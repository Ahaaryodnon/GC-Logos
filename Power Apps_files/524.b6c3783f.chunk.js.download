/*! For license information please see 524.b6c3783f.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[524],{22313:function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return c}));var n=r(10926),i=r(11021),a=r(12088),o=r(16208),u=r(14831),l={SharePointS2S:"FCB.SHAREPOINTS2S",GuidedHelp:"FCB.GUIDEDHELP",OrionAir:"FCB.Orion.Air"},c=(e,t)=>{var{featureName:r,t:l}=e,[c,d]=Object(n.useState)(void 0),{data:s,isInitialLoading:b,error:v}=Object(u.c)(t),f=v?v.message||l("Common.Request.Failed"):"";return Object(n.useEffect)(()=>{try{if(!b&&s){var e,t,n,u,c,v,m=null!==(e=null==s?void 0:s.featureSet)&&void 0!==e?e:"",p=null!==(t=null==s?void 0:s.isAuditEnabled)&&void 0!==t&&t,g=null!==(n=null==s?void 0:s.enableMakerSwitchToClassic)&&void 0!==n&&n;Object(i.W)(a.a,{eventName:o.b.GetOrganization,eventData:{organizationSettings:s}});var y=!1;if(m&&r){var O=(new DOMParser).parseFromString(m,"application/xml");if(O){var j,h=(null==O||null===(j=O.documentElement)||void 0===j?void 0:j.querySelectorAll("feature"))||[];null==h||h.forEach(e=>{var t,n,i=(null==e||null===(t=e.querySelector("name"))||void 0===t?void 0:t.textContent)||"";(null==i?void 0:i.toLowerCase())!==(null==r?void 0:r.toLowerCase())||(y=!(null==e||null===(n=e.querySelector("value"))||void 0===n||!n.textContent)||!1)})}}d({loading:!1,errorMessage:f,orgHasFeatureNameSet:y,isAuditEnabled:p||!1,isBPFEntityCustomizationFeatureEnabled:null!==(u=null==s?void 0:s.isBPFEntityCustomizationFeatureEnabled)&&void 0!==u&&u,maxUploadFileSize:null!==(c=null==s?void 0:s.maxUploadFileSize)&&void 0!==c?c:void 0,organizationState:null!==(v=null==s?void 0:s.organizationState)&&void 0!==v?v:void 0,enableMakerSwitchToClassic:g||!1})}else d({loading:b,errorMessage:f,orgHasFeatureNameSet:!1,isAuditEnabled:!1,isBPFEntityCustomizationFeatureEnabled:!1,enableMakerSwitchToClassic:!1})}catch(E){Object(i.U)(a.a,{eventName:o.b.GetOrganization,eventData:{organizationSettings:s}}),d({loading:!1,errorMessage:l("Common.Request.Failed"),orgHasFeatureNameSet:!1,isAuditEnabled:!1,isBPFEntityCustomizationFeatureEnabled:!1,enableMakerSwitchToClassic:!1})}},[s,b,f]),c}},22507:function(e,t,r){"use strict";r.d(t,"b",(function(){return w})),r.d(t,"g",(function(){return F})),r.d(t,"e",(function(){return N})),r.d(t,"a",(function(){return C})),r.d(t,"d",(function(){return T})),r.d(t,"c",(function(){return I})),r.d(t,"f",(function(){return A}));var n=r(13555),i=r(11021),a=r(12313),o=r(13771),u=r(13556),l=r(22508),c=r(10926),d=r(13572),s=r(11868),b=r(22509),v=r(12219),f=r(22510),m=r(22514),p=r(13770),g=r(21939),y=r(22517),O=r(13791);function j(e,t,r,n,i,a,o){try{var u=e[a](o),l=u.value}catch(c){return void r(c)}u.done?t(l):Promise.resolve(l).then(n,i)}function h(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){j(a,n,i,o,u,"next",e)}function u(e){j(a,n,i,o,u,"throw",e)}o(void 0)}))}}function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e,t){var r=u.g.createTable,n=Object(c.useRef)(),[a,l]=Object(c.useState)(""),[d,s]=Object(c.useState)(""),{mutate:b,isLoading:v,data:m}=Object(o.a)(f.a,{mutationKey:["powerapps-ui-common","createTable"],onSuccess:()=>{var e;null===(e=n.current)||void 0===e||e.complete(),l("")},onError:e=>{var r,i,a,o,u,c,d,b=Object(p.c)(e,t);l(b);var v=new RegExp("0[xX][0-9a-fA-F]+");s(null!==(r=null===(i=v.exec(b))||void 0===i?void 0:i[0])&&void 0!==r?r:null===(a=v.exec(null===(o=e.response)||void 0===o||null===(u=o.data)||void 0===u||null===(c=u.error)||void 0===c?void 0:c.code))||void 0===a?void 0:a[0]),null===(d=n.current)||void 0===d||d.failure(e)}});return Object(c.useEffect)(()=>{v&&(n.current=Object(u.j)(e,r,u.d.DataExperience,u.e.DataFetchHooks,i.j.PowerappsPortal,i.f.Medium))},[v]),P({createTable:b},P(P({},m),{},{loading:v,errorMessage:a,errorCode:d}))}function F(e,t){var r=u.g.updateTable,n=Object(c.useRef)(),[a,l]=Object(c.useState)(""),{mutate:d,isLoading:s,data:b}=Object(o.a)(m.a,{mutationKey:["powerapps-ui-common","updateTable"],onSuccess:()=>{var e;null===(e=n.current)||void 0===e||e.complete(),l("")},onError:e=>{var r,i=Object(p.c)(e,t);l(i),null===(r=n.current)||void 0===r||r.failure(e)}});return Object(c.useEffect)(()=>{s&&(n.current=Object(u.j)(e,r,u.d.DataExperience,u.e.DataFetchHooks,i.j.PowerappsPortal,i.f.Medium))},[s]),{updateTable:d,loading:s,errorMessage:a,tableUpdated:!!b}}function N(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4?arguments[4]:void 0,l=u.g.getTableByName,d=Object(c.useRef)(),[v,f]=Object(c.useState)(""),{isInitialLoading:m,data:y,refetch:O,isFetching:j}=Object(a.a)(["powerapps-ui-common","GetTableByNameQuery",e],h((function*(){var t={method:"GET",team:i.j.PowerappsPortal},r=Object(g.d)(e.tableName),n=yield Object(s.f)(r,t),a=Object(b.b)(null==n?void 0:n.data),o=yield Object(s.f)("".concat(r,"/Attributes(LogicalName = '").concat(null==a?void 0:a.toLowerCase(),"')"),t);return Object(b.c)(null==n?void 0:n.data,null==o?void 0:o.data,e.isElasticTableTypeFeatureEnabled)})),{enabled:n,onSuccess:e=>{d.current&&(d.current.complete({tableId:null==e?void 0:e.id}),d.current=void 0),f("")},onError:e=>{var t=Object(p.c)(e,r);f(t),d.current&&(d.current.failure({error:t,clientError:e}),d.current=void 0)},staleTime:0,cacheTime:0});return o&&O&&O(),Object(c.useEffect)(()=>{(m||j)&&(d.current=Object(u.j)(t,l,u.d.DataExperience,u.e.DataFetchHooks,i.j.PowerappsPortal,i.f.Medium))},[m,j]),{loading:m||j,errorMessage:v,table:y}}var C=e=>"".concat(O.b,"EntityDefinitions(").concat(e,")");function T(e,t,r){var n,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],l=arguments.length>4?arguments[4]:void 0,d=arguments.length>5?arguments[5]:void 0,f=u.g.getTableById,m=Object(c.useRef)(),[g,y]=Object(c.useState)(""),{currentEnvironment:O}=Object(v.W)(),{data:j,error:E,refetch:P,isInitialLoading:S,isSuccess:w,isError:F}=Object(a.a)(["powerapps-ui-common","GetTableByIdQuery",e,null==O?void 0:O.name],h((function*(){var t=C(e.tableId),r=yield Object(s.f)(t),n=Object(b.b)(null==r?void 0:r.data),i=encodeURIComponent((null==n?void 0:n.toLowerCase())||"")||void 0,a=e.needPrimaryField?yield Object(s.f)("".concat(t,"/Attributes(LogicalName = '").concat(i,"')")):void 0;return Object(b.c)(null==r?void 0:r.data,null==a?void 0:a.data,d)})),{enabled:o,staleTime:0,cacheTime:0});return Object(c.useEffect)(()=>{if(S)m.current=Object(u.j)(t,f,u.d.DataExperience,u.e.DataFetchHooks,i.j.PowerappsPortal,i.f.Medium);else if(w)m.current&&(m.current.complete({tableId:null==j?void 0:j.id}),m.current=void 0),y("");else if(F){var e=Object(p.c)(E,r);y(e),m.current&&(m.current.failure({error:E}),m.current=void 0)}},[S,w,F]),l&&P&&P(),{loading:S,errorMessage:g,table:j,refetch:(n=h((function*(){yield P()})),function(){return n.apply(this,arguments)})}}function I(e,t,r,a){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=u.g.getAllTables,b=Object(c.useRef)(),[v,f]=Object(c.useState)(""),{loading:m,data:p}=Object(d.c)(l.a,{client:e||void 0,onCompleted:e=>{var t;b.current&&(b.current.complete({tablesLength:null==e||null===(t=e.entityTypes)||void 0===t?void 0:t.length}),b.current=void 0);f("")},onError:e=>{var t=Object(n.b)(e,a);f(t),b.current&&(b.current.failure({error:t,clientError:null==e?void 0:e.message}),b.current=void 0)},skip:o,variables:t});return Object(c.useEffect)(()=>{m&&(b.current=Object(i.X)(r,s))},[m]),{loading:m,errorMessage:v,tables:null==p?void 0:p.entityTypes}}function A(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5?arguments[5]:void 0,{hasDataverse:d}=Object(v.W)(),b=!o&&!!d,f=u.g.getCdsTableRelatedRecords,m=Object(c.useRef)(),[p,O]=Object(c.useState)(""),{isInitialLoading:j,isFetching:E,data:P,refetch:S}=Object(a.a)(["powerapps-ui-common","GetTableRelatedRecords",e,t],h((function*(){var r,n,i=Object(g.e)(e,t),a=yield Object(s.f)(i);return(null==a||null===(r=a.data)||void 0===r||null===(n=r.value)||void 0===n?void 0:n.map(e=>Object(y.a)(e)))||[]})),{enabled:b,onSuccess:e=>{var t;null===(t=m.current)||void 0===t||t.complete({TableRelatedRecordsLength:null==e?void 0:e.length}),O(""),m.current=void 0},onError:e=>{var t;O((null==e?void 0:e.message)||n),null===(t=m.current)||void 0===t||t.failure({error:e}),m.current=void 0}});return Object(c.useEffect)(()=>{l&&b&&S&&S()},[l,b,S]),Object(c.useEffect)(()=>{(j||E)&&(m.current=Object(u.j)(r,f,u.d.DataExperience,u.e.DataFetchHooks,i.j.PowerappsPortal,i.f.Medium))},[j,E]),{loading:j,fetching:E,errorMessage:p,tableRelatedRecords:P}}},22508:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,i=r(13558);var a,o,u=r.n(i)()(n||(a=["\n  query allTables($entityTypeNames: [String!]!, $solutionId: String, $filterEntities: Boolean) {\n    entityTypes(entityTypeNames: $entityTypeNames, solutionId: $solutionId, filterEntities: $filterEntities) {\n      id\n      logicalName\n      logicalCollectionName\n      displayName\n      primaryIdAttribute\n      primaryNameAttribute\n      canBePrimaryEntityInRelationship\n      dataSourceId\n      dataProviderId\n    }\n  }\n"],o||(o=a.slice(0)),n=Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(o)}}))))},22514:function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n=r(22511),i=r(22509),a=r(21926),o=r(22512),u=r(22513),l=r(11885),c=r(14426),d=r(14430),s=r(11868),b=r(11021),v=r(13791),f=r(22515);function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y(e,t,r,n,i,a,o){try{var u=e[a](o),l=u.value}catch(c){return void r(c)}u.done?t(l):Promise.resolve(l).then(n,i)}var O=function(){var e,t=(e=function*(e){var t,r,m,{solutionUniqueName:g,solutionId:y,table:O,localeId:j,isArchivalServiceFeatureEnabled:h,isElasticTableTypeFeatureEnabled:E,isPreferredSolutionFeatureEnabled:P}=e,S=j||1033,w=[],F=null==O?void 0:O.iconVectorName;if(F&&(m=yield Object(n.c)(y,F),F&&!m)){var N,C=yield Object(o.a)(F,!1);(null==C?void 0:C.length)>0&&w.push(Object(u.a)(null===(N=C[0])||void 0===N?void 0:N.id,l.v.WebResource,!1,!1,g))}if((null==O||null===(t=O.primaryImageAttribute)||void 0===t?void 0:t.logicalName)!==(null==O||null===(r=O.originalPrimaryImageAttribute)||void 0===r?void 0:r.logicalName)){var T,I=null==O?void 0:O.schemaName;if(null!=O&&null!==(T=O.primaryImageAttribute)&&void 0!==T&&T.logicalName){w.push(Object(a.l)(I,null==O?void 0:O.primaryImageAttribute,g,!0,P)),w.push(Object(i.e)(O,S,g,P)),null!=O&&O.originalPrimaryImageAttribute&&w.push(Object(a.l)(I,null==O?void 0:O.originalPrimaryImageAttribute,g,!1,P));var A=Object(c.e)(w,e=>e);return yield Promise.all(A.map(e=>Object(d.a)(e))),!0}var D=yield Object(f.a)(I);for(var M of D)w.push(Object(a.a)(I,null==M?void 0:M.logicalName));w.push(Object(i.e)(O,S,g,P));var B=Object(c.e)(w,e=>e);return yield Promise.all(B.map(e=>Object(d.a)(e))),!0}if(null!=O&&O.iconVectorName&&!m){w.push(Object(i.e)(O,S,g,P));var L=Object(c.e)(w,e=>e);return yield Promise.all(L.map(e=>Object(d.a)(e))),!0}var R,k,x=p(p({Accept:"application/json","Content-Type":"application/json"},P?{}:{"MSCRM.SolutionUniqueName":g}),{},{"MSCRM.MergeLabels":"true"}),z=Object(i.d)(O,S,h,E),H={headers:x,team:b.j.PowerappsPortal,method:"put",data:JSON.stringify(z)},G=yield Object(s.f)("".concat(v.b,"EntityDefinitions(LogicalName = '").concat(null==O||null===(R=O.schemaName)||void 0===R?void 0:R.toLowerCase(),"')"),H);if(204!==(null==G?void 0:G.status)&&200!==(null==G?void 0:G.status))throw new Error(null==G||null===(k=G.data)||void 0===k?void 0:k.errorMessage);return!0},function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){y(a,n,i,o,u,"next",e)}function u(e){y(a,n,i,o,u,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}()},22515:function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return f}));var n=r(11021),i=r(13556),a=r(10926),o=r(12313),u=r(12219),l=r(11868),c=r(21939),d=r(22516);function s(e,t,r,n,i,a,o){try{var u=e[a](o),l=u.value}catch(c){return void r(c)}u.done?t(l):Promise.resolve(l).then(n,i)}function b(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){s(a,n,i,o,u,"next",e)}function u(e){s(a,n,i,o,u,"throw",e)}o(void 0)}))}}var v=function(){var e=b((function*(e){var t,r,n=Object(c.a)(e),i=yield Object(l.f)(n);return(null==i||null===(t=i.data)||void 0===t||null===(r=t.value)||void 0===r?void 0:r.map(e=>Object(d.a)(e)))||[]}));return function(t){return e.apply(this,arguments)}}();function f(e,t,r){var l=arguments.length>3&&void 0!==arguments[3]&&arguments[3],{hasDataverse:c}=Object(u.W)(),d=!l&&!!c,s=i.g.getAttributeByTableName,f=Object(a.useRef)(),[m,p]=Object(a.useState)(""),{isInitialLoading:g,isFetching:y,data:O}=Object(o.a)(["powerapps-ui-common","GetImageAttributesByTableNameQuery",e],b((function*(){return v(e)})),{enabled:d,onSuccess:e=>{var t;null===(t=f.current)||void 0===t||t.complete({ImageAttributesLength:null==e?void 0:e.length}),p(""),f.current=void 0},onError:e=>{var t;p((null==e?void 0:e.message)||r),null===(t=f.current)||void 0===t||t.failure({error:e}),f.current=void 0}});return Object(a.useEffect)(()=>{(g||y)&&(f.current=Object(i.j)(t,s,i.d.DataExperience,i.e.DataFetchHooks,n.j.PowerappsPortal,n.f.Medium))},[g,y]),{loading:g,fetching:y,errorMessage:m,attributes:O}}},22516:function(e,t,r){"use strict";function n(e){var t,r;return{id:(null==e?void 0:e.MetadataId)||"",schemaName:(null==e?void 0:e.SchemaName)||"",logicalName:(null==e?void 0:e.LogicalName)||"",isPrimaryImage:(null==e?void 0:e.IsPrimaryImage)||!1,displayName:(null==e||null===(t=e.DisplayName)||void 0===t||null===(r=t.UserLocalizedLabel)||void 0===r?void 0:r.Label)||(null==e?void 0:e.SchemaName),isCustomAttribute:(null==e?void 0:e.IsCustomAttribute)||!1}}r.d(t,"a",(function(){return n}))},22517:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(13752),i=r.n(n),a=r(22518);function o(e){return i()({id:"msdyn_objectid",schemaName:"msdyn_schemaname",subType:"msdyn_subtype",primaryEntityName:"msdyn_primaryentityname",relatedEntity:"msdyn_relatedentity",relatedEntityAttribute:"msdyn_relatedentityattribute"},e,a.a)}},22518:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e,t,r,n,i,a){this.id=e,this.schemaName=t,this.subType=r,this.primaryEntityName=n,this.relatedEntity=i,this.relatedEntityAttribute=a,this.id=e,this.schemaName=t,this.subType=r,this.primaryEntityName=n,this.relatedEntity=i,this.relatedEntityAttribute=a}}},22534:function(e,t,r){"use strict";r.d(t,"f",(function(){return a})),r.d(t,"g",(function(){return o})),r.d(t,"b",(function(){return u})),r.d(t,"e",(function(){return l})),r.d(t,"d",(function(){return c})),r.d(t,"c",(function(){return d})),r.d(t,"a",(function(){return s}));var n=r(11885),i=r(19333),a="7015A531-CC0D-4537-B5F2-C882A1EB65AD",o="00000000-0000-0000-0000-000000000000",u=(e,t,r)=>!e&&l(t,r),l=(e,t)=>e===n.F.Virtual&&Object(i.h)(t),c=e=>!!e&&("1d9bde74-9ebd-4da9-8ff5-aa74945b9f74"===e.id||"1d9bde74-9ebd-4da9-8ff5-aa74945b9f74"===e.entityDataProviderId),d=e=>!(null==e||!e.find(e=>"2ac667f5-31d6-e911-a95e-000d3a110bbd"===e.entityDataProviderId)),s=(e,t,r)=>e&&t===n.F.Virtual?r.filter(e=>"1d9bde74-9ebd-4da9-8ff5-aa74945b9f74"!==e.data):r},22535:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return l}));var n=r(12088),i=r(14955),a=r(11021),o=r(12219),u={MocaOffline:"FCB.Moca.Offline",OrionAir:"FCB.Orion.Air",OneNoteIntegration:"FCB.OneNoteIntegration",SharePointS2S:"FCB.SharePointS2S",MultipleImages:"FCB.MultipleImages",EnableArchivalService:"FCB.EnableArchivalService",EnableChangeTrackingForFnOVEFromEntityService:"FCB.EnableChangeTrackingForFnOVEFromEntityService",EnableChangeTrackingConfigurationForFnOVE:"FCB.EnableChangeTrackingConfigurationForFnOVE"},l=(e,t)=>{var{platformFCBNames:r}=e,{currentEnvironment:u}=Object(o.W)(),{data:l}=Object(i.a)({fcbsToFetch:r,telemetryScope:n.a,environment:u},a.j.PowerappsPortal,t);return null==l?void 0:l.fcbs}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/524.b6c3783f.chunk.js.map
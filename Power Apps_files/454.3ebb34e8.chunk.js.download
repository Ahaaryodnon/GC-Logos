/*! For license information please see 454.3ebb34e8.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[454],{20408:function(e,n,t){"use strict";t.d(n,"e",(function(){return H})),t.d(n,"b",(function(){return X})),t.d(n,"a",(function(){return Z})),t.d(n,"c",(function(){return Q}));var r=t(20409),a=t.n(r),i=t(20410),o=t.n(i),s=t(20411),u=t.n(s),c=t(20412),l=t.n(c),p=t(20413),d=t.n(p),E=t(20414),v=t.n(E),f=t(20415),S=t.n(f),g=t(20416),O=t.n(g),m=t(20417),T=t.n(m),R=t(20418),C=t.n(R),P=t(20419),_=t.n(P),A=t(20420),b=t.n(A),h=t(20421),I=t.n(h),N=t(20422),y=t.n(N),k=t(20423),D=t.n(k),L=t(20424),w=t(20425),J=t.n(w),U=t(20426),M=t.n(U),j=t(20427),B=t.n(j),F=t(20428),V=t.n(F),x=t(20429),G=t.n(x),K=t(20430),z=t.n(K),q={Phone1:a(),Phone2:o(),Phone3:u(),Tablet1:l(),Tablet2:d(),Tablet3:v(),BadFrame_Complex:T(),BadFrame_darkBg:C(),BadFrame_MultiPg:_(),GoodFrame:b(),HandDrawn_Bad:I(),HandDrawn_Good:y(),createAppFailure:D()},W={getPaths:()=>q},H=()=>[a.a,o.a,u.a,l.a,d.a,v.a],X={createNewTable:S(),skipStep:O()};L.a;n.d=W;var Z={StartFromFigmaTile:J(),StartFromImageTile:M(),FigmaStepOne:B()},Q={CreatingAppLoading:V(),NewWizardBackground:G(),PreviewEmptyApp:z()}},20409:function(e,n,t){e.exports=t.p+"static/media/Phone1.9a8be612.22.png"},20410:function(e,n,t){e.exports=t.p+"static/media/Phone2.cba3ca34.22.png"},20411:function(e,n,t){e.exports=t.p+"static/media/Phone3.319c4e7f.22.png"},20412:function(e,n,t){e.exports=t.p+"static/media/Tablet1.2e57d52a.22.png"},20413:function(e,n,t){e.exports=t.p+"static/media/Tablet2.9bb8f9fb.22.png"},20414:function(e,n,t){e.exports=t.p+"static/media/Tablet3.c5acffa0.22.png"},20415:function(e,n,t){e.exports=t.p+"static/media/createNewTable.9288835b.svg"},20416:function(e,n,t){e.exports=t.p+"static/media/skipStep.32cda2fb.svg"},20417:function(e,n,t){e.exports=t.p+"static/media/BadFrame_Complex.31f8c9e6.svg"},20418:function(e,n,t){e.exports=t.p+"static/media/BadFrame_darkBg.98b222d7.svg"},20419:function(e,n,t){e.exports=t.p+"static/media/BadFrame_MultiPg.73c00e82.svg"},20420:function(e,n,t){e.exports=t.p+"static/media/GoodFrame.c0325cb9.svg"},20421:function(e,n,t){e.exports=t.p+"static/media/HandDrawn_Bad.74f31501.22.png"},20422:function(e,n,t){e.exports=t.p+"static/media/HandDrawn_Good.4d007c98.22.png"},20423:function(e,n,t){e.exports=t.p+"static/media/createAppFailure.6b9cebf6.svg"},20424:function(e,n,t){"use strict";n.a="data:image/png;base64,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"},20425:function(e,n,t){e.exports=t.p+"static/media/StartFromFigmaTile.829340e3.svg"},20426:function(e,n,t){e.exports=t.p+"static/media/StartFromImageTile.0cdd03c0.svg"},20427:function(e,n,t){e.exports=t.p+"static/media/FigmaStepOne.3061522c.svg"},20428:function(e,n,t){e.exports=t.p+"static/media/creatingAppLoading.b5af5ef5.svg"},20429:function(e,n,t){e.exports=t.p+"static/media/newWizardBackground.e7938dc1.svg"},20430:function(e,n,t){e.exports=t.p+"static/media/previewEmptyApp.953d82a1.svg"},20432:function(e,n,t){"use strict";t.d(n,"a",(function(){return s})),t.d(n,"b",(function(){return u}));var r=t(10926),a=t.n(r),i=t(11205),o=t(13616),s="exprDesignFlags",u=()=>{var e=Object(i.j)(),n=a.a.useMemo(()=>{var n,t;return null!==(n=new URLSearchParams(null!==(t=e.search)&&void 0!==t?t:"").get(s))&&void 0!==n?n:""},[e.search]);return{exprDesignFlags:c(n),exprDesignParams:n}},c=e=>{var n={UsePPAPI:!!o.a.getConfig().deprecateLegacyPARP};if(!e)return n;return e.split(",").forEach(e=>{var t=e.split("=");n[t[0]]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=["true","True","1"];return n.includes(e.toLowerCase())}(t[1])}),n}},20435:function(e,n,t){"use strict";t.d(n,"h",(function(){return a})),t.d(n,"f",(function(){return i})),t.d(n,"g",(function(){return o})),t.d(n,"c",(function(){return s})),t.d(n,"d",(function(){return u})),t.d(n,"e",(function(){return c})),t.d(n,"a",(function(){return l})),t.d(n,"b",(function(){return p}));var r=t(17716),a=e=>{var{error:n,success:t}=e;if(void 0!==n&&void 0!==t)throw new Error(r.k.InvalidResponse);if(void 0!==n)return n;if(void 0!==t)return t;throw new Error(r.k.InvalidResponse)},i=e=>({error:e}),o=e=>({success:e.result}),s=function(e){return e.Phone="phone",e.Tablet="tablet",e}({}),u=function(e){return e.Portrait="portrait",e.Landscape="landscape",e}({}),c=function(e){return e.TextLabel="TextLabel",e.TextInput="TextInput",e.Button="Button",e.CheckBox="CheckBox",e.ControlGroup="ControlGroup",e.Radio="Radio",e.Rectangle="Rectangle",e.DatePicker="DatePicker",e.DropDown="DropDown",e.ListBox="ListBox",e.Rating="Rating",e.Slider="Slider",e.Toggle="Toggle",e.None="None",e}({}),l=function(e){return e.None="None",e.Dataverse="Dataverse",e}({}),p=function(e){return e.Text="Text",e.Date="Date",e.Number="Number",e.Email="Email",e.Phone="Phone",e.Decimal="Decimal",e.URL="URL",e}({})},20436:function(e,n,t){"use strict";t.d(n,"b",(function(){return _})),t.d(n,"a",(function(){return A}));var r=t(11019),a=t(16199),i=t(17555),o=t(11838),s=t(10920),u=t(11021),c=t(13616),l=t(10926),p=t.n(l),d=t(20435),E=t(17716),v=t(20437),f=t(20438),S=t(20432);function g(e,n,t,r,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void t(c)}s.done?n(u):Promise.resolve(u).then(r,a)}function O(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var i=e.apply(n,t);function o(e){g(i,r,a,o,s,"next",e)}function s(e){g(i,r,a,o,s,"throw",e)}o(void 0)}))}}var m=new Map([[i.b.tie,"preprod"],[i.b.test,Object(o.a)()?"test":"preprod"],[i.b.preprod,"preprod"],[i.b.preview,"firstrelease"],[i.b.prod,"prod"],[i.b.gov,"gov"],[i.b.high,"high"],[i.b.dod,"dod"],[i.b.mooncake,"mooncake"],[i.b.ex,"ex"],[i.b.rx,"rx"]]),T=()=>{var{region:e}=Object(s.j)(),n=m.get(i.b[e]);return c.a.getConfig().deprecateLegacyPARP?{audience:new a.a(n).getTokenAudience(),cluster:n}:{audience:"https://service.powerapps.com",cluster:n}};function R(e){return C.apply(this,arguments)}function C(){return(C=O((function*(e){if(e)return(yield Object(r.g)(e)).accessToken}))).apply(this,arguments)}function P(e){var n;return!(null!=e&&e.id&&e.name&&null!==(n=e.properties.cluster)&&void 0!==n&&n.uriSuffix)}var _=(e,n)=>{var{exprDesignFlags:t}=Object(S.b)(),r=Object(l.useMemo)(T,[]);return{processImage:p.a.useCallback(function(){var r=O((function*(r){if(P(n))e({type:v.a.SET_INVALID_ENVIRONMENT_ERROR,errorMessage:E.k.InvalidEnvironment,loading:!1});else{var a=Object(u.Y)(E.s,E.q.ProcessImage);r.jsonParams.config={enabledFeatures:t},e({type:v.a.PROCESS_IMAGE_TO_CONTROLS,request:r});var i,o,s=yield Object(f.e)(r,n.name),c=Object(d.h)(s);if("errors"in c)e({type:v.a.SET_SERVICE_RESPONSE_ERROR,errorMessage:E.k.InvalidResponse,loading:!1}),a.completeWithError({error:c,networkError:c.isNetworkOrConnectionError});else e({type:v.a.PROCESS_IMAGE_TO_CONTROLS_COMPLETE,response:c}),a.complete({apiSessionId:c.sessionId,identifiedControlsCount:null!==(i=null===(o=c.identifiedControls)||void 0===o?void 0:o.length)&&void 0!==i?i:0})}}));return function(e){return r.apply(this,arguments)}}(),[e,n,t]),processControls:p.a.useCallback(function(){var r=O((function*(r){if(P(n))e({type:v.a.SET_INVALID_ENVIRONMENT_ERROR,errorMessage:E.k.InvalidEnvironment,loading:!1});else{var a=Object(u.Y)(E.s,E.q.ProcessControls);e({type:v.a.PROCESS_CONTROLS_TO_COLUMNS,request:r});var i,o,s=yield Object(f.d)(r,n.name,{enabledFeatures:t}),c=Object(d.h)(s);if("errors"in c)e({type:v.a.SET_SERVICE_RESPONSE_ERROR,errorMessage:E.k.InvalidResponse,loading:!1}),a.completeWithError({error:c,networkError:c.isNetworkOrConnectionError});else e({type:v.a.PROCESS_CONTROLS_TO_COLUMNS_COMPLETE,response:c}),a.complete({apiSessionId:c.sessionId,identifiedColumnsCount:null!==(i=null===(o=c.identifiedGroups)||void 0===o?void 0:o.length)&&void 0!==i?i:0})}}));return function(e){return r.apply(this,arguments)}}(),[e,n,t]),createAppFromImage:p.a.useCallback(function(){var a=O((function*(a,i){var o,s,u;if(P(n))return e({type:v.a.SET_SERVICE_RESPONSE_ERROR,errorMessage:E.k.InvalidResponse,loading:!1}),void i.completeWithError({message:E.k.InvalidEnvironment});e({type:v.a.PROCESS_CREATE_APP,request:a});var c=null!==(o=null===(s=n.properties.linkedEnvironmentMetadata)||void 0===s?void 0:s.instanceUrl)&&void 0!==o?o:"",[l,p]=yield Promise.all([R(r.audience),R(c)]),S={id:n.name,accessToken:l,cluster:null===(u=r.cluster)||void 0===u?void 0:u.toString()},g=c&&p?{url:c,accessToken:p}:void 0,O=yield Object(f.b)(a,{environment:S,dataverseContext:g,enabledFeatures:t},n.name),m=Object(d.h)(O);"errors"in m?(e({type:v.a.SET_SERVICE_RESPONSE_ERROR,errorMessage:E.k.InvalidResponse,loading:!1}),i.completeWithError({error:m,networkError:m.isNetworkOrConnectionError})):m.uploadError?(e({type:v.a.SET_SERVICE_RESPONSE_ERROR,errorMessage:E.k.InvalidResponse,loading:!1}),i.completeWithError({error:m.uploadError})):(e({type:v.a.PROCESS_CREATE_APP_COMPLETE,response:m}),i.complete({apiSessionId:m.sessionId,appId:b(m.makerUrl)}))}));return function(e,n){return a.apply(this,arguments)}}(),[e,n,t,r])}},A=e=>{var[n,t]=p.a.useState(!1),{exprDesignFlags:r}=Object(S.b)(),a=Object(l.useMemo)(T,[]);return{isLoading:n,createAppFromFigma:p.a.useCallback(function(){var n=O((function*(n){var i;if(P(e))return{errors:[],message:E.k.InvalidEnvironment,isNetworkOrConnectionError:!1};var o=Object(u.Y)(E.r,E.q.CreateAppFromFigma);t(!0);var s=yield R(a.audience);n.config.environment.accessToken=s,n.config.environment.cluster=null===(i=a.cluster)||void 0===i?void 0:i.toString(),n.config.enabledFeatures=r;var c=yield Object(f.a)(n,e.name),l=Object(d.h)(c);return"errors"in l?o.completeWithError({error:l,networkError:l.isNetworkOrConnectionError}):l.uploadError?o.completeWithError({error:l.uploadError,apiSessionId:l.sessionId}):o.complete({apiSessionId:l.sessionId,appId:b(l.makerUrl)}),t(!1),l}));return function(e){return n.apply(this,arguments)}}(),[e,r,a]),validateInputAsync:p.a.useCallback(function(){var e=O((function*(e,n){t(!0);var{status:r,loading:a,nodeDataSet:i}=yield Object(f.g)(e,n);return t(a),{status:r,nodeDataSet:i}}));return function(n,t){return e.apply(this,arguments)}}(),[]),validateAppNameAsync:p.a.useCallback(function(){var n=O((function*(n){return yield Object(f.f)(n,e.name,E.r)}));return function(e){return n.apply(this,arguments)}}(),[e]),getPreviewImageAsync:p.a.useCallback(function(){var e=O((function*(e,n,r){t(!0);var a=yield Object(f.c)(e,n,r);return t(!1),a}));return function(n,t,r){return e.apply(this,arguments)}}(),[])}},b=e=>{var n,t;return e&&null!==(n=null===(t=new URL(e))||void 0===t?void 0:t.searchParams.get("app-id"))&&void 0!==n?n:void 0}},20437:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var r=function(e){return e.SET_SERVICE_RESPONSE_ERROR="SET_SERVICE_RESPONSE_ERROR",e.SET_INVALID_ENVIRONMENT_ERROR="SET_INVALID_ENVIRONMENT_ERROR",e.SET_LOADING="SET_LOADING",e.SET_CAN_ADVANCE="SET_CAN_ADVANCE",e.SAVE_INPUT_VALUES="SAVE_INPUT_VALUES",e.PROCESS_IMAGE_TO_CONTROLS="PROCESS_IMAGE_TO_CONTROLS",e.PROCESS_IMAGE_TO_CONTROLS_COMPLETE="PROCESS_IMAGE_TO_CONTROLS_COMPLETE",e.PROCESS_CONTROLS_TO_COLUMNS="PROCESS_CONTROLS_TO_COLUMNS",e.PROCESS_CONTROLS_TO_COLUMNS_COMPLETE="PROCESS_CONTROLS_TO_COLUMNS_COMPLETE",e.PROCESS_CREATE_APP="PROCESS_CREATE_APP",e.PROCESS_CREATE_APP_COMPLETE="PROCESS_CREATE_APP_COMPLETE",e.SET_STEP_STATUS="SET_STEP_STATUS",e.SKIP_DATA_STEPS="SKIP_DATA_STEPS",e.PROCESS_USER_DEFINED_CONTROLS="PROCESS_USER_DEFINED_CONTROLS",e.PROCESS_USER_DEFINED_COLUMNS="PROCESS_USER_DEFINED_COLUMNS",e.SET_TABLE_NAME_CONFLICT="SET_TABLE_NAME_CONFLICT",e.SET_USER_PRIVILEGES="SET_USER_PRIVILEGES",e.PROCESS_CREATE_TABLE="PROCESS_CREATE_TABLE",e.PROCESS_CREATE_TABLE_COMPLETE="PROCESS_CREATE_TABLE_COMPLETE",e.REVIEW_UPDATE_TABLE_SETTINGS="REVIEW_UPDATE_TABLE_SETTINGS",e.SET_WIZARD_COMPLETE_STATUS="SET_WIZARD_COMPLETE_STATUS",e.PROCESS_CREATE_ATTRIBUTE="PROCESS_CREATE_ATTRIBUTE",e.PROCESS_CREATE_ATTRIBUTE_COMPLETE="PROCESS_CREATE_ATTRIBUTE_COMPLETE",e.RESET_SKIPPED_STEP_STATUS="RESET_SKIPPED_STEP_STATUS",e}({})},20438:function(e,n,t){"use strict";t.d(n,"e",(function(){return T})),t.d(n,"d",(function(){return C})),t.d(n,"b",(function(){return _})),t.d(n,"a",(function(){return b})),t.d(n,"g",(function(){return N})),t.d(n,"f",(function(){return k})),t.d(n,"c",(function(){return L}));var r=t(11021),a=t(20435),i=t(17716),o=t(11868);function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){c(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n,t){return(n=function(e){var n=function(e,n){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n,t,r,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void t(c)}s.done?n(u):Promise.resolve(u).then(r,a)}function p(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var i=e.apply(n,t);function o(e){l(i,r,a,o,s,"next",e)}function s(e){l(i,r,a,o,s,"throw",e)}o(void 0)}))}}function d(e){return E.apply(this,arguments)}function E(){return(E=p((function*(e){var n=e.data;return Object(a.g)(n)}))).apply(this,arguments)}function v(e){return f.apply(this,arguments)}function f(){return(f=p((function*(e){var n=e.data;if(n){var t,r=n.error;if((null==r||null===(t=r.errors)||void 0===t?void 0:t.length)>0)return Object(a.f)(u(u({},r),{},{sessionId:n.sessionId,isNetworkOrConnectionError:O(r)}));if(null!=r&&r.message)return Object(a.f)({message:null==r?void 0:r.message,sessionId:n.sessionId,errors:[],isNetworkOrConnectionError:O(r)})}return Object(a.g)(n)}))).apply(this,arguments)}function S(e,n,t){return g.apply(this,arguments)}function g(){return(g=p((function*(e,n,t){var i,o=Object(r.p)(e);Object(r.U)(n,{eventData:o,eventName:t});var s=null===(i=e.response)||void 0===i?void 0:i.data;if(s){var c,l=s.error;if((null==l||null===(c=l.errors)||void 0===c?void 0:c.length)>0)return Object(a.f)(u(u({},l),{},{sessionId:s.sessionId,isNetworkOrConnectionError:O(l)}));if(null!=l&&l.message)return Object(a.f)({message:null==l?void 0:l.message,sessionId:s.sessionId,errors:[],isNetworkOrConnectionError:O(l)})}return Object(a.f)({message:JSON.stringify(o),errors:[],isNetworkOrConnectionError:O(o)})}))).apply(this,arguments)}function O(e){return"Network Error"===(null==e?void 0:e.message)||"Failed to fetch"===(null==e?void 0:e.message)||"Request aborted"===(null==e?void 0:e.message)}var m=(e,n,t)=>window.location.search.indexOf("CFC_useDevApis=true")>-1?(e=>{var n={"appintelligence/processimage":"Content/Image","appintelligence/processcontrols":"Content/Results/Controls","appintelligence/image/createapp":"Content/Results/Groups","appintelligence/figma/createapp":"Figma"}[e];return n?"https://localhost:44313/".concat(n):e})(n):"https://".concat(t?"aibuildertextapiservice.".concat(t,".powerapps.com"):"aibtext","/").concat(i.v,"/").concat(e,"/").concat(n);function T(e,n){return R.apply(this,arguments)}function R(){return(R=p((function*(e,n){try{var t=new FormData;t.append("file",e.file),t.append("request",JSON.stringify(e.jsonParams));var r=m(n,i.u.processImage),a=yield o.f.post(r,t);return yield d(a)}catch(s){return yield S(s,i.s,i.q.ProcessImage)}}))).apply(this,arguments)}function C(e,n,t){return P.apply(this,arguments)}function P(){return(P=p((function*(e,n,t){try{var r=m(n,i.u.processControls),a=yield o.f.post(r,{input:e,config:t});return yield d(a)}catch(s){return yield S(s,i.s,i.q.ProcessControls)}}))).apply(this,arguments)}function _(e,n,t){return A.apply(this,arguments)}function A(){return(A=p((function*(e,n,t){try{var r=m(t,i.u.createAppFromImage),a=yield o.f.post(r,{input:e,config:n});return yield d(a)}catch(s){return yield S(s,i.s,i.q.CreateAppFromImage)}}))).apply(this,arguments)}function b(e,n){return h.apply(this,arguments)}function h(){return(h=p((function*(e,n){try{var t=m(n,i.u.createAppFromFigma),r=yield o.f.post(t,e);return yield v(r)}catch(a){return yield S(a,i.r,i.q.CreateAppFromFigma)}}))).apply(this,arguments)}var I=e=>{var n,t="",r="",a=!0,i=e.match(/^http[s]?:\/\/www.figma.com\/file\/(\w+)/i);if(!i||i.length<2)return{invalidUrl:a,fileId:t,nodeId:r};a=!1,t=i[1];var o=new URL(e);return{invalidUrl:a,fileId:t,nodeId:r=(null!==(n=new URLSearchParams(o.search))&&void 0!==n?n:"").get("node-id")}};function N(e,n){return y.apply(this,arguments)}function y(){return(y=p((function*(e,n){var t=!1,s=[];if(!e||!n)return Object(r.W)(i.r,{eventData:{message:"empty figma link url or personal access token",status:-1},eventName:i.q.ValidateLinkAndToken}),{status:-1,loading:t,nodeDataSet:s};try{var u,{invalidUrl:c,fileId:l,nodeId:p}=I(e);if(c)return Object(r.W)(i.r,{eventData:{message:"invalid figma link url",status:404},eventName:i.q.ValidateLinkAndToken}),{status:404,loading:t,nodeDataSet:s};if(!l||!p)return Object(r.W)(i.r,{eventData:{message:"empty file or node id as a not found",status:404},eventName:i.q.ValidateLinkAndToken}),{status:404,loading:t,nodeDataSet:s};var d=200,E="".concat("https://api.figma.com/v1/files","/").concat(l,"/nodes?ids=").concat(p),v=yield o.f.get(E,{headers:{"X-FIGMA-TOKEN":n}}),f=null===(u=v.data)||void 0===u?void 0:u.nodes;if(v.status>=400)d=v.status,Object(r.W)(i.r,{eventData:{figmaResponse:f,message:"valid link with empty nodes returned",status:d},eventName:i.q.ValidateLinkAndToken});else if(f){var S=!1;for(var g in f){if(!f[g]){S=!0;break}var O=f[g].document;if("CANVAS"===O.type)O.children.forEach(e=>{if("FRAME"===e.type){var n=e.absoluteBoundingBox;s.push({id:e.id,name:e.name,layout:n?n.width/n.height>=.9?a.c.Tablet:a.c.Phone:void 0})}}),s.reverse();else if("FRAME"===O.type){var m=O.absoluteBoundingBox;s=[{id:O.id,name:O.name,layout:m?m.width/m.height>=.9?a.c.Tablet:a.c.Phone:void 0}]}}S&&(d=404,Object(r.W)(i.r,{eventData:{message:"at least one node contains no data",status:d},eventName:i.q.ValidateLinkAndToken}))}else d=404,Object(r.W)(i.r,{eventData:{message:"empty node returned",status:d},eventName:i.q.ValidateLinkAndToken});return-1!==d&&d<400&&(t=!0,Object(r.W)(i.r,{eventData:{message:"figma link and assess token validation was successful",status:d},eventName:i.q.ValidateLinkAndToken})),{status:d,loading:t,nodeDataSet:s}}catch(R){var T=Object(r.p)(R);return Object(r.U)(i.r,{eventData:T,eventName:i.q.ValidateLinkAndToken}),{status:-1,loading:t,nodeDataSet:s}}}))).apply(this,arguments)}function k(e,n,t){return D.apply(this,arguments)}function D(){return(D=p((function*(e,n,t){var a="";try{var s,u,c,l="https://pa-rp//providers/Microsoft.PowerApps/environments/".concat(n,"/validateAppDisplayName?api-version=2020-06-01"),p={displayName:e},d=yield o.f.post(l,JSON.stringify(p),{headers:{"Content-Type":"application/json"}});if(d.data.validationStatus!==i.a[i.a.Available])a=null!==(s=null==d||null===(u=d.data)||void 0===u||null===(c=u.error)||void 0===c?void 0:c.message)&&void 0!==s?s:"";return a}catch(v){var E=Object(r.p)(v);return Object(r.U)(t,{eventData:E,eventName:i.q.CheckAppNameExists}),a}}))).apply(this,arguments)}function L(e,n,t){return w.apply(this,arguments)}function w(){return(w=p((function*(e,n,t){var a=[],s=!1;try{var{fileId:u}=I(e),c={};for(var l of t)c[l.id]=l.name;var p=t.map(e=>e.id).join(","),d="".concat("https://api.figma.com/v1/images","/").concat(u,"?ids=").concat(p,"&format=svg"),E=(yield o.f.get(d,{headers:{"X-FIGMA-TOKEN":n}})).data;if(E.err)s=!0;else for(var v in E.images)E.images[v]&&a.push({imageUrl:E.images[v],name:c[v]});return Object(r.W)(i.r,{eventData:{message:"get figma preview images successfully",figmaResponseError:E.err},eventName:i.q.GetPreviewImage}),{previewDataSet:a,hasError:s}}catch(S){var f=Object(r.p)(S);return Object(r.U)(i.r,{eventData:f,eventName:i.q.GetPreviewImage}),{previewDataSet:a,hasError:s=!0}}}))).apply(this,arguments)}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/454.3ebb34e8.chunk.js.map
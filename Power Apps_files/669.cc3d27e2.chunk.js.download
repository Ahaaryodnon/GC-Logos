/*! For license information please see 669.cc3d27e2.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[669],{37570:function(e,t,a){"use strict";a.d(t,"a",(function(){return $}));var i=a(10926),n=a.n(i),o=a(23331),r=a(23061),l=a(24178),u=a(24169),s=a(12139),c=a(23716),d=a(10929),m=a(37571),p=a(37573),b=a(37587),v=a(37593),f=a(37594),y=a(24037),g=a(24166),h=a(37574),O=a(12353),C=a(37595),N=a(37616),T=a(37617),j=a(11465),S=a(37618),D=a(37619),E=a(37620),L=a(37572),P=a(11021),w=a(37611),A=a(12219),M=a(37586),V=a(37624),I=a(17427),R=a(37628),x=a(37629),F=a(14421),k=a(37592),z=a(37630),U=a(11624),B=a(11629),W=a(11708),G=a(11824),H=a(11823),q=a(37631),_=a(37632),Z=[],J=Object(S.a)();Object(g.a)();var K={ids:[],indexes:[]};var X=Object(d.db)({container:{minWidth:"1px",margin:"0 24px",selectors:{"@media (max-width: 479px)":{overflowX:"auto"}}},header:{display:"flex",justifyContent:"space-between",width:"100%",paddingRight:"16px",paddingLeft:"6px"},grid:{selectors:{"@media (min-width: 480px)":{minWidth:"1px"}}}}),$=Object(I.b)(Object(j.s)("PowerTableInMemoryDesigner")((function(e){var t,a,{table:i,blockUi:d,telemetryClient:g,solutionContext:j,configurationType:S,useFirstRowAsColumnHeaders:I,setUseFirstRowAsColumnHeaders:$,isLoading:Q,onUpdate:Y,dataPayloadFormat:ee=h.b.Dataverse,classNames:te,t:ae,validationErrorAutoFixer:ie,shouldSkipApiAndUseDevEnvironmentDefaults:ne}=e,{agGridLocalizedStrings:oe}=Object(T.a)({createFieldDisabled:S===h.a.ConversationalReadOnly}),re=n.a.useMemo(()=>new c.b({localizedStrings:oe.customizerLocalizedStrings}),[oe]),[le,ue]=n.a.useState(1),[se,ce]=n.a.useState(void 0),[de,me]=n.a.useState(void 0),[pe,be]=n.a.useState(void 0),[ve,fe]=n.a.useState(K),[ye,ge]=n.a.useState(void 0),[he,Oe]=n.a.useState(void 0),[Ce,Ne]=n.a.useState(void 0),[Te,je]=n.a.useState(!0),[Se,De]=n.a.useState(void 0),[Ee,Le]=n.a.useState({errorMessages:Z,hasDataErrors:!1,hasMetadataErrors:!1}),[Pe,we]=n.a.useState({}),[Ae,Me]=n.a.useState(!1),Ve=n.a.useState(J),[Ie,Re]=Ve,xe=n.a.useRef(void 0);xe.current=Ie;var Fe=n.a.useRef(void 0);Fe.current=se;var{currentEnvironment:ke}=Object(A.W)(),ze=Object(M.a)(ke),{data:Ue,error:Be,isInitialLoading:We}=Object(D.a)({languageCode:ze,getMetadataClient:e.getMetadataClient},ne);n.a.useRef(void 0).current=Ue;var{data:Ge,error:He,isInitialLoading:qe}=Object(z.a)(ne);n.a.useRef(void 0).current=Ge;var _e=()=>{Object(P.W)(L.b,{eventName:L.a.userActions.confirmationDialog.close,eventData:{type:null==pe?void 0:pe.type}}),be(void 0)},Ze=n.a.useCallback(e=>{Object(P.W)(L.b,{eventName:L.a.userActions.confirmationDialog.open,eventData:{type:null==e?void 0:e.type}}),be(e)},[]),Je=!!he;n.a.useEffect(()=>{ue(e=>e+1)},[Je]);var Ke=n.a.useMemo(()=>new V.a,[]),{isLoadingRelatedEntities:Xe,relatedEntities:$e,relatedEntitiesError:Qe}=Object(R.a)({isLoading:Q,relatedDataSetProvider:Ke,agGridTable:Ie,currentEnvironment:ke},ne),Ye=Be||Se||Qe||He,et=!!Ye,tt=!Te&&!et&&Object(w.b)(S,Ee)&&!!i&&!Xe,at=d||Xe;n.a.useEffect(()=>{Ye&&Object(P.U)(L.b,{eventName:L.a.userActions.load.error,eventData:{configurationType:S}},Ye)},[Ye,S]);var it=n.a.useMemo(()=>{if(!(Te||et||Xe))return Object(N.a)(Ie,$e||[],!!ne)},[Te,et,Xe,Ie,$e,ne]);n.a.useEffect(()=>{null==Y||Y({validationErrors:Ee,canBeSaved:tt,table:it,isLoading:Te,columnDataTypeWasUpdated:Ae})},[Ee,tt,Te,it,Ae]);var nt=n.a.useMemo(()=>{var e,t;return!We&&Ue&&ae&&oe&&!qe&&Ge&&Ke&&null!=j&&null!==(e=j.publisher)&&void 0!==e&&e.customizationPrefix?new C.a({onUpdateRowDataWithoutConversions:e=>{we(e)},onUpdateValidationErrors:e=>{Le(e)},onUpdateAgGridTable:e=>{Re(e)},getAgGridTable:()=>xe.current,getPaGridAPI:()=>Fe.current,onError:e=>{De(e)},formattingSettings:Ue,languageCode:ze,availableLanguages:Ge,configurationType:S,relatedDataSetProvider:Ke,dataPayloadFormat:ee,agGridLocalizedStrings:oe,onOpenConfirmDialog:Ze,t:ae,customizationPrefix:null===(t=j.publisher)||void 0===t?void 0:t.customizationPrefix}):null},[Ze,We,Ue,Ke,ae,Re,ze,Le,oe,S,qe,Ge,ee,null==j||null===(t=j.publisher)||void 0===t?void 0:t.customizationPrefix]);n.a.useEffect(()=>{null==nt||nt.getAgGridValidationProvider().updateState()},[nt,Ie]),n.a.useEffect(()=>{if(Q||!j||!i||!nt)return je(!0),void Re(J);try{nt.loadTable(i)}catch(e){De(e)}finally{je(!1)}},[S,i,Q,Re,j,nt,ee]),n.a.useEffect(()=>{Te||et||null==nt||nt.blockUi(at)},[et,nt,at,Te]),n.a.useEffect(()=>{null==se||se.setRows(Ie.rows)},[se,Ie.rows]);var ot=n.a.useMemo(()=>Ie.columns.filter(e=>!e.isHidden),[Ie.columns]),rt=n.a.useMemo(()=>Ie.columns.filter(e=>e.isHidden),[Ie.columns]),lt=0===ot.length,{gridDivRef:ut}=Object(x.a)({paGridAPI:se}),st=e=>{Object(P.W)(L.b,{eventName:L.a.userActions.tableEditor.open}),Ne({calloutTarget:e})},ct=(e,t)=>{Object(P.W)(L.b,{eventName:L.a.userActions.columnEditor.open,eventData:{isNew:!t}}),Oe({agGridTable:Ie,columnLogicalName:t,calloutTarget:e})},dt=e=>{Object(P.W)(L.b,{eventName:L.a.userActions.addExistingColumns.open,eventData:{}}),ge({calloutTarget:e})};return n.a.createElement(n.a.Fragment,null,n.a.createElement(s.a,{verticalFill:!0},!lt&&!et&&n.a.createElement(s.a.Item,{className:null==te?void 0:te.commandBarWrapper},n.a.createElement(b.a,{agGridTable:Ie,shouldSkipApiAndUseDevEnvironmentDefaults:ne,rowSelection:ve,agGridRuntimeProvider:nt,onOpenAddColumnCallout:ct,onOpenTableEditorCallout:st,configurationType:S,isLoading:Te,blockUi:at,className:null==te?void 0:te.commandBarControl,onOpenConfirmDialog:Ze})),n.a.createElement(s.a.Item,null,n.a.createElement(_.a,{onMessageBarReady:e=>{me(e)}})),!et&&n.a.createElement(s.a.Item,{style:{paddingBottom:20}},n.a.createElement(m.a,{isVisible:ye,setIsVisible:ge,onUpdate:e=>{null==nt||nt.setVisibleOrderedColumns(e)},columns:Te?Z:Ie.columns}),n.a.createElement("div",{className:X.header},n.a.createElement("div",{style:{width:"100%"}},n.a.createElement(E.a,{agGridTable:Ie,isVisible:Ce,setIsVisible:Ne,updateTableMetadata:(e,t)=>{null==nt||nt.updateTableMetadata(e,t)},shouldSkipApiAndUseDevEnvironmentDefaults:ne,upsertColumn:e=>{null==nt||nt.upsertColumn({autoNumber:!0,isHidden:!0,relationships:!0},e.LogicalName,e,!!at)},target:null==Ce?void 0:Ce.calloutTarget,isLoading:Te,isReadOnly:S===h.a.ConversationalReadOnly}),n.a.createElement(f.a,{agGridTable:Ie,blockUi:at,isReadOnly:S===h.a.ConversationalReadOnly,isLoading:Te,isTableEditorCalloutVisible:!!Ce,onOpenTableEditorCallout:st})),n.a.createElement(s.a,{styles:{root:{width:"100%"}}},n.a.createElement(s.a.Item,{align:"end"},n.a.createElement(s.a,{horizontal:!0},n.a.createElement(s.a.Item,null,S===h.a.ImportExcel&&n.a.createElement(F.a,{styles:{root:{display:"flex"},container:{padding:"5px 10px 5px 5px"}},disabled:at||Te,label:ae("actions.useFirstRowAsColumnHeaders"),checked:I,onChange:(e,t)=>null==$?void 0:$(t||!1)})))),n.a.createElement(s.a.Item,{align:"end"},n.a.createElement(v.a,{errorMessages:Ee.errorMessages,validationErrorAutoFixer:ie})))),pe&&n.a.createElement(U.a,{hidden:!1,dialogContentProps:{type:B.a.normal,title:pe.title,subText:pe.subText,showCloseButton:!1},onDismiss:_e,modalProps:{isBlocking:!0}},n.a.createElement(W.a,null,n.a.createElement(G.a,{text:pe.defaultButtonText,onClick:()=>{pe.onConfirm(),_e()}}),n.a.createElement(H.a,{text:pe.primaryButtonText,onClick:_e}))),n.a.createElement(q.a,{key:le,onError:e=>{null==de||de.appendError(ae("common.request.failed")),Oe(void 0)}},n.a.createElement(p.a,{configurationType:S,isVisible:he,entitySchemaName:null==Ie||null===(a=Ie.metadata)||void 0===a?void 0:a.SchemaName,shouldSkipApiAndUseDevEnvironmentDefaults:ne,setIsVisible:Oe,isColumnSchemaNameDuplicated:(e,t)=>Object(w.c)(Ie,e,t),isLookupSchemaNameDuplicated:(e,t)=>Object(w.d)(Ie,e,t),upsertColumn:(e,t,a,i)=>{null==nt||nt.upsertColumn({autoNumber:!1,isHidden:!0,relationships:!1},e,t,at,a,i)},columnUpdated:e=>{e&&Me(!0)},solutionContext:j,rowDataWithoutConversions:Pe}))),!lt&&!et&&n.a.createElement(s.a.Item,{verticalFill:!0},n.a.createElement(s.a,{verticalFill:!0,horizontal:!0,tokens:{childrenGap:0},className:X.container,horizontalAlign:"start"},n.a.createElement(s.a.Item,{verticalFill:!0,shrink:!0,className:X.grid},n.a.createElement("div",{style:{width:"100%",height:"100%"},ref:ut},n.a.createElement(o.a,{onColumnSort:O.noop,cellCustomization:re,onGridReady:e=>{ce(e)},onColumnEdit:(e,t)=>{ct(t,e)},onColumnInsert:(e,t)=>{ct(t)},onColumnMoved:(e,t)=>{null==nt||nt.moveColumn(e,t)},onSelectionChanged:(e,t)=>{var a=e.findIndex(e=>{var t;return null===(t=e.params)||void 0===t?void 0:t.isLastRow});fe({ids:e.map(e=>e[r.k]).filter(t=>{var i;return t!==(null===(i=e[a])||void 0===i?void 0:i[r.k])}),indexes:t.filter(e=>e!==a)})},onCellValueChanged:(e,t,a)=>{null==nt||nt.updateCellValue(t[r.k],e.name,a)},rowSelection:Object(k.a)(S)?"none":"multiple",enableStatusColumn:!0,allowColumnMoving:!at&&!Object(k.a)(S)&&!Te,paddingRight:0,statusColumn:Object(k.a)(S)?"hidden":"pinned",statusColumnWidth:"wide",columns:ot,telemetryClient:g,useEditableStyles:!Object(k.a)(S),allowTabKeyNavigation:!0,domLayout:"normal",useSkinnyScrollbars:!0,ensureDomOrder:!0}))),!Object(k.a)(S)&&n.a.createElement(s.a.Item,{grow:!0,shrink:!1,style:{display:"flex"}},n.a.createElement(u.b,{disabled:at||Te,onAddColumnClick:e=>{ct(e)},onShowHideColumnsButtonClick:e=>{dt(e)},hiddenColumnsCount:rt.length})))),n.a.createElement(s.a.Item,null,n.a.createElement(l.a,{showNoDataViewPermissionEmptyState:!1,showNoColumnEmptyState:lt,createFieldDisabled:at||Object(k.a)(S)||Te,viewMode:y.a.Page,theme:void 0,showDataLoadErrorEmptyState:!!Ye,metadataLoadError:Ye,dataLoadExtendedError:void 0,canCreateColumn:!at&&!Object(k.a)(S)&&!Te,exploreColumnDetailsOnClick:O.noop,newColumnOnClick:e=>{ct(e)},onAddExistingColumnsClick:e=>{dt(e)},styleOptions:{placeInline:!0}}))))})))},37571:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var i=a(10926),n=a.n(i),o=a(24044),r=a(11021),l=a(37572),u=a(23285),s=e=>{var{isVisible:t,setIsVisible:a,columns:i,onUpdate:s}=e;return n.a.createElement(o.b,{calloutTarget:null==t?void 0:t.calloutTarget,isShowingHidingColumns:!!t,closeShowHideColumns:()=>{Object(r.W)(l.b,{eventName:l.a.userActions.addExistingColumns.close}),a(void 0)},onUpdate:s,columnsMetadata:i.map(e=>({logicalName:e.field.LogicalName,displayName:e.field.DisplayName.LocalizedLabels[0].Label,isPrimaryName:e.field.IsPrimaryName,requiredLevel:e.field.RequiredLevel.Value})),columnsUIState:i.map(e=>({isHidden:e.isHidden,logicalName:e.field.LogicalName,iconName:Object(u.b)(e.designerField),canHideColumn:!0}))})}},37572:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return n}));var i="powertable-inmemory-designer",n={runtimeProvider:{loadTable:"runtimeProvider/loadTable",addEmptyRow:"runtimeProvider/addEmptyRow",addEmptyRowAt:"runtimeProvider/addEmptyRowAt",deleteRows:"runtimeProvider/deleteRows",deleteColumn:"runtimeProvider/deleteColumn",upsertColumn:"runtimeProvider/upsertColumn",hideColumn:"runtimeProvider/hideColumn",setVisibleOrderedColumns:"runtimeProvider/setVisibleOrderedColumns",setIsBlocked:"runtimeProvider/setIsBlocked",moveColumn:"runtimeProvider/moveColumn",updateTableMetadata:"runtimeProvider/updateTableMetadata",updateCellValue:"runtimeProvider/updateCellValue"},cdsApiUtilities:{persistTable:"cdsApiUtilities/persistTable",preValidateTable:"cdsApiUtilities/preValidateTable",deleteEntityError:"cdsApiUtilities/deleteEntityError",persistTableError:"cdsApiUtilities/persistTableError",updateEntityFormAndViewError:"cdsApiUtilities/updateEntityFormAndViewError",createEntity:"cdsApiUtilities/createEntity",createEntityAndData:"cdsApiUtilities/createEntityAndData",createRow:"cdsApiUtilities/createRow",createRelationship:"cdsApiUtilities/createRelationship",createCustomerRelationship:"cdsApiUtilities/createCustomerRelationship",createAutoNumberSeed:"cdsApiUtilities/createAutoNumberSeed",updateFormsAndViews:"cdsApiUtilities/updateFormsAndViews",getSolution:"cdsApiUtilities/getSolution"},errorBoundaray:{hasError:"errorBoundaray/hasError"},apiCallEmulator:{applyApiColumnUpdates:"apiCallEmulator/applyApiColumnUpdates"},validationProvider:{validateCell:"validationProvider/validateCell",validateTable:"validationProvider/validateTable"},relatedDataSetProvider:{getEntityMetadata:{error:"relatedDataSetProvider/getEntityMetadata/error"},getEntityData:{error:"relatedDataSetProvider/getEntityData/error"}},userActions:{addExistingColumns:{open:"userActions/addExistingColumns/open",close:"userActions/addExistingColumns/close"},confirmationDialog:{open:"userActions/confirmationDialog/open",close:"userActions/confirmationDialog/close"},columnEditor:{open:"userActions/columnEditor/open",close:"userActions/columnEditor/close"},tableEditor:{open:"userActions/tableEditor/open",close:"userActions/tableEditor/close"},loadData:{begin:"userActions/load/begin"},load:{error:"userActions/load/error"}},sampleDataProcessor:{cleanUpInvalidSampleData:"sampleDataProcessor/cleanUpInvalidSampleData"}}},37573:function(e,t,a){"use strict";a.d(t,"a",(function(){return C}));var i=a(10926),n=a.n(i),o=a(37574),r=a(12353),l=a(37576),u=a(37577),s=a(12219),c=a(37586),d=a(11885),m=a(11883),p=a(19360),b=a(11021),v=a(37572),f=a(19448),y=a(19333);function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){O(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function O(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var C=e=>{var t,a,i,f,g,O,C,P,w,A,M,V,I,R,x,F,{isVisible:k,setIsVisible:z,entitySchemaName:U,upsertColumn:B,columnUpdated:W,solutionContext:G,configurationType:H,shouldSkipApiAndUseDevEnvironmentDefaults:q,rowDataWithoutConversions:_}=e,{currentEnvironment:Z}=Object(s.W)(),J=Object(c.a)(Z),K=n.a.useMemo(()=>{var e;return null!=k&&k.columnLogicalName?null==k||null===(e=k.agGridTable)||void 0===e?void 0:e.columns.find(e=>e.name===(null==k?void 0:k.columnLogicalName)):null},[k]),X=n.a.useMemo(()=>{var e;return null!=k&&k.columnLogicalName?null==k||null===(e=k.agGridTable)||void 0===e?void 0:e.manyToOneRelationships.filter(e=>{var t;return e.relationship.ReferencingEntity===(null==k||null===(t=k.agGridTable)||void 0===t?void 0:t.metadata.LogicalName)&&e.relationship.ReferencingAttribute===(null==k?void 0:k.columnLogicalName)}):null},[k]),$=n.a.useMemo(()=>{if(K&&null!=k&&k.columnLogicalName)return function(e,t,a){var i,n,o,r,u,s,c,d,p;if(e.OptionSet){var b,v,f,g,h,O,C=e.OptionSet;C.Options&&(g=C.Options.map(e=>j(e))),e.OptionSet.TrueOption&&(h=j(e.OptionSet.TrueOption)),e.OptionSet.FalseOption&&(O=j(e.OptionSet.FalseOption)),p={name:C.Name,displayName:(null===(b=C.DisplayName.UserLocalizedLabel)||void 0===b?void 0:b.Label)||"",description:(null===(v=C.Description.UserLocalizedLabel)||void 0===v?void 0:v.Label)||"",isCustomizable:!(null===(f=C.IsCustomizable)||void 0===f||!f.Value),isCustomOptionSet:C.IsCustomOptionSet,isGlobal:C.IsGlobal,isManaged:C.IsManaged,introducedVersion:C.IntroducedVersion,externalTypeName:C.ExternalTypeName,options:g,trueOption:h,falseOption:O,optionSetType:C.OptionSetType,isBoolean:!(!h&&!O)}}var N=null;e.AttributeType===m.j.Picklist?N=e.DefaultFormValue:e.AttributeType===m.j.Boolean&&(N=e.DefaultValue?1:0);var T,S,D,E=[];if(e.AttributeType===m.j.Lookup){var L;E=e.Targets,T=null==a||null===(L=a[0])||void 0===L?void 0:L.SchemaName}if(e.AttributeType===m.j.Customer){var P,w,A,M;S=null==a||null===(P=a.filter(e=>e.ReferencedEntity===Object(l.j)(y.a)))||void 0===P||null===(w=P[0])||void 0===w?void 0:w.SchemaName,D=null==a||null===(A=a.filter(e=>e.ReferencedEntity===Object(l.j)(y.b)))||void 0===A||null===(M=A[0])||void 0===M?void 0:M.SchemaName}return{schemaName:e.SchemaName,displayName:(null===(i=e.DisplayName.UserLocalizedLabel)||void 0===i?void 0:i.Label)||"",externalName:e.ExternalName,attributeType:e.AttributeType,attributeTypeName:e.AttributeTypeName.Value,format:e.Format,formatName:null===(n=e.FormatName)||void 0===n?void 0:n.Value,description:null===(o=e.Description.UserLocalizedLabel)||void 0===o?void 0:o.Label,requiredLevel:e.RequiredLevel.Value,isValidForAdvancedFind:null===(r=e.IsValidForAdvancedFind)||void 0===r?void 0:r.Value,isSecured:e.IsSecured,isAuditEnabled:null===(u=e.IsAuditEnabled)||void 0===u?void 0:u.Value,isGlobalFilterEnabled:null===(s=e.IsGlobalFilterEnabled)||void 0===s?void 0:s.Value,isSortableEnabled:null===(c=e.IsSortableEnabled)||void 0===c?void 0:c.Value,sourceType:e.SourceType,maxLength:e.MaxLength,imeMode:e.ImeMode,autoNumberFormat:e.AutoNumberFormat,autoNumberSeed:t,defaultFormValue:N,choice:p,isPrimaryImage:e.IsPrimaryImage,canStoreFullImage:e.CanStoreFullImage,maxSizeInKB:e.MaxSizeInKB,maxValue:e.MaxValue,minValue:e.MinValue,precisionSource:e.PrecisionSource,precision:e.Precision,dateTimeBehavior:null===(d=e.DateTimeBehavior)||void 0===d?void 0:d.Value,formulaDefinition:e.FormulaDefinition,targets:E,isPrimaryName:e.IsPrimaryName,oneToManyRelationshipName:T,accountRelationshipName:S,contactRelationshipName:D}}(Object(r.cloneDeep)(K.field),null==k?void 0:k.autoNumberSeed,Object(r.cloneDeep)(null==X?void 0:X.map(e=>e.relationship)))},[k,K,X]);return n.a.createElement(u.a,{focusTrapCalloutTarget:null==k?void 0:k.calloutTarget,isStagedData:!0,solutionId:null==G?void 0:G.id,onDismiss:(e,t,a)=>{if(Object(b.W)(v.b,{eventName:v.a.userActions.columnEditor.close,eventData:{dataWasUpdated:e,columnDataTypeWasUpdated:t}}),e&&null!=a&&a.columnToBeCreated||null!=a&&a.relationshipToBeCreated){var i,n,o=function(e,t,a,i,n){if(null!=e&&e.attributeType)switch(null==e?void 0:e.attributeType){case m.j.String:return function(e,t,a){return{column:h(h({},L(e,t,a)),{},{AttributeType:m.j.String,AttributeTypeName:{Value:d.e.StringType},ImeMode:e.imeMode,MaxLength:e.maxLength,FormatName:{Value:e.formatName},Format:e.format,AutoNumberFormat:e.autoNumberFormat?e.autoNumberFormat:null})}}(e,a,i);case m.j.Memo:return function(e,t,a){return{column:h(h({},L(e,t,a)),{},{AttributeType:m.j.Memo,AttributeTypeName:{Value:d.e.MemoType},ImeMode:e.imeMode,MaxLength:e.maxLength,FormatName:{Value:e.formatName},Format:e.format,AutoNumberFormat:e.autoNumberFormat||null})}}(e,a,i);case m.j.Double:return function(e,t,a){return{column:h(h({},L(e,t,a)),{},{AttributeType:m.j.Double,AttributeTypeName:{Value:d.e.DoubleType},ImeMode:e.imeMode,MaxValue:e.maxValue,MinValue:e.minValue,Precision:e.precision})}}(e,a,i);case m.j.Decimal:return function(e,t,a){return{column:h(h({},L(e,t,a)),{},{AttributeType:m.j.Decimal,AttributeTypeName:{Value:d.e.DecimalType},ImeMode:e.imeMode,MaxValue:e.maxValue,MinValue:e.minValue,Precision:e.precision})}}(e,a,i);case m.j.Integer:return function(e,t,a){e.format===m.s.Duration||e.format===m.s.Language?(e.maxValue||(e.maxValue=p.o),e.minValue||(e.minValue=0)):e.format===m.s.TimeZone&&(e.maxValue||(e.maxValue=1500),e.minValue||(e.minValue=-1500));return{column:h(h({},L(e,t,a)),{},{AttributeType:m.j.Integer,AttributeTypeName:{Value:d.e.IntegerType},MaxValue:e.maxValue,MinValue:e.minValue,Format:e.format})}}(e,a,i);case m.j.BigInt:return function(e,t,a){return{column:h(h({},L(e,t,a)),{},{AttributeType:m.j.BigInt,AttributeTypeName:{Value:d.e.BigIntType},MaxValue:e.maxValue,MinValue:e.minValue})}}(e,a,i);case m.j.DateTime:return function(e,t,a){return{column:h(h({},L(e,t,a)),{},{AttributeType:m.j.DateTime,AttributeTypeName:{Value:d.e.DateTimeType},ImeMode:e.imeMode,Format:e.format,DateTimeBehavior:{Value:e.dateTimeBehavior},CanChangeDateTimeBehavior:{Value:!0,CanBeChanged:!0,ManagedPropertyLogicalName:"canmodifybehavior"}})}}(e,a,i);case m.j.Picklist:return function(e,t,a){return{column:h(h(h({},L(e,t,a)),S(e,t,a,!1)),{},{AttributeType:m.j.Picklist,AttributeTypeName:{Value:d.e.PicklistType}})}}(e,a,i);case m.j.Virtual:if(e.attributeTypeName===d.e.MultiSelectPicklistType)return function(e,t,a){return{column:h(h({},S(e,t,a,!0)),{},{AttributeType:m.j.Virtual,AttributeTypeName:{Value:d.e.MultiSelectPicklistType}})}}(e,a,i);if(e.attributeTypeName===d.e.FileType)return function(e,t,a){return{column:h(h({},L(e,t,a)),{},{AttributeType:m.j.Virtual,AttributeTypeName:{Value:d.e.FileType},MaxSizeInKB:e.maxSizeInKB})}}(e,a,i);if(e.attributeTypeName===d.e.ImageType)return function(e,t,a){return{column:h(h({},L(e,t,a)),{},{AttributeType:m.j.Virtual,AttributeTypeName:{Value:d.e.ImageType},MaxSizeInKB:e.maxSizeInKB,CanStoreFullImage:e.canStoreFullImage,IsPrimaryImage:e.isPrimaryImage})}}(e,a,i);throw new Error("not supported");case m.j.Boolean:return function(e,t,a){var i,n,o,r,l,u,s,c;return{column:h(h({},L(e,t,a)),{},{AttributeType:m.j.Boolean,AttributeTypeName:{Value:d.e.BooleanType},DefaultValue:1===e.defaultFormValue,OptionSet:{IsCustomOptionSet:null===(i=e.choice)||void 0===i?void 0:i.isCustomOptionSet,IsGlobal:null===(n=e.choice)||void 0===n?void 0:n.isGlobal,IsCustomizable:{Value:!0,CanBeChanged:!1,ManagedPropertyLogicalName:"iscustomizable"},IsManaged:!1,ExternalTypeName:null===(o=e.choice)||void 0===o?void 0:o.externalTypeName,OptionSetType:null===(r=e.choice)||void 0===r?void 0:r.optionSetType,Description:{LocalizedLabels:[{Label:null===(l=e.choice)||void 0===l?void 0:l.description,LanguageCode:t}]},DisplayName:{LocalizedLabels:[{Label:null===(u=e.choice)||void 0===u?void 0:u.displayName,LanguageCode:t}]},TrueOption:D(null===(s=e.choice)||void 0===s?void 0:s.trueOption,t,!0),FalseOption:D(null===(c=e.choice)||void 0===c?void 0:c.falseOption,t,!0)}})}}(e,a,i);case m.j.Money:return function(e,t,a){return{column:h(h({},L(e,t,a)),{},{AttributeType:m.j.Money,AttributeTypeName:{Value:d.e.MoneyType},ImeMode:e.imeMode,MaxValue:e.maxValue,MinValue:e.minValue,PrecisionSource:e.precisionSource,Precision:e.precision||p.g,IsBaseCurrency:!1})}}(e,a,i);default:throw new Error("not supported")}if(null!=t&&t.lookupColumn)switch(null==t?void 0:t.lookupColumn.attributeType){case m.j.Lookup:return function(e,t,a,i){var n;return{column:h(h({},L(null==e?void 0:e.lookupColumn,t,a)),{},{AttributeType:m.j.Lookup,AttributeTypeName:{Value:d.e.LookupType},Targets:[null===(n=e.oneToManyRelationship)||void 0===n?void 0:n.referencedEntity]}),manyToOneRelationships:[E(e.oneToManyRelationship,null==e?void 0:e.lookupColumn.schemaName,i,!1)]}}(t,a,i,n);case m.j.Customer:return function(e,t,a,i){var n,o,r=h(h({},L(null==e?void 0:e.lookupColumn,t,a)),{},{AttributeType:m.j.Customer,AttributeTypeName:{Value:d.e.CustomerType},Targets:[null===(n=e.accountRelationship)||void 0===n?void 0:n.referencedEntity,null===(o=e.contactRelationship)||void 0===o?void 0:o.referencedEntity]});return{column:r,manyToOneRelationships:[E(e.accountRelationship,r.SchemaName,i,!0),E(e.contactRelationship,r.SchemaName,i,!0)]}}(t,a,i,n);default:throw new Error("not supported")}throw new Error("not supported")}(a.columnToBeCreated,a.relationshipToBeCreated,J,!(null==K||!K.field.IsPrimaryName),U);o.column=Object(l.c)(o.column,U,J),o.manyToOneRelationships=null===(i=o.manyToOneRelationships)||void 0===i?void 0:i.map(l.e),B(null==K?void 0:K.field.LogicalName,o.column,null==a||null===(n=a.columnToBeCreated)||void 0===n?void 0:n.autoNumberSeed,o.manyToOneRelationships),W(t)}z(void 0)},showCallout:!!k,stagedConfigurationType:T(H),isReadOnlyMode:H===o.a.ConversationalReadOnly,columnDetails:$,tableDetails:{displayName:(null==k||null===(t=k.agGridTable)||void 0===t||null===(a=t.metadata)||void 0===a||null===(i=a.DisplayName)||void 0===i||null===(f=i.UserLocalizedLabel)||void 0===f?void 0:f.Label)||"",schemaName:(null==k||null===(g=k.agGridTable)||void 0===g||null===(O=g.metadata)||void 0===O?void 0:O.SchemaName)||"",isCustomizable:null==k||null===(C=k.agGridTable)||void 0===C||null===(P=C.metadata)||void 0===P||null===(w=P.IsCustomizable)||void 0===w?void 0:w.Value,isManaged:null==k||null===(A=k.agGridTable)||void 0===A||null===(M=A.metadata)||void 0===M?void 0:M.IsManaged,isAuditEnabled:null==k||null===(V=k.agGridTable)||void 0===V||null===(I=V.metadata)||void 0===I||null===(R=I.IsAuditEnabled)||void 0===R?void 0:R.Value,tableType:null==k||null===(x=k.agGridTable)||void 0===x||null===(F=x.metadata)||void 0===F?void 0:F.TableType},shouldSkipApiAndUseDevEnvironmentDefaults:q,isSchemaNameDuplicated:t=>e.isColumnSchemaNameDuplicated(null==K?void 0:K.field.SchemaName,t),isLookupSchemaNameDuplicated:t=>e.isLookupSchemaNameDuplicated(null==$?void 0:$.oneToManyRelationshipName,t),isAccountRelationshipSchemaNameDuplicated:t=>e.isLookupSchemaNameDuplicated(null==$?void 0:$.accountRelationshipName,t),isContactRelationshipSchemaNameDuplicated:t=>e.isLookupSchemaNameDuplicated(null==$?void 0:$.contactRelationshipName,t),dataRows:_&&null!=K&&K.field.LogicalName?N(_,Object(l.j)(null==K?void 0:K.field.SchemaName)):void 0})};function N(e,t){return Object.values(e).map(e=>{var a;return null===(a=e[t])||void 0===a?void 0:a.formatted}).filter(e=>null!=e)}function T(e){switch(e){case o.a.Blank:return f.a.Blank;case o.a.ImportExcel:return f.a.ImportExcel;case o.a.ConversationalReadOnly:case o.a.ConversationalReadWrite:return f.a.Conversational;case o.a.ImportFromConnector:return f.a.ImportFromConnector;default:return}}function j(e){var t,a,i;return{label:(null===(t=e.Label.UserLocalizedLabel)||void 0===t?void 0:t.Label)||"",value:e.Value,description:null===(a=e.Description)||void 0===a||null===(i=a.UserLocalizedLabel)||void 0===i?void 0:i.Label,externalValue:e.ExternalValue,color:e.Color,hasChanged:e.HasChanged,state:e.State,defaultStatus:e.DefaultStatus}}function S(e,t,a,i){var n,o,r,l,u,s,c,d;return h(h({},L(e,t,a)),{},{DefaultFormValue:e.defaultFormValue,OptionSet:{DisplayName:{LocalizedLabels:[{Label:null===(n=e.choice)||void 0===n?void 0:n.displayName,LanguageCode:t}]},Options:null===(o=e.choice)||void 0===o||null===(r=o.options)||void 0===r?void 0:r.map(e=>D(e,t,!1)),OptionSetType:null===(l=e.choice)||void 0===l?void 0:l.optionSetType,IsCustomOptionSet:null===(u=e.choice)||void 0===u?void 0:u.isCustomOptionSet,IsCustomizable:i?void 0:{Value:!0,CanBeChanged:!1,ManagedPropertyLogicalName:"iscustomizable"},Description:{LocalizedLabels:[{Label:null===(s=e.choice)||void 0===s?void 0:s.description,LanguageCode:t}]},IsGlobal:null===(c=e.choice)||void 0===c?void 0:c.isGlobal,ExternalTypeName:null===(d=e.choice)||void 0===d?void 0:d.externalTypeName}})}function D(e,t,a){var i={Value:e.value,Label:{LocalizedLabels:[{Label:e.label,LanguageCode:t}]},Color:e.color||void 0,IsManaged:!1,ExternalValue:e.externalValue||""};return i.Description={LocalizedLabels:a?[]:[{Label:e.description||"",LanguageCode:t}]},i}function E(e,t,a,i){return{SchemaName:null==e?void 0:e.schemaName,ReferencingEntity:Object(l.j)(a),ReferencingAttribute:Object(l.j)(t),ReferencedEntity:null==e?void 0:e.referencedEntity,RelationshipType:d.t.OneToManyRelationship,ReferencingEntityNavigationPropertyName:i?t+"_"+(null==e?void 0:e.referencedEntity):t,IsCustomRelationship:!0,IsValidForAdvancedFind:!0,IsCustomizable:{Value:!0,CanBeChanged:!0,ManagedPropertyLogicalName:"iscustomizable"},CascadeConfiguration:{Assign:d.g.NoCascade,Delete:d.g.RemoveLink,Merge:d.g.NoCascade,Reparent:d.g.NoCascade,Share:d.g.NoCascade,Unshare:d.g.NoCascade,RollupView:d.g.NoCascade,Archive:d.g.RemoveLink}}}function L(e,t,a){return{IsPrimaryName:a,IsSecured:e.isSecured||!1,IsValidForRead:!0,IsValidForUpdate:!0,SchemaName:e.schemaName,SourceType:e.sourceType||d.z.Simple,ExternalName:e.externalName||null,Description:{LocalizedLabels:[{Label:e.description||"",LanguageCode:t}]},DisplayName:{LocalizedLabels:[{Label:e.displayName,LanguageCode:t}]},RequiredLevel:{Value:e.requiredLevel}}}},37574:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return n}));a(21528),a(37575),a(11883);var i=function(e){return e.ImportExcel="ImportExcel",e.ConversationalReadOnly="ConversationalReadOnly",e.ConversationalReadWrite="ConversationalReadWrite",e.Blank="Blank",e.ImportFromConnector="ImportFromConnector",e}({}),n=function(e){return e.Dataverse="Dataverse",e.ExcelAndConnectorInference="ExcelAndConnectorInference",e}({})},37575:function(e,t,a){"use strict"},37576:function(e,t,a){"use strict";a.d(t,"f",(function(){return p})),a.d(t,"j",(function(){return b})),a.d(t,"c",(function(){return v})),a.d(t,"g",(function(){return y})),a.d(t,"e",(function(){return g})),a.d(t,"i",(function(){return h})),a.d(t,"d",(function(){return N})),a.d(t,"h",(function(){return T})),a.d(t,"a",(function(){return S})),a.d(t,"b",(function(){return D}));var i=a(13786),n=a(15265),o=a(15249),r=a(24029),l=a(11031),u=a(11885),s=a(11883),c=a(19360),d=a(37572),m=a(11021);function p(e,t){return Object(r.g)(e,t)}function b(e){return e.toLowerCase()}function v(e,t,a){var i,n,o;switch(e.LogicalName=b(e.SchemaName),e.DisplayName||(e.DisplayName={LocalizedLabels:[{Label:"",LanguageCode:a}]}),e.OptionSet&&(e.OptionSet.Name="".concat(t,"_").concat(e.LogicalName),e.OptionSet.DisplayName||(e.OptionSet.DisplayName={LocalizedLabels:[]}),e.OptionSet.DisplayName.LocalizedLabels=e.DisplayName.LocalizedLabels),(e=function(e,t){j(e.Description)&&(e.Description={LocalizedLabels:[{Label:"",LanguageCode:t}]});return e}(e,a)).AttributeType){case s.j.String:e=function(e){var t,a,i,n=e;j(n.AttributeTypeName)&&(n.AttributeTypeName={Value:u.e.StringType});j(n.ImeMode)&&(n.ImeMode=s.r.Auto);j(n.FormatName)&&(n.FormatName={Value:s.J.Text});(null===(t=n.FormatName)||void 0===t?void 0:t.Value)===s.J.TickerSymbol?e.Format=s.J.TickerSymbol:(null===(a=n.FormatName)||void 0===a?void 0:a.Value)===s.J.Url?e.Format=s.J.Url:(null===(i=n.FormatName)||void 0===i?void 0:i.Value)===s.J.Email&&(e.Format=s.J.Email);return n}(e);break;case s.j.Memo:e=function(e){var t=e;j(t.AttributeTypeName)&&(t.AttributeTypeName={Value:u.e.MemoType});j(t.ImeMode)&&(t.ImeMode=s.r.Auto);j(t.MaxLength)&&(t.MaxLength=c.q);j(t.FormatName)&&(t.FormatName={Value:s.J.Text});return t}(e);break;case s.j.Double:e=function(e){var t=e;j(t.ImeMode)&&(t.ImeMode=s.r.Auto);j(t.MaxValue)&&(t.MaxValue=c.h);j(t.MinValue)&&(t.MinValue=c.j);j(t.Precision)&&(t.Precision=c.g);j(t.AttributeTypeName)&&(t.AttributeTypeName={Value:u.e.DoubleType});return t}(e);break;case s.j.Decimal:e=function(e){var t=e;j(t.ImeMode)&&(t.ImeMode=s.r.Auto);j(t.MaxValue)&&(t.MaxValue=c.d);j(t.MinValue)&&(t.MinValue=c.e);j(t.Precision)&&(t.Precision=c.g);j(t.AttributeTypeName)&&(t.AttributeTypeName={Value:u.e.DecimalType});return t}(e);break;case s.j.Integer:e=function(e){var t=e;j(t.MaxValue)&&(t.MaxValue=c.o);j(t.MinValue)&&(t.MinValue=c.p);j(t.Format)&&(t.Format=s.s.None);j(t.AttributeTypeName)&&(t.AttributeTypeName={Value:u.e.IntegerType});return t}(e);break;case s.j.BigInt:e=function(e){var t=e;j(t.MaxValue)&&(t.MaxValue=c.b);j(t.MinValue)&&(t.MinValue=c.c);j(t.AttributeTypeName)&&(t.AttributeTypeName={Value:u.e.BigIntType});return t}(e);break;case s.j.DateTime:e=function(e){var t=e;j(t.ImeMode)&&(t.ImeMode=s.r.Auto);j(t.Format)&&(t.Format=s.n.DateAndTime);j(t.DateTimeBehavior)&&(t.DateTimeBehavior={Value:s.m.UserLocal});j(t.CanChangeDateTimeBehavior)&&(t.CanChangeDateTimeBehavior={Value:!0,CanBeChanged:!0,ManagedPropertyLogicalName:"canmodifybehavior"});j(t.AttributeTypeName)&&(t.AttributeTypeName={Value:u.e.DateTimeType});return t}(e);break;case s.j.Picklist:e=function(e,t){var a=e;j(a.AttributeTypeName)&&(a.AttributeTypeName={Value:u.e.PicklistType});j(a.DefaultFormValue)&&(a.DefaultFormValue=-1);a.OptionSet&&(j(a.OptionSet.IsCustomizable)&&(a.OptionSet.IsCustomizable={Value:!0,CanBeChanged:!1,ManagedPropertyLogicalName:"iscustomizable"}),j(a.OptionSet.Description)&&(a.OptionSet.Description={LocalizedLabels:[{Label:"",LanguageCode:t}]}),a.OptionSet.Options&&a.OptionSet.Options.forEach(e=>{e=f(e)}));return a}(e,a);break;case s.j.Virtual:if((null===(i=e.AttributeTypeName)||void 0===i?void 0:i.Value)===u.e.MultiSelectPicklistType||e["@odata.type"]===c.a.MultiSelectPicklist){e=function(e,t){var a=e;j(a.AttributeTypeName)&&(e.AttributeTypeName={Value:u.e.MultiSelectPicklistType});j(a.DefaultFormValue)&&(a.DefaultFormValue=-1);a.OptionSet&&(j(a.OptionSet.Description)&&(a.OptionSet.Description={LocalizedLabels:[{Label:"",LanguageCode:t}]}),a.OptionSet.Options&&a.OptionSet.Options.forEach(e=>{e=f(e)}));return a}(e,a);break}if((null===(n=e.AttributeTypeName)||void 0===n?void 0:n.Value)===u.e.FileType||e["@odata.type"]===c.a.File){e=function(e){var t=e;j(t.AttributeTypeName)&&(e.AttributeTypeName={Value:u.e.FileType});j(t.MaxSizeInKB)&&(t.MaxSizeInKB=c.m);return t}(e);break}if((null===(o=e.AttributeTypeName)||void 0===o?void 0:o.Value)===u.e.ImageType||e["@odata.type"]===c.a.Image){e=function(e){var t=e;j(t.AttributeTypeName)&&(e.AttributeTypeName={Value:u.e.ImageType});j(t.MaxSizeInKB)&&(t.MaxSizeInKB=c.n);j(t.CanStoreFullImage)&&(t.CanStoreFullImage=!0);return t}(e);break}var r;Object(m.jb)(d.b,{eventName:d.a.apiCallEmulator.applyApiColumnUpdates,eventData:{attributeTypeName:null===(r=e.AttributeTypeName)||void 0===r?void 0:r.Value,odataType:e["@odata.type"],attributeType:e.AttributeType}});break;case s.j.Boolean:e=function(e,t){var a=e;j(a.AttributeTypeName)&&(a.AttributeTypeName={Value:u.e.BooleanType});j(a.DefaultValue)&&(a.DefaultValue=!1);a.OptionSet&&(j(a.OptionSet.IsCustomizable)&&(a.OptionSet.IsCustomizable={Value:!0,CanBeChanged:!1,ManagedPropertyLogicalName:"iscustomizable"}),j(a.OptionSet.IsManaged)&&(a.OptionSet.IsManaged=!1),j(a.OptionSet.Description)&&(a.OptionSet.Description={LocalizedLabels:[{Label:"",LanguageCode:t}]}),a.OptionSet.TrueOption&&(a.OptionSet.TrueOption=f(a.OptionSet.TrueOption)),a.OptionSet.FalseOption&&(a.OptionSet.FalseOption=f(a.OptionSet.FalseOption)));return a}(e,a);break;case s.j.Money:e=function(e){var t=e;j(t.AttributeTypeName)&&(t.AttributeTypeName={Value:u.e.MoneyType});j(t.MaxValue)&&(t.MaxValue=c.r);j(t.MinValue)&&(t.MinValue=c.s);j(t.PrecisionSource)&&(t.PrecisionSource=s.w.TransactionCurrency);j(t.Precision)&&(t.Precision=c.g);j(t.ImeMode)&&(t.ImeMode=s.r.Auto);return t}(e);break;case s.j.Lookup:case s.j.Customer:break;default:Object(m.jb)(d.b,{eventName:d.a.apiCallEmulator.applyApiColumnUpdates,eventData:{attributeType:e.AttributeType}})}return e.IsValidForUpdate=!0,e.MetadataId=Object(l.a)(),e.DisplayName.UserLocalizedLabel=e.DisplayName.LocalizedLabels[0],e.Description&&(e.Description.UserLocalizedLabel=e.Description.LocalizedLabels[0]),e.OptionSet&&(e.OptionSet.Description&&(e.OptionSet.Description.UserLocalizedLabel=e.OptionSet.Description.LocalizedLabels[0]),e.OptionSet.DisplayName&&(e.OptionSet.DisplayName.UserLocalizedLabel=e.OptionSet.DisplayName.LocalizedLabels[0]),e.OptionSet.MetadataId=Object(l.a)(),e.OptionSet.Options&&e.OptionSet.Options.forEach(e=>{O(e)}),O(e.OptionSet.TrueOption),O(e.OptionSet.FalseOption)),e}function f(e){return j(e.ExternalValue)&&(e.ExternalValue=""),j(e.IsManaged)&&(e.IsManaged=!1),e}function y(e){return e.AttributeType!==s.j.Customer&&(e=Object(n.g)(e)),delete e.MetadataId,delete e.LogicalName,delete e.DisplayName.UserLocalizedLabel,e.Description&&delete e.Description.UserLocalizedLabel,e.OptionSet&&(delete e.OptionSet.Description.UserLocalizedLabel,delete e.OptionSet.DisplayName.UserLocalizedLabel,delete e.OptionSet.MetadataId,e.OptionSet.Options&&e.OptionSet.Options.forEach(e=>{C(e)}),C(e.OptionSet.TrueOption),C(e.OptionSet.FalseOption)),e}function g(e){return e.MetadataId=Object(l.a)(),e}function h(e){return e["@odata.type"]="Microsoft.Dynamics.CRM.OneToManyRelationshipMetadata",delete e.MetadataId,e}function O(e){e&&(e.MetadataId=Object(l.a)(),e.Description&&(e.Description.UserLocalizedLabel=e.Description.LocalizedLabels[0]),e.Label.UserLocalizedLabel=e.Label.LocalizedLabels[0])}function C(e){e&&(delete e.MetadataId,e.Description&&delete e.Description.UserLocalizedLabel,delete e.Label.UserLocalizedLabel)}function N(e,t){return e.DisplayName||(e.DisplayName={LocalizedLabels:[{Label:"",LanguageCode:t}]}),e.MetadataId=Object(l.a)(),e.LogicalName=b(e.SchemaName),e.DisplayName.UserLocalizedLabel=e.DisplayName.LocalizedLabels[0],e.Description&&(e.Description.UserLocalizedLabel=e.Description.LocalizedLabels[0]),e.DisplayCollectionName&&(e.DisplayCollectionName.UserLocalizedLabel=e.DisplayCollectionName.LocalizedLabels[0]),e.Privileges=[{Name:"prvCreate".concat(e.SchemaName),PrivilegeId:Object(l.a)(),PrivilegeType:o.a.Create},{Name:"prvRead".concat(e.SchemaName),PrivilegeId:Object(l.a)(),PrivilegeType:o.a.Read},{Name:"prvWrite".concat(e.SchemaName),PrivilegeId:Object(l.a)(),PrivilegeType:o.a.Write},{Name:"prvDelete".concat(e.SchemaName),PrivilegeId:Object(l.a)(),PrivilegeType:o.a.Delete},{Name:"prvAssign".concat(e.SchemaName),PrivilegeId:Object(l.a)(),PrivilegeType:o.a.Assign},{Name:"prvShare".concat(e.SchemaName),PrivilegeId:Object(l.a)(),PrivilegeType:o.a.Share},{Name:"prvAppend".concat(e.SchemaName),PrivilegeId:Object(l.a)(),PrivilegeType:o.a.Append},{Name:"prvAppendTo".concat(e.SchemaName),PrivilegeId:Object(l.a)(),PrivilegeType:o.a.AppendTo}],e.ManyToOneRelationships||(e.ManyToOneRelationships=[]),e.OneToManyRelationships||(e.OneToManyRelationships=[]),e.ManyToManyRelationships||(e.ManyToManyRelationships=[]),e}function T(e){return delete(e=Object(i.g)(e,"Microsoft.Dynamics.CRM.EntityMetadata")).MetadataId,delete e.LogicalName,delete e.DisplayName.UserLocalizedLabel,e.Description&&delete e.Description.UserLocalizedLabel,e.DisplayCollectionName&&delete e.DisplayCollectionName.UserLocalizedLabel,delete e.Privileges,e}function j(e){return null==e}var S="accountid",D="contactid"},37577:function(e,t,a){"use strict";a.d(t,"a",(function(){return T}));var i=a(10926),n=a.n(i),o=a(11466),r=a(11885),l=a(37578),u=a(21618),s=a(22543),c=a(12088),d=a(22504),m=a(11465),p=a(21622),b=a(11021),v=a(22448),f=a(22438),y=a.n(f),g=a(14837),h=a(19450);function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){N(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function N(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var T=e=>{var t,a,f,{solutionId:O,isStagedData:N,tableId:T,showCallout:j,onDismiss:S,focusTrapCalloutTarget:D,columnDetails:E,tableDetails:L,isSchemaNameDuplicated:P,isLookupSchemaNameDuplicated:w,isAccountRelationshipSchemaNameDuplicated:A,isContactRelationshipSchemaNameDuplicated:M,stagedConfigurationType:V,isReadOnlyMode:I,shouldSkipApiAndUseDevEnvironmentDefaults:R,dataRows:x}=e,{t:F}=Object(o.g)("PowerappsPortalColumns"),[k,z]=Object(i.useState)(Object(d.h)()),[U,B]=Object(i.useState)(Object(d.h)()),[W,G]=n.a.useState(!1),[H,q]=n.a.useState(!1),[_,Z]=n.a.useState(!1),[J,K]=n.a.useState(!1),[X,$]=n.a.useState(!1),{isCDSLiteUX:Q,locale:Y,solution:ee,solutionUniqueName:te,table:ae}=Object(s.a)({t:F,isCreateMode:!0,refetchColumn:!1,solutionId:O,tableId:T,tableName:"",columnId:void 0,attributeProps:void 0,isStageData:N||!0},!!R),{enableColumnLevelSecurity:ie}=Object(h.e)(),{data:ne}=Object(g.m)({attributeLogicalName:null===(t=k.schemaName)||void 0===t?void 0:t.toLowerCase(),entityName:null!==(a=null==ae||null===(f=ae.table)||void 0===f?void 0:f.logicalName)&&void 0!==a?a:""},!!ie&&!N&&!R),oe=N&&(null==E?void 0:E.schemaName),re=oe?Object(u.b)(Object(u.a)(null==E?void 0:E.schemaName)):void 0,le={solutionId:null==ee?void 0:ee.solutionId,solutionUniqueName:te,publisherCustomizationPrefix:null!=ee&&ee.customizationPrefix?Object(u.b)(null==ee?void 0:ee.customizationPrefix):re,publisherCustomizationPrefixValue:(null==ee?void 0:ee.publisherCustomizationOptionValuePrefix)||void 0,isManaged:null==ee?void 0:ee.solutionIsManaged,isPatched:null==ee?void 0:ee.solutionIsPatched},ue=(e,t,a)=>{Object(b.W)(c.a,{eventName:p.i.DismissPanel,eventData:{dataWasUpdated:e,columnDataTypeWasUpdated:t}}),S(e,t,a)},se=n.a.useCallback(()=>{var e,t,a,i=null==ae||null===(e=ae.table)||void 0===e?void 0:e.isVirtualTable,n=null==ae||null===(t=ae.table)||void 0===t?void 0:t.schemaName;if(k.type===r.d.Customer){var o,l,u,s={relationshipInput:a=Object(d.e)(k,(null==le?void 0:le.publisherCustomizationPrefix)||"",!0,i,null==ae?void 0:ae.table),solutionUniqueName:te,localeId:0!==Y?Y:1033},v={lookupColumn:y()(null===(o=a)||void 0===o?void 0:o.lookupColumn,p.q),accountRelationship:y()(null===(l=a)||void 0===l?void 0:l.accountRelationship,["schemaName"]),contactRelationship:y()(null===(u=a)||void 0===u?void 0:u.contactRelationship,["schemaName"]),isVirtualTable:i,publisherCustomizationPrefix:(null==le?void 0:le.publisherCustomizationPrefix)||""};Object(b.W)(c.a,{eventName:p.i.CreateColumn,eventData:{tableId:T,columnToBeCreated:s,relationshipType:k.type,columnOrRelationshipDetailsToLog:v,solutionUniqueName:te,localeId:0!==Y?Y:1033}}),ue(Object(d.j)(k,U,N),!1,{relationshipToBeCreated:a})}else if(k.type===r.d.Lookup){var f,g;a=Object(d.d)(k,(null==le?void 0:le.publisherCustomizationPrefix)||"",!0,i,null==ae?void 0:ae.table);var h={lookupColumn:y()(null===(f=a)||void 0===f?void 0:f.lookupColumn,p.q),oneToManyRelationship:y()(null===(g=a)||void 0===g?void 0:g.oneToManyRelationship,["schemaName"]),isVirtualTable:i,publisherCustomizationPrefix:(null==le?void 0:le.publisherCustomizationPrefix)||""},C={relationshipInput:a,solutionUniqueName:te,localeId:0!==Y?Y:1033};Object(b.W)(c.a,{eventName:p.i.CreateColumn,eventData:{tableId:T,columToBeCreated:C,relationshipType:k.type,columnOrRelationshipDetailsToLog:h,solutionUniqueName:te,localeId:0!==Y?Y:1033}}),ue(Object(d.j)(k,U,N),!1,{relationshipToBeCreated:a})}else{a=Object(d.c)(k,(null==le?void 0:le.publisherCustomizationPrefix)||"",i);var j={tableId:T||"",tableName:n,column:a,solutionUniqueName:te,localeId:0!==Y?Y:1033,localeString:Object(m.h)()};Object(b.W)(c.a,{eventName:p.i.CreateColumn,eventData:{tableId:T,solutionId:O,isStagedData:N,columnToBeCreated:y()(null==j?void 0:j.column,p.q),publisherCustomizationPrefix:(null==le?void 0:le.publisherCustomizationPrefix)||""}});var S=!U||!U.type||k.type!==U.type,D=!U||!U.format||k.format!==U.format;(S||D)&&Object(b.W)(c.a,{eventName:p.i.DataTypeOrFormatChanged,eventData:{dataType:{before:null==U?void 0:U.type,after:k.type},format:{before:null==U?void 0:U.format,after:k.format}}}),ue(Object(d.j)(k,U,N),S,{columnToBeCreated:a})}},[T,null==ae?void 0:ae.table,k,Y,null==le?void 0:le.publisherCustomizationPrefix,O,N,ue]);n.a.useEffect(()=>{if(E){var e=oe&&null!=le&&le.publisherCustomizationPrefix?C(C({},E),{},{schemaName:Object(u.g)(null==E?void 0:E.schemaName,null==le?void 0:le.publisherCustomizationPrefix),oneToManyRelationshipName:null!=E&&E.oneToManyRelationshipName?Object(u.g)(null==E?void 0:E.oneToManyRelationshipName,null==le?void 0:le.publisherCustomizationPrefix):"",accountRelationshipName:null!=E&&E.accountRelationshipName?Object(u.g)(null==E?void 0:E.accountRelationshipName,null==le?void 0:le.publisherCustomizationPrefix):"",contactRelationshipName:null!=E&&E.contactRelationshipName?Object(u.g)(null==E?void 0:E.contactRelationshipName,null==le?void 0:le.publisherCustomizationPrefix):""}):E,t=Object(d.g)(F,e,null==e?void 0:e.accountRelationshipName,null==e?void 0:e.contactRelationshipName,null==e?void 0:e.oneToManyRelationshipName,ne,!!ie);z(C(C({},t),{},{wasRelationshipSchemaNameManuallyUpdated:!(null==e||!e.oneToManyRelationshipName)})),B(t),Object(b.W)(c.a,{eventName:p.i.GetColumnFormValues,eventData:{column:y()(t,p.r),prefix:null==le?void 0:le.publisherCustomizationPrefix}})}},[oe,null==le?void 0:le.publisherCustomizationPrefix,E,F,ne,ie]),n.a.useEffect(()=>{if(P){var e=!!k.schemaName&&P("".concat(null==le?void 0:le.publisherCustomizationPrefix).concat(k.schemaName));G(e),Object(b.W)(c.a,{eventName:p.i.DuplicatedSchemaName,eventData:{isSchemaNameDuplicated:P,publisherCustomizationPrefix:null==le?void 0:le.publisherCustomizationPrefix}})}},[P,k.schemaName,null==le?void 0:le.publisherCustomizationPrefix]),n.a.useEffect(()=>{if(w){var e=k.type===r.d.Lookup&&!!k.oneToManyRelationshipName&&w("".concat(null==le?void 0:le.publisherCustomizationPrefix).concat(k.oneToManyRelationshipName));q(e),Object(b.W)(c.a,{eventName:p.i.DuplicatedSchemaName,eventData:{columnType:k.type,isLookupDuplicatedSchemaName:e,publisherCustomizationPrefix:null==le?void 0:le.publisherCustomizationPrefix}})}},[w,k.type,k.oneToManyRelationshipName,null==le?void 0:le.publisherCustomizationPrefix]),n.a.useEffect(()=>{if(A){var e=k.type===r.d.Customer&&!!k.accountRelationshipName&&A("".concat(null==le?void 0:le.publisherCustomizationPrefix).concat(k.accountRelationshipName));Z(e),Object(b.W)(c.a,{eventName:p.i.DuplicatedSchemaName,eventData:{columnType:k.type,isCustomerDuplicatedSchemaName:e,publisherCustomizationPrefix:null==le?void 0:le.publisherCustomizationPrefix}})}},[A,k.type,k.accountRelationshipName,,null==le?void 0:le.publisherCustomizationPrefix]),n.a.useEffect(()=>{if(M){var e=k.type===r.d.Customer&&!!k.contactRelationshipName&&M("".concat(null==le?void 0:le.publisherCustomizationPrefix).concat(k.contactRelationshipName));K(e),Object(b.W)(c.a,{eventName:p.i.DuplicatedSchemaName,eventData:{columnType:k.type,isCustomerDuplicatedSchemaName:e,publisherCustomizationPrefix:null==le?void 0:le.publisherCustomizationPrefix}})}},[M,k.type,k.contactRelationshipName,null==le?void 0:le.publisherCustomizationPrefix]),n.a.useEffect(()=>{var e=Object(v.b)({type:U.type,typeName:U.typeName,format:U.format,formatName:U.formatName}),t=Object(v.b)({type:k.type,typeName:k.typeName,format:k.format,formatName:k.formatName});$(t&&e!==t&&(null==k?void 0:k.type)!==r.d.Boolean)},[U.type,U.typeName,U.format,U.formatName,k.type,k.typeName,k.format,k.formatName]);var ce=N?!ee||!(null==ee||!ee.loading):!ee||!(null==ee||!ee.loading)||!(null==ae||!ae.loading),de=N&&(null!=E&&E.schemaName||null!=ee&&ee.loading)?"":null==ee?void 0:ee.errorMessage;n.a.useEffect(()=>{ce||Object(b.W)(c.a,{eventName:p.i.FormLoaded,eventData:{hasSolution:!!ee,isSolutionLoading:!(null==ee||!ee.loading),isTableLoading:!(null==ae||!ae.loading),isStagedData:N,hasColumnDetails:!!E,solutionId:null==ee?void 0:ee.solutionId,SolutionPrefix:null==ee?void 0:ee.customizationPrefix,solutionUniqueName:null==ee?void 0:ee.solutionUniqueName,publisherCustomizationPrefix:null==le?void 0:le.publisherCustomizationPrefix}})},[ce,N,null==ee?void 0:ee.loading,null==ae?void 0:ae.loading,E,null==ee?void 0:ee.solutionId,null==ee?void 0:ee.customizationPrefix,null==ee?void 0:ee.solutionUniqueName,null==le?void 0:le.publisherCustomizationPrefix]),n.a.useEffect(()=>{de&&Object(b.W)(c.a,{eventName:p.i.Error,eventData:{errorMessage:de,isStagedData:N}})},[de,N]);var me=n.a.useCallback(()=>{var e;return{isAuditEnabled:!(null==L||!L.isAuditEnabled),entityType:(null==L?void 0:L.tableType)||r.F.Standard,logicalName:(null==L||null===(e=L.schemaName)||void 0===e?void 0:e.toLowerCase())||"",schemaName:(null==L?void 0:L.schemaName)||"",id:"",canCreateAttributes:!0,isManaged:!(null==L||!L.isManaged),isCustomizable:!(null==L||!L.isCustomizable),dataProviderId:void 0,dataSourceId:void 0,isVirtualTable:!1}},[L]),pe={calloutTitle:F(E?I?"Column.Properties":"Column.Update.Header":"Column.Create.Header"),isFormLoading:ce,isCreateMode:!0,showCallout:j,focusTrapCalloutTarget:D,onDismiss:ue,formFields:k,setFormFields:z,originalFormFields:U,isCDSLiteUX:Q,solutionDetails:le,shouldSkipApiAndUseDevEnvironmentDefaults:R,shouldDisableSaveButton:ce||!!de||!!I,parentTable:ae||{loading:!1,table:me()},column:{columnDetails:E,disableActionOnColumn:ce||!!de,columnLogicalName:void 0},isCreateOrUpdateTableTriggered:!1,createOrUpdateColumn:se,errorMessage:de,isSchemaNameUpdatedDuplicated:W,isNewLookupSchemaNameDuplicated:H,isNewCustomerAccountDuplicatedSchemaName:_,isNewCustomerContactDuplicatedSchemaName:J,wasColumnTypeUpdatedToChoice:X,primaryButtonLabel:F(E?"Common.Update":"Common.Save"),stagedConfigurationType:V,isReadOnlyMode:I,dataRows:x};return n.a.createElement(l.a,pe)}},37578:function(e,t,a){"use strict";a.d(t,"a",(function(){return T}));var i=a(10926),n=a.n(i),o=a(13093),r=a(11675),l=a(12139),u=a(11645),s=a(16100),c=a(11635),d=a(11636),m=a(22445),p=a(22523),b=a(37579),v=a(11466),f=a(22504),y=a(37580),g=a(37582),h=a(37584),O=a(12088),C=a(21622),N=a(11021),T=e=>{var{focusTrapCalloutTarget:t,calloutTitle:a,isCreateMode:i,formFields:T,setFormFields:j,column:S,solutionDetails:D,shouldDisableSaveButton:E,parentTable:L,isCDSLiteUX:P,createOrUpdateColumn:w,isCreateOrUpdateTableTriggered:A,isFormLoading:M,onDismiss:V,showCallout:I,errorMessage:R,isSchemaNameUpdatedDuplicated:x,isNewLookupSchemaNameDuplicated:F,isNewCustomerAccountDuplicatedSchemaName:k,isNewCustomerContactDuplicatedSchemaName:z,primaryButtonLabel:U,stagedConfigurationType:B,isReadOnlyMode:W,shouldSkipApiAndUseDevEnvironmentDefaults:G,wasColumnTypeUpdatedToChoice:H,dataRows:q}=e,{t:_}=Object(v.g)("PowerappsPortalColumns"),Z=Object(s.a)(),J=Object(b.c)(Z),K=Object(u.a)("columnCalloutId"),X=Object(c.a)(n.a.useRef(null))<=d.a.small,[$,Q]=n.a.useState(""),[Y,ee]=n.a.useState(""),{solutionId:te,publisherCustomizationPrefix:ae,publisherCustomizationPrefixValue:ie,isManaged:ne,isPatched:oe}=D,re=null==S?void 0:S.columnDetails,[le,ue]=n.a.useState(!1),[se,ce]=n.a.useState(!1),[de,me]=n.a.useState(!1),pe=!(null==S||!S.disableActionOnColumn)||!!W;n.a.useEffect(()=>{var{disabledColumn:e,disabledColumnWithAdditionalSettings:t,disableColumnWithNoRename:a}=Object(f.b)(ne,oe,null==re?void 0:re.isManaged,null==re?void 0:re.isCustomizable,null==re?void 0:re.canModifyAdditionalSettings,null==re?void 0:re.isRenameable);ue(e||!!W),me(t||!!W),ce(a||!!W),Object(N.W)(O.a,{eventName:C.i.DisableColumnBaseOnConfiguration,eventData:{isSolutionManaged:ne,isSolutionPatched:oe,isTableManaged:null==re?void 0:re.isManaged,isTableCustomizable:null==re?void 0:re.isCustomizable,canModifyAdditionalSettings:null==re?void 0:re.canModifyAdditionalSettings,isTableRenameable:null==re?void 0:re.isRenameable,disabledColumn:e,disabledColumnWithAdditionalSettings:t,disableColumnWithNoRename:a,isReadOnlyMode:W}})},[ne,oe,null==re?void 0:re.isManaged,null==re?void 0:re.isCustomizable,null==re?void 0:re.canModifyAdditionalSettings,null==re?void 0:re.isRenameable,W]),n.a.useEffect(()=>{var e=x?_("Column.FormMessage.DuplicatedSchemaNameError",{columnSchemaName:"".concat(ae).concat(T.schemaName)}):"",t=F?_("Column.FormMessage.DuplicatedRelationshipSchemaNameError",{relationshipSchemaName:"".concat(ae).concat(T.oneToManyRelationshipName)}):"",a=k?_("Column.FormMessage.DuplicatedRelationshipSchemaNameError",{relationshipSchemaName:"".concat(ae).concat(T.accountRelationshipName)}):"",i=z?_("Column.FormMessage.DuplicatedRelationshipSchemaNameError",{relationshipSchemaName:"".concat(ae).concat(T.contactRelationshipName)}):"";Q(e||t||a||i)},[x,F,k,z,ae,T.schemaName,T.oneToManyRelationshipName,T.accountRelationshipName,T.contactRelationshipName]),n.a.useEffect(()=>{var e=H?_("Column.FormMessage.PreviewChoices"):"";ee(e)},[H]);var be={propertiesSectionDetails:{isCreateMode:i,isCDSLiteUX:P,formFields:T,setFormFields:j,disableEntityWithNoCustomization:!!le,disabledEntityWithNoModifyOption:!!de,disableEntityWithNoRenameOption:!!se,solutionId:te,columnName:null==S?void 0:S.columnLogicalName,disableCalculatedAndRollupOption:E,disableActionOnColumn:pe,solutionPublisherCustomizationOptionValuePrefix:ie,parentTable:null==L?void 0:L.table,isSimpleCreateOrUpdateColumn:!0,notifyPrimaryColumnDataTypeChanged:e=>{Q(e?_("Column.FormMessage.PrimaryColumnDataTypeSelectionMessage"):""),Object(N.W)(O.a,{eventName:C.i.PrimaryColumnDataTypeChanged,eventData:{isPrimaryColumnDataTypeChanged:e}})},stagedConfigurationType:B,shouldSkipApiAndUseDevEnvironmentDefaults:G,dataRows:q}},ve={advancedOptionsSectionDetails:{isCreateMode:i,isCDSLiteUX:P,table:L,formFields:T,setFormFields:j,disableEntityWithNoRenameOption:!!se,disabledEntityWithNoModifyOption:!!de,disableActionOnColumn:pe,columnPrefix:ae||"",isSimpleCreateOrUpdateColumn:!0,shouldSkipApiAndUseDevEnvironmentDefaults:G}},fe=n.a.useCallback(()=>n.a.createElement(y.a,{headerLabelId:K,calloutTitle:a,closeLabel:_("Common.Close"),onCloseCallout:()=>V(!1,!1),errorMessage:R,warningMessage:$,infoMessage:Y}),[V,R,$,Y,_,a,K]),ye=n.a.useCallback(()=>n.a.createElement(g.a,{shouldDisablePrimaryButton:E||Object(f.k)(!0,T)||x||F||k||z,primaryButtonLabel:U||_("Common.Save"),primaryButtonAction:w,shouldDisableSecondaryButton:A,secondaryButtonLabel:_("Common.Cancel"),secondaryButtonAction:()=>V(!1,!1)}),[A,_,V,E,T,w,i,x,F,k,z,U]),ge=_(M?"Common.Loading":"Common.Saving");return n.a.createElement(n.a.Fragment,null,I?n.a.createElement(o.a,{ariaLabelledBy:K,styles:X?b.a:b.b,role:"alertdialog",target:t,focusTrapProps:{isClickableOutsideFocusTrap:!0,"data-testid":"columnFormCallout"},gapSpace:8,directionalHint:r.a.bottomCenter,setInitialFocus:!0,onDismiss:()=>V(!1,!1)},n.a.createElement(l.a,null,fe(),M&&n.a.createElement(h.a,{label:ge,ariaLabel:ge}),n.a.createElement("div",{className:M?J.calloutBodyLoading:J.calloutBody},n.a.createElement(m.a,be),n.a.createElement(p.a,ve),ye()))):null)}},37579:function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return l}));var i=a(10979),n=a(10929),o=Object(i.c)(e=>{var{palette:t}=e;return Object(n.db)({calloutBody:{padding:"0 24px 20px 24px"},calloutBodyLoading:{visibility:"hidden"}})}),r=()=>Object(n.db)({root:{width:357}}),l=()=>Object(n.db)({root:{width:"100%",top:"0 !important",left:"0 !important",height:"100vh !important",maxHeight:"inherit !important"}})},37580:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var i=a(10926),n=a.n(i),o=a(12139),r=a(11712),l=a(12671),u=a(16100),s=a(11932),c=a(11934),d=a(37581),m=e=>{var{headerLabelId:t,calloutTitle:a,closeLabel:i,onCloseCallout:m,errorMessage:p,warningMessage:b,infoMessage:v}=e,f=Object(u.a)(),y=Object(d.a)(f),[g,h]=n.a.useState(!1),[O,C]=n.a.useState(!1),[N,T]=n.a.useState(!1);return n.a.createElement(n.a.Fragment,null,n.a.createElement(o.a,{className:y.mainContentArea,horizontal:!0,horizontalAlign:"space-between"},n.a.createElement(o.a,{horizontal:!0,horizontalAlign:"center"},n.a.createElement("h1",{id:t,className:y.headerTitle},a)),n.a.createElement(o.a,{className:y.headerCloseButton},n.a.createElement(l.a,{content:i},n.a.createElement(r.a,{ariaLabel:i,iconProps:{iconName:"Cancel"},onClick:m,className:y.headerCloseButtonLabel})))),!!b&&!O&&n.a.createElement(s.a,{className:y.messageBar,messageBarType:c.a.warning,onDismiss:()=>C(!0),dismissButtonAriaLabel:i,isMultiline:!0},b),!!p&&!g&&n.a.createElement(s.a,{className:y.messageBar,messageBarType:c.a.error,onDismiss:()=>h(!0),dismissButtonAriaLabel:i,isMultiline:!0},p),!!v&&!N&&n.a.createElement(s.a,{className:y.messageBar,messageBarType:c.a.info,onDismiss:()=>T(!0),dismissButtonAriaLabel:i,isMultiline:!0},v))}},37581:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var i=a(10979),n=a(10929),o=Object(i.c)(e=>{var{palette:t}=e;return Object(n.db)({mainContentArea:{paddingTop:16,paddingRight:24,paddingLeft:24,fontSize:16,color:(null==t?void 0:t.neutralPrimary)||"#323130",selectors:{".ms-TooltipHost":{paddingLeft:5}}},headerCloseButton:{marginRight:0},headerCloseButtonLabel:{color:(null==t?void 0:t.neutralSecondary)||"#605E5C"},headerTitle:{fontSize:20,fontWeight:600,color:(null==t?void 0:t.neutralPrimary)||"#323130",lineHeight:28,overflowWrap:"break-word",wordBreak:"break-word",hyphens:"auto",marginBottom:16},messageBar:{marginBottom:6}})})},37582:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var i=a(10926),n=a.n(i),o=a(12139),r=a(11823),l=a(11824),u=a(16100),s=a(37583),c=e=>{var{shouldDisablePrimaryButton:t,primaryButtonLabel:a,primaryButtonAction:i,shouldDisableSecondaryButton:c,secondaryButtonLabel:d,secondaryButtonAction:m}=e,p=Object(u.a)(),b=Object(s.a)(p);return n.a.createElement(o.a,{horizontal:!0,horizontalAlign:"end"},n.a.createElement(r.a,{disabled:t,text:a,className:b.primaryButton,onClick:i}),n.a.createElement(l.a,{text:d,disabled:c,onClick:m}))}},37583:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var i=a(10979),n=a(10929),o=Object(i.c)(e=>{var{palette:t}=e;return Object(n.db)({primaryButton:{marginRight:8}})})},37584:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var i=a(10926),n=a.n(i),o=a(11940),r=a(11942),l=a(37585),u=e=>{var{label:t,ariaLabel:a}=e,i=Object(l.a)();return n.a.createElement(o.a,{size:r.a.large,label:t,ariaLabel:a||t,ariaLive:"assertive",className:i.spinner})}},37585:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var i=a(10979),n=a(10929),o=Object(i.c)(()=>Object(n.db)({spinner:{position:"absolute",top:"45%",left:"50%",transform:"translateX(-50%)"}}))},37586:function(e,t,a){"use strict";function i(e){return e&&e.properties.linkedEnvironmentMetadata&&parseInt(e.properties.linkedEnvironmentMetadata.baseLanguage,10)||1033}a.d(t,"a",(function(){return i}))},37587:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var i=a(10926),n=a.n(i),o=a(11465),r=a(12917),l=a(37574),u=a(10929),s=a(37588),c=a(37592);function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){p(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function b(e){var{agGridRuntimeProvider:t,rowSelection:a,agGridTable:i,onOpenAddColumnCallout:u,onOpenTableEditorCallout:d,isLoading:p,blockUi:b,className:v,onOpenConfirmDialog:f,configurationType:y,shouldSkipApiAndUseDevEnvironmentDefaults:g}=e,[h,O]=n.a.useState(void 0),[C,N]=n.a.useState(1),{t:T}=Object(o.t)("PowerTableInMemoryDesigner"),j=!!h;n.a.useEffect(()=>{N(e=>e+1)},[j]);var S=b||p,D=[];return 0===a.ids.length?(Object(c.a)(y)||(D.push({key:"newRow","data-testid":"newRow",text:T("actions.newRow"),iconProps:{iconName:"Add"},onClick:()=>{null==t||t.addEmptyRow()},disabled:S}),D.push({key:"newColumn","data-testid":"newColumn",text:T("actions.newColumn"),iconProps:{iconName:"Add"},onClick:e=>{u(null==e?void 0:e.currentTarget)},disabled:S})),D.push({key:"editTableProperties","data-testid":"editTableProperties",text:T("actions.editTableProperties"),title:y===l.a.ConversationalReadOnly?T("actions.openTableProperties"):void 0,iconProps:{iconName:"Edit"},onClick:e=>{d(null==e?void 0:e.currentTarget)},disabled:S}),y!==l.a.Blank&&y!==l.a.ImportExcel&&y!==l.a.ImportFromConnector||D.push({key:"rowOwnershipButton","data-testid":"rowOwnershipButton",text:T("actions.rowOwnership"),iconProps:{iconName:"contact-lock-svg"},onClick:e=>{O(null==e?void 0:e.currentTarget)},disabled:S})):Object(c.a)(y)||(1===a.ids.length&&(D.push({key:"insertRowAbove","data-testid":"insertRowAbove",text:T("actions.insertRecordAbove"),iconProps:{iconName:"InsertRowsAbove"},onClick:()=>{null==t||t.addEmptyRowAt(a.indexes[0],"above")},disabled:S}),D.push({key:"insertRowBelow","data-testid":"insertRowBelow",text:T("actions.insertRecordBelow"),iconProps:{iconName:"InsertRowsBelow"},onClick:()=>{null==t||t.addEmptyRowAt(a.indexes[0],"below")},disabled:S})),D.push({key:"deleteRow","data-testid":"deleteRow",text:T("actions.deleteRecord",{qty:a.ids.length}),iconProps:{iconName:"Delete"},onClick:()=>{f({type:"deleteRow",title:T("actions.deleteRowConfirm.title"),subText:T("actions.deleteRowConfirm.subText"),defaultButtonText:T("actions.deleteRowConfirm.defaultButtonText"),primaryButtonText:T("actions.deleteRowConfirm.primaryButtonText"),onConfirm:()=>{null==t||t.deleteRows(a.ids)}})},disabled:S})),n.a.createElement(n.a.Fragment,null,n.a.createElement(r.a,{className:v,items:D}),n.a.createElement(s.a,{focusTrapCalloutTarget:h,showCallout:!!h,key:C,onDismissCallout:(e,a)=>{a&&(null==t||t.updateTableMetadata(i.metadata.LogicalName,m(m({},i.metadata),{},{OwnershipType:a.ownershipType,TableType:a.tableType}))),O(void 0)},isCreateMode:!0,isStagedData:!0,shouldSkipApiAndUseDevEnvironmentDefaults:g,isReadOnlyMode:!1,tableDetails:{ownershipType:i.metadata.OwnershipType,tableType:i.metadata.TableType}}))}Object(u.ib)({icons:{"contact-lock-svg":n.a.createElement("svg",{width:"14",height:"14",viewBox:"0 0 14 14",xmlns:"http://www.w3.org/2000/svg"},n.a.createElement("path",{d:"M9.27637 7.18457C9.18522 7.30306 9.10775 7.43066 9.04395 7.56738C8.98014 7.69954 8.92546 7.83854 8.87988 7.98438C8.48796 7.66536 8.05729 7.42155 7.58789 7.25293C7.11849 7.08431 6.63086 7 6.125 7C5.72396 7 5.33659 7.05241 4.96289 7.15723C4.58919 7.26204 4.24056 7.41016 3.91699 7.60156C3.59342 7.78841 3.2972 8.01628 3.02832 8.28516C2.764 8.54948 2.53613 8.84342 2.34473 9.16699C2.15788 9.49056 2.01204 9.83919 1.90723 10.2129C1.80241 10.5866 1.75 10.974 1.75 11.375H0.875C0.875 10.8281 0.954753 10.3018 1.11426 9.7959C1.27832 9.29004 1.50846 8.82292 1.80469 8.39453C2.10091 7.96615 2.45638 7.58561 2.87109 7.25293C3.29036 6.92025 3.75521 6.6582 4.26562 6.4668C4.01042 6.30729 3.78027 6.12044 3.5752 5.90625C3.37467 5.6875 3.20378 5.45052 3.0625 5.19531C2.92122 4.9401 2.81185 4.66895 2.73438 4.38184C2.66146 4.09473 2.625 3.80078 2.625 3.5C2.625 3.01693 2.71615 2.56348 2.89844 2.13965C3.08529 1.71582 3.33594 1.34668 3.65039 1.03223C3.9694 0.713216 4.34082 0.462565 4.76465 0.280273C5.18848 0.0934245 5.64193 0 6.125 0C6.60807 0 7.06152 0.0934245 7.48535 0.280273C7.90918 0.462565 8.27832 0.713216 8.59277 1.03223C8.91178 1.34668 9.16243 1.71582 9.34473 2.13965C9.53158 2.56348 9.625 3.01693 9.625 3.5C9.625 3.80078 9.58626 4.09473 9.50879 4.38184C9.43587 4.66895 9.32878 4.9401 9.1875 5.19531C9.04622 5.45052 8.87305 5.6875 8.66797 5.90625C8.46289 6.12044 8.23275 6.30729 7.97754 6.4668C8.4515 6.64909 8.88444 6.88835 9.27637 7.18457ZM3.5 3.5C3.5 3.86458 3.56836 4.20638 3.70508 4.52539C3.8418 4.83984 4.02865 5.11784 4.26562 5.35938C4.50716 5.59635 4.78516 5.7832 5.09961 5.91992C5.41862 6.05664 5.76042 6.125 6.125 6.125C6.48503 6.125 6.82454 6.05664 7.14355 5.91992C7.46257 5.7832 7.74056 5.59635 7.97754 5.35938C8.21908 5.11784 8.4082 4.83984 8.54492 4.52539C8.68164 4.20638 8.75 3.86458 8.75 3.5C8.75 3.13997 8.68164 2.80046 8.54492 2.48145C8.4082 2.16243 8.21908 1.88444 7.97754 1.64746C7.74056 1.40592 7.46257 1.2168 7.14355 1.08008C6.82454 0.943359 6.48503 0.875 6.125 0.875C5.76042 0.875 5.41862 0.943359 5.09961 1.08008C4.78516 1.2168 4.50716 1.40592 4.26562 1.64746C4.02865 1.88444 3.8418 2.16243 3.70508 2.48145C3.56836 2.80046 3.5 3.13997 3.5 3.5ZM14 9.625V14H8.75V9.625H9.625V8.75C9.625 8.50846 9.67057 8.28288 9.76172 8.07324C9.85286 7.85905 9.97819 7.6722 10.1377 7.5127C10.2972 7.35319 10.4818 7.22786 10.6914 7.13672C10.9056 7.04557 11.1335 7 11.375 7C11.6165 7 11.8421 7.04557 12.0518 7.13672C12.266 7.22786 12.4528 7.35319 12.6123 7.5127C12.7718 7.6722 12.8971 7.85905 12.9883 8.07324C13.0794 8.28288 13.125 8.50846 13.125 8.75V9.625H14ZM10.5 9.625H12.25V8.75C12.25 8.62695 12.2272 8.51302 12.1816 8.4082C12.1361 8.30339 12.0723 8.21224 11.9902 8.13477C11.9128 8.05273 11.8216 7.98893 11.7168 7.94336C11.612 7.89779 11.498 7.875 11.375 7.875C11.252 7.875 11.138 7.89779 11.0332 7.94336C10.9284 7.98893 10.835 8.05273 10.7529 8.13477C10.6755 8.21224 10.6139 8.30339 10.5684 8.4082C10.5228 8.51302 10.5 8.62695 10.5 8.75V9.625ZM13.125 10.5H9.625V13.125H13.125V10.5Z",fill:"currentColor"}))}})},37588:function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var i=a(10926),n=a.n(i),o=a(11645),r=a(11635),l=a(11636),u=a(11885),s=a(11860),c=a(11466),d=a(24228),m=a(37589),p=a(24240),b=a(12088),v=a(21622),f=a(21727),y=a(37590),g=a(37580),h=a(37582),O=a(37584),C=a(11021),N=a(13093),T=a(11675),j=e=>{var{t:t}=Object(c.g)("PowerappsPortalEntities"),{showCallout:a,onDismissCallout:i,focusTrapCalloutTarget:j,isStagedData:S,isCreateMode:D,isReadOnlyMode:E,solutionId:L,shouldSkipApiAndUseDevEnvironmentDefaults:P,tableDetails:w}=e,[A,M]=n.a.useState(void 0),V=Object(o.a)("tableOwnershipCalloutId"),I=Object(m.c)(),R=Object(r.a)(n.a.useRef(null))<=l.a.small,{solution:x,table:F}=Object(p.a)({t:t,isCreateMode:D,refreshUpdatedTable:!1,solutionId:L,tableId:S||null==w?void 0:w.id,isStagedData:S},!!P),k=(e,t)=>{Object(C.W)(b.a,{eventName:v.l.DismissPanel,eventData:{dataWasUpdated:e}}),i(e,t)},z=n.a.useCallback(()=>{Object(C.W)(b.a,{eventName:v.l.UpdateTableOwnership,eventData:{currentOwnershipType:null==w?void 0:w.ownershipType,newOwnershipType:null==A?void 0:A.ownershipType}});var e=(null==w?void 0:w.ownershipType)!==(null==A?void 0:A.ownershipType)&&!D;k(e,A)},[D,null==w?void 0:w.ownershipType,null==A?void 0:A.ownershipType]),U=!S&&(!(null==x||!x.loading)||!(null==F||!F.loading)),B=S?"":(null==x?void 0:x.errorMessage)||(null==F?void 0:F.errorMessage);n.a.useEffect(()=>{U||Object(C.W)(b.a,{eventName:v.l.FormLoaded,eventData:{isSolutionLoading:!(null==x||!x.loading),isStagedData:S,hasTableDetails:!!w}})},[U,S,null==x?void 0:x.loading,w]),n.a.useEffect(()=>{B&&Object(C.W)(b.a,{eventName:v.l.Error,eventData:{errorMessage:B,isStagedData:S}})},[B,S]),n.a.useEffect(()=>{var e=null==F?void 0:F.table,t=(null==e?void 0:e.entityType)||(null==w?void 0:w.tableType)||u.F.Standard,a={ownershipType:(null==e?void 0:e.ownershipType)||(t===u.F.Standard&&null!=w&&w.ownershipType?null==w?void 0:w.ownershipType:Object(d.e)(t)),tableType:t};M(a)},[null==F?void 0:F.table,null==w?void 0:w.tableType,null==w?void 0:w.ownershipType,null==w?void 0:w.id]);var W=n.a.useCallback(()=>n.a.createElement(g.a,{headerLabelId:V,calloutTitle:t("Entities.RowOwnership"),closeLabel:t("Common.Close"),onCloseCallout:()=>k(!1),errorMessage:B}),[k,B,V,t]),G=!(D&&!E&&(null==x||!x.solutionIsManaged)&&(null==x||!x.solutionIsPatched)),H=U||!!B||G,q=n.a.useCallback(()=>n.a.createElement(h.a,{shouldDisablePrimaryButton:H,primaryButtonLabel:t("Common.Save"),primaryButtonAction:z,secondaryButtonLabel:t("Common.Cancel"),secondaryButtonAction:()=>k(!1),shouldDisableSecondaryButton:!1}),[t,k,H,z]);return n.a.createElement(n.a.Fragment,null,a?n.a.createElement(N.a,{ariaLabelledBy:V,styles:R?m.a:m.b,role:"alertdialog",target:j,focusTrapProps:{isClickableOutsideFocusTrap:!0},directionalHint:T.a.bottomCenter,setInitialFocus:!0,onDismiss:()=>k(!1)},W(),n.a.createElement("p",{className:I.description},t("Entities.RowOwnershipDescription"),n.a.createElement(s.a,{href:f.a.aboutTableRowOwnership,target:"_blank",underline:!0,styles:{root:{paddingLeft:"0.4em"}}},t("Common.LearnMore"))),U&&n.a.createElement(O.a,{label:t("Common.Loading"),ariaLabel:t("Common.Loading")}),n.a.createElement("div",{className:U?I.calloutBodyLoading:I.calloutBody},n.a.createElement(y.a,{disableFormFields:G,formFields:A,setFormFields:M}),q())):null)}},37589:function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return r}));var i=a(10929),n=()=>Object(i.db)({calloutBody:{padding:"0 24px 20px 24px"},calloutBodyLoading:{visibility:"hidden"},description:{padding:"0 24px 15px 24px"}}),o=()=>Object(i.db)({root:{width:356}}),r=()=>Object(i.db)({root:{width:"100%",top:"0 !important",left:"0 !important",height:"100vh !important",maxHeight:"inherit !important"}})},37590:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var i=a(10926),n=a.n(i),o=a(12146),r=a(11885),l=a(12680),u=a(11466),s=a(12088),c=a(21622),d=a(11021),m=a(24219),p=a(37591);function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){f(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function f(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var y=e=>{var{t:t}=Object(u.g)("PowerappsPortalEntities"),{disableFormFields:a,formFields:i,setFormFields:b}=e,f=Object(p.a)(),[y]=n.a.useState(Object(m.c)(t));return n.a.createElement(o.a,null,n.a.createElement(l.a,{label:t("Entities.Form.RowsOwnershipLabel"),ariaLabel:t("Entities.Form.RowsOwnershipLabel"),className:f.formElement,required:!0,disabled:a||(null==i?void 0:i.tableType)===r.F.Activity||(null==i?void 0:i.tableType)===r.F.Virtual,selectedKey:null==i?void 0:i.ownershipType,options:y,onChange:(e,t)=>{Object(d.W)(s.a,{eventName:c.l.UpdatedOwnership,eventData:{currentOwnership:null==i?void 0:i.ownershipType,newOwnership:null==t?void 0:t.key}}),b(e=>{var a;return v(v({},e),{},{ownershipType:null==t||null===(a=t.key)||void 0===a?void 0:a.toString()})})}}))}},37591:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var i=a(10929),n=()=>Object(i.db)({formElement:{paddingBottom:20}})},37592:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return o}));var i=a(37574);function n(e,t,a){if(a<0||a>e.length-1)return e;for(var i=0;i<e.length;i++)if(e[i].field.LogicalName===t){var n=e[a];e[a]=e[i],e[i]=n;break}return e}function o(e){return e!==i.a.Blank&&e!==i.a.ConversationalReadWrite}},37593:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var i=a(12149),n=a(12139),o=a(10929),r=a(10926),l=a.n(r),u=a(11666),s=a(24041),c=a(11860),d=a(11465),m=e=>{var{errorMessages:t,validationErrorAutoFixer:a}=e,{palette:r}=Object(s.a)(),{t:m}=Object(d.t)("PowerTableInMemoryDesigner");return 0===t.length?null:l.a.createElement(n.a,{horizontal:!0,tokens:{childrenGap:8},"data-id":"saveStatus",verticalAlign:"center",styles:{root:{marginRight:"8px"}}},l.a.createElement(n.a.Item,{disableShrink:!0,styles:{root:{padding:"10px 0 5px"}}},l.a.createElement(u.a,{iconName:"Info",styles:{root:{color:r.red,fontWeight:o.l.semibold}}})),l.a.createElement(n.a.Item,{disableShrink:!0,style:{width:"100%"}},l.a.createElement(i.a,{"data-testid":"tableErrorMessages",styles:{root:{color:r.red,fontSize:o.k.medium,fontWeight:o.l.semibold}}},t.map((e,i)=>l.a.createElement(l.a.Fragment,null,e.message,a&&e.code&&l.a.createElement(l.a.Fragment,null," ",l.a.createElement(c.a,{disabled:a.isLoading,style:{color:r.red,textDecoration:"underline"},onClick:()=>{a.fix({code:e.code})}},m("actions.helpMeFixIt"))),i<t.length-1&&", ")))))}},37594:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var i=a(11712),n=a(13205),o=a(13209),r=a(12139),l=a(10929),u=a(10926),s=a.n(u),c=a(24041),d=a(11666),m=a(11466),p=e=>{var{isReadOnly:t,isLoading:a,agGridTable:l,blockUi:u,onOpenTableEditorCallout:p,isTableEditorCalloutVisible:v}=e,f=Object(c.a)(),{t:y}=Object(m.g)("PowerTableInMemoryDesigner"),g=s.a.useMemo(()=>b(f.palette),[f.palette]),h=s.a.createElement(s.a.Fragment,null);return h=a?s.a.createElement(n.a,{className:g.shimmer,shimmerElements:[{type:o.a.line,height:24}]}):s.a.createElement(r.a,{horizontal:!0,tokens:{childrenGap:10}},s.a.createElement(r.a.Item,null,s.a.createElement(d.a,{iconName:"Table",style:{fontSize:"32px"}})),s.a.createElement(r.a.Item,null,s.a.createElement("h2",{"data-testid":"entityDisplayNameId",title:l.metadata.DisplayName.LocalizedLabels[0].Label,className:g.label},l.metadata.DisplayName.LocalizedLabels[0].Label)),s.a.createElement(r.a.Item,{verticalFill:!0},s.a.createElement(i.a,{"data-testid":"editTableButton",iconProps:{iconName:"Edit"},disabled:!!v||u,title:y(t?"actions.openTableProperties":"actions.editTableProperties"),onClick:e=>{p(e.currentTarget)},className:g.icon}))),s.a.createElement(r.a,{className:g.container},h)},b=e=>Object(l.db)({container:{height:32,marginLeft:20},shimmer:{width:"100%",maxWidth:"128px",lineHeight:"28px",marginTop:"4px",marginBottom:"4px"},label:{maxWidth:"256px",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontSize:l.k.size20,fontWeight:l.l.semibold,lineHeight:"28px",color:e.neutralPrimary,paddingTop:"2px"},icon:{color:e.accent}})},37595:function(e,t,a){"use strict";a.d(t,"a",(function(){return y})),a.d(t,"b",(function(){return g})),a.d(t,"c",(function(){return h}));var i=a(23061),n=a(11031),o=a(37592),r=a(11021),l=a(37572),u=a(37596),s=a(37611),c=a(37614),d=a(37615),m=a(37609),p=a(37613);function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){f(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function f(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class y{constructor(e){this.props=e,this.agGridValidationProvider=void 0,this.agGridRowDataWithoutConversionsProvider=void 0,this.initDependencies()}initDependencies(){this.agGridValidationProvider=new s.a({onUpdateValidationErrors:this.props.onUpdateValidationErrors,t:this.props.t,configurationType:this.props.configurationType}),this.agGridRowDataWithoutConversionsProvider=new d.a({formattingSettings:this.props.formattingSettings,agGridValidationProvider:this.agGridValidationProvider,onUpdateRowDataWithoutConversions:this.props.onUpdateRowDataWithoutConversions})}loadTable(e){var t;Object(r.W)(l.b,{eventName:l.a.runtimeProvider.loadTable,eventData:{configurationType:this.props.configurationType,columns:null===(t=e.entity.Attributes)||void 0===t?void 0:t.map(p.a),rowsCount:e.data.length}}),function(e){var t=[];null!==e.entity.HasActivities&&void 0!==e.entity.HasActivities||t.push("Entity.MissingHasActivities");t.length>0&&Object(r.jb)(l.b,{eventName:l.a.cdsApiUtilities.preValidateTable},{errors:t})}(e),this.initDependencies(),this.updateAgGridTable(()=>{var t=Object(u.b)({onOpenConfirmDialog:this.props.onOpenConfirmDialog,onDeleteColumn:this.deleteColumn.bind(this),onHideColumn:this.hideColumn.bind(this)},e,this.props.formattingSettings,this.props.availableLanguages,this.props.agGridLocalizedStrings,this.props.configurationType,!1,this.props.languageCode,this.props.relatedDataSetProvider,this.props.t,this.props.dataPayloadFormat);if(this.agGridRowDataWithoutConversionsProvider.loadAndValidateTable(t,e,this.props.dataPayloadFormat),!Object(o.a)(this.props.configurationType)){var a=g(!0,t.columns);t.rows.push(a)}return t})}updateAgGridTable(e){this.props.onUpdateAgGridTable(t=>{try{return t=e(t),this.agGridValidationProvider.validateTable(t),t}catch(a){return this.props.onError(a),t}})}get agGridTable(){return this.props.getAgGridTable()}addEmptyRowAt(e,t){var a;Object(r.W)(l.b,{eventName:l.a.runtimeProvider.addEmptyRowAt,eventData:{index:e}}),this.updateAgGridTable(a=>{var i=-1;return"above"===t?i=e:"below"===t&&(i=e+1),a.rows.splice(i,0,g(!1,a.columns)),v(v({},a),{},{rows:[...a.rows]})}),null===(a=this.props.getPaGridAPI())||void 0===a||a.deselectAll()}addEmptyRow(){var e;Object(r.W)(l.b,{eventName:l.a.runtimeProvider.addEmptyRow,eventData:{}});var t=Object(n.a)();this.updateAgGridTable(e=>{var a,n=e.rows.findIndex(e=>{var t;return null===(t=e.params)||void 0===t?void 0:t.isLastRow});return e.rows[n]=v(v({},e.rows[n]),{},{[i.k]:t,params:v(v({},null===(a=e.rows[n])||void 0===a?void 0:a.params),{},{isLastRow:!1})}),v(v({},e),{},{rows:[...e.rows,g(!0,e.columns)]})}),null===(e=this.props.getPaGridAPI())||void 0===e||e.deselectAll()}deleteRows(e){Object(r.W)(l.b,{eventName:l.a.runtimeProvider.deleteRows,eventData:{id:e}}),this.agGridValidationProvider.deleteRows(e),this.agGridRowDataWithoutConversionsProvider.deleteRows(e),this.updateAgGridTable(t=>{var a=new Set(e);return v(v({},t),{},{rows:t.rows.filter(e=>!a.has(e[i.k]))})})}deleteColumn(e){Object(r.W)(l.b,{eventName:l.a.runtimeProvider.deleteColumn,eventData:{logicalName:e}}),this.agGridValidationProvider.deleteColumn(e),this.agGridRowDataWithoutConversionsProvider.deleteColumn(e),this.updateAgGridTable(t=>{var a;return a=(t=v(v({},t),{},{manyToOneRelationships:t.manyToOneRelationships.filter(a=>O(a,t.metadata.LogicalName,e)),columns:t.columns.filter(t=>t.field.LogicalName!==e)})).columns.length>0?t.rows.map(t=>(delete t[e],t)):[g(!0,t.columns)],v(v({},t),{},{rows:a})})}upsertColumn(e,t,a,n,o,s,d){Object(r.W)(l.b,{eventName:l.a.runtimeProvider.upsertColumn,eventData:{previous:{logicalName:t},new:{logicalName:a.LogicalName}}}),this.updateAgGridTable(r=>{var l;d=e.isHidden?Object(c.c)(r,t):d,o=e.autoNumber?Object(c.a)(r,t):o;var p=e.relationships?Object(c.b)(r,t):Object(u.c)(s||[]),b=Object(u.a)({onDeleteColumn:this.deleteColumn.bind(this),onHideColumn:this.hideColumn.bind(this),onOpenConfirmDialog:this.props.onOpenConfirmDialog},a,null==r||null===(l=r.metadata)||void 0===l?void 0:l.LogicalName,this.props.formattingSettings,this.props.availableLanguages,this.props.agGridLocalizedStrings,this.props.configurationType,!!n,this.props.relatedDataSetProvider,this.props.t,d),f=function(e,t,a,i,n){var o=v({},e);o[t]||(o[t]={});a&&delete o[t][a];delete o[t][i],null!=n&&(o[t][i]=n);return o}(r.autoNumberSeeds,r.metadata.LogicalName,t,b.field.LogicalName,o);if(this.agGridValidationProvider.upsertColumn(t,b.field.LogicalName),this.agGridRowDataWithoutConversionsProvider.upsertColumn(t,b.field.LogicalName),t){var y=r.columns.findIndex(e=>e.field.LogicalName===t),g=r.columns[y];return r.rows=function(e,t,a){t&&t!==a&&e.forEach(e=>{e[a]=e[t],delete e[t]});return e}(r.rows,t,b.field.LogicalName),r.rows=function(e,t,a,n,o,r){var l,s=Object(m.d)(n),c=Object(m.d)(o),d=null===(l=m.b[s])||void 0===l?void 0:l[c];if(void 0===d)return a;return a.forEach(a=>{var n;if(null==a||null===(n=a.params)||void 0===n||!n.isLastRow){var l=t.getValue(a[i.k],o.field.LogicalName);if(null!==l.raw){var s=Object(m.c)(o,l,r,d);s=function(e,t,a,i){var{cellHasErrors:n,validationResult:o}=e.validateCell(t,a,i);if(n)return Object(u.d)(i);return Object(u.d)(o.parsedValue)}(e,a[i.k],o,s),a[o.field.LogicalName]=s}}}),a}(this.agGridValidationProvider,this.agGridRowDataWithoutConversionsProvider,r.rows,g,b,this.props.formattingSettings),r.columns[y]=b,v(v({},r),{},{manyToOneRelationships:[...r.manyToOneRelationships.filter(e=>O(e,r.metadata.LogicalName,t)),...p||[]],columns:[...r.columns],newAutoNumberSeeds:f})}return v(v({},r),{},{rows:r.rows.map(e=>(e[b.field.LogicalName]=null,e)),columns:r.columns.filter(e=>!e.isHidden).concat([b]).concat(r.columns.filter(e=>e.isHidden)),manyToOneRelationships:[...r.manyToOneRelationships,...p||[]]})})}updateCellValue(e,t,a){var o;Object(r.W)(l.b,{eventName:l.a.runtimeProvider.updateCellValue,eventData:{id:e,logicalName:t}});var u,s=this.agGridTable.rows.findIndex(t=>t[i.k]===e),c=null===(o=this.agGridTable.rows[s].params)||void 0===o?void 0:o.isLastRow;(c&&(e=Object(n.a)()),this.updateAgGridTable(n=>{var o,r=this.agGridTable.columns.find(e=>e.field.LogicalName===t),{value:l}=this.agGridRowDataWithoutConversionsProvider.validateCellAndUpdateCellValue(e,r,a);return n.rows[s]=v(v({},n.rows[s]),{},{[i.k]:e,params:v(v({},null===(o=n.rows[s])||void 0===o?void 0:o.params),{},{isLastRow:!1}),[t]:l}),n.rows=[...n.rows,...c?[g(!0,n.columns)]:[]],v({},n)}),e)&&(null===(u=this.props.getPaGridAPI())||void 0===u||u.setRowSelection(e,!0))}hideColumn(e){Object(r.W)(l.b,{eventName:l.a.runtimeProvider.hideColumn,eventData:{logicalName:e}}),this.updateAgGridTable(t=>v(v({},t),{},{columns:t.columns.filter(t=>!t.isHidden&&t.field.LogicalName!==e).concat(t.columns.filter(e=>e.isHidden)).concat(t.columns.filter(t=>t.field.LogicalName===e).map(e=>v(v({},e),{},{isHidden:!0})))}))}setVisibleOrderedColumns(e){Object(r.W)(l.b,{eventName:l.a.runtimeProvider.setVisibleOrderedColumns,eventData:{logicalNames:e}});var t=new Set(e);this.updateAgGridTable(a=>{var i=[];return e.forEach(e=>{var t=a.columns.find(t=>t.field.LogicalName===e);t&&i.push(v(v({},t),{},{isHidden:!1}))}),v(v({},a),{},{columns:i.concat(a.columns.filter(e=>!t.has(e.field.LogicalName)).map(e=>v(v({},e),{},{isHidden:!0})))})})}blockUi(e){Object(r.W)(l.b,{eventName:l.a.runtimeProvider.setVisibleOrderedColumns,eventData:{}}),this.updateAgGridTable(t=>v(v({},t),{},{columns:t.columns.map(a=>Object(u.a)({onDeleteColumn:this.deleteColumn.bind(this),onHideColumn:this.hideColumn.bind(this),onOpenConfirmDialog:this.props.onOpenConfirmDialog},a.field,t.metadata.LogicalName,this.props.formattingSettings,this.props.availableLanguages,this.props.agGridLocalizedStrings,this.props.configurationType,e,this.props.relatedDataSetProvider,this.props.t,a.isHidden))}))}moveColumn(e,t){Object(r.W)(l.b,{eventName:l.a.runtimeProvider.moveColumn,eventData:{logicalName:e,position:t}}),this.updateAgGridTable(a=>v(v({},a),{},{columns:Object(o.b)(a.columns,e,t-1)}))}updateTableMetadata(e,t){Object(r.W)(l.b,{eventName:l.a.runtimeProvider.updateTableMetadata,eventData:{previous:{logicalName:e},new:{logicalName:t.LogicalName}}}),this.updateAgGridTable(a=>{var i=function(e,t,a){if(!t||t===a)return e;var i=v({},e),n=i[t];return delete i[t],i[a]=n,i}(a.autoNumberSeeds,e,t.LogicalName),n=function(e,t,a,i){if(!t||t===a)return e;return e.forEach(e=>(e.relationship.ReferencingEntity===t&&(e.relationship.SchemaName=e.relationship.SchemaName.replace(new RegExp("^"+e.relationship.ReferencingEntity),a),e.relationship.SchemaName=e.relationship.SchemaName.replace(new RegExp("^".concat(i,"_").concat(e.relationship.ReferencedEntity,"_").concat(e.relationship.ReferencingEntity)),"".concat(i,"_").concat(e.relationship.ReferencedEntity,"_").concat(a)),e.relationship.ReferencingEntity=a),e)),e}(a.manyToOneRelationships,e,t.LogicalName,this.props.customizationPrefix);return v(v({},a),{},{metadata:v({},t),autoNumberSeeds:i,manyToOneRelationships:n})})}getAgGridRowDataWithoutConversionsProvider_DO_NOT_USE(){return this.agGridRowDataWithoutConversionsProvider}getAgGridValidationProvider(){return this.agGridValidationProvider}getAgGridTable_DO_NOT_USE(){return this.props.getAgGridTable()}}function g(e,t){var a=h(e);return t.forEach(e=>{a[e.field.LogicalName]=null}),a}function h(e){return{[i.k]:Object(n.a)(),[i.l]:{error:void 0},params:{isLastRow:e}}}function O(e,t,a){return e.relationship.ReferencingEntity!==t||e.relationship.ReferencingEntity===t&&e.relationship.ReferencingAttribute!==a}},37596:function(e,t,a){"use strict";a.d(t,"f",(function(){return R})),a.d(t,"b",(function(){return F})),a.d(t,"a",(function(){return z})),a.d(t,"c",(function(){return U})),a.d(t,"e",(function(){return q})),a.d(t,"d",(function(){return _}));var i=a(23061),n=a(37574),o=a(23285),r=a(20879),l=a(23297),u=a(23952),s=a(23296),c=a(23962),d=a(23295),m=a(20880),p=a(23951),b=a(37595),v=a(37576),f=a(20793),y=a(20770),g=a(20862),h=a(37597),O=a(37598),C=a(24028),N=a(12353),T=a(37607),j=a(37592),S=a(37608),D=a(37609),E=a(23299),L=a(11885),P=a(37610),w=["Attributes","ManyToManyRelationships","OneToManyRelationships","ManyToOneRelationships"];function A(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function M(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?A(Object(a),!0).forEach((function(t){V(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):A(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function V(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function I(e,t){if(null==e)return{};var a,i,n=function(e,t){if(null==e)return{};var a,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)a=o[i],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)a=o[i],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}Object(S.a)();var R={createField:!0,updateField:!0,createEntity:!0,viewData:!0,editData:!0,addData:!0,deleteData:!0,canWriteForms:!0,canWriteViews:!0},x={aliasedValueDescriptors:{},entity2AttributesMap:{}};function F(e,t,a,i,o,r,l,u,s,c){var d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:n.b.Dataverse;(t=Object(N.cloneDeep)(t)).entity=Object(v.d)(t.entity,u),t.entity.Attributes=t.entity.Attributes.map(e=>Object(v.c)(e,t.entity.LogicalName,u)),t.entity.ManyToOneRelationships=t.entity.ManyToOneRelationships.map(e=>Object(v.e)(e));var m=k(e,t,a,i,o,r,l,s,c),p=U(t.entity.ManyToOneRelationships),b=r!==n.a.ImportExcel&&r!==n.a.ImportFromConnector||d!==n.b.ExcelAndConnectorInference?G(t,m):W(t,m,a),f=t.entity,{Attributes:y,ManyToManyRelationships:g,OneToManyRelationships:h,ManyToOneRelationships:O}=f,C=I(f,w);return{columns:m,rows:b,metadata:C,autoNumberSeeds:t.autoNumberSeeds,manyToOneRelationships:p}}function k(e,t,a,i,n,o,r,l,u){return t.entity.Attributes.map(s=>z(e,s,t.entity.LogicalName,a,i,n,o,r,l,u))}function z(e,t,a,n,l,m,p,b,v,f){var y=arguments.length>10&&void 0!==arguments[10]&&arguments[10],{onDeleteColumn:g,onHideColumn:h}=e,N=Object(r.b)(t,a),T=Object(s.b)(N,!1,void 0),S=Object(C.c)(t),D=Object(d.c)(T,T.LogicalName,!1,0,!1,!!t.IsPrimaryName,R),E=Object(u.b)(T),L=e=>Object(O.a)(t,T,n,e,l,f),P=Object(u.c)(E,m),w={moveMenuItem:"hide",insertMenuItem:b||Object(j.a)(p)?"hide":"show",deleteMenuItem:b||Object(j.a)(p)||t.IsPrimaryName?"hide":"show",editMenuItem:b?"hide":"show",hideMenuItem:b||Object(j.a)(p)?"hide":"show",filterMenuItem:"hide",sortMenuItem:"hide",pinMenuItem:"hide"};return M(M({},w),{},{name:t.LogicalName,displayName:t.DisplayName.LocalizedLabels[0].Label||"",isPrimary:!!t.IsPrimaryName,width:Object(u.a)(E),minWidth:c.i,isRequired:Object(o.d)(t.RequiredLevel.Value),dataType:E,editable:!b&&!Object(j.a)(p)&&(null==T?void 0:T.IsEditable)&&(null==T?void 0:T.IsReadable)&&Object(u.d)(E),sortDirection:i.r.None,showHeaderIcon:!0,customizerParams:H(D,E,T,L,v,n,l,p,f),defaultPlaceHolder:P,onHide:()=>{h(t.LogicalName)},onDelete:()=>{e.onOpenConfirmDialog({type:"deleteColumn",title:f("actions.deleteColumnConfirm.title"),subText:f("actions.deleteColumnConfirm.subText"),defaultButtonText:f("actions.deleteColumnConfirm.defaultButtonText"),primaryButtonText:f("actions.deleteColumnConfirm.primaryButtonText"),onConfirm:()=>{g(t.LogicalName)}})},field:t,isHidden:y,validate:L,attributeDescriptor:N,attributeMetadata:T,designerField:S})}function U(e){return e.map(B)}function B(e){return{relationship:e}}function W(e,t,a){var i=[];return e.data.forEach(e=>{var n=Object(b.b)(!1,t);t.forEach(t=>{var i,o=e[t.field.LogicalName],r={raw:_(o),formatted:_(o)},l=Object(D.d)(t),u=null===(i=D.b[D.a.String])||void 0===i?void 0:i[l];o=Object(D.c)(t,r,a,u),n[t.field.LogicalName]=o}),i.push(n)}),i}function G(e,t){var a=e.entity.Attributes.map(e=>e.LogicalName),i=new y.a(a),n=Object(h.a)([e.entity]);return e.data.map(o=>{var r,l,u,s,c={};t.filter(e=>e.field.AttributeType===L.d.DateTime).forEach(e=>{var t=o[e.field.LogicalName];Object(P.b)(t)||(c[e.field.LogicalName]=t,delete o[e.field.LogicalName])});var d=Object(f.b)(n,o,null===(r=n.metadata)||void 0===r||null===(l=r.entities)||void 0===l?void 0:l[e.entity.LogicalName],null===(u=n.metadata)||void 0===u||null===(s=u.attributes)||void 0===s?void 0:s[e.entity.LogicalName],a,i,null,x,void 0,f.a.OData,void 0),p=Object(g.a)(d),v={};return a.forEach(e=>{v[e]=null}),Object.keys(null==p?void 0:p.fields).forEach(e=>{var t=_(Object(m.k)(p.fields[e]));v[e]=t}),M(M(M({},Object(b.c)(!1)),v),c)})}function H(e,t,a,i,n,o,r,l,u){var s={alwaysShowErrors:!0,getFormattedValue:(e,t)=>q(t,a,o),getValidationError:(e,t)=>{var a=i(t);return a.validationErrorString?Promise.resolve(new Error(a.validationErrorString)):Promise.resolve(void 0)}};switch(t){case"OptionSet":case"MultiSelectPicklist":return Object(p.f)(s,e,void 0);case"TwoOptions":return Object(p.h)(s,e);case"DateOnly":case"DateAndTime":return Object(p.d)(s,e);case"TimeZone":return function(e,t,a){var i=(a.timeZoneDefinitions||[]).reduce((e,t)=>M(M({},e),{},{[t.TimeZoneCode]:t.UserInterfaceName}),{});return M(M({},Object(p.g)(e,t)),{},{timeZoneByCode:i})}(s,e,o);case"Language":return function(e,t,a){var i=a.reduce((e,t)=>M(M({},e),{},{[t]:T.a.getLocalizedString("languages.lang_"+t,[])}),{});return M(M({},Object(p.e)(e,t)),{},{languageByCode:i})}(s,e,r);case"Lookup":return function(e,t,a){var i,n=null===(i=a.attributes)||void 0===i?void 0:i.Targets;return M({targets:n,getLookupColumns:()=>e.getEntityColumns(n[0]),getLookupRows:t=>e.getEntityData(n[0]),useLookupForOwnerEqFilters:!0},t)}(n,s,e);default:return s}}function q(e,t,a,i){if(i&&(t.Type===E.a.Integer||t.Type===E.a.BigInt)&&(null==e?void 0:e.toString().split(a.numberFormat.NumberDecimalSeparator).length)>1)return null==e?void 0:e.toString();var n=Object(l.a)(e,t,a);return null!=n?n:null==e?"":e.toString()}function _(e){return void 0===e?null:e}},37597:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var i=a(20830),n=a(20880),o=a(20879);function r(e){var t={metadata:{attributes:{},entities:{}}};return e.forEach(e=>{var a=Object(i.a)(e,0,0,!1,n.f.Initialized),r={};e.Attributes.forEach(t=>{var a=Object(o.b)(t,e.LogicalName);r[a.LogicalName]=a}),t.metadata.attributes[e.LogicalName]=r,t.metadata.entities[e.LogicalName]=a}),t}},37598:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var i=a(23306),n=a(11883),o=a(23730),r=a(23311),l=a(23310),u=a(37599),s=a(37601),c=a(37600),d=a(37602),m=a(37603),p=a(11885),b=a(37604),v=a(37605),f=a(37606);function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function g(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function h(e,t,a,h,O,C){var N=[];if(e.AttributeType===n.j.Memo){var T=e.MaxLength;Object(o.a)(T)||N.push(Object(r.a)(T))}else if(e.AttributeType===n.j.Double){var j=e.MinValue;Object(o.a)(j)||N.push(Object(l.b)(j));var S=e.MaxValue;Object(o.a)(S)||N.push(Object(l.a)(S))}else if(e.AttributeType===n.j.Integer)e.Format===n.s.Language?N.push(Object(u.a)(O)):e.Format===n.s.TimeZone&&N.push(Object(s.a)(a.timeZoneDefinitions));else if(e.AttributeType===n.j.Lookup||e.AttributeType===n.j.Customer)N.push(Object(d.a)());else if(e.AttributeType===n.j.Boolean){var D,E,L=e;N.push(Object(v.a)(null===(D=L.OptionSet.TrueOption.Label.LocalizedLabels[0])||void 0===D?void 0:D.Label,null===(E=L.OptionSet.FalseOption.Label.LocalizedLabels[0])||void 0===E?void 0:E.Label))}else if(e.AttributeTypeName.Value===p.e.ImageType)N.push(Object(f.a)());else if(e.AttributeType===n.j.Picklist){var P=e.OptionSet.Options.map(e=>e.Value.toString());N.push(Object(m.a)(P))}else if(e.AttributeType===n.j.Virtual){if(e.AttributeTypeName.Value===p.e.MultiSelectPicklistType){var w=e.OptionSet.Options.map(e=>e.Value);N.push(Object(b.a)(w))}}else if(e.AttributeType===n.j.String){e.FormatName.Value===p.D.Email&&delete(t=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){g(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},t)).Format}return Object(i.a)(t,a,{validators:N,validationErrors:{[c.a.InvalidValue]:C("validations.cellLevel.invalidValue")}})(h)}},37599:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var i=a(37600);function n(e){return t=>e.some(e=>e===t)?null:i.a.InvalidValue}},37600:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var i=function(e){return e[e.InvalidLanguageCode=98100]="InvalidLanguageCode",e[e.InvalidValue=98101]="InvalidValue",e}({})},37601:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var i=a(37600);function n(e){return t=>e.some(e=>e.TimeZoneCode===t)?null:i.a.InvalidValue}},37602:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var i=a(37600),n=a(20880);function o(){return e=>e.id===n.e.EMPTY?i.a.InvalidValue:null}},37603:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var i=a(37600);function n(e){return t=>e.some(e=>e===t)?null:i.a.InvalidValue}},37604:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var i=a(37600),n=a(23728);function o(e){return t=>{var a=t,o=Object(n.b)(t,!0);if(null!==o&&(a=o),!Array.isArray(a))return i.a.InvalidValue;var r=e.find(e=>a.find(t=>e.toString()===t));return null==r?i.a.InvalidValue:null}}},37605:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var i=a(37600),n=a(23730);function o(e,t){return a=>{var o=Object(n.c)(a,e,t);return null===o&&(o=a),!0!==o&&!1!==o?i.a.InvalidValue:null}}},37606:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var i=a(37600);function n(){return e=>null!=e?i.a.InvalidValue:null}},37608:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var i=a(11465),n=a(37607);var o=new class{constructor(){this._translationFn=void 0}getLocalizedString(e,t){return this.getTranslationFn()(e)}getTranslationFn(){return this._translationFn||(this._translationFn=Object(i.i)("PCFLocalizationProvider")),this._translationFn}};function r(){i.p&&Object(i.p)("PCFLocalizationProvider").catch(()=>{throw Error("Error loading PCF localization library")}),n.a.initWithProvider(o)}},37609:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return b})),a.d(t,"d",(function(){return v})),a.d(t,"c",(function(){return f}));var i=a(11885),n=a(20880),o=a(37610),r=a(37596),l=a(23951);function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var d=function(e){return e[e.FormattedValueToLookup=0]="FormattedValueToLookup",e[e.AnyToFormattedValue=1]="AnyToFormattedValue",e[e.FormattedValueToPicklist=2]="FormattedValueToPicklist",e[e.ValueToNull=3]="ValueToNull",e[e.FormattedValueToMultiPicklist=4]="FormattedValueToMultiPicklist",e[e.FormattedValueToBoolean=5]="FormattedValueToBoolean",e[e.FormattedValueToDateTime=6]="FormattedValueToDateTime",e[e.FormattedValueToTimeZone=7]="FormattedValueToTimeZone",e[e.FormattedValueToLanguageCode=8]="FormattedValueToLanguageCode",e}(d||{}),m=function(e){return e.String="String",e.Decimal="Decimal",e.Integer="Integer",e.BigInt="BigInt",e.TimeZone="TimeZone",e.LanguageCode="LanguageCode",e.DateAndTime="DateAndTime",e.DateOnly="DateOnly",e.Lookup="Lookup",e.Customer="Customer",e.Picklist="Picklist",e.MultiPicklist="MultiPicklist",e.File="File",e.Image="Image",e.Double="Double",e.Boolean="Boolean",e.Money="Money",e.Unknown="Unknown",e}({}),p={[m.Decimal]:d.AnyToFormattedValue,[m.Money]:d.AnyToFormattedValue,[m.Integer]:d.AnyToFormattedValue,[m.BigInt]:d.AnyToFormattedValue,[m.Double]:d.AnyToFormattedValue,[m.String]:d.AnyToFormattedValue,[m.DateAndTime]:d.FormattedValueToDateTime,[m.DateOnly]:d.FormattedValueToDateTime,[m.Lookup]:d.FormattedValueToLookup,[m.Boolean]:d.FormattedValueToBoolean,[m.TimeZone]:d.FormattedValueToTimeZone,[m.LanguageCode]:d.FormattedValueToLanguageCode,[m.Picklist]:d.FormattedValueToPicklist,[m.MultiPicklist]:d.FormattedValueToMultiPicklist,[m.Customer]:d.ValueToNull,[m.File]:d.ValueToNull,[m.Image]:d.ValueToNull},b={[m.String]:p,[m.Boolean]:p,[m.Picklist]:p,[m.MultiPicklist]:p,[m.Double]:p,[m.Decimal]:p,[m.Integer]:p,[m.BigInt]:p,[m.TimeZone]:p,[m.LanguageCode]:p,[m.Money]:p,[m.DateAndTime]:p,[m.DateOnly]:p,[m.Lookup]:p,[m.File]:s(s({},p),{},{[m.File]:d.ValueToNull}),[m.Image]:s(s({},p),{},{[m.Image]:d.ValueToNull}),[m.Customer]:s(s({},p),{},{[m.Customer]:d.ValueToNull})};function v(e){var t,a,n;switch(e.field.AttributeType){case i.d.String:case i.d.Memo:return m.String;case i.d.Double:return m.Double;case i.d.Decimal:return m.Decimal;case i.d.Integer:switch(e.field.Format){case i.o.TimeZone:return m.TimeZone;case i.o.Language:return m.LanguageCode;default:return m.Integer}case i.d.BigInt:return m.BigInt;case i.d.DateTime:switch(e.field.Format){case i.i.DateAndTime:return m.DateAndTime;case i.i.DateOnly:return m.DateOnly;default:return m.Unknown}case i.d.Picklist:return m.Picklist;case i.d.Customer:return m.Customer;case i.d.Virtual:return(null===(t=e.field.AttributeTypeName)||void 0===t?void 0:t.Value)===i.e.MultiSelectPicklistType?m.MultiPicklist:(null===(a=e.field.AttributeTypeName)||void 0===a?void 0:a.Value)===i.e.FileType?m.File:(null===(n=e.field.AttributeTypeName)||void 0===n?void 0:n.Value)===i.e.ImageType?m.Image:m.Unknown;case i.d.Lookup:return m.Lookup;case i.d.Boolean:return m.Boolean;case i.d.Money:return m.Money;default:return m.Unknown}}function f(e,t,a,r){var u,{raw:s,formatted:c}=t,p=s,b=v(e);if(r===d.ValueToNull)p=null;else if(r===d.FormattedValueToLookup){var f=y(c,e,a);if(null!=f&&""!==f)if((null==(u=s)?void 0:u.etn)&&(null==u?void 0:u.id)&&(null==s?void 0:s.etn)===e.field.Targets[0])p=s;else p=new n.c(e.field.Targets[0],null,f);else p=null}else if(r===d.FormattedValueToPicklist){var g,h,O,C,N=e.field,T=c,j=N.OptionSet.Options.find(e=>{var t;return(null===(t=e.Label.UserLocalizedLabel)||void 0===t?void 0:t.Label)===T});if(j||(j=N.OptionSet.Options.find(e=>{var t;return(null===(t=e.Value)||void 0===t?void 0:t.toString())===(null==s?void 0:s.toString())})),null!==(g=j)&&void 0!==g&&g.Value.toString())p=null===(h=j)||void 0===h?void 0:h.Value.toString();else p=(null===(O=N.OptionSet.Options.find(e=>e.Value===N.DefaultFormValue))||void 0===O||null===(C=O.Value)||void 0===C?void 0:C.toString())||null}else if(r===d.FormattedValueToMultiPicklist){var S=y(c,e,a),D=(null==S?void 0:S.split(",").map(e=>e.trim()))||[],E=e.field,L=[];if(D.forEach(e=>{var t=E.OptionSet.Options.find(t=>{var a;return(null===(a=t.Label.UserLocalizedLabel)||void 0===a?void 0:a.Label)===e});t&&L.push(t.Value)}),0===L.length){var P=[];Array.isArray(s)?P=s:"string"==typeof s&&(P=[parseInt(s,10)]),P.forEach(e=>{var t=E.OptionSet.Options.find(t=>t.Value===e);t&&L.push(t.Value)})}p=L.length===D.length?L:S}else if(r===d.FormattedValueToBoolean){var w,A,M=y(c,e,a),V=e.field,I=V.OptionSet,R=new Set([null===(w=I.TrueOption.Label.UserLocalizedLabel)||void 0===w?void 0:w.Label.toLowerCase(),"true","1"]),x=new Set([null===(A=I.FalseOption.Label.UserLocalizedLabel)||void 0===A?void 0:A.Label.toLowerCase(),"false","0"]);p=!(!R.has(null==M?void 0:M.toLowerCase())&&!0!==s)||!x.has(null==M?void 0:M.toLowerCase())&&!1!==s&&(1===V.DefaultValue||!0===V.DefaultValue)}else if(r===d.FormattedValueToTimeZone){var F=y(c,e,a),k=a.timeZoneDefinitions.find(e=>e.UserInterfaceName===F);p=(null==k?void 0:k.TimeZoneCode)||F}else if(r===d.FormattedValueToLanguageCode){var z=y(c,e,a),U=e.customizerParams.languageByCode,B=Object.keys(U).find(e=>U[e]===z);p=B?parseInt(B,10):z}else if(r===d.FormattedValueToDateTime){var W=y(c,e,a);if(Object(o.b)(s)&&!Object(l.i)(W))p=Object(o.a)(new Date(Date.parse(s)),e.field.DateTimeBehavior.Value===i.h.TimeZoneIndependent,b===m.DateOnly);else if(isNaN(W)){var G=(0,e.customizerParams.parseDateFromInput)(W);p=G&&!isNaN(G)?Object(o.a)(G,e.field.DateTimeBehavior.Value===i.h.TimeZoneIndependent,b===m.DateOnly):W}else p=W}else r===d.AnyToFormattedValue&&(p=y(c,e,a));return p}function y(e,t,a){var i=e,n=t.validate(i);return n.validationError||(i=n.parsedValue),i=Object(r.e)(i,t.attributeMetadata,a)}},37610:function(e,t,a){"use strict";function i(e,t,a){if(a){if(t){var i=e.getFullYear().toString().padStart(2,"0"),n=(e.getMonth()+1).toString().padStart(2,"0"),o=e.getDate().toString().padStart(2,"0");return"".concat(i,"-").concat(n,"-").concat(o,"T00:00:00.000Z")}e=new Date(e.getFullYear(),e.getMonth(),e.getDate())}return e.toISOString()}function n(e){if("string"!=typeof e||null==e)return!1;var t=Date.parse(e);if(!isNaN(t)&&new Date(t).toISOString()===e)return!0;return/^(\d{4}-\d{2}-\d{2})(T\d{2}:\d{2}:\d{2}(\.\d{1,3})?)?(Z|[+-]\d{2}:?\d{2})?$/.test(e)}a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return n}))},37611:function(e,t,a){"use strict";a.d(t,"a",(function(){return v})),a.d(t,"c",(function(){return f})),a.d(t,"d",(function(){return y})),a.d(t,"b",(function(){return g}));var i=a(37576),n=a(37612),o=a(37574),r=a(11021),l=a(37572),u=a(37613),s=a(10920),c=a(21618),d=a(21639);function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach((function(t){b(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class v{constructor(e){this.props=e,this.dataErrors={},this.metadataErrors=[]}getDataErrors_DO_NOT_USE(){return this.dataErrors}onUpdateValidationErrors(e){this.props.onUpdateValidationErrors(e)}validateCell(e,t,a){var i=t.validate(a),n=null!==i.validationError;if(this.props.configurationType===o.a.ConversationalReadOnly&&n){var c="test"===Object(s.j)().region,d={columntMetadata:Object(u.a)(t.field),validationError:i.validationErrorString,rowId:e};c&&(d=p(p({},d),{},{value:a})),Object(r.jb)(l.b,{eventName:l.a.validationProvider.validateCell,eventData:d})}return this.dataErrors[e]||(this.dataErrors[e]={}),this.dataErrors[e][t.field.LogicalName]=n,{validationResult:i,cellHasErrors:n}}validateTable(e){this.metadataErrors=[];var t={};e.columns.some(e=>e.field.IsPrimaryName)||(this.metadataErrors.push({message:this.props.t("validations.tableLevel.primaryNameColumnRequired"),code:"MissingPrimaryNameColumn"}),t=p(p({},t),{},{isPrimaryNameMissing:!0}));var a=Object(n.a)(e.columns.map(e=>e.field.SchemaName));a.length>0&&(this.metadataErrors.push({message:this.props.t("validations.tableLevel.duplicateColumnSchemaNames",{duplicateSchemaNames:a.join(", ")})}),t=p(p({},t),{},{hasDuplicateColumnSchemaNames:!0})),!e.metadata.DisplayName.LocalizedLabels[0].Label&&(this.metadataErrors.push({message:this.props.t("validations.tableLevel.invalidTableDisplayName")}),t=p(p({},t),{},{hasEmptyEntityDisplayName:!0})),e.columns.some(e=>!e.field.DisplayName.LocalizedLabels[0].Label)&&(this.metadataErrors.push({message:this.props.t("validations.tableLevel.invalidColumnDisplayName")}),t=p(p({},t),{},{hasEmptyColumnDisplayName:!0}));var i=e.columns.map(e=>{var t,a;return Object(c.f)(d.m,e.field.SchemaName,(null===(t=e.field.DisplayName)||void 0===t||null===(a=t.LocalizedLabels[0])||void 0===a?void 0:a.Label)||e.field.SchemaName)}).filter(Boolean);i.length>0&&(this.metadataErrors.push({message:this.props.t("validations.tableLevel.invalidColumnSchemaNames",{invalidSchemaNames:i.join(", ")})}),t=p(p({},t),{},{hasInvalidColumnLogicalNames:!0}));var u=Object(c.f)(d.m,e.metadata.SchemaName,this.props.t("validations.tableLevel.invalidTableSchemaName"));u&&(this.metadataErrors.push({message:u}),t=p(p({},t),{},{hasEntitySchemaNameError:!0})),this.props.configurationType===o.a.ConversationalReadOnly&&Object.keys(t).length>0&&Object(r.jb)(l.b,{eventName:l.a.validationProvider.validateTable,eventData:t})}deleteRows(e){e.forEach(e=>{delete this.dataErrors[e]})}upsertColumn(e,t){e&&e!==t&&Object.keys(this.dataErrors).forEach(a=>{this.dataErrors[a][t]=this.dataErrors[a][e],delete this.dataErrors[a][e]})}deleteColumn(e){Object.keys(this.dataErrors).forEach(t=>{delete this.dataErrors[t][e]}),Object.keys(this.dataErrors).some(e=>Object.keys(this.dataErrors[e]).length>0)||(this.dataErrors={})}updateState(){Object.keys(this.dataErrors).forEach(e=>{Object.keys(this.dataErrors[e]).forEach(t=>{this.dataErrors[e][t]||delete this.dataErrors[e][t]}),0===Object.keys(this.dataErrors[e]).length&&delete this.dataErrors[e]});var e=Object.keys(this.dataErrors).some(e=>Object.keys(this.dataErrors[e]).some(t=>this.dataErrors[e][t])),t=[];e&&this.props.configurationType!==o.a.ImportExcel&&this.props.configurationType!==o.a.ImportFromConnector&&t.push({message:this.props.t("validations.rowLevel.hasErrors")}),t=t.concat(this.metadataErrors),this.onUpdateValidationErrors({errorMessages:t,hasDataErrors:e,hasMetadataErrors:this.metadataErrors.length>0})}}function f(e,t,a){return(!t||Object(i.j)(t)!==Object(i.j)(a))&&e.columns.some(e=>Object(i.j)(e.field.SchemaName)===Object(i.j)(a))}function y(e,t,a){return(!t||Object(i.j)(t)!==Object(i.j)(a))&&e.manyToOneRelationships.some(e=>Object(i.j)(e.relationship.SchemaName)===Object(i.j)(a))}function g(e,t){return e===o.a.ImportExcel||e===o.a.ImportFromConnector?!t.hasMetadataErrors:!t.hasMetadataErrors&&!t.hasDataErrors}},37612:function(e,t,a){"use strict";function i(e){var t=new Set(e);return Array.from(t).filter(t=>e.indexOf(t)!==e.lastIndexOf(t))}a.d(t,"a",(function(){return i}))},37613:function(e,t,a){"use strict";function i(e){return{AttributeType:e.AttributeType,AttributeTypeName:e.AttributeTypeName,FormatName:e.FormatName,Format:e.Format,"@odata.type":e["@odata.type"]}}a.d(t,"a",(function(){return i}))},37614:function(e,t,a){"use strict";function i(e,t){var a;return null===(a=e.columns.find(e=>e.field.LogicalName===t))||void 0===a?void 0:a.isHidden}function n(e,t){var a,i;return null===(a=e.autoNumberSeeds[null==e||null===(i=e.metadata)||void 0===i?void 0:i.LogicalName])||void 0===a?void 0:a[t]}function o(e,t){return e.manyToOneRelationships.filter(a=>a.relationship.ReferencingEntity===e.metadata.LogicalName&&a.relationship.ReferencingAttribute===t)}a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return o}))},37615:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var i=a(37596),n=a(23061),o=a(37574);class r{constructor(e){this.props=e,this.rowDataWithoutConversions={}}getRowDataWithoutConversions_DO_NOT_USE(){return this.rowDataWithoutConversions}loadAndValidateTable(e,t,a){this.rowDataWithoutConversions={};var i=[];a===o.b.ExcelAndConnectorInference&&(i=t.data),e.rows.forEach((t,r)=>{Object.keys(t).forEach(l=>{var u=e.columns.find(e=>e.field.LogicalName===l);if(u){var s,c;if(a===o.b.ExcelAndConnectorInference)s=null===(c=i[r])||void 0===c?void 0:c[l];var d=t[l];this.validateCellAndUpdateCellValue(t[n.k],u,d,s)}})}),this.updateState()}updateState(){this.props.onUpdateRowDataWithoutConversions(this.rowDataWithoutConversions)}deleteRows(e){e.forEach(e=>{delete this.rowDataWithoutConversions[e]}),this.updateState()}upsertColumn(e,t){e&&e!==t&&Object.keys(this.rowDataWithoutConversions).forEach(a=>{this.rowDataWithoutConversions[a][t]=this.rowDataWithoutConversions[a][e],delete this.rowDataWithoutConversions[a][e]}),this.updateState()}getValue(e,t){var a,i=null===(a=this.rowDataWithoutConversions[e])||void 0===a?void 0:a[t];return null==i?{raw:null,formatted:null}:i}validateCellAndUpdateCellValue(e,t,a,n){this.rowDataWithoutConversions[e]||(this.rowDataWithoutConversions[e]={});var{validationResult:o,cellHasErrors:r}=this.props.agGridValidationProvider.validateCell(e,t,a),l=Object(i.d)(o.parsedValue);if(a=r?a:l,null==n){var u=Object(i.e)(a,t.attributeMetadata,this.props.formattingSettings,!0);this.rowDataWithoutConversions[e][t.field.LogicalName]={formatted:u,raw:a}}else this.rowDataWithoutConversions[e][t.field.LogicalName]={formatted:n,raw:n};return this.updateState(),{value:a}}deleteColumn(e){Object.keys(this.rowDataWithoutConversions).forEach(t=>{delete this.rowDataWithoutConversions[t][e]}),Object.keys(this.rowDataWithoutConversions).some(e=>Object.keys(this.rowDataWithoutConversions[e]).length>0)||(this.rowDataWithoutConversions={}),this.updateState()}}},37616:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var i=a(12353),n=a(37576),o=a(23312),r=a(20880),l=a(20792),u=a(20871),s=a(20891),c=a(23951),d=a(37597);function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach((function(t){b(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var v=(new s.a).getTracer("InMemoryTable_Save");function f(e,t,a){var s=Object(i.cloneDeep)(e.rows),m=Object(i.cloneDeep)(e.columns.map(e=>e.field)),b=Object(i.cloneDeep)(e.metadata),f=Object(i.cloneDeep)(e.manyToOneRelationships.map(e=>e.relationship)),y=b.LogicalName,g=[];g.push(p(p({},b),{},{Attributes:m,ManyToOneRelationships:f,OneToManyRelationships:[],ManyToManyRelationships:[]})),g=g.concat(t);var h=Object(d.a)(g),O={};e.columns.forEach(e=>{O[e.attributeDescriptor.LogicalName]=e.attributeDescriptor}),h.metadata.attributes[y]=O;var C=[];s.forEach((t,a)=>{var i;if(null===(i=t.params)||void 0===i||!i.isLastRow){var n={identifier:{etn:y,id:{guid:"00000000-0000-0000-0000-000000000000"}},mode:r.h.Create,activeChanges:{},lockedChanges:{}};e.columns.forEach(e=>{var a=e.field.LogicalName,i=Object(c.c)(t[a]),r=e.validate(i),l={errorMessage:r.validationErrorString||"",isValueValid:null===r.validationError};if(l.isValueValid||!l.errorMessage){var u=(null==i?void 0:i.toString())||"",s=r.parsedValue;n.activeChanges[a]=Object(o.a)(s,e.attributeMetadata.Type,l,new Date,u)}});var s=Object(u.a)(h,n,v),d=Object(l.b)(h,s);C.push(d)}}),m=m.map(n.g),f=f.map(n.i);var N=Object(i.cloneDeep)(e.autoNumberSeeds);return{entity:p(p({},Object(n.h)(Object(i.cloneDeep)(e.metadata))),{},{Attributes:m,ManyToOneRelationships:f,OneToManyRelationships:[],ManyToManyRelationships:[]}),data:C,autoNumberSeeds:N,builtUsingDevEnvironmentDefaults:a}}},37617:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var i=a(10926),n=a.n(i),o=a(24170),r=a(11465);function l(e){var{createFieldDisabled:t}=e,{t:a}=Object(r.t)("PowerTableDesigner");return n.a.useMemo(()=>{var e=a("strings",{returnObjects:!0});return{agGridLocalizedStrings:Object(o.b)(t,e)}},[a,t])}},37618:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var i=a(11031),n=a(37595);function o(){return{columns:Array(10).fill(0).map(()=>({name:Object(i.a)(),displayName:void 0,editable:!0,customizerParams:{getCellAttributes:()=>Promise.resolve({editable:!1,readable:!0,secured:!0})}})),manyToOneRelationships:[],rows:Array(10).fill(0).map(()=>Object(n.c)(!1)),metadata:{SchemaName:Object(i.a)(),DisplayName:{LocalizedLabels:[{Label:"",LanguageCode:0}]}},autoNumberSeeds:{}}}},37619:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var i=a(10926),n=a.n(i),o=a(20582),r=a(12219),l=a(12313),u=a(14768),s=a(11225),c=a(24031),d=a(24030),m=a(14767);function p(e,t,a,i,n,o,r){try{var l=e[o](r),u=l.value}catch(s){return void a(s)}l.done?t(u):Promise.resolve(u).then(i,n)}function b(e){return function(){var t=this,a=arguments;return new Promise((function(i,n){var o=e.apply(t,a);function r(e){p(o,i,n,r,l,"next",e)}function l(e){p(o,i,n,r,l,"throw",e)}r(void 0)}))}}var v={data:void 0,error:null,isInitialLoading:!1},f={data:g(m.a.userContext),error:null,isInitialLoading:!1};function y(e,t){var a=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],{languageCode:a,getMetadataClient:i}=e,{currentEnvironment:m}=Object(r.W)(),p=Object(u.e)(),v=n.a.useMemo(()=>["powertable-inmemory-designer",null==m?void 0:m.name,"userContext"],[null==m?void 0:m.name]);n.a.useLayoutEffect(()=>{var{unregister:e}=p.register({persisterId:u.b.IndexedDB,queryKey:v,team:s.b.PowerappsPortal});return e},[v,p]);var f=function(){var e=b((function*(){var e,t=null==m||null===(e=m.properties.linkedEnvironmentMetadata)||void 0===e?void 0:e.instanceUrl,n=c.a.getInstance(t,a),r=new d.a(i(m),n,t),l=o.a.getInstance(m,Promise.resolve(r));return g(yield l.retrieveUserContext(!1))}));return function(){return e.apply(this,arguments)}}(),{data:y,isInitialLoading:h,error:O}=Object(l.a)(v,{queryFn:f,enabled:t});return{data:y,isInitialLoading:h,error:O}}(e,!t),i=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e?f:v}(!!t);return t?i:a}function g(e){var t,a,i,n,o;return{dateTimeFormat:null!==(t=null===(a=e.cultureInfo)||void 0===a?void 0:a.dateTimeFormat)&&void 0!==t?t:{},numberFormat:null!==(i=null===(n=e.cultureInfo)||void 0===n?void 0:n.numberFormat)&&void 0!==i?i:{},timeZoneDefinitions:null!==(o=e.timeZoneDefinitions)&&void 0!==o?o:[]}}},37620:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var i=a(10926),n=a.n(i),o=a(37621),r=a(37576),l=a(11883),u=a(11021),s=a(37572),c=a(12219),d=a(37586);function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach((function(t){b(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function v(e){var{setIsVisible:t,target:a,isLoading:i,isReadOnly:m,agGridTable:b,updateTableMetadata:v,upsertColumn:f,shouldSkipApiAndUseDevEnvironmentDefaults:y}=e,{currentEnvironment:g}=Object(c.W)(),h=Object(d.a)(g),O=n.a.useMemo(()=>{if(b&&!i&&a)return function(e,t){var a,i,n,o,r=e.metadata,u=e.columns.find(e=>e.field.IsPrimaryName),s=e.columns.filter(e=>e.field.AttributeType===l.j.String).map(e=>{var t;return{schemaName:e.field.SchemaName,displayName:null===(t=e.field.DisplayName.UserLocalizedLabel)||void 0===t?void 0:t.Label,dataType:e.field.AttributeType,format:e.field.Format}});t&&!u&&(s=[]);return{schemaName:r.SchemaName,displayName:(null===(a=r.DisplayName.UserLocalizedLabel)||void 0===a?void 0:a.Label)||"",pluralName:(null===(i=r.DisplayCollectionName.UserLocalizedLabel)||void 0===i?void 0:i.Label)||"",description:(null===(n=r.Description.UserLocalizedLabel)||void 0===n?void 0:n.Label)||"",primaryField:u?{schemaName:u.field.SchemaName,displayName:(null===(o=u.field.DisplayName.UserLocalizedLabel)||void 0===o?void 0:o.Label)||""}:void 0,enableAttachments:r.HasNotes,primaryFieldOptions:s}}(b,m)},[b,i,m,a]);return n.a.createElement(o.a,{showCallout:!!a,onDismiss:(e,i)=>{if(window.setTimeout(()=>{null==a||a.focus()}),Object(u.W)(s.b,{eventName:s.a.userActions.tableEditor.close,eventData:{dataWasUpdated:e}}),e&&null!=i&&i.tableToBeCreated){var n=Object(r.d)((o=b.metadata,l=null==i?void 0:i.tableToBeCreated,p(p({},o),{},{SchemaName:l.schemaName,HasNotes:l.hasNotes||!1,DisplayName:{LocalizedLabels:[p(p({},o.DisplayName.LocalizedLabels[0]),{},{Label:l.displayName})]},DisplayCollectionName:{LocalizedLabels:[p(p({},o.DisplayCollectionName.LocalizedLabels[0]),{},{Label:l.pluralName})]},Description:{LocalizedLabels:[p(p({},o.Description.LocalizedLabels[0]),{},{Label:l.description||""})]}})),h);v(b.metadata.LogicalName,n),null==b||b.columns.forEach(e=>{var t,a,o,l,u,s;(null==O||null===(t=O.primaryField)||void 0===t?void 0:t.schemaName)!==(null===(a=i.tableToBeCreated)||void 0===a||null===(o=a.primaryField)||void 0===o?void 0:o.schemaName)&&(e.field.SchemaName===(null==O||null===(l=O.primaryField)||void 0===l?void 0:l.schemaName)&&(e.field.IsPrimaryName=!1),e.field.SchemaName===(null==i||null===(u=i.tableToBeCreated)||void 0===u||null===(s=u.primaryField)||void 0===s?void 0:s.schemaName)&&(e.field.IsPrimaryName=!0));e.field=Object(r.c)(e.field,n.LogicalName,h),f(e.field)})}var o,l;t(void 0)},isStagedData:!0,shouldSkipApiAndUseDevEnvironmentDefaults:y,isReadOnlyMode:m,focusTrapCalloutTarget:a,tableDetails:O})}},37621:function(e,t,a){"use strict";a.d(t,"a",(function(){return N}));var i=a(10926),n=a.n(i),o=a(11466),r=a(21618),l=a(24228),u=a(24240),s=a(12088),c=a(22535),d=a(21622),m=a(11021),p=a(37622),b=a(22438),v=a.n(b),f=a(12258),y=a.n(f),g=a(24219);function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){C(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function C(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var N=e=>{var{solutionId:t,isStagedData:a,tableDetails:b,showCallout:f,onDismiss:h,focusTrapCalloutTarget:C,isSchemaNameDuplicated:N,shouldSkipApiAndUseDevEnvironmentDefaults:T,isReadOnlyMode:j}=e,{t:S}=Object(o.g)("PowerappsPortalEntities"),[D,E]=Object(i.useState)(Object(l.f)(void 0,!0)),[L,P]=Object(i.useState)(Object(l.f)(void 0,!0)),[w,A]=n.a.useState(!1),{isCDSLiteUX:M,locale:V,solution:I,fcbs:R}=Object(u.a)({t:S,isCreateMode:!0,refreshUpdatedTable:!1,solutionId:t,tableId:void 0,isStagedData:a||!0},!!T),x=a&&null!=b&&b.schemaName?Object(r.b)(Object(r.a)(null==b?void 0:b.schemaName)):void 0,F={solutionId:null==I?void 0:I.solutionId,publisherCustomizationPrefix:null!=I&&I.customizationPrefix?Object(r.b)(null==I?void 0:I.customizationPrefix):x,isManaged:null==I?void 0:I.solutionIsManaged,isPatched:null==I?void 0:I.solutionIsPatched},k=(e,t)=>{Object(m.W)(s.a,{eventName:d.k.DismissPanel,eventData:{dataWasUpdated:e}}),h(e,t)},z=n.a.useCallback(()=>{var e,t,i=Object(l.a)(D,!0),n={solutionUniqueName:(null==I?void 0:I.solutionUniqueName)||"",solutionId:(null==I?void 0:I.solutionId)||"",table:i,localeId:0!==V?V:1033,isArchivalServiceFeatureEnabled:null==R||null===(e=R.get(null===c.a||void 0===c.a?void 0:c.a.EnableArchivalService))||void 0===e?void 0:e.value};Object(m.W)(s.a,{eventName:d.k.CreateTable,eventData:{solutionId:null==I?void 0:I.solutionId,isStagedData:a,tableToBeCreated:v()(null==n?void 0:n.table,d.s)}});var o=["primaryColumnSchemaNameWithPrefix","wasAdvanceSectionOpened","wasExternalNameManuallyUpdated","wasSchemaNameManuallyUpdated"],r=v()(D,o),u=v()(L,o),p=!y()(r,u),f=!!b&&(null===(t=b.primaryField)||void 0===t?void 0:t.schemaName)!==(null==r?void 0:r.primaryColumnSchemaName);k(p||f,{tableToBeCreated:i})},[D,null==I?void 0:I.solutionUniqueName,null==I?void 0:I.solutionId,V,R,k,a,b]);n.a.useEffect(()=>{if(b){var e=Object(l.d)(a,!0,S,b,(null==F?void 0:F.publisherCustomizationPrefix)||"",(null==b?void 0:b.primaryFieldOptions)||[]);E(e),P(e),Object(m.W)(s.a,{eventName:d.k.GetTableFormValues,eventData:{column:v()(e,d.s)}})}else null!=F&&F.publisherCustomizationPrefix&&E(O(O({},D),{},{primaryColumnSchemaNameWithPrefix:Object(g.e)(void 0,Object(g.j)(D,!0,void 0),null==F?void 0:F.publisherCustomizationPrefix)}))},[b,a,null==F?void 0:F.publisherCustomizationPrefix]),n.a.useEffect(()=>{if(N){var e=!!D.schemaNameWithPrefix&&N(D.schemaNameWithPrefix);A(e),Object(m.W)(s.a,{eventName:d.k.DuplicatedSchemaName,eventData:{isSchemaNameDuplicated:N,publisherCustomizationPrefix:null==F?void 0:F.publisherCustomizationPrefix}})}},[N,D.schemaNameWithPrefix,null==F?void 0:F.publisherCustomizationPrefix]);var U=!I||!(null==I||!I.loading),B=a&&(null!=b&&b.schemaName||null!=I&&I.loading)?"":null==I?void 0:I.errorMessage;n.a.useEffect(()=>{U||Object(m.W)(s.a,{eventName:d.k.FormLoaded,eventData:{isSolutionLoading:!(null==I||!I.loading),isStagedData:a,hasColumnDetails:!!b}})},[U,a,null==I?void 0:I.loading,b]),n.a.useEffect(()=>{B&&Object(m.W)(s.a,{eventName:d.k.Error,eventData:{errorMessage:B,isStagedData:a}})},[B,a]);var W={focusTrapCalloutTarget:C,calloutTitle:S(b?j?"Entities.TableProperties":"Entities.Update.Header":"Entities.Create.Header"),isCreateMode:!0,showCallout:f,isCDSLiteUX:M,solutionDetails:F,onDismiss:k,formFields:D,setFormFields:E,tableDetails:b,shouldDisableSaveButton:U||!!B||!!j,createOrUpdateTable:z,isCreateOrUpdateTableTriggered:!1,isFormLoading:U,errorMessage:B,isSchemaNameUpdatedDuplicated:w,primaryButtonLabel:S("Common.Save"),isReadOnlyMode:j,shouldSkipApiAndUseDevEnvironmentDefaults:T};return n.a.createElement(p.a,W)}},37622:function(e,t,a){"use strict";a.d(t,"a",(function(){return C}));var i=a(10926),n=a.n(i),o=a(13093),r=a(11675),l=a(11645),u=a(11635),s=a(11636),c=a(24225),d=a(24203),m=a(37623),p=a(11466),b=a(37580),v=a(37582),f=a(37584),y=a(24207),g=a(12088),h=a(21622),O=a(11021),C=e=>{var{focusTrapCalloutTarget:t,calloutTitle:a,isCreateMode:i,showCallout:C,isCDSLiteUX:N,solutionDetails:T,onDismiss:j,formFields:S,setFormFields:D,shouldDisableSaveButton:E,createOrUpdateTable:L,isCreateOrUpdateTableTriggered:P,isFormLoading:w,tableDetails:A,errorMessage:M,isSchemaNameUpdatedDuplicated:V,primaryButtonLabel:I,isReadOnlyMode:R,shouldSkipApiAndUseDevEnvironmentDefaults:x}=e,{publisherCustomizationPrefix:F,isManaged:k,isPatched:z}=T,U=Object(u.a)(n.a.useRef(null))<=s.a.small,[B,W]=n.a.useState(""),{t:G}=Object(p.g)("PowerappsPortalEntities"),H=Object(m.c)(),q=Object(l.a)("tableCalloutId"),[_,Z]=n.a.useState(!1),[J,K]=n.a.useState(!1),[X,$]=n.a.useState(!1);n.a.useEffect(()=>{var{disabledEntity:e,disabledEntityWithSettings:t,disableEntityWithNoRename:a}=Object(y.a)(null==T?void 0:T.isManaged,null==T?void 0:T.isPatched,null==A?void 0:A.isManaged,null==A?void 0:A.isCustomizable,null==A?void 0:A.canModifyAdditionalSettings,null==A?void 0:A.isRenameable);Z(e||!!R),K(t||!!R),$(a||!!R),Object(O.W)(g.a,{eventName:h.k.DisableEntityBaseOnConfiguration,eventData:{isSolutionManaged:null==T?void 0:T.isManaged,isSolutionPatched:null==T?void 0:T.isPatched,isTableManaged:null==A?void 0:A.isManaged,isTableCustomizable:null==A?void 0:A.isCustomizable,canModifyAdditionalSettings:null==A?void 0:A.canModifyAdditionalSettings,isTableRenameable:null==A?void 0:A.isRenameable,disabledEntity:e,disabledEntityWithSettings:t,disableEntityWithNoRename:a,isReadOnlyMode:R}})},[null==T?void 0:T.isManaged,null==T?void 0:T.isPatched,null==A?void 0:A.isManaged,null==A?void 0:A.isCustomizable,null==A?void 0:A.canModifyAdditionalSettings,null==A?void 0:A.isRenameable,R]),n.a.useEffect(()=>{W(V?G("Entities.FormMessage.DuplicatedSchemaNameError",{tableSchemaName:S.schemaNameWithPrefix}):"")},[V,S.schemaNameWithPrefix]);var Q={propertiesSectionDetails:{isCreateMode:i,formValues:S,setFormValues:D,customizationPrefix:F||"",disableEntityWithNoRenameOption:X,disabledEntityWithNoModifyOption:J,enableAttachments:null==A?void 0:A.enableAttachments,isCDSLiteUX:N,isSimpleCreateOrUpdateTable:!0,disablePrimaryColumnSelection:R,shouldSkipApiAndUseDevEnvironmentDefaults:x}},Y={advanceOptionsSectionDetails:{isCreateMode:i,customizationPrefix:F||"",formValues:S,setFormValues:D,isSolutionManaged:k,isSolutionPatched:z,disableEntityWithNoCustomization:_,disabledEntityWithNoModifyOption:J,disableEntityWithNoRenameOption:X,openWebResourcesPanel:()=>{},createdWebResource:void 0,currentWebResourceSelected:void 0,setCurrentWebResourceSelected:()=>{},isCDSLiteUX:N,isSimpleCreateOrUpdateTable:!0,canBeLinkedToFeedback:void 0,canCreateActivity:void 0,canHaveConnections:void 0,canHaveContactEmail:void 0,canBeAddedToQueue:void 0,isSolutionAware:void 0,isSlaEnabled:void 0,trackChanges:void 0,isSchemaNameFieldReadOnly:R,shouldSkipApiAndUseDevEnvironmentDefaults:x}},ee=n.a.useCallback(()=>n.a.createElement(b.a,{headerLabelId:q,calloutTitle:a,closeLabel:G("Common.Close"),onCloseCallout:()=>j(!1),errorMessage:M,warningMessage:B}),[j,M,B,q,a,G]),te=n.a.useCallback(()=>n.a.createElement(v.a,{shouldDisablePrimaryButton:E||Object(y.b)(!0,S)||V,primaryButtonLabel:I||G("Common.Save"),primaryButtonAction:L,shouldDisableSecondaryButton:P,secondaryButtonLabel:G("Common.Cancel"),secondaryButtonAction:()=>j(!1)}),[P,G,j,E,S,L,i,V,I]),ae=G(w?"Common.Loading":"Common.Saving");return n.a.createElement(n.a.Fragment,null,C?n.a.createElement(o.a,{ariaLabelledBy:q,styles:U?m.a:m.b,role:"alertdialog",target:t,focusTrapProps:{isClickableOutsideFocusTrap:!0,"data-testid":"tableFormCallout"},directionalHint:r.a.bottomCenter,setInitialFocus:!0,onDismiss:()=>j(!1)},ee(),w&&n.a.createElement(f.a,{label:ae,ariaLabel:ae}),n.a.createElement("div",{className:w?H.calloutBodyLoading:H.calloutBody},n.a.createElement(c.a,Q),n.a.createElement(d.a,Y),te())):null)}},37623:function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return r}));var i=a(10929),n=()=>Object(i.db)({calloutBody:{padding:"0 24px 20px 24px"},calloutBodyLoading:{visibility:"hidden"}}),o=()=>Object(i.db)({root:{width:356}}),r=()=>Object(i.db)({root:{width:"100%",top:"0 !important",left:"0 !important",height:"100vh !important",maxHeight:"inherit !important"}})},37624:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var i=a(37625),n=a(23061),o=a(20879),r=a(23296),l=a(23295),u=a(37596),s=a(23952),c=a(23724),d=a(37572),m=a(11021),p=a(37627);function b(e,t,a,i,n,o,r){try{var l=e[o](r),u=l.value}catch(s){return void a(s)}l.done?t(u):Promise.resolve(u).then(i,n)}function v(e){return function(){var t=this,a=arguments;return new Promise((function(i,n){var o=e.apply(t,a);function r(e){b(o,i,n,r,l,"next",e)}function l(e){b(o,i,n,r,l,"throw",e)}r(void 0)}))}}class f{constructor(){this.dataCache=new p.a}getEntityMetadata(e){var t=this;return v((function*(){return t.dataCache.fetchData("getEntityMetadata",i.d,e).catch(e=>{throw Object(m.U)(d.b,{eventName:d.a.relatedDataSetProvider.getEntityMetadata.error},e),e})}))()}getEntityData(e){var t=this;return v((function*(){return t.dataCache.fetchData("getEntityData",function(){var e=v((function*(e){return function(e,t){return g.apply(this,arguments)}(yield t.getEntityMetadata(e),e)}));return function(t){return e.apply(this,arguments)}}(),e).catch(e=>{throw Object(m.U)(d.b,{eventName:d.a.relatedDataSetProvider.getEntityData.error},e),e})}))()}getEntityColumns(e){var t=this;return v((function*(){var a=yield t.getEntityMetadata(e),i=a.PrimaryIdAttribute,n=a.PrimaryNameAttribute,o=a.Attributes.find(e=>e.LogicalName===i),r=a.Attributes.find(e=>e.LogicalName===n);return[y(o,e),y(r,e)]}))()}}function y(e,t){var a=Object(o.b)(e,t),i=Object(r.b)(a,!1,void 0),n=Object(l.c)(i,i.LogicalName,!1,0,!1,!!e.IsPrimaryName,u.f),c=n.attributes,d=Object(s.b)(c);return{name:n.name,displayName:n.displayName,isPrimary:!!n.isPrimary,dataType:d,width:Object(s.a)(d)}}function g(){return(g=v((function*(e,t){return(yield Object(i.c)(e.EntitySetName,[e.PrimaryIdAttribute,e.PrimaryNameAttribute])).map(a=>({[n.k]:a[e.PrimaryIdAttribute],[c.a]:t,[e.PrimaryNameAttribute]:a[e.PrimaryNameAttribute]}))}))).apply(this,arguments)}},37625:function(e,t,a){"use strict";a.d(t,"e",(function(){return O})),a.d(t,"a",(function(){return j})),a.d(t,"d",(function(){return ee})),a.d(t,"c",(function(){return ne})),a.d(t,"b",(function(){return re}));var i=a(11868),n=a(11021),o=a(37572),r=a(11885),l=a(12353),u=a(10920),s=a(37576),c=a(11019),d=a(12219),m=a(37626),p=a(37613);function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){f(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function f(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function y(e,t,a,i,n,o,r){try{var l=e[o](r),u=l.value}catch(s){return void a(s)}l.done?t(u):Promise.resolve(u).then(i,n)}function g(e){return function(){var t=this,a=arguments;return new Promise((function(i,n){var o=e.apply(t,a);function r(e){y(o,i,n,r,l,"next",e)}function l(e){y(o,i,n,r,l,"throw",e)}r(void 0)}))}}var h="https://cds-org/api/data/v9.0/EntityDefinitions?$select=SchemaName&$filter=IsCustomEntity eq true and IsManaged eq false";function O(e){return C.apply(this,arguments)}function C(){return(C=g((function*(e){var t,a,i,{inMemoryTable:c,solutionUniqueName:b,enableSingleSaveApi:f,configurationType:y,targetEnvironment:g,enableSingleSaveApiV2:h,isPreferredSolutionFeatureEnabled:O}=e,C=Object(n.N)(o.b,o.a.cdsApiUtilities.persistTable,{configurationType:y,columns:null===(t=c.entity.Attributes)||void 0===t?void 0:t.map(p.a),rowsCount:c.data.length,targetEnvironment:null==g?void 0:g.name,solutionUniqueName:b,enableSingleSaveApi:f,builtUsingDevEnvironmentDefaults:c.builtUsingDevEnvironmentDefaults});if(c.builtUsingDevEnvironmentDefaults){var N=yield ae(y,g,d.s);b=N.solutionUniqueName,c=Object(m.a)(c,{customizationOptionValuePrefix:N.customizationOptionValuePrefix,customizationPrefix:N.customizationPrefix}),C.progress({eventName:"updateTableProps",solutionUniqueName:b,customizationOptionValuePrefix:N.customizationOptionValuePrefix,customizationPrefix:N.customizationPrefix})}try{if(f)i={metadataId:(yield U(y,g,c,b,O)).EntityId,logicalName:Object(s.j)(c.entity.SchemaName),entitySetName:c.entity.SchemaName};else if(h){i={metadataId:(yield W(y,g,c,b,O)).EntityId,logicalName:Object(s.j)(c.entity.SchemaName),entitySetName:c.entity.SchemaName}}else{var T;c=Object(l.cloneDeep)(c);var j=Object(l.groupBy)(c.entity.Attributes,e=>e.AttributeType===r.d.Lookup?"lookup":e.AttributeType===r.d.Customer?"customer":"other");c.entity.Attributes=j.other||[],a=yield D(y,g,c.entity,b,O),(null===(T=c.entity.ManyToOneRelationships)||void 0===T?void 0:T.length)>0&&(yield L(y,g,b,c.entity.SchemaName,j.lookup||[],c.entity.ManyToOneRelationships,O),yield M(y,g,b,c.entity.SchemaName,j.customer||[],c.entity.ManyToOneRelationships,O)),yield x(y,g,a.EntitySetName,c.data),yield J(y,g,c.autoNumberSeeds),H(y,g,c,b,O),i={metadataId:a.MetadataId,logicalName:a.LogicalName,entitySetName:a.EntitySetName}}return C.complete(i),i}catch(V){var S,E,P="test"===Object(u.j)().region;if(C.failure(P?V:{configurationType:y,message:null==V?void 0:V.message,error:v({},null==V||null===(S=V.response)||void 0===S||null===(E=S.data)||void 0===E?void 0:E.error)}),a)try{Q(g,a.LogicalName)}catch(I){var w,A;Object(n.jb)(o.b,{eventName:o.a.cdsApiUtilities.deleteEntityError},P?V:v({},null==V||null===(w=V.response)||void 0===w||null===(A=w.data)||void 0===A?void 0:A.error))}throw V}}))).apply(this,arguments)}function N(e,t,a){return T.apply(this,arguments)}function T(){return(T=g((function*(e,t,a){var n=e.properties.linkedEnvironmentMetadata.instanceUrl;t=t.replace("https://cds-org/",n);var o=(yield Object(c.g)(n)).accessToken;return a||(a={}),a.headers||(a.headers={}),a.headers=v(v({},a.headers),{},{Authorization:"Bearer ".concat(o)}),Object(i.f)(t,a)}))).apply(this,arguments)}function j(e){return S.apply(this,arguments)}function S(){return(S=g((function*(e){var t,a,n=yield Object(i.f)(h,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","MSCRM.SolutionUniqueName":e,Prefer:"return=representation",Consistency:"Strong"}});return null==n||null===(t=n.data)||void 0===t||null===(a=t.value)||void 0===a?void 0:a.map(e=>e.SchemaName.toLowerCase())}))).apply(this,arguments)}function D(e,t,a,i,n){return E.apply(this,arguments)}function E(){return(E=g((function*(e,t,a,i,r){var l,u,s,c=Object(n.N)(o.b,o.a.cdsApiUtilities.createEntity,{columns:null===(l=a.Attributes)||void 0===l?void 0:l.length,configurationType:e});try{s=yield N(t,"https://cds-org/api/data/v9.0/EntityDefinitions?tag=TableQuickCreate",{method:"POST",data:JSON.stringify(a),headers:ue(i,r)}),c.complete({configurationType:e})}catch(d){throw c.failure(d),d}return null===(u=s)||void 0===u?void 0:u.data}))).apply(this,arguments)}function L(e,t,a,i,n,o,r){return P.apply(this,arguments)}function P(){return(P=g((function*(e,t,a,i,n,o,r){var l=function*(n){var l=o.find(e=>e.ReferencingEntity===Object(s.j)(i)&&e.ReferencingAttribute===Object(s.j)(n.SchemaName));yield w(e,t,a,n,l,r)};for(var u of n)yield*l(u)}))).apply(this,arguments)}function w(e,t,a,i,n,o){return A.apply(this,arguments)}function A(){return(A=g((function*(e,t,a,i,r,l){var u=Object(n.N)(o.b,o.a.cdsApiUtilities.createRelationship,{configurationType:e});try{delete r.ReferencingAttribute;var s=v(v({},r),{},{Lookup:v({},i),"@odata.type":"Microsoft.Dynamics.CRM.OneToManyRelationshipMetadata"});yield N(t,"https://cds-org/api/data/v9.0/RelationshipDefinitions",{method:"POST",data:JSON.stringify(s),headers:ue(a,l)}),u.complete({configurationType:e})}catch(c){throw u.failure(c),c}}))).apply(this,arguments)}function M(e,t,a,i,n,o,r){return V.apply(this,arguments)}function V(){return(V=g((function*(e,t,a,i,n,o,r){for(var l of n)yield I(e,t,a,i,l,o,r)}))).apply(this,arguments)}function I(e,t,a,i,n,o,r){return R.apply(this,arguments)}function R(){return(R=g((function*(e,t,a,i,r,l,u){var c=Object(n.N)(o.b,o.a.cdsApiUtilities.createCustomerRelationship,{configurationType:e});try{var d={OneToManyRelationships:l.filter(e=>e.ReferencingEntity===Object(s.j)(i)&&e.ReferencingAttribute===Object(s.j)(r.SchemaName)).map(e=>({SchemaName:e.SchemaName,ReferencedEntity:e.ReferencedEntity,ReferencingEntity:Object(s.j)(i)})),Lookup:v({},r),SolutionUniqueName:a};yield N(t,"https://cds-org/api/data/v9.0/CreateCustomerRelationships",{method:"POST",data:JSON.stringify(d),headers:ue(a,u)}),c.complete({configurationType:e})}catch(m){throw c.failure(m),m}}))).apply(this,arguments)}function x(e,t,a,i){return F.apply(this,arguments)}function F(){return(F=g((function*(e,t,a,i){for(var n of i)yield k(e,t,a,n)}))).apply(this,arguments)}function k(e,t,a,i){return z.apply(this,arguments)}function z(){return(z=g((function*(e,t,a,i){var r=Object(n.N)(o.b,o.a.cdsApiUtilities.createRow,{fields:Object.keys(i||{}),configurationType:e});try{yield N(t,"https://cds-org/api/data/v9.0/".concat(a),{method:"POST",data:JSON.stringify(i),headers:{"Content-Type":"application/json","mscrm.suppressduplicatedetection":!1,Consistency:"Strong"}}),r.complete({configurationType:e})}catch(l){throw r.failure(l),l}}))).apply(this,arguments)}function U(e,t,a,i,n){return B.apply(this,arguments)}function B(){return(B=g((function*(e,t,a,i,r){var l,u,s,c=Object(n.N)(o.b,o.a.cdsApiUtilities.createEntityAndData,{columns:null===(l=a.entity.Attributes)||void 0===l?void 0:l.length,configurationType:e});try{var d;s=yield N(t,"https://cds-org/api/data/v9.1/msdyn_CreateEntity",{method:"POST",data:v({FileInfo:null!==(d=JSON.stringify(a.fileInfo))&&void 0!==d?d:JSON.stringify({HasHeader:!1,AttributesMapping:[]}),EntityDefinition:JSON.stringify(a.entity),SampleData:JSON.stringify(a.data)},a.useUserSettings?{UseUserSettings:a.useUserSettings}:{}),headers:ue(i,r)}),c.complete({configurationType:e})}catch(m){throw c.failure(m),m}return null===(u=s)||void 0===u?void 0:u.data}))).apply(this,arguments)}function W(e,t,a,i,n){return G.apply(this,arguments)}function G(){return(G=g((function*(e,t,a,i,r){var l,u,s,c=Object(n.N)(o.b,o.a.cdsApiUtilities.createEntityAndData,{columns:null===(l=a.entity.Attributes)||void 0===l?void 0:l.length,configurationType:e});try{var d;s=yield N(t,"https://cds-org/api/data/v9.1/msdyn_CreateEntity",{method:"POST",data:v({FileInfo:null!==(d=JSON.stringify(a.fileInfoFromConnector))&&void 0!==d?d:JSON.stringify({HasHeader:!1,AttributesMapping:null,AttributesInfo:[]}),EntityDefinition:JSON.stringify(a.entity),PreviewData:JSON.stringify(a.data)},a.connectionInfo?{ConnectionInfo:JSON.stringify(a.connectionInfo)}:{}),headers:ue(i,r)}),c.complete({configurationType:e})}catch(m){throw c.failure(m),m}return null===(u=s)||void 0===u?void 0:u.data}))).apply(this,arguments)}function H(e,t,a,i,n){return q.apply(this,arguments)}function q(){return(q=g((function*(e,t,a,i,r){try{try{yield _(e,t,a,i,!0,r)}catch(c){var l;if(404!==(null==c||null===(l=c.response)||void 0===l?void 0:l.status))throw c;yield _(e,t,a,i,!1,r)}}catch(c){var u,s;Object(n.jb)(o.b,{eventName:o.a.cdsApiUtilities.updateEntityFormAndViewError},v({},null==c||null===(u=c.response)||void 0===u||null===(s=u.data)||void 0===s?void 0:s.error))}}))).apply(this,arguments)}function _(e,t,a,i,n,o){return Z.apply(this,arguments)}function Z(){return(Z=g((function*(e,t,a,i,r,l){var u=Object(n.N)(o.b,o.a.cdsApiUtilities.updateFormsAndViews,{configurationType:e});try{yield N(t,"https://cds-org/api/data/v9.1/".concat(r?"msdyn_UpdateEntityFormAndViewAsync":"msdyn_UpdateEntityFormAndView"),{method:"POST",data:{EntityDefinition:JSON.stringify(a.entity)},headers:ue(i,l)}),u.complete({configurationType:e})}catch(s){throw u.failure(s),s}}))).apply(this,arguments)}function J(e,t,a){return K.apply(this,arguments)}function K(){return(K=g((function*(e,t,a){for(var i of Object.keys(a||{}))for(var n of Object.keys(a[i]||{})){var o=a[i][n];yield X(e,t,i,n,o)}}))).apply(this,arguments)}function X(e,t,a,i,n){return $.apply(this,arguments)}function $(){return($=g((function*(e,t,a,i,r){var l=Object(n.N)(o.b,o.a.cdsApiUtilities.createAutoNumberSeed,{configurationType:e});try{var u={EntityName:a,AttributeName:i,Value:r};yield N(t,"https://cds-org/api/data/v9.1/SetAutoNumberSeed",{method:"POST",data:JSON.stringify(u),headers:{"Content-Type":"application/json",Consistency:"Strong"}}),l.complete({configurationType:e})}catch(s){throw l.failure(s),s}}))).apply(this,arguments)}function Q(e,t){return Y.apply(this,arguments)}function Y(){return(Y=g((function*(e,t){yield N(e,"https://cds-org/api/data/v9.0/EntityDefinitions(LogicalName='".concat(t,"')"),{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Consistency:"Strong"}})}))).apply(this,arguments)}function ee(e){return te.apply(this,arguments)}function te(){return(te=g((function*(e){return(yield Object(i.f)("https://cds-org/api/data/v9.0/EntityDefinitions(LogicalName='".concat(e,"')?$expand=Attributes"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Prefer:"return=representation",Consistency:"Strong"}})).data}))).apply(this,arguments)}function ae(e,t,a){return ie.apply(this,arguments)}function ie(){return(ie=g((function*(e,t,a){var i,r=Object(n.N)(o.b,o.a.cdsApiUtilities.getSolution,{configurationType:e});try{i=(yield N(t,"https://cds-org/api/data/v9.0/solutions(".concat(a,")?$expand=publisherid"),{method:"GET"})).data,r.complete({configurationType:e})}catch(l){throw r.failure(l),l}return{solutionUniqueName:i.uniquename,customizationPrefix:i.publisherid.customizationprefix,customizationOptionValuePrefix:i.publisherid.customizationoptionvalueprefix}}))).apply(this,arguments)}function ne(e,t){return oe.apply(this,arguments)}function oe(){return(oe=g((function*(e,t){for(var a=yield Object(i.f)("https://cds-org/api/data/v9.0/".concat(e,"?$select=").concat(t.join(","),"&$top=1000"),{method:"GET",headers:{"Content-Type":"application/json","mscrm.suppressduplicatedetection":!1,Consistency:"Strong"}}),n=a.data.value;a.data["@odata.nextLink"];){var o=new URL(a.data["@odata.nextLink"]);o.host="cds-org",a=yield Object(i.f)(o.toString(),{method:"GET",headers:{"Content-Type":"application/json","mscrm.suppressduplicatedetection":!1,Consistency:"Strong"}}),n=n.concat(a.data.value)}return n}))).apply(this,arguments)}function re(){return le.apply(this,arguments)}function le(){return(le=g((function*(){return(yield Object(i.f)("https://cds-org/api/data/v9.0/RetrieveAvailableLanguages",{method:"GET",headers:{"Content-Type":"application/json"}})).data.LocaleIds}))).apply(this,arguments)}function ue(e,t){return v(v({Accept:"application/json","Content-Type":"application/json"},t?{}:{"MSCRM.SolutionUniqueName":e}),{},{Prefer:"return=representation",Consistency:"Strong"})}},37626:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var i=a(12353),n=a(37576);function o(e,t){return e=function(e,t){e.entity.SchemaName=r(e.entity.SchemaName,t.customizationPrefix),e.entity.Attributes&&e.entity.Attributes.map(a=>function(e,t,a){e.SchemaName=r(e.SchemaName,a.customizationPrefix);var i=e;if(i.OptionSet)return function(e,t,a){e.OptionSet.Name="".concat(Object(n.j)(t.SchemaName),"_").concat(Object(n.j)(e.SchemaName)),e.OptionSet.Options&&(e.OptionSet.Options=e.OptionSet.Options.map(e=>(e.Value=e.Value+a.customizationOptionValuePrefix,e)));return e}(i,t,a);return e}(a,e.entity,t));return e}(e=function(e,t){return e.entity.Attributes.filter(e=>e.OptionSet).forEach(a=>{e.data.forEach(e=>{var i=Object(n.j)(a.SchemaName);e[i]=function(e,t){if("number"==typeof e)return e+t;if("string"==typeof e)return e.split(",").map(e=>t+parseInt(e,10)).join(",");return e}(e[i],t.customizationOptionValuePrefix)})}),e.data.map(e=>(Object.keys(e).forEach(a=>{e[r(a,t.customizationPrefix)]=e[a],delete e[a]}),e)),e}(e=Object(i.cloneDeep)(e),t),t)}function r(e,t){var a=e.indexOf("_"),i=e.substring(0,a);return e.startsWith(i)?t+e.slice(i.length):e}},37627:function(e,t,a){"use strict";function i(e,t,a,i,n,o,r){try{var l=e[o](r),u=l.value}catch(s){return void a(s)}l.done?t(u):Promise.resolve(u).then(i,n)}a.d(t,"a",(function(){return n}));class n{constructor(){this.cache=new Map}UNSAFE_DO_NOT_USE_getCache(){return this.cache}fetchData(e,t){var a,n=arguments,o=this;return(a=function*(){for(var a=n.length,i=new Array(a>2?a-2:0),r=2;r<a;r++)i[r-2]=n[r];e+=JSON.stringify(i);var l=o.cache.get(e);if(l)return l;var u=t(...i).then(e=>e).catch(t=>{throw o.cache.delete(e),t});return o.cache.set(e,u),u},function(){var e=this,t=arguments;return new Promise((function(n,o){var r=a.apply(e,t);function l(e){i(r,n,o,l,u,"next",e)}function u(e){i(r,n,o,l,u,"throw",e)}l(void 0)}))})()}}},37628:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var i=a(10926),n=a.n(i),o=a(12313);function r(e,t,a,i,n,o,r){try{var l=e[o](r),u=l.value}catch(s){return void a(s)}l.done?t(u):Promise.resolve(u).then(i,n)}function l(e){return function(){var t=this,a=arguments;return new Promise((function(i,n){var o=e.apply(t,a);function l(e){r(o,i,n,l,u,"next",e)}function u(e){r(o,i,n,l,u,"throw",e)}l(void 0)}))}}var u={isLoadingRelatedEntities:!1,relatedEntities:void 0,relatedEntitiesError:void 0},s={isLoadingRelatedEntities:!1,relatedEntities:[],relatedEntitiesError:void 0};function c(e,t){var a=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],{isLoading:a,agGridTable:i,relatedDataSetProvider:r,currentEnvironment:u}=e,s=n.a.useMemo(()=>p(i).sort(),[i]),{isInitialLoading:c,data:m,error:b}=Object(o.a)(["powertable-inmemory-designer",null==u?void 0:u.name,"relatedDatasets",s.join(",")],l((function*(){return d(r,s)})),{enabled:t&&!a&&s.length>0});return{isLoadingRelatedEntities:c,relatedEntities:m,relatedEntitiesError:b}}(e,!t),i=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e?s:u}(!!t);return t?i:a}function d(e,t){return m.apply(this,arguments)}function m(){return(m=l((function*(e,t){var a=[];for(var i of t)a.push(e.getEntityMetadata(i));return yield Promise.all(a)}))).apply(this,arguments)}function p(e){var t=Array.from(new Set([...e.manyToOneRelationships.map(e=>e.relationship.ReferencedEntity),...e.manyToOneRelationships.map(e=>e.relationship.ReferencingEntity)]));return t=t.filter(t=>t!==e.metadata.LogicalName)}},37629:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var i=a(10926),n=a.n(i);function o(e){var{paGridAPI:t}=e,a=n.a.useRef(null),i=n.a.useCallback(e=>{var i,n=document.getElementById("fluent-default-layer-host"),o=document.getElementsByClassName("ag-header")[0];!t||(null!==(i=a.current)&&void 0!==i&&i.contains(e.target)||null!=n&&n.contains(e.target))&&(null==o||!o.contains(e.target))||null==t||t.stopCellEditing()},[t]);return n.a.useEffect(()=>(document.addEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}),[i]),{gridDivRef:a}}},37630:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var i=a(10926),n=a.n(i),o=a(12219),r=a(12313),l=a(14768),u=a(11225),s=a(37625),c=a(14767);var d={error:null,isInitialLoading:!1,data:void 0},m={error:null,isInitialLoading:!1,data:c.a.availableLanguages};function p(e){var t=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],{currentEnvironment:t}=Object(o.W)(),a=Object(l.e)(),i=n.a.useMemo(()=>["powertable-inmemory-designer",null==t?void 0:t.name,"useAvailableLanguages"],[null==t?void 0:t.name]);n.a.useLayoutEffect(()=>{var{unregister:e}=a.register({persisterId:l.b.IndexedDB,queryKey:i,team:u.b.PowerappsPortal});return e},[i,a]);var{data:c,isInitialLoading:d,error:m}=Object(r.a)(i,{queryFn:s.b,enabled:e});return{data:c,isInitialLoading:d,error:m}}(!e),a=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e?m:d}(!!e);return e?a:t}},37631:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var i=a(10926),n=a.n(i),o=a(12056),r=a(37572),l=a(11021);function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class d extends n.a.Component{constructor(e){super(e),this.state={error:void 0}}_createErrorDataObject(e,t){var{isCritical:a=!1,description:i="",message:n,stack:o=""}=e;return s(s({},t),{},{isCritical:a,description:i,message:n,stack:o})}componentDidCatch(e,t){this.props.onError(e);var a=Object(o.b)(e),i=this._createErrorDataObject(a,t);Object(l.U)(r.b,{eventName:r.a.errorBoundaray.hasError,eventData:i},a),this.setState({error:e})}render(){return this.state.error?null:this.props.children}}},37632:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var i=a(10926),n=a.n(i),o=a(11932),r=a(11934),l=a(11031);function u(e){var{onMessageBarReady:t}=e,[a,i]=n.a.useState([]);return n.a.useEffect(()=>{t({appendError:e=>{i(t=>{var a=[...t];return a.push({id:Object(l.a)(),message:e}),a})}})},[]),0===a.length?n.a.createElement(n.a.Fragment,null):n.a.createElement("div",{style:{paddingBottom:"20px"}},a.map(e=>n.a.createElement(o.a,{key:e.id,messageBarType:r.a.error,onDismiss:()=>{return t=e.id,void i(e=>e.filter(e=>e.id!==t));var t}},e.message)))}},37635:function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"z",(function(){return b})),a.d(t,"m",(function(){return f})),a.d(t,"b",(function(){return y})),a.d(t,"w",(function(){return g})),a.d(t,"v",(function(){return h})),a.d(t,"t",(function(){return O})),a.d(t,"u",(function(){return C})),a.d(t,"x",(function(){return N})),a.d(t,"y",(function(){return T})),a.d(t,"j",(function(){return j})),a.d(t,"k",(function(){return S})),a.d(t,"r",(function(){return D})),a.d(t,"l",(function(){return E})),a.d(t,"o",(function(){return L})),a.d(t,"p",(function(){return P})),a.d(t,"n",(function(){return w})),a.d(t,"q",(function(){return A})),a.d(t,"e",(function(){return M})),a.d(t,"f",(function(){return V})),a.d(t,"s",(function(){return I})),a.d(t,"i",(function(){return R})),a.d(t,"A",(function(){return x})),a.d(t,"c",(function(){return F})),a.d(t,"h",(function(){return k})),a.d(t,"d",(function(){return z})),a.d(t,"g",(function(){return B})),a.d(t,"B",(function(){return W}));var i=a(21528),n=a(19360),o=a(37576),r=a(11883),l=a(11885),u=a(20793),s=a(19333);function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){m(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function m(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var p=1e4;function b(e){var t,a=null!==(t=e.customPrefixedSchemaName)&&void 0!==t?t:Object(o.f)(e.customizationPrefix,e.tableDisplayName);return{Attributes:[function(e){return d(d({},v(e)),{},{AttributeType:r.j.String,AttributeTypeName:{Value:l.e.StringType},ImeMode:r.r.Auto,MaxLength:100,FormatName:{Value:l.D.Text},Format:l.D.Text,AutoNumberFormat:null})}({displayName:e.primaryNameColumnDisplayName,customizationPrefix:e.customizationPrefix,languageCode:e.languageCode,isPrimaryName:!0})],OwnershipType:r.v.UserOwned,PrimaryNameAttribute:"",SchemaName:a,HasNotes:!1,HasActivities:!1,IsAvailableOffline:!1,IsActivity:!1,ActivityTypeMask:r.b.DoNotDisplayInActivityMenus,IsSolutionAware:!!e.solutionUniqueName,Description:{LocalizedLabels:[{Label:"",LanguageCode:e.languageCode}]},DisplayCollectionName:{LocalizedLabels:[{Label:e.tablePluralDisplayName,LanguageCode:e.languageCode}]},DisplayName:{LocalizedLabels:[{Label:e.tableDisplayName,LanguageCode:e.languageCode}]},IsAuditEnabled:{Value:!1},IsValidForQueue:{Value:!1},IsConnectionsEnabled:{Value:!1},IsDuplicateDetectionEnabled:{Value:!0},IsDocumentManagementEnabled:!1,EntityColor:null,IsRetentionEnabled:!1,SyncToExternalSearchIndex:!1,AutoRouteToOwnerQueue:!1,IsSLAEnabled:!1,IsQuickCreateEnabled:!1,IsActivityParty:!1,HasFeedback:!1,AutoCreateAccessTeams:!1,ChangeTrackingEnabled:!!e.changeTrackingEnabled,IsKnowledgeManagementEnabled:!1,EntityHelpUrlEnabled:!1,EntityHelpUrl:null,IsMailMergeEnabled:{Value:!0},IsOfflineInMobileClient:{Value:!!e.isOfflineInMobileClient}}}function v(e){return{IsPrimaryName:!!e.isPrimaryName,IsSecured:!1,IsValidForUpdate:!0,IsValidForRead:!0,SchemaName:Object(o.f)(e.customizationPrefix,e.displayName),SourceType:l.z.Simple,ExternalName:null,Description:{LocalizedLabels:[{Label:"",LanguageCode:e.languageCode}]},DisplayName:{LocalizedLabels:[{Label:e.displayName,LanguageCode:e.languageCode}]},RequiredLevel:{Value:e.isPrimaryName?i.c.ApplicationRequired:i.c.None}}}function f(e){return d(d({},v(e)),{},{AttributeType:r.j.Decimal,AttributeTypeName:{Value:l.e.DecimalType},ImeMode:r.r.Auto,MaxValue:n.d,MinValue:n.e,Precision:2})}function y(e){return d(d({},v(e)),{},{AttributeType:r.j.String,AttributeTypeName:{Value:l.e.StringType},ImeMode:r.r.Auto,AutoNumberFormat:"{SEQNUM:4}",Format:l.D.Text,MaxLength:100,FormatName:{Value:l.D.Text}})}function g(e){return d(d({},v(e)),{},{AttributeType:r.j.String,AttributeTypeName:{Value:l.e.StringType},ImeMode:r.r.Auto,MaxLength:100,FormatName:{Value:l.D.TextArea},Format:l.D.TextArea,AutoNumberFormat:null})}function h(e){return d(d({},v(e)),{},{AttributeType:r.j.String,AttributeTypeName:{Value:l.e.StringType},ImeMode:r.r.Auto,MaxLength:100,FormatName:{Value:l.c.RichText},Format:l.D.Text,AutoNumberFormat:null})}function O(e){return d(d({},v(e)),{},{AttributeType:r.j.String,AttributeTypeName:{Value:l.e.StringType},ImeMode:r.r.Auto,MaxLength:100,FormatName:{Value:l.D.Email},Format:l.D.Email,AutoNumberFormat:null})}function C(e){return d(d({},v(e)),{},{AttributeType:r.j.String,AttributeTypeName:{Value:l.e.StringType},ImeMode:r.r.Auto,MaxLength:100,FormatName:{Value:l.D.Phone},Format:l.D.Text,AutoNumberFormat:null})}function N(e){return d(d({},v(e)),{},{AttributeType:r.j.String,AttributeTypeName:{Value:l.e.StringType},ImeMode:r.r.Auto,MaxLength:100,FormatName:{Value:l.D.TickerSymbol},Format:l.D.TickerSymbol,AutoNumberFormat:null})}function T(e){return d(d({},v(e)),{},{AttributeType:r.j.String,AttributeTypeName:{Value:l.e.StringType},ImeMode:r.r.Auto,MaxLength:100,FormatName:{Value:l.D.Url},Format:l.D.Url,AutoNumberFormat:null})}function j(e){return d(d({},v(e)),{},{AttributeType:r.j.Memo,AttributeTypeName:{Value:l.e.MemoType},ImeMode:r.r.Auto,MaxLength:n.q,FormatName:{Value:l.D.Text},Format:l.D.Text,AutoNumberFormat:null})}function S(e){return d(d({},v(e)),{},{AttributeType:r.j.Memo,AttributeTypeName:{Value:l.e.MemoType},ImeMode:r.r.Auto,MaxLength:2e3,FormatName:{Value:l.b.RichText},Format:l.D.Text,AutoNumberFormat:null})}function D(e){return d(d({},v(e)),{},{AttributeType:r.j.Integer,AttributeTypeName:{Value:l.e.IntegerType},MaxValue:n.o,MinValue:n.p,Format:r.s.None})}function E(e){return d(d({},v(e)),{},{AttributeType:r.j.BigInt,AttributeTypeName:{Value:l.e.BigIntType},MaxValue:n.b,MinValue:n.c})}function L(e){return d(d({},v(e)),{},{AttributeType:r.j.Double,AttributeTypeName:{Value:l.e.DoubleType},ImeMode:r.r.Auto,MaxValue:n.h,MinValue:n.j,Precision:n.g})}function P(e){return d(d({},v(e)),{},{AttributeType:r.j.Integer,AttributeTypeName:{Value:l.e.IntegerType},MaxValue:2147483647,MinValue:0,Format:r.s.Language})}function w(e){return d(d({},v(e)),{},{AttributeType:r.j.Integer,AttributeTypeName:{Value:l.e.IntegerType},MaxValue:2147483647,MinValue:0,Format:r.s.Duration})}function A(e){return d(d({},v(e)),{},{AttributeType:r.j.Integer,AttributeTypeName:{Value:l.e.IntegerType},MaxValue:1500,MinValue:-1500,Format:r.s.TimeZone})}function M(e){return d(d({},v(e)),{},{ImeMode:r.r.Auto,AttributeType:r.j.DateTime,AttributeTypeName:{Value:l.e.DateTimeType},Format:r.n.DateAndTime,DateTimeBehavior:{Value:r.m.UserLocal},CanChangeDateTimeBehavior:{Value:!0,CanBeChanged:!0,ManagedPropertyLogicalName:"canmodifybehavior"}})}function V(e){return d(d({},v(e)),{},{AttributeType:r.j.DateTime,AttributeTypeName:{Value:l.e.DateTimeType},ImeMode:r.r.Auto,Format:r.n.DateOnly,DateTimeBehavior:{Value:r.m.UserLocal},CanChangeDateTimeBehavior:{Value:!0,CanBeChanged:!0,ManagedPropertyLogicalName:"canmodifybehavior"}})}function I(e){return d(d({},v(e)),{},{AttributeType:r.j.Picklist,AttributeTypeName:{Value:l.e.PicklistType},DefaultFormValue:e.defaultFormValue||-1,OptionSet:{IsCustomOptionSet:!0,IsGlobal:!1,IsCustomizable:{Value:!0,CanBeChanged:!1,ManagedPropertyLogicalName:"iscustomizable"},ExternalTypeName:"",OptionSetType:l.p.Picklist,Description:{LocalizedLabels:[{Label:"",LanguageCode:e.languageCode}]},DisplayName:{LocalizedLabels:[{Label:e.displayName,LanguageCode:e.languageCode}]},Options:e.options.map((t,a)=>({Value:e.customizationOptionValuePrefix*p+a,ExternalValue:"",IsManaged:!1,Label:{LocalizedLabels:[{Label:t,LanguageCode:e.languageCode}]},Description:{LocalizedLabels:[{Label:"",LanguageCode:e.languageCode}]}}))}})}function R(e){return d(d({},v(e)),{},{AttributeType:r.j.Virtual,AttributeTypeName:{Value:l.e.MultiSelectPicklistType},DefaultFormValue:-1,OptionSet:{IsCustomOptionSet:!0,IsGlobal:!1,ExternalTypeName:"",OptionSetType:l.p.Picklist,Description:{LocalizedLabels:[{Label:"",LanguageCode:e.languageCode}]},DisplayName:{LocalizedLabels:[{Label:e.displayName,LanguageCode:e.languageCode}]},Options:e.options.map((t,a)=>({Value:e.customizationOptionValuePrefix*p+a,ExternalValue:"",IsManaged:!1,Label:{LocalizedLabels:[{Label:t,LanguageCode:e.languageCode}]},Description:{LocalizedLabels:[{Label:"",LanguageCode:e.languageCode}]}}))}})}function x(e){return d(d({},v(e)),{},{AttributeType:r.j.Boolean,AttributeTypeName:{Value:l.e.BooleanType},DefaultValue:!1,OptionSet:{IsCustomOptionSet:!0,IsGlobal:!1,IsCustomizable:{Value:!0,CanBeChanged:!1,ManagedPropertyLogicalName:"iscustomizable"},IsManaged:!1,ExternalTypeName:"",OptionSetType:l.p.Boolean,Description:{LocalizedLabels:[{Label:"",LanguageCode:e.languageCode}]},DisplayName:{LocalizedLabels:[{Label:e.displayName,LanguageCode:e.languageCode}]},TrueOption:{Value:1,IsManaged:!1,ExternalValue:"",Label:{LocalizedLabels:[{Label:"Yes",LanguageCode:1033}]},Description:{LocalizedLabels:[]}},FalseOption:{Value:0,IsManaged:!1,ExternalValue:"",Label:{LocalizedLabels:[{Label:"No",LanguageCode:e.languageCode}]},Description:{LocalizedLabels:[]}}}})}function F(e){return d(d({},v(e)),{},{AttributeType:r.j.Money,AttributeTypeName:{Value:l.e.MoneyType},ImeMode:r.r.Auto,MaxValue:n.r,MinValue:n.s,PrecisionSource:r.w.TransactionCurrency,Precision:n.g,IsBaseCurrency:!1})}function k(e){var t=d(d({},v(e)),{},{AttributeType:r.j.Lookup,AttributeTypeName:{Value:l.e.LookupType},Targets:[Object(o.j)(e.referencedEntitySchemaName)]});return{column:t,manyToOneRelationships:[U(e.referencedEntitySchemaName,e.referencedAttributeSchemaName,e.referencingEntitySchemaName,t.SchemaName,!1)]}}function z(e){var t=[{referencedEntitySchemaName:Object(o.j)(s.b),referencedAttributeSchemaName:o.b},{referencedEntitySchemaName:Object(o.j)(s.a),referencedAttributeSchemaName:o.a}],a=d(d({},v(e)),{},{AttributeType:r.j.Customer,AttributeTypeName:{Value:l.e.CustomerType},Targets:t.map(e=>Object(o.j)(e.referencedEntitySchemaName))});return{column:a,manyToOneRelationships:t.map(t=>U(t.referencedEntitySchemaName,t.referencedAttributeSchemaName,e.referencingEntitySchemaName,a.SchemaName,!0))}}function U(e,t,a,i,n){return{SchemaName:"".concat(a,"_").concat(i,"_").concat(e),ReferencingAttribute:Object(o.j)(i),ReferencedEntity:Object(o.j)(e),ReferencingEntity:Object(o.j)(a),ReferencedAttribute:Object(o.j)(t),ReferencingEntityNavigationPropertyName:n?i+"_"+e:i,RelationshipType:l.t.OneToManyRelationship,IsCustomRelationship:!0,IsValidForAdvancedFind:!0,IsCustomizable:{Value:!0,CanBeChanged:!0,ManagedPropertyLogicalName:"iscustomizable"},CascadeConfiguration:{Assign:l.g.NoCascade,Delete:l.g.RemoveLink,Merge:l.g.NoCascade,Reparent:l.g.NoCascade,Share:l.g.NoCascade,Unshare:l.g.NoCascade,RollupView:l.g.NoCascade,Archive:l.g.RemoveLink}}}function B(e){return{data:[],entity:b(e),autoNumberSeeds:{}}}function W(e){var{logicalName:t,id:a,lookupLogicalName:i,formattedValue:n}=e;return{[Object(u.g)(t)]:a,[Object(u.f)(Object(u.g)(t))]:i,[Object(u.e)(Object(u.g)(t))]:n}}},37636:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var i=a(12295),n=a(37625),o=a(12219),r=["mutate","mutateAsync"];function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){s(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function c(e,t){if(null==e)return{};var a,i,n=function(e,t){if(null==e)return{};var a,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)a=o[i],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)a=o[i],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function d(){var{currentEnvironment:e}=Object(o.W)(),t=Object(i.a)(n.e,{}),{mutate:a,mutateAsync:l}=t;return u(u({},c(t,r)),{},{mutate:t=>(t.targetEnvironment||(t.targetEnvironment=e),a(t)),mutateAsync:t=>(t.targetEnvironment||(t.targetEnvironment=e),l(t))})}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/669.cc3d27e2.chunk.js.map
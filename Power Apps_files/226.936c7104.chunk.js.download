/*! For license information please see 226.936c7104.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[226],{17571:function(t,e,r){"use strict";r.d(e,"a",(function(){return o})),r.d(e,"d",(function(){return i})),r.d(e,"b",(function(){return a})),r.d(e,"c",(function(){return c}));var n=r(11021);function o(t,e){Object(n.fb)("power-support-bot",t,e,n.j.Shell)}function i(t,e){return Object(n.X)("power-support-bot",t,e,n.j.Shell)}function a(t,e,r){Object(n.U)("power-support-bot",{eventName:t,eventData:e},r,n.j.Shell)}function c(t,e){Object(n.W)("power-support-bot",{eventName:t,eventData:e},n.j.Shell)}},17574:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(10926),o=r(17575);function i(){return Object(n.useContext)(o.b)}},17575:function(t,e,r){"use strict";r.d(e,"b",(function(){return g})),r.d(e,"a",(function(){return S}));var n=r(10926),o=r(17576),i=r(17577),a=r(11465),c=r(11205),s=r(17578),p=r(17571),u=r(11019),l=r(10920),d=r(12219);function v(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(p){return void r(p)}c.done?e(s):Promise.resolve(s).then(n,o)}function h(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){v(i,n,o,a,c,"next",t)}function c(t){v(i,n,o,a,c,"throw",t)}a(void 0)}))}}var g=n.createContext({startSkylightBotAsync:(t,e)=>{throw Object(p.b)("SupportBot.SkylightBotProviderContext.NotRegistered",{action:"startSkylightBotAsync"}),new Error("Not Implemented")},restartSkylightBot:()=>{throw Object(p.b)("SupportBot.SkylightBotProviderContext.NotRegistered",{action:"restartSkylightBot"}),new Error("Not Implemented")}}),S=t=>{var[e,r]=Object(n.useState)(Object(s.a)()),{status:v}=Object(d.W)(),S=Object(c.j)();if("success"!==v)return n.createElement(n.Fragment,null);var y=function(){var t=h((function*(){if(!e){var t=Object(p.d)("SupportBot/LoadBotScripts"),n=Object(o.a)();try{yield Promise.all([Object(i.a)(n.useSkylightDevEnvironment?n.devSkylightAppScriptUrl:n.skylightAppScriptUrl,t),Object(i.a)(n.useSkylightDevEnvironment?n.devSkylightVendorScriptUrl:n.skylightVendorScriptUrl,t),Object(i.b)(n.useSkylightDevEnvironment?n.devSkylightAppStylesUrl:n.skylightAppStylesUrl,t)]),t.complete(),r(!0)}catch(a){t.failure({error:a})}}}));return function(){return t.apply(this,arguments)}}(),f={startSkylightBotAsync:function(){var r=h((function*(r){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=Object(p.d)("SupportBot/StartBot",{skylightScriptLoaded:e});yield y(),o.progress({skylightScriptLoaded:e});var i,c=t.createBotParams(S.pathname),d=Object(l.a)();if(t.authResource)try{var v=yield Object(u.g)(t.authResource);v.error?Object(p.b)("SupportBot/StartBot/AcquireToken",{message:"error fetching token, continuing anyways",inNewWindow:n},v.error):i=v.accessToken}catch(h){Object(p.b)("SupportBot/StartBot/AcquireToken",{message:"error thrown while fetching token, continuing anyways",inNewWindow:n},h)}Object(s.c)(r,Object(a.h)(),c,n,d,i),o.complete()}));return function(t){return r.apply(this,arguments)}}(),restartSkylightBot:()=>{Object(s.b)()}};return n.createElement(g.Provider,{value:f},n.createElement(n.Fragment,null,t.children))}},17576:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(11038),o=Object(n.e)({packageName:"power-support-bot",settings:{skylightAppScriptUrl:{description:"Url for skylight app scripts",values:{default:"https://vsa.services.microsoft.com/v1.0/js/app.bundle.js"}},skylightVendorScriptUrl:{description:"Url for skylight vendor scripts",values:{default:"https://vsa.services.microsoft.com/v1.0/js/vendor.bundle.js"}},skylightAppStylesUrl:{description:"Url for skylight app styles",values:{default:"https://vsa.services.microsoft.com/v1.0/styles.css"}},devSkylightAppScriptUrl:{description:"Url for skylight app scripts for the skylight dev environment",values:{default:"https://cdn-vsa-dev.services.microsoft.com/v1.0/js/app.bundle.js"}},devSkylightVendorScriptUrl:{description:"Url for skylight vendor scripts for the skylight dev environment",values:{default:"https://cdn-vsa-dev.services.microsoft.com/v1.0/js/vendor.bundle.js"}},devSkylightAppStylesUrl:{description:"Url for skylight app styles for the skylight dev environment",values:{default:"https://cdn-vsa-dev.services.microsoft.com/v1.0/styles.css"}},useSkylightDevEnvironment:{description:"Whether to use skylight dev environment, this should never be checked in as true for non-test environments",allowOverrides:!0,values:{default:!1,test:!0}}}});function i(){return o}},17577:function(t,e,r){"use strict";function n(t,e){return new Promise((r,n)=>{var o=document.createElement("script");o.type="text/javascript",o.readyState?o.onreadystatechange=()=>{"loaded"!==o.readyState&&"complete"!==o.readyState||(o.onreadystatechange=null,r("loaded"))}:(o.onload=()=>{e.progress({script:t,status:"loaded"}),r("loaded")},o.onerror=r=>{e.progress({script:t,status:"error",error:r}),n(r)}),o.src=t,document.body.appendChild(o)})}function o(t,e){return new Promise((r,n)=>{var o=document.createElement("link");o.rel="stylesheet",o.readyState?o.onreadystatechange=()=>{"loaded"!==o.readyState&&"complete"!==o.readyState||(o.onreadystatechange=null,r("loaded"))}:(o.onload=()=>{e.progress({script:t,status:"loaded"}),r("loaded")},o.onerror=r=>{e.progress({script:t,status:"error",error:r}),n(r)}),o.href=t,document.body.appendChild(o)})}r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return o}))},17578:function(t,e,r){"use strict";r.d(e,"a",(function(){return o})),r.d(e,"c",(function(){return a})),r.d(e,"b",(function(){return c}));var n=r(17571);function o(){return"VirtualSupportAgentApplication"in window}function i(){return window.VirtualSupportAgentApplication.conversationID}function a(t,e,r,o,a,c){if(window.VirtualSupportAgentApplication){Object(n.c)("SupportBot/setupVirtualSupportAgentApplication",{locale:e,botParams:r,inNewWindow:o}),window.VirtualSupportAgentApplication.setLocaleForSDK(e),window.VirtualSupportAgentApplication.setShouldRouteRequestsToEU("eu"===a),c&&window.VirtualSupportAgentApplication.setGetTokenAuthorizationHeader("Bearer",c),window.VirtualSupportAgentApplication.setPartnerID(r.partnerId,r.partnerName),window.VirtualSupportAgentApplication.setInitialQuery(r.greetingId,!0),window.VirtualSupportAgentApplication.setGlobalVariables({origin:r.origin,product:r.product,productSAPID:r.productSAPID}),window.VirtualSupportAgentApplication.setFlowID(r.flowId),window.VirtualSupportAgentApplication.onBotActivityReceived(()=>{Object(n.c)("SupportBot/botActivityEvent",{conversationId:i()})}),window.VirtualSupportAgentApplication.onUserActivityReceived(()=>{Object(n.c)("SupportBot/userActivityEvent",{conversationId:i()})}),window.VirtualSupportAgentApplication.subscribeCallbackToEndChatEvent(()=>{Object(n.c)("SupportBot/endChatEvent",{conversationId:i()})}),window.VirtualSupportAgentApplication.subscribeCallbackToRestartChatEvent(()=>(Object(n.c)("SupportBot/restartChatEvent",{conversationId:i()}),!o)),window.VirtualSupportAgentApplication.renderVirtualSupportAgentApplication({theme:"GRAY"},document.getElementById(t)),o||(document.getElementsByClassName("frame-header")[0].style.display="none");var s=setInterval(()=>{var t=i();t&&(Object(n.c)("SupportBot/conversationStarted",{locale:e,botParams:r,inNewWindow:o,conversationId:t}),clearInterval(s))},1e3)}else Object(n.b)("SupportBot/setupVirtualSupportAgent/notLoaded",{message:"window.VirtualSupportAgentApplication is not set"})}function c(){window.VirtualSupportAgentApplication.restartChat()}},17581:function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r(10926),o=r.n(n),i=r(17574),a=t=>{var{startSkylightBotAsync:e}=Object(i.a)();return o.a.useEffect(()=>{e("virtual-agent-application",t.inNewWindow)},[]),o.a.createElement("div",{id:"virtual-agent-application",role:"main"})}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/226.936c7104.chunk.js.map
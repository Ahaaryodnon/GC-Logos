/*! For license information please see canvas-host-base.40f93d87.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[336],{19802:function(e,t,n){"use strict";var r=n(16094);n.d(t,"a",(function(){return r.a}))},25011:function(e,t,n){"use strict";n.r(t),n.d(t,"CanvasHostBaseInternal",(function(){return J}));var r=n(17342),o=n(25012),a=n(25025),i=n(17323),s=n(11401),c=n(11835),l=n(19802),u=n(11465),d=n(11021),p=n(10920),v=n(12082),m=n(10926),f=n(17712),h=n(25029),b=n(12394),g=n(25030),w=n(25032),y=n(25033),O=n(25035),C=n(25037),S=n(25040),E=n(12094),j=n(25041),T=n(17321),P=n(25042),A=n(12393),I=n(12096),k=n(25031),M=n(12092),N=n(14283),_=n(12065),R=n(11031),D=n(12093),x=n(25055),F=n(17572),L=n(25056),V=n(12095),H=n(12356),W=n(25058);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){G(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function G(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function q(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,o)}function z(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){q(a,r,o,i,s,"next",e)}function s(e){q(a,r,o,i,s,"throw",e)}i(void 0)}))}}var Q,X=function(e){return e.ContextEntityId="ContextEntityId",e.IsFullScreen="IsFullScreen",e.Theme="Theme",e.ThisChannel="ThisChannel",e.ThisTeam="ThisTeam",e.ThisMeeting="ThisMeeting",e.IsSidePanel="IsSidePanel",e}(X||{}),J=e=>{var t,n,r,u,U=m.useContext(_.a),G=Object(m.useRef)(null),q=Object(m.useRef)(!1),J=Object(R.a)(),K=Object(m.useRef)(0),Z=Object(m.useRef)(void 0),Y=function(e){var{enableMessagingWireInvoke:t}=Object(L.f)(),{webAuthSessionTimeoutOverride:n}=Object(L.g)(),r=Object(m.useRef)(""),o=e.clientSessionId,a=new URLSearchParams(e.history.location.search),i={};o&&(i[I.a.CanvasSessionId.value]=o);t&&"false"!==a.get(I.a.UseMessageInvoke.value)&&(i[I.a.UseMessageInvoke.value]="true");V.a.allowWebAuthSessionRetries&&(i[I.a.WebAuthSessionTimeoutOverride.value]="".concat(n));var s=Object(D.a)(e.studioURL,i);if(s=Object(H.d)(s),r.current!==s){var c;Object(d.W)(E.n,{eventName:"".concat(E.m,"/StartCanvasDesignerIframe"),eventData:{studioURL:e.studioURL,environmentName:null===(c=e.currentEnvironment)||void 0===c?void 0:c.name,studioVersionProp:e.studioVersion,studioSessionId:e.clientSessionId}}),r.current=s}return s}(e),$=Object(m.useRef)(!1);Object(m.useEffect)(()=>(window.addEventListener("message",Oe),()=>{window.removeEventListener("message",Oe)}));var ee=()=>{void 0!==Z.current&&(clearInterval(Z.current),Z.current=void 0)},[te,ne]=Object(m.useState)(),[re,oe]=m.useState();Object(m.useEffect)(()=>{var t;e.studioURL&&((null===(t=new URL(e.studioURL).searchParams.get(I.a.IsHosted.value))||void 0===t?void 0:t.toLowerCase())===(!0).toString()&&window.opener&&(e=>{var t=new o.a(e);t.onCommandReceived.attach(e=>{var t={command:e.command};ye({eventType:b.a.AutomationCommandReceived,args:t})}),oe(t)})(new a.a(window.opener)))},[e.studioURL]);var ae=function(){var e=z((function*(e){$.current=!0}));return function(t){return e.apply(this,arguments)}}(),ie=function(){var e=z((function*(){var e=!(null==re||!re.hasStarted);ye({eventType:b.a.AutomationHasServerStartedResponse,hasStarted:e})}));return function(){return e.apply(this,arguments)}}(),se=function(){var e=z((function*(){yield null==re?void 0:re.startAsync(),ye({eventType:b.a.AutomationServerStarted})}));return function(){return e.apply(this,arguments)}}();Object(m.useEffect)(()=>(Object(P.b)(),()=>{Object(P.a)()}),[]),Object(m.useEffect)(()=>{var t;return Object(d.W)(E.n,{eventName:"".concat(E.m,"/CanvasHostBaseMounted"),eventData:{studioUrl:e.studioURL,environmentName:null===(t=e.currentEnvironment)||void 0===t?void 0:t.name}}),K.current=0,Z.current=window.setInterval(()=>{var t;if(!q.current&&void 0!==Z.current){var n;if(K.current>Math.floor(12))return ee(),void Object(d.U)(E.n,{eventName:"".concat(E.m,"/studioLoadFailed"),eventData:{studioUrl:e.studioURL,environmentName:null===(n=e.currentEnvironment)||void 0===n?void 0:n.name,activityId:J,heartbeatCount:K.current+1}});K.current++,Object(d.W)(E.n,{eventName:"".concat(E.m,"/noStudioHeartbeat"),eventData:{studioUrl:e.studioURL,environmentName:null===(t=e.currentEnvironment)||void 0===t?void 0:t.name,activityId:J,heartbeatCount:K.current}})}},15e3),e.studioURL&&je(!0),()=>{if(ee(),$.current)Object(i.g)();else{var e=Object(i.e)();e&&e.then(e=>{e.disposeAsync()})}}},[]),Object(m.useEffect)(()=>{ye(e.studioMessage)},[e.studioMessage]);var{t:ce,tReady:le}=e,ue=null===(t=e.currentEnvironment)||void 0===t||null===(n=t.properties)||void 0===n||null===(r=n.linkedEnvironmentMetadata)||void 0===r?void 0:r.instanceUrl,[de,pe]=Object(k.a)(m.useCallback(ye,[])),ve=m.useContext(M.b),me=Object(F.a)(),fe=null===(u=Object(L.d)().supportBot)||void 0===u?void 0:u.enableForCanvasDesigner,he=()=>{var e=me.isVisible,t=me.isSupported;fe||(t=!1,e=!1),ye({eventType:b.a.UpdateSupportBotState,isSupported:t,isVisible:e})};Object(m.useEffect)(()=>{he()},[me]);var be=Object(c.a)();if(!e.studioURL)return null;var ge=(null==ve?void 0:ve.canvasLoadPhase)===M.a.Preload,we="";return te?we=te:le&&(we=ce("Designer.HeaderText",{defaultValue:""})),m.createElement(de,null,m.createElement(l.a,null,m.createElement(l.a.Header,null,we),m.createElement(l.a.Canvas,{hidden:ge},m.createElement("div",{className:f.a.designerContainer},m.createElement("iframe",{key:e.clientSessionId,"data-test-id":N.b.studioIframeId,name:"EmbeddedStudio",ref:G,src:Y,className:f.a.iframe,allow:Object(T.c)(be.tid,Object(p.j)().region),title:ce("Designer.CanvasEmbedTitle")}))),m.createElement(y.a,null),m.createElement(O.a,null),m.createElement(g.a,{cdsOrgUrl:ue}),m.createElement(C.a,null),m.createElement(S.a,null),m.createElement(w.a,null),m.createElement(x.a,null),m.createElement(W.a,null)));function ye(e){var t=G.current;t&&t.contentWindow&&(Object(A.e)({data:e},!0),t.contentWindow.postMessage(e,"*"))}function Oe(t){var n,r,o=t.data&&t.data.eventType,a=Object(T.d)(U.allowListFeatures,e.currentEnvironment,null===(n=e.history)||void 0===n||null===(r=n.location)||void 0===r?void 0:r.search);if(Object(h.a)(t,G.current,a)){var i,s;null!=t&&t.origin&&Object(T.g)(t.origin)&&Object(d.W)(E.n,{eventName:"".concat(E.m,"/invalidMessage"),eventData:{evt:t,eventOrigin:t.origin,iframeContentWindowExists:!(null===(i=G.current)||void 0===i||!i.contentWindow),studioHostname:a,iframeSrc:null===(s=G.current)||void 0===s?void 0:s.src}})}else{switch(Object(A.e)(t),q.current||void 0===Z.current||(q.current=!0,ee(),Object(d.W)(E.n,{eventName:"".concat(E.m,"/studioHeartbeat"),eventData:{activityId:J}})),o){case b.a.AcquireTokenAsync:case b.a.AcquireTokenSilentAsync:!function(e){Ce.apply(this,arguments)}(t);break;case b.a.WebAuthSessionRequested:!function(e){Se.apply(this,arguments)}(t);break;case b.a.WebAuthSessionDisposed:!function(){Ee.apply(this,arguments)}();break;case b.a.WebAuthSessionEstablished:ae(t);break;case b.a.EnvironmentsRequested:!function(t){ye({eventType:t.data.eventType,environments:e.environments})}(t);break;case b.a.CurrentEnvironmentRequested:ye({eventType:b.a.CurrentEnvironmentRequested,environment:e.currentEnvironment});break;case b.a.EnrollmentRequested:ye({eventType:b.a.EnrollmentRequested,enrollment:e.enrollmentAndUserDetails});break;case b.a.HostControlCreated:!function(){var e={Name:j.a.String};ye({eventType:b.a.SetHostSchema,controlName:"Teams",propertyName:X.Theme,propertySchema:e,isTable:!1});var t={DisplayName:j.a.String,Id:j.a.String,Kind:j.a.String};ye({eventType:b.a.SetHostSchema,controlName:"Teams",propertyName:X.ThisChannel,propertySchema:t,isTable:!1});var n={DisplayName:j.a.String,Id:j.a.String,GroupId:j.a.String};ye({eventType:b.a.SetHostSchema,controlName:"Teams",propertyName:X.ThisTeam,propertySchema:n,isTable:!1});var r={Id:j.a.String};ye({eventType:b.a.SetHostSchema,controlName:"Teams",propertyName:X.ThisMeeting,propertySchema:r,isTable:!1})}(),v.a.getContext(e=>{var t,n,r,o,a,i,s,c,l={Name:null!==(t=e.theme)&&void 0!==t?t:""};ye({eventType:b.a.SetHostData,controlName:"Teams",propertyName:X.Theme,propertyValue:l});var u={DisplayName:null!==(n=e.channelName)&&void 0!==n?n:"",Id:null!==(r=e.channelId)&&void 0!==r?r:"",Kind:null!==(o=e.channelType)&&void 0!==o?o:""};ye({eventType:b.a.SetHostData,controlName:"Teams",propertyName:X.ThisChannel,propertyValue:u});var d={DisplayName:null!==(a=e.teamName)&&void 0!==a?a:"",Id:null!==(i=e.teamId)&&void 0!==i?i:"",GroupId:null!==(s=e.groupId)&&void 0!==s?s:""};ye({eventType:b.a.SetHostData,controlName:"Teams",propertyName:X.ThisTeam,propertyValue:d});var p={Id:null!==(c=e.meetingId)&&void 0!==c?c:""};ye({eventType:b.a.SetHostData,controlName:"Teams",propertyName:X.ThisMeeting,propertyValue:p}),ye({eventType:b.a.SetHostData,controlName:"Teams",propertyName:X.ContextEntityId,propertyValue:e.entityId}),ye({eventType:b.a.SetHostData,controlName:"Teams",propertyName:X.IsSidePanel,propertyValue:e.frameContext===v.a.FrameContexts.sidePanel}),ye({eventType:b.a.SetHostData,controlName:"Teams",propertyName:X.IsFullScreen,propertyValue:e.isFullScreen})}),v.a.registerOnThemeChangeHandler(e=>{var t={Name:null!=e?e:""};ye({eventType:b.a.SetHostData,controlName:"Teams",propertyName:X.Theme,propertyValue:t})}),v.a.registerFullScreenHandler(e=>{ye({eventType:b.a.SetHostData,controlName:"Teams",propertyName:X.IsFullScreen,propertyValue:e})}),v.a.registerBeforeUnloadHandler(e=>(Q=e,Object(d.W)(E.n,{eventName:"".concat(E.m,"/BeforeUnloadInTeams")}),ye({eventType:b.a.BeforeUnloadInTeams}),!0));break;case b.a.ReadyToUnloadInTeams:!function(){var e="_onReadyToUnloadInTeamsEvent called";"function"==typeof Q&&(Q(),e="readyToUnloadFunc called");Object(d.W)(E.n,{eventName:"".concat(E.m,"/ReadyToUnloadInTeams"),eventData:{message:e}})}();break;case b.a.AutomationBroadcastServerEvent:(e=>{null==re||re.broadcastEventAsync(e.data.eventData)})(t);break;case b.a.AutomationStartServer:se();break;case b.a.AutomationHasServerStarted:ie();break;case b.a.ToggleSupportBot:me.toggleBot();break;case b.a.SendInitialSupportBotState:he();break;case b.a.AppNameChanged:(e=>{ne(e.data.appName)})(t)}e.onStudioMessageReceived&&e.onStudioMessageReceived(t),pe(o,t)}}function Ce(){return(Ce=z((function*(e){if(void 0!==e.data.requestId&&null!==e.data.requestId){var t,n=e.data.resourceUrl,r=e.data.claims;try{t=e.data.eventType===b.a.AcquireTokenAsync?yield Object(s.a)(n,r):yield Object(s.b)(n)}catch(o){Object(d.U)(E.n,{eventName:"".concat(E.m,"/acquireTokenError"),eventData:o}),t={error:o}}ye(B(B({},t),{},{result:t,requestId:e.data.requestId,eventType:e.data.eventType}))}}))).apply(this,arguments)}function Se(){return(Se=z((function*(e){var t=yield je(!1);ye({webAuthSession:{sessionToken:t.sessionToken,sessionState:t.sessionState,domainName:t.domainName,authoringHostVersion:t.authoringHostVersion,authoringHostEndpoint:t.authoringHostEndpoint,location:t.location,flags:{isCoauthoringAllowedT91:t.isCoauthoringAllowed,isCoauthoringAllowed:V.a.isCoauthoringAllowedContractBackwardsCompatibility?t.isCoauthoringAllowed:void 0,minimumSupportedVersionForCoauthoring:t.minimumSupportedVersionForCoauthoring,isCoauthoringWithMultipleWritersAllowed:V.a.isMultipleWritersAllowedContractBackwardsCompatibility?t.isCoauthoringWithMultipleWritersAllowed:void 0,isCoauthoringEnabledForApp:t.isCoauthoringEnabledForApp,isCoauthoringWithMultipleWritersAllowedT24:t.isCoauthoringWithMultipleWritersAllowed,isCoauthoringWithMultipleWritersEnabledForApp:t.isCoauthoringWithMultipleWritersEnabledForApp,minimumSupportedVersionForMultipleWriters:t.minimumSupportedVersionForMultipleWriters},coauthoringSessionId:t.coauthoringSessionId},eventType:e.data.eventType})}))).apply(this,arguments)}function Ee(){return(Ee=z((function*(){Object(i.g)()}))).apply(this,arguments)}function je(){return Te.apply(this,arguments)}function Te(){return(Te=z((function*(){var t,n,r,o,a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=new URL(e.studioURL).searchParams,c=(null!==(t=e.studioVersion)&&void 0!==t?t:s.get(I.a.StudioVersion.value))||void 0,l=s.get(I.a.DomainName.value)||void 0,u=(null===(n=s.get(I.a.Action.value))||void 0===n?void 0:n.toLowerCase())||void 0,p=u===E.l,v=p?void 0:s.get(I.a.AppId.value)||void 0,m=null;return m=e.skipNewInstance?yield Object(i.c)(U.allowListFeatures,e.currentEnvironment,l,c,a?i.a.OnBrowserUnload:i.a.None):yield Object(i.d)(e.clientSessionId,U.allowListFeatures,e.currentEnvironment,a?i.a.OnBrowserUnload:i.a.None,v,c,l,!0,V.a.allowWebAuthSessionRetries,u),Object(d.W)(E.n,{eventName:"".concat(E.m,"/CanvasHostBase.onAuthoringHostVersionDetermined"),eventData:{clientStudioSessionId:e.clientSessionId,hostStudioSessionId:m.sessionId,coauthoringSessionId:m.coauthoringSessionId,studioURL:e.studioURL,studioVersionProp:e.studioVersion,authoringHostVersion:m.authoringHostVersion,isCoauthoringAllowed:m.isCoauthoringAllowed,isCoauthoringEnabledForApp:m.isCoauthoringEnabledForApp,isCoauthoringWithMultipleWritersAllowed:m.isCoauthoringWithMultipleWritersAllowed,location:m.location,minimumSupportedVersionForCoauthoring:m.minimumSupportedVersionForCoauthoring,environmentName:null===(r=e.currentEnvironment)||void 0===r?void 0:r.name}}),null===(o=e.onAuthoringHostVersionDetermined)||void 0===o||o.call(e,m.authoringHostVersion),m}))).apply(this,arguments)}};var K=(e,t)=>{var n,r;return e.studioMessage===t.studioMessage&&(e.studioVersion===t.studioVersion&&!!Object(T.a)(null===(n=e.currentEnvironment)||void 0===n?void 0:n.id,null===(r=t.currentEnvironment)||void 0===r?void 0:r.id))},Z=Object(r.h)(Object(u.s)("CanvasHost")(m.memo(J,K)));t.default=Z},25012:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(25013),o=n(25022),a=n(25024);function i(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){i(a,r,o,s,c,"next",e)}function c(e){i(a,r,o,s,c,"throw",e)}s(void 0)}))}}class c{get hasStarted(){if(this._isDisposed)throw new Error("Object has already been disposed.");return this._channels.filter(e=>e.isOpen&&e.onMessageReceived().has(this.channelMessageReceived)).length===this._channels.length}constructor(){this._channels=[],this._onCommandReceived=new r.a,this._onQueryReceived=new r.a,this._isDisposed=!1;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)throw new Error("clientChannels");t.forEach(e=>this._channels.push(e)),this.channelMessageReceived=this.channelMessageReceived.bind(this)}startAsync(){var e=this;return s((function*(){if(e._isDisposed)throw new Error("Object has already been disposed.");if(e.hasStarted)throw new Error("Server has already started.");yield Promise.all(e._channels.map(function(){var t=s((function*(t){t.onMessageReceived().has(e.channelMessageReceived)||t.onMessageReceived().attach(e.channelMessageReceived),t.isOpen||(yield t.openAsync())}));return function(e){return t.apply(this,arguments)}}()))}))()}stopAsync(){var e=this;return s((function*(){if(e._isDisposed)throw new Error("Object has already been disposed.");if(!e.hasStarted)throw new Error("Sever has not started.");yield Promise.all(e._channels.map(function(){var t=s((function*(t){t.onMessageReceived().has(e.channelMessageReceived)&&t.onMessageReceived().detach(e.channelMessageReceived),t.isOpen&&(yield t.closeAsync())}));return function(e){return t.apply(this,arguments)}}()))}))()}broadcastEventAsync(e,t){var n=this;return s((function*(){if(n._isDisposed)throw new Error("Object has already been disposed.");if(!n.hasStarted)throw new Error("Server has not started.");if(null==e)throw new Error("event");if(null!=t&&t%1!=0)throw new Error("timeout");if(null!=t&&t<=0)throw new Error("timeout");yield Promise.all(n._channels.map(n=>n.isOpen?n.sendMessageAsync(e,t).catch(()=>Promise.resolve()):Promise.resolve()))}))()}get onCommandReceived(){if(this._isDisposed)throw new Error("Object has already been disposed.");return this._onCommandReceived}get onQueryReceived(){if(this._isDisposed)throw new Error("Object has already been disposed.");return this._onQueryReceived}channelMessageReceived(e){if(this._isDisposed)throw new Error("Object has already been disposed.");if(null==e.sender)throw new Error("sender");if(null==e)throw new Error("args");if(null==e.message)throw new Error("args");if(null==e.message.type)throw new Error("args");if(""===e.message.type)throw new Error("args");if(e.message.type.lastIndexOf("Command")===e.message.type.length-"Command".length){if(null==e.message)throw new Error("args");var t=e.message,n=new a.a(this,t);this._onCommandReceived.post(n)}else if(e.message.type.lastIndexOf("Query")===e.message.type.length-"Query".length){if(null==e.message)throw new Error("args");var r=e.message,i=new o.a(this,r);this._onQueryReceived.post(i)}}dispose(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._isDisposed)throw new Error("Object has already been disposed.");try{this._onCommandReceived.detach(),this._onQueryReceived.detach()}catch(t){}e&&this._channels.forEach(e=>e.dispose()),this._isDisposed=!0}}},25013:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(25014);class o extends r.AnyEvent{has(){var e,t,n,r=this._events;if(!r||0===r.length)return!1;for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];for(var s of(a.length>=1&&("function"==typeof a[0]?t=a[0]:1===a.length&&"function"==typeof a[0].post?n=a[0]:e=a[0]),a.length>=2&&(t=a[1]),r)){var c=s._listeners;if(c&&0!==c.length)for(var l of c)if(!(void 0!==t&&l.handler!==t||void 0!==n&&l.event!==n||void 0!==e&&l.boundTo!==e||l.deleted))return!0}return!1}}},25022:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(25023);class o extends r.a{constructor(e,t){super(e),this.query=void 0,this.query=t}}},25023:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e){this.sender=void 0,this.sender=e}}},25024:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(25023);class o extends r.a{constructor(e,t){super(e),this.command=void 0,this.command=t}}},25025:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(25013),o=n(25026),a=n.n(o),i=n(25028);function s(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){s(a,r,o,i,c,"next",e)}function c(e){s(a,r,o,i,c,"throw",e)}i(void 0)}))}}a.a.CONFIG.LOG_LEVEL="error";class l{get remoteWindow(){return this._remoteWindow}get isOpen(){return this._isOpen}constructor(e,t){if(this._remoteWindow=void 0,this._remoteWindowAuthority=null,this._client=void 0,this._listener=void 0,this._isOpen=!1,this._onMessageReceivedEvent=new r.a,this._isDisposed=!1,null==e)throw new Error("remoteWindow");if(e===window)throw new Error("The remote window and the current window cannot be the same.");this._remoteWindow=e,null!=t&&""!==t&&(this._remoteWindowAuthority=t)}openAsync(){var e=this;return c((function*(){if(e._isDisposed)throw new Error("Object has already been disposed.");if(e.isOpen)throw new Error("Channel is already open");e._client=a.a.client({domain:null!=e._remoteWindowAuthority?e._remoteWindowAuthority:"*",window:e._remoteWindow}),e._listener=a.a.on("*",{domain:null!=e._remoteWindowAuthority?e._remoteWindowAuthority:"*",window:e._remoteWindow},e.listenerMessageReceived.bind(e)),e._isOpen=!0}))()}closeAsync(){var e=this;return c((function*(){if(e._isDisposed)throw new Error("Object has already been disposed.");if(!e.isOpen)throw new Error("Channel is already closed");e._client=null,e._listener.cancel(),e._listener=null,e._isOpen=!1}))()}sendMessageAsync(e,t){var n=this;return c((function*(){if(null==e)throw new Error("message");if(null!=t&&t%1!=0)throw new Error("timeout");if(null!=t&&t<=0)throw new Error("timeout");if(!n.isOpen)throw new Error("Channel is not open.");yield n._client.send("*",e,{timeout:t})}))()}onMessageReceived(){if(this._isDisposed)throw new Error("Object has already been disposed.");return this._onMessageReceivedEvent}listenerMessageReceived(e){if(null==e)throw new Error("e");if(null==e.origin)throw new Error("e");if(""===e.origin)throw new Error("e");if(null==e.data)throw new Error("e");if(null==e.data)throw new Error("e");var t=e.data,n=new i.a(this,t);this._onMessageReceivedEvent.post(n)}dispose(){if(this._isDisposed)throw new Error("Object has already been disposed.");try{this._onMessageReceivedEvent.detach(),this.isOpen&&this.closeAsync().catch()}catch(e){}this._isDisposed=!0}}},25028:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(25023);class o extends r.a{constructor(e,t){super(e),this.message=void 0,this.message=t}}},25029:function(e,t,n){"use strict";function r(e,t,n){return!t||!t.contentWindow||!e.origin.includes(n)}n.d(t,"a",(function(){return r}))},25030:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(10926),o=n(12394),a=n(12095),i=n(25031),s=n(11844),c=Object(s.a)(()=>Promise.all([n.e(588),n.e(587),n.e(730)]).then(n.bind(null,39431))),l=e=>{var[t,n]=r.useState(!1),[s,l]=r.useState(void 0),[u,d]=r.useState(void 0);Object(i.c)("AddResourcesDialogWrapper",(e,t)=>{switch(e){case o.a.OpenAddResourcesDialog:if(null==t||!t.data)break;l(t.data.solutionId),n(!0);break;case o.a.AddResourceExecuted:if(null==t||!t.data)break;null!=t.data.error?d(t.data.error):n(!1)}});var p=r.useCallback(()=>{n(!1),d(void 0)},[n,d]),v=r.useCallback(()=>{d(void 0)},[d]);return a.a.enableAddResourcesDialogIntegration&&t?r.createElement(c,{onDismiss:p,newResourceUrl:e.cdsOrgUrl?"".concat(e.cdsOrgUrl,"main.aspx?appSolutionId=").concat(s,"&etc=").concat("9333","&pagetype=webresourceedit"):void 0,emptyStateIcon:"FileASPX",solutionId:s,errorMessage:u,onDismissErrorMessage:v,singleSelect:!0}):null}},25031:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u}));var r=n(10926);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=r.createContext({subscribe:()=>{},unsubscribe:()=>{},publish:()=>{}});function c(e){var[t,n]=r.useState({}),o=r.useCallback((e,n)=>Object.keys(t).forEach(r=>t[r](e,n)),[t]),i=r.useMemo(()=>({subscribe:(e,t)=>n(n=>n=a(a({},n),{},{[e]:t})),unsubscribe:e=>n(t=>(delete(t=a({},t))[e],t)),publish:e}),[e,n]);return[r.useCallback(e=>{var{children:t}=e;return r.createElement(s.Provider,{value:i},t)},[i]),o]}function l(){return r.useContext(s).publish}function u(e,t,n){var{subscribe:o,unsubscribe:a}=r.useContext(s);r.useEffect(()=>(o(e,t),()=>a(e)),[o,e,n])}},25032:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(11465),o=n(11824),a=n(11624),i=n(11708),s=n(10926),c=n(12394),l=n(25031),u=n(12096),d=function(e){return e.AppSaved="AppSaved",e.AppPublished="AppPublished",e}(d||{}),p=Object(r.s)("CanvasHost")(e=>{var{t:t}=e,[n,r]=s.useState(!1),p=s.useRef(!1);Object(l.c)("AppDesignerHandler",(e,t)=>{switch(e){case c.a.FileSave:var n,o,a=t,{appToken:i,isNewApp:s}=a.data;if("app-designer"===new URLSearchParams(location.search).get(u.a.Source.value)&&a.data.appToken)null===(n=window.opener)||void 0===n||null===(o=n.postMessage)||void 0===o||o.call(n,JSON.stringify({type:d.AppSaved,appToken:i,isNewApp:s}),location.origin),p.current||(p.current=!0,r(!0));break;case c.a.FilePublish:var l,v,m=t,{appName:f}=m.data;if("app-designer"===new URLSearchParams(location.search).get(u.a.Source.value)&&f)null===(l=window.opener)||void 0===l||null===(v=l.postMessage)||void 0===v||v.call(l,JSON.stringify({type:d.AppPublished,appName:f}),location.origin)}});var v=()=>r(!1);return s.createElement(a.a,{hidden:!n,dialogContentProps:{title:t("AppDesignerHandler.ReturnTitle"),subText:t("AppDesignerHandler.ReturnSubText"),showCloseButton:!0,closeButtonAriaLabel:t("AppDesignerHandler.CloseButtonAriaLabel")},onDismiss:v},s.createElement(i.a,null,s.createElement(o.a,{text:t("AppDesignerHandler.DismissButtonText"),onClick:v})))})},25033:function(e,t,n){"use strict";var r=n(12219),o=n(11841),a=n(12217),i=n(11465),s=n(11631),c=n(11712),l=n(10926),u=n(25034),d=n(12394),p=n(25031),v=n(11844),m=n(10929),f=n(12094),h=Object(v.a)(()=>Promise.all([n.e(143),n.e(731)]).then(n.bind(null,39432)));var b=Object(o.a)(e=>{var{t:t}=e,{currentEnvironment:n}=Object(r.W)(),[o,i]=l.useState(!1),[v,b]=l.useState(!1),[g,w]=l.useState(void 0),[y,O]=l.useState(()=>()=>{});Object(p.c)("FlowCreationModal",(e,t)=>{switch(e){case d.a.CreateNewFlow:w(t.data.solutionId),i(!0)}});var C,S=Object(p.b)(),E=Object(u.a)(),j=Object(m.db)({flowCreationModal:{position:"absolute",width:v?"1820px":"800px",height:v?"830px":"470px",outline:"none",display:"flex"}});return o?l.createElement("div",null,l.createElement(s.a,{scrollableContentClassName:E.flowCreationModalScrollableSection,containerClassName:j.flowCreationModal,isOpen:o,isBlocking:!0},l.createElement("div",{className:E.flowCreationModalHeader},l.createElement("h4",{className:E.flowCreationModalHeaderText}," ",t("FlowCreationModal.CreateYourFlow")," "),l.createElement(c.a,{onClick:y,className:E.flowCreationModalCloseIcon,iconProps:{iconName:"Cancel"},ariaLabel:t("Common.Close")})),l.createElement(h,{environmentId:(null==n?void 0:n.name)||"",hostId:f.k,hostname:a.U.powerAppsFlowHostName,solutionId:null!=g?g:(C=new URL(location.href),C.searchParams.get("solution-id")||""),hideDesignerTestButton:!0,widgetType:f.o.templates,onWidgetClose:e=>{i(!1),b(!1)},onFlowCreated:e=>{var t={eventType:d.a.NewFlowCreated,flowId:null==e?void 0:e.flowId};S(t),i(!1)},onFullDesignerRendered:()=>{b(!0)},onDesignerBackButtonClicked:()=>{b(!1)},handleSetOnDismissModal:e=>{O(()=>e)}}))):null},[Object(i.s)("CanvasHost")]);t.a=b},25034:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10929),o=()=>Object(r.db)({flowCreationModalCloseIcon:{float:"right"},flowCreationModalHeader:{width:"100%",padding:"10px 20px 5px 32px"},flowCreationModalHeaderText:{display:"inline",fontWeight:"600",fontSize:"20px"},flowCreationModalScrollableSection:{overflow:"hidden"},spinner:{marginTop:20}})},25035:function(e,t,n){"use strict";var r=n(12219),o=n(11841),a=n(12217),i=n(11465),s=n(11631),c=n(11712),l=n(10926),u=n(25036),d=n(12394),p=n(25031),v=n(11844),m=n(10929),f=n(12094),h=Object(v.a)(()=>Promise.all([n.e(143),n.e(731)]).then(n.bind(null,39432)));var b=Object(o.a)(e=>{var{t:t}=e,{currentEnvironment:n}=Object(r.W)(),[o,i]=l.useState(!1),[v,b]=l.useState(""),[g,w]=l.useState(void 0),[y,O]=l.useState(()=>()=>{});Object(p.c)("FlowEditModal",(e,t)=>{e===d.a.EditFlow&&t.data.flowName&&(b(t.data.flowName),w(t.data.solutionId),i(!0))});var C,S=Object(p.b)(),E=Object(u.a)(),j=Object(m.db)({flowEditModal:{position:"absolute",width:"1820px",height:"830px",outline:"none",display:"flex"}});return o?l.createElement(s.a,{scrollableContentClassName:E.flowEditModalScrollableSection,containerClassName:j.flowEditModal,isOpen:o,isBlocking:!0},l.createElement("div",{className:E.flowEditModalHeader},l.createElement(c.a,{onClick:y,className:E.flowEditModalCloseIcon,iconProps:{iconName:"Cancel"},ariaLabel:t("Common.Close")})),l.createElement(h,{environmentId:(null==n?void 0:n.name)||"",hostId:f.k,hostname:a.U.powerAppsFlowHostName,widgetType:f.o.flowEdit,flowName:v,hideDesignerTestButton:!0,hideDesignerBackButton:!0,solutionId:null!=g?g:(C=new URL(location.href),C.searchParams.get("solution-id")||""),onWidgetClose:e=>{var t={eventType:d.a.RefreshFlowInApp,flowId:v};S(t),i(!1)},handleSetOnDismissModal:e=>{O(()=>e)}})):null},[Object(i.s)("CanvasHost")]);t.a=b},25036:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10929),o=()=>Object(r.db)({flowEditModalCloseIcon:{float:"right"},flowEditModalHeader:{width:"100%","padding-right":"20px","font-weight":"600","font-size":"20px","padding-top":"10px","padding-left":"32px"},flowEditModalScrollableSection:{overflow:"hidden"},spinner:{marginTop:20}})},25037:function(e,t,n){"use strict";var r=n(25038),o=n(12219),a=n(10926),i=n(12394),s=n(25031),c=n(13616),l=n(25039);function u(){return new URL(location.href).searchParams.get("solution-id")||void 0}var d=()=>{var e,t,n,[d,p]=a.useState(),[v,m]=a.useState(null),{currentEnvironment:f}=Object(o.W)(),{enableModernTableModal:h}=Object(c.f)();Object(s.c)("PowerTableDesignerModal",(e,t)=>{switch(e){case i.a.PowerTableDesignerOpened:p(t.data),t.data.entityLogicalName?m("ExistingTable"):m(h?"TableWizard":"ExistingTable")}});var b=Object(s.b)(),g=a.useCallback(e=>{var t={eventType:i.a.PowerTableDesignerClosed,entityLogicalName:e};b(t),m(null)},[b,m]),w=a.useCallback(()=>{p(void 0)},[p]);return a.createElement(a.Fragment,null,a.createElement(r.a,{isOpen:"ExistingTable"===v,environmentId:null!==(e=null==f?void 0:f.id)&&void 0!==e?e:"",solutionId:null!==(t=null==d?void 0:d.solutionId)&&void 0!==t?t:u(),tableName:null==d?void 0:d.entityLogicalName,commandBarProps:{hiddenCommands:new Set(["updateFormsAndViews"])},onDismiss:g,onDismissed:w}),a.createElement(l.a,{isOpen:"TableWizard"===v,solutionId:null!==(n=null==d?void 0:d.solutionId)&&void 0!==n?n:u(),onDismiss:()=>{g()},onTableCreated:e=>{g(e)}}))};t.a=d},25038:function(e,t,n){"use strict";var r=n(11465),o=n(10926),a=o.lazy(()=>Promise.all([Promise.all([n.e(127),n.e(153),n.e(156),n.e(155),n.e(151),n.e(17),n.e(452),n.e(478),n.e(343),n.e(333),n.e(538),n.e(521),n.e(289),n.e(332),n.e(540),n.e(535),n.e(278),n.e(539),n.e(507),n.e(536),n.e(541),n.e(543),n.e(184),n.e(532),n.e(470),n.e(202),n.e(204),n.e(545),n.e(549),n.e(302),n.e(546),n.e(183),n.e(548),n.e(547),n.e(186),n.e(265),n.e(255),n.e(205),n.e(266),n.e(146),n.e(67),n.e(312),n.e(522),n.e(310),n.e(524),n.e(313),n.e(465),n.e(509),n.e(520),n.e(506),n.e(510),n.e(544),n.e(534),n.e(523),n.e(198),n.e(533),n.e(329),n.e(551),n.e(553),n.e(264),n.e(552),n.e(528),n.e(554),n.e(557),n.e(341),n.e(88),n.e(245)]).then(n.bind(null,38398)),Object(r.p)(["PowerTableDesigner"])]).then(e=>{var[t]=e;return t}));t.a=e=>o.createElement(a,e)},25039:function(e,t,n){"use strict";var r=n(11465),o=n(10926),a=n(12411);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var s=o.lazy(()=>Promise.all([Promise.all([n.e(127),n.e(153),n.e(156),n.e(115),n.e(155),n.e(151),n.e(17),n.e(452),n.e(478),n.e(143),n.e(343),n.e(333),n.e(538),n.e(521),n.e(289),n.e(332),n.e(540),n.e(535),n.e(278),n.e(56),n.e(539),n.e(507),n.e(536),n.e(541),n.e(543),n.e(532),n.e(470),n.e(202),n.e(204),n.e(545),n.e(549),n.e(302),n.e(546),n.e(467),n.e(548),n.e(547),n.e(186),n.e(265),n.e(441),n.e(208),n.e(255),n.e(324),n.e(205),n.e(207),n.e(266),n.e(232),n.e(191),n.e(258),n.e(595),n.e(582),n.e(224),n.e(674),n.e(243),n.e(638),n.e(501),n.e(248),n.e(242),n.e(263),n.e(121),n.e(114),n.e(146),n.e(67),n.e(144),n.e(137),n.e(86),n.e(312),n.e(145),n.e(522),n.e(310),n.e(524),n.e(313),n.e(465),n.e(509),n.e(520),n.e(506),n.e(510),n.e(544),n.e(534),n.e(497),n.e(198),n.e(560),n.e(533),n.e(494),n.e(551),n.e(264),n.e(559),n.e(457),n.e(223),n.e(504),n.e(454),n.e(240),n.e(453),n.e(527),n.e(218),n.e(673),n.e(323),n.e(636),n.e(669),n.e(581),n.e(322),n.e(254),n.e(268),n.e(671),n.e(635),n.e(672),n.e(267)]).then(n.bind(null,39435)),Object(r.p)(["CreateAppWizard","PowerAppsWizards","CreateFrom"])]).then(e=>{var[t]=e;return t}));t.a=e=>{var[t,n]=o.useState(0);return o.useEffect(()=>{e.isOpen&&n(e=>t+1)},[e.isOpen]),o.createElement(o.Suspense,{fallback:o.createElement(a.b,null)},o.createElement(s,i({key:t},e)))}},25040:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(11908),o=n(12082),a=n(12394),i=n(25031),s=n(12219),c=()=>{var{currentEnvironmentName:e}=Object(s.X)();return Object(i.c)("TeamsHandler",(t,n)=>{switch(t){case a.a.PinToTeamsDialogOpened:var{appId:o}=n.data,i=encodeURIComponent(o);l("".concat(r.a.makerShellUrl,"/environments/").concat(e,"/teams/powerapps/pinapp/appid/").concat(i));break;case a.a.ManageChannelAvailabilityDialogOpened:var{appId:s,showDeepLink:c}=n.data,u=encodeURIComponent(s);l("".concat(r.a.makerShellUrl,"/environments/").concat(e,"/teams/powerapps/channelslist/appid/").concat(u,"/showdeeplink/").concat(null!=c&&c))}},e),null};function l(e){o.a.tasks.startTask({title:"PowerApps",height:600,width:600,url:e,card:void 0,fallbackUrl:void 0,completionBotId:void 0},void 0)}},25041:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){return e.Boolean="b",e.Date="d",e.DateTime="D",e.Number="n",e.String="s",e}({})},25042:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d}));var r=n(25043),o=n(11019),a=n(10920),i=n(11021);function s(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){s(a,r,o,i,c,"next",e)}function c(e){s(a,r,o,i,c,"throw",e)}i(void 0)}))}}class l{trackError(e,t){Object(i.U)("PowerAppsAuthFlow",{eventName:e,eventData:t})}trackEvent(e,t){Object(i.O)("PowerAppsAuthFlow",{eventName:e,eventData:t})}}function u(){var e,t=Object(a.d)(Object(a.b)());Object(r.c)({authenticationMode:r.a.Host,telemetryLocation:"eu"===t?"eu":"global",hostFunctions:{getAccessToken:(e=c((function*(e,t){try{t(void 0,yield function(e){return p.apply(this,arguments)}(e))}catch(n){t(Object(r.d)(n))}})),function(t,n){return e.apply(this,arguments)})},logger:new l,region:v(),sessionId:Object(i.y)(),hostType:"MakerPortal"})}function d(){Object(r.b)()}function p(){return(p=c((function*(e){var{claims:t,resource:n}=e;return(t?yield Object(o.f)(n,t):yield Object(o.g)(n)).accessToken}))).apply(this,arguments)}function v(){var e=Object(a.j)().region;switch(e){case"high":return"gcchigh";case"gov":return"gccmoderate";case"tie":return"test";default:return e}}},25055:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(10926),o=n(11844),a=n(12095),i=Object(o.a)(()=>Promise.all([n.e(143),n.e(324),n.e(144),n.e(323),n.e(140),n.e(732)]).then(n.bind(null,39439))),s=()=>a.a.embeddedConnectionExperience?r.createElement(r.Suspense,{fallback:r.createElement(r.Fragment,null)},r.createElement(i,null)):null},25056:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"f",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return h})),n.d(t,"c",(function(){return g})),n.d(t,"b",(function(){return y})),n.d(t,"h",(function(){return C})),n.d(t,"a",(function(){return S}));var r=n(12095),o=n(13450),a=n(25057),{useFeature:i,withFeature:s,feature:c}=Object(o.a)({teamName:"MakerPortal",owners:["cherieq"],description:"Enables the support bot for Canvas app designer",createdOn:"07/01/2022",fallback:{supportBot:{enableForCanvasDesigner:r.a.enableSupportBot}}}),{useFeature:l,withFeature:u,feature:d}=Object(o.a)({teamName:"MakerPortal",owners:["jalo"],description:"Enables the PPUX connection creation experience",createdOn:"08/30/2022",fallback:{embeddedConnectionExperience:r.a.embeddedConnectionExperience}}),{useFeature:p}=Object(o.a)({teamName:"MakerPortal",owners:["debuggay"],description:"Enables passing through the useMessageInvoke query parameter to the canvas app frame, routing invoke API calls through SignalR",createdOn:"01/12/2023",ecsURL:"https://ecs.skype.com/PowerApps-MakerPortal/MakerPortal/configurations/1068761",fallback:{enableMessagingWireInvoke:r.a.enableMessagingWireInvoke}}),{feature:v,useFeature:m}=Object(o.a)({teamName:"MakerPortal",owners:["jacalhou","pastudioia"],description:"Controls if we use Intelligence Service for Questions and Answers",createdOn:"06/26/2023",ecsURL:"https://ecs.skype.com/PowerApps-MakerPortal/MakerPortal/configurations/1105391",fallback:{enableIntelligenceServiceForQA:r.a.enableIntelligenceServiceForQA}}),{feature:f,useFeature:h}=Object(o.a)({teamName:"MakerPortal",owners:["pacrozie"],description:"Allows us to configure how long the Studio will wait for PPUX to provide the web auth session details before timing out and calling /newinstance itself. Value is in milliseconds.",createdOn:"07/27/2023",ecsURL:"https://ecs.skype.com/PowerApps-MakerPortal/MakerPortal/configurations/1114926",fallback:{webAuthSessionTimeoutOverride:6e4}}),{feature:b,useFeature:g}=Object(o.a)({teamName:"MakerPortal",owners:["takharch"],description:"If true app context will be sent to Augloop with every Copilot query",createdOn:"08/23/2023",ecsURL:"https://ecs.skype.com/PowerApps-MakerPortal/MakerPortal/configurations/1120690",fallback:{canvasCopilotSendContextToAugLoop:r.a.canvasCopilotSendContextToAugLoop}}),{feature:w,useFeature:y}=Object(o.a)({teamName:"MakerPortal",owners:["camontei","pastudioia"],description:"Enables the ability to select which augloop workflow schema version to use.",createdOn:"8/30/2023",ecsURL:"https://ecs.skype.com/PowerApps-MakerPortal/MakerPortal/configurations/1127212",fallback:{canvasAugloopWorkflowVersion:a.a.copilotVersion}}),{withFeature:O,useFeature:C}=Object(o.a)({teamName:"MakerPortal",owners:["eriwong"],description:"Enables zero prompt copilot experience",createdOn:"12/01/2023",fallback:{enableZeroPromptCopilot:r.a.enableZeroPromptCopilot}}),{feature:S}=Object(o.a)({teamName:"MakerPortal",owners:["vajagarl","pastudioia"],description:"Controls if columns should be included in app context or not, and if all data sources columns should be included",createdOn:"02/13/2024",ecsURL:"https://ecs.skype.com/PowerApps-MakerPortal/MakerPortal/configurations/1231602",fallback:{columnsInCopilotAppContext:{enabled:r.a.enableColumnsInCopilotAppContext,enabledForAllDataSources:r.a.enableAllDataSourcesColumnsInCopilotAppContext}}})},25057:function(e,t,n){"use strict";var r=n(11038);t.a=Object(r.e)({packageName:"canvasHost",settings:{copilotVersion:{description:"Flight value to change the version for maker copilot",values:{default:"",tie:"main",test:"main",preprod:"main",preview:"released",prod:"released"}}}})},25058:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(11844),o=n(11465),a=n(17676),i=n(10926),s=n.n(i),c=n(25059),l=n(25074);function u(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,o)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){u(a,r,o,i,s,"next",e)}function s(e){u(a,r,o,i,s,"throw",e)}i(void 0)}))}}var p=Object(r.a)(d((function*(){var[e]=yield Promise.all([Promise.all([n.e(521),n.e(467),n.e(232),n.e(243),n.e(230),n.e(262),n.e(242),n.e(227),n.e(734),n.e(488),n.e(116),n.e(636),n.e(733),n.e(639),n.e(225)]).then(n.bind(null,39441)),Object(o.p)(["CanvasCopilot"])]);return e.CopilotPaneWrapper}))),v=()=>{Object(l.m)();var e=Object(c.a)();return!!Object(a.f)().current&&e?s.a.createElement(p,null):s.a.createElement(s.a.Fragment,null)}},25059:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(25060),o=n(25071),a=n(11854),i=n.n(a),s=n(10926),c=n(25072),l=n(11021),u=n(25073),d=n(17677);function p(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,o)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){p(a,r,o,i,s,"next",e)}function s(e){p(a,r,o,i,s,"throw",e)}i(void 0)}))}}var m=function(){var e=v((function*(){var e=Object(l.X)(u.c,u.b.GetApiVersion);try{var t=yield Object(r.e)(),n=!!t&&-1!==i()(t,c.a);return n?e.complete():e.failure("Canvas version: ".concat(t," is lower then minimum supported ").concat(c.a)),n}catch(o){return e.failure(o),!1}}));return function(){return e.apply(this,arguments)}}(),f=()=>{var[e,t]=Object(s.useState)(!1),n=Object(d.a)().isEnabled,r=Object(o.a)(n),a=Object(s.useCallback)(v((function*(){return t(yield m())})),[t]);return Object(s.useEffect)(()=>{r&&a()},[r]),e}},25060:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"h",(function(){return v})),n.d(t,"j",(function(){return m})),n.d(t,"k",(function(){return f})),n.d(t,"m",(function(){return h})),n.d(t,"o",(function(){return b})),n.d(t,"p",(function(){return g})),n.d(t,"q",(function(){return w})),n.d(t,"r",(function(){return y})),n.d(t,"s",(function(){return O})),n.d(t,"t",(function(){return C})),n.d(t,"u",(function(){return S})),n.d(t,"e",(function(){return E})),n.d(t,"i",(function(){return j})),n.d(t,"l",(function(){return T})),n.d(t,"g",(function(){return P})),n.d(t,"n",(function(){return A}));var r=n(25061),o=n(25065),a=n(11031);function i(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){i(a,r,o,s,c,"next",e)}function c(e){i(a,r,o,s,c,"throw",e)}s(void 0)}))}}var c=()=>Object(r.b)("CloseUndoGroup",{}),l=e=>Object(r.b)("DismissWaitDialog",{id:e}),u=(e,t,n)=>Object(r.b)("CreateControl",{templateName:e,variantName:n,parentId:t.id}),d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.e.BlankScreen;return Object(r.b)("CreateScreen",{layoutName:e})},p=e=>Object(r.b)("GetControlByName",{controlName:e}),v=(e,t)=>Object(r.b)("GetControlsByTemplateName",{templateName:e,parentId:null==t?void 0:t.id}),m=()=>Object(r.b)("GetCurrentScreen",{}),f=()=>Object(r.b)("GetModernControlsFlag",{}),h=()=>Object(r.b)("GetSelectedControls",{}),b=function(){var e=s((function*(e){var t;return null!==(t=e)&&void 0!==t||(e="Copilot_Action_".concat(Object(a.a)())),yield Object(r.b)("OpenUndoGroup",{name:e}),e}));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=s((function*(){return Object(r.b)("Redo",{})}));return function(){return e.apply(this,arguments)}}(),w=e=>Object(r.b)("SetAppModernTheme",{propertyValue:e}),y=function(){var e=s((function*(e,t){return yield Object(r.b)("SetControlName",{controlId:e.id,newName:t})}));return function(t,n){return e.apply(this,arguments)}}(),O=(e,t,n)=>Object(r.b)("SetControlProperty",{controlId:e.id,propertyName:t,propertyValue:n}),C=function(){var e=s((function*(e){return Object(r.b)("ShowWaitDialog",{message:e})}));return function(t){return e.apply(this,arguments)}}(),S=()=>Object(r.b)("Undo",{}),E=()=>Object(r.b)("GetApiVersion",{}),j=e=>Object(r.b)("GetControlsTree",e?{controlId:e}:{}),T=e=>Object(r.b)("GetPreloadedControlPropertyRules",{controlId:e}),P=e=>Object(r.b)("GetControlProperties",{controlId:e}),A=()=>Object(r.b)("GetTabularDataSources",{})},25061:function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return v}));var r=n(10926),o=n(25062),a=n.n(o),i=n(25063),s=n(25064),c={};var l=new class{constructor(){this._eventEmitter=new a.a,this._messagePromises={},this._nextId=0,this._createPromise=e=>{var t=()=>{},n=()=>{},r=new Promise((e,r)=>{t=e,n=r});return this._messagePromises[e]={promise:r,resolve:t,reject:n},r},this._getNextId=()=>++this._nextId,this._resolvePromise=(e,t)=>{var n;null===(n=this._messagePromises[e])||void 0===n||n.resolve(t),delete this._messagePromises[e]},this._rejectPromise=(e,t)=>{var n;null===(n=this._messagePromises[e])||void 0===n||n.reject(t),delete this._messagePromises[e]},this._receiveEvent=e=>{var t=Object(i.a)();if(t&&t.src.startsWith(e.origin)){var n=e.data;if(void 0!==n.eventId)switch(n.eventType){case"AUTHORING_API":this._eventEmitter.emit(n.actionName,n.data);break;case"AUTHORING_API_ERROR":this._rejectPromise(n.eventId,{pacErrorCode:n.errorCode,error:n.error});break;case"AUTHORING_API_RESPONSE":this._resolvePromise(n.eventId,n.data)}}},this.registerListener=(e,t)=>(this._eventEmitter.addListener(e,t),()=>{this._eventEmitter.removeListener(e,t)}),this.sendEvent=(e,t)=>{var n=this._getNextId(),r=this._createPromise(n),o=Object(i.a)();return o?(o.contentWindow.postMessage({eventId:n,eventType:"AUTHORING_API",actionName:e,data:t},"*"),r):Promise.reject(new Error("No authoring window found"))}}startListening(){window.addEventListener("message",this._receiveEvent)}stopListening(){window.removeEventListener("message",this._receiveEvent)}},u=0;function d(){Object(r.useEffect)(()=>(0===u&&l.startListening(),u++,()=>{0===--u&&l.stopListening()}),[])}function p(e,t){if(0===u)throw Error("No event listeners are active.  Did you call the useCanvasHostAuthoringEventHandler hook?");return l.registerListener(e,t)}function v(e,t){if(0===u)throw Error("No event listeners are active.  Did you call the useCanvasHostAuthoringEventHandler hook?");return c[e]?Promise.resolve(c[e](t)):l.sendEvent(e,t)}s.a.enableDebugFunctions&&(window.canvasHostAuthoringApi={debugFunctions:{registerAuthoringEventListener:p,sendAuthoringEvent:v}})},25063:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(14283);function o(){var e=document.querySelectorAll('iframe[data-test-id="'.concat(r.b.studioIframeId,'"]'));if(1!==e.length)return null;var t=e[0];if(!t.contentWindow)throw new Error("Iframe does not have valid contentWindow");return t}},25064:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(11038),o=Object(r.d)({packageName:"canvasHostAuthoringApi",features:{enableDebugFunctions:{owner:"chasezemanek",description:"Connects developer functions to the window under the canvasHostAuthoringApi.debugFunctions namespace.",enabledFor:{test:!0,preprod:!1,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1}}}})},25065:function(e,t,n){"use strict";var r=n(25066);n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b}));var o=n(25067);n.d(t,"a",(function(){return o.a}));var a=n(25068);n.d(t,"d",(function(){return a.a})),n.d(t,"f",(function(){return a.b}));n(25069);var i=n(25070);n.d(t,"e",(function(){return i.a}))},25066:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r={Flexible:{SocialFeed:"BrowseLayout_Flexible_SocialFeed_pcfCore",NewsFeed:"BrowseLayout_Flexible_NewsFeed_pcfCore"},Horizontal:{TitleAndSubtitle:"BrowseLayout_Horizontal_TwoTextOneImageVariant_pcfCore",TitleAndSubtitleOnOverlay:"BrowseLayout_Horizontal_TwoTextOneImageOverlayVariant_pcfCore"},Vertical:{List:{Title:"BrowseLayout_Vertical_OneTextVariant_pcfCore",TitleAndSubtitle:"BrowseLayout_Vertical_TwoTextVariant_pcfCore",TitleSubtitleAndBody:"BrowseLayout_Vertical_ThreeTextVariant_pcfCore",ImageAndTitle:"BrowseLayout_Vertical_OneTextOneImageVariant_pcfCore",ImageTitleAndSubtitle:"BrowseLayout_Vertical_TwoTextOneImageVariant_pcfCore",ImageTitleSubtitleAndBody:"BrowseLayout_Vertical_ThreeTextOneImageVariant_pcfCore"},Gallery:{TwoColumns:"BrowseLayout_Vertical_OneImageTwoColumnVariant_pcfCore",ThreeColumns:"BrowseLayout_Vertical_OneImageThreeColumnVariant_pcfCore",TitleAndSubtitle:"BrowseLayout_Vertical_TwoTextOneImageTwoColumnVariant_pcfCore",TitleAndSubtitleOnOverlay:"BrowseLayout_Vertical_TwoTextOneImageTwoColumnOverlayVariant_pcfCore"}}},o=function(e){return e.Horizontal="horizontalAutoLayoutContainer",e.Manual="manualLayoutContainer",e.Vertical="verticalAutoLayoutContainer",e}({})},25067:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){return e.AddressInput="AddressInput",e.AddMediaWithImage="AddMediaWithImage",e.AddMedia="addMedia",e.AnnotateInMR="AnnotateInMR",e.AppInfo="appinfo",e.Arrow="arrow",e.Attachments="attachments",e.Audio="audioPlayback",e.Barcode="barcode",e.BarcodeReader="BarcodeReader",e.BarcodeScanner="barcodeScanner",e.BusinessCardReader="BusinessCardReader",e.Button="button",e.Camera="camera",e.Chatbot="Chatbot",e.Copilot="Copilot",e.CheckBox="checkbox",e.Circle="circle",e.ComboBox="combobox",e.Component="component",e.CompositeColumnChart="CompositeColumnChart",e.CompositeLineChart="CompositeLineChart",e.CompositePieChart="CompositePieChart",e.DataCard="dataCard",e.DataGrid="dataGrid",e.DataTable="dataTable",e.DatePicker="datepicker",e.Dropdown="dropdown",e.EntityExtraction="entityExtraction",e.EntityForm="entityForm",e.Export="export",e.FluidGrid="fluidGrid",e.Form="form",e.FormProcessor="FormProcessor",e.FormsPro="formspro",e.FormViewer="formViewer",e.Gallery="gallery",e.Group="group",e.GroupContainer="groupContainer",e.Hexagon="hexagon",e.HtmlViewer="htmlViewer",e.Icon="icon",e.IdentityDocument="IdentityDocument",e.Image="image",e.ImageDescription="ImageDescription",e.Import="import",e.InvoiceProcessing="InvoiceProcessing",e.IoTDeviceManager="IoTDeviceManager",e.KeyPhraseExtraction="KeyPhraseExtraction",e.Label="label",e.LanguageDetection="LanguageDetection",e.ListBox="listbox",e.Lookup="lookup",e.Map="Map",e.MeasureInMR="MeasureInMR",e.Microphone="microphone",e.MicrosoftStream="microsoftStreamPlayback",e.ObjectDetector="ObjectDetector",e.Octagon="octagon",e.PartialCircle="partialCircle",e.PdfViewer="pdfViewer",e.PenInput="inkControl",e.Pentagon="pentagon",e.PowerAppsOneGrid="PowerAppsOneGrid",e.PowerBI="powerbi",e.PowerVirtualAgentsChat="PowerVirtualAgentsChat",e.Radio="radio",e.Rating="rating",e.ReceiptProcessor="ReceiptProcessor",e.Rectangle="rectangle",e.RichForm="richForm",e.RichFormViewer="richFormViewer",e.RichTextEditor="richTextEditor",e.SalesNavigatorAccount="SalesNavigatorAccount",e.SalesNavigatorLead="SalesNavigatorLead",e.SentimentAnalysis="SentimentAnalysis",e.Screen="screen",e.Section="section",e.Slider="slider",e.Star="star",e.TabContainer="tabcontainer",e.TabPage="tabPage",e.Text="text",e.TextClassificationV2="TextClassificationV2",e.GptPromptEngineering="GptPromptEngineering",e.TextRecognizer="TextRecognizer",e.TextTranslation="TextTranslation",e.Timer="timer",e.Toggle="toggleSwitch",e.Triangle="triangle",e.TypedDataCard="typedDataCard",e.Video="videoPlayback",e.ViewIn3D="ViewIn3D",e.ViewInMR="ViewInMR",e.ViewShapeInMR="ViewShapeInMR",e}({})},25068:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r=function(e){return e.UnknownError="UnknownError",e.InternalError="InternalError",e.CreateControlFailed="CreateControlFailed",e.ControlNotFound="ControlNotFound",e.LayoutNotApplied="LayoutNotApplied",e.NotSupported="NotSupported",e.PhoneOnly="PhoneOnly",e.TabletOnly="TabletOnly",e.ReadOnly="ReadOnly",e.PreviewError="PreviewError",e.ModernOnlyTemplate="ModernOnlyTemplate",e.ModernThemesDisabled="ModernThemesDisabled",e}({});function o(e){return void 0!==e.pacErrorCode}},25069:function(e,t,n){"use strict"},25070:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){return e.BlankScreen="",e.Calendar="Calendar",e.Email="Email",e.Form="HeaderAndForm",e.HeaderFooter="HeaderFooter",e.HeaderMainFooter="HeaderMainFooter",e.LandscapePrint="A4Landscape",e.List="HeaderAndGallery",e.Meeting="Meeting",e.People="PeoplePicker",e.PortraitPrint="A4Portrait",e.Scrollable="FluidGridWithHeaderPageLayout",e.Sidebar="Sidebar",e.SplitScreen="SplitScreen",e.Success="Success",e.Tutorial="Tutorial",e}({})},25071:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(10926),o=n(25060),a=n(11021);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){c(a,r,o,i,s,"next",e)}function s(e){c(a,r,o,i,s,"throw",e)}i(void 0)}))}}var u=function(){var e=l((function*(){var e;return new Promise(function(){var t=l((function*(t,n){var r=window.setTimeout(()=>{e?t():n("ApiVersion is not available")},100);try{e=yield Object(o.e)(),t()}catch(a){n(a)}window.clearTimeout(r),t()}));return function(e,n){return t.apply(this,arguments)}}())}));return function(){return e.apply(this,arguments)}}(),d=e=>{var[t,n]=Object(r.useState)(!1),o=Object(r.useRef)(0),[c,d]=Object(r.useState)(50),p=Object(r.useRef)(100),v=Object(a.X)("PowerApps-Canvas-Host-Authoring-Api","useIsAuthoringApiAvailable"),m=function(){var r=l((function*(r){try{yield u(),v.complete({retries:50-c}),n(!0)}catch(l){t||n(!1),d(c-1),c>0&&e?o.current=setTimeout(m,p.current*=2):v.failure(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({retries:50-c,shouldRetry:e},Object(a.p)(l)))}}));return function(e){return r.apply(this,arguments)}}();return Object(r.useEffect)(()=>(m(e),()=>{o.current&&clearTimeout(o.current),n(!1)}),[e]),t}},25072:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="1.0"},25073:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i}));var r=n(12094),o=function(e){return e.GetApiVersion="GetApiVersion",e.CanvasLoading="CanvasLoading",e.CreateContext="CreateContext",e}({}),a=function(e){return e.ReadyStateChanged="ReadyStateChanged",e.AppPreviewStateChanged="AppPreviewStateChanged",e.ZeroPromptButtonClicked="ZeroPromptButtonClicked",e}({}),i="".concat(r.n,"/Copilot")},25074:function(e,t,n){"use strict";var r=n(25060);n.d(t,"c",(function(){return r.a})),n.d(t,"d",(function(){return r.d})),n.d(t,"f",(function(){return r.o})),n.d(t,"k",(function(){return r.t})),n.d(t,"g",(function(){return r.p})),n.d(t,"j",(function(){return r.s})),n.d(t,"l",(function(){return r.u}));var o=n(25061);n.d(t,"h",(function(){return o.a})),n.d(t,"i",(function(){return o.b})),n.d(t,"m",(function(){return o.c}));var a=n(25065);n.d(t,"e",(function(){return a.f})),n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return a.d}))}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/canvas-host-base.40f93d87.chunk.js.map
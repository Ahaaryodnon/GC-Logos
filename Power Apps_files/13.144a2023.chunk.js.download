/*! For license information please see 13.144a2023.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{12219:function(e,n,t){"use strict";var r=t(12220);t.d(n,"i",(function(){return r.a})),t.d(n,"l",(function(){return r.b})),t.d(n,"A",(function(){return r.c})),t.d(n,"J",(function(){return r.d}));var o=t(12286);t.d(n,"a",(function(){return o.a})),t.d(n,"b",(function(){return o.b})),t.d(n,"f",(function(){return o.d})),t.d(n,"o",(function(){return o.g})),t.d(n,"U",(function(){return o.r}));t(12329),t(12330);var i=t(12331);t.d(n,"g",(function(){return i.a})),t.d(n,"h",(function(){return i.b})),t.d(n,"db",(function(){return i.c}));var a=t(12289);t.d(n,"T",(function(){return a.b}));var c=t(11901);t.d(n,"c",(function(){return c.a})),t.d(n,"d",(function(){return c.b})),t.d(n,"e",(function(){return c.c})),t.d(n,"k",(function(){return c.d})),t.d(n,"m",(function(){return c.e})),t.d(n,"n",(function(){return c.f})),t.d(n,"p",(function(){return c.g})),t.d(n,"q",(function(){return c.h})),t.d(n,"r",(function(){return c.i})),t.d(n,"s",(function(){return c.j})),t.d(n,"t",(function(){return c.k})),t.d(n,"u",(function(){return c.l})),t.d(n,"v",(function(){return c.n})),t.d(n,"w",(function(){return c.o})),t.d(n,"x",(function(){return c.p})),t.d(n,"y",(function(){return c.q})),t.d(n,"z",(function(){return c.r})),t.d(n,"B",(function(){return c.s})),t.d(n,"C",(function(){return c.t})),t.d(n,"D",(function(){return c.u})),t.d(n,"E",(function(){return c.v})),t.d(n,"F",(function(){return c.w})),t.d(n,"G",(function(){return c.x})),t.d(n,"H",(function(){return c.y})),t.d(n,"I",(function(){return c.z})),t.d(n,"K",(function(){return c.A})),t.d(n,"L",(function(){return c.B})),t.d(n,"M",(function(){return c.C})),t.d(n,"N",(function(){return c.E})),t.d(n,"O",(function(){return c.F})),t.d(n,"P",(function(){return c.G})),t.d(n,"Q",(function(){return c.H})),t.d(n,"R",(function(){return c.I})),t.d(n,"S",(function(){return c.L}));t(12332);var u=t(12333);t.d(n,"cb",(function(){return u.a}));var s=t(12334);t.d(n,"eb",(function(){return s.a}));var v=t(12335);t.d(n,"V",(function(){return v.a})),t.d(n,"W",(function(){return v.b})),t.d(n,"X",(function(){return v.c})),t.d(n,"Y",(function(){return v.d})),t.d(n,"Z",(function(){return v.e})),t.d(n,"ab",(function(){return v.f})),t.d(n,"bb",(function(){return v.g}));t(12341);t.d(n,"j",(function(){return o.e}))},12220:function(e,n,t){"use strict";t.d(n,"a",(function(){return N})),t.d(n,"d",(function(){return B})),t.d(n,"c",(function(){return W})),t.d(n,"b",(function(){return K}));var r=t(11855),o=t(11853),i=t(11858),a=t(11020),c=t(11019),u=t(11842),s=t(11870),v=t(12068),l=t(11021),d=t(12221),p=t(12258),m=t.n(p),f=t(10926),h=t(11205),g=t(12285),b=t(12286),y=t(12287),E=t(12288),O=t(11838),j=t(12289),w=t(12323),S=t(10920);function P(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function L(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?P(Object(t),!0).forEach((function(n){D(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):P(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function D(e,n,t){return(n=function(e){var n=function(e,n){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function C(e,n,t,r,o,i,a){try{var c=e[i](a),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(r,o)}function F(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){C(i,r,o,a,c,"next",e)}function c(e){C(i,r,o,a,c,"throw",e)}a(void 0)}))}}var A,x,N=f.createContext({_environments:[],switchEnvironment:()=>null,forceRefreshEnvironmentsList:()=>null,addAndSetEnvironment:()=>null,addOrUpdateEnvironment:()=>null,refreshCurrentEnvironment:function(){return Promise.resolve(void 0)},currentEnvironmentType:r.f.Empty,currentEnvironmentLoadingStatus:u.a.NotLoaded,allEnvironmentsLoadingStatus:u.a.NotLoaded,environmentsFullyLoaded:!1}),k=!1;function T(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e===b.i||e===b.q)return"https://bap-rp/api/providers/Microsoft.BusinessAppPlatform/environments/".concat(e,"?api-version=").concat(b.a,"&$expand=properties.permissions&$filter=").concat(b.j);if(Object(g.a)()){var t=n?"&refreshCache=true":"";return"https://flow/providers/Microsoft.ProcessSimple/environments/".concat(e,"?api-version=").concat(b.a,"&$expand=properties/permissions").concat(t)}return k&&e!==b.q&&e!==b.i?"https://ppapi/powerapps/tenants/:tenantId/environments/".concat(e,"/environment?api-version=").concat(b.h,"&$expand=properties.permissions&$filter=").concat(b.j):"https://pa-rp/api/providers/Microsoft.PowerApps/environments/".concat(e,"?api-version=").concat(i.b,"&$expand=properties.permissions&$filter=").concat(b.j)}function M(e){var n=e.data;return n.type="Microsoft.PowerApps/environments/",n.id="/providers/"+n.type+n.name,e}var I,U=new Promise((e,n)=>{A=e,x=n}),R=new Promise(e=>{I=e});class q extends f.Component{constructor(e){var n,t;super(e),n=this,this.timeoutId=void 0,this.getAllEnvironments=()=>this.state.allEnvironments,this.combineSingleAndAllEnvironments=(e,n)=>{var t=[...n||this.state.allEnvironments];if(!e)return t;var r=t.findIndex(n=>n.name===(null==e?void 0:e.name));return-1===r?t.push(e):m()(t[r],e)||(t[r]=this.takeLatestEnvironment(e,t[r])),t},this.getCurrentEnvironmentLoadingStatus=e=>{if(e)return u.a.Loaded;var{allEnvironmentsLoadingStatus:n,singleEnvironmentLoadingStatus:t}=this.state;return null!=t?t:n},this.handleLoadingError=e=>{if(e instanceof Error)throw e;var n=e&&e.response&&e.response.data&&e.response.data.message||"Unable to get environment data";throw new Error(n)},this.switchEnvironment=(e,n)=>{var t;if(e){if(Object(l.W)(b.r,{eventName:"switchEnvironment",eventData:{newPath:n,environmentName:e.name}},l.j.Shell),n){var r=W(n);if(r&&r!==b.c&&r!==e.name)throw new Error("Environment in path must match provided environment")}n&&n.indexOf(b.c)>-1&&(n=n.replace(b.c,e.name));var o="/environments/".concat(e.name,"/home"),i=(null===(t=this.props.redirectablePaths)||void 0===t?void 0:t.find(e=>Object(h.h)(this.props.location.pathname,{path:e,exact:!0})))||"";i&&!n?this.props.history.push({pathname:i.replace(b.d,e.name),search:location.search,hash:location.hash}):this.props.history.push(n||o),X(e)}},this.addAndSetEnvironment=(e,n)=>{this.setState({singleEnvironment:e,allEnvironments:this.combineSingleAndAllEnvironments(e)},()=>this.switchEnvironment(e,n))},this.addOrUpdateEnvironment=e=>{var n,t=[...this.state.allEnvironments],r=t.findIndex(n=>n.name===e.name);-1===r?t.push(e):t[r]=e;var o={allEnvironments:t};(null===(n=this.state.singleEnvironment)||void 0===n?void 0:n.name)===e.name&&(o.singleEnvironment=e),this.setState(o)},this.refreshCurrentEnvironment=F((function*(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{var t,r=W(n.props.location.pathname);if(!r)return;var o=null!==(t=n.props.getSingleEnvironmentUrl)&&void 0!==t?t:T,i=o(r,e),a=yield n.props.httpClient.get(i,{team:l.j.Shell}).then(M),c=n.state.singleEnvironment,u=n.takeLatestEnvironment(a.data,c);if(!m()(c,u)){var s=n.combineSingleAndAllEnvironments(a.data,n.state.allEnvironments);n.setState({allEnvironments:s,singleEnvironment:u})}return u}catch(v){throw new Error("An error occurred while refreshing the current environment: ".concat(v))}})),this.getStorageKey=()=>Object(d.SHA256)(this.getEnvironmentFilterExpression()+this.props.tid+(Object(O.a)()?"tip2":"")).toString(),this.saveToStorage=e=>{v.c.setItemAsync(this.getStorageKey(),e)},this.retrieveAndSetCachedEnvironments=()=>{v.c.getItemAsync(this.getStorageKey()).then(function(){var e=F((function*(e){null!=e&&e.length?n.state.allEnvironmentsLoadingStatus===u.a.NotLoaded&&(Object(l.W)(b.r,{eventName:"cachedEnvironmentsList",eventData:{allEnvironments:e.map(e=>e.name)}},l.j.Shell),I(),n.setState({allEnvironments:e,allEnvironmentsLoadingStatus:u.a.Loaded})):Object(l.W)(b.r,{eventName:"emptyEnvironmentCache",eventData:{singleEnvironmentLoadingStatus:n.state.singleEnvironmentLoadingStatus,allEnvironmentsLoadingStatus:n.state.allEnvironmentsLoadingStatus}},l.j.Shell)}));return function(n){return e.apply(this,arguments)}}())},this.refreshEnvironmentsList=F((function*(){yield n.retrieveAndSetEnvironmentList(!1)})),this.state={singleEnvironment:void 0,allEnvironments:[],singleEnvironmentLoadingStatus:void 0,allEnvironmentsLoadingStatus:u.a.NotLoaded,singleEnvironmentLoadingError:void 0,allEnvironmentsLoadingError:void 0,environmentsFullyLoaded:!1,onGetEnvironmentByName:e.onGetEnvironmentByName},k=null!==(t=e.deprecateLegacyPARPForEssentialServices)&&void 0!==t&&t}componentDidMount(){var e=this;return F((function*(){e.retrieveAndSetPreferredEnvironment(),e.retrieveAndSetCachedEnvironments(),yield e.retrieveAndSetEnvironmentList()}))()}componentWillUnmount(){clearTimeout(this.timeoutId)}componentDidUpdate(e,n){var t=G(n.allEnvironments,e,n),r=G(this.state.allEnvironments,this.props,this.state);if(t!==r){var i,a,c,u,s,v,d=null==t||null===(i=t.properties.cluster)||void 0===i?void 0:i.geoShortName,p=null==r||null===(a=r.properties.cluster)||void 0===a?void 0:a.geoShortName,m=d&&Object(S.d)(d),f=p&&Object(S.d)(p),h=W(this.props.location.pathname);if(m&&f&&m!==f&&("eu"===m||"eu"===f)&&window.location.reload(),Object(l.z)(this.props.puid,this.props.oid,this.props.tid,p),r)null===(c=(u=this.props).onSwitchEnvironment)||void 0===c||c.call(u,L(L({},this.props.getPreferredEnvironmentConfigurationProps),{},{environment:r}));if(!t&&r)Object(l.W)(b.r,{eventName:"firstEnvironmentSelected",eventData:{environmentSpecified:!!h,isDefaultEnvironment:Object(o.J)(r),isDevEnvironment:Object(o.K)(r),isSharePointEnvironment:h===b.q,preferredEnvironmentProviderName:(null===(s=this.props.getPreferredEnvironment)||void 0===s?void 0:s.id)||(null===(v=Object(j.a)(this.props))||void 0===v?void 0:v.id)}},l.j.Shell);Object(l.W)(b.r,{eventName:"environmentPermissions",eventData:{currentEnvironmentName:null==r?void 0:r.name,currentEnvironmentPermissions:Object.keys((null==r?void 0:r.properties.permissions)||{}),isDefaultEnvironment:r&&Object(o.J)(r),isDevEnvironment:r&&Object(o.K)(r),isSharePointEnvironment:h===b.q,isDisabledEnvironment:r&&Object(o.L)(r),provisioningState:null==r?void 0:r.properties.provisioningState}},l.j.Shell)}X(r)}render(){var{allEnvironmentsLoadingStatus:e,singleEnvironmentLoadingStatus:n,singleEnvironmentLoadingError:t,allEnvironmentsLoadingError:r,environmentsFullyLoaded:i}=this.state;if(t){var a,s,v,{EnvironmentNotFoundComponent:l}=this.props;return f.createElement(l,{descriptionText:null==t||null===(a=t.response)||void 0===a||null===(s=a.data)||void 0===s||null===(v=s.error)||void 0===v?void 0:v.message})}var{history:d,location:p}=this.props,m=W(this.props.location.pathname),g=this.state.allEnvironments,y=G(g,this.props,this.state);if(Object(c.n)()||n!==u.a.Loaded||y||this.handleLoadingError(r),y){var E="";m===b.d?E=p.pathname:m!==b.q&&m!==b.i||(E=p.pathname.replace("/".concat(m),"/".concat(b.d))),E&&d.replace(L(L({},p),{},{pathname:Object(h.g)(E,{environmentId:y.name})}))}var O={_environments:g,currentEnvironment:y,switchEnvironment:this.switchEnvironment,forceRefreshEnvironmentsList:this.refreshEnvironmentsList,addAndSetEnvironment:this.addAndSetEnvironment,addOrUpdateEnvironment:this.addOrUpdateEnvironment,refreshCurrentEnvironment:this.refreshCurrentEnvironment,currentEnvironmentType:Object(o.y)(y),currentEnvironmentLoadingStatus:this.getCurrentEnvironmentLoadingStatus(y),allEnvironmentsLoadingStatus:e,environmentsFullyLoaded:i};return f.createElement(N.Provider,{value:O},f.createElement(f.Fragment,null,this.props.children))}retrieveAndSetPreferredEnvironment(){var e=this;return F((function*(){e.setState({singleEnvironmentLoadingStatus:u.a.NotLoaded});try{var n=e.props.getPreferredEnvironment?e.props.getPreferredEnvironment:Object(j.a)(e.props),t=L(L({},e.props.getPreferredEnvironmentConfigurationProps),{},{envListLoadPromise:e.getInitialLoadEnvironmentsPromise,getEnvironmentsList:e.getAllEnvironments,userInfoContext:e.props,addOrUpdateEnvironment:e.addOrUpdateEnvironment});e.props.getSingleEnvironmentUrl&&(t.getSingleEnvironmentUrl=e.props.getSingleEnvironmentUrl);var r=yield n.fn(t);r?e.setState({singleEnvironment:r,singleEnvironmentLoadingStatus:u.a.Loaded,allEnvironments:e.combineSingleAndAllEnvironments(r)}):e.setState({singleEnvironmentLoadingStatus:u.a.Loaded})}catch(o){e.setState({singleEnvironmentLoadingStatus:u.a.Error,singleEnvironmentLoadingError:o})}}))()}retrieveAndSetEnvironmentList(){var e=arguments,n=this;return F((function*(){var t=!(e.length>0&&void 0!==e[0])||e[0];try{var r,{httpClient:o}=n.props,i=n.getEnvironmentFilterExpression(),a=new URL(n.props.deprecateLegacyPARPForEssentialServices?b.l:b.k);a.searchParams.append("$filter",i);var c=(yield o.get(a.toString(),{page:!0,team:l.j.Shell})).data.value.filter(J),s=n.combineSingleAndAllEnvironments(n.state.singleEnvironment,c);if(null===(r=A)||void 0===r||r(),s){var v={environmentsFullyLoaded:!0,allEnvironmentsLoadingStatus:u.a.Loaded,allEnvironmentsLoadingError:void 0};m()(s,n.state.allEnvironments)?n.state.environmentsFullyLoaded||n.setState(v):(v=L(L({},v),{},{allEnvironments:s}),Object(l.W)(b.r,{eventName:"environmentsList",eventData:{allEnvironments:s.map(e=>e.name),filteredEnvironments:s.filter(e=>!c.includes(e)).map(e=>e.name)}},l.j.Shell),n.setState(v)),n.saveToStorage(s)}return s}catch(p){var d;return null===(d=x)||void 0===d||d(p),void(t&&n.setState({allEnvironmentsLoadingError:p,allEnvironmentsLoadingStatus:u.a.Error}))}}))()}getEnvironmentFilterExpression(){if(y.a.disableLiteEnvFilter)return b.j;var{environmentFilterBehavior:e}=this.props;switch(e){case b.e.ShowOnlyCdsLiteEnvironments:return"".concat(b.j," and ").concat(b.p);case b.e.ShowOnlyNonCdsLiteEnvironments:default:return"".concat(b.j," and ").concat(b.o)}}getInitialLoadEnvironmentsPromise(){var e=arguments;return F((function*(){return e.length>0&&void 0!==e[0]&&e[0]?U:Promise.race([R,U])}))()}takeLatestEnvironment(e,n){return!n||new Date(e.properties.lastModifiedTime)>new Date(n.properties.lastModifiedTime)?e:n}}function B(e,n,t){return $.apply(this,arguments)}function $(){return($=F((function*(e,n,t){var r=(null!=t?t:T)(n),o=yield e.get(r).then(M);if(J(o.data))return o.data}))).apply(this,arguments)}function W(e){var n=Object(h.h)(e,{path:"/e/".concat(b.d)});return(n=n||Object(h.h)(e,{path:"/environment/".concat(b.d)})||Object(h.h)(e,{path:"/environments/".concat(b.d)})||Object(h.h)(e,{path:"/widget/environments/".concat(b.d)}))&&n.params&&n.params.environmentId||""}function X(e){var n,t,r,o;if(e){var i=e.properties.linkedEnvironmentMetadata,a=null!==(n=null==i?void 0:i.uniqueName)&&void 0!==n?n:"",c=null!==(t=null==i?void 0:i.resourceId)&&void 0!==t?t:"",u=null!==(r=e.properties.environmentSku)&&void 0!==r?r:"",s=null!==(o=e.properties.cluster)&&void 0!==o?o:"";Object(l.k)("EnvironmentMetadata",{envId:e.name,envSku:u,orgId:c,orgUniqueName:a,location:e.location,cluster:s})}else Object(l.k)("EnvironmentMetadata",{})}function G(e,n,t){var r=W(n.location.pathname);if(r){var o=e.find(e=>Object(w.a)(e.name,r));if(o)return o}return t.singleEnvironment}function J(e){var n,t;if(null!=e&&null!==(n=e.properties)&&void 0!==n&&null!==(t=n.cluster)&&void 0!==t&&t.category){if((E.a.testEnvFilter||Object(O.a)())&&!Object(o.P)(e))return!1;if(E.a.preprodEnvFilter&&!Object(o.O)(e))return!1}return!Object(o.N)(e)}var K=Object(h.m)(Object(s.r)(Object(a.d)(q)))},12223:function(e,n){},12285:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(11019),o=t(11403),i=()=>!Object(r.n)()&&Object(o.f)()&&(!Object(o.d)()||Object(o.d)()===o.a.PowerAutomate)},12286:function(e,n,t){"use strict";t.d(n,"e",(function(){return i})),t.d(n,"d",(function(){return a})),t.d(n,"c",(function(){return c})),t.d(n,"r",(function(){return u})),t.d(n,"a",(function(){return s})),t.d(n,"h",(function(){return v})),t.d(n,"k",(function(){return l})),t.d(n,"l",(function(){return d})),t.d(n,"m",(function(){return p})),t.d(n,"n",(function(){return m})),t.d(n,"i",(function(){return f})),t.d(n,"q",(function(){return h})),t.d(n,"j",(function(){return g})),t.d(n,"o",(function(){return b})),t.d(n,"p",(function(){return y})),t.d(n,"g",(function(){return E})),t.d(n,"f",(function(){return O})),t.d(n,"b",(function(){return j}));var r=t(11858),o=function(e){return e.CDSLite="CDSLite",e.Standard="Standard",e}({}),i=function(e){return e[e.ShowOnlyCdsLiteEnvironments=0]="ShowOnlyCdsLiteEnvironments",e[e.ShowOnlyNonCdsLiteEnvironments=1]="ShowOnlyNonCdsLiteEnvironments",e}({}),a=(o.Standard,o.CDSLite,":environmentId"),c=":environmentName",u="powerapps-environment",s="2020-06-01",v="1",l="https://pa-rp/api/providers/Microsoft.PowerApps/environments?$expand=properties.permissions&api-version=".concat(r.b,"&$top=").concat(200),d="https://ppapi/powerapps/tenants/:tenantid/environments?$expand=properties.permissions&api-version=".concat(v,"&$top=").concat(200),p="https://pa-rp/api/providers/Microsoft.PowerApps/environments?$expand=properties.permissions,properties.capacity&api-version=".concat(r.b,"&$top=").concat(200),m="https://ppapi/powerapps/tenants/:tenantid/environments?$expand=properties.permissions,properties.capacity&api-version=".concat(v,"&$top=").concat(200),f="~default",h="~sharepointform",g="minimumAppPermission eq 'CanEdit'",b="properties.environmentSku ne 'Teams'",y="properties/connectedGroups/any(group:group/resources/any(resource:resource/type+eq+'Team'))",E=3e5,O=36e5,j="https://bap-rp/providers/Microsoft.BusinessAppPlatform/environments"},12287:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(11038),o=Object(r.d)({packageName:"powerplatform",features:{disableLiteEnvFilter:{owner:"xiaoxhua",createdDate:"06/17/2020",description:"Disable Lite environment filter",enabledFor:{}},enableOakdaleEnforcementMessaging:{owner:"nshah",description:"Enables enforcement warnings/errors when DfT environments approach/exceed their capacity limits",createdDate:"01/25/2021",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!1}},enableRoutingToDataverseEnvironment:{owner:"sergioe,jacalhou",description:"Enables routing user to a dataverse environment instead of default environment",enabledFor:{test:!1,preprod:!1,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1}}}})},12288:function(e,n,t){"use strict";var r=t(11038);n.a=Object(r.e)({packageName:"powerplatform",settings:{testEnvFilter:{description:"Filter to only cluster category test environments",allowOverrides:!0,values:{default:!1,test:!1}},preprodEnvFilter:{description:"Filter to only cluster category preprod environments",allowOverrides:!0,values:{default:!1,preprod:!0}}}})},12289:function(e,n,t){"use strict";t(12290),t(12320);var r=t(12321);t.d(n,"a",(function(){return r.a}));t(12322),t(12324),t(12327);var o=t(12326);t.d(n,"b",(function(){return o.b}));t(12325)},12290:function(e,n,t){"use strict";t.d(n,"a",(function(){return m}));var r=t(11021),o=t(12286),i=t(11901),a=t(12291),c=t(12292),u=t(12311),s=t(11465),v=t(11859),l=t(12312);function d(e,n,t,r,o,i,a){try{var c=e[i](a),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(r,o)}function p(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){d(i,r,o,a,c,"next",e)}function c(e){d(i,r,o,a,c,"throw",e)}a(void 0)}))}}var m={id:"getDevEnvironment",fn:function(e){return f.apply(this,arguments)}};function f(){return(f=p((function*(e){var{envListLoadPromise:n,getEnvironmentsList:t,userInfoContext:c,previousPreferredEnvironmentProvidersPromise:u}=e,s=g("EnvironmentPicker"),l=Object(r.X)(o.r,"preferredEnvironment/getDevEnvironment",{},r.j.Shell);if(window.location.search.includes("offer=dev")){var d=!1;try{var p=(yield n(!0).then(()=>t())).find(e=>Object(i.E)(e));if(!a.a.provisionDevEnvironmentWithoutEnrollmentCall||p)return l.complete({environmentFound:!!p}),p;if(void 0!==u?yield u:void 0)return void l.complete({skipped:!0,environmentFound:!1,previousProviderUsed:!0});d=!0,l.progress({message:"Creating developer environment"});var m=(yield s)("jitEnvironment.environmentName"),f=Object(v.a)("jitEnvironment.environmentName"!==m?m:"{0}",c.name);return p=yield h(f,e),l.complete({environmentFound:!!p,provisioned:!0}),p}catch(b){if(l.failure(b),d)throw b;return}}else l.complete({skipped:!0,environmentFound:!1})}))).apply(this,arguments)}var h=function(){var e=p((function*(e,n){var{addOrUpdateEnvironment:t}=n,i=Object(r.N)(o.r,"preferredEnvironment/getDevEnvironmentProvisioning",{},r.j.Shell),a=yield Object(c.a)(e,"Developer");return Object(u.a)({environment:a,templates:["D365_CDSSampleApp"]}).then(e=>{i.progress({message:"Successfully requested database attachment"}),Object(l.a)(e,t,i,void 0,0).then(()=>{i.complete({message:"Successfully attached database to environment"})}).catch(()=>{})}).catch(e=>{i.failure(Object(r.o)({message:"Failed to request attach database to environment"},e))}),i.progress({message:"Successfully created developer environment"}),a}));return function(n,t){return e.apply(this,arguments)}}(),g=function(){var e=p((function*(e){return yield Promise.race([Object(s.p)(e),new Promise(e=>setTimeout(e,2e3))]),Object(s.i)(e)}));return function(n){return e.apply(this,arguments)}}()},12291:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(11038),o=Object(r.d)({packageName:"powerappsFeatureGates",features:{deprecateLegacyPARP:{owner:"xiaoxhua",description:"Deprecate legacy powerapps RP. It enables converting pa-rp api to ppapi in make.powerapps.com, it could also switch some consumers to use ppapi instead of the legacy powerapps-rp",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!1,high:!1,dod:!1,mooncake:!1,ex:!0,rx:!0}},deprecateLegacyPARPForPinAppToChannels:{owner:"jennietu",description:"Deprecate legacy powerapps RP for critical services. This is separate flag so we can control migration separately for pinAppToChannels calls.",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1}},deprecateLegacyPARPForEssentialServices:{owner:"jacalhou",description:"Deprecate legacy powerapps RP for critical services. This is separate flag so we can control migration separately for essential calls.",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!1,high:!1,dod:!1,mooncake:!1,ex:!0,rx:!0}},enableNonVersionedGraphqlEndpoint:{owner:"vpareddy",description:"Enables non versioned graphql endpoints",enabledFor:{test:!0,preprod:!0,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1}},enableGeoGraphqlEndpoint:{owner:"vpareddy",description:"Enables geo based graphql endpoints",enabledFor:{test:!0,preprod:!0,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1}},showRepublishAppsMessageBar:{owner:"sbakli",description:"Shows republish apps message bar on apps list",enabledFor:{test:!0,preprod:!0,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1}},enableModernTableModal:{owner:"mirestom",description:"Enable the modern table wizard modal",createdDate:"08/16/2023",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0}},provisionDevEnvironmentWithoutEnrollmentCall:{owner:"jacalhou",description:"If enabled, dev environments will not be provisioned during enrollment. Disabled currently in environments where developer plan signup is not supported currently.",createdDate:"07/11/2023",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!1,high:!1,dod:!1,mooncake:!1}},enableEditingGlobalOrEntityCommands:{owner:"sergioe",description:"Enable app-less entry point from solution explorer to command designer.",createdDate:"08/16/2023",enabledFor:{test:!1,preprod:!1,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1}},enableCanvasAppsInSolutionsByDefault:{owner:"suskumar",description:"Enable the creation of canvas apps in default solution context by default.",createdDate:"03/02/2022",enabledFor:{test:!0,preview:!0,preprod:!0,prod:!0,gov:!1,high:!1,dod:!1,mooncake:!1}}}})},12292:function(e,n,t){"use strict";t.d(n,"b",(function(){return y})),t.d(n,"a",(function(){return E}));var r=t(11020),o=t(10926),i=t(12295),a=t(12293),c=t(11021),u=t(11868),s=t(11022),v=t(11466),l=t(12294),d=t(11859),p=t(12286);function m(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function f(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?m(Object(t),!0).forEach((function(n){h(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function h(e,n,t){return(n=function(e){var n=function(e,n){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function g(e,n,t,r,o,i,a){try{var c=e[i](a),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(r,o)}function b(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){g(i,r,o,a,c,"next",e)}function c(e){g(i,r,o,a,c,"throw",e)}a(void 0)}))}}function y(e){var{type:n,location:t,environmentDisplayName:u,switchToEnvironmentAfterCreation:p}=e,m=Object(o.useRef)(),{switchEnvironment:f}=Object(l.a)(),h=Object(o.useContext)(r.a),{t:g,ready:y}=Object(v.g)("EnvironmentPicker");return Object(i.a)(["power-platform-environment","createDataverseEnvironmentMutation"],b((function*(){m.current=Object(s.m)(a.f,a.e,void 0,c.j.Shell);var e=null!=u?u:Object(d.a)(y?g("jitEnvironment.environmentName"):"{0}",h.name);return yield E(e,n,t)})),{onSuccess:e=>{var n;e&&(null===(n=m.current)||void 0===n||n.complete({environmentID:null==e?void 0:e.name}),p&&f(e))},onError:e=>{var n;null===(n=m.current)||void 0===n||n.failure(e)}})}var E=function(){var e=b((function*(e,n,t){try{var r=f(f({},t&&{location:t}),{},{properties:{displayName:e,environmentSku:n}}),o="".concat(a.a,"?api-version=").concat(p.a),i=yield u.f.post(o,r).catch(e=>{var n,t,r,o=null==e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t||null===(r=t.error)||void 0===r?void 0:r.message;throw Object(c.U)(a.f,{eventName:a.d},o,c.j.Shell),e});if(i)return Object(c.W)(a.f,{eventName:a.b},c.j.Shell),i.data;throw new Error("Create environment api call response is null")}catch(s){throw Object(c.U)(a.f,{eventName:a.c},s,c.j.Shell),s}}));return function(n,t,r){return e.apply(this,arguments)}}()},12293:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"f",(function(){return o})),t.d(n,"e",(function(){return i})),t.d(n,"b",(function(){return a})),t.d(n,"c",(function(){return c})),t.d(n,"d",(function(){return u}));var r="https://bap-rp/providers/Microsoft.BusinessAppPlatform/environments",o="JITEnvironmentScope",i="JITCreateEnvironmentScenario",a="JITCreateEnvironment",c="JITCreateEnvironmentFailed",u="JITCreateEnvironmentFailedMessage"},12294:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(10926),o=t(12219);function i(){var{addAndSetEnvironment:e}=r.useContext(o.i);return{switchEnvironment:e}}},12311:function(e,n,t){"use strict";t.d(n,"b",(function(){return d})),t.d(n,"a",(function(){return p}));var r=t(11868),o=t(11021),i=t(10926),a=t.n(i),c=t(12295),u=t(12219),s=t(11853);function v(e,n,t,r,o,i,a){try{var c=e[i](a),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(r,o)}function l(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){v(i,r,o,a,c,"next",e)}function c(e){v(i,r,o,a,c,"throw",e)}a(void 0)}))}}function d(e){var{environment:n}=e,t=a.a.useRef(null);return Object(c.a)(["power-platform-environment","attachDataverseToEnvironmentMutation",null==n?void 0:n.name],l((function*(){if(t.current=Object(o.X)(u.U,"useAttachDataverseToEnvironment",void 0,o.j.Shell),Object(s.B)(n))throw new Error("EnvironmentAlreadyLinkedToDataverse");var r=yield p(e);if(202!==r.status)throw new Error("RequestedAttachingDataverseToEnvironmentFailed with status code: ".concat(r.status));return r})),{onSuccess:e=>{var n;null===(n=t.current)||void 0===n||n.complete({message:"RequestedAttachingDataverseToEnvironmentSuccess"})},onError:e=>{var n;return null===(n=t.current)||void 0===n?void 0:n.failure(e)}})}var p=function(){var e=l((function*(e){var{environment:n,languageId:t,currencyCode:o,templates:i}=e,a={baseLanguage:t,currency:{code:o},templates:i},c="".concat(u.b,"/").concat(null==n?void 0:n.name,"/provisionInstance?api-version=").concat(u.a),s=yield r.f.post(c,a);return{status:s.status,location:s.headers.location,retryAfterInSeconds:s.headers["retry-after"],environment:s.data}}));return function(n){return e.apply(this,arguments)}}()},12312:function(e,n,t){"use strict";t.d(n,"b",(function(){return p})),t.d(n,"a",(function(){return m}));var r=t(11868),o=t(11021),i=t(10926),a=t.n(i),c=t(12313),u=t(12219),s=t(12293);function v(e,n,t,r,o,i,a){try{var c=e[i](a),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(r,o)}function l(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){v(i,r,o,a,c,"next",e)}function c(e){v(i,r,o,a,c,"throw",e)}a(void 0)}))}}var d=10;function p(e){var n,{attachmentProvisioningResponse:t,maxPollingAttempts:r=d}=e,{addOrUpdateEnvironment:i}=a.a.useContext(u.i),s=a.a.useRef(null),{data:v,isInitialLoading:p,isError:f,error:h,refetch:g,status:b}=Object(c.a)(["power-platform-environment","usePollDataverseAttachmentStatus",null==t||null===(n=t.environment)||void 0===n?void 0:n.name,null==t?void 0:t.location],l((function*(){return s.current=Object(o.X)(u.U,"usePollDataverseAttachmentStatus",void 0,o.j.Shell),m(t,i,s.current,r,0)})),{enabled:!(null==t||!t.location)});return{data:v,isInitialLoading:p,isError:f,error:h,refetch:g,status:b}}var m=function(){var e=l((function*(e,n,t){var r,i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:d,c=arguments.length>4?arguments[4]:void 0;try{if(++c>a)throw null==t||t.failure({message:"AttachingDataverseToEnvironmentFailed",pollingCount:c,reason:"MaxAttemptsReached"}),new Error("AttachingDataverseToEnvironmentFailed - MaxAttemptsReached");yield new Promise(n=>setTimeout(n,1e3*e.retryAfterInSeconds));var u=yield f(e);switch(u.status){case 200:return null==t||t.complete({message:"AttachingDataverseToEnvironmentSuccess",pollingCount:c}),n(u.environment),u;case 202:return null==t||t.progress({message:"PollingAttachDataverseToEnvironment",pollingCount:c}),m(u,n,t,a,c);default:return null==t||t.failure({message:"AttachingDataverseToEnvironmentFailed",pollingCount:c,reason:"UnexpectedStatusCode",statusCode:u.status,provisioningState:null===(r=u.environment)||void 0===r||null===(i=r.properties)||void 0===i?void 0:i.provisioningState}),u.environment&&n(u.environment),u}}catch(s){throw null==t||t.failure({message:"AttachingDataverseToEnvironmentFailed",pollingCount:c,error:Object(o.o)(void 0,s)}),s}}));return function(n,t,r){return e.apply(this,arguments)}}(),f=function(){var e=l((function*(e){var n,t,{location:o}=e,i=o.substring(o.indexOf("providers")),a="https://bap-rp/".concat(i),c=yield r.f.get(a);if(200===c.status&&null!==(n=c)&&void 0!==n&&null!==(t=n.data)&&void 0!==t&&t.name){var v="".concat(s.a,"/").concat(c.data.name,"?$expand=properties.permissions&api-version=").concat(u.a);c=yield r.f.get(v)}return{status:c.status,location:c.headers.location,retryAfterInSeconds:c.headers["retry-after"],environment:c.data}}));return function(n){return e.apply(this,arguments)}}()},12320:function(e,n,t){"use strict";t.d(n,"a",(function(){return v}));var r=t(11901),o=t(12220),i=t(11868),a=t(12286),c=t(11021);function u(e,n,t,r,o,i,a){try{var c=e[i](a),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(r,o)}function s(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){u(i,r,o,a,c,"next",e)}function c(e){u(i,r,o,a,c,"throw",e)}a(void 0)}))}}var v={id:"getDefaultEnvironment",fn:function(e){return l.apply(this,arguments)}};function l(){return(l=s((function*(e){var{envListLoadPromise:n,getEnvironmentsList:t,getSingleEnvironmentUrl:u}=e,s=Object(c.X)(a.r,"preferredEnvironment/getDefaultEnvironment",{},c.j.Shell);try{var v=Object(o.d)(i.f,a.i,u),l=n().then(()=>t()).catch(()=>[]),d=yield Promise.race([v,l]),p=(Array.isArray(d)?d:[d]).find(e=>e&&Object(r.D)(e));if(p)return s.complete({environmentFound:!!p}),p;var m=yield v;return s.complete({environmentFound:!!m,environmentFromPointQuery:!0}),m}catch(f){return void s.failure(f)}}))).apply(this,arguments)}},12321:function(e,n,t){"use strict";t.d(n,"a",(function(){return p}));var r=t(11019),o=t(12320),i=t(12290),a=t(12322),c=t(12324),u=t(12325),s=t(12326),v=t(12327),l=t(12287),d=t(12328),p=e=>Object(u.a)([a.a,i.a,v.a,s.a,l.a.enableRoutingToDataverseEnvironment&&e.shouldUseNewEnvironmentLandingLogic&&d.a,!Object(r.n)()&&o.a,c.a].filter(Boolean))},12322:function(e,n,t){"use strict";t.d(n,"a",(function(){return v}));var r=t(12220),o=t(11868),i=t(12286),a=t(12323),c=t(11021);function u(e,n,t,r,o,i,a){try{var c=e[i](a),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(r,o)}function s(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){u(i,r,o,a,c,"next",e)}function c(e){u(i,r,o,a,c,"throw",e)}a(void 0)}))}}var v={id:"getEnvironmentFromPathname",fn:function(e){return l.apply(this,arguments)}};function l(){return(l=s((function*(e){var{envListLoadPromise:n,getEnvironmentsList:t,getSingleEnvironmentUrl:u}=e,s=Object(c.X)(i.r,"preferredEnvironment/getEnvironmentFromPathname",{},c.j.Shell),v=Object(r.c)(window.location.pathname);if(v&&d(v)&&v!==i.q)try{var l=Object(r.d)(o.f,v,u),p=n().then(()=>t()).catch(()=>[]),m=yield Promise.race([l,p]),f=(Array.isArray(m)?m:[m]).find(e=>e&&Object(a.a)(e.name,v));if(f)return s.complete({environmentFound:!!f}),f;var h=yield l;return s.complete({environmentFound:!!h,environmentFromPointQuery:!0}),h}catch(g){throw s.failure(g),g}else s.complete({skipped:!0,environmentFound:!1})}))).apply(this,arguments)}function d(e){return e&&e!==i.d&&e!==i.c}},12323:function(e,n,t){"use strict";function r(e,n){return!e&&!n||!(!e||!n)&&e.toUpperCase()===n.toUpperCase()}t.d(n,"a",(function(){return r}))},12324:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(11021),o=t(12286);function i(e,n,t,r,o,i,a){try{var c=e[i](a),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(r,o)}function a(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var a=e.apply(n,t);function c(e){i(a,r,o,c,u,"next",e)}function u(e){i(a,r,o,c,u,"throw",e)}c(void 0)}))}}var c={id:"getFirstEnvironment",fn:function(e){return u.apply(this,arguments)}};function u(){return(u=a((function*(e){var{envListLoadPromise:n,getEnvironmentsList:t}=e,i=Object(r.X)(o.r,"preferredEnvironment/getFirstEnvironment",{},r.j.Shell);try{var a=yield n().then(()=>t()),c=a.length>0?a[0]:void 0;return i.complete({environmentFound:!!c}),c}catch(u){return void i.failure(u)}}))).apply(this,arguments)}},12325:function(e,n,t){"use strict";t.d(n,"a",(function(){return v}));var r=t(11021),o=t(12286);function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){c(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n,t){return(n=function(e){var n=function(e,n){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function u(e,n,t,r,o,i,a){try{var c=e[i](a),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(r,o)}function s(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){u(i,r,o,a,c,"next",e)}function c(e){u(i,r,o,a,c,"throw",e)}a(void 0)}))}}var v=e=>({id:"getFirstPreferredEnvironmentStrategy",fn:l(e)}),l=e=>function(){var n=s((function*(n){var t=Object(r.X)(o.r,"getFirstPreferredEnvironmentStrategy",void 0,r.j.Shell),i=Promise.resolve(void 0),c=e.map(e=>{var t=e.fn(a(a({},n),{},{previousPreferredEnvironmentProvidersPromise:i}));return i=Promise.all([i,t]).then(e=>{var[n,t]=e;return null!=n?n:t}),s((function*(){return t}))});for(var[u,v]of c.entries())try{var l=yield v(n);if(l)return t.complete({providerIndex:u,providerId:e[u].id}),l}catch(d){throw t.failure(d),d}t.complete({providerId:"NotFound"})}));return function(e){return n.apply(this,arguments)}}()},12326:function(e,n,t){"use strict";t.d(n,"a",(function(){return p})),t.d(n,"b",(function(){return f}));var r=t(12068),o=t(12220),i=t(11868),a=t(11838),c=t(12286),u=t(11021),s=t(12323),v=t(11401);function l(e,n,t,r,o,i,a){try{var c=e[i](a),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(r,o)}function d(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){l(i,r,o,a,c,"next",e)}function c(e){l(i,r,o,a,c,"throw",e)}a(void 0)}))}}var p={id:"getMruEnvironmentFromLocalStorage",fn:e=>function(e){return m.apply(this,arguments)}(e)};function m(){return(m=d((function*(e){var{envListLoadPromise:n,getEnvironmentsList:t,getSingleEnvironmentUrl:a,localStorageKey:v}=e,l=Object(u.X)(c.r,"preferredEnvironment/getMruEnvironmentFromLocalStorage",{},u.j.Shell);try{var d=yield r.c.getItemAsync(g(v));if(!d)return void l.complete({noCacheFound:!0});var p=Object(o.d)(i.f,d,a),m=n().then(()=>t()).catch(()=>[]),f=yield Promise.race([p,m]),h=(Array.isArray(f)?f:[f]).find(e=>e&&Object(s.a)(e.name,d));if(h)return l.complete({environmentFound:!!h}),h;var b=yield p;return l.complete({environmentFound:!!b,environmentFromPointQuery:!0}),b}catch(y){return void l.failure(y)}}))).apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return(h=d((function*(e){var{environment:n,localStorageKey:t}=e;r.c.setItemAsync(g(t),n.name).catch(e=>{Object(u.W)(c.r,{eventName:"setMruEnvironmentInLocalStorageInternal",eventData:{error:Object(u.o)(e)}},u.j.Shell)})}))).apply(this,arguments)}function g(e){return"environment_".concat(Object(v.f)(),"_").concat(Object(a.a)().toString(),"_").concat(e)}},12327:function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var r=t(12220),o=t(11868),i=t(12286),a=t(11021);function c(e,n,t,r,o,i,a){try{var c=e[i](a),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(r,o)}function u(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){c(i,r,o,a,u,"next",e)}function u(e){c(i,r,o,a,u,"throw",e)}a(void 0)}))}}var s={id:"getSharePointEnvironment",fn:function(e){return v.apply(this,arguments)}};function v(){return(v=u((function*(e){var{getSingleEnvironmentUrl:n}=e,t=Object(a.X)(i.r,"preferredEnvironment/getSharePointEnvironment",{},a.j.Shell);try{if(Object(r.c)(window.location.pathname)!==i.q)return;var c=Object(r.d)(o.f,i.q,n),u=yield c;return t.complete({environmentFound:!!u,environmentFromPointQuery:!0}),u}catch(s){throw t.failure(s),s}}))).apply(this,arguments)}},12328:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var r=t(11021),o=t(12286),i=t(11901);function a(e,n,t,r,o,i,a){try{var c=e[i](a),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(r,o)}function c(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function c(e){a(i,r,o,c,u,"next",e)}function u(e){a(i,r,o,c,u,"throw",e)}c(void 0)}))}}var u={id:"getUserDataverseEnvironmentByType",fn:function(e){return s.apply(this,arguments)}};function s(){return(s=c((function*(e){var{envListLoadPromise:n,getEnvironmentsList:t,environmentTypes:a=[i.e.Sandbox,i.e.Production,i.e.Developer]}=e,c=Object(r.X)(o.r,"preferredEnvironment/getUserDataverseEnvironmentByType",{},r.j.Shell);try{var u;yield n();var s,v=t().filter(i.A).filter(e=>Object(i.l)(e)||Object(i.L)(e));a.forEach(e=>{s||(s=v.find(n=>n.properties.environmentSku===e))});var l=null!==(u=s)&&void 0!==u?u:v[0];return c.complete({environmentFound:!!l}),l}catch(d){return void c.failure(d)}}))).apply(this,arguments)}},12329:function(e,n,t){},12330:function(e,n,t){"use strict";t.d(n,"a",(function(){return c})),t.d(n,"b",(function(){return u}));var r=t(10920),o=t(11853),i=t(11838),a=new RegExp("^/environments/([^/]+)/"),c=(e,n)=>{if(a.test(e)){var t=e.match(a);return t&&t[1]===(null==n?void 0:n.name)}return!1};function u(e){var n,t;if(Object(i.a)())return!1;if(null!=e&&null!==(n=e.properties)&&void 0!==n&&null!==(t=n.cluster)&&void 0!==t&&t.category){if("test"===Object(r.j)().region&&!Object(o.P)(e))return!0;if("preprod"===Object(r.j)().region&&!Object(o.O)(e))return!0}return!1}},12331:function(e,n,t){"use strict";t.d(n,"a",(function(){return p})),t.d(n,"b",(function(){return f})),t.d(n,"c",(function(){return h}));var r=t(11853),o=t(11842),i=t(11870),a=t(11021),c=t(10926),u=t(12286),s=t(12287),v=t(12291);function l(e,n,t,r,o,i,a){try{var c=e[i](a),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(r,o)}function d(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){l(i,r,o,a,c,"next",e)}function c(e){l(i,r,o,a,c,"throw",e)}a(void 0)}))}}var p=c.createContext({capacityMap:void 0,environmentsCapacityLoadingStatus:o.a.NotLoaded,environmentsCapacityLoadingError:void 0});class m extends c.Component{constructor(e){var n;super(e),n=this,this.timeoutId=void 0,this.createCapacityMap=e=>{var n=new Map;return e&&e.map(e=>{var t;return n.set(e.name,null===(t=e.properties)||void 0===t?void 0:t.capacity)}),n},this.refreshEnvironmentsList=d((function*(){try{yield n.retrieveAndSetEnvironmentCapacityList()}finally{n.setupPollingForEnvironmentCapacityList()}})),this.setupPollingForEnvironmentCapacityList=()=>{this.timeoutId=window.setTimeout(this.refreshEnvironmentsList,u.f)},this.retrieveAndSetEnvironmentCapacityList=d((function*(){try{var{httpClient:e,enabled:t}=n.props;if(!t)return;if(s.a.enableOakdaleEnforcementMessaging){var i,c=new URL(v.a.deprecateLegacyPARPForEssentialServices?u.n:u.m);c.searchParams.append("$filter","".concat(u.j," and ").concat(u.p));var l=null!==(i=(yield e.get(c.toString(),{page:!0,team:a.j.Shell})).data.value.filter(e=>!Object(r.N)(e)))&&void 0!==i?i:[],d=n.createCapacityMap(l);return l&&n.setState({capacityMap:d,environmentsCapacityLoadingStatus:o.a.Loaded,environmentsCapacityLoadingError:null}),l}}catch(p){Object(a.U)(u.r,{eventName:"getEnvironmentsListExpandCapacity",eventData:p}),n.setState({environmentsCapacityLoadingStatus:o.a.Error,environmentsCapacityLoadingError:p})}})),this.state={capacityMap:void 0,environmentsCapacityLoadingStatus:o.a.NotLoaded,environmentsCapacityLoadingError:void 0}}componentDidMount(){var e=this;return d((function*(){s.a.enableOakdaleEnforcementMessaging&&((yield e.retrieveAndSetEnvironmentCapacityList())&&e.setupPollingForEnvironmentCapacityList())}))()}componentWillUnmount(){s.a.enableOakdaleEnforcementMessaging&&clearTimeout(this.timeoutId)}render(){var{enabled:e}=this.props;if(!e)return c.createElement(c.Fragment,null,this.props.children);var{capacityMap:n,environmentsCapacityLoadingStatus:t,environmentsCapacityLoadingError:r}=this.state,o={capacityMap:n,environmentsCapacityLoadingStatus:t,environmentsCapacityLoadingError:r};return c.createElement(p.Provider,{value:o},c.createElement(c.Fragment,null,this.props.children))}}var f=Object(i.r)(m),h=Object(o.b)(p,"environmentsCapacityLoadingStatus")},12332:function(e,n,t){"use strict";t(12219),t(10926)},12333:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(12219),o=t(10926),i=t.n(o);function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}function c(e,n){var t=t=>{var o=Object(r.W)();return n&&!o.isSuccess?i.a.createElement(i.a.Fragment,null):i.a.createElement(e,a({},t,o))};return t.displayName="withCurrentEnvironment(".concat(e.displayName||e.name||"Component",")"),t}},12334:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(12219),o=t(10926),i=t.n(o);function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}function c(e){var n=n=>{var t=Object(r.bb)();return i.a.createElement(e,a({},n,t))};return n.displayName="withSwitchEnvironment(".concat(e.displayName||e.name||"Component",")"),n}},12335:function(e,n,t){"use strict";var r=t(12311);t.d(n,"a",(function(){return r.b}));t(12292);var o=t(12336);t.d(n,"b",(function(){return o.a}));var i=t(12338);t.d(n,"c",(function(){return i.a}));var a=t(12339);t.d(n,"d",(function(){return a.a}));var c=t(12294);t.d(n,"g",(function(){return c.a}));var u=t(12312);t.d(n,"f",(function(){return u.b}));var s=t(12340);t.d(n,"e",(function(){return s.a}))},12336:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var r=t(10926),o=t(12219),i=t(12337);function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function c(e,n,t){return(n=function(e){var n=function(e,n){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function u(){var{currentEnvironment:e,currentEnvironmentLoadingStatus:n,refreshCurrentEnvironment:t}=r.useContext(o.i),u=r.useMemo(()=>{switch(n){case o.p.Loaded:return"success";case o.p.Error:return"error";default:return"loading"}},[n]),s=r.useMemo(()=>Object(i.a)(u),[u]),v=r.useMemo(()=>!!e&&Object(o.v)(e),[e]);return function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){c(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({currentEnvironment:e,status:u,refetch:t,hasDataverse:v},s)}},12337:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var r=e=>({isLoading:"loading"===e,isSuccess:"success"===e,isError:"error"===e})},12338:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var r=t(10926),o=t(12219),i=t(12337);function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function c(e,n,t){return(n=function(e){var n=function(e,n){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function u(){var{currentEnvironment:e,currentEnvironmentLoadingStatus:n}=r.useContext(o.i),t=r.useMemo(()=>{switch(n){case o.p.Loaded:return"success";case o.p.Error:return"error";default:return"loading"}},[n]),u=r.useMemo(()=>Object(i.a)(t),[t]);return function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){c(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({currentEnvironmentName:null==e?void 0:e.name,status:t},u)}},12339:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var r=t(10926),o=t(12219),i=t(12337);function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function c(e,n,t){return(n=function(e){var n=function(e,n){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function u(){var{_environments:e,allEnvironmentsLoadingStatus:n,forceRefreshEnvironmentsList:t}=r.useContext(o.i),u=r.useMemo(()=>{switch(n){case o.p.Loaded:return"success";case o.p.Error:return"error";default:return"loading"}},[n]),s=r.useMemo(()=>Object(i.a)(u),[u]);return function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){c(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({environments:e,status:u,refetch:()=>t()},s)}},12340:function(e,n,t){"use strict";t.d(n,"a",(function(){return m}));var r=t(11868),o=t(11021),i=t(10926),a=t(12297),c=(t(12313),t(12220)),u=t(12286);function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function v(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n,t){return(n=function(e){var n=function(e,n){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function d(e,n,t,r,o,i,a){try{var c=e[i](a),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(r,o)}function p(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){d(i,r,o,a,c,"next",e)}function c(e){d(i,r,o,a,c,"throw",e)}a(void 0)}))}}function m(e){var{onGetEnvironmentByName:n}=Object(i.useContext)(c.a),t=Object(a.b)();return{getEnvironmentByName:Object(i.useCallback)(function(){var r=p((function*(r){return r?yield t.fetchQuery(v({queryFn:(o=p((function*(){return n?yield n({environmentName:r}):yield g(r)})),function(){return o.apply(this,arguments)}),queryKey:h({environmentName:r}),staleTime:f},e)):null;var o}));return function(e){return r.apply(this,arguments)}}(),[n,t,e])}}var f=18e4,h=e=>{var{environmentName:n}=e;return["power-platform-environment","getBapEnvironmentByName",n]},g=function(){var e=p((function*(e){var n=Object(o.X)(u.r,"getBapEnvironmentByName",void 0,o.j.Shell);try{var t=yield r.f.get(b(e));return n.complete({environmentName:e,found:!(null==t||!t.data)}),(null==t?void 0:t.data)||null}catch(i){throw n.failure(i),i}}));return function(n){return e.apply(this,arguments)}}(),b=e=>"".concat(u.b,"/").concat(e,"?api-version=").concat(u.a,"&$expand=properties.permissions")},12341:function(e,n,t){"use strict";t(12342),t(12343),t(12344),t(12345),t(12346),t(12347),t(12348)},12342:function(e,n,t){},12343:function(e,n,t){},12344:function(e,n,t){},12345:function(e,n,t){},12346:function(e,n,t){},12347:function(e,n,t){},12348:function(e,n,t){}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/13.144a2023.chunk.js.map
/*! For license information please see Core.Services.js.LICENSE.txt */
(function(){return this?this:window}())["@pa-client/core-services"]=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=347)}([function(e,t){!function(){e.exports=function(){return this?this:window}()["@pa-client/core"]}()},function(e,t,n){"use strict";var r,o,i,a,s,c,u,p,l,d,f,y,m,g,v,b,h,A,C,P,w,S,O,R,_,T,I,E,U,j,N,D,V,M,k,L,F,x,H,B,q,G,J,W,z,K,X,Q,$,Z,Y,ee,te,ne,re,oe,ie,ae,se,ce,ue,pe,le,de,fe,ye,me,ge,ve,be,he,Ae,Ce,Pe,we,Se,Oe,Re,_e,Te,Ie,Ee,Ue,je,Ne,De,Ve,Me,ke,Le,Fe,xe,He,Be,qe,Ge,Je,We,ze,Ke,Xe,Qe,$e,Ze,Ye,et,tt,nt,rt,ot,it,at,st,ct,ut,pt,lt,dt,ft,yt,mt,gt,vt,bt,ht,At,Ct,Pt,wt,St,Ot,Rt,_t,Tt,It,Et,Ut,jt,Nt,Dt,Vt,Mt,kt,Lt,Ft,xt,Ht,Bt,qt,Gt,Jt,Wt,zt,Kt,Xt,Qt,$t,Zt,Yt,en,tn,nn,rn,on,an,sn,cn,un,pn,ln,dn,fn,yn,mn,gn,vn,bn,hn,An,Cn,Pn,wn,Sn,On,Rn,_n,Tn,In,En,Un,jn,Nn,Dn,Vn,Mn,kn,Ln,Fn,xn,Hn,Bn,qn,Gn,Jn,Wn,zn,Kn,Xn,Qn,$n,Zn,Yn,er,tr,nr,rr,or,ir,ar,sr,cr,ur;n.d(t,"o",(function(){return r})),n.d(t,"Jg",(function(){return o})),n.d(t,"nb",(function(){return i})),n.d(t,"ib",(function(){return a})),n.d(t,"Ob",(function(){return s})),n.d(t,"ng",(function(){return c})),n.d(t,"cg",(function(){return u})),n.d(t,"zg",(function(){return p})),n.d(t,"Pf",(function(){return l})),n.d(t,"ab",(function(){return d})),n.d(t,"Ig",(function(){return f})),n.d(t,"N",(function(){return y})),n.d(t,"t",(function(){return m})),n.d(t,"r",(function(){return g})),n.d(t,"fg",(function(){return v})),n.d(t,"F",(function(){return b})),n.d(t,"D",(function(){return h})),n.d(t,"lb",(function(){return A})),n.d(t,"m",(function(){return C})),n.d(t,"Ng",(function(){return P})),n.d(t,"Hg",(function(){return w})),n.d(t,"Fg",(function(){return S})),n.d(t,"Gg",(function(){return O})),n.d(t,"p",(function(){return R})),n.d(t,"v",(function(){return _})),n.d(t,"vb",(function(){return T})),n.d(t,"Mg",(function(){return I})),n.d(t,"wb",(function(){return E})),n.d(t,"u",(function(){return U})),n.d(t,"w",(function(){return j})),n.d(t,"rh",(function(){return N})),n.d(t,"s",(function(){return D})),n.d(t,"rb",(function(){return V})),n.d(t,"n",(function(){return M})),n.d(t,"sb",(function(){return k})),n.d(t,"E",(function(){return L})),n.d(t,"G",(function(){return F})),n.d(t,"I",(function(){return x})),n.d(t,"rg",(function(){return H})),n.d(t,"K",(function(){return B})),n.d(t,"J",(function(){return q})),n.d(t,"U",(function(){return G})),n.d(t,"Q",(function(){return J})),n.d(t,"Z",(function(){return W})),n.d(t,"Mh",(function(){return z})),n.d(t,"S",(function(){return K})),n.d(t,"bb",(function(){return X})),n.d(t,"R",(function(){return Q})),n.d(t,"k",(function(){return $})),n.d(t,"xg",(function(){return Z})),n.d(t,"wg",(function(){return Y})),n.d(t,"d",(function(){return ee})),n.d(t,"b",(function(){return te})),n.d(t,"i",(function(){return ne})),n.d(t,"l",(function(){return re})),n.d(t,"h",(function(){return oe})),n.d(t,"f",(function(){return ie})),n.d(t,"g",(function(){return ae})),n.d(t,"Wg",(function(){return se})),n.d(t,"Ug",(function(){return ce})),n.d(t,"ub",(function(){return ue})),n.d(t,"tb",(function(){return pe})),n.d(t,"Vg",(function(){return le})),n.d(t,"mb",(function(){return de})),n.d(t,"bc",(function(){return fe})),n.d(t,"ug",(function(){return ye})),n.d(t,"tg",(function(){return me})),n.d(t,"sg",(function(){return ge})),n.d(t,"vg",(function(){return ve})),n.d(t,"cc",(function(){return be})),n.d(t,"Pb",(function(){return he})),n.d(t,"th",(function(){return Ae})),n.d(t,"sh",(function(){return Ce})),n.d(t,"pg",(function(){return Pe})),n.d(t,"W",(function(){return we})),n.d(t,"Kg",(function(){return Se})),n.d(t,"V",(function(){return Oe})),n.d(t,"c",(function(){return Re})),n.d(t,"P",(function(){return _e})),n.d(t,"ag",(function(){return Te})),n.d(t,"bg",(function(){return Ie})),n.d(t,"T",(function(){return Ee})),n.d(t,"Qb",(function(){return Ue})),n.d(t,"Zf",(function(){return je})),n.d(t,"O",(function(){return Ne})),n.d(t,"mh",(function(){return De})),n.d(t,"eg",(function(){return Ve})),n.d(t,"Zb",(function(){return Me})),n.d(t,"Vf",(function(){return ke})),n.d(t,"ec",(function(){return Le})),n.d(t,"Yb",(function(){return Fe})),n.d(t,"ac",(function(){return xe})),n.d(t,"Bg",(function(){return He})),n.d(t,"Dg",(function(){return Be})),n.d(t,"Cg",(function(){return qe})),n.d(t,"Eg",(function(){return Ge})),n.d(t,"Pg",(function(){return Je})),n.d(t,"db",(function(){return We})),n.d(t,"eb",(function(){return ze})),n.d(t,"cb",(function(){return Ke})),n.d(t,"j",(function(){return Xe})),n.d(t,"kb",(function(){return Qe})),n.d(t,"jb",(function(){return $e})),n.d(t,"Jh",(function(){return Ze})),n.d(t,"Kh",(function(){return Ye})),n.d(t,"Hh",(function(){return et})),n.d(t,"x",(function(){return tt})),n.d(t,"Mb",(function(){return nt})),n.d(t,"Nb",(function(){return rt})),n.d(t,"Lb",(function(){return ot})),n.d(t,"Ih",(function(){return it})),n.d(t,"yh",(function(){return at})),n.d(t,"qg",(function(){return st})),n.d(t,"xh",(function(){return ct})),n.d(t,"Tb",(function(){return ut})),n.d(t,"Ub",(function(){return pt})),n.d(t,"Vb",(function(){return lt})),n.d(t,"Wb",(function(){return dt})),n.d(t,"Xb",(function(){return ft})),n.d(t,"Rb",(function(){return yt})),n.d(t,"Rg",(function(){return mt})),n.d(t,"Qg",(function(){return gt})),n.d(t,"dc",(function(){return vt})),n.d(t,"Sb",(function(){return bt})),n.d(t,"y",(function(){return ht})),n.d(t,"Yg",(function(){return At})),n.d(t,"hb",(function(){return Ct})),n.d(t,"Og",(function(){return Pt})),n.d(t,"Kf",(function(){return wt})),n.d(t,"e",(function(){return St})),n.d(t,"If",(function(){return Ot})),n.d(t,"Jf",(function(){return Rt})),n.d(t,"Lf",(function(){return _t})),n.d(t,"Mf",(function(){return Tt})),n.d(t,"Nf",(function(){return It})),n.d(t,"Of",(function(){return Et})),n.d(t,"Rf",(function(){return Ut})),n.d(t,"Tf",(function(){return jt})),n.d(t,"mg",(function(){return Nt})),n.d(t,"Uf",(function(){return Dt})),n.d(t,"Wf",(function(){return Vt})),n.d(t,"Xf",(function(){return Mt})),n.d(t,"Yf",(function(){return kt})),n.d(t,"Lg",(function(){return Lt})),n.d(t,"Eb",(function(){return Ft})),n.d(t,"fb",(function(){return xt})),n.d(t,"gb",(function(){return Ht})),n.d(t,"lh",(function(){return Bt})),n.d(t,"kh",(function(){return qt})),n.d(t,"dg",(function(){return Gt})),n.d(t,"lg",(function(){return Jt})),n.d(t,"kg",(function(){return Wt})),n.d(t,"Gf",(function(){return zt})),n.d(t,"wh",(function(){return Kt})),n.d(t,"xb",(function(){return Xt})),n.d(t,"Db",(function(){return Qt})),n.d(t,"gg",(function(){return $t})),n.d(t,"hg",(function(){return Zt})),n.d(t,"ig",(function(){return Yt})),n.d(t,"jg",(function(){return en})),n.d(t,"Cb",(function(){return tn})),n.d(t,"Bb",(function(){return nn})),n.d(t,"yb",(function(){return rn})),n.d(t,"Ab",(function(){return on})),n.d(t,"zb",(function(){return an})),n.d(t,"uh",(function(){return sn})),n.d(t,"vh",(function(){return cn})),n.d(t,"H",(function(){return un})),n.d(t,"og",(function(){return pn})),n.d(t,"qh",(function(){return ln})),n.d(t,"yg",(function(){return dn})),n.d(t,"X",(function(){return fn})),n.d(t,"Y",(function(){return yn})),n.d(t,"zh",(function(){return mn})),n.d(t,"a",(function(){return gn})),n.d(t,"L",(function(){return vn})),n.d(t,"fc",(function(){return bn})),n.d(t,"B",(function(){return hn})),n.d(t,"C",(function(){return An})),n.d(t,"q",(function(){return Cn})),n.d(t,"hc",(function(){return Pn})),n.d(t,"z",(function(){return wn})),n.d(t,"A",(function(){return Sn})),n.d(t,"Kb",(function(){return On})),n.d(t,"Ib",(function(){return Rn})),n.d(t,"Hb",(function(){return _n})),n.d(t,"Sf",(function(){return Tn})),n.d(t,"Gb",(function(){return In})),n.d(t,"gc",(function(){return En})),n.d(t,"Xg",(function(){return Un})),n.d(t,"Fb",(function(){return jn})),n.d(t,"Ag",(function(){return Nn})),n.d(t,"M",(function(){return Dn})),n.d(t,"Jb",(function(){return Vn})),n.d(t,"Qf",(function(){return Mn})),n.d(t,"Sg",(function(){return kn})),n.d(t,"Tg",(function(){return Ln})),n.d(t,"Zg",(function(){return Fn})),n.d(t,"ah",(function(){return xn})),n.d(t,"gh",(function(){return Hn})),n.d(t,"fh",(function(){return Bn})),n.d(t,"eh",(function(){return qn})),n.d(t,"dh",(function(){return Gn})),n.d(t,"ch",(function(){return Jn})),n.d(t,"bh",(function(){return Wn})),n.d(t,"ih",(function(){return zn})),n.d(t,"hh",(function(){return Kn})),n.d(t,"jh",(function(){return Xn})),n.d(t,"ob",(function(){return Qn})),n.d(t,"qb",(function(){return $n})),n.d(t,"pb",(function(){return Zn})),n.d(t,"oh",(function(){return Yn})),n.d(t,"ph",(function(){return er})),n.d(t,"nh",(function(){return tr})),n.d(t,"Dh",(function(){return nr})),n.d(t,"Ah",(function(){return rr})),n.d(t,"Fh",(function(){return or})),n.d(t,"Eh",(function(){return ir})),n.d(t,"Bh",(function(){return ar})),n.d(t,"Ch",(function(){return sr})),n.d(t,"Gh",(function(){return cr})),n.d(t,"Lh",(function(){return ur})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.appName&&"string"==typeof e.environmentName&&"string"==typeof e.tenantId&&"string"==typeof e.appVersion&&(null===e.aiAppDescription||void 0===e.aiAppDescription||"string"==typeof e.aiAppDescription);return!n&&t&&Core.Log.warning("IAppExtendedMetadata.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(r||(r={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.id&&e.id.length>=1&&(null===e.displayName||void 0===e.displayName||"string"==typeof e.displayName)&&(null===e.iconUri||void 0===e.iconUri||Core.Utility.isAbsoluteUrlString(e.iconUri))&&(null===e.dataSources||void 0===e.dataSources||Core.Utility.isArray(e.dataSources)&&e.dataSources.every((function(e){return"string"==typeof e&&e.length>=1})))&&(null===e.dataSets||void 0===e.dataSets||Core.Utility.isJsonHashTable(e.dataSets)&&HashTableUtility.every(e.dataSets,(function(e){return i.isValid(e)})))&&(null===e.dataSourceAppMappings||void 0===e.dataSourceAppMappings||Core.Utility.isJsonHashTable(e.dataSourceAppMappings)&&HashTableUtility.every(e.dataSourceAppMappings,(function(e){return null==e||Core.Utility.isArray(e)&&e.every((function(e){return null==e||"string"==typeof e}))})))&&(null===e.dependencies||void 0===e.dependencies||Core.Utility.isArray(e.dependencies)&&e.dependencies.every((function(e){return"string"==typeof e&&e.length>=1})))&&(null===e.dependents||void 0===e.dependents||Core.Utility.isArray(e.dependents)&&e.dependents.every((function(e){return"string"==typeof e&&e.length>=1})))&&(null===e.sharedConnectionId||void 0===e.sharedConnectionId||"string"==typeof e.sharedConnectionId)&&(null===e.xrmConnectionReferenceLogicalName||void 0===e.xrmConnectionReferenceLogicalName||"string"==typeof e.xrmConnectionReferenceLogicalName)&&(null===e.gatewayObjectIdHint||void 0===e.gatewayObjectIdHint||"string"==typeof e.gatewayObjectIdHint)&&(null===e.isOnPremiseConnection||void 0===e.isOnPremiseConnection||"boolean"==typeof e.isOnPremiseConnection)&&(null===e.isCustomApiConnection||void 0===e.isCustomApiConnection||"boolean"==typeof e.isCustomApiConnection)&&(null===e.resourceIdentifier||void 0===e.resourceIdentifier||"string"==typeof e.resourceIdentifier)&&(null===e.bypassConsent||void 0===e.bypassConsent||"boolean"==typeof e.bypassConsent)&&(null===e.parameterHints||void 0===e.parameterHints||Core.Utility.isJsonHashTable(e.parameterHints)&&HashTableUtility.every(e.parameterHints,(function(e){return c.isValid(e)})))&&(null===e.parameterHintsV2||void 0===e.parameterHintsV2||Core.Utility.isJsonHashTable(e.parameterHintsV2)&&HashTableUtility.every(e.parameterHintsV2,(function(e){return c.isValid(e)})))&&(null===e.runtimePolicyName||void 0===e.runtimePolicyName||"string"==typeof e.runtimePolicyName)&&(null===e.apiTier||void 0===e.apiTier||"string"==typeof e.apiTier)&&(null===e.authenticationType||void 0===e.authenticationType||"string"==typeof e.authenticationType)&&(null===e.nestedActions||void 0===e.nestedActions||Core.Utility.isArray(e.nestedActions)&&e.nestedActions.every((function(e){return u.isValid(e)})))&&(null===e.actions||void 0===e.actions||Core.Utility.isArray(e.actions)&&e.actions.every((function(e){return"string"==typeof e})));return!n&&t&&Core.Log.warning("IServerConnectionReference.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(o||(o={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.dataSources||void 0===e.dataSources||Core.Utility.isJsonHashTable(e.dataSources)&&HashTableUtility.every(e.dataSources,(function(e){return a.isValid(e)})))&&(null===e.datasetOverride||void 0===e.datasetOverride||null!==e.datasetOverride&&"object"==typeof e.datasetOverride&&Object.getPrototypeOf(e.datasetOverride)===Object.prototype&&(null===e.datasetOverride.description||void 0===e.datasetOverride.description||"string"==typeof e.datasetOverride.description)&&(null===e.datasetOverride.name||void 0===e.datasetOverride.name||"string"==typeof e.datasetOverride.name)&&(null===e.datasetOverride.environmentVariableName||void 0===e.datasetOverride.environmentVariableName||"string"==typeof e.datasetOverride.environmentVariableName));return!n&&t&&Core.Log.warning("IDatasetReference.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(i||(i={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.apps||void 0===e.apps||Core.Utility.isArray(e.apps)&&e.apps.every((function(e){return null==e||"string"==typeof e})))&&(null===e.tableName||void 0===e.tableName||"string"==typeof e.tableName)&&(null===e.tableNameOverride||void 0===e.tableNameOverride||null!==e.tableNameOverride&&"object"==typeof e.tableNameOverride&&Object.getPrototypeOf(e.tableNameOverride)===Object.prototype&&(null===e.tableNameOverride.name||void 0===e.tableNameOverride.name||"string"==typeof e.tableNameOverride.name)&&(null===e.tableNameOverride.environmentVariableName||void 0===e.tableNameOverride.environmentVariableName||"string"==typeof e.tableNameOverride.environmentVariableName));return!n&&t&&Core.Log.warning("IDataSourceReference.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(a||(a={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.apiId&&(null===e.apiVer||void 0===e.apiVer||"number"==typeof e.apiVer)&&"string"==typeof e.appVer&&"string"==typeof e.modifiedOn&&"string"==typeof e.policy&&"number"==typeof e.version;return!n&&t&&Core.Log.warning("IExecutionRestrictionsPolicy.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(s||(s={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||null!==e.requiredApiId&&void 0!==e.requiredApiId&&"string"!=typeof e.requiredApiId||null===e.value&&void 0===e.value);return!n&&t&&Core.Log.warning("IParameterHint.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(c||(c={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.actionName||void 0===e.actionName||"string"==typeof e.actionName)&&(null===e.apiName||void 0===e.apiName||"string"==typeof e.apiName)&&(null===e.id||void 0===e.id||"string"==typeof e.id)&&(null===e.referencedResources||void 0===e.referencedResources||Core.Utility.isArray(e.referencedResources)&&e.referencedResources.every((function(e){return p.isValid(e)})));return!n&&t&&Core.Log.warning("INestedAction.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(u||(u={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||null!==e.key&&void 0!==e.key&&"string"!=typeof e.key||null!==e.value&&void 0!==e.value&&"string"!=typeof e.value);return!n&&t&&Core.Log.warning("IResourceReference.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(p||(p={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.tenantId;return!n&&t&&Core.Log.warning("ILastPublishedBy.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(l||(l={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.description||void 0===e.description||"string"==typeof e.description)&&(null===e.aiGeneratedDescription||void 0===e.aiGeneratedDescription||"string"==typeof e.aiGeneratedDescription)&&"string"==typeof e.displayName&&(null===e.owner||void 0===e.owner||R.isValid(e.owner))&&(null===e.connectionReferences||void 0===e.connectionReferences||Core.Utility.isJsonHashTable(e.connectionReferences)&&HashTableUtility.every(e.connectionReferences,(function(e){return o.isValid(e)})))&&(null===e.databaseReferences||void 0===e.databaseReferences||Core.Utility.isJsonHashTable(e.databaseReferences)&&HashTableUtility.every(e.databaseReferences,(function(e){return null==e||h.isValid(e)})));return!n&&t&&Core.Log.warning("ICoreAppComponentInfoProperties.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(d||(d={})),function(e){function t(e,t){var n=d.isValid(e)&&"string"==typeof e.appComponentName&&"string"==typeof e.appName&&"string"==typeof e.appVersion&&(null===e.appComponentLibraryLogicalName||void 0===e.appComponentLibraryLogicalName||"string"==typeof e.appComponentLibraryLogicalName)&&"string"==typeof e.appDisplayName&&"string"==typeof e.environmentName&&(null===e.thumbnailUri||void 0===e.thumbnailUri||"string"==typeof e.thumbnailUri)&&(null===e.iconUri||void 0===e.iconUri||"string"==typeof e.iconUri)&&(null===e.allowCustomization||void 0===e.allowCustomization||"boolean"==typeof e.allowCustomization)&&"string"==typeof e.createdOn&&"string"==typeof e.lastModifiedOn&&(null===e.tags||void 0===e.tags||Core.Utility.isJsonHashTable(e.tags)&&HashTableUtility.every(e.tags,(function(e){return null==e||"string"==typeof e})))&&(null===e.componentType||void 0===e.componentType||"string"==typeof e.componentType);return!n&&t&&Core.Log.warning("IServerComponentInfo.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(f||(f={})),function(e){function t(e,t){var n=d.isValid(e)&&(null===e.commitMessage||void 0===e.commitMessage||"string"==typeof e.commitMessage)&&(null===e.createdTime||void 0===e.createdTime||"string"==typeof e.createdTime)&&(null===e.publisher||void 0===e.publisher||"string"==typeof e.publisher)&&(null===e.sharedGroupsCount||void 0===e.sharedGroupsCount||"number"==typeof e.sharedGroupsCount)&&(null===e.sharedUsersCount||void 0===e.sharedUsersCount||"number"==typeof e.sharedUsersCount)&&(null===e.createdBy||void 0===e.createdBy||R.isValid(e.createdBy))&&(null===e.userAppMetadata||void 0===e.userAppMetadata||N.isValid(e.userAppMetadata))&&(null===e.backgroundImageUri||void 0===e.backgroundImageUri||Core.Utility.isAbsoluteUrlString(e.backgroundImageUri))&&(null===e.bypassConsent||void 0===e.bypassConsent||"boolean"==typeof e.bypassConsent)&&(null===e.appUris||void 0===e.appUris||j.isValid(e.appUris))&&(null===e.lastModifiedBy||void 0===e.lastModifiedBy||R.isValid(e.lastModifiedBy))&&(null===e.lastModifiedTime||void 0===e.lastModifiedTime||"string"==typeof e.lastModifiedTime)&&(null===e.lastPublishTime||void 0===e.lastPublishTime||"string"==typeof e.lastPublishTime)&&(null===e.lastDraftVersion||void 0===e.lastDraftVersion||"string"==typeof e.lastDraftVersion)&&(null===e.lifeCycleId||void 0===e.lifeCycleId||"string"==typeof e.lifeCycleId)&&(null===e.authorizationReferences||void 0===e.authorizationReferences||Core.Utility.isArray(e.authorizationReferences)&&e.authorizationReferences.every((function(e){return null==e||O.isValid(e)})))&&(null===e.environment||void 0===e.environment||Vn.isValid(e.environment))&&(null===e.cdsMigrationDetails||void 0===e.cdsMigrationDetails||b.isValid(e.cdsMigrationDetails))&&(null===e.isFeaturedApp||void 0===e.isFeaturedApp||"boolean"==typeof e.isFeaturedApp)&&(null===e.isHeroApp||void 0===e.isHeroApp||"boolean"==typeof e.isHeroApp)&&(null===e.unpublishedAppDefinition||void 0===e.unpublishedAppDefinition||S.isValid(e.unpublishedAppDefinition))&&(null===e.embeddedApp||void 0===e.embeddedApp||E.isValid(e.embeddedApp))&&(null===e.userAppResourceConsent||void 0===e.userAppResourceConsent||Core.Utility.isArray(e.userAppResourceConsent)&&e.userAppResourceConsent.every((function(e){return null==e||P.isValid(e)})))&&(null===e.appPackageDetails||void 0===e.appPackageDetails||D.isValid(e.appPackageDetails))&&(null===e.almMode||void 0===e.almMode||"string"==typeof e.almMode)&&(null===e.lastPublishedBy||void 0===e.lastPublishedBy||l.isValid(e.lastPublishedBy))&&(null===e.appVersion||void 0===e.appVersion||"string"==typeof e.appVersion)&&(null===e.sourceControl||void 0===e.sourceControl||U.isValid(e.sourceControl))&&(null===e.enableModernRuntimeMode||void 0===e.enableModernRuntimeMode||"boolean"==typeof e.enableModernRuntimeMode)&&(null===e.canvasAppAdornerStatus||void 0===e.canvasAppAdornerStatus||"string"==typeof e.canvasAppAdornerStatus)&&(null===e.canvasAppSidecarStatus||void 0===e.canvasAppSidecarStatus||"string"==typeof e.canvasAppSidecarStatus)&&(null===e.aiGeneratedDescription||void 0===e.aiGeneratedDescription||"string"==typeof e.aiGeneratedDescription);return!n&&t&&Core.Log.warning("ICommonAppProperties.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(y||(y={})),function(e){function t(e,t){var n=y.isValid(e)&&"string"==typeof e.backgroundColor&&(null===e.appOverrides||void 0===e.appOverrides||g.isValid(e.appOverrides))&&(null===e.unauthenticatedWebPackageHint||void 0===e.unauthenticatedWebPackageHint||"string"==typeof e.unauthenticatedWebPackageHint)&&(null===e.offlineProfileDetails||void 0===e.offlineProfileDetails||v.isValid(e.offlineProfileDetails));return!n&&t&&Core.Log.warning("IAppProperties.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(m||(m={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"boolean"==typeof e.bypassUserPlansValidation;return!n&&t&&Core.Log.warning("IAppOverrides.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(g||(g={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||"string"!=typeof e.offlineProfileId||"boolean"!=typeof e.isAutoGenerated||null!==e.state&&void 0!==e.state&&"string"!=typeof e.state||null!==e.publishErrorCode&&void 0!==e.publishErrorCode&&"string"!=typeof e.publishErrorCode);return!n&&t&&Core.Log.warning("IOfflineProfileDetails.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(v||(v={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.upgradeStatus&&(null===e.environmentMigratedBy||void 0===e.environmentMigratedBy||null!==e.environmentMigratedBy&&"object"==typeof e.environmentMigratedBy&&Object.getPrototypeOf(e.environmentMigratedBy)===Object.prototype&&"string"==typeof e.environmentMigratedBy.id&&"string"==typeof e.environmentMigratedBy.displayName&&(null===e.environmentMigratedBy.email||void 0===e.environmentMigratedBy.email||"string"==typeof e.environmentMigratedBy.email));return!n&&t&&Core.Log.warning("ICdsMigrationDetails.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(b||(b={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&null!==e.databaseDetails&&"object"==typeof e.databaseDetails&&Object.getPrototypeOf(e.databaseDetails)===Object.prototype&&"string"==typeof e.databaseDetails.environmentName&&(null===e.databaseDetails.overrideValues||void 0===e.databaseDetails.overrideValues||null!==e.databaseDetails.overrideValues&&"object"==typeof e.databaseDetails.overrideValues&&Object.getPrototypeOf(e.databaseDetails.overrideValues)===Object.prototype&&(null===e.databaseDetails.overrideValues.environmentName||void 0===e.databaseDetails.overrideValues.environmentName||"string"==typeof e.databaseDetails.overrideValues.environmentName)&&(null===e.databaseDetails.overrideValues.environmentVariableName||void 0===e.databaseDetails.overrideValues.environmentVariableName||"string"==typeof e.databaseDetails.overrideValues.environmentVariableName))&&(null===e.databaseDetails.linkedEnvironmentMetadata||void 0===e.databaseDetails.linkedEnvironmentMetadata||Tn.isValid(e.databaseDetails.linkedEnvironmentMetadata))&&(null===e.dataSources||void 0===e.dataSources||Core.Utility.isJsonHashTable(e.dataSources)&&HashTableUtility.every(e.dataSources,(function(e){return null==e||A.isValid(e)})))&&(null===e.components||void 0===e.components||Core.Utility.isArray(e.components)&&e.components.every((function(e){return null==e||C.isValid(e)})))&&(null===e.actions||void 0===e.actions||Core.Utility.isArray(e.actions)&&e.actions.every((function(e){return null==e||"string"==typeof e&&e.length>=1})));return!n&&t&&Core.Log.warning("ICdsDatabaseReference.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(h||(h={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.entitySetName&&"string"==typeof e.logicalName&&(null===e.overrideValues||void 0===e.overrideValues||null!==e.overrideValues&&"object"==typeof e.overrideValues&&Object.getPrototypeOf(e.overrideValues)===Object.prototype&&(null===e.overrideValues.entitySetName||void 0===e.overrideValues.entitySetName||"string"==typeof e.overrideValues.entitySetName)&&(null===e.overrideValues.logicalName||void 0===e.overrideValues.logicalName||"string"==typeof e.overrideValues.logicalName))&&(null===e.apps||void 0===e.apps||Core.Utility.isArray(e.apps)&&e.apps.every((function(e){return null==e||"string"==typeof e&&e.length>=1})));return!n&&t&&Core.Log.warning("IDatabaseDataSource.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(A||(A={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.componentName&&"string"==typeof e.identifier&&"string"==typeof e.identifierType&&(null===e.capabilities||void 0===e.capabilities||null!==e.capabilities&&"object"==typeof e.capabilities&&Object.getPrototypeOf(e.capabilities)===Object.prototype&&(null===e.capabilities.pcfExternalServiceUsageAllowed||void 0===e.capabilities.pcfExternalServiceUsageAllowed||"boolean"==typeof e.capabilities.pcfExternalServiceUsageAllowed));return!n&&t&&Core.Log.warning("IAppCdsComponent.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(C||(C={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.name&&"string"==typeof e.type;return!n&&t&&Core.Log.warning("IServerUserConsent.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(P||(P={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.id&&"string"==typeof e.name&&"string"==typeof e.type&&(null===e.tags||void 0===e.tags||Core.Utility.isJsonHashTable(e.tags)&&HashTableUtility.every(e.tags,(function(e){return null==e||"string"==typeof e})))&&(null===e.appType||void 0===e.appType||"string"==typeof e.appType)&&(null===e.metadataVersion||void 0===e.metadataVersion||"number"==typeof e.metadataVersion);return!n&&t&&Core.Log.warning("IServerCommonAppInfo.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(w||(w={})),function(e){function t(e,t){var n=w.isValid(e)&&m.isValid(e.properties)&&(null===e.logicalName||void 0===e.logicalName||"string"==typeof e.logicalName)&&(null===e.appModuleSettings||void 0===e.appModuleSettings||Core.Utility.isArray(e.appModuleSettings)&&e.appModuleSettings.every((function(e){return null==e||Cn.isValid(e)})));return!n&&t&&Core.Log.warning("IServerAppInfo.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(S||(S={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.resourceId;return!n&&t&&Core.Log.warning("IServerAuthReference.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(O||(O={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||"string"!=typeof e.id||null!==e.displayName&&void 0!==e.displayName&&"string"!=typeof e.displayName||"string"!=typeof e.type||null!==e.email&&void 0!==e.email&&"string"!=typeof e.email);return!n&&t&&Core.Log.warning("IAppInfoAuthor.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(R||(R={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Core.Utility.isAbsoluteUrlString(e.value)&&(null===e.readonlyValue||void 0===e.readonlyValue||Core.Utility.isAbsoluteUrlString(e.readonlyValue));return!n&&t&&Core.Log.warning("IAppUri.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(_||(_={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||"string"!=typeof e.type||null!==e.screenWidth&&void 0!==e.screenWidth&&"number"!=typeof e.screenWidth||null!==e.screenHeight&&void 0!==e.screenHeight&&"number"!=typeof e.screenHeight);return!n&&t&&Core.Log.warning("IEmbeddedApp.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(T||(T={})),function(e){function t(e,t){var n=T.isValid(e)&&"string"==typeof e.siteId&&"string"==typeof e.listId&&"string"==typeof e.listUrl;return!n&&t&&Core.Log.warning("IServerSharepointEmbeddedApp.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(I||(I={})),function(e){function t(e,t){var n=Core.Utility.isJsonHashTable(e)&&HashTableUtility.every(e,(function(e){return null!==e}));return!n&&t&&Core.Log.warning("IEmbeddedAppPropertySet.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(E||(E={})),function(e){function t(e,t){var n=Core.Utility.isJsonHashTable(e)&&HashTableUtility.every(e,(function(e){return null!==e}));return!n&&t&&Core.Log.warning("IAppSourceControlPropertySet.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(U||(U={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.documentUri||void 0===e.documentUri||_.isValid(e.documentUri))&&(null===e.debugPlayerPackageUri||void 0===e.debugPlayerPackageUri||_.isValid(e.debugPlayerPackageUri))&&(null===e.debugWebPackageUri||void 0===e.debugWebPackageUri||_.isValid(e.debugWebPackageUri))&&(null===e.globalAppDocumentUri||void 0===e.globalAppDocumentUri||_.isValid(e.globalAppDocumentUri))&&(null===e.imageUris||void 0===e.imageUris||Core.Utility.isArray(e.imageUris)&&e.imageUris.every((function(e){return null==e||_.isValid(e)})));return!n&&t&&Core.Log.warning("IAppUris.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(j||(j={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||null!==e.favorite&&void 0!==e.favorite&&"string"!=typeof e.favorite||null!==e.lastOpenedTime&&void 0!==e.lastOpenedTime&&"string"!=typeof e.lastOpenedTime||null!==e.includeInAppsList&&void 0!==e.includeInAppsList&&"boolean"!=typeof e.includeInAppsList);return!n&&t&&Core.Log.warning("IUserAppMetadata.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(N||(N={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.appPackageResourcesKind||void 0===e.appPackageResourcesKind||"string"==typeof e.appPackageResourcesKind)&&(null===e.playerPackage||void 0===e.playerPackage||_.isValid(e.playerPackage))&&(null===e.unauthenticatedWebPackage||void 0===e.unauthenticatedWebPackage||_.isValid(e.unauthenticatedWebPackage))&&(null===e.unauthenticatedModernRuntimePackage||void 0===e.unauthenticatedModernRuntimePackage||_.isValid(e.unauthenticatedModernRuntimePackage))&&(null===e.webPackage||void 0===e.webPackage||_.isValid(e.webPackage))&&(null===e.documentServerVersion||void 0===e.documentServerVersion||V.isValid(e.documentServerVersion))&&(null===e.packagePropertiesJson||void 0===e.packagePropertiesJson||"string"==typeof e.packagePropertiesJson)&&(null===e.logicalName||void 0===e.logicalName||"string"==typeof e.logicalName)&&(null===e.id||void 0===e.id||"string"==typeof e.id);return!n&&t&&Core.Log.warning("IAppPackage.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(D||(D={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||"number"!=typeof e.major||"number"!=typeof e.minor||null!==e.build&&void 0!==e.build&&"number"!=typeof e.build||null!==e.revision&&void 0!==e.revision&&"number"!=typeof e.revision);return!n&&t&&Core.Log.warning("IDocumentServerVersion.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(V||(V={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||null!==e.major&&void 0!==e.major&&"number"!=typeof e.major||null!==e.minor&&void 0!==e.minor&&"number"!=typeof e.minor||null!==e.build&&void 0!==e.build&&"number"!=typeof e.build||null!==e.revision&&void 0!==e.revision&&"number"!=typeof e.revision||null!==e.majorRevision&&void 0!==e.majorRevision&&"number"!=typeof e.majorRevision||null!==e.minorRevision&&void 0!==e.minorRevision&&"number"!=typeof e.minorRevision);return!n&&t&&Core.Log.warning("IAppClientVersion.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(M||(M={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.webPackageUrl;return!n&&t&&Core.Log.warning("IDraftResources.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(k||(k={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.Result||void 0===e.Result||null!==e.Result&&"object"==typeof e.Result&&Object.getPrototypeOf(e.Result)===Object.prototype&&"string"==typeof e.Result.FileName&&"number"==typeof e.Result.FileSizeInBytes&&"string"==typeof e.Result.MimeType&&"string"==typeof e.Result.SasUrl);return!n&&t&&Core.Log.warning("ICdsFileSasUrlResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(L||(L={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Core.Utility.isArray(e.value)&&e.value.every((function(e){return null==e||null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.name&&e.name.length>=1&&"string"==typeof e.schemaname&&e.schemaname.length>=1&&(null===e.publishedon||void 0===e.publishedon||"string"==typeof e.publishedon&&e.publishedon.length>=1)&&(null===e.botid||void 0===e.botid||"string"==typeof e.botid&&e.botid.length>=1)}));return!n&&t&&Core.Log.warning("ICdsPVABotsResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(F||(F={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Core.Utility.isArray(e.userPrivileges)&&e.userPrivileges.every((function(e){return null==e||H.isValid(e)}));return!n&&t&&Core.Log.warning("ICheckPrivileges.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(x||(x={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||null!==e.privilegeName&&void 0!==e.privilegeName&&"string"!=typeof e.privilegeName||null!==e.displayName&&void 0!==e.displayName&&"string"!=typeof e.displayName||null!==e.hasPrivilege&&void 0!==e.hasPrivilege&&"boolean"!=typeof e.hasPrivilege||null!==e.errorMessage&&void 0!==e.errorMessage&&"string"!=typeof e.errorMessage||null!==e.governanceUri&&void 0!==e.governanceUri&&"string"!=typeof e.governanceUri||null!==e.governanceEmail&&void 0!==e.governanceEmail&&"string"!=typeof e.governanceEmail);return!n&&t&&Core.Log.warning("IPrivilege.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(H||(H={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&q.isValid(e.master)&&q.isValid(e.int)&&q.isValid(e.prod);return!n&&t&&Core.Log.warning("IClientConfigurationSet.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(B||(B={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.documentServerEndpoint&&"boolean"==typeof e.appFromTemplateUseExtendedGallery&&"string"==typeof e.playerResourcesEndpoint;return!n&&t&&Core.Log.warning("IClientConfiguration.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(q||(q={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.id&&e.id.length>=1&&"string"==typeof e.name&&e.name.length>=1&&"string"==typeof e.type&&e.type.length>=1&&J.isValid(e.properties);return!n&&t&&Core.Log.warning("IConnectionResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(G||(G={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.displayName||void 0===e.displayName||"string"==typeof e.displayName&&e.displayName.length>=1)&&(null===e.iconUri||void 0===e.iconUri||Core.Utility.isAbsoluteUrlString(e.iconUri))&&(null===e.api||void 0===e.api||$.isValid(e.api))&&"string"==typeof e.apiId&&e.apiId.length>=1&&(null===e.connectionParameters||void 0===e.connectionParameters||_e.isValid(e.connectionParameters))&&(null===e.connectionParametersSet||void 0===e.connectionParametersSet||Ie.isValid(e.connectionParametersSet))&&(null===e.createdTime||void 0===e.createdTime||"string"==typeof e.createdTime&&e.createdTime.length>=1)&&(null===e.lastModifiedTime||void 0===e.lastModifiedTime||"string"==typeof e.lastModifiedTime&&e.lastModifiedTime.length>=1)&&(null===e.createdBy||void 0===e.createdBy||X.isValid(e.createdBy))&&(null===e.statuses||void 0===e.statuses||Core.Utility.isArray(e.statuses)&&e.statuses.every((function(e){return Q.isValid(e)})))&&(null===e.testLinks||void 0===e.testLinks||Core.Utility.isArray(e.testLinks)&&e.testLinks.every((function(e){return K.isValid(e)})))&&(null===e.connectionReferences||void 0===e.connectionReferences||Core.Utility.isArray(e.connectionReferences)&&e.connectionReferences.every((function(e){return null==e||z.isValid(e)})))&&Vn.isValid(e.environment)&&(null===e.consentInfo||void 0===e.consentInfo||W.isValid(e.consentInfo))&&(null===e.accountName||void 0===e.accountName||"string"==typeof e.accountName)&&(null===e.createdXrmConnectionReferenceLogicalName||void 0===e.createdXrmConnectionReferenceLogicalName||"string"==typeof e.createdXrmConnectionReferenceLogicalName);return!n&&t&&Core.Log.warning("IConnectionPropertiesResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(J||(J={})),function(e){function t(e,t){var n=be.isValid(e)&&(null===e.redirectUrl||void 0===e.redirectUrl||Core.Utility.isAbsoluteUrlString(e.redirectUrl));return!n&&t&&Core.Log.warning("IConsentInfoResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(W||(W={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||null!==e["@odata.etag"]&&void 0!==e["@odata.etag"]&&"string"!=typeof e["@odata.etag"]||null!==e.connectionreferencedisplayname&&void 0!==e.connectionreferencedisplayname&&"string"!=typeof e.connectionreferencedisplayname||null!==e.connectionreferenceid&&void 0!==e.connectionreferenceid&&"string"!=typeof e.connectionreferenceid||null!==e.connectionreferencelogicalname&&void 0!==e.connectionreferencelogicalname&&"string"!=typeof e.connectionreferencelogicalname);return!n&&t&&Core.Log.warning("IXrmConnectionReferences.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(z||(z={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Core.Utility.isAbsoluteUrlString(e.requestUri)&&"string"==typeof e.method&&e.method.length>=1;return!n&&t&&Core.Log.warning("IConnectionPropertiesResponseTestLink.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(K||(K={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.displayName||void 0===e.displayName||"string"==typeof e.displayName&&e.displayName.length>=1)&&(null===e.email||void 0===e.email||"string"==typeof e.email&&e.email.length>=1)&&(null===e.id||void 0===e.id||"string"==typeof e.id&&e.id.length>=1);return!n&&t&&Core.Log.warning("ICreatedBy.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(X||(X={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.status&&e.status.length>=1&&(null===e.target||void 0===e.target||"string"==typeof e.target&&e.target.length>=1)&&(null===e.error||void 0===e.error||null!==e.error&&"object"==typeof e.error&&Object.getPrototypeOf(e.error)===Object.prototype&&"string"==typeof e.error.code&&e.error.code.length>=1&&"string"==typeof e.error.message&&e.error.message.length>=1);return!n&&t&&Core.Log.warning("IConnectionPropertiesResponseStatusResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Q||(Q={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.id&&e.id.length>=1&&"string"==typeof e.name&&e.name.length>=1&&"string"==typeof e.type&&e.type.length>=1&&ne.isValid(e.properties);return!n&&t&&Core.Log.warning("IApiResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}($||($={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Core.Utility.isArray(e.consents)&&e.consents.every((function(e){return null==e||Y.isValid(e)}));return!n&&t&&Core.Log.warning("IRecordScopeConsentRequest.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Z||(Z={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.consentType&&e.consentType.length>=1&&"string"==typeof e.connectionId&&e.connectionId.length>=1&&re.isValid(e.scopes);return!n&&t&&Core.Log.warning("IRecordScopeConsent.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Y||(Y={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.name&&e.name.length>=1&&(null===e.uiDefinition||void 0===e.uiDefinition||De.isValid(e.uiDefinition))&&(null===e.parameters||void 0===e.parameters||Core.Utility.isJsonHashTable(e.parameters)&&HashTableUtility.every(e.parameters,(function(e){return null!==e||void 0!==e})))&&(null===e.metadata||void 0===e.metadata||oe.isValid(e.metadata));return!n&&t&&Core.Log.warning("IApiConnectionParametersSet.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(ee||(ee={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.uiDefinition||void 0===e.uiDefinition||De.isValid(e.uiDefinition))&&Core.Utility.isArray(e.values)&&e.values.every((function(e){return null==e||ee.isValid(e)}));return!n&&t&&Core.Log.warning("IApiConnectionParameterSets.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(te||(te={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.displayName||void 0===e.displayName||"string"==typeof e.displayName&&e.displayName.length>=1)&&(null===e.description||void 0===e.description||"string"==typeof e.description)&&(null===e.changedTime||void 0===e.changedTime||"string"==typeof e.changedTime&&e.changedTime.length>=1)&&(null===e.releaseTag||void 0===e.releaseTag||"string"==typeof e.releaseTag&&e.releaseTag.length>=1)&&(null===e.tier||void 0===e.tier||"string"==typeof e.tier&&e.tier.length>=1)&&(null===e.scopes||void 0===e.scopes||re.isValid(e.scopes))&&(null===e.iconUri||void 0===e.iconUri||Core.Utility.isAbsoluteUrlString(e.iconUri))&&(null===e.wadlUrl||void 0===e.wadlUrl||Core.Utility.isAbsoluteUrlString(e.wadlUrl))&&(null===e.termsOfUseUrl||void 0===e.termsOfUseUrl||Core.Utility.isAbsoluteUrlString(e.termsOfUseUrl))&&Core.Utility.isAbsoluteUrlString(e.primaryRuntimeUrl)&&Core.Utility.isArray(e.capabilities)&&e.capabilities.every((function(e){return"string"==typeof e&&e.length>=1}))&&(null===e.connectionParameters||void 0===e.connectionParameters||Core.Utility.isJsonHashTable(e.connectionParameters)&&HashTableUtility.every(e.connectionParameters,(function(e){return null!==e||void 0!==e})))&&(null===e.connectionParameterSets||void 0===e.connectionParameterSets||te.isValid(e.connectionParameterSets))&&(null===e.createdBy||void 0===e.createdBy||X.isValid(e.createdBy))&&(null===e.metadata||void 0===e.metadata||oe.isValid(e.metadata))&&(null===e.interfaces||void 0===e.interfaces||Core.Utility.isJsonHashTable(e.interfaces)&&HashTableUtility.every(e.interfaces,(function(e){return null==e||ie.isValid(e)})))&&(null===e.swagger||void 0===e.swagger||null!==e.swagger&&"object"==typeof e.swagger&&Object.getPrototypeOf(e.swagger)===Object.prototype);return!n&&t&&Core.Log.warning("IApiPropertiesResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(ne||(ne={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.will||void 0===e.will||Core.Utility.isArray(e.will)&&e.will.every((function(e){return null==e||"string"==typeof e})))&&(null===e.wont||void 0===e.wont||Core.Utility.isArray(e.wont)&&e.wont.every((function(e){return null==e||"string"==typeof e})));return!n&&t&&Core.Log.warning("IApiScopes.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(re||(re={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.brandColor||void 0===e.brandColor||"string"==typeof e.brandColor)&&(null===e.connectionLimits||void 0===e.connectionLimits||Core.Utility.isJsonHashTable(e.connectionLimits)&&HashTableUtility.every(e.connectionLimits,(function(e){return"number"==typeof e})))&&(null===e.allowSharing||void 0===e.allowSharing||"boolean"==typeof e.allowSharing)&&(null===e.source||void 0===e.source||"string"==typeof e.source)&&(null===e.sourceApplication||void 0===e.sourceApplication||"string"==typeof e.sourceApplication)&&(null===e.fileMediaTypes||void 0===e.fileMediaTypes||Core.Utility.isArray(e.fileMediaTypes)&&e.fileMediaTypes.every((function(e){return"string"==typeof e&&e.length>=1})));return!n&&t&&Core.Log.warning("IApiMetadata.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(oe||(oe={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Core.Utility.isJsonHashTable(e.revisions)&&HashTableUtility.every(e.revisions,(function(e){return null==e||ae.isValid(e)}));return!n&&t&&Core.Log.warning("IApiInterface.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(ie||(ie={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.baseUrl&&e.baseUrl.length>=1&&(null===e.status||void 0===e.status||"string"==typeof e.status)&&(null===e.deprecated||void 0===e.deprecated||"boolean"==typeof e.deprecated)&&(null===e.expires||void 0===e.expires||"string"==typeof e.expires);return!n&&t&&Core.Log.warning("IApiInterfaceRevision.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(ae||(ae={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.id&&"string"==typeof e.displayName;return!n&&t&&Core.Log.warning("ITabularParameterItem.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(se||(se={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.tabular||void 0===e.tabular||null!==e.tabular&&"object"==typeof e.tabular&&Object.getPrototypeOf(e.tabular)===Object.prototype&&"string"==typeof e.tabular.source&&"string"==typeof e.tabular.displayName&&"string"==typeof e.tabular.urlEncoding&&"string"==typeof e.tabular.tableDisplayName&&"string"==typeof e.tabular.tablePluralName)&&(null===e.blob||void 0===e.blob||null!==e.blob&&"object"==typeof e.blob&&Object.getPrototypeOf(e.blob)===Object.prototype&&"string"==typeof e.blob.source&&"string"==typeof e.blob.displayName)&&"string"==typeof e.datasetFormat&&(null===e.parameters||void 0===e.parameters||Core.Utility.isArray(e.parameters)&&e.parameters.every((function(e){return le.isValid(e)})))&&null!==e.noNaturalKeyColumnConnector&&"object"==typeof e.noNaturalKeyColumnConnector&&Object.getPrototypeOf(e.noNaturalKeyColumnConnector)===Object.prototype&&"string"==typeof e.noNaturalKeyColumnConnector.createKeyColumnPath&&"string"==typeof e.noNaturalKeyColumnConnector.createKeyColumnMethod&&"string"==typeof e.noNaturalKeyColumnConnector.keyColumnNameUrlEncoding;return!n&&t&&Core.Log.warning("ITabularMetadata.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(ce||(ce={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.path&&"string"==typeof e.itemValuePath&&"string"==typeof e.itemTitlePath&&"string"==typeof e.itemFullTitlePath&&"string"==typeof e.itemIsParent&&"string"==typeof e.selectableFilter;return!n&&t&&Core.Log.warning("IDynamicTreeSelectOption.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(ue||(ue={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&null!==e.settings&&"object"==typeof e.settings&&Object.getPrototypeOf(e.settings)===Object.prototype&&"boolean"==typeof e.settings.canSelectParentNodes&&"boolean"==typeof e.settings.canSelectLeafNodes&&"string"==typeof e.settings.selectedItemPlaceholder&&ue.isValid(e.open)&&ue.isValid(e.browse);return!n&&t&&Core.Log.warning("IDynamicTreeOptions.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(pe||(pe={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.name&&"string"==typeof e.type&&"string"==typeof e.description&&"boolean"==typeof e.required&&"string"==typeof e["x-ms-summary"]&&(null===e["x-ms-dynamic-values"]||void 0===e["x-ms-dynamic-values"]||null!==e["x-ms-dynamic-values"]&&"object"==typeof e["x-ms-dynamic-values"]&&Object.getPrototypeOf(e["x-ms-dynamic-values"])===Object.prototype&&"string"==typeof e["x-ms-dynamic-values"].path&&"string"==typeof e["x-ms-dynamic-values"]["value-collection"]&&"string"==typeof e["x-ms-dynamic-values"]["value-path"]&&"string"==typeof e["x-ms-dynamic-values"]["value-title"])&&"string"==typeof e.urlEncoding&&(null===e["x-ms-dynamic-tree"]||void 0===e["x-ms-dynamic-tree"]||pe.isValid(e["x-ms-dynamic-tree"]))&&(null===e.isFileType||void 0===e.isFileType||"boolean"==typeof e.isFileType);return!n&&t&&Core.Log.warning("ITabularMetadataParameter.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(le||(le={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.tabular||void 0===e.tabular||null!==e.tabular&&"object"==typeof e.tabular&&Object.getPrototypeOf(e.tabular)===Object.prototype&&"string"==typeof e.tabular.source&&"string"==typeof e.tabular.displayName&&"string"==typeof e.tabular.tableDisplayName&&"string"==typeof e.tabular.tablePluralName)&&(null===e.blob||void 0===e.blob||null!==e.blob&&"object"==typeof e.blob&&Object.getPrototypeOf(e.blob)===Object.prototype&&"string"==typeof e.blob.source&&"string"==typeof e.blob.displayName);return!n&&t&&Core.Log.warning("IDatasetMetadata.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(de||(de={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Core.Utility.isArray(e.value)&&e.value.every((function(e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype}));return!n&&t&&Core.Log.warning("IGetApisOrConnectionsResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(fe||(fe={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&ve.isValid(e.properties);return!n&&t&&Core.Log.warning("IPutConnectionRequest.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(ye||(ye={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null!==e.value||void 0!==e.value);return!n&&t&&Core.Log.warning("IPutConnectionParametersSetValue.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(me||(me={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.name&&(null===e.values||void 0===e.values||Core.Utility.isJsonHashTable(e.values)&&HashTableUtility.every(e.values,(function(e){return me.isValid(e)})));return!n&&t&&Core.Log.warning("IPutConnectionParametersSet.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(ge||(ge={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.displayName||void 0===e.displayName||"string"==typeof e.displayName)&&(null===e.connectionParameters||void 0===e.connectionParameters||Core.Utility.isJsonHashTable(e.connectionParameters)&&HashTableUtility.every(e.connectionParameters,(function(e){return null!==e||void 0!==e})))&&(null===e.connectionParametersSet||void 0===e.connectionParametersSet||ge.isValid(e.connectionParametersSet))&&(null===e.usages||void 0===e.usages||Core.Utility.isArray(e.usages)&&e.usages.every((function(e){return null==e||null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.resourceId&&e.resourceId.length>=1&&"string"==typeof e.reference&&e.reference.length>=1})))&&(null===e.metadata||void 0===e.metadata||Core.Utility.isJsonHashTable(e.metadata)&&HashTableUtility.every(e.metadata,(function(e){return null!==e})))&&(null===e.environment||void 0===e.environment||Vn.isValid(e.environment))&&(null===e.consentInfo||void 0===e.consentInfo||null!==e.consentInfo&&"object"==typeof e.consentInfo&&Object.getPrototypeOf(e.consentInfo)===Object.prototype&&(null===e.consentInfo.redirectUrl||void 0===e.consentInfo.redirectUrl||"string"==typeof e.consentInfo.redirectUrl));return!n&&t&&Core.Log.warning("IPutConnectionRequestProperties.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(ve||(ve={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Core.Utility.isAbsoluteUrlString(e.consentLink)&&(null===e.firstPartyLoginUri||void 0===e.firstPartyLoginUri||Core.Utility.isAbsoluteUrlString(e.firstPartyLoginUri));return!n&&t&&Core.Log.warning("IGetConnectionConsentLinkResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(be||(be={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.Id&&e.Id.length>=1&&"string"==typeof e.Name&&e.Name.length>=1&&"string"==typeof e.Path&&e.Path.length>=1&&"boolean"==typeof e.IsFolder&&(null===e.MediaType||void 0===e.MediaType||"string"==typeof e.MediaType);return!n&&t&&Core.Log.warning("IFileServiceItem.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(he||(he={})),function(e){function t(e,t){var n=G.isValid(e)&&Ce.isValid(e.properties);return!n&&t&&Core.Log.warning("IUserConnectionForAppResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Ae||(Ae={})),function(e){function t(e,t){var n=J.isValid(e)&&"string"==typeof e.reference&&e.reference.length>=1&&(null===e.appActions||void 0===e.appActions||Core.Utility.isArray(e.appActions)&&e.appActions.every((function(e){return null==e||"string"==typeof e})));return!n&&t&&Core.Log.warning("IUserConnectionForAppPropertiesResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Ce||(Ce={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.properties||void 0===e.properties||we.isValid(e.properties));return!n&&t&&Core.Log.warning("IPostConnectionUsageRequest.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Pe||(Pe={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.resourceId&&e.resourceId.length>=1&&"string"==typeof e.reference&&e.reference.length>=1&&(null===e.appActions||void 0===e.appActions||Core.Utility.isArray(e.appActions)&&e.appActions.every((function(e){return"string"==typeof e&&e.length>=1})));return!n&&t&&Core.Log.warning("IConnectionUsageProperties.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(we||(we={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.value||void 0===e.value||Core.Utility.isArray(e.value)&&e.value.every((function(e){return null==e||Oe.isValid(e)})));return!n&&t&&Core.Log.warning("IServerListConnectionUsage.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Se||(Se={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.name&&e.name.length>=1&&"string"==typeof e.id&&e.id.length>=1&&we.isValid(e.properties);return!n&&t&&Core.Log.warning("IConnectionUsage.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Oe||(Oe={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.type&&e.type.length>=1&&(null===e.uiDefinition||void 0===e.uiDefinition||De.isValid(e.uiDefinition))&&(null===e.oAuthSettings||void 0===e.oAuthSettings||Ve.isValid(e.oAuthSettings));return!n&&t&&Core.Log.warning("IApiConnectionParametersResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Re||(Re={})),function(e){function t(e,t){var n=Core.Utility.isJsonHashTable(e)&&HashTableUtility.every(e,(function(e){return!0}));return!n&&t&&Core.Log.warning("IConnectionParameterSet.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(_e||(_e={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&null!==e.value;return!n&&t&&Core.Log.warning("IMultiAuthConnectionParameterValue.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Te||(Te={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.name&&(null===e.values||void 0===e.values||Core.Utility.isJsonHashTable(e.values)&&HashTableUtility.every(e.values,(function(e){return null==e||Te.isValid(e)})));return!n&&t&&Core.Log.warning("IMultiAuthConnectionParametersSet.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Ie||(Ie={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||"string"!=typeof e.connectionId||null!==e.id&&void 0!==e.id&&"string"!=typeof e.id||null!==e.url&&void 0!==e.url&&"string"!=typeof e.url||null!==e.source&&void 0!==e.source&&"string"!=typeof e.source||null!==e.apiId&&void 0!==e.apiId&&"string"!=typeof e.apiId);return!n&&t&&Core.Log.warning("IConnectionReferenceInfo.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Ee||(Ee={})),function(e){function t(e,t){var n=_e.isValid(e)&&Ee.isValid(e.fileSource);return!n&&t&&Core.Log.warning("IFileSourceSet.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Ue||(Ue={})),function(e){function t(e,t){var n=_e.isValid(e)&&"string"==typeof e.workflowName&&(null===e.workflowEntityId||void 0===e.workflowEntityId||"string"==typeof e.workflowEntityId)&&Core.Utility.isJsonHashTable(e.$connections)&&HashTableUtility.every(e.$connections,(function(e){return null==e||Ee.isValid(e)}));return!n&&t&&Core.Log.warning("IMsFlowSet.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(je||(je={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.required||void 0===e.required||"string"==typeof e.required)&&(null===e.tabIndex||void 0===e.tabIndex||"number"==typeof e.tabIndex)&&(null===e.hidden||void 0===e.hidden||"string"==typeof e.hidden)&&(null===e.clearText||void 0===e.clearText||"boolean"==typeof e.clearText)&&(null===e.allowedValues||void 0===e.allowedValues||Core.Utility.isArray(e.allowedValues)&&e.allowedValues.every((function(e){return null==e||null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.text||void 0===e.text||"string"==typeof e.text)&&(null===e.value||void 0===e.value||"string"==typeof e.value)})))&&(null===e.capability||void 0===e.capability||Core.Utility.isArray(e.capability)&&e.capability.every((function(e){return null==e||"string"==typeof e&&e.length>=1})))&&(null===e.dependentCapability||void 0===e.dependentCapability||"string"==typeof e.dependentCapability&&e.dependentCapability.length>=1);return!n&&t&&Core.Log.warning("IConnectionParameterConstraints.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Ne||(Ne={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.displayName||void 0===e.displayName||"string"==typeof e.displayName&&e.displayName.length>=1)&&(null===e.description||void 0===e.description||"string"==typeof e.description&&e.description.length>=1)&&(null===e.tooltip||void 0===e.tooltip||"string"==typeof e.tooltip&&e.tooltip.length>=1)&&(null===e.constraints||void 0===e.constraints||Ne.isValid(e.constraints));return!n&&t&&Core.Log.warning("IUIDefinitionResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(De||(De={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.properties||void 0===e.properties||null!==e.properties&&"object"==typeof e.properties&&Object.getPrototypeOf(e.properties)===Object.prototype&&(null===e.properties.IsFirstParty||void 0===e.properties.IsFirstParty||"string"==typeof e.properties.IsFirstParty));return!n&&t&&Core.Log.warning("IOAuthSettingsResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Ve||(Ve={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.gatewayObjectId||void 0===e.gatewayObjectId||"string"==typeof e.gatewayObjectId);return!n&&t&&Core.Log.warning("IGatewayConnectionParameter.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Me||(Me={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.id&&e.id.length>=1&&null!==e.connectionRef&&"object"==typeof e.connectionRef&&Object.getPrototypeOf(e.connectionRef)===Object.prototype&&"string"==typeof e.connectionRef.id&&e.connectionRef.id.length>=1&&(null===e.connectionRef.displayName||void 0===e.connectionRef.displayName||"string"==typeof e.connectionRef.displayName&&e.connectionRef.displayName.length>=1)&&(null===e.connectionRef.iconUri||void 0===e.connectionRef.iconUri||"string"==typeof e.connectionRef.iconUri&&e.connectionRef.iconUri.length>=1)&&(null===e.connectionRef.sharedConnectionId||void 0===e.connectionRef.sharedConnectionId||"string"==typeof e.connectionRef.sharedConnectionId&&e.connectionRef.sharedConnectionId.length>=1)&&(null===e.connectionRef.gatewayObjectIdHint||void 0===e.connectionRef.gatewayObjectIdHint||"string"==typeof e.connectionRef.gatewayObjectIdHint&&e.connectionRef.gatewayObjectIdHint.length>=1)&&(null===e.connectionRef.isOnPremiseConnection||void 0===e.connectionRef.isOnPremiseConnection||"boolean"==typeof e.connectionRef.isOnPremiseConnection)&&(null===e.connectionRef.isCustomApiConnection||void 0===e.connectionRef.isCustomApiConnection||"boolean"==typeof e.connectionRef.isCustomApiConnection)&&(null===e.connectionRef.resourceIdentifier||void 0===e.connectionRef.resourceIdentifier||"string"==typeof e.connectionRef.resourceIdentifier&&e.connectionRef.resourceIdentifier.length>=1)&&(null===e.connectionRef.bypassConsent||void 0===e.connectionRef.bypassConsent||"boolean"==typeof e.connectionRef.bypassConsent)&&(null===e.connectionRef.xrmConnectionReferenceLogicalName||void 0===e.connectionRef.xrmConnectionReferenceLogicalName||"string"==typeof e.connectionRef.xrmConnectionReferenceLogicalName&&e.connectionRef.xrmConnectionReferenceLogicalName.length>=1)&&(null===e.connectionRef.parameterHints||void 0===e.connectionRef.parameterHints||Core.Utility.isJsonHashTable(e.connectionRef.parameterHints)&&HashTableUtility.every(e.connectionRef.parameterHints,(function(e){return c.isValid(e)})))&&(null===e.connectionRef.parameterHintsV2||void 0===e.connectionRef.parameterHintsV2||Core.Utility.isJsonHashTable(e.connectionRef.parameterHintsV2)&&HashTableUtility.every(e.connectionRef.parameterHintsV2,(function(e){return c.isValid(e)})))&&(null===e.connectionRef.runtimePolicyName||void 0===e.connectionRef.runtimePolicyName||"string"==typeof e.connectionRef.runtimePolicyName)&&(null===e.connectionRef.apiTier||void 0===e.connectionRef.apiTier||"string"==typeof e.connectionRef.apiTier)&&(null===e.connectionRef.authenticationType||void 0===e.connectionRef.authenticationType||"string"==typeof e.connectionRef.authenticationType&&e.connectionRef.authenticationType.length>=1)&&(null===e.connectionRef.executionRestrictions||void 0===e.connectionRef.executionRestrictions||s.isValid(e.connectionRef.executionRestrictions))&&(null===e.connectionInstanceId||void 0===e.connectionInstanceId||"string"==typeof e.connectionInstanceId&&e.connectionInstanceId.length>=1)&&Core.Utility.isArray(e.dataSources)&&e.dataSources.every((function(e){return"string"==typeof e&&e.length>=1}))&&(null===e.datasets||void 0===e.datasets||Core.Utility.isJsonHashTable(e.datasets)&&HashTableUtility.every(e.datasets,(function(e){return i.isValid(e)})))&&(null===e.dataSourceAppMappings||void 0===e.dataSourceAppMappings||Core.Utility.isJsonHashTable(e.dataSourceAppMappings)&&HashTableUtility.every(e.dataSourceAppMappings,(function(e){return null==e||Core.Utility.isArray(e)&&e.every((function(e){return null==e||"string"==typeof e}))})))&&Core.Utility.isJsonHashTable(e.dependencies)&&HashTableUtility.every(e.dependencies,(function(e){return null==e||"string"==typeof e}))&&(null===e.dependents||void 0===e.dependents||Core.Utility.isArray(e.dependents)&&e.dependents.every((function(e){return null==e||"string"==typeof e})))&&(null===e.connectionParameters||void 0===e.connectionParameters||Core.Utility.isJsonHashTable(e.connectionParameters)&&HashTableUtility.every(e.connectionParameters,(function(e){return"string"==typeof e})))&&(null===e.endpoints||void 0===e.endpoints||Core.Utility.isArray(e.endpoints)&&e.endpoints.every((function(e){return null==e||"string"==typeof e})))&&(null===e.appActions||void 0===e.appActions||Core.Utility.isArray(e.appActions)&&e.appActions.every((function(e){return null==e||"string"==typeof e})));return!n&&t&&Core.Log.warning("ILocalConnection.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(ke||(ke={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.value||void 0===e.value||Core.Utility.isArray(e.value)&&e.value.every((function(e){return Fe.isValid(e)})));return!n&&t&&Core.Log.warning("IGetGatewaysResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Le||(Le={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.id&&e.id.length>=1&&"string"==typeof e.name&&e.name.length>=1&&"string"==typeof e.type&&e.type.length>=1&&xe.isValid(e.properties);return!n&&t&&Core.Log.warning("IGateway.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Fe||(Fe={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.displayName&&e.displayName.length>=1&&(null===e.description||void 0===e.description||"string"==typeof e.description)&&(null===e.machineName||void 0===e.machineName||"string"==typeof e.machineName)&&(null===e.admin||void 0===e.admin||Core.Utility.isArray(e.admin)&&e.admin.every((function(e){return null==e||"string"==typeof e})))&&(null===e.gatewayType||void 0===e.gatewayType||"string"==typeof e.gatewayType);return!n&&t&&Core.Log.warning("IGatewayProperties.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(xe||(xe={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.displayName||void 0===e.displayName||"string"==typeof e.displayName&&e.displayName.length>=1)&&(null===e.email||void 0===e.email||"string"==typeof e.email&&e.email.length>=1)&&"string"==typeof e.id&&e.id.length>=1&&(null===e.type||void 0===e.type||"string"==typeof e.type)&&(null===e.tenantId||void 0===e.tenantId||"string"==typeof e.tenantId);return!n&&t&&Core.Log.warning("IRuntimeNamespaceOwner.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(He||(He={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.id&&e.id.length>=1&&"string"==typeof e.displayName&&e.displayName.length>=1&&"string"==typeof e.runtimeId&&e.runtimeId.length>=1&&Core.Utility.isAbsoluteUrlString(e.runtimeUri)&&(null===e.createdDateTime||void 0===e.createdDateTime||"string"==typeof e.createdDateTime&&e.createdDateTime.length>=1)&&(null===e.modifiedDateTime||void 0===e.modifiedDateTime||"string"==typeof e.modifiedDateTime&&e.modifiedDateTime.length>=1)&&"string"==typeof e.version&&e.version.length>=1&&He.isValid(e.owner)&&He.isValid(e.createdBy)&&null!==e.provisioningState&&"object"==typeof e.provisioningState&&Object.getPrototypeOf(e.provisioningState)===Object.prototype&&"string"==typeof e.provisioningState.status;return!n&&t&&Core.Log.warning("IRuntimeUserNamespaceProperties.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Be||(Be={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.name&&e.name.length>=1&&"string"==typeof e.id&&e.id.length>=1&&Be.isValid(e.properties);return!n&&t&&Core.Log.warning("IRuntimeUserNamespace.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(qe||(qe={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.value||void 0===e.value||Core.Utility.isArray(e.value)&&e.value.every((function(e){return null==e||qe.isValid(e)})));return!n&&t&&Core.Log.warning("IRuntimeUserNamespaceResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Ge||(Ge={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Core.Utility.isArray(e.errors)&&e.errors.every((function(e){return null==e||"string"==typeof e}));return!n&&t&&Core.Log.warning("ISharePointConnectorErrorResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Je||(Je={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.name&&"string"==typeof e.id&&(null===e.appModuleId||void 0===e.appModuleId||"string"==typeof e.appModuleId)&&"string"==typeof e.type&&ze.isValid(e.properties);return!n&&t&&Core.Log.warning("ICuratedAppInfo.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(We||(We={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.serviceName||void 0===e.serviceName||"string"==typeof e.serviceName)&&(null===e.appType||void 0===e.appType||"string"==typeof e.appType)&&(null===e.firstPartyApp||void 0===e.firstPartyApp||"boolean"==typeof e.firstPartyApp)&&(null===e.isFavorited||void 0===e.isFavorited||"boolean"==typeof e.isFavorited)&&(null===e.heroApp||void 0===e.heroApp||"boolean"==typeof e.heroApp)&&(null===e.appId||void 0===e.appId||"string"==typeof e.appId)&&(null===e.appName||void 0===e.appName||"string"==typeof e.appName)&&(null===e.appDescription||void 0===e.appDescription||"string"==typeof e.appDescription)&&(null===e.displayName||void 0===e.displayName||"string"==typeof e.displayName)&&(null===e.backgroundColor||void 0===e.backgroundColor||"string"==typeof e.backgroundColor)&&(null===e.iconUri||void 0===e.iconUri||"string"==typeof e.iconUri)&&(null===e.createdTime||void 0===e.createdTime||"string"==typeof e.createdTime)&&(null===e.lastUsedTime||void 0===e.lastUsedTime||"string"==typeof e.lastUsedTime)&&(null===e.appOpenUri||void 0===e.appOpenUri||"string"==typeof e.appOpenUri)&&(null===e.featuredApp||void 0===e.featuredApp||"boolean"==typeof e.featuredApp)&&(null===e.groupName||void 0===e.groupName||"string"==typeof e.groupName)&&(null===e.groupDisplayName||void 0===e.groupDisplayName||"string"==typeof e.groupDisplayName)&&(null===e.groupType||void 0===e.groupType||"string"==typeof e.groupType)&&(null===e.createdBy||void 0===e.createdBy||Ke.isValid(e.createdBy));return!n&&t&&Core.Log.warning("ICuratedAppProperties.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(ze||(ze={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||null!==e.id&&void 0!==e.id&&"string"!=typeof e.id||null!==e.displayName&&void 0!==e.displayName&&"string"!=typeof e.displayName||null!==e.type&&void 0!==e.type&&"string"!=typeof e.type||null!==e.tenantId&&void 0!==e.tenantId&&"string"!=typeof e.tenantId||null!==e.userPrincipalName&&void 0!==e.userPrincipalName&&"string"!=typeof e.userPrincipalName);return!n&&t&&Core.Log.warning("ICuratedAppCreatedBy.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Ke||(Ke={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.name&&e.name.length>=1&&"string"==typeof e.id&&e.id.length>=1&&"string"==typeof e.type&&e.type.length>=1;return!n&&t&&Core.Log.warning("IApiReference.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Xe||(Xe={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Xe.isValid(e.api);return!n&&t&&Core.Log.warning("IDataUsageParameter.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Qe||(Qe={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.type&&e.type.length>=1&&(null===e.parameters||void 0===e.parameters||Qe.isValid(e.parameters));return!n&&t&&Core.Log.warning("IDataUsage.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}($e||($e={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.dataSource||void 0===e.dataSource||null!==e.dataSource&&"object"==typeof e.dataSource&&Object.getPrototypeOf(e.dataSource)===Object.prototype&&"string"==typeof e.dataSource.apiGroup&&(null===e.dataSource.apis||void 0===e.dataSource.apis||Core.Utility.isArray(e.dataSource.apis)&&e.dataSource.apis.every((function(e){return null==e||Xe.isValid(e)}))))&&(null===e.dataDestination||void 0===e.dataDestination||null!==e.dataDestination&&"object"==typeof e.dataDestination&&Object.getPrototypeOf(e.dataDestination)===Object.prototype&&"string"==typeof e.dataDestination.apiGroup&&(null===e.dataDestination.apis||void 0===e.dataDestination.apis||Core.Utility.isArray(e.dataDestination.apis)&&e.dataDestination.apis.every((function(e){return null==e||Xe.isValid(e)}))));return!n&&t&&Core.Log.warning("IViolationParameters.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Ze||(Ze={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.type||void 0===e.type||"string"==typeof e.type);return!n&&t&&Core.Log.warning("IViolationPolicy.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Ye||(Ye={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.policy||void 0===e.policy||Ye.isValid(e.policy))&&(null===e.type||void 0===e.type||"string"==typeof e.type&&e.type.length>=1)&&(null===e.parameters||void 0===e.parameters||Ze.isValid(e.parameters));return!n&&t&&Core.Log.warning("IViolation.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(et||(et={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.policyId||void 0===e.policyId||"string"==typeof e.policyId)&&(null===e.policyDisplayName||void 0===e.policyDisplayName||"string"==typeof e.policyDisplayName)&&(null===e.type||void 0===e.type||"string"==typeof e.type&&e.type.length>=1)&&(null===e.parameters||void 0===e.parameters||Core.Utility.isArray(e.parameters)&&e.parameters.every((function(e){return null==e||"string"==typeof e})));return!n&&t&&Core.Log.warning("IAppViolation.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(tt||(tt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Core.Utility.isArray(e.dataUsages)&&e.dataUsages.every((function(e){return null==e||$e.isValid(e)}));return!n&&t&&Core.Log.warning("IEvaluatePolicyRequest.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(nt||(nt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Core.Utility.isArray(e.dataUsages)&&e.dataUsages.every((function(e){return null==e||$e.isValid(e)}))&&Core.Utility.isArray(e.violations)&&e.violations.every((function(e){return null==e||et.isValid(e)}));return!n&&t&&Core.Log.warning("IEvaluatePolicyResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(rt||(rt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&null!==e.evaluationResult&&"object"==typeof e.evaluationResult&&Object.getPrototypeOf(e.evaluationResult)===Object.prototype&&(null===e.evaluationResult.status||void 0===e.evaluationResult.status||"string"==typeof e.evaluationResult.status)&&(null===e.evaluationResult.lastEvaluationDate||void 0===e.evaluationResult.lastEvaluationDate||"string"==typeof e.evaluationResult.lastEvaluationDate)&&Core.Utility.isArray(e.evaluationResult.violations)&&e.evaluationResult.violations.every((function(e){return null==e||null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.policyId||void 0===e.policyId||"string"==typeof e.policyId)&&(null===e.policyDisplayName||void 0===e.policyDisplayName||"string"==typeof e.policyDisplayName)&&(null===e.type||void 0===e.type||"string"==typeof e.type&&e.type.length>=1)&&(null===e.parameters||void 0===e.parameters||Core.Utility.isArray(e.parameters)&&e.parameters.every((function(e){return null==e||"string"==typeof e})))}))&&(null===e.evaluationResult.violationsByPolicy||void 0===e.evaluationResult.violationsByPolicy||Core.Utility.isArray(e.evaluationResult.violationsByPolicy)&&e.evaluationResult.violationsByPolicy.every((function(e){return null==e||it.isValid(e)})))&&(null===e.evaluationResult.additionalInfo||void 0===e.evaluationResult.additionalInfo||null!==e.evaluationResult.additionalInfo&&"object"==typeof e.evaluationResult.additionalInfo&&Object.getPrototypeOf(e.evaluationResult.additionalInfo)===Object.prototype)&&(null===e.evaluationResult.violationErrorMessage||void 0===e.evaluationResult.violationErrorMessage||"string"==typeof e.evaluationResult.violationErrorMessage)&&Core.Utility.isArray(e.errors)&&e.errors.every((function(e){return null==e||null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.message&&"string"==typeof e.code}));return!n&&t&&Core.Log.warning("IEvaluatePolicyForAppResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(ot||(ot={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.policyRef||void 0===e.policyRef||null!==e.policyRef&&"object"==typeof e.policyRef&&Object.getPrototypeOf(e.policyRef)===Object.prototype&&(null===e.policyRef.policyId||void 0===e.policyRef.policyId||"string"==typeof e.policyRef.policyId)&&(null===e.policyRef.policyDisplayName||void 0===e.policyRef.policyDisplayName||"string"==typeof e.policyRef.policyDisplayName))&&(null===e.violations||void 0===e.violations||Core.Utility.isArray(e.violations)&&e.violations.every((function(e){return null==e||null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.policyId||void 0===e.policyId||"string"==typeof e.policyId)&&(null===e.policyDisplayName||void 0===e.policyDisplayName||"string"==typeof e.policyDisplayName)&&(null===e.type||void 0===e.type||"string"==typeof e.type&&e.type.length>=1)&&(null===e.parameters||void 0===e.parameters||Core.Utility.isArray(e.parameters)&&e.parameters.every((function(e){return null==e||"string"==typeof e})))})));return!n&&t&&Core.Log.warning("IViolationByPolicy.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(it||(it={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"boolean"==typeof e.isWhiteListed&&"string"==typeof e.userDefaultCountryLocation;return!n&&t&&Core.Log.warning("IUserProperties.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(at||(at={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Core.Utility.isArray(e.premiumApiIds)&&e.premiumApiIds.every((function(e){return null==e||"string"==typeof e}))&&"boolean"==typeof e.premiumApis&&"boolean"==typeof e.onPremGateway&&"boolean"==typeof e.customApi&&"boolean"==typeof e.nonDefaultEnvironments;return!n&&t&&Core.Log.warning("IPremiumFeatures.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(st||(st={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"boolean"==typeof e.userHasActivePlan&&"boolean"==typeof e.userHasActivePremiumPlan&&"boolean"==typeof e.userHasExpiredPremiumPlan&&st.isValid(e.premiumFeaturesActivePlans)&&st.isValid(e.premiumFeaturesExpiredPlans);return!n&&t&&Core.Log.warning("IUserPlans.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(ct||(ct={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Core.Utility.isArray(e.value)&&e.value.every((function(e){return null==e||pt.isValid(e)}));return!n&&t&&Core.Log.warning("IFlowMetadata.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(ut||(ut={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.name&&"string"==typeof e.id&&lt.isValid(e.properties)&&"string"==typeof e.type;return!n&&t&&Core.Log.warning("IFlowMetadataEx.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(pt||(pt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.displayName||void 0===e.displayName||"string"==typeof e.displayName)&&(null===e.apiId||void 0===e.apiId||"string"==typeof e.apiId)&&(null===e.connectionReferences||void 0===e.connectionReferences||Core.Utility.isJsonHashTable(e.connectionReferences)&&HashTableUtility.every(e.connectionReferences,(function(e){return null==e||yt.isValid(e)})))&&(null===e.definitionSummary||void 0===e.definitionSummary||null!==e.definitionSummary&&"object"==typeof e.definitionSummary&&Object.getPrototypeOf(e.definitionSummary)===Object.prototype&&(null===e.definitionSummary.triggers||void 0===e.definitionSummary.triggers||Core.Utility.isArray(e.definitionSummary.triggers)&&e.definitionSummary.triggers.every((function(e){return null==e||dt.isValid(e)}))))&&(null===e.createdTime||void 0===e.createdTime||"string"==typeof e.createdTime)&&(null===e.lastModifiedTime||void 0===e.lastModifiedTime||"string"==typeof e.lastModifiedTime)&&(null===e.state||void 0===e.state||"string"==typeof e.state)&&(null===e.flowTriggerUri||void 0===e.flowTriggerUri||Core.Utility.isAbsoluteUrlString(e.flowTriggerUri))&&(null===e.workflowEntityId||void 0===e.workflowEntityId||"string"==typeof e.workflowEntityId);return!n&&t&&Core.Log.warning("IFlowMetadataProperties.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(lt||(lt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.kind||void 0===e.kind||"string"==typeof e.kind&&e.kind.length>=1)&&(null===e.type||void 0===e.type||"string"==typeof e.type&&e.type.length>=1)&&(null===e.api||void 0===e.api||null!==e.api&&"object"==typeof e.api&&Object.getPrototypeOf(e.api)===Object.prototype&&(null===e.api.name||void 0===e.api.name||"string"==typeof e.api.name)&&(null===e.api.properties||void 0===e.api.properties||ft.isValid(e.api.properties)));return!n&&t&&Core.Log.warning("IFlowTrigger.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(dt||(dt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.displayName||void 0===e.displayName||"string"==typeof e.displayName)&&(null===e.iconUri||void 0===e.iconUri||Core.Utility.isAbsoluteUrlString(e.iconUri));return!n&&t&&Core.Log.warning("IFlowTriggersApiProperties.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(ft||(ft={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||null!==e.connectionName&&void 0!==e.connectionName&&"string"!=typeof e.connectionName||null!==e.displayName&&void 0!==e.displayName&&"string"!=typeof e.displayName||null!==e.iconUri&&void 0!==e.iconUri&&"string"!=typeof e.iconUri||null!==e.id&&void 0!==e.id&&"string"!=typeof e.id||null!==e.source&&void 0!==e.source&&"string"!=typeof e.source);return!n&&t&&Core.Log.warning("IFlowConnectionReferences.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(yt||(yt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.value||void 0===e.value||Core.Utility.isArray(e.value)&&e.value.every((function(e){return!(null!=e&&(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||"string"!=typeof e.workflowidunique||null!==e.workflowid&&void 0!==e.workflowid&&"string"!=typeof e.workflowid||null!==e.solutionid&&void 0!==e.solutionid&&"string"!=typeof e.solutionid||null!==e.name&&void 0!==e.name&&"string"!=typeof e.name||null!==e.modifiedon&&void 0!==e.modifiedon&&"string"!=typeof e.modifiedon||null!==e.statecode&&void 0!==e.statecode&&"number"!=typeof e.statecode||null!==e.clientdata&&void 0!==e.clientdata&&"string"!=typeof e.clientdata))})));return!n&&t&&Core.Log.warning("ISolutionFlowMetadata.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(mt||(mt={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||null===e.definition||"object"!=typeof e.definition||Object.getPrototypeOf(e.definition)!==Object.prototype||null===e.definition.triggers||"object"!=typeof e.definition.triggers||Object.getPrototypeOf(e.definition.triggers)!==Object.prototype||null!==e.definition.triggers.manual&&void 0!==e.definition.triggers.manual&&(null===e.definition.triggers.manual||"object"!=typeof e.definition.triggers.manual||Object.getPrototypeOf(e.definition.triggers.manual)!==Object.prototype||null!==e.definition.triggers.manual.kind&&void 0!==e.definition.triggers.manual.kind&&"string"!=typeof e.definition.triggers.manual.kind||null!==e.definition.triggers.manual.type&&void 0!==e.definition.triggers.manual.type&&"string"!=typeof e.definition.triggers.manual.type));return!n&&t&&Core.Log.warning("ISolutionFlowClientDataResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(gt||(gt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.value||void 0===e.value||Core.Utility.isArray(e.value)&&e.value.every((function(e){return bt.isValid(e)})));return!n&&t&&Core.Log.warning("IGetFlowMachineGroupsResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(vt||(vt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.flowmachinegroupid&&e.flowmachinegroupid.length>=1&&"string"==typeof e.name&&(null===e.description||void 0===e.description||"string"==typeof e.description);return!n&&t&&Core.Log.warning("IFlowMachineGroup.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(bt||(bt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.resource&&e.resource.length>=1&&(null===e.preventAuthPopUp||void 0===e.preventAuthPopUp||"boolean"==typeof e.preventAuthPopUp)&&(null===e.sendAsBody||void 0===e.sendAsBody||"boolean"==typeof e.sendAsBody)&&(null===e.isDynamicResource||void 0===e.isDynamicResource||"boolean"==typeof e.isDynamicResource);return!n&&t&&Core.Log.warning("IAuthorizationOptions.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(ht||(ht={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.operationName||void 0===e.operationName||"string"==typeof e.operationName&&e.operationName.length>=1)&&(null===e.previousClientRequestId||void 0===e.previousClientRequestId||"string"==typeof e.previousClientRequestId&&e.previousClientRequestId.length>=1);return!n&&t&&Core.Log.warning("ITelemetryOptions.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(At||(At={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.optInMSHeaders||void 0===e.optInMSHeaders||"boolean"==typeof e.optInMSHeaders)&&(null===e.addCustomHeaders||void 0===e.addCustomHeaders||"boolean"==typeof e.addCustomHeaders)&&(null===e.headersToRemove||void 0===e.headersToRemove||Core.Utility.isArray(e.headersToRemove)&&e.headersToRemove.every((function(e){return null==e||"string"==typeof e})));return!n&&t&&Core.Log.warning("ICustomHeadersOptions.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Ct||(Ct={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.serviceType||void 0===e.serviceType||"string"==typeof e.serviceType&&e.serviceType.length>=1);return!n&&t&&Core.Log.warning("IServiceErrorOptions.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Pt||(Pt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.connectionReferences||void 0===e.connectionReferences||Core.Utility.isJsonHashTable(e.connectionReferences)&&HashTableUtility.every(e.connectionReferences,(function(e){return St.isValid(e)})));return!n&&t&&Core.Log.warning("IInstallFlowRequest.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(wt||(wt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.connectionName&&"string"==typeof e.id;return!n&&t&&Core.Log.warning("IApiConnectionReference.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(St||(St={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.iconUri||void 0===e.iconUri||Core.Utility.isAbsoluteUrlString(e.iconUri))&&(null===e.createdBy||void 0===e.createdBy||X.isValid(e.createdBy))&&(null===e.environmentName||void 0===e.environmentName||"string"==typeof e.environmentName)&&(null===e.flowName||void 0===e.flowName||"string"==typeof e.flowName);return!n&&t&&Core.Log.warning("IInstallFlowConnectionMetadata.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Ot||(Ot={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.name||void 0===e.name||"string"==typeof e.name&&e.name.length>=1)&&(null===e.displayName||void 0===e.displayName||"string"==typeof e.displayName&&e.displayName.length>=1)&&(null===e.statuses||void 0===e.statuses||Core.Utility.isArray(e.statuses)&&e.statuses.every((function(e){return Q.isValid(e)})))&&(null===e.tenantId||void 0===e.tenantId||"string"==typeof e.tenantId)&&(null===e.metadata||void 0===e.metadata||Ot.isValid(e.metadata))&&(null===e.createdTime||void 0===e.createdTime||"string"==typeof e.createdTime)&&(null===e.changedTime||void 0===e.changedTime||"string"==typeof e.changedTime)&&(null===e.nonSecretParameterValues||void 0===e.nonSecretParameterValues||je.isValid(e.nonSecretParameterValues));return!n&&t&&Core.Log.warning("IInstallFlowConnectionProperties.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Rt||(Rt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.connectionId&&(null===e.connection||void 0===e.connection||null!==e.connection&&"object"==typeof e.connection&&Object.getPrototypeOf(e.connection)===Object.prototype&&"string"==typeof e.connection.id&&"string"==typeof e.connection.name&&(null===e.connection.type||void 0===e.connection.type||"string"==typeof e.connection.type)&&(null===e.connection.properties||void 0===e.connection.properties||Rt.isValid(e.connection.properties)));return!n&&t&&Core.Log.warning("IInstallFlowResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(_t||(_t={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||null!==e.ispaienabled&&void 0!==e.ispaienabled&&"boolean"!=typeof e.ispaienabled||null!==e.arePreviewScenarioEnabled&&void 0!==e.arePreviewScenarioEnabled&&"boolean"!=typeof e.arePreviewScenarioEnabled||null!==e.templates&&void 0!==e.templates&&"string"!=typeof e.templates);return!n&&t&&Core.Log.warning("IIsPaiEnabledResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Tt||(Tt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.name&&"boolean"==typeof e.isPreview;return!n&&t&&Core.Log.warning("IIsPaiEnabledResponseTemplate.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(It||(It={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"number"==typeof e.status&&"string"==typeof e.message;return!n&&t&&Core.Log.warning("IJsonErrorResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Et||(Et={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&S.isValid(e.app)&&(null===e.apis||void 0===e.apis||Core.Utility.isArray(e.apis)&&e.apis.every((function(e){return null==e||$.isValid(e)})))&&(null===e.connections||void 0===e.connections||Core.Utility.isArray(e.connections)&&e.connections.every((function(e){return null==e||G.isValid(e)})))&&(null===e.appConnections||void 0===e.appConnections||Core.Utility.isArray(e.appConnections)&&e.appConnections.every((function(e){return null==e||Ae.isValid(e)})))&&(null===e.draftResources||void 0===e.draftResources||null!==e.draftResources&&"object"==typeof e.draftResources&&Object.getPrototypeOf(e.draftResources)===Object.prototype&&"string"==typeof e.draftResources.webPackageUrl)&&(null===e.listAppPackageOperationDetails||void 0===e.listAppPackageOperationDetails||jt.isValid(e.listAppPackageOperationDetails));return!n&&t&&Core.Log.warning("ILaunchAppServerResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Ut||(Ut={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.appPackageDetails||void 0===e.appPackageDetails||D.isValid(e.appPackageDetails))&&(null===e.nestedAppsPackageDetails||void 0===e.nestedAppsPackageDetails||Core.Utility.isArray(e.nestedAppsPackageDetails)&&e.nestedAppsPackageDetails.every((function(e){return null==e||D.isValid(e)})))&&(null===e.packageReturnUri||void 0===e.packageReturnUri||"string"==typeof e.packageReturnUri)&&(null===e.retryAfter||void 0===e.retryAfter||"string"==typeof e.retryAfter)&&"string"==typeof e.packageStatus&&(null===e.error||void 0===e.error||"string"==typeof e.error);return!n&&t&&Core.Log.warning("IListAppPackageOperationDetailsResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(jt||(jt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Core.Utility.isAbsoluteUrlString(e.value)&&Core.Utility.isAbsoluteUrlString(e.readonlyValue);return!n&&t&&Core.Log.warning("IPackageUri.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Nt||(Nt={})),function(e){function t(t,n){var r=null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===Object.prototype&&(null===t.minimumRequiredApiVersion||void 0===t.minimumRequiredApiVersion||"string"==typeof t.minimumRequiredApiVersion&&t.minimumRequiredApiVersion.length>=1)&&(null===t.webPackageUri||void 0===t.webPackageUri||Nt.isValid(t.webPackageUri))&&(null===t.playerPackageUri||void 0===t.playerPackageUri||Nt.isValid(t.playerPackageUri))&&(null===t.value||void 0===t.value||Core.Utility.isAbsoluteUrlString(t.value))&&(null===t.readonlyValue||void 0===t.readonlyValue||Core.Utility.isAbsoluteUrlString(t.readonlyValue))&&(null===t.appPackageResourcesKind||void 0===t.appPackageResourcesKind||"string"==typeof t.appPackageResourcesKind)&&(null===t.appPackageMetadata||void 0===t.appPackageMetadata||"string"==typeof t.appPackageMetadata)&&(null===t.nestedCanvasApps||void 0===t.nestedCanvasApps||Core.Utility.isArray(t.nestedCanvasApps)&&t.nestedCanvasApps.every((function(t){return null==t||e.isValid(t)})));return!r&&n&&Core.Log.warning("IListAppPackageResponse.isValid","Invalid value."),r}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Dt||(Dt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.assetVersion&&(null===e.customAssetsLinks||void 0===e.customAssetsLinks||Mt.isValid(e.customAssetsLinks))&&(null===e.fillColor||void 0===e.fillColor||"string"==typeof e.fillColor)&&(null===e.buttonColor||void 0===e.buttonColor||"string"==typeof e.buttonColor)&&(null===e.actionButtonHighlight||void 0===e.actionButtonHighlight||"string"==typeof e.actionButtonHighlight)&&(null===e.hyperlinkColor||void 0===e.hyperlinkColor||"string"==typeof e.hyperlinkColor)&&(null===e.headingTextColor||void 0===e.headingTextColor||"string"==typeof e.headingTextColor)&&(null===e.statusBarContentColorMode||void 0===e.statusBarContentColorMode||"string"==typeof e.statusBarContentColorMode)&&(null===e.defaultAppIds||void 0===e.defaultAppIds||Core.Utility.isArray(e.defaultAppIds)&&e.defaultAppIds.every((function(e){return null==e||"string"==typeof e})));return!n&&t&&Core.Log.warning("IMobileCustomBrandingConfig.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Vt||(Vt={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||null!==e.tenantSplashImage&&void 0!==e.tenantSplashImage&&"string"!=typeof e.tenantSplashImage||null!==e.tenantWelcomeImage&&void 0!==e.tenantWelcomeImage&&"string"!=typeof e.tenantWelcomeImage);return!n&&t&&Core.Log.warning("IMobileCustomBrandingImageLinks.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Mt||(Mt={})),function(e){function t(e,t){var n=y.isValid(e)&&(null===e.appId||void 0===e.appId||"string"==typeof e.appId)&&(null===e.appOpenUri||void 0===e.appOpenUri||"string"==typeof e.appOpenUri)&&(null===e.backgroundColor||void 0===e.backgroundColor||"string"==typeof e.backgroundColor)&&(null===e.iconUri||void 0===e.iconUri||"string"==typeof e.iconUri)&&(null===e.navigateUri||void 0===e.navigateUri||"string"==typeof e.navigateUri)&&(null===e.serviceName||void 0===e.serviceName||"string"==typeof e.serviceName)&&(null===e.groupName||void 0===e.groupName||"string"==typeof e.groupName)&&(null===e.groupDisplayName||void 0===e.groupDisplayName||"string"==typeof e.groupDisplayName)&&(null===e.appDescription||void 0===e.appDescription||"string"==typeof e.appDescription);return!n&&t&&Core.Log.warning("IModelAppProperties.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(kt||(kt={})),function(e){function t(e,t){var n=w.isValid(e)&&kt.isValid(e.properties);return!n&&t&&Core.Log.warning("IServerModelAppInfo.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Lt||(Lt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.modifiedOn||void 0===e.modifiedOn||"string"==typeof e.modifiedOn)&&(null===e.modifiedBy||void 0===e.modifiedBy||"string"==typeof e.modifiedBy)&&(null===e.environmentId||void 0===e.environmentId||"string"==typeof e.environmentId)&&Core.Utility.isArray(e.currencyAllocations)&&e.currencyAllocations.every((function(e){return null==e||xt.isValid(e)}));return!n&&t&&Core.Log.warning("IEnvironmentAllocationsResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Ft||(Ft={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.currencyType&&"number"==typeof e.allocated;return!n&&t&&Core.Log.warning("ICurrencyAllocation.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(xt||(xt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.currencyType&&"number"==typeof e.allocated&&"number"==typeof e.purchased;return!n&&t&&Core.Log.warning("ICurrencyReport.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Ht||(Ht={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.trialType||void 0===e.trialType||"string"==typeof e.trialType)&&(null===e.startDate||void 0===e.startDate||"string"==typeof e.startDate)&&"string"==typeof e.expiryDate&&"number"==typeof e.trialCount&&Core.Utility.isArray(e.trialCurrencyUnits)&&e.trialCurrencyUnits.every((function(e){return null==e||qt.isValid(e)}));return!n&&t&&Core.Log.warning("ITrialResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Bt||(Bt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.currencyType&&"number"==typeof e.trialUnits&&"number"==typeof e.trialConsumedUnits;return!n&&t&&Core.Log.warning("ITrialCurrencyUnit.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(qt||(qt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"boolean"==typeof e.display;return!n&&t&&Core.Log.warning("INpsPromptResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Gt||(Gt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.value||void 0===e.value||Core.Utility.isArray(e.value)&&e.value.every((function(e){return null==e||Wt.isValid(e)})));return!n&&t&&Core.Log.warning("IOrganizationsResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Jt||(Jt={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||null!==e.powerappsmakerbotenabled&&void 0!==e.powerappsmakerbotenabled&&"boolean"!=typeof e.powerappsmakerbotenabled||null!==e.organizationid&&void 0!==e.organizationid&&"string"!=typeof e.organizationid);return!n&&t&&Core.Log.warning("IOrganizationItem.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Wt||(Wt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.BusinessUnitId&&"string"==typeof e.UserId&&"string"==typeof e.OrganizationId;return!n&&t&&Core.Log.warning("IIWhoAmIResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(zt||(zt={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||"string"!=typeof e.id||"string"!=typeof e.type||null!==e.displayName&&void 0!==e.displayName&&"string"!=typeof e.displayName||null!==e.email&&void 0!==e.email&&"string"!=typeof e.email);return!n&&t&&Core.Log.warning("IUserObjectResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Kt||(Kt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&tn.isValid(e.tenant)&&(null===e.activeUserPlans||void 0===e.activeUserPlans||Core.Utility.isArray(e.activeUserPlans)&&e.activeUserPlans.every((function(e){return null==e||nn.isValid(e)})))&&(null===e.expiredUserPlans||void 0===e.expiredUserPlans||Core.Utility.isArray(e.expiredUserPlans)&&e.expiredUserPlans.every((function(e){return null==e||nn.isValid(e)})))&&(null===e.graphTenantDetails||void 0===e.graphTenantDetails||Core.Utility.isArray(e.graphTenantDetails)&&e.graphTenantDetails.every((function(e){return null==e||rn.isValid(e)})))&&(null===e.enrollmentOptions||void 0===e.enrollmentOptions||Qt.isValid(e.enrollmentOptions));return!n&&t&&Core.Log.warning("IEnrollResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Xt||(Xt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&null!==e.powerApps&&"object"==typeof e.powerApps&&Object.getPrototypeOf(e.powerApps)===Object.prototype&&"string"==typeof e.powerApps.promotionalEmailOption;return!n&&t&&Core.Log.warning("IEnrollmentOptionsResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Qt||(Qt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.value||void 0===e.value||Core.Utility.isArray(e.value)&&e.value.every((function(e){return null==e||Zt.isValid(e)})));return!n&&t&&Core.Log.warning("IOptInCountryResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}($t||($t={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.countryCode&&"string"==typeof e.countryDisplayName&&"string"==typeof e.defaultOptIn;return!n&&t&&Core.Log.warning("IOptInCountryResponseDetails.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Zt||(Zt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.PowerApps||void 0===e.PowerApps||null!==e.PowerApps&&"object"==typeof e.PowerApps&&Object.getPrototypeOf(e.PowerApps)===Object.prototype);return!n&&t&&Core.Log.warning("IOptInUserConsentData.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Yt||(Yt={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.PromotionalEmailOption;return!n&&t&&Core.Log.warning("IOptInUserConsentDataDetails.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(en||(en={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"boolean"==typeof e.isTenantWhitelisted;return!n&&t&&Core.Log.warning("IEnrollResponseTenant.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(tn||(tn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.id||void 0===e.id||"string"==typeof e.id)&&(null===e.name||void 0===e.name||"string"==typeof e.name)&&on.isValid(e.properties);return!n&&t&&Core.Log.warning("IEnrollResponsePlanDetails.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(nn||(nn={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||null!==e.city&&void 0!==e.city&&"string"!=typeof e.city||null!==e.countryLetterCode&&void 0!==e.countryLetterCode&&"string"!=typeof e.countryLetterCode);return!n&&t&&Core.Log.warning("IEnrollResponseGraphTenantDetails.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(rn||(rn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.capabilityStatus&&"string"==typeof e.licenseName&&"string"==typeof e.licenseSku&&"boolean"==typeof e.isTrial&&an.isValid(e.policies);return!n&&t&&Core.Log.warning("IEnrollResponsePlanDetailProperties.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(on||(on={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.accessPremiumApis||void 0===e.accessPremiumApis||"boolean"==typeof e.accessPremiumApis)&&(null===e.accessOnPremGateway||void 0===e.accessOnPremGateway||"boolean"==typeof e.accessOnPremGateway)&&(null===e.canUseCustomApis||void 0===e.canUseCustomApis||"boolean"==typeof e.canUseCustomApis)&&(null===e.canAccessNonDefaultEnvironments||void 0===e.canAccessNonDefaultEnvironments||"boolean"==typeof e.canAccessNonDefaultEnvironments)&&(null===e.additionalAllowedPremiumApis||void 0===e.additionalAllowedPremiumApis||Core.Utility.isArray(e.additionalAllowedPremiumApis)&&e.additionalAllowedPremiumApis.every((function(e){return null==e||"string"==typeof e})));return!n&&t&&Core.Log.warning("IEnrollResponsePlanDetailPolicies.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(an||(an={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.id&&e.id.length>=1&&"string"==typeof e.name&&e.name.length>=1&&"string"==typeof e.type&&e.type.length>=1;return!n&&t&&Core.Log.warning("IUserFeatureResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(sn||(sn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.value||void 0===e.value||Core.Utility.isArray(e.value)&&e.value.every((function(e){return null==e||sn.isValid(e)})));return!n&&t&&Core.Log.warning("IUserFeaturesResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(cn||(cn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.value||void 0===e.value||Core.Utility.isArray(e.value)&&e.value.every((function(e){return null==e||nn.isValid(e)})));return!n&&t&&Core.Log.warning("ICheckPlansResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(un||(un={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.value||void 0===e.value||Core.Utility.isArray(e.value)&&e.value.every((function(e){return null==e||nn.isValid(e)})));return!n&&t&&Core.Log.warning("IPlansResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(pn||(pn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"boolean"==typeof e.UpdateNeeded&&Core.Utility.isAbsoluteUrlString(e.iOSUpdateLink)&&Core.Utility.isAbsoluteUrlString(e.WindowsUpdateLink)&&Core.Utility.isAbsoluteUrlString(e.AndroidUpdateLink);return!n&&t&&Core.Log.warning("IUpdateVersion.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(ln||(ln={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&null!==e.error&&"object"==typeof e.error&&Object.getPrototypeOf(e.error)===Object.prototype&&"string"==typeof e.error.code&&"string"==typeof e.error.message;return!n&&t&&Core.Log.warning("IResourceProviderResponseError.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(dn||(dn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.code||void 0===e.code||"string"==typeof e.code)&&"string"==typeof e.message&&(null===e.details||void 0===e.details||Core.Utility.isArray(e.details)&&e.details.every((function(e){return null==e||null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.code||void 0===e.code||"string"==typeof e.code)&&(null===e.message||void 0===e.message||"string"==typeof e.message)})));return!n&&t&&Core.Log.warning("IConnectorResponseError.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(fn||(fn={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||null===e.error||"object"!=typeof e.error||Object.getPrototypeOf(e.error)!==Object.prototype||null!==e.error.code&&void 0!==e.error.code&&"number"!=typeof e.error.code||"string"!=typeof e.error.message||null!==e.error.innerError&&void 0!==e.error.innerError&&(null===e.error.innerError||"object"!=typeof e.error.innerError||Object.getPrototypeOf(e.error.innerError)!==Object.prototype||null!==e.error.innerError.message&&void 0!==e.error.innerError.message&&"string"!=typeof e.error.innerError.message));return!n&&t&&Core.Log.warning("IConnectorResponseGatewayError.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(yn||(yn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.validationStatus&&e.validationStatus.length>=1&&(null===e.suggestedName||void 0===e.suggestedName||"string"==typeof e.suggestedName&&e.suggestedName.length>=1)&&(null===e.error||void 0===e.error||null!==e.error&&"object"==typeof e.error&&Object.getPrototypeOf(e.error)===Object.prototype&&(null===e.error.code||void 0===e.error.code||"string"==typeof e.error.code)&&(null===e.error.message||void 0===e.error.message||"string"==typeof e.error.message));return!n&&t&&Core.Log.warning("IValidateAppDisplayNameServerResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(mn||(mn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.expiry&&e.expiry.length>=1&&"string"==typeof e.leaseId&&e.leaseId.length>=1&&(null===e.lessee||void 0===e.lessee||null!==e.lessee&&"object"==typeof e.lessee&&Object.getPrototypeOf(e.lessee)===Object.prototype&&(null===e.lessee.id||void 0===e.lessee.id||"string"==typeof e.lessee.id&&e.lessee.id.length>=1)&&(null===e.lessee.type||void 0===e.lessee.type||"string"==typeof e.lessee.type&&e.lessee.type.length>=1)&&(null===e.lessee.tenantId||void 0===e.lessee.tenantId||"string"==typeof e.lessee.tenantId&&e.lessee.tenantId.length>=1)&&(null===e.lessee.email||void 0===e.lessee.email||"string"==typeof e.lessee.email&&e.lessee.email.length>=1)&&(null===e.lessee.displayName||void 0===e.lessee.displayName||"string"==typeof e.lessee.displayName&&e.lessee.displayName.length>=1)&&(null===e.lessee.userPrincipalName||void 0===e.lessee.userPrincipalName||"string"==typeof e.lessee.userPrincipalName&&e.lessee.userPrincipalName.length>=1));return!n&&t&&Core.Log.warning("IAcquireLeaseServerResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(gn||(gn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.clientIpAddress&&e.clientIpAddress.length>=1;return!n&&t&&Core.Log.warning("IClientIPResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(vn||(vn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.settingName&&e.settingName.length>=1&&"string"==typeof e.settingValue;return!n&&t&&Core.Log.warning("IGlobalConfigSettingResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(bn||(bn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Core.Utility.isArray(e.versions)&&e.versions.every((function(e){return An.isValid(e)}));return!n&&t&&Core.Log.warning("ICanvasStudioVersionsResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(hn||(hn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.displayName&&e.displayName.length>=1&&"string"==typeof e.documentVersion&&e.documentVersion.length>=1&&"string"==typeof e.powerAppsClientVersion&&e.powerAppsClientVersion.length>=1&&(null===e.isPreferredVersion||void 0===e.isPreferredVersion||"boolean"==typeof e.isPreferredVersion);return!n&&t&&Core.Log.warning("ICanvasStudioVersionsResponseVersion.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(An||(An={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.name&&"string"==typeof e.value&&"number"==typeof e.dataType;return!n&&t&&Core.Log.warning("IAppModuleSettingsDetail.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Cn||(Cn={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||null!==e.givenName&&void 0!==e.givenName&&"string"!=typeof e.givenName||null!==e.surname&&void 0!==e.surname&&"string"!=typeof e.surname||null!==e.mail&&void 0!==e.mail&&"string"!=typeof e.mail||null!==e.displayName&&void 0!==e.displayName&&"string"!=typeof e.displayName);return!n&&t&&Core.Log.warning("IGraphUser.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Pn||(Pn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.tenantId&&"string"==typeof e.state&&"string"==typeof e.location&&"string"==typeof e.aadCountryGeo&&"string"==typeof e.dataStorageGeo&&"string"==typeof e.defaultEnvironmentGeo&&"string"==typeof e.aadDataBoundary;return!n&&t&&Core.Log.warning("IBAPTenant.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(wn||(wn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.aadDataBoundary&&"string"==typeof e.location;return!n&&t&&Core.Log.warning("IBAPTenantDataResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Sn||(Sn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.id&&e.id.length>=1&&"string"==typeof e.name&&e.name.length>=1&&"string"==typeof e.type&&e.type.length>=1&&(null===e.location||void 0===e.location||"string"==typeof e.location)&&(null===e.properties||void 0===e.properties||Rn.isValid(e.properties));return!n&&t&&Core.Log.warning("IEnvironmentResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(On||(On={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.displayName||void 0===e.displayName||"string"==typeof e.displayName)&&(null===e.provisioningState||void 0===e.provisioningState||"string"==typeof e.provisioningState)&&(null===e.creationType||void 0===e.creationType||"string"==typeof e.creationType)&&(null===e.sku||void 0===e.sku||"string"==typeof e.sku)&&(null===e.environmentSku||void 0===e.environmentSku||"string"==typeof e.environmentSku)&&(null===e.type||void 0===e.type||"string"==typeof e.type)&&(null===e.isDefault||void 0===e.isDefault||"boolean"==typeof e.isDefault)&&(null===e.createdTime||void 0===e.createdTime||"string"==typeof e.createdTime)&&(null===e.createdBy||void 0===e.createdBy||Kt.isValid(e.createdBy))&&(null===e.lastModifiedBy||void 0===e.lastModifiedBy||Kt.isValid(e.lastModifiedBy))&&(null===e.lastModifiedTime||void 0===e.lastModifiedTime||"string"==typeof e.lastModifiedTime)&&(null===e.permissions||void 0===e.permissions||null!==e.permissions&&"object"==typeof e.permissions&&Object.getPrototypeOf(e.permissions)===Object.prototype)&&(null===e.linkedEnvironmentMetadata||void 0===e.linkedEnvironmentMetadata||Tn.isValid(e.linkedEnvironmentMetadata))&&(null===e.updateCadence||void 0===e.updateCadence||jn.isValid(e.updateCadence))&&(null===e.runtimeEndpoints||void 0===e.runtimeEndpoints||Nn.isValid(e.runtimeEndpoints))&&(null===e.connectedGroups||void 0===e.connectedGroups||Core.Utility.isArray(e.connectedGroups)&&e.connectedGroups.every((function(e){return null==e||_n.isValid(e)})))&&(null===e.cluster||void 0===e.cluster||Dn.isValid(e.cluster))&&(null===e.governanceConfiguration||void 0===e.governanceConfiguration||In.isValid(e.governanceConfiguration));return!n&&t&&Core.Log.warning("IEnvironmentPropertiesResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Rn||(Rn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.displayName||void 0===e.displayName||"string"==typeof e.displayName)&&(null===e.resources||void 0===e.resources||Core.Utility.isArray(e.resources)&&e.resources.every((function(e){return null==e||null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.type||void 0===e.type||"string"==typeof e.type)})));return!n&&t&&Core.Log.warning("IEnvironmentPropertiesConnectedGroup.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(_n||(_n={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||"string"!=typeof e.friendlyName||"string"!=typeof e.uniqueName||"string"!=typeof e.instanceUrl||null!==e.version&&void 0!==e.version&&"string"!=typeof e.version||null!==e.resourceId&&void 0!==e.resourceId&&"string"!=typeof e.resourceId||null!==e.baseLanguage&&void 0!==e.baseLanguage&&"number"!=typeof e.baseLanguage||null!==e.bapSolutionId&&void 0!==e.bapSolutionId&&"string"!=typeof e.bapSolutionId||null!==e.platformSku&&void 0!==e.platformSku&&"string"!=typeof e.platformSku);return!n&&t&&Core.Log.warning("ILinkedEnvironmentMetadata.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Tn||(Tn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.protectionLevel||void 0===e.protectionLevel||"string"==typeof e.protectionLevel)&&(null===e.settings||void 0===e.settings||En.isValid(e.settings));return!n&&t&&Core.Log.warning("IEnvironmentGovernanceConfiguration.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(In||(In={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.extendedSettings||void 0===e.extendedSettings||Un.isValid(e.extendedSettings));return!n&&t&&Core.Log.warning("IGovernanceConfigurationSettings.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(En||(En={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.disableAiGeneratedDescriptions||void 0===e.disableAiGeneratedDescriptions||"string"==typeof e.disableAiGeneratedDescriptions);return!n&&t&&Core.Log.warning("ITagDictionary.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Un||(Un={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.id;return!n&&t&&Core.Log.warning("IEnvironmentCadence.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(jn||(jn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e["microsoft.PowerApps"]||void 0===e["microsoft.PowerApps"]||"string"==typeof e["microsoft.PowerApps"]);return!n&&t&&Core.Log.warning("IRuntimeEndpoints.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Nn||(Nn={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||null!==e.category&&void 0!==e.category&&"string"!=typeof e.category||null!==e.environment&&void 0!==e.environment&&"string"!=typeof e.environment||null!==e.geoShortName&&void 0!==e.geoShortName&&"string"!=typeof e.geoShortName||null!==e.number&&void 0!==e.number&&"string"!=typeof e.number||null!==e.uriSuffix&&void 0!==e.uriSuffix&&"string"!=typeof e.uriSuffix);return!n&&t&&Core.Log.warning("ICluster.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Dn||(Dn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.id&&(null===e.location||void 0===e.location||"string"==typeof e.location)&&"string"==typeof e.name&&(null===e.properties||void 0===e.properties||null!==e.properties&&"object"==typeof e.properties&&Object.getPrototypeOf(e.properties)===Object.prototype&&(null===e.properties.displayName||void 0===e.properties.displayName||"string"==typeof e.properties.displayName)&&(null===e.properties.location||void 0===e.properties.location||"string"==typeof e.properties.location)&&(null===e.properties.environmentSku||void 0===e.properties.environmentSku||"string"==typeof e.properties.environmentSku)&&(null===e.properties.environmentType||void 0===e.properties.environmentType||"string"==typeof e.properties.environmentType)&&(null===e.properties.createdBy||void 0===e.properties.createdBy||Kt.isValid(e.properties.createdBy))&&(null===e.properties.runtimeEndpoints||void 0===e.properties.runtimeEndpoints||Nn.isValid(e.properties.runtimeEndpoints))&&(null===e.properties.linkedEnvironmentMetadata||void 0===e.properties.linkedEnvironmentMetadata||Tn.isValid(e.properties.linkedEnvironmentMetadata))&&(null===e.properties.updateCadence||void 0===e.properties.updateCadence||jn.isValid(e.properties.updateCadence))&&(null===e.properties.cluster||void 0===e.properties.cluster||Dn.isValid(e.properties.cluster))&&(null===e.properties.governanceConfiguration||void 0===e.properties.governanceConfiguration||In.isValid(e.properties.governanceConfiguration)));return!n&&t&&Core.Log.warning("IEnvironmentReference.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Vn||(Vn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.locale&&e.locale.length>=1&&"string"==typeof e.oid&&e.oid.length>=1&&null!==e.environment&&"object"==typeof e.environment&&Object.getPrototypeOf(e.environment)===Object.prototype&&"string"==typeof e.environment.id&&e.environment.id.length>=1&&"string"==typeof e.environment.name&&e.environment.name.length>=1&&(null===e.environment.properties||void 0===e.environment.properties||null!==e.environment.properties&&"object"==typeof e.environment.properties&&Object.getPrototypeOf(e.environment.properties)===Object.prototype&&(null===e.environment.properties.displayName||void 0===e.environment.properties.displayName||"string"==typeof e.environment.properties.displayName&&e.environment.properties.displayName.length>=1)&&(null===e.environment.properties.location||void 0===e.environment.properties.location||"string"==typeof e.environment.properties.location&&e.environment.properties.location.length>=1));return!n&&t&&Core.Log.warning("ILastUsedEnvironmentMetadata.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Mn||(Mn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.solutionid&&"string"==typeof e.uniquename&&(null===e.publisherid||void 0===e.publisherid||null!==e.publisherid&&"object"==typeof e.publisherid&&Object.getPrototypeOf(e.publisherid)===Object.prototype&&"string"==typeof e.publisherid.customizationprefix);return!n&&t&&Core.Log.warning("ISolutionInfo.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(kn||(kn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Core.Utility.isArray(e.value)&&e.value.every((function(e){return null==e||null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.version&&e.version.length>=1}));return!n&&t&&Core.Log.warning("ISolutionVersionResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Ln||(Ln={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.id&&e.id.length>=1&&"string"==typeof e.displayName&&e.displayName.length>=1;return!n&&t&&Core.Log.warning("ITemplateCategoryResponseValue.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Fn||(Fn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Core.Utility.isArray(e.value)&&e.value.every((function(e){return Hn.isValid(e)}));return!n&&t&&Core.Log.warning("ITemplateResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(xn||(xn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.id&&e.id.length>=1&&"string"==typeof e.name&&e.name.length>=1&&Bn.isValid(e.properties);return!n&&t&&Core.Log.warning("ITemplateResponseValue.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Hn||(Hn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&qn.isValid(e.metadata)&&Core.Utility.isArray(e.images)&&e.images.every((function(e){return Gn.isValid(e)}))&&Core.Utility.isArray(e.artifacts)&&e.artifacts.every((function(e){return Wn.isValid(e)}))&&"string"==typeof e.itemDisplayName&&e.itemDisplayName.length>=1&&"string"==typeof e.longSummary;return!n&&t&&Core.Log.warning("ITemplateResponseProperties.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Bn||(Bn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.categories&&e.categories.length>=1&&(null===e.tableNames||void 0===e.tableNames||"string"==typeof e.tableNames&&e.tableNames.length>=1)&&(null===e.preferredNames||void 0===e.preferredNames||"string"==typeof e.preferredNames&&e.preferredNames.length>=1);return!n&&t&&Core.Log.warning("ITemplateResponseMetadata.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(qn||(qn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.context&&e.context.length>=1&&(null===e.items||void 0===e.items||Core.Utility.isArray(e.items)&&e.items.every((function(e){return Jn.isValid(e)})));return!n&&t&&Core.Log.warning("ITemplateResponseImageContext.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Gn||(Gn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.id&&e.id.length>=1&&Core.Utility.isAbsoluteUrlString(e.uri)&&"string"==typeof e.type&&e.type.length>=1;return!n&&t&&Core.Log.warning("ITemplateResponseImage.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Jn||(Jn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.name&&e.name.length>=1&&Core.Utility.isAbsoluteUrlString(e.uri);return!n&&t&&Core.Log.warning("ITemplateResponseArtifact.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Wn||(Wn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.value||void 0===e.value||Core.Utility.isArray(e.value)&&e.value.every((function(e){return null==e||Kn.isValid(e)})));return!n&&t&&Core.Log.warning("ITenants.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(zn||(zn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.tenantId&&e.tenantId.length>=1&&"boolean"==typeof e.isHomeTenant&&"string"==typeof e.countryCode&&e.countryCode.length>=1&&"string"==typeof e.displayName&&e.displayName.length>=1&&"string"==typeof e.defaultDomain&&e.defaultDomain.length>=1&&"string"==typeof e.tenantType&&e.tenantType.length>=1;return!n&&t&&Core.Log.warning("ITenant.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Kn||(Kn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Core.Utility.isArray(e.docServerTestProfiles)&&e.docServerTestProfiles.every((function(e){return null==e||Qn.isValid(e)}));return!n&&t&&Core.Log.warning("ITestProfile.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Xn||(Xn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.name&&Zn.isValid(e.settings)&&Core.Utility.isArray(e.variants)&&e.variants.every((function(e){return null==e||$n.isValid(e)}));return!n&&t&&Core.Log.warning("IDocServerTestProfile.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Qn||(Qn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.name&&Zn.isValid(e.settings);return!n&&t&&Core.Log.warning("IDocServerTestProfileVariant.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}($n||($n={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||null!==e.docServerEndpoint&&void 0!==e.docServerEndpoint&&"string"!=typeof e.docServerEndpoint||null!==e.docServerEnvironment&&void 0!==e.docServerEnvironment&&"string"!=typeof e.docServerEnvironment||null!==e.playerResourcesEndpoint&&void 0!==e.playerResourcesEndpoint&&"string"!=typeof e.playerResourcesEndpoint);return!n&&t&&Core.Log.warning("IDocServerTestProfileSettings.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Zn||(Zn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.name&&"string"==typeof e.id&&"string"==typeof e.type&&(null===e.location||void 0===e.location||"string"==typeof e.location)&&(null===e.appModuleSettings||void 0===e.appModuleSettings||Core.Utility.isArray(e.appModuleSettings)&&e.appModuleSettings.every((function(e){return null==e||Cn.isValid(e)})))&&er.isValid(e.properties);return!n&&t&&Core.Log.warning("IUnifiedAppInfo.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(Yn||(Yn={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.logicalName||void 0===e.logicalName||"string"==typeof e.logicalName)&&(null===e.displayName||void 0===e.displayName||"string"==typeof e.displayName)&&(null===e.description||void 0===e.description||"string"==typeof e.description)&&(null===e.icons||void 0===e.icons||tr.isValid(e.icons))&&(null===e.environment||void 0===e.environment||Vn.isValid(e.environment))&&(null===e.metadata||void 0===e.metadata||"string"==typeof e.metadata)&&(null===e.lastModifiedTime||void 0===e.lastModifiedTime||"string"==typeof e.lastModifiedTime)&&(null===e.lastOpenedTime||void 0===e.lastOpenedTime||"string"==typeof e.lastOpenedTime)&&(null===e.appOpenUri||void 0===e.appOpenUri||"string"==typeof e.appOpenUri)&&(null===e.owner||void 0===e.owner||"string"==typeof e.owner);return!n&&t&&Core.Log.warning("IUnifiedAppProperties.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(er||(er={})),function(e){function t(e,t){var n=!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||null!==e.smallIconUri&&void 0!==e.smallIconUri&&"string"!=typeof e.smallIconUri||null!==e.mediumIconUri&&void 0!==e.mediumIconUri&&"string"!=typeof e.mediumIconUri||null!==e.largeIconUri&&void 0!==e.largeIconUri&&"string"!=typeof e.largeIconUri||null!==e.wideIconUri&&void 0!==e.wideIconUri&&"string"!=typeof e.wideIconUri);return!n&&t&&Core.Log.warning("IUnifiedAppIcons.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(tr||(tr={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Core.Utility.isArray(e.value)&&e.value.every((function(e){return null==e||rr.isValid(e)}));return!n&&t&&Core.Log.warning("IVersionHistory.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(nr||(nr={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.isLive||void 0===e.isLive||"boolean"==typeof e.isLive)&&(null===e.tags||void 0===e.tags||or.isValid(e.tags))&&(null===e.properties||void 0===e.properties||ir.isValid(e.properties));return!n&&t&&Core.Log.warning("IVersion.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(rr||(rr={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.publisherVersion||void 0===e.publisherVersion||"string"==typeof e.publisherVersion);return!n&&t&&Core.Log.warning("IVersionTag.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(or||(or={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.appVersion||void 0===e.appVersion||"string"==typeof e.appVersion)&&(null===e.appDefinition||void 0===e.appDefinition||ar.isValid(e.appDefinition));return!n&&t&&Core.Log.warning("IVersionProperties.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(ir||(ir={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.properties||void 0===e.properties||sr.isValid(e.properties));return!n&&t&&Core.Log.warning("IVersionAppDefinition.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(ar||(ar={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.lastModifiedBy||void 0===e.lastModifiedBy||cr.isValid(e.lastModifiedBy))&&(null===e.commitMessage||void 0===e.commitMessage||"string"==typeof e.commitMessage);return!n&&t&&Core.Log.warning("IVersionAppProperties.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(sr||(sr={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(null===e.displayName||void 0===e.displayName||"string"==typeof e.displayName);return!n&&t&&Core.Log.warning("IVersionTimestamp.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(cr||(cr={})),function(e){function t(e,t){var n=null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&"string"==typeof e.access_token&&e.access_token.length>=1&&"string"==typeof e.expires_on&&e.expires_on.length>=1&&"string"==typeof e.refresh_token&&e.refresh_token.length>=1;return!n&&t&&Core.Log.warning("IWebAuthenticationResponse.isValid","Invalid value."),n}e.safeCast=function(e){return t(e,!0)?e:null},e.isValid=function(e){return t(e,!1)}}(ur||(ur={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"GalleryItem",(function(){return r})),n.d(t,"GalleryItemTypes",(function(){return o})),n.d(t,"PowerAppEndpoints",(function(){return i})),n.d(t,"PowerAppsPackageDefaultValues",(function(){return a})),n.d(t,"PowerAppsTemplateProperties",(function(){return s})),n.d(t,"TemplateTags",(function(){return c})),n.d(t,"AppModuleSettingsKeys",(function(){return u})),n.d(t,"Publish",(function(){return p})),n.d(t,"ProtocolHandler",(function(){return l})),n.d(t,"Notification",(function(){return d})),n.d(t,"idTokenKey",(function(){return b})),n.d(t,"favoriteValue",(function(){return h})),n.d(t,"PowerAppsAppNameKey",(function(){return A})),n.d(t,"PowerAppsSaveDisplayNameConflictError",(function(){return C})),n.d(t,"PowerAppsNextLink",(function(){return P})),n.d(t,"GetAppExpandParameters",(function(){return y})),n.d(t,"ListAppExpandParameters",(function(){return m})),n.d(t,"ListAppFilterParameters",(function(){return g})),n.d(t,"AppTypesFromRP",(function(){return v})),n.d(t,"RPAppTypeByIndex",(function(){return O})),n.d(t,"UnifiedAppTypes",(function(){return w})),n.d(t,"ParameterHintNames",(function(){return S})),n.d(t,"hiddenParametersTag",(function(){return _})),n.d(t,"APIs",(function(){return R})),n.d(t,"PowerAppsRpInvokeHeader",(function(){return U})),n.d(t,"PowerAppsRpBaseUrlSuffix",(function(){return j})),n.d(t,"PowerAppsRpBaseGccUrlSuffix",(function(){return N})),n.d(t,"ApimInvokeHeader",(function(){return D})),n.d(t,"ApimInvokeRequestMethodHeader",(function(){return V})),n.d(t,"ApimInvokeUrlPath",(function(){return M})),n.d(t,"ApimBaseUrlSuffix",(function(){return k})),n.d(t,"ApiHubBaseUrlSuffix",(function(){return L})),n.d(t,"ApimBaseGccUrlSuffix",(function(){return F})),n.d(t,"ApimFirstSegment",(function(){return x})),n.d(t,"BadRpBaseUrlSuffix",(function(){return H})),n.d(t,"PowerPlatformBaseUrlSuffix",(function(){return B})),n.d(t,"PowerPlatformGccBaseUrlSuffix",(function(){return q})),n.d(t,"Links",(function(){return T})),n.d(t,"EmbeddedAppTypes",(function(){return I})),n.d(t,"CapabilityStatus",(function(){return E})),n.d(t,"CdsDefaultWebApiVersion",(function(){return W})),n.d(t,"AlmModeFromRP",(function(){return G})),n.d(t,"TabularActions",(function(){return J}));var r,o,i,a,s,c,u,p,l,d,f=n(0);!function(e){e.galleryIdKey="galleryId",e.versionKey="version",e.gallerySourceKey="gallerySource",e.instanceIdKey="instanceId"}(r||(r={})),function(e){e.sienaAppType="SienaApp",e.powerAppType="PowerApp"}(o||(o={})),function(e){e.getApiVersion=function(){return Object(f.isWebPlayer)()||Object(f.isReactNativePlayer)()||Object(f.isWebAuthoring)()?"2020-06-01":"2018-10-01"},e.getEnvironmentPermissionExpandQueryParam=function(e){return e>="2019-05-01"?"properties.permissions":"Permissions"},e.getCdmRpApiVersion=function(){return"2016-11-01"},e.getCuratedApiVersion=function(){return"2021-02-01"},e.powerPlatformApiVersion="1",e.powerPlatformSafePublishApiVersion="3",e.paRpInvokeUrl="api/invoke",e.appVersionKey="versionstring",e.providers="providers/Microsoft.PowerApps",e.generateTransientStorageValue="generateTransientStorage",e.generateResourceStorageValue="generateResourceStorage",e.apiVersionKey="api-version",e.objectIdsValue="objectIds",e.appsValue="apps",e.unifiedAppsValue="unifiedApps",e.sessions="sessions",e.displayName="displayName",e.updateDisplayName="updateDisplayName",e.validateAppDisplayName="validateAppDisplayName",e.versions="versions",e.globalAppsValue="globalApps",e.curatedAppsValue="curatedApps",e.entitiesFolderName="entities",e.listPackageValue="listPackage",e.roleAssignmentsValue="roleAssignments",e.noCacheKey="nc",e.retrieveConsentLinks="listLoginUris",e.listApplicationCategoriesValue="listApplicationCategories",e.appPermission="permissions",e.serverSession="initiateDocumentServerSession",e.refreshServerSession="refreshDocumentServerSession",e.tenantPrefix="tenant-",e.trialConsentPath="trial",e.redirectQueryParam="redirect",e.authoringRedirectQueryValue="authoring",e.playerRedirectQueryValue="player",e.blockingEnrollCallQueryParam="_blocking",e.actionQueryParam="action",e.appSourceTrialQueryParamValue="AppSourceTrial",e.pollQueryParam="_poll",e.refreshCacheQueryParam="refreshCache",e.environmentsValue="environments",e.instancesValue="instances",e.solutionsValue="solutions",e.componentsValue="components",e.organizationSettingsValue="organizationsettings",e.apiConsumptionInterval=3e5,e.checkPrivileges="checkPrivileges",e.excludeQueryParam="exclude",e.excludeSolutionFlowQueryParamValue="excludeSolutionCloudFlows",function(e){e.publishValue="publish",e.packageValue="package",e.setFavoriteValue="setFavorite",e.unsetFavoriteValue="unsetFavorite",e.clientMetadata="clientinfo/clientmetadata",e.acquireLeaseValue="acquireLease",e.releaseLeaseValue="releaseLease",e.healthCheck="healthcheck",e.portalHome="home",e.customBrandingAssets="customAssets/default",e.checkComponentUpdates="checkComponentUpdates",e.makeSolutionAware="makeSolutionAware",e.componentDependencies="componentDependencies",e.startSession="startSession",e.endSession="endSession",e.refreshSession="refreshSession",e.getSessions="sessions",e.getAppExtendedMetadata="getAppExtendedMetadata"}(e.UrlPaths||(e.UrlPaths={}))}(i||(i={})),function(e){e.author="",e.appVersion="1.0.0.0",e.sienaVersion="0000",e.publisherVersion="0.0.0",e.minimumRequiredApiVersion="0.0.0",e.backgroundImageUrl="https://sienatestappgallery.blob.core.windows.net/backgroundimagegallery/0f94216f-6b09-410e-a6c3-3f5a73aaccd6_1701458968_V1.0.1.png",e.backgroundColor="RGBA(0, 176, 240, 1)",e.blobDocumentName="document.msapp",e.blobPackageName="player.msappk",e.blobAssetsName="assets.zip",e.blobLogoSmallName="logoSmallFile",e.blobStableControlIdentityName="identity.json",e.blobWebPlayerRootFolder="web-player/",e.blobWebPlayerIndexFile="index.web.html",e.blobWebPlayerManifestFile="manifest.json",e.galleryItemSource="https://www.microsoft.com"}(a||(a={})),function(e){e.parametersKey="parameters",e.descriptionJsonPointer="/properties/description",e.documentUriJsonPointer="/properties/outputs/documentUri/value",e.playerPackageUriJsonPointer="/properties/outputs/playerPackageUri/value",e.wadlUrisJsonPointer="/properties/outputs/wadlUris/value"}(s||(s={})),function(e){e.backgroundColor="backgroundColor",e.displayName="displayName",e.publisher="publisher",e.sienaVersion="sienaVersion",e.publisherVersion="publisherVersion",e.minimumRequiredApiVersion="minimumRequiredApiVersion",e.deviceCapabilities="deviceCapabilities",e.hasComponent="hasComponent",e.hasUnlockedComponent="hasUnlockedComponent",e.isHidden="isHidden",e.isUnifiedRootApp="isUnifiedRootApp",e.templateId="templateId",e.optimizedForTeamsMeeting="optimizedForTeamsMeeting",e.coauthoringEnabled="coauthoringEnabled",e.imageUrl="imageUrl",e.originalImageUrl="originalImageUrl",e.supportsPortrait="supportsPortrait",e.supportsLandscape="supportsLandscape",e.primaryDeviceWidth="primaryDeviceWidth",e.primaryDeviceHeight="primaryDeviceHeight",e.primaryFormFactor="primaryFormFactor",e.localConnectionReferencesJSON="localConnectionReferencesJSON",e.sharePointSiteId="sp-site-id",e.sharePointListId="sp-list-id",e.iconSetting="iconSetting",e.backgroundFillSetting="backgroundFillSetting",e.offlineProfileId="offlineProfileId",e.offlineLargeFilesSupport="offlineLargeFilesSupport",e.showStatusBar="showStatusBar"}(c||(c={})),function(e){e.ChannelAvailability="ChannelAvailability",e.LaunchNativeExperience="LaunchNativeExperience"}(u||(u={})),function(e){e.defaultPackageFileName="player.msappk",e.defaultDocumentFileName="doc.msapp",e.defaultAssetsFileName="assets.zip",e.defaultLogoSmallFileName="powerAppLogoSmall"}(p||(p={})),function(e){e.docDownloadUrlKey="docDownloadUrl"}(l||(l={})),function(e){!function(e){e.gcmSenderId="233986630110"}(e.Prod||(e.Prod={})),function(e){e.gcmSenderId="845762260408"}(e.TestInProd1||(e.TestInProd1={})),function(e){e.gcmSenderId="845762260408"}(e.TestInProd2||(e.TestInProd2={})),function(e){e.gcmSenderId="845762260408"}(e.WebAuthTest||(e.WebAuthTest={})),function(e){e.gcmSenderId="233986630110"}(e.WebAuthProd||(e.WebAuthProd={})),e.registerDeviceApi="registerDeviceNotifications",e.registerDevicePowerPlatformApi="pushNotifications/register",e.unregisterDeviceApi="unregisterDeviceNotifications",e.unregisterDevicePowerPlatformApi="pushNotifications/unregister",e.sendTestNotification="sendTestNotification"}(d||(d={}));var y,m,g,v,b="idToken",h="Favorite",A="appName",C="ApplicationDisplayNameIsInUse",P="nextLink";!function(e){e.EnvironmentDisplayName="environment.DisplayName",e.UnpublishedAppDefinition="unpublishedAppDefinition",e.UserConsent="consent"}(y||(y={})),function(e){e.Metadata="metadata",e.Environment="environment"}(m||(m={})),function(e){e.SupportsMobileCapability="supportsMobileCapability eq 'true'",e.ClassificationFilterUnformatted="classification eq '{0}'"}(g||(g={})),function(e){e.ClassicCanvasApp="ClassicCanvasApp",e.AppComponentLibrary="AppComponentLibrary",e.CustomCanvasPage="CustomCanvasPage",e.UnifiedApp="UnifiedApp"}(v||(v={}));var w,S,O=[v.ClassicCanvasApp,v.AppComponentLibrary,v.CustomCanvasPage,v.UnifiedApp];!function(e){e.CanvasApp="CanvasApp",e.AppModule="AppModule"}(w||(w={})),function(e){e.msFlowWorkflowName="workflowName",e.msWorkflowEntityId="workflowEntityId",e.msWorkflowDisplayName="workflowDisplayName"}(S||(S={}));var R,_="__hiddenParameters";!function(e){e.checkPlans="checkPlans",e.plans="plans",e.features="features",e.tenants="tenants"}(R||(R={}));var T,I,E,U="x-ms-path-query",j="api.powerapps.com",N="api.powerapps.us",D="x-ms-request-url",V="x-ms-request-method",M="invoke",k=".azure-apim.net",L=".azure-apihub.net",F=".azure-apihub.us",x="apim",H="api.businessappdiscovery.microsoft.com",B=".powerplatform.com",q=".powerplatform.microsoft.us";!function(e){e.ConnectorMoreInfoDefaultLink="https://go.microsoft.com/fwlink/?linkid=851284"}(T||(T={})),function(e){e.SharepointFormApp="SharepointFormApp",e.TeamsApp="TeamsApp"}(I||(I={})),function(e){e.Enabled="Enabled",e.Expired="Expired"}(E||(E={}));var G,J,W="v9.0";!function(e){e.Environment="Environment",e.Solution="Solution",e.NotSpecified="NotSpecified"}(G||(G={})),function(e){e.Read="providers/PowerPlatform.Governance/Operations/Read",e.Write="providers/PowerPlatform.Governance/Operations/Write",e.Delete="providers/PowerPlatform.Governance/Operations/Delete"}(J||(J={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"HeaderName",(function(){return r})),n.d(t,"HeaderValue",(function(){return o})),n.d(t,"HttpStatusCode",(function(){return i})),n.d(t,"Method",(function(){return a})),n.d(t,"KnownMethods",(function(){return l})),n.d(t,"MediaType",(function(){return s})),n.d(t,"ContentDispositionType",(function(){return c})),n.d(t,"XhrReadyState",(function(){return u})),n.d(t,"FailureCauses",(function(){return p}));var r,o,i,a;n(0);!function(e){e.Accept="Accept",e.AcceptLanguage="Accept-Language",e.Authorization="Authorization",e.ContentDisposition="Content-Disposition",e.ContentType="Content-Type",e.ContentLength="Content-Length",e.IfMatch="If-Match",e.IfNoneMatch="If-None-Match",e.SoapAction="SOAPAction",e.ETag="ETag",e.Location="Location",e.CacheControl="Cache-Control",e.Date="Date",e.RetryAfter="Retry-After",e.OperationLocation="Operation-Location",e.MsClientRequestId="x-ms-client-request-id",e.MsClientSessionId="x-ms-client-session-id",e.MsCorrelationId="x-ms-correlation-id",e.MsDocServerEndpoint="x-ms-docserver-endpoint",e.MsDocServerEnvironment="x-ms-docserver-environment",e.PowerAppsConnectorProtocolSemantics="x-ms-protocol-semantics",e.MsClientEnvironmentId="x-ms-client-environment-id",e.MsClientTenantId="x-ms-client-tenant-id",e.MsClientObjectId="x-ms-client-object-id",e.MsClientAppId="x-ms-client-app-id",e.MsClientAppVersion="x-ms-client-app-version",e.MsSessionState="x-ms-session-state",e.MsJoinSessionToken="x-ms-join-session-token",e.MsRequestId="x-ms-request-id",e.MsCorrelationRequestId="x-ms-correlation-request-id",e.MsRoutingRequestId="x-ms-routing-request-id",e.MsFailureCause="x-ms-failure-cause",e.MsErrorType="x-ms-error-type",e.MsDavExtendedError="X-MSDAVEXT_Error",e.SharePointRequestId="SPRequestGuid",e.MsDomainName="x-ms-domain-name",e.MsUserAgent="x-ms-user-agent",e.MsSasDuration="x-ms-app-sas-duration",e.PAClientHeaderPrefix="x-ms-pa-client-",e.EnvironmentName="x-ms-environment-name",e.EnvironmentUpdateCadence="x-ms-environment-update-cadence",e.AppNameName="x-ms-app-name",e.TelemetryOptions=e.PAClientHeaderPrefix+"telemetry-options",e.TelemetryAdditionalData=e.PAClientHeaderPrefix+"telemetry-additional-data",e.ServiceErrorOptions=e.PAClientHeaderPrefix+"service-error-options",e.CustomHeadersOptions=e.PAClientHeaderPrefix+"custom-headers-options",e.MsRtsAuthorizationRequestId="x-ms-rts-authorization-request-id",e.Consistency="Consistency",e.CdsAutoDisassociate="AutoDisassociate",e.CdsNativeRequestId="Request-Id",e.CdsNativeClientSessionId="Client-Session-Id",e.CdsNativeAppId="x-ms-app-id",e.DiagnosticContext="x-ms-diagnostics-context",e.PowerAppsOrigin="x-ms-pa-origin",e.CdsLogicalNameForMdl="x-ms-mdl-etn-name",e.MimeTypeForMdl="x-ms-mdl-mimeType",e.FileSizeForMdl="x-ms-mdl-fileSize",e.FileUrlForMdl="x-ms-mdl-fileUrl",e.ServiceNamespace="ServiceNamespace",e.BatchedRequestMethod="BatchedRequestMethod",e.WwwAuthHeader="www-authenticate",e.ExecRestrictionsValidatedVer="x-ms-exec-restrictions-validated",e.SharedConnectionId="x-ms-shared-connection-id",e.WorkflowId="x-ms-workflow-id",e.WorkflowName="x-ms-workflow-name",e.ServerCodeRepoName="Server-Code-Repo-Name"}(r||(r={})),function(e){e.MatchAll="*",e.NoCache="no-cache",e.NoStore="no-store",e.NoCacheNoStore="no-cache, no-store",e.PowerAppsConnectorProtocolSemanticsValue="cdp",e.ConsistencyStrong="Strong"}(o||(o={})),function(e){e.XhrRequestIncomplete=0,e.Continue=100,e.SwitchingProtocols=101,e.Ok=200,e.ContentAdded=201,e.Accepted=202,e.NonAuthoritativeInformation=203,e.NoContent=204,e.ResetContent=205,e.PartialContent=206,e.MultipleChoices=300,e.Ambiguous=300,e.MovedPermanently=301,e.Moved=301,e.Found=302,e.Redirect=302,e.SeeOther=303,e.RedirectMethod=303,e.NotModified=304,e.UseProxy=305,e.Unused=306,e.TemporaryRedirect=307,e.RedirectKeepVerb=307,e.BadRequest=400,e.Unauthorized=401,e.PaymentRequired=402,e.Forbidden=403,e.NotFound=404,e.MethodNotAllowed=405,e.NotAcceptable=406,e.ProxyAuthenticationRequired=407,e.RequestTimeout=408,e.Conflict=409,e.Gone=410,e.LengthRequired=411,e.PreconditionFailed=412,e.RequestEntityTooLarge=413,e.RequestUriTooLong=414,e.UnsupportedMediaType=415,e.RequestedRangeNotSatisfiable=416,e.ExpectationFailed=417,e.Locked=423,e.UpgradeRequired=426,e.TooManyRequests=429;var t=[e.BadRequest,e.Unauthorized,e.PaymentRequired,e.Forbidden,e.NotFound,e.MethodNotAllowed,e.NotAcceptable,e.ProxyAuthenticationRequired,e.RequestTimeout,e.Conflict,e.Gone,e.LengthRequired,e.PreconditionFailed,e.RequestEntityTooLarge,e.RequestUriTooLong,e.UnsupportedMediaType,e.RequestedRangeNotSatisfiable,e.ExpectationFailed,e.Locked,e.UpgradeRequired];e.InternalServerError=500,e.NotImplemented=501,e.BadGateway=502,e.ServiceUnavailable=503,e.GatewayTimeout=504,e.HttpVersionNotSupported=505,e.ApiHubTokenExchangeError=520;var n=[e.InternalServerError,e.NotImplemented,e.BadGateway,e.ServiceUnavailable,e.GatewayTimeout,e.HttpVersionNotSupported];e.CommonRetryableErrorCodes=[e.RequestTimeout,e.Conflict,e.InternalServerError,e.BadGateway,e.ServiceUnavailable,e.GatewayTimeout,e.TooManyRequests],e.isClientErrorCode=function(e){return t.indexOf(e)>-1},e.isServerErrorCode=function(e){return n.indexOf(e)>-1}}(i||(i={})),function(e){e.GET="GET",e.HEAD="HEAD",e.POST="POST",e.PUT="PUT",e.PATCH="PATCH",e.DELETE="DELETE"}(a||(a={}));var s,c,u,p,l=[a.GET,a.HEAD,a.POST,a.PUT,a.PATCH,a.DELETE];!function(e){e.All="*/*",e.Text="text",e.TextHtml="text/html",e.TextJavascript="text/javascript",e.TextPlain="text/plain",e.TextXml="text/xml",e.ApplicationXHtml="application/xhtml+xml",e.ApplicationXml="application/xml",e.ApplicationJson="application/json",e.ApplicationFormUrlEncoded="application/x-www-form-urlencoded",e.ApplicationOctetStream="application/octet-stream",e.MultipartFormData="multipart/form-data",e.Image="image",e.Audio="audio",e.Video="video"}(s||(s={})),function(e){e.Attachment="attachment",e.FormData="form-data",e.Inline="inline"}(c||(c={})),function(e){e[e.Unsent=0]="Unsent",e[e.Opened=1]="Opened",e[e.HeadersReceived=2]="HeadersReceived",e[e.Loading=3]="Loading",e[e.Done=4]="Done"}(u||(u={})),function(e){e.ApiHubTokenExchange="apihub-token-exchange"}(p||(p={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"PowerAppsUtility",(function(){return g}));var r=n(0),o=n(16),i=n(17),a=n(3),s=n(8),c=n(43),u=n(2),p=n(21),l=n(171),d=n(51),f=n(18),y=n(11),m=n(35),g=function(){function e(){}return e.tryGetDocumentServerEndpointHeader=function(){var e=o.Region.getCurrentRegion();if(Core.FeatureGates.services.packageWithDocServerEndpointHeader){if(e.useCustomDocServerPackager){var t=e.docServerEndpoint.toString();return"/"===t.substr(-1)&&(t=t.substr(0,t.length-1)),{headerName:a.HeaderName.MsDocServerEndpoint,value:t}}}else if(e.docServerRegion)return{headerName:a.HeaderName.MsDocServerEnvironment,value:e.docServerRegion};return null},e.getPowerAppsTransientStorageUrl=function(t){var n=Core.Environment.usePowerPlatformApi()?e.createPowerPlatformPowerAppsUrlBuilder():e.createPowerAppsObjectUrlBuilder(t);return n.appendPath(u.PowerAppEndpoints.generateResourceStorageValue),n.toUrl()},e.getBaseUrl=function(){return e._regionalRPBaseUrl?e._regionalRPBaseUrl:o.Region.getCurrentRegion().powerAppsRpBaseUrl},e.getPowerPlatformRpBaseUrl=function(){return o.Region.getCurrentRegion().powerPlatformRpBaseUrl},e.getPowerPlatformApiVersion=function(){return o.Region.getCurrentRegion().powerPlatformRpApiVersion},e.getBaseFlowUrl=function(){return o.Region.getCurrentRegion().flowRPBaseUrl},e.getBaseFlowPortalUrl=function(){return o.Region.getCurrentRegion().flowPortalBaseUrl},e.getBadBaseUrl=function(){return o.Region.getCurrentRegion().powerAppsBadBaseUrl},e.getApiVersion=function(){return o.Region.getCurrentRegion().powerAppsApiVersion},e.getCuratedApiVersion=function(){return u.PowerAppEndpoints.getCuratedApiVersion()},e.getPowerAppsResourceName=function(){return Core.Environment.usePowerPlatformApi()?s.d.PowerPlatformService:s.d.PowerAppsService},e.getPowerAppsServiceType=function(){return Core.Environment.usePowerPlatformApi()?f.d:f.e},e.getPowerAppsApiVersion=function(){return Core.Environment.usePowerPlatformApi()?e.getPowerPlatformApiVersion():e.getApiVersion()},e.createPowerAppsBaseUrlBuilder=function(){return new r.UrlBuilder(e.getBaseUrl())},e.createPowerAppsProviderUrlBuilder=function(t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var o=t?new r.UrlBuilder("/"):new r.UrlBuilder(e.getBaseUrl());return n||o.appendPath(u.PowerAppEndpoints.providers),o},e.createPowerPlatformTenantUrlBuilder=function(e){return new r.UrlBuilder(o.Region.getCurrentRegion().powerPlatformTenantBaseUrl(e))},e.createPowerAppsTenantUrlBuilder=function(t){var n=e.createPowerPlatformTenantUrlBuilder(t);return n.appendPath("powerapps"),n},e.createPowerPlatformEnvironmentUrlBuilder=function(e){return new r.UrlBuilder(o.Region.getCurrentRegion().powerPlatformEnvironmentBaseUrl(e))},e.createPowerPlatformPowerAppsUrlBuilder=function(t){var n=e.createPowerPlatformEnvironmentUrlBuilder(t);return n.appendPath("powerapps"),n},e.getPublicItemsEndpoint=function(){var t=new r.UrlBuilder(e.getBaseUrl());return t.appendPath(u.PowerAppEndpoints.providers),t.appendPath("galleries/public/items"),t.toUrl()},e.createPowerAppsObjectUrlBuilder=function(t){var n=e.createPowerAppsProviderUrlBuilder();return n.appendPath(u.PowerAppEndpoints.objectIdsValue),n.appendPath(t),n},e.getPowerAppsListCategoriesEndpoint=function(t,n){var r=Core.Environment.usePowerPlatformApi()?e.createPowerAppsTenantUrlBuilder(n):e.createPowerAppsObjectUrlBuilder(t);return r.appendPath(u.PowerAppEndpoints.listApplicationCategoriesValue),r.toUrl()},e.getPowerAppsServerSessionEndpoint=function(t){var n=e.createPowerAppsObjectUrlBuilder(t);return n.appendPath(u.PowerAppEndpoints.serverSession),n.setQueryParam(u.PowerAppEndpoints.apiVersionKey,e.getApiVersion()),n.toUrl()},e.createPowerAppsAppUrlBuilder=function(t){var n=e.createPowerAppsProviderUrlBuilder();return n.appendPath(u.PowerAppEndpoints.appsValue),n.appendPath(t),n},e.createPowerAppsEnvironmentAppUrlBuilder=function(t,n){var r=e.createPowerAppsProviderUrlBuilder();return r.appendPath(u.PowerAppEndpoints.environmentsValue),r.appendPath(n),r.appendPath(u.PowerAppEndpoints.appsValue),r.appendPath(t),r},e.getPowerAppsAppUrl=function(t){return e.createPowerAppsAppUrlBuilder(t).toUrl()},e.createPowerPlatformAppUrlBuilder=function(t,n){var r=e.createPowerPlatformPowerAppsUrlBuilder(n);return r.appendPath(u.PowerAppEndpoints.appsValue),r.appendPath(t),r},e.getPowerPlatformAppUrl=function(t,n){return e.createPowerPlatformAppUrlBuilder(t,n).toUrl()},e.getUnifiedPowerAppsAppUrl=function(t,n){return e._getUnifiedPowerAppsAppUrlBuilder(t,n).toUrl()},e.tryGetPowerPlatformLaunchServiceUrl=function(t){if(!Core.Environment.usePowerPlatformApi())return null;var n=e.createPowerPlatformEnvironmentUrlBuilder(Core.Environment.tryGetEnvironmentName());return n.appendPath("powerapps"),n.appendPath("apps"),n.appendPath(t),n.toUrl()},e._getUnifiedPowerAppsAppUrlBuilder=function(t,n){var r=Core.Environment.usePowerPlatformApi(),o=r?e.createPowerPlatformAppUrlBuilder(n,t):AppMagic.PowerApps.PowerAppsUtility.createPowerAppsProviderUrlBuilder(!1,!0);return r||(o.appendPath(u.PowerAppEndpoints.environmentsValue),o.appendPath(t),o.appendPath(u.PowerAppEndpoints.appsValue),o.appendPath(n)),o},e.getPowerAppsAppId=function(t){var n=e.createPowerAppsProviderUrlBuilder(!0);return n.appendPath(u.PowerAppEndpoints.appsValue),n.appendPath(t),n.toString()},e.getUnifiedPowerAppsListPackageEndpoint=function(t,n){var r=e._getUnifiedPowerAppsAppUrlBuilder(n,t);return r.appendPath(u.PowerAppEndpoints.listPackageValue),r.toUrl()},e.getPowerAppsListPackageEndpoint=function(t){var n=e.createPowerAppsAppUrlBuilder(t);return n.appendPath(u.PowerAppEndpoints.listPackageValue),n.toUrl()},e.parseVersionString=function(e){var t=e.split(".");return{major:parseInt(t[0],10),minor:parseInt(t[1],10),build:parseInt(t[2],10),majorRevision:0,minorRevision:0,revision:0}},e.getPowerAppSetFavoriteEndpoint=function(t){var n=Core.Environment.usePowerPlatformApi()?e.createPowerPlatformAppUrlBuilder(t):e.createPowerAppsAppUrlBuilder(t);return n.appendPath(u.PowerAppEndpoints.UrlPaths.setFavoriteValue),n.toUrl()},e.getPowerAppUnsetFavoriteEndpoint=function(t){var n=Core.Environment.usePowerPlatformApi()?e.createPowerPlatformAppUrlBuilder(t):e.createPowerAppsAppUrlBuilder(t);return n.appendPath(u.PowerAppEndpoints.UrlPaths.unsetFavoriteValue),n.toUrl()},e._createBadApiEndpointUrlBuilder=function(){var t=new r.UrlBuilder(e.getBadBaseUrl());return t.appendPath(d.BadEndpoints.providers),t},e.getEndpointForAppsDiscovery=function(){var t=e._createBadApiEndpointUrlBuilder();return t.appendPath(d.BadEndpoints.apps),t.toUrl()},e.getAppsAndComponentLibrariesEndpoint=function(){var t=e.createPowerAppsProviderUrlBuilder();return t.appendPath(u.PowerAppEndpoints.appsValue),t.toUrl()},e.getAppsAndComponentLibrariesEnvironmentEndpoint=function(t){var n=e.createPowerPlatformPowerAppsUrlBuilder(t);return n.appendPath(u.PowerAppEndpoints.appsValue),n.toUrl()},e.getAppsAndComponentLibrariesTenantEndpoint=function(t){var n=e.createPowerAppsTenantUrlBuilder(t);return n.appendPath(u.PowerAppEndpoints.appsValue),n.toUrl()},e.getPowerAppsGetAppExtendedMetadataEndpoint=function(t,n){var r=Core.Environment.tryGetEnvironmentName(),o=Core.Environment.usePowerPlatformApi()?e.createPowerPlatformAppUrlBuilder(t,r):e.createPowerAppsEnvironmentAppUrlBuilder(t,r);return o.appendPath(u.PowerAppEndpoints.versions),o.appendPath(n),o.appendPath(u.PowerAppEndpoints.UrlPaths.getAppExtendedMetadata),o.setQueryParam(p.ODataConstants.QueryOption.Select,"AppDescription"),o.toUrl()},e.getPowerAppsPublishEndpoint=function(t,n){void 0===n&&(n=!1);var r=Core.Environment.usePowerPlatformApi()||n?e.createPowerPlatformAppUrlBuilder(t):e.createPowerAppsAppUrlBuilder(t);return r.appendPath(u.PowerAppEndpoints.UrlPaths.publishValue),r.toUrl()},e.getPowerAppsPackageEndpoint=function(t){var n=e.createPowerPlatformAppUrlBuilder(t);return n.appendPath(u.PowerAppEndpoints.UrlPaths.packageValue),n.toUrl()},e.getUpdateDisplayNameEndpoint=function(t){var n=Core.Environment.usePowerPlatformApi(),r=n?e.createPowerPlatformAppUrlBuilder(t):e.createPowerAppsAppUrlBuilder(t),o=n?u.PowerAppEndpoints.updateDisplayName:u.PowerAppEndpoints.displayName;return r.appendPath(o),r.toUrl()},e.getValidateAppDisplayNameEndpoint=function(t){var n=Core.Environment.usePowerPlatformApi(),o=n?e.createPowerPlatformPowerAppsUrlBuilder(t):new r.UrlBuilder(e.getBaseUrl()),i=n?e.getPowerPlatformApiVersion():e.getApiVersion();return n||(o.appendUrl(u.PowerAppEndpoints.providers),o.appendUrl(u.PowerAppEndpoints.environmentsValue),o.appendUrl(t)),o.appendUrl(u.PowerAppEndpoints.validateAppDisplayName),o.setQueryParam(u.PowerAppEndpoints.apiVersionKey,i),o.toUrl()},e.getVersionsEndpoint=function(t){var n=Core.Environment.usePowerPlatformApi()?e.createPowerPlatformAppUrlBuilder(t):e.createPowerAppsAppUrlBuilder(t);return n.appendPath(u.PowerAppEndpoints.versions),n.toUrl()},e.getPrivilegesEndpoint=function(t){var n=Core.Environment.usePowerPlatformApi()?e.createPowerPlatformPowerAppsUrlBuilder(t):e.createPowerAppsProviderUrlBuilder();Core.Environment.usePowerPlatformApi()||(n.appendPath(u.PowerAppEndpoints.environmentsValue),n.appendPath(t)),n.appendPath(u.PowerAppEndpoints.checkPrivileges);var r=Core.Environment.usePowerPlatformApi()?e.getPowerPlatformApiVersion():e.getApiVersion();return n.setQueryParam(u.PowerAppEndpoints.apiVersionKey,r),n.toUrl()},e.getUnifiedAppListEndpoint=function(t){var n;return Core.Environment.usePowerPlatformApi()?((n=e.createPowerAppsTenantUrlBuilder(t)).appendPath(u.PowerAppEndpoints.unifiedAppsValue),n.toUrl()):((n=e.createPowerAppsProviderUrlBuilder(!1,!0)).appendPath(u.PowerAppEndpoints.appsValue),n.toUrl())},e.getEnvironmentComponentsEndpoint=function(t){var n=Core.Environment.usePowerPlatformApi(),r=n?e.createPowerPlatformPowerAppsUrlBuilder(t):e.createPowerAppsProviderUrlBuilder();return n||(r.appendPath(u.PowerAppEndpoints.environmentsValue),r.appendPath(t)),r.appendPath(u.PowerAppEndpoints.componentsValue),r.toUrl()},e.getEnvironmentAppComponentsEndpoint=function(t,n){var r=Core.Environment.usePowerPlatformApi(),o=r?e.createPowerPlatformAppUrlBuilder(n,t):e.createPowerAppsProviderUrlBuilder();return r||(o.appendPath(u.PowerAppEndpoints.environmentsValue),o.appendPath(t),o.appendPath(u.PowerAppEndpoints.appsValue),o.appendPath(n)),o.appendPath(u.PowerAppEndpoints.componentsValue),o.toUrl()},e.getSolutionAppsEndpoint=function(t,n){var r=Core.Environment.usePowerPlatformApi()?e.createPowerPlatformPowerAppsUrlBuilder(t):e.createPowerAppsProviderUrlBuilder();return Core.Environment.usePowerPlatformApi()||(r.appendPath(u.PowerAppEndpoints.environmentsValue),r.appendPath(t)),r.appendPath(u.PowerAppEndpoints.solutionsValue),r.appendPath(n),r.appendPath(u.PowerAppEndpoints.appsValue),Core.Environment.usePowerPlatformApi()&&r.setQueryParam(u.PowerAppEndpoints.apiVersionKey,e.getPowerPlatformApiVersion()),r.toUrl()},e.getGlobalAppsEndpoint=function(t){var n=Core.Environment.usePowerPlatformApi()?e.createPowerAppsTenantUrlBuilder(t):e.createPowerAppsProviderUrlBuilder();return n.appendPath(u.PowerAppEndpoints.globalAppsValue),n.toUrl()},e.getCuratedAppsEndpoint=function(t){var n=Core.Environment.usePowerPlatformApi()?e.createPowerAppsTenantUrlBuilder(t):new r.UrlBuilder(e.getBaseUrl());return n.appendPath(u.PowerAppEndpoints.curatedAppsValue),n.toUrl()},e.createMakeSolutionAwareEndpointUrlBuilder=function(t,n){var o=Core.Environment.usePowerPlatformApi(),i=o?e.createPowerPlatformAppUrlBuilder(t,n):new r.UrlBuilder(e.getBaseUrl());return o||(i.appendPath(u.PowerAppEndpoints.providers),i.appendPath(u.PowerAppEndpoints.environmentsValue),i.appendPath(n),i.appendPath(u.PowerAppEndpoints.appsValue),i.appendPath(t)),i.setQueryParam(u.PowerAppEndpoints.apiVersionKey,e.getPowerAppsApiVersion()),i.appendPath(u.PowerAppEndpoints.UrlPaths.makeSolutionAware),i},e.getSessionUrlBuilder=function(t,n,r){var o=Core.Environment.usePowerPlatformApi(),i=o?e.createPowerPlatformAppUrlBuilder(n,t):e.createPowerAppsBaseUrlBuilder();return o||(i.appendPath(u.PowerAppEndpoints.environmentsValue),i.appendPath(t),i.appendPath(u.PowerAppEndpoints.appsValue),i.appendPath(n)),r&&(i.appendPath(u.PowerAppEndpoints.sessions),i.appendPath(r)),i},e.getClientMetadataUrl=function(){if(!e._clientMetadataUrl){var t=new r.UrlBuilder(o.Region.getCurrentRegion().portalUri);t.appendPath(u.PowerAppEndpoints.UrlPaths.clientMetadata),e._clientMetadataUrl=t.toUrl()}return e._clientMetadataUrl},e.authorizeHttpBuilder=function(t,n,r,o,a){void 0===a&&(a=e.getApiVersion()),t.setBaseUrl(r),t.setMethod(n),Object(s.f)(t,{resource:o}),Object(i.addCustomHeadersOptionsToBuilder)(t,{optInMSHeaders:!0}),0===r.getQueryParamValuesByCaseInsensitiveName(u.PowerAppEndpoints.apiVersionKey).length&&t.addQueryParameter(u.PowerAppEndpoints.apiVersionKey,a)},e.parseAppNameFromAppId=function(t){return e._applyRegexAndGetMatch(t,e._appNameAppIdRegex)},e.parseAppInfoString=function(e){try{var t=JSON.parse(e);return c.AppInfoParser.parseAppInfo(t)}catch(e){return r.CoreLog.error("PowerAppsUtility.parseAppInfoString",e),null}},e.generateAppTemplatePackage=function(e,t,n,o,i){var a=new l.TemplatePackageBuilder;a.appName=Object(r.generate128BitUUID)(),a.displayName=t,a.backgroundColor=u.PowerAppsPackageDefaultValues.backgroundColor,a.backgroundImageUri=u.PowerAppsPackageDefaultValues.backgroundImageUrl,a.publisher=n,a.environment={id:i.id,name:i.name},a.setTag(u.PowerAppsPackageDefaultValues.publisherVersion,Core.Environment.Version.VERSION_NUMBER);var s=new r.UrlBuilder(e);s.appendPath(u.PowerAppsPackageDefaultValues.blobPackageName),a.playerPackageUri=s.toString();var c=new r.UrlBuilder(e);return c.appendPath(u.PowerAppsPackageDefaultValues.blobDocumentName),a.documentUri=c.toString(),a.getPackage()},e.getXMsUserAgentValueForApp=function(e,t){var n=e?"Player":"AuthoringTool",r=t||"<NonCloudApp>";return"PowerApps/".concat(Core.Environment.Version.VERSION_NUMBER," (").concat(Core.Environment.getPlatformNameForTelemetry()," ").concat(n,"; AppName=").concat(r,")")},e.getXMsUserAgentValue=function(){var e=Core.Environment.isAuthoringTool()?"AuthoringTool":"Player";return"PowerApps/".concat(Core.Environment.Version.VERSION_NUMBER," (").concat(Core.Environment.getPlatformNameForTelemetry(),"; ").concat(e,"; isReactNative: ").concat(Core.Environment.isReactNativePlayer(),")")},e.getAppOptionsForAppEditing=function(){return{expandParams:[u.GetAppExpandParameters.UnpublishedAppDefinition,u.GetAppExpandParameters.EnvironmentDisplayName]}},e.getAppOptionsForAppImporting=function(){return{expandParams:[u.GetAppExpandParameters.EnvironmentDisplayName]}},e.getPublishedAppOptionsMinimal=function(){return{expandParams:[],includePackageUrl:!1}},e.convertConnectionArrayToHashTable=function(e){var t=Object(r.HashTableUtility_create)();return e.forEach((function(e){t[e.id]=e})),t},e.useSharedEntityReferenceMap=function(){return Core.FeatureGates.webPlayer.enableSharedEntityReferenceMap&&Core.Environment.isSharedAppHost()},e.isOnlineAsync=function(){return __awaiter(this,void 0,Promise,(function(){var t,n,o;return __generator(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,4]),[4,Object(r.wrapWithTimeout)(AppMagic.Services.xhr(e._healthCheckRequest.value),3e3)];case 1:return i.sent().hasTimedOut||(t=!0),[3,4];case 2:return n=i.sent(),[4,Object(y.createNormalizedErrorFromWinJSXhrErrorAsync)(n,e._healthCheckUrlString.value)];case 3:return o=i.sent(),t=Object(m.errorHasHttpResponse)(o)&&o.response.status>=100,[3,4];case 4:return r.Log.trackActivityEvent("PowerAppsUtility.isOnlineAsync",{isOnline:t}),[2,t]}}))}))},e.setRegionalRPBaseUrl=function(t){r.Log.trackActivityEvent("PowerAppsUtility.setRegionalRPBaseUrl",{message:"URL: ".concat(t)}),Object(r.isAbsoluteUrlString)(t)?e._regionalRPBaseUrl=new r.Core_Url(t):e._regionalRPBaseUrl=void 0},e.getEcsHostResource=function(){return o.Region.getCurrentRegion().ecsHostResource},e._applyRegexAndGetMatch=function(e,t){var n=e.match(t);return!n||n.length<2?null:n[1]},e.tryGetConvergedAppIdentifier=function(){var e=Core.Environment.getWebPlayerAppEnvironmentId(),t=Core.Environment.getWebPlayerAppLogicalName();return(Core.Environment.isSharedAppHost()||Core.Environment.isSharedConsentOnly())&&Object(r.isNonEmptyNonWhitespaceString)(t)&&Object(r.isNonEmptyNonWhitespaceString)(e)?new AppMagic.Runtime.Client.UnifiedAppIdentifier(e,t):null},e.compareApiId=function(e,t){return r.FallbackSwitch.isActivated("AppConnectivity.ApiIdComparision")?e===t:Object(r.equalsIgnoreCase)(e,t)},e.isPowerAppsRpDlpApiEnabled=function(){return!r.FallbackSwitch.isActivated("AppConnectivity.ConnectionGroupingDlp")&&Core.FeatureGates.authoring.enableNewDlpApi},e._appNameAppIdRegex=new RegExp("providers/Microsoft.PowerApps/apps/(.+)$","i"),e._healthCheckUrlString=new r.Lazy((function(){var t=new r.UrlBuilder(e.getBaseUrl());return t.appendPath("api/invoke"),t.doneToString()})),e._healthCheckRequest=new r.Lazy((function(){var t=Object(r.HashTableUtility_create)();return t[u.PowerAppsRpInvokeHeader]="/healthcheck/compute",{url:e._healthCheckUrlString.value,type:a.Method.GET,headers:t,data:null}})),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"KeyName",(function(){return i})),n.d(t,"KeyType",(function(){return a})),n.d(t,"KeyPtr",(function(){return s})),n.d(t,"TypeArray",(function(){return c})),n.d(t,"TypeObject",(function(){return u})),n.d(t,"TypeControl",(function(){return p})),n.d(t,"TypeView",(function(){return l})),n.d(t,"TypeTable",(function(){return d})),n.d(t,"TypeBoolean",(function(){return f})),n.d(t,"TypeCurrency",(function(){return y})),n.d(t,"TypeDateTime",(function(){return m})),n.d(t,"TypeDate",(function(){return g})),n.d(t,"TypeHyperlink",(function(){return v})),n.d(t,"TypePenImage",(function(){return b})),n.d(t,"TypeColor",(function(){return h})),n.d(t,"TypeImage",(function(){return A})),n.d(t,"TypeMedia",(function(){return C})),n.d(t,"TypeNumber",(function(){return P})),n.d(t,"TypeString",(function(){return w})),n.d(t,"TypeBlob",(function(){return S})),n.d(t,"TypeTime",(function(){return O})),n.d(t,"TypeError",(function(){return R})),n.d(t,"TypeUnknown",(function(){return _})),n.d(t,"TypeObjNull",(function(){return T})),n.d(t,"TypeEntity",(function(){return I})),n.d(t,"TypeAttachment",(function(){return E})),n.d(t,"TypeGuid",(function(){return U})),n.d(t,"TypeDateTimeNoTimeZone",(function(){return j})),n.d(t,"TypeOptionSetValue",(function(){return N})),n.d(t,"TypePolymorphic",(function(){return D})),n.d(t,"TypeViewValue",(function(){return V})),n.d(t,"TypeOptionSet",(function(){return M})),n.d(t,"TypeFile",(function(){return k})),n.d(t,"TypeLargeImage",(function(){return L})),n.d(t,"TypeUntypedObject",(function(){return F})),n.d(t,"transformSchemaMapToArray",(function(){return B})),n.d(t,"createSchemaForSimple",(function(){return q})),n.d(t,"createSchemaForArrayFromPointer",(function(){return J})),n.d(t,"createSchemaForObjectFromPointer",(function(){return W})),n.d(t,"createSchemaForControlFromPointer",(function(){return z})),n.d(t,"getSchemaOfProperty",(function(){return K})),n.d(t,"isSchemaOfTypeArray",(function(){return X})),n.d(t,"isSchemaOfTypeObject",(function(){return Q})),n.d(t,"isSchemaComplexSchema",(function(){return $})),n.d(t,"isSchemaOfPrimitiveType",(function(){return Z})),n.d(t,"isSchemaOfType",(function(){return Y})),n.d(t,"getSchemaString",(function(){return ee})),n.d(t,"getChildSchemaAtMemberNameOrIndex",(function(){return te})),n.d(t,"getSchemaFollowingDataJsonPointer",(function(){return ne})),n.d(t,"schemasAreEqual",(function(){return oe})),n.d(t,"addSchemaMember",(function(){return ae})),n.d(t,"containsSchemaMember",(function(){return se})),n.d(t,"removeSchemaMember",(function(){return ce})),n.d(t,"stringizeSchema",(function(){return ue})),n.d(t,"getPrimitiveTypes",(function(){return pe}));var r=n(0),o=n(12),i="name",a="type",s="ptr",c="array",u="object",p="v",l="View",d="*",f="b",y="$",m="d",g="D",v="h",b="p",h="c",A="i",C="m",P="n",w="s",S="o",O="T",R="e",_="?",T="N",I="E",E="A",U="g",j="Z",N="l",D="P",V="q",M="OptionSet",k="F",L="I",F="O",x=[f,P,w,v,A,C,y,b,m,j,g,h,S,O,U,R,_,T,I,E,N,D,V,M,F],H=[c,u,p,l,k,L,d];x.concat(H);function B(e){var t=[];for(var n in e)if(e.hasOwnProperty(n)){var r={name:n,type:null},o=e[n];r.type="string"==typeof o?o:o.type,t.push(r)}return t}function q(e,t){var n={type:e};return"string"==typeof t&&(n.name=t),n}function G(e,t,n){var r={type:e,ptr:t};return"string"==typeof n&&(r.name=n),r}function J(e,t){return G(c,e,t)}function W(e,t){return G(u,e,t)}function z(e,t){return G(p,e,t)}function K(e,t){for(var n=e.ptr,r=n.length,o=0;o<r;o++){var i=n[o];if((i.invariantName?i.invariantName:i.name)===t)return i}return null}function X(e){return e.type===c}function Q(e){return e.type===u}function $(e){return H.some((function(t){return t===e.type}))}function Z(e){return x.indexOf(e.type)>=0}function Y(e,t){return e.type===t}function ee(e){if(x.indexOf(e.type)>=0)return e.type;var t=e,n=X(t);return ue(t.ptr,n)}function te(e,t){if(e.type===c){if(null!==t.match(/[^\d]/))return null;var n=e;return(r=Object(o.r)(n)).type=u,r}var r;return e.type===u?K(r=e,t):null}function ne(e,t){var n=Object(o.v)(t);if(!n.success)return e;var r=te(e,n.firstToken);return null===r?null:ne(r,n.nextPointer)}function re(e,t){return e[i].localeCompare(t[i])}function oe(e,t){if(e[a]!==t[a])return!1;var n=e[a];if(n===c||n===u||n===p){var r=e[s].slice(0),o=t[s].slice(0);if(r.length!==o.length)return!1;r.sort(re),o.sort(re);for(var l=0,d=r.length;l<d;l++){if(r[l][i]!==o[l][i])return!1;if(!oe(r[l],o[l]))return!1}}return!0}function ie(e,t){return e.invariantName?e.invariantName===t:e.name===t}function ae(e,t,n){Object(r.check)(e.ptr.every((function(e){return!ie(e,t)})),"Member already exists."),e.ptr.push({name:t,type:n})}function se(e,t){return e.ptr.some((function(e){return ie(e,t)}))}function ce(e,t){for(var n=0,o=e.ptr.length;n<o;n++){if(ie(e.ptr[n],t))return void e.ptr.splice(n,1)}Object(r.check)(!1,"Member not found.")}function ue(e,t){Object(r.checkArray)(e);var n="",o="",i=t?"*":"!";return e.forEach((function(e){Object(r.checkObject)(e);var t=e.name;if(/[^a-zA-Z0-9_]/.test(t)||/^[0-9]/.test(t)){var i=t.replace(/'/g,"''");t="'"+i+"'"}if(n+=o+t+":",Object(r.checkNonEmpty)(e.type,"Schema item needs to have a dtype."),X(e)||Q(e)){var a=e;Object(r.checkArray)(a.ptr),X(a)?n+=ue(a.ptr,!0):n+=ue(a.ptr,!1)}else n+=e.type;o=","})),i+"["+n+"]"}function pe(){return x.slice()}},function(e,t,n){"use strict";n.d(t,"c",(function(){return H})),n.d(t,"v",(function(){return B})),n.d(t,"f",(function(){return q})),n.d(t,"a",(function(){return G})),n.d(t,"w",(function(){return J})),n.d(t,"e",(function(){return W})),n.d(t,"q",(function(){return z})),n.d(t,"m",(function(){return K})),n.d(t,"u",(function(){return X})),n.d(t,"h",(function(){return Q})),n.d(t,"g",(function(){return $})),n.d(t,"i",(function(){return Z})),n.d(t,"l",(function(){return Y})),n.d(t,"k",(function(){return ee})),n.d(t,"j",(function(){return te})),n.d(t,"b",(function(){return ne})),n.d(t,"s",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"r",(function(){return a})),n.d(t,"o",(function(){return c})),n.d(t,"n",(function(){return u})),n.d(t,"t",(function(){return oe}));var r,o,i,a,s,c,u,p,l=n(0),d=n(16),f=n(53),y=n(63),m=n(32),g=n(34),v=n(58),b=n(9),h=n(111),A=n(130),C=n(17),P=n(46),w=n(3),S=n(117),O=n(35),R=n(21),_=n(28),T=n(2),I=n(169),E=n(4),U=n(8),j=n(39),N=n(42),D=n(18),V=n(11),M=n(14),k=n(30),L=n(1),F=n(105),x=n(69),H="blob",B="tabular",q="composite",G="actions",J="triggers",W="cloud",z="parameter",K="gateway",X="error",Q="error",$="id",Z="configuration needed",Y="unauthorized",ee="unauthenticated",te="too many requests",ne="*";function re(e){return Object(l.isObject)(e)&&e.message===AppMagic.Strings.AuthenticationBrokerManagerErrorUserCanceled}!function(e){e.String="string",e.SecureString="securestring",e.Integer="int",e.Object="object",e.SecureObject="secureobject",e.Array="array",e.Boolean="bool",e.OAuthSetting="oauthsetting",e.Connection="connection",e.GatewaySetting="gatewaysetting"}(r||(r={})),function(e){e.getApiCall="ConnectionService.GetApi",e.getApiWadlCall="ConnectionService.GetApiWadl",e.getConnectionCall="ConnectionService.GetConnection",e.createConnectionCall="ConnectionService.CreateConnection",e.testConnectionCall="ConnectionService.TestConnection",e.deleteConnectionCall="ConnectionService.DeleteConnection",e.getRtsNamespaces="ConnectionService.GetAvailableRtsNamespaces",e.firstPartyConsent="ConnectionService.FirstPartyConsent",e.addConnectionUsageCall="ConnectionService.AddUsage",e.removeConnectionUsageCall="ConnectionService.RemoveUsage",e.listConnectionUsageCall="ConnectionService.ListConnectionUsage",e.getGatewaysCall="ConnectionService.GetGateways",e.getConsentLinkCall="ConnectionService.GetConsentLink",e.confirmConsentCodeCall="ConnectionService.ConfirmConsentCode",e.recordScopeConsentsCall="ConnectionService.RecordScopeConsents",e.saveUserConsentCall="ConnectionService.SaveUserConsent"}(o||(o={})),function(e){e[e.Blob=1]="Blob",e[e.Tabular=2]="Tabular",e[e.Composite=4]="Composite",e[e.Actions=8]="Actions",e[e.Triggers=16]="Triggers",e[e.Cloud=32]="Cloud",e[e.Gateway=64]="Gateway",e[e.Parameter=128]="Parameter"}(i||(i={})),function(e){e[e.String=0]="String",e[e.SecureString=1]="SecureString",e[e.Integer=2]="Integer",e[e.Object=3]="Object",e[e.SecureObject=4]="SecureObject",e[e.Array=5]="Array",e[e.Boolean=6]="Boolean",e[e.OAuthSetting=7]="OAuthSetting",e[e.Connection=8]="Connection",e[e.GatewaySetting=9]="GatewaySetting"}(a||(a={})),function(e){e[e.None=0]="None",e[e.GetConsentLink=1]="GetConsentLink",e[e.ConfirmConsentCode=2]="ConfirmConsentCode"}(s||(s={})),function(e){e.PowerApp="properties/definitionSummary/triggers/any(t: t/type eq 'Request' and t/kind eq 'PowerApp')",e.PowerAppV2="properties/definitionSummary/triggers/any(t: t/type eq 'Request' and t/kind eq 'PowerAppV2')"}(c||(c={})),function(e){e.Personal="search('personal')",e.Team="search('team')"}(u||(u={})),function(e){e[e.Default=545940002]="Default",e[e.Standard=545940001]="Standard",e[e.Keyless=54594e4]="Keyless"}(p||(p={}));var oe=function(e){function t(n,r,o,i,a,s,c,u,p){var l=e.call(this)||this;return l._isSkipTestConnectionEnabled=p,l._useEnhancedSqlConnection=!1,l._environment=n,l._connectionsCache=r,l._apiCache=o,l._currentUserConnectionsForAppCache=null,l._brokerManager=i,l._httpClient=a,l._callbackUri=l._brokerManager.appCallbackUri?l._brokerManager.appCallbackUri:t.RedirectUri.toString(),l._disambiguationRuleManager=new I.DisambiguationRuleManager(l),l._clientSettings=s,l._userIdentity=c,l._isParseInstallConnectionObjectEnabled=u,l}return __extends(t,e),Object.defineProperty(t,"IsPowerPlatformApiEnabled",{get:function(){return null===t._isPowerPlatformApiEnabled&&(t._isPowerPlatformApiEnabled=l.services.EnablePowerPlatformConnectionsApi&&!l.FallbackSwitch.isActivated("AppConnectivity.DisablePowerPlatformConnectionsApi")&&"shrinkwrap"!=Object(l.getMobilePlayerFlavor)()&&(!Object(l.isAirGapCloudRegion)()||l.FeatureGates_authoring.powerPlatformApiAllowAGC)&&Object(l.usePowerPlatformApi)()),t._isPowerPlatformApiEnabled},set:function(e){t._isPowerPlatformApiEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"useEnhancedSqlConnection",{set:function(e){this._useEnhancedSqlConnection=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disambiguationRuleManager",{get:function(){return this._disambiguationRuleManager},enumerable:!1,configurable:!0}),t.getApisFromServerAsync=function(e,n,r,o){var i;return void 0===o&&(o=!1),__awaiter(this,void 0,Promise,(function(){var a,s,c,u,p,d,f,y,m,g;return __generator(this,(function(v){switch(v.label){case 0:a=Object(l.generate128BitUUID)(),Object(l.enterScope)(a),t.IsPowerPlatformApiEnabled&&!o?s=t.createPowerPlatformConnectorUrlBuilder(e.name):(s=E.PowerAppsUtility.createPowerAppsProviderUrlBuilder()).appendPath("apis"),r&&s.setQueryParam(T.PowerAppEndpoints.pollQueryParam,"true"),s.setQueryParam("showApisWithToS","true"),c=new _.ODataListItemsTool(s.toString(),t._getResourceName(o),n,"ConnectionService.ListApis",b.NextLink),u={expand:b.ExpandEntityNames.Api,apiVersion:t._getApiVersion(o)},Object(P.addEnvironmentFilterToOptions)(e.name,u),t._addDenyListFilterToOptions(u),v.label=1;case 1:return v.trys.push([1,3,,4]),[4,Object(l.PromiseUtility_join)([c.getItemsAsync(u),t._tryGetHiddenApisAsync(e,n)])];case 2:if(p=v.sent(),d=p[0],f=null!==(i=p[1])&&void 0!==i?i:[],d.resultCode!==_.GetItemsResultCode.Success)throw y=_.GetItemsResultCode[d.resultCode],y+=d.errorMessage?". ".concat(d.errorMessage):"",new l.ApplicationError(y);return m=d.items.map(AppMagic.ConnectionHub.Api.tryParseFromResponseWithLogging).concat(f).filter((function(e){return Object(l.isNotNull)(e)})).sort((function(e,t){return e.displayName.localeCompare(t.displayName)})),t._logGetItemsTelemetry(a,l.connectionHubGetApisBypassCacheSucceeded,m.length),[2,m];case 3:throw g=v.sent(),Object(l.throwIfCanceled)(g),t._logGetItemsTelemetry(a,l.connectionHubGetApisBypassCacheFailed),g;case 4:return[2]}}))}))},t.prototype.installWorkflowAsync=function(e,t,n,r,o){return __awaiter(this,void 0,Promise,(function(){var i,a,s,c,u,p,f,y,m,g,v;return __generator(this,(function(b){switch(b.label){case 0:b.label=1;case 1:return b.trys.push([1,3,,4]),Object(l.HashTableUtility_forEach)(e.connectionReferences,(function(e,t){var n,r;if((null===(n=e.id)||void 0===n?void 0:n.length)<=0||(null===(r=e.connectionName)||void 0===r?void 0:r.length)<=0)throw new Error("Install flow Api failed Request. ConnectionReference should have both id and connectionName")})),i=this._getWorkflowInstallEndpoint(t,n),(a=new l.UrlBuilder(E.PowerAppsUtility.getBaseFlowUrl())).appendPath(i),a.setQueryParam(T.PowerAppEndpoints.apiVersionKey,d.Region.getCurrentRegion().powerAppsApiVersion),this._isParseInstallConnectionObjectEnabled&&a.setQueryParam(R.ODataConstants.QueryOption.Expand,"connection"),s={connectionReferences:e.connectionReferences},(c=Object(l.HashTableUtility_create)())[w.HeaderName.ContentType]=w.MediaType.ApplicationJson,u=o&&!l.FallbackSwitch.isActivated("PowerAutomatePane.DisableRetryAddFlow")?{maxRetries:1,statusCodes:[400,408,409,500,502,503,504]}:void 0,p={url:a.toString(),method:w.Method.POST,headers:c,bodyData:JSON.stringify(s),retryable:u},f=Object(l.createErrorContext)({protocol:"rest",operation:"InstallFlow",operationName:"installWorkflowAsync"}),Object(l.addHeaders)(p.headers,f),[4,this._sendHttpRequestJsonResponseAsync(p,U.d.PowerAppsService,D.e,"installWorkflowAsync")];case 2:if(!(y=b.sent()))throw new Error("Install flow Api failed Request. Empty response from the back-end service");if(!(m=AppMagic.PowerApps.InstallFlowResponse.safeCast(y))||!m.connectionId)throw new h.ErrorWithResponseTypes("Install flow Api failed Request. Couldn't parse response",y);return(g=this._tryParseInstallConnectionResponse(m,r))?(l.Log.trackActivityEvent("PowerAppsConnectionService.installWorkflowAsync",{message:"Install returned connection object",connectionId:g.id}),this._connectionsCache.setItem(m.connectionId,g),[2,g]):[2,m.connectionId];case 3:throw v=b.sent(),l.CoreLog.errorEx("ConnectionService.installWorkflowAsync",{error:v,message:"Install flow Api failed Request",eventData:{installFlowRequest:e,responseTypes:v instanceof h.ErrorWithResponseTypes?v.responseTypes:void 0}}),v;case 4:return[2]}}))}))},t.prototype._tryParseInstallConnectionResponse=function(e,t){var n,r,o,i,a,s,c,u,p,l,d,f,y=null==e?void 0:e.connection;if(!y||!this._isParseInstallConnectionObjectEnabled)return null;var g=e.connectionId,v=y.name,b={displayName:null===(n=y.properties)||void 0===n?void 0:n.displayName,iconUri:null===(o=null===(r=y.properties)||void 0===r?void 0:r.metadata)||void 0===o?void 0:o.iconUri,createdBy:null===(a=null===(i=y.properties)||void 0===i?void 0:i.metadata)||void 0===a?void 0:a.createdBy,api:t,apiId:t.id,isOnPremise:!1,status:void 0,environmentName:null===(c=null===(s=y.properties)||void 0===s?void 0:s.metadata)||void 0===c?void 0:c.environmentName,connectionParameters:null===(u=y.properties)||void 0===u?void 0:u.nonSecretParameterValues,createdTime:null===(p=y.properties)||void 0===p?void 0:p.createdTime},h={id:g,name:v,type:y.type,properties:{displayName:b.displayName,iconUri:b.iconUri,apiId:t.id,connectionParameters:null===(l=y.properties)||void 0===l?void 0:l.nonSecretParameterValues,createdTime:b.createdTime,lastModifiedTime:null===(d=y.properties)||void 0===d?void 0:d.changedTime,createdBy:b.createdBy,statuses:null===(f=y.properties)||void 0===f?void 0:f.statuses,environment:void 0}};return new m.MsFlowCompositeConnection(g,v,b,h)},t.prototype.getFlowsAsync=function(e,t){return void 0===t&&(t=this._environment.name),__awaiter(this,void 0,Promise,(function(){var n,r,o,i,a,s,c,u;return __generator(this,(function(p){switch(p.label){case 0:p.label=1;case 1:return p.trys.push([1,3,,4]),n=this._getFlowsEndpoint(t),(r=new l.UrlBuilder(E.PowerAppsUtility.getBaseFlowUrl())).appendPath(n),r.setQueryParam(T.PowerAppEndpoints.apiVersionKey,d.Region.getCurrentRegion().powerAppsApiVersion),(o=Object(l.HashTableUtility_create)())[R.ODataConstants.QueryOption.Filter]=e,r.setQueryParams(o),(i=Object(l.HashTableUtility_create)())[w.HeaderName.ContentType]=w.MediaType.ApplicationJson,a={url:r.toString(),method:w.Method.GET,headers:i},[4,this._sendHttpRequestJsonResponseAsync(a,U.d.PowerAppsService,D.e,"GetFlows")];case 2:if(!(s=p.sent()))throw new Error("Get flows Api request failed. Empty response from the back-end service");if(!(c=AppMagic.PowerApps.FlowMetadata.safeCast(s)))throw new Error("Get flows Api request failed. Couldn't parse response");return[2,this._tryParseGetFlowsRequestComplete(c)];case 3:throw u=p.sent(),l.CoreLog.errorEx("ConnectionService.getFlowsAsync",{error:u,message:"Get flows Api request failed"}),u;case 4:return[2]}}))}))},t.prototype.getFlowAsync=function(e,t,n){return void 0===t&&(t=this._environment.name),__awaiter(this,void 0,Promise,(function(){var r,o,i,a,s,c,u,p;return __generator(this,(function(f){switch(f.label){case 0:f.label=1;case 1:return f.trys.push([1,3,,4]),r=this._getFlowsEndpoint(t,e),(o=new l.UrlBuilder(E.PowerAppsUtility.getBaseFlowUrl())).appendPath(r),o.setQueryParam(R.ODataConstants.QueryOption.Expand,"swagger,properties.connectionreferences.apidefinition,properties.definitionsummary.operations.apioperation"),o.setQueryParam(T.PowerAppEndpoints.apiVersionKey,d.Region.getCurrentRegion().powerAppsApiVersion),i=Object(l.HashTableUtility_create)(),o.setQueryParams(i),(a=Object(l.HashTableUtility_create)())[w.HeaderName.ContentType]=w.MediaType.ApplicationJson,s={url:o.toString(),method:w.Method.GET,headers:a},[4,this._sendHttpRequestJsonResponseAsync(s,U.d.PowerAppsService,D.e,"GetFlow")];case 2:if(!(c=f.sent()))throw new Error("Get flow Api request failed. Empty response from the back-end service");if(!(u=AppMagic.PowerApps.FlowMetadataEx.safeCast(c)))throw new Error("Get flow Api request failed. Couldn't parse response");return[2,this._tryParseGetFlowRequestComplete(u,n)];case 3:throw p=f.sent(),l.CoreLog.errorEx("ConnectionService.getFlowAsync",{error:p,message:"Get flow Api request failed"}),p;case 4:return[2]}}))}))},t.prototype.getSolutionFlowsAsync=function(e,t){var n;return void 0===t&&(t=!1),__awaiter(this,void 0,Promise,(function(){var r,o,i,a,s,c,u;return __generator(this,(function(p){switch(p.label){case 0:p.label=1;case 1:return p.trys.push([1,7,,8]),r=void 0,l.FallbackSwitch.isActivated("AppConnectivity.OptimizeGetSolutionFlows")||t?r="workflows?$filter=(category eq 5)":("workflowid,workflowidunique,solutionid,name,modifiedon,statecode,clientdata",r="workflows?$filter=(category eq 5)&$select=".concat("workflowid,workflowidunique,solutionid,name,modifiedon,statecode,clientdata")),o=AppMagic.PowerApps.CdsUtility.buildCdsHttpRequestUrl(e,AppMagic.PowerApps.Constants.CdsDefaultWebApiVersion,r),i=AppMagic.PowerApps.CdsUtility.buildCdsHttpRequestParameters(o,e,w.Method.GET),[4,this._httpClient.sendHttpJsonResponseAsync(i)];case 2:if(!(a=p.sent()))throw new Error("Get solution flows Api request failed. Empty response from the back-end service");if(!(s=AppMagic.PowerApps.SolutionFlowMetadata.safeCast(a)))throw new Error("Get solution flows Api request failed. Couldn't parse response");return l.FallbackSwitch.isActivated("AppConnectivity.OptimizeGetSolutionFlows")||t?[3,4]:[4,this._tryParseGetSolutionFlowsRequestCompleteOptimizedAsync(s)];case 3:return[2,p.sent()];case 4:return c=null!==(n=null==s?void 0:s.value)&&void 0!==n?n:[],[4,this._tryParseGetSolutionFlowsRequestCompleteAsync(c)];case 5:return[2,p.sent()];case 6:return[3,8];case 7:throw u=p.sent(),l.CoreLog.errorEx("ConnectionService.getSolutionFlowsAsync",{error:u,message:"Get solution flows Api request failed"}),u;case 8:return[2]}}))}))},t.prototype.getFlowMachineGroupsAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n,r,o,i,a,s;return __generator(this,(function(c){switch(c.label){case 0:c.label=1;case 1:return c.trys.push([1,3,,4]),t="(statecode eq 0) and (flowgrouptype eq ".concat(p.Default," or flowgrouptype eq ").concat(p.Standard,")"),"flowmachinegroupid,name,description","name asc",n="flowmachinegroups?$filter=".concat(t,"&$select=").concat("flowmachinegroupid,name,description","&$orderby=").concat("name asc"),r=AppMagic.PowerApps.CdsUtility.buildCdsHttpRequestUrl(e,AppMagic.PowerApps.Constants.CdsDefaultWebApiVersion,n),o=AppMagic.PowerApps.CdsUtility.buildCdsHttpRequestParameters(r,e,w.Method.GET),[4,this._httpClient.sendHttpJsonResponseAsync(o)];case 2:if(!(i=c.sent()))throw new Error("Get flow machine groups Api request failed. Empty response from the back-end service");if(!(a=L.dc.safeCast(i)))throw new Error("Get flow machine groups Api request failed. Couldn't parse response");return[2,a.value||[]];case 3:throw s=c.sent(),l.CoreLog.errorEx("ConnectionService.getFlowMachineGroupsAsync",{error:s,message:"Get flow machine groups Api request failed"}),s;case 4:return[2]}}))}))},t.prototype.getFlowApiWadlXmlAsync=function(e,t){return void 0===t&&(t=this._environment.name),__awaiter(this,void 0,Promise,(function(){var n,r,o,i,a,s;return __generator(this,(function(c){switch(c.label){case 0:c.label=1;case 1:return c.trys.push([1,3,,4]),n=this._getFlowsEndpoint(t,e),(r=new l.UrlBuilder(E.PowerAppsUtility.getBaseFlowUrl())).appendPath(n),r.appendPath("listWadl"),r.setQueryParam(T.PowerAppEndpoints.apiVersionKey,d.Region.getCurrentRegion().powerAppsApiVersion),(o=Object(l.HashTableUtility_create)())[w.HeaderName.ContentType]=w.MediaType.ApplicationJson,i={url:r.toString(),method:w.Method.POST,headers:o},AppMagic.Runtime.Client.addAuthorizationOptions(i.headers,{resource:U.d.PowerAppsService}),Object(N.addServiceErrorOptions)(i,{serviceType:D.e}),Object(C.appendCustomHeadersOptions)(i,{optInMSHeaders:!0,addCustomHeaders:!0}),[4,Object(M.sendHttpTextResponseAsync)(this._httpClient,i,"GetFlowApiWadl")];case 2:if(!(a=c.sent()))throw new Error("Get flow Api Wadl request failed. Empty response from the back-end service");return[2,a];case 3:throw s=c.sent(),l.CoreLog.errorEx("ConnectionService.getFlowApiWadlXmlAsync",{error:s,message:"Get flow Api Wadl request failed"}),s;case 4:return[2]}}))}))},t.prototype.getAllEnvironmentFlowsAsync=function(e,t){return void 0===t&&(t=this._environment.name),__awaiter(this,void 0,Promise,(function(){var n,r,o,i,a,s,c,u;return __generator(this,(function(p){switch(p.label){case 0:p.label=1;case 1:return p.trys.push([1,3,,4]),n=this._getListFlowsEndpoint(t),(r=new l.UrlBuilder(E.PowerAppsUtility.getBaseFlowUrl())).appendPath(n),(o=Object(l.HashTableUtility_create)())[R.ODataConstants.QueryOption.Filter]=e,o[T.PowerAppEndpoints.apiVersionKey]=d.Region.getCurrentRegion().powerAppsApiVersion,l.FallbackSwitch.isActivated("AppConnectivity.excludeSolutionCloudFlows")||(o[T.PowerAppEndpoints.excludeQueryParam]=T.PowerAppEndpoints.excludeSolutionFlowQueryParamValue),r.setQueryParams(o),(i=Object(l.HashTableUtility_create)())[w.HeaderName.ContentType]=w.MediaType.ApplicationJson,a={url:r.toString(),method:w.Method.GET,headers:i},[4,this._sendHttpRequestJsonResponseAsync(a,U.d.PowerAppsService,D.e,"GetFlows")];case 2:if(!(s=p.sent()))throw new Error("Get flows Api request failed. Empty response from the back-end service");if(!(c=AppMagic.PowerApps.FlowMetadata.safeCast(s)))throw new Error("Get flows Api request failed. Couldn't parse response");return[2,this._tryParseGetFlowsRequestComplete(c)];case 3:throw u=p.sent(),l.CoreLog.errorEx("ConnectionService.getAllEnvironmentFlowsAsync",{error:u,message:"Get flows Api request failed"}),u;case 4:return[2]}}))}))},t.prototype._getFlowsEndpoint=function(e,t){var n=t?"/".concat(t):"",r=new l.UrlTemplate("/providers/Microsoft.Flow/environments/{environmentName}/flows{optionalFlowName}");return decodeURIComponent(r.expandUrlString({environmentName:e,optionalFlowName:n}))},t.prototype._getListFlowsEndpoint=function(e){var t=new l.UrlTemplate("/providers/Microsoft.ProcessSimple/environments/{environmentName}/flows");return decodeURIComponent(t.expandUrlString({environmentName:e}))},t.prototype._parseFlowResponse=function(e){var t,n,r,o,i,a,s,c,u,p,l=[];if(0===Object.keys(e.properties).length)return null;var d=e.properties.displayName,f=new Date(e.properties.lastModifiedTime),y="Started"===e.properties.state,m=null!==(n=null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.workflowEntityId)&&void 0!==n?n:void 0,g=null!==(o=null===(r=e.properties.definitionSummary.triggers[0])||void 0===r?void 0:r.type)&&void 0!==o?o:"",v=null!==(a=null===(i=e.properties.definitionSummary.triggers[0])||void 0===i?void 0:i.kind)&&void 0!==a?a:"",b=null!==(p=null===(u=null===(c=null===(s=e.properties.definitionSummary.triggers[0])||void 0===s?void 0:s.api)||void 0===c?void 0:c.properties)||void 0===u?void 0:u.iconUri)&&void 0!==p?p:"";if(e.properties.connectionReferences)for(var h in e.properties.connectionReferences){var A=e.properties.connectionReferences[h].id,C=e.properties.connectionReferences[h].displayName,P=e.properties.connectionReferences[h].iconUri;l.push(new F.FlowConnectionReference(h,A,C,P,e.properties.connectionReferences[h].connectionName,e.properties.connectionReferences[h].source))}return new F.FlowMetadataEx(l,e.id,e.properties.apiId,d,e.name,f,y,new Date,e.properties.flowTriggerUri,g,v,b,void 0,m,JSON.stringify(e.properties))},t.prototype._tryParseGetFlowsRequestComplete=function(e){return e.value.map(this._parseFlowResponse).filter((function(e){return null!==e}))},t.prototype._tryParseGetFlowRequestComplete=function(e,t){var n=this._parseFlowResponse(e);return n.solutionId=null!=t?t:void 0,n},t.prototype._tryParseGetSolutionFlowsRequestCompleteAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n,r,o,i,a=this;return __generator(this,(function(s){switch(s.label){case 0:t=30,n=[],r=0,s.label=1;case 1:return r<e.length?(o=e.slice(r,r+t),[4,Object(l.PromiseUtility_join)(o.map((function(e){return __awaiter(a,void 0,void 0,(function(){var t;return __generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.getFlowAsync(e.workflowidunique,this._environment.name,e.solutionid)];case 1:return[2,n.sent()];case 2:return t=n.sent(),Object(l.isCanceledError)(t)||l.CoreLog.errorEx("ConnectionService._tryParseGetSolutionFlowsRequestCompleteAsync",{error:t,message:"There was an error fetching metadata for flow. WorkflowIdUnique: ".concat(e.workflowidunique)}),[2,null];case 3:return[2]}}))}))})))]):[3,4];case 2:i=s.sent(),n.push.apply(n,i.filter((function(e){return null!==e}))),s.label=3;case 3:return r+=t,[3,1];case 4:return[2,n]}}))}))},t.prototype._tryParseGetSolutionFlowsRequestCompleteOptimizedAsync=function(e){var t,n,r,o,i,a,s;return __awaiter(this,void 0,Promise,(function(){var c,u,p,d,f,y,m,g,v;return __generator(this,(function(b){switch(b.label){case 0:for(c=null!==(t=null==e?void 0:e.value)&&void 0!==t?t:[],u=[],p=[],d=0;d<c.length;d++)try{if(!(f=JSON.parse(c[d].clientdata))){l.CoreLog.warningEx("ConnectionService._tryParseGetSolutionFlowsRequestCompleteOptimizedAsync","Could not parse clientdata: '".concat(c[d].workflowidunique,"'")),p.push(c[d]);continue}y=L.Qg.safeCast(f.properties),m=new F.FlowMetadata(c[d].workflowidunique,AppMagic.ConnectionHub.Constants.ApiIds.FlowService,c[d].name,c[d].workflowidunique,new Date(c[d].modifiedon),1===c[d].statecode,new Date,"",null!==(o=null===(r=null===(n=y.definition.triggers)||void 0===n?void 0:n.manual)||void 0===r?void 0:r.type)&&void 0!==o?o:"",null!==(s=null===(a=null===(i=y.definition.triggers)||void 0===i?void 0:i.manual)||void 0===a?void 0:a.kind)&&void 0!==s?s:"","",c[d].solutionid,c[d].workflowid,""),u.push(m)}catch(e){l.CoreLog.errorEx("ConnectionService._tryParseGetSolutionFlowsRequestCompleteOptimized",{error:e,message:"Server returned invalid json response for getSolutionFlows call."})}return p.length>0?(v=(g=u).concat,[4,this._tryParseGetSolutionFlowsRequestCompleteAsync(p)]):[3,2];case 1:return[2,v.apply(g,[b.sent()])];case 2:return[2,u]}}))}))},t.prototype.createConnectionReferenceForExistingConnection=function(e,t,n){var r;return __awaiter(this,void 0,Promise,(function(){var o,i,a,s;return __generator(this,(function(c){switch(c.label){case 0:c.label=1;case 1:return c.trys.push([1,3,,4]),o=y.CdsUtility.buildCdsHttpRequestUrl(e,AppMagic.PowerApps.Constants.CdsDefaultWebApiVersion,"connectionreferences"),i={connectionreferencelogicalname:(null===(r=n.publisherid)||void 0===r?void 0:r.customizationprefix)+"_"+t.name,connectionreferencedisplayname:t.displayName,connectorid:t.apiId,connectionid:t.name,description:t.displayName,ismanaged:!1},a=y.CdsUtility.buildCdsHttpRequestParameters(o,e,w.Method.POST,JSON.stringify(i),n.uniquename),[4,this._httpClient.sendHttpAsync(a)];case 2:if(!c.sent())throw new Error("Failed to create connection reference.");return[3,4];case 3:throw s=c.sent(),l.CoreLog.errorEx("ConnectionService.createConnectionReferenceForExistingConnection",{error:s,message:"Failed to create connection reference.",eventData:{connection:t}}),s;case 4:return[2]}}))}))},t.prototype.installCdsWorkflowAsync=function(e,t,n,r){return __awaiter(this,void 0,Promise,(function(){var o,i,a,s,c,u,p,d,f;return __generator(this,(function(m){switch(m.label){case 0:m.label=1;case 1:return m.trys.push([1,3,,4]),o=this._getCdsWorkflowInstallEndpoint(t),i={connectionReferences:JSON.stringify(n.connectionReferences)},a=y.CdsUtility.buildCdsHttpRequestUrl(e,AppMagic.PowerApps.Constants.CdsDefaultWebApiVersion,o),s=y.CdsUtility.buildCdsHttpRequestParameters(a,e,w.Method.POST,JSON.stringify(i)),c=Object(l.createErrorContext)({protocol:"rest",operation:"InstallFlow",operationName:"installCdsWorkflowAsync"}),Object(l.addHeaders)(s.headers,c),[4,this._httpClient.sendHttpJsonResponseAsync(s)];case 2:if(!(u=m.sent()))throw new Error("Install flow Api failed Request. Empty response from the back-end service");if(this._isParseInstallConnectionObjectEnabled&&u[b.FlowInstallConnectionKeys.ConnectionObjStringKey]&&"string"==typeof u[b.FlowInstallConnectionKeys.ConnectionObjStringKey])try{u[b.FlowInstallConnectionKeys.ConnectionObjKey]=JSON.parse(u[b.FlowInstallConnectionKeys.ConnectionObjStringKey])}catch(e){l.Log.trackErrorEvent("PowerAppsConnectionService.installCdsWorkflowAsync",{errorMessage:"Failed to parse response connection string. Will fallback to list connections"}),u[b.FlowInstallConnectionKeys.ConnectionObjKey]=null}else u[b.FlowInstallConnectionKeys.ConnectionObjKey]=null;if(!(p=AppMagic.PowerApps.InstallFlowResponse.safeCast(u))||!p.connectionId)throw new h.ErrorWithResponseTypes("Install flow Api failed Request. Couldn't parse response",u);return(d=this._tryParseInstallConnectionResponse(p,r))?(l.Log.trackActivityEvent("PowerAppsConnectionService.installCdsWorkflowAsync",{message:"Install returned connection object",connectionId:d.id}),this._connectionsCache.setItem(p.connectionId,d),[2,d]):[2,p.connectionId];case 3:throw f=m.sent(),l.CoreLog.errorEx("ConnectionService.installCdsWorkflowAsync",{error:f,message:"Install flow Api failed Request",eventData:{installFlowRequest:n,responseTypes:f instanceof h.ErrorWithResponseTypes?f.responseTypes:void 0}}),f;case 4:return[2]}}))}))},t.prototype._getWorkflowInstallEndpoint=function(e,t){var n=new l.UrlTemplate("/providers/Microsoft.ProcessSimple/environments/{environmentName}/flows/{flowName}/install");return decodeURIComponent(n.expandUrlString({environmentName:e,flowName:t}))},t.prototype._getCdsWorkflowInstallEndpoint=function(e){var t=new l.UrlTemplate("workflows({workflowEntityId})/Microsoft.Dynamics.CRM.install");return decodeURIComponent(t.expandUrlString({workflowEntityId:e}))},t._tryGetHiddenApisAsync=function(e,n){return __awaiter(this,void 0,Promise,(function(){var r,o,i=this;return __generator(this,(function(a){switch(a.label){case 0:return r=[b.ApiIds.MicrosoftSpatialServices],o=r.map((function(r){return __awaiter(i,void 0,void 0,(function(){var o;return __generator(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,t._getFullApiByIdAsync(r,e,n,(function(e){var t;return e instanceof x.ServiceError&&404===(null===(t=e.response)||void 0===t?void 0:t.status)}))];case 1:return o=i.sent(),l.CoreLog.verbose("_tryGetHiddenApisAsync success for API id {0}",r),[2,o];case 2:return i.sent(),[2,null];case 3:return[2]}}))}))})),[4,Object(l.PromiseUtility_join)(o)];case 1:return[2,a.sent().filter((function(e){return!!e}))]}}))}))},t._addDenyListFilterToOptions=function(e){var t="apiCurationName eq 'PowerAppsClients'";e.filter?e.filter="".concat(e.filter," ").concat(R.ODataConstants.QueryOption.FilterOperators.And," ").concat(t):e.filter=t},t.getConnectionsFromServerAsync=function(e,n,r,o){void 0===o&&(o=!1);var i,a=Object(l.generate128BitUUID)();Object(l.enterScope)(a),t.IsPowerPlatformApiEnabled&&!o?i=t.createPowerPlatformConnectionUrlBuilder(e.name):(i=E.PowerAppsUtility.createPowerAppsProviderUrlBuilder()).appendPath("connections"),r&&i.setQueryParam(T.PowerAppEndpoints.pollQueryParam,"true");var s=new _.ODataListItemsTool(i.toString(),t._getResourceName(o),n,"ConnectionService.ListConnections",b.NextLink),c={expand:b.ExpandEntityNames.Api,apiVersion:t._getApiVersion(o)};return Object(P.addEnvironmentFilterToOptions)(e.name,c),s.getItemsAsync(c).then((function(e){if(e.resultCode!==_.GetItemsResultCode.Success){var n=_.GetItemsResultCode[e.resultCode];throw n+=e.errorMessage?". ".concat(e.errorMessage):"",new l.ApplicationError(n)}var r=e.items.map((function(e){return Object(g.l)(e)})).filter(l.isNotNull).sort((function(e,n){return t.isRuntimeServiceApi(e.apiId)?-1:e.api.displayName.localeCompare(n.api.displayName)}));return t._logGetItemsTelemetry(a,l.connectionHubGetConnectionsBypassCacheSucceeded,r.length),r})).catch((function(e){return Object(l.throwIfCanceled)(e),t._logGetItemsTelemetry(a,l.connectionHubGetConnectionsBypassCacheFailed),Promise.reject(e)}))},t.prototype._getCurrentUserConnectionsForAppAsync=function(e,n,r,o){return __awaiter(this,void 0,Promise,(function(){var i,a,s,c,u,p,d,f,y,m;return __generator(this,(function(g){switch(g.label){case 0:if(!Core.FallbackSwitch.isActivated("AppControls.CurrentUserConnectionsForAppCache")&&this._currentUserConnectionsForAppCache&&r===this._currentUserConnectionsForAppCache.environmentName&&e===this._currentUserConnectionsForAppCache.appId)return l.Log.trackActivityEvent("PowerAppsConnectionService._getCurrentUserConnectionsForAppAsync",{message:"Returning cached user connections for app",environmentName:r,appId:e}),[2,this._currentUserConnectionsForAppCache.cachedData];t.IsPowerPlatformApiEnabled&&!o?(a=e.split("/"),s=a.pop(),i=AppMagic.PowerApps.PowerAppsUtility.createPowerPlatformAppUrlBuilder(s,r)):(i=new l.UrlBuilder(E.PowerAppsUtility.getBaseUrl())).appendPath(e),i.appendPath(t.ConnectionsRoute),c=new _.ODataListItemsTool(i.toString(),t._getResourceName(o),n,"ConnectionService.ListConnectionsForApp",b.NextLink),u={expand:b.ExpandEntityNames.Api,apiVersion:t._getApiVersion(o)},g.label=1;case 1:return g.trys.push([1,3,,4]),[4,c.getItemsAsync(u)];case 2:if((p=g.sent()).resultCode!==_.GetItemsResultCode.Success)throw d=_.GetItemsResultCode[p.resultCode],d+=p.errorMessage?". ".concat(p.errorMessage):"",new l.ApplicationError(d);return f=p.items.map(AppMagic.ConnectionHub.UserConnectionForApp.tryParseFromResponseWithLogging).filter(l.isNotNull),y=Object(l.HashTableUtility_create)(),f.forEach((function(e){y[e.reference]=e})),Core.FallbackSwitch.isActivated("AppControls.CurrentUserConnectionsForAppCache")||(l.Log.trackActivityEvent("PowerAppsConnectionService._getCurrentUserConnectionsForAppAsync",{message:"Caching user connections for app",environmentName:r,appId:e}),this._currentUserConnectionsForAppCache={environmentName:r,appId:e,cachedData:y}),[2,y];case 3:throw m=g.sent(),this.clearCurrentUserConnectionsForAppCache(),Object(l.isCanceledError)(m)||l.CoreLog.error("PowerAppsConnectionService.getCurrentUserConnectionsForAppFromServerAsync",m,"appId: "+e),m;case 4:return[2]}}))}))},t._logGetItemsTelemetry=function(e,t,n){var r={};if(Object(l.isNonEmptyString)(e)){var o=Object(l.exitScopeAndGetRunTime)(e);r.duration=o}Object(l.isDefined)(n)&&(r.itemCount=n),l.Log.trackEvent(t,r)},t.prototype.recordScopeConsentsAsync=function(e,n,r){var i;void 0===r&&(r=!1),t.IsPowerPlatformApiEnabled&&!r?(i=AppMagic.PowerApps.PowerAppsUtility.createPowerPlatformAppUrlBuilder(e,this._environment.name)).appendPath("reportScopesConsent"):(i=new l.UrlBuilder(E.PowerAppsUtility.getPowerAppsAppUrl(e))).appendPath("recordScopesConsent"),i.setQueryParam(T.PowerAppEndpoints.apiVersionKey,t._getApiVersion(r));var a=Object(l.HashTableUtility_create)();return a[w.HeaderName.ContentType]=w.MediaType.ApplicationJson,this._sendHttpRequestIgnoreResponseAsync({bodyData:JSON.stringify(n),method:w.Method.POST,url:i.toString(),headers:a},t._getResourceName(r),t.getServiceType(),o.recordScopeConsentsCall)},t.selectRuntimeUrl=function(e){for(var t=0,n=e.length;t<n;t++)if("https"===e[t].substring(0,5).toLowerCase())return new l.UrlBuilder(e[t]);return null},t.prototype._sendHttpRequestJsonResponseAsync=function(e,n,r,o,i){return t._sendHttpRequestJsonResponseAsync(this._httpClient,e,n,r,o,i)},t.prototype._sendHttpRequestJsonResponseAndSafeCastAsync=function(e,n,r,o,i,a,s){return t._sendHttpRequestJsonResponseAndSafeCastAsync(this._httpClient,e,n,r,o,i,a,s)},t.prototype._sendHttpRequestIgnoreResponseAsync=function(e,n,r,o,i){return t._sendHttpRequestIgnoreResponseAsync(this._httpClient,e,n,r,o,i)},t._sendHttpRequestJsonResponseAsync=function(e,n,r,o,i,a){return n.headers||(n.headers=Object(l.HashTableUtility_create)()),Object(U.e)(n.headers,{resource:r}),Object(N.addServiceErrorOptions)(n,{serviceType:o}),Object(C.appendCustomHeadersOptions)(n,{optInMSHeaders:!0,addCustomHeaders:!0}),t._updateRequestWithTelemetryData(n,i,a),e.sendHttpJsonResponseAsync(n)},t._sendHttpRequestJsonResponseAndSafeCastAsync=function(e,n,r,o,i,a,s,c){return t._sendHttpRequestJsonResponseAsync(e,n,r,o,s,c).then((function(e){var t=i(e);if(!t)throw new j.SafeCastError(a);return t}))},t._sendHttpRequestIgnoreResponseAsync=function(e,n,r,o,i,a){return n.headers||(n.headers=Object(l.HashTableUtility_create)()),Object(U.e)(n.headers,{resource:r}),Object(C.appendCustomHeadersOptions)(n,{optInMSHeaders:!0,addCustomHeaders:!0}),t._updateRequestWithTelemetryData(n,i,a),Object(N.addServiceErrorOptions)(n,{serviceType:o}),e.sendHttpIgnoreResponseAsync(n)},t._updateRequestWithTelemetryData=function(e,t,n){void 0===n&&(n=null),Object(k.addTelemetryOptions)(e,{operationName:t}),n&&Object(k.addTelemetryAdditionalData)(e,n)},t.prototype.ensureConnectionExistsAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n;return __generator(this,(function(r){switch(r.label){case 0:return[4,this.tryGetConnectionAsync(e)];case 1:return(t=r.sent())?[2,t]:[4,this.getApiByIdAsync(e)];case 2:return n=r.sent(),[4,this.addConnectionAsync(n)];case 3:return[2,r.sent()]}}))}))},t.prototype.ensureConnectionDependenciesExistAsync=function(e){var t=this;return e instanceof m.CompositeConnection&&e.dependentConnectionIds&&Object(l.some)(e.dependentConnectionIds,(function(e){return!t._connectionsCache.tryGetItem(e)}))?this._connectionsCache.getItemsAsync().then(l.noOpFn):Promise.resolve()},t.prototype.tryGetCachedConnections=function(){return this._connectionsCache.getItems()},t.prototype.getApisAsync=function(e,t){return void 0===e&&(e=!1),this._apiCache.getItemsAsync(e,void 0,t).then((function(e){return Object(l.HashTableUtility_getValues)(e)}),(function(t){return Object(l.throwIfCanceled)(t),l.CoreLog.error("PowerAppsConnectionService.getApisAsync",t,"bypassCache: "+e),Promise.reject(t)}))},t.prototype.tryGetApiByNameAsync=function(e){return this._apiCache.tryFindFirstItemAsync((function(t){return t.name===e}),l.FindFirstItemOptions.RefreshFromServerIfCacheMiss)},t.prototype.getApiByNameAsync=function(e){return this.tryGetApiByNameAsync(e).then((function(t){if(t)return t;throw new A.PowerAppsConnectionServiceError("Api with id: ".concat(e," is not found"))}))},t.prototype.getApiByIdAsync=function(e){return this._apiCache.getItemAsync(e)},t.prototype.tryGetApiByIdAsync=function(e){return this._apiCache.tryGetItemAsync(e)},t.prototype.getFullApiByIdAsync=function(e,n){return void 0===n&&(n=!1),t._getFullApiByIdAsync(e,this._environment,this._httpClient,void 0,n)},t._getFullApiByIdAsync=function(e,n,r,i,a){return void 0===i&&(i=null),void 0===a&&(a=!1),__awaiter(this,void 0,Promise,(function(){var s,c,u,p;return __generator(this,(function(d){return t.IsPowerPlatformApiEnabled&&!a?(s=t.createPowerPlatformConnectorUrlBuilder(n.name),c=e.split("/"),u=c.pop(),s.appendPath(u)):(s=new l.UrlBuilder(E.PowerAppsUtility.getBaseUrl())).appendPath(e),Object(P.addEnvironmentFilterToUrlBuilder)(n.name,s),s.setQueryParam(T.PowerAppEndpoints.apiVersionKey,t._getApiVersion(a)),p={url:s.toString(),method:w.Method.GET},[2,t._sendHttpRequestJsonResponseAsync(r,p,t._getResourceName(a),t.getServiceType(),o.getApiCall,{apiId:e}).then(AppMagic.ConnectionHub.Api.tryParseFromResponseWithLogging).catch((function(t){return Object(l.throwIfCanceled)(t),!!i&&i(t)||l.CoreLog.error("PowerAppsConnectionService.getFullApiByIdAsync",t,"apiId: ".concat(e,".")),Promise.reject(t)}))]}))}))},t.prototype.getApiWadlXml=function(e){var t={url:e.wadlUrl.toString(),method:w.Method.GET};return Object(M.sendHttpTextResponseAsync)(this._httpClient,t,o.getApiWadlCall,{apiId:e.id})},t.prototype.tryGetConnectionByIdAsync=function(e,t){return void 0===t&&(t=!1),this._connectionsCache.tryGetItemAsync(e,t)},t.prototype.getConnectionsAsync=function(e,n,r,o){return void 0===e&&(e=null),void 0===n&&(n=!1),void 0===o&&(o=!1),__awaiter(this,void 0,Promise,(function(){var i,a,s,c,u,p,d;return __generator(this,(function(f){switch(f.label){case 0:return i=this.tryGetCachedConnections(),a=Object(l.HashTableUtility_getValues)(i),s=a.filter((function(e){return Object(l.isNonEmptyStringOrUndefined)(e.xrmConnectionReferenceLogicalName)||Object(l.isNonEmptyStringOrUndefined)(e.createdXrmConnectionReferenceLogicalName)})),[4,this._getConnectionsHashTableAsync(e,n)];case 1:c=f.sent(),u=0,f.label=2;case 2:return u<s.length?(l.CoreLog.verbose("Found xrm connection references in cached connections"),Object(l.tryGetValueIgnoreCase)(c,s[u].id)?(p=t.constructConnectionId(s[u].name,s[u].apiId),[4,this._getConnectionAsync(p,o,r)]):[3,4]):[3,5];case 3:d=f.sent(),c[s[u].id]=d,f.label=4;case 4:return++u,[3,2];case 5:return[2,Object(l.HashTableUtility_getValues)(c)]}}))}))},t.prototype._getConnectionsHashTableAsync=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),(e?this._connectionsCache.searchItemsAsync((function(t){return t.api.name===e}),t):this._connectionsCache.getItemsAsync(t)).catch((function(n){return Object(l.throwIfCanceled)(n),l.CoreLog.error("PowerAppsConnectionService._getConnectionsHashTableAsync",n,"apiName: ".concat(e,". bypassCache: ").concat(t,".")),Promise.reject(n)}))},t.prototype.getConnectionAsync=function(e,n,r){return void 0===r&&(r=!1),__awaiter(this,void 0,Promise,(function(){var o,i,a;return __generator(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),o=t.constructConnectionId(e,n),[4,this._getConnectionAsync(o,r)];case 1:return i=s.sent(),this._saveConnection(i),[2,i];case 2:throw a=s.sent(),Object(l.throwIfCanceled)(a),l.CoreLog.error("PowerAppsConnectionService.getConnectionAsync",a,"connectionName: ".concat(e,". apiId: ").concat(n,".")),a;case 3:return[2]}}))}))},t.prototype._getConnectionAsync=function(e,n,r){return __awaiter(this,void 0,Promise,(function(){var i,a,c;return __generator(this,(function(u){switch(u.label){case 0:return[4,this._isXrmConnectionReferenceFeatureEnabled()];case 1:return i=u.sent(),a=t._constructConnectionUrlById({connectionId:e,environmentName:this._environment.name,urlType:s.None,addExpandQueryParam:!0,addXrmConnectionReferenceQueryParam:i,isRequestPowerAppsRp:n}),Object(P.addEnvironmentFilterToUrlBuilder)(this._environment.name,a),[4,this._sendHttpRequestJsonResponseAndSafeCastAsync({url:a.toString(),method:w.Method.GET,signal:r},t._getResourceName(n),t.getServiceType(),L.U.safeCast,"IConnectionResponse",o.getConnectionCall,{connectionId:e,isRequestPowerPlatformApi:t.IsPowerPlatformApiEnabled&&!n})];case 2:return c=u.sent(),[2,AppMagic.ConnectionHub.Connection.parse(c)]}}))}))},t.prototype.addConnectionUsingApiIdAsync=function(e){var t=this;return this.getApiByIdAsync(e).then((function(e){return t.addConnectionAsync(e)})).catch((function(t){return Object(l.throwIfCanceled)(t),l.CoreLog.error("PowerAppsConnectionService.addConnectionUsingApiIdAsync",t,"apiId: "+e),Promise.reject(t)}))},t.prototype.updateConnectionAsync=function(e,t,n,r,o,i,a){return l.Log.trackEvent(l.connectionHubUpdateConnection,{connectionName:t}),this._addOrUpdateConnectionAsync(e,t,n,r,o,i,void 0,!1,a)},t.prototype._addOrUpdateConnectionAsync=function(e,n,r,o,i,a,s,c,u){var p,d=this,f=t._generatePutConnectionRequest(e,r,o,a),y={apiId:e.id},m=e.getIsConsentRequired(a);return this.putConnectionAsync(n,e,f,m,s,!1,u).then((function(e){return p=e,!m||e.status.isAuthenticated?e:e.consentInfo?d._getConnectionConsentFromConsentLinkDataAsync(e,d._getConsentLinkData(e.consentInfo),i):d.getConnectionConsentAsync(e,i)})).then((function(e){if(l.Log.trackEvent(l.connectionHubCreateConnectionSucceeded,y),p=e,e.testLink){if(!d._skipTestConnectionEnabled()||c)return d.testConnectionAsync(e);e.isTestConnectionRequiredAfterConsent=!0}})).then((function(){return l.Log.trackEvent(l.connectionHubTestConnectionSucceeded,y),p})).catch((function(n){return Object(l.throwIfCanceled)(n),re(n)?l.Log.trackEvent(l.connectionHubCreateConnectionCanceled,y):n instanceof v.ConnectionError&&n.source===v.ConnectionErrorSource.TestConnection?(l.CoreLog.error("PowerAppsConnectionService.addConnectionAsync",n,"Error in testing the connection. apiId: ".concat(e.id,". gatewayObjectId: ").concat(o||"",".")),l.Log.trackEvent(l.connectionHubTestConnectionFailed,y)):(t._isRtsAccessPremiumConnectionNotAllowedError(e.id,n)||l.CoreLog.error("PowerAppsConnectionService.addConnectionAsync",n,"apiId: ".concat(e.id,". gatewayObjectId: ").concat(o||"",".")),l.Log.trackEvent(l.connectionHubCreateConnectionFailed,y)),p?(l.CoreLog.verbose("Error in consent flow during put connection. Attempting to delete connection."),d.deleteConnectionAsync(p.id,p.apiId).then((function(){return d._connectionsCache.deleteItem(p.id),l.CoreLog.verbose("Connection deleted."),Promise.reject(n)}),(function(e){return Object(l.throwIfCanceled)(e),l.CoreLog.error("PowerAppsConnectionService.addConnectionAsync",e,"Failed to delete connection after failure in put connection."),Promise.reject(e)}))):(l.CoreLog.verbose("No connection was created, nothing to clean up after failure in put connection."),Promise.reject(n))}))},t.prototype.addConnectionAsync=function(e,t,n,r,o,i,a,s){return this._addOrUpdateConnectionAsync(e,Object(l.generateNonDashedUUID)(),t,n,r,o,i,a,s)},t._generatePutConnectionRequest=function(e,t,n,r){var o=t||Object(l.HashTableUtility_create)();if(n){var i={gatewayObjectId:n};o[e.getGatewayParameterName(r)]=i}return r?{properties:{connectionParametersSet:{name:r,values:Object(l.map)(o,(function(e){return{value:e}}))}}}:{properties:{connectionParameters:o}}},t.prototype.putConnectionAsync=function(e,n,r,o,i,a,s){return void 0===o&&(o=!1),void 0===a&&(a=!1),this._putConnectionAsync(e,n,r,o,i,this._environment.name,a,s).catch((function(r){throw Object(l.throwIfCanceled)(r),t._isRtsAccessPremiumConnectionNotAllowedError(n.id,r)||l.CoreLog.error("PowerAppsConnectionService.putConnectionAsync",r,"connectionName: ".concat(e,". apiId: ").concat(n.id,".")),v.ConnectionError.createConnectionError(r,v.ConnectionErrorSource.PutConnection,D.e,n)}))},t.prototype._isXrmConnectionReferenceFeatureEnabled=function(){return __awaiter(this,void 0,Promise,(function(){var e;return __generator(this,(function(n){switch(n.label){case 0:return(e=!Object(l.isNullOrUndefined)(t.ConnectionReferenceEntityExists))?[4,t.ConnectionReferenceEntityExists]:[3,2];case 1:e=n.sent(),n.label=2;case 2:return[2,e]}}))}))},t.prototype._putConnectionAsync=function(e,n,r,i,a,c,u,p){var d;return void 0===i&&(i=!1),__awaiter(this,void 0,Promise,(function(){var f,y,m,g;return __generator(this,(function(v){switch(v.label){case 0:return(f=Object(l.HashTableUtility_create)())[w.HeaderName.ContentType]=w.MediaType.ApplicationJson,r.properties.environment={id:this._environment.id,name:this._environment.name},y=t._constructConnectionUrl({connectionName:e,connectionApiId:n.id,environmentName:c,urlType:s.None,isRequestPowerAppsRp:u}),i&&(r.properties.consentInfo={redirectUrl:this._callbackUri.toString()},y.setQueryParam(R.ODataConstants.QueryOption.Expand,b.ExpandEntityNames.ConsentLink)),[4,this._isXrmConnectionReferenceFeatureEnabled()];case 1:return v.sent()&&n.isConnectionShareable(null===(d=r.properties.connectionParametersSet)||void 0===d?void 0:d.name)&&a&&this._setXrmConnectionReferenceQueryParams(y,a),[4,this._sendHttpRequestJsonResponseAndSafeCastAsync({url:y.toString(),method:w.Method.PUT,headers:f,bodyData:JSON.stringify(r),signal:p},t._getResourceName(u),t.getServiceType(),L.U.safeCast,"IConnectionResponse",o.createConnectionCall,{apiId:n.id,isRequestPowerPlatformApi:t.IsPowerPlatformApiEnabled&&!u})];case 2:return m=v.sent(),g=AppMagic.ConnectionHub.Connection.parse(m,n),this._connectionsCache.setItem(g.id,g),[2,g]}}))}))},t.prototype.testConnectionAsync=function(e){var t=e.testLink.requestUri.toString();return this._sendHttpRequestIgnoreResponseAsync({url:t,method:e.testLink.method,retryable:{maxRetries:2,statusCodes:[w.HttpStatusCode.BadRequest]}},U.d.AppService,D.b,o.testConnectionCall,{apiId:e.apiId,requestUri:t}).then(null,(function(t){throw v.ConnectionError.createConnectionError(t,v.ConnectionErrorSource.TestConnection,D.b,e.api)}))},t.prototype.deleteConnectionAsync=function(e,n,r){var i,a=this;if(void 0===r&&(r=!1),t.IsPowerPlatformApiEnabled&&!r)i=t._constructConnectionUrlById({connectionId:e,environmentName:this._environment.name,urlType:s.None,isRequestPowerAppsRp:r});else{(i=new l.UrlBuilder(E.PowerAppsUtility.getBaseUrl())).appendPath(n),i.appendPath(t.ConnectionsRoute);var c=e.split("/");i.appendPath(c[c.length-1]),i.setQueryParam(T.PowerAppEndpoints.apiVersionKey,d.Region.getCurrentRegion().powerAppsApiVersion)}return Object(P.addEnvironmentFilterToUrlBuilder)(this._environment.name,i),this._sendHttpRequestIgnoreResponseAsync({url:i.toString(),method:w.Method.DELETE},t._getResourceName(r),t.getServiceType(),o.deleteConnectionCall,{apiId:n,isRequestPowerPlatformApi:t.IsPowerPlatformApiEnabled&&!r}).then((function(){return a._connectionsCache.deleteItem(e)})).catch((function(t){return Object(l.throwIfCanceled)(t),l.CoreLog.error("PowerAppsConnectionService.deleteConnectionAsync",t,"connectionId: ".concat(e,". apiId: ").concat(n,".")),Promise.reject(t)}))},t.prototype._getAvailableRtsNamespacesAsync=function(){var e=y.CdsUtility.createCdsProviderUrlBuilder();return e.appendPath(f.CdsEndpoints.namespacesPath),e.setQueryParam(R.ODataConstants.QueryOption.Filter,Object(P.getEnvironmentFilter)(this._environment.name)),e.setQueryParam(T.PowerAppEndpoints.apiVersionKey,y.CdsUtility.getApiVersion()),this._sendHttpRequestJsonResponseAndSafeCastAsync({url:e.toString(),method:w.Method.GET},U.d.PowerAppsService,D.e,L.Eg.safeCast,"IRuntimeUserNamespaceResponse",o.getRtsNamespaces).then((function(e){return e.value}))},t.prototype.tryGetConnectionAsync=function(e){return this._connectionsCache.tryFindFirstItemAsync((function(t){return t.apiId===e}))},t.prototype.getAllConnectionDependenciesAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n,r;return __generator(this,(function(o){switch(o.label){case 0:t=Object(l.HashTableUtility_create)(),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this._getConnectionsHashTableAsync(null,!0)];case 2:return n=o.sent(),[3,4];case 3:return r=o.sent(),l.CoreLog.error("PowerAppsConnectionService.getAllConnectionDependenciesAsync",r,"Could not get connections from server. Using cached connections instead."),n=this.tryGetCachedConnections(),[3,4];case 4:return[4,this._getAllConnectionDependenciesAsync(e,t,n)];case 5:return[2,o.sent()]}}))}))},t.prototype._getAllConnectionDependenciesAsync=function(e,t,n){return __awaiter(this,void 0,Promise,(function(){var r,o,i,a,s,c=this;return __generator(this,(function(u){switch(u.label){case 0:return t[e.id]?[2,[]]:(t[e.id]=!0,r=e.dependentConnectionIds,Object(l.HashTableUtility_isEmpty)(r)?[2,[]]:(o=[],i=function(r){return __awaiter(c,void 0,Promise,(function(){var i;return __generator(this,(function(a){switch(a.label){case 0:return(i=Object(l.tryGetValueIgnoreCase)(n,r))?[3,2]:[4,this._getConnectionAsync(r)];case 1:i=a.sent(),n[i.id]=i,a.label=2;case 2:if(!this._useEnhancedSqlConnection&&AppMagic.ConnectionHub.PowerAppsConnectionService.isSqlNonSharedConnection(i))throw l.Log.trackErrorEvent("PowerAppsConnectionService.getAllConnectionDependenciesAsync",{errorMessage:"Powerapps does not currently support SQL connections with AAD"}),new A.PowerAppsConnectionServiceError("Flow with id: ".concat(e.id," has dependent SQL AAD connection"));return t[i.id]||o.push(i),i instanceof m.CompositeConnection?[4,this._getAllConnectionDependenciesAsync(i,t,n)]:[3,4];case 3:a.sent().forEach((function(e){return o.push(e)})),a.label=4;case 4:return[2]}}))}))},a=[],s=new l.PromiseQueue("_getAllConnectionDependenciesAsync"),Object(l.HashTableUtility_forEach)(r,(function(e){a.push(s.pushJob((function(){return i(e)})))})),[4,Object(l.PromiseUtility_join)(a)]));case 1:return u.sent(),[2,o]}}))}))},t.prototype.getAvailableRtsNamespacesAsync=function(){return this._getAvailableRtsNamespacesAsync().then((function(e){return e.map((function(e){return{name:e.properties.id,displayName:e.properties.displayName}}))})).catch((function(e){return Object(l.throwIfCanceled)(e),l.CoreLog.error("PowerAppsConnectionService.getAvailableRtsNamespacesAsync",e),Promise.reject(e)}))},t.prototype.getConnectionConsentAsync=function(e,t,n){var r=this;return void 0===n&&(n=!1),this._getConnectionConsentLinkAsync(e.name,e.apiId,this._environment.name,n).then((function(o){return r._getConnectionConsentFromConsentLinkDataAsync(e,o,t,n)}))},t.prototype._getConnectionConsentFromConsentLinkDataAsync=function(e,t,n,r){return __awaiter(this,void 0,Promise,(function(){var o,i,a,s;return __generator(this,(function(c){switch(c.label){case 0:o=n&&n.manualLoginSettings===AppMagic.ConnectionHub.ManualLoginSettings.Force,c.label=1;case 1:if(c.trys.push([1,14,,15]),!t.isFirstParty||o)return[3,9];c.label=2;case 2:return c.trys.push([2,4,,8]),[4,this._onBehalfOfAsync(e.apiId,t)];case 3:return c.sent(),[3,8];case 4:if(i=c.sent(),Object(l.throwIfCanceled)(i),!w.HttpStatusCode.isClientErrorCode(i.response.status)&&!w.HttpStatusCode.isServerErrorCode(i.response.status))throw i;return t.isFirstParty=!1,n&&n.manualLoginSettings===AppMagic.ConnectionHub.ManualLoginSettings.Disable?(l.Log.trackActivityEvent("PowerAppsConnectionService._getConnectionConsentFromConsentLinkDataAsync",{message:"Silent SSO failed, but disable manual login set. Neither SSO nor manual sign in will occur."}),[3,7]):[3,5];case 5:return[4,this._manualSignInAsync(e.name,e.apiId,t,r)];case 6:c.sent(),c.label=7;case 7:return[3,8];case 8:return[3,12];case 9:return n&&n.manualLoginSettings===AppMagic.ConnectionHub.ManualLoginSettings.Disable?(l.Log.trackActivityEvent("PowerAppsConnectionService._getConnectionConsentFromConsentLinkDataAsync",{message:"Disable manual login set. Neither SSO nor manual sign in will occur."}),[3,12]):[3,10];case 10:return[4,this._manualSignInAsync(e.name,e.apiId,t,r)];case 11:c.sent(),c.label=12;case 12:return[4,this.getConnectionAsync(e.name,e.apiId)];case 13:if(!(a=c.sent()).status.isAuthenticated)throw new Error(AppMagic.Strings.ConnectionHubReGetConnectionConsentLinkError);return l.CoreLog.verbose("Successfully completed consent flow."),[2,a];case 14:throw s=c.sent(),Object(l.throwIfCanceled)(s),re(s)||l.CoreLog.error("PowerAppsConnectionService.getConnectionConsentAsync",Object(l.scrubSensitiveDataFromError)(s,["error","webPlayerUrl"]),"connectionName: ".concat(e.name,". apiId: ").concat(e.apiId,".")),s;case 15:return[2]}}))}))},t.prototype._onBehalfOfAsync=function(e,t){var n={url:new l.UrlBuilder(t.firstPartyUrl).toString(),method:w.Method.POST,headers:Object(l.HashTableUtility_create)()};return n.headers[w.HeaderName.ContentType]=w.MediaType.ApplicationJson,Object(U.e)(n.headers,{resource:U.d.ConsentServer,sendAsBody:!0}),Object(C.appendCustomHeadersOptions)(n,{optInMSHeaders:!0,addCustomHeaders:!0}),Object(M.sendHttpIgnoreResponseAsync)(this._httpClient,n,o.firstPartyConsent,{apiId:e})},t.prototype._manualSignInAsync=function(e,t,n,r){var o=this;return this._brokerManager.requestAccessToken(n.consentUrl.toString(),this._callbackUri.toString(),Object(l.HashTableUtility_create)(),S.BrowserType.System).then(V.getAsyncResultResultOrThrow).then((function(n){var i=new l.Core_Url(n),a=i.getQueryParamFirstValue(Q);if(Object(l.isNonEmptyNonWhitespaceString)(a)){var s=Object(l.tryDecodeBase64String)(a),c="Error retrieving connection consent.";throw s&&(c+=" Server response error: "+s),new A.PowerAppsConnectionServiceError(c,s)}var u=i.getQueryParamFirstValue("code");if(Object(l.isNonEmptyNonWhitespaceString)(u))return l.CoreLog.verbose("Posting confirmConsentCode: {0}",u),o._postConfirmConsentCodeAsync(e,t,u,r)}))},t.prototype._saveConnection=function(e){this._connectionsCache.setItem(e.id,e)},t.isRuntimeServiceApi=function(e){return Object(l.equalsIgnoreCase)(e,b.ApiIds.RuntimeService)},t.isSqlNonSharedConnection=function(e){var n=t.isSqlApi(e.apiId),r=Object(l.equalsIgnoreCase)(e.multiAuthParametersSetName,AppMagic.ConnectionHub.Constants.MultiAuthConnectionParametersSetNames.AadAuth)||Object(l.equalsIgnoreCase)(e.multiAuthParametersSetName,AppMagic.ConnectionHub.Constants.MultiAuthConnectionParametersSetNames.AadComAuth)||Object(l.equalsIgnoreCase)(e.multiAuthParametersSetName,AppMagic.ConnectionHub.Constants.MultiAuthConnectionParametersSetNames.WindowsNonShared);return n&&r},t.isSqlNonSharedConnectionReference=function(e){return AppMagic.ConnectionHub.PowerAppsConnectionService.isSqlApi(e.id)&&!e.sharedConnectionId},t.isExperimentalRuntimeServiceApi=function(e){return Object(l.equalsIgnoreCase)(e,b.ApiIds.ExperimentalRuntimeService)},t.isAnyRuntimeServiceApi=function(e){return t.isRuntimeServiceApi(e)||t.isExperimentalRuntimeServiceApi(e)},t.isSqlApi=function(e){return Object(l.equalsIgnoreCase)(e,AppMagic.ConnectionHub.Constants.ApiIds.Sql)||Object(l.equalsIgnoreCase)(e,AppMagic.ConnectionHub.Constants.ApiIds.SqlV2)||Object(l.equalsIgnoreCase)(e,AppMagic.ConnectionHub.Constants.ApiIds.SqlAAD)||Object(l.equalsIgnoreCase)(e,AppMagic.ConnectionHub.Constants.ApiIds.SqlGcc)||Object(l.equalsIgnoreCase)(e,AppMagic.ConnectionHub.Constants.ApiIds.SqlWinNonShared)},t._isRtsAccessPremiumConnectionNotAllowedError=function(e,n){if(!t.isRuntimeServiceApi(e))return!1;var r=Object(O.errorHasHttpResponse)(n)&&n.response;if(!r||r.status!==w.HttpStatusCode.Forbidden)return!1;var o=Object(l.tryParseJson)(r.responseText);if(!o)return!1;var i=L.yg.safeCast(o);return!!i&&"AccessPremiumConnectionNotAllowed"===i.error.code},t.tryGetGatewayObjectId=function(e){var t=null;return e.connectionParameters&&Object(l.HashTableUtility_every)(e.connectionParameters,(function(n,r){var o=e.api.getConnectionParameters()[r];if(o&&o.type===a.GatewaySetting){var i=L.Zb.safeCast(n);if(i&&i.gatewayObjectId)return t=i.gatewayObjectId,!1}return!0})),t},t.prototype.getCurrentUserConnectionsForAppAsync=function(e,t){return void 0===t&&(t=!1),__awaiter(this,void 0,Promise,(function(){return __generator(this,(function(n){switch(n.label){case 0:return[4,this._getCurrentUserConnectionsForAppAsync(e,this._httpClient,this._environment.name,t)];case 1:return[2,n.sent()]}}))}))},t.prototype.clearCurrentUserConnectionsForAppCache=function(){l.Log.trackActivityEvent("PowerAppsConnectionService.clearCurrentUserConnectionsForAppCache"),this._currentUserConnectionsForAppCache=null},t.prototype.postConnectionUsageAsync=function(e,n,r,i,a,s){var c;if(void 0===s&&(s=!1),this.clearCurrentUserConnectionsForAppCache(),t.IsPowerPlatformApiEnabled&&!s){c=AppMagic.PowerApps.PowerAppsUtility.createPowerPlatformPowerAppsUrlBuilder(this._environment.name);var u=n.split("/").pop();c.appendPath("".concat(t.ApiRoute,"/").concat(u))}else(c=new l.UrlBuilder(E.PowerAppsUtility.getBaseUrl())).appendPath(n);c.appendPath(t.ConnectionsRoute),c.appendPath(r),c.appendPath(t.UsagesRoute),c.setQueryParam(T.PowerAppEndpoints.apiVersionKey,t._getApiVersion(s)),Object(P.addEnvironmentFilterToUrlBuilder)(this._environment.name,c);var p=Object(l.HashTableUtility_create)();p[w.HeaderName.ContentType]=w.MediaType.ApplicationJson;var d={properties:{reference:i,resourceId:E.PowerAppsUtility.getPowerAppsAppId(e),appActions:Core.FallbackSwitch.isActivated("AppConnectivity.GranularConsentDialogV2")?[]:a}};return this._sendHttpRequestJsonResponseAndSafeCastAsync({url:c.toString(),method:w.Method.POST,headers:p,bodyData:JSON.stringify(d)},t._getResourceName(s),t.getServiceType(),L.V.safeCast,"IConnectionUsage",o.addConnectionUsageCall,{apiId:n}).catch((function(e){return Object(l.throwIfCanceled)(e),l.CoreLog.error("PowerAppsConnectionService.postConnectionUsageAsync",e,"connectionName: ".concat(r,". apiId: ").concat(n,".")),Promise.reject(e)}))},t.prototype.deleteConnectionUsageAsync=function(e){var t=new l.UrlBuilder(E.PowerAppsUtility.getBaseUrl());return t.appendPath(e),t.setQueryParam(T.PowerAppEndpoints.apiVersionKey,d.Region.getCurrentRegion().powerAppsApiVersion),Object(P.addEnvironmentFilterToUrlBuilder)(this._environment.name,t),this._sendHttpRequestIgnoreResponseAsync({method:w.Method.DELETE,url:t.toString()},U.d.PowerAppsService,D.e,o.removeConnectionUsageCall).catch((function(t){return Object(l.throwIfCanceled)(t),l.CoreLog.error("PowerAppsConnectionService.deleteConnectionUsageAsync",t,"usageId: "+e),Promise.reject(t)}))},t.prototype.listConnectionUsagesAsync=function(e){var n;if(t.IsPowerPlatformApiEnabled){var r=e.split("/"),i=r.pop();r.pop();var a=r.pop();(n=AppMagic.PowerApps.PowerAppsUtility.createPowerPlatformEnvironmentUrlBuilder(this._environment.name)).appendPath(t._constructPowerPlatformApiConnectivityPath(i,a))}else(n=new l.UrlBuilder(E.PowerAppsUtility.getBaseUrl())).appendPath(e);return n.appendPath(t.UsagesRoute),n.setQueryParam(T.PowerAppEndpoints.apiVersionKey,t.getApiVersion()),Object(P.addEnvironmentFilterToUrlBuilder)(this._environment.name,n),this._sendHttpRequestJsonResponseAndSafeCastAsync({method:w.Method.GET,url:n.toString()},t.getResourceName(),t.getServiceType(),L.Kg.safeCast,"IServerListConnectionUsage",o.listConnectionUsageCall,{connectionId:e}).then((function(e){return e.value})).catch((function(t){return Object(l.throwIfCanceled)(t),l.CoreLog.error("PowerAppsConnectionService.listConnectionUsagesAsync",t,"connectionId: "+e),Promise.reject(t)}))},t.prototype.getGatewaysAsync=function(e){var n=e.split("/").pop(),r=t.IsPowerPlatformApiEnabled?t.createPowerPlatformConnectivityUrlBuilder(this._environment.name):E.PowerAppsUtility.createPowerAppsProviderUrlBuilder();!Object(l.isSovereignCloudRegion)()&&l.authoring.enableVNetGateways?r.appendPath(t.GatewayClustersRoute):r.appendPath(t.GatewaysRoute);var i=R.ODataConstants,a=Object(l.CoreUtility_formatString)("{0} {1} '{2}'","apiName",i.QueryOption.FilterOperators.Equals,n);return a=a+" "+i.QueryOption.FilterOperators.And+" "+Object(P.getEnvironmentFilter)(this._environment.name),r.setQueryParam(i.QueryOption.Filter,a),r.setQueryParam(T.PowerAppEndpoints.apiVersionKey,t.getApiVersion()),this._sendHttpRequestJsonResponseAndSafeCastAsync({method:w.Method.GET,url:r.toString()},t.getResourceName(),t.getServiceType(),L.ec.safeCast,"IGetGatewaysResponse",o.getGatewaysCall).then((function(e){return e.value})).catch((function(t){return Object(l.throwIfCanceled)(t),l.CoreLog.error("PowerAppsConnectionService.getGatewaysAsync",t,"apiId: "+e),Promise.reject(t)}))},t.createPowerPlatformConnectorUrlBuilder=function(e){var n=t.createPowerPlatformConnectivityUrlBuilder(e);return n.appendPath(t.ConnectorRoute),n},t.createPowerPlatformConnectionUrlBuilder=function(e){var n=t.createPowerPlatformConnectivityUrlBuilder(e);return n.appendPath(t.ConnectionsRoute),n},t.createPowerPlatformConnectivityUrlBuilder=function(e){var n=E.PowerAppsUtility.createPowerPlatformEnvironmentUrlBuilder(e);return n.appendPath(t.ConnectivityRoute),n},t.getResourceName=function(){return t.IsPowerPlatformApiEnabled?U.d.PowerPlatformService:U.d.PowerAppsService},t.getApiVersion=function(){return t.IsPowerPlatformApiEnabled?E.PowerAppsUtility.getPowerPlatformApiVersion():E.PowerAppsUtility.getApiVersion()},t.getServiceType=function(){return t.IsPowerPlatformApiEnabled?D.e:D.d},t.prototype._getConnectionConsentLinkAsync=function(e,n,r,i){var a=this,c=Object(l.HashTableUtility_create)();c[w.HeaderName.ContentType]=w.MediaType.ApplicationJson;var u={redirectUrl:this._callbackUri.toString()},p=t._constructConnectionUrl({connectionName:e,connectionApiId:n,environmentName:r,urlType:s.GetConsentLink,isRequestPowerAppsRp:i});return Object(P.addEnvironmentFilterToUrlBuilder)(this._environment.name,p),this._sendHttpRequestJsonResponseAndSafeCastAsync({url:p.toString(),method:w.Method.POST,headers:c,bodyData:JSON.stringify(u)},t._getResourceName(i),t.getServiceType(),L.cc.safeCast,"IGetConnectionConsentLinkResponse",o.getConsentLinkCall,{apiId:n,isRequestPowerPlatformApi:t.IsPowerPlatformApiEnabled&&!i}).then((function(e){return a._getConsentLinkData(e)}))},t.prototype._getConsentLinkData=function(e){var t=this._clientSettings.singleSignOnEnabled&&Object(l.isAbsoluteUrlString)(e.firstPartyLoginUri);return{isFirstParty:t,consentUrl:new l.Core_Url(e.consentLink),firstPartyUrl:t?new l.Core_Url(e.firstPartyLoginUri):null}},t.prototype._postConfirmConsentCodeAsync=function(e,n,r,i){var a=Object(l.HashTableUtility_create)();a[w.HeaderName.ContentType]=w.MediaType.ApplicationJson;var c={code:r},u=t._constructConnectionUrl({connectionName:e,connectionApiId:n,environmentName:this._environment.name,urlType:s.ConfirmConsentCode,isRequestPowerAppsRp:i});return Object(P.addEnvironmentFilterToUrlBuilder)(this._environment.name,u),this._sendHttpRequestIgnoreResponseAsync({url:u.toString(),method:w.Method.POST,headers:a,bodyData:JSON.stringify(c)},t._getResourceName(i),t.getServiceType(),o.confirmConsentCodeCall,{apiId:n,isRequestPowerPlatformApi:t.IsPowerPlatformApiEnabled&&!i})},t.constructConnectionId=function(e,n){return"".concat(n,"/").concat(t.ConnectionsRoute,"/").concat(e)},t._constructPowerPlatformApiConnectivityPath=function(e,n){return"/".concat(t.ConnectivityRoute,"/").concat(t.ApiRoute,"/").concat(n,"/").concat(t.ConnectionsRoute,"/").concat(e)},t._getResourceName=function(e){return t.IsPowerPlatformApiEnabled&&!e?U.d.PowerPlatformService:U.d.PowerAppsService},t._getApiVersion=function(e){return t.IsPowerPlatformApiEnabled&&!e?d.Region.getCurrentRegion().powerPlatformRpApiVersion:d.Region.getCurrentRegion().powerAppsApiVersion},t._constructConnectionUrl=function(e){var n=e.connectionName,r=e.connectionApiId,o=e.environmentName,i=e.urlType,a=e.addExpandQueryParam,s=void 0!==a&&a,c=e.addXrmConnectionReferenceQueryParam,u=void 0!==c&&c,p=e.isRequestPowerAppsRp;return this._constructConnectionUrlById({connectionId:t.constructConnectionId(n,r),urlType:i,environmentName:o,addExpandQueryParam:s,addXrmConnectionReferenceQueryParam:u,isRequestPowerAppsRp:p})},t._constructConnectionUrlById=function(e){var n,r=e.connectionId,o=e.urlType,i=e.environmentName,a=e.addExpandQueryParam,c=void 0!==a&&a,u=e.addXrmConnectionReferenceQueryParam,p=void 0!==u&&u,d=e.isRequestPowerAppsRp;if(t.IsPowerPlatformApiEnabled&&!d){var f=r.split("/"),y=f.pop();f.pop();var m=f.pop();(n=AppMagic.PowerApps.PowerAppsUtility.createPowerPlatformEnvironmentUrlBuilder(i)).appendPath(t._constructPowerPlatformApiConnectivityPath(y,m))}else(n=new l.UrlBuilder(E.PowerAppsUtility.getBaseUrl())).appendPath(r);switch(o){case s.GetConsentLink:n.appendPath(t.GetConsentLinkRoute);break;case s.ConfirmConsentCode:n.appendPath(t.ConfirmConsentCodeRoute)}return c&&p?n.setQueryParam(R.ODataConstants.QueryOption.Expand,b.ExpandEntityNames.Api.concat(Object(l.CoreUtility_formatString)(",{0}",b.ExpandEntityNames.ConnectionReference))):c?n.setQueryParam(R.ODataConstants.QueryOption.Expand,b.ExpandEntityNames.Api):p&&n.setQueryParam(R.ODataConstants.QueryOption.Expand,b.ExpandEntityNames.ConnectionReference),n.setQueryParam(T.PowerAppEndpoints.apiVersionKey,t._getApiVersion(d)),n},t.prototype.applyDisambiguationRules=function(e){return this._disambiguationRuleManager.executeRules(e)},t.prototype.saveUserConsentsAsync=function(e,n){if(0===(null==n?void 0:n.length))return l.Log.trackActivityEvent("PowerAppsConnectionService.saveUserConsentsAsync",{message:"No user consents to save"}),Promise.resolve();var r=null;if(t.IsPowerPlatformApiEnabled){var i="string"==typeof e?e.split("/").pop():e.appLogicalName;(r=E.PowerAppsUtility.createPowerPlatformAppUrlBuilder(i,this._environment.name)).appendPath("consent")}else"string"==typeof e?((r=new l.UrlBuilder(E.PowerAppsUtility.getBaseUrl())).appendPath(e),r.appendPath("consent")):((r=AppMagic.PowerApps.PowerAppsUtility.createPowerAppsProviderUrlBuilder(!1,!0)).appendPath(T.PowerAppEndpoints.environmentsValue),r.appendPath(e.environmentId),r.appendPath(T.PowerAppEndpoints.appsValue),r.appendPath(e.appLogicalName),r.appendPath("recordConsent"));r.setQueryParam(T.PowerAppEndpoints.apiVersionKey,t.getApiVersion());var a=Object(l.HashTableUtility_create)();a[w.HeaderName.ContentType]=w.MediaType.ApplicationJson;var s=n.map((function(e){return __assign(__assign({},e),{consent:"Yes"})}));return this._sendHttpRequestIgnoreResponseAsync({bodyData:JSON.stringify(s),method:w.Method.POST,url:r.toString(),headers:a},t.getResourceName(),t.getServiceType(),o.saveUserConsentCall)},t.prototype.isSsoAuthValid=function(e){if(!e.isApiFirstParty)return!1;if(!this._userIdentity.email)return l.CoreLog.error("PowerAppsConnectionService.isSsoAuthValid","No user is logged in."),!1;var t=e.accountName?e.accountName.toLowerCase().trim():null;return!!this.isConnectionForCurrentUser(e)||(l.Log.trackActivityEvent("PowerAppsConnectionService.isSsoAuthValid",{message:"Email associated with connection does not match email of logged in user.",accountName:Object(l.scrubSensitiveDataSafe)(t),connectionId:e.id}),!1)},t.getParameterSetName=function(e){var t=e.authenticationType,n=AppMagic.ConnectionHub.PowerAppsConnectionService.isSqlNonSharedConnectionReference(e);return!t&&n&&(t=AppMagic.ConnectionHub.Constants.MultiAuthConnectionParametersSetNames.AadAuth),t},t.prototype.updateXrmConnectionReference=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this._isXrmConnectionReferenceFeatureEnabled()];case 1:return t.sent()?[4,this._getConnectionAsync(e)]:[3,3];case 2:return[2,t.sent()];case 3:return[2,null]}}))}))},t.prototype._setXrmConnectionReferenceQueryParams=function(e,t){e.setQueryParam(AppMagic.ConnectionHub.Constants.CreateConnectionReference,"true"),e.setQueryParam(AppMagic.ConnectionHub.Constants.SolutionId,t)},t.isD365Api=function(e){return Object(l.equalsIgnoreCase)(e,AppMagic.ConnectionHub.Constants.ApiIds.DynamicsCRMOnline)},t.prototype.isConnectionForCurrentUser=function(e){return!this._userIdentity.email||Object(l.isEmptyString)(this._userIdentity.email)?(l.CoreLog.errorEx("PowerAppsConnectionService.isConnectionForCurrentUser","UserIdentity email is not set"),!1):t.userMatchesConnectionAccount(e,this._userIdentity.email)},t.userMatchesConnectionAccount=function(e,t){if(!e.accountName||Object(l.isEmptyString)(e.accountName))return l.CoreLog.warningEx("PowerAppsConnectionService.isConnectionForCurrentUser","Connection missing accountName",{eventData:{connectionId:e.id,apiId:e.apiId}}),!1;var n=e.accountName.toLowerCase().trim(),r=t.toLowerCase().trim();return n.includes(r)},t.prototype._skipTestConnectionEnabled=function(){return Object(l.equalsIgnoreCase)(Object(l.getMobilePlayerFlavor)(),"shrinkwrap")&&this._isSkipTestConnectionEnabled},t.ConnectionsRoute="connections",t.ConnectivityRoute="connectivity",t.ConnectorRoute="connectors",t.ApiRoute="apis",t._isPowerPlatformApiEnabled=null,t.GetConsentLinkRoute="getConsentLink",t.ConfirmConsentCodeRoute="confirmConsentCode",t.UsagesRoute="usages",t.GatewaysRoute="gateways",t.GatewayClustersRoute="gatewayClusters",__decorate([initializeOnLoad((function(){return new l.Core_Url("https://www.microsoft.com/")}))],t,"RedirectUri",void 0),t}(l.Disposable)},function(e,t,n){"use strict";var r;n.r(t),n.d(t,"TTypeValueKind",(function(){return r})),n.d(t,"HttpStringBasedTTypeValueKinds",(function(){return i})),n.d(t,"JsonTTypeValueKinds",(function(){return a})),n.d(t,"XmlSimpleTTypeValueKinds",(function(){return s})),n.d(t,"NumericXsdType",(function(){return o})),function(e){e[e.Boolean=0]="Boolean",e[e.Number=1]="Number",e[e.String=2]="String",e[e.Guid=3]="Guid",e[e.JsonObject=4]="JsonObject",e[e.JsonUntypedObject=5]="JsonUntypedObject",e[e.JsonArray=6]="JsonArray",e[e.CdpNavigation=7]="CdpNavigation",e[e.CdpAttachment=8]="CdpAttachment",e[e.CdpPolymorphicLookup=9]="CdpPolymorphicLookup",e[e.Binary=10]="Binary",e[e.Xml2JsonElement=11]="Xml2JsonElement",e[e.DomNode=12]="DomNode",e[e.CdpObjectOptionSet=13]="CdpObjectOptionSet",e[e.CdpArrayOptionSet=14]="CdpArrayOptionSet",e[e.CdsObject=15]="CdsObject",e[e.CdsAttachment=16]="CdsAttachment",e[e.Identity=17]="Identity",e[e.XmlIdentity=18]="XmlIdentity",e[e.CdsOptionSet=19]="CdsOptionSet",e[e.CdsArrayOptionSet=20]="CdsArrayOptionSet",e[e.File=21]="File",e[e.LargeImage=22]="LargeImage",e[e.CdsPolymorphicLookup=23]="CdsPolymorphicLookup"}(r||(r={}));var o,i=[r.Identity,r.String],a=[r.Identity,r.Boolean,r.Number,r.String,r.Guid,r.JsonObject,r.JsonUntypedObject,r.JsonArray,r.CdpNavigation,r.CdpAttachment,r.CdpPolymorphicLookup,r.CdpObjectOptionSet,r.CdpArrayOptionSet,r.CdsAttachment,r.CdsObject,r.CdsOptionSet,r.CdsArrayOptionSet,r.File,r.LargeImage,r.CdsPolymorphicLookup],s=[r.XmlIdentity,r.Boolean,r.Number,r.String];!function(e){e[e.Decimal=0]="Decimal",e[e.Float=1]="Float",e[e.Double=2]="Double",e[e.Int=3]="Int",e[e.Long=4]="Long",e[e.UnsignedInt=5]="UnsignedInt",e[e.UnsignedLong=6]="UnsignedLong"}(o||(o={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"h",(function(){return p})),n.d(t,"g",(function(){return l}));var r,o=n(0),i=n(3),a=(n(1),"paclient-auth"),s=a+" ";function c(e,t){var n=JSON.stringify(t);e[i.HeaderName.Authorization]=s+n}function u(e,t){var n=JSON.stringify(t);e.addHeader(i.HeaderName.Authorization,s+n)}function p(e){return e===a}function l(e){var t=e.headers&&e.headers[i.HeaderName.Authorization];return!!t&&p(t.substr(0,a.length))}!function(e){e.AppService="appservice",e.ConsentServer="consentserver",e.Flows="flows",e.PowerAppsService="powerappsservice",e.PowerPlatformService="powerplatformservice",e.PowerBI="powerbi",e.RTSDataService="rtsdataservice",e.MicrosoftGraph="microsoftgraph",e.FormsPro="formspro",e.MicrosoftStream="microsoftstream";var t=Object(o.HashTableUtility_create)({appservice:e.AppService,consentserver:e.ConsentServer,flows:e.Flows,powerappsservice:e.PowerAppsService,powerbi:e.PowerBI,rtsdataservice:e.RTSDataService,formspro:e.FormsPro,microsoftstream:e.MicrosoftStream});e.tryConvertFromString=function(e){return"string"!=typeof e?null:t[e.toLowerCase()]||null}}(r||(r={}))},function(e,t,n){"use strict";var r;n.r(t),n.d(t,"Status",(function(){return r})),n.d(t,"NextLink",(function(){return d})),n.d(t,"FileSource",(function(){return f})),n.d(t,"CustomApiSourceId",(function(){return y})),n.d(t,"UnspecifiedApiSourceId",(function(){return m})),n.d(t,"CustomApimAppSource",(function(){return g})),n.d(t,"ExtendedMetadataSources",(function(){return o})),n.d(t,"UrlEncoding",(function(){return i})),n.d(t,"ApiNames",(function(){return a})),n.d(t,"ApiIds",(function(){return s})),n.d(t,"MultiAuthConnectionParametersSetNames",(function(){return c})),n.d(t,"ExpandEntityNames",(function(){return u})),n.d(t,"ErrorCode",(function(){return p})),n.d(t,"RtsProvisioningStatus",(function(){return l})),n.d(t,"DefaultDatasetName",(function(){return h})),n.d(t,"CdsDefaultDatasetName",(function(){return A})),n.d(t,"CurrentEnvironmentLogicalName",(function(){return C})),n.d(t,"CreateConnectionReference",(function(){return P})),n.d(t,"SolutionId",(function(){return w})),n.d(t,"FlowDependentConnectionSource",(function(){return v})),n.d(t,"FlowInstallConnectionKeys",(function(){return b})),n.d(t,"SqlStoredProcedures",(function(){return S})),function(e){!function(e){e.alertCritical="RGBA(232, 17, 35, 1)",e.alertInfo="RGBA(80, 80, 80, 1)",e.alertWarning="RGBA(155, 0, 98, 1)"}(e.ActionLinkColors||(e.ActionLinkColors={})),function(e){e.tooManyRequests="https://go.microsoft.com/fwlink/?LinkId=717347",e.teamsKnownIssues="https://go.microsoft.com/fwlink/?linkid=2143493"}(e.ActionLinkUrls||(e.ActionLinkUrls={}))}(r||(r={}));var o,i,a,s,c,u,p,l,d="nextLink",f="fileSource",y="powerapps-user-defined",m="unspecified",g="AzurePortal";!function(e){e.Singleton="singleton",e.Mru="mru",e.List="list",e.File="file"}(o||(o={})),function(e){e.Single="single",e.Double="double"}(i||(i={})),function(e){e.CommonDataService="shared_commondataservice",e.Excel="shared_excel",e.LinkedIn="shared_linkedin",e.RuntimeService="shared_runtimeservice"}(a||(a={})),function(e){e.ExperimentalRuntimeService="/providers/microsoft.powerapps/apis/shared_runtimeservice-experimental",e.RuntimeService="/providers/microsoft.powerapps/apis/shared_runtimeservice",e.CommonDataService="/providers/microsoft.powerapps/apis/shared_commondataservice",e.CommonDataServiceCurrentEnvironment="/providers/microsoft.powerapps/apis/shared_commondataserviceforapps",e.Excel="/providers/microsoft.powerapps/apis/shared_excel",e.DynamicsCRMOnline="/providers/microsoft.powerapps/apis/shared_dynamicscrmonline",e.OneDriveForBusiness="/providers/microsoft.powerapps/apis/shared_onedriveforbusiness",e.SharepointOnline="/providers/microsoft.powerapps/apis/shared_sharepointonline",e.Salesforce="/providers/microsoft.powerapps/apis/shared_salesforce",e.OneDrive="/providers/microsoft.powerapps/apis/shared_onedrive",e.FlowService="/providers/Microsoft.PowerApps/apis/shared_logicflows",e.DropBox="/providers/microsoft.powerapps/apis/shared_dropbox",e.GoogleDrive="/providers/microsoft.powerapps/apis/shared_googledrive",e.LinkedIn="/providers/microsoft.powerapps/apis/shared_linkedin",e.Sql="/providers/microsoft.powerapps/apis/shared_sql",e.SqlV2="/providers/microsoft.powerapps/apis/shared_sql-noaad-sayleec",e.SqlAAD="/providers/microsoft.powerapps/apis/shared_sql-sayleec",e.SqlGcc="/providers/microsoft.powerapps/apis/shared_sql-olshyron",e.SqlWinNonShared="/providers/Microsoft.PowerApps/apis/shared_sql-v-nizoto",e.Office365Users="/providers/Microsoft.PowerApps/apis/shared_office365users",e.MicrosoftSpatialServices="/providers/Microsoft.PowerApps/apis/shared_microsoftspatialservices",e.Smtp="/providers/microsoft.powerapps/apis/shared_smtp",e.Azureblob="/providers/microsoft.powerapps/apis/shared_azureblob",e.HttpAzureAD="/providers/microsoft.powerapps/apis/shared_webcontents",e.ExcelOnline="/providers/microsoft.powerapps/apis/shared_excelonline",e.ExcelOnlineBusiness="/providers/microsoft.powerapps/apis/shared_excelonlinebusiness",e.ExcelOnlineBusinessV2="/providers/microsoft.powerapps/apis/shared_excelonlinebusiness-v-nizoto",e.DesktopFlow="/providers/microsoft.powerapps/apis/shared_uiflow",e.AzureMySql="/providers/microsoft.powerapps/apis/shared_azuremysql",e.AzureMySqlInt="/providers/microsoft.powerapps/apis/shared_azuremysql-adithyaks"}(s||(s={})),function(e){e.AadAuth="oauth",e.AadComAuth="oauthCom",e.WindowsNonShared="windowsAuthenticationNonShared"}(c||(c={})),function(e){e.Api="api",e.ConsentLink="ConsentLink",e.ConnectionReference="connectionreference"}(u||(u={})),function(e){e.ApiConnectionLimitExceeded="ApiConnectionLimitExceeded",e.PlanApiConnectionLimitExceeded="PlanApiConnectionLimitExceeded"}(p||(p={})),function(e){e.RtsProvisioningSuccessful="Successful",e.RtsProvisioningFailed="Failed"}(l||(l={}));var v,b,h="default",A="default.cds",C="environment_39a902ba",P="createConnectionReference",w="solutionId";!function(e){e.DependentSourceInvoker="Invoker",e.DependentSourceEmbedded="Embedded"}(v||(v={})),function(e){e.ConnectionObjKey="connection",e.ConnectionObjStringKey="stringifiedConnectionObject"}(b||(b={}));var S="sqlStoredProcedures"},function(e,t,n){"use strict";n.r(t),n.d(t,"isExpressionRuntime",(function(){return s})),n.d(t,"computeDValueSchemaForObjectTType",(function(){return c})),n.d(t,"computeDValueSchemaForArrayTType",(function(){return u})),n.d(t,"convertFromObjectDValue",(function(){return p})),n.d(t,"convertToObjectDValue",(function(){return l})),n.d(t,"getLocalizedTTypeName",(function(){return d})),n.d(t,"makeODataEntityRecordPointer",(function(){return f})),n.d(t,"convertArrayOfTItemsToDTable",(function(){return y})),n.d(t,"convertFromDValueAsync",(function(){return m})),n.d(t,"convertDTableToArrayOfTItems",(function(){return g})),n.d(t,"isNaNType",(function(){return v})),n.d(t,"tryGetPrimaryKey",(function(){return b}));var r=n(0),o=n(5),i=n(7),a=n(91);function s(e){return e&&e.isExpressionRuntime}function c(e,t){if(t<=0)return Object(o.createSchemaForObjectFromPointer)([]);var n=Object.keys(e).sort((function(t,n){return e[t].displayIdx-e[n].displayIdx})),r=t-1,i=[];return n.forEach((function(t){var n=e[t].ttypeRef.getType().computeDValueSchema(r);n.name=t,i.push(n)})),Object(o.createSchemaForObjectFromPointer)(i)}function u(e,t){if(t<=0)return Object(o.createSchemaForArrayFromPointer)([]);var n=e.getType(),r=n.computeDValueSchema(n.isRecordDType?t:t-1);if(n.isRecordDType){var i=r;return Object(o.createSchemaForArrayFromPointer)(i.ptr)}return r.name=a.TypesManager.ValueColumnName,Object(o.createSchemaForArrayFromPointer)([r])}function p(e,t,n){return n?null===e||Object(r.isNullOrUndefined)(t)||0===Object.keys(t).length?Promise.resolve(e):function(e,t){var n={},o=Promise.resolve();return Object(r.HashTableUtility_forEach)(t,(function(t,i){var a=t.ttypeRef.getType(),s=e[i];Object(r.isDefined)(s)&&e.hasOwnProperty(i)&&!AppMagic.Data.ErrorValue.isGatedError(s)&&(o=o.then((function(){return m(a,s)})).then((function(e){n[i]=e})))})),o.then((function(){return n}))}(e,t):null===e||Object(r.isNullOrUndefined)(t)||0===Object.keys(t).length?e:function(e,t){var n={};return Object(r.HashTableUtility_forEach)(t,(function(t,o){var i=t.ttypeRef.getType(),a=e[o];if(Object(r.isDefined)(a)&&e.hasOwnProperty(o)&&!AppMagic.Data.ErrorValue.isGatedError(a)){var s=i.convertFromDValue(a);n[o]=s}})),n}(e,t)}function l(e,t){if(null===e)return null;if(!Object(r.isJsonObject)(e)){var n=Object(r.CoreUtility_formatString)(AppMagic.Strings.ParsingErrorMessage,AppMagic.Strings.ValueTypeObject,d(e));return Object(r.trace)(r.CategoryNames.Verbose,"parsing",{info:n,issue:AppMagic.Strings.ParsingErrorDetail},r.MonitorLogLevel.Error),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,n,{errorContext:null,errorMessage:n,raiseToastNotification:!1,wasReported:!1,functionName:null})}var o,i=AppMagic.Data.DataRecord.create();return Object(r.isEnabled)()&&(o=new Set(Object.keys(e))),Object.keys(t).forEach((function(n){var a=t[n].ttypeRef.getType(),s=e[n],c={unsafePropertyValues:e,propertyName:n};if(Object(r.isDefined)(s)&&e.hasOwnProperty(n)){var u=a.convertToDValue(s,c);i[n]=u,o&&o.delete(n)}})),o&&o.size>0&&Object(r.trace)(r.CategoryNames.Verbose,"parsing",{info:AppMagic.Strings.UnexpectedColumnsInResponse,droppedColumns:Array.from(o)},r.MonitorLogLevel.Warning),i}function d(e){if(void 0===e)return AppMagic.Strings.ValueTypeUndefined;if(null===e)return AppMagic.Strings.ValueTypeNull;if(Object(r.isArray)(e))return AppMagic.Strings.ValueTypeArray;switch(typeof e){case"number":return AppMagic.Strings.ValueTypeNumber;case"boolean":return AppMagic.Strings.ValueTypeBoolean;case"string":return AppMagic.Strings.ValueTypeString;case"object":return AppMagic.Strings.ValueTypeObject;default:return AppMagic.Strings.ValueTypeUnknown}}function f(e){var t=e.unsafePropertyValues,n=t[e.propertyName];if(!t||!Object(r.isNonEmptyString)(n))return null;var o={source:"odataPointer",odataId:n};return AppMagic.Data.DataEntityRecord.makeODataEntityRecordPointer(o)}function y(e,t,n){for(var r=AppMagic.Data.DataTable.create(),o=0,s=e.length;o<s;o++){var c=t.convertToDValue(e[o],n);if(!t.isRecordDType||t.TTypeValueKind==i.TTypeValueKind.JsonUntypedObject){var u=AppMagic.Data.DataRecord.create();u[a.TypesManager.ValueColumnName]=c,c=u}r[o]=c}return r}function m(e,t){var n=e.convertFromDValue(t);return e.isConvertFromDValueAsync?n:Promise.resolve(n)}function g(e,t){return t.isConvertFromDValueAsync?null===e?Promise.resolve(null):t.isRecordDType?function(e,t){var n=e.map((function(e){return AppMagic.Data.ErrorValue.isGatedError(e)?Object(r.throwAsync)(new Error("dtableRecord is error value or undefined")):t.convertFromDValue(e)}));return Object(r.PromiseUtility_join)(n)}(e,t):function(e,t){var n=this,o=e.map((function(e){return __awaiter(n,void 0,void 0,(function(){return __generator(this,(function(n){if(AppMagic.Data.ErrorValue.isGatedError(e))throw new Error("Cannot send undefined records to a service without risk of corrupting data.");if(null===e)return[2,null];if(AppMagic.Data.ErrorValue.isGatedError(e.Value))throw new Error("Cannot send undefined records to a service without risk of corrupting data");return[2,t.convertFromDValue(e.Value)]}))}))}));return Object(r.PromiseUtility_join)(o)}(e,t):null===e?null:t.isRecordDType?function(e,t){return e.map((function(e){if(AppMagic.Data.ErrorValue.isGatedError(e))throw new Error("dtableRecord is error value or undefined");return t.convertFromDValue(e)}))}(e,t):function(e,t){return e.map((function(e){if(AppMagic.Data.ErrorValue.isGatedError(e))throw new Error("Cannot send undefined records to a service without risk of corrupting data.");if(null===e)return null;if(AppMagic.Data.ErrorValue.isGatedError(e.Value))throw new Error("Cannot send undefined records to a service without risk of corrupting data");return t.convertFromDValue(e.Value)}))}(e,t)}function v(e){return!!isNaN(e)&&(r.CoreLog.error("TTypeUtility.isNaNType","Expected non-NaN tvalue."),!0)}function b(e,t){if(!function(e,t){if(!e)return!1;for(var n=0,o=t.length;n<o;++n)if(Object(r.isNullOrUndefined)(e[t[n]]))return!1;return!0}(e,t))return null;if(1===t.length)return JSON.stringify(e[t[0]]);var n=t.map((function(t){return e[t]}));return JSON.stringify(n)}},function(e,t,n){"use strict";n.r(t),n.d(t,"createSuccessfulAsyncResult",(function(){return d})),n.d(t,"createUnsuccessfulAsyncResult",(function(){return f})),n.d(t,"castToUnsuccessfulAnyAsyncResult",(function(){return y})),n.d(t,"getAsyncResultResultOrThrow",(function(){return m})),n.d(t,"createSuccessfulDataflowResult",(function(){return g})),n.d(t,"createSuccessfulUndefinedDataflowResult",(function(){return v})),n.d(t,"createUnsuccessfulDataflowResult",(function(){return b})),n.d(t,"getDataflowResultValueOrThrow",(function(){return h})),n.d(t,"promiseErrorToDataflowResult",(function(){return A})),n.d(t,"parseXmlFromStringWithErrorDetection",(function(){return C})),n.d(t,"isParserErrorDocument",(function(){return S})),n.d(t,"computeNormalizedRequestContentType",(function(){return R})),n.d(t,"sendHttpErrorHandler_ConvertToAsyncResult",(function(){return _})),n.d(t,"tryGetMimeTypeFromRequestOrResponse",(function(){return T})),n.d(t,"tryGetMimeTypeFromContentType",(function(){return I})),n.d(t,"addSendHttpPipelinePerf",(function(){return E})),n.d(t,"createSendHttpPipelineResponseFromXMLHttpRequest",(function(){return U})),n.d(t,"parseTextResponseToJsonWithStandardErrors",(function(){return j})),n.d(t,"createNormalizedErrorFromWinJSXhrErrorAsync",(function(){return N})),n.d(t,"createSendHttpErrorWithResponseAsync",(function(){return L})),n.d(t,"WindowsErrorNumber",(function(){return D})),n.d(t,"createSendHttpError",(function(){return F})),n.d(t,"normalizeHttpHeaderName",(function(){return H})),n.d(t,"parseResponseHeaders",(function(){return B})),n.d(t,"getAllResponseHeadersFromHashTable",(function(){return q}));var r=n(0),o=n(95),i=(n(97),n(3)),a=(n(64),n(33)),s=n(23),c=n(82),u=n(71),p=n(122),l=n(12);function d(e){return{success:!0,result:e}}function f(e){return e?{success:!1,message:e}:{success:!1}}function y(e){return e}function m(e){if(e.success)return e.result;throw new Error(e.message)}function g(e){return Object(r.isDefined)(e)?{success:!0,value:e}:{success:!0}}function v(){return{success:!0}}function b(e){return e?{success:!1,message:e}:{success:!1}}function h(e){if(!0===e.success)return e.value;throw new Error(e.message)}function A(e){return Object(r.throwIfCanceled)(e),Object(r.isObject)(e)&&Object(r.isBoolean)(e.success)?e:b(Object(r.formatErrorMessage)(e))}function C(e,t){var n=new DOMParser;try{var r=n.parseFromString(e,t),o=O(r);return null!==o?f(o.textContent):d(r)}catch(e){return f(AppMagic.Strings.RestErrorUnableToParseXml)}}var P=null,w=null;function S(e){return null!==O(e)}function O(e){if(null===P){var t=new DOMParser;try{w=t.parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI,P=!1}catch(e){P=!0}}if(P)return null;var n=e.getElementsByTagNameNS(w,"parsererror");return n.length>0?n[0]:null}function R(e,t,n,o){return t&&o&&t!==o&&Object(r.tryExtractMimeTypeFromMediaType)(t)!==Object(r.tryExtractMimeTypeFromMediaType)(o)&&r.Log.trackActivityEvent("ServiceUtility.computeNormalizedRequestContentType",{message:"Request Content-Type header and body's content type are inconsistent. Favoring the Content-Type header.",url:e,headerContentType:t,bodyContentType:o}),t||o||("string"==typeof n?r.TextPlain:r.ApplicationOctetStream)}function _(e){return Object(r.throwIfCanceled)(e),f(e.message)}function T(e){return e.headers?I(Object(r.tryGetValueIgnoreCase)(e.headers,i.HeaderName.ContentType)):null}function I(e){if(!e)return null;var t=e.indexOf(";");return t<0?e:0===t?null:e.substr(0,t)}function E(e,t,n,o,i){r.services.EnableSendHttpPipelinePerf&&t.sendHttpPipelinePerf&&t.sendHttpPipelinePerf.sendHttpPipelinePerfTimestamps&&(t.sendHttpPipelinePerf.sendHttpPipelinePerfTimestamps[e]={pipelineStart:n,responseReceived:o,pipelineEnd:i})}function U(e){var t=s.ResponseTypes.tryConvertFromString(e.responseType||"text"),n={status:e.status,headers:B(e,H),responseType:t,sendHttpPipelinePerf:{sendHttpPipelinePerfTimestamps:Object(r.HashTableUtility_create)()}};if(t===s.ResponseTypes.Text)n.response=n.responseText=e.responseText||"",n.responseSize=k(n);else if(null===e.response||void 0===e.response);else if("arraybuffer"===t)n.response=e.response,n.responseSize=k(n);else if("blob"===t)n.response=e.response,n.responseSize=k(n);else{if("json"!==t)throw new Error("Unsupported xhr.responseType '".concat(e.responseType,"'."));n.response=e.response,n.responseSize=k(n)}return n}function j(e,t){try{return Object(r.isEmptyString)(e.responseText)?e.responseText:JSON.parse(e.responseText)}catch(n){throw new p.SendHttpInvalidResponseError(AppMagic.Strings.RestResponseDataInvalid,e,p.HttpResponseErrorKind.ResponseInvalidJson,t)}}function N(e,t,n){return void 0===n&&(n=null),__awaiter(this,void 0,Promise,(function(){var o;return __generator(this,(function(i){switch(i.label){case 0:return Object(r.isCanceledError)(e)?[2,e]:a.MinimalXMLHttpRequest.isValid(e)?[4,L(U(e),t,e.readyState,n)]:[3,2];case 1:return o=i.sent(),[3,3];case 2:o=F(e,t,e.readyState),i.label=3;case 3:return[2,o]}}))}))}var D,V=[r.TextHtml,r.ApplicationXHtml],M=[r.TextPlain,r.ApplicationJson,r.TextHtml,r.ApplicationXHtml,r.ApplicationXml];function k(e){if(!e.response)return 0;var t=Object(r.tryGetValueIgnoreCase)(e.headers,i.HeaderName.ContentLength);if(t&&Object(r.isIntegerString)(t))return parseInt(t,10);var n=e.response;switch(e.responseType){case s.ResponseTypes.Text:if("string"==typeof n)return n.length;break;case s.ResponseTypes.Blob:if(n instanceof Blob)return n.size;break;case s.ResponseTypes.ArrayBuffer:if(n instanceof ArrayBuffer)return n.byteLength;break;case s.ResponseTypes.Json:if(null!=n)return JSON.stringify(n).length}return 0}function L(e,t,n,a){return void 0===n&&(n=null),void 0===a&&(a=null),__awaiter(this,void 0,Promise,(function(){var s,c,p,d,f,y,m,g;return __generator(this,(function(v){switch(v.label){case 0:return s=T(e)||"",c=null,0!==e.status?[3,1]:(c=AppMagic.Strings.ConnectedDataIncompleteError,[3,15]);case 1:return M.some((function(e){return Object(l.m)(e,s)}))?[3,2]:(e.responseType="text",e.response=e.responseText="",[3,15]);case 2:return"text"===e.responseType?[3,14]:(p=void 0,void 0!==e.response&&null!==e.response?[3,3]:(p="",[3,13]));case 3:return"blob"!==e.responseType?[3,5]:(d=e.response,f=d.type,[4,Object(o.blobToString)(d)]);case 4:return p=v.sent(),!Object(r.tryGetValueIgnoreCase)(e.headers,i.HeaderName.ContentType)&&f&&(e.headers[i.HeaderName.ContentType]=f),[3,13];case 5:return"arraybuffer"!==e.responseType?[3,7]:(y=e.response,[4,Object(o.arrayBufferToTextAsync)(y)]);case 6:return p=v.sent(),[3,13];case 7:return"json"!==e.responseType?[3,8]:(p=JSON.stringify(e.response),[3,13]);case 8:return"pabinary"!==e.responseType?[3,12]:(m=e.response,a?[3,9]:(r.Log.trackActivityEvent("ServiceUtility.createSendHttpErrorWithResponseAsync",{message:"Cannot get errored response as text when responseType is 'pabinary' but no binaryResolver available."}),[3,11]));case 9:return[4,a.getAsTextAsync(m)];case 10:p=v.sent(),v.label=11;case 11:return[3,13];case 12:throw new Error("Unexpected responseType '".concat(e.responseType,"'."));case 13:e.responseType="text",e.response=e.responseText=p||"",v.label=14;case 14:if(Object(r.isNonEmptyString)(e.responseText)){if(g=e.responseText,V.some((function(e){return Object(l.m)(e,s)})))try{g=Object(l.u)(g)}catch(e){}c=g}v.label=15;case 15:return c||(c=Object(r.CoreUtility_formatString)(AppMagic.Strings.RESTHttpErrorReturnedFormat,e.status)),[2,new u.SendHttpErrorWithResponse(c,e,{requestUrl:t,readyState:n})]}}))}))}function F(e,t,n){if(void 0===n&&(n=null),Object(r.isNumber)(e.number)&&(e.number===D.AccessIsDenied||e.number===D.CannotLocateResource||e.number===D.OperationAborted)){var o="string"==typeof e.message?e.message:"";return new r.ApplicationError(o)}return new c.SendHttpError(AppMagic.Strings.RESTHttpErrorReturned,{requestUrl:t,readyState:n})}!function(e){e[e.AccessIsDenied=-2147024891]="AccessIsDenied",e[e.CannotLocateResource=-2146697211]="CannotLocateResource",e[e.OperationAborted=-2147467260]="OperationAborted"}(D||(D={}));var x=null;function H(e){return null===x&&(x=Object(r.HashTableUtility_create)(),Object.keys(i.HeaderName).forEach((function(e){var t=i.HeaderName[e];x[t.toLowerCase()]=t}))),x[e.toLowerCase()]||e}function B(e,t){var n=Object(r.HashTableUtility_create)(),o=e.getAllResponseHeaders();return null!==o&&o.split("\r\n").forEach((function(e){if(0!==e.length){var r=e.split(": ",2);if(2!==r.length)return;n[t?t(r[0]):r[0]]=r[1]}})),n}function q(e){return Object(r.HashTableUtility_mapToArray)(e,(function(e,t){return function(e,t){return e+": "+t+"\r\n"}(t,e)})).join("")}},function(e,t,n){"use strict";n.d(t,"r",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"o",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"s",(function(){return p})),n.d(t,"m",(function(){return l})),n.d(t,"u",(function(){return f})),n.d(t,"v",(function(){return y})),n.d(t,"i",(function(){return m})),n.d(t,"j",(function(){return g})),n.d(t,"q",(function(){return v})),n.d(t,"l",(function(){return h})),n.d(t,"t",(function(){return A})),n.d(t,"c",(function(){return C})),n.d(t,"b",(function(){return P})),n.d(t,"f",(function(){return S})),n.d(t,"g",(function(){return _})),n.d(t,"h",(function(){return T})),n.d(t,"k",(function(){return I})),n.d(t,"p",(function(){return U})),n.d(t,"a",(function(){return j})),n.d(t,"n",(function(){return D}));var r=n(0),o=n(11);function i(e){return JSON.parse(JSON.stringify(e))}function a(e){return e.replace(/<|>|&|'|"/g,(function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&#39;";case'"':return"&quot;";default:return e}}))}function s(e){return"string"==typeof e&&(""===e||"/"===e[0]&&null===e.match(/~[^01]/))}function c(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function u(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}function p(e){if(!s(e))throw new Error("Invalid json pointer");if(""===e)return[];var t=e.split("/");return t.splice(0,1),t=t.map(c)}function l(e,t){return e.indexOf("/")>0?e.toLowerCase()===t.toLowerCase():/^\w+\/[\w-+]+$/i.test(t)&&0===t.toLowerCase().indexOf((e+"/").toLowerCase())}var d=[[/<br\s*\/?>/gi,"\n"],[/<p((\s+([\w]+:)?\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)>(.*?)<\/p>/gi,"\n$5\n"],[/<div((\s+([\w]+:)?\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)>(.*?)<\/div>/gi,"\n$5\n"],[/<a((\s+([\w]+:)?\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)(href\s*=\s*("(.*?)"|'(.*?)'))((\s+([\w]+:)?\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)>(.*?)<\/a>/gi," $13 ($7$8) "],[/<script((\s+([\w]+:)?\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)>.*?<\/script>/gi,""],[/<style((\s+([\w]+:)?\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)>.*?<\/style>/gi,""],[/<\/?([\w]+:)?\w+((\s+([\w]+:)?\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)\/?>/g,""],[/ +( |$)/g,"$1"],[/\r/g,""],[/( +\n)|(\n +)/g,"\n"],[/\n{3,}/g,"\n\n"]];function f(e){void 0===e&&(e="");for(var t=e,n=0,r=d.length;n<r;n++){var o=d[n],i=o[0],a=o[1];t=t.replace(i,a)}return t.trim()}function y(e){if(0===e.length)return{success:!1,firstToken:null,nextPointer:null};var t,n,r=e.indexOf("/",1);return-1===r?(t=e.substr(1),n=""):(t=e.substr(1,r-1),n=e.substr(r)),{success:!0,firstToken:t=c(t),nextPointer:n}}function m(e,t){for(var n=p(t),o=e,i=0;i<n.length&&Object(r.isDefined)(o);i++){if(null===o){o=(o={}).someUndefinedProperty;break}o=o[n[i]]}return o}function g(e,t){for(var n=p(t),i=e,a=0;a<n.length&&Object(r.isDefined)(i);a++){if(null===i)return Object(o.createSuccessfulUndefinedDataflowResult)();if(!(Object(r.isObject)(i)||Object(r.isArray)(i)||N(i)))return Object(o.createUnsuccessfulDataflowResult)();i=i[n[a]]}return Object(o.createSuccessfulDataflowResult)(i)}function v(e){return e.message===AppMagic.Strings.AuthenticationBrokerManagerErrorUserCanceled}var b=[/<br\s*\/?>/i,/<p((\s+([\w]+:)?\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)>(.*?)<\/p>/i,/<div((\s+([\w]+:)?\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)>(.*?)<\/div>/i,/<a((\s+([\w]+:)?\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)(href\s*=\s*("(.*?)"|'(.*?)'))((\s+([\w]+:)?\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)>(.*?)<\/a>/i,/<script((\s+([\w]+:)?\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)>.*?<\/script>/i,/<style((\s+([\w]+:)?\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)>.*?<\/style>/i,/<\/?([\w]+:)?\w+((\s+([\w]+:)?\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)\/?>/];function h(e){if(""===e)return!1;for(var t=0,n=b.length;t<n;t++){if(b[t].test(e))return!0}return!1}function A(e,t){return Object(r.checkString)(e),Object(r.checkString)(t),e.replace(/[\'\"]/g,t)}function C(e,t){void 0===t&&(t=!1),Object(r.check)("object"==typeof e);for(var n=Object.keys(e),o=Object.create(null),i=0,a=n.length;i<a;i++){var s=n[i],c=t?{}:{name:s},u=e[s];if(o[s]=c,null!=u)switch(typeof u){case"string":Object(r.isImageUrl)(u)?c.type="i":Object(r.isUrl)(u)?c.type="h":c.type="s";break;case"number":c.type="n";break;case"boolean":c.type="b";break;case"object":u instanceof Array?(c.type="array",c.ptr=P(u,t)):(c.type="object",c.ptr=C(u,t));break;default:c.type="?"}else c.type="?"}return o}function P(e,t){void 0===t&&(t=!1),Object(r.checkArray)(e);for(var n=Object.create(null),o=0,i=e.length;o<i;o++){var a=e[o];if(null!=a)("object"!=typeof a||a instanceof Array)&&(a={Value:a}),w(n,C(a,t))}return n}function w(e,t){var n,r,o,i,a,s=Object.keys(e);for(n=0,r=s.length;n<r;n++)if(i=e[o=s[n]],null!=(a=t[o]))if(null!=i&&"?"!==i.type){if("?"!==a.type){var c=function(e,t){e[t]={type:"s",name:t}};i.type===a.type?"object"!==i.type&&"array"!==i.type||w(i.ptr,a.ptr):("object"===i.type?"array"===a.type?(w(i.ptr,a.ptr),e[o]={name:o,type:"array",ptr:i.ptr}):c(e,o):"array"===i.type&&"object"===a.type?w(i.ptr,a.ptr):c(e,o),delete t[o])}}else e[o]=a,delete t[o];for(n=0,r=(s=Object.keys(t)).length;n<r;n++)void 0===e[o=s[n]]&&(e[o]=t[o])}function S(e){Object(r.checkPureObject)(e);for(var t=Object.keys(e),n=[],o=0,i=t.length;o<i;o++){var a=e[t[o]],s={name:a.name};"object"===a.type||"array"===a.type?s.ptr=S(a.ptr):void 0!==a.ptr&&(s.ptr=a.ptr),"?"===a.type?s.type="s":s.type=a.type,n.push(s)}return n}function O(){return"undefined"!=typeof window}function R(){return O()&&window.top}function _(){var e;if(r.services.EnableMdlCustomPage&&O())return null===(e=window.RootAppServices)||void 0===e?void 0:e.MdlHttpClient}function T(){var e;if(r.services.EnableMdlCustomPage&&O())return null===(e=window.RootAppServices)||void 0===e?void 0:e.MdlMetadataClient}function I(){return O()&&window.WebViewFileTransferService}var E=null;function U(e){E=e}function j(){return null!=E?E:!!_()&&!!T()}function N(e){var t;if(j()){var n=null===(t=R())||void 0===t?void 0:t.Object;return!!n&&e instanceof n}return!1}function D(e){var t;if(j()&&null!==e&&"object"==typeof e){var n=null===(t=R())||void 0===t?void 0:t.Object;return!!n&&Object.getPrototypeOf(e)===n.prototype}return!1}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u}));var r=n(0),o=n(217);function i(e){return function(t){return function(e,t){var n=new o.PowerPlatformApiDiscovery(e);try{return new r.Core_Url("https://".concat(n.getTenantEndpoint(t)))}catch(e){return r.Log.trackErrorEvent("RegionUtility.getPowerPlatformApiTenantUrl.Failure",{message:e.message}),null}}(e,t)}}function a(e,t){if(void 0===t&&(t=Core.Environment.tryGetEnvironmentName()),!t)return null;var n=new o.PowerPlatformApiDiscovery(e);try{return new r.Core_Url("https://".concat(n.getEnvironmentEndpoint(t)))}catch(e){return r.Log.trackErrorEvent("RegionUtility.getPowerPlatformApiEnvironmentUrl.Failure",{message:e.message}),null}}function s(e){return new r.Core_Url("https://web."+e+".powerva.microsoft.com/")}function c(e){return function(t){return a(e,t)}}function u(e){return new o.PowerPlatformApiDiscovery(e).getTokenAudience()}},function(e,t,n){"use strict";n.r(t),n.d(t,"sendHttpAsync",(function(){return o})),n.d(t,"sendHttpIgnoreResponseAsync",(function(){return i})),n.d(t,"sendHttpTextResponseAsync",(function(){return a})),n.d(t,"sendHttpJsonResponseAsync",(function(){return s}));n(0),n(97);var r=n(30);function o(e,t,n,r,o){return void 0===r&&(r=null),c(t,n,r),e.sendHttpAsync(t,o)}function i(e,t,n,r){return void 0===r&&(r=null),c(t,n,r),e.sendHttpIgnoreResponseAsync(t)}function a(e,t,n,r){return void 0===r&&(r=null),c(t,n,r),e.sendHttpTextResponseAsync(t)}function s(e,t,n,r){return void 0===r&&(r=null),c(t,n,r),e.sendHttpJsonResponseAsync(t)}function c(e,t,n){Object(r.addTelemetryOptions)(e,{operationName:t}),n&&Object(r.addTelemetryAdditionalData)(e,n)}},function(e,t,n){"use strict";n.r(t),n.d(t,"AppLifeCycleId",(function(){return r})),n.d(t,"AppInfo",(function(){return a}));var r,o=n(0),i=n(43);!function(e){e[e.Published=0]="Published",e[e.Draft=1]="Draft",e[e.AutoSaved=2]="AutoSaved",e[e.Packaged=3]="Packaged"}(r||(r={}));var a=function(){function e(t,n,r,o,i,a,s,c,u,p,l,d,f,y,m,g,v,b,h,A,C,P,w,S,O,R,_,T,I,E,U,j,N,D,V,M,k,L,F,x,H,B,q,G,J,W,z,K,X,Q,$,Z,Y,ee,te,ne,re,oe,ie,ae,se,ce,ue,pe,le,de,fe,ye,me){void 0===Y&&(Y=null),void 0===ee&&(ee=null),void 0===te&&(te=null),void 0===ne&&(ne=null),void 0===re&&(re=null),void 0===oe&&(oe=null),void 0===ie&&(ie=null),void 0===ae&&(ae=null),void 0===se&&(se=null),void 0===ce&&(ce=null),void 0===ue&&(ue=null),void 0===pe&&(pe=void 0),void 0===le&&(le=void 0),void 0===de&&(de=null),void 0===fe&&(fe=!1),void 0===ye&&(ye=null),void 0===me&&(me=null),this.documentServerVersion=K,this._originalJson=t,this._id=n,this._name=r,this._description=o,this._aiGeneratedDescription=i||null,this._createdDate=a,this._lastModifiedDate=s,this._documentUrl=c,this._playerPackageUrl=u,this._playerReadOnlyPackageUrl=p,this._debugPlayerPackageUrl=l,this._displayName=d,this._backgroundColor=f,this._backgroundImageUrl=y,this._authResources=m,this._publisher=g,this._supportsPortrait=v,this._supportsLandscape=b,this._hasComponent=h||!1,this._hasUnlockedComponent=null!==A?A:h||!1,this._primaryDeviceWidth=C,this._primaryDeviceHeight=P,this._primaryFormFactor=w,this._sienaVersion=S,this._publisherVersion=O,this._minimumRequiredApiVersion=R,this._deviceCapabilities=_,this._tags=T,this._environment=I,this._connectionReferences=E,this._databaseReferences=U,this._featuresRequirements=AppMagic.Runtime.Client.ClientUtility.getAppPremiumFeaturesRequirements(E,U,I),this._sharedGroupsCount=j,this._sharedUsersCount=N,this._owner=D||null,this._lastModifiedBy=V||null,this._createdBy=M||null,this._webPackageUrl=k,this._webReadOnlyPackageUrl=L,this._sharePointSiteId=F,this._sharePointListId=x,this._debugWebPackageUrl=H,this._isFavorite=B,this._lastOpenedTime=q,this._isFeaturedApp=G,this._isHeroApp=J,this._includeInAppsList=W,this._appPackageResourcesKind=z,this._properties=Q,this._bypassConsent=$,this._packageProperties=e.tryParsePackageProperties(X),this._packagePropertiesJson=X,this._logicalName=Y,this._draftWebPackageUrl=ee,this._appOverrides=te||null,this._unauthenticatedWebPackageHint=ne,this._appVersion=ae,this._appType=re,this._appIconUrls=oe,this._appOpenUri=ie,this._appVersion=ae,this._appModuleSettings=se,this._unauthenticatedWebPackageUrl=ce,this._unauthenticatedWebReadOnlyPackageUrl=ue,this._unifiedAppMetadataVersion=pe,this._enableModernRuntimeMode=le,this._unauthenticatedModernRuntimePackageUrl=de,this._isPartialResponse=fe,this._showStatusBar=Z,this._canvasAppAdornerStatus=ye,this._canvasAppSidecarStatus=me}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cacheItemId",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appName",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this._description},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"aiGeneratedDescription",{get:function(){return this._aiGeneratedDescription},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"createdDate",{get:function(){return this._createdDate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastModifiedDate",{get:function(){return this._lastModifiedDate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return this._displayName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"publisher",{get:function(){return this._publisher},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"supportsPortrait",{get:function(){return this._supportsPortrait},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"supportsLandscape",{get:function(){return this._supportsLandscape},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasComponent",{get:function(){return this._hasComponent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasUnlockedComponent",{get:function(){return this._hasUnlockedComponent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"primaryDeviceWidth",{get:function(){return this._primaryDeviceWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"primaryDeviceHeight",{get:function(){return this._primaryDeviceHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"primaryFormFactor",{get:function(){return this._primaryFormFactor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sienaVersion",{get:function(){return this._sienaVersion},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"publisherVersion",{get:function(){return this._publisherVersion},set:function(e){this._publisherVersion=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minimumRequiredApiVersion",{get:function(){return this._minimumRequiredApiVersion},set:function(e){this._minimumRequiredApiVersion=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deviceCapabilities",{get:function(){return this._deviceCapabilities},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authResources",{get:function(){return this._authResources},set:function(e){this._authResources=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalAppDocumentUri",{get:function(){return this._properties.globalAppDocumentUri?this._properties.globalAppDocumentUri.toString():null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"debugPlayerPackageUrl",{get:function(){return null!==this._debugPlayerPackageUrl?this._debugPlayerPackageUrl.toString():null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"debugWebPackageUrl",{get:function(){return null!==this._debugWebPackageUrl?this._debugWebPackageUrl.toString():null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originalJson",{get:function(){return this._originalJson},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"imageUrl",{get:function(){return null!==this._backgroundImageUrl?this._backgroundImageUrl.toString():null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this._backgroundColor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sharedGroupsCount",{get:function(){return this._sharedGroupsCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sharedUsersCount",{get:function(){return this._sharedUsersCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"owner",{get:function(){return this._owner},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastModifiedBy",{get:function(){return this._lastModifiedBy},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFavorite",{get:function(){return this._isFavorite},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFeaturedApp",{get:function(){return this._isFeaturedApp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHeroApp",{get:function(){return this._isHeroApp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"includeInAppsList",{get:function(){return this._includeInAppsList},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"createdBy",{get:function(){return this._createdBy},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sharePointSiteId",{get:function(){return this._sharePointSiteId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sharePointListId",{get:function(){return this._sharePointListId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playerPackageUrl",{get:function(){return null!==this._playerPackageUrl?this._playerPackageUrl.toString():null},set:function(e){this._playerPackageUrl=new o.Core_Url(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playerReadOnlyPackageUrl",{get:function(){return null!==this._playerReadOnlyPackageUrl?this._playerReadOnlyPackageUrl.toString():null},set:function(e){this._playerReadOnlyPackageUrl=e?new o.Core_Url(e):null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"unauthenticatedWebPackageUrl",{get:function(){return null!==this._unauthenticatedWebPackageUrl?this._unauthenticatedWebPackageUrl.toString():null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"unauthenticatedWebReadOnlyPackageUrl",{get:function(){return null!==this._unauthenticatedWebReadOnlyPackageUrl?this._unauthenticatedWebReadOnlyPackageUrl.toString():null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webPackageUrl",{get:function(){return null!==this._webPackageUrl?this._webPackageUrl.toString():null},set:function(e){this._webPackageUrl=new o.Core_Url(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webReadOnlyPackageUrl",{get:function(){return null!==this._webReadOnlyPackageUrl?this._webReadOnlyPackageUrl.toString():null},set:function(e){this._webReadOnlyPackageUrl=e?new o.Core_Url(e):null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appType",{get:function(){return this._appType},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appIconUrls",{get:function(){return this._appIconUrls},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appOpenUri",{get:function(){return this._appOpenUri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appModuleSettings",{get:function(){return this._appModuleSettings},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"environment",{get:function(){return this._environment},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectionReferences",{get:function(){return Object(o.HashTableUtility_create)(this._connectionReferences)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"databaseReferences",{get:function(){return Object(o.HashTableUtility_create)(this._databaseReferences)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"featuresRequirements",{get:function(){return this._featuresRequirements},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastOpenedTime",{get:function(){return this._lastOpenedTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFirstPublish",{get:function(){return this._properties.isFirstPublish},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastPublishDate",{get:function(){return this._properties.lastPublishDate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastDraftVersion",{get:function(){return this._properties.lastDraftVersion},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastDraft",{get:function(){return this._properties.lastDraft},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lifeCycleId",{get:function(){return this._properties.lifeCycleId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"documentUrl",{get:function(){return null!==this._documentUrl?this._documentUrl.toString():null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"commitMessage",{get:function(){return this._properties.commitMessage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenshots",{get:function(){return this._properties.screenshots},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"embeddedAppMetadata",{get:function(){return this._properties.embeddedApp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userConsents",{get:function(){return this._properties.userConsents},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appDocumentComplexity",{get:function(){return this._properties.appDocumentComplexity},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offlineProfileDetails",{get:function(){return this._properties.offlineProfileDetails},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"showStatusBar",{get:function(){return this._showStatusBar},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appPackageResourcesKind",{get:function(){return this._appPackageResourcesKind},set:function(e){this._appPackageResourcesKind=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"packageProperties",{get:function(){return this._packageProperties},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appInfoProperties",{get:function(){return this._properties},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"packagePropertiesJson",{get:function(){return this._packagePropertiesJson},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logicalName",{get:function(){return this._logicalName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"draftWebPackageUrl",{get:function(){return this._draftWebPackageUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appOverrides",{get:function(){return this._appOverrides},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"unauthenticatedWebPackageHint",{get:function(){return this._unauthenticatedWebPackageHint},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appVersion",{get:function(){return this._appVersion},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bypassConsent",{get:function(){return this._bypassConsent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"unifiedAppMetadataVersion",{get:function(){return this._unifiedAppMetadataVersion},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sourceControl",{get:function(){return this._properties.sourceControl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableModernRuntimeMode",{get:function(){return this._enableModernRuntimeMode},set:function(e){this._enableModernRuntimeMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"unauthenticatedModernRuntimePackageUrl",{get:function(){return null!==this._unauthenticatedModernRuntimePackageUrl?this._unauthenticatedModernRuntimePackageUrl.toString():null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPartialResponse",{get:function(){return this._isPartialResponse},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canvasAppAdornerStatus",{get:function(){return this._canvasAppAdornerStatus},set:function(e){this._canvasAppAdornerStatus=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canvasAppSidecarStatus",{get:function(){return this._canvasAppSidecarStatus},set:function(e){this._canvasAppSidecarStatus=e},enumerable:!1,configurable:!0}),e.prototype.serializeToJson=function(){return this._properties.rawServerRepresentation},e.deserialize=function(e){return i.AppInfoParser.parseAppInfo(e)},e.deserializeToCurated=function(e){return i.AppInfoParser.tryParseCuratedAppInfo(e)},e.prototype.getDocumentUrl=function(){return this._documentUrl},e.prototype.getPlayerPackageUrl=function(){return this._playerPackageUrl},e.prototype.getPlayerReadOnlyPackageUrl=function(){return this._playerReadOnlyPackageUrl},e.prototype.getDebugPlayerPackageUrl=function(){return this._debugPlayerPackageUrl},e.prototype.getBackgroundImageUrl=function(){return this._backgroundImageUrl},e.prototype.getWebPackageUrl=function(){return this._webPackageUrl},e.prototype.getWebReadOnlyPackageUrl=function(){return this._webReadOnlyPackageUrl},e.prototype.getDebugWebPackageUrl=function(){return this._debugWebPackageUrl},e.prototype.getTag=function(t){return e.getTagValue(this._tags,t)},e.getTagValue=function(e,t){var n=e[t];return Object(o.isDefined)(n)?n:null},e.getAppModuleSettingValue=function(e,t){var n;return e&&(null===(n=e.find((function(e){return e.name===t})))||void 0===n?void 0:n.value)},e.prototype.getTags=function(){return Object(o.clone)(this._tags)},e.prototype.updateAppPackageMetadata=function(t){this._packageProperties=e.tryParsePackageProperties(t),this._packagePropertiesJson=t},e.tryParsePackageProperties=function(e){if(e)try{return JSON.parse(e)}catch(e){o.CoreLog.error("AppInfo.tryParsePackageProperties",e,"Failed to parse package properties.")}return null},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"Region",(function(){return m}));var r=n(0),o=n(164),i=n(165),a=n(166),s=n(167),c=n(110),u=n(168),p=n(129),l=n(25),d=n(290),f=n(86),y=n(145),m=function(){function e(t){this._values=__assign({},t),Object(r.isWebPlayer)()||Object(r.isWebAuthoring)()||Object(r.isSovereignCloudRegion)(t.name)||e._setBuildRelatedValues(this._values)}return e.getCurrentRegion=function(){var t=this;if(null===e._currentRegion){Object(r.isWebAuthoring)()?e._setWebAuthoringRegion():Object(r.isWebPlayer)()&&e._setWebPlayerRegion(),Object(r.regionChangedEvent)().addListener((function(n){e._currentRegion=t._getRegion(n.region)}));var n=void 0,o=Object(r.getRegionConfig)();o?e._currentRegion=this._getRegion(o.region):(n=r.services.tip1EndPoint?new e(f.a.getValues()):new e(l.a.getValues()),e._currentRegion=n)}return e._currentRegion},e.setEventBroker=function(t){t.subscribe([r.EventBrokerId.Runtime_EnvironmentChanged],(function(t,n){return e._currentEnvironmentName=n.name}))},e.setGlobalOverrides=function(t){e._currentRegionOverrides=t},e.getGlobalOverrides=function(){return __assign({},e._currentRegionOverrides)},e.clearGlobalOverrides=function(){e._currentRegionOverrides={}},e._getRegion=function(t){var n;switch(t){case"prod":n=new e(l.a.getValues());break;case"test":case"int":if(Object(r.useTip2InTest)()){n=new e(y.a.getValues());break}n=new e(f.a.getValues());break;case"preprod":n=new e(p.a.getValues());break;case"tip2":n=new e(y.a.getValues());break;case"gccmoderate":n=new e(s.a.getValues());break;case"gcchigh":n=new e(a.a.getValues());break;case"dod":n=new e(o.a.getValues());break;case"mooncake":n=new e(u.a.getValues());break;case"ex":n=new e(i.a.getValues());break;case"rx":n=new e(d.a.getValues());break;default:throw new Error("Undefined region: "+t)}return n},e._setWebAuthoringRegion=function(){var t=r.ObjectFactory.instance.getSingleton(r.IUrlHashManagerSingletonKey).getParameterValue("portal").toLowerCase(),n=e._getRegionNameFromPortalQueryParam(t);n&&Object(r.setRegion)(n)},e._setBuildRelatedValues=function(e){var t;t=r.authoring.webAuthoringProductionEndpoint?{docServerEndpoint:l.a.docServerEndpoint,docServerRegion:"Production",playerResourcesEndpoint:l.a.playerResourcesEndpoint,appFromTemplateUseExtendedGallery:!1}:r.authoring.webAuthoringIntegrationEndpoint?{docServerEndpoint:c.a.docServerEndpoint,docServerRegion:"Integration",playerResourcesEndpoint:c.a.playerResourcesEndpoint,appFromTemplateUseExtendedGallery:!0}:{docServerEndpoint:f.a.docServerEndpoint,docServerRegion:"Test",playerResourcesEndpoint:f.a.playerResourcesEndpoint,appFromTemplateUseExtendedGallery:!0},e.docServerEndpoint.toString()===t.docServerEndpoint.toString()&&e.playerResourcesEndpoint.toString()===t.playerResourcesEndpoint.toString()||(e.docServerEndpoint=t.docServerEndpoint,e.playerResourcesEndpoint=t.playerResourcesEndpoint,e.useCustomDocServerPackager=!0),e.appFromTemplateUseExtendedGallery=t.appFromTemplateUseExtendedGallery,e.docServerRegion=t.docServerRegion},e._setWebPlayerRegion=function(){var t=r.ObjectFactory.instance.getSingleton(r.IUrlHashManagerSingletonKey),n=t.getParameterValue("overrideRegion").toLowerCase(),o=t.getParameterValue("overridePackager"),i=n||Object(r.getWebPlayerEnvironmentString)(),a=r.Regions.find((function(e){return i.toLowerCase()===e}));if(!a)switch(i){case"local":case"tip1":a="test";break;case"gccmoderate":a="gccmoderate";break;default:a="prod"}o&&e._overridePackager(o),Object(r.setRegion)(a)},e._overridePackager=function(t){var n,r,o="";switch(t){case"PreProd":o="Preproduction",n=p.a.playerResourcesEndpoint,r=p.a.docServerEndpoint;break;case"Int":o="Integration",n=c.a.playerResourcesEndpoint,r=c.a.docServerEndpoint}n&&r&&o&&e.setGlobalOverrides({playerResourcesEndpoint:n,docServerEndpoint:r,docServerRegion:o,useCustomDocServerPackager:!0})},e._getRegionNameFromPortalQueryParam=function(e){if(!e)return null;var t="tip1"===e?"test":r.Regions.find((function(t){return e.toLowerCase()===t}));return t},Object.defineProperty(e.prototype,"paRpInvokeUrl",{get:function(){return this._values.paRpInvokeUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paBadInvokeUrl",{get:function(){return this._values.paBadInvokeUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._values.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endpointTitle",{get:function(){return this._values.endpointTitle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clientId",{get:function(){return this._values.clientId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authUri",{get:function(){return this._values.authUri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"redirectUri",{get:function(){return this._values.redirectUri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logInResource",{get:function(){return this._values.logInResource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apiHubRuntimeAudience",{get:function(){return this._values.apiHubRuntimeAudience},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"consentServerResource",{get:function(){return this._values.consentServerResource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rtsDataServiceResource",{get:function(){return this._values.rtsDataServiceResource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"powerAppsServiceResource",{get:function(){return this._values.powerAppsServiceResource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webAuthResource",{get:function(){return this._values.webAuthResource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"flowsResource",{get:function(){return this._values.flowsResource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"microsoftGraphResource",{get:function(){return this._values.microsoftGraphResource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"teamsEndpoint",{get:function(){return this._values.teamsEndpoint},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"teamsPowerAppsId",{get:function(){return this._values.teamsPowerAppsId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"powerAppsRpBaseUrl",{get:function(){return this._values.powerAppsRpBaseUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"powerAppsApiVersion",{get:function(){return this._values.powerAppsApiVersion},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"powerPlatformRpBaseUrl",{get:function(){return this._values.powerPlatformRpBaseUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"powerPlatformRpApiVersion",{get:function(){return this._values.powerPlatformRpApiVersion},enumerable:!1,configurable:!0}),e.prototype.powerPlatformTenantBaseUrl=function(e){return this._values.powerPlatformTenantBaseUrl(e)},e.prototype.powerPlatformEnvironmentBaseUrl=function(e){return this._values.powerPlatformEnvironmentBaseUrl(e)},Object.defineProperty(e.prototype,"powerPlatformResource",{get:function(){return this._values.powerPlatformResource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bapBaseUrl",{get:function(){return this._values.bapBaseUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bapApiVersion",{get:function(){return this._values.bapApiVersion},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cdsBaseUrl",{get:function(){return this._values.cdsBaseUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cdsApiVersion",{get:function(){return this._values.cdsApiVersion},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"microsoftGraphEndpoint",{get:function(){return this._values.microsoftGraphEndpoint},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clientConsentEndPoint",{get:function(){return this._values.clientConsentEndPoint},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webPlayerSignUpEndPoint",{get:function(){return this._values.webPlayerSignUpEndPoint},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webPlayerConsentEndPoint",{get:function(){return this._values.webPlayerConsentEndPoint},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webAuthoringSignUpEndPoint",{get:function(){return this._values.webAuthoringSignUpEndPoint},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gcmSenderId",{get:function(){return this._values.gcmSenderId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"powerAppsRedirectUri",{get:function(){return this._values.powerAppsRedirectUri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"installGatewayLinkUrl",{get:function(){return this._values.installGatewayLinkUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"installVNetGatewayLinkUrl",{get:function(){return this._values.installVNetGatewayLinkUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"flowRPBaseUrl",{get:function(){return this._values.flowRpBaseUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"aibTextServiceResource",{get:function(){return this._values.aibTextServiceResource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"aibTextServiceEndpoint",{get:function(){return this._values.aibTextServiceEndpoint},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"flowPortalBaseUrl",{get:function(){return this._values.flowPortalBaseUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cesFeedbackEndpoint",{get:function(){return this._values.cesFeedbackEndpoint},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cesFeedbackServiceResource",{get:function(){return this._values.cesFeedbackServiceResource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"neptuneServiceResource",{get:function(){return this._values.neptuneResource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"neptuneServiceAudience",{get:function(){return this._values.neptuneAudience},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"createPVABotUrl",{get:function(){return this._values.createPVABotUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playerResourcesEndpoint",{get:function(){return Object(r.isDefined)(e._currentRegionOverrides.playerResourcesEndpoint)?e._currentRegionOverrides.playerResourcesEndpoint:this._values.playerResourcesEndpoint},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docServerEndpoint",{get:function(){return Object(r.isDefined)(e._currentRegionOverrides.docServerEndpoint)?e._currentRegionOverrides.docServerEndpoint:this._values.docServerEndpoint},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docServerRegion",{get:function(){return Object(r.isDefined)(e._currentRegionOverrides.docServerRegion)?e._currentRegionOverrides.docServerRegion:this._values.docServerRegion},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"useCustomDocServerPackager",{get:function(){return Object(r.isDefined)(e._currentRegionOverrides.useCustomDocServerPackager)?e._currentRegionOverrides.useCustomDocServerPackager:this._values.useCustomDocServerPackager},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appFromTemplateUseExtendedGallery",{get:function(){return Object(r.isDefined)(e._currentRegionOverrides.appFromTemplateUseExtendedGallery)?e._currentRegionOverrides.appFromTemplateUseExtendedGallery:this._values.appFromTemplateUseExtendedGallery},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"powerAppsBadBaseUrl",{get:function(){return this._values.powerAppsBadBaseUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"powerAppsBadApiVersion",{get:function(){return this._values.powerAppsBadApiVersion},enumerable:!1,configurable:!0}),e.prototype._createConsentUri=function(e){var t=new r.UrlBuilder(e),n=new r.Core_Url(window.location.href);return n.query&&t.appendQuery(n.query),n.fragment&&t.appendQuery(n.fragment),t.toUrl()},Object.defineProperty(e.prototype,"webPlayerConsentUri",{get:function(){var e,t,n=null===(t=null===(e=null===window||void 0===window?void 0:window.webPlayerServerConfig)||void 0===e?void 0:e.EndpointConfig)||void 0===t?void 0:t.TrialEndpoint,o=n?new r.Core_Url(n):this._values.webPlayerConsentEndPoint;return this._createConsentUri(o)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"currentEnvironmentName",{get:function(){return e._currentEnvironmentName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"portalUri",{get:function(){return e._currentEnvironmentName?this._appendEnvironment(this._values.portalUri):this._values.portalUri},enumerable:!1,configurable:!0}),e.prototype._appendEnvironment=function(t){var n=new r.UrlBuilder(t);return n.appendPath("environments/".concat(e._currentEnvironmentName,"/")),n.toUrl()},Object.defineProperty(e.prototype,"appDownloadRootUri",{get:function(){return this._values.appDownloadRootUri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"consumerPortalUri",{get:function(){return this._values.consumerPortalUri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"powerBIServiceResource",{get:function(){return this._values.powerBIServiceResource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formsProServiceResource",{get:function(){return this._values.formsProServiceResource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"microsoftStreamServiceResource",{get:function(){return this._values.microsoftStreamServiceResource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"intelligenceStudioBaseUrl",{get:function(){return this._values.intelligenceStudioBaseUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rawPortalUri",{get:function(){return this._values.portalUri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"manageEntitiesUri",{get:function(){var e=new r.UrlBuilder(this.portalUri);return e.appendPath("entities"),e.toUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectionsUri",{get:function(){var e=new r.UrlBuilder(this.portalUri);return e.appendPath("connections"),e.toUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logicflowsUri",{get:function(){var e=new r.UrlBuilder(this.portalUri);return e.appendPath("logicflows"),e.toUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ecsHostResource",{get:function(){return this._values.ecsHostResource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clusterCategory",{get:function(){return this._values.clusterCategory},enumerable:!1,configurable:!0}),e._currentRegion=null,e._currentRegionOverrides={},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"addCustomHeadersOptionsToBuilder",(function(){return a})),n.d(t,"appendCustomHeadersOptions",(function(){return s}));var r=n(0),o=n(3),i=n(1);function a(e,t){var n=JSON.stringify(t);e.addHeader(o.HeaderName.CustomHeadersOptions,n)}function s(e,t){if(e.headers){var n=e.headers[o.HeaderName.CustomHeadersOptions];if(n){var a=i.hb.safeCast(JSON.parse(n));!function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];void 0!==r&&(e[n]=r)}}(a,t),t=a,delete e.headers[o.HeaderName.CustomHeadersOptions]}}!function(e,t){e.headers||(e.headers=Object(r.HashTableUtility_create)());var n=JSON.stringify(t);e.headers[o.HeaderName.CustomHeadersOptions]=n}(e,t)}},function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"g",(function(){return u}));var r={other:!0,rp:!0,connector:!0,apihub:!0,ppapi:!0},o="rp",i="other",a="connector",s="apihub",c="ppapi";function u(e){return!!r[e]}},function(e,t,n){"use strict";n.r(t),n.d(t,"DefTypes",(function(){return r})),n.d(t,"JsonPrimitives",(function(){return o})),n.d(t,"ResultForm",(function(){return i})),n.d(t,"ResultForms",(function(){return p})),n.d(t,"RequestMediaType",(function(){return c})),n.d(t,"ResponseMediaType",(function(){return u})),n.d(t,"ParamType",(function(){return f})),n.d(t,"DateTimeNamedFormats",(function(){return l})),n.d(t,"AuthTypeName",(function(){return d}));var r,o,i,a=n(3),s=n(55);!function(e){e.LanguageVariable="LanguageVariable",e.RestFunction="RestFunction",e.CompositeFunction="CompositeFunction",e.HostFunction="HostFunction",e.GeneratedFunction="GeneratedFunction",e.Literal="Literal",e.ServiceVariableReference="ServiceVariableReference",e.ParameterReference="ParameterReference",e.VariableReference="VariableReference",e.QuoteString="QuoteString",e.StringFormat="StringFormat",e.DateTimeFormat="DateTimeFormat",e.FunctionCall="FunctionCall",e.O365ParseEmailAddresses="O365ParseEmailAddresses",e.BuiltInFunctionCall="BuiltInFunctionCall",e.BuiltInFunctionName_O365ComposeRecipientsArray="O365ComposeRecipientsArray",e.BuiltInFunctionName_O365ComposeAttendeesArray="O365ComposeAttendeesArray",e.SampleXmlElement="SampleXmlElement",e.XmlSimpleType="XmlSimpleType",e.IdentityTType="IdentityTType",e.XmlSimpleIdentityType="XmlSimpleIdentity",e.CdpNavigation="CdpNavigation",e.CdpAttachment="CdpAttachment",e.CdpPolymorphic="CdpPolymorphicLookup",e.CdpObjectOptionSet="CdpObjectOptionSet",e.CdpArrayOptionSet="CdpArrayOptionSet",e.CdsOptionSet="CdsOptionSet",e.CdsArrayOptionSet="CdsArrayOptionSet",e.CdsNavigation="CdsNavigation",e.CdsEntity="CdsEntity",e.CdsAttachment="CdsAttachment",e.File="File",e.LargeImage="LargeImage",e.BlobTType="BlobTType",e.Base64TType="Base64TType",e.JsonPrimitive="JsonPrimitive",e.JsonObject="JsonObject",e.JsonUntypedObject="JsonUntypedObject",e.JsonTuple="JsonTuple",e.JsonArray="JsonArray",e.JsonMapObject="JsonMapObject",e.JsonDateTimeString="JsonDateTimeString",e.JsonDateTimeNumber="JsonDateTimeNumber",e.JsonDateString="JsonDateString",e.JsonGuid="JsonGuid",e.JsonDateTimeNoTimeZoneString="JsonDateTimeNoTimeZoneString"}(r||(r={})),function(e){e.Boolean="boolean",e.Number="number",e.String="string"}(o||(o={})),function(e){e.Void="void",e.Self="self",e.Single="single",e.Aggregate="aggregate"}(i||(i={}));var c,u,p=[i.Void,i.Self,i.Single,i.Aggregate];!function(e){e.Binary=a.MediaType.ApplicationOctetStream,e.FormUrlEncoded=a.MediaType.ApplicationFormUrlEncoded,e.Json=a.MediaType.ApplicationJson,e.MultipartFormData=a.MediaType.MultipartFormData}(c||(c={})),function(e){e.Binary=a.MediaType.ApplicationOctetStream,e.Json=a.MediaType.ApplicationJson,e.Xml=a.MediaType.ApplicationXml}(u||(u={}));var l,d,f=s.XsdTypeNames;!function(e){e.Iso8601ExtendedUtc="Iso8601ExtendedUtc"}(l||(l={})),function(e){e.ConnectionProvider="connectionProvider"}(d||(d={}))},function(e,t,n){},function(e,t,n){"use strict";n.r(t),n.d(t,"ODataUtility",(function(){return r})),n.d(t,"SupportedOdataVersion",(function(){return o})),n.d(t,"ODataConstants",(function(){return i}));var r,o,i;n(0);!function(e){e.formatNavigationNextLinkPropertyName=function(e){return"".concat(e).concat(i.MetadataPropertyName.NextLink)},e.formatNavigationBindPropertyName=function(e){return"".concat(e).concat(i.MetadataPropertyName.Bind)},e.formatAnnotatedPropName=function(e){return"_".concat(e).concat(i.MetadataPropertyName.Value)}}(r||(r={})),function(e){e[e.OData3=3]="OData3",e[e.OData4=4]="OData4"}(o||(o={})),function(e){e.ApiVersion="api-version",e.NextLink="odata.nextLink",e.NullValue="null",function(e){e.Select="$select",e.Expand="$expand",e.Top="$top",e.Skip="$skip",e.SkipToken="$skiptoken",e.Filter="$filter",e.OrderBy="$orderby",e.Apply="$apply",e.Count="$count",e.CdsView="savedQuery",e.Format="$format",e.PkColumn="pkColumn",e.PkIsAutoGenerated="isGeneratedColumn",function(e){e.Add="add",e.Mul="mul",e.Div="div",e.Sub="sub",e.And="and",e.Or="or",e.Equals="eq",e.NotEquals="ne",e.GreaterThanOrEqual="ge",e.GreaterThan="gt",e.LessThanOrEqual="le",e.LessThan="lt",e.Not="not",e.Negate="-"}(e.FilterOperators||(e.FilterOperators={})),function(e){e.Ascending="asc",e.Descending="desc"}(e.OrderByDirections||(e.OrderByDirections={})),function(e){e.None="none",e.Full="full",e.Minimal="minimal"}(e.ODataMetadataValues||(e.ODataMetadataValues={}))}(e.QueryOption||(e.QueryOption={})),function(e){e.Version="OData-Version",e.Prefer="Prefer"}(e.HeaderName||(e.HeaderName={})),function(e){e.ContinueOnError="odata.continue-on-error",e.Version4_0="4.0",e.MaxPage_Size="odata.maxpagesize={0}",e.ReturnRepresentation="return=representation",e.IncludeAnnotations_Annotation="odata.include-annotations={0}"}(e.HeaderValue||(e.HeaderValue={})),function(e){e.Context="@odata.context",e.ETag="@odata.etag",e.Type="@odata.type",e.Id="@odata.id",e.Bind="@odata.bind",e.NextLink="@odata.nextLink",e.Value="_value",e.FormattedValue="@OData.Community.Display.V1.FormattedValue",e.AssociatedNavigationProperty="@Microsoft.Dynamics.CRM.associatednavigationproperty",e.AttributeName="@OData.Community.Display.V1.AttributeName",e.ViewLookupFieldAliasEnding=".OData.Community.Display.V1.CurrentEntityField",e.ViewDotNotation="_x002e_"}(e.MetadataPropertyName||(e.MetadataPropertyName={}))}(i||(i={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"PowerAppsP2TrialInternalGuid",(function(){return i})),n.d(t,"BapEndpoints",(function(){return r}));var r,o=n(0),i="d3703ef2-235b-4098-b756-ce6402008bc7";!function(e){function t(){return"2016-11-01"}e.getApiVersion=t,function(e){e.getApiVersionValue=function(){return t()},e.getBaseUrl=function(){return new o.Core_Url("https://api.bap.microsoft.com")}}(e.Prod||(e.Prod={})),function(e){e.getApiVersionValue=function(){return t()+"-alpha"},e.getBaseUrl=function(){return Object(o.useTip2InTest)()?new o.Core_Url("https://tip2.api.bap.microsoft.com"):new o.Core_Url("https://tip1.api.bap.microsoft.com")}}(e.Test||(e.Test={})),function(e){e.getApiVersionValue=function(){return t()+"-beta"},e.getBaseUrl=function(){return new o.Core_Url("https://tip2.api.bap.microsoft.com")}}(e.Tip2||(e.Tip2={})),function(e){e.getApiVersionValue=function(){return t()},e.getBaseUrl=function(){return new o.Core_Url("https://gov.api.bap.microsoft.us")}}(e.Gcc||(e.Gcc={})),function(e){e.getApiVersionValue=function(){return t()},e.getBaseUrl=function(){return new o.Core_Url("https://high.api.bap.microsoft.us")}}(e.GccHigh||(e.GccHigh={})),function(e){e.getApiVersionValue=function(){return t()},e.getBaseUrl=function(){return new o.Core_Url("https://api.bap.appsplatform.us")}}(e.Military||(e.Military={})),function(e){e.getApiVersionValue=function(){return t()},e.getBaseUrl=function(){return new o.Core_Url("https://api.bap.partner.microsoftonline.cn")}}(e.Mooncake||(e.Mooncake={})),function(e){e.getApiVersionValue=function(){return t()},e.getBaseUrl=function(){return new o.Core_Url("https://api.bap.eaglex.ic.gov")}}(e.Ex||(e.Ex={})),function(e){e.getApiVersionValue=function(){return t()},e.getBaseUrl=function(){return new o.Core_Url("https://api.bap.microsoft.scloud")}}(e.Rx||(e.Rx={})),e.providers="providers/Microsoft.BusinessAppPlatform",e.apiVersionKey="api-version"}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"ResponseTypes",(function(){return r}));var r,o=n(0);!function(e){e.Text="text",e.ArrayBuffer="arraybuffer",e.Blob="blob",e.Document="document",e.Json="json",e.PABinary="pabinary";var t=Object(o.HashTableUtility_create)({text:e.Text,arraybuffer:e.ArrayBuffer,blob:e.Blob,document:e.Document,json:e.Json,pabinary:e.PABinary});e.tryConvertFromString=function(e){return"string"!=typeof e?null:t[e.toLowerCase()]||null},e.isValid=function(e){return"string"==typeof e&&t[e]===e}}(r||(r={}))},function(e,t,n){"use strict";var r,o,i;n.r(t),n.d(t,"UpdateDisplayNameResultCode",(function(){return r})),n.d(t,"GetAppResultCode",(function(){return o})),n.d(t,"DeleteAppResultCode",(function(){return i})),function(e){e[e.Success=0]="Success",e[e.ApplicationDisplayNameInUse=1]="ApplicationDisplayNameInUse",e[e.Error=2]="Error"}(r||(r={})),function(e){e[e.Success=0]="Success",e[e.NotFound=1]="NotFound",e[e.Failure=2]="Failure",e[e.Forbidden=3]="Forbidden"}(o||(o={})),function(e){e[e.Success=0]="Success",e[e.ObjectNotFound=1]="ObjectNotFound",e[e.UnknownError=2]="UnknownError",e[e.Unauthorized=3]="Unauthorized"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r,o=n(0),i=n(60),a=n(51),s=n(22),c=n(53),u=n(48),p=n(2),l=n(13);!function(e){e.RegionName="prod",e.endpointTitle="Prod",e.clientId="4e291c71-d680-4d0e-9640-0a3358e31177",e.formsProServiceResource="c9a559d2-7aab-4f13-a6ed-e7e9c52aec87",e.microsoftStreamServiceResource="cf53fce8-def6-4aeb-8d30-b158e7b1cf83",e.authUri=new o.Core_Url("https://login.microsoftonline.com/common/"),e.redirectUri=new o.Core_Url("https://www.microsoft.com/en-us/projectsiena"),e.authenticatorRedirectUri=new o.Core_Url("x-msauth-com-microsoft-msapps://com.microsoft.msapps"),e.apiHubRuntimeAudience="https://apihub.azure.com",e.consentServerResource=e.apiHubRuntimeAudience,e.powerAppsServiceResource="https://service.powerapps.com/",e.powerPlatformResource=Object(l.e)("prod"),e.flowsResource="https://service.flow.microsoft.com/",e.rtsDataServiceResource="https://rts.powerapps.com",e.webAuthResource="c6c4e5e1-0bc0-4d7d-b69b-954a907287e4",e.powerBIServiceResource="https://analysis.windows.net/powerbi/api",e.powerAppsRedirectUri=new o.Core_Url("https://web.powerapps.com/powerappsredirect/"),e.docServerEndpoint=new o.Core_Url("https://create.powerapps.com/"),e.playerResourcesEndpoint=new o.Core_Url("https://paplayercdn.azureedge.net/"),e.microsoftGraphResource="https://graph.microsoft.com/",e.flowRPEndpoint=new o.Core_Url("https://api.flow.microsoft.com"),e.aibTextServiceResource="https://text.pai.dynamics.com",e.aibTextServiceEndpoint="https://wus2-text.pai.dynamics.com/",e.flowPortalEndpoint=new o.Core_Url("https://flow.microsoft.com/"),e.cesFeedbackEndpoint=i.NpsUrlOrigin,e.cesFeedbackServiceResource="https://microsoft.onmicrosoft.com/nps-prod";var t=new o.Core_Url("https://go.microsoft.com/fwlink/?linkid=841572"),n=new o.Core_Url("https://go.microsoft.com/fwlink/?linkid=841573");function r(){return new o.Core_Url("https://api.powerapps.com")}function d(){return new o.Core_Url("https://"+AppMagic.PowerApps.Constants.BadRpBaseUrlSuffix)}function f(){return p.PowerAppEndpoints.getApiVersion()}function y(e,t){return Object(o.getCordovaPlatformId)()===o.CordovaPlatformId.iOS?t:e}function m(e,t){return Object(o.getCordovaPlatformId)()===o.CordovaPlatformId.iOS?t:e}e.ecsHostResource="https://ecs.office.com",e.neptuneResource="https://licensing.powerplatform.microsoft.com/",e.neptuneAudience="https://licensing.powerplatform.microsoft.com/auth",e.createPVABotUrl=new o.Core_Url("https://web.powerva.microsoft.com/"),e.getPowerAppsRpBaseUrl=r,e.getPowerAppsBadBaseUrl=d,e.getApiVersionValue=f,e.getCdmRpApiVersionValue=function(){return p.PowerAppEndpoints.getCdmRpApiVersion()},e.microsoftGraphEndpoint=new o.Core_Url("https://graph.microsoft.com/"),e.portalEndPoint=new o.Core_Url("https://make.powerapps.com/"),e.appDownloadRootEndPoint=new o.Core_Url("https://apps.powerapps.com/open/"),e.consumerPortalEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?linkid=2169021"),e.webPlayerSignUpEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkId=785760"),e.webPlayerConsentEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkId=785764"),e.webAuthoringSignUpEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkId=785768"),e.InstallGatewayLinkUrl=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkID=817346"),e.InstallVNetGatewayLinkUrl=new o.Core_Url("https://admin.powerplatform.microsoft.com/ext/DataGateways"),e.teamsEndpoint=new o.Core_Url("https://teams.microsoft.com"),e.teamsPowerAppsId="ba1cabe6-dfd2-4334-96c0-0dcdf86e18e5",e.getValues=function(){return{name:"prod",clusterCategory:"prod",endpointTitle:e.endpointTitle,clientId:e.clientId,authUri:e.authUri,redirectUri:y(e.redirectUri,e.authenticatorRedirectUri),portalUri:e.portalEndPoint,appDownloadRootUri:e.appDownloadRootEndPoint,consumerPortalUri:e.consumerPortalEndPoint,logInResource:e.powerAppsServiceResource,apiHubRuntimeAudience:e.apiHubRuntimeAudience,consentServerResource:e.consentServerResource,rtsDataServiceResource:e.rtsDataServiceResource,powerBIServiceResource:e.powerBIServiceResource,formsProServiceResource:e.formsProServiceResource,microsoftStreamServiceResource:e.microsoftStreamServiceResource,intelligenceStudioBaseUrl:u.IntelligenceEndpoints.Prod.intelligenceStudioBaseUrl,powerAppsServiceResource:e.powerAppsServiceResource,powerPlatformResource:e.powerPlatformResource,flowsResource:e.flowsResource,webAuthResource:e.webAuthResource,microsoftGraphResource:e.microsoftGraphResource,powerAppsRpBaseUrl:r(),powerAppsApiVersion:f(),powerPlatformRpBaseUrl:Object(l.b)("prod"),powerPlatformRpApiVersion:p.PowerAppEndpoints.powerPlatformApiVersion,powerPlatformTenantBaseUrl:Object(l.d)("prod"),powerPlatformEnvironmentBaseUrl:Object(l.c)("prod"),bapBaseUrl:s.BapEndpoints.Prod.getBaseUrl(),bapApiVersion:s.BapEndpoints.Prod.getApiVersionValue(),cdsBaseUrl:c.CdsEndpoints.Prod.getBaseUrl(),cdsApiVersion:c.CdsEndpoints.Prod.getApiVersionValue(),microsoftGraphEndpoint:e.microsoftGraphEndpoint,teamsEndpoint:e.teamsEndpoint,teamsPowerAppsId:e.teamsPowerAppsId,clientConsentEndPoint:m(t,n),webPlayerSignUpEndPoint:e.webPlayerSignUpEndPoint,webPlayerConsentEndPoint:e.webPlayerConsentEndPoint,webAuthoringSignUpEndPoint:e.webAuthoringSignUpEndPoint,gcmSenderId:AppMagic.PowerApps.Constants.Notification.Prod.gcmSenderId,powerAppsRedirectUri:e.powerAppsRedirectUri,playerResourcesEndpoint:e.playerResourcesEndpoint,docServerEndpoint:e.docServerEndpoint,docServerRegion:null,useCustomDocServerPackager:!1,appFromTemplateUseExtendedGallery:!1,paRpInvokeUrl:p.PowerAppEndpoints.paRpInvokeUrl,paBadInvokeUrl:a.BadEndpoints.paBadInvokeUrl,installGatewayLinkUrl:e.InstallGatewayLinkUrl,installVNetGatewayLinkUrl:e.InstallVNetGatewayLinkUrl,powerAppsBadBaseUrl:d(),powerAppsBadApiVersion:a.BadEndpoints.getApiVersion(),flowRpBaseUrl:e.flowRPEndpoint,aibTextServiceResource:e.aibTextServiceResource,aibTextServiceEndpoint:e.aibTextServiceEndpoint,flowPortalBaseUrl:e.flowPortalEndpoint,cesFeedbackEndpoint:e.cesFeedbackEndpoint,cesFeedbackServiceResource:e.cesFeedbackServiceResource,ecsHostResource:e.ecsHostResource,neptuneResource:e.neptuneResource,neptuneAudience:e.neptuneAudience,createPVABotUrl:e.createPVABotUrl}},e.getRedirectUri=y,e.getClientConsentEndPoint=m}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"m",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return v})),n.d(t,"a",(function(){return A})),n.d(t,"q",(function(){return C})),n.d(t,"r",(function(){return P})),n.d(t,"p",(function(){return w})),n.d(t,"o",(function(){return S})),n.d(t,"n",(function(){return O})),n.d(t,"c",(function(){return h}));var r,o,i=n(0),a=n(83),s=n(9),c=n(106),u=n(49),p=n(6),l=n(39),d=n(12),f=n(93),y=n(1),m=n(84);!function(e){e[e.Default=0]="Default",e[e.Custom=1]="Custom"}(r||(r={})),function(e){e.isValid=function(e){return Object(i.isObject)(e)&&Object(i.isDate)(e.apiLastChangedTime)&&Object(i.isNonEmptyString)(e.interfaceName)&&Object(i.isNumber)(e.revision)&&Object(i.isTypeScriptEnumValue)(e.status,u.a)&&Object(i.isBoolean)(e.isDeprecated)&&(null===e.expires||Object(i.isDate)(e.expires))}}(o||(o={}));var g=function(){function e(e){var t=this;this._revisions=e,this._revisionNumberWithDefaultBaseUrl=0,this._latestRevisionNumber=0,Object(i.forEach)(e,(function(e){null!==e&&("/"===e.baseUrl.toString()&&(t._revisionNumberWithDefaultBaseUrl&&i.CoreLog.warning("ApiServiceInterface.constructor","More than one revisions have the default baseUrl."),t._revisionNumberWithDefaultBaseUrl=e.revNumber),e.revNumber>t._latestRevisionNumber&&(t._latestRevisionNumber=e.revNumber))}))}return Object.defineProperty(e.prototype,"revisionNumberWithDefaultBaseUrl",{get:function(){return this._revisionNumberWithDefaultBaseUrl||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"latestRevisionNumber",{get:function(){return this._latestRevisionNumber||null},enumerable:!1,configurable:!0}),e.parse=function(t){return new e(Object(i.map)(t.revisions,v.parse,!1))},e.prototype.tryGetInterfaceRevision=function(e){return this._revisions[e]||null},e}(),v=function(){function e(e,t,n,r,o){this._revNumber=e,this._baseUrl=t,this._status=n,this._isDeprecated=r,this._expires=o}return Object.defineProperty(e.prototype,"revNumber",{get:function(){return this._revNumber},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseUrl",{get:function(){return this._baseUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDeprecated",{get:function(){return this._isDeprecated},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"expires",{get:function(){return this._expires},enumerable:!1,configurable:!0}),e.parse=function(t,n){var r=parseInt(n,10);if(isNaN(r)||r<1)throw new f.InvalidJsonServerResponse("Interface revision keys must be integer strings greater than zero.");if("/"!==t.baseUrl[0])throw new f.InvalidJsonServerResponse("Interface revision baseUrl must start with '/'.");var o=Object(u.c)(t.status,null),a=t.expires?new Date(t.expires):null;return new e(r,new i.Core_Url(t.baseUrl),o,!!t.deprecated,a)},e}();function b(e){var t,n;return e&&(e.will&&(t=e.will),e.wont&&(n=e.wont)),{will:t||[],wont:n||[]}}var h,A=function(){function e(e,t,n,r,o){void 0===o&&(o=!1),this._id=e.toLowerCase(),this._name=t,this._isFullApi=null!==n.swaggerJson,this._properties=n,this._rawServerRepresentation=r,this._apiRevisionManager=new m.b(this._id,n.interfaces,n.lastChangedTime,n.releaseStatus),this._isSuggested=o}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cacheItemId",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFullApi",{get:function(){return this._isFullApi},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return this._properties.displayName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this._properties.description},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"releaseStatus",{get:function(){return this._properties.releaseStatus},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastChangedTime",{get:function(){return this._properties.lastChangedTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tier",{get:function(){return this._properties.tier},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iconUri",{get:function(){return this._properties.iconUri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wadlUrl",{get:function(){return this._properties.wadlUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"swaggerJson",{get:function(){return this._properties.swaggerJson},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"termsOfUseUrl",{get:function(){return this._properties.termsOfUseUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"runtimeUrl",{get:function(){return this._properties.runtimeUrl},enumerable:!1,configurable:!0}),e.prototype.getConnectionParameters=function(e){return this._getActiveConnectionParameters(e)},Object.defineProperty(e.prototype,"connectionParameterSets",{get:function(){return this._properties.connectionParameterSets},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._properties.metadata},enumerable:!1,configurable:!0}),e.prototype.getGatewayParameterName=function(e){return this._tryGetGatewayParameterName(e)},e.prototype.getIsConsentRequired=function(e){return this._isConsentRequired(e)},e.prototype.getIsFirstParty=function(e){return this._isFirstPartyApi(e)},Object.defineProperty(e.prototype,"creator",{get:function(){return this._properties.creator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRuntimeService",{get:function(){return Object(i.equalsIgnoreCase)(this.id,s.ApiIds.RuntimeService)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCustomApi",{get:function(){return this._properties.metadata&&this._properties.metadata.source&&Object(i.equalsIgnoreCase)(this._properties.metadata.source,s.CustomApiSourceId)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCustomApimConnector",{get:function(){return this._properties.metadata&&this._properties.metadata.sourceApplication&&Object(i.equalsIgnoreCase)(this._properties.metadata.sourceApplication,s.CustomApimAppSource)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSuggested",{get:function(){return this._isSuggested},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"capabilities",{get:function(){return this._properties.capabilities},enumerable:!1,configurable:!0}),e.prototype.serializeToJson=function(){return this._rawServerRepresentation},e.prototype.supports=function(e){return(this.capabilities&e)===e},e.prototype.getScopesWill=function(){return Object(d.r)(this._properties.scopes.will)},e.prototype.getScopesWont=function(){return Object(d.r)(this._properties.scopes.wont)},e.prototype.tryGetLatestInterfaceRevisionNumber=function(e,t){return this._apiRevisionManager.tryGetLatestInterfaceRevisionNumber(e,t)},e.prototype.tryGetInterfaceRevisionNumberWithDefaultBaseUrl=function(e){return this._apiRevisionManager.tryGetInterfaceRevisionNumberWithDefaultBaseUrl(e)},e.prototype.tryGetInterfaceRevision=function(e,t){return this._apiRevisionManager.tryGetInterfaceRevision(e,t)},e.prototype._getActiveConnectionParameters=function(e){var t=this._properties.connectionParameters;if(e&&this.connectionParameterSets){var n=this.connectionParameterSets.values.find((function(t){return t.name===e}));n&&(t=n.parameters)}return t},e.prototype._isConsentRequired=function(e){var t=this._getActiveConnectionParameters(e);return Object(i.some)(t,(function(e,t){return e instanceof c.OAuthTokenConnectionParameter}))},e.prototype._isFirstPartyApi=function(e){var t=this._getActiveConnectionParameters(e);return Object(i.some)(t,(function(e){return e instanceof c.OAuthTokenConnectionParameter&&(e.oAuthSettings.properties&&Object(i.equalsIgnoreCase)(e.oAuthSettings.properties.IsFirstParty,"true"))}))},e.prototype._tryGetGatewayParameterName=function(e){var t=null,n=this._getActiveConnectionParameters(e);return Object(i.every)(n,(function(e,n){return e.type!==p.r.GatewaySetting||(t=n,!1)})),t},e.prototype.tryGetConnectionsLimit=function(){var e=this.metadata.connectionLimits[p.b];return"number"==typeof e?e:null},e.deserialize=function(e){return P(e)},e.prototype.isConnectionShareable=function(e){if(e&&this.connectionParameterSets&&this.connectionParameterSets.values){var t=this.connectionParameterSets.values.find((function(t){return t.name===e}));if(t){if(t.metadata)return t.metadata.allowSharing}else i.CoreLog.warningEx("Connection.isShareable",{message:"Connection created using parameter set that is not found in api metadata.",eventData:{api:this.name,connectionId:this.id,connectionParameterSetName:e}})}return!!this.metadata&&this.metadata.allowSharing},e}();function C(e){return new A(e.id,e.name,h.parse(e.properties),e,function(e){return Object(i.equalsIgnoreCase)(e,s.ApiIds.Office365Users)||Object(i.equalsIgnoreCase)(e,s.ApiIds.Sql)||Object(i.equalsIgnoreCase)(e,s.ApiIds.SharepointOnline)}(e.id))}function P(e){try{var t=y.k.safeCast(e);if(!t)throw new l.SafeCastError("IApiResponse");return C(t)}catch(t){var n=Object(i.safeCastString)(e&&e.id)||"{unknown}";return i.CoreLog.error("Api.tryParseFromResponseWithLogging",t,"apiId: "+n),null}}function w(e){return Object(i.equalsIgnoreCase)(e,s.ApiIds.SharepointOnline)}function S(e){return Object(i.equalsIgnoreCase)(e,s.ApiIds.FlowService)}function O(e){var t=e.getConnectionParameters();return e.supports(p.d.Composite)&&t&&Object(i.isValue)(t[s.FileSource])}!function(e){function t(e){var t=0;return e.map((function(e){switch(e.toLowerCase()){case p.c:return p.d.Blob;case p.v:return p.d.Tabular;case p.f:return p.d.Composite;case p.a:return p.d.Actions;case p.w:return p.d.Triggers;case p.e:return p.d.Cloud;case p.m:return p.d.Gateway;case p.q:return p.d.Parameter;default:return null}})).filter((function(e){return null!==e})).forEach((function(e){return t|=e})),t}e.parse=function(e){var n,o,s=Object(i.safeCastAbsoluteUrl)(e.primaryRuntimeUrl);return e.interfaces?(n=Object(i.HashTableUtility_create)(),Object(i.forEach)(e.interfaces,(function(e,t){0!==t.length&&(t=t.toLowerCase(),n[t]=g.parse(e))}))):n=Object(i.HashTableUtility_create)(),o=e.createdBy?{kind:r.Custom,createdBy:e.createdBy}:{kind:r.Default},{displayName:e.displayName,description:e.description,releaseStatus:Object(u.c)(e.releaseTag,u.a.Production),tier:Object(u.d)(e.tier,u.b.Standard),scopes:b(e.scopes),lastChangedTime:e.changedTime?new Date(e.changedTime):null,iconUri:Object(i.safeCastAbsoluteUrlString)(e.iconUri),wadlUrl:Object(i.safeCastAbsoluteUrl)(e.wadlUrl),termsOfUseUrl:Object(i.safeCastAbsoluteUrlString)(e.termsOfUseUrl),runtimeUrl:s,capabilities:t(e.capabilities),connectionParameters:Object(a.parseParameters)(e.connectionParameters),connectionParameterSets:Object(a.parseParameterSets)(e.connectionParameterSets),metadata:Object(a.parseMetadata)(e.metadata),interfaces:n,creator:o,swaggerJson:e.swagger?JSON.stringify(e.swagger):null}}}(h||(h={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"k",(function(){return c})),n.d(t,"f",(function(){return p})),n.d(t,"g",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"e",(function(){return u}));var r,o=n(0),i=n(1);!function(e){e[e.Standard=0]="Standard",e[e.DefaultTenant=1]="DefaultTenant",e[e.Legacy=2]="Legacy",e[e.Unknown=3]="Unknown"}(r||(r={}));var a=function(){function e(e,t,n,r,o,i){this._id=e,this._name=t,this._location=r,this._type=n,this._properties=o,this._displayName=o.displayName,this._rawServerRepresentation=i}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cacheItemId",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"location",{get:function(){return this._location},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return this._displayName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this._properties},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDefault",{get:function(){return this._properties.isDefault},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasDataverse",{get:function(){return!!this._properties.linkedEnvironmentMetadata},enumerable:!1,configurable:!0}),e.prototype.serializeToJson=function(){return this._rawServerRepresentation},e.tryDeserialize=function(e){var t=i.Kb.safeCast(e);return t?c(t):null},e}(),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(o.ApplicationError);function c(e){try{var t=u.parse(e.properties);return new a(e.id,e.name,e.type,e.location,t,e)}catch(t){if(t instanceof s){var n=t;o.CoreLog.warning("Environment.parse","Parsing environment '".concat(e.name,"' failed due to error: ").concat(n.message))}else o.CoreLog.warning("Environment.parse",t,"Parsing environment '".concat(e.name,"' failed due to unexpected error."));return null}}var u,p="environments",l="Environments",d="environment";!function(e){e.parse=function(e){var t=r[e.creationType];if(Object(o.isUndefined)(t)&&(t=r.Unknown),e.createdTime){var n=Date.parse(e.createdTime);if(isNaN(n))throw new s("Invalid createdTime returned for environment.")}if(e.lastModifiedTime){var i=Date.parse(e.lastModifiedTime);if(isNaN(i))throw new s("Invalid lastModifiedTime returned for environment.")}if(e.linkedEnvironmentMetadata)var a=e.linkedEnvironmentMetadata;return{displayName:e.displayName,provisioningState:e.provisioningState,creationType:t,createdBy:e.createdBy,lastModifiedBy:e.lastModifiedBy,createdTime:n,lastModifiedTime:i,isDefault:!!e.isDefault,permissions:e.permissions,linkedEnvironmentMetadata:a,updateCadence:e.updateCadence,environmentSku:e.environmentSku,runtimeEndpoints:e.runtimeEndpoints,cluster:e.cluster,governanceConfiguration:e.governanceConfiguration}}}(u||(u={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"GetItemsResultCode",(function(){return r})),n.d(t,"ODataListItemsTool",(function(){return d}));var r,o=n(0),i=(n(97),n(17)),a=n(3),s=n(21),c=n(8),u=n(11),p=n(14),l=n(30);!function(e){e[e.Success=0]="Success",e[e.UnableToReachServer=1]="UnableToReachServer",e[e.UnableToParseResponse=2]="UnableToParseResponse",e[e.ItemsMaxLimitExceeded=3]="ItemsMaxLimitExceeded"}(r||(r={}));var d=function(){function e(e,t,n,r,o){this._uri=e,this._resourceName=t,this._telemetryOperationName=r,this._nextLinkKeyWord=o||s.ODataConstants.NextLink,this._httpClient=n}return e.prototype.getItemsAsync=function(e,t,n,r){void 0===r&&(r=!0);var o=this._getResourceRequest(a.Method.GET,this._uri,e);return this._getItemsAsync(o,[],t,n,r)},e.prototype._getItemsAsync=function(e,t,n,s,u){var p=this;return void 0===u&&(u=!0),e.headers||(e.headers=Object(o.HashTableUtility_create)()),s&&(Object(o.forEach)(s,(function(t,n){e.headers[n]=t})),Object(l.addTelemetryAdditionalData)(e,{customHeaders:JSON.stringify(s)})),e.headers[a.HeaderName.Accept]=a.MediaType.ApplicationJson,Object(c.e)(e.headers,{resource:this._resourceName}),Object(i.appendCustomHeadersOptions)(e,{optInMSHeaders:!0,addCustomHeaders:!0}),this._getItemsInBatchAsync(e).then((function(e){if(e.resultCode!==r.Success){var i={resultCode:e.resultCode,items:null};return e.errorMessage&&(i.errorMessage=e.errorMessage),i}for(var c=Object(o.isDefined)(n)?Math.min(e.items.length,n-t.length):e.items.length,l=0;l<c;l++)t.push(e.items[l]);if(c<e.items.length)return{resultCode:r.ItemsMaxLimitExceeded,items:t};if(null===e.nextLink||!u)return{resultCode:r.Success,items:t,nextLink:e.nextLink};var d=p._getResourceRequest(a.Method.GET,e.nextLink);return p._getItemsAsync(d,t,n,s,u)}))},e.prototype._getItemsInBatchAsync=function(e){var t=this;return(this._telemetryOperationName?Object(p.sendHttpJsonResponseAsync)(this._httpClient,e,this._telemetryOperationName):this._httpClient.sendHttpJsonResponseAsync(e)).then(u.createSuccessfulAsyncResult,u.sendHttpErrorHandler_ConvertToAsyncResult).then((function(n){if(!n.success)return{resultCode:r.UnableToReachServer,items:null,nextLink:null,errorMessage:n.message};try{var i=n.result;Object(o.checkObject)(i),Object(o.checkArray)(i.value);var a=i[t._nextLinkKeyWord];return(a=Object(o.isNonEmptyString)(a)?a:null)&&o.Log.trackActivityEvent("ODataListItemsTool._getItemsInBatchAsync",{message:"Next link ".concat(a," returned by request ").concat(e.url)}),{resultCode:r.Success,items:i.value,nextLink:a}}catch(e){}return{resultCode:r.UnableToParseResponse,items:null,nextLink:null}}),(function(e){return Object(o.throwIfCanceled)(e),{resultCode:r.UnableToReachServer,items:null,nextLink:null,errorMessage:Object(o.formatErrorMessage)(e)}}))},e.prototype._getResourceRequest=function(e,t,n){var r=new o.UrlBuilder(t);return this._addQueryOptions(r,n),{url:r.toString(),method:e}},e.prototype._addQueryOptions=function(e,t){Object(o.isUndefined)(t)||(Object(o.isString)(t.expand)&&e.setQueryParam(s.ODataConstants.QueryOption.Expand,t.expand),Object(o.isString)(t.apiVersion)&&e.setQueryParam(s.ODataConstants.ApiVersion,t.apiVersion),Object(o.isString)(t.top)&&e.setQueryParam(s.ODataConstants.QueryOption.Top,t.top),Object(o.isString)(t.skipToken)&&e.setQueryParam(s.ODataConstants.QueryOption.SkipToken,t.skipToken),Object(o.isString)(t.filter)&&e.setQueryParam(s.ODataConstants.QueryOption.Filter,t.filter))},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"isAllowedRfc3339DateString",(function(){return p})),n.d(t,"convertDateStringToDValue",(function(){return l})),n.d(t,"convertDateStringFromDValue",(function(){return d})),n.d(t,"convertDateTimeStringToDValue",(function(){return f})),n.d(t,"convertDateTimeStringFromDValue",(function(){return m})),n.d(t,"convertDateTimeNumberToDValue",(function(){return g})),n.d(t,"convertDateTimeNumberFromDValue",(function(){return v}));var r=n(0),o=n(37),i=n(10);Object(r.check)(0===new Date("1970-01-01T00:00:00Z").getTime(),"The current browser doesn't represent epoch with the JavaScript convention. This will cause data corruption with date values.");var a,s={strictRegex:/^\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d(\.\d+)?(Z|[+-]\d\d:\d\d)$/i,allowedRegex:/^\d\d\d\d-\d\d-\d\dT\d\d:\d\d(:\d\d(\.\d+)?)?(Z?|[+-]\d\d:\d\d)$/i,allowedISOFormats:["YYYY-MM-DDThh:mm:ssZ","YYYY-MM-DDThh:mm:sshh:mm","YYYY-MM-DDThh:mm:ss"]},c={strictRegex:/^\d\d\d\d-\d\d-\d\d$/,allowedRegex:/(^\d\d\d\d-\d\d-\d\dT\d\d:\d\d(:\d\d(\.\d+)?)?((Z|z)|[+-]\d\d:\d\d)$)|(^\d\d\d\d-\d\d-\d\d$)/i,allowedISOFormats:["YYYY-MM-DD","YYYY-MM-DDT00:00:00Z","YYYY-MM-DDThh:mm:sshh:mm"]};function u(e,t){return(t.allowedRegex||t.strictRegex).test(e)}function p(e){return u(e,c)}function l(e,t){var n=function(e){if(!p(e))return null;return function(e){if(r.FallbackSwitch.isActivated("AppConnectivity.DisableLocalDateStringParsing")){t=new Date(e);return Object(i.isNaNType)(t.getTime())?null:new Date(t.getTime()+60*t.getTimezoneOffset()*1e3)}var t=new Date(e+"T00:00:00");return Object(i.isNaNType)(t.getTime())?null:new Date(t.getTime())}(e.substr(0,10))}(e);if(null===n){var o=Object(r.CoreUtility_formatString)(AppMagic.Strings.InvalidDateResponse,e,c.allowedISOFormats.map((function(e){return"'".concat(e,"'")})).join(", "));return r.CoreLog.errorEx("DateTimeUtility.convertDateStringToDValue","Invalid value"),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.Validation,AppMagic.Data.ErrorSeverity.Severe,o,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},raiseToastNotification:!1,errorMessage:o,wasReported:!1,functionName:null})}return n.getTime()}function d(e){var t=new Date(e),n=t.getMonth()+1,o=t.getDate(),i=t.getFullYear(),a=n<10?"0".concat(n):n.toString(),s=o<10?"0".concat(o):o.toString(),c=("0000"+i.toString()).slice(-4);return Object(r.CoreUtility_formatString)("{0}-{1}-{2}",c,a,s)}function f(e,t,n){var c=null;if(null===(c=e===o.DateTimeBehavior.NoTimeZone?function(e){var t,n,r,o;e.split(/[T]/);if(null===y(e))return null;var s=e;"Z"!==s.slice(-1)&&"z"!==s.slice(-1)||(s=s.substr(0,s.length-1));var c=s.split(/[-:T\.]/).map((function(e,t){return t===a.Milliseconds?function(e){return e+="000",parseInt(e.substr(0,3))}(e):parseInt(e)})),u=new Date(c[0],c[1]-1,c[2],null!==(t=c[3])&&void 0!==t?t:0,null!==(n=c[4])&&void 0!==n?n:0,null!==(r=c[5])&&void 0!==r?r:0,null!==(o=c[6])&&void 0!==o?o:0);return Object(i.isNaNType)(u.getTime())?null:u}(t):y(t))){var u=Object(r.CoreUtility_formatString)(AppMagic.Strings.InvalidDateTimeResponse,t,s.allowedISOFormats.map((function(e){return"'".concat(e,"'")})).join(", "));return r.CoreLog.errorEx("DateTimeUtility.convertDateTimeStringToDValue",Object(r.scrubSensitiveDataSafe)(u)),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.Validation,AppMagic.Data.ErrorSeverity.Severe,u,{errorContext:{entityName:"",id:-1,propertyName:null==n?void 0:n.propertyName},raiseToastNotification:!1,errorMessage:u,wasReported:!1,functionName:null})}return c.getTime()}function y(e){if(!function(e){return u(e,s)}(e))return null;var t=new Date(e);return Object(i.isNaNType)(t.getTime())?null:t}function m(e,t){var n=new Date(t);if(e===o.DateTimeBehavior.NoTimeZone){var r=function(e){var t,n=e.getFullYear().toString(),r=e.getMonth()+1;t=r<10?"0"+r.toString():r.toString();var o,i=e.getDate();o=i<10?"0"+i.toString():i.toString();return"".concat(n,"-").concat(t,"-").concat(o)}(n);r+="T"+n.toTimeString().substr(0,8);var i=n.getMilliseconds();return i>0&&(r+=function(e){if(e<10)return".00"+e.toString();if(e<100)return".0"+e.toString();return"."+e.toString()}(i)),r}return n.toISOString()}function g(e){var t=new Date(e);return Object(i.isNaNType)(t.getTime())?null:t.getTime()}function v(e){return e}!function(e){e[e.Year=0]="Year",e[e.Month=1]="Month",e[e.Date=2]="Date",e[e.Hours=3]="Hours",e[e.Minutes=4]="Minutes",e[e.Seconds=5]="Seconds",e[e.Milliseconds=6]="Milliseconds"}(a||(a={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"TelemetryScheme",(function(){return i})),n.d(t,"TelemetrySchemeWithSpace",(function(){return a})),n.d(t,"addTelemetryOptions",(function(){return s})),n.d(t,"addTelemetryOptionsToBuilder",(function(){return c})),n.d(t,"addTelemetryAdditionalData",(function(){return u}));var r=n(0),o=n(3),i="paclient-telemetry",a=i+" ";function s(e,t){e.headers||(e.headers=Object(r.HashTableUtility_create)());var n=JSON.stringify(t);e.headers[o.HeaderName.TelemetryOptions]=a+n}function c(e,t){var n=JSON.stringify(t);e.addHeader(o.HeaderName.TelemetryOptions,a+n)}function u(e,t){e.headers||(e.headers=Object(r.HashTableUtility_create)());var n={},i=e.headers[o.HeaderName.TelemetryAdditionalData];i&&(n=Object(r.tryParseJson)(i)),Object(r.upsertObjectProperties)(n,t);var a=JSON.stringify(n);e.headers[o.HeaderName.TelemetryAdditionalData]=a}},function(e,t,n){"use strict";var r;n.r(t),n.d(t,"ResponseValueType",(function(){return r})),function(e){e[e.Xhr=0]="Xhr",e[e.BinaryData=1]="BinaryData",e[e.Json=2]="Json",e[e.Document=3]="Document",e[e.DomNode=4]="DomNode",e[e.XmlAsJson=5]="XmlAsJson",e[e.Text=6]="Text",e[e.DValue=7]="DValue"}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"CompositeConnection",(function(){return i})),n.d(t,"FileSourceCompositeConnection",(function(){return a})),n.d(t,"MsFlowCompositeConnection",(function(){return s}));var r=n(0),o=n(34),i=(n(6),n(1),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"dependentConnectionIds",{get:function(){return this._dependentConnectionIds},enumerable:!1,configurable:!0}),t}(o.a)),a=function(e){function t(t,n,o,i){var a=this;return(a=e.call(this,t,n,o,i)||this)._dependentConnectionIds=Object(r.HashTableUtility_create)(),a._dependentConnectionIds[AppMagic.ConnectionHub.Constants.FileSource]=a.connectionParameters.fileSource.connectionId,a}return __extends(t,e),t}(i),s=function(e){function t(t,n,o,i){var a=this;(a=e.call(this,t,n,o,i)||this)._msFlowName=a.connectionParameters.workflowName,a._msWorkflowEntityId=a.connectionParameters.workflowEntityId;var s=Object(r.filter)(a.connectionParameters.$connections,(function(e){var t,n;return!Object(r.equalsIgnoreCase)(null!==(t=null==e?void 0:e.source)&&void 0!==t?t:"",AppMagic.ConnectionHub.Constants.FlowDependentConnectionSource.DependentSourceEmbedded)||Object(r.equalsIgnoreCase)(null!==(n=null==e?void 0:e.apiId)&&void 0!==n?n:"",AppMagic.ConnectionHub.Constants.ApiIds.CommonDataServiceCurrentEnvironment)}));return a._dependentConnectionIds=Object(r.map)(s,(function(e){return e.connectionId}),!1),a}return __extends(t,e),Object.defineProperty(t.prototype,"msFlowName",{get:function(){return this._msFlowName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"msWorkflowEntityId",{get:function(){return this._msWorkflowEntityId},enumerable:!1,configurable:!0}),t}(i);!function(e){function t(e,t){return!!Object(r.equalsIgnoreCase)(e,t)||!(!e||!t)&&(e.toLowerCase().startsWith(AppMagic.ConnectionHub.Constants.ApiIds.CommonDataServiceCurrentEnvironment)&&t.toLowerCase().startsWith(AppMagic.ConnectionHub.Constants.ApiIds.CommonDataServiceCurrentEnvironment))}e.createCompositeConnectionPutRequest=function(t,n,o){if(AppMagic.ConnectionHub.Api.isMsFlowApi(n.id)){if(!t.connectionRef.parameterHints||!t.connectionRef.parameterHints.workflowName||!Object(r.isNonEmptyString)(t.connectionRef.parameterHints.workflowName.value)){var i="Cannot read workflowName for Flow connection. Connection reference for connection ".concat(t.connectionInstanceId," has invalid parameterHints.");throw Object(r.errorEx)("CompositeConnection.createCompositeConnectionPutRequest",i,{eventData:{compositeReferenceJson:JSON.stringify(t)}}),new Error(i)}var a=t.connectionRef.parameterHints.workflowName.value,s=Object(r.map)(o,(function(e){return e.id}));return e.createMsFlowCompositeConnectionPutRequest(n,s,a)}if(AppMagic.ConnectionHub.Api.isFileSourceApi(n)){var c=Object(r.getValues)(o)[0];return e.createFileSourceCompositeConnectionPutRequest(n,c)}throw new Error("Unknown composite connection type for apiId: ".concat(n.id,". Connection ID: ").concat(t.connectionInstanceId))},e.createFileSourceCompositeConnectionPutRequest=function(e,t){var n=new r.UrlBuilder(t.api.runtimeUrl);return n.appendPath(t.name),{properties:{displayName:Object(r.CoreUtility_formatString)(AppMagic.Strings.ConnectionsCompositeSuffixFormat,t.displayName),connectionParameters:{fileSource:{connectionId:t.id,url:n.toString()}},metadata:{fileSource:t.id}}}},e.createMsFlowCompositeConnectionPutRequest=function(e,t,n){var o={properties:{connectionParameters:{workflowName:n,$connections:{}},metadata:{}}};return Object(r.forEach)(t,(function(e,t){o.properties.connectionParameters.$connections[t]={connectionId:e},o.properties.metadata[t]=e})),o},e.matchCompositeDependencies=function(e,n){var o=r.FallbackSwitch.isActivated("AppConnectivity.FlowEmbeddedCDS")?r.equalsIgnoreCase:t;return Object(r.areEqual)(e,n,o)}}(i||(i={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"MinimalXMLHttpRequest",(function(){return r})),n.d(t,"SendTriggerFunctionStatusCode",(function(){return o})),n.d(t,"OptionSetType",(function(){return i})),n.d(t,"SavedQueryType",(function(){return a}));var r,o,i,a,s=n(0);!function(e){e.isValid=function(e){return e instanceof XMLHttpRequest||Object(s.isObject)(e)&&"number"==typeof e.DONE&&"number"==typeof e.readyState&&"number"==typeof e.status&&"string"==typeof e.responseType&&Object(s.isFunction)(e.getAllResponseHeaders)&&Object(s.isFunction)(e.getResponseHeader)&&("text"!==e.responseType||"string"==typeof e.responseText)}}(r||(r={})),function(e){e[e.Ok=200]="Ok",e[e.NotFound=404]="NotFound",e[e.TimeOut=408]="TimeOut",e[e.HostFunctionError=500]="HostFunctionError",e[e.SendTriggerNotRegistered=503]="SendTriggerNotRegistered",e[e.StringifyError=508]="StringifyError"}(o||(o={})),function(e){e[e.Picklist=0]="Picklist",e[e.State=1]="State",e[e.Status=2]="Status",e[e.Boolean=3]="Boolean"}(i||(i={})),function(e){e[e.MAIN_APPLICATION_VIEW=0]="MAIN_APPLICATION_VIEW",e[e.ADVANCED_SEARCH=1]="ADVANCED_SEARCH",e[e.SUB_GRID=2]="SUB_GRID",e[e.QUICKFIND_SEARCH=4]="QUICKFIND_SEARCH",e[e.REPORTING=8]="REPORTING",e[e.OFFLINE_FILTERS=16]="OFFLINE_FILTERS",e[e.MA_SEARCH=32]="MA_SEARCH",e[e.LOOKUP_VIEW=64]="LOOKUP_VIEW",e[e.SM_APPOINTMENTBOOK_VIEW=128]="SM_APPOINTMENTBOOK_VIEW",e[e.OUTLOOK_FILTERS=256]="OUTLOOK_FILTERS",e[e.ADDRESSBOOK_FILTERS=512]="ADDRESSBOOK_FILTERS",e[e.SAVEDQUERYTYPE_OTHER=2048]="SAVEDQUERYTYPE_OTHER",e[e.INTERACTIVE_WORKFLOW_VIEW=4096]="INTERACTIVE_WORKFLOW_VIEW",e[e.OFFLINE_TEMPLATE=8192]="OFFLINE_TEMPLATE",e[e.OUTLOOK_TEMPLATE=131072]="OUTLOOK_TEMPLATE",e[e.CUSTOM_DEFINED_VIEW=16384]="CUSTOM_DEFINED_VIEW"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"k",(function(){return f})),n.d(t,"l",(function(){return y})),n.d(t,"h",(function(){return m})),n.d(t,"i",(function(){return g})),n.d(t,"j",(function(){return v})),n.d(t,"b",(function(){return r}));var r,o=n(0),i=n(1),a=n(3),s=n(39),c=n(32),u=n(76),p=n(79),l=n(6),d=function(){function e(t,n,r,o){this._testConnectionRequired=!1,this._id=t,this._name=n,this._properties=r;var i=this._properties.api?this._properties.api.runtimeUrl:null;this._apiRuntimeUrlString=i?i.toString():null,this._rawServerRepresentation=o,this._connectionParameters=e._getConnectionParameters(r)}return e.deserialize=function(e,t){return y(e,t)},e._getConnectionParameters=function(e){if(e.multiauthConnectionParametersSet){var t=e.multiauthConnectionParametersSet,n=Object(o.HashTableUtility_create)();return t.values&&Object(o.forEach)(t.values,(function(e,t){e.value&&(n[t]=e.value)})),n}return e.connectionParameters},Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cacheItemId",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"environmentName",{get:function(){return this._properties.environmentName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return this._properties.displayName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iconUri",{get:function(){return this._properties.iconUri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"api",{get:function(){return this._properties.api},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"accountName",{get:function(){return this._properties.accountName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apiScopes",{get:function(){return{will:this._properties.api.getScopesWill(),wont:this._properties.api.getScopesWont()}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apiRuntimeUrlString",{get:function(){return this._apiRuntimeUrlString},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apiId",{get:function(){return this._properties.apiId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOnPremise",{get:function(){return this._properties.isOnPremise},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"consentInfo",{get:function(){return this._properties.consentInfo},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"xrmConnectionReferences",{get:function(){return this._properties.xrmConnectionReferences},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"createdXrmConnectionReferenceLogicalName",{get:function(){return this._properties.createdXrmConnectionReferenceLogicalName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"xrmConnectionReferenceLogicalName",{get:function(){return this._properties.xrmConnectionReferenceLogicalName},set:function(e){this._properties.xrmConnectionReferenceLogicalName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectionParameters",{get:function(){return this._connectionParameters},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"multiAuthParametersSetName",{get:function(){return this.properties.multiauthConnectionParametersSet?this.properties.multiauthConnectionParametersSet.name:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isApiFirstParty",{get:function(){return this.api.getIsFirstParty(this.multiAuthParametersSetName)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isApiConsentRequired",{get:function(){return this.api.getIsConsentRequired(this.multiAuthParametersSetName)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isShareable",{get:function(){return this.api.isConnectionShareable(this.multiAuthParametersSetName)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"createdTime",{get:function(){return this._properties.createdTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastModifiedTime",{get:function(){return this._properties.lastModifiedTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"createdBy",{get:function(){return this._properties.createdBy},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._properties.status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"testLink",{get:function(){return this._properties.testLink},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRuntimeService",{get:function(){return this.api.isRuntimeService},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isAuthenticated",{get:function(){var e=this.status.errorCode;return e!==p.ConnectionStatusErrorCode.Unauthorized&&e!==p.ConnectionStatusErrorCode.Unauthenticated},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this._properties},enumerable:!1,configurable:!0}),e.prototype.serializeToJson=function(){return this._rawServerRepresentation},e.prototype.supports=function(e){return this.api.supports(e)},Object.defineProperty(e.prototype,"isTestConnectionRequiredAfterConsent",{get:function(){return this._testConnectionRequired},set:function(e){this._testConnectionRequired=e},enumerable:!1,configurable:!0}),e}();function f(e,t){var n=e.id.toLowerCase(),i=e.name,a=r.parse(e.properties,t);return e.properties&&!e.properties.api&&t&&(e.properties.api=t.serializeToJson()),function(e){return Object(u.isFileSource)(null==e?void 0:e.connectionParameters)}(a)?(a.connectionParameters.fileSource.connectionId=a.connectionParameters.fileSource.connectionId.toLowerCase(),new c.FileSourceCompositeConnection(n,i,a,e)):function(e){return Object(u.isMsFlow)(null==e?void 0:e.connectionParameters)}(a)?(Object(o.forEach)(a.connectionParameters.$connections,(function(e){e.connectionId=e.connectionId.toLowerCase()})),new c.MsFlowCompositeConnection(n,i,a,e)):new d(n,i,a,e)}function y(e,t){try{var n=i.U.safeCast(e);if(!n)throw new s.SafeCastError("IConnectionResponse");return f(n,t)}catch(t){var r=t,a=Object(o.safeCastString)(e&&e.id)||"{unknown}";return o.CoreLog.error("Connection.tryParseFromResponseWithLogging",r,"connectionId: "+a),null}}function m(e){return e instanceof c.CompositeConnection}function g(e){return e instanceof c.FileSourceCompositeConnection}function v(e){return e instanceof c.MsFlowCompositeConnection}!function(e){function t(e,t,n){if(!t)return function(e,t){var n=!1;t&&t.values&&Object(o.every)(t.values,(function(r,o){var i=e.getConnectionParameters(t.name)[o];return!i||i.type!==l.r.GatewaySetting||(n=!0,!1)}));return n}(e,n);var r=!1;return Object(o.every)(t,(function(t,n){var o=e.getConnectionParameters()[n];return!o||o.type!==l.r.GatewaySetting||(r=!0,!1)})),r}function n(e){var t=!0,n=p.ConnectionStatusErrorCode.OK;if(Object(o.isDefined)(e)&&e.length>0){e.forEach((function(e){e.status=e.status.toLowerCase(),Object(o.isDefined)(e.error)&&Object(o.isDefined)(e.error.code)&&(e.error.code=e.error.code.toLowerCase())}));var r=e[0];if(r.status===l.u&&Object(o.isObject)(r.error))switch(r.error.code){case l.i:n=p.ConnectionStatusErrorCode.ConfigurationNeeded;break;case l.l:n=p.ConnectionStatusErrorCode.Unauthorized,t=!1;break;case l.k:n=p.ConnectionStatusErrorCode.Unauthenticated,t=!1;break;case l.j:n=p.ConnectionStatusErrorCode.TooManyRequests}}return{isAuthenticated:t,errorCode:n}}function r(e){if(!e||e.length<1)return null;var t=e[0],n=a.KnownMethods.indexOf(t.method.toLocaleUpperCase());return n>=0?{requestUri:new o.Url(e[0].requestUri),method:a.KnownMethods[n]}:null}function i(e){return!e||e.length<1?null:e[0].connectionreferencelogicalname}e.parse=function(e,a){var s,c;return s=e.api?AppMagic.ConnectionHub.Api.parse(e.api):a,e.consentInfo&&(e.consentInfo.consentLink||e.consentInfo.firstPartyLoginUri)&&(c=e.consentInfo),{displayName:e.displayName,iconUri:Object(o.safeCastAbsoluteUrlString)(e.iconUri),api:s,apiId:e.apiId.toLowerCase(),connectionParameters:e.connectionParameters||null,multiauthConnectionParametersSet:e.connectionParametersSet||null,isOnPremise:t(s,e.connectionParameters,e.connectionParametersSet),createdTime:e.createdTime,lastModifiedTime:e.lastModifiedTime,createdBy:e.createdBy,status:n(e.statuses),testLink:r(e.testLinks),environmentName:e.environment.name,consentInfo:c||null,accountName:e.accountName||null,xrmConnectionReferences:e.connectionReferences||null,createdXrmConnectionReferenceLogicalName:e.createdXrmConnectionReferenceLogicalName||null,xrmConnectionReferenceLogicalName:i(e.connectionReferences)}}}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"errorHasHttpResponse",(function(){return r}));n(0);function r(e){return e&&!!e.response}},function(e,t,n){"use strict";n.r(t),n.d(t,"ListAppPackageResultStatus",(function(){return o})),n.d(t,"AppExtendedMetadataStatus",(function(){return i})),n.d(t,"PowerAppsApp",(function(){return w}));var r,o,i,a=n(0),s=n(41),c=n(17),u=n(3),p=n(35),l=n(44),d=n(21),f=n(8),y=n(42),m=n(18),g=n(14),v=n(30),b=n(1),h=n(2),A=n(24),C=n(40),P=n(4);!function(e){e.appPublishCall="PowerAppsApp.Publish",e.appPackageCall="PowerAppsApp.Package",e.appCreateCall="PowerAppsApp.Create",e.appDeleteCall="PowerAppsApp.Delete",e.appGetCall="PowerAppsApp.Get",e.appUpdateCall="PowerAppsApp.Update",e.appSetFavoriteCall="PowerAppsApp.SetFavorite",e.appUnsetFavoriteCall="PowerAppsApp.UnsetFavorite",e.ModelAppSetFavoriteCall="PowerAppsApp.ModelAppSetFavorite",e.ModelAppUnSetFavoriteCall="PowerAppsApp.ModelAppUnSetFavorite",e.appListPackageCall="PowerAppsApp.ListPackage",e.appPatchConnRefs="PowerAppsApp.PatchConnectionReferences",e.appUpdateDisplayName="PowerAppsApp.UpdateDisplayName",e.appGetVersionHistory="PowerAppsApp.GetVersionHistory",e.appGetAppExtendedMetadataCall="PowerAppsApp.GetAppExtendedMetadata"}(r||(r={})),function(e){e[e.Ready=0]="Ready",e[e.InProgress=1]="InProgress",e[e.Error=2]="Error",e[e.AccessError=3]="AccessError",e[e.NotFound=4]="NotFound"}(o||(o={})),function(e){e[e.Ready=0]="Ready",e[e.InProgress=1]="InProgress",e[e.Error=2]="Error",e[e.AccessError=3]="AccessError",e[e.NotFound=4]="NotFound"}(i||(i={}));var w=function(){function e(e,t,n){this._appName=e,this._appName&&(this._appEndpointUrl=P.PowerAppsUtility.getPowerAppsAppUrl(this._appName)),n&&(this._unifiedAppEndpointUrl=AppMagic.PowerApps.PowerAppsUtility.getUnifiedPowerAppsAppUrl(n.environmentId,n.appLogicalName)),this._httpClient=t,this._pollingHandle=null}return e.prototype.upsertAppAsync=function(e,t){return t.isNewApp?(e.properties.canConsumeAppPass=!0,this._postAppAsync(e,t.solutionId)):this.putAppAsync(e)},e.prototype._postAppAsync=function(e,t){var n,o=new l.JsonHttpRequestBuilder,i=e.properties.environment.name;n=t?P.PowerAppsUtility.getSolutionAppsEndpoint(i,t):Core.Environment.usePowerPlatformApi()?P.PowerAppsUtility.getAppsAndComponentLibrariesEnvironmentEndpoint(i):P.PowerAppsUtility.getAppsAndComponentLibrariesEndpoint(),Core.Environment.usePowerPlatformApi()?P.PowerAppsUtility.authorizeHttpBuilder(o,u.Method.POST,n,f.d.PowerPlatformService,P.PowerAppsUtility.getPowerPlatformApiVersion()):P.PowerAppsUtility.authorizeHttpBuilder(o,u.Method.POST,n,f.d.PowerAppsService),o.setJsonValue("",e),o.addQueryParameter("lifeCycleId",e.properties.lifeCycleId);var a=o.generateSendHttpRequestParameters();return Object(c.appendCustomHeadersOptions)(a,{addCustomHeaders:!0}),Object(g.sendHttpAsync)(this._httpClient,a,r.appCreateCall)},e.prototype.putAppAsync=function(e){var t=new l.JsonHttpRequestBuilder;if(Core.Environment.usePowerPlatformApi()){var n=P.PowerAppsUtility.getPowerPlatformAppUrl(this._appName,e.properties.environment.name);P.PowerAppsUtility.authorizeHttpBuilder(t,u.Method.PUT,n,f.d.PowerPlatformService,P.PowerAppsUtility.getPowerPlatformApiVersion())}else P.PowerAppsUtility.authorizeHttpBuilder(t,u.Method.PUT,this._appEndpointUrl,f.d.PowerAppsService);t.setJsonValue("",e),t.addQueryParameter("lifeCycleId",e.properties.lifeCycleId);var o=t.generateSendHttpRequestParameters();return Object(c.appendCustomHeadersOptions)(o,{addCustomHeaders:!0}),Object(g.sendHttpAsync)(this._httpClient,o,r.appUpdateCall)},e.prototype.patchAppWithConnectionReferencesAsync=function(e,t){var n=new l.JsonHttpRequestBuilder;if(Core.Environment.usePowerPlatformApi()){var o=P.PowerAppsUtility.getPowerPlatformAppUrl(this._appName);P.PowerAppsUtility.authorizeHttpBuilder(n,u.Method.PATCH,o,f.d.PowerPlatformService,P.PowerAppsUtility.getPowerPlatformApiVersion())}else P.PowerAppsUtility.authorizeHttpBuilder(n,u.Method.PATCH,this._appEndpointUrl,f.d.PowerAppsService);t&&n.addQueryParameter("leaseId",t),n.setJsonValue("",e);var i=n.generateSendHttpRequestParameters();return Object(c.appendCustomHeadersOptions)(i,{addCustomHeaders:!0}),Object(g.sendHttpIgnoreResponseAsync)(this._httpClient,i,r.appPatchConnRefs)},e.prototype.getAppAsync=function(t){var n;void 0===t&&(t=[]);var o=null!==(n=this._unifiedAppEndpointUrl)&&void 0!==n?n:this._appEndpointUrl;a.CoreLog.verbose("In getAppAsync, appName "+this._appName);var i=new s.BodilessHttpRequestBuilder;if(Core.Environment.usePowerPlatformApi()){var p=P.PowerAppsUtility.getPowerPlatformAppUrl(this._appName);P.PowerAppsUtility.authorizeHttpBuilder(i,u.Method.GET,p,f.d.PowerPlatformService,P.PowerAppsUtility.getPowerPlatformApiVersion())}else P.PowerAppsUtility.authorizeHttpBuilder(i,u.Method.GET,o,f.d.PowerAppsService);t.push(h.GetAppExpandParameters.UserConsent),i.addQueryParameter(d.ODataConstants.QueryOption.Expand,t.join(","));var l=i.generateSendHttpRequestParameters();return Object(c.appendCustomHeadersOptions)(l,{addCustomHeaders:!0}),a.CoreLog.verbose("getAppAsync uses endpoint: "+o),Object(g.sendHttpAsync)(this._httpClient,l,r.appGetCall).then((function(t){return e._parseGetAppResponse(t.responseText)}),e._handleUnsuccessfulGetApp)},e.prototype.getAppAndPackageAsync=function(e){return void 0===e&&(e=[]),C.f.getGenerateDebugPlayerPackageLocally()?this.getAppAsync(e):(a.CoreLog.verbose("In getAppAndPackageAsync, appName "+this._appName),Object(a.PromiseUtility_join)([this.listPackageUntilReadyAsync(),this.getAppAsync(e)]).then((function(e){var t=e[0],n=e[1];if(t.status!==o.Ready){var r=Object(a.CoreUtility_formatString)("ListPackage call returned an error. Status: {0}",o[t.status]);if(t.status===o.AccessError)return a.CoreLog.error("PowerAppsApp.getAppAndPackageAsync",r),{appInfo:null,resultCode:A.GetAppResultCode.Forbidden,error:t.error};if(t.status===o.NotFound)return a.CoreLog.error("PowerAppsApp.getAppAndPackageAsync",r),{appInfo:null,resultCode:A.GetAppResultCode.NotFound,error:t.error};if(t.error)throw t.error;throw new Error(r)}return n.resultCode!==A.GetAppResultCode.Success?a.CoreLog.error("PowerAppsApp.getAppAndPackageAsync","GetAppResultCode: "+A.GetAppResultCode[n.resultCode]):(n.appInfo.playerPackageUrl=t.result.playerPackageUri.value,n.appInfo.playerReadOnlyPackageUrl=t.result.playerPackageUri.readonlyValue,n.appInfo.webPackageUrl=t.result.webPackageUri.value,n.appInfo.webReadOnlyPackageUrl=t.result.webPackageUri.readonlyValue,n.appInfo.minimumRequiredApiVersion=t.result.minimumRequiredApiVersion,n.appInfo.appPackageResourcesKind=t.result.appPackageResourcesKind),n})).then(null,(function(e){return a.CoreLog.error("PowerAppsApp.getAppAndPackageAsync",e,"There was an error getting appInfo for the app."),{appInfo:null,resultCode:A.GetAppResultCode.Failure,error:e}})))},e.prototype.publishAppAsync=function(e){void 0===e&&(e=!1);var t,n=P.PowerAppsUtility.getPowerAppsPublishEndpoint(this._appName,e),o=new s.BodilessHttpRequestBuilder,i=P.PowerAppsUtility.tryGetDocumentServerEndpointHeader();i&&(o.addHeader(i.headerName,i.value),t={docServerEndPointHeaderName:i.headerName,docServerEndPointValue:i.value});var p=e?f.d.PowerPlatformService:P.PowerAppsUtility.getPowerAppsResourceName(),l=e?h.PowerAppEndpoints.powerPlatformSafePublishApiVersion:P.PowerAppsUtility.getPowerAppsApiVersion();P.PowerAppsUtility.authorizeHttpBuilder(o,u.Method.POST,n,p,l);var d=o.generateSendHttpRequestParameters();return Object(v.addTelemetryOptions)(d,{operationName:r.appPublishCall}),Object(y.addServiceErrorOptions)(d,{serviceType:e?m.d:P.PowerAppsUtility.getPowerAppsServiceType()}),Object(c.appendCustomHeadersOptions)(d,{addCustomHeaders:!0}),i&&Object(v.addTelemetryAdditionalData)(d,t),this._httpClient.sendHttpAsync(d).then(a.noOpFnAsync)},e.prototype.packageAppAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n,o,i,s,p;return __generator(this,(function(d){switch(d.label){case 0:t=P.PowerAppsUtility.getPowerAppsPackageEndpoint(this._appName),(n=new l.JsonHttpRequestBuilder).setJsonValue("",e),(o=P.PowerAppsUtility.tryGetDocumentServerEndpointHeader())&&(n.addHeader(o.headerName,o.value),i={docServerEndPointHeaderName:o.headerName,docServerEndPointValue:o.value}),P.PowerAppsUtility.authorizeHttpBuilder(n,u.Method.POST,t,f.d.PowerPlatformService,h.PowerAppEndpoints.powerPlatformSafePublishApiVersion),s=n.generateSendHttpRequestParameters(),Object(y.addServiceErrorOptions)(s,{serviceType:m.d}),Object(c.appendCustomHeadersOptions)(s,{addCustomHeaders:!0}),o&&Object(v.addTelemetryAdditionalData)(s,i),d.label=1;case 1:return d.trys.push([1,3,,4]),[4,Object(g.sendHttpAsync)(this._httpClient,s,r.appPackageCall)];case 2:return d.sent(),[3,4];case 3:throw p=d.sent(),Object(a.throwIfCanceled)(p),a.CoreLog.errorEx("PowerAppsApp.packageAppAsync",p),p;case 4:return[2]}}))}))},e.prototype.getVersionHistoryAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e,t,n,o,i;return __generator(this,(function(s){switch(s.label){case 0:e=P.PowerAppsUtility.getVersionsEndpoint(this._appName),t=new l.JsonHttpRequestBuilder,Core.Environment.usePowerPlatformApi()?P.PowerAppsUtility.authorizeHttpBuilder(t,u.Method.GET,e,f.d.PowerPlatformService,P.PowerAppsUtility.getPowerPlatformApiVersion()):P.PowerAppsUtility.authorizeHttpBuilder(t,u.Method.GET,e,f.d.PowerAppsService),n=t.generateSendHttpRequestParameters(),Object(c.appendCustomHeadersOptions)(n,{addCustomHeaders:!0}),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,Object(g.sendHttpAsync)(this._httpClient,n,r.appGetVersionHistory)];case 2:return o=s.sent(),[2,b.Dh.safeCast(JSON.parse(o.response))];case 3:throw i=s.sent(),a.CoreLog.errorEx("PowerAppsApp.getVersionHistoryAsync",i),i;case 4:return[2]}}))}))},e.prototype.putUpdateDisplayNameAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n,o,i;return __generator(this,(function(s){switch(s.label){case 0:t=P.PowerAppsUtility.getUpdateDisplayNameEndpoint(this._appName),n=new l.JsonHttpRequestBuilder,Core.Environment.usePowerPlatformApi()?P.PowerAppsUtility.authorizeHttpBuilder(n,u.Method.POST,t,f.d.PowerPlatformService,P.PowerAppsUtility.getPowerPlatformApiVersion()):P.PowerAppsUtility.authorizeHttpBuilder(n,u.Method.PUT,t,f.d.PowerAppsService),n.setJsonValue("",{displayName:"".concat(e)}),o=n.generateSendHttpRequestParameters(),Object(c.appendCustomHeadersOptions)(o,{addCustomHeaders:!0}),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,Object(g.sendHttpAsync)(this._httpClient,o,r.appUpdateDisplayName)];case 2:return s.sent(),[2,{resultCode:A.UpdateDisplayNameResultCode.Success}];case 3:return i=s.sent(),Object(a.throwIfCanceled)(i),i.message.indexOf(AppMagic.PowerApps.Constants.PowerAppsSaveDisplayNameConflictError)>-1?[2,{resultCode:A.UpdateDisplayNameResultCode.ApplicationDisplayNameInUse,errorMessage:i.message}]:(a.CoreLog.error("PowerAppsApp.putUpdateDisplayNameAsync",i),[2,{resultCode:A.UpdateDisplayNameResultCode.Error,errorMessage:i}]);case 4:return[2]}}))}))},e.prototype.postSetFavoriteAsync=function(){var e=P.PowerAppsUtility.getPowerAppSetFavoriteEndpoint(this._appName),t=new s.BodilessHttpRequestBuilder;P.PowerAppsUtility.authorizeHttpBuilder(t,u.Method.POST,e,P.PowerAppsUtility.getPowerAppsResourceName(),P.PowerAppsUtility.getPowerAppsApiVersion());var n=t.generateSendHttpRequestParameters();return Object(c.appendCustomHeadersOptions)(n,{addCustomHeaders:!0}),Object(g.sendHttpAsync)(this._httpClient,n,r.appSetFavoriteCall).then(a.noOpFnAsync)},e.prototype.postUnsetFavoriteAsync=function(){var e=P.PowerAppsUtility.getPowerAppUnsetFavoriteEndpoint(this._appName),t=new s.BodilessHttpRequestBuilder;P.PowerAppsUtility.authorizeHttpBuilder(t,u.Method.POST,e,P.PowerAppsUtility.getPowerAppsResourceName(),P.PowerAppsUtility.getPowerAppsApiVersion());var n=t.generateSendHttpRequestParameters();return Object(c.appendCustomHeadersOptions)(n,{addCustomHeaders:!0}),Object(g.sendHttpAsync)(this._httpClient,n,r.appUnsetFavoriteCall).then(a.noOpFnAsync)},e.prototype.postModelAppSetFavoriteAsync=function(e){var t=new a.UrlBuilder(this._unifiedAppEndpointUrl);e?t.appendPath(h.PowerAppEndpoints.UrlPaths.setFavoriteValue):t.appendPath(h.PowerAppEndpoints.UrlPaths.unsetFavoriteValue);var n=t.toUrl(),o=new s.BodilessHttpRequestBuilder;P.PowerAppsUtility.authorizeHttpBuilder(o,u.Method.POST,n,P.PowerAppsUtility.getPowerAppsResourceName(),P.PowerAppsUtility.getPowerAppsApiVersion());var i=o.generateSendHttpRequestParameters();Object(c.appendCustomHeadersOptions)(i,{addCustomHeaders:!0});var p=e?r.ModelAppSetFavoriteCall:r.ModelAppUnSetFavoriteCall;return Object(g.sendHttpAsync)(this._httpClient,i,p).then(a.noOpFnAsync)},e.prototype.getAppExtendedMetadataUntilReadyAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n,r,o;return __generator(this,(function(s){switch(s.label){case 0:t=Object(a.generateNonDashedUUID)(),Object(a.enterScope)(t),s.label=1;case 1:return s.trys.push([1,5,,6]),[4,this.getAppExtendedMetadataAsync(e)];case 2:return(n=s.sent()).status!==i.InProgress?[3,4]:(a.Log.updateOpenAppData({needsProcessing:!0}),[4,this._retryGetAppExtendedMetadataUntilReadyAsync(n.locationForPollingStatus)]);case 3:n=s.sent(),s.label=4;case 4:return r=Object(a.exitScopeAndGetRunTime)(t),a.Log.updateOpenAppData({getAppExtendedMetadataTime:r}),t="",[2,n];case 5:return o=s.sent(),null!==this._getAppExtendedMetadaPollingHandle&&(this._getAppExtendedMetadaPollingHandle.dispose(),this._getAppExtendedMetadaPollingHandle=null),Object(a.exitScope)(t),a.CoreLog.errorEx("PowerAppsApp.getAppExtendedMetadataUntilReadyAsync",o),[2,{status:i.Error,error:o}];case 6:return[2]}}))}))},e.prototype._retryGetAppExtendedMetadataUntilReadyAsync=function(t){return __awaiter(this,void 0,Promise,(function(){var n,r,o,s=this;return __generator(this,(function(c){switch(c.label){case 0:n=function(e){return s._getAppExtendedMetadataStatusFromLocationAsync(e)},r=function(e){switch(e.status){case i.Ready:return Object(a.createTailEnd)();case i.InProgress:return Object(a.createNext)(e.locationForPollingStatus);default:if(e.error)throw e.error;throw a.CoreLog.error("PowerAppsApp._retryGetAppExtendedMetadataUntilReadyAsync",e),new Error("There was an error while polling get app extended metadata uri.")}},this._getAppExtendedMetadaPollingHandle=Object(a.startPollingOperation)("PowerAppsApp._retryGetAppExtendedMetadataUntilReadyAsync",t,n,r,e.defaultRetryGetAppExtendedMetadataTimeoutMilliseconds),c.label=1;case 1:return c.trys.push([1,3,4,5]),[4,this._getAppExtendedMetadaPollingHandle.waitAsync()];case 2:return[2,c.sent()];case 3:return o=c.sent(),a.CoreLog.errorEx("PowerAppsApp._retryGetAppExtendedMetadataUntilReadyAsync",o),[2,{status:i.Error,error:o}];case 4:return null!==this._getAppExtendedMetadaPollingHandle&&(this._getAppExtendedMetadaPollingHandle.dispose(),this._getAppExtendedMetadaPollingHandle=null),[7];case 5:return[2]}}))}))},e.prototype.getAppExtendedMetadataAsync=function(t){return __awaiter(this,void 0,Promise,(function(){var n,o,l,d,v,b,h;return __generator(this,(function(A){switch(A.label){case 0:n=P.PowerAppsUtility.getPowerAppsGetAppExtendedMetadataEndpoint(this._appName,t),o=new s.BodilessHttpRequestBuilder,l=Core.Environment.usePowerPlatformApi()?P.PowerAppsUtility.getPowerPlatformApiVersion():P.PowerAppsUtility.getApiVersion(),d=Core.Environment.usePowerPlatformApi()?f.d.PowerPlatformService:f.d.PowerAppsService,P.PowerAppsUtility.authorizeHttpBuilder(o,u.Method.POST,n,d,l),v=o.generateSendHttpRequestParameters(),Object(y.addServiceErrorOptions)(v,{serviceType:m.e}),Object(c.appendCustomHeadersOptions)(v,{addCustomHeaders:!0}),A.label=1;case 1:return A.trys.push([1,3,,4]),[4,Object(g.sendHttpAsync)(this._httpClient,v,r.appGetAppExtendedMetadataCall)];case 2:return b=A.sent(),[2,e._parseGetAppExtendedMetadataResponse("PowerAppsApp.getAppExtendedMetadataAsync",b)];case 3:if(h=A.sent(),a.CoreLog.errorEx("PowerAppsApp.getAppExtendedMetadataAsync",h),Object(p.errorHasHttpResponse)(h))switch(h.response.status){case u.HttpStatusCode.BadRequest:case u.HttpStatusCode.Forbidden:case u.HttpStatusCode.Unauthorized:return[2,{status:i.AccessError,error:h}];case u.HttpStatusCode.NotFound:return[2,{status:i.NotFound,error:h}]}return[2,{status:i.Error,error:h}];case 4:return[2]}}))}))},e.prototype.listPackageUntilReadyAsync=function(){var e=this,t=Object(a.generateNonDashedUUID)();return Object(a.enterScope)(t),this.listPackageAsync().then((function(t){return t.status===o.InProgress?(a.Log.updateOpenAppData({needsPackaging:!0}),e._retryListPackageUntilReadyAsync(t.locationForPollingStatus)):t})).then((function(e){var n=Object(a.exitScopeAndGetRunTime)(t);return a.Log.updateOpenAppData({packagingTime:n}),t="",e}),(function(n){return null!==e._pollingHandle&&(e._pollingHandle.dispose(),e._pollingHandle=null),Object(a.exitScope)(t),a.CoreLog.error("PowerAppsApp.listPackageUntilReadyAsync",n),{status:o.Error,error:n}}))},e.prototype.listPackageAsync=function(){var t,n,i,s=AppMagic.PowerApps.PowerAppsUtility.tryGetPowerPlatformLaunchServiceUrl(this._appName);if(s){var d=new a.UrlBuilder(s);d.appendPath("listPackage"),t=d.toUrl(),n=P.PowerAppsUtility.getPowerPlatformApiVersion(),i=f.d.PowerPlatformService}else t=P.PowerAppsUtility.getPowerAppsListPackageEndpoint(this._appName),n=P.PowerAppsUtility.getApiVersion(),i=f.d.PowerAppsService;var g=new l.JsonHttpRequestBuilder,b={clientVersion:P.PowerAppsUtility.parseVersionString(a.Version.VERSION_NUMBER)};g.setJsonValue("",b);var h,A=P.PowerAppsUtility.tryGetDocumentServerEndpointHeader();A&&(g.addHeader(A.headerName,A.value),h={docServerEndPointHeaderName:A.headerName,docServerEndPointValue:A.value}),P.PowerAppsUtility.authorizeHttpBuilder(g,u.Method.POST,t,i,n);var C=g.generateSendHttpRequestParameters();return Object(y.addServiceErrorOptions)(C,{serviceType:m.e}),Object(c.appendCustomHeadersOptions)(C,{addCustomHeaders:!0}),Object(v.addTelemetryOptions)(C,{operationName:r.appListPackageCall}),A&&Object(v.addTelemetryAdditionalData)(C,h),this._httpClient.sendHttpAsync(C).then((function(t){return e._parseListPackageResponse("PowerAppsApp.listPackageAsync",t,!1)})).then(null,(function(e){if(a.CoreLog.error("PowerAppsApp.listPackageAsync",e),Object(p.errorHasHttpResponse)(e))switch(e.response.status){case u.HttpStatusCode.BadRequest:case u.HttpStatusCode.Forbidden:case u.HttpStatusCode.Unauthorized:return{status:o.AccessError,error:e};case u.HttpStatusCode.NotFound:return{status:o.NotFound,error:e}}return{status:o.Error,error:e}}))},e.prototype.deleteAppAsync=function(){var e=new s.BodilessHttpRequestBuilder;if(Core.Environment.usePowerPlatformApi()){var t=P.PowerAppsUtility.getPowerPlatformAppUrl(this._appName);P.PowerAppsUtility.authorizeHttpBuilder(e,u.Method.DELETE,t,f.d.PowerPlatformService,P.PowerAppsUtility.getPowerPlatformApiVersion())}else P.PowerAppsUtility.authorizeHttpBuilder(e,u.Method.DELETE,this._appEndpointUrl,f.d.PowerAppsService);var n=e.generateSendHttpRequestParameters();return Object(c.appendCustomHeadersOptions)(n,{addCustomHeaders:!0}),Object(g.sendHttpAsync)(this._httpClient,n,r.appDeleteCall).then((function(){return A.DeleteAppResultCode.Success}),(function(e){if(Object(a.throwIfCanceled)(e),Object(p.errorHasHttpResponse)(e))switch(e.response.status){case u.HttpStatusCode.NotFound:return A.DeleteAppResultCode.ObjectNotFound;case u.HttpStatusCode.Forbidden:case u.HttpStatusCode.Unauthorized:return A.DeleteAppResultCode.Unauthorized}return A.DeleteAppResultCode.UnknownError}))},e._handleUnsuccessfulGetApp=function(e){if(Object(a.throwIfCanceled)(e),Object(p.errorHasHttpResponse)(e))switch(a.CoreLog.error("PowerAppsApp.getAppAsync",e,"response.status: "+e.response.status),e.response.status){case u.HttpStatusCode.NotFound:return{resultCode:A.GetAppResultCode.NotFound,appInfo:null,error:e};case u.HttpStatusCode.Forbidden:return{resultCode:A.GetAppResultCode.Forbidden,appInfo:null,error:e};default:return{resultCode:A.GetAppResultCode.Failure,appInfo:null,error:e}}return a.CoreLog.error("PowerAppsApp.getAppAsync",e,"resultCode: GetAppResultCode.Failure"),{resultCode:A.GetAppResultCode.Failure,appInfo:null,error:e}},e._parseGetAppResponse=function(e){var t=P.PowerAppsUtility.parseAppInfoString(e);return{resultCode:null!==t?A.GetAppResultCode.Success:A.GetAppResultCode.Failure,appInfo:t}},e._parseGetAppExtendedMetadataResponse=function(e,t){if(t.status===u.HttpStatusCode.Accepted){var n=Core.Environment.usePowerPlatformApi()?u.HeaderName.OperationLocation:u.HeaderName.Location,r=Object(a.tryGetValueIgnoreCase)(t.headers,n);if(!Object(a.isNonEmptyString)(r))return a.CoreLog.errorEx(e,"GetAppExtendedMetadata call returned empty string or non string location header."),{status:i.Error};var o=new a.Core_Url(r);return o.isAbsolute?(a.CoreLog.verbose("GetAppExtendedMetadata call returned a location header for polling the package status"),{locationForPollingStatus:o,status:i.InProgress}):(a.CoreLog.errorEx(e,"GetAppExtendedMetadata call returned non absolute uri location header."),{status:i.Error})}if(t.status===u.HttpStatusCode.Ok){var s=void 0;try{s=JSON.parse(t.responseText)}catch(t){return a.CoreLog.errorEx(e,"Server returned invalid json response for GetAppExtendedMetadata call."),{status:i.Error}}var c=b.o.safeCast(s);return null===c?(a.CoreLog.errorEx(e,"Server returned invalid response for GetAppExtendedMetadata call. safeCast failed."),{status:i.Error}):(a.CoreLog.verbose("GetAppExtendedMetadata call returned metadata."),{result:c,status:i.Ready})}return a.CoreLog.errorEx(e,"GetAppExtendedMetadata call returned unexpected status code: "+t.status),{status:i.Error}},e.prototype._getAppExtendedMetadataStatusFromLocationAsync=function(t){return __awaiter(this,void 0,Promise,(function(){var n,o,p,l,d,y;return __generator(this,(function(m){switch(m.label){case 0:n=new s.BodilessHttpRequestBuilder,o=Core.Environment.usePowerPlatformApi()?P.PowerAppsUtility.getPowerPlatformApiVersion():P.PowerAppsUtility.getApiVersion(),p=Core.Environment.usePowerPlatformApi()?f.d.PowerPlatformService:f.d.PowerAppsService,P.PowerAppsUtility.authorizeHttpBuilder(n,u.Method.GET,t,p,o),m.label=1;case 1:return m.trys.push([1,3,,4]),l=n.generateSendHttpRequestParameters(),Object(c.appendCustomHeadersOptions)(l,{addCustomHeaders:!0}),[4,Object(g.sendHttpAsync)(this._httpClient,l,r.appGetAppExtendedMetadataCall)];case 2:return d=m.sent(),[2,e._parseGetAppExtendedMetadataResponse("PowerAppsApp._parseGetAppExtendedMetadataResponse",d)];case 3:return y=m.sent(),a.CoreLog.errorEx("PowerAppsApp._parseGetAppExtendedMetadataResponse",y),[2,{status:i.Error,error:y}];case 4:return[2]}}))}))},e._parseListPackageResponse=function(e,t,n,r){var i,s;if(t.status===u.HttpStatusCode.Accepted){var c=Core.Environment.usePowerPlatformApi()?u.HeaderName.OperationLocation:u.HeaderName.Location,p=Object(a.tryGetValueIgnoreCase)(t.headers,c);if(!Object(a.isNonEmptyString)(p))return a.CoreLog.error(e,"ListPackage call returned empty string or non string location header."),{status:o.Error};var l=new a.Core_Url(p);return l.isAbsolute?(a.CoreLog.verbose("ListPackage call returned a location header for polling the package status"),{locationForPollingStatus:l,status:o.InProgress}):(a.CoreLog.error(e,"ListPackage call returned non absolute uri location header."),{status:o.Error})}if(t.status===u.HttpStatusCode.Ok){var d=void 0;try{d=JSON.parse(t.responseText)}catch(t){return a.CoreLog.error(e,"Server returned invalid json response for listPackage call."),{status:o.Error}}var f=void 0;if(Core.Environment.usePowerPlatformApi()&&n){if(d.status){if("Running"===d.status||"NotStarted"===d.status)return a.CoreLog.verbose("".concat(e,": The app is still being packaged. Will poll again.")),r?{locationForPollingStatus:r,status:o.InProgress}:(a.CoreLog.errorEx(e,"List package polling failed. Polling URL is not provided."),{status:o.Error});if("Failed"===d.status||"Canceled"===d.status){var y=d.status,m=null===(i=d.error)||void 0===i?void 0:i.code,g=null===(s=d.error)||void 0===s?void 0:s.message;return a.CoreLog.errorEx(e,"List package polling failed. Status: ".concat(y,". Error Code: ").concat(m," Error Message: ").concat(g)),{status:o.Error}}}f=b.Uf.safeCast(d.result)}else f=b.Uf.safeCast(d);return null===f?(a.CoreLog.error(e,"Server returned invalid response for listPackage call. safeCast failed."),{status:o.Error}):Object(a.isDefined)(f.value)||Object(a.isDefined)(f.readonlyValue)||Object(a.isUndefined)(f.webPackageUri)||Object(a.isUndefined)(f.playerPackageUri)?(a.CoreLog.error(e,"Server response contained unexpected properties values."),{status:o.Error}):(a.CoreLog.verbose("ListPackage call returned package uri."),{result:f,status:o.Ready})}return a.CoreLog.error(e,"ListPackage call returned unexpected status code: "+t.status),{status:o.Error}},e.prototype._listPackageStatusFromLocationAsync=function(t){var n=new s.BodilessHttpRequestBuilder,i=Core.Environment.usePowerPlatformApi()?P.PowerAppsUtility.getPowerPlatformApiVersion():P.PowerAppsUtility.getApiVersion(),p=Core.Environment.usePowerPlatformApi()?f.d.PowerPlatformService:f.d.PowerAppsService;P.PowerAppsUtility.authorizeHttpBuilder(n,u.Method.GET,t,p,i);var l=n.generateSendHttpRequestParameters();return Object(c.appendCustomHeadersOptions)(l,{addCustomHeaders:!0}),Object(g.sendHttpAsync)(this._httpClient,l,r.appListPackageCall).then((function(n){return e._parseListPackageResponse("PowerAppsApp._listPackageStatusFromLocationAsync",n,!0,t)})).then(null,(function(e){return a.CoreLog.error("PowerAppsApp._listPackageStatusFromLocationAsync",e),{status:o.Error,error:e}}))},e.prototype._retryListPackageUntilReadyAsync=function(t){var n=this;return this._pollingHandle=Object(a.startPollingOperation)("PowerAppsApp._retryListPackageUntilReadyAsync",t,(function(e){return n._listPackageStatusFromLocationAsync(e)}),(function(e){switch(e.status){case o.Ready:return Object(a.createTailEnd)();case o.InProgress:return Object(a.createNext)(e.locationForPollingStatus);default:if(e.error)throw e.error;throw new Error("There was an error while polling the package uri.")}}),e.defaultRetryListPackageTimeoutMilliseconds),Object(a.wrapWithFinally)(this._pollingHandle.waitAsync(),(function(){null!==n._pollingHandle&&(n._pollingHandle.dispose(),n._pollingHandle=null)})).then(null,(function(e){return a.CoreLog.error("PowerAppsApp._retryListPackageUntilReadyAsync",e),{status:o.Error,error:e}}))},e.defaultRetryListPackageTimeoutMilliseconds=3e3,e.defaultRetryGetAppExtendedMetadataTimeoutMilliseconds=2e3,e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"DateTimeFormat",(function(){return r})),n.d(t,"DateTimeFormats",(function(){return a})),n.d(t,"DateTimeBehavior",(function(){return i})),n.d(t,"DateTimeBehaviors",(function(){return c})),n.d(t,"SupportedBinaryDTypes",(function(){return u})),n.d(t,"CdsConstants",(function(){return s}));var r,o=n(5);!function(e){e.Iso8601ExtendedUtc="Iso8601ExtendedUtc",e.Iso8601Datetime="Iso8601Datetime"}(r||(r={}));var i,a=[r.Iso8601ExtendedUtc,r.Iso8601Datetime];!function(e){e.UserLocal="UserLocal",e.NoTimeZone="NoTimeZone"}(i||(i={}));var s,c=[i.UserLocal,i.NoTimeZone],u=[o.TypeImage,o.TypeMedia,o.TypeBlob];!function(e){e.labelAnnotation="@OData.Community.Display.V1.FormattedValue"}(s||(s={}))},function(e,t,n){"use strict";var r;n.r(t),n.d(t,"ComponentType",(function(){return r})),function(e){e.NotSpecified="NotSpecified",e.Canvas="Canvas",e.Function="Function",e.Data="Data",e.Command="Command"}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"SafeCastError",(function(){return o}));var r=n(0),o=function(e){function t(t){return e.call(this,"Server sent an invalid response for api call: ".concat(t),"Services.SafeCastError")||this}return __extends(t,e),t}(r.ErrorBase)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return L}));var r,o,i,a,s,c=n(0),u=n(67),p=n(41),l=n(6),d=n(17),f=n(46),y=n(3),m=n(44),g=n(21),v=n(28),b=n(182),h=n(81),A=n(8),C=n(39),P=n(18),w=n(11),S=n(14),O=n(1),R=n(43),_=n(124),T=n(2),I=n(119),E=n(24),U=n(36),j=n(4),N=n(38),D=n(42),V=n(30),M=n(16);function k(e,t){void 0===t&&(t=!1);var n=t?j.PowerAppsUtility.getPowerAppsResourceName():A.d.PowerAppsService;Object(A.e)(e.headers,{resource:n}),Object(d.appendCustomHeadersOptions)(e,{optInMSHeaders:!0,addCustomHeaders:!0})}!function(e){e.getAppsAvailableToUserCall="PowerAppsService.GetAppsAvailableToUser",e.getAppTemplateCategoriesCall="PowerAppsService.GetAppTemplateCategories",e.getAppComponentsForAppComponentLibraryCall="PowerAppsService.GetAppComponentsForAppComponentLibrary",e.getAppTemplatesCall="PowerAppsService.GetAppTemplates",e.getAppTemplateByNameCall="PowerAppsService.GetAppTemplateByName",e.getStorageCall="PowerAppsService.GetStorage",e.getOptInCountriesListCall="PowerAppsService.getOptInCountriesList",e.sendOptInUserConsentCall="PowerAppsService.sendOptInUserConsent",e.getCustomBrandingAssetsCall="PowerAppsService.getCustomBrandingAssets",e.getRPMessageCall="PowerAppsService.tryGetRPMessagesAsync",e.checkComponentUpdatesCall="PowerAppsService.checkComponentUpdates",e.getComponentDependencies="PowerAppsService.getComponentDependencies",e.makeExistingCanvasAppSolutionAwareAsync="PowerAppsService.makeExistingCanvasAppSolutionAwareAsync",e.getTenantData="PowerAppsService.getTenantData",e.getMakerPrivileges="PowerAppsService.GetMakerPrivilegesAsync",e.getAppDetailsById="PowerAppsService.getAppDetailsById"}(r||(r={})),function(e){e[e.None=0]="None",e[e.NativePackageOnly=1]="NativePackageOnly",e[e.WebPackageOnly=2]="WebPackageOnly",e[e.BothPackages=3]="BothPackages"}(o||(o={})),function(e){e[e.MyApps=0]="MyApps",e[e.OrgGalleryApps=1]="OrgGalleryApps"}(i||(i={})),function(e){e.countryDefaultOptInUrl="countryDefaultOptIn",e.userEmailConsentUrl="userEmailConsent"}(a||(a={})),function(e){e.tenantResource="tenant"}(s||(s={}));var L=function(e){function t(t,n,r,o){var i=this;return(i=e.call(this)||this)._identityService=t,i._httpClient=n,i._userService=o,i._connectionUsageManager=r,i._appInfoConnectionRefsUpdatedEvent=new c.EventObject,i}return __extends(t,e),t.prototype.dispose=function(){this._connectionUsageManager.dispose(),this._connectionUsageManager=null},Object.defineProperty(t.prototype,"connectionUsageManager",{get:function(){return this._connectionUsageManager},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"httpClient",{get:function(){return this._httpClient},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"identityService",{get:function(){return this._identityService},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"appInfoConnectionRefsUpdatedEvent",{get:function(){return this._appInfoConnectionRefsUpdatedEvent},enumerable:!1,configurable:!0}),t.getGenerateDebugPlayerPackageLocally=function(){return t._generateDebugPlayerPackageLocally!==o.None},t.getGenerateDebugPlayerPackageLocallyForNativeClients=function(){return t._generateDebugPlayerPackageLocally===o.NativePackageOnly||t._generateDebugPlayerPackageLocally===o.BothPackages},t.getGenerateDebugPlayerPackageLocallyForWeb=function(){return t._generateDebugPlayerPackageLocally===o.WebPackageOnly||t._generateDebugPlayerPackageLocally===o.BothPackages},t.setGenerateDebugPlayerPackageLocally=function(e){t._generateDebugPlayerPackageLocally=e},t.getGenerateDebugPlayerPackageLocallySetting=function(){return t._generateDebugPlayerPackageLocally},t.prototype.tryGetRPMessagesAsync=function(e,t){var n;return __awaiter(this,void 0,Promise,(function(){var o,i,a,s,u,p,d;return __generator(this,(function(f){switch(f.label){case 0:return f.trys.push([0,2,,3]),o=l.t.IsPowerPlatformApiEnabled?j.PowerAppsUtility.getPowerPlatformApiVersion():T.PowerAppEndpoints.getApiVersion(),i=void 0,o&&e&&t?(l.t.IsPowerPlatformApiEnabled?(i=AppMagic.PowerApps.PowerAppsUtility.createPowerPlatformAppUrlBuilder(e,t)).appendPath("playNotifications"):((i=new c.UrlBuilder(j.PowerAppsUtility.getBaseUrl())).appendPath(T.PowerAppEndpoints.environmentsValue),i.appendPath(t),i.appendPath(T.PowerAppEndpoints.appsValue),i.appendPath(e),i.appendPath("appPlayNotifications")),i.setQueryParam(T.PowerAppEndpoints.apiVersionKey,o),a={url:i.toString(),method:y.Method.GET,headers:Object(c.HashTableUtility_create)((d={"Content-Type":"application/json"},d[y.HeaderName.CacheControl]=y.HeaderValue.NoCacheNoStore,d))},AppMagic.Runtime.Client.addAuthorizationOptions(a.headers,{resource:l.t.getResourceName()}),Object(D.addServiceErrorOptions)(a,{serviceType:l.t.getServiceType()}),Object(V.addTelemetryOptions)(a,{operationName:r.getRPMessageCall}),[4,this.httpClient.sendHttpAsync(a)]):[2,[]];case 1:return(s=f.sent()).response&&(u=JSON.parse(s.response),(null===(n=u.notifications)||void 0===n?void 0:n.length)>0)?[2,u.notifications]:[3,3];case 2:return p=f.sent(),c.CoreLog.errorEx("PlayerPublishedClient.getRPMessage","call appPlayNotifications fails with error: "+p+". This call is a best effort call and this error is harmless."),[3,3];case 3:return[2,[]]}}))}))},t.prototype.getComponentsAvailableToUserAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n,o,i,a,s,u,p;return __generator(this,(function(l){switch(l.label){case 0:return l.trys.push([0,4,,5]),c.CoreLog.verbose("PowerAppsService: getComponentsAvailableToUserAsync"),Core.Environment.isAuthoringTool()?[4,this._userService.waitForInitialUserInstanceLoadedAsync()]:[2,[]];case 1:return l.sent(),[4,this._userService.getEnvironmentService().getCurrentEnvironmentAsync()];case 2:return t=l.sent(),n=e?new c.UrlBuilder(j.PowerAppsUtility.getEnvironmentAppComponentsEndpoint(t.name,e)):new c.UrlBuilder(j.PowerAppsUtility.getEnvironmentComponentsEndpoint(t.name)),o={apiVersion:j.PowerAppsUtility.getPowerAppsApiVersion()},[4,new v.ODataListItemsTool(n.toString(),j.PowerAppsUtility.getPowerAppsResourceName(),this._httpClient,r.getAppComponentsForAppComponentLibraryCall,T.PowerAppsNextLink).getItemsAsync(o)];case 3:if(null===(i=l.sent()).items)throw a="PowerAppsService: getComponentsAvailableToUserAsync: Error getting components.",a+=i.errorMessage?" ".concat(i.errorMessage):"",new c.ApplicationError(a);return s=i.items,u=[],s.forEach((function(e){var t=Object(_.parseComponentInfo)(e);null!==t&&t.componentType!=N.ComponentType.Command&&u.push(t)})),[2,u];case 4:return p=l.sent(),Object(c.isCanceledError)(p)||c.CoreLog.error("PowerAppsService.getComponentsAvailableToUserAsync",p),[2,null];case 5:return[2]}}))}))},t.prototype.getAppComponentDependenciesAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var n,o,i,a,s,u;return __generator(this,(function(p){switch(p.label){case 0:if(!Object(c.isNonEmptyString)(e)||!Object(c.isNonEmptyString)(t))return[2,[]];n=Core.Environment.usePowerPlatformApi()?j.PowerAppsUtility.createPowerPlatformPowerAppsUrlBuilder(t):j.PowerAppsUtility.createPowerAppsBaseUrlBuilder(),Core.Environment.usePowerPlatformApi()||(n.appendPath(T.PowerAppEndpoints.providers),n.appendPath(T.PowerAppEndpoints.environmentsValue),n.appendPath(t)),n.appendPath(T.PowerAppEndpoints.appsValue),n.appendPath(e),n.appendPath(T.PowerAppEndpoints.UrlPaths.componentDependencies),o=Core.Environment.usePowerPlatformApi()?j.PowerAppsUtility.getPowerPlatformApiVersion():T.PowerAppEndpoints.getApiVersion(),n.setQueryParam(T.PowerAppEndpoints.apiVersionKey,o),i={url:n.toString(),method:y.Method.GET,headers:Object(c.HashTableUtility_create)((u={"Content-Type":"application/json"},u[y.HeaderName.CacheControl]=y.HeaderValue.NoCacheNoStore,u))},Core.Environment.usePowerPlatformApi()?(AppMagic.Runtime.Client.addAuthorizationOptions(i.headers,{resource:A.d.PowerPlatformService}),Object(D.addServiceErrorOptions)(i,{serviceType:P.d})):(AppMagic.Runtime.Client.addAuthorizationOptions(i.headers,{resource:A.d.PowerAppsService}),Object(D.addServiceErrorOptions)(i,{serviceType:P.e})),p.label=1;case 1:return p.trys.push([1,3,,4]),[4,Object(S.sendHttpJsonResponseAsync)(this._httpClient,i,r.getComponentDependencies)];case 2:return(a=p.sent())&&Object(c.isArray)(a)?[2,a.map((function(e){return Object(_.parseComponentInfo)(e)}))]:(c.CoreLog.errorEx("PowerAppsService.getAppComponentDependenciesAsync","Invalid return value."),[2,[]]);case 3:return s=p.sent(),Object(c.isCanceledError)(s)||c.CoreLog.errorEx("PowerAppsService.getAppComponentDependenciesAsync",s),[2,[]];case 4:return[2]}}))}))},t.prototype.getAppsAvailableToUserAsync=function(e,t,n,r){return void 0===e&&(e=i.OrgGalleryApps),void 0===t&&(t=!0),void 0===n&&(n=!1),void 0===r&&(r=null),__awaiter(this,void 0,Promise,(function(){return __generator(this,(function(o){return[2,this._getAppsAndComponentLibrariesAsync(!1,e,t,n,r)]}))}))},t.prototype.getAppsAndComponentLibrariesAvailableToUserAsync=function(e,t,n,r){return void 0===e&&(e=i.OrgGalleryApps),void 0===t&&(t=!0),void 0===n&&(n=!1),void 0===r&&(r=null),__awaiter(this,void 0,Promise,(function(){return __generator(this,(function(o){return[2,this._getAppsAndComponentLibrariesAsync(!0,e,t,n,r)]}))}))},t.prototype.updateDisplayNameAsync=function(e,t){return c.CoreLog.verbose("PowerAppsService: _updateDisplayNameAsync({0}, newName: {1})",e,t),new U.PowerAppsApp(e,this._httpClient).putUpdateDisplayNameAsync(t)},t.prototype.getAppVersionHistory=function(e){return c.CoreLog.verbose("PowerAppsService: getAppVersionHistory({0})",e),new U.PowerAppsApp(e,this._httpClient).getVersionHistoryAsync()},t.prototype.getMakerPrivilegesAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var n,o,i,a,s,u;return __generator(this,(function(p){switch(p.label){case 0:n=j.PowerAppsUtility.getPrivilegesEndpoint(e),o=new m.JsonHttpRequestBuilder,j.PowerAppsUtility.authorizeHttpBuilder(o,y.Method.POST,n,j.PowerAppsUtility.getPowerAppsResourceName()),i={UserPrivileges:[{PrivilegeName:"".concat(t)}]},o.setJsonValue("",i),a=o.generateSendHttpRequestParameters(),Object(d.appendCustomHeadersOptions)(a,{addCustomHeaders:!0}),p.label=1;case 1:return p.trys.push([1,3,,4]),[4,Object(S.sendHttpAsync)(this._httpClient,a,r.getMakerPrivileges)];case 2:return s=p.sent(),[2,O.I.safeCast(JSON.parse(s.response))];case 3:throw u=p.sent(),c.CoreLog.errorEx("PowerAppsApp.getMakerPrivilegesAsync",u),u;case 4:return[2]}}))}))},t.prototype._getAppsAndComponentLibrariesAsync=function(e,t,n,o,a){return void 0===t&&(t=i.OrgGalleryApps),void 0===n&&(n=!0),void 0===o&&(o=!1),void 0===a&&(a=null),__awaiter(this,void 0,Promise,(function(){var s,u,p,l,d,f,y,m,g,v,b;return __generator(this,(function(h){switch(h.label){case 0:h.label=1;case 1:return h.trys.push([1,6,,7]),c.CoreLog.verbose("PowerAppsService: _getAppsAndComponentLibrariesAsync"),a||!Core.Environment.isAuthoringTool()?[3,4]:[4,this._userService.waitForInitialUserInstanceLoadedAsync()];case 2:return h.sent(),[4,this._userService.getEnvironmentService().getCurrentEnvironmentAsync()];case 3:s=h.sent(),a=s.name,h.label=4;case 4:return u=Core.Environment.usePowerPlatformApi()?j.PowerAppsUtility.getAppsAndComponentLibrariesEnvironmentEndpoint():j.PowerAppsUtility.getAppsAndComponentLibrariesEndpoint(),p=Object(c.CoreUtility_formatString)("classification eq '{0}'",i[t]),l=e?this._getAppInfosAsync(u,n,r.getAppsAvailableToUserCall,"isAppComponentLibrary eq 'true'",a,o):Promise.resolve([]),d=this._getAppInfosAsync(u,n,r.getAppsAvailableToUserCall,p,a,o),f=this._getAppInfosAsync(u,n,r.getAppsAvailableToUserCall,"AppType eq 'CustomCanvasPage'",a,o),[4,Object(c.PromiseUtility_join)([l,d,f])];case 5:return y=h.sent(),m=y[0],g=y[1],v=y[2],c.CoreLog.verbose("PowerAppsService: _getAppsAndComponentLibrariesAsync: returned "+m.length+" componentLibraries, "+g.length+" apps, and "+v.length+" custom pages."),c.Log.trackEvent(c.powerAppsServiceGetAppsAvailableToUserResultSuccess,{appInfos:g.length,requestedComponentLibraries:e,componentLibraries:m.length,customPages:v.length}),[2,m.concat(g,v)];case 6:return b=h.sent(),Object(c.isCanceledError)(b)||c.CoreLog.error("PowerAppsService._getAppsAndComponentLibrariesAsync",b),[2,null];case 7:return[2]}}))}))},t.prototype._getAppInfosAsync=function(e,t,n,r,o,i){void 0===o&&(o=null),void 0===i&&(i=!1),c.CoreLog.verbose("PowerAppsService: _getAppInfosAsync: endPoint : "+e);var a=new c.UrlBuilder(e);i&&a.setQueryParam(T.PowerAppEndpoints.pollQueryParam,"true");var s,u=new v.ODataListItemsTool(a.toString(),j.PowerAppsUtility.getPowerAppsResourceName(),this._httpClient,n,T.PowerAppsNextLink),p={apiVersion:j.PowerAppsUtility.getPowerAppsApiVersion()};Object(c.isDefined)(r)&&(p.filter=r),o&&Object(f.addEnvironmentFilterToOptions)(o,p),t&&(p.expand=T.GetAppExpandParameters.EnvironmentDisplayName);var l=j.PowerAppsUtility.tryGetDocumentServerEndpointHeader();return l&&((s=Object(c.HashTableUtility_create)())[l.headerName]=l.value),u.getItemsAsync(p,void 0,s).then((function(e){if(null===e.items){var t="PowerAppsService: _getAppInfosAsync: Error getting paged app data.";throw t+=e.errorMessage?" ".concat(e.errorMessage):"",new c.ApplicationError(t)}var n=e.items,r=[];return n.forEach((function(e){var t=R.AppInfoParser.parseAppInfo(e);null!==t&&r.push(t)})),r}))},t.prototype.getBlobStorageAsync=function(){var e,t,n=this;return c.CoreLog.verbose("PowerAppsService: getBlobStorageAsync"),this._userService.getEnvironmentService().getCurrentEnvironmentAsync().then((function(o){e=new m.JsonHttpRequestBuilder;var i={environment:{id:o.id,name:o.name}};e.setJsonValue("",i),t=n._identityService.identity.objectId;var a=j.PowerAppsUtility.getPowerAppsTransientStorageUrl(t);j.PowerAppsUtility.authorizeHttpBuilder(e,y.Method.POST,a,j.PowerAppsUtility.getPowerAppsResourceName(),j.PowerAppsUtility.getPowerAppsApiVersion());var s=e.generateSendHttpRequestParameters();return Object(d.appendCustomHeadersOptions)(s,{addCustomHeaders:!0}),Object(S.sendHttpAsync)(n._httpClient,s,r.getStorageCall)})).catch((function(e){return Object(c.isCanceledError)(e)||c.CoreLog.error("PowerAppsService.getBlobStorageAsync",e),null}))},t.prototype.deleteAppFromServiceAsync=function(e){c.CoreLog.verbose("PowerAppsService: deleteAppFromServiceAsync({0})",e);var t=j.PowerAppsUtility.parseAppNameFromAppId(e);return new U.PowerAppsApp(t,this._httpClient).deleteAppAsync().then(null,(function(e){return Object(c.throwIfCanceled)(e),c.CoreLog.error("PowerAppsService.deleteAppFromServiceAsync",e),null}))},t.prototype.setAppAsFavoriteAsync=function(e){c.CoreLog.verbose("PowerAppsService: setAppAsFavoriteAsync({0})",e);var t=j.PowerAppsUtility.parseAppNameFromAppId(e);return new U.PowerAppsApp(t,this._httpClient).postSetFavoriteAsync().then(null,(function(e){return Object(c.throwIfCanceled)(e),c.CoreLog.error("PowerAppsService.setAppAsFavoriteAsync",e),Promise.reject(e)}))},t.prototype.unsetAppAsFavoriteAsync=function(e){c.CoreLog.verbose("PowerAppsService: unsetAppAsFavoriteAsync({0})",e);var t=j.PowerAppsUtility.parseAppNameFromAppId(e);return new U.PowerAppsApp(t,this._httpClient).postUnsetFavoriteAsync().then(null,(function(e){return Object(c.throwIfCanceled)(e),c.CoreLog.error("PowerAppsService.unsetAppAsFavoriteAsync",e),Promise.reject(e)}))},t.prototype.updateModelAppFavoriteAsync=function(e,t,n){c.CoreLog.verbose("PowerAppsService: updateModelAppAsFavoriteAsync({0})",e);var r=j.PowerAppsUtility.parseAppNameFromAppId(e);return new U.PowerAppsApp(r,this._httpClient,n).postModelAppSetFavoriteAsync(t).then(null,(function(e){return Object(c.throwIfCanceled)(e),c.CoreLog.error("PowerAppsService.updateModelAppAsFavoriteAsync",e),Promise.reject(e)}))},t.prototype.publishAppAsync=function(e){c.CoreLog.verbose("PowerAppsService: publishAppAsync ({0})",e);var t=j.PowerAppsUtility.parseAppNameFromAppId(e);return new U.PowerAppsApp(t,this._httpClient).publishAppAsync().catch((function(e){throw Object(c.throwIfCanceled)(e),c.CoreLog.error("PowerAppsService.publishAppAsync",e),e}))},t.prototype.packageAppAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var n,r,o;return __generator(this,(function(i){switch(i.label){case 0:c.CoreLog.verbose("PowerAppsService: packageAppAsync ({0})",e),n=j.PowerAppsUtility.parseAppNameFromAppId(e),r=new U.PowerAppsApp(n,this._httpClient),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,r.packageAppAsync(t)];case 2:return i.sent(),[3,4];case 3:throw o=i.sent(),Object(c.throwIfCanceled)(o),c.CoreLog.error("PowerAppsService.packageAppAsync",o),o;case 4:return[2]}}))}))},t.prototype.getAppFromAppIdAsync=function(e,t){var n=j.PowerAppsUtility.parseAppNameFromAppId(e);return this.getAppFromAppNameAsync(n,t)},t.prototype.getAppFromAppNameAsync=function(e,t,n,r){var o,i;return __awaiter(this,void 0,Promise,(function(){var a,s,u,p,l;return __generator(this,(function(d){switch(d.label){case 0:c.CoreLog.verbose("PowerAppsService: getAppFromAppNameAsync({0}, {1})",e,JSON.stringify(t)),d.label=1;case 1:return d.trys.push([1,4,,5]),[4,this._userService.waitForInitialUserInstanceLoadedAsync()];case 2:return d.sent(),a=new U.PowerAppsApp(e,this._httpClient,n&&r?new h.UnifiedAppIdentifier(n,r):void 0),s=void 0,s=t.includePackageUrl?a.getAppAndPackageAsync(t.expandParams||[]):a.getAppAsync(t.expandParams||[]),u=j.PowerAppsUtility.getPowerAppsAppId(e),this._startGetConnectionUsages(u),[4,s];case 3:return(null==(p=d.sent())?void 0:p.appInfo)?n&&(null===(i=null===(o=p.appInfo.environment)||void 0===o?void 0:o.name)||void 0===i?void 0:i.toUpperCase())!==n.toUpperCase()?(c.CoreLog.warningEx("PowerAppsService.getAppFromAppNameAsync","Found ".concat(e," in environment ").concat(p.appInfo.environment.name,", but call was restricted to environment ").concat(n)),[2,{appInfo:null,resultCode:E.GetAppResultCode.NotFound}]):(p.resultCode!==E.GetAppResultCode.Success?c.CoreLog.warningEx("PowerAppsService.getAppFromAppNameAsync","resultCode: {result.resultCode}"):c.CoreLog.verbose("PowerAppsService: getAppFromAppNameAsync({0}, {1}) succeeded",e,JSON.stringify(t)),[2,p]):(c.CoreLog.warningEx("PowerAppsService.getAppFromAppNameAsync","App ".concat(e," not found.")),[2,{appInfo:null,resultCode:E.GetAppResultCode.NotFound}]);case 4:return l=d.sent(),Object(c.throwIfCanceled)(l),c.CoreLog.error("PowerAppsService.getAppFromAppNameAsync",l),[2,{appInfo:null,resultCode:E.GetAppResultCode.Failure,error:l}];case 5:return[2]}}))}))},t.prototype._startGetConnectionUsages=function(e){this.trackAnonymous(this._userService.getConnectionServiceAsync().then((function(t){return t.getCurrentUserConnectionsForAppAsync(e)})).catch((function(t){Object(c.throwIfCanceled)(t),c.CoreLog.error("PowerAppsService._startGetConnectionUsages",t,"Failed to front-load usages for app: ".concat(e))})))},t.prototype.patchAppConnectionReferencesAsync=function(e,t,n){var r=this;return c.CoreLog.verbose("PowerAppsService: patchAppConnectionReferences({0}",e),new U.PowerAppsApp(e,this._httpClient).patchAppWithConnectionReferencesAsync(t,n).then((function(){return r.appInfoConnectionRefsUpdatedEvent.dispatch(e)})).catch((function(t){Object(c.throwIfCanceled)(t),c.CoreLog.error("PowerAppsService.patchAppConnectionReferences",t,"Failed to patch app info connection references for app ".concat(e))}))},t.prototype.tryGetEnvironmentForAppAsync=function(e,t){var n,r;return void 0===t&&(t=!1),__awaiter(this,void 0,Promise,(function(){var o;return __generator(this,(function(i){switch(i.label){case 0:return[4,this._tryGetAppAsync(e,t)];case 1:return(o=i.sent()).resultCode===E.GetAppResultCode.Success&&(null===(r=null===(n=o.appInfo)||void 0===n?void 0:n.environment)||void 0===r?void 0:r.id)?[2,this._userService.getEnvironmentService().tryGetEnvironmentByIdAsync(o.appInfo.environment.id)]:(c.CoreLog.error("PowerAppsService.tryGetEnvironmentForAppAsync.notFound","appId: "+e),[2,null])}}))}))},t.prototype.tryGetEnvironmentNameForAppAsync=function(e,t){var n,r;return void 0===t&&(t=!1),__awaiter(this,void 0,Promise,(function(){var o;return __generator(this,(function(i){switch(i.label){case 0:return[4,this._tryGetAppAsync(e,t)];case 1:return(o=i.sent()).resultCode===E.GetAppResultCode.Success&&(null===(r=null===(n=o.appInfo)||void 0===n?void 0:n.environment)||void 0===r?void 0:r.name)?[2,o.appInfo.environment.name]:(c.CoreLog.error("PowerAppsService.tryGetEnvironmentNameForAppAsync.notFound","appId: "+e),[2,null])}}))}))},t.prototype._tryGetAppAsync=function(e,t){return void 0===t&&(t=!1),__awaiter(this,void 0,Promise,(function(){var n;return __generator(this,(function(r){switch(r.label){case 0:return c.CoreLog.verbose("PowerAppsService_tryGetAppAsync({0}, {1})",e,t),c.Log.trackActivityEvent("PowerAppsService._tryGetAppAsync",{appIdOrName:e,isName:t}),n=AppMagic.PowerApps.PowerAppsUtility.getPublishedAppOptionsMinimal(),[4,t?this.getAppFromAppNameAsync(e,n):this.getAppFromAppIdAsync(e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype.listPackageAsync=function(e){return new U.PowerAppsApp(e,this._httpClient).listPackageUntilReadyAsync()},t.prototype.getAppExtendedMetadataAsync=function(e,t){return new U.PowerAppsApp(e,this._httpClient).getAppExtendedMetadataUntilReadyAsync(t)},t.prototype.getAppTemplateCategoriesAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e,t,n,o,i;return __generator(this,(function(a){switch(a.label){case 0:c.CoreLog.verbose("PowerAppsService: getAppTemplateCategoriesAsync"),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,this._userService.waitForInitialUserInstanceLoadedAsync()];case 2:return a.sent(),e=j.PowerAppsUtility.getPowerAppsListCategoriesEndpoint(this._identityService.identity.objectId,this._identityService.identity.tenantId),(t=new c.UrlBuilder(e.getBaseUrl())).setQueryParam(T.PowerAppEndpoints.apiVersionKey,j.PowerAppsUtility.getPowerAppsApiVersion()),k(n={url:t.toString(),method:y.Method.POST,headers:Object(c.HashTableUtility_create)()},!0),[4,Object(S.sendHttpJsonResponseAsync)(this._httpClient,n,r.getAppTemplateCategoriesCall)];case 3:return o=a.sent(),[2,Object(w.createSuccessfulAsyncResult)(o)];case 4:return i=a.sent(),Object(c.isCanceledError)(i)||c.CoreLog.error("PowerAppsService.getAppTemplateCategoriesAsync",i),[2,Object(w.createUnsuccessfulAsyncResult)(Object(c.formatError)(i))];case 5:return[2]}}))}))},t.prototype.getAppTemplatesAsync=function(e){return void 0===e&&(e=!1),__awaiter(this,void 0,Promise,(function(){var n,o,i,a,s,u;return __generator(this,(function(p){switch(p.label){case 0:c.CoreLog.verbose("PowerAppsService: getAppTemplatesAsync"),n=j.PowerAppsUtility.getPublicItemsEndpoint(),(o=new c.UrlBuilder(n.getBaseUrl())).setQueryParam(T.PowerAppEndpoints.apiVersionKey,j.PowerAppsUtility.getApiVersion()),i=t._getInternalTemplatesQueryParamValue_Filter,e||(i+=" and "+t._getPublicTemplatesQueryParamValue_Filter),o.setQueryParam(t._getPublicItemsParamName_Filter,i),k(a={url:o.toString(),method:y.Method.GET,headers:Object(c.HashTableUtility_create)()}),p.label=1;case 1:return p.trys.push([1,4,,5]),[4,this._userService.waitForInitialUserInstanceLoadedAsync()];case 2:return p.sent(),[4,Object(S.sendHttpJsonResponseAsync)(this._httpClient,a,r.getAppTemplatesCall)];case 3:return s=p.sent(),[2,Object(w.createSuccessfulAsyncResult)(s)];case 4:return u=p.sent(),Object(c.isCanceledError)(u)||c.CoreLog.error("PowerAppsService.getAppTemplatesAsync",u),[2,Object(w.createUnsuccessfulAsyncResult)(Object(c.formatError)(u))];case 5:return[2]}}))}))},t.prototype.getAppTemplateByNameAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n,o,i;return __generator(this,(function(a){switch(a.label){case 0:t=j.PowerAppsUtility.getPublicItemsEndpoint(),(n=new c.UrlBuilder(t.getBaseUrl())).appendPath(e),n.setQueryParam(T.PowerAppEndpoints.apiVersionKey,j.PowerAppsUtility.getApiVersion()),k(o={url:n.toString(),method:y.Method.GET,headers:Object(c.HashTableUtility_create)()}),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this._userService.waitForInitialUserInstanceLoadedAsync()];case 2:return a.sent(),[2,Object(S.sendHttpJsonResponseAsync)(this._httpClient,o,r.getAppTemplateByNameCall)];case 3:return i=a.sent(),Object(c.throwIfCanceled)(i),c.CoreLog.error("PowerAppsService.getAppTemplateFromNameAsync",i),[2,Object(w.createUnsuccessfulAsyncResult)(Object(c.formatError)(i))];case 4:return[2]}}))}))},t.prototype.getOptInListOfCountriesAsync=function(){var e=u.BapUtility.createBapProviderUrlBuilder();e.appendPath(a.countryDefaultOptInUrl),e.setQueryParam(T.PowerAppEndpoints.apiVersionKey,M.Region.getCurrentRegion().bapApiVersion);var t={method:y.Method.GET,url:e.toString(),headers:Object(c.HashTableUtility_create)()};return t.headers[y.HeaderName.ContentType]=y.MediaType.ApplicationJson,k(t),Object(S.sendHttpJsonResponseAsync)(this._httpClient,t,r.getOptInCountriesListCall).then((function(e){var t=O.gg.safeCast(e);if(null===t)throw new C.SafeCastError("IOptInCountryResponse");return t}))},t.prototype.getTenantDataAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e,t,n,o,i,a,p;return __generator(this,(function(l){switch(l.label){case 0:return(e=u.BapUtility.createBapProviderUrlBuilder()).appendPath(s.tenantResource),e.setQueryParam(T.PowerAppEndpoints.apiVersionKey,M.Region.getCurrentRegion().bapApiVersion),(t={method:y.Method.GET,url:e.toString(),headers:Object(c.HashTableUtility_create)()}).headers[y.HeaderName.ContentType]=y.MediaType.ApplicationJson,k(t),p=(a=O.z).safeCast,[4,Object(S.sendHttpJsonResponseAsync)(this._httpClient,t,r.getTenantData)];case 1:return n=p.apply(a,[l.sent()]),o=n.aadDataBoundary,i=n.location,[2,{aadDataBoundary:o,location:i}]}}))}))},t.prototype.sendOptInConsentInformationAsync=function(e){var t=u.BapUtility.createBapProviderUrlBuilder();t.appendPath(a.userEmailConsentUrl),t.setQueryParam(T.PowerAppEndpoints.apiVersionKey,M.Region.getCurrentRegion().bapApiVersion);var n={bodyData:JSON.stringify(e),method:y.Method.POST,url:t.toString(),headers:Object(c.HashTableUtility_create)()};return n.headers[y.HeaderName.ContentType]=y.MediaType.ApplicationJson,k(n),Object(S.sendHttpIgnoreResponseAsync)(this._httpClient,n,r.sendOptInUserConsentCall)},t.prototype.requestPushNotificationAsync=function(){var e=this;return new b.a(this._httpClient,(function(){return e._identityService})).requestTestNotificationAsync()},t.prototype.getCustomBrandingConfigAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e,t,n,o,i,a;return __generator(this,(function(s){switch(s.label){case 0:(e=Core.Environment.usePowerPlatformApi()?j.PowerAppsUtility.createPowerAppsTenantUrlBuilder(this._identityService.identity.tenantId):new c.UrlBuilder(j.PowerAppsUtility.getBaseUrl())).appendPath(T.PowerAppEndpoints.UrlPaths.customBrandingAssets),t=new p.BodilessHttpRequestBuilder,j.PowerAppsUtility.authorizeHttpBuilder(t,y.Method.GET,e.toUrl(),j.PowerAppsUtility.getPowerAppsResourceName(),j.PowerAppsUtility.getPowerAppsApiVersion()),n=t.generateSendHttpRequestParameters(),Object(d.appendCustomHeadersOptions)(n,{addCustomHeaders:!0}),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,Object(S.sendHttpJsonResponseAsync)(this._httpClient,n,r.getCustomBrandingAssetsCall)];case 2:if(o=s.sent(),null===(i=O.Wf.safeCast(o)))throw new C.SafeCastError("IMobileCustomBrandingConfig");return[2,i];case 3:throw a=s.sent(),Object(c.throwIfCanceled)(a),c.CoreLog.error("PowerAppsService.getCustomBrandingConfigAsync",a,"Could not fetch custom branding config"),a;case 4:return[2]}}))}))},t.prototype.checkComponentUpdatesAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var n,o,i,a,s,u;return __generator(this,(function(p){switch(p.label){case 0:if(!Object(c.isNonEmptyString)(e)||!Object(c.isNonEmptyString)(t))return[2,[]];n=Core.Environment.usePowerPlatformApi()?j.PowerAppsUtility.createPowerPlatformPowerAppsUrlBuilder(t):j.PowerAppsUtility.createPowerAppsBaseUrlBuilder(),o=Core.Environment.usePowerPlatformApi()?j.PowerAppsUtility.getPowerPlatformApiVersion():j.PowerAppsUtility.getApiVersion(),Core.Environment.usePowerPlatformApi()||(n.appendPath(T.PowerAppEndpoints.providers),n.appendPath(T.PowerAppEndpoints.environmentsValue),n.appendPath(t)),n.appendPath(T.PowerAppEndpoints.appsValue),n.appendPath(e),n.appendPath(T.PowerAppEndpoints.UrlPaths.checkComponentUpdates),n.setQueryParam(T.PowerAppEndpoints.apiVersionKey,o),i={url:n.toString(),method:y.Method.POST,headers:Object(c.HashTableUtility_create)((u={"Content-Type":"application/json"},u[y.HeaderName.CacheControl]=y.HeaderValue.NoCacheNoStore,u))},AppMagic.Runtime.Client.addAuthorizationOptions(i.headers,{resource:j.PowerAppsUtility.getPowerAppsResourceName()}),Object(D.addServiceErrorOptions)(i,{serviceType:j.PowerAppsUtility.getPowerAppsServiceType()}),p.label=1;case 1:return p.trys.push([1,3,,4]),[4,Object(S.sendHttpJsonResponseAsync)(this._httpClient,i,r.checkComponentUpdatesCall)];case 2:return a=p.sent(),[2,I.AppComponentUpdateInfos.safeCast(a)];case 3:return s=p.sent(),Object(c.isCanceledError)(s)||c.CoreLog.errorEx("PowerAppsService.checkComponentUpdatesAsync",s),[2,[]];case 4:return[2]}}))}))},t.prototype.makeExistingCanvasAppSolutionAwareAsync=function(e,t,n){return __awaiter(this,void 0,Promise,(function(){var o,i,a,s,u,p;return __generator(this,(function(l){switch(l.label){case 0:if(!e||!t)return[2,null];o=j.PowerAppsUtility.createMakeSolutionAwareEndpointUrlBuilder(e,t),i={url:o.toString(),method:y.Method.POST,headers:Object(c.HashTableUtility_create)((p={"Content-Type":"application/json"},p[y.HeaderName.CacheControl]=y.HeaderValue.NoCacheNoStore,p)),bodyData:JSON.stringify({solutionId:n})},AppMagic.Runtime.Client.addAuthorizationOptions(i.headers,{resource:j.PowerAppsUtility.getPowerAppsResourceName()}),Object(D.addServiceErrorOptions)(i,{serviceType:j.PowerAppsUtility.getPowerAppsServiceType()}),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,Object(S.sendHttpJsonResponseAsync)(this._httpClient,i,r.makeExistingCanvasAppSolutionAwareAsync,{appId:e,solutionId:n,environmentId:t})];case 2:return a=l.sent(),[2,R.AppInfoParser.parseAppInfo(a)];case 3:return s=l.sent(),Object(c.isCanceledError)(s)||((u=s)&&u.response&&409===u.response.status?c.CoreLog.warningEx(r.makeExistingCanvasAppSolutionAwareAsync,s):c.CoreLog.errorEx(r.makeExistingCanvasAppSolutionAwareAsync,s)),[2,null];case 4:return[2]}}))}))},t.prototype.getAppDetailsById=function(e,t){return __awaiter(this,void 0,Promise,(function(){var n,o,i,a,s,u,p,l;return __generator(this,(function(d){switch(d.label){case 0:if(n=Core.Environment.usePowerPlatformApi(),!((o=n?j.PowerAppsUtility.getPowerPlatformApiVersion():T.PowerAppEndpoints.getCuratedApiVersion())&&e&&t))return[2,null];(i=n?j.PowerAppsUtility.createPowerPlatformAppUrlBuilder(e,t):j.PowerAppsUtility.createPowerAppsEnvironmentAppUrlBuilder(e,t)).setQueryParam(T.PowerAppEndpoints.apiVersionKey,o),i.setQueryParam(g.ODataConstants.QueryOption.Expand,T.ListAppExpandParameters.Environment),a={url:i.toString(),method:y.Method.GET,headers:Object(c.HashTableUtility_create)((l={"Content-Type":"application/json"},l[y.HeaderName.CacheControl]=y.HeaderValue.NoCacheNoStore,l))},AppMagic.Runtime.Client.addAuthorizationOptions(a.headers,{resource:j.PowerAppsUtility.getPowerAppsResourceName()}),Object(D.addServiceErrorOptions)(a,{serviceType:P.e}),d.label=1;case 1:return d.trys.push([1,3,,4]),[4,Object(S.sendHttpJsonResponseAsync)(this._httpClient,a,r.getAppDetailsById,{appId:e,environmentId:t})];case 2:return s=d.sent(),[2,R.AppInfoParser.parseAppDetailString(s)];case 3:return u=d.sent(),Object(c.isCanceledError)(u)||((p=u)&&p.response&&409===p.response.status?c.CoreLog.warningEx(r.getAppDetailsById,u):c.CoreLog.errorEx(r.getAppDetailsById,u)),[2,null];case 4:return[2]}}))}))},t._generateDebugPlayerPackageLocally=o.None,t._getPublicItemsParamName_Filter="$filter",t._getPublicTemplatesQueryParamValue_Filter="CategoryIds/any(c: c eq 'powerapps-templates')",t._getInternalTemplatesQueryParamValue_Filter="CategoryIds/any(c: c eq 'powerapps-templates-all')",t}(c.Disposable)},function(e,t,n){"use strict";n.r(t),n.d(t,"BodilessHttpRequestBuilder",(function(){return i}));var r=n(0),o=n(3),i=function(){function e(e){this._method="",this._baseUrl=null,this._headers=Object(r.HashTableUtility_create)(),this._queryParameters=Object(r.HashTableUtility_create)(),this._paths=[],this._pathUpdateFunction=e}return e.prototype.clone=function(t){this._pathUpdateFunction=t;var n=new e;return this._cloneTo(n),n},e.prototype._cloneTo=function(e){var t=this;e._method=this._method,e._baseUrl=this._baseUrl,e._pathUpdateFunction=this._pathUpdateFunction,Object.keys(this._headers).forEach((function(n){return e._headers[n]=t._headers[n]})),Object.keys(this._queryParameters).forEach((function(n){return e._queryParameters[n]=t._queryParameters[n]}));for(var n=0,o=this._paths.length;n<o;n++){var i=this._paths[n],a=Object(r.clone)(i.templateValuesByParamName);e._paths.push({path:i.path,templateValuesByParamName:a})}},e.prototype.setMethod=function(e){this._method=e},e.prototype.setBaseUrl=function(e){this._baseUrl=e},e.prototype.addHeader=function(e,t){this._headers[e]=t},e.prototype.addQueryParameter=function(e,t){this._queryParameters[e]=t},e.prototype.addPath=function(e){var t=Object(r.HashTableUtility_create)();return this._paths.push({path:e,templateValuesByParamName:t}),this._paths.length-1},e.prototype.addTemplateToPath=function(e,t,n){this._paths[e].templateValuesByParamName[t]=n},e.prototype.generateSendHttpRequestParameters=function(){var e=this._buildUrl(),t={method:this._method,url:e.toString(),headers:Object(r.HashTableUtility_create)(this._headers)},n=this._generateBodyBinary();if(n){t.bodyData=n;var i=null;r.FallbackSwitch.isActivated("AppConnectivity.DeDupContentType")||(i=t.headers?Object(r.tryGetKeyIgnoreCase)(t.headers,o.HeaderName.ContentType):null),i||(i=o.HeaderName.ContentType),t.headers[i]=n.contentType}return t},e.prototype._generateBodyBinary=function(){return null},e.prototype._buildUrl=function(){var e=this,t=new r.UrlBuilder(this._baseUrl),n=/{([^\{\}]+)}/g;return this._paths.map((function(e){return null===e.path||0===e.path.length?null:e.path.replace(n,(function(t,n){var o=e.templateValuesByParamName[n];return o?Object(r.encode)(o):""}))})).forEach((function(n){e._pathUpdateFunction&&(n=e._pathUpdateFunction(n)),n&&n.length>0&&t.appendPath(n)})),Object(r.forEach)(this._queryParameters,(function(e,n){t.setQueryParam(n,e)})),t.toUrl()},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"addServiceErrorOptions",(function(){return i}));var r=n(0),o=n(3);function i(e,t){e.headers||(e.headers=Object(r.HashTableUtility_create)());var n=JSON.stringify(t);e.headers[o.HeaderName.ServiceErrorOptions]=n}},function(e,t,n){"use strict";n.r(t),n.d(t,"AppInfoParser",(function(){return l}));var r=n(0),o=n(1),i=(n(51),n(9)),a=n(15),s=n(2),c=n(140),u=n(88),p=n(170),l=function(){function e(){}return e._parseCommonAppData=function(t){var n=t.commitMessage||null,o=Date.parse(t.createdTime);isNaN(o)&&(o=0);var i=Date.parse(t.lastPublishTime);isNaN(i)&&(i=0);var a=t.lastDraftVersion||null,p=!!a&&t.lastDraftVersion===t.lastPublishTime,l=Date.parse(t.lastModifiedTime);isNaN(l)&&(l=0);var d=(t.authorizationReferences||[]).map((function(e){return c.AuthResource.tryFromServerAuthReference(e)})).filter((function(e){return null!==e})),f=(t.userAppResourceConsent||[]).map((function(e){return Object(u.tryFromServerUserConsent)(e)})).filter((function(e){return null!==e})),y=e._parseLastOpenedTime(t.userAppMetadata),m=!(!t.userAppMetadata||t.userAppMetadata.favorite!==s.favoriteValue),g=!!t.isFeaturedApp,v=!!t.isHeroApp,b=!(!t.userAppMetadata||!t.userAppMetadata.includeInAppsList);if(v&&!g)throw new AppMagic.PowerApps.AppInfoParserError("AppInfo is invalid. All heroApps should also be featured apps.");var h,A,C=t.displayName,P=e._parsePublisher(t),w=t.bypassConsent;h=Object(r.isValue)(t.connectionReferences)?Object(r.map)(t.connectionReferences,(function(t){return e.parseConnectionReference(t,w)}),!1):Object(r.HashTableUtility_create)(),A=Object(r.isValue)(t.databaseReferences)?Object(r.HashTableUtility_create)(t.databaseReferences):Object(r.HashTableUtility_create)();var S=t.almMode,O=t.unpublishedAppDefinition?e.parseAppInfo(t.unpublishedAppDefinition):null,R=e._parseLifeCycleId(t.lifeCycleId),_=e._parseEmbeddedAppInfo(t.embeddedApp),T=e._parseAppUris(t.appUris),I=e._parseAppPackageDetails(t.appPackageDetails),E=t.lastPublishedBy,U=t.appVersion,j=e._parseAppSourceControlMetadata(t.sourceControl);return{commitMessage:n,createdTime:o,lastPublishTime:i,lastDraftVersion:a,isFirstPublish:p,lastModifiedTime:l,authResources:d,userConsents:f,lastOpenedTime:y,isFavorite:m,isFeaturedApp:g,isHeroApp:v,includeInAppsList:b,displayName:C,publisher:P,bypassConsent:w,connectionReferences:h,databaseReferences:A,lastDraft:O,lifeCycleId:R,embeddedApp:_,appUris:T,appPackageDetails:I,almMode:S,lastPublishedBy:E,appVersion:U,sourceControl:j}},e._parseTagInfo=function(e){var t=Object(r.HashTableUtility_create)(e.tags),n=a.AppInfo.getTagValue(t,s.TemplateTags.sharePointSiteId),o=a.AppInfo.getTagValue(t,s.TemplateTags.sharePointListId);if(n&&!o||!n&&o)throw new AppMagic.PowerApps.AppInfoParserError("AppInfo is invalid. It should have both sp list and site provided, or none.");return{tags:t,sharePointSiteId:n,sharePointListId:o}},e._createAppInfo=function(e,t,n,r,o,i,c,u,p,l,d,f,y,m,g,v,b,h,A){var C;void 0===f&&(f=null),void 0===y&&(y=null),void 0===m&&(m=null),void 0===g&&(g=null),void 0===v&&(v=null),void 0===b&&(b=null),void 0===h&&(h=null),void 0===A&&(A=null);var P={isFirstPublish:o.isFirstPublish,globalAppDocumentUri:o.appUris.globalDocumentUrl,lastDraftVersion:o.lastDraftVersion,lastPublishDate:o.lastPublishTime,lastDraft:o.lastDraft,lifeCycleId:o.lifeCycleId,commitMessage:o.commitMessage,screenshots:o.appUris.imageUrls,embeddedApp:o.embeddedApp,userConsents:o.userConsents,rawServerRepresentation:e,appDocumentComplexity:v,almMode:o.almMode,lastPublishedBy:o.lastPublishedBy,appVersion:o.appVersion,sourceControl:o.sourceControl,offlineProfileDetails:A},w="true"===a.AppInfo.getTagValue(i.tags,s.TemplateTags.hasComponent),S=a.AppInfo.getTagValue(i.tags,s.TemplateTags.hasUnlockedComponent);return new a.AppInfo(p,t.id,t.name,n,r,o.createdTime,o.lastModifiedTime,o.appUris.documentUrl,o.appPackageDetails.playerPackageUrl,o.appPackageDetails.playerReadOnlyPackageUrl,o.appUris.debugPlayerPackageUrl,o.displayName,u,c,o.authResources,o.publisher,null===a.AppInfo.getTagValue(i.tags,s.TemplateTags.supportsPortrait)?null:"true"===a.AppInfo.getTagValue(i.tags,s.TemplateTags.supportsPortrait),"true"===a.AppInfo.getTagValue(i.tags,s.TemplateTags.supportsLandscape),w,null!==S?"true"===S:w,parseInt(a.AppInfo.getTagValue(i.tags,s.TemplateTags.primaryDeviceWidth),10)||0,parseInt(a.AppInfo.getTagValue(i.tags,s.TemplateTags.primaryDeviceHeight),10)||0,a.AppInfo.getTagValue(i.tags,s.TemplateTags.primaryFormFactor)||"",a.AppInfo.getTagValue(i.tags,s.TemplateTags.sienaVersion),a.AppInfo.getTagValue(i.tags,s.TemplateTags.publisherVersion||"0.0.0"),a.AppInfo.getTagValue(i.tags,s.TemplateTags.minimumRequiredApiVersion||"0.0.0"),a.AppInfo.getTagValue(i.tags,s.TemplateTags.deviceCapabilities),i.tags,l,o.connectionReferences,o.databaseReferences,d.sharedGroupsCount,d.sharedUsersCount,d.owner,d.lastModifiedBy,d.createdBy,o.appPackageDetails.webPackageUrl,o.appPackageDetails.webReadOnlyPackageUrl,i.sharePointSiteId,i.sharePointListId,o.appUris.debugWebPackageUrl,o.isFavorite,o.lastOpenedTime,o.isFeaturedApp,o.isHeroApp,o.includeInAppsList,y?"Split":o.appPackageDetails.appPackageResourcesKind,o.appPackageDetails.documentServerVersion,o.appPackageDetails.packagePropertiesJson,P,!!o.bypassConsent,"true"===a.AppInfo.getTagValue(i.tags,s.TemplateTags.showStatusBar),f,y,m,g,null!==(C=t.appType)&&void 0!==C?C:null,null,null,b,h,o.appPackageDetails.unauthenticatedWebPackageUrl,o.appPackageDetails.unauthenticatedWebReadOnlyPackageUrl,t.metadataVersion,d.enableModernRuntimeMode,o.appPackageDetails.unauthenticatedModernRuntimePackageUrl,!1,d.canvasAppAdornerStatus,d.canvasAppSidecarStatus)},e._createUnifiedCanvasAppInfo=function(t,n,r,i,c,u,p,l,d,f,y,m){var g=o.Fg.safeCast(JSON.parse(d));if(null===g)throw new AppMagic.PowerApps.AppInfoParserError("Invalid unified canvas app metadata.");var v=this._parseCommonAppData(g.properties),b=e._parseTagInfo(g),h=e._parseImageUrl(g),A=g.properties.backgroundColor,C=g.properties.appOverrides,P=g.logicalName?g.logicalName:"",w=g.properties.unauthenticatedWebPackageHint,S=g.properties,O={isFirstPublish:v.isFirstPublish,globalAppDocumentUri:v.appUris.globalDocumentUrl,lastDraftVersion:v.lastDraftVersion,lastPublishDate:v.lastPublishTime,lastDraft:v.lastDraft,lifeCycleId:v.lifeCycleId,commitMessage:v.commitMessage,screenshots:v.appUris.imageUrls,embeddedApp:v.embeddedApp,userConsents:v.userConsents,rawServerRepresentation:JSON.parse(t),appDocumentComplexity:void 0,almMode:v.almMode,lastPublishedBy:v.lastPublishedBy,appVersion:v.appVersion,sourceControl:v.sourceControl},R="true"===a.AppInfo.getTagValue(b.tags,s.TemplateTags.hasComponent),_=a.AppInfo.getTagValue(b.tags,s.TemplateTags.hasUnlockedComponent);return new a.AppInfo(t,r,n,u,"",v.createdTime,f,v.appUris.documentUrl,v.appPackageDetails.playerPackageUrl,v.appPackageDetails.playerReadOnlyPackageUrl,v.appUris.debugPlayerPackageUrl,c,A,h,v.authResources,v.publisher,null===a.AppInfo.getTagValue(b.tags,s.TemplateTags.supportsPortrait)?null:"true"===a.AppInfo.getTagValue(b.tags,s.TemplateTags.supportsPortrait),"true"===a.AppInfo.getTagValue(b.tags,s.TemplateTags.supportsLandscape),R,null!==_?"true"===_:R,parseInt(a.AppInfo.getTagValue(b.tags,s.TemplateTags.primaryDeviceWidth),10)||0,parseInt(a.AppInfo.getTagValue(b.tags,s.TemplateTags.primaryDeviceHeight),10)||0,a.AppInfo.getTagValue(b.tags,s.TemplateTags.primaryFormFactor)||"",a.AppInfo.getTagValue(b.tags,s.TemplateTags.sienaVersion),a.AppInfo.getTagValue(b.tags,s.TemplateTags.publisherVersion||"0.0.0"),a.AppInfo.getTagValue(b.tags,s.TemplateTags.minimumRequiredApiVersion||"0.0.0"),a.AppInfo.getTagValue(b.tags,s.TemplateTags.deviceCapabilities),b.tags,l,v.connectionReferences,v.databaseReferences,S.sharedGroupsCount,S.sharedUsersCount,S.owner,S.lastModifiedBy,S.createdBy,v.appPackageDetails.webPackageUrl,v.appPackageDetails.webReadOnlyPackageUrl,b.sharePointSiteId,b.sharePointListId,v.appUris.debugWebPackageUrl,v.isFavorite,y,v.isFeaturedApp,v.isHeroApp,v.includeInAppsList,null,v.appPackageDetails.documentServerVersion,v.appPackageDetails.packagePropertiesJson,O,!!v.bypassConsent,"true"===a.AppInfo.getTagValue(b.tags,s.TemplateTags.showStatusBar),P,null,C,w,i,p,m,v.appVersion)},e._createUnifiedModelAppInfo=function(e,t,n,o,i,s,c,u,p,l,d,f,y,m){var g={isFirstPublish:!1,globalAppDocumentUri:null,lastDraftVersion:null,lastPublishDate:0,lastDraft:null,lifeCycleId:null,commitMessage:null,screenshots:[],embeddedApp:null,userConsents:[],rawServerRepresentation:JSON.parse(e),appDocumentComplexity:void 0,almMode:null,lastPublishedBy:void 0,appVersion:null,sourceControl:null},v={id:"",displayName:m.owner,type:""},b=Object(r.HashTableUtility_create)(),h=Object(r.HashTableUtility_create)();return new a.AppInfo(e,n,t,s,null,0,l,null,null,null,null,i,null,null,[],null,null,null,null,null,0,0,"",null,null,null,null,b,u,h,void 0,void 0,void 0,v,void 0,void 0,null,null,null,null,null,!1,d,!1,!1,!0,null,null,null,g,!1,!1,p,null,null,null,o,c,f,null,y)},e.parseUnifiedAppInfo=function(t){try{var n=o.oh.safeCast(t);if(null===n)throw new AppMagic.PowerApps.AppInfoParserError("Invalid unified app info.");var i=n.name,a=n.id,c=n.type,u=n.location,p=n.appModuleSettings,l=n.properties,d=l.displayName,f=l.description||null,y=l.icons,m=l.logicalName,g=l.environment;g.properties&&(g.properties.location=u);var v=Date.parse(l.lastModifiedTime);isNaN(v)&&(v=0);var b=Date.parse(l.lastOpenedTime);isNaN(b)&&(b=0);var h=new r.Core_Url(l.appOpenUri),A=l.metadata,C=JSON.stringify(t);if(c===s.UnifiedAppTypes.CanvasApp)return e._createUnifiedCanvasAppInfo(C,i,a,c,d,f,y,g,A,v,b,h);if(c===s.UnifiedAppTypes.AppModule)return e._createUnifiedModelAppInfo(C,i,a,c,d,f,y,g,m,v,b,h,p,l);throw new Error("Incorrect AppType provided by server")}catch(e){return r.CoreLog.error("AppInfoParser.parseUnifiedAppInfo",e,"Error parsing app info from server"),null}},e.parseAppInfo=function(t,n){void 0===n&&(n=null);try{var i=o.Hg.safeCast(t);if(null===i)throw new AppMagic.PowerApps.AppInfoParserError("Invalid app info.");return i.type===s.UnifiedAppTypes.CanvasApp||i.type===s.UnifiedAppTypes.AppModule?e.parseUnifiedAppInfo(t):e._parseCanvasAppInfo(t,n)}catch(e){return r.CoreLog.error("AppInfoParser.parseAppInfo",e,"AppInfo: "+JSON.stringify(t)),null}},e.parseAppDetailString=function(e){var t,n,o;try{var i=JSON.parse(JSON.stringify(e));return i&&!i.error&&(i.id=i.appType==s.AppTypesFromRP.UnifiedApp?this.createCuratedAppModuleId(i.id,i.appModuleId,(null===(t=i.properties)||void 0===t?void 0:t.appOpenUri)||null):i.id,(null===(o=null===(n=i.properties)||void 0===n?void 0:n.environment)||void 0===o?void 0:o.properties)&&(i.properties.environment.properties.location=i.properties.environment.location)),this.parseAppInfo(i)}catch(e){return r.CoreLog.error("AppInfoParser.parseAppDetailString",e),null}},e._parseCanvasAppInfo=function(t,n){void 0===n&&(n=null);try{var i=o.Fg.safeCast(t);if(null===i)throw new AppMagic.PowerApps.AppInfoParserError("Invalid app info.");var c=i.properties.description||null,u=i.properties.aiGeneratedDescription||null,p=this._parseCommonAppData(i.properties),l=e._parseTagInfo(i),d=e._parseImageUrl(i),f=i.properties.backgroundColor,y=i.properties.appOverrides,m=JSON.stringify(t),g=i.properties.environment?i.properties.environment:null,v=i.logicalName?i.logicalName:"",b=i.properties.unauthenticatedWebPackageHint,h=i.properties.appDocumentComplexity,A=p.appVersion,C=i.properties.offlineProfileDetails,P=null;if(n)P=o.sb.safeCast(n).webPackageUrl;var w=a.AppInfo.getTagValue(l.tags,s.TemplateTags.localConnectionReferencesJSON);return w&&e.convertObsoleteTagConnectionReferenceToFirstClassConnectionReference(w,p.connectionReferences,p.bypassConsent),e._createAppInfo(t,i,c,u,p,l,d,f,m,g,i.properties,v,P,y,b,h,A,i.appModuleSettings,C)}catch(e){return r.CoreLog.error("AppInfoParser._parseCanvasAppInfo",e,"AppInfo: "+Object(r.scrubSensitiveDataFromAnySafe)(t)),null}},e.parseModelAppInfo=function(t){try{var n=o.Lg.safeCast(t);if(null===n)throw new AppMagic.PowerApps.AppInfoParserError("Invalid model app info.");var i=n.properties.appDescription||null,a=n.properties.aiGeneratedDescription||null,s=this._parseCommonAppData(n.properties),c=e._parseTagInfo(n),u=e._parseModelAppIconUrl(n),l=n.properties.backgroundColor?n.properties.backgroundColor:"rgba(0, 176, 240, 1)",d=JSON.stringify(t),f=void 0;if(n.properties.groupDisplayName&&n.properties.groupName){var y={displayName:n.properties.groupDisplayName,location:""};f={id:n.properties.groupName,name:n.properties.groupDisplayName,properties:y}}else f={id:"",name:"",properties:{displayName:"",location:""}};var m=e._createAppInfo(t,n,i,a,s,c,u,l,d,f,n.properties),g=void 0;return n.properties.appOpenUri?g=n.properties.appOpenUri:n.properties.navigateUri&&(g=n.properties.navigateUri),new p.ModelAppInfo(m,new r.Core_Url(g))}catch(e){return r.CoreLog.error("AppInfoParser.parseAppInfo",e,"ModelAppInfo: "+JSON.stringify(t)),null}},e.tryParseCuratedAppInfo=function(t){var n,i,c;try{var u=o.db.safeCast(t);if(null===u)throw new AppMagic.PowerApps.AppInfoParserError("Invalid curated app info.");var p=Object(r.HashTableUtility_create)(),l=JSON.stringify(t),d=e._parseCuratedAppIconUrl(u),f=Date.parse(u.properties.createdTime);(isNaN(f)||f<=0)&&(f=0);var y=Date.parse(u.properties.lastUsedTime);(isNaN(y)||y<=0)&&(y=0);var m=void 0;if(u.properties.groupName){var g={displayName:null!==(n=u.properties.groupDisplayName)&&void 0!==n?n:"",location:"",environmentSku:null!==(i=u.properties.groupType)&&void 0!==i?i:""};m={id:u.properties.groupName,name:null!==(c=u.properties.groupName)&&void 0!==c?c:"",properties:g}}else m={id:"",name:"",properties:{displayName:"",location:""}};var v=void 0;v=u.properties.createdBy.id&&u.properties.createdBy.type?{id:u.properties.createdBy.id,type:u.properties.createdBy.type,email:u.properties.createdBy.userPrincipalName,displayName:u.properties.createdBy.displayName}:{id:"",type:"",email:"",displayName:""};var b=Object(r.HashTableUtility_create)(),h=Object(r.HashTableUtility_create)(),A={isFirstPublish:!1,globalAppDocumentUri:null,lastDraftVersion:null,lastPublishDate:0,lastDraft:null,lifeCycleId:null,commitMessage:null,screenshots:[],embeddedApp:null,userConsents:[],rawServerRepresentation:JSON.parse(l),appDocumentComplexity:void 0,almMode:null,lastPublishedBy:void 0,appVersion:null,sourceControl:null},C=void 0;return C=u.type===s.AppTypesFromRP.UnifiedApp?this.createCuratedAppModuleId(u.id,u.appModuleId||null,u.properties.appOpenUri||null):u.id,new a.AppInfo(l,C,u.name,u.properties.appDescription,"",f,0,null,null,null,null,u.properties.displayName,u.properties.backgroundColor,d,[],null,null,null,null,null,0,0,"",null,null,null,null,p,m,b,h,void 0,void 0,v,void 0,void 0,null,null,null,null,null,u.properties.isFavorited,y,u.properties.featuredApp,u.properties.heroApp,!0,null,null,null,A,!0,!1,null,null,null,null,u.type,null,null,null,null,null,null,null,null,null,!0,null,null)}catch(e){return r.CoreLog.error("AppInfoParser.parseAppInfo",e,"AppInfo: "+JSON.stringify(t)),null}},e._parseLastOpenedTime=function(e){if(e&&e.lastOpenedTime){var t=Date.parse(e.lastOpenedTime);return isNaN(t)&&(t=0),t}return 0},e._parseLifeCycleId=function(e){if(!e)return null;switch(e.toLowerCase()){case"published":return a.AppLifeCycleId.Published;case"draft":return a.AppLifeCycleId.Draft;case"autosaved":return a.AppLifeCycleId.AutoSaved;case"packaged":return a.AppLifeCycleId.Packaged;default:throw new AppMagic.PowerApps.AppInfoParserError("Unexpected lifeCycleId: "+e)}},e._parseEmbeddedAppInfo=function(e){if(!e)return null;if(!Object(r.isNonEmptyString)(e.type))throw new AppMagic.PowerApps.AppInfoParserError("Emmbedded app type should be a string");var t;switch(e.type){case s.EmbeddedAppTypes.SharepointFormApp:if(!(t=o.Mg.safeCast(e)))throw new AppMagic.PowerApps.AppInfoParserError("Embedded app properties are invalid for sharepoint form app. Refer to the appInfo for details.");return t;case s.EmbeddedAppTypes.TeamsApp:if(!(t=o.vb.safeCast(e)))throw new AppMagic.PowerApps.AppInfoParserError("Embedded app properties are invalid for teams app . Refer to the appInfo for details.");return t;default:throw new AppMagic.PowerApps.AppInfoParserError("Unexpected embedded app type: "+e.type)}},e._parseAppSourceControlMetadata=function(e){return e&&Object(r.isNonEmptyString)(e.gitUrl)&&Object(r.isNonEmptyString)(e.branch)&&Object(r.isNonEmptyString)(e.directory)?{gitUrl:Object(r.safeCastString)(e.gitUrl),branch:Object(r.safeCastString)(e.branch),directory:Object(r.safeCastString)(e.directory),commitHash:Object(r.safeCastString)(e.commitHash)}:null},e.convertObsoleteTagConnectionReferenceToFirstClassConnectionReference=function(t,n,o){var i=this,a=Object(r.tryParseJson)(t);Object(r.isJsonHashTable)(a)?Object(r.forEach)(a,(function(a,c){var u=a[s.hiddenParametersTag];if(u){var p=Object(r.safeCastString)(u[s.ParameterHintNames.msFlowWorkflowName]);if(p){var l=e._convertUnSafeLocalConnectionToConnectionReference(a,o);if(!l)return void r.CoreLog.errorEx("AppInfoParser.convertObsoleteTagConnectionReferenceToFirstClassConnection","Local connection is invalid.",{eventData:{localConnectionReferenceJson:t}});n[c]=l,l.parameterHints||(l.parameterHints={}),l.parameterHints[s.ParameterHintNames.msFlowWorkflowName]={value:p},l.parameterHintsV2||(l.parameterHintsV2={}),l.parameterHintsV2[s.ParameterHintNames.msFlowWorkflowName]={value:p},i._updateWorkflowEntityId(l,u)}}})):r.CoreLog.errorEx("AppInfoParser.convertObsoleteTagConnectionReferenceToFirstClassConnection","oldConnectionRef is not a valid hashtable.",{eventData:{localConnectionReferenceJson:t}})},e._updateWorkflowEntityId=function(e,t){var n=Object(r.safeCastString)(t[s.ParameterHintNames.msWorkflowEntityId]);n&&(e.parameterHints[s.ParameterHintNames.msWorkflowEntityId]={value:n},e.parameterHintsV2[s.ParameterHintNames.msWorkflowEntityId]={value:n})},e._convertUnSafeLocalConnectionToConnectionReference=function(e,t){var n,r=o.Vf.safeCast(e);if(!r)return null;var i={dataSources:r.dataSources,dependencies:r.dependencies,displayName:r.connectionRef.displayName,dependents:r.dependents,id:r.connectionRef.id.toLowerCase(),iconUri:r.connectionRef.iconUri,appActions:null!==(n=r.appActions)&&void 0!==n?n:[]};return i.bypassConsent=!!t,i.isOnPremiseConnection=!!r.connectionRef.isOnPremiseConnection,i.isCustomApiConnection=!!r.connectionRef.isCustomApiConnection,r.connectionRef.gatewayObjectIdHint&&(i.gatewayObjectIdHint=r.connectionRef.gatewayObjectIdHint),r.connectionRef.parameterHints&&(i.parameterHints=r.connectionRef.parameterHints),r.connectionRef.parameterHintsV2&&(i.parameterHintsV2=r.connectionRef.parameterHintsV2),r.connectionRef.resourceIdentifier&&(i.resourceIdentifier=r.connectionRef.resourceIdentifier),r.connectionRef.sharedConnectionId&&(i.sharedConnectionId=r.connectionRef.sharedConnectionId.toLowerCase()),i},e._getParamNameFromParamHint=function(e,t){var n=i.FileSource;if(!e.parameterHints)return n;var o=e.parameterHints[t];return o&&Object(r.safeCastString)(o.value)&&(n=Object(r.safeCastString)(o.value)),n},e.parseConnectionReference=function(t,n){var o,a,c=Object(r.HashTableUtility_create)();Object(r.isArray)(t.dependencies)&&(t.parameterHintsV2?Object(r.forEach)(t.parameterHintsV2,(function(e,t){Object(r.equalsIgnoreCase)(t,s.ParameterHintNames.msFlowWorkflowName)||Object(r.equalsIgnoreCase)(t,s.ParameterHintNames.msWorkflowEntityId)||Object(r.equalsIgnoreCase)(t,s.ParameterHintNames.msWorkflowDisplayName)||(c[t]=Object(r.safeCastString)(e.value))})):t.dependencies.forEach((function(n){var r=e._getParamNameFromParamHint(t,n);c[r]=n})));var u={id:t.id.toLowerCase(),displayName:t.displayName,iconUri:t.iconUri,appActions:null!==(o=t.actions)&&void 0!==o?o:[]};return u.dataSources=null!==(a=t.dataSources)&&void 0!==a?a:[],t.dataSets&&(u.datasets=t.dataSets),t.dataSourceAppMappings&&(u.dataSourceAppMappings=t.dataSourceAppMappings),c&&(u.dependencies=c),t.dependents&&(u.dependents=t.dependents),Object(r.isDefined)(t.sharedConnectionId)&&(u.sharedConnectionId=t.sharedConnectionId.toLowerCase()),Object(r.isDefined)(t.gatewayObjectIdHint)&&(u.gatewayObjectIdHint=t.gatewayObjectIdHint),Object(r.isDefined)(t.resourceIdentifier)&&(u.resourceIdentifier=t.resourceIdentifier),t.parameterHints&&(u.parameterHints=t.parameterHints),t.parameterHintsV2&&(u.parameterHintsV2=t.parameterHintsV2),t.apiTier&&(u.apiTier=t.apiTier),t.xrmConnectionReferenceLogicalName&&(u.xrmConnectionReferenceLogicalName=t.xrmConnectionReferenceLogicalName),t.authenticationType&&(u.authenticationType=t.authenticationType),t.nestedActions&&(u.nestedActions=t.nestedActions),t.runtimePolicyName&&(u.runtimePolicyName=t.runtimePolicyName),u.isOnPremiseConnection=!!t.isOnPremiseConnection,u.isCustomApiConnection=!!t.isCustomApiConnection,u.bypassConsent=!!Object(r.equalsIgnoreCase)(u.id,i.ApiIds.CommonDataServiceCurrentEnvironment)||!!n,u},e._parsePublisher=function(e){return e.publisher||null},e._parseImageUrl=function(e){var t=e.properties.backgroundImageUri||null;if(null===t)return null;var n=new r.Core_Url(t);if(!n.isAbsolute)throw new AppMagic.PowerApps.AppInfoParserError("Provided image URL string is not a valid URL.");return n},e._parseModelAppIconUrl=function(e){var t=e.properties.iconUri||null;if(null===t)return null;var n=new r.Core_Url(t);if(!n.isAbsolute)throw new AppMagic.PowerApps.AppInfoParserError("Provided icon URL string is not a valid URL.");return n},e._parseCuratedAppIconUrl=function(e){var t=e.properties.iconUri||null;if(null===t)return null;var n=new r.Core_Url(t);if(!n.isAbsolute)throw new AppMagic.PowerApps.AppInfoParserError("Provided icon URL string is not a valid URL.");return n},e.createCuratedAppModuleId=function(e,t,n){if(null===t||null===n)return e;var o=new r.Core_Url(n);return o.isAbsolute?o.host+"_"+t:e},e._parseAppPackageDetails=function(e){var t;return e?{appPackageResourcesKind:e.appPackageResourcesKind||null,playerPackageUrl:e.playerPackage?new r.Core_Url(e.playerPackage.value):null,playerReadOnlyPackageUrl:e.playerPackage&&e.playerPackage.readonlyValue?new r.Core_Url(e.playerPackage.readonlyValue):null,unauthenticatedWebPackageUrl:e.unauthenticatedWebPackage?new r.Core_Url(e.unauthenticatedWebPackage.value):null,unauthenticatedWebReadOnlyPackageUrl:(null===(t=e.unauthenticatedWebPackage)||void 0===t?void 0:t.readonlyValue)?new r.Core_Url(e.unauthenticatedWebPackage.readonlyValue):null,unauthenticatedModernRuntimePackageUrl:e.unauthenticatedModernRuntimePackage?new r.Core_Url(e.unauthenticatedModernRuntimePackage.value):null,webPackageUrl:e.webPackage?new r.Core_Url(e.webPackage.value):null,webReadOnlyPackageUrl:e.webPackage&&e.webPackage.readonlyValue?new r.Core_Url(e.webPackage.readonlyValue):null,documentServerVersion:this._parseDocumentServerVersion(e.documentServerVersion),packagePropertiesJson:e.packagePropertiesJson||null}:{appPackageResourcesKind:null,playerPackageUrl:null,playerReadOnlyPackageUrl:null,unauthenticatedWebPackageUrl:null,unauthenticatedWebReadOnlyPackageUrl:null,unauthenticatedModernRuntimePackageUrl:null,webPackageUrl:null,webReadOnlyPackageUrl:null,documentServerVersion:null,packagePropertiesJson:null}},e._parseDocumentServerVersion=function(e){return e?Object(r.CoreVersion_create)(e.major,e.minor,e.build,e.revision):null},e._parseAppUris=function(e){return e?{debugPlayerPackageUrl:e.debugPlayerPackageUri?new r.Core_Url(e.debugPlayerPackageUri.value):null,debugWebPackageUrl:e.debugWebPackageUri?new r.Core_Url(e.debugWebPackageUri.value):null,documentUrl:e.documentUri?new r.Core_Url(e.documentUri.value):null,globalDocumentUrl:e.globalAppDocumentUri?new r.Core_Url(e.globalAppDocumentUri.value):null,imageUrls:e.imageUris?e.imageUris.map((function(e){return new r.Core_Url(e.value)})):[]}:{debugPlayerPackageUrl:null,debugWebPackageUrl:null,documentUrl:null,globalDocumentUrl:null,imageUrls:[]}},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"JsonHttpRequestBuilder",(function(){return s}));var r=n(0),o=n(41),i=n(3),a=n(12),s=function(e){function t(){var t=e.call(this)||this;return t._jsonBody=null,t._isBodyUndefined=!0,t}return __extends(t,e),t.prototype.clone=function(){var e=new t;return this._cloneTo(e),e},t.prototype._cloneTo=function(t){e.prototype._cloneTo.call(this,t),t._jsonBody=Object(a.r)(this._jsonBody),t._isBodyUndefined=this._isBodyUndefined},t.prototype._setBody=function(e){this._isBodyUndefined=!1,this._jsonBody=e},t.prototype.setJsonValue=function(e,t){var n=Object(a.s)(e);if(0!==n.length){this._setBody(this._isBodyUndefined?Object.create(null):this._jsonBody);for(var r=this._jsonBody,o=0,i=n.length-1;o<i;o++){var s=n[o];void 0===r[s]&&(r[s]=Object.create(null)),r=r[s]}r[n[n.length-1]]=t}else this._setBody(t)},t.prototype._generateBodyBinary=function(){var e=this.getStringifiedJsonBody();return void 0===e?null:r.PABinary.createFromText(e,i.MediaType.ApplicationJson)},t.prototype.getStringifiedJsonBody=function(){if(!this._isBodyUndefined)return JSON.stringify(this._jsonBody)},t}(o.BodilessHttpRequestBuilder)},function(e,t,n){"use strict";n.r(t),n.d(t,"AuthenticationErrorKind",(function(){return r})),n.d(t,"AuthenticationError",(function(){return i}));var r,o=n(0);!function(e){e[e.NotLoggedInError=0]="NotLoggedInError",e[e.RefreshTokenExpired=1]="RefreshTokenExpired",e[e.ServerError=2]="ServerError",e[e.InvalidIdToken=3]="InvalidIdToken",e[e.InvalidJsonWebToken=4]="InvalidJsonWebToken",e[e.InvalidAuthenticationResult=5]="InvalidAuthenticationResult",e[e.InvalidIdentity=6]="InvalidIdentity",e[e.InvalidAuthorizationCode=7]="InvalidAuthorizationCode",e[e.UserCancelledError=8]="UserCancelledError",e[e.Unspecified=9]="Unspecified",e[e.NetworkConnectionUnavailable=10]="NetworkConnectionUnavailable",e[e.BrokerError=11]="BrokerError",e[e.DeviceError=12]="DeviceError",e[e.UnexpectedUserChange=13]="UnexpectedUserChange",e[e.LogoutRequested=14]="LogoutRequested",e[e.MAMNotCompliant=15]="MAMNotCompliant",e[e.AuthFlowCookiesBlocked=16]="AuthFlowCookiesBlocked",e[e.AuthFlowStorageBlocked=17]="AuthFlowStorageBlocked",e[e.AuthFlowUserCancelled=18]="AuthFlowUserCancelled",e[e.AuthFlowPopupError=19]="AuthFlowPopupError"}(r||(r={}));var i=function(e){function t(n,r,i,a,s){void 0===s&&(s=null);var c=this;return(c=e.call(this,Object(o.CoreUtility_formatString)(t._getErrorMessage(n,r)+" Error: {0}",r),"AuthenticationError",a)||this)._correlationId=i||null,c._errorKind=n,c._rawError=s,c}return __extends(t,e),Object.defineProperty(t.prototype,"errorKind",{get:function(){return this._errorKind},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"correlationId",{get:function(){return this._correlationId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rawError",{get:function(){return this._rawError},enumerable:!1,configurable:!0}),t._getErrorMessage=function(e,t){switch(e){case r.NotLoggedInError:return"[NotLoggedInError] User is not logged in.";case r.RefreshTokenExpired:return"[RefreshTokenExpired] The refresh token has expired.";case r.ServerError:return"[ServerError] There was a server error.";case r.InvalidAuthenticationResult:return"[InvalidAuthenticationResult] AuthenticationResult is not valid.";case r.InvalidIdToken:return"[InvalidIdToken] IdToken is not valid.";case r.InvalidIdentity:return"[InvalidIdentity] Identity is not valid.";case r.InvalidJsonWebToken:return"[InvalidJsonWebToken] JsonWebToken is not valid.";case r.InvalidAuthorizationCode:return"[InvalidAuthorizationCode] Authorization code is not valid.";case r.UserCancelledError:return"[UserCancelledError] User cancelled authentication.";case r.NetworkConnectionUnavailable:return"[NetworkConnectionUnavailable] There was a network Connectivity error.";case r.BrokerError:return"[BrokerError] There was a broker error.";case r.DeviceError:return"[DeviceError] There was a device error.";case r.MAMNotCompliant:return"[NotCompliantError] User is not compliant.";case r.AuthFlowCookiesBlocked:case r.AuthFlowStorageBlocked:case r.AuthFlowUserCancelled:case r.AuthFlowPopupError:return t||"Unspecified error has occurred.";default:return"Unspecified error has occurred."}},t.toAuthenticationError=function(e){return Object(o.throwIfCanceled)(e),e instanceof t?e:Object(o.throwInline)(new t(r.Unspecified,Object(o.formatError)(e)))},t.prototype.requiresLogin=function(){return this.errorKind===r.RefreshTokenExpired||this.errorKind===r.NotLoggedInError},t}(Core.ApplicationError)},function(e,t,n){"use strict";n.r(t),n.d(t,"addEnvironmentFilterToOptions",(function(){return a})),n.d(t,"getEnvironmentFilter",(function(){return s})),n.d(t,"addEnvironmentFilterToUrlBuilder",(function(){return c}));var r=n(0),o=n(27),i=n(21);function a(e,t){t.filter?t.filter=Object(r.CoreUtility_formatString)("{0} {1} {2}",t.filter,i.ODataConstants.QueryOption.FilterOperators.And,s(e)):t.filter=s(e)}function s(e){return Object(r.CoreUtility_formatString)("{0} eq '{1}'",o.c,e)}function c(e,t){return t.setQueryParam(i.ODataConstants.QueryOption.Filter,s(e)),t}},function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"f",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return p})),n.d(t,"i",(function(){return l}));n(0);var r,o=function(){function e(e,t){this._kind=e,this._invocationId=t}return Object.defineProperty(e.prototype,"kind",{get:function(){return this._kind},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"invocationId",{get:function(){return this._invocationId},enumerable:!1,configurable:!0}),e.prototype.asCallStart=function(){return this},e.prototype.asCallSucceeded=function(){return this},e.prototype.asCallFailed=function(){return this},e.prototype.asCallCanceled=function(){return this},e.prototype.asCallTimeout=function(){return this},e}();!function(e){e[e.CallStart=0]="CallStart",e[e.CallSucceeded=1]="CallSucceeded",e[e.CallFailed=2]="CallFailed",e[e.CallCanceled=3]="CallCanceled",e[e.CallTimeout=4]="CallTimeout",e[e.PollingTimerElapsed=5]="PollingTimerElapsed"}(r||(r={}));var i=function(e){function t(t,n,r){var o=e.call(this,t,n)||this;return o._requestId=r,o}return __extends(t,e),Object.defineProperty(t.prototype,"requestId",{get:function(){return this._requestId},enumerable:!1,configurable:!0}),t}(o),a=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r)||this;return i._errorContext=o,i}return __extends(t,e),Object.defineProperty(t.prototype,"errorContext",{get:function(){return this._errorContext},enumerable:!1,configurable:!0}),t}(i),s=function(e){function t(t,n,o){var i=e.call(this,r.CallStart,t,n)||this;return i._serviceFunction=o,i}return __extends(t,e),Object.defineProperty(t.prototype,"serviceFunction",{get:function(){return this._serviceFunction},enumerable:!1,configurable:!0}),t}(i),c=function(e){function t(t,n,o,i){var a=e.call(this,r.CallSucceeded,t,n,o)||this;return a._result=i,a}return __extends(t,e),Object.defineProperty(t.prototype,"result",{get:function(){return this._result},enumerable:!1,configurable:!0}),t}(a),u=function(e){function t(t,n,o,i){var a=e.call(this,r.CallFailed,t,n,o)||this;return a._error=i,a}return __extends(t,e),Object.defineProperty(t.prototype,"error",{get:function(){return this._error},enumerable:!1,configurable:!0}),t}(a),p=function(e){function t(t,n,o,i){var a=e.call(this,r.CallCanceled,t,n,o)||this;return a._error=i,a}return __extends(t,e),Object.defineProperty(t.prototype,"error",{get:function(){return this._error},enumerable:!1,configurable:!0}),t}(a),l=function(e){function t(t,n,o,i){var a=e.call(this,r.CallTimeout,t,n,o)||this;return a._request=i,a}return __extends(t,e),Object.defineProperty(t.prototype,"request",{get:function(){return this._request},enumerable:!1,configurable:!0}),t}(a)},function(e,t,n){"use strict";n.r(t),n.d(t,"AiModelType",(function(){return r})),n.d(t,"isPrebuiltAiModel",(function(){return s})),n.d(t,"IntelligenceConstants",(function(){return o})),n.d(t,"IntelligenceEndpoints",(function(){return i}));var r,o,i,a=n(0);function s(e){return o.PrebuiltAiModelsIds[e.templateName]===e.modelId}!function(e){e.ObjectDetection="ObjectDetection",e.DocumentScanning="DocumentScanning",e.BusinessCard="BusinessCard",e.TextRecognition="TextRecognition",e.ReceiptScanning="ReceiptScanning",e.BinaryClassification="BinaryClassification",e.BringYourOwnModel="BringYourOwnModel",e.EntityExtraction="EntityExtraction",e.IdentityDocument="IdentityDocument",e.InvoiceProcessing="InvoiceProcessing",e.KeyPhraseExtraction="KeyPhraseExtraction",e.LanguageDetection="LanguageDetection",e.SentimentAnalysis="SentimentAnalysis",e.TextClassificationV2="TextClassificationV2",e.TextTranslation="TextTranslation",e.ImageClassification="ImageClassification",e.ImageDescription="ImageDescription",e.GptPromptEngineering="GptPromptEngineering",e.GptPowerPrompt="GptPowerPrompt",e.AISummarize="AISummarize",e.AIReply="AIReply",e.AIExtract="AIExtract",e.AIClassify="AIClassify"}(r||(r={})),function(e){var t;e.AiModelsDataSourceName="43b0dc67-68af-47ae-9a9c-9e69d396ba3e",e.AiModelsEntitySetName="msdyn_aimodels",e.AiModelsLogicalName="msdyn_aimodel",e.AiModelsTableName="AIModel",e.ModelTemplateRelationship="msdyn_TemplateId",e.ModelIdFieldName="msdyn_aimodelid",e.ModelNameFieldName="msdyn_name",e.ActiveRunConfigIdFieldName="_msdyn_activerunconfigurationid_value",e.TemplateName="msdyn_uniquename",e.StatusCodeName="statuscode",e.StateCodeName="statecode",e.AiConfigurationsStatusCode="statuscode",e.AiConfigurationsRunType=190690001,e.AiConfigurationStatusPublished=7,e.AiConfigurationsDataSourceName="18333537-fdd1-4579-907c-955609c15d25",e.AiConfigurationsEntitySetName="msdyn_aiconfigurations",e.AiConfigurationsLogicalName="msdyn_aiconfiguration",e.AiConfigurationsTableName="AIConfiguration",e.AiConfigurationsModelIdFieldName="_msdyn_aimodelid_value",e.AiConfigurationsModifiedOnFieldName="modifiedon",e.AiConfigurationsParentConfigurationExpandName="msdyn_TrainedModelAIConfigurationPareId",e.AiConfigurationsTypeFieldName="msdyn_type",e.AiConfigurationsIdFieldName="msdyn_aiconfigurationid",e.AiConfigurationsLabelExpandName="msdyn_aiodlabel_msdyn_aiconfiguration",e.AiConfigurationsCustomConfigurationFieldName="msdyn_customconfiguration",e.AiLabelsDataSourceName="39a6196f-02b0-4fc1-9715-78a41651bedd",e.AiLabelsEntitySetName="msdyn_aiodlabels",e.AiLabelsLogicalName="msdyn_aiodlabel",e.AiLabelsTableName="AILabel",e.AiLabelsIdFieldName="msdyn_aiodlabelid",e.AiLabelsStringFieldName="msdyn_labelstring",e.Namespace="Microsoft.Dynamics.CRM",e.InferActionName="Predict",e.GetSchemaActionName="PredictionSchema",e.RetrieveOrganizationInfoFunctionName="RetrieveOrganizationInfo",e.AiServiceId="8aa17a0b-1896-4c27-b9ed-218e63abc44a",e.AiModelServiceId="6bff14c4-550f-49e4-a143-055935a28c3c",e.PrebuiltAiModelsIds=((t={})[r.BusinessCard]="a0440df3-2656-e911-8194-000d3a6cd5a5",t[r.TextRecognition]="86419a67-205a-454f-b6fc-601394f2786d",t[r.ReceiptScanning]="baa44529-bebe-49e6-837a-80bee63b0d2c",t[r.EntityExtraction]="8c281981-c5d6-484f-bac7-4924ddd0b8ae",t[r.IdentityDocument]="2c444168-f8b1-4c6a-9313-2d9c03be6fea",t[r.ImageDescription]="77365cfa-7021-4cb7-a9b2-dc9823cde772",t[r.InvoiceProcessing]="5ed4d0fd-e9d4-4026-b09b-71f83ea90c60",t[r.KeyPhraseExtraction]="c8425db7-c5a7-4226-b38e-c93a044c0fe1",t[r.LanguageDetection]="17a6f893-5b0b-4867-8fac-fb2eda9080b2",t[r.SentimentAnalysis]="f1c549c2-a97e-47a5-b612-c5c2bab0f163",t[r.TextClassificationV2]="62d1e848-5ca7-490a-94bf-79baabe85ef4",t[r.TextTranslation]="6225038a-8b5a-4913-bfd2-d8236f4102ba",t[r.GptPromptEngineering]="a1afa5d4-7a44-4c31-9cd2-e852a78431fa",t[r.AISummarize]="c076eac8-f218-4feb-8ad1-7ee4fb039419",t[r.AIReply]="572f57a7-7a8f-49fc-adb4-331e02c509a6",t[r.AIExtract]="4e72b59a-17d6-451e-8657-89fbdec56d7a",t[r.AIClassify]="2bcd7b94-50bc-4767-af4a-367c63fb5487",t)}(o||(o={})),function(e){!function(e){e.intelligenceStudioBaseUrl=new a.Url("https://make.powerapps.com")}(e.Prod||(e.Prod={})),function(e){e.intelligenceStudioBaseUrl=new a.Url("https://make.test.powerapps.com")}(e.Test||(e.Test={})),function(e){e.intelligenceStudioBaseUrl=new a.Url("https://make.powerapps.cn")}(e.Mooncake||(e.Mooncake={})),function(e){e.intelligenceStudioBaseUrl=new a.Url("https://make.powerapps.eaglex.ic.gov")}(e.Ex||(e.Ex={})),function(e){e.intelligenceStudioBaseUrl=new a.Url("https://make.powerapps.microsoft.scloud")}(e.Rx||(e.Rx={}))}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return p}));var r,o,i=n(0),a=n(93);!function(e){e[e.Production=0]="Production",e[e.Preview=1]="Preview"}(r||(r={})),function(e){e[e.Standard=0]="Standard",e[e.Premium=1]="Premium",e[e.Enterprise=2]="Enterprise"}(o||(o={}));var s=Object(i.HashTableUtility_create)({production:r.Production,preview:r.Preview});function c(e,t){if(!e)return t;var n=s[e.toLowerCase()];if(Object(i.isUndefined)(n))throw new a.InvalidJsonServerResponse("Invalid release status: "+e);return n}var u=Object(i.HashTableUtility_create)({standard:o.Standard,premium:o.Premium,enterprise:o.Enterprise});function p(e,t){if(!e)return t;var n=u[e.toLowerCase()];if(Object(i.isUndefined)(n))throw new a.InvalidJsonServerResponse("Invalid api tier: "+e);return n}},function(e,t,n){"use strict";n.r(t),n.d(t,"DelayedLoadingCdsObjectTType",(function(){return a}));n(0);var r=n(7),o=n(5),i=n(10),a=function(){function e(){this._parentDataSourceNames=[]}return Object.defineProperty(e.prototype,"ttype",{get:function(){return this._ttype},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return r.TTypeValueKind.CdsObject},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!!this._ttype&&this._ttype.isConvertFromDValueAsync},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ParentDataSourceNames",{get:function(){return this._parentDataSourceNames},enumerable:!1,configurable:!0}),e.prototype.addParentDataSourceName=function(e){e&&-1===this._parentDataSourceNames.indexOf(e)&&this._parentDataSourceNames.push(e)},Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this._ttype},enumerable:!1,configurable:!0}),e.prototype.setType=function(e){if(this._ttype)throw new Error("ttype is already set.");this._ttype=e},e.prototype.computeDValueSchema=function(e){return this._ttype?this._ttype.computeDValueSchema(e):{type:o.TypeUnknown}},e.prototype.convertFromDValue=function(e){if(this._ttype)return this._ttype.convertFromDValue(e)},e.prototype.convertToDValue=function(e,t){if(void 0===t&&(t=null),Object(i.isExpressionRuntime)(t)){if("string"==typeof e)return Object(i.makeODataEntityRecordPointer)(t);if(null===e)return null}if(this._ttype)return this._ttype.convertToDValue(e,t)},e}()},function(e,t,n){"use strict";var r;n.r(t),n.d(t,"BadEndpoints",(function(){return r})),function(e){e.getApiVersion=function(){return"2016-11-01"},e.providers="providers/Microsoft.BusinessAppDiscovery",e.apiVersionKey="api-version",e.apps="apps",e.powerAppsServiceName="Microsoft.PowerApps",e.modelAppsServiceName="Microsoft.CRM",e.paBadInvokeUrl="api/invoke",e.PowerAppsBadInvokeHeader="x-ms-path-query"}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"upsertAsync",(function(){return c})),n.d(t,"remove",(function(){return l})),n.d(t,"getLocalConnections",(function(){return m})),n.d(t,"sanitizeDependencies",(function(){return g})),n.d(t,"updateExecutionRestrictions",(function(){return v})),n.d(t,"isEndpointDlpEnabledForApi",(function(){return b})),n.d(t,"isSqlV2LocalConnection",(function(){return h})),n.d(t,"getEndpointsFromConnectionParameters",(function(){return A}));var r=n(0),o=n(32),i=n(76),a=n(2),s=n(6);function c(e,t,n,o){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(i){return[2,u(e,Object(r.HashTableUtility_create)(),t,n,o)]}))}))}function u(e,t,n,r,i){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(a){return e instanceof o.MsFlowCompositeConnection?[2,d(e,t,n,r,i)]:[2,p(e,t,n,r,i)]}))}))}function p(e,t,n,o,a){return __awaiter(this,void 0,Promise,(function(){var c,u,l,d,y,m=this;return __generator(this,(function(g){switch(g.label){case 0:if(r.CoreLog.verbose("LocalConnectionReferenceStoreUtility:upserting dependencies for connection: {0}",e.id),t[e.id])throw l=Object(r.CoreUtility_formatString)("LocalConnectionReferenceStoreUtility:circular dependency detected during upsert. Current: {0}, Visited: {1}",e.id,JSON.stringify(t)),r.CoreLog.error("LocalConnectionReferenceStoreUtility._upsert",l),new Error(l);if(!e.supports(s.d.Composite))return[2,f(e,n,o,a)];if(t[e.id]=!0,c=e.api.getConnectionParameters(),u=e.connectionParameters,Object(r.isUndefined)(c)||Object(r.isUndefined)(u))throw l=Object(r.CoreUtility_formatString)("LocalConnectionReferenceStoreUtility:missing parameters on connection or API. Connection: {0}, API: {1}",e.id,e.apiId),r.CoreLog.error("LocalConnectionReferenceStoreUtility._upsert",l),new Error(l);return d=Object(r.HashTableUtility_create)(),Object(r.forEach)(c,(function(t,n){if(t.type===s.r.Connection)if(Object(i.isFileSource)(u)){var a=u.fileSource.connectionId,c=o.tryGetCachedConnections()[a.toLowerCase()];if(Object(r.isUndefined)(c)){var p=Object(r.CoreUtility_formatString)("LocalConnectionReferenceStoreUtility:invalid parent connection ID. ParamId: {0}, ParentConnectionId: {1}",n,a);throw r.CoreLog.error("LocalConnectionReferenceStoreUtility._upsert",p),new Error(p)}d[n]=c}else r.CoreLog.error("LocalConnectionReferenceStoreUtility._upsert","Expected composite connection ".concat(e.id," to have connectionParameter property 'fileSource'."))})),[4,f(e,n,o,a)];case 1:return y=g.sent(),[4,Object(r.forEachAsync)(d,(function(e,i){return __awaiter(m,void 0,void 0,(function(){var a,s;return __generator(this,(function(c){switch(c.label){case 0:return[4,p(e,t,n,o)];case 1:if(a=c.sent(),Object(r.isDefined)(y.dependencies[i])&&y.dependencies[i]!==a.id)throw s=Object(r.CoreUtility_formatString)("LocalConnectionReferenceStoreUtility:duplicate connection dependency from {0} to {1}.",y.id,y.dependencies[i]),r.CoreLog.error("LocalConnectionReferenceStoreUtility._upsert",s),new Error(s);return y.dependencies[i]=a.id,a.dependents.indexOf(y.id)<0&&(a.dependents.push(y.id),n.update(a.id,a)),n.update(y.id,y),[2]}}))}))}))];case 2:return g.sent(),delete t[e.id],[2,y]}}))}))}function l(e,t){r.CoreLog.verbose("LocalConnectionReferenceStoreUtility:remove reference for referenceId: {0}",e),function e(t,n,o){r.CoreLog.verbose("LocalConnectionReferenceStoreUtility:remove composite reference for referenceId: {0}",t),n[t]=!0;var i=o.get(t);Object(r.forEach)(i.dependencies,(function(t){var r=o.tryGet(t);if(r){var a=r.dependents.indexOf(i.id);a<0||(r.dependents.splice(a,1),0===r.dataSources.length&&0===r.dependents.length&&e(r.id,n,o))}})),delete n[t],o.delete(t)}(e,Object(r.HashTableUtility_create)(),t)}function d(e,t,n,s,c){return __awaiter(this,void 0,Promise,(function(){var p,l,d,y,m,g=this;return __generator(this,(function(v){switch(v.label){case 0:if(r.CoreLog.verbose("LocalConnectionReferenceStoreUtility:upserting dynamic dependencies for connection: {0}",e.id),t[e.id])throw p=Object(r.CoreUtility_formatString)("LocalConnectionReferenceStoreUtility:circular dependency detected during upsertCompositeWithDynamicDependencies. Current: {0}, Visited: {1}",e.id,JSON.stringify(t)),r.CoreLog.error("LocalConnectionReferenceStoreUtility._upsertCompositeWithDynamicDependencies",p),new Error(p);return t[e.id]=!0,l=s.tryGetCachedConnections(),d=function e(t,n){var i=Object(r.HashTableUtility_create)();return Object(r.forEach)(t.dependentConnectionIds,(function(a,s){var c=n[a.toLowerCase()];if(!c){var u=Object(r.CoreUtility_formatString)("LocalConnectionReferenceStoreUtility: Parent connection {0} is no longer available for {1}.",a,t.id);throw r.CoreLog.error("LocalConnectionReferenceStoreUtility.validateAndGetParentConnections",u),new r.ApplicationError(u)}c instanceof o.CompositeConnection&&e(c,n),i[s]=c})),i}(e,l),[4,f(e,n,s,c)];case 1:return y=v.sent(),Object(i.isMsFlow)(e.connectionParameters)&&(y.connectionRef.parameterHints||(y.connectionRef.parameterHints={}),y.connectionRef.parameterHints[a.ParameterHintNames.msFlowWorkflowName]={value:e.connectionParameters.workflowName},y.connectionRef.parameterHints[a.ParameterHintNames.msWorkflowEntityId]={value:e.connectionParameters.workflowEntityId},y.connectionRef.parameterHintsV2||(y.connectionRef.parameterHintsV2={}),y.connectionRef.parameterHintsV2[a.ParameterHintNames.msFlowWorkflowName]={value:e.connectionParameters.workflowName},y.connectionRef.parameterHintsV2[a.ParameterHintNames.msWorkflowEntityId]={value:e.connectionParameters.workflowEntityId},!r.FallbackSwitch.isActivated("AppConnectivity.ShowFlowDisplayNameWhileAppSharing")&&(m=e.displayName,y.connectionRef.parameterHints[a.ParameterHintNames.msWorkflowDisplayName]={value:m},y.connectionRef.parameterHintsV2[a.ParameterHintNames.msWorkflowDisplayName]={value:m})),[4,Object(r.forEachAsync)(d,(function(o,a){return __awaiter(g,void 0,void 0,(function(){var c,p,l;return __generator(this,(function(d){switch(d.label){case 0:return c="",Object(i.isMsFlow)(e.connectionParameters)&&(c=Object(r.tryGetValueIgnoreCase)(y.dependencies,a)),[4,u(o,t,n,s,c)];case 1:if(p=d.sent(),Object(r.isDefined)(y.dependencies[a])&&y.dependencies[a]!==p.id)throw l=Object(r.CoreUtility_formatString)("LocalConnectionReferenceStoreUtility: duplicate dynamic connection dependency from {0} to {1}.",y.id,y.dependencies[a]),r.CoreLog.error("LocalConnectionReferenceStoreUtility._upsertCompositeWithDynamicDependencies",l),new Error(l);return y.dependencies[a]=p.id,p.dependents.indexOf(y.id)<0&&(p.dependents.push(y.id),n.update(p.id,p)),n.update(y.id,y),[2]}}))}))}))];case 2:return v.sent(),delete t[e.id],[2,y]}}))}))}function f(e,t,n,o){return __awaiter(this,void 0,Promise,(function(){var i,a,s,c,u;return __generator(this,(function(p){switch(p.label){case 0:if(r.CoreLog.verbose("LocalConnectionReferenceStoreUtility:upsert reference to connection {0}",e.id),i=e,!e.isShareable||e.createdXrmConnectionReferenceLogicalName||e.xrmConnectionReferenceLogicalName)return[3,4];p.label=1;case 1:return p.trys.push([1,3,,4]),[4,n.updateXrmConnectionReference(e.id,e.api)];case 2:return i=p.sent()||e,[3,4];case 3:return a=p.sent(),r.CoreLog.errorEx("LocalConnectionReferenceStoreUtility.upsertSingle","Could not get connection from server to determine xrmLogicalConnectionRefName.",a),[3,4];case 4:if(s=t.getAll(),o)for(c=0,u=s.length;c<u;c++)if(Object(r.equalsIgnoreCase)(s[c].connectionInstanceId,i.id)&&Object(r.equalsIgnoreCase)(s[c].id,o))return[2,s[c]];for(c=0,u=s.length;c<u;c++)if(Object(r.equalsIgnoreCase)(s[c].connectionInstanceId,i.id))return[2,s[c]];return[2,y(i,t,o)]}}))}))}function y(e,t,n){var o;r.CoreLog.verbose("LocalConnectionReferenceStoreUtility:insert reference to connection {0}",e.id),n&&!t.tryGet(n)||(n=Object(r.generate128BitUUID)());var i={connectionRef:{displayName:e.api.displayName,iconUri:e.iconUri,id:e.apiId},dataSources:[],dependencies:Object(r.HashTableUtility_create)(),dependents:[],datasets:Object(r.HashTableUtility_create)(),id:n,connectionInstanceId:e.id};b(i.connectionRef.id)&&(i.endpoints=A(i,Object(r.convertUnsafeHashTableToStringHashTable)(e.connectionParameters))),e.isShareable?(i.connectionRef.sharedConnectionId=e.id,i.connectionRef.xrmConnectionReferenceLogicalName=null!==(o=e.xrmConnectionReferenceLogicalName)&&void 0!==o?o:e.createdXrmConnectionReferenceLogicalName):i.connectionRef.xrmConnectionReferenceLogicalName=null;var a=s.t.tryGetGatewayObjectId(e);return a&&(i.connectionRef.gatewayObjectIdHint=a),i.connectionRef.isOnPremiseConnection=e.isOnPremise,e.multiAuthParametersSetName&&(i.connectionRef.authenticationType=e.multiAuthParametersSetName),t.add(n,i),i}function m(e,t){var n=[];return Object(r.forEach)(e,(function(e,r){var o=null;t[r]&&(o=t[r].id);var i={dependents:e.dependents,dependencies:e.dependencies,dataSources:e.dataSources,datasets:e.datasets,dataSourceAppMappings:e.dataSourceAppMappings,connectionRef:{apiTier:e.apiTier,authenticationType:e.authenticationType,bypassConsent:e.bypassConsent,displayName:e.displayName,executionRestrictions:e.executionRestrictions,gatewayObjectIdHint:e.gatewayObjectIdHint,iconUri:e.iconUri,id:e.id,isCustomApiConnection:!!e.isCustomApiConnection,isOnPremiseConnection:!!e.isOnPremiseConnection,parameterHints:e.parameterHints,parameterHintsV2:e.parameterHintsV2,resourceIdentifier:e.resourceIdentifier,runtimePolicyName:e.runtimePolicyName,sharedConnectionId:e.sharedConnectionId,xrmConnectionReferenceLogicalName:e.xrmConnectionReferenceLogicalName},id:r,connectionInstanceId:o,endpoints:e.endpoints,appActions:e.appActions};n.push(i)})),n}function g(e){e.getAll().forEach((function(t){var n;if(Object(r.forEach)(t.dependencies,(function(n){var o=e.tryGet(n);if(o){if(!o.dependents||-1===o.dependents.indexOf(t.id)){var i=Object(r.CoreUtility_formatString)("LocalConnectionReferenceStoreUtility: Connection {0} was not marked as dependent for {1}.",t.id,n);r.CoreLog.warningEx("LocalConnectionReferenceStoreUtility.sanitizeDependencies",i),o.dependents=o.dependents?o.dependents.concat(t.id):[t.id],e.update(o.id,o)}}else{var a=Object(r.CoreUtility_formatString)("LocalConnectionReferenceStoreUtility: Connection dependency {0} is no longer available for {1}.",n,t.id);r.CoreLog.errorEx("LocalConnectionReferenceStoreUtility.sanitizeDependencies",a)}})),(null===(n=t.dependents)||void 0===n?void 0:n.length)>0){var o=!1;__spreadArray([],t.dependents,!0).forEach((function(n){if(!e.tryGet(n)){var i=Object(r.CoreUtility_formatString)("LocalConnectionReferenceStoreUtility: Connection {0} had stale dependent {1}.",t.id,n);r.CoreLog.warningEx("LocalConnectionReferenceStoreUtility.sanitizeDependencies",i),t.dependents.splice(t.dependents.indexOf(n),1),o=!0}})),o&&e.update(t.id,t)}}))}function v(e,t,n){var r=e.get(t);r.connectionRef.executionRestrictions=n,e.update(r.id,r)}function b(e){return Object(r.equalsIgnoreCase)(e,AppMagic.ConnectionHub.Constants.ApiIds.Sql)||Object(r.equalsIgnoreCase)(e,AppMagic.ConnectionHub.Constants.ApiIds.Smtp)||Object(r.equalsIgnoreCase)(e,AppMagic.ConnectionHub.Constants.ApiIds.Azureblob)||Object(r.equalsIgnoreCase)(e,AppMagic.ConnectionHub.Constants.ApiIds.HttpAzureAD)}function h(e){if(!e||!e.connectionRef)return!1;if(!AppMagic.ConnectionHub.PowerAppsConnectionService.isSqlApi(e.connectionRef.id))return!1;var t=!1;return!e.datasets||Object(r.HashTableUtility_isEmpty)(e.datasets)||Object(r.every)(e.datasets,(function(e,t){return"default"===t}))||(t=!0),t}function A(e,t){var n;switch(null===(n=e.connectionRef)||void 0===n?void 0:n.id){case AppMagic.ConnectionHub.Constants.ApiIds.Sql:return!h(e)&&(null==t?void 0:t.server)&&(null==t?void 0:t.database)?["".concat(t.server,",").concat(t.database)]:e.datasets&&Object.keys(e.datasets);case AppMagic.ConnectionHub.Constants.ApiIds.Smtp:if((null==t?void 0:t.serverAddress)&&(null==t?void 0:t.port))return["".concat(t.serverAddress,",").concat(t.port)];break;case AppMagic.ConnectionHub.Constants.ApiIds.Azureblob:if(null==t?void 0:t.accountName)return["".concat(t.accountName)];break;case AppMagic.ConnectionHub.Constants.ApiIds.HttpAzureAD:if(null==t?void 0:t.baseResourceUrl)return["".concat(t.baseResourceUrl)]}}},function(e,t,n){"use strict";n.r(t),n.d(t,"CdsEndpoints",(function(){return r})),n.d(t,"CdsTableTypes",(function(){return o}));var r,o,i=n(0);!function(e){function t(){return"2016-11-01"}e.getApiVersion=t,function(e){e.getApiVersionValue=function(){return t()},e.getBaseUrl=function(){return new i.Core_Url("https://api.cds.microsoft.com")}}(e.Prod||(e.Prod={})),function(e){e.getApiVersionValue=function(){return t()},e.getBaseUrl=function(){return new i.Core_Url("https://tip1.api.cds.microsoft.com")}}(e.Test||(e.Test={})),function(e){e.getApiVersionValue=function(){return t()},e.getBaseUrl=function(){return new i.Core_Url("https://tip2.api.cds.microsoft.com")}}(e.Tip2||(e.Tip2={})),e.providers="providers/Microsoft.CommonDataModel",e.apiVersionKey="api-version",e.namespacesPath="namespaces"}(r||(r={})),function(e){e.Elastic="Elastic"}(o||(o={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"CdsComponentIdentifierType",(function(){return r})),n.d(t,"IPowerAppsClientSingletonKey",(function(){return i}));var r,o=n(0);!function(e){e[e.LogicalName=0]="LogicalName",e[e.UniqueId=1]="UniqueId"}(r||(r={}));var i=Object(o.createForInterface)("AppMagic.PowerApps.IPowerAppsClient")},function(e,t,n){"use strict";n.r(t),n.d(t,"XsdTypeNames",(function(){return r})),n.d(t,"tryParseNumericXsdTypeFromXsdTypeName",(function(){return i})),n.d(t,"coerceNumberToXsdNumericType",(function(){return a}));n(0);var r,o=n(7);function i(e){switch(e){case r.Decimal:return o.NumericXsdType.Decimal;case r.Float:return o.NumericXsdType.Float;case r.Double:return o.NumericXsdType.Double;case r.Int:return o.NumericXsdType.Int;case r.Long:return o.NumericXsdType.Long;case r.UnsignedInt:return o.NumericXsdType.UnsignedInt;case r.UnsignedLong:return o.NumericXsdType.UnsignedLong;default:return null}}function a(e,t){switch(t){case o.NumericXsdType.Decimal:case o.NumericXsdType.Float:case o.NumericXsdType.Double:return e;case o.NumericXsdType.Int:case o.NumericXsdType.Long:return e>0?Math.floor(e):Math.ceil(e);case o.NumericXsdType.UnsignedInt:case o.NumericXsdType.UnsignedLong:return Math.abs(e>0?Math.floor(e):Math.ceil(e))}}!function(e){e.Boolean="boolean",e.Int="int",e.Long="long",e.UnsignedInt="unsignedInt",e.UnsignedLong="unsignedLong",e.Decimal="decimal",e.Float="float",e.Double="double",e.String="string",e.Base64Binary="base64Binary",e.HexBinary="hexBinary",e.AnyURI="anyURI",e.DateTime="dateTime",e.Date="date"}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"FileNameHeader",(function(){return r})),n.d(t,"TempFileUrl",(function(){return o})),n.d(t,"DataSourceType",(function(){return i}));var r="x-ms-file-name",o="http://temp.url",i={CDS:"cds",Sharepoint:AppMagic.ConnectionHub.Constants.ApiIds.SharepointOnline}},function(e,t,n){"use strict";n.r(t),n.d(t,"optionSetConvertFromDValue",(function(){return i})),n.d(t,"optionSetMultiSelectFromDValue",(function(){return a})),n.d(t,"convertToCdsOptionSetReference",(function(){return s}));var r=n(0),o=n(77);function i(e){return null==e?null:e.Id}function a(e,t){if(null==e)return null;var n=[];return e.forEach((function(e){if(e){var o=t.convertFromDValue(e.Value);Object(r.isDefined)(o)&&n.push(o)}})),0===n.length?null:n.join(",")}function s(e,t,n,r){var i=e+"_"+t+"_"+n;return o.CdsOptionSetTType.prototype.hasOwnProperty(i)||(o.CdsOptionSetTType.prototype[i]={Id:n,Value:r}),o.CdsOptionSetTType.prototype[i]}},function(e,t,n){"use strict";n.r(t),n.d(t,"ConnectionErrorSource",(function(){return r})),n.d(t,"ConnectionError",(function(){return c}));var r,o=n(0),i=n(9),a=n(35),s=n(69);!function(e){e[e.PutConnection=0]="PutConnection",e[e.TestConnection=1]="TestConnection",e[e.FindParentConnection=2]="FindParentConnection"}(r||(r={}));var c=function(e){function t(t,n,r){var o=e.call(this,t,r)||this;return o._source=n,o}return __extends(t,e),Object.defineProperty(t.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),t.createConnectionError=function(e,n,r,o){if(e instanceof t)return e;var i,c=t._tryGetConnectionLimitErrorMessage(e,o);return i=c?{response:Object(a.errorHasHttpResponse)(e)?e.response:null,serviceType:r,suggestedErrorMessage:{message:c},diagnosticMessage:null}:s.ServiceError.createServiceErrorParams(e,r),new t(e.message,n,i)},t._tryGetConnectionLimitErrorMessage=function(e,t){var n=Object(o.tryParseJson)(e.message);if(n&&n.error&&(n.error.code===i.ErrorCode.ApiConnectionLimitExceeded||n.error.code===i.ErrorCode.PlanApiConnectionLimitExceeded)){var r=t.tryGetConnectionsLimit();return null!==r?Object(o.CoreUtility_formatString)(AppMagic.Strings.ConnectionHubApiConnectionLimitExceededDetailedErrorDescription,r,t.displayName):Object(o.CoreUtility_formatString)(AppMagic.Strings.ConnectionHubApiConnectionLimitExceededErrorDescription,t.displayName)}return null},t}(s.ServiceError)},function(e,t,n){},function(e,t,n){"use strict";n.r(t),n.d(t,"NpsUrlOrigin",(function(){return s})),n.d(t,"NpsUrlOriginForTest",(function(){return c})),n.d(t,"NpsService",(function(){return u}));var r=n(0),o=n(1),i=n(3),a=n(39),s=function(){var e;return"eu"===(null===(e=Object(r.getTelemetryConfig)())||void 0===e?void 0:e.telemetryLocation)?"https://europe.ces.microsoftcloud.com":"https://world.ces.microsoftcloud.com"}(),c=function(){var e;return"eu"===(null===(e=Object(r.getTelemetryConfig)())||void 0===e?void 0:e.telemetryLocation)?"https://europe.tip1.ces.microsoftcloud.com":"https://world.tip1.ces.microsoftcloud.com"}(),u=function(){function e(e,t){this._identityService=e,this._httpClient=t}return e.prototype.shouldDisplayDialogAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var n,c,u;return __generator(this,(function(p){switch(p.label){case 0:return(n=new r.UrlBuilder(s)).appendPath("display"),n.appendPath(e),n.setQueryParam("puid",this._identityService.identity.objectId),t&&n.setQueryParam("custom",JSON.stringify(t)),[4,this._httpClient.sendHttpJsonResponseAsync({url:n.toString(),method:i.Method.GET})];case 1:if(c=p.sent(),!(u=o.dg.safeCast(c)))throw new a.SafeCastError("Service.NpsPromptResponse");return[2,u.display]}}))}))},e.prototype.getDisplayUrlAsync=function(e,t,n){return void 0===t&&(t=""),__awaiter(this,void 0,Promise,(function(){var o;return __generator(this,(function(i){return(o=new r.UrlBuilder(s)).appendPath("render"),o.appendPath(e),o.setQueryParam("culture",Core.Globalization.currentCulture().language),o.setQueryParam("puid",this._identityService.identity.objectId),t&&o.setQueryParam("client",t),n&&o.setQueryParam("custom",JSON.stringify(n)),[2,o.toString()]}))}))},e.prototype.getNpsDialogUrlIfNeededAsync=function(e,t,n){var o,i;return __awaiter(this,void 0,Promise,(function(){var a,s,c,u,p,l,d;return __generator(this,(function(f){switch(f.label){case 0:return f.trys.push([0,4,,5]),s=new r.UrlBuilder(window.location.href),c=null===(o=null==s?void 0:s.toUrl())||void 0===o?void 0:o.getQueryParamFirstValue("forceCsatPrompt"),null===(i=c&&"true"===c)||void 0===i?[3,1]:(u=i,[3,3]);case 1:return[4,this.shouldDisplayDialogAsync(e,n)];case 2:u=f.sent(),f.label=3;case 3:return a=u,[3,5];case 4:return p=f.sent(),r.CoreLog.error("NpsDialogViewModel.shouldDisplayDialogAsync",{name:p.name,stack:Object(r.scrubSensitiveDataSafe)(p.stack),message:Object(r.scrubSensitiveDataSafe)(p.stack)}),[2];case 5:return a?[4,Object(r.timeout)(t)]:[2];case 6:f.sent(),f.label=7;case 7:return f.trys.push([7,9,,10]),[4,this.getDisplayUrlAsync(e,null,n)];case 8:return[2,null!=(l=f.sent())?l:""];case 9:return d=f.sent(),r.CoreLog.error("NpsDialogViewModel.getDisplayUrlAsync",d),[3,10];case 10:return[2]}}))}))},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"DatabaseReferencesManager",(function(){return a}));var r=n(0),o=n(54),i=n(9),a=function(){function e(e){this._appResourcesPromise=e,this._databaseReferences=new r.Lazy((function(){return Object(r.HashTableUtility_create)()})),this._dynamicResourceConfigs=new r.Lazy((function(){return Object(r.HashTableUtility_create)()})),this._isAppResourcePromiseResolved=!1}return e.prototype.getReferencesAsync=function(e){var t;return __awaiter(this,void 0,Promise,(function(){var e,n;return __generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),!this._appResourcesPromise||this._isAppResourcePromiseResolved?[3,2]:[4,this._appResourcesPromise];case 1:e=o.sent(),this._isAppResourcePromiseResolved=!0,(null===(t=null==e?void 0:e.appInfo)||void 0===t?void 0:t.databaseReferences)&&this.restoreFromServerDatabaseReferences(e.appInfo.databaseReferences),o.label=2;case 2:return[3,4];case 3:return n=o.sent(),r.CoreLog.errorEx("DatabaseReferencesManager.getReferencesAsync","Fetching app resources failed with error: ",{error:n}),[3,4];case 4:return[2,this._databaseReferences.value]}}))}))},e.prototype.hasValues=function(){return this._databaseReferences.isValueCreated&&!Object(r.HashTableUtility_isEmpty)(this._databaseReferences.value)},e.prototype.upsert=function(e){this._databaseReferences.value[e.datasetName]||(this._databaseReferences.value[e.datasetName]={state:"Configured",instanceUrl:e.instanceUrl,webApiVersion:AppMagic.PowerApps.Constants.CdsDefaultWebApiVersion,dataSources:Object(r.HashTableUtility_create)(),version:e.version,environmentVariableName:e.environmentVariableName},this._upsertDynamicResourceConfig(e.datasetName,e.instanceUrl)),this._databaseReferences.value[e.datasetName].dataSources[e.dataSourceName]={entitySetName:e.entitySetName,logicalName:e.logicalName}},e.prototype.upsertAppDependency=function(e){this._databaseReferences.value[e.datasetName]||(this._databaseReferences.value[e.datasetName]={state:"Configured",instanceUrl:e.instanceUrl,webApiVersion:AppMagic.PowerApps.Constants.CdsDefaultWebApiVersion,dataSources:Object(r.HashTableUtility_create)(),components:new Array},this._upsertDynamicResourceConfig(e.datasetName,e.instanceUrl)),this._databaseReferences.value[e.datasetName].components||(this._databaseReferences.value[e.datasetName].components=new Array);var t=this._databaseReferences.value[e.datasetName].components;t.find((function(t){return t.componentName===e.componentName&&t.identifier===e.identifier&&t.identifierType===e.identifierType}))||t.push({componentName:e.componentName,identifier:e.identifier,identifierType:e.identifierType})},e.prototype.removeAppDependency=function(e){var t,n=this._databaseReferences.value[e.datasetName],o=null==n?void 0:n.components,i=null!==(t=null==o?void 0:o.findIndex((function(t){return t.componentName===e.componentName&&t.identifier===e.identifier&&t.identifierType===e.identifierType})))&&void 0!==t?t:-1;i>-1&&o.splice(i,1),!Object(r.HashTableUtility_isEmpty)(n.dataSources)||n.components&&0!=n.components.length||(delete this._databaseReferences.value[e.datasetName],delete this._dynamicResourceConfigs.value[e.datasetName])},e.prototype.removeDataSource=function(e,t){var n=Object(r.filter)(this._databaseReferences.value,(function(t){return Object(r.isObject)(t.dataSources[e])})),o=Object(r.toKeyValuePairArray)(n),a=o[0].value,s=o[0].key;e==i.CurrentEnvironmentLogicalName&&t!=s||(delete a.dataSources[e],!Object(r.HashTableUtility_isEmpty)(a.dataSources)||a.components&&0!=a.components.length||(delete this._databaseReferences.value[s],delete this._dynamicResourceConfigs.value[s]))},e.prototype.getDynamicResourceConfigsAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getReferencesAsync()];case 1:return e.sent(),[2,this._dynamicResourceConfigs.value]}}))}))},e.prototype.restoreFromServerDatabaseReferences=function(e,t){this._databaseReferences=this._restoreFromServerDatabaseReferences(e,this._appResourcesPromise,this._isAppResourcePromiseResolved)},e.prototype._restoreFromServerDatabaseReferences=function(e,t,n){var o=this,i=new r.Lazy((function(){return Object(r.HashTableUtility_create)()}));return Object(r.forEach)(e,(function(e){var a,s,c,u,p;if(!e.databaseDetails.linkedEnvironmentMetadata)return r.CoreLog.error("DatabaseReferencesManager.restoreFromServerDatabaseReferences","Missing linkedEnvironmentMetadata for environment name ".concat(e.databaseDetails.environmentName)),t&&!n&&r.Log.trackActivityEvent("DatabaseReferencesManager.restoreFromServerDatabaseReferences",{message:"linkedEnvironmentMetadata might get restored after appResourcePromise gets resolved."}),i.value[e.databaseDetails.environmentName]={state:"NotConfigured",instanceUrl:null,webApiVersion:null,dataSources:null!==(a=e.dataSources)&&void 0!==a?a:Object(r.HashTableUtility_create)(),environmentVariableName:null===(s=e.databaseDetails.overrideValues)||void 0===s?void 0:s.environmentVariableName},void((null===(c=e.components)||void 0===c?void 0:c.length)>0&&(i.value[e.databaseDetails.environmentName].components=e.components));var l=e.databaseDetails.linkedEnvironmentMetadata.instanceUrl;i.value[e.databaseDetails.environmentName]={state:"Configured",instanceUrl:l,webApiVersion:AppMagic.PowerApps.Constants.CdsDefaultWebApiVersion,dataSources:null!==(u=e.dataSources)&&void 0!==u?u:Object(r.HashTableUtility_create)(),version:e.databaseDetails.linkedEnvironmentMetadata.version,environmentVariableName:null===(p=e.databaseDetails.overrideValues)||void 0===p?void 0:p.environmentVariableName},e.components&&(i.value[e.databaseDetails.environmentName].components=e.components),o._upsertDynamicResourceConfig(e.databaseDetails.environmentName,l)})),i},e.prototype.updateInstanceUrl=function(e,t){this._databaseReferences.value[e]?(this._databaseReferences.value[e].instanceUrl=t,this._upsertDynamicResourceConfig(e,t,!0)):r.CoreLog.errorEx("DatabaseReferenceManager.updateInstanceUrl","Attempted to update instanceUrl for ".concat(e," but no reference was found."))},e.prototype._upsertDynamicResourceConfig=function(e,t,n){void 0===n&&(n=!1),!n&&this._dynamicResourceConfigs.value[e]||(this._dynamicResourceConfigs.value[e]={resource:t,url:new r.Core_Url(t)})},e.prototype.toServerDatabaseReferences=function(){var e=Object(r.HashTableUtility_create)();return Object(r.forEach)(this._databaseReferences.value,(function(t,n){e[n]={databaseDetails:{environmentName:n,overrideValues:{environmentVariableName:t.environmentVariableName}},dataSources:t.dataSources},t.components&&t.components.length>0&&(e[n].components=t.components)})),e},e.prototype.deserializeAsync=function(e,t,n){return void 0===n&&(n=!1),__awaiter(this,void 0,Promise,(function(){var o,i,a,s=this;return __generator(this,(function(c){switch(c.label){case 0:return n&&(this._databaseReferences=new r.Lazy((function(){return Object(r.HashTableUtility_create)()})),this._dynamicResourceConfigs=new r.Lazy((function(){return Object(r.HashTableUtility_create)()}))),Object(r.isNonEmptyNonWhitespaceString)(t)?(o=Object(r.tryParseJson)(t))?(i=Object(r.fromJsonObject)(o),Object(r.HashTableUtility_isEmpty)(i)?[2]:[4,e()]):(r.CoreLog.error("DatabaseReferenceManager.deserialize","Invalid database references json received to deserialize"),[2]):[2];case 1:return a=c.sent(),Object(r.forEach)(i,(function(e,t){s._databaseReferences.value[t]=e,t===AppMagic.ConnectionHub.Constants.CdsDefaultDatasetName?a.properties.linkedEnvironmentMetadata?(e.instanceUrl=a.properties.linkedEnvironmentMetadata.instanceUrl,e.webApiVersion=AppMagic.PowerApps.Constants.CdsDefaultWebApiVersion,e.state="Configured"):(r.CoreLog.error("DatabaseReferencesManager.deserialize","Missing linkedEnvironmentMetadata for current environment with name: ".concat(a.name)),e.instanceUrl=null,e.webApiVersion=null,e.state="NotConfigured"):e.state="Configured",r.controls.componentsInDatabaseReference&&s._updateComponentInterface(e),"Configured"===e.state&&s._upsertDynamicResourceConfig(t,e.instanceUrl)})),[2]}}))}))},e.prototype._updateComponentInterface=function(e){if(e.components)for(var t=0,n=e.components;t<n.length;t++){var r=n[t];if(null!=r){var i=r;null!=i.ComponentName&&(r.componentName=i.ComponentName,delete i.ComponentName),null!=i.Identifier&&(r.identifier=i.Identifier,delete i.Identifier),null!=i.IdentifierType&&(r.identifierType=i.IdentifierType,delete i.IdentifierType),"number"==typeof r.identifierType&&(r.identifierType=o.CdsComponentIdentifierType[r.identifierType])}}},e.prototype.serialize=function(){return this._databaseReferences.isValueCreated?JSON.stringify(this._databaseReferences.value):""},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n(0),n(31);function r(e,t){return{type:e,value:t}}},function(e,t,n){"use strict";n.r(t),n.d(t,"CdsUtility",(function(){return s}));var r=n(0),o=n(16),i=n(53),a=n(17),s=function(){function e(){}return e.getBaseUrl=function(){return o.Region.getCurrentRegion().cdsBaseUrl},e.getApiVersion=function(){return o.Region.getCurrentRegion().cdsApiVersion},e.createCdsProviderUrlBuilder=function(t){void 0===t&&(t=!1);var n=t?new r.UrlBuilder("/"):new r.UrlBuilder(e.getBaseUrl());return n.appendPath(i.CdsEndpoints.providers),n},e.buildCdsHttpRequestUrl=function(e,t,n){var o=new r.UrlTemplate("{resourceUrl}/api/data/{webApiVersion}/{endpoint}");return decodeURIComponent(o.expandUrlString({resourceUrl:e,webApiVersion:t,endpoint:n}))},e.buildCdsHttpRequestParameters=function(e,t,n,o,i){var s=Object(r.HashTableUtility_create)();s["Content-Type"]="application/json",i&&(s["MSCRM.SolutionUniqueName"]=i);var c={url:e,method:n,headers:s};return o&&(c.bodyData=o),AppMagic.Runtime.Client.addAuthorizationOptions(c.headers,{resource:t,isDynamicResource:!0}),Object(a.appendCustomHeadersOptions)(c,{optInMSHeaders:!0}),c},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"SendHttpResponse",(function(){return r}));var r,o=n(0),i=n(23),a=n(11);!function(e){function t(e){return Object(o.isObject)(e)&&Object(o.isNumber)(e.status)&&Object(o.isHashTable)(e.headers)&&i.ResponseTypes.isValid(e.responseType)&&(e.responseType===i.ResponseTypes.Text&&"string"==typeof e.responseText&&"string"==typeof e.response&&e.response===e.responseText||e.responseType!==i.ResponseTypes.Text&&void 0===e.responseText&&(Object(o.isNullOrUndefined)(e.response)||function(e){var t=Object(a.tryGetMimeTypeFromRequestOrResponse)(e);switch(e.responseType){case"arraybuffer":return Object(o.isArrayBuffer)(e.response);case"blob":return Object(o.isBlob)(e.response);case"json":return void 0!==e.response;case"pabinary":return Object(o.isPABinary)(e.response)&&e.response.source.sourceType!==o.BinarySourceType.Invalid&&!!e.response.contentType&&(!t||t===Object(o.tryExtractMimeTypeFromMediaType)(e.response.contentType));default:return!1}}(e)))&&(void 0===e.responseSize||"number"==typeof e.responseSize)&&(void 0===e.duration||"number"==typeof e.duration)&&(void 0===e.batchCount||"number"==typeof e.batchCount)&&(void 0===e.performanceInformation||"object"==typeof e.performanceInformation)&&(void 0===e.throttleDuration||"number"==typeof e.throttleDuration)&&(void 0===e.requestRetryInfo||"object"==typeof e.requestRetryInfo)}e.safeCast=function(e){return t(e)?e:null},e.isValid=t}(r||(r={}))},function(e,t,n){"use strict";var r,o,i;n.r(t),n.d(t,"PresentUserStatus",(function(){return r})),n.d(t,"RPSessionResourceTypes",(function(){return o})),n.d(t,"RPSessionType",(function(){return i})),function(e){e.Active="Active",e.Inactive="Inactive"}(r||(r={})),function(e){e.App="App"}(o||(o={})),function(e){e.Writer="Writer",e.Reader="Reader"}(i||(i={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"InlinedTTypeRef",(function(){return r})),n.d(t,"LazyTTypeRef",(function(){return o}));n(0);var r=function(){function e(e){this._ttype=e}return e.prototype.getType=function(){return this._ttype},e}(),o=function(){function e(e,t){this._ttype=null,this._typeRef=e,this._typesMgr=t}return e.prototype.getType=function(){return null===this._ttype&&(this._ttype=this._typesMgr.getType(this._typeRef.prefix,this._typeRef.name)),this._ttype},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"BapUtility",(function(){return a}));var r=n(0),o=n(16),i=n(22),a=function(){function e(){}return e.getBaseUrl=function(){return o.Region.getCurrentRegion().bapBaseUrl},e.getApiVersion=function(){return o.Region.getCurrentRegion().bapApiVersion},e.createBapProviderUrlBuilder=function(t){void 0===t&&(t=!1);var n=t?new r.UrlBuilder("/"):new r.UrlBuilder(e.getBaseUrl());return n.appendPath(i.BapEndpoints.providers),n},e}()},function(e,t,n){"use strict";var r;n.d(t,"g",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"a",(function(){return i})),function(e){e[e.SelectDevice=0]="SelectDevice",e[e.SelectAppID=1]="SelectAppID"}(r||(r={}));var o="DeviceID",i="IoTCentralApplicationID"},function(e,t,n){"use strict";n.r(t),n.d(t,"ServiceErrorName",(function(){return c})),n.d(t,"ServiceErrorCodes",(function(){return r})),n.d(t,"ServiceError",(function(){return u}));var r,o=n(0),i=n(1),a=n(35),s=(n(64),n(118)),c="AppMagic.Services.ServiceError";!function(e){e.ConnectionAuthorizationFailed="ConnectionAuthorizationFailed",e.FlowWadlConversionNotSupported="FlowWadlConversionNotSupported",e.MultipleErrorsOccurred="MultipleErrorsOccurred"}(r||(r={}));var u=function(e){function t(t,n){var r=e.call(this,t,c)||this;return r._response=n.response||null,r._serviceType=n.serviceType,Object(o.isDefined)(n.suggestedErrorMessage)&&(r._suggestedErrorMessage=n.suggestedErrorMessage),Object(o.isDefined)(n.diagnosticMessage)&&(r._diagnosticMessage=n.diagnosticMessage),"boolean"==typeof n.isOnline&&(r._isOnline=n.isOnline),r}return __extends(t,e),t.createServiceError=function(e,n){return e instanceof t?e:new t(e.message,t.createServiceErrorParams(e,n))},t.createServiceErrorParams=function(e,n){var r=Object(a.errorHasHttpResponse)(e)?e.response:null;return{response:r,serviceType:n,suggestedErrorMessage:t._tryGetSuggestedErrorMessage(r,n),diagnosticMessage:t._tryGetDiagnosticMessage(r),isOnline:e&&"boolean"==typeof e.isOnline?e.isOnline:null}},t._tryGetSuggestedErrorMessage=function(e,t){return Object(s.tryMapErrorResponse)(e,t)},t._tryGetDiagnosticMessage=function(e){if(e&&e.responseText){var t=Object(o.tryParseJson)(e.responseText);if(t){var n=i.yg.safeCast(t);if(n)return n.error.message;var r=i.X.safeCast(t);if(r)return r.message}}return null},Object.defineProperty(t.prototype,"response",{get:function(){return this._response},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serviceType",{get:function(){return this._serviceType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isOnline",{get:function(){return this._isOnline},enumerable:!1,configurable:!0}),t.prototype.toSuggestedErrorMessage=function(){return Object(o.isDefined)(this._suggestedErrorMessage)||(this._suggestedErrorMessage=t._tryGetSuggestedErrorMessage(this._response,this._serviceType)),this._suggestedErrorMessage},t.prototype.toDiagnosticMessage=function(){return Object(o.isDefined)(this._diagnosticMessage)||(this._diagnosticMessage=t._tryGetDiagnosticMessage(this._response)),this._diagnosticMessage},t.prototype.getTelemetryData=function(){return"boolean"==typeof this._isOnline?{isOnline:this._isOnline}:null},t}(Core.ApplicationError)},function(e,t,n){"use strict";n.r(t),n.d(t,"JsonWebToken",(function(){return i}));var r=n(0);function o(e){if(Object(r.isEmptyString)(e))return null;var t=Object(r.tryDecodeBase64String)(e);if(!t)throw new Error("Failed to decode the JwtSegment.");return JSON.parse(t)}var i=function(){function e(e){if(!e)throw Error("token must be a valid string.");var t=e.split(".");if(3!==t.length)throw Error("token has an invalid number of segments.");this._header=o(t[0]),this._payload=o(t[1])}return e.tryParse=function(t){if(!t)return null;try{return new e(t)}catch(e){return r.CoreLog.error("JsonWebToken.tryParse",e),null}},e.parse=function(t){return new e(t)},Object.defineProperty(e.prototype,"header",{get:function(){return this._header},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"payload",{get:function(){return this._payload},enumerable:!1,configurable:!0}),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"SendHttpErrorWithResponse",(function(){return o}));var r=n(0),o=function(e){function t(t,n,r){var o=this;return(o=e.call(this,t,r)||this)._response=n,o}return __extends(t,e),Object.defineProperty(t.prototype,"response",{get:function(){return this._response},enumerable:!1,configurable:!0}),t.prototype.toDiagnosticMessage=function(){return Object(r.isString)(this._response.responseText)?this._response.responseText:null},t}(n(82).SendHttpError)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u}));var r=n(0),o=n(39),i=n(1),a=function(){function e(e,t,n){this._connection=t,this._reference=e,this._appActions=n}return Object.defineProperty(e.prototype,"cacheItemId",{get:function(){return this._reference},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connection",{get:function(){return this._connection},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appActions",{get:function(){return this._appActions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reference",{get:function(){return this._reference},enumerable:!1,configurable:!0}),e.deserialize=function(e){return u(e)},e}();function s(e){var t=AppMagic.ConnectionHub.Connection.parse(e);return new a(e.properties.reference,t,e.properties.appActions)}function c(e){var t=e.connection.serializeToJson();return t.properties.reference=e.reference,t.properties.appActions=e.appActions,t}function u(e){try{var t=i.th.safeCast(e);if(!t)throw new o.SafeCastError("IUserConnectionForAppResponse");return s(t)}catch(t){var n=t,a=Object(r.safeCastString)(e&&e.id)||"{unknown}";return r.CoreLog.error("UserConnectionForApp.tryParseFromResponseWithLogging",n,"Invalid UserConnectionForApp response. userConnectionForAppId: "+a),null}}},function(e,t,n){"use strict";n.r(t),n.d(t,"NamedHttpRequestParam",(function(){return r}));var r=function(e){function t(t,n,r){var o=e.call(this,r)||this;return o._paramName=t,o._paramValueStringifier=n,o}return __extends(t,e),Object.defineProperty(t.prototype,"paramName",{get:function(){return this._paramName},enumerable:!1,configurable:!0}),t.prototype._convertFromDValueAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){return null===e?[2,null]:[2,this._paramValueStringifier.getStringValue(e)]}))}))},t}(n(90).RequestParamBase)},function(e,t,n){"use strict";n.r(t),n.d(t,"JsonArrayTType",(function(){return a}));var r=n(0),o=n(7),i=n(10),a=function(){function e(e){this._isConvertFromDValueAsync=null,this._itemTTypeRef=e}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return o.TTypeValueKind.JsonArray},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return null===this._isConvertFromDValueAsync&&(this._isConvertFromDValueAsync=this._itemTTypeRef.getType().isConvertFromDValueAsync),this._isConvertFromDValueAsync},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(i.computeDValueSchemaForArrayTType)(this._itemTTypeRef,e)},e.prototype.convertFromDValue=function(e){var t=this._itemTTypeRef.getType();return Object(i.convertDTableToArrayOfTItems)(e,t)},e.prototype.convertToDValue=function(e,t){if(null===e)return null;if(!Object(r.isArray)(e)){var n=Object(r.CoreUtility_formatString)(AppMagic.Strings.ParsingErrorMessage,AppMagic.Strings.ValueTypeArray,Object(i.getLocalizedTTypeName)(e));return Object(r.trace)(r.CategoryNames.Verbose,"parsing",{property:null==t?void 0:t.propertyName,info:n,issue:AppMagic.Strings.ParsingErrorDetail},r.MonitorLogLevel.Error),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,n,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:n,raiseToastNotification:!1,wasReported:!1,functionName:null})}var o=this._itemTTypeRef.getType();return Object(i.convertArrayOfTItemsToDTable)(e,o,t)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"convertStringToNumber",(function(){return r})),n.d(t,"convertNumberToString",(function(){return o})),n.d(t,"convertStringToHyperlink",(function(){return i})),n.d(t,"convertHyperlinkToString",(function(){return a}));n(0);function r(e){return null===e?null:parseFloat(e)}function o(e){return null===e?null:e.toString()}function i(e){return e}function a(e){return e}},function(e,t,n){"use strict";n.r(t),n.d(t,"isFileSource",(function(){return o})),n.d(t,"isMsFlow",(function(){return i}));n(0);var r=n(1);function o(e){var t=e;return r.Qb.isValid(t)}function i(e){var t=e;return r.Zf.isValid(t)}},function(e,t,n){"use strict";n.r(t),n.d(t,"CdsOptionSetTType",(function(){return u}));var r=n(0),o=n(5),i=n(37),a=n(57),s=n(7),c=n(10),u=function(){function e(e,t){this._dataSetName=e,this._logicalName=t}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return s.TTypeValueKind.CdsOptionSet},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(o.createSchemaForSimple)(o.TypeOptionSetValue)},e.prototype.convertToDValue=function(e,t){if(null===e)return null;if(!this._isValidOptionSet(e)||!Object(r.isObject)(t)){var n=AppMagic.Strings.NetworkErrorInvalidResponse;return this._isValidOptionSet(e)||(n=Object(r.CoreUtility_formatString)(AppMagic.Strings.ParsingErrorMessage,AppMagic.Strings.ValueTypeBoolean+"/"+AppMagic.Strings.ValueTypeNumber,Object(c.getLocalizedTTypeName)(e)),Object(r.trace)(r.CategoryNames.Verbose,"parsing",{property:t.propertyName,info:n,issue:AppMagic.Strings.ParsingErrorDetail},r.MonitorLogLevel.Error)),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.Validation,AppMagic.Data.ErrorSeverity.Severe,n,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:n,raiseToastNotification:!1,wasReported:!1,functionName:null})}var o=t.unsafePropertyValues[t.propertyName+i.CdsConstants.labelAnnotation];if(!Object(r.isNonEmptyString)(o)){if(!Object(c.isExpressionRuntime)(t))return AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.Validation,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null});o=e.toString()}return Object(a.convertToCdsOptionSetReference)(this._dataSetName,this._logicalName,e,o)},e.prototype._isValidOptionSet=function(e){return"number"==typeof e||"boolean"==typeof e},e.prototype.convertFromDValue=function(e){return Object(a.optionSetConvertFromDValue)(e)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"CdsNavigationTTypeRef",(function(){return a}));n(0);var r=n(50),o=n(66),i=n(74),a=function(){function e(e,t,n,r,o){this._targetTable=e,this._typesManager=t,this._isArray=n,this._referencingFieldName=r,this._parentDataSourceName=o}return Object.defineProperty(e.prototype,"referencingFieldName",{get:function(){return this._referencingFieldName},enumerable:!1,configurable:!0}),e.prototype.removeType=function(e){e&&e===this._targetTable&&(this._ttype=null,this.getType())},e.prototype.getType=function(){if(!this._ttype){var e=void 0;this._typesManager.hasType(AppMagic.Data.ConnectedDataConstants.TypesManagerPrefix,this._targetTable)?e=this._typesManager.getType(AppMagic.Data.ConnectedDataConstants.TypesManagerPrefix,this._targetTable):(e=this._typesManager.getOrAddDelayedType(AppMagic.Data.ConnectedDataConstants.TypesManagerPrefix,this._targetTable,(function(){return new r.DelayedLoadingCdsObjectTType})))instanceof r.DelayedLoadingCdsObjectTType&&e.addParentDataSourceName(this._parentDataSourceName),this._isArray?this._ttype=new i.JsonArrayTType(new o.InlinedTTypeRef(e)):this._ttype=e}return this._ttype},e}()},function(e,t,n){"use strict";var r;n.r(t),n.d(t,"ConnectionStatusErrorCode",(function(){return r})),function(e){e[e.OK=0]="OK",e[e.ConfigurationNeeded=1]="ConfigurationNeeded",e[e.Unauthorized=2]="Unauthorized",e[e.Unauthenticated=3]="Unauthenticated",e[e.TooManyRequests=4]="TooManyRequests"}(r||(r={}))},function(e,t,n){},function(e,t,n){"use strict";n.r(t),n.d(t,"AppPackageType",(function(){return r})),n.d(t,"UnifiedAppIdentifier",(function(){return i})),n.d(t,"generatePreloadConnectionUsages",(function(){return a}));var r,o=n(0);!function(e){e[e.WebPlayer=0]="WebPlayer",e[e.PlayerPackage=1]="PlayerPackage"}(r||(r={}));var i=function(){function e(e,t){this.environmentId=e,this.appLogicalName=t}return e.prototype.toString=function(){return"".concat(this.environmentId,"/").concat(this.appLogicalName)},e}();function a(e){var t=e.connectionUsages,n=Object(o.HashTableUtility_create)();return Object(o.forEach)(t,(function(e){var t=e.connection;n[e.reference]={id:t.id,name:t.name,environmentName:t.environmentName,apiId:t.apiId,apiRuntimeUrlString:t.apiRuntimeUrlString,isAuthenticated:t.isAuthenticated,apiScopes:t.apiScopes,connectionParameters:t.connectionParameters,isTestConnectionRequiredAfterConsent:t.isTestConnectionRequiredAfterConsent,appActions:e.appActions}})),n}},function(e,t,n){"use strict";n.r(t),n.d(t,"SendHttpErrorName",(function(){return r})),n.d(t,"SendHttpError",(function(){return o}));n(0);var r="Core.SendHttpError",o=function(e){function t(t,n){var o=this;return(o=e.call(this,t,r)||this)._requestUrl=n&&n.requestUrl,o._readyState=n&&n.readyState,o._rawError=n&&n.rawError,o}return __extends(t,e),Object.defineProperty(t.prototype,"requestUrl",{get:function(){return this._requestUrl},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"readyState",{get:function(){return this._readyState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rawError",{get:function(){return this._rawError},enumerable:!1,configurable:!0}),t}(Core.ApplicationError)},function(e,t,n){"use strict";n.r(t),n.d(t,"tryParse",(function(){return l})),n.d(t,"parseMetadata",(function(){return d})),n.d(t,"parseParameters",(function(){return f})),n.d(t,"parseParameterSets",(function(){return y}));var r=n(0),o=n(121),i=n(172),a=n(146),s=n(106),c=n(6),u=n(9),p=n(1);function l(e){var t=p.c.safeCast(e);if(t){var n=function(e){if(!e)return null;switch(e.toLowerCase().trim()){case c.s.Array:return c.r.Array;case c.s.Boolean:return c.r.Boolean;case c.s.Connection:return c.r.Connection;case c.s.GatewaySetting:return c.r.GatewaySetting;case c.s.Integer:return c.r.Integer;case c.s.OAuthSetting:return c.r.OAuthSetting;case c.s.Object:return c.r.Object;case c.s.SecureObject:return c.r.SecureObject;case c.s.SecureString:return c.r.SecureString;case c.s.String:return c.r.String;default:return null}}(t.type);if(null!==n)switch(n){case c.r.OAuthSetting:if(t.oAuthSettings)return new s.OAuthTokenConnectionParameter(t.oAuthSettings,t.uiDefinition?t.uiDefinition:{});break;default:return new o.a(n,t.uiDefinition?t.uiDefinition:{})}}return null}function d(e){e||(e={});return{brandColor:e.brandColor||"#C7C7C7",allowSharing:!!e.allowSharing,fileMediaTypes:e.fileMediaTypes||[],connectionLimits:Object(r.HashTableUtility_create)(e.connectionLimits),source:e.source||u.UnspecifiedApiSourceId,sourceApplication:e.sourceApplication||u.UnspecifiedApiSourceId}}function f(e){return e?Object(r.map)(e,(function(e,t){var n=l(e);return n||r.CoreLog.warning("ApiConnectionParameter.parseParameters","The connection parameter with parameter name '".concat(t,"' could not be parsed.")),null===n?void 0:n}),!1):Object(r.HashTableUtility_create)()}function y(e){if(!e)return new a.a([],{});var t=e.values.map((function(e){var t=f(e.parameters),n=(d(e.metadata),e.uiDefinition?e.uiDefinition:{});return new i.a(e.name,t,n,e.metadata)}));return new a.a(t,e.uiDefinition?e.uiDefinition:{})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return A})),n.d(t,"c",(function(){return S})),n.d(t,"b",(function(){return _}));var r,o,i,a,s,c,u,p,l,d,f,y,m,g,v,b,h,A,C=n(0),P=n(9),w=(n(49),n(26),n(147));!function(e){e.CDPTabular1="cdptabular1",e.CDPBlob0="cdpblob0",e.CDPBlob1="cdpblob1"}(A||(A={}));var S=[P.ApiIds.CommonDataService,P.ApiIds.SharepointOnline,P.ApiIds.Sql,P.ApiIds.SqlV2,P.ApiIds.ExcelOnlineBusiness,P.ApiIds.ExcelOnlineBusinessV2],O=(A.CDPBlob0,A.CDPBlob1,A.CDPTabular1,(r={})[P.ApiIds.CommonDataService]=((o={})[A.CDPTabular1]=1,o),r[P.ApiIds.SharepointOnline]=((i={})[A.CDPTabular1]=1,i),r[P.ApiIds.Sql]=((a={})[A.CDPTabular1]=1,a),r[P.ApiIds.SqlV2]=((s={})[A.CDPTabular1]=1,s),r[P.ApiIds.SqlGcc]=((c={})[A.CDPTabular1]=1,c),r[P.ApiIds.SqlWinNonShared]=((u={})[A.CDPTabular1]=1,u),r[P.ApiIds.ExcelOnlineBusiness]=((p={})[A.CDPTabular1]=1,p),r[P.ApiIds.ExcelOnlineBusinessV2]=((l={})[A.CDPTabular1]=1,l),r),R=((d={})[P.ApiIds.CommonDataService]=((f={})[A.CDPTabular1]=2,f),d[P.ApiIds.Sql]=((y={})[A.CDPTabular1]=2,y),d[P.ApiIds.SqlV2]=((m={})[A.CDPTabular1]=2,m),d[P.ApiIds.SqlGcc]=((g={})[A.CDPTabular1]=2,g),d[P.ApiIds.SqlWinNonShared]=((v={})[A.CDPTabular1]=2,v),d[P.ApiIds.ExcelOnlineBusiness]=((b={})[A.CDPTabular1]=2,b),d[P.ApiIds.ExcelOnlineBusinessV2]=((h={})[A.CDPTabular1]=2,h),d),_=function(){function e(e,t,n,r,o){this._apiId=e,this._apiInterfaces=t,this._lastChangedTime=n,this._releaseStatus=r,this._defaultProdRevisions=o&&o.prod||O,this._defaultPreviewRevisions=o&&o.preview||R}return e.prototype.tryGetLatestInterfaceRevisionNumber=function(e,t){var n=this._tryGetDefaultRevisionNumber(e,t);if(n)return n;var r=this._apiInterfaces[e];return r?r.latestRevisionNumber:null},e.prototype.tryGetInterfaceRevisionNumberWithDefaultBaseUrl=function(e){var t=this._apiInterfaces[e];return t?t.revisionNumberWithDefaultBaseUrl:null},e.prototype.tryGetInterfaceRevision=function(e,t){var n=this._apiInterfaces[e];if(!n)return null;var r=n.tryGetInterfaceRevision(t);return r?this._createApiInterfaceRevisionInfo(e,r):null},e.prototype._createApiInterfaceRevisionInfo=function(e,t){return{apiLastChangedTime:this._lastChangedTime,interfaceName:e,revision:t.revNumber,baseUrl:t.baseUrl,status:Object(C.isNumber)(t.status)?t.status:this._releaseStatus,isDeprecated:t.isDeprecated,expires:t.expires}},e.prototype._tryGetDefaultRevisionNumber=function(e,t){if(t&&t[this._apiId]){var n=this._defaultPreviewRevisions[this._apiId];if(n&&n[e]){if(!(o=n[e])||!this.tryGetInterfaceRevision(e,o))throw new w.ApiError(this._apiId,"Could not find experimental revision ".concat(o," from api ").concat(this._apiId,"."));return o}}var r=this._defaultProdRevisions[this._apiId];if(r&&r[e]){var o;if(!(o=r[e])||!this.tryGetInterfaceRevision(e,o))throw new w.ApiError(this._apiId,"Could not find production revision ".concat(o," from api ").concat(this._apiId,"."));return o}return null},e}()},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(0);function o(e){return encodeURIComponent(e).replace(/!|'|\(|\)|\*/g,(function(e){switch(e){case"!":return"%21";case"'":return"%27";case"(":return"%28";case")":return"%29";case"*":return"%2A";default:return e}}))}var i=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(r.ApplicationError)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r,o=n(0),i=n(60),a=n(51),s=n(22),c=n(53),u=n(48),p=n(2),l=n(25),d=n(13);!function(e){e.RegionName="test",e.endpointTitle="TestInProd1",e.powerAppsRedirectUri=new o.Core_Url("https://tip1.web.powerapps.com/powerappsredirect/"),e.docServerEndpoint=new o.Core_Url("https://test.create.powerapps.com/"),e.playerResourcesEndpoint=new o.Core_Url("https://paplayercdn-test.azureedge.net/");var t=new o.Core_Url("https://go.microsoft.com/fwlink/?linkid=841574"),n=new o.Core_Url("https://go.microsoft.com/fwlink/?linkid=841575");function r(){return new o.Core_Url("https://tip1.api.powerapps.com")}function f(){return Object(o.useTip2InTest)()?Object(d.a)("test"):Object(d.a)("preprod")}function y(){return new o.Core_Url("https://tip1."+AppMagic.PowerApps.Constants.BadRpBaseUrlSuffix)}function m(){return p.PowerAppEndpoints.getApiVersion()+"-alpha"}e.flowRPEndpoint=new o.Core_Url("https://tip1.api.flow.microsoft.com"),e.flowPortalEndpoint=new o.Core_Url("https://tip1.flow.microsoft.com/"),e.ecsHostResource="https://config.edge.skype.net",e.webAuthResource="7f96ed90-4ea5-48c1-b589-81ac94ade0aa",e.getPowerAppsRpBaseUrl=r,e.getPowerPlatformRpBaseUrl=function(){return Object(o.useTip2InTest)()?Object(d.b)("test",Object(o.tryGetEnvironmentName)()):Object(d.b)("preprod",Object(o.tryGetEnvironmentName)())},e.powerPlatformTenantBaseUrl=function(){return Object(o.useTip2InTest)()?Object(d.d)("test"):Object(d.d)("preprod")},e.powerPlatformEnvironmentBaseUrl=function(){return Object(o.useTip2InTest)()?Object(d.c)("test"):Object(d.c)("preprod")},e.getPowerPlatformResource=function(){return Object(o.useTip2InTest)()?Object(d.e)("test"):Object(d.e)("preprod")},e.getCreatePVABotUrl=f,e.getPowerAppsBadBaseUrl=y,e.getApiVersionValue=m,e.getCdmRpApiVersionValue=function(){return p.PowerAppEndpoints.getCdmRpApiVersion()+"-alpha"},e.portalEndPoint=new o.Core_Url("https://make.test.powerapps.com"),e.appDownloadRootEndPoint=new o.Core_Url("https://apps.test.powerapps.com/open/"),e.consumerPortalEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?linkid=2169021"),e.webPlayerSignUpEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkId=785762"),e.webPlayerConsentEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkId=785766"),e.webAuthoringSignUpEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkId=785770"),e.InstallGatewayLinkUrl=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkID=817347"),e.InstallVNetGatewayLinkUrl=new o.Core_Url("https://tip.admin.powerplatform.microsoft.com/ext/DataGateways"),e.aibTextServiceEndpoint="https://cus-text.pai.test.dynamics.com",e.neptuneResource="https://licensing-tip.powerplatform.microsoft.com/",e.neptuneAudience="https://licensing-tip.powerplatform.microsoft.com/auth",e.cesFeedbackEndpoint=i.NpsUrlOriginForTest,e.cesFeedbackServiceResource="https://microsoft.onmicrosoft.com/nps-int",e.teamsPowerAppsId="0fa58992-1b03-41e1-8b1d-4aa556715d20",e.getValues=function(){var i=l.a.getValues();return i.name="test",i.clusterCategory=Object(o.useTip2InTest)()?"test":"preprod",i.endpointTitle=e.endpointTitle,i.portalUri=e.portalEndPoint,i.appDownloadRootUri=e.appDownloadRootEndPoint,i.consumerPortalUri=e.consumerPortalEndPoint,i.powerAppsRpBaseUrl=r(),i.powerAppsApiVersion=m(),i.powerPlatformRpBaseUrl=Object(d.b)(i.clusterCategory,Object(o.tryGetEnvironmentName)()),i.powerPlatformResource=Object(d.e)(i.clusterCategory),i.powerPlatformRpApiVersion=p.PowerAppEndpoints.powerPlatformApiVersion,i.powerPlatformTenantBaseUrl=Object(d.d)(i.clusterCategory),i.powerPlatformEnvironmentBaseUrl=Object(d.c)(i.clusterCategory),i.createPVABotUrl=f(),i.bapBaseUrl=s.BapEndpoints.Test.getBaseUrl(),i.bapApiVersion=s.BapEndpoints.Test.getApiVersionValue(),i.cdsBaseUrl=c.CdsEndpoints.Test.getBaseUrl(),i.cdsApiVersion=c.CdsEndpoints.Test.getApiVersionValue(),i.clientConsentEndPoint=l.a.getClientConsentEndPoint(t,n),i.webPlayerSignUpEndPoint=e.webPlayerSignUpEndPoint,i.webPlayerConsentEndPoint=e.webPlayerConsentEndPoint,i.webAuthoringSignUpEndPoint=e.webAuthoringSignUpEndPoint,i.gcmSenderId=AppMagic.PowerApps.Constants.Notification.TestInProd1.gcmSenderId,i.powerAppsRedirectUri=e.powerAppsRedirectUri,i.installGatewayLinkUrl=e.InstallGatewayLinkUrl,i.installVNetGatewayLinkUrl=e.InstallVNetGatewayLinkUrl,i.intelligenceStudioBaseUrl=u.IntelligenceEndpoints.Test.intelligenceStudioBaseUrl,i.flowRpBaseUrl=e.flowRPEndpoint,i.flowPortalBaseUrl=e.flowPortalEndpoint,i.playerResourcesEndpoint=e.playerResourcesEndpoint,i.docServerEndpoint=e.docServerEndpoint,i.webAuthResource=e.webAuthResource,i.powerAppsBadBaseUrl=y(),i.powerAppsBadApiVersion=a.BadEndpoints.getApiVersion(),i.aibTextServiceEndpoint=e.aibTextServiceEndpoint,i.cesFeedbackEndpoint=e.cesFeedbackEndpoint,i.cesFeedbackServiceResource=e.cesFeedbackServiceResource,i.ecsHostResource=e.ecsHostResource,i.neptuneResource=e.neptuneResource,i.neptuneAudience=e.neptuneAudience,i.teamsPowerAppsId=e.teamsPowerAppsId,i}}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"PostMessageXmlHttpRequestConstants",(function(){return r}));var r=function(){function e(){}return e.RequestMessage="xhrrequest",e.ResultMessage="xhrresult",e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"tryFromServerUserConsent",(function(){return o}));n(0);var r=n(8);function o(e){switch(e.type){case"Auth":var t=AppMagic.Runtime.Client.AuthResource.isCdsAuthResource(e.name)?e.name:r.d.tryConvertFromString(e.name);return t?{type:"Auth",name:t}:null;case"Device":return{type:"Device",name:e.name};default:return null}}},function(e,t,n){"use strict";var r,o,i,a;n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),function(e){!function(e){e.tokenAcquireEndpoint="/api/accesstoken/acquire",e.tokenRefreshEndpoint="/api/accesstoken/refresh",e.restartEndpoint="/api/accesstoken/restart"}(e.Web||(e.Web={})),function(e){e.authorizationPath="oauth2/authorize",e.tokenPath="oauth2/token"}(e.Url||(e.Url={}))}(r||(r={})),function(e){e.getProfilePhotoDataUrl="UserIdentiy.GetProfilePhotoDataUrl",e.sharePoint="Microsoft.SharePoint",e.powerBIAPIBasePath=function(e){switch(e.name){case"gccmoderate":return"https://api.powerbigov.us/";case"gcchigh":return"https://api.high.powerbigov.us/";case"dod":return"https://api.mil.powerbigov.us/";case"mooncake":return"https://api.powerbi.cn/";case"ex":return"https://api.powerbi.eaglex.ic.gov/";case"rx":return"https://api.powerbi.microsoft.scloud/";case"prod":case"int":case"preprod":case"test":case"tip2":return"https://api.powerbi.com/";default:throw new Error("Undefined region: "+e.name)}},function(t){var n=function(e){return e?"/groups/".concat(e):""};t.workspacesUrl=function(t){return"".concat(e.powerBIAPIBasePath(t)).concat("v1.0","/myorg/groups")},t.dashboardsUrl=function(t,r){return"".concat(e.powerBIAPIBasePath(t)).concat("v1.0","/myorg").concat(n(r),"/dashboards")},t.tilesUrl=function(t,r,o){return"".concat(e.powerBIAPIBasePath(t)).concat("v1.0","/myorg").concat(n(o),"/dashboards/").concat(r,"/tiles")}}(e.PowerBIAPI||(e.PowerBIAPI={}))}(o||(o={})),function(e){e.userProperties="EnrollProperties.userProperties",e.userPlans="EnrollProperties.userPlans",e.showOptInConsentDialog="EnrollProperties.showOptInConsentDialog",e.oid="EnrollProperties.oid"}(i||(i={})),function(e){!function(e){e.data="RTS",e.metadata="RP"}(e.EntityFormContainer||(e.EntityFormContainer={}))}(a||(a={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"RequestParamBase",(function(){return o}));var r=n(0),o=function(){function e(e){this._valueExpression=e}return e.prototype.applyAsync=function(e,t){var n;return __awaiter(this,void 0,Promise,(function(){var o,i,a;return __generator(this,(function(s){switch(s.label){case 0:s.label=1;case 1:return s.trys.push([1,4,,5]),[4,this._getDValueAsync(t)];case 2:return o=s.sent(),Object(r.isUndefined)(o)||AppMagic.Data.ErrorValue.isGatedError(o)?[2]:[4,this._convertFromDValueAsync(o,t)];case 3:return null===(i=s.sent())?this._applyNullValue(e):this._applyValue(e,i),[3,5];case 4:throw a=s.sent(),r.Log.trackException(a,{message:"Error while applying request params",parameterName:null===(n=this._valueExpression)||void 0===n?void 0:n._parameterName}),a;case 5:return[2]}}))}))},e.prototype._getDValueAsync=function(e){return this._valueExpression.evaluateAsync(e)},e.prototype._applyNullValue=function(e){},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"TypesManager",(function(){return o}));var r=n(0),o=function(){function e(){this._types=Object(r.HashTableUtility_create)(),this._delayedLoadedTypes=Object(r.HashTableUtility_create)()}return e._encodeKeys=function(e,t){return e.length.toString()+"+"+t.length.toString()+"_"+e+t},e.prototype.addType=function(t,n,o){Object(r.check)(!this.hasType(t,n),"Type with prefix ".concat(t,", name ").concat(n," already present"));var i=e._encodeKeys(t,n),a=o;if(this._delayedLoadedTypes[i]){var s=this._delayedLoadedTypes[i];s.setType(o),a=s,delete this._delayedLoadedTypes[i]}this._types[e._encodeKeys(t,n)]=a},e.prototype.hasType=function(t,n){return!!this._types[e._encodeKeys(t,n)]},e.prototype.getType=function(t,n){return this._types[e._encodeKeys(t,n)]},e.prototype.getDelayedType=function(t,n){var r=e._encodeKeys(t,n);return this._delayedLoadedTypes[r]},e.prototype.getOrAddDelayedType=function(t,n,r){var o=e._encodeKeys(t,n);return this._delayedLoadedTypes[o]||(this._delayedLoadedTypes[o]=r()),this._delayedLoadedTypes[o]},e.prototype.removeType=function(t,n){var o=e._encodeKeys(t,n),i=this._types[o];this._delayedLoadedTypes[o]?delete this._delayedLoadedTypes[o]:(i||r.CoreLog.error("TypesManager.removeType","Removing type ".concat(t,":").concat(n," that already does not exist!")),delete this._types[o],Object(r.HashTableUtility_forEach)(this._types,(function(e){e.removeTypeRef&&e.removeTypeRef(i)})))},e.prototype.combineTypesManagers=function(e){var t=this;Object(r.HashTableUtility_forEach)(e._types,(function(e,n){t._types[n]=e})),Object(r.HashTableUtility_forEach)(e._delayedLoadedTypes,(function(e,n){t._delayedLoadedTypes[n]=e}))},e.prototype.removeTypesBySubstring=function(e){var t=this;Object(r.HashTableUtility_forEach)(this._types,(function(n,r){r.indexOf(e)>=0&&delete t._types[r]})),Object(r.HashTableUtility_forEach)(this._delayedLoadedTypes,(function(n,r){r.indexOf(e)>=0&&delete t._delayedLoadedTypes[r]}))},e.ValueColumnName="Value",e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"Type",(function(){return r})),n.d(t,"correctSchemaDictionaryAndCreateNameRemapping",(function(){return i})),n.d(t,"correctObjectWithSchema",(function(){return s}));n(0);var r,o=n(5);function i(e){var t,n,r=Object.create(null),a=Object.keys(e).sort();for(t=0,n=a.length;t<n;t++){var s=a[t],c=e[s],u=0===s.length?"_":AppMagic.Utility.replaceAllSingleOrDoubleQuotes(s,"_");if(u!==s){for(var p=u,l=0;void 0!==e[p];)p=u+"_"+(++l).toString();u=p,c.name=p,e[p]=c,delete e[s]}r[s]={name:u},Object(o.isSchemaComplexSchema)(c)&&c.ptr&&(r[s].childMapping=i(c.ptr))}return r}function a(e,t,n){var r,o;for(r=0,o=e.length;r<o;r++){var i=e[r];null!==i&&(("object"!=typeof i||i instanceof Array)&&(i={Value:i},e[r]=i),s(i,t,n))}}function s(e,t,n){if(null!==e){var r,i,c=Object.keys(e);for(r=0,i=c.length;r<i;r++){var u=c[r],p=e[u],l=t[n[u].name];switch(l.type){case"array":null!==p&&Object(o.isSchemaOfTypeArray)(l)&&(p instanceof Array||(e[u]=[p]),a(e[u],l.ptr,n[u].childMapping));break;case"s":"string"!=typeof p&&null!==p&&(e[u]=JSON.stringify(p));break;case"object":s(e[u],l.ptr,n[u].childMapping)}if(p=e[u],n[u].name!==u)e[n[u].name]=p,delete e[u]}}}!function(e){e[e.authRequest=0]="authRequest",e[e.error=1]="error",e[e.item=2]="item",e[e.set=3]="set",e[e.pagedSet=4]="pagedSet"}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"InvalidJsonServerResponse",(function(){return o}));var r=n(0),o=function(e){function t(t){return void 0===t&&(t="Json response from service is invalid."),e.call(this,t,"InvalidJsonServerResponse")||this}return __extends(t,e),t}(r.ErrorBase)},function(e,t,n){"use strict";n.r(t),n.d(t,"CdsPolymorphicLookupTType",(function(){return u}));var r=n(0),o=n(5),i=n(7),a=n(10),s=n(126),c=n(50),u=function(){function e(e,t){this._logicalNames=e,this._navigationPropertyNames=t}return Object.defineProperty(e.prototype,"LogicalNames",{get:function(){return this._logicalNames},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return i.TTypeValueKind.CdsPolymorphicLookup},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(o.createSchemaForSimple)(o.TypePolymorphic)},e.prototype.convertToDValue=function(e,t,n){var o=t.unsafePropertyValues,i=t.propertyName;if(!Object(r.isJsonObject)(o)||!Object(r.isNonEmptyString)(i)){var s=AppMagic.Strings.NetworkErrorInvalidResponse;return Object(r.isJsonObject)(o)||(s=Object(r.CoreUtility_formatString)(AppMagic.Strings.ParsingErrorMessage,AppMagic.Strings.ValueTypeObject,Object(a.getLocalizedTTypeName)(o)),Object(r.trace)(r.CategoryNames.Verbose,"parsing",{property:t.propertyName,info:s,issue:AppMagic.Strings.ParsingErrorDetail},r.MonitorLogLevel.Error)),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,s,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:s,raiseToastNotification:!1,wasReported:!1,functionName:null})}var c=o["".concat(i,"@Microsoft.Dynamics.CRM.lookuplogicalname")],u=o["".concat(i)],p=o["".concat(i,"@OData.Community.Display.V1.FormattedValue")];if(Object(r.isNonEmptyString)(c)&&Object(r.isNonEmptyString)(u)){var l={Type:c,Value:u,DisplayName:p},d=this._tryGetExpandedRecord(c,o,n,t,i);return AppMagic.Data.DataEntityRecord.isDataEntityRecord(d)&&(l.ExpandedRecord=d),l}return null===u?null:Object(a.isExpressionRuntime)(t)?this._createPolymorphicLookupPointer(t):AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null})},e.prototype.convertFromDValue=function(e){return null===e?null:Object(r.isString)(e)?e:e.Value},e.prototype._validateDValue=function(e){return Object(r.isNonEmptyString)(e.Value)&&Object(r.isNonEmptyString)(e.Type)},e.prototype._createPolymorphicLookupPointer=function(e){var t=e.unsafePropertyValues,n=e.propertyName,r=n.slice(1,n.length).slice(0,-6),o=this._getPolymorphicLookupProperties(r,t),i=o.typeName,a=o.odataId,s=o.navigationPropertyName;if(void 0!==a){if(!a||!i||!s)return AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:"",id:-1,propertyName:null==e?void 0:e.propertyName},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null});var c=a.split(/[(]/);if(2!==c.length)return AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:"",id:-1,propertyName:null==e?void 0:e.propertyName},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null});var u=c[0].slice(1);return{Value:c[1].slice(0,-1),NavigationPropertyName:s,EntitySetName:u,odataId:a,Type:i}}},e.prototype._getPolymorphicLookupProperties=function(e,t){if("ownerid"===e.toLocaleLowerCase()){var n=t.ownerid;if(n)return{typeName:n.indexOf("systemusers")>-1?"systemuser":"team",odataId:n,navigationPropertyName:e}}for(var r=0,o=this._navigationPropertyNames.length;r<o;r++){var i=this._navigationPropertyNames[r];if(t.hasOwnProperty(i))return{typeName:this._logicalNames[r],odataId:t[i],navigationPropertyName:i}}return{typeName:void 0,odataId:void 0,navigationPropertyName:void 0}},e.prototype._tryGetExpandedRecord=function(e,t,n,o,i){for(var a,u=0,p=this._logicalNames.length;u<p;u++)if(e===this._logicalNames[u]){a=this._navigationPropertyNames[u];break}if(void 0!==a){"ownerid"===a&&(a="systemuser"===e?"owninguser":"owningteam");var l=n.getTargetType(e);if(!Object(r.isUndefined)(l)&&!Object(r.isUndefined)(i)){if(l instanceof c.DelayedLoadingCdsObjectTType&&l.isLoaded&&(l=l.ttype),!t.hasOwnProperty(a)&&l instanceof s.CdsEntityObjectTType){var d=l.getPropTValueFromAnnotations(t,i);return l.convertToDValue(d,o)}return l.convertToDValue(t[a],o)}}},e}()},function(e,t){!function(){e.exports=function(){return this?this:window}()["@pa-client/core-io"]}()},function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(0),n(98),n(99)},function(e,t,n){"use strict";n.r(t),n.d(t,"SendHttpCoreSupportedXhrResponseTypes",(function(){return s})),n.d(t,"SendHttpPipelineRequestParameters",(function(){return r}));var r,o=n(0),i=n(3),a=n(23),s=[a.ResponseTypes.Text,a.ResponseTypes.Json,a.ResponseTypes.ArrayBuffer,a.ResponseTypes.Blob,a.ResponseTypes.PABinary];!function(e){function t(e){return null==e||"string"==typeof e||e instanceof Blob||e instanceof ArrayBuffer||e instanceof o.PABinary&&e.source.sourceType!==o.BinarySourceType.Invalid}e.isValid=function(e){return Object(o.isObject)(e)&&Object(o.isNonEmptyString)(e.url)&&i.KnownMethods.indexOf(e.method)>=0&&(void 0===e.headers||Object(o.isHashTable)(e.headers))&&void 0===e.queryParameters&&(void 0===e.retryable||Object(o.isObject)(e.retryable)&&"number"==typeof e.retryable.maxRetries&&e.retryable.maxRetries>=0&&(void 0===e.retryable.statusCodes||Object(o.isArray)(e.retryable.statusCodes)&&e.retryable.statusCodes.every(o.isNumber)))&&t(e.bodyData)&&(void 0===e.responseType||s.indexOf(e.responseType)>=0)&&(void 0===e.requestSource||"PublishedApp"===e.requestSource)},e.isValidBodyData=t}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"SendHttpRequestParameters",(function(){return r}));var r,o=n(0),i=n(3);!function(e){function t(e){return null==e||"string"==typeof e||e instanceof Blob||e instanceof ArrayBuffer||e instanceof o.PABinary}e.isValid=function(e){return Object(o.isObject)(e)&&Object(o.isNonEmptyString)(e.url)&&i.KnownMethods.indexOf(e.method)>=0&&(void 0===e.headers||Object(o.isAnyHashTable)(e.headers))&&void 0===e.queryParameters&&void 0===e.requestSource&&(void 0===e.retryable||Object(o.isObject)(e.retryable)&&"number"==typeof e.retryable.maxRetries&&e.retryable.maxRetries>=0&&(void 0===e.retryable.statusCodes||Object(o.isArray)(e.retryable.statusCodes)&&e.retryable.statusCodes.every(o.isNumber)))&&t(e.bodyData)},e.isValidBodyData=t}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"LeaseStatus",(function(){return r})),n.d(t,"AppLease",(function(){return o}));var r,o,i=n(0);!function(e){e[e.Success=0]="Success",e[e.ConflictWithAnotherUser=1]="ConflictWithAnotherUser",e[e.ConflictForSameUser=2]="ConflictForSameUser",e[e.ReadOnly=3]="ReadOnly",e[e.NotFound=4]="NotFound",e[e.UnexpectedError=5]="UnexpectedError"}(r||(r={})),function(e){e.parse=function(e){var t=Date.parse(e.expiry);return isNaN(t)?(i.CoreLog.error("AppLease.parse","Attempting to parse lease object failed due to invalid expiry date: "+e.expiry),{status:r.UnexpectedError}):(i.CoreLog.verbose("Lease acquired for app successfully"),{status:r.Success,appLease:{expiry:t,leaseId:e.leaseId,lessee:e.lessee}})}}(o||(o={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return A}));var r,o,i=n(0),a=n(16),s=n(17),c=n(51),u=n(3),p=n(44),l=n(28),d=n(43),f=n(2),y=n(40),m=n(4),g=n(39),v=n(14),b=n(1),h=n(65);!function(e){e.validateAppDisplayNameCall="PowerAppsAppService.ValidateAppDisplayName",e.getAppsCall="PowerAppsAppService.GetApps",e.getModelAppsCall="PowerAppsAppService.GetModelApps",e.getGlobalAppsCall="PowerAppsAppService.GetGlobalApps",e.getCuratedAppsCall="PowerAppsAppService.getCuratedApps",e.startSessionCall="PowerAppsAppService.StartSession",e.getSessionsCall="PowerAppsAppService.GetSessions",e.refreshSessionCall="PowerAppsAppService.RefreshSession",e.endSessionCall="PowerAppsAppService.EndSession"}(r||(r={})),function(e){e[e.Available=0]="Available",e[e.Unavailable=1]="Unavailable",e[e.Malformed=2]="Malformed",e[e.Unexpected=3]="Unexpected"}(o||(o={}));var A=function(){function e(e){this._httpClient=e}return e.prototype.startSessionAsync=function(e,t,n,o,a,s,c){return void 0===c&&(c=h.RPSessionType.Writer),__awaiter(this,void 0,Promise,(function(){var p,l;return __generator(this,(function(d){switch(d.label){case 0:return[4,this._sendSessionHttpRequestAsync(e,t,u.Method.POST,f.PowerAppEndpoints.UrlPaths.startSession,r.startSessionCall,{requestBody:{sessionType:c,userClientContext:JSON.stringify(n)},force:o,abortController:a,allowMultipleWriters:s})];case 1:return p=d.sent(),l=Object(i.tryParseJson)(p.response),[2,{currentSession:this.processSessionResponse(l.currentSession),copresenceDetails:this.processPresenceDetailsResponse(l.copresenceDetails)}]}}))}))},e.prototype.getSessionsAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var n;return __generator(this,(function(o){switch(o.label){case 0:return[4,this._sendSessionHttpRequestAsync(e,t,u.Method.GET,f.PowerAppEndpoints.UrlPaths.getSessions,r.getSessionsCall)];case 1:return n=o.sent(),[2,{copresenceDetails:this.processPresenceDetailsResponse(Object(i.tryParseJson)(n.response).copresenceDetails)}]}}))}))},e.prototype.endSessionAsync=function(e,t,n){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(o){switch(o.label){case 0:return[4,this._sendSessionHttpRequestAsync(e,t,u.Method.POST,f.PowerAppEndpoints.UrlPaths.endSession,r.endSessionCall,{sessionId:n})];case 1:return o.sent(),[2]}}))}))},e.prototype.refreshSessionAsync=function(e,t,n,o){return __awaiter(this,void 0,Promise,(function(){var a,s;return __generator(this,(function(c){switch(c.label){case 0:return[4,this._sendSessionHttpRequestAsync(e,t,u.Method.POST,f.PowerAppEndpoints.UrlPaths.refreshSession,r.refreshSessionCall,{sessionId:n,requestBody:{userClientContext:JSON.stringify(o)}})];case 1:return a=c.sent(),s=Object(i.tryParseJson)(a.response),[2,{currentSession:this.processSessionResponse(s.currentSession),copresenceDetails:this.processPresenceDetailsResponse(s.copresenceDetails)}]}}))}))},e.prototype.parseJsonOrEmpty=function(e){try{return JSON.parse(e)}catch(e){return{}}},e.prototype.parseUserClientContext=function(e){var t=this.parseJsonOrEmpty(e),n={status:t.status,location:t.location,clientSessionId:t.clientSessionId,coauthoringSessionId:t.coauthoringSessionId};if(t.lastSaved){var r=new Date(t.lastSaved);if(!isNaN(r.getTime()))return __assign(__assign({},n),{lastSaved:r})}return n},e.prototype.processSessionResponse=function(e){return __assign(__assign({},e),{userClientContext:this.parseUserClientContext(e.userClientContext)})},e.prototype.processPresenceDetailsResponse=function(e){var t=this,n={};return Object.keys(e.sessions).forEach((function(r){n[r]=t.processSessionResponse(e.sessions[r])})),__assign(__assign({},e),{sessions:n})},e.prototype._sendSessionHttpRequestAsync=function(e,t,n,r,o,i){var a=void 0===i?{}:i,c=a.requestBody,u=a.sessionId,l=a.force,d=a.abortController,f=a.allowMultipleWriters,y=m.PowerAppsUtility.getSessionUrlBuilder(e,t,u);y.appendPath(r),!0===l&&y.setQueryParam("forceStartNewSession","true"),!0===f&&y.setQueryParam("allowMultipleWriters","true");var g=new p.JsonHttpRequestBuilder;c&&g.setJsonValue("",c),m.PowerAppsUtility.authorizeHttpBuilder(g,n,y.toUrl(),m.PowerAppsUtility.getPowerAppsResourceName(),m.PowerAppsUtility.getPowerAppsApiVersion());var b=g.generateSendHttpRequestParameters();return b.signal=d,Object(s.appendCustomHeadersOptions)(b,{addCustomHeaders:!0}),Object(v.sendHttpAsync)(this._httpClient,b,o)},e.prototype.validateAppDisplayNameAsync=function(e,t){var n=this,o=m.PowerAppsUtility.getValidateAppDisplayNameEndpoint(t),i=new p.JsonHttpRequestBuilder;i.setJsonValue("",{displayName:e}),m.PowerAppsUtility.authorizeHttpBuilder(i,u.Method.POST,o,m.PowerAppsUtility.getPowerAppsResourceName());var a=i.generateSendHttpRequestParameters();return Object(s.appendCustomHeadersOptions)(a,{addCustomHeaders:!0}),Object(v.sendHttpJsonResponseAsync)(this._httpClient,a,r.validateAppDisplayNameCall).then((function(e){return n._parseValidateAppDisplayNameResponse(e)}))},e.getAppsFromServerAsync=function(t,n,o,a,s,c){return void 0===n&&(n=y.b.OrgGalleryApps),void 0===o&&(o=!0),void 0===s&&(s=!1),__awaiter(this,void 0,Promise,(function(){var u,p,l,d,f;return __generator(this,(function(y){switch(y.label){case 0:y.label=1;case 1:return y.trys.push([1,6,,7]),u=null,s?[3,3]:(p=Object(i.usePowerPlatformApi)()?m.PowerAppsUtility.getAppsAndComponentLibrariesTenantEndpoint(c):m.PowerAppsUtility.getAppsAndComponentLibrariesEndpoint(),d=e._getIODataQueryOptionsForCanvasApps(n,o),[4,e._getAppInfosAsync(t,p,r.getAppsCall,a,d)]);case 2:return u=y.sent(),[3,5];case 3:return l=m.PowerAppsUtility.getUnifiedAppListEndpoint(c),d=e._getIODataQueryOptionsForUnifiedApps(n),[4,e._getAppInfosAsync(t,l,r.getAppsCall,a,d,!0)];case 4:u=y.sent(),y.label=5;case 5:return i.Log.trackActivityEvent("PowerAppsAppService.getAppsFromServerAsync",{numberOfApps:u.length}),[2,u];case 6:throw f=y.sent(),Object(i.isCanceledError)(f)||i.CoreLog.error("PowerAppsAppService.getAppsFromServerAsync",f),f;case 7:return[2]}}))}))},e.getModelAppsFromServerAsync=function(t){return __awaiter(this,void 0,Promise,(function(){var n,o,s,u;return __generator(this,(function(p){switch(p.label){case 0:n=m.PowerAppsUtility.getEndpointForAppsDiscovery(),o={apiVersion:a.Region.getCurrentRegion().powerAppsBadApiVersion,filter:Object(i.CoreUtility_formatString)("properties/serviceName eq '{0}'",c.BadEndpoints.modelAppsServiceName)},p.label=1;case 1:return p.trys.push([1,3,,4]),[4,e._getModelAppsAsync(t,n,r.getModelAppsCall,!1,o)];case 2:return s=p.sent(),i.Log.trackActivityEvent("PowerAppsAppService.getModelAppsFromServerAsync",{numberOfApps:s.length}),[2,s];case 3:throw u=p.sent(),Object(i.isCanceledError)(u)||i.CoreLog.error("PowerAppsAppService.getModelAppsFromServerAsync",u),u;case 4:return[2]}}))}))},e.getGlobalAppsFromServerAsync=function(t,n,o){return __awaiter(this,void 0,Promise,(function(){var a,s,c,u;return __generator(this,(function(p){switch(p.label){case 0:a=m.PowerAppsUtility.getGlobalAppsEndpoint(o),s=e._getIODataQueryOptionsForCanvasApps(y.b.OrgGalleryApps,!1),p.label=1;case 1:return p.trys.push([1,3,,4]),[4,e._getAppInfosAsync(t,a,r.getGlobalAppsCall,n,s)];case 2:return c=p.sent(),i.Log.trackActivityEvent("PowerAppsAppService.getGlobalAppsFromServerAsync",{numberOfApps:c.length}),[2,c];case 3:throw u=p.sent(),Object(i.isCanceledError)(u)||i.CoreLog.error("PowerAppsAppService.getGlobalAppsFromServerAsync",u),u;case 4:return[2]}}))}))},e.getCuratedAppsFromServerAsync=function(t,n){return __awaiter(this,void 0,Promise,(function(){var o,a,s,c;return __generator(this,(function(u){switch(u.label){case 0:o=m.PowerAppsUtility.getCuratedAppsEndpoint(n),a={apiVersion:Object(i.usePowerPlatformApi)()?m.PowerAppsUtility.getPowerPlatformApiVersion():m.PowerAppsUtility.getCuratedApiVersion(),filter:f.ListAppFilterParameters.SupportsMobileCapability},u.label=1;case 1:return u.trys.push([1,3,,4]),[4,e._getCuratedAppInfosAsync(t,o,r.getCuratedAppsCall,a)];case 2:return s=u.sent(),i.Log.trackActivityEvent("PowerAppsAppService.getCuratedAppsFromServerAsync",{numberOfApps:s.length}),[2,s];case 3:throw c=u.sent(),Object(i.isCanceledError)(c)||i.CoreLog.error("PowerAppsAppService.getCuratedAppsFromServerAsync",c),c;case 4:return[2]}}))}))},e._getCuratedAppInfosAsync=function(e,t,n,r){return __awaiter(this,void 0,Promise,(function(){var o,i;return __generator(this,(function(a){switch(a.label){case 0:return[4,this._getAppsAsync(e,t,n,!1,r)];case 1:return o=a.sent(),i=[],o.forEach((function(e){var t=d.AppInfoParser.tryParseCuratedAppInfo(e);null!==t&&i.push(t)})),[2,i]}}))}))},e._getIODataQueryOptionsForCanvasApps=function(e,t){void 0===e&&(e=y.b.OrgGalleryApps),void 0===t&&(t=!1);var n={apiVersion:m.PowerAppsUtility.getPowerAppsApiVersion()};return Object(i.isDefined)(e)&&(n.filter=Object(i.CoreUtility_formatString)(f.ListAppFilterParameters.ClassificationFilterUnformatted,y.b[e])),t&&(n.expand=f.GetAppExpandParameters.EnvironmentDisplayName),n},e._getIODataQueryOptionsForUnifiedApps=function(e,t,n){void 0===e&&(e=y.b.OrgGalleryApps),void 0===t&&(t=!0),void 0===n&&(n=!0);var r={apiVersion:m.PowerAppsUtility.getPowerAppsApiVersion()};return Object(i.isDefined)(e)?r.filter=f.ListAppFilterParameters.SupportsMobileCapability+" and "+Object(i.CoreUtility_formatString)(f.ListAppFilterParameters.ClassificationFilterUnformatted,y.b[e]):r.filter=f.ListAppFilterParameters.SupportsMobileCapability,t&&n?r.expand=f.ListAppExpandParameters.Environment+","+f.ListAppExpandParameters.Metadata:t?r.expand=f.ListAppExpandParameters.Metadata:n&&(r.expand=f.ListAppExpandParameters.Environment),r},e._getAppsAsync=function(e,t,n,r,o){return __awaiter(this,void 0,Promise,(function(){var a,s,c,u,p,d;return __generator(this,(function(y){switch(y.label){case 0:return i.CoreLog.verbose("PowerAppsAppService: _getAppsAsync: endPoint : "+t),a=new i.UrlBuilder(t),r&&a.setQueryParam(f.PowerAppEndpoints.pollQueryParam,"true"),s=new l.ODataListItemsTool(a.toString(),m.PowerAppsUtility.getPowerAppsResourceName(),e,n,f.PowerAppsNextLink),(u=m.PowerAppsUtility.tryGetDocumentServerEndpointHeader())&&((c=Object(i.HashTableUtility_create)())[u.headerName]=u.value),[4,s.getItemsAsync(o,void 0,c)];case 1:if(!(p=y.sent()).items)throw d="PowerAppsAppService: _getAppsAsync: Error getting paged app data.",d+=p.errorMessage||"",new i.ApplicationError(d);return[2,p.items]}}))}))},e._getAppInfosAsync=function(e,t,n,r,o,i){return void 0===i&&(i=!1),__awaiter(this,void 0,Promise,(function(){var a,s;return __generator(this,(function(c){switch(c.label){case 0:return[4,this._getAppsAsync(e,t,n,r,o)];case 1:return a=c.sent(),s=[],i?a.forEach((function(e){var t=d.AppInfoParser.parseUnifiedAppInfo(e);null!==t&&s.push(t)})):a.forEach((function(e){var t=d.AppInfoParser.parseAppInfo(e);null!==t&&s.push(t)})),[2,s]}}))}))},e._getModelAppsAsync=function(e,t,n,r,o){return __awaiter(this,void 0,Promise,(function(){var i,a;return __generator(this,(function(s){switch(s.label){case 0:return[4,this._getAppsAsync(e,t,n,r,o)];case 1:return i=s.sent(),a=[],i.forEach((function(e){var t=d.AppInfoParser.parseModelAppInfo(e);null!==t&&a.push(t)})),[2,a]}}))}))},e.prototype._parseValidateAppDisplayNameResponse=function(e){var t=b.zh.safeCast(e);if(!t)throw new g.SafeCastError("Service.ValidateAppDisplayName");switch(t.validationStatus){case"Available":return{validationStatus:o.Available};case"Malformed":var n={validationStatus:o.Malformed};return t.error&&(n.errorCode=t.error.code,n.errorMessage=t.error.message),i.CoreLog.errorEx("PowerAppsAppService.validateAppDisplayNameAsync","Malformed display name: ".concat(JSON.stringify(t.error)),{error:t.error}),n;case"Unavailable":var r={validationStatus:o.Unavailable,suggestedName:t.suggestedName};return t.error&&(r.errorCode=t.error.code,r.errorMessage=t.error.message),r.errorCode===f.PowerAppsSaveDisplayNameConflictError?i.CoreLog.warningEx("PowerAppsAppService.validateAppDisplayNameAsync","Application display name in use: ".concat(JSON.stringify(t.error)),{error:t.error}):i.CoreLog.errorEx("PowerAppsAppService.validateAppDisplayNameAsync","Unavailable display name: ".concat(JSON.stringify(t.error)),{error:t.error}),r;default:return i.CoreLog.errorEx("PowerAppsAppService.validateAppDisplayNameAsync","Unexpected validation status ".concat(t.validationStatus),{error:null==t?void 0:t.error}),{validationStatus:o.Unexpected}}},e.getAppPageAndLinkFromServerAsync=function(t,n,o,a,s,c){return void 0===n&&(n=y.b.OrgGalleryApps),void 0===s&&(s=!0),__awaiter(this,void 0,Promise,(function(){var s,u,p,l;return __generator(this,(function(d){switch(d.label){case 0:d.label=1;case 1:return d.trys.push([1,3,,4]),s=null,u=m.PowerAppsUtility.getUnifiedAppListEndpoint(c),p=e._getIODataQueryOptionsForUnifiedApps(n),[4,e._getPageAppInfosAndLinkAsync(t,a?new i.Core_Url(a):u,r.getAppsCall,o,p)];case 2:return s=d.sent(),i.Log.trackActivityEvent("PowerAppsAppService.getAppPageAndLinkFromServerAsync",{numberOfApps:s.appInfos.length}),[2,s];case 3:throw l=d.sent(),Object(i.isCanceledError)(l)||i.CoreLog.error("PowerAppsAppService.getAppPageAndLinkFromServerAsync",l),l;case 4:return[2]}}))}))},e._getPageAppInfosAndLinkAsync=function(e,t,n,r,o){var i;return __awaiter(this,void 0,Promise,(function(){var a;return __generator(this,(function(s){switch(s.label){case 0:return[4,this._getPageAppsAsync(e,t,n,r,o)];case 1:return a=s.sent(),[2,{appInfos:(null!==(i=a.appInfos)&&void 0!==i?i:[]).map(d.AppInfoParser.parseUnifiedAppInfo).filter((function(e){return!!e})),nextLink:a.nextLink}]}}))}))},e._getPageAppsAsync=function(e,t,n,r,o){return __awaiter(this,void 0,Promise,(function(){var a,s,c,u,p,d;return __generator(this,(function(y){switch(y.label){case 0:return i.CoreLog.verbose("PowerAppsAppService: _getPageAppsAsync: endPoint : "+t),a=new i.UrlBuilder(t),r&&a.setQueryParam(f.PowerAppEndpoints.pollQueryParam,"true"),s=new l.ODataListItemsTool(a.toString(),m.PowerAppsUtility.getPowerAppsResourceName(),e,n,f.PowerAppsNextLink),(u=m.PowerAppsUtility.tryGetDocumentServerEndpointHeader())&&((c=Object(i.HashTableUtility_create)())[u.headerName]=u.value),[4,s.getItemsAsync(o,void 0,c,!1)];case 1:if(!(p=y.sent()).items)throw d="PowerAppsAppService: _getPageAppsAsync: Error getting paged app data.",d+=p.errorMessage||"",new i.ApplicationError(d);return[2,{appInfos:p.items,nextLink:p.nextLink}]}}))}))},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"ResourceAwaiterPool",(function(){return o}));var r=n(0),o=function(){function e(e){this._resourceAcquirer=e,this._resourceAwaiterCounter=0,this._resourceAwaiters=Object(r.HashTableUtility_create)()}return e.prototype.acquire=function(e,t){var n=this._resourceAcquirer.tryGetResource();if(n.success&&(!e||!e.claims)&&(!e||!e.bypassCache))return Promise.resolve(n.result);if(this._resourceAcquirer.isAcquiring()){var o=this._resourceAwaiterCounter++,i=Object(r.createCompletablePromise)();return this._resourceAwaiters[o]=i,null==t||t.addEventListener("abort",(function(){i.error(Object(r.createCanceledError)())})),i.promise}return this._acquire(e,t)},e.prototype._acquire=function(e,t){var n=this;return this._resourceAcquirer.acquireResource(e,t).then((function(e){return n._notifyAwaiters(e),Promise.resolve(e)}),(function(e){return n._errorAwaiters(e),Promise.reject(e)}))},e.prototype._notifyAwaiters=function(e){var t=this;Object.keys(this._resourceAwaiters).forEach((function(n){t._resourceAwaiters[n].complete(e),delete t._resourceAwaiters[n]}))},e.prototype._errorAwaiters=function(e){var t=this;Object.keys(this._resourceAwaiters).forEach((function(n){t._resourceAwaiters[n].error(e),delete t._resourceAwaiters[n]}))},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"ScopeConsentType",(function(){return o})),n.d(t,"PostConnectionUsageManager",(function(){return a}));var r,o,i=n(0);!function(e){e.userConsent="userConsent",e.adminBypass="adminBypass",e.appCreator="appCreator",e.powerAppsRequired="powerAppsRequired"}(r||(r={})),function(e){e[e.userConsent=0]="userConsent",e[e.adminBypass=1]="adminBypass",e[e.appCreator=2]="appCreator",e[e.powerAppsRequired=3]="powerAppsRequired"}(o||(o={}));var a=function(){function e(e){this._userService=e,this._postConnectionPromiseQueue=new i.PromiseQueue("_postConnectionPromiseQueue"),this._deleteUsagePromiseQueue=new i.PromiseQueue("_deleteUsagePromiseQueue"),this._recordConnectionScopeConsentQueue=new i.PromiseQueue("_recordConnectionScopeConsentQueue"),this._isDisposed=!1}return Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),e.prototype.startPostConnectionUsagesAsync=function(t,n,r){return __awaiter(this,void 0,Promise,(function(){var o,a,s,c=this;return __generator(this,(function(u){switch(u.label){case 0:return i.Log.trackActivityEvent("PostConnectionUsageManager.startPostConnectionUsages",{message:"There are ".concat(t.length," results to save.")}),o={consents:[]},this._userService.getEnvironmentService().tryGetCurrentEnvironment()?(a=this._userService.tryGetConnectionService(),s=[],t.forEach((function(t){if(Object(i.equalsIgnoreCase)(t.apiId,t.connection.apiId)){var u=c._postConnectionPromiseQueue.pushJob((function(){return a.postConnectionUsageAsync(r,t.connection.apiId,t.connection.name,t.localConnectionId,t.actions).then((function(e){i.Log.trackActivityEvent("PostConnectionUsageManager.PostUsage.Success",{message:"Successfully saved consent to use connection with id: ".concat(t.connection.id," for current app.")}),i.CoreLog.verbose("DisambiguationResultProcessor: Successfully saved disambiguation result for {0}.",e.name)}),(function(e){Object(i.isCanceledError)(e)||i.CoreLog.error("PostConnectionUsageManager.PostUsage.Failed",e)}))}));s.push(u),o.consents.push({connectionId:t.connection.id,consentType:e._getServerConsentType(n),scopes:{will:t.connection.apiScopes.will,wont:t.connection.apiScopes.wont}})}else i.CoreLog.errorEx("PostConnectionUsageManager.startPostConnectionUsagesAsync","Cannot post usage for a connection that does not match API ID of the app connection",{eventData:{connectionApi:t.connection.apiId,referenceApi:t.apiId}})})),[4,Object(i.PromiseUtility_join)(s)]):(i.CoreLog.error("PostConnectionUsageManager.startPostConnectionUsages","Cannot get current environment. Abort posting connection usage."),[2]);case 1:return u.sent(),[4,this._recordScopeConsentAsync(o,r)];case 2:return u.sent(),[2]}}))}))},e.prototype._recordScopeConsentAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var n=this;return __generator(this,(function(r){return 0===e.consents.length?[2]:[2,this._recordConnectionScopeConsentQueue.pushJob((function(){return __awaiter(n,void 0,void 0,(function(){var n,r;return __generator(this,(function(o){switch(o.label){case 0:return[4,this._userService.getConnectionServiceAsync()];case 1:n=o.sent(),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,n.recordScopeConsentsAsync(t,e)];case 3:return o.sent(),[3,5];case 4:return r=o.sent(),Object(i.isCanceledError)(r)||i.CoreLog.error("PostConnectionUsageManager._recordScopeConsent",r),[3,5];case 5:return[2]}}))}))}))]}))}))},e._getServerConsentType=function(e){switch(e){case o.adminBypass:return r.adminBypass;case o.appCreator:return r.appCreator;case o.userConsent:return r.userConsent;default:return r.powerAppsRequired}},e.prototype.startDeleteConnectionUsage=function(e,t){var n=this;this._deleteUsagePromiseQueue.pushJob((function(){var r;return n._userService.getConnectionServiceAsync().then((function(t){return(r=t).listConnectionUsagesAsync(e.connection.id)})).then((function(e){var n;if(e.some((function(e){return e.properties.resourceId===t&&(i.Log.trackActivityEvent("PostConnectionUsageManager.startDeleteConnectionUsage",{message:"Found usage to delete.",usageId:e.id}),n=e.id,!0)})),n)return r.deleteConnectionUsageAsync(n)})).then(null,(function(e){Object(i.throwIfCanceled)(e),i.CoreLog.error("PostConnectionUsageManager.startDeleteConnectionUsage",e)}))}))},e.prototype.dispose=function(){this._postConnectionPromiseQueue.cancelAll(),this._postConnectionPromiseQueue=null,this._deleteUsagePromiseQueue.cancelAll(),this._deleteUsagePromiseQueue=null,this._recordConnectionScopeConsentQueue.cancelAll(),this._recordConnectionScopeConsentQueue=null,this._isDisposed=!0},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"xml2json",(function(){return i})),n.d(t,"json2xml",(function(){return a}));var r=n(0),o=n(12);function i(e){var t,n,o=[],i=sax.parser(!0,{trim:!0,normalize:!0,xmlns:!0,position:!0});return i.onerror=function(e){throw new Error(Object(r.CoreUtility_formatString)(AppMagic.Strings.XmlParsingError,e.message))},i.onopentag=function(e){var r={},i=void 0!==n?n[e.name]:n;void 0===i?i=r:(i instanceof Array||(i=[i]),i.push(r));for(var a=Object.keys(e.attributes),s=a.length,c={},u=0;u<s;u++){var p=e.attributes[a[u]];"string"!=typeof p&&("xmlns"!==p.prefix&&"xmlns"!==p.name&&(c[p.name]=p.value))}r.$name=e.name,r.$ns=JSON.parse(JSON.stringify(e.ns)),r.$attributes=c,void 0===t?t=n=r:(n[e.name]=i,o.push(n),n=r)},i.oncdata=function(e){void 0===n.$text?n.$text=e:n.$text+=e},i.ontext=function(e){void 0===n.$text?n.$text=e:n.$text+=e},i.onclosetag=function(e){n=o.pop()},i.onend=function(){},i.write(e).close(),t}function a(e,t){void 0===t&&(t=!1);var n=function(e){var t,r,i="<"+e.$name;if(void 0!==e.$ns){var a=e.$ns,s=Object.keys(a);for(t=0,r=s.length;t<r;t++){var c=s[t];i+=" xmlns",""!==c&&(i+=":"+c),i+='="'.concat(Object(o.e)(a[c]),'"')}}if(void 0!==e.$attributes){var u=e.$attributes,p=Object.keys(u);for(t=0,r=p.length;t<r;t++){var l=p[t];i+=" ".concat(l,'="').concat(Object(o.e)(u[l]),'"')}}i+=">","string"==typeof e.$text&&(i+=Object(o.e)(e.$text));var d=Object.keys(e);for(t=0,r=d.length;t<r;t++){var f=d[t];if("$"!==f.charAt(0)){var y=e[f];if(y instanceof Array)for(var m=0,g=y.length;m<g;m++)i+=n(y[m]);else i+=n(y)}}return i+="</"+e.$name+">"};return(t?"":'<?xml version="1.0" encoding="utf-8"?>')+n(e)}},function(e,t,n){"use strict";n.r(t),n.d(t,"FlowMetadata",(function(){return r})),n.d(t,"FlowMetadataEx",(function(){return o})),n.d(t,"FlowConnectionReference",(function(){return i}));var r=function(){return function(e,t,n,r,o,i,a,s,c,u,p,l,d,f){this.id=e,this.apiId=t,this.name=r,this.displayName=n,this.isRunning=i,o&&(this.lastModifiedTime=o),a&&(this.lastRunTime=a),s&&(this.flowTriggerUri=s),this.flowTriggerType=c,this.flowTriggerKind=u,this.flowTriggerTypeIconUri=p,this.solutionId=l,this.workflowEntityId=d,this.properties=f}}(),o=function(e){function t(t,n,r,o,i,a,s,c,u,p,l,d,f,y,m){var g=e.call(this,n,r,o,i,a,s,c,u,p,l,d,f,y,m)||this;return g.connections=t,g}return __extends(t,e),t}(r),i=function(){return function(e,t,n,r,o,i){this.name=e,this.id=t,this.displayName=n,this.iconUri=r,this.connectionName=o,this.source=i}}()},function(e,t,n){"use strict";n.r(t),n.d(t,"OAuthTokenConnectionParameter",(function(){return i}));n(0);var r=n(121),o=n(6),i=function(e){function t(t,n){var r=e.call(this,o.r.OAuthSetting,n)||this;return r._oAuthSettings=t,r}return __extends(t,e),Object.defineProperty(t.prototype,"oAuthSettings",{get:function(){return this._oAuthSettings},enumerable:!1,configurable:!0}),t}(r.a)},function(e,t,n){"use strict";n.r(t),n.d(t,"LocalConnectionReferenceStore",(function(){return c}));var r=n(0),o=n(2),i=n(1),a=n(52),s=n(9),c=function(){function e(){this._references=Object(r.HashTableUtility_create)()}return e.prototype.addConnections=function(e){var t=this;e.forEach((function(e){return t.add(e.id,e)}))},e.prototype.add=function(e,t){this._references[e]=t,this._logReferenceTelemetry(t)},e.prototype.setConnectionReferencesFromJson=function(t){this._references=Object(r.HashTableUtility_create)();var n=e.deserialize(t);this.addConnections(n)},e.prototype.get=function(e){if(!this._references[e])throw new Error("There is no connectionReference for ID: ".concat(e));return this._references[e]},e.prototype.tryGet=function(e){return r.CoreLog.verbose("LocalConnectionReferenceStore:get reference for referenceId: {0}",e),this._references[e]||null},e.prototype.tryGetFromConnectionId=function(e){for(var t=this.getAll(),n=0,o=t.length;n<o;n++)if(Object(r.equalsIgnoreCase)(t[n].connectionInstanceId,e))return t[n];return null},e.prototype.getAppDatasetIdsByConnectionId=function(e){var t=[];return Object(r.forEach)(this._references,(function(n){n.datasets&&Object(r.equalsIgnoreCase)(n.connectionInstanceId,e)&&Object(r.forEach)(n.datasets,(function(e,n){t.push(n)}))})),t},e.prototype.hasConnectionApiReference=function(e){return Object(r.some)(this._references,(function(t){return Object(r.equalsIgnoreCase)(t.connectionRef.id,e)}))},Object.defineProperty(e.prototype,"hasConnections",{get:function(){return!Object(r.HashTableUtility_isEmpty)(this._references)},enumerable:!1,configurable:!0}),e.prototype.getOrCreateReferenceId=function(e){for(var t=this.getAll(),n=0,o=t.length;n<o;n++)if(Object(r.equalsIgnoreCase)(t[n].connectionInstanceId,e.id))return t[n].id;return Object(r.generate128BitUUID)()},e.prototype.update=function(e,t){r.CoreLog.verbose("LocalConnectionReferenceStore: update reference from referenceId: {0}",t.id),this._references[e]=t},e.prototype.delete=function(e){delete this._references[e]},e.prototype.getAll=function(){return Object(r.getValues)(this._references)},e.deserialize=function(e,t){r.CoreLog.verbose("LocalConnectionReferenceStore: attempting to parse references from JSON. ReferenceJson: {0}",e),r.CoreLog.verbose("LocalConnectionReferenceStore: attempting to parse references from JSON to append. ReferenceJson: {0}",Object(r.isUndefined)(t)?"<undefined>":t);var n=[];if(!Object(r.isNonEmptyNonWhitespaceString)(e)){if(!Object(r.isNonEmptyNonWhitespaceString)(t))return n;e="{}"}try{var s=Object(r.tryParseJson)(e);if(!Object(r.isJsonObject)(s))throw new Error("Failed to parse referencesJson JSON.");if(Object(r.isNonEmptyNonWhitespaceString)(t)){var c=Object(r.tryParseJson)(t);Object(r.isJsonObject)(c)&&Object.assign(s,c)}return Object.keys(s).forEach((function(e){var t,c=s[e],u=i.Vf.safeCast(c);if(!u){var p="LocalConnectionReferenceStore: error parsing reference from JSON. ReferenceId: "+e;throw r.CoreLog.error("LocalConnectionReferenceStore.deserialize",p),new Error(p)}u[o.hiddenParametersTag]&&u[o.hiddenParametersTag][o.ParameterHintNames.msFlowWorkflowName]&&(u.connectionRef.parameterHints||(u.connectionRef.parameterHints={}),u.connectionRef.parameterHints[o.ParameterHintNames.msFlowWorkflowName]={value:u[o.hiddenParametersTag][o.ParameterHintNames.msFlowWorkflowName]},u[o.hiddenParametersTag][o.ParameterHintNames.msWorkflowEntityId]&&(u.connectionRef.parameterHints[o.ParameterHintNames.msWorkflowEntityId]={value:u[o.hiddenParametersTag][o.ParameterHintNames.msWorkflowEntityId]}),u.connectionRef.parameterHintsV2||(u.connectionRef.parameterHintsV2={}),u.connectionRef.parameterHintsV2[o.ParameterHintNames.msFlowWorkflowName]={value:u[o.hiddenParametersTag][o.ParameterHintNames.msFlowWorkflowName]},u[o.hiddenParametersTag][o.ParameterHintNames.msWorkflowEntityId]&&(u.connectionRef.parameterHintsV2[o.ParameterHintNames.msWorkflowEntityId]={value:u[o.hiddenParametersTag][o.ParameterHintNames.msWorkflowEntityId]}),delete u[o.hiddenParametersTag]),u.connectionInstanceId&&(u.connectionInstanceId=u.connectionInstanceId.toLowerCase()),Object(r.isArray)(u.dependencies)?(0!==u.dependencies.length&&r.CoreLog.error("LocalConnectionReferenceStore.deserialize","Dependencies should have remained unused while it was an array."),u.dependencies=Object(r.HashTableUtility_create)()):u.dependencies=Object(r.fromJsonObject)(u.dependencies),u.dependents=Object(r.isDefined)(u.dependents)?u.dependents:[],u.datasets=Object(r.isDefined)(u.datasets)?Object(r.fromJsonObject)(u.datasets):Object(r.HashTableUtility_create)(),Object(r.forEach)(u.datasets,(function(e){Object(r.isDefined)(e.dataSources)&&(e.dataSources=Object(r.fromJsonObject)(e.dataSources))})),u.connectionParameters&&(Object(a.isEndpointDlpEnabledForApi)(null===(t=u.connectionRef)||void 0===t?void 0:t.id)&&(u.endpoints=Object(a.getEndpointsFromConnectionParameters)(u,u.connectionParameters)),delete u.connectionParameters),n.push(u)})),r.CoreLog.verbose("LocalConnectionReferenceStore: successfully parsed references from JSON.",n),n}catch(t){r.CoreLog.errorEx("LocalConnectionReferenceStore.deserialize","Error parsing references from JSON. References: "+e,{error:t}),n=[]}return n},e.prototype.isSqlV2Connection=function(e){var t=this.tryGet(e);return!(!t||!t.connectionRef)&&Object(a.isSqlV2LocalConnection)(t)},e.prototype.load=function(e){this._references=e},e.prototype.serialize=function(){r.CoreLog.verbose("LocalConnectionReferenceStore: attempting to save references to JSON.");var e=JSON.stringify(this._references);return r.CoreLog.verbose("LocalConnectionReferenceStore: successfully saved references to JSON. ReferencesJson: {0}",e),e},e.prototype.clear=function(){r.CoreLog.verbose("LocalConnectionReferenceStore: clearing current references."),this._references=Object(r.HashTableUtility_create)()},e.prototype._logReferenceTelemetry=function(e){(null==e?void 0:e.datasets)&&Object(r.equalsIgnoreCase)(e.connectionRef.id,s.ApiIds.SharepointOnline)&&Object(r.forEach)(e.datasets,(function(t,n){var o=!1;if(t.dataSources&&!Object(r.HashTableUtility_isEmpty)(t.dataSources)&&(t.datasetOverride&&(o=!0),!Object(r.every)(t.dataSources,(function(e,t){return o&&!!e.tableNameOverride||!o&&!e.tableNameOverride})))){var i={connRefId:e.id,datasetRef:n,datasetEnvVarExists:o,tableNameEnvVarExists:!o};r.Log.trackActivityEvent("DataSetTableNameOverrideMismatch",i);var a=Core.Utility.formatString(AppMagic.Strings.DataSetTableNameOverrideMismatchMessage,n);Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.Connection,"DataSetTableNameOverrideMismatch",{errorMessage:a,traceData:i},Core.Diagnostics.MonitorLogLevel.Error)}}))},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"XmlHttpRequestSerializer",(function(){return s}));var r=n(0),o=n(3),i=n(23),a=n(11),s=(n(33),function(){function e(){}return e.prototype.serialize=function(e){var t=Object(a.parseResponseHeaders)(e,(function(e){return e.toLowerCase()})),n={status:e.status,headers:t,responseType:e.responseType},r=e.responseType.toLowerCase();(e.getResponseHeader(o.HeaderName.ContentType)||"").toLowerCase();return this._isResponseArrayBufferOrBlob(r)?n.response=e.response:(n.response=e.responseText,n.responseText=e.responseText),n},e.prototype.deserialize=function(e){var t={status:e.status,responseType:e.responseType,getResponseHeader:function(t){var n=e.headers[t.toLowerCase()];return Object(r.isUndefined)(n)?null:n}};return Object(r.isDefined)(e.response)&&(t.response=e.response),Object(r.isDefined)(e.responseText)&&(t.responseText=e.responseText),t},e.prototype._isResponseArrayBufferOrBlob=function(e){return e===i.ResponseTypes.Blob||e===i.ResponseTypes.ArrayBuffer},e}())},function(e,t,n){"use strict";var r;n.r(t),n.d(t,"AuthenticationStatus",(function(){return r})),function(e){e[e.inProgress=0]="inProgress",e[e.success=1]="success",e[e.cancel=2]="cancel",e[e.invalidUrl=3]="invalidUrl",e[e.httpError=4]="httpError"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r,o=n(0);!function(e){e.RegionName="int",e.endpointTitle="Int",e.docServerEndpoint=new o.Core_Url("https://int.create.powerapps.com/"),e.playerResourcesEndpoint=new o.Core_Url("https://paplayerintcdn.azureedge.net/"),e.InstallGatewayLinkUrl=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkID=817346"),e.appDownloadRootEndPoint=new o.Core_Url("https://apps.int.powerapps.com/open/")}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"ErrorWithResponseTypes",(function(){return i}));var r=n(0),o=n(12),i=function(e){function t(n,r){var o=this;return(o=e.call(this,n)||this)._responseTypes=t._getResponseTypes(r),o}return __extends(t,e),Object.defineProperty(t.prototype,"responseTypes",{get:function(){return this._responseTypes},enumerable:!1,configurable:!0}),t._getResponseTypes=function(e){if(void 0===e)return"response undefined";if(null===e)return"null";if(Array.isArray(e))return"array";if("object"!=typeof e)return typeof e;var t;try{t=Object(o.c)(e,!0)}catch(e){r.CoreLog.errorEx("PowerAppsConnectionService._getResponseTypes",{error:e})}return JSON.stringify(t)},t}(r.ErrorBase)},function(e,t,n){"use strict";var r;n.r(t),n.d(t,"ConnectionStatus",(function(){return r})),function(e){e[e.Connected=0]="Connected",e[e.Disconnected=1]="Disconnected"}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"HttpClientSupportedXhrResponseTypes",(function(){return o}));var r=n(23),o=[r.ResponseTypes.Text,r.ResponseTypes.Json,r.ResponseTypes.ArrayBuffer,r.ResponseTypes.Blob,r.ResponseTypes.PABinary]},function(e,t,n){"use strict";var r;n.r(t),n.d(t,"PlanValidationResult",(function(){return r})),function(e){e[e.noMissingPlans=1]="noMissingPlans",e[e.requiredPlansNotFound=2]="requiredPlansNotFound",e[e.expiredPlanFound=3]="expiredPlanFound"}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"BooleanParamValueStringifier",(function(){return a})),n.d(t,"NumberParamValueStringifier",(function(){return s})),n.d(t,"StringParamValueStringifier",(function(){return c})),n.d(t,"DateTimeParamValueStringifier",(function(){return u})),n.d(t,"DateParamValueStringifier",(function(){return p}));n(0);var r=n(37),o=n(29),i=(n(7),n(55)),a=function(){function e(){}return e.prototype.getStringValue=function(e){return e.toString()},e}(),s=function(){function e(e){this._xsdType=e}return e.prototype.getStringValue=function(e){return Object(i.coerceNumberToXsdNumericType)(e,this._xsdType).toString()},e}(),c=function(){function e(){}return e.prototype.getStringValue=function(e){return e},e}(),u=function(){function e(){}return e.prototype.getStringValue=function(e){return Object(o.convertDateTimeStringFromDValue)(r.DateTimeBehavior.UserLocal,e)},e}(),p=function(){function e(){}return e.prototype.getStringValue=function(e){return Object(o.convertDateStringFromDValue)(e)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"safeCast",(function(){return a})),n.d(t,"isValid",(function(){return s})),n.d(t,"safeCastAndThrowIfError",(function(){return c})),n.d(t,"parse",(function(){return u}));var r=n(0),o=n(45),i=n(70);function a(e){return s(e)?e:null}function s(e){return Object(r.isObject)(e)?Object(r.isStringOrUndefined)(e.error)?!!Object(r.isNonEmptyString)(e.error)||(Object(r.isString)(e.accessToken)?(i.JsonWebToken.tryParse(e.accessToken)||r.CoreLog.warningEx("".concat("AuthenticationResult",".isValid"),"Can not parse access token as JsonWebToken"),Object(r.isEmptyString)(e.idToken)&&(r.Log.trackActivityEvent("".concat("AuthenticationResult",".safeCastAndThrowIfError"),{message:"idToken was empty, using accessToken for idToken."}),e.idToken=e.accessToken),Object(r.isString)(e.idToken)?Object(r.isDate)(e.expiresOn)?!!Object(r.isBooleanOrUndefined)(e.fromCache)||(r.CoreLog.errorEx("".concat("AuthenticationResult",".isValid"),"authenticationResult.fromCache is not valid"),!1):(r.CoreLog.errorEx("".concat("AuthenticationResult",".isValid"),"authenticationResult.expiresOn is not a date"),!1):(r.CoreLog.errorEx("".concat("AuthenticationResult",".isValid"),"authenticationResult.idToken is not a string"),!1)):(r.CoreLog.errorEx("".concat("AuthenticationResult",".isValid"),"authenticationResult.accessToken is not a string"),!1)):(r.CoreLog.errorEx("".concat("AuthenticationResult",".isValid"),"authenticationResult.error is not valid"),!1):(r.CoreLog.errorEx("".concat("AuthenticationResult",".isValid"),"authenticationResult is not an object"),!1)}function c(e){var t=a(e);if(null===t)throw r.CoreLog.error("".concat("AuthenticationResult",".safeCastAndThrowIfError"),"Failed ".concat("AuthenticationResult",".safeCast")),new o.AuthenticationError(o.AuthenticationErrorKind.InvalidAuthenticationResult,"Safe cast for ".concat("AuthenticationResult"," failed."));if(Object(r.isNonEmptyString)(t.error))throw r.CoreLog.error("".concat("AuthenticationResult",".safeCastAndThrowIfError"),"Failed to acquire token"),new o.AuthenticationError(o.AuthenticationErrorKind.ServerError,t.error,void 0,!1);return t}function u(e){var t=c(e),n=Date.now(),i=t.expiresOn.getTime(),a=i-n;if(a||(r.Log.trackActivityEvent("".concat("AuthenticationResult",".parse"),{tokenTimeStamp:n,expiresOn:"stringRepresentation: ".concat(t.expiresOn.toString()),message:"Adding a window of 4 minutes"}),a=24e4),!(Object(r.isWebAuthoring)()||Object(r.isWebPlayerUsingMsal)()||Object(r.isWebPlayerAuthFlowProxyEnabled)()||Object(r.isWebPlayerAppHost)())&&(!(a=Math.floor(.9*a))||a<=0)){var s="Token found expired at ".concat(n," with expiryDate ").concat(i," and ").concat(t.expiresOn.toString());throw r.CoreLog.error("".concat("AuthenticationResult",".parse"),s),new o.AuthenticationError(o.AuthenticationErrorKind.InvalidAuthenticationResult,s)}return{accessToken:t.accessToken,idToken:t.idToken,expiresOn:new Date(n+a),error:t.error,fromCache:t.fromCache}}},function(e,t,n){"use strict";var r;n.r(t),n.d(t,"BrowserType",(function(){return r})),function(e){e[e.WebView=0]="WebView",e[e.System=1]="System"}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"tryMapErrorResponse",(function(){return p})),n.d(t,"tryGetToastWithLinksMessageData",(function(){return d}));var r=n(0),o=n(16),i=n(35),a=(n(64),n(18)),s=n(1),c=new r.Lazy((function(){return Object(r.isAuthoringTool)()?Object(r.HashTableUtility_create)({403:{AccessPremiumConnectionNotAllowed:{message:AppMagic.Strings.ConnectionHubAddConnectionPremiumPlanErrorMessage,linkClickHandlers:[function(){return Core.UI.Utility.launchInBrowser(o.Region.getCurrentRegion().clientConsentEndPoint.toString()),Promise.resolve()}]}},500:{_client_internal_default_:{message:AppMagic.Strings.ConnectionHubRPServerErrorDefaultErrorMessage}},502:{_client_internal_default_:{message:AppMagic.Strings.ConnectionHubRPServerErrorDefaultErrorMessage}},503:{_client_internal_default_:{message:AppMagic.Strings.ConnectionHubRPServerErrorDefaultErrorMessage}},504:{_client_internal_default_:{message:AppMagic.Strings.ConnectionHubRPServerErrorDefaultErrorMessage}}}):Object(r.HashTableUtility_create)()})),u=new r.Lazy((function(){return Object(r.isAuthoringTool)()?Object(r.HashTableUtility_create)({401:{_client_internal_default_:{message:AppMagic.Strings.ConnectionHubConnectorUnauthorizedDefaultErrorMessage}},423:{_client_internal_default_:{message:AppMagic.Strings.ConnectionHubConnectorLockedDefaultErrorMessage}},429:{_client_internal_default_:{message:AppMagic.Strings.ConnectionHubConnectorTooManyRequestsDefaultErrorMessage}}}):Object(r.HashTableUtility_create)({401:{_client_internal_default_:{message:AppMagic.Strings.ConnectionHubConnectorPlayerUnauthorizedDefaultErrorMessage}}})}));function p(e,t){if(!e)return null;switch(t){case a.e:case a.d:return function(e){var t,n=Object(r.tryParseJson)(e.responseText);if(n){var o=s.yg.safeCast(n);o&&(t=o.error.code)}return l(c.value,e.status,t)}(e);case a.b:return function(e){var t,n=e.responseText?Object(r.tryParseJson)(e.responseText):null;if(n){var o=s.X.safeCast(n);o&&(t=o.code)}return l(u.value,e.status,t)}(e);case a.a:case a.c:}return null}function l(e,t,n){var r=e[t];if(r){if(n){var o=r[n];if(o)return o}var i=r._client_internal_default_;if(i)return i}return null}function d(e,t,n){if(!t||!Object(i.errorHasHttpResponse)(t))return null;if(e!==a.b)return null;switch(t.response.status){case 401:return{message:AppMagic.Strings.ConnectionHubConnectorToastWithLinksFixUnauthenticatedConnectionsMessage,linkClickHandlers:[n.fixUnauthenticatedConnections]}}return null}},function(e,t,n){"use strict";n.r(t),n.d(t,"AppComponentUpdateInfos",(function(){return o})),n.d(t,"AppComponentUpdateInfo",(function(){return i}));var r=n(0),o=function(){function e(){}return e.safeCast=function(e){if(!e||!Object(r.isArray)(e))return r.CoreLog.errorEx("AppComponentUpdateInfos.safeCast","Invalid AppComponentUpdateInfos value."),[];var t=e,n=[];return t.forEach((function(e){var t=i.safeCast(e);t&&n.push(t)})),t.length!=n.length?(r.CoreLog.errorEx("AppComponentUpdateInfos.safeCast","Invalid AppComponentUpdateInfos value."),null):n},e}(),i=function(){function e(){}return e.safeCast=function(t){var n;return e.validateCore(t)?{appComponentName:t.appComponentName,displayName:null!==(n=t.displayName)&&void 0!==n?n:"",appComponentLibraryName:t.appComponentLibraryName,currentAppVersion:t.currentAppVersion,latestAppVersion:t.latestAppVersion,isDeleted:t.isDeleted}:(r.CoreLog.errorEx("AppComponentUpdateInfo.safeCast","Invalid AppComponentUpdateInfo value."),null)},e.validateCore=function(e){return!(null===e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||"string"!=typeof e.appComponentName||void 0!==e.displayName&&"string"!=typeof e.displayName||"string"!=typeof e.appComponentLibraryName||void 0!==e.currentAppVersion&&"string"!=typeof e.currentAppVersion||"string"!=typeof e.latestAppVersion||"boolean"!=typeof e.isDeleted)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"UserIdentity",(function(){return a}));var r=n(0),o=n(70),i=n(289),a=function(){function e(e,t,n,r,o,i,a){void 0===i&&(i=!1),void 0===a&&(a=!1),this._email=e,this._fullName=t,this._isGuest=i,this._isPersonalAccount=a,this._objectId=n,this._tenantId=r,this._serializedJsonString=o}return Object.defineProperty(e.prototype,"tenantId",{get:function(){return this._tenantId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"objectId",{get:function(){return this._objectId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"email",{get:function(){return this._email},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullName",{get:function(){return this._fullName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isGuest",{get:function(){return this._isGuest},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPersonalAccount",{get:function(){return this._isPersonalAccount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serializedJsonString",{get:function(){return this._serializedJsonString},enumerable:!1,configurable:!0}),e.fromJsonWebToken=function(t){var n=o.JsonWebToken.tryParse(t);if(null===n)return null;var r=i.a.safeCast(n.payload);if(null===r)return null;var a=!1,s=!1;if(r.idp){a=r.idp!==r.iss;s="live.com"===r.idp||r.idp.indexOf("9188040d-6c67-4c5b-b112-36a304b66dad")>=0}var c=e.getUserFullName(r.given_name,r.family_name,r.name);return a&&r&&r.unique_name&&r.unique_name.includes("#")&&(r.unique_name=r.unique_name.substr(r.unique_name.indexOf("#")+1)),new e(r.unique_name||r.preferred_username,c,r.oid,r.tid,t,a,s)},e.getUserFullName=function(e,t,n){return e&&!Object(r.isEmptyString)(e)?t&&!Object(r.isEmptyString)(t)?e+" "+t:e:n&&!Object(r.isEmptyString)(n)?n:t||""},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n(0);var r=n(6),o=(n(1),function(){function e(e,t){this._type=e,this._uiDefinition=t,this._isUserValueRequired=this._requiresUserValue()}return Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uiDefinition",{get:function(){return this._uiDefinition},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRequiredUiParameter",{get:function(){return this._uiDefinition&&this._uiDefinition.constraints&&"true"===this._uiDefinition.constraints.required},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isUserValueRequired",{get:function(){return this._isUserValueRequired},enumerable:!1,configurable:!0}),e.prototype.isRequiredCloudParameter=function(){return this._isUserValueRequired&&this.isRequiredUiParameter&&(void 0===this._uiDefinition.constraints.capability||0===this._uiDefinition.constraints.capability.length||this._uiDefinition.constraints.capability.indexOf("cloud")>=0)},e.prototype._requiresUserValue=function(){if(!this.uiDefinition)return!1;switch(this.type){case r.r.Array:case r.r.Boolean:case r.r.Integer:case r.r.Object:case r.r.SecureObject:case r.r.SecureString:case r.r.String:return!0;case r.r.Connection:case r.r.GatewaySetting:case r.r.OAuthSetting:default:return!1}},e}())},function(e,t,n){"use strict";n.r(t),n.d(t,"HttpResponseErrorKind",(function(){return r})),n.d(t,"SendHttpInvalidResponseError",(function(){return i}));n(0);var r,o=n(71);!function(e){e[e.ResponseNotJsonNorText=0]="ResponseNotJsonNorText",e[e.ResponseInvalidJson=1]="ResponseInvalidJson",e[e.ResponseNotBlob=2]="ResponseNotBlob"}(r||(r={}));var i=function(e){function t(t,n,r,o){void 0===o&&(o=null);var i=e.call(this,t,n,{requestUrl:o})||this;return i._errorKind=r,i}return __extends(t,e),Object.defineProperty(t.prototype,"errorKind",{get:function(){return this._errorKind},enumerable:!1,configurable:!0}),t}(o.SendHttpErrorWithResponse)},function(e,t,n){"use strict";n.r(t),n.d(t,"TypedRequestParamBase",(function(){return i}));var r=n(90),o=n(10),i=function(e){function t(t,n,r){var o=e.call(this,n)||this;return o._typeRef=t,o._validTTypeValueKinds=r,o}return __extends(t,e),t.prototype._convertFromDValueAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(n){return t=this._typeRef.getType(),[2,Object(o.convertFromDValueAsync)(t,e)]}))}))},t}(r.RequestParamBase)},function(e,t,n){"use strict";n.r(t),n.d(t,"parseComponentInfo",(function(){return s}));var r=n(0),o=n(1),i=n(43),a=n(38);function s(e){var t;try{var n=o.Ig.safeCast(e);if(null===n)throw new Error("Invalid component info.");var s=n.description||null,c=n.appComponentName||null,u=n.displayName||null,p=n.appName||null,l=n.appVersion||null,d=null!==(t=n.appComponentLibraryLogicalName)&&void 0!==t?t:null,f=n.appDisplayName||null,y=n.environmentName||null,m=n.owner||null,g=n.thumbnailUri||null,v=n.iconUri||null,b=n.allowCustomization||!1,h=n.createdOn?n.createdOn:null,A=n.lastModifiedOn?n.lastModifiedOn:null,C=n.tags||null,P=n.componentType?function(e){switch(e.toLowerCase()){case"function":return a.ComponentType.Function;case"data":return a.ComponentType.Data;case"canvas":return a.ComponentType.Canvas;case"command":return a.ComponentType.Command;default:return a.ComponentType.NotSpecified}}(n.componentType):null;return{appComponentName:c,displayName:u,description:s,appName:p,appVersion:l,appComponentLibraryLogicalName:d,appDisplayName:f,environmentName:y,owner:m,thumbnailUri:g,iconUri:v,allowCustomization:b,createdOn:h,lastModifiedOn:A,tags:C,connectionReferences:Object(r.isValue)(n.connectionReferences)?Object(r.map)(n.connectionReferences,(function(e){return i.AppInfoParser.parseConnectionReference(e,!1)}),!1):Object(r.HashTableUtility_create)(),databaseReferences:Object(r.isValue)(n.databaseReferences)?Object(r.HashTableUtility_create)(n.databaseReferences):Object(r.HashTableUtility_create)(),componentType:P}}catch(t){return r.CoreLog.error("ComponentInfoParser.parseComponentInfo",t,"AppInfo: "+JSON.stringify(e)),null}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i}));var r,o,i,a=n(0);!function(e){e[e.Operation=0]="Operation",e[e.System=1]="System",e[e.Unknown=2]="Unknown"}(r||(r={})),function(e){e[e.Share=0]="Share",e[e.Update=1]="Update",e[e.Provision=2]="Provision",e[e.ConnectorPushNotification=3]="ConnectorPushNotification",e[e.Test=4]="Test",e[e.Unknown=5]="Unknown"}(o||(o={})),function(e){e.parseSubcategory=function(e){switch(e){case"Share":return o.Share;case"Update":return o.Update;case"Provision":return o.Provision;case"ConnectorPushNotification":return o.ConnectorPushNotification;case"Test":return o.Test;default:return a.CoreLog.warning("NotificationCategories.parseSubcategory","Notification subcategory is invalid. Server passed: "+e),o.Unknown}},e.parseCategory=function(e){switch(e){case"Operation":return r.Operation;case"System":return r.System;default:return a.CoreLog.warning("NotificationCategories.parseCategory","Notification category is invalid. Server passed: "+e),r.Unknown}}}(i||(i={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"CdsEntityObjectTType",(function(){return l}));var r=n(0),o=n(21),i=n(12),a=n(78),s=n(94),c=n(50),u=n(7),p=n(10),l=function(){function e(e,t,n,r,o,i){this._properties=e,this._entityType=t,this._tableName=n,this._entitySetName=r,this._primaryKeyColumns=o,this._primaryNameColumn=i,this._isConvertFromDValueAsync=null}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return u.TTypeValueKind.CdsObject},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return null===this._isConvertFromDValueAsync&&(this._isConvertFromDValueAsync=Object(r.some)(this._properties,(function(e){return!(e.ttypeRef instanceof a.CdsNavigationTTypeRef)&&e.ttypeRef.getType().isConvertFromDValueAsync}))),this._isConvertFromDValueAsync},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tableName",{get:function(){return this._tableName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"primaryKeyColumns",{get:function(){return this._primaryKeyColumns},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"primaryNameColumn",{get:function(){return this._primaryNameColumn},enumerable:!1,configurable:!0}),e.prototype.removeTypeRef=function(t){var n;t instanceof e?n=t:t instanceof c.DelayedLoadingCdsObjectTType&&t.isLoaded&&t.ttype instanceof e&&(n=t.ttype),n&&Object(r.forEach)(this._properties,(function(e){var t,r;(null===(t=e.ttypeRef)||void 0===t?void 0:t.removeType)&&(null===(r=e.ttypeRef)||void 0===r||r.removeType(n.tableName))}))},e.prototype.computeDValueSchema=function(e){return Object(p.computeDValueSchemaForObjectTType)(this._properties,e)},e.prototype.convertFromDValue=function(e,t){var n=Object(r.filter)(this._properties,(function(e){return!(e.ttypeRef instanceof a.CdsNavigationTTypeRef)&&e.ttypeRef.getType().isConvertFromDValueAsync})),o=Object(r.filter)(this._properties,(function(e){return e.ttypeRef instanceof a.CdsNavigationTTypeRef||!e.ttypeRef.getType().isConvertFromDValueAsync}));return Object(r.HashTableUtility_isEmpty)(n)?f(e,o):Object(p.convertFromObjectDValue)(e,n,!0).then((function(t){return f(e,o,t)}))},e.prototype.convertToDValue=function(t,n){if(Object(p.isExpressionRuntime)(n)&&"string"==typeof t)return Object(p.makeODataEntityRecordPointer)(n);var r=d(t,this._properties,n);if(AppMagic.Data.DataValue.isBlankOrErrorValue(r))return r;var o=null,i=this._primaryKeyColumns.map((function(e){return r[e]}));if(e._isPkValuesValid(i))o=1===i.length?i[0].toString():JSON.stringify(i);else if(!Object(p.isExpressionRuntime)(n))return null;var a={entityType:this._entityType,canonicalId:o,tableName:this._tableName,entitySetName:this._entitySetName,source:"cdsNative"};return o?AppMagic.Data.DataEntityRecord.makeEntityRecord(r,a):AppMagic.Data.DataEntityRecord.makeStagedEntityRecord(r,a)},e._isPkValuesValid=function(e){return!(!e||0===e.length||1===e.length&&!e[0])},e.prototype.getPropTValueFromAnnotations=function(e,t){var n,r=this.primaryKeyColumns&&this.primaryKeyColumns[0];if(r){var i=e[t],a=e["".concat(t).concat(o.ODataConstants.MetadataPropertyName.FormattedValue)],s=((n={})[r]=i,n);return a&&this.primaryNameColumn&&(s[this.primaryNameColumn]=a),s}},e}();function d(e,t,n){if(null===e)return null;if(!Object(r.isJsonObject)(e)&&!Object(i.n)(e))return Object(r.trace)(r.CategoryNames.Verbose,"parsing",{property:null==n?void 0:n.propertyName,info:Object(r.CoreUtility_formatString)(AppMagic.Strings.ParsingErrorMessage,AppMagic.Strings.ValueTypeObject,Object(p.getLocalizedTTypeName)(e)),issue:AppMagic.Strings.ParsingErrorDetail},r.MonitorLogLevel.Error),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:"",id:-1,propertyName:null==n?void 0:n.propertyName},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null});var u=AppMagic.Data.DataRecord.create(),d=n&&n.isExpressionRuntime;return Object.keys(t).forEach((function(n){var i=t[n],p=i.ttypeRef.getType(),f=i.ttypeRef instanceof a.CdsNavigationTTypeRef;if(!f||void 0!==p){var y=e.hasOwnProperty(n)?e[n]:void 0,m=d&&p instanceof c.DelayedLoadingCdsObjectTType;if(f&&(p instanceof l||m||p instanceof c.DelayedLoadingCdsObjectTType&&p.isLoaded)){var g=i.ttypeRef,v=o.ODataUtility.formatAnnotatedPropName(g.referencingFieldName);if(null!=g.referencingFieldName&&Object(r.isDefined)(e[v])){var b=void 0;if(p instanceof l?b=p:p instanceof c.DelayedLoadingCdsObjectTType&&(b=p.ttype),b){var h=b.getPropTValueFromAnnotations(e,v);y=y?__assign(__assign({},h),y):h}}}var A=d&&p instanceof s.CdsPolymorphicLookupTType;if(Object(r.isDefined)(y)||A){var C={unsafePropertyValues:e,propertyName:n,isExpressionRuntime:d},P=p instanceof s.CdsPolymorphicLookupTType?p.convertToDValue(y,C,i.ttypeRef):p.convertToDValue(y,C);u[n]=P}}})),u}function f(e,t,n){var i=n||{};return Object(r.forEach)(t,(function(t,n){var c=t.ttypeRef.getType(),u=e[n];if(Object(r.isDefined)(u)&&e.hasOwnProperty(n)&&!AppMagic.Data.ErrorValue.isGatedError(u)){if(function(e,t,n,r,i){if(e.ttypeRef instanceof a.CdsNavigationTTypeRef){var s=o.ODataUtility.formatNavigationBindPropertyName(n);if(null===r)i[o.ODataUtility.formatAnnotatedPropName(e.ttypeRef.referencingFieldName)]=null;else if(AppMagic.Data.DataEntityRecord.isODataEntityRecordPointer(r)){var c=AppMagic.Data.DataEntityRecord.tryGetODataIdFromODataEntityRecordPointer(r);i[s]=c}else if(AppMagic.Data.DataEntityRecord.isDataEntityRecord(r)){var u=AppMagic.Data.DataEntityRecord.getCanonicalId(r),p=AppMagic.Data.DataEntityRecord.tryGetEntitySetName(r);i[s]="".concat(p,"(").concat(u,")")}return!0}return!1}(t,0,n,u,i)||function(e,t,n,i){if(e instanceof s.CdsPolymorphicLookupTType){var a=e.convertFromDValue(n);if(Object(r.isStringOrNull)(n))i[t]=a;else{var c=n,u=o.ODataUtility.formatNavigationBindPropertyName(c.NavigationPropertyName);if(AppMagic.Data.PolymorphicLookup.isODataPointer(c))return i[u]=c.odataId,!0;i[u]="".concat(c.EntitySetName,"(").concat(a,")")}return!0}return!1}(c,n,u,i))return;var p=c.convertFromDValue(u);i[n]=p}})),i}},function(e,t,n){"use strict";n.r(t),n.d(t,"IdentityTType",(function(){return s})),n.d(t,"XmlIdentityTType",(function(){return c}));var r=n(0),o=n(5),i=n(7),a=n(12),s=function(){function e(e,t){void 0===t&&(t=!1),this._schema=e,this._isConvertFromDValueAsync=t}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return i.TTypeValueKind.Identity},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return null!==this._schema&&Object(o.isSchemaOfTypeObject)(this._schema)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return this._isConvertFromDValueAsync},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(r.checkValue)(this._schema,"Cannot use computeDValueSchema unless you've also specified the schema in the constructor."),Object(a.r)(this._schema)},e.prototype.convertFromDValue=function(e){return this.isConvertFromDValueAsync?Promise.resolve(e):e},e.prototype.convertToDValue=function(e){return e},e}(),c=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),Object.defineProperty(t.prototype,"TTypeValueKind",{get:function(){return i.TTypeValueKind.XmlIdentity},enumerable:!1,configurable:!0}),t.prototype.convertFromDValue=function(e,t){return null===e?null:e.toString?e.toString():AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null})},t.prototype.convertToDValue=function(e,t){return null===e?null:"string"!=typeof e?AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null}):e},t}(s)},function(e,t,n){"use strict";n.r(t),n.d(t,"JsonTupleTTypeItem",(function(){return s})),n.d(t,"JsonTupleTType",(function(){return c}));var r=n(0),o=n(5),i=n(7),a=n(10),s=function(){function e(e,t){this._ttypeRef=e,this._name=t}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ttypeRef",{get:function(){return this._ttypeRef},enumerable:!1,configurable:!0}),e}(),c=function(){function e(e){this._isConvertFromDValueAsync=null,this._items=e}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return i.TTypeValueKind.JsonArray},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return null===this._isConvertFromDValueAsync&&(this._isConvertFromDValueAsync=this._items.some((function(e){return e.ttypeRef.getType().isConvertFromDValueAsync}))),this._isConvertFromDValueAsync},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){if(e<=0)return Object(o.createSchemaForObjectFromPointer)([]);var t=e-1,n=this._items.map((function(e){var n=e.ttypeRef.getType().computeDValueSchema(t);return n.name=e.name,n}));return Object(o.createSchemaForObjectFromPointer)(n)},e.prototype.convertFromDValue=function(e){return this.isConvertFromDValueAsync?null===e?Promise.resolve(null):this._convertFromDValueAsync(e):null===e?null:this._convertFromDValue(e)},e.prototype._convertFromDValue=function(e){return this._items.map((function(t){var n=e[t.name];if(Object(r.isUndefined)(n)||!e.hasOwnProperty(t.name))throw new Error("itemDValue is undefined");if(AppMagic.Data.ErrorValue.isGatedError(n))throw new Error("itemDValue is error value");return t.ttypeRef.getType().convertFromDValue(n)}))},e.prototype._convertFromDValueAsync=function(e){var t=this._items.map((function(t){var n=e[t.name];if(Object(r.isUndefined)(n)||!e.hasOwnProperty(t.name))return Object(r.throwAsync)(new Error("itemDValue is undefined"));if(AppMagic.Data.ErrorValue.isGatedError(n))return Object(r.throwAsync)(new Error("itemDValue is error value"));var o=t.ttypeRef.getType();return Object(a.convertFromDValueAsync)(o,n)}));return Object(r.PromiseUtility_join)(t)},e.prototype.convertToDValue=function(e,t){if(null===e)return null;if(!Object(r.isArray)(e)){var n=Object(r.CoreUtility_formatString)(AppMagic.Strings.ParsingErrorMessage,AppMagic.Strings.ValueTypeArray,Object(a.getLocalizedTTypeName)(e));return Object(r.trace)(r.CategoryNames.Verbose,"parsing",{property:null==t?void 0:t.propertyName,info:n,issue:AppMagic.Strings.ParsingErrorDetail},r.MonitorLogLevel.Error),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,n,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:n,raiseToastNotification:!1,wasReported:!1,functionName:null})}var o=AppMagic.Data.DataRecord.create();return this._items.forEach((function(t,n){var r=t.ttypeRef.getType(),i=e[n];if(void 0!==i){var a={propertyName:n?n.toString():"",unsafePropertyValues:e};o[t.name]=r.convertToDValue(i,a)}else o[t.name]=null})),o},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r,o=n(0),i=n(86),a=n(217),s=n(2);!function(e){function t(){if(!Object(o.tryGetEnvironmentName)())return null;var e=new a.PowerPlatformApiDiscovery("preprod");return new o.Core_Url("https://".concat(e.getEnvironmentEndpoint(Object(o.tryGetEnvironmentName)())))}e.RegionName="preprod",e.endpointTitle="Preprod",e.docServerEndpoint=new o.Core_Url("https://preprod.create.powerapps.com/"),e.playerResourcesEndpoint=new o.Core_Url("https://paplayercdn-pp.azureedge.net/"),e.appDownloadRootEndPoint=new o.Core_Url("https://apps.preprod.powerapps.com/open/"),e.portalUri=new o.Core_Url("https://make.preprod.powerapps.com"),e.webAuthResource="7f96ed90-4ea5-48c1-b589-81ac94ade0aa",e.getValues=function(){var n=i.a.getValues();return n.name=e.RegionName,n.clusterCategory="preprod",n.endpointTitle=e.endpointTitle,n.portalUri=e.portalUri,n.playerResourcesEndpoint=e.playerResourcesEndpoint,n.appDownloadRootUri=e.appDownloadRootEndPoint,n.powerPlatformRpBaseUrl=t(),n.powerPlatformRpApiVersion=s.PowerAppEndpoints.powerPlatformApiVersion,n.webAuthResource=e.webAuthResource,n},e.getPowerPlatformRpBaseUrl=t}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"PowerAppsConnectionServiceError",(function(){return o}));var r=n(0),o=function(e){function t(t,n){void 0===n&&(n=null);var r=e.call(this,t)||this;return r._diagnosticMessage=n,r}return __extends(t,e),t.prototype.toDiagnosticMessage=function(){return this._diagnosticMessage?this._diagnosticMessage:null},t}(r.ApplicationError)},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t),n.d(t,"AuthorizationScheme",(function(){return r})),n.d(t,"DynamicResourceAuthorizationScheme",(function(){return o})),n.d(t,"formatAppAccessTokenAuthorizationHeader",(function(){return i})),n.d(t,"formatDynamicAccessTokenAuthorizationHeader",(function(){return a}));n(0);var r="paauth",o="dynamicauth";function i(e){return"".concat(r," ").concat(e)}function a(e){return"".concat(o," ").concat(e)}},function(e,t,n){"use strict";n.r(t),n.d(t,"ManualLoginSettings",(function(){return r})),n.d(t,"IConnectionServiceSingletonKey",(function(){return i}));var r,o=n(0);!function(e){e[e.Force=0]="Force",e[e.Disable=1]="Disable"}(r||(r={}));var i=Object(o.createForInterface)("AppMagic.ConnectionHub.IConnectionService")},function(e,t,n){"use strict";n.r(t),n.d(t,"parseUriComponents",(function(){return o})),n.d(t,"parseFormUrlEncodedStringToHashTable",(function(){return i})),n.d(t,"isLaunchableUrl",(function(){return a})),n.d(t,"urlHasProtocol",(function(){return c}));var r=n(0);function o(e){var t=e.indexOf(":");if(-1===t)return null;var n=e.substr(0,t),r=e.indexOf("?"),o=e.indexOf("#");return{scheme:n,authority:null,path:null,query:-1===r?"":e.substring(r+1,-1===o?e.length:o),fragment:-1===o?"":e.substring(o+1)}}function i(e){if(null!==e.match(/[?#]/))return null;var t={};return e.split("&").forEach((function(e){if(e.length>0){var n=e.split("=",2),r=decodeURIComponent(n[0]),o=decodeURIComponent(n[1]);t[r]=o}})),t}function a(e){return!!Object(r.isString)(e)&&!/^(data:)|(javascript:)/i.test(e)}var s=["sip:","tel:","mailto:"];function c(e){var t=e.toLocaleLowerCase();if(s.some((function(e){return 0===t.indexOf(e)})))return!0;return/^[^:]+:(?:(?!\d+\/?)|(?=[^@\s]+@(?:[^.\s]+\.)+[^.\s]+$))/.test(e)}},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(187),i=n(188),a=n(189),s=n(190),c=n(191),u=n(192),p=n(126),l=n(78),d=n(193),f=n(77),y=n(194),m=(n(37),n(195)),g=n(150),v=n(7),b=n(56),h=n(196),A=n(127),C=n(74),P=n(197),w=n(198),S=n(199),O=n(200),R=n(201),_=n(202),T=n(203),I=n(204),E=n(144),U=n(205),j=n(206),N=n(128),D=n(207),V=n(208),M=n(5),k=n(10),L=function(){function e(e){this.dataSetName=e}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return v.TTypeValueKind.String},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sharepointAbsoluteUrl",{get:function(){try{void 0===this._sharepointAbsoluteUrl&&this.dataSetName&&this.dataSetName()&&(this._sharepointAbsoluteUrl=new r.Core_Url(this.dataSetName()).origin(),this._sharepointAbsoluteUrl.endsWith("/")||(this._sharepointAbsoluteUrl+="/"))}catch(e){this._sharepointAbsoluteUrl=void 0,r.Log.trackWarningEvent("SharepointStringTType.sharepointAbsoluteUrl",e)}return this._sharepointAbsoluteUrl},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(M.createSchemaForSimple)(M.TypeString)},e.prototype.convertFromDValue=function(e){return e},e.prototype.convertToDValue=function(e,t){if(null===e)return null;if("string"!=typeof e){var n=Object(r.CoreUtility_formatString)(AppMagic.Strings.ParsingErrorMessage,AppMagic.Strings.ValueTypeString,Object(k.getLocalizedTTypeName)(e));return Object(r.trace)(r.CategoryNames.Verbose,"parsing",{property:null==t?void 0:t.propertyName,info:n,issue:AppMagic.Strings.ParsingErrorDetail},r.MonitorLogLevel.Error),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,n,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:n,raiseToastNotification:!1,wasReported:!1,functionName:null})}return this.sharepointAbsoluteUrl?(e=Object(r.replaceAll)(e,'href="/','href="'.concat(this.sharepointAbsoluteUrl)),Object(r.replaceAll)(e,'src="/','src="'.concat(this.sharepointAbsoluteUrl))):e},e}(),F=n(66),x=n(91),H=n(209),B=n(210),q=n(211),G=n(212),J=n(213),W=n(55),z=n(19),K=n(214),X=n(215);n.d(t,"parseTypesManager",(function(){return Z})),n.d(t,"parseTypedDefinitionMetadata",(function(){return Y})),n.d(t,"parseTypeDefinition",(function(){return ee}));var Q=W.XsdTypeNames,$=AppMagic.Schema;function Z(e,t,n,r,o){void 0===r&&(r=null),void 0===o&&(o=null);var i=new x.TypesManager,a={typesMgr:i,mediaRuntime:t,binaryResolver:n};return Object.keys(e).forEach((function(t){var n=e[t];Object.keys(n.typesbyname).forEach((function(e){var s=ee(n.typesbyname[e],a,{dataSetName:r,connectionApiId:o});i.addType(t,e,s)}))})),i}function Y(e,t,n){if(!Object(r.isDefined)(e.type))return function(e,t){return new F.LazyTTypeRef(e,t.typesMgr)}(e.typeref,t);switch(e.type.deftype){case z.DefTypes.CdsNavigation:return function(e,t,n){if(1===e.targets.length)return new l.CdsNavigationTTypeRef(e.targets[0],t.typesMgr,!!e.isArray,e.referencingFieldName,n);return new y.CdsPolymorphicTTypeRef(e.targets,e.targetFields,t.typesMgr,!!e.isArray,n)}(e.type,t,null==n?void 0:n.dataSourceName);default:var o=ee(e.type,t,n);return new F.InlinedTTypeRef(o)}}function ee(e,t,n){switch(e.deftype){case z.DefTypes.BlobTType:return function(e,t){return new X.PABinaryTType(e.dtype,t.mediaRuntime)}(e,t);case z.DefTypes.Base64TType:return function(e,t){return new K.Base64BinaryTType(e.dtype,t.mediaRuntime,t.binaryResolver)}(e,t);case z.DefTypes.CdpNavigation:return function(e){return new i.CdpNavigationTType(e.targetTable,!!e.isArray)}(e);case z.DefTypes.CdpAttachment:return function(e){return new o.CdpAttachmentTType(e.targetEntity)}(e);case z.DefTypes.CdsAttachment:return function(){return new u.CdsAttachmentTType}();case z.DefTypes.File:return function(e){return new h.FileTType(e.dataSourceType,e.boundDataSource,e.tableName,e.primaryKeyColumns,e.cdsColumnForFileName)}(e);case z.DefTypes.LargeImage:return function(e,t){return new D.LargeImageTType(e.dataSourceType,e.boundDataSource,e.tableName,e.primaryKeyColumns,t.mediaRuntime,e.columnForImageId)}(e,t);case z.DefTypes.CdpPolymorphic:return function(){return new c.CdpPolymorphicLookupTType}();case z.DefTypes.JsonPrimitive:return function(e,t){switch(e.primitive){case z.JsonPrimitives.Boolean:return new P.JsonBooleanTType;case z.JsonPrimitives.Number:var n=Object(r.isDefined)(e.xsdtype)?W.tryParseNumericXsdTypeFromXsdTypeName(e.xsdtype):v.NumericXsdType.Decimal;return new I.JsonNumberTType(e.dtype||$.TypeNumber,n);case z.JsonPrimitives.String:var o=e.dtype||$.TypeString,i=void 0;if(i=(null==t?void 0:t.connectionApiId)===b.DataSourceType.Sharepoint?new L(null==t?void 0:t.dataSetName):new j.JsonStringTType,o===$.TypeString)return i;var a=void 0;switch(o){case $.TypeHyperlink:case $.TypeImage:case $.TypeMedia:case $.TypeBlob:case $.TypeNumber:a=Object(g.createStringConverter)(o);break;default:return}return new m.ConverterTType(i,a);default:return}}(e,n);case z.DefTypes.JsonObject:return function(e,t,n){var r=te(e.properties,t,n);return new E.JsonObjectTType(r)}(e,t,n);case z.DefTypes.JsonUntypedObject:return function(){return new U.JsonUntypedObjectTType}();case z.DefTypes.CdpObjectOptionSet:return function(e,t){return new s.CdpOptionSetTType}();case z.DefTypes.CdpArrayOptionSet:return function(e,t){var n=Y(e.items,t);return new a.CdpOptionSetMultiSelectTType(n)}(e,t);case z.DefTypes.JsonTuple:return function(e,t){var n=e.items.map((function(e){var n=Y(e,t);return new N.JsonTupleTTypeItem(n,e.name)}));return new N.JsonTupleTType(n)}(e,t);case z.DefTypes.JsonArray:return function(e,t){var n=Y(e.items,t);return new C.JsonArrayTType(n)}(e,t);case z.DefTypes.JsonMapObject:return function(e,t){var n=Y(e.values,t);return new T.JsonMapObjectTType(e.keys.fieldname,e.values.fieldname,n)}(e,t);case z.DefTypes.JsonDateTimeString:return function(e){return new R.JsonDateTimeStringTType(e.format,e.behavior)}(e);case z.DefTypes.JsonDateTimeNumber:return function(e){return new O.JsonDateTimeNumberTType}();case z.DefTypes.JsonDateString:return function(e){return new w.JsonDateStringTType}();case z.DefTypes.JsonDateTimeNoTimeZoneString:return function(e){return new S.JsonDateTimeNoTimeZoneStringTType(e.format)}(e);case z.DefTypes.JsonGuid:return function(e){return new _.JsonGuidTType}();case z.DefTypes.SampleXmlElement:return function(e){return new V.SampleXmlElementTType(e.samplexml)}(e);case z.DefTypes.XmlSimpleType:return function(e){var t=W.tryParseNumericXsdTypeFromXsdTypeName(e.basexsdtype);if(null!==t)return new G.XmlNumericTType(t);switch(e.basexsdtype){case Q.Boolean:return new B.XmlBooleanTType;case Q.String:return new J.XmlStringTType;case Q.AnyURI:return new H.XmlAnyUriTType(e.dtype);case Q.DateTime:return new q.XmlDateTimeTType}}(e);case z.DefTypes.IdentityTType:return function(e){var t=e.schema||null,n=!!e.isConvertFromDValueAsync;return new A.IdentityTType(t,n)}(e);case z.DefTypes.XmlSimpleIdentityType:return function(e){var t=e.schema||null;return new A.XmlIdentityTType(t)}(e);case z.DefTypes.CdsOptionSet:return function(e){return new f.CdsOptionSetTType(e.boundDataSet,e.name)}(e);case z.DefTypes.CdsArrayOptionSet:return function(e){var t=e.items.type;return new d.CdsOptionSetMultiSelectTType(t.boundDataSet,t.name)}(e);case z.DefTypes.CdsEntity:return function(e,t,n){var r=te(e.properties,t,n);return new p.CdsEntityObjectTType(r,t.entityType,e.tableName,e.entitySetName,e.primaryKeyColumns,e.primaryNameColumn)}(e,t,n);default:return}}function te(e,t,n){return Object(r.map)(e,(function(e){return{ttypeRef:Y(e,t,n),displayIdx:e.displayidx}}),!1)}},function(e,t,n){"use strict";n.r(t),n.d(t,"AuthenticationBrokerManager",(function(){return i}));var r=n(0),o=n(109),i=(n(117),function(){function e(e){this._broker=e,this._promiseQueue=new r.PromiseQueue("AuthenticationBrokerManager")}return Object.defineProperty(e.prototype,"appCallbackUri",{get:function(){return this._broker.appCallbackUri},enumerable:!1,configurable:!0}),e.prototype.requestAccessToken=function(e,t,n,r){var o=this;return this._promiseQueue.pushJob((function(){return o._requestAccessToken(e,t,n,r)}))},e.hasNativeBrowserSupport=function(){return Object(r.getCordovaPlatformId)()===r.CordovaPlatformId.iOS||Object(r.getCordovaPlatformId)()===r.CordovaPlatformId.Android},e.prototype._requestAccessToken=function(e,t,n,i){if(null!==n){var a=new r.UrlBuilder(e);Object(r.toKeyValuePairArray)(n).forEach((function(e){a.setQueryParam(e.key,e.value)})),e=a.toString()}return this._broker.authenticateAsync(e,t,i).then((function(e){switch(e.authenticationStatus){case o.AuthenticationStatus.success:return"string"!=typeof e.responseData?{success:!1,message:AppMagic.Strings.AuthenticationBrokerManagerErrorNoResponseDataReturnedFromServer,domains:e.navigatedUris}:{success:!0,result:e.responseData,domains:e.navigatedUris};case o.AuthenticationStatus.cancel:return{success:!1,message:AppMagic.Strings.AuthenticationBrokerManagerErrorUserCanceled,domains:e.navigatedUris};case o.AuthenticationStatus.httpError:case o.AuthenticationStatus.invalidUrl:return{success:!1,message:AppMagic.Strings.AuthenticationBrokerManagerErrorHttp,domains:e.navigatedUris}}}))},e.prototype.dispose=function(){},e}())},function(e,t,n){"use strict";n.r(t),n.d(t,"AuthResource",(function(){return r}));var r,o=n(0),i=n(8);!function(e){function t(e){var t=r(e),n=function(e){switch(e){case i.d.PowerBI:return"Power BI";case i.d.FormsPro:return"Forms Pro";case i.d.MicrosoftStream:return"Microsoft Stream";default:return e}}(e);return e&&t&&n?{name:n,resourceId:e,iconUri:t}:null}function n(t){var n=t.toLowerCase();return e.CdsAuthResourceSuffixes.some((function(e){var t=e+"/";return n.endsWith(t)||n.endsWith(e)}))}function r(e){switch(e){case i.d.PowerBI:return"url(".concat(Object(o.getAbsoluteUri)("images/capabilities/powerbi.svg"),")");case i.d.FormsPro:return"url(".concat(Object(o.getAbsoluteUri)("images/capabilities/formspro.svg"),")");case i.d.MicrosoftStream:return"url(".concat(Object(o.getAbsoluteUri)("images/capabilities/microsoftstream.svg"),")");default:return n(e)?"url(".concat(Object(o.getAbsoluteUri)("images/capabilities/cds.svg"),")"):null}}e.CdsAuthResourceSuffixes=[".dynamics.com",".microsoftdynamics.us",".appsplatform.us",".microsoftdynamics.de",".dynamics.cn"],e.serverAuthReferenceFromAuthResource=function(e){return{resourceId:e.resourceId}},e.tryFromServerAuthReference=function(e){return n(e.resourceId)?{resourceId:e.resourceId,name:"",iconUri:""}:t(i.d.tryConvertFromString(e.resourceId))},e.tryFromResourceName=t,e.isCdsAuthResource=n,e.tryGetIconUri=r}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"DisambiguationResultProcessor",(function(){return o}));var r=n(0),o=(n(103),function(){function e(e,t){this._powerAppsClient=t,this._connectionUsageManager=e}return e.prototype.startSaveDisambiguationResultsAsync=function(e,t,n){return r.Log.trackActivityEvent("DisambiguationResultProcessor.saveDisambiguationResults"),this._connectionUsageManager.startPostConnectionUsagesAsync(e,t,n)},e.prototype.saveDisambiguationResultsAndUpdateRuntimeAsync=function(e,t,n){r.CoreLog.verbose("DisambiguationResultProcessor: Starting saveDisambiguationResultsAndUpdateRuntimeAsync");var o=[];return n&&o.push(this.startSaveDisambiguationResultsAsync(e,t,n)),this._powerAppsClient&&o.push(this._powerAppsClient.addDisambiguationResultsAsync(e,n)),Object(r.join)(o).then(r.noOpFn)},e.prototype.validateConnectionUsages=function(e,t,n,o){var i=Object(r.HashTableUtility_create)();return Object(r.forEach)(e,(function(e,a){var s,c,u,p,l,d,f,y;if(!Object(r.equalsIgnoreCase)(e.environmentName,t))return Object(r.trace)(r.CategoryNames.Verbose,"ValidateConnectionUsage",{apiId:e.apiId,info:"Connection is not valid for app environment.",connectionId:e.id,appEnvironment:t,connectionEnvironment:e.environmentName}),void r.Log.trackErrorEvent("DisambiguationResultProcessor.validateConnectionUsage",{connectionId:e.id,message:"Connection is not valid for app environment.",appEnvironment:t,connectionEnvironment:e.environmentName});if(!r.FallbackSwitch.isActivated("AppConnectivity.EnforceSharedConnectionId")&&(null===(s=n[a])||void 0===s?void 0:s.sharedConnectionId)&&!Object(r.equalsIgnoreCase)(e.id,n[a].sharedConnectionId))return Object(r.trace)(r.CategoryNames.Connection,"ValidateConnectionUsage",{apiId:e.apiId,info:"Connection is not valid for shared connection reference",connectionId:e.id,sharedConnectionId:null!==(u=null===(c=n[a])||void 0===c?void 0:c.sharedConnectionId)&&void 0!==u?u:void 0}),void r.Log.trackWarningEvent("DisambiguationResultProcessor.validateConnectionUsage",{connectionId:e.id,message:"Connection is not valid for shared connection reference",sharedConnectionId:n[a].sharedConnectionId});if(!(o||Core.Environment.isReactNativePlayer()||Core.FallbackSwitch.isActivated("AppConnectivity.GranularConsentDialogV2")||Core.Environment.isSharedAppHost()||!((null===(l=null===(p=n[a])||void 0===p?void 0:p.appActions)||void 0===l?void 0:l.length)>0)||(null===(f=null===(d=n[a])||void 0===d?void 0:d.dependents)||void 0===f?void 0:f.length)>0)){var m=null!==(y=e.appActions)&&void 0!==y?y:[];if(n[a].appActions.some((function(e){if(!m.some((function(t){return Core.Utility.equalsIgnoreCase(t,e)})))return!0})))return void r.Log.trackWarningEvent("DisambiguationResultProcessor.validateConnectionUsage",{apiId:e.apiId,message:"Connection usage is not valid for app actions",connectionId:e.id,appActions:n[a].appActions,usageActions:m})}i[a]=e})),i},e}())},function(e,t,n){"use strict";n.r(t),n.d(t,"createCommonJsonRestCallHeaders",(function(){return a})),n.d(t,"getAppPremiumFeaturesRequirements",(function(){return s}));var r,o=n(0),i=n(3);function a(){var e=Object(o.HashTableUtility_create)();return e[i.HeaderName.ContentType]=i.MediaType.ApplicationJson,e[i.HeaderName.Accept]=i.MediaType.ApplicationJson,e}function s(e,t,n){var i=function(e){if(!e||!e.properties||!e.properties.environmentSku)return r.Default;switch(e.properties.environmentSku.toLowerCase()){case"notspecified":return r.NotSpecified;case"default":return r.Default;case"developer":return r.Developer;default:return r.Other}}(n);if(!e&&!t&&i===r.Default)return function(){return{premiumApis:!1,premiumApiIds:[],onPremGateway:!1,customApi:!1,nonDefaultEnvironments:!1}}();if(i===r.Developer)return{premiumApis:!1,premiumApiIds:[],onPremGateway:!1,customApi:!1,nonDefaultEnvironments:!1};var a=i===r.Default||i===r.NotSpecified,s=function(e){var t=new Set;Object(o.forEach)(e,(function(e){(function(e){var t;try{t=AppMagic.ConnectionHub.apiTierParse(e.apiTier,AppMagic.ConnectionHub.ApiTier.Standard)}catch(e){return!1}return t===AppMagic.ConnectionHub.ApiTier.Premium})(e)&&t.add(e.id)}));var n=[];return t.forEach((function(e){return n.push(e)})),n}(e);return t&&!Object(o.HashTableUtility_isEmpty)(t)&&s.push("cdsNative"),{premiumApis:s.length>0,premiumApiIds:s,onPremGateway:c(e),customApi:u(e),nonDefaultEnvironments:!a}}function c(e){return Object(o.some)(e,(function(e){return!!e.isOnPremiseConnection}))}function u(e){return Object(o.some)(e,(function(e){return!!e.isCustomApiConnection}))}!function(e){e[e.NotSpecified=0]="NotSpecified",e[e.Default=1]="Default",e[e.Developer=2]="Developer",e[e.Other=3]="Other"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return b}));var r,o,i=n(0),a=n(41),s=n(17),c=n(3),u=n(35),p=n(44),l=n(4),d=n(8),f=n(42),y=n(18),m=n(14),g=n(30),v=n(1);!function(e){e.appListPackageCall="ListPackageClient.ListPackage"}(r||(r={})),function(e){e[e.Ready=0]="Ready",e[e.InProgress=1]="InProgress",e[e.Error=2]="Error",e[e.AccessError=3]="AccessError",e[e.NotFound=4]="NotFound",e[e.Empty=5]="Empty"}(o||(o={}));var b=function(e){function t(t,n){var r=this;return(r=e.call(this)||this)._httpClient=n,r._pollingHandle=null,"string"==typeof t?(r._appName=AppMagic.PowerApps.PowerAppsUtility.parseAppNameFromAppId(t),r._isUnifiedApp=!1):(r._appName=t.appLogicalName,r._environmentId=t.environmentId,r._isUnifiedApp=!0),r}return __extends(t,e),t.prototype.listPackageAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return[4,this._listPackageAsync()];case 1:return[2,{result:(e=t.sent()).result,status:e.status,error:e.error}]}}))}))},t.prototype.listPackageWithUriAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var n;return __generator(this,(function(r){switch(r.label){case 0:return[4,this._listPackageWithUriAsync(e,t)];case 1:return[2,{result:(n=r.sent()).result,status:n.status,error:n.error}]}}))}))},t.prototype._listPackageWithUriAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var n,r,o;return __generator(this,(function(a){switch(a.label){case 0:return r=AppMagic.PowerApps.PowerAppsUtility.getPowerPlatformRpBaseUrl(),(o=new i.UrlBuilder(r)).appendUrl(e),n=o.toUrl(),[4,this._retryListPackageUntilReadyAsync(n,t,"2")];case 1:return[2,a.sent()]}}))}))},t.prototype._listPackageAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e,t,n,r;return __generator(this,(function(a){switch(a.label){case 0:e=Object(i.generateNonDashedUUID)(),Object(i.enterScope)(e),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,this._callListPackageAsync()];case 2:return(t=a.sent()).status!==o.InProgress?[3,4]:(i.Log.updateOpenAppData({needsPackaging:!0}),[4,this._retryListPackageUntilReadyAsync(t.locationForPollingStatus,t.retryAfter)]);case 3:t=a.sent(),a.label=4;case 4:return n=Object(i.exitScopeAndGetRunTime)(e),i.Log.updateOpenAppData({packagingTime:n}),[2,t];case 5:return r=a.sent(),Object(i.exitScope)(e),i.CoreLog.error("ListPackageClient.listPackageUntilReadyAsync",r),[2,{status:o.Error,error:r}];case 6:return[2]}}))}))},t.prototype._callListPackageAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e,n,a,m,v,b,h,A,C,P,w,S;return __generator(this,(function(O){switch(O.label){case 0:(m=AppMagic.PowerApps.PowerAppsUtility.tryGetPowerPlatformLaunchServiceUrl(this._appName))?((v=new i.UrlBuilder(m)).appendPath("listPackage"),e=v.toUrl(),n=l.PowerAppsUtility.getPowerPlatformApiVersion(),a=d.d.PowerPlatformService):(e=this._isUnifiedApp?l.PowerAppsUtility.getUnifiedPowerAppsListPackageEndpoint(this._appName,this._environmentId):l.PowerAppsUtility.getPowerAppsListPackageEndpoint(this._appName),n=l.PowerAppsUtility.getApiVersion(),a=d.d.PowerAppsService),b=new p.JsonHttpRequestBuilder,h={clientVersion:l.PowerAppsUtility.parseVersionString(i.Version.VERSION_NUMBER)},b.setJsonValue("",h),(A=l.PowerAppsUtility.tryGetDocumentServerEndpointHeader())&&(b.addHeader(A.headerName,A.value),C={docServerEndPointHeaderName:A.headerName,docServerEndPointValue:A.value}),l.PowerAppsUtility.authorizeHttpBuilder(b,c.Method.POST,e,a,n),P=b.generateSendHttpRequestParameters(),Object(g.addTelemetryOptions)(P,{operationName:r.appListPackageCall}),Object(f.addServiceErrorOptions)(P,{serviceType:y.e}),Object(s.appendCustomHeadersOptions)(P,{addCustomHeaders:!0}),A&&Object(g.addTelemetryAdditionalData)(P,C),O.label=1;case 1:return O.trys.push([1,4,,5]),[4,this._httpClient.sendHttpAsync(P)];case 2:return w=O.sent(),[4,t._parseListPackageResponse("ListPackageClient.listPackageAsync",w,!1,this._isUnifiedApp)];case 3:return[2,O.sent()];case 4:if(S=O.sent(),i.CoreLog.error("ListPackageClient.listPackageAsync",S),Object(u.errorHasHttpResponse)(S))switch(S.response.status){case c.HttpStatusCode.BadRequest:case c.HttpStatusCode.Forbidden:case c.HttpStatusCode.Unauthorized:return[2,{status:o.AccessError,error:S}];case c.HttpStatusCode.NotFound:return[2,{status:o.NotFound,error:S}]}return[2,{status:o.Error,error:S}];case 5:return[2]}}))}))},t._tryParseRetryAfter=function(e){var n=Object(i.tryGetValueIgnoreCase)(e,c.HeaderName.RetryAfter);return n?1e3*parseInt(n):t.defaultRetryListPackageTimeoutMilliseconds},t._parseListPackageResponse=function(e,n,r,a,s){var u,p;if(n.status===c.HttpStatusCode.Accepted){var l=Object(i.usePowerPlatformApi)()?c.HeaderName.OperationLocation:c.HeaderName.Location,d=Object(i.tryGetValueIgnoreCase)(n.headers,l);if(!Object(i.isNonEmptyString)(d))return i.CoreLog.error(e,"ListPackage call returned empty string or non string location header."),{status:o.Error};var f=new i.Core_Url(d);if(!f.isAbsolute)return i.CoreLog.error(e,"ListPackage call returned non absolute uri location header."),{status:o.Error};i.CoreLog.verbose("".concat(e,": ListPackage call returned a location header for polling the package status"));var y=t._tryParseRetryAfter(n.headers);return i.Log.trackActivityEvent("ListPackageClient._parseListPackageResponse",{message:"Retry listPackage in ".concat(y," milliseconds")}),{locationForPollingStatus:f,retryAfter:y,status:o.InProgress}}if(n.status===c.HttpStatusCode.Ok){var m=void 0;try{m=JSON.parse(n.responseText)}catch(t){return i.CoreLog.error(e,t,"Server returned invalid json response for listPackage call."),{status:o.Error}}var g=void 0;if(Object(i.usePowerPlatformApi)()&&r){if(m.status){if("Running"===m.status||"NotStarted"===m.status){i.CoreLog.verbose("".concat(e,": The app is still being packaged. Will poll again."));y=t._tryParseRetryAfter(n.headers);return i.Log.trackActivityEvent("ListPackageClient._parseListPackageResponse",{message:"Retry listPackage in ".concat(y," milliseconds")}),s?{locationForPollingStatus:s,retryAfter:y,status:o.InProgress}:(i.CoreLog.errorEx(e,"List package polling failed. Polling URL is not provided."),{status:o.Error})}if("Failed"===m.status||"Canceled"===m.status){var b=m.status,h=null===(u=m.error)||void 0===u?void 0:u.code,A=null===(p=m.error)||void 0===p?void 0:p.message;return i.CoreLog.errorEx(e,"List package polling failed. Status: ".concat(b,". Error Code: ").concat(h," Error Message: ").concat(A)),{status:o.Error}}}g=v.Uf.safeCast(m.result)}else g=v.Uf.safeCast(m);return null===g?(i.CoreLog.error(e,"Server returned invalid response for listPackage call. safeCast failed."),{status:o.Error}):(i.CoreLog.verbose("".concat(e,": ListPackage call returned package uri.")),{result:g,status:o.Ready})}return n.status===c.HttpStatusCode.NoContent&&a?(i.CoreLog.verbose("".concat(e,": Server returned status code 204/no-content for listPackage call for a unifiedApp.")),{status:o.Empty}):(i.CoreLog.error(e,"ListPackage call returned unexpected status code: "+n.status),{status:o.Error})},t.prototype._listPackageStatusFromLocationAsync=function(e,n){return __awaiter(this,void 0,Promise,(function(){var u,p,f,y,g;return __generator(this,(function(v){switch(v.label){case 0:u=new a.BodilessHttpRequestBuilder,n||(n=Object(i.usePowerPlatformApi)()?l.PowerAppsUtility.getPowerPlatformApiVersion():l.PowerAppsUtility.getApiVersion()),p=Object(i.usePowerPlatformApi)()?d.d.PowerPlatformService:d.d.PowerAppsService,l.PowerAppsUtility.authorizeHttpBuilder(u,c.Method.GET,e,p,n),f=u.generateSendHttpRequestParameters(),Object(s.appendCustomHeadersOptions)(f,{addCustomHeaders:!0}),v.label=1;case 1:return v.trys.push([1,3,,4]),[4,Object(m.sendHttpAsync)(this._httpClient,f,r.appListPackageCall)];case 2:return y=v.sent(),[2,t._parseListPackageResponse("ListPackageClient._listPackageStatusFromLocationAsync",y,!0,!1,e)];case 3:return g=v.sent(),i.CoreLog.error("ListPackageClient._listPackageStatusFromLocationAsync",g),[2,{status:o.Error,error:g}];case 4:return[2]}}))}))},t.prototype._retryListPackageUntilReadyAsync=function(e,t,n){return __awaiter(this,void 0,Promise,(function(){var r,a,s,c=this;return __generator(this,(function(u){switch(u.label){case 0:r=function(e){return c._listPackageStatusFromLocationAsync(e,n)},a=function(e){switch(e.status){case o.Ready:return Object(i.createTailEnd)();case o.InProgress:return Object(i.createNext)(e.locationForPollingStatus,e.retryAfter);default:if(e.error)throw e.error;throw new Error("There was an error while polling the package uri.")}},this._pollingHandle=Object(i.startPollingOperation)("ListPackageClient._retryListPackageUntilReadyAsync",e,r,a,t),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,this._pollingHandle.waitAsync()];case 2:return[2,u.sent()];case 3:return s=u.sent(),i.CoreLog.error("ListPackageClient._retryListPackageUntilReadyAsync",s),[2,{status:o.Error,error:s}];case 4:return[2]}}))}))},t.prototype.dispose=function(){null!==this._pollingHandle&&(this._pollingHandle.dispose(),this._pollingHandle=null)},t.defaultRetryListPackageTimeoutMilliseconds=3e3,t}(i.Disposable)},function(e,t,n){"use strict";n.r(t),n.d(t,"JsonObjectTType",(function(){return a}));var r=n(0),o=n(7),i=n(10),a=function(){function e(e){this._isConvertFromDValueAsync=null,this._properties=e}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return o.TTypeValueKind.JsonObject},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this._properties},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return null===this._isConvertFromDValueAsync&&(this._isConvertFromDValueAsync=Object(r.HashTableUtility_some)(this._properties,(function(e){return e.ttypeRef.getType().isConvertFromDValueAsync}))),this._isConvertFromDValueAsync},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(i.computeDValueSchemaForObjectTType)(this._properties,e)},e.prototype.convertFromDValue=function(e){return Object(i.convertFromObjectDValue)(e,this._properties,this.isConvertFromDValueAsync)},e.prototype.convertToDValue=function(e){return Object(i.convertToObjectDValue)(e,this._properties)},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r,o=n(0),i=n(60),a=n(51),s=n(22),c=n(53),u=n(2),p=n(25),l=n(13);!function(e){e.RegionName="test",e.endpointTitle="TestInProd2",e.powerAppsRedirectUri=new o.Core_Url("https://tip2.web.powerapps.com/powerappsredirect/"),e.docServerEndpoint=new o.Core_Url("https://test.create.powerapps.com/"),e.playerResourcesEndpoint=new o.Core_Url("https://paplayercdn-test.azureedge.net/");var t=new o.Core_Url("https://go.microsoft.com/fwlink/?linkid=841576"),n=new o.Core_Url("https://go.microsoft.com/fwlink/?linkid=841577");function r(){return new o.Core_Url("https://tip2.api.powerapps.com")}function d(){return new o.Core_Url("https://tip2."+AppMagic.PowerApps.Constants.BadRpBaseUrlSuffix)}function f(){return u.PowerAppEndpoints.getApiVersion()+"-beta"}e.getPowerAppsRpBaseUrl=r,e.getPowerAppsBadBaseUrl=d,e.getApiVersionValue=f,e.getCdmRpApiVersionValue=function(){return u.PowerAppEndpoints.getCdmRpApiVersion()+"-beta"},e.portalEndPoint=new o.Core_Url("https://make.test.powerapps.com"),e.appDownloadRootEndPoint=new o.Core_Url("https://apps.test.powerapps.com/open/"),e.consumerPortalEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?linkid=2169021"),e.webPlayerSignUpEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkId=785763"),e.webPlayerConsentEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkId=785767"),e.webAuthoringSignUpEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkId=785771"),e.InstallGatewayLinkUrl=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkID=817347"),e.InstallVNetGatewayLinkUrl=new o.Core_Url("https://tip2.admin.powerplatform.microsoft.com/ext/DataGateways"),e.flowRPEndpoint=new o.Core_Url("https://tip2.api.flow.microsoft.com"),e.aibTextServiceEndpoint="https://wus2-text.pai.ppe.dynamics.com",e.flowPortalEndpoint=new o.Core_Url("https://tip2.flow.microsoft.com"),e.neptuneResource="https://licensing-tip.powerplatform.microsoft.com/",e.neptuneAudience="https://licensing-tip.powerplatform.microsoft.com/auth",e.cesFeedbackEndpoint=i.NpsUrlOriginForTest,e.ecsHostResource="https://config.edge.skype.net",e.getValues=function(){var o=p.a.getValues();return o.name="tip2",o.clusterCategory="test",o.endpointTitle=e.endpointTitle,o.portalUri=e.portalEndPoint,o.appDownloadRootUri=e.appDownloadRootEndPoint,o.consumerPortalUri=e.consumerPortalEndPoint,o.powerAppsRpBaseUrl=r(),o.powerAppsApiVersion=f(),o.powerPlatformRpBaseUrl=Object(l.b)(o.clusterCategory),o.powerPlatformRpApiVersion=u.PowerAppEndpoints.powerPlatformApiVersion,o.powerPlatformResource=Object(l.e)(o.clusterCategory),o.powerPlatformTenantBaseUrl=Object(l.d)(o.clusterCategory),o.powerPlatformEnvironmentBaseUrl=Object(l.c)(o.clusterCategory),o.bapBaseUrl=s.BapEndpoints.Tip2.getBaseUrl(),o.bapApiVersion=s.BapEndpoints.Tip2.getApiVersionValue(),o.cdsApiVersion=c.CdsEndpoints.Tip2.getApiVersionValue(),o.cdsBaseUrl=c.CdsEndpoints.Tip2.getBaseUrl(),o.clientConsentEndPoint=p.a.getClientConsentEndPoint(t,n),o.webPlayerSignUpEndPoint=e.webPlayerSignUpEndPoint,o.webPlayerConsentEndPoint=e.webPlayerConsentEndPoint,o.webAuthoringSignUpEndPoint=e.webAuthoringSignUpEndPoint,o.gcmSenderId=AppMagic.PowerApps.Constants.Notification.TestInProd2.gcmSenderId,o.powerAppsRedirectUri=e.powerAppsRedirectUri,o.installGatewayLinkUrl=e.InstallGatewayLinkUrl,o.installVNetGatewayLinkUrl=e.InstallVNetGatewayLinkUrl,o.flowRpBaseUrl=e.flowRPEndpoint,o.flowPortalBaseUrl=e.flowPortalEndpoint,o.playerResourcesEndpoint=e.playerResourcesEndpoint,o.docServerEndpoint=e.docServerEndpoint,o.powerAppsBadBaseUrl=d(),o.powerAppsBadApiVersion=a.BadEndpoints.getApiVersion(),o.cesFeedbackEndpoint=e.cesFeedbackEndpoint,o.aibTextServiceEndpoint=e.aibTextServiceEndpoint,o.ecsHostResource=e.ecsHostResource,o.neptuneResource=e.neptuneResource,o.neptuneAudience=e.neptuneAudience,o.webAuthResource="7f96ed90-4ea5-48c1-b589-81ac94ade0aa",o}}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n(0),n(1);var r=function(){function e(e,t){this._uiDefinition=t,this._values=e}return Object.defineProperty(e.prototype,"uiDefinition",{get:function(){return this._uiDefinition},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){return this._values},enumerable:!1,configurable:!0}),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"ApiError",(function(){return o}));var r=n(0),o=function(e){function t(t,n){var r=this;return(r=e.call(this,n,"PowerApps.ApiError")||this)._apiId=t,r}return __extends(t,e),Object.defineProperty(t.prototype,"apiId",{get:function(){return this._apiId},enumerable:!1,configurable:!0}),t.prototype.toDiagnosticMessage=function(){return"".concat(this.message,"\r\napiId: ").concat(this._apiId)},t}(r.ErrorBase)},function(e,t,n){"use strict";n.r(t),n.d(t,"SharedEntityConnectionReferenceNameMap",(function(){return i}));var r=n(0),o=n(235),i=function(){function e(){this._entityReferenceNameMap=Object(r.HashTableUtility_create)()}return e.prototype.populateMap=function(e){this._entityReferenceNameMap=o.a.buildPerAppMap(e)},e.prototype.addEntityReferences=function(e,t,n){var o=this;this._entityReferenceNameMap&&this._entityReferenceNameMap[n]?e.forEach((function(e){return o._entityReferenceNameMap[n].entityConnectionRefMap[e]=t})):r.Log.trackErrorEvent("SharedEntityConnectionReferenceNameMap.addEntityReferences",{message:"an Entity-Reference map doesn't exist",appId:n})},e.prototype.tryGetEntityReferenceMap=function(e){var t;return null!==(t=this._entityReferenceNameMap[e])&&void 0!==t?t:this._entityReferenceNameMap[o.b]},e.prototype.tryRemoveEntityReferenceMap=function(e,t){try{delete this._entityReferenceNameMap[t].entityConnectionRefMap[e]}catch(e){return r.CoreLog.errorEx("SharedEntityConnectionReferenceNameMap.tryRemoveReferenceMap","Removing Entity Reference map from store failed with error",{error:e}),!1}return!0},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"ApiPolicyViolationError",(function(){return o}));var r=n(0),o=function(e){function t(t,n){var r=e.call(this,t,"ApiPolicyViolationError")||this;return r.dlpEvaluationResult=n,r.dataSourceNamesToRemove=[],r}return __extends(t,e),t}(r.ApplicationError)},function(e,t,n){"use strict";n.r(t),n.d(t,"createStringConverter",(function(){return c}));var r=n(0),o=n(5),i=n(75),a=null;function s(e){if(null===a){var t=function(e){return function(t){return Object(o.createSchemaForSimple)(e)}};(a=Object(r.HashTableUtility_create)())[o.TypeBoolean]={isRecord:!1,computeDValueSchema:t(o.TypeBoolean)},a[o.TypeNumber]={isRecord:!1,computeDValueSchema:t(o.TypeNumber)},a[o.TypeString]={isRecord:!1,computeDValueSchema:t(o.TypeString)},a[o.TypeHyperlink]={isRecord:!1,computeDValueSchema:t(o.TypeHyperlink)},a[o.TypeImage]={isRecord:!1,computeDValueSchema:t(o.TypeImage)},a[o.TypeMedia]={isRecord:!1,computeDValueSchema:t(o.TypeMedia)},a[o.TypeBlob]={isRecord:!1,computeDValueSchema:t(o.TypeBlob)},a[o.TypeGuid]={isRecord:!1,computeDValueSchema:t(o.TypeGuid)}}return a[e]}function c(e){switch(e){case o.TypeNumber:return{target:s(e),convertToTarget:i.convertStringToNumber,convertFromTarget:i.convertNumberToString};case o.TypeHyperlink:case o.TypeImage:case o.TypeMedia:case o.TypeBlob:return{target:s(e),convertToTarget:i.convertStringToHyperlink,convertFromTarget:i.convertHyperlinkToString};default:return}}},function(e,t,n){},function(e,t,n){"use strict";n.r(t),n.d(t,"FormUrlEncodedHttpRequestBuilder",(function(){return s}));var r=n(0),o=n(85),i=n(41),a=n(3),s=function(e){function t(){var t=e.call(this)||this;return t._formBody=Object(r.HashTableUtility_create)(),t}return __extends(t,e),t.prototype.clone=function(){var e=new t;return this._cloneTo(e),e},t.prototype._cloneTo=function(t){e.prototype._cloneTo.call(this,t),t._formBody=Object(r.clone)(this._formBody)},t.prototype.setFormValue=function(e,t){this._formBody[e]=t},t.prototype._generateBodyBinary=function(){var e=this.getEncodedFormBody();return r.PABinary.createFromText(e,a.MediaType.ApplicationFormUrlEncoded)},t.prototype.getEncodedFormBody=function(){return Object(r.mapToArray)(this._formBody,(function(e,t){return Object(o.b)(t)+"="+Object(o.b)(e)})).join("&")},t}(i.BodilessHttpRequestBuilder)},function(e,t,n){"use strict";var r;n.r(t),n.d(t,"OperationPriority",(function(){return r})),function(e){e[e.Critical=0]="Critical",e[e.Normal=1]="Normal"}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"token",(function(){return r})),n.d(t,"tokenTimeStamp",(function(){return o})),n.d(t,"tokenExpiresIn",(function(){return i}));var r="token",o="tokenTimeStamp",i="tokenExpiresIn"},function(e,t,n){"use strict";n.r(t),n.d(t,"PowerAppsClient",(function(){return P}));var r=n(0),o=n(32),i=n(34),a=n(9),s=n(107),c=n(52),u=(n(6),n(148)),p=n(183),l=n(1),d=n(179),f=n(2),y=n(61),m=n(141),g=n(54),v=n(4),b=n(184),h=n(346),A=n(35),C=n(3),P=function(e){function t(){var t=e.call(this)||this;return t._isAppCdsAuthConsentPromiseCompleted=!1,t._sendCDSRequest=function(e,n){return __awaiter(t,void 0,Promise,(function(){var t,r;return __generator(this,(function(o){switch(o.label){case 0:return t=AppMagic.PowerApps.CdsUtility.buildCdsHttpRequestUrl(e,AppMagic.PowerApps.Constants.CdsDefaultWebApiVersion,n),r=AppMagic.PowerApps.CdsUtility.buildCdsHttpRequestParameters(t,e,C.Method.GET),[4,this._powerAppsService.httpClient.sendHttpJsonResponseAsync(r)];case 1:return[2,o.sent()]}}))}))},t._identityService=null,t._powerAppsService=null,t._userService=null,t._appType=f.AppTypesFromRP.ClassicCanvasApp,t._appConnectionsChangedEvent=new r.EventObject,t._databaseReferencesManager=t._getDatabaseReferenceManager(),t._appCdsDataSourcesChangedEvent=new r.EventObject,t._appCdsAuthConsentPromise=Object(r.createCompletablePromise)(),t._initializeAppConnectionsState(),r.ObjectFactory.instance.register(g.IPowerAppsClientSingletonKey,[],(function(){return t}),!0,null,!0),t}return __extends(t,e),Object.defineProperty(t.prototype,"isInitialized",{get:function(){return!!this._powerAppsService},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasConnectionReferences",{get:function(){return this._connectionReferenceStore.hasConnections},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"areAppConnectionsLoaded",{get:function(){return this._areAppConnectionsLoaded},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"areAppConnectionsLoadedAsync",{get:function(){return this._areAppConnectionsLoadedAsync},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"referenceStore",{get:function(){return this._connectionReferenceStore},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"databaseReferencesManager",{get:function(){return this._databaseReferencesManager},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"identityService",{get:function(){return this._identityService},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userService",{get:function(){return this._userService},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataLossPreventionClient",{get:function(){return this._dataLossPreventionClient},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"powerAppsService",{get:function(){return this._powerAppsService},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"appConnectionsChanged",{get:function(){return this._appConnectionsChangedEvent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"appCdsDataSourcesChanged",{get:function(){return this._appCdsDataSourcesChangedEvent},enumerable:!1,configurable:!0}),t._verifyAppIdIfRequired=function(e){return!Core.Environment.isSharedAppHost()||Object(r.isNonEmptyNonWhitespaceString)(e)},t.prototype._getDatabaseReferenceManager=function(){var e=this;return new r.Lazy((function(){var t,n;return e._appType===f.AppTypesFromRP.UnifiedApp?new d.ConsolidatedDatabaseReferencesManager:Core.Environment.isSharedAppHost()&&r.webPlayer.enableCDSNativeForCustomPages?new b.SharedDatabaseReferencesManager:new y.DatabaseReferencesManager((null===(n=null===(t=e._appResources)||void 0===t?void 0:t.appInfo)||void 0===n?void 0:n.id)&&e._userService.appResourceManager.getAppResourcesAsync(e._appResources.appInfo.id))}))},t.prototype.tryGetEntityConnectionReferenceMap=function(e){var t,n,r;return v.PowerAppsUtility.useSharedEntityReferenceMap()?null!==(n=null===(t=this._entityConnectionReferenceNameMap)||void 0===t?void 0:t.tryGetEntityReferenceMap(e))&&void 0!==n?n:null:null!==(r=this._entityConnections)&&void 0!==r?r:null},t.prototype._initializeAppConnectionsState=function(){this._areAppConnectionsLoaded=!1,this._connectionReferenceStore=new s.LocalConnectionReferenceStore,v.PowerAppsUtility.useSharedEntityReferenceMap()?this._entityConnectionReferenceNameMap=new u.SharedEntityConnectionReferenceNameMap:this._entityConnections=Object(r.HashTableUtility_create)(),this._appResources=null,this._connectionUsages=null},t.prototype._resetAppConnectionsState=function(e){this._areAppConnectionsLoaded=!1,this._connectionReferenceStore=new s.LocalConnectionReferenceStore,v.PowerAppsUtility.useSharedEntityReferenceMap()?this._entityConnectionReferenceNameMap=new u.SharedEntityConnectionReferenceNameMap:this._entityConnections=Object(r.HashTableUtility_create)(),this._appResources=null,this._connectionUsages=null},t.prototype._releaseAppConnectionStore=function(){this._connectionReferenceStore=null,this._entityConnections=null,this._entityConnectionReferenceNameMap=null,this._areAppConnectionsLoaded=!1},t.prototype._completeAppCdsAuthConsentPromise=function(){this._isAppCdsAuthConsentPromiseCompleted||(this._appCdsAuthConsentPromise.complete(),this._isAppCdsAuthConsentPromiseCompleted=!0)},t.prototype.getAppMetadataAsync=function(){var e,t,n,o,i,a,s,c,u,p,l,d,f,y;return __awaiter(this,void 0,Promise,(function(){var m;return __generator(this,(function(g){switch(g.label){case 0:return m={appId:null!==(n=null===(t=null===(e=this._appResources)||void 0===e?void 0:e.appInfo)||void 0===t?void 0:t.id)&&void 0!==n?n:"",appName:null!==(a=null===(i=null===(o=this._appResources)||void 0===o?void 0:o.appInfo)||void 0===i?void 0:i.name)&&void 0!==a?a:"",sessionId:r.Log.sessionId},[4,this._userService.tryGetEnvironmentService().getCurrentEnvironmentAsync()];case 1:return[2,(m.environmentId=null!==(c=null===(s=g.sent())||void 0===s?void 0:s.id)&&void 0!==c?c:"",m.tenantId=null!==(l=null===(p=null===(u=this._identityService)||void 0===u?void 0:u.identity)||void 0===p?void 0:p.tenantId)&&void 0!==l?l:"",m.objectId=null!==(y=null===(f=null===(d=this._identityService)||void 0===d?void 0:d.identity)||void 0===f?void 0:f.objectId)&&void 0!==y?y:"",m)]}}))}))},t.prototype.loadCompositeConnectionsAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e=this;return __generator(this,(function(t){return[2,r.Log.trackPromiseScenario(r.ScenarioName.DisambiguationResolveCompositeConnections,(function(){return e._resolveCompositeReferencesAsync()}))]}))}))},t.prototype._formatHostVersion=function(e,t,n){var r="".concat(e,"/").concat(t);return n&&(r+=" (".concat(n,")")),r},t.prototype._getHostVersion=function(e){var t;if(Core.Environment.isWebAuthoring())t="PowerApps-Studio";else if(Core.Environment.isWebPlayer())t="PowerApps-Web";else{if(!Core.Environment.isReactNativePlayer())return;t="PowerApps-Native"}return this._formatHostVersion(t,r.Version.VERSION_NUMBER,e)},t.prototype.getHostMetadataAsync=function(e){var t=new h.UAParser(e),n=t.getOS().name,r=t.getDevice().model;return"ios"===n.toLowerCase()&&"ipad"===r.toLowerCase()&&(n="iPadOS"),Promise.resolve({osType:n,version:this._getHostVersion(n),offlineEnabled:!1})},t.prototype._populateDisplayInfoForCdsAuthResourcesAsync=function(e,t,n){var o;return __awaiter(this,void 0,Promise,(function(){var n,i,a;return __generator(this,(function(s){switch(s.label){case 0:return[4,this._userService.appResourceManager.getAppResourcesAsync(e)];case 1:return n=s.sent(),i=null===(o=null==n?void 0:n.appInfo)||void 0===o?void 0:o.databaseReferences,Object(r.isNullOrUndefined)(i)?[2,[]]:(a=[],t.forEach((function(e){AppMagic.Runtime.Client.AuthResource.isCdsAuthResource(e.resourceId)||a.push(e)})),Object(r.HashTableUtility_forEach)(i,(function(e){var t,n,o,i;if(!Object(r.equalsIgnoreCase)(e.databaseDetails.environmentName,AppMagic.ConnectionHub.Constants.CdsDefaultDatasetName)){var s=null===(n=null===(t=e.databaseDetails)||void 0===t?void 0:t.linkedEnvironmentMetadata)||void 0===n?void 0:n.instanceUrl,c={name:null===(i=null===(o=e.databaseDetails)||void 0===o?void 0:o.linkedEnvironmentMetadata)||void 0===i?void 0:i.friendlyName,resourceId:s,iconUri:AppMagic.Runtime.Client.AuthResource.tryGetIconUri(s)};a.push(c)}})),[2,a])}}))}))},t.prototype._onAppConnectionsChanged=function(){this._areAppConnectionsLoaded&&this._appConnectionsChangedEvent.dispatch()},t.prototype._loadAppConnectionsAsync=function(e,t,n,o,i,a,s,c,u,p){return void 0===u&&(u=!1),void 0===p&&(p=!1),__awaiter(this,void 0,Promise,(function(){var l=this;return __generator(this,(function(d){return Object(r.trace)(r.CategoryNames.Connection,"LoadAppConnections",{appId:e,connectionReferences:o,preloadConnectionUsages:a}),[2,r.Log.trackPromiseScenario(r.ScenarioName.DisambiguationSetup,(function(){return l._disambiguateConnections(e,t,n,o,i,a,s,c,u,p)}))]}))}))},t.prototype._loadAppResourcesAsync=function(e,t,n,o){return __awaiter(this,void 0,Promise,(function(){var i;return __generator(this,(function(a){switch(a.label){case 0:return[4,this._updateAppResourcesIfNeededAsync(e,t,n,o)];case 1:return i=a.sent(),[4,this._populateAppResourcesAsync(e,i)];case 2:return a.sent(),r.Log.trackEvent(r.reloadAppResourceSucceed),[2]}}))}))},t._isAppPlayerStartingWithioutMissingConnections=function(e,t,n){return!e&&!t&&0==n.invalidUsageReferenceIds.length&&Object(r.HashTableUtility_isEmpty)(n.missingConnections)},t.prototype._disambiguateConnections=function(e,t,n,o,i,a,s,c,u,p){return __awaiter(this,void 0,Promise,(function(){var l,d;return __generator(this,(function(f){switch(f.label){case 0:return l=!1,a&&s&&(this._connectionUsages=a,l=this._tryDisambiguateConnectionsFromPreloadData(e,n,o,this._connectionUsages,s,i,u)),l?(Object(r.trace)(Core.Diagnostics.CategoryNames.Connection,"DisambiguateConnections",{appId:e,info:"Disambiguation succeeded from preload cached data"}),r.Log.trackActivityEvent("PowerAppsClient._disambiguateConnections",{message:"Connections successfully disambiguated from preload cached data."}),d=this,[4,c]):[3,3];case 1:return d._appResources=f.sent(),[4,this._showConsentDialogAsync(Object(r.HashTableUtility_create)(),!1)];case 2:return f.sent(),[3,5];case 3:return r.Log.trackActivityEvent("PowerAppsClient._disambiguateConnections",{message:"About to start connection disambiguation using app resources."}),[4,this._disambiguateConnectionsFromAppResourcesAsync(e,t,n,o,i,c,u,p)];case 4:f.sent(),f.label=5;case 5:return this._updateAppResourcesAfterDisambiguation(e,u,i),[2]}}))}))},t.prototype._tryDisambiguateConnectionsFromPreloadData=function(e,n,o,i,a,s,c){var u=this;Object(r.trace)(r.CategoryNames.Verbose,"DisambiguateConnectionsFromPreloadData",{appId:e,info:"Trying to Disambiguate Connections from preloadData",preloadConnectionIds:a});var p=this._setupDisambiguationAndResolveUsages(e,n,o,i,a);if(t._isAppPlayerStartingWithioutMissingConnections(s,c,p)){Object(r.trace)(r.CategoryNames.Verbose,"StartingWithoutMissingConnections",{appId:e,info:AppMagic.Strings.AppPlayerStartingWithoutMissingConnectionsText});var l=!0,d=!0;if(p.disambiguationResults.forEach((function(e){l=u._tryAddDisambiguationResultToReferenceStore(e)&&l,d=e.connection.isAuthenticated&&d})),l&&d)return Object(r.trace)(r.CategoryNames.Verbose,"ConnectionReferenceStore",{appId:e,info:this._connectionReferenceStore.getAll()}),!0}return!1},t.prototype._disambiguateConnectionsFromAppResourcesAsync=function(e,t,n,o,i,a,s,u){return __awaiter(this,void 0,Promise,(function(){var p,l,d,f,y,m,g=this;return __generator(this,(function(v){switch(v.label){case 0:return v.trys.push([0,2,,3]),[4,this._loadAppResourcesAsync(e,i,a,s)];case 1:return v.sent(),[3,3];case 2:throw p=v.sent(),l=c.getLocalConnections(o,Object(r.HashTableUtility_create)()),this._buildConnectionReferenceStoreAndMap(l),Object(r.trace)(r.CategoryNames.Connection,"DisambiguateConnections",{appId:e,info:"Failed to load the user app resources.",error:p},r.MonitorLogLevel.Error),r.CoreLog.errorEx("PowerAppsClient._disambiguateConnectionsFromAppResourcesAsync","Failed to load user app resources",{error:p}),p;case 3:d=this._appResources.connections.map((function(e){return e.id})),this._connectionUsages=Object(r.HashTableUtility_create)(),HashTableUtility.forEach(this._appResources.connectionUsages,(function(e,t){g._connectionUsages[t]={id:e.connection.id,environmentName:e.connection.environmentName,apiId:e.connection.apiId,apiRuntimeUrlString:e.connection.apiRuntimeUrlString,isAuthenticated:e.connection.isAuthenticated,apiScopes:e.connection.apiScopes,connectionParameters:e.connection.connectionParameters,isShareable:e.connection.isShareable,name:e.connection.name,isTestConnectionRequiredAfterConsent:e.connection.isTestConnectionRequiredAfterConsent,appActions:e.appActions}})),(f=this._setupDisambiguationAndResolveUsages(e,n,o,this._connectionUsages,d)).invalidUsageReferenceIds.forEach((function(e){g._appResources.removeConnectionUsage(e)})),f.disambiguationResults.forEach((function(t){g._addDisambiguationResult(t,e)})),y=Object(r.HashTableUtility_create)(),Object(r.HashTableUtility_isEmpty)(f.missingConnections)||(y=this.getLocalMissingAppConnections(e),Object(r.trace)(r.CategoryNames.Connection,"MissingConnections",{appId:e,info:"There are some missing connections",missingConnections:y})),v.label=4;case 4:return v.trys.push([4,6,,7]),Object(r.trace)(r.CategoryNames.Connection,"ResolveMissingConnections",{appId:e,info:"Resolving missing connections",localMissingAppConnections:y,nonCompositeConnectionsOnly:u,appAlreadyRunning:i}),[4,this._resolveMissingAppConnectionsAsync(y,i,u,t)];case 5:return v.sent(),r.Log.trackEvent(r.disambiguationCompleted),[3,7];case 6:return m=v.sent(),Object(r.isCanceledError)(m)?r.Log.trackEvent(r.disambiguationCanceled):(r.Log.trackEvent(r.disambiguationFailed),r.CoreLog.error("PowerAppsClient._loadAppConnectionsAsync","appAlreadyRunning: ".concat(i,".\r\nConnection disambiguation failed with error: ").concat(Object(r.formatError)(m),"."))),Object(r.trace)(r.CategoryNames.Connection,"ResolveMissingConnections",{appId:e,info:"Resolving missing connections failed",error:m,localMissingAppConnections:y,nonCompositeConnectionsOnly:u,appAlreadyRunning:i},r.MonitorLogLevel.Error),[3,7];case 7:return[2]}}))}))},t.prototype._updateAppResourcesAfterDisambiguationCore=function(e,t){return __awaiter(this,void 0,Promise,(function(){var n,o,i;return __generator(this,(function(a){switch(a.label){case 0:n=!t,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this._userService.appResourceManager.getAppResourcesAsync(e,!0,n)];case 2:return(o=a.sent())&&o.appInfo&&this.notifyCacheRefresh(o.appInfo),r.Log.trackActivityEvent(r.reloadAppResourceSucceed,{appAlreadyRunning:t}),[3,4];case 3:return i=a.sent(),Object(A.errorHasHttpResponse)(i)&&this.notifyAppErrorState(i.response.status),r.CoreLog.error("PowerAppsClient._updateAppResourcesAfterDisambiguation","appAlreadyRunning: ".concat(t,".\r\nReloading appResource at the end of disambiguation failed with error: ").concat(Object(r.formatError)(i),".\n                    Next time user opens an app they might see disambiguation dialog.")),[3,4];case 4:return[2]}}))}))},t.prototype._updateAppResourcesAfterDisambiguation=function(e,t,n){var r=this;t||(n?this._updateAppResourcesAfterDisambiguationCore(e,n):this._userService.getOperationsExecutor().run("PowerAppsClient.RefreshAppResourcesCache",(function(){return r._updateAppResourcesAfterDisambiguationCore(e,n)}),AppMagic.Runtime.Client.OperationPriority.Critical))},t.prototype.notifyCacheRefresh=function(e){},t.prototype.notifyAppErrorState=function(e){},t.prototype._updateAppResourcesIfNeededAsync=function(e,t,n,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(o){switch(o.label){case 0:return t?[4,this._userService.appResourceManager.getAppResourcesAsync(e,!1,!1,!0)]:[3,2];case 1:return[2,o.sent()];case 2:return r||n?[3,4]:[4,this._userService.appResourceManager.getAppResourcesAsync(e)];case 3:return[2,o.sent()];case 4:return[2,n]}}))}))},t.prototype._populateAppResourcesAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var n,o,i,a,s,c,u,l;return __generator(this,(function(d){switch(d.label){case 0:return this._resetAppConnectionsState(e),t?(this._appResources=t,r.Log.trackActivityEvent(r.disambiguationUsingLaunchAppData),[2]):(r.Log.trackActivityEvent(r.disambiguationNotUsingLaunchAppData),[4,this._userService.getConnectionServiceAsync()]);case 1:return n=d.sent(),o=n.getConnectionsAsync(),i=n.getApisAsync(),a=e?n.getCurrentUserConnectionsForAppAsync(e):null,[4,Object(r.PromiseUtility_join)([a,o,i])];case 2:return s=d.sent(),c=s[0],u=s[1],l=s[2],this._appResources=new p.AppResources(null,l,u,c),[2]}}))}))},t.prototype._setupDisambiguationAndResolveUsages=function(e,n,o,i,a){var s=this._disambiguationResultProcessor.validateConnectionUsages(i,n.name,o,Core.Environment.isWebAuthoring()),u=c.getLocalConnections(o,s);this._buildConnectionReferenceStoreAndMap(u);var p=t._loadCurrentAppConnections(e,o,n,i,a,s);if(!Object(r.HashTableUtility_isEmpty)(p.missingConnections)||0!==p.invalidUsageReferenceIds.length){var l=this._userService.tryGetConnectionService();l?l.clearCurrentUserConnectionsForAppCache():r.CoreLog.errorEx("PowerAppsClient._setupDisambiguationAndResolveUsages","Failed to retrieve cached connection service")}return p},t.prototype._resolveMissingAppConnectionsAsync=function(e,t,n,o){return __awaiter(this,void 0,Promise,(function(){var i,a,s=this;return __generator(this,(function(c){switch(c.label){case 0:return[4,this._userService.getConnectionServiceAsync()];case 1:return i=c.sent(),[4,r.Log.trackPromiseScenario(r.ScenarioName.DisambiguationRuleEngine,(function(){return i.disambiguationRuleManager.executeRulesAndDisambiguateAsync(e,s._disambiguationResultProcessor,s._appResources,o)}))];case 2:return a=c.sent(),r.CoreLog.verbose("PowerAppsClient._resolveMissingAppConnectionsAsync: resolving missing app connection references."),[4,r.Log.trackPromiseScenario(r.ScenarioName.DisambiguationInteractive,(function(){return s._resolveUnauthenticatedAndUnmappedAppConnectionsAsync(a,t,o?v.PowerAppsUtility.getPowerAppsAppId(o):void 0)}))];case 3:return c.sent(),r.CoreLog.verbose("PowerAppsClient._resolveMissingAppConnectionsAsync: resolving composite connection references."),n?[3,5]:[4,r.Log.trackPromiseScenario(r.ScenarioName.DisambiguationResolveCompositeConnections,(function(){return s._resolveCompositeReferencesAsync()}))];case 4:return c.sent(),[3,6];case 5:this._connectionReferenceStore.getAll().forEach((function(e){e.dependencies&&Object(r.count)(e.dependencies)&&e.connectionInstanceId&&(s._areDependenciesResolved(e.dependencies,e.connectionInstanceId)||(e.connectionInstanceId=null,s._connectionReferenceStore.update(e.id,e)))})),c.label=6;case 6:return[2]}}))}))},t.prototype._buildConnectionReferenceStoreAndMap=function(e){this._connectionReferenceStore.addConnections(e),v.PowerAppsUtility.useSharedEntityReferenceMap()?this._entityConnectionReferenceNameMap.populateMap(e):this._populateEntityReferenceNameMap()},t.prototype._deserializeLocalConnections=function(e,t){return s.LocalConnectionReferenceStore.deserialize(e,t)},t.prototype._serializeLocalConnections=function(){var e;return null===(e=this._connectionReferenceStore)||void 0===e?void 0:e.serialize()},t.prototype.getAppDataSourceConfigs=function(e){var n=Object(r.HashTableUtility_create)();this._appResources&&this._appResources.connections?this._appResources.connections.forEach((function(e){n[e.id]=e})):this._connectionUsages?Object(r.HashTableUtility_forEach)(this._connectionUsages,(function(e){n[e.id]=e})):r.Log.trackEvent(r.disambiguationAppDataSourceConfigsReturnedNoConnections);var o=this.tryGetEntityConnectionReferenceMap(e);return t._getAppDataSourceConfigs(o,this._connectionReferenceStore,n,this._connectionInstallErrors)},t._getAppDataSourceConfigs=function(e,t,n,o){var i=Object(r.HashTableUtility_create)();return null===e||Object(r.HashTableUtility_isEmpty)(e)||Object(r.HashTableUtility_forEach)(e,(function(e,a){var s,c,u=t.tryGet(e);if(u){if((null==o?void 0:o[u.id])&&!r.FallbackSwitch.isActivated("Connection.IgnoreFlowInstallErrors"))return i[a]={error:o[u.id],apiId:o[u.id].name||"Error",connectionName:o[u.id].name||"Error",runtimeUrl:"https://powerapps.com"},!0;var p=n[u.connectionInstanceId]||null;if(p||r.FallbackSwitch.isActivated("AppConnectivity.InsensitiveConnectionCheck")||(p=Object(r.tryGetValueIgnoreCase)(n,u.connectionInstanceId)||null),p){var l={apiId:p.apiId,connectionName:p.name,runtimeUrl:p.apiRuntimeUrlString,isShareableConnection:p.isShareable};u.datasets&&Object(r.HashTableUtility_every)(u.datasets,(function(e,t){return!e.dataSources||!e.dataSources[a]||(l.datasetName=t,e.datasetOverride&&(l.datasetNameOverride=e.datasetOverride.name),e.dataSources[a].tableNameOverride&&(l.tableNameOverride=e.dataSources[a].tableNameOverride.name),!1)})),u.connectionRef.runtimePolicyName&&(l.runtimePolicyName=u.connectionRef.runtimePolicyName);try{var d=null===(s=p.connectionParameters)||void 0===s?void 0:s.server,f=null===(c=p.connectionParameters)||void 0===c?void 0:c.database;t.isSqlV2Connection(e)&&d&&f&&(r.Log.trackActivityEvent("SqlDatasetOveride",{message:"User provided override - serverName: ".concat(d," databaseName: ").concat(f)}),d=decodeURIComponent(d),f=decodeURIComponent(f),d.toLowerCase().startsWith("tcp:")&&(d=d.substring(4)),d=encodeURIComponent(d),f=encodeURIComponent(f),l.datasetNameOverride="".concat(d,",").concat(f))}catch(e){r.CoreLog.error("SqlDatasetOveride",e,"Failed to parse SQL dataset override")}i[a]=l}}})),i},t.prototype.getAppCdsDataSourceConfigsAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n;return __generator(this,(function(o){switch(o.label){case 0:return[4,this._appCdsAuthConsentPromise.promise];case 1:return o.sent(),t=Object(r.HashTableUtility_create)(),this._databaseReferencesManager.value.hasValues()?[4,this._databaseReferencesManager.value.getReferencesAsync(e)]:[2,t];case 2:return n=o.sent(),Object(r.HashTableUtility_forEach)(n,(function(e,n){"Configured"===e.state&&e.dataSources&&Object(r.HashTableUtility_forEach)(e.dataSources,(function(n,o){var i=new r.UrlBuilder(e.instanceUrl);i.appendPath("api/data/".concat(e.webApiVersion));var s=o==a.CurrentEnvironmentLogicalName?n.entitySetName:o;t[s]={runtimeUrl:i.toString(),logicalName:n.logicalName,entitySetName:n.entitySetName,version:e.version}}))})),[2,t]}}))}))},t.prototype.getAppCdsDatabaseReferenceComponents=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n;return __generator(this,(function(o){switch(o.label){case 0:return[4,this._appCdsAuthConsentPromise.promise];case 1:return o.sent(),t=new Array,this._databaseReferencesManager.value.hasValues()?[4,this._databaseReferencesManager.value.getReferencesAsync(e)]:[2,t];case 2:return n=o.sent(),Object(r.HashTableUtility_forEach)(n,(function(e,n){var r;"Configured"===e.state&&(null===(r=e.components)||void 0===r?void 0:r.length)>0&&e.components.filter((function(e){return"WebResource"==e.componentName})).forEach((function(n){t.push({runtimeUrl:e.instanceUrl,componentName:n.componentName,identifier:n.identifier,identifierType:n.identifierType})}))})),[2,t]}}))}))},t.prototype.getPcfUserIdFromCdsAsync=function(e){var t,n,o,i,a,s,c,u,p;return __awaiter(this,void 0,Promise,(function(){var e,d,f,y,m;return __generator(this,(function(g){switch(g.label){case 0:return(d=null===(n=null===(t=this._appResources)||void 0===t?void 0:t.appInfo)||void 0===n?void 0:n.environment)?[3,2]:[4,this._userService.getEnvironmentService().getCurrentEnvironmentAsync()];case 1:d=g.sent(),g.label=2;case 2:return(e=null===(a=null===(i=null===(o=d)||void 0===o?void 0:o.properties)||void 0===i?void 0:i.linkedEnvironmentMetadata)||void 0===a?void 0:a.instanceUrl)?[3,4]:[4,null===(s=this._userService.tryGetEnvironmentService())||void 0===s?void 0:s.getFullCurrentEnvironmentAsync()];case 3:f=g.sent(),e=null===(p=null===(u=null===(c=null==f?void 0:f.properties)||void 0===c?void 0:c.linkedEnvironmentMetadata)||void 0===u?void 0:u.instanceUrl)||void 0===p?void 0:p.replace(/\/$/,""),g.label=4;case 4:if(!e)throw r.CoreLog.errorEx("PowerAppsClient.getPcfUserIdFromCdsAsync","Unable to get linked environment information"),new Error("Unable to get linked environment information");return[4,this._sendCDSRequest(e,"WhoAmI()")];case 5:if(y=g.sent(),!(m=l.Gf.safeCast(y)))throw r.CoreLog.errorEx("PowerAppsClient.getPcfUserIdFromCdsAsync","Invalid WhoAmI response"),new Error("Invalid WhoAmI response");return[2,m.UserId]}}))}))},t.prototype.getAppDynamicResourceConfigsAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this._databaseReferencesManager.value.getDynamicResourceConfigsAsync()];case 1:return[2,e.sent()]}}))}))},t.prototype._isCdsAuthConsentNeeded=function(e,t){return e.filter((function(e){return AppMagic.Runtime.Client.AuthResource.isCdsAuthResource(e.resourceId)})).some((function(e){return t.every((function(t){return t.name!==e.resourceId}))}))},t.prototype.tryGetTemplatePackageDatabaseReferences=function(){return this._databaseReferencesManager.value.hasValues()?this._databaseReferencesManager.value.toServerDatabaseReferences():null},t.prototype.getApisInfo=function(){var e=Object(r.HashTableUtility_create)();return this._appResources?this._appResources.apis.forEach((function(t){return e[t.id]=t})):this._connectionUsages&&Object(r.HashTableUtility_forEach)(this._connectionUsages,(function(t){var n={id:t.apiId,runtimeUrl:new r.Core_Url(t.apiRuntimeUrlString)};e[t.apiId]=n})),e},t._loadCurrentAppConnections=function(e,n,o,i,a,s){if(Object(r.HashTableUtility_isEmpty)(n))return Object(r.trace)(r.CategoryNames.Connection,"LoadCurrentAppConnections",{appId:e,info:"App does not have connections."}),r.CoreLog.verbose("PowerAppsClient: App doesn't have any appInfo connections."),r.Log.trackEvent(r.disambiguationAppHasNoConnections),{missingConnections:Object(r.HashTableUtility_create)(),disambiguationResults:[],invalidUsageReferenceIds:[]};if(r.Log.trackEvent(r.disambiguationGettingUsages,{appId:e}),Object(r.HashTableUtility_isEmpty)(s))return r.Log.trackEvent(r.disambiguationNoUsageFound,{appId:e}),r.CoreLog.verbose("PowerAppsClient: There is not connection usage to disambiguate."),{missingConnections:n,disambiguationResults:[],invalidUsageReferenceIds:[]};var c=[];Object(r.HashTableUtility_forEach)(i,(function(e,t){s[t]||c.push(t)})),r.CoreLog.verbose("PowerAppsClient: There are connection usage available, it takes priority over local meta data");try{return t._disambiguateUsingConnectionReferencesAndUsages(s,a,n,c)}catch(e){return r.CoreLog.error("PowerAppsClient._loadCurrentAppConnections",e),{missingConnections:n,disambiguationResults:[],invalidUsageReferenceIds:c}}},t.prototype._getUnauthenticatedConnections=function(){var e=Object(r.HashTableUtility_create)();this._appResources.connections.forEach((function(t){e[t.id]=t}));var t=Object(r.HashTableUtility_create)();return e&&this._connectionReferenceStore.getAll().forEach((function(n){var o,i=e[n.connectionInstanceId];i&&!i.isAuthenticated&&(r.Log.trackActivityEvent("PowerAppsClient.getUnauthenticatedConnection",{message:"Connection with id: ".concat(i.id," is not authenticated. Added it to the list of unauthenticated connections.")}),t[n.id]={bypassConsent:n.connectionRef.bypassConsent,dataSources:n.dataSources,dependents:n.dependents,displayName:n.connectionRef.displayName,dependencies:n.dependencies,gatewayObjectIdHint:n.connectionRef.gatewayObjectIdHint,iconUri:n.connectionRef.iconUri,id:n.connectionRef.id,isCustomApiConnection:n.connectionRef.isCustomApiConnection,isOnPremiseConnection:n.connectionRef.isOnPremiseConnection,resourceIdentifier:n.connectionRef.resourceIdentifier,sharedConnectionId:n.connectionRef.sharedConnectionId,parameterHints:n.connectionRef.parameterHints,parameterHintsV2:n.connectionRef.parameterHintsV2,apiTier:n.connectionRef.apiTier,unauthenticatedConnection:i,authenticationType:n.connectionRef.authenticationType,runtimePolicyName:n.connectionRef.runtimePolicyName,appActions:null!==(o=n.appActions)&&void 0!==o?o:[]})})),t},t.prototype.getLocalMissingAppConnections=function(e){var n=this;r.CoreLog.verbose("PowerAppsClient: Disambiguation using localConnection references in the document.");var o=Object(r.HashTableUtility_create)(),i=this._connectionReferenceStore.getAll();if(0===i.length)return r.CoreLog.verbose("PowerAppsClient: App doesn't have any local connection."),o;var a=this._appResources.connections,s=Object(r.HashTableUtility_create)();return a.forEach((function(e){return s[e.id]=e})),i.filter((function(e){return Object(r.HashTableUtility_isEmpty)(e.dependencies)})).forEach((function(i){var a;!i.connectionInstanceId||!s[i.connectionInstanceId]||t._isDatasetConfigurationNeeded(i.datasets)||r.FallbackSwitch.isActivated("AppConnectivity.silentAuthPreConsent")&&!s[i.connectionInstanceId].isAuthenticated?(o[i.id]={id:i.connectionRef.id,displayName:i.connectionRef.displayName,iconUri:i.connectionRef.iconUri,dataSources:i.dataSources,dependencies:i.dependencies,dependents:i.dependents,datasets:i.datasets,isCustomApiConnection:i.connectionRef.isCustomApiConnection,isOnPremiseConnection:i.connectionRef.isOnPremiseConnection,gatewayObjectIdHint:i.connectionRef.gatewayObjectIdHint,resourceIdentifier:i.connectionRef.resourceIdentifier,sharedConnectionId:i.connectionRef.sharedConnectionId,bypassConsent:i.connectionRef.bypassConsent,parameterHints:i.connectionRef.parameterHints,parameterHintsV2:i.connectionRef.parameterHintsV2,apiTier:i.connectionRef.apiTier,authenticationType:i.connectionRef.authenticationType,runtimePolicyName:i.connectionRef.runtimePolicyName,appActions:null!==(a=i.appActions)&&void 0!==a?a:[]},r.CoreLog.verbose("PowerAppsClient: Connection in document doesn't match user's connection. LocalConnectionId: {0}, Api displayName: {1}",i.id,i.connectionRef.displayName),r.Log.trackActivityEvent(r.disambiguationMissingConnection,{localConnectionId:i.id,apiName:i.connectionRef.displayName})):n._addDisambiguationResult({localConnectionId:i.id,connection:s[i.connectionInstanceId],apiId:i.connectionRef.id,actions:i.appActions},e)})),o},t.prototype.removeConnectionMappings=function(e,t){var n=this.tryGetEntityConnectionReferenceMap();if(n){var o=n[e];if(Object(r.isUndefined)(o))r.CoreLog.warning("PowerAppsClient.removeConnectionMappings","Cannot remove data source with name: ".concat(e,". It does not exist."));else{var i=this._connectionReferenceStore.tryGet(o);if(null!==i){if(i.dataSources.length>1||this._hasDependents(i)||t){var a=i.dataSources.indexOf(e);i.dataSources.splice(a,1),this._connectionReferenceStore.update(o,i)}else i.dataSources=[],this._connectionReferenceStore.update(i.id,i),c.remove(i.id,this._connectionReferenceStore);if(i.datasets){var s=[];Object(r.HashTableUtility_every)(i.datasets,(function(t,n){return!t.dataSources||!t.dataSources[e]||(delete t.dataSources[e],Object(r.HashTableUtility_isEmpty)(t.dataSources)&&s.push(n),!1)})),s.forEach((function(e){return delete i.datasets[e]}))}if(v.PowerAppsUtility.useSharedEntityReferenceMap()){if(!this._entityConnectionReferenceNameMap.tryRemoveEntityReferenceMap(e))return void r.CoreLog.warningEx("PowerAppsClient.removeConnectionMappingsAsync","Failed to remove data source with name: ".concat(e))}else delete this._entityConnections[e];this._onAppConnectionsChanged()}else r.CoreLog.warning("PowerAppsClient.removeConnectionMappings","Cannot remove reference with id: ".concat(o,", and data source name: ").concat(e,". Reference does not exist."))}}else r.CoreLog.warningEx("PowerAppsClient.removeConnectionMappings","Cannot remove data source with name: ".concat(e,". no reference map exists."))},t.prototype._hasDependents=function(e){return!!e.dependents&&e.dependents.length>0},t.prototype.getAppInfoConnections=function(){var e,t=Object(r.HashTableUtility_create)();return(null===(e=this._appResources)||void 0===e?void 0:e.connectionUsages)&&Object(r.HashTableUtility_forEach)(this._appResources.connectionUsages,(function(e){t[e.reference]=e.connection})),t},t.prototype.getConnectionFromCache=function(e){var t;return this._appResources?null===(t=this._appResources.connections)||void 0===t?void 0:t.find((function(t){return Object(r.equalsIgnoreCase)(t.name,e)})):(r.CoreLog.warningEx("PowerAppsClient.getConnectionFromCache","AppResources is not defined"),null)},t.prototype.addDisambiguationResultsAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var n,o,i,a=this;return __generator(this,(function(s){switch(s.label){case 0:return e.forEach((function(e){a._addDisambiguationResult(e)})),this._onAppConnectionsChanged(),t&&e.some((function(e){return e.datasetOverrides&&!Object(r.HashTableUtility_isEmpty)(e.datasetOverrides)}))?(o={},i={},[4,this.getTemplatePackageConnectionReferencesAsync()]):[3,3];case 1:return o.properties=(i.connectionReferences=s.sent(),i),n=o,[4,this._startPatchAppConnectionReferencesAsync(t,n)];case 2:s.sent(),s.label=3;case 3:return[2]}}))}))},t.prototype._addDisambiguationResult=function(e,t){var n=e.connection instanceof i.a?e.connection:this._appResources.connections.find((function(t){return t.id===e.connection.id}));this._appResources&&n&&this._appResources.upsertConnectionUsage(e.localConnectionId,n),this._tryAddDisambiguationResultToReferenceStore(e)||r.CoreLog.error("PowerAppsClient._addDisambiguationResult","Failed to add connection to reference store. Local id: ".concat(e.localConnectionId,", connection id: ").concat(e.connection.id,", connection.name: ").concat(e.connection.name))},t.prototype._tryAddDisambiguationResultToReferenceStore=function(e){var t,n=this,o=this._connectionReferenceStore.tryGet(e.localConnectionId);return!!o&&(v.PowerAppsUtility.useSharedEntityReferenceMap()||o.dataSources.forEach((function(t){return n._entityConnections[t]=e.localConnectionId})),o.connectionInstanceId=e.connection.id,o.endpoints=c.getEndpointsFromConnectionParameters(o,Object(r.convertUnsafeHashTableToStringHashTable)(null===(t=e.connection)||void 0===t?void 0:t.connectionParameters)),e.datasetOverrides&&Object(r.HashTableUtility_forEach)(e.datasetOverrides,(function(e,t){o.datasets[t].datasetOverride.name=e})),this._connectionReferenceStore.update(e.localConnectionId,o),!0)},t.prototype._startPatchAppConnectionReferencesAsync=function(e,t){return this.trackAnonymous(this._powerAppsService.patchAppConnectionReferencesAsync(e,t))},t.prototype.getTemplatePackageConnectionReferencesAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(n){return t=Object(r.HashTableUtility_create)(),(e=null!=e?e:this._connectionReferenceStore).getAll().forEach((function(e){var n={id:e.connectionRef.id};e.connectionRef.parameterHints&&(n.parameterHints=e.connectionRef.parameterHints),e.connectionRef.parameterHintsV2&&(n.parameterHintsV2=e.connectionRef.parameterHintsV2);var o=[];Object(r.isHashTable)(e.dependencies)&&(n.parameterHints||(n.parameterHints={}),n.parameterHintsV2||(n.parameterHintsV2={}),Object(r.HashTableUtility_forEach)(e.dependencies,(function(e,t){o.push(e),n.parameterHints[e]={value:t},n.parameterHintsV2[t]={value:e}}))),e.dataSources&&(n.dataSources=e.dataSources),e.datasets&&(n.datasets=e.datasets),e.dependents&&(n.dependents=e.dependents),o&&(n.dependencies=o),Object(r.isDefined)(e.connectionRef.sharedConnectionId)&&(n.sharedConnectionId=e.connectionRef.sharedConnectionId),Object(r.isDefined)(e.connectionRef.gatewayObjectIdHint)&&(n.gatewayObjectIdHint=e.connectionRef.gatewayObjectIdHint),Object(r.isDefined)(e.connectionRef.isOnPremiseConnection)&&(n.isOnPremiseConnection=e.connectionRef.isOnPremiseConnection),Object(r.isDefined)(e.connectionRef.isCustomApiConnection)&&(n.isCustomApiConnection=e.connectionRef.isCustomApiConnection),Object(r.isDefined)(e.connectionRef.resourceIdentifier)&&(n.resourceIdentifier=e.connectionRef.resourceIdentifier),Object(r.isDefined)(e.connectionRef.xrmConnectionReferenceLogicalName)&&(n.xrmConnectionReferenceLogicalName=e.connectionRef.xrmConnectionReferenceLogicalName),Object(r.isDefined)(e.connectionRef.authenticationType)&&(n.authenticationType=e.connectionRef.authenticationType),Object(r.isDefined)(e.connectionRef.executionRestrictions)&&(n.executionRestrictions=e.connectionRef.executionRestrictions),Object(r.isDefined)(e.connectionRef.sharedConnectionId)&&(n.sharedConnectionId=e.connectionRef.sharedConnectionId),Object(r.isDefined)(e.endpoints)&&(n.endpoints=e.endpoints),t[e.id]=n})),[2,Promise.resolve(t)]}))}))},t.prototype.initialize=function(e,t,n,r){this._identityService=e,this._powerAppsService=t,this._userService=n,this._dataLossPreventionClient=r,this._initializing()},t.prototype._initializing=function(){this._disambiguationResultProcessor=new m.DisambiguationResultProcessor(this._powerAppsService.connectionUsageManager,this)},t.prototype._populateEntityReferenceNameMap=function(){var e=this;this._connectionReferenceStore.getAll().forEach((function(t){t.dataSources.forEach((function(n){e._entityConnections[n]=t.id}))}))},t._disambiguateUsingConnectionReferencesAndUsages=function(e,n,o,i){r.CoreLog.verbose("PowerAppsClient: disambiguation using usages."),r.Log.trackEvent(r.disambiguationUsingUsages,{totalUsage:e.length});var a=Object(r.HashTableUtility_create)(),s=[];return Object(r.HashTableUtility_forEach)(o,(function(o,i){var c=!1,u=t._isDatasetConfigurationNeeded(o.datasets);u||Object(r.HashTableUtility_forEach)(e,(function(e,t){Object(r.equalsIgnoreCase)(e.apiId,o.id)&&Object(r.equalsIgnoreCase)(t,i)&&-1!=n.indexOf(e.id)&&e.isAuthenticated&&(s.push({localConnectionId:i,connection:e,apiId:o.id,actions:o.appActions}),c=!0)})),c||(r.CoreLog.verbose("PowerAppsClient: ConnectionRef not found in usages or it may have usage but no dataset or it may be unauthenticated. User needs disambiguate manually. LocalConnectionId: {0}, apiName: {1}, needsDataset: {2}",i,o.displayName,u),r.Log.trackActivityEvent(r.disambiguationMissingConnection,{localConnectionId:i,apiName:o.displayName}),a[i]=o)})),{missingConnections:a,disambiguationResults:s,invalidUsageReferenceIds:i}},t.prototype.tryDataLossPolicyForAppAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){return[2,this.dataLossPreventionClient.tryDataLossPolicyForAppAsync(e)]}))}))},t.prototype._getExistingNonCompositeApiUsages=function(){return Object(r.getValues)(this.getAppInfoConnections()).filter((function(e){return!(e instanceof o.CompositeConnection)})).map((function(e){return e.api}))},t.prototype._resolveCompositeReferencesAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e,t,n,o,i,a=this;return __generator(this,(function(s){switch(s.label){case 0:if(!this._identityService.hasIdentity)return[2];AppMagic.ConnectionHub.LocalConnectionReferenceStoreUtility.sanitizeDependencies(this._connectionReferenceStore),e=this._connectionReferenceStore.getAll(),t=this._sortReferences(e),n=Object(r.HashTableUtility_create)(),t.forEach((function(e){var t=new Set;Object(r.HashTableUtility_forEach)(e.dependencies,(function(e){return t.add(e)})),n[e.id]=t.size})),o=function(){var e,o,s,c,u,p,l,d;return __generator(this,(function(f){switch(f.label){case 0:if(e=[],o=[],t.forEach((function(t){0===n[t.id]?e.push(t):o.push(t)})),0===e.length)throw r.CoreLog.errorEx("PowerAppsClient._resolveCompositeReferencesAsync","A batch should never be empty. Is the AppInfo corrupt?",{eventData:{appId:i._appResources.appInfo?i._appResources.appInfo.id:null,remainingReferences:o.map((function(e){return e.id}))}}),Object(r.trace)(r.CategoryNames.Connection,"AppInfoCorrupt",{appId:i._appResources.appInfo?i._appResources.appInfo.id:"",info:Object(r.CoreUtility_formatString)(AppMagic.Strings.AppInfoMissingDependencies,o.map((function(e){return e.dataSources.toString})).toString)}),new Error("Could not resolve composite connection references. The app may be corrupt.");return[4,Object(r.PromiseUtility_join)(e.map((function(e){if(AppMagic.ConnectionHub.Api.isMsFlowApi(e.connectionRef.id)||!Object(r.HashTableUtility_isEmpty)(e.dependencies))return a._resolveCompositeReferenceAsync(e,a._appResources.connections)})))];case 1:return s=(s=f.sent()).filter((function(e){return Object(r.isNonEmptyString)(e)||Object(r.isObject)(e)})),[4,i._userService.getConnectionServiceAsync()];case 2:c=f.sent(),u=i._connectionReferenceStore.getAll(),p=!0,l=function(e){var t,n,o;return __generator(this,(function(a){switch(a.label){case 0:return t="",n=null,"string"!=typeof s[e]?[3,2]:(t=s[e],[4,c.tryGetConnectionByIdAsync(t,p)]);case 1:return n=a.sent(),p=!1,[3,3];case 2:n=s[e],t=n.id,a.label=3;case 3:if(n){if(!(o=u.find((function(e){var n;return(null===(n=e.connectionInstanceId)||void 0===n?void 0:n.toLowerCase().trim())===t.toLowerCase().trim()}))))return r.CoreLog.errorEx("PowerAppsClient._resolveCompositeReferencesAsync","Could not find connection in reference store",{eventData:{connectionId:t}}),[2,"continue"];i.postCompositeUsageAsync(n,o.id,o.appActions),i._appResources.connections.find((function(e){return e.id===n.id}))||i._appResources.connections.push(n),n.id!==o.connectionInstanceId&&(o.connectionInstanceId=n.id,i._connectionReferenceStore.update(o.id,o))}else r.CoreLog.errorEx("PowerAppsClient._resolveCompositeReferencesAsync","Newly created composite connection not found in RP",{eventData:{connectionId:n}});return[2]}}))},d=0,f.label=3;case 3:return d<s.length?[5,l(d)]:[3,6];case 4:f.sent(),f.label=5;case 5:return d++,[3,3];case 6:return e.forEach((function(e){e.dependents&&e.dependents.forEach((function(e){n[e]--}))})),t=o,[2]}}))},i=this,s.label=1;case 1:return t.length>0?[5,o()]:[3,3];case 2:return s.sent(),[3,1];case 3:return[2]}}))}))},t.prototype._resolveUnauthenticatedAndUnmappedAppConnectionsAsync=function(e,t,n){return __awaiter(this,void 0,Promise,(function(){var n,o,i,a;return __generator(this,(function(s){switch(s.label){case 0:return n=this._getUnauthenticatedConnections(),o=Object(r.HashTableUtility_create)(),[4,this._userService.getConnectionServiceAsync()];case 1:return i=s.sent(),Object(r.HashTableUtility_forEach)(n,(function(t,n){var r=i.isSsoAuthValid(t.unauthenticatedConnection),a=t.unauthenticatedConnection.isApiFirstParty;a&&r?o[n]=t:(e[n]=t,a&&!r&&(t.consentOptions={manualLoginSettings:AppMagic.ConnectionHub.ManualLoginSettings.Force}))})),[4,this._authenticateSsoConnectionsAsync(o)];case 2:return a=s.sent(),Object(r.HashTableUtility_forEach)(a,(function(t,n){var o=t.connectionReference;o.consentOptions={manualLoginSettings:AppMagic.ConnectionHub.ManualLoginSettings.Force},e[n]=o,r.Log.trackActivityEvent("PowerAppsClient._resolveUnauthenticatedAndUnmappedAppConnectionsAsync",{message:"SSO failed, will try manual consent",id:o.id})})),[4,this._showConsentDialogAsync(e,t)];case 3:return[2,s.sent()]}}))}))},t.prototype._authenticateSsoConnectionsAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n,o=this;return __generator(this,(function(i){switch(i.label){case 0:return t=Object(r.HashTableUtility_create)(),n=Object(r.HashTableUtility_mapToArray)(e,(function(e,n){return __awaiter(o,void 0,void 0,(function(){var o,i;return __generator(this,(function(a){switch(a.label){case 0:o=e.unauthenticatedConnection,r.Log.trackActivityEvent("PowerAppsClient._authenticateSsoConnectionsAsync",{message:"Try to automatically fix connection with id: ".concat(o.id),apiId:o.apiId}),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,this._userService.getConnectionServiceAsync()];case 2:return[4,a.sent().getConnectionConsentAsync(o)];case 3:return[2,a.sent()];case 4:return i=a.sent(),r.Log.trackException(i),t[n]={error:i,connectionReference:e},[3,5];case 5:return[2]}}))}))})),[4,Object(r.PromiseUtility_join)(n)];case 1:return i.sent(),[2,t]}}))}))},t.prototype._sortReferences=function(e){for(var t=[],n=Object(r.HashTableUtility_create)(),o=Object(r.HashTableUtility_create)();e.length>0;){var i=e.pop();this._visitDependencies(i,t,o,n),e.filter((function(e){return t.indexOf(e)<0}))}return t},t.prototype._visitDependencies=function(e,t,n,o){var i=this;if(o[e.id])return r.CoreLog.error("PowerAppsClient._visitDependencies",new Error("Connection reference ".concat(e.connectionInstanceId," should not have cyclic dependencies"))),void delete o[e.id];n[e.id]||(o[e.id]=!0,Object(r.HashTableUtility_forEach)(e.dependencies,(function(a,s){var c=i._connectionReferenceStore.tryGet(a);if(null===c){var u="Could not find dependent connection (name: ".concat(s,", reference: ").concat(a,") ");u+="in local connection store. Parent connection: ".concat(e.connectionInstanceId),r.CoreLog.error("PowerAppsClient._sortReferences",new Error(u))}else i._visitDependencies(c,t,n,o)})),delete o[e.id],n[e.id]=!0,t.push(e))},t._doesConnectionMatchRefDependencies=function(e,t,n){return Object(r.equalsIgnoreCase)(t.connectionRef.id,e.apiId)&&e instanceof o.CompositeConnection&&o.CompositeConnection.matchCompositeDependencies(n,e.dependentConnectionIds)},t.prototype._resolveCompositeReferenceAsync=function(e,n){var i,a;return __awaiter(this,void 0,Promise,(function(){var s,c,u,p,l,d,y,m,g,v,b,h,A;return __generator(this,(function(C){switch(C.label){case 0:if(c=this._getConnectionIdTableFromDependencies(e.dependencies),r.FallbackSwitch.isActivated("AppConnectivity.resolveCompositeConnectionsOrder")){for(l=0,d=n.length;l<d;++l)if(y=n[l],Object(r.equalsIgnoreCase)(e.connectionRef.id,y.apiId)&&y instanceof o.CompositeConnection&&o.CompositeConnection.matchCompositeDependencies(c,y.dependentConnectionIds)){if(!AppMagic.ConnectionHub.Connection.isMsFlowCompositeConnection(y)){s=y;break}if(m=e.connectionRef.parameterHints,g=m[f.ParameterHintNames.msWorkflowEntityId],(v=Object(r.safeCastString)(null==g?void 0:g.value))&&y.connectionParameters.workflowEntityId&&Object(r.equalsIgnoreCase)(v,y.connectionParameters.workflowEntityId)){s=y;break}if(b=m[f.ParameterHintNames.msFlowWorkflowName],(h=Object(r.safeCastString)(b.value))&&y.connectionParameters.workflowName&&Object(r.equalsIgnoreCase)(h,y.connectionParameters.workflowName)){s=y;break}}}else AppMagic.ConnectionHub.Api.isMsFlowApi(e.connectionRef.id)?(m=e.connectionRef.parameterHints,g=m[f.ParameterHintNames.msWorkflowEntityId],(u=Object(r.safeCastString)(null==g?void 0:g.value))&&(s=null!==(i=n.find((function(n){return AppMagic.ConnectionHub.Connection.isMsFlowCompositeConnection(n)&&t._doesConnectionMatchRefDependencies(n,e,c)&&n.connectionParameters.workflowEntityId&&Object(r.equalsIgnoreCase)(u,n.connectionParameters.workflowEntityId)})))&&void 0!==i?i:s),s||(b=m[f.ParameterHintNames.msFlowWorkflowName],p=Object(r.safeCastString)(b.value),s=null!==(a=n.find((function(n){return AppMagic.ConnectionHub.Connection.isMsFlowCompositeConnection(n)&&t._doesConnectionMatchRefDependencies(n,e,c)&&n.connectionParameters.workflowName&&Object(r.equalsIgnoreCase)(p,n.connectionParameters.workflowName)})))&&void 0!==a?a:s)):s=n.find((function(n){return t._doesConnectionMatchRefDependencies(n,e,c)}));return(A=s)?[3,2]:(r.Log.trackActivityEvent(r.existingCompositeConnectionNotFound,{apiId:e.connectionRef.id,connectionReferenceId:e.id}),[4,this._tryCreateCompositeConnectionAsync(e,c)]);case 1:A=C.sent(),C.label=2;case 2:return A?(e.connectionInstanceId="string"==typeof A?A:A.id,this._connectionReferenceStore.update(e.id,e)):r.CoreLog.errorEx("PowerAppsClient._resolveCompositeReferenceAsync",{message:"Could not resolve composite connection",eventData:{connectionRef:e.id,api:e.connectionRef.id}}),[2,A]}}))}))},t.prototype.tryResetCompositeConnectionAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n,o,i,a;return __generator(this,(function(s){switch(s.label){case 0:return r.FallbackSwitch.isActivated("AppConnectivity.FixFlowOn401")?[2,null]:(t=this._connectionReferenceStore.getAll(),(n=t.find((function(t){return Object(r.equalsIgnoreCase)(t.connectionInstanceId,e.id)})))?(o=this._getConnectionIdTableFromDependencies(n.dependencies),[4,this._tryCreateCompositeConnectionAsync(n,o,e.name)]):(r.CoreLog.errorEx("PowerAppsClient.tryResetCompositeConnectionAsync",{message:"connection not found in connection store",eventData:{connectionName:e.name}}),[2,null]));case 1:return null==(i=s.sent())?(r.CoreLog.errorEx("PowerAppsClient.tryResetCompositeConnectionAsync",{message:"could not reset composite connection",eventData:{connectionName:e.name}}),[2,null]):(a=null,"string"!=typeof i?[3,4]:[4,this._userService.getConnectionServiceAsync()]);case 2:return[4,s.sent().tryGetConnectionByIdAsync(i,!0)];case 3:return a=s.sent(),[3,5];case 4:a=i,s.label=5;case 5:return a?(this._appResources.connections.push(a),Object(r.equalsIgnoreCase)(a.id,e.id)||(r.CoreLog.warningEx("PowerAppsClient.tryResetCompositeConnectionAsync",{message:"reset connection created a new connection id",eventData:{connectionName:e.name,newConnectionName:a.name}}),n.connectionInstanceId=a.id,this._connectionReferenceStore.update(n.id,n),this._onAppConnectionsChanged())):r.CoreLog.errorEx("PowerAppsClient.tryResetCompositeConnectionAsync",{message:"Connection not found",eventData:{connectionName:e.name}}),[2,a]}}))}))},t.prototype._tryCreateCompositeConnectionAsync=function(e,t,n){var o,i;return __awaiter(this,void 0,Promise,(function(){var a,s,c,u,p,l,d,y,m;return __generator(this,(function(g){switch(g.label){case 0:return r.Log.trackEvent(r.disambiguationCreateCompositeConnection,{apiId:e.connectionRef.id}),a=e.connectionRef.id,(c=null===(i=null===(o=this._appResources)||void 0===o?void 0:o.appInfo)||void 0===i?void 0:i.environment)?[3,2]:[4,this._userService.getEnvironmentService().getCurrentEnvironmentAsync()];case 1:c=g.sent(),g.label=2;case 2:s=c,u=e.connectionRef.parameterHints,g.label=3;case 3:return g.trys.push([3,5,,6]),[4,this._putOrInstallConnectionAsync(s,e,t,a,n)];case 4:return[2,g.sent()];case 5:return p=g.sent(),l=u[f.ParameterHintNames.msFlowWorkflowName],d=Object(r.safeCastString)(null==l?void 0:l.value),y=u[f.ParameterHintNames.msWorkflowEntityId],m=Object(r.safeCastString)(null==y?void 0:y.value),Object(r.trace)(r.CategoryNames.Connection,"ConnectionCreationFailed",{appId:this._appResources.appInfo?this._appResources.appInfo.id:"",info:Object(r.CoreUtility_formatString)(AppMagic.Strings.FailedToCreateCompositeConnection,e.dataSources.toString()),error:p,apiId:a,workflowName:d,workflowEntityId:m,helpUrl:"https://aka.ms/PowerAutomateConnectionIssues"}),r.CoreLog.errorEx("PowerAppsClient._tryCreateCompositeConnectionAsync",{error:p,eventData:{apiId:a,workflowName:d,workflowEntityId:m},message:"Error creating composite connection"}),[2,null];case 6:return[2]}}))}))},t.prototype.useInstallApi=function(){return r.authoring.useInstallApi},t.prototype._putOrInstallConnectionAsync=function(e,t,n,i,a){var s;return __awaiter(this,void 0,Promise,(function(){var c,u,p,l,d,y,m,g,b,h,A,C,P,w=this;return __generator(this,(function(S){switch(S.label){case 0:return c=this._appResources.apis.find((function(e){return v.PowerAppsUtility.compareApiId(e.id,i)})),[4,this._userService.getConnectionServiceAsync()];case 1:if(u=S.sent(),!AppMagic.ConnectionHub.Api.isMsFlowApi(t.connectionRef.id))return[3,9];if(l=t.connectionRef.parameterHints,d=l[f.ParameterHintNames.msWorkflowEntityId],y=Object(r.safeCastString)(null==d?void 0:d.value),!this._isSolutionAwareApp()||!y)return[3,5];if(!!!(null===(s=null==e?void 0:e.properties)||void 0===s?void 0:s.linkedEnvironmentMetadata))return[3,5];S.label=2;case 2:return S.trys.push([2,4,,5]),r.Log.trackActivityEvent(r.installCdsWorkflowStarted,{workflowEntityId:y}),[4,this._installCdsWorkflowInternalAsync(e,y,n,c)];case 3:return h=S.sent(),r.Log.trackActivityEvent(r.installCdsWorkflowCompleted,{workflowEntityId:y}),[2,h];case 4:return m=S.sent(),p=m,r.Log.trackWarningEvent(r.fallbackToPutConnection,{message:"Flow CDS install failed. Falling back to useInstallApi or put connection."}),[3,5];case 5:if(!this.useInstallApi())return[3,9];g=l[f.ParameterHintNames.msFlowWorkflowName],b=Object(r.safeCastString)(null==g?void 0:g.value),S.label=6;case 6:return S.trys.push([6,8,,9]),[4,r.Log.trackPromiseScenario(r.ScenarioName.InstallWorkflow,(function(){return w._installWorkflowInternalAsync(e,n,b,c)}))];case 7:return[2,h=S.sent()];case 8:return A=S.sent(),void 0===p&&(p=A),r.Log.trackWarningEvent(r.fallbackToPutConnection,{message:"Flow install using install API failed. Falling back to put connection."}),[3,9];case 9:C=o.CompositeConnection.createCompositeConnectionPutRequest(t,c,this._getConnectionTableFromDependencies(t.dependencies)),S.label=10;case 10:return S.trys.push([10,12,,13]),[4,u.putConnectionAsync(null!=a?a:Object(r.generateNonDashedUUID)(),c,C)];case 11:return[2,S.sent()];case 12:throw P=S.sent(),p&&(this._connectionInstallErrors||(this._connectionInstallErrors=Object(r.HashTableUtility_create)())),this._connectionInstallErrors[t.id]=null!=p?p:P,null!=p?p:P;case 13:return[2]}}))}))},t.prototype._generateFlowRequest=function(e){var t={connectionReferences:{}};return Object(r.HashTableUtility_forEach)(e,(function(e,n){var r=e.split("/connections/",2);if(2!==r.length){throw new Error("Install flow Api input request is invalid.")}t.connectionReferences[n]={connectionName:r[1],id:r[0]}})),t},t.prototype._installWorkflowInternalAsync=function(e,t,n,o){return __awaiter(this,void 0,Promise,(function(){var i,a;return __generator(this,(function(s){switch(s.label){case 0:s.label=1;case 1:return s.trys.push([1,4,,5]),i=this._generateFlowRequest(t),[4,this._userService.getConnectionServiceAsync()];case 2:return[4,s.sent().installWorkflowAsync(i,e.name,n,o)];case 3:return[2,s.sent()];case 4:throw a=s.sent(),r.CoreLog.errorEx("PowerAppsClient._installWorkflowInternalAsync",{error:a,message:"Failed to Install Microsoft Workflow."}),a;case 5:return[2]}}))}))},t.prototype._installCdsWorkflowInternalAsync=function(e,t,n,o){return __awaiter(this,void 0,Promise,(function(){var i,a;return __generator(this,(function(s){switch(s.label){case 0:s.label=1;case 1:return s.trys.push([1,4,,5]),i=this._generateFlowRequest(n),[4,this._userService.getConnectionServiceAsync()];case 2:return[4,s.sent().installCdsWorkflowAsync(e.properties.linkedEnvironmentMetadata.instanceUrl,t,i,o)];case 3:return[2,s.sent()];case 4:throw a=s.sent(),r.Log.trackActivityEvent(r.installCdsWorkflowFailed,{workflowEntityId:t}),r.CoreLog.errorEx("PowerAppsClient._installCdsWorkflowInternalAsync",{error:a,message:"Failed to Install Microsoft Workflow."}),a;case 5:return[2]}}))}))},t.prototype._isSolutionAwareApp=function(){var e,t,n;return"Solution"===(null===(n=null===(t=null===(e=this._appResources)||void 0===e?void 0:e.appInfo)||void 0===t?void 0:t.appInfoProperties)||void 0===n?void 0:n.almMode)},t.prototype._areDependenciesResolved=function(e,t){if(!this._appResources)return r.CoreLog.warningEx("PowerAppsClient._areDependenciesResolved","appResources not set"),!1;var n=this._appResources.connections.find((function(e){return e.id===t}));if(!n)return r.CoreLog.warningEx("PowerAppsClient._areDependenciesResolved","flow connection not found in appResources"),!1;var i=this._getConnectionIdTableFromDependencies(e);return!!o.CompositeConnection.matchCompositeDependencies(i,n.dependentConnectionIds)},t.prototype._getConnectionIdTableFromDependencies=function(e){var t=this,n=Object(r.HashTableUtility_create)();return Object(r.HashTableUtility_forEach)(e,(function(e,o){var i=t._connectionReferenceStore.tryGet(e);i?n[o]=i.connectionInstanceId:r.CoreLog.warning("PowerAppsClient._getConnectionIdTableFromDependencies","Dependency for '".concat(e,"' should have been found in reference store"))})),n},t.prototype._getConnectionTableFromDependencies=function(e){var t=this;return Object(r.HashTableUtility_map)(e,(function(e,n){var r=t._connectionReferenceStore.tryGet(e),o=t._appResources.connections.find((function(e){return e.id===r.connectionInstanceId}));return o||null}))},t._isDatasetConfigurationNeeded=function(e){return!!e&&Object(r.HashTableUtility_some)(e,(function(e){return e.datasetOverride&&!e.datasetOverride.name}))},t.prototype.getPreviouslyUnauthenticatedConnectionDataSources=function(e){var t=this,n=Object(r.HashTableUtility_create)();this.referenceStore.getAll().forEach((function(e){n[e.id]=e}));var o=[];return Object(r.HashTableUtility_forEach)(n,(function(n,i){var a=e[i];a?a.isAuthenticated||o.splice.apply(o,__spreadArray([o.length,0],t._getDataSources(n),!1)):r.Log.trackActivityEvent("PowerAppsClient.getPreviouslyUnauthenticatedConnectionDataSources",{message:"No connection found for LocalConnection: "+i})})),o},t.prototype.tryGetAndShowRPMessagesAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2]}))}))},t.prototype.getAppDatasetIdsByConnectionId=function(e){return this._connectionReferenceStore.getAppDatasetIdsByConnectionId(e)},t.prototype.hasConnectionApiReference=function(e){return this._connectionReferenceStore.hasConnectionApiReference(e)},t.prototype._getDataSources=function(e){var t=this,n=[];return e.dataSources&&n.splice.apply(n,__spreadArray([n.length,0],e.dataSources,!1)),e.dependents&&e.dependents.forEach((function(e){var r=t.referenceStore.tryGet(e);n.splice.apply(n,__spreadArray([n.length,0],r.dataSources,!1))})),n},t.prototype.postCompositeUsageAsync=function(e,t,n){var o;return __awaiter(this,void 0,Promise,(function(){var i,a,s;return __generator(this,(function(c){switch(c.label){case 0:return[4,this.userService.userFeaturesManager.isPostFlowUsagesEnabledAsync()];case 1:if(!c.sent())return[2];if(r.FallbackSwitch.isActivated("AppConnectivity.PostCompositeConnectionUsage"))return[3,5];c.label=2;case 2:return c.trys.push([2,4,,5]),(i=null===(o=this._appResources)||void 0===o?void 0:o.appInfo.name)?(a=Object(r.tryGetValueIgnoreCase)(this._appResources.connectionUsages,t))&&Object(r.equalsIgnoreCase)(a.connection.id,e.id)?[2]:[4,this._userService.getConnectionServiceAsync()]:(r.CoreLog.errorEx("PowerAppsClient.postCompositeUsageAsync","appName not available to post usage"),[2]);case 3:return c.sent().postConnectionUsageAsync(i,e.apiId,e.name,t,n),this._appResources.upsertConnectionUsage(t,e),[3,5];case 4:return s=c.sent(),r.CoreLog.warningEx("PowerAppsClient.postCompositeUsageAsync","Non-fatal error while saving composite usage",{error:s}),[3,5];case 5:return[2]}}))}))},t}(r.Disposable)},function(e,t,n){"use strict";n.r(t),n.d(t,"AppPreloadDataContractVersion",(function(){return r}));var r=2},function(e,t,n){"use strict";n.r(t),n.d(t,"AccessTokenAcquirer",(function(){return r}));n(0);var r=function(e){function t(t,n,r,o,i){var a=this;return(a=e.call(this,r,i)||this)._clientId=t,a._resource=n,a._redirectUri=o,a}return __extends(t,e),t.prototype._acquireResourceAsync=function(e,t){var n=this;return this.authenticationContext.acquireTokenAsync(this._resource,this._clientId,this._redirectUri,e,t).then((function(e){return n._saveTokenResponseAsync(e)}))},t}(n(288).a)},function(e,t,n){"use strict";n.r(t),n.d(t,"ResourceAcquirerBase",(function(){return r}));n(0);var r=function(){function e(){}return e.prototype.isAcquiring=function(){return this._isAcquiring},e.prototype.acquireResource=function(e,t){var n=this;return this._isAcquiring=!0,this._acquireResourceAsync(e,t).then((function(e){return n._isAcquiring=!1,e}),(function(e){return n._isAcquiring=!1,Promise.reject(e)}))},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"AuthenticationPluginWrapper",(function(){return s}));var r=n(0),o=n(45),i=n(116),a=n(70),s=function(){function e(e){var t=this;this._lazyAuthenticationPlugin=new r.AsyncLazy("authenticationPlugin",(function(){return __awaiter(t,void 0,void 0,(function(){var t;return __generator(this,(function(n){switch(n.label){case 0:return t=Object(r.getAadTenantId)(),[4,e.loadConfigurationAsync({tenantId:t})];case 1:return n.sent(),[2,e]}}))}))})),this._promiseQueue=new r.PromiseQueue("AuthenticationPluginWrapper"),this._isDisposed=!1}return e.prototype.acquireTokenAsync=function(e,t,n,o){return __awaiter(this,void 0,Promise,(function(){var i,a,s,c,u;return __generator(this,(function(p){switch(p.label){case 0:return i="",o&&((s=Object(r.HashTableUtility_create)()).login_hint=o.emailAddress,(c=new r.UrlBuilder("")).setQueryParams(s),i=(i=c.toString()).slice(1),i=decodeURIComponent(i),o.claims&&(a=o.claims)),[4,this._lazyAuthenticationPlugin.valueAsync()];case 1:return u=p.sent(),[4,this._getAdalResponseCore((function(){return u.acquireTokenAsync(e,t,n.toString(),{extraQueryParameters:i,claims:a})}),{operationName:"AuthenticationPluginWrapper.acquireTokenAsync",resourceUrl:e,pluginName:u.name})];case 2:return[2,p.sent()]}}))}))},e.prototype.acquireTokenSilentAsync=function(e,t,n){return __awaiter(this,void 0,Promise,(function(){var r,o;return __generator(this,(function(i){switch(i.label){case 0:return r=n&&n.objectId||"",[4,this._lazyAuthenticationPlugin.valueAsync()];case 1:return o=i.sent(),[2,this._getAdalResponseCore((function(){return o.acquireTokenSilentAsync(e,t,r)}),{operationName:"AuthenticationPluginWrapper.acquireTokenSilentAsync",resourceUrl:e,pluginName:o.name})]}}))}))},e.prototype.logOutAsync=function(){var e=this;return this._promiseQueue.pushJob((function(){return e._logOutActionAsync()}))},e.prototype._logOutActionAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e,t;return __generator(this,(function(n){switch(n.label){case 0:return[4,this._lazyAuthenticationPlugin.valueAsync()];case 1:e=n.sent(),n.label=2;case 2:return n.trys.push([2,4,,5]),r.Log.trackActivityEvent("AuthenticationPluginWrapper.logOutAsync",{message:"Clearing all tokens"}),[4,e.clearAsync()];case 3:return[2,n.sent()];case 4:return t=n.sent(),Object(r.throwIfCanceled)(t),Object(r.errorEx)("AuthenticationPluginWrapper.logOutAsync",{error:t,eventData:{pluginName:e.name}}),[3,5];case 5:return[2]}}))}))},e.prototype.dispose=function(){this._promiseQueue.cancelAll(),this._isDisposed=!0},e.prototype._getAdalResponseCore=function(e,t){return __awaiter(this,void 0,Promise,(function(){var n,a,s=this;return __generator(this,(function(c){switch(c.label){case 0:return n=r.Log.startScenario(r.ScenarioName.Authentication,t),a=function(){return __awaiter(s,void 0,Promise,(function(){var a,s,c,u,p;return __generator(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,e()];case 1:return a=l.sent(),s=Object(i.parse)(a),c=this._getTokenTelemetryOptions(s),r.Log.endScenario(n,{customScenarioData:c}),[2,s];case 2:throw u=l.sent(),p=this._onError(u,n,t.operationName),u instanceof o.AuthenticationError&&u.errorKind===o.AuthenticationErrorKind.LogoutRequested&&this._promiseQueue.cancelAll(),p;case 3:return[2]}}))}))},Object(r.isWebPlayer)()?[4,a()]:[3,2];case 1:return[2,c.sent()];case 2:return[4,this._promiseQueue.pushJob(a)];case 3:return[2,c.sent()]}}))}))},e.prototype._getTokenTelemetryOptions=function(e){var t={};if(!e||!e.accessToken)return t;var n=a.JsonWebToken.tryParse(e.accessToken);return n&&n.payload?(t.amr=n.payload.amr,t.iss=n.payload.iss,t.idp=n.payload.idp,t.isGuest=!!t.idp&&t.idp!==t.iss,t):t},e.prototype._onError=function(e,t,n){r.Log.endAndThrowIfCanceled(e,t);var i=o.AuthenticationError.toAuthenticationError(e);if(i.errorKind===o.AuthenticationErrorKind.NotLoggedInError||i.errorKind===o.AuthenticationErrorKind.UserCancelledError)return r.Log.endScenario(t),i;var a={pluginName:this._lazyAuthenticationPlugin.isValueCreated&&this._lazyAuthenticationPlugin.value.name};i.correlationId&&(a.errorCorrelationId=i.correlationId),Object(r.errorEx)(n,{error:e,eventData:a});var s={};return i.correlationId&&(s.errorCorrelationId=i.correlationId),r.Log.failScenario(t,{error:e,customScenarioData:s}),i},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"AuthenticationProviderRequestAuthenticator",(function(){return i}));var r=n(0),o=function(){function e(e){this._request=e}return e.prototype.addHeader=function(e,t){this._request.headers||(this._request.headers=Object(r.HashTableUtility_create)()),this._request.headers[e]=t},e.prototype._notSupported=function(){throw new Error("Not supported.")},e.prototype.clone=function(){return this._notSupported()},e.prototype.generateSendHttpRequestParameters=function(){return this._notSupported()},e.prototype.setMethod=function(e){return this._notSupported()},e.prototype.setBaseUrl=function(e){return this._notSupported()},e.prototype.addQueryParameter=function(e,t){return this._notSupported()},e.prototype.addPath=function(e){return this._notSupported()},e.prototype.addTemplateToPath=function(e,t,n){return this._notSupported()},e}(),i=function(){function e(e){this._authProvider=e}return e.prototype.authenticateRequestAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(n){switch(n.label){case 0:return t=new o(e),[4,this._authProvider.authenticateRequestAsync(t)];case 1:return n.sent(),[2]}}))}))},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"AuthenticationProvider",(function(){return i}));var r=n(0),o=n(160),i=function(){function e(){this._authenticator=new o.AuthenticationProviderRequestAuthenticator(this),this._isDisposed=!1,this._pendingPromises=[],this.abortController=new AbortController}return Object.defineProperty(e.prototype,"authenticator",{get:function(){return this._authenticator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),e.prototype.authenticateAsync=function(e){return this._handlePendingPromise(this.authenticateCoreAsync(e,this.abortController.signal))},e.prototype.authenticateRequestAsync=function(e){return this._handlePendingPromise(this.authenticateRequestCoreAsync(e,this.abortController.signal))},e.prototype._handlePendingPromise=function(e){var t=this;this._pendingPromises.push(e);var n=Object(r.wrapWithFinally)(e,(function(){var n=t._pendingPromises.indexOf(e);t._pendingPromises.splice(n,1)}));return Object(r.preventCancel)(n)},e.prototype.dispose=function(){var e=this;this._pendingPromises.slice(0).forEach((function(t){Object(r.abortPromise)(t,e.abortController)})),this._isDisposed=!0},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"AuthenticationProvider",(function(){return i}));var r=n(0),o=n(3),i=function(e){function t(t,n,r,o){var i=this;return(i=e.call(this)||this)._store=o,i._parentContext=t,i._tokenAwaiterPool=n,i._silentTokenAwaiterPool=r,i}return __extends(t,e),Object.defineProperty(t.prototype,"store",{get:function(){return this._store},enumerable:!1,configurable:!0}),t.prototype.authenticateCoreAsync=function(e,t){return this._tokenAwaiterPool.acquire(e,t).then((function(e){}))},t.prototype.authenticateRequestCoreAsync=function(e){return this._tokenAwaiterPool.acquire().then((function(t){e.addHeader(o.HeaderName.Authorization,"Bearer "+t)}))},t.prototype.authenticateSilentAsync=function(e){return(null==e?void 0:e.bypassCache)?Promise.reject("Silent Auth Bypass Indicated"):Object(r.preventCancel)(this._silentTokenAwaiterPool.acquire(e)).then((function(e){}))},t.prototype.logOutAsync=function(){return Object(r.verbose)("Logging out Azure AuthenticationProvider."),this._store.clear(),Object(r.verbose)("Logged out Azure AuthenticationProvider."),Promise.resolve()},t.prototype.logOutSharedStateAsync=function(){return r.Log.trackActivityEvent("AuthenticationProvider.logOutSharedStateAsync"),this._parentContext.logOutAsync()},t.prototype.clearUserIdentity=function(){this._parentContext.clearUserIdentity()},t}(n(161).AuthenticationProvider)},function(e,t,n){"use strict";n.r(t),n.d(t,"UserContext",(function(){return r}));n(0);var r=function(){function e(){}return Object.defineProperty(e.prototype,"identityToken",{get:function(){return this._validate(),this._identityToken},set:function(e){this._identityToken=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"accessToken",{get:function(){return this._validate(),this._accessToken},set:function(e){this._accessToken=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"expiresOn",{get:function(){return this._validate(),new Date(this._expiresOn)},set:function(e){this._expiresOn=e.getTime()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fromCache",{get:function(){return this._fromCache},set:function(e){this._fromCache=e},enumerable:!1,configurable:!0}),e.prototype._validate=function(){this._expiresOn&&this._expiresOn>Date.now()||this.clear()},e.prototype.clear=function(){this._accessToken=null,this._identityToken=null,this._expiresOn=null},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r,o=n(0),i=n(22),a=n(2),s=n(25),c=n(13);!function(e){e.RegionName="dod",e.endpointTitle="DepartmentOfDefense",e.powerAppsRedirectUri=new o.Core_Url(""),e.authUri=new o.Core_Url("https://login.microsoftonline.us/common/"),e.powerAppsServiceResource="https://service.apps.appsplatform.us/",e.flowsResource="https://service.flow.appsplatform.us/",e.webAuthResource="8d70984e-79a4-4ed4-a682-30faaff7f4ef",e.powerBIServiceResource="https://analysis.usmilcloudapi.net/powerbi/api",e.apiHubRuntimeAudience="https://power-apis-usdod-001.azure-apihub.us",e.consentServerResource=e.apiHubRuntimeAudience,e.flowRPEndpoint=new o.Core_Url("https://api.flow.appsplatform.us"),e.flowPortalEndpoint=new o.Core_Url("https://flow.appsplatform.us/"),e.docServerEndpoint=new o.Core_Url("https://create.apps.appsplatform.us/");var t=new o.Core_Url("https://go.microsoft.com/fwlink/?linkid=841572"),n=new o.Core_Url("https://go.microsoft.com/fwlink/?linkid=841573");function r(){return new o.Core_Url("https://api.apps.appsplatform.us")}function u(){return a.PowerAppEndpoints.getApiVersion()}e.ecsHostResource="https://config.ecs.dod.teams.microsoft.us/",e.neptuneResource="https://licensing.appsplatform.us/",e.neptuneAudience="https://licensing.appsplatform.us/auth",e.getPowerAppsRpBaseUrl=r,e.getApiVersionValue=u,e.getCdmRpApiVersionValue=function(){return a.PowerAppEndpoints.getCdmRpApiVersion()},e.portalEndPoint=new o.Core_Url("https://make.apps.appsplatform.us/"),e.appDownloadRootEndPoint=new o.Core_Url("https://play.apps.appsplatform.us/open/"),e.playerResourcesEndpoint=new o.Core_Url(""),e.consumerPortalEndPoint=new o.Core_Url("https://make.apps.appsplatform.us/"),e.webPlayerSignUpEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkId=2024661"),e.webPlayerConsentEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkId=2024811"),e.webAuthoringSignUpEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkId=2024661"),e.InstallGatewayLinkUrl=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkID=820585"),e.InstallVNetGatewayLinkUrl=new o.Core_Url("https://TODO"),e.cesFeedbackEndpoint="",e.microsoftGraphEndpoint=new o.Core_Url("https://dod-graph.microsoft.us/"),e.microsoftGraphResource="https://dod-graph.microsoft.us/",e.getValues=function(){var p=s.a.getValues();return p.name=e.RegionName,p.clusterCategory="dod",p.endpointTitle=e.endpointTitle,p.portalUri=e.portalEndPoint,p.appDownloadRootUri=e.appDownloadRootEndPoint,p.consumerPortalUri=e.consumerPortalEndPoint,p.powerAppsRpBaseUrl=r(),p.powerAppsApiVersion=u(),p.powerPlatformRpBaseUrl=Object(c.b)(p.clusterCategory),p.powerPlatformRpApiVersion=a.PowerAppEndpoints.powerPlatformApiVersion,p.powerPlatformTenantBaseUrl=Object(c.d)(p.clusterCategory),p.powerPlatformEnvironmentBaseUrl=Object(c.c)(p.clusterCategory),p.bapBaseUrl=i.BapEndpoints.Military.getBaseUrl(),p.bapApiVersion=i.BapEndpoints.Military.getApiVersionValue(),p.cdsApiVersion="",p.cdsBaseUrl=new o.Core_Url(""),p.clientConsentEndPoint=s.a.getClientConsentEndPoint(t,n),p.webPlayerSignUpEndPoint=e.webPlayerSignUpEndPoint,p.webPlayerConsentEndPoint=e.webPlayerConsentEndPoint,p.webAuthoringSignUpEndPoint=e.webAuthoringSignUpEndPoint,p.gcmSenderId="",p.intelligenceStudioBaseUrl=new o.Core_Url("https://make.mil.powerapps.us"),p.playerResourcesEndpoint=e.playerResourcesEndpoint,p.docServerEndpoint=e.docServerEndpoint,p.powerAppsServiceResource=e.powerAppsServiceResource,p.powerPlatformResource=Object(c.e)(p.clusterCategory),p.logInResource=e.powerAppsServiceResource,p.authUri=e.authUri,p.flowsResource=e.flowsResource,p.webAuthResource=e.webAuthResource,p.powerBIServiceResource=e.powerBIServiceResource,p.apiHubRuntimeAudience=e.apiHubRuntimeAudience,p.consentServerResource=e.consentServerResource,p.cesFeedbackEndpoint=e.cesFeedbackEndpoint,p.microsoftGraphEndpoint=e.microsoftGraphEndpoint,p.microsoftGraphResource=e.microsoftGraphResource,p.flowRpBaseUrl=e.flowRPEndpoint,p.flowPortalBaseUrl=e.flowPortalEndpoint,p.ecsHostResource=e.ecsHostResource,p.neptuneResource=e.neptuneResource,p.neptuneAudience=e.neptuneAudience,p}}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r,o=n(0),i=n(22),a=n(48),s=n(2),c=n(25),u=n(13);!function(e){e.RegionName="ex",e.endpointTitle="USNat",e.powerAppsRedirectUri=new o.Core_Url(""),e.authUri=new o.Core_Url("https://login.microsoftonline.eaglex.ic.gov/common/"),e.powerAppsServiceResource="https://service.powerapps.eaglex.ic.gov/",e.flowsResource="https://service.flow.eaglex.ic.gov/",e.webAuthResource="7a46adcf-cda2-4cba-8aba-0d9d9f3cecbc",e.powerBIServiceResource="https://analysis.eaglex.ic.gov/powerbi/api",e.apiHubRuntimeAudience="https://azure-apihub.eaglex.ic.gov",e.consentServerResource=e.apiHubRuntimeAudience,e.flowRPEndpoint=new o.Core_Url("https://api.flow.eaglex.ic.gov"),e.flowPortalEndpoint=new o.Core_Url("https://flow.eaglex.ic.gov/"),e.docServerEndpoint=new o.Core_Url("https://create.powerapps.eaglex.ic.gov/");var t=new o.Core_Url("https://aka.eaglex.ic.gov/fwlink/?linkid=2143705"),n=new o.Core_Url("https://aka.eaglex.ic.gov/fwlink/?linkid=2143663");function r(){return new o.Core_Url("https://api.powerapps.eaglex.ic.gov")}function p(){return s.PowerAppEndpoints.getApiVersion()}e.ecsHostResource="https://config.ecs.teams.eaglex.ic.gov/",e.neptuneResource="https://licensing.powerplatform.eaglex.ic.gov/",e.neptuneAudience="https://licensing.powerplatform.eaglex.ic.gov/auth",e.getPowerAppsRpBaseUrl=r,e.getApiVersionValue=p,e.getCdmRpApiVersionValue=function(){return s.PowerAppEndpoints.getCdmRpApiVersion()},e.portalEndPoint=new o.Core_Url("https://make.powerapps.eaglex.ic.gov/"),e.appDownloadRootEndPoint=new o.Core_Url("https://apps.powerapps.eaglex.ic.gov/open/"),e.playerResourcesEndpoint=new o.Core_Url(""),e.consumerPortalEndPoint=new o.Core_Url("https://aka.eaglex.ic.gov/fwlink/?LinkId=2161030"),e.webPlayerSignUpEndPoint=new o.Core_Url("https://aka.eaglex.ic.gov/fwlink/?LinkId=2143708"),e.webPlayerConsentEndPoint=new o.Core_Url("https://aka.eaglex.ic.gov/fwlink/?LinkId=2143709"),e.webAuthoringSignUpEndPoint=new o.Core_Url("https://aka.eaglex.ic.gov/fwlink/?LinkId=2143710"),e.InstallGatewayLinkUrl=new o.Core_Url("https://aka.eaglex.ic.gov/fwlink/?LinkID=2143712"),e.InstallVNetGatewayLinkUrl=new o.Core_Url("https://TODO"),e.cesFeedbackEndpoint="",e.microsoftGraphEndpoint=new o.Core_Url("https://graph.eaglex.ic.gov/"),e.microsoftGraphResource="https://graph.eaglex.ic.gov/",e.getValues=function(){var l=c.a.getValues();return l.name=e.RegionName,l.clusterCategory="ex",l.endpointTitle=e.endpointTitle,l.portalUri=e.portalEndPoint,l.appDownloadRootUri=e.appDownloadRootEndPoint,l.consumerPortalUri=e.consumerPortalEndPoint,l.powerAppsRpBaseUrl=r(),l.powerAppsApiVersion=p(),l.powerPlatformRpBaseUrl=Object(u.b)(l.clusterCategory),l.powerPlatformRpApiVersion=s.PowerAppEndpoints.powerPlatformApiVersion,l.powerPlatformTenantBaseUrl=Object(u.d)(l.clusterCategory),l.powerPlatformEnvironmentBaseUrl=Object(u.c)(l.clusterCategory),l.bapBaseUrl=i.BapEndpoints.Ex.getBaseUrl(),l.bapApiVersion=i.BapEndpoints.Ex.getApiVersionValue(),l.cdsApiVersion="",l.cdsBaseUrl=new o.Core_Url(""),l.clientConsentEndPoint=c.a.getClientConsentEndPoint(t,n),l.webPlayerSignUpEndPoint=e.webPlayerSignUpEndPoint,l.webPlayerConsentEndPoint=e.webPlayerConsentEndPoint,l.webAuthoringSignUpEndPoint=e.webAuthoringSignUpEndPoint,l.gcmSenderId="",l.intelligenceStudioBaseUrl=a.IntelligenceEndpoints.Ex.intelligenceStudioBaseUrl,l.playerResourcesEndpoint=e.playerResourcesEndpoint,l.docServerEndpoint=e.docServerEndpoint,l.powerAppsServiceResource=e.powerAppsServiceResource,l.powerPlatformResource=Object(u.e)(l.clusterCategory),l.logInResource=e.powerAppsServiceResource,l.authUri=e.authUri,l.flowsResource=e.flowsResource,l.webAuthResource=e.webAuthResource,l.powerBIServiceResource=e.powerBIServiceResource,l.apiHubRuntimeAudience=e.apiHubRuntimeAudience,l.consentServerResource=e.consentServerResource,l.microsoftGraphEndpoint=e.microsoftGraphEndpoint,l.microsoftGraphResource=e.microsoftGraphResource,l.powerAppsBadBaseUrl=null,l.powerAppsBadApiVersion=null,l.cesFeedbackEndpoint=e.cesFeedbackEndpoint,l.flowRpBaseUrl=e.flowRPEndpoint,l.flowPortalBaseUrl=e.flowPortalEndpoint,l.ecsHostResource=e.ecsHostResource,l.neptuneResource=e.neptuneResource,l.neptuneAudience=e.neptuneAudience,l}}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r,o=n(0),i=n(22),a=n(2),s=n(25),c=n(13);!function(e){e.RegionName="gcchigh",e.endpointTitle="GccHigh",e.powerAppsRedirectUri=new o.Core_Url(""),e.authUri=new o.Core_Url("https://login.microsoftonline.us/common/"),e.powerAppsServiceResource="https://high.service.powerapps.us/",e.flowsResource="https://high.service.flow.microsoft.us/",e.webAuthResource="8d70984e-79a4-4ed4-a682-30faaff7f4ef",e.powerBIServiceResource="https://analysis.ushighcloudapi.net/powerbi/api",e.docServerEndpoint=new o.Core_Url("https://high.create.powerapps.us/"),e.microsoftGraphResource="https://graph.microsoft.us/",e.apiHubRuntimeAudience="https://power-apis-usgov001-sovereign.azure-apihub.us",e.consentServerResource=e.apiHubRuntimeAudience,e.flowRPEndpoint=new o.Core_Url("https://high.api.flow.microsoft.us"),e.flowPortalEndpoint=new o.Core_Url("https://high.flow.microsoft.us/");var t=new o.Core_Url("https://go.microsoft.com/fwlink/?linkid=841572"),n=new o.Core_Url("https://go.microsoft.com/fwlink/?linkid=841573");function r(){return new o.Core_Url("https://high.api.powerapps.us")}function u(){return a.PowerAppEndpoints.getApiVersion()}e.ecsHostResource="https://config.ecs.gov.teams.microsoft.us/",e.neptuneResource="https://high.licensing.powerplatform.microsoft.us/",e.neptuneAudience="https://high.licensing.powerplatform.microsoft.us/auth",e.getPowerAppsRpBaseUrl=r,e.getApiVersionValue=u,e.getCdmRpApiVersionValue=function(){return a.PowerAppEndpoints.getCdmRpApiVersion()},e.microsoftGraphEndpoint=new o.Core_Url("https://graph.microsoft.us/"),e.portalEndPoint=new o.Core_Url("https://make.high.powerapps.us/"),e.appDownloadRootEndPoint=new o.Core_Url("https://apps.high.powerapps.us/open/"),e.playerResourcesEndpoint=new o.Core_Url(""),e.consumerPortalEndPoint=new o.Core_Url("https://make.high.powerapps.us/"),e.webPlayerSignUpEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkId=2024661"),e.webPlayerConsentEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkId=2024811"),e.webAuthoringSignUpEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkId=2024661"),e.InstallGatewayLinkUrl=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkID=820585"),e.InstallVNetGatewayLinkUrl=new o.Core_Url("https://TODO"),e.createPVABotUrl=new o.Core_Url("https://high.powerva.microsoft.us/"),e.aibTextServiceResource="",e.aibTextServiceEndpoint="",e.cesFeedbackServiceResource="",e.cesFeedbackEndpoint="",e.getValues=function(){var p=s.a.getValues();return{name:e.RegionName,clusterCategory:"high",endpointTitle:e.endpointTitle,portalUri:e.portalEndPoint,appDownloadRootUri:e.appDownloadRootEndPoint,consumerPortalUri:e.consumerPortalEndPoint,powerAppsRpBaseUrl:r(),powerAppsApiVersion:u(),powerPlatformRpBaseUrl:Object(c.b)("high"),powerPlatformRpApiVersion:a.PowerAppEndpoints.powerPlatformApiVersion,powerPlatformTenantBaseUrl:Object(c.d)("high"),powerPlatformEnvironmentBaseUrl:Object(c.c)("high"),bapBaseUrl:i.BapEndpoints.GccHigh.getBaseUrl(),bapApiVersion:i.BapEndpoints.GccHigh.getApiVersionValue(),cdsBaseUrl:new o.Core_Url(""),cdsApiVersion:"",clientConsentEndPoint:s.a.getClientConsentEndPoint(t,n),webPlayerSignUpEndPoint:e.webPlayerSignUpEndPoint,webPlayerConsentEndPoint:e.webPlayerConsentEndPoint,webAuthoringSignUpEndPoint:e.webAuthoringSignUpEndPoint,gcmSenderId:"",flowsResource:e.flowsResource,docServerEndpoint:e.docServerEndpoint,docServerRegion:null,authUri:e.authUri,installGatewayLinkUrl:e.InstallGatewayLinkUrl,installVNetGatewayLinkUrl:e.InstallVNetGatewayLinkUrl,apiHubRuntimeAudience:e.apiHubRuntimeAudience,consentServerResource:e.consentServerResource,microsoftGraphEndpoint:e.microsoftGraphEndpoint,microsoftGraphResource:e.microsoftGraphResource,intelligenceStudioBaseUrl:new o.Core_Url("https://make.high.powerapps.us"),powerAppsServiceResource:e.powerAppsServiceResource,powerPlatformResource:Object(c.e)("high"),logInResource:e.powerAppsServiceResource,playerResourcesEndpoint:e.playerResourcesEndpoint,webAuthResource:e.webAuthResource,powerBIServiceResource:e.powerBIServiceResource,powerAppsBadBaseUrl:null,powerAppsBadApiVersion:null,formsProServiceResource:p.formsProServiceResource,microsoftStreamServiceResource:p.microsoftStreamServiceResource,appFromTemplateUseExtendedGallery:p.appFromTemplateUseExtendedGallery,rtsDataServiceResource:p.rtsDataServiceResource,paRpInvokeUrl:p.paRpInvokeUrl,paBadInvokeUrl:p.paBadInvokeUrl,redirectUri:p.redirectUri,useCustomDocServerPackager:p.useCustomDocServerPackager,clientId:p.clientId,powerAppsRedirectUri:p.powerAppsRedirectUri,flowRpBaseUrl:e.flowRPEndpoint,aibTextServiceResource:e.aibTextServiceResource,aibTextServiceEndpoint:e.aibTextServiceEndpoint,flowPortalBaseUrl:e.flowPortalEndpoint,cesFeedbackEndpoint:e.cesFeedbackEndpoint,cesFeedbackServiceResource:e.cesFeedbackServiceResource,ecsHostResource:e.ecsHostResource,neptuneResource:e.neptuneResource,neptuneAudience:e.neptuneAudience,createPVABotUrl:e.createPVABotUrl}}}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r,o=n(0),i=n(22),a=n(2),s=n(25),c=n(13);!function(e){e.RegionName="gccmoderate",e.endpointTitle="GccModerate",e.authUri=new o.Core_Url("https://login.microsoftonline.com/common/"),e.powerAppsServiceResource="https://gov.service.powerapps.us/",e.flowsResource="https://gov.service.flow.microsoft.us/",e.webAuthResource="4361fe6e-7866-4c68-868f-034650097f33",e.powerBIServiceResource="https://analysis.usgovcloudapi.net/powerbi/api",e.formsProServiceResource="",e.microsoftStreamServiceResource="cf53fce8-def6-4aeb-8d30-b158e7b1cf83",e.apiHubRuntimeAudience="https://power-apis-usgov001-public.azure-apihub.us",e.consentServerResource=e.apiHubRuntimeAudience,e.docServerEndpoint=new o.Core_Url("https://gov.create.powerapps.us/"),e.microsoftGraphResource="https://graph.microsoft.com/",e.flowRPEndpoint=new o.Core_Url("https://gov.api.flow.microsoft.us"),e.flowPortalEndpoint=new o.Core_Url("https://gov.flow.microsoft.us/"),e.teamsEndpoint=new o.Core_Url("https://teams.microsoft.com"),e.teamsPowerAppsId="ba1cabe6-dfd2-4334-96c0-0dcdf86e18e5";var t=new o.Core_Url("https://go.microsoft.com/fwlink/?linkid=2024805"),n=new o.Core_Url("https://go.microsoft.com/fwlink/?linkid=2024657");function r(){return new o.Core_Url("https://gov.api.powerapps.us")}function u(){return a.PowerAppEndpoints.getApiVersion()}e.ecsHostResource="https://ecs.office.com",e.createPVABotUrl=new o.Core_Url("https://gcc.powerva.microsoft.us/"),e.getPowerAppsRpBaseUrl=r,e.getApiVersionValue=u,e.getCdmRpApiVersionValue=function(){return a.PowerAppEndpoints.getCdmRpApiVersion()},e.playerResourcesEndpoint=new o.Core_Url("https://paplayercdn-gov.azureedge.net/"),e.consumerPortalEndPoint=new o.Core_Url("https://make.gov.powerapps.us/"),e.microsoftGraphEndpoint=new o.Core_Url("https://graph.microsoft.com/"),e.portalEndPoint=new o.Core_Url("https://make.gov.powerapps.us/"),e.appDownloadRootEndPoint=new o.Core_Url("https://apps.gov.powerapps.us/open/"),e.webPlayerSignUpEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkId=2024661"),e.webPlayerConsentEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkId=2024811"),e.webAuthoringSignUpEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkId=2024661"),e.InstallGatewayLinkUrl=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkID=820585"),e.InstallVNetGatewayLinkUrl=new o.Core_Url("https://TODO"),e.neptuneResource="https://gov.licensing.powerplatform.microsoft.us/",e.neptuneAudience="https://gov.licensing.powerplatform.microsoft.us/auth",e.aibTextServiceResource="",e.aibTextServiceEndpoint="",e.cesFeedbackServiceResource="",e.cesFeedbackEndpoint="",e.getValues=function(){var p=s.a.getValues();return{name:e.RegionName,clusterCategory:"gov",endpointTitle:e.endpointTitle,portalUri:e.portalEndPoint,appDownloadRootUri:e.appDownloadRootEndPoint,consumerPortalUri:e.consumerPortalEndPoint,powerAppsRpBaseUrl:r(),powerAppsApiVersion:u(),powerPlatformRpBaseUrl:Object(c.b)("gov"),powerPlatformRpApiVersion:a.PowerAppEndpoints.powerPlatformApiVersion,powerPlatformTenantBaseUrl:Object(c.d)("gov"),powerPlatformEnvironmentBaseUrl:Object(c.c)("gov"),bapBaseUrl:i.BapEndpoints.Gcc.getBaseUrl(),bapApiVersion:i.BapEndpoints.Gcc.getApiVersionValue(),cdsApiVersion:"",cdsBaseUrl:new o.Core_Url(""),clientConsentEndPoint:s.a.getClientConsentEndPoint(t,n),teamsEndpoint:e.teamsEndpoint,teamsPowerAppsId:e.teamsPowerAppsId,webPlayerSignUpEndPoint:e.webPlayerSignUpEndPoint,webPlayerConsentEndPoint:e.webPlayerConsentEndPoint,webAuthoringSignUpEndPoint:e.webAuthoringSignUpEndPoint,installGatewayLinkUrl:e.InstallGatewayLinkUrl,installVNetGatewayLinkUrl:e.InstallVNetGatewayLinkUrl,gcmSenderId:"",playerResourcesEndpoint:e.playerResourcesEndpoint,docServerEndpoint:e.docServerEndpoint,logInResource:e.powerAppsServiceResource,powerAppsServiceResource:e.powerAppsServiceResource,powerPlatformResource:Object(c.e)("gov"),authUri:e.authUri,flowsResource:e.flowsResource,webAuthResource:e.webAuthResource,powerBIServiceResource:e.powerBIServiceResource,formsProServiceResource:e.formsProServiceResource,microsoftStreamServiceResource:e.microsoftStreamServiceResource,intelligenceStudioBaseUrl:new o.Core_Url("https://make.gov.powerapps.us"),consentServerResource:e.consentServerResource,apiHubRuntimeAudience:e.apiHubRuntimeAudience,microsoftGraphEndpoint:e.microsoftGraphEndpoint,microsoftGraphResource:e.microsoftGraphResource,docServerRegion:null,clientId:p.clientId,redirectUri:p.redirectUri,rtsDataServiceResource:p.rtsDataServiceResource,powerAppsRedirectUri:p.powerAppsRedirectUri,paRpInvokeUrl:p.paRpInvokeUrl,paBadInvokeUrl:p.paBadInvokeUrl,useCustomDocServerPackager:p.useCustomDocServerPackager,appFromTemplateUseExtendedGallery:p.appFromTemplateUseExtendedGallery,powerAppsBadBaseUrl:null,powerAppsBadApiVersion:null,flowRpBaseUrl:e.flowRPEndpoint,flowPortalBaseUrl:e.flowPortalEndpoint,aibTextServiceResource:e.aibTextServiceResource,aibTextServiceEndpoint:e.aibTextServiceEndpoint,cesFeedbackEndpoint:e.cesFeedbackEndpoint,cesFeedbackServiceResource:e.cesFeedbackServiceResource,ecsHostResource:e.ecsHostResource,neptuneResource:e.neptuneResource,neptuneAudience:e.neptuneAudience,createPVABotUrl:e.createPVABotUrl}}}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r,o=n(0),i=n(22),a=n(48),s=n(2),c=n(25),u=n(13);!function(e){e.RegionName="mooncake",e.endpointTitle="Mooncake",e.powerAppsRedirectUri=new o.Core_Url(""),e.authUri=new o.Core_Url("https://login.chinacloudapi.cn/common/"),e.powerAppsServiceResource="https://service.powerapps.cn/",e.flowsResource="https://service.powerautomate.cn/",e.webAuthResource="96d13b6c-70e3-4272-b1b8-9ebf89c35e87",e.powerBIServiceResource="https://analysis.chinacloudapi.cn/powerbi/api",e.docServerEndpoint=new o.Core_Url("https://create.powerapps.cn/"),e.microsoftGraphResource="https://microsoftgraph.chinacloudapi.cn/",e.apiHubRuntimeAudience="https://china.azure-apihub.cn",e.consentServerResource=e.apiHubRuntimeAudience,e.flowRPEndpoint=new o.Core_Url("https://api.powerautomate.cn"),e.flowPortalEndpoint=new o.Core_Url("https://www.powerautomate.cn/");var t=new o.Core_Url("https://go.microsoft.com/fwlink/?linkid=2128739"),n=new o.Core_Url("https://go.microsoft.com/fwlink/?linkid=2128636");function r(){return new o.Core_Url("https://api.powerapps.cn")}function p(){return s.PowerAppEndpoints.getApiVersion()}e.ecsHostResource="https://ecs.office.com",e.neptuneResource="https://licensing.partner.microsoftonline.cn/",e.neptuneAudience="https://licensing.partner.microsoftonline.cn/auth",e.getPowerAppsRpBaseUrl=r,e.getApiVersionValue=p,e.getCdmRpApiVersionValue=function(){return s.PowerAppEndpoints.getCdmRpApiVersion()},e.microsoftGraphEndpoint=new o.Core_Url("https://graph.chinacloudapi.cn/"),e.portalEndPoint=new o.Core_Url("https://make.powerapps.cn/"),e.appDownloadRootEndPoint=new o.Core_Url("https://apps.powerapps.cn/open/"),e.playerResourcesEndpoint=new o.Core_Url(""),e.consumerPortalEndPoint=new o.Core_Url("https://make.powerapps.cn/"),e.webPlayerSignUpEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?linkid=2128738"),e.webPlayerConsentEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?linkid=2128590"),e.webAuthoringSignUpEndPoint=new o.Core_Url("https://go.microsoft.com/fwlink/?linkid=2128834"),e.InstallGatewayLinkUrl=new o.Core_Url("https://go.microsoft.com/fwlink/?LinkID=817346"),e.InstallVNetGatewayLinkUrl=new o.Core_Url("https://TODO"),e.aibTextServiceResource="",e.aibTextServiceEndpoint="",e.cesFeedbackServiceResource="",e.cesFeedbackEndpoint="",e.getValues=function(){var l=c.a.getValues();return{name:e.RegionName,clusterCategory:"mooncake",endpointTitle:e.endpointTitle,portalUri:e.portalEndPoint,appDownloadRootUri:e.appDownloadRootEndPoint,consumerPortalUri:e.consumerPortalEndPoint,powerAppsRpBaseUrl:r(),powerAppsApiVersion:p(),bapBaseUrl:i.BapEndpoints.Mooncake.getBaseUrl(),bapApiVersion:i.BapEndpoints.Mooncake.getApiVersionValue(),powerPlatformRpBaseUrl:Object(u.b)("mooncake"),powerPlatformRpApiVersion:s.PowerAppEndpoints.powerPlatformApiVersion,powerPlatformTenantBaseUrl:Object(u.d)("mooncake"),powerPlatformEnvironmentBaseUrl:Object(u.c)("mooncake"),cdsBaseUrl:new o.Core_Url(""),cdsApiVersion:"",clientConsentEndPoint:c.a.getClientConsentEndPoint(t,n),webPlayerSignUpEndPoint:e.webPlayerSignUpEndPoint,webPlayerConsentEndPoint:e.webPlayerConsentEndPoint,webAuthoringSignUpEndPoint:e.webAuthoringSignUpEndPoint,gcmSenderId:"",flowsResource:e.flowsResource,docServerEndpoint:e.docServerEndpoint,docServerRegion:null,authUri:e.authUri,installGatewayLinkUrl:e.InstallGatewayLinkUrl,installVNetGatewayLinkUrl:e.InstallVNetGatewayLinkUrl,apiHubRuntimeAudience:e.apiHubRuntimeAudience,consentServerResource:e.consentServerResource,microsoftGraphEndpoint:e.microsoftGraphEndpoint,microsoftGraphResource:e.microsoftGraphResource,intelligenceStudioBaseUrl:a.IntelligenceEndpoints.Mooncake.intelligenceStudioBaseUrl,powerAppsServiceResource:e.powerAppsServiceResource,powerPlatformResource:Object(u.e)("mooncake"),logInResource:e.powerAppsServiceResource,playerResourcesEndpoint:e.playerResourcesEndpoint,webAuthResource:e.webAuthResource,powerBIServiceResource:e.powerBIServiceResource,powerAppsBadBaseUrl:null,powerAppsBadApiVersion:null,formsProServiceResource:l.formsProServiceResource,microsoftStreamServiceResource:l.microsoftStreamServiceResource,appFromTemplateUseExtendedGallery:l.appFromTemplateUseExtendedGallery,rtsDataServiceResource:l.rtsDataServiceResource,paRpInvokeUrl:l.paRpInvokeUrl,paBadInvokeUrl:l.paBadInvokeUrl,redirectUri:l.redirectUri,useCustomDocServerPackager:l.useCustomDocServerPackager,clientId:l.clientId,powerAppsRedirectUri:l.powerAppsRedirectUri,flowRpBaseUrl:e.flowRPEndpoint,flowPortalBaseUrl:e.flowPortalEndpoint,aibTextServiceResource:e.aibTextServiceResource,aibTextServiceEndpoint:e.aibTextServiceEndpoint,cesFeedbackEndpoint:e.cesFeedbackEndpoint,cesFeedbackServiceResource:e.cesFeedbackServiceResource,ecsHostResource:e.ecsHostResource,neptuneResource:e.neptuneResource,neptuneAudience:e.neptuneAudience}}}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"DisambiguationRuleManager",(function(){return y}));var r=n(0),o=n(85),i=n(6),a=n(103),s=n(4),c=n(58),u=function(){function e(){}return e.prototype.applyRule=function(e,t,n){AppMagic.ConnectionHub.Api.isMsFlowApi(e.id)&&delete n[t]},e.prototype.applyRuleAndDisambiguateAsync=function(e,t,n,r,o,i){return this.applyRule(e,t,n),Promise.resolve()},e}(),p=function(){function e(){}return e.prototype.applyRule=function(e,t,n){e.dependencies&&!Object(r.HashTableUtility_isEmpty)(e.dependencies)&&delete n[t]},e.prototype.applyRuleAndDisambiguateAsync=function(e,t,n,r,o,i){return this.applyRule(e,t,n),Promise.resolve()},e}(),l=function(){function e(e){this._connectionService=e}return e.prototype.applyRule=function(e,t,n){this._doesRuleApply(e)&&(r.CoreLog.verbose("AdminBypassConnectionsRule: local connection: {0} with ApiId: {1} has bypassConsent flag. Removing it from disambiguation list.",t,e.id),delete n[t])},e.prototype.applyRuleAndDisambiguateAsync=function(e,t,n,i,s,u){return this._doesRuleApply(e)?(r.CoreLog.verbose("AdminBypassConnectionsRule: local connection: {0} with ApiId: {1} has bypassConsent flag. Removing it from disambiguation list.",t,e.id),this._tryGetOrCreateConnectionAsync(e.id,e,s).then((function(r){if(r)return delete n[t],i.saveDisambiguationResultsAndUpdateRuntimeAsync([{connection:r,localConnectionId:t,apiId:e.id,actions:e.appActions}],a.ScopeConsentType.adminBypass,u)})).catch((function(t){return t instanceof o.a?(e.consentOptions={manualLoginSettings:AppMagic.ConnectionHub.ManualLoginSettings.Force},r.Log.trackActivityEvent("AdminBypassConnectionsRule.applyRuleAndDisambiguateAsync",{message:"SSO failed, will try manual consent",id:e.id}),Object(r.trace)(r.CategoryNames.Connection,"CannotBypassConnection",{apiName:e.displayName,info:AppMagic.Strings.BypassConnectionUserInteractionRequired,error:t}),Promise.resolve()):t instanceof c.ConnectionError&&t.source==c.ConnectionErrorSource.TestConnection?(e.consentOptions={manualLoginSettings:AppMagic.ConnectionHub.ManualLoginSettings.Force},r.Log.trackActivityEvent("AdminBypassConnectionsRule.applyRuleAndDisambiguateAsync",{message:"Test connection failed. Will show consent dialog",id:e.id}),Object(r.trace)(r.CategoryNames.Connection,"CannotBypassConnection",{apiName:e.displayName,info:AppMagic.Strings.BypassConnectionUserInteractionRequired,error:t}),Promise.resolve()):Promise.reject(t)}))):Promise.resolve()},e.prototype._tryGetOrCreateConnectionAsync=function(e,t,n){var o,i=this,a=n.connections,c=null==a?void 0:a.find((function(t){return t.apiId===e}));if((null===(o=null==c?void 0:c.api)||void 0===o?void 0:o.isCustomApi)&&m(c.api,t.isOnPremiseConnection))return r.Log.trackActivityEvent("AdminBypassConnectionsRule._tryGetOrCreateConnectionAsync",{message:"Bypassing custom connection",apiId:e}),Promise.resolve(c);var u=t.sharedConnectionId;if(u){u=u.toLocaleLowerCase();var p=a.find((function(e){return e.id===u}));if(p)return Promise.resolve(p);r.CoreLog.warning("AdminBypassConnectionsRule._tryGetOrCreateConnectionAsync","SharedConnectionRefId was set for API '".concat(e,"', but we could not find the connection."))}else r.CoreLog.verbose("AdminBypassConnectionsRule: SharedConnectionRefId is not set for API: {0}",e);var l=n.apis.find((function(t){return s.PowerAppsUtility.compareApiId(t.id,e)})),d=AppMagic.ConnectionHub.PowerAppsConnectionService.getParameterSetName(t),f=AppMagic.ConnectionHub.PowerAppsConnectionService.isSqlNonSharedConnectionReference(t);if(l&&l.getIsFirstParty(d)){var y=f?a.find((function(t){return t.apiId===e&&!t.isOnPremise&&t.multiAuthParametersSetName===d})):a.find((function(n){return n.apiId===e&&(t.isOnPremiseConnection&&n.isOnPremise||!t.isOnPremiseConnection&&!n.isOnPremise)&&i._isConnectionForCurrentUser(n)}));return y?Promise.resolve(y):this._connectionService.addConnectionAsync(l,void 0,t.gatewayObjectIdHint,void 0,d,void 0,!0)}return Object(r.trace)(r.CategoryNames.Connection,"CannotBypassConnection",{apiName:t.displayName,info:AppMagic.Strings.BypassConnectionIsNotSSO}),r.CoreLog.warning("AdminBypassConnectionsRule._tryGetOrCreateConnectionAsync","Connection for API ".concat(e," was set to bypassConsent. However, sharedConnectionId is invalid and it is not SSO, so we cannot create it.")),Promise.resolve(null)},e.prototype._isConnectionForCurrentUser=function(e){return!!r.FallbackSwitch.isActivated("AppConnectivity.SPOConnectionMatchCurrentUser")||this._connectionService.isConnectionForCurrentUser(e)},e.prototype._doesRuleApply=function(e){return e.bypassConsent},e}(),d=function(){function e(e){this._connectionService=e}return e.prototype._doesRuleApply=function(e){return i.t.isRuntimeServiceApi(e.id)},e.prototype.applyRule=function(e,t,n){this._doesRuleApply(e)&&delete n[t]},e.prototype.applyRuleAndDisambiguateAsync=function(e,t,n,o,i,s){var c=this;if(this._doesRuleApply(e)){var u;r.CoreLog.verbose("HideRtsConnectionAndResolveNamespaceRule: App has runtime services. Remove it from disambiguation.");var p=Object(r.HashTableUtility_create)();return this._getOrCreateConnectionAsync(i).then((function(t){u=t;var n=[];return e.datasets&&Object(r.forEach)(e.datasets,(function(e,t){e.datasetOverride&&!e.datasetOverride.name&&n.push(c._connectionService.getAvailableRtsNamespacesAsync().then((function(e){e.length>0&&(p[t]=e[0].name)})))})),Object(r.join)(n)})).then((function(){return delete n[t],o.saveDisambiguationResultsAndUpdateRuntimeAsync([{connection:u,localConnectionId:t,datasetOverrides:p,apiId:e.id,actions:e.appActions}],a.ScopeConsentType.powerAppsRequired,s)}))}return Promise.resolve()},e.prototype._getOrCreateConnectionAsync=function(e){var t=e.connections.find((function(e){return e.isRuntimeService}));if(t)return Promise.resolve(t);var n=e.apis.find((function(e){return e.isRuntimeService}));return this._connectionService.addConnectionAsync(n)},e}(),f=function(){function e(e){this._connectionService=e}return e.prototype.applyRule=function(e,t,n){},e.prototype.applyRuleAndDisambiguateAsync=function(e,t,n,o,i,a){return this._doesRuleApply(e)?this._tryCreateCustomConnectionAsync(e.id,e,i).then((function(e){e&&i.connections.push(e)})).catch((function(t){return r.Log.trackWarningEvent("AutoCreateCustomConnectionRule.applyRuleAndDisambiguateAsync",{message:"Auto create of custom connection failed",id:e.id,error:t}),Promise.resolve()})):Promise.resolve()},e.prototype._tryCreateCustomConnectionAsync=function(e,t,n){var o=n.connections;if(null==o?void 0:o.find((function(t){return t.apiId===e})))return Promise.resolve(null);var i=n.apis.find((function(t){return s.PowerAppsUtility.compareApiId(t.id,e)})),a=AppMagic.ConnectionHub.PowerAppsConnectionService.getParameterSetName(t);return i&&m(i,t.isOnPremiseConnection)?(r.Log.trackActivityEvent("AutoCreateCustomConnectionRule._tryCreateCustomConnectionAsync",{message:"Auto creating custom connection",apiId:e}),this._connectionService.addConnectionAsync(i,t.isOnPremiseConnection?Object(r.HashTableUtility_create)({authType:"anonymous"}):void 0,t.isOnPremiseConnection?t.gatewayObjectIdHint:void 0,void 0,a)):Promise.resolve(null)},e.prototype._doesRuleApply=function(e){return e.isCustomApiConnection},e}(),y=function(){function e(e){this._rules=[],this._rules.push(new d(e)),this._rules.push(new f(e)),this._rules.push(new l(e)),this._rules.push(new u),this._rules.push(new p)}return e.prototype.executeRules=function(e){var t=this;if(Object(r.HashTableUtility_isEmpty)(e))return e;var n=Object(r.clone)(e);return Object(r.forEach)(n,(function(e,r){t._rules.forEach((function(t){t.applyRule(e,r,n)}))})),n},e.prototype.executeRulesAndDisambiguateAsync=function(e,t,n,o){var i=this;if(Object(r.HashTableUtility_isEmpty)(e))return Promise.resolve(Object(r.clone)(e));var a=Object(r.clone)(e),s=[];return Object(r.forEach)(e,(function(e,r){var c=Promise.resolve();i._rules.forEach((function(i){c=c.then((function(){return i.applyRuleAndDisambiguateAsync(e,r,a,t,n,o)}))})),s.push(c)})),Object(r.join)(s).then((function(){return a}),(function(e){r.CoreLog.error("DisambiguationRuleManager.executeRulesAndDisambiguateAsync",e);var t=e.find((function(e){return Object(r.isCanceledError)(e)}));if(t)return Promise.reject(t);var n=e.find((function(e){return Object(r.isDefined)(e)}));return Promise.reject(n)}))},e}();function m(e,t){var n,o,a,s,c;try{var u=null!==(n=e.getConnectionParameters())&&void 0!==n?n:{};if(!t&&Object(r.HashTableUtility_isEmpty)(u))return!0;if(t){var p=e.getGatewayParameterName();if(p&&2==Object(r.count)(u)){var l=Object(r.tryGetValueIgnoreCase)(u,"authType"),d=Object(r.tryGetValueIgnoreCase)(u,p);if(l&&l.type===i.r.String&&1==(null===(s=null===(a=null===(o=l.uiDefinition)||void 0===o?void 0:o.constraints)||void 0===a?void 0:a.allowedValues)||void 0===s?void 0:s.length)&&"anonymous"==(null===(c=l.uiDefinition.constraints.allowedValues[0].value)||void 0===c?void 0:c.toLowerCase())&&d&&d.type===i.r.GatewaySetting)return!0}}}catch(e){r.Log.trackWarningEvent("AdminBypassConnectionsRule._canBypassOrAutoCreateCustomConnection","Error. Custom connection will not be bypassed or auto created")}return!1}},function(e,t,n){"use strict";n.r(t),n.d(t,"ModelAppInfo",(function(){return r}));n(0);var r=function(e){function t(t,n){var r=this;return(r=e.call(this,t.originalJson,t.id,t.name,t.description,t.aiGeneratedDescription,t.createdDate,t.lastModifiedDate,t.getDocumentUrl(),t.getPlayerPackageUrl(),t.getPlayerReadOnlyPackageUrl(),t.getDebugPlayerPackageUrl(),t.displayName,t.backgroundColor,t.getBackgroundImageUrl(),t.authResources,t.publisher,t.supportsPortrait,t.supportsLandscape,t.hasComponent,t.hasUnlockedComponent,t.primaryDeviceWidth,t.primaryDeviceHeight,t.primaryFormFactor,t.sienaVersion,t.publisherVersion,t.minimumRequiredApiVersion,t.deviceCapabilities,t.getTags(),t.environment,t.connectionReferences,t.databaseReferences,t.sharedGroupsCount,t.sharedUsersCount,null===t.owner?void 0:t.owner,null===t.lastModifiedBy?void 0:t.lastModifiedBy,null===t.createdBy?void 0:t.createdBy,t.getWebPackageUrl(),t.getWebReadOnlyPackageUrl(),t.sharePointSiteId,t.sharePointListId,t.getDebugWebPackageUrl(),t.isFavorite,t.lastOpenedTime,t.isFeaturedApp,t.isHeroApp,t.includeInAppsList,t.appPackageResourcesKind,t.documentServerVersion,t.packagePropertiesJson,t.appInfoProperties,t.bypassConsent,t.showStatusBar)||this)._appOpenUrl=n,r}return __extends(t,e),Object.defineProperty(t.prototype,"appOpenUri",{get:function(){return this._appOpenUrl},enumerable:!1,configurable:!0}),t}(n(15).AppInfo)},function(e,t,n){"use strict";n.r(t),n.d(t,"TemplatePackageBuilder",(function(){return s}));var r=n(0),o=n(12),i=n(2),a=n(4),s=function(){function e(e){void 0===e&&(e=null),this._tags=Object(r.HashTableUtility_create)(),this._documentUri=null,this._packageUri=null,this._debugPlayerPackageUri=null,this._entityReferences=Object(r.HashTableUtility_create)(),this._debugWebPackageUri=null,this._libraryComponents=null,e&&this._initializeWithAppInfo(e)}return e.prototype._initializeWithAppInfo=function(e){var t=this,n=e.getTags();Object(r.HashTableUtility_forEach)(n,(function(e,n){return t.setTag(n,e)})),Object(r.isString)(e.commitMessage)&&(this._commitMessage=e.commitMessage),e.embeddedAppMetadata&&(this._embeddedAppInfo=e.embeddedAppMetadata),e.screenshots&&e.screenshots.length>0&&(this._screenshots=e.screenshots.map((function(e){return e.toString()})))},Object.defineProperty(e.prototype,"description",{set:function(e){this._description=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"commitMessage",{set:function(e){this._commitMessage=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sourceControl",{set:function(e){this._sourceControl=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenshots",{set:function(e){this._screenshots=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appName",{set:function(e){this._appName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lifeCycleId",{set:function(e){this._lifeCycleId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appType",{get:function(){return this._appType},set:function(e){this._appType=e},enumerable:!1,configurable:!0}),e.prototype.buildLibraryComponents=function(e,t,n,r){var o=this;void 0===r&&(r=null),this._libraryComponents=this._appType===AppMagic.PowerApps.Constants.AppTypesFromRP.AppComponentLibrary?n.map((function(n){return __assign(__assign({},n),{createdOn:e,lastModifiedOn:t,tags:r,connectionReferences:o._connectionReferences,databaseReferences:o._databaseReferences})})):null},Object.defineProperty(e.prototype,"embeddedAppMetadata",{set:function(e){this._embeddedAppInfo=e},enumerable:!1,configurable:!0}),e.prototype.setScreenSize=function(e,t){this._embeddedAppInfo&&(this._embeddedAppInfo.screenHeight=e,this._embeddedAppInfo.screenWidth=t),this.setTag(i.TemplateTags.primaryDeviceWidth,t.toString()),this.setTag(i.TemplateTags.primaryDeviceHeight,e.toString())},Object.defineProperty(e.prototype,"displayName",{set:function(e){this._displayName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"publisher",{set:function(e){this._publisher=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backgroundColor",{set:function(e){this._backgroundColor=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backgroundImageUri",{set:function(e){this._backgroundImageUri=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"performanceOptimizationEnabled",{set:function(e){this._performanceOptimizationEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canConsumeAppPass",{set:function(e){this._canConsumeAppPass=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"additionalUris",{set:function(e){e.forEach((function(e){})),this._additionalUris=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"documentUri",{set:function(e){this._documentUri=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playerPackageUri",{set:function(e){this._packageUri=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"debugPlayerPackageUri",{set:function(e){this._debugPlayerPackageUri=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"debugWebPackageUri",{set:function(e){this._debugWebPackageUri=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"environment",{set:function(e){this._environment=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectionReferences",{set:function(e){this._connectionReferences=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"databaseReferences",{set:function(e){this._databaseReferences=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authorizationReferences",{set:function(e){this._authorizationReferences=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appComponentDependencies",{set:function(e){this._appComponentDependencies=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableModernRuntimeMode",{set:function(e){this._enableModernRuntimeMode=e},enumerable:!1,configurable:!0}),e.prototype.deleteTag=function(e){this._tags[e]&&delete this._tags[e]},e.prototype.setTag=function(e,t){this._tags[e]=t},e.prototype.addRtsEntityReference=function(e,t){this._entityReferences[e]={entityId:t}},e.prototype.getPackage=function(){var e,t,n,i=null===this._documentUri?null:{documentUri:{value:this._documentUri}};null!==this._packageUri&&(i.playerPackageUri={value:this._packageUri}),null!==this._debugPlayerPackageUri&&(i.debugPlayerPackageUri={value:this._debugPlayerPackageUri}),null!==this._debugWebPackageUri&&(i.debugWebPackageUri={value:this._debugWebPackageUri}),this._additionalUris&&this._additionalUris.length>0&&(i.additionalUris=this._additionalUris);var s=a.PowerAppsUtility.parseVersionString(r.Version.VERSION_NUMBER),c={appUris:i,displayName:this._displayName,publisher:this._publisher,backgroundImageUri:this._backgroundImageUri,description:this._description,commitMessage:this._commitMessage,environment:this._environment,backgroundColor:this._backgroundColor,minClientVersion:s,createdByClientVersion:s,embeddedApp:null!==(e=this._embeddedAppInfo)&&void 0!==e?e:null,lifeCycleId:this._lifeCycleId,performanceOptimizationEnabled:this._performanceOptimizationEnabled,canConsumeAppPass:this._canConsumeAppPass,sourceControl:null!==(t=this._sourceControl)&&void 0!==t?t:null,enableModernRuntimeMode:null!==(n=this._enableModernRuntimeMode)&&void 0!==n&&n};this._screenshots&&(c.appUris.imageUris=this._screenshots.map((function(e){return{value:e}}))),this._authorizationReferences&&this._authorizationReferences.length>0&&(c.authorizationReferences=this._authorizationReferences),this._connectionReferences&&!Object(r.HashTableUtility_isEmpty)(this._connectionReferences)&&(c.connectionReferences=this._connectionReferences),this._databaseReferences&&!Object(r.HashTableUtility_isEmpty)(this._databaseReferences)&&(c.databaseReferences=this._databaseReferences),Object(r.HashTableUtility_isEmpty)(this._entityReferences)||(c.entityReferences=this._entityReferences);var u={properties:c,tags:Object(o.r)(this._tags)};return u.appType=this._appType,this._libraryComponents&&(u.appComponents=this._libraryComponents),this._appComponentDependencies&&(u.appComponentDependencies=this._appComponentDependencies),u.name=this._appName,u},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n(0);var r=function(){function e(e,t,n,r){void 0===r&&(r=null),this._name=e,this._uiDefinition=n,this._parameters=t,this._metadata=r}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uiDefinition",{get:function(){return this._uiDefinition},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parameters",{get:function(){return this._parameters},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._metadata},enumerable:!1,configurable:!0}),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"factory",(function(){return r}));var r=new(n(174).XmlHttpRequestFactory)},function(e,t,n){"use strict";n.r(t),n.d(t,"XmlHttpRequestFactory",(function(){return s}));var r=n(0),o=n(175),i=n(176),a=n(177),s=function(){function e(){}return e.prototype.createXmlHttpRequestSender=function(){return Object(r.isWorkerContext)()&&!this._canMakeCrossDomainRequestsOnWorker()?new i.PostMessageXmlHttpRequestSender:new a.XmlHttpRequestSender},e.prototype.createXmlHttpRequestReceiver=function(e){return this._canMakeCrossDomainRequestsOnWorker()?null:new o.PostMessageXmlHttpRequestReceiver(e)},e.prototype._canMakeCrossDomainRequestsOnWorker=function(){return WinJS.Utilities.hasWinRT&&!Object(r.isWebAuthoring)()},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"PostMessageXmlHttpRequestReceiver",(function(){return a}));n(0);var r=n(23),o=n(87),i=n(108),a=function(){function e(e){this._worker=e,this._onMessageFn=this._onMessage.bind(this),this._worker.addEventListener("message",this._onMessageFn)}return e.prototype.dispose=function(){this._worker.removeEventListener("message",this._onMessageFn)},e.prototype._onMessage=function(e){var t=this;if(void 0!==e.data.type&&e.data.type===o.PostMessageXmlHttpRequestConstants.RequestMessage){var n=e.data.opts;WinJS.xhr(n).then((function(n){return t._onSuccess(n,e.data.requestid)}),(function(n){return t._onError(n,e.data.requestid)}))}},e.prototype._onSuccess=function(e,t){var n=(new i.XmlHttpRequestSerializer).serialize(e);this._worker.postMessage({type:o.PostMessageXmlHttpRequestConstants.ResultMessage,responseid:t,result:n},null)},e.prototype._onError=function(e,t){this._worker.postMessage({type:o.PostMessageXmlHttpRequestConstants.ResultMessage,responseid:t,error:this._serializeError(e)},null)},e.prototype._serializeError=function(e){var t=null;e instanceof XMLHttpRequest?t=(new i.XmlHttpRequestSerializer).serialize(e):e instanceof Error&&(t={status:0,headers:{},responseType:r.ResponseTypes.Text,responseText:e.message});return t},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"PostMessageXmlHttpRequestSender",(function(){return a}));var r=n(0),o=n(87),i=n(108),a=function(){function e(){this._currentRequestId=0,this._requestIdToCompletablePromise=Object(r.HashTableUtility_create)(),this._onMessageReceivedFn=this._onMessageReceived.bind(this),self.addEventListener("message",this._onMessageReceivedFn)}return e.prototype.xhr=function(e){var t=Object(r.createCompletablePromise)();return self.postMessage({type:o.PostMessageXmlHttpRequestConstants.RequestMessage,requestid:this._currentRequestId,opts:e},null),this._requestIdToCompletablePromise[this._currentRequestId]=t,this._currentRequestId++,t.promise},e.prototype.dispose=function(){self.removeEventListener("message",this._onMessageReceivedFn)},e.prototype._onMessageReceived=function(e){var t=e.data;if(t.type===o.PostMessageXmlHttpRequestConstants.ResultMessage){var n=this._requestIdToCompletablePromise[t.responseid],r=new i.XmlHttpRequestSerializer;t.error?n.error(r.deserialize(t.error)):n.complete(r.deserialize(t.result)),delete this._requestIdToCompletablePromise[t.responseid]}},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"XmlHttpRequestSender",(function(){return r}));var r=function(){function e(){}return e.prototype.xhr=function(e){return WinJS.xhr(e)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"WinJSPABinaryResolver",(function(){return a}));var r=n(0),o=n(95),i=n(3),a=function(){function e(e){this._xhr=e}return e.prototype.getAsBlobAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(n){switch(n.label){case 0:return"blob"!==e.source.sourceType||e.contentType&&e.source.blob.type!==e.contentType?[4,this._getAsArrayBufferCoreAsync(e)]:[2,e.source.blob];case 1:return t=n.sent(),[2,new Blob([t],{type:e.contentType})]}}))}))},e.prototype.getAsArrayBufferAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){return[2,this._getAsArrayBufferCoreAsync(e)]}))}))},e.prototype._getAsArrayBufferCoreAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n;return __generator(this,(function(a){switch(a.label){case 0:switch(e.source.sourceType){case"appRelativeFile":return[3,1];case"arrayBuffer":return[3,3];case"base64String":return[3,4];case"blob":return[3,5];case"invalid":return[3,6]}return[3,7];case 1:return[4,this._xhr({url:e.source.relativeUrl,type:"GET",responseType:"arraybuffer"})];case 2:return t=a.sent(),(n=t.getResponseHeader(i.HeaderName.ContentType))&&e.contentType&&n!==e.contentType&&Object(r.tryExtractMimeTypeFromMediaType)(n)!==Object(r.tryExtractMimeTypeFromMediaType)(e.contentType)&&r.Log.trackActivityEvent("WinJSPABinaryResolver._getAsArrayBufferCoreAsync",{message:"Retrieving appRelativeFile via xhr resulted in a Content-Type header that is inconsistent with the originating PABinary's contentType. (Content-Type header: '".concat(n,"', binary.contentType: '").concat(e.contentType,"')")}),[2,t.response];case 3:return[2,e.source.buffer];case 4:return[2,Object(o.base64ToArrayBuffer)(e.source.base64)];case 5:return[2,Object(o.convertBlobToArrayBuffer)(e.source.blob)];case 6:throw r.PABinary.createErrorFromInvalid(e);case 7:throw new r.NotSupportedError("WinJSPABinaryResolver._getAsArrayBufferCoreAsync","sourceType: "+e.source.sourceType)}}))}))},e.prototype.getAsTextAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(n){switch(n.label){case 0:switch(e.source.sourceType){case"appRelativeFile":return[3,1];case"arrayBuffer":return[3,3];case"base64String":return[3,4];case"blob":return[3,5];case"invalid":return[3,6]}return[3,7];case 1:return[4,this._xhr({url:e.source.relativeUrl,type:"GET",responseType:"text"})];case 2:return t=n.sent(),t.getResponseHeader(i.HeaderName.ContentType),[2,t.responseText];case 3:return[2,Object(o.arrayBufferToTextAsync)(e.source.buffer)];case 4:return[2,Object(o.base64ToText)(e.source.base64)];case 5:return[2,Object(o.blobToString)(e.source.blob)];case 6:throw r.PABinary.createErrorFromInvalid(e);case 7:throw new r.NotImplementedError("PABinary.toTextAsync")}}))}))},e.prototype.getAsBase64StringAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(n){switch(n.label){case 0:if("invalid"===e.source.sourceType)throw r.PABinary.createErrorFromInvalid(e);return"base64String"===e.source.sourceType?[2,e.source.base64]:[4,this._getAsArrayBufferCoreAsync(e)];case 1:return t=n.sent(),[2,Object(o.arrayBufferToBase64)(t)]}}))}))},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"ConsolidatedDatabaseReferencesManager",(function(){return o}));var r=n(0),o=function(e){function t(){var t=e.call(this)||this;return t._consolidatedDatabaseReferences=Object(r.HashTableUtility_create)(),t}return __extends(t,e),t.prototype.getReferencesAsync=function(e){var t;return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(n){return[2,null!==(t=this._consolidatedDatabaseReferences[null==e?void 0:e.appLogicalName])&&void 0!==t?t:this._consolidatedDatabaseReferences.global]}))}))},t.prototype.restoreFromServerDatabaseReferences=function(e){var t=this._restoreFromServerDatabaseReferences(e,null,!0);this._disambiguateDataSourcesIfAny(t.value)},t.prototype._disambiguateDataSourcesIfAny=function(e){var t=this,n=Object(r.HashTableUtility_create)();Object(r.forEach)(e,(function(e,o){Object(r.forEach)(e.dataSources,(function(e,r){e.apps?e.apps.forEach((function(i){t._addToConsolidatedDataSources(n,i,r,o,e.entitySetName,e.logicalName)})):t._addToConsolidatedDataSources(n,"global",r,o,e.entitySetName,e.logicalName)}))})),Object(r.HashTableUtility_isEmpty)(n)||1===Object.keys(n).length?this._consolidatedDatabaseReferences.global=e:(Object(r.forEach)(n,(function(e,t){"global"!==t&&(n[t]=__assign(__assign({},n.global),n[t]))})),Object(r.forEach)(n,(function(n,o){t._consolidatedDatabaseReferences[o]||(t._consolidatedDatabaseReferences[o]={}),Object(r.forEach)(n,(function(n,r){t._consolidatedDatabaseReferences[o][n.environment]||(t._consolidatedDatabaseReferences[o][n.environment]={state:e[n.environment].state,instanceUrl:e[n.environment].instanceUrl,webApiVersion:e[n.environment].webApiVersion,dataSources:{},environmentVariableName:e[n.environment].environmentVariableName}),t._consolidatedDatabaseReferences[o][n.environment].dataSources[r]={entitySetName:n.entitySetName,logicalName:n.logicalName}}))})))},t.prototype._addToConsolidatedDataSources=function(e,t,n,r,o,i){e[t]||(e[t]={}),e[t][n]={environment:r,entitySetName:o,logicalName:i}},t.prototype.hasValues=function(){return this._consolidatedDatabaseReferences&&!Object(r.HashTableUtility_isEmpty)(this._consolidatedDatabaseReferences)},t}(n(61).DatabaseReferencesManager)},function(e,t,n){"use strict";n.r(t),n.d(t,"ApiPolicyViolation",(function(){return r}));n(0),n(1);var r=function(){function e(e){this._type=e.type}return Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),e}()},function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return g}));var r,o=n(0),i=n(22),a=n(67),s=n(2),c=n(17),u=n(3),p=n(8),l=n(39),d=n(14),f=n(1),y=n(6);!function(e){e.evaluateDlpPolicies="DataLossPreventionService.EvaluateDlpPolicy",e.evaluateDlpPoliciesForApp="DataLossPreventionService.EvaluateDlpPolicyForApp",e.evaluateConnectionGroupingDlpPolicyForApp="DataLossPreventionService.EvaluateConnectionGroupingDlpPolicyForApp"}(r||(r={}));var m=new o.TypedUrlTemplate("/".concat(i.BapEndpoints.providers,"/environments/{environmentName}/checkApiPolicies?").concat(i.BapEndpoints.apiVersionKey,"={apiVersion}")),g=function(){function e(e,t,n){this._identityService=e,this._userService=t,this._httpClient=n}return e.prototype.evaluatePolicyForAppAsync=function(e,t){return void 0===t&&(t=!1),__awaiter(this,void 0,Promise,(function(){var n,i,a,c,m,g;return __generator(this,(function(v){switch(v.label){case 0:if(y.t.IsPowerPlatformApiEnabled){if(!(i=this._userService.getEnvironmentService().tryGetCurrentEnvironment()))return o.CoreLog.errorEx("DataLossPreventionService.evaluatePolicyForAppAsync","Cannot get current environment to retrieve environment name for PowerPlatform Api endpoint."),[2];n=AppMagic.PowerApps.PowerAppsUtility.createPowerPlatformPowerAppsUrlBuilder(null==i?void 0:i.name)}else n=AppMagic.PowerApps.PowerAppsUtility.createPowerAppsBaseUrlBuilder();return n.appendPath("evaluateDlpPoliciesForApp"),n.setQueryParam(s.PowerAppEndpoints.apiVersionKey,y.t.getApiVersion()),(a={url:n.toString(),method:u.Method.POST,headers:Object(o.HashTableUtility_create)(),bodyData:JSON.stringify(e)}).headers[u.HeaderName.ContentType]=u.MediaType.ApplicationJson,a.headers[u.HeaderName.CacheControl]=u.HeaderValue.NoCacheNoStore,Object(p.e)(a.headers,{resource:y.t.getResourceName()}),c=t?r.evaluateConnectionGroupingDlpPolicyForApp:r.evaluateDlpPoliciesForApp,[4,Object(d.sendHttpJsonResponseAsync)(this._httpClient,a,c)];case 1:if(m=v.sent(),null===(g=f.Lb.safeCast(m)))throw new l.SafeCastError("EvaluatePolicyForAppResponse");return[2,g]}}))}))},e.prototype.evaluatePolicyAsync=function(e){var t,n=this;return this._userService.getEnvironmentService().getCurrentEnvironmentAsync().then((function(i){t=i.name;var s={url:o.UrlBuilder.composeUrlAppendToBase(a.BapUtility.getBaseUrl(),m.expand({environmentName:t,apiVersion:a.BapUtility.getApiVersion()})).toString(),method:u.Method.POST,bodyData:JSON.stringify(e)};return n._addHeaders(s),Object(d.sendHttpJsonResponseAsync)(n._httpClient,s,r.evaluateDlpPolicies)})).then((function(e){var t=f.Nb.safeCast(e);if(!t)throw new l.SafeCastError("Service.EvaluatePolicyResponse");return t}))},e.prototype._addHeaders=function(e){e.headers||(e.headers=Object(o.HashTableUtility_create)()),e.headers[u.HeaderName.ContentType]=u.MediaType.ApplicationJson,Object(p.e)(e.headers,{resource:p.d.PowerAppsService}),Object(c.appendCustomHeadersOptions)(e,{optInMSHeaders:!0,addCustomHeaders:!0})},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r,o=n(0),i=n(17),a=n(3),s=n(2),c=n(4),u=n(142),p=n(8),l=n(14);!function(e){e.registerDeviceCall="RemoteNotification.RegisterDevice",e.requestTestNotificationCall="RemoteNotification.RequestTestNotification",e.unregisterDeviceCall="RemoteNotification.UnregisterDevice"}(r||(r={}));var d=function(){function e(e,t){this._httpClient=null,this._httpClient=e,this._identityServiceFn=t}return e.prototype.registerDeviceAsync=function(e){o.CoreLog.verbose("Calling PowerApps to register device.");var t=Core.Environment.usePowerPlatformApi()?s.Notification.registerDevicePowerPlatformApi:s.Notification.registerDeviceApi,n=Core.Environment.usePowerPlatformApi()?p.d.PowerPlatformService:p.d.PowerAppsService;return this._sendRequestToPowerAppsAsync(JSON.stringify(e),t,this._identityServiceFn().identity,n,r.registerDeviceCall)},e.prototype.unregisterDeviceAsync=function(e){o.CoreLog.verbose("Calling PowerApps to unregister device.");var t=Core.Environment.usePowerPlatformApi()?s.Notification.unregisterDevicePowerPlatformApi:s.Notification.unregisterDeviceApi,n=Core.Environment.usePowerPlatformApi()?p.d.PowerPlatformService:p.d.PowerAppsService;return this._sendRequestToPowerAppsAsync(JSON.stringify(e),t,this._identityServiceFn().identity,n,r.unregisterDeviceCall)},e.prototype.requestTestNotificationAsync=function(){return o.CoreLog.verbose("Requesting server to send us push notification."),this._sendRequestToPowerAppsAsync("",s.Notification.sendTestNotification,this._identityServiceFn().identity,p.d.PowerAppsService,r.requestTestNotificationCall)},e.prototype._sendRequestToPowerAppsAsync=function(t,n,r,s,c){var d={method:a.Method.POST,bodyData:t,headers:Object(u.createCommonJsonRestCallHeaders)(),url:e._createUrl(n,r).toString()};return Object(p.e)(d.headers,{resource:s}),Object(i.appendCustomHeadersOptions)(d,{optInMSHeaders:!0,addCustomHeaders:!0}),Object(l.sendHttpIgnoreResponseAsync)(this._httpClient,d,c).then((function(){return!0}),(function(e){return o.CoreLog.error("PowerAppsChannelRegistrar._sendRequestToPowerAppsAsync",e),!1}))},e._createUrl=function(e,t){var n=Core.Environment.usePowerPlatformApi()?c.PowerAppsUtility.createPowerAppsTenantUrlBuilder(t.tenantId):c.PowerAppsUtility.createPowerAppsObjectUrlBuilder(t.objectId),r=Core.Environment.usePowerPlatformApi()?c.PowerAppsUtility.getPowerPlatformApiVersion():c.PowerAppsUtility.getApiVersion();return n.appendPath(e),n.setQueryParam(s.PowerAppEndpoints.apiVersionKey,r),n.toUrl()},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"AppResources",(function(){return i}));var r=n(0),o=n(72),i=function(){function e(e,t,n,o,i){this._appInfo=e,this._apis=t,this._connections=n,this._connectionUsageMapping=o||Object(r.HashTableUtility_create)(),this._listPackageOperationDetails=i}return Object.defineProperty(e.prototype,"appInfo",{get:function(){return this._appInfo},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apis",{get:function(){return this._apis},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connections",{get:function(){return this._connections},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectionUsages",{get:function(){return this._connectionUsageMapping},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listAppPackageOperationDetails",{get:function(){return this._listPackageOperationDetails},enumerable:!1,configurable:!0}),e.prototype.removeConnectionUsage=function(e){delete this._connectionUsageMapping[e]},e.prototype.upsertConnectionUsage=function(e,t){var n=new o.a(t.id,t);this._connectionUsageMapping[e]=n,this.upsertConnection(t)},e.prototype.upsertConnection=function(e){for(var t=0;t<this._connections.length;t++)if(this._connections[t].id===e.id)return void(this._connections[t]=e);this._connections.push(e)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"SharedDatabaseReferencesManager",(function(){return o}));var r=n(0),o=function(e){function t(){var t=e.call(this)||this;return t._sharedDatabaseReferences=new r.Lazy((function(){return Object(r.HashTableUtility_create)()})),t}return __extends(t,e),t.prototype.getReferencesAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){return[2,this._sharedDatabaseReferences.value[null==e?void 0:e.appId]]}))}))},t.prototype.restoreFromServerDatabaseReferences=function(e,t){if(t){var n=this._restoreFromServerDatabaseReferences(e,null,!0);this._sharedDatabaseReferences.value[t]=n.value}else r.Log.trackErrorEvent("SharedDatabaseReferencesManager.restoreFromServerDatabaseReferences",{message:"appId is not provided."})},t.prototype.hasValues=function(){return this._sharedDatabaseReferences.isValueCreated&&!Object(r.HashTableUtility_isEmpty)(this._sharedDatabaseReferences.value)},t}(n(61).DatabaseReferencesManager)},function(e,t,n){"use strict";n.r(t),n.d(t,"XhrProcessor",(function(){return s}));var r=n(0),o=n(23),i=n(31),a=n(62),s=function(){function e(e,t,n){this._responseDef=e,this._headerParams=t,this._responseProcessor=n}return Object.defineProperty(e.prototype,"responseDefinition",{get:function(){return this._responseDef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"xhrResponseType",{get:function(){return null===this._responseProcessor?o.ResponseTypes.PABinary:this._responseProcessor.responseType},enumerable:!1,configurable:!0}),e.prototype.processXhr=function(t){var n={status:t.status},r=Object(a.a)(i.ResponseValueType.Xhr,t),o=e.extractParamValues(r,this._headerParams);if(o&&(n.headerParams=o),null!==this._responseProcessor){var s=this._responseProcessor.processResponse(t);s.bodyParams&&(n.bodyParams=s.bodyParams),void 0!==s.body&&(n.body=s.body)}return n},e.extractParamValues=function(e,t){var n=Object.keys(t);if(0!==n.length){var o=Object(r.HashTableUtility_create)();return n.forEach((function(n){var i=t[n].getValue(e);if(!1===i.success)throw new Error("Processing Rest param '".concat(n,"' failed. ").concat(i.message||""));var a=i.value;Object(r.isDefined)(a)&&(o[n]=a.value)})),o}},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"XmlSelection",(function(){return i}));var r;n(0);!function(e){e[e.Element=0]="Element",e[e.Text=1]="Text"}(r||(r={}));var o=function(){function e(e){this.index=this._parseIndex(e),this.tagName=this._parseTagName(e),this.tokenType=this._parseTokenType(e)}return e.prototype.nodeTest=function(e){switch(this.tokenType){case r.Element:return e.nodeType===Node.ELEMENT_NODE&&e.nodeName===this.tagName;case r.Text:return e.nodeType===Node.TEXT_NODE;default:return!1}},e.prototype._parseTagName=function(t){return t.match(e.RegEx.TagName)[1]},e.prototype._parseIndex=function(t){return e.RegEx.Index.test(t)?parseInt(t.match(e.RegEx.Index)[1],10)-1:null},e.prototype._parseTokenType=function(t){return t.match(e.RegEx.TagName)[1]===e.TextNodeTagName?r.Text:r.Element},e.RegEx={TagName:/(\w[\w\d.-]*)/,Index:/\[([1-9]\d*)\]/},e.TextNodeTagName="text",e}(),i=function(){function e(){}return e.selectNodes=function(t,n){return e._selectNodes(t,e._tokenizeXPath(n))},e._selectNodes=function(t,n){if(0===n.length)return[t];for(var r,o=[],i=n.shift(),a=0;a<t.childNodes.length;a++){var s=t.childNodes[a];i.nodeTest(s)&&o.push(s)}return r=null!==i.index?i.index<o.length?e._selectNodes(o[i.index],n):[]:o.map((function(t){return e._selectNodes(t,n)})).reduce((function(e,t){return e.concat(t)}),[]),n.unshift(i),r},e._tokenizeXPath=function(t){return t.split(e.XPathSeparator).filter((function(e){return""!==e&&"."!==e})).map((function(e){return new o(e)}))},e.XPathSeparator="/",e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"CdpAttachmentTType",(function(){return a}));var r=n(0),o=n(5),i=n(7),a=function(){function e(e){this._targetEntity=e}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return i.TTypeValueKind.CdpAttachment},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"targetEntity",{get:function(){return this._targetEntity},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(o.createSchemaForSimple)(o.TypeUnknown)},e.prototype.convertFromDValue=function(e){throw new r.NotSupportedError("We do not expect to get value for attachment yet.")},e.prototype.convertToDValue=function(e){return AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:this._targetEntity,id:-1,propertyName:""},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null})},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"CdpNavigationTType",(function(){return a}));var r=n(0),o=n(5),i=n(7),a=function(){function e(e,t){this._targetTableName=e,this._isArray=t}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return i.TTypeValueKind.CdpNavigation},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"targetTableName",{get:function(){return this._targetTableName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isArray",{get:function(){return this._isArray},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(o.createSchemaForSimple)(o.TypeUnknown)},e.prototype.convertFromDValue=function(e){throw new r.NotSupportedError("We do not expect to get value for navigation yet.")},e.prototype.convertToDValue=function(e){return AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:this._targetTableName,id:-1,propertyName:""},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null})},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"CdpOptionSetMultiSelectTType",(function(){return a}));n(0);var r=n(7),o=n(74),i=n(57),a=function(){function e(e){this._arrayType=new o.JsonArrayTType(e),this._itemTypeReference=e}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return r.TTypeValueKind.CdpArrayOptionSet},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return this._arrayType.computeDValueSchema(e)},e.prototype.convertToDValue=function(e){return this._arrayType.convertToDValue(e)},e.prototype.convertFromDValue=function(e){return Object(i.optionSetMultiSelectFromDValue)(e,this._itemTypeReference.getType())},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"CdpOptionSetTType",(function(){return s}));var r=n(0),o=n(5),i=n(57),a=n(7),s=function(){function e(){}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return a.TTypeValueKind.CdpObjectOptionSet},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(o.createSchemaForSimple)(o.TypeOptionSetValue)},e.prototype.convertToDValue=function(e,t){if(null===e)return null;if(!Object(r.isJsonObject)(e))return AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null});var n=e.Id;if((Object(r.isNumber)(n)||Object(r.isBoolean)(n))&&Object(r.isNonEmptyStringOrUndefined)(e.Value)){var o=Object(r.isString)(e.Value)?e.Value:n.toString(),i={Id:n,Value:o};return Object(r.isString)(e.Color)&&(i.Color=e.Color),i}return AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:null,errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null})},e.prototype.convertFromDValue=function(e){return Object(i.optionSetConvertFromDValue)(e)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"CdpPolymorphicLookupTType",(function(){return a}));var r=n(0),o=n(5),i=n(7),a=function(){function e(){}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return i.TTypeValueKind.CdpPolymorphicLookup},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(o.createSchemaForSimple)(o.TypePolymorphic)},e.prototype.convertToDValue=function(e,t){return null===e?null:Object(r.isJsonObject)(e)?Object(r.isNonEmptyString)(e.type)&&Object(r.isNonEmptyString)(e.value)&&Object(r.isNonEmptyStringOrNull)(e.displayName)?{Type:e.type,Value:e.value,DisplayName:e.displayName}:AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:null,errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null}):AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null})},e.prototype.convertFromDValue=function(e){return null===e?null:Object(r.isString)(e)?e:e.Value},e.prototype._validateDValue=function(e){return Object(r.isNonEmptyString)(e.Value)&&Object(r.isNonEmptyString)(e.Type)&&Object(r.isNonEmptyStringOrNull)(e.DisplayName)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"CdsAttachmentTType",(function(){return a}));var r=n(0),o=n(5),i=n(7),a=function(){function e(){}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return i.TTypeValueKind.CdsAttachment},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(o.createSchemaForSimple)(o.TypeUnknown)},e.prototype.convertFromDValue=function(e){throw new r.NotSupportedError("We do not expect to get value for attachment yet.")},e.prototype.convertToDValue=function(e,t){return AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null})},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"CdsOptionSetMultiSelectTType",(function(){return p}));var r=n(0),o=n(5),i=n(7),a=n(57),s=n(77),c=n(37),u=n(10),p=function(){function e(e,t){this._dataSetName=e,this._logicalName=t,this._itemType=new s.CdsOptionSetTType(e,t)}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return i.TTypeValueKind.CdsArrayOptionSet},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(o.createSchemaForArrayFromPointer)([Object(o.createSchemaForSimple)(o.TypeOptionSetValue)])},e.prototype.convertToDValue=function(e,t){if(!Object(r.isString)(e))return null;if(!Object(r.isDefined)(t.unsafePropertyValues))return r.CoreLog.error("CdsOptionSetMultiSelectTTypes.convertToDValue","context.unsafePropertyValues undefined"),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.Validation,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null});var n,o=[],i=e.split(",").map((function(e){return e.trim()})),s=t.unsafePropertyValues[t.propertyName+c.CdsConstants.labelAnnotation];if(!Object(r.isString)(s)){var p=Object(r.CoreUtility_formatString)(AppMagic.Strings.ParsingErrorMessage,AppMagic.Strings.ValueTypeString,Object(u.getLocalizedTTypeName)(s));return Object(r.trace)(r.CategoryNames.Verbose,"parsing",{property:t.propertyName,info:p,issue:AppMagic.Strings.ParsingErrorDetail},r.MonitorLogLevel.Error),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.Validation,AppMagic.Data.ErrorSeverity.Severe,p,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:p,raiseToastNotification:!1,wasReported:!1,functionName:null})}if(n=s.split(";").map((function(e){return e.trim()})),i.length!==n.length)return Object(r.trace)(r.CategoryNames.Verbose,"parsing",{property:t.propertyName,info:AppMagic.Strings.ParsingOptionSetMultiSelectLengthNotMatch},r.MonitorLogLevel.Error),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.Validation,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.ParsingOptionSetMultiSelectLengthNotMatch,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:AppMagic.Strings.ParsingOptionSetMultiSelectLengthNotMatch,raiseToastNotification:!1,wasReported:!1,functionName:null});if(0===i.length)return o;for(var l=0,d=i.length;l<d;l++){var f=i[l],y=void 0;if(y=parseInt(f,10),!Object(r.isFiniteNumber)(y)){if("true"!==f&&"false"!==f){p=Object(r.CoreUtility_formatString)(AppMagic.Strings.ParsingErrorMessage,AppMagic.Strings.ValueTypeBoolean,f);return Object(r.trace)(r.CategoryNames.Verbose,"parsing",{property:t.propertyName,info:p,issue:AppMagic.Strings.ParsingErrorDetail},r.MonitorLogLevel.Error),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.Validation,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.ParsingErrorDetail,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:p,raiseToastNotification:!1,wasReported:!1,functionName:null})}y="true"===f}o.push({Value:Object(a.convertToCdsOptionSetReference)(this._dataSetName,this._logicalName,y,n[l])})}return o},e.prototype.convertFromDValue=function(e){return Object(a.optionSetMultiSelectFromDValue)(e,this._itemType)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"CdsPolymorphicTTypeRef",(function(){return c}));var r=n(0),o=n(94),i=n(50),a=n(66),s=n(74),c=function(){function e(e,t,n,i,a){this._typesManager=n,this._isArray=i,this._parentDataSourceName=a,this._cdsPolymorphicLookupTType=new o.CdsPolymorphicLookupTType(e,t),this._ttypes=Object(r.HashTableUtility_create)()}return e.prototype.getType=function(){return this._cdsPolymorphicLookupTType},e.prototype.removeType=function(e){e&&-1!==this._cdsPolymorphicLookupTType.LogicalNames.indexOf(e)&&(delete this._ttypes[e],this.getTargetType(e))},e.prototype.getTargetType=function(e){if(!this._ttypes[e]){var t=void 0;this._typesManager.hasType(AppMagic.Data.ConnectedDataConstants.TypesManagerPrefix,e)?t=this._typesManager.getType(AppMagic.Data.ConnectedDataConstants.TypesManagerPrefix,e):(t=this._typesManager.getOrAddDelayedType(AppMagic.Data.ConnectedDataConstants.TypesManagerPrefix,e,(function(){return new i.DelayedLoadingCdsObjectTType})))instanceof i.DelayedLoadingCdsObjectTType&&t.addParentDataSourceName(this._parentDataSourceName),this._isArray?this._ttypes[e]=new s.JsonArrayTType(new a.InlinedTTypeRef(t)):this._ttypes[e]=t}return this._ttypes[e]},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"ConverterTType",(function(){return r}));var r=function(){function e(e,t){this._ttype=e,this._converter=t}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return this._ttype.TTypeValueKind},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return this._converter.target.isRecord},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return this._ttype.isConvertFromDValueAsync},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return this._converter.target.computeDValueSchema(e)},e.prototype.convertToDValue=function(e,t){var n=this._ttype.convertToDValue(e,t);return AppMagic.Data.ErrorValue.isGatedError(n)?n:this._converter.convertToTarget(n)},e.prototype.convertFromDValue=function(e){var t=this._converter.convertFromTarget(e);return this._ttype.convertFromDValue(t)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"FileTType",(function(){return u}));var r,o=n(0),i=n(5),a=n(7),s=n(56),c=n(10);!function(e){e.Value="Value"}(r||(r={}));var u=function(){function e(e,t,n,r,o){this.dataSourceType=e,this.dataSourceName=t,this.tableName=n,this.primaryKeyColumns=r,this.columnForFileName=o,s.DataSourceType.CDS}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return a.TTypeValueKind.File},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(i.createSchemaForSimple)(i.TypeUnknown)},e.prototype.convertFromDValue=function(e){throw new o.NotSupportedError("We do not expect to get value for file yet.")},e.prototype.convertToDValue=function(e,t){if(e&&t){var n=t.unsafePropertyValues,o=JSON.parse(Object(c.tryGetPrimaryKey)(n,this.primaryKeyColumns));if(this.dataSourceType==s.DataSourceType.CDS){if("string"==typeof e){var i=AppMagic.AppResourceUri.Templates.CdsDataSourceFileReference.expandUrlString({datasourceName:this.dataSourceName,tableName:this.tableName,columnName:t.propertyName,internalRowId:o,downloadUrl:s.TempFileUrl,resourceId:e});return{FileName:this.columnForFileName&&n[this.columnForFileName],Value:i}}if(this.isValidAndNonNullMDLFileFields(e))return{FileName:this.columnForFileName&&n[this.columnForFileName],Value:e[r.Value]}}}return null},e.prototype.isValidAndNonNullMDLFileFields=function(e){return e&&"object"==typeof e&&Object(o.isNonEmptyString)(e[r.Value])},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"JsonBooleanTType",(function(){return s}));var r=n(0),o=n(5),i=n(7),a=n(10),s=function(){function e(){}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return i.TTypeValueKind.Boolean},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(o.createSchemaForSimple)(o.TypeBoolean)},e.prototype.convertFromDValue=function(e){return e},e.prototype.convertToDValue=function(e,t){if(null===e)return null;if("boolean"!=typeof e){var n=Object(r.CoreUtility_formatString)(AppMagic.Strings.ParsingErrorMessage,AppMagic.Strings.ValueTypeBoolean,Object(a.getLocalizedTTypeName)(e));return Object(r.trace)(r.CategoryNames.Verbose,"parsing",{property:null==t?void 0:t.propertyName,info:n,issue:AppMagic.Strings.ParsingErrorDetail},r.MonitorLogLevel.Error),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,n,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:n,raiseToastNotification:!1,wasReported:!1,functionName:null})}return e},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"JsonDateStringTType",(function(){return c}));var r=n(0),o=n(5),i=n(29),a=n(7),s=n(10),c=function(){function e(){}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return a.TTypeValueKind.String},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(o.createSchemaForSimple)(o.TypeDate)},e.prototype.convertFromDValue=function(e){return null===e?null:Object(i.convertDateStringFromDValue)(e)},e.prototype.convertToDValue=function(e,t){if(null===e)return null;if("string"!=typeof e){var n=Object(r.CoreUtility_formatString)(AppMagic.Strings.ParsingErrorMessage,AppMagic.Strings.ValueTypeString,Object(s.getLocalizedTTypeName)(e));return Object(r.trace)(r.CategoryNames.Verbose,"parsing",{property:null==t?void 0:t.propertyName,info:n,issue:AppMagic.Strings.ParsingErrorDetail},r.MonitorLogLevel.Error),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,n,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:n,raiseToastNotification:!1,wasReported:!1,functionName:null})}return Object(i.convertDateStringToDValue)(e)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"JsonDateTimeNoTimeZoneStringTType",(function(){return u}));var r=n(0),o=n(5),i=n(37),a=n(29),s=n(7),c=n(10),u=function(){function e(e){this._format=e}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return s.TTypeValueKind.String},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(o.createSchemaForSimple)(o.TypeDateTimeNoTimeZone)},e.prototype.convertFromDValue=function(e){return e?Object(a.convertDateTimeStringFromDValue)(i.DateTimeBehavior.NoTimeZone,e):null},e.prototype.convertToDValue=function(e,t){if(null===e)return null;if("string"!=typeof e){var n=Object(r.CoreUtility_formatString)(AppMagic.Strings.ParsingErrorMessage,AppMagic.Strings.ValueTypeString,Object(c.getLocalizedTTypeName)(e));return Object(r.trace)(r.CategoryNames.Verbose,"parsing",{property:null==t?void 0:t.propertyName,info:n,issue:AppMagic.Strings.ParsingErrorDetail},r.MonitorLogLevel.Error),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,n,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:n,raiseToastNotification:!1,wasReported:!1,functionName:null})}return Object(a.convertDateTimeStringToDValue)(this._format,e)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"JsonDateTimeNumberTType",(function(){return c}));var r=n(0),o=n(5),i=n(29),a=n(7),s=n(10),c=function(){function e(){}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return a.TTypeValueKind.Number},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(o.createSchemaForSimple)(o.TypeDateTime)},e.prototype.convertFromDValue=function(e){return null===e?null:Object(i.convertDateTimeNumberFromDValue)(e)},e.prototype.convertToDValue=function(e,t){if(null===e)return null;if("number"!=typeof e){var n=Object(r.CoreUtility_formatString)(AppMagic.Strings.ParsingErrorMessage,AppMagic.Strings.ValueTypeNumber,Object(s.getLocalizedTTypeName)(e));return Object(r.trace)(r.CategoryNames.Verbose,"parsing",{property:null==t?void 0:t.propertyName,info:n,issue:AppMagic.Strings.ParsingErrorDetail},r.MonitorLogLevel.Error),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,n,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:n,raiseToastNotification:!1,wasReported:!1,functionName:null})}return Object(i.convertDateTimeNumberToDValue)(e)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"JsonDateTimeStringTType",(function(){return c}));var r=n(0),o=n(5),i=(n(37),n(29)),a=n(7),s=n(10),c=function(){function e(e,t){this._format=e,this._behavior=t}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return a.TTypeValueKind.String},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(o.createSchemaForSimple)(o.TypeDateTime)},e.prototype.convertFromDValue=function(e){return null===e?null:Object(i.convertDateTimeStringFromDValue)(this._behavior,e)},e.prototype.convertToDValue=function(e,t){if(null===e)return null;if("string"!=typeof e){var n=Object(r.CoreUtility_formatString)(AppMagic.Strings.ParsingErrorMessage,AppMagic.Strings.ValueTypeString,Object(s.getLocalizedTTypeName)(e));return Object(r.trace)(r.CategoryNames.Verbose,"parsing",{property:null==t?void 0:t.propertyName,info:n,issue:AppMagic.Strings.ParsingErrorDetail},r.MonitorLogLevel.Error),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,n,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:n,raiseToastNotification:!1,wasReported:!1,functionName:null})}return Object(i.convertDateTimeStringToDValue)(this._behavior,e)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"JsonGuidTType",(function(){return s}));var r=n(0),o=n(5),i=n(7),a=n(10),s=function(){function e(){}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return i.TTypeValueKind.Guid},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(o.createSchemaForSimple)(o.TypeGuid)},e.prototype.convertFromDValue=function(e){return null===e?null:e=e.toLowerCase()},e.prototype.convertToDValue=function(e,t){if(null===e)return null;if("string"!=typeof e){var n=Object(r.CoreUtility_formatString)(AppMagic.Strings.ParsingErrorMessage,AppMagic.Strings.ValueTypeString,Object(a.getLocalizedTTypeName)(e));return Object(r.trace)(r.CategoryNames.Verbose,"parsing",{property:null==t?void 0:t.propertyName,info:n,issue:AppMagic.Strings.ParsingErrorDetail},r.MonitorLogLevel.Error),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,n,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:n,raiseToastNotification:!1,wasReported:!1,functionName:null})}return e=e.toLowerCase(),Object(r.isGuid)(e)?e:AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null})},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"JsonMapObjectTType",(function(){return s}));var r=n(0),o=n(5),i=n(7),a=n(10),s=function(){function e(e,t,n){this._isConvertFromDValueAsync=null,this._keyFieldName=e,this._valueFieldName=t,this._valueTTypeRef=n}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return i.TTypeValueKind.JsonObject},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return null===this._isConvertFromDValueAsync&&(this._isConvertFromDValueAsync=this._valueTTypeRef.getType().isConvertFromDValueAsync),this._isConvertFromDValueAsync},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){if(e<=0)return Object(o.createSchemaForArrayFromPointer)([]);var t=this._valueTTypeRef.getType().computeDValueSchema(e-1);t.name=this._valueFieldName;var n=[Object(o.createSchemaForSimple)(o.TypeString,this._keyFieldName),t];return Object(o.createSchemaForArrayFromPointer)(n)},e.prototype.convertFromDValue=function(e){return this.isConvertFromDValueAsync?null===e?Promise.resolve(e):this._convertFromDValueAsync(e):null===e?e:this._convertFromDValue(e)},e.prototype._convertFromDValue=function(e){var t=this,n=this._valueTTypeRef.getType(),o={};return e.forEach((function(e){if(null!==e&&!AppMagic.Data.ErrorValue.isGatedError(e)){var i=e[t._keyFieldName];if(!(Object(r.isDefined)(i)&&!e.hasOwnProperty(t._keyFieldName)||AppMagic.Data.ErrorValue.isGatedError(i)||null===i)){var a=e[t._valueFieldName];if(Object(r.isDefined)(a)&&e.hasOwnProperty(t._valueFieldName)&&!AppMagic.Data.ErrorValue.isGatedError(a)){var s=n.convertFromDValue(a);o[i]=s}}}})),o},e.prototype._convertFromDValueAsync=function(e){var t=this,n=this._valueTTypeRef.getType(),o={},i=Promise.resolve();return e.forEach((function(e){if(null!==e&&!AppMagic.Data.ErrorValue.isGatedError(e)){var a=e[t._keyFieldName];if(e.hasOwnProperty(t._keyFieldName)&&!AppMagic.Data.ErrorValue.isGatedError(a)&&null!==a){var s=e[t._valueFieldName];Object(r.isDefined)(s)&&e.hasOwnProperty(t._valueFieldName)&&!AppMagic.Data.ErrorValue.isGatedError(s)&&(i=i.then((function(){return n.convertFromDValue(s)})).then((function(e){o[a]=e})))}}})),i.then((function(){return o}))},e.prototype.convertToDValue=function(e,t){var n=this;if(null===e)return null;if(!Object(r.isJsonObject)(e)){var o=Object(r.CoreUtility_formatString)(AppMagic.Strings.ParsingErrorMessage,AppMagic.Strings.ValueTypeObject,Object(a.getLocalizedTTypeName)(e));return Object(r.trace)(r.CategoryNames.Verbose,"parsing",{property:null==t?void 0:t.propertyName,info:o,issue:AppMagic.Strings.ParsingErrorDetail},r.MonitorLogLevel.Error),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,o,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:o,raiseToastNotification:!1,wasReported:!1,functionName:null})}var i=this._valueTTypeRef.getType(),s=AppMagic.Data.DataTable.create();return Object.keys(e).forEach((function(t){var o;if(!Object(r.isUndefined)(e[t])){var a={unsafePropertyValues:e,propertyName:t};o=i.convertToDValue(e[t],a);var c=AppMagic.Data.DataRecord.create();c[n._keyFieldName]=t,c[n._valueFieldName]=o,s.push(c)}})),s},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"JsonNumberTType",(function(){return c}));var r=n(0),o=n(5),i=n(7),a=n(55),s=n(10),c=function(){function e(e,t){this._dtype=e,this._xsdType=t}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return i.TTypeValueKind.Number},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(o.createSchemaForSimple)(this._dtype)},e.prototype.convertFromDValue=function(e){return null===e||null===this._xsdType?null:Object(a.coerceNumberToXsdNumericType)(e,this._xsdType)},e.prototype.convertToDValue=function(e,t){if(null===e)return null;if("number"!=typeof e){var n=Object(r.CoreUtility_formatString)(AppMagic.Strings.ParsingErrorMessage,AppMagic.Strings.ValueTypeNumber,Object(s.getLocalizedTTypeName)(e));return Object(r.trace)(r.CategoryNames.Verbose,"parsing",{property:null==t?void 0:t.propertyName,info:n,issue:AppMagic.Strings.ParsingErrorDetail},r.MonitorLogLevel.Error),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,n,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:n,raiseToastNotification:!1,wasReported:!1,functionName:null})}return e},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"JsonUntypedObjectTType",(function(){return a}));var r=n(0),o=n(7),i=n(10),a=function(){function e(){this._properties={},this._isConvertFromDValueAsync=null}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return o.TTypeValueKind.JsonUntypedObject},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this._properties},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return null===this._isConvertFromDValueAsync&&(this._isConvertFromDValueAsync=Object(r.HashTableUtility_some)(this._properties,(function(e){return e.ttypeRef.getType().isConvertFromDValueAsync}))),this._isConvertFromDValueAsync},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(i.computeDValueSchemaForObjectTType)(this._properties,e)},e.prototype.convertFromDValue=function(e){return e},e.prototype.convertToDValue=function(e){return e},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"JsonStringTType",(function(){return s}));var r=n(0),o=n(5),i=n(7),a=n(10),s=function(){function e(){}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return i.TTypeValueKind.String},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(o.createSchemaForSimple)(o.TypeString)},e.prototype.convertFromDValue=function(e){return e},e.prototype.convertToDValue=function(e,t){if(null===e)return null;if("string"!=typeof e){var n=Object(r.CoreUtility_formatString)(AppMagic.Strings.ParsingErrorMessage,AppMagic.Strings.ValueTypeString,Object(a.getLocalizedTTypeName)(e));return Object(r.trace)(r.CategoryNames.Verbose,"parsing",{property:null==t?void 0:t.propertyName,info:n,issue:AppMagic.Strings.ParsingErrorDetail},r.MonitorLogLevel.Error),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,n,{errorContext:{entityName:"",propertyName:null==t?void 0:t.propertyName,id:-1},errorMessage:n,raiseToastNotification:!1,wasReported:!1,functionName:null})}return e},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"LargeImageTType",(function(){return p}));var r,o,i=n(0),a=n(5),s=n(7),c=n(56),u=n(10);!function(e){e.Full="Full",e.Large="Large",e.Medium="Medium",e.Small="Small"}(r||(r={})),function(e){e.Value="Value",e.Full="Full"}(o||(o={}));var p=function(){function e(e,t,n,r,o,i){this.dataSourceType=e,this.dataSourceName=t,this.tableName=n,this.primaryKeyColumns=r,this.mediaRuntime=o,this.columnForImageId=i,c.DataSourceType.CDS}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return s.TTypeValueKind.LargeImage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(a.createSchemaForSimple)(a.TypeUnknown)},e.prototype.convertFromDValue=function(e){throw new i.NotSupportedError("We do not expect to get value for attachment yet.")},e.prototype.convertToDValue=function(e,t){if(e&&t){var n=t.unsafePropertyValues,o=JSON.parse(Object(u.tryGetPrimaryKey)(n,this.primaryKeyColumns));if(this.dataSourceType===c.DataSourceType.CDS){if("string"==typeof e){var a="";this.columnForImageId&&n[this.columnForImageId]&&(a=n[this.columnForImageId].toString());var s=AppMagic.AppResourceUri.Templates.CdsDataSourceFileReference.expandUrlString({datasourceName:this.dataSourceName,tableName:this.tableName,columnName:t.propertyName,internalRowId:o,downloadUrl:c.TempFileUrl,resourceId:a}),p=i.PABinary.createFromBase64String(e,i.ApplicationOctetStream);return{Value:this.mediaRuntime.registerDataBinaryAndAddRef(p),Full:s}}return this.isValidAndNonNullMDLLargeImage(e)?e:null}if(this.isValidAndNonNullSharepointLargeImage(e))return{Full:AppMagic.AppResourceUri.Templates.ConnectedDataSourceBlobReference.expandUrlString({datasourceName:this.dataSourceName,tableName:this.tableName,internalRowId:o,downloadUrl:e[r.Full]}),Large:AppMagic.AppResourceUri.Templates.ConnectedDataSourceBlobReference.expandUrlString({datasourceName:this.dataSourceName,tableName:this.tableName,internalRowId:o,downloadUrl:e[r.Large]}),Medium:AppMagic.AppResourceUri.Templates.ConnectedDataSourceBlobReference.expandUrlString({datasourceName:this.dataSourceName,tableName:this.tableName,internalRowId:o,downloadUrl:e[r.Medium]}),Small:AppMagic.AppResourceUri.Templates.ConnectedDataSourceBlobReference.expandUrlString({datasourceName:this.dataSourceName,tableName:this.tableName,internalRowId:o,downloadUrl:e[r.Small]}),Value:AppMagic.AppResourceUri.Templates.ConnectedDataSourceBlobReference.expandUrlString({datasourceName:this.dataSourceName,tableName:this.tableName,internalRowId:o,downloadUrl:e[r.Small]})}}return null},e.prototype.isValidAndNonNullSharepointLargeImage=function(e){return e&&"object"==typeof e&&Object(i.isNonEmptyString)(e[r.Full])&&Object(i.isNonEmptyString)(e[r.Large])&&Object(i.isNonEmptyString)(e[r.Medium])&&Object(i.isNonEmptyString)(e[r.Small])},e.prototype.isValidAndNonNullMDLLargeImage=function(e){return e&&"object"==typeof e&&Object(i.isNonEmptyString)(e[o.Value])&&(Object(i.isNonEmptyString)(e[o.Full])||Object(i.isUndefined)(e[o.Full]))},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"SampleXmlElementTType",(function(){return c}));var r=n(0),o=n(92),i=n(5),a=n(7),s=n(104),c=function(){function e(e){var t=Object(s.xml2json)(e);this._schemaDictionary=AppMagic.Utility.createInferredSchemaFromObject(t),Object(o.correctSchemaDictionaryAndCreateNameRemapping)(this._schemaDictionary)}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return a.TTypeValueKind.Xml2JsonElement},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){if(0===e)return Object(i.createSchemaForObjectFromPointer)([]);var t=AppMagic.Utility.flattenSchema(this._schemaDictionary);return Object(i.createSchemaForObjectFromPointer)(t)},e.prototype.convertFromDValue=function(e){Object(r.check)(!1,"Not Supported")},e.prototype.convertToDValue=function(e,t){if(null===e)return null;if(!(Object(r.isObject)(e)&&Object(r.isString)(e.$name)&&Object(r.isObject)(e.$ns)&&Object(r.isObject)(e.$attributes)))return AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:null,errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null});var n=this._parseXmlToJsonWithSchemaInfo(e);return n.success?this._fitXmlToTargetSchema(n.xmlAsJson,n.xmlSchemaDict,this._schemaDictionary):AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.Validation,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null})},e.prototype._parseXmlToJsonWithSchemaInfo=function(e){var t=AppMagic.Utility.createInferredSchemaFromObject(e),n=Object(o.correctSchemaDictionaryAndCreateNameRemapping)(t);return Object(o.correctObjectWithSchema)(e,t,n),{success:!0,xmlAsJson:e,xmlSchemaDict:t}},e.prototype._fitXmlToTargetSchema=function(e,t,n){var o=this;if(AppMagic.Data.ErrorValue.isGatedError(e))return null;if(null===e)return null;var a,s,c=AppMagic.Data.DataRecord.create(),u=Object.keys(e);for(a=0,s=u.length;a<s;a++){var p=u[a],l=n[p];if(Object(r.isDefined)(l)){var d=e[p],f=t[p];if(f.type!==l.type)f.type===i.TypeObject&&l.type===i.TypeArray&&(c[p]=[this._fitXmlToTargetSchema(e[p],f.ptr,l.ptr)]);else if(Object(r.isArray)(l.type)){var y=[];d.forEach((function(e){y.push(o._fitXmlToTargetSchema(e,f.ptr,l.ptr))})),c[p]=y}else Object(r.isObject)(l.type)?c[p]=this._fitXmlToTargetSchema(d,f.ptr,l.ptr):c[p]=e[p]}}return c},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"XmlAnyUriTType",(function(){return a}));var r=n(0),o=n(5),i=n(7),a=function(){function e(e){this._dtype=e}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return i.TTypeValueKind.String},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(o.createSchemaForSimple)(this._dtype)},e.prototype.convertFromDValue=function(e){Object(r.check)(!1,"Not Supported")},e.prototype.convertToDValue=function(e,t){return null===e?null:"string"!=typeof e?AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null}):e},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"XmlBooleanTType",(function(){return a}));var r=n(0),o=n(5),i=n(7),a=function(){function e(){}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return i.TTypeValueKind.Boolean},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(o.createSchemaForSimple)(o.TypeBoolean)},e.prototype.convertFromDValue=function(e){Object(r.check)(!1,"Not Supported")},e.prototype.convertToDValue=function(e,t){if(null===e)return null;if("string"!=typeof e)return AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null});switch(e.toLowerCase()){case"0":case"false":return!1;case"1":case"true":return!0;default:return AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:null,errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null})}},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"XmlDateTimeTType",(function(){return s}));var r=n(0),o=n(5),i=n(29),a=n(7),s=function(){function e(){}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return a.TTypeValueKind.String},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(o.createSchemaForSimple)(o.TypeDateTime)},e.prototype.convertFromDValue=function(e){Object(r.check)(!1,"Not Supported")},e.prototype.convertToDValue=function(e,t){return null===e?null:"string"!=typeof e?AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null}):Object(i.convertDateTimeStringToDValue)("UserLocal",e)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"XmlNumericTType",(function(){return a}));var r=n(0),o=n(5),i=n(7),a=function(){function e(e){this._xsdType=e}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return i.TTypeValueKind.Number},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(o.createSchemaForSimple)(o.TypeNumber)},e.prototype.convertFromDValue=function(e){Object(r.check)(!1,"Not Supported")},e.prototype.convertToDValue=function(e,t){if(null===e)return null;if("string"!=typeof e)return AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null});var n=parseFloat(e);return isNaN(n)?AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.Validation,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null}):n},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"XmlStringTType",(function(){return a}));var r=n(0),o=n(5),i=n(7),a=function(){function e(){}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return i.TTypeValueKind.String},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(o.createSchemaForSimple)(o.TypeString)},e.prototype.convertFromDValue=function(e){Object(r.check)(!1,"Not Supported")},e.prototype.convertToDValue=function(e,t){return null===e?null:"string"!=typeof e?AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null}):e},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"Base64BinaryTType",(function(){return i}));var r=n(0),o=(n(37),n(7)),i=function(){function e(e,t,n){this._dtype=e,this._mediaRuntime=t,this._binaryResolver=n}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return o.TTypeValueKind.String},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return AppMagic.Schema.createSchemaForSimple(this._dtype)},e.prototype.convertFromDValue=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(n){switch(n.label){case 0:return e?[4,this._mediaRuntime.getMediaAsBinaryAsync(e)]:[2,null];case 1:return(t=n.sent())?[4,this._binaryResolver.getAsBase64StringAsync(t)]:[2,null];case 2:return[2,n.sent()]}}))}))},e.prototype.convertToDValue=function(e){if(null===e)return null;if("string"!=typeof e||!Object(r.isValidBase64StringLength)(e))return AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.Unknown,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:null,errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null});var t=r.ApplicationOctetStream,n=r.PABinary.createFromBase64String(e,t);return this._mediaRuntime.registerDataBinaryAndAddRef(n)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"PABinaryTType",(function(){return i}));var r=n(0),o=(n(37),n(7)),i=function(){function e(e,t){this._dtype=e,this._mediaRuntime=t}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return o.TTypeValueKind.Binary},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return AppMagic.Schema.createSchemaForSimple(this._dtype)},e.prototype.convertFromDValue=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return e?[4,this._mediaRuntime.getMediaAsBinaryAsync(e)]:[2,null];case 1:return[2,t.sent()]}}))}))},e.prototype.convertToDValue=function(e){if(null===e)return null;var t;if(!(e instanceof r.PABinary))throw new r.InvalidOperationError("PABinaryTType.convertToDValue","Unsupported tvalue type '".concat(typeof e,"'. Only null or PABinary instances are supported."));return t=e,this._mediaRuntime.registerDataBinaryAndAddRef(t)},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),o=(n(31),n(185)),i=function(){function e(e,t,n){this._responseType=e,this._bodyValueExtractor=t,this._params=n}return Object.defineProperty(e.prototype,"responseType",{get:function(){return this._responseType},enumerable:!1,configurable:!0}),e.prototype.processResponseValueExtractors=function(e){var t={};if(""===e.value)return t;if(null!==this._bodyValueExtractor){var n=this._bodyValueExtractor.getValue(e);if(!1===n.success)throw new Error(n.message||"Response body is invalid.");var i=n.value;Object(r.isDefined)(i)&&(t.body=i.value)}var a=o.XhrProcessor.extractParamValues(e,this._params);return a&&(t.bodyParams=a),t},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PowerPlatformApiDiscovery=void 0;var r=n(348);Object.defineProperty(t,"PowerPlatformApiDiscovery",{enumerable:!0,get:function(){return r.PowerPlatformApiDiscovery}})},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t),n.d(t,"AuthenticationErrorResponse",(function(){return r}));var r,o=n(0);!function(e){function t(e){return Object(o.isObject)(e)&&Object(o.isString)(e.error)}e.isValid=t,e.tryParse=function(e){var n=null;return e&&(n=t(n=Object(o.tryParseJson)(e))?n:null),n}}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"PluginError",(function(){return r}));var r,o=n(0);!function(e){function t(e){var t=Object(o.isError)(e)&&Object(o.isNonEmptyString)(e.code);return t||Object(o.warning)("AppMagic.Services.Adal.DataInterfaces.IPluginError.isValid failed.","Invalid value."),t}e.safeCast=function(e){return t(e)?e:null},e.isValid=t,e.formatError=function(e){return"AdalCode: [".concat(e.code,"] and Message: ").concat(e.message)}}(r||(r={}))},function(e,t,n){"use strict";n.r(t)},function(e,t,n){"use strict";var r,o;n.r(t),n.d(t,"CdpConstants",(function(){return r})),n.d(t,"CdpUtility",(function(){return o})),function(e){e.CdpNavigationRefIdKey="x-ms-cdpNavigationRef-id",function(e){e.NextLink="_x-ms-nextLink"}(e.MetadataPropertyNames||(e.MetadataPropertyNames={}))}(r||(r={})),function(e){e.formatNavigationBindPropertyName=function(e){return"".concat(e)},e.formatNavigationNextLinkPropertyName=function(e){return"".concat(e).concat(r.MetadataPropertyNames.NextLink)}}(o||(o={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"CdsSolutionVersion",(function(){return a}));var r=n(0),o=n(63),i=n(3),a=function(){function e(){}return e.tryGetSolutionVersion=function(t,n,r,i,a){return __awaiter(this,void 0,Promise,(function(){var s,c,u;return __generator(this,(function(p){switch(p.label){case 0:return s=o.CdsUtility.buildCdsHttpRequestUrl(r,AppMagic.PowerApps.Constants.CdsDefaultWebApiVersion,n),t[s]?[4,t[s]]:[3,2];case 1:if(null!==(c=p.sent()))return[2,c];p.label=2;case 2:return u=e._tryGetSolutionVersionInternal(s,r,i,a),t[s]=u,[2,u]}}))}))},e._tryGetSolutionVersionInternal=function(e,t,n,a){return __awaiter(this,void 0,Promise,(function(){var s,c,u;return __generator(this,(function(p){switch(p.label){case 0:s=o.CdsUtility.buildCdsHttpRequestParameters(e,t,i.Method.GET),p.label=1;case 1:return p.trys.push([1,3,,4]),[4,n.sendHttpJsonResponseAsync(s)];case 2:return(c=p.sent())?(u=AppMagic.PowerApps.SolutionVersionResponse.safeCast(c))&&u.value?[2,u.value.length>0?u.value[0].version:null]:(r.CoreLog.errorEx("CdsSolutionVersion._tryGetSolutionVersionInternal",{message:"Couldn't parse response",eventData:{telemetryName:a}}),[2,null]):(r.CoreLog.errorEx("CdsSolutionVersion._tryGetSolutionVersionInternal",{message:"Invalid response from the back-end service",eventData:{telemetryName:a}}),[2,null]);case 3:return p.sent(),r.CoreLog.errorEx("CdsSolutionVersion._tryGetSolutionVersionInternal",{message:"Caught exception",eventData:{telemetryName:a}}),[2,null];case 4:return[2]}}))}))},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"IEncryptionProviderSingletonKey",(function(){return o}));var r=n(0),o=Object(r.createForInterface)("AppMagic.Encryption.IEncryptionProvider")},function(e,t,n){"use strict";n.r(t)},function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(0),o=n(23);function i(e){return Object(r.isObject)(e)&&Object(r.isNumber)(e.status)&&Object(r.isString)(e.responseType)&&Object(r.isFunction)(e.getResponseHeader)&&(e.responseType!==o.ResponseTypes.Text||Object(r.isString)(e.responseText))}},function(e,t,n){"use strict";n.r(t),n.d(t,"ErrorMoreInfoLink",(function(){return a})),n.d(t,"DataLossPreventionClient",(function(){return s}));var r=n(0),o=n(180),i=n(149),a=(n(1),"https://go.microsoft.com/fwlink/?linkid=829852"),s=function(){function e(e){this._dlpService=e}return e.prototype._evaluatePolicyCoreAsync=function(t){return __awaiter(this,void 0,Promise,(function(){var n,o;return __generator(this,(function(i){return n=Object(r.HashTableUtility_create)(),t.forEach((function(e){n[e.id]||(n[e.id]={id:e.id,name:e.name,type:"api"})})),o=e._createEvaluatePolicyRequest(Object(r.getValues)(n)),[2,this._dlpService.evaluatePolicyAsync(o)]}))}))},e.prototype._evaluatePolicyAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this._evaluatePolicyCoreAsync(e)];case 1:return[2,t.sent().violations.map((function(e){return new o.ApiPolicyViolation(e)}))]}}))}))},e.prototype.checkDataLossPolicyAsync=function(t,n){return __awaiter(this,void 0,Promise,(function(){var o,a,s;return __generator(this,(function(c){switch(c.label){case 0:return o=t.concat(n),[4,this._evaluatePolicyAsync(o)];case 1:if(0!==(a=c.sent()).length)throw r.Log.trackActivityEvent("DataLossPreventionClient.checkDataLossPolicyAsync",{policyViolation:e._policyViolationToTelemetryString(a)}),(null==n?void 0:n.length)>0?(s=n.map((function(e){return e.id})).toString(),new i.ApiPolicyViolationError("Connections for API with Id ".concat(s," cannot be added due to policy violation."))):new i.ApiPolicyViolationError("There is a policy violation for the connections in the app. Please remove the offending connections and re-load the app.");return[2]}}))}))},e.prototype.tryDataLossPolicyForAppAsync=function(t,n){return void 0===n&&(n=!1),__awaiter(this,void 0,Promise,(function(){var o,i;return __generator(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this._dlpService.evaluatePolicyForAppAsync(t,n)];case 1:return 0!==(o=a.sent()).evaluationResult.violations.length&&r.Log.trackActivityEvent("DataLossPreventionClient.tryDataLossPolicyForAppAsync",{policyViolation:e._policyForAppViolationToTelemetryString(o.evaluationResult.violations)}),[2,o];case 2:return i=a.sent(),r.CoreLog.errorEx("DataLossPreventionClient.tryDataLossPolicyForAppAsync",i),[3,3];case 3:return[2]}}))}))},e.prototype.getNewApiViolationsAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var n,o,i,a;return __generator(this,(function(s){switch(s.label){case 0:return 0===(n=t.reduce((function(t,n){return e.some((function(e){return Object(r.equalsIgnoreCase)(e.id,n.id)}))?t:t.concat([n])}),[])).length?[2,[]]:(o=e.concat(n),[4,this._evaluatePolicyCoreAsync(o)]);case 1:return 0===(i=s.sent()).violations.length?[2,[]]:(a=i.violations.reduce((function(e,t){return e.concat(t.parameters.dataSource.apis).concat(t.parameters.dataDestination.apis)}),[]),[2,n.filter((function(e){return a.some((function(t){return t.id===e.id}))}))])}}))}))},e._policyViolationToTelemetryString=function(e){var t="Total violations: ".concat(e.length," \n");return e.forEach((function(e){t+="violation type: ".concat(e.type," \n")})),t},e._policyForAppViolationToTelemetryString=function(e){var t="Total violations: ".concat(e.length," \n");return e.forEach((function(e){t+="violation type: ".concat(e.type," \n")})),t},e._createEvaluatePolicyRequest=function(e){return{dataUsages:e.map((function(e){return{type:"api",parameters:{api:e}}}))}},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"PrimitiveDArgument",(function(){return r}));var r=function(){function e(e){this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!1,configurable:!0}),e}()},function(e,t,n){"use strict";var r;n.r(t),n.d(t,"AppListType",(function(){return r})),function(e){e[e.OrgApps=0]="OrgApps",e[e.MyApps=1]="MyApps",e[e.GlobalApps=2]="GlobalApps",e[e.ModelApps=3]="ModelApps",e[e.CuratedApps=4]="CuratedApps"}(r||(r={}))},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(157),i=n(159),a=n(162),s=n(102),c=function(e){function t(t,n,r,o){var i=this;return(i=e.call(this,r,o)||this)._clientId=t,i._resource=n,i}return __extends(t,e),t.prototype._acquireResourceAsync=function(e,t){var n=this;return this.authenticationContext.acquireTokenSilentAsync(this._resource,this._clientId,e,t).then((function(e){return n._saveTokenResponseAsync(e)}))},t}(n(288).a),u=n(163),p=function(){function e(e,t,n,o,a,s){this._clientId=t,this._clientSecret=n,this._defaultResource=o,this._redirectUri=a,this._authenticationContext=new i.AuthenticationPluginWrapper(s),this._resourceStores=Object(r.HashTableUtility_create)(),this._resourceAwaiterPools=Object(r.HashTableUtility_create)(),this._silentResourceAwaiterPools=Object(r.HashTableUtility_create)()}return e.prototype.createAuthenticationProvider=function(e){var t=this._resourceAwaiterPools[e],n=this._silentResourceAwaiterPools[e],i=this._resourceStores[e];if(Object(r.isUndefined)(t)){i=new u.UserContext;var p=new o.AccessTokenAcquirer(this._clientId,e,i,this._redirectUri,this._authenticationContext),l=new c(this._clientId,e,i,this._authenticationContext);t=new s.ResourceAwaiterPool(p),n=new s.ResourceAwaiterPool(l),this._resourceAwaiterPools[e]=t,this._silentResourceAwaiterPools[e]=n,this._resourceStores[e]=i}return new a.AuthenticationProvider(this,t,n,i)},e.prototype.logOutAsync=function(){var e=this;return r.Log.trackActivityEvent("ClientContext.logOutAsync"),this._authenticationContext.logOutAsync().then((function(){return e.clearUserIdentity()}))},e.prototype.clearUserIdentity=function(){Object(r.forEach)(this._resourceStores,(function(e){e.clear()}))},e}(),l=n(16),d=n(82);n.d(t,"AuthenticationManager",(function(){return f}));var f=function(){function e(e){var t=this;this._contexts=Object(r.HashTableUtility_create)(),this._pluginCreatorFn=e,this._authenticationProviders=null,this._dynamicProviders=Object(r.HashTableUtility_create)(),Object(r.regionChangedEvent)().addListener((function(e){t._resetProviders()}))}return Object.defineProperty(e.prototype,"authenticationProviders",{get:function(){return this._authenticationProviders||this._initializeProviders(),this._authenticationProviders},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logInProvider",{get:function(){return this.authenticationProviders.logInProvider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appServiceProvider",{get:function(){return this.authenticationProviders.appServiceProvider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"consentServerProvider",{get:function(){return this.authenticationProviders.consentServerProvider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rtsDataServiceProvider",{get:function(){return this.authenticationProviders.rtsDataServiceProvider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"microsoftGraphProvider",{get:function(){return this.authenticationProviders.microsoftGraphProvider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"powerBIServiceProvider",{get:function(){return this.authenticationProviders.powerBIServiceProvider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formsProServiceProvider",{get:function(){return this.authenticationProviders.formsProServiceProvider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"microsoftStreamServiceProvider",{get:function(){return this.authenticationProviders.microsoftStreamServiceProvider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"powerAppsServiceProvider",{get:function(){return this.authenticationProviders.powerAppsServiceProvider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"powerPlatformServiceProvider",{get:function(){return this.authenticationProviders.powerPlatformServiceProvider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"flowsProvider",{get:function(){return this.authenticationProviders.flowsProvider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"aibTextServiceProvider",{get:function(){return this.authenticationProviders.aibTextServiceProvider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cesFeedbackServiceProvider",{get:function(){return this.authenticationProviders.cesFeedbackServiceProvider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"neptuneServiceProvider",{get:function(){return this.authenticationProviders.neptuneServiceProvider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"azureDevOpsServiceProvider",{get:function(){return this.authenticationProviders.azureDevOpsServiceProvider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webAuthoringServiceProvider",{get:function(){return this.authenticationProviders.webAuthoringServiceProvider},enumerable:!1,configurable:!0}),e.prototype.refreshProviders=function(){this._resetProviders(),this._initializeProviders()},e.prototype._resetProviders=function(){this._authenticationProviders&&(this._authenticationProviders.logInProvider.dispose(),this._authenticationProviders.appServiceProvider.dispose(),this._authenticationProviders.consentServerProvider.dispose(),this._authenticationProviders.rtsDataServiceProvider.dispose(),this._authenticationProviders.powerBIServiceProvider.dispose(),this._authenticationProviders.formsProServiceProvider.dispose(),this._authenticationProviders.microsoftStreamServiceProvider.dispose(),this._authenticationProviders.powerAppsServiceProvider.dispose(),this._authenticationProviders.flowsProvider.dispose(),this._authenticationProviders.microsoftGraphProvider.dispose(),this._authenticationProviders.aibTextServiceProvider.dispose(),this._authenticationProviders.neptuneServiceProvider.dispose(),this._authenticationProviders.azureDevOpsServiceProvider.dispose(),this._authenticationProviders.webAuthoringServiceProvider.dispose(),this._authenticationProviders=null)},e.prototype.createAuthenticationProvider=function(e,t,n,o,i,a){var s=e+"~"+t,c=this._contexts[s];return Object(r.isUndefined)(c)&&(c=new p(e,t,n,o,i,a),this._contexts[s]=c),c.createAuthenticationProvider(o)},e.prototype._initializeProviders=function(){var e=l.Region.getCurrentRegion(),t=this._pluginCreatorFn().getAuthenticationPlugin(e.authUri.toString()),n=e.powerAppsServiceResource,o=e.logInResource,i=Object(r.getLogInResource)();i&&(r.Log.trackActivityEvent("AuthenticationManager._initializeProviders",{message:"using logInResource override",prevLoginResource:o,newLogInResource:i}),o=i);var a=e.microsoftGraphEndpoint.toString(),s=Object(r.getWebPlayerGraphResource)();s&&(r.Log.trackActivityEvent("AuthenticationManager._initializeProviders",{message:"using web player graph resource",microsoftGraphResource:a,webPlayerGraphResource:s}),a=s);var c=this.createAuthenticationProvider(e.authUri,e.clientId,null,o,e.redirectUri,t),u=this.createAuthenticationProvider(e.authUri,e.clientId,null,e.apiHubRuntimeAudience,e.redirectUri,t),p=this.createAuthenticationProvider(e.authUri,e.clientId,null,e.consentServerResource,e.redirectUri,t),d=this.createAuthenticationProvider(e.authUri,e.clientId,null,e.rtsDataServiceResource,e.redirectUri,t),f=this.createAuthenticationProvider(e.authUri,e.clientId,null,e.powerBIServiceResource,e.redirectUri,t),y=this.createAuthenticationProvider(e.authUri,e.clientId,null,e.formsProServiceResource,e.redirectUri,t),m=this.createAuthenticationProvider(e.authUri,e.clientId,null,e.microsoftStreamServiceResource,e.redirectUri,t),g=this.createAuthenticationProvider(e.authUri,e.clientId,null,n,e.redirectUri,t),v=this.createAuthenticationProvider(e.authUri,e.clientId,null,e.powerPlatformResource,e.redirectUri,t),b=this.createAuthenticationProvider(e.authUri,e.clientId,null,e.webAuthResource,e.redirectUri,t),h=this.createAuthenticationProvider(e.authUri,e.clientId,null,e.flowsResource,e.redirectUri,t),A=this.createAuthenticationProvider(e.authUri,e.clientId,null,a,e.redirectUri,t),C=this.createAuthenticationProvider(e.authUri,e.clientId,null,e.aibTextServiceResource,e.redirectUri,t),P=this.createAuthenticationProvider(e.authUri,e.clientId,null,e.aibTextServiceResource,e.redirectUri,t),w=this.createAuthenticationProvider(e.authUri,e.clientId,null,e.neptuneServiceAudience,e.redirectUri,t),S=this.createAuthenticationProvider(e.authUri,e.clientId,null,"499b84ac-1321-427f-aa17-267ca6975798",e.redirectUri,t);this._authenticationProviders={logInProvider:c,webAuthoringServiceProvider:b,appServiceProvider:u,consentServerProvider:p,rtsDataServiceProvider:d,powerBIServiceProvider:f,formsProServiceProvider:y,microsoftStreamServiceProvider:m,powerAppsServiceProvider:g,powerPlatformServiceProvider:v,flowsProvider:h,microsoftGraphProvider:A,aibTextServiceProvider:C,cesFeedbackServiceProvider:P,neptuneServiceProvider:w,azureDevOpsServiceProvider:S}},e.prototype._getOrCreateAuthenticationProvider=function(e){var t=l.Region.getCurrentRegion(),n=this._pluginCreatorFn().getAuthenticationPlugin(t.authUri.toString()),r=e.toLowerCase();return this._dynamicProviders[r]||(this._dynamicProviders[r]=this.createAuthenticationProvider(t.authUri,t.clientId,null,r,t.redirectUri,n)),this._dynamicProviders[r]},e.prototype.getProviderForResourceUrl=function(e,t){if(void 0===t&&(t=!1),t)return this._getOrCreateAuthenticationProvider(e);var n=l.Region.getCurrentRegion();switch(e){case n.apiHubRuntimeAudience:return this.appServiceProvider;case n.consentServerResource:return this.consentServerProvider;case n.flowsResource:return this.flowsProvider;case n.powerAppsServiceResource:return this.powerAppsServiceProvider;case n.powerPlatformResource:return this.powerPlatformServiceProvider;case n.powerBIServiceResource:return this.powerBIServiceProvider;case n.formsProServiceResource:return this.formsProServiceProvider;case n.microsoftStreamServiceResource:return this.microsoftStreamServiceProvider;case n.rtsDataServiceResource:return this.rtsDataServiceProvider;case n.microsoftGraphResource:return this.microsoftGraphProvider;case n.neptuneServiceAudience:return this.neptuneServiceProvider;case n.webAuthResource:return this.webAuthoringServiceProvider;default:throw new d.SendHttpError("Invalid resource specified. Resource name: ".concat(e))}},e}()},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(0),o="global",i=function(){function e(){}return e.buildMap=function(e){var t=Object(r.HashTableUtility_create)();return e.forEach((function(e){e.dataSources.forEach((function(n){t[n]=e.id}))})),t},e.buildPerAppMap=function(e){var t=this,n=Object(r.HashTableUtility_create)();return e.forEach((function(e){e.dataSources.forEach((function(r){t._addToConsolidatedMap(e.id,r,o,n)})),e.dataSourceAppMappings?Object(r.forEach)(e.dataSourceAppMappings,(function(r,i){r.forEach((function(r){t._addToConsolidatedMap(e.id,i,r,n),delete n[o][i]}))})):e.datasets&&!Object(r.HashTableUtility_isEmpty)(e.datasets)&&Object(r.forEach)(e.datasets,(function(i){Object(r.forEach)(i.dataSources,(function(r,i){r.apps&&r.apps.forEach((function(r){t._addToConsolidatedMap(e.id,i,r,n),delete n[o][i]}))}))}))})),Object(r.HashTableUtility_isEmpty)(n)?n[o]=Object(r.HashTableUtility_create)():Object(r.forEach)(n,(function(e,t){t!==o&&(n[t]=__assign(__assign({},n[o]),e))})),n},e._addToConsolidatedMap=function(e,t,n,o){o[n]||(o[n]=Object(r.HashTableUtility_create)()),o[n][t]=e},e}()},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t),n.d(t,"AsyncResult",(function(){return r}));var r=function(){return function(){}}()},function(e,t,n){"use strict";n.r(t),n.d(t,"AuthenticationBrokerManagerFactory",(function(){return o}));n(0);var r=n(139),o=function(){function e(e){this._defaultBrokerManager=new r.AuthenticationBrokerManager(e)}return e.prototype.getBrokerManager=function(){return this._defaultBrokerManager},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"IdentityStore",(function(){return i}));var r=n(0),o=n(120),i=function(){function e(e){this._settingsProvider=e}return Object.defineProperty(e.prototype,"userIdentity",{get:function(){var e=this._settingsProvider.getValue("PowerApps_UserIdentityKey");return e&&Object(r.isNonEmptyString)(e)?o.UserIdentity.fromJsonWebToken(e):null},set:function(e){this._settingsProvider.setValue("PowerApps_UserIdentityKey",e.serializedJsonString)},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this._settingsProvider.removeValue("PowerApps_UserIdentityKey")},e}()},function(e,t,n){"use strict";n.r(t)},function(e,t,n){"use strict";n.r(t),n.d(t,"SingleEntityConnectionReferenceNameMap",(function(){return i}));var r=n(0),o=n(235),i=function(){function e(){this._entityReferenceNameMap=Object(r.HashTableUtility_create)()}return e.prototype.populateMap=function(e){this._entityReferenceNameMap=o.a.buildMap(e)},e.prototype.addEntityReferences=function(e,t){var n=this;this._entityReferenceNameMap?e.forEach((function(e){return n._entityReferenceNameMap[e]=t})):r.Log.trackErrorEvent("SingleEntityConnectionReferenceNameMap.addEntityReferences",{message:"an Entity-Reference map doesn't exist"})},e.prototype.tryGetEntityReferenceMap=function(){return this._entityReferenceNameMap||null},e.prototype.tryRemoveEntityReferenceMap=function(e){try{delete this._entityReferenceNameMap[e]}catch(e){return r.CoreLog.errorEx("SingleEntityConnectionReferenceNameMap.tryRemoveReferenceMap","Removing Entity Reference map from store failed with error",{error:e}),!1}return!0},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"EnvironmentService",(function(){return y}));var r,o=n(0),i=n(1),a=n(6),s=n(28),c=n(2),u=n(4),p=n(8),l=n(27),d=n(67),f=n(16);!function(e){e.getStartupEnvironment="Environments.GetStartupEnvironment",e.setEnvironmentAsync="Environments.setEnvironmentAsync",e.tryGetDefaultEnvironmentAsync="Environments.tryGetDefaultEnvironmentAsync"}(r||(r={}));var y=function(e){function t(t,n,r,i){var a=e.call(this)||this;return a._isLocked=!1,a._userObjectId=t,a._environmentsCache=n,a._unfilteredEnvironmentsCache=i,a._settingsProvider=r,a._currentEnvironment=null,a._currentFullEnvironment=null,a._environmentChangedEvent=new o.EventObject,a}var n;return __extends(t,e),Object.defineProperty(t.prototype,"environmentChangedEvent",{get:function(){return this._environmentChangedEvent},enumerable:!1,configurable:!0}),t.getEnvironmentsFromServerAsync=function(e,n,r){return __awaiter(this,void 0,Promise,(function(){var u,p,d,f;return __generator(this,(function(y){switch(y.label){case 0:return[4,t._getEnvironmentsFromPowerPlatformEmbedAsync()];case 1:return(u=y.sent())?[2,u]:a.t.IsPowerPlatformApiEnabled&&!r?(p="Tenant Id is required for Power Platform API endpoint in hostname request. Failed to retrieve the environment list due to tenant id value is null.",o.CoreLog.errorEx("ServerItemsRetriever.getEnvironmentsAsync",p),[2,Promise.reject(p)]):(d=new s.ODataListItemsTool(this.generateEnvironmentFromServerUrl(n,r).toString(),a.t.getResourceName(),e,"EnvironmentsService.ListEnvironments",c.PowerAppsNextLink),f={apiVersion:a.t.getApiVersion()},[2,d.getItemsAsync(f).then((function(e){if(e.resultCode!==s.GetItemsResultCode.Success){var t=s.GetItemsResultCode[e.resultCode];throw t+=e.errorMessage?". ".concat(e.errorMessage):"",new o.ApplicationError(t)}return e.items.map(i.Kb.safeCast).filter((function(e){return null!==e})).map((function(e){return Object(l.k)(e)})).filter((function(e){return null!==e}))})).catch((function(e){return Object(o.throwIfCanceled)(e),o.CoreLog.error("ServerItemsRetriever.getEnvironmentsAsync",e,"Getting Environments from server failed."),Promise.reject(e)}))])}}))}))},t.generateEnvironmentFromServerUrl=function(e,t){var n=a.t.IsPowerPlatformApiEnabled?u.PowerAppsUtility.createPowerAppsTenantUrlBuilder(t):u.PowerAppsUtility.createPowerAppsProviderUrlBuilder();n.appendPath(l.f);var r="properties.permissions";return a.t.IsPowerPlatformApiEnabled||(r=c.PowerAppEndpoints.getEnvironmentPermissionExpandQueryParam(f.Region.getCurrentRegion().powerAppsApiVersion)),n.setQueryParam("$expand",r),e&&n.setQueryParam(c.PowerAppEndpoints.pollQueryParam,"true"),n},t.getAllEnvironmentsFromBAPServerAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var n,r,a,u,y,m,g,v;return __generator(this,(function(b){switch(b.label){case 0:return Object(o.isWebAuthoringTeamsEmbedded)()?[4,t._getEnvironmentsFromPowerPlatformEmbedAsync()]:[3,2];case 1:if(g=b.sent())return[2,g];b.label=2;case 2:(n=d.BapUtility.createBapProviderUrlBuilder()).appendPath(l.f),r=f.Region.getCurrentRegion().bapApiVersion,a=new s.ODataListItemsTool(n.toString(),p.d.PowerAppsService,e,"EnvironmentsService.getAllEnvironmentsFromBAPServerAsync",c.PowerAppsNextLink),u={apiVersion:r},b.label=3;case 3:return b.trys.push([3,5,,6]),[4,a.getItemsAsync(u)];case 4:if((y=b.sent()).resultCode!==s.GetItemsResultCode.Success)throw m=s.GetItemsResultCode[y.resultCode],m+=y.errorMessage?". ".concat(y.errorMessage):"",new o.ApplicationError(m);return[2,g=y.items.map((function(e){var t=i.Kb.safeCast(e);return t?Object(l.k)(t):null})).filter((function(e){return null!==e})).sort((function(e,t){return e.displayName.localeCompare(t.displayName)}))];case 5:return v=b.sent(),Object(o.throwIfCanceled)(v),o.CoreLog.error("ServerItemsRetriever.getAllEnvironmentsFromBAPServerAsync",v,"Getting Environments from BAP server failed."),[2,Promise.reject(v)];case 6:return[2]}}))}))},t.prototype.initializeEnvironment=function(){Object(o.isWebAuthoring)()||this.trackAnonymous(this.getCurrentEnvironmentAsync().catch((function(e){o.CoreLog.error("EnvironmentService.initializeEnvironment",e,"Failed to initialize environment")})))},t.prototype.resetAndLockEnvironment=function(){this.resetState(),this._isLocked=!0},t.tryGetCurrentEnvironmentFromPowerPlatformEmbedAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return Object(o.isWebAuthoringEmbedded)()?[2,t.getDataFromPowerPlatformEmbedAsync(o.EventBrokerId.PowerPlatformEmbed_RequestCurrentEnvironment,o.EventBrokerId.PowerPlatformEmbed_CurrentEnvironmentProvided,"EnvironmentService.PowerPlatformEmbed_RequestCurrentEnvironment",(function(e){var t=l.a.tryDeserialize(e);return o.Log.trackActivityEvent("EnvironmentService.PowerPlatformEmbed_CurrentEnvironmentProvided",{environment:null==t?void 0:t.name,webAuthSessionTimeout:Object(o.getWebAuthSessionTimeout)()}),t}))]:[2,null]}))}))},t.prototype.tryGetLastUsedEnvironment=function(){var e,n,r,a=this._settingsProvider.getValue(t._lastUsedEnvironmentKey);if(!a)return null;var s=i.Qf.safeCast(a);return s&&s.oid===this._userObjectId&&s.locale===Core.Globalization.currentCulture().currentLocaleName?s.environment:(o.Log.trackActivityEvent("EnvironmentService.tryGetLastUsedEnvironment",{message:"Last used environment in the settings provider cannot be used.",hasCachedInfo:!!s,currentOid:this._userObjectId,currentLocale:Core.Globalization.currentCulture().currentLocaleName,cachedOid:null==s?void 0:s.oid,cachedLocale:null==s?void 0:s.locale,cachedEnvironmentId:null===(e=null==s?void 0:s.environment)||void 0===e?void 0:e.id,cachedEnvironmentLocation:null===(r=null===(n=null==s?void 0:s.environment)||void 0===n?void 0:n.properties)||void 0===r?void 0:r.location}),null)},t._toEnvironmentReference=function(e){var t,n,r,o,i;return{id:e.id,name:e.name,properties:{displayName:e.displayName||e.name,location:e.location,updateCadence:null===(t=e.properties)||void 0===t?void 0:t.updateCadence,environmentSku:null===(n=e.properties)||void 0===n?void 0:n.environmentSku,linkedEnvironmentMetadata:null===(r=e.properties)||void 0===r?void 0:r.linkedEnvironmentMetadata,cluster:null===(o=e.properties)||void 0===o?void 0:o.cluster,governanceConfiguration:null===(i=e.properties)||void 0===i?void 0:i.governanceConfiguration}}},Object.defineProperty(t.prototype,"lastUsedEnvironment",{set:function(e){var n={locale:Core.Globalization.currentCulture().currentLocaleName,oid:this._userObjectId,environment:e};this._settingsProvider.setValue(t._lastUsedEnvironmentKey,n,!0)},enumerable:!1,configurable:!0}),t.prototype._tryGetStartupEnvironmentAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e,n,o=this;return __generator(this,(function(i){switch(i.label){case 0:return[4,t.tryGetCurrentEnvironmentFromPowerPlatformEmbedAsync()];case 1:return(e=i.sent())?[2,t._toEnvironmentReference(e)]:(n=this.tryGetLastUsedEnvironment())?(t._trackEnvironmentTelemetry(r.getStartupEnvironment,"Starting up with last used environment (".concat(n.id,")")),[2,n]):[2,this.tryGetDefaultEnvironmentAsync().then((function(e){return e?(t._trackEnvironmentTelemetry(r.getStartupEnvironment,"No last used environment found. Starting up with default environment (".concat(e.id,")")),t._toEnvironmentReference(e)):o._environmentsCache.tryFindFirstItemAsync((function(){return!0})).then((function(e){return e?(t._trackEnvironmentTelemetry(r.getStartupEnvironment,"No default environment found. Starting up with environment (".concat(e.id,")")),t._toEnvironmentReference(e)):(t._trackEnvironmentTelemetry(r.getStartupEnvironment,"No environment found. Returning null"),null)}))}))]}}))}))},t.prototype.listEnvironmentsAsync=function(e){return void 0===e&&(e=!1),this._environmentsCache.getItemsAsync(e).then((function(e){return Object(o.getValues)(e)}))},t.prototype.listUnfilteredEnvironmentsAsync=function(e){return void 0===e&&(e=!1),this._unfilteredEnvironmentsCache.getItemsAsync(e).then((function(e){return Object(o.getValues)(e)}))},t.prototype.tryGetEnvironmentByIdAsync=function(e){return this._environmentsCache.tryGetItemAsync(e)},t.prototype.tryGetDefaultEnvironmentAsync=function(){return this._environmentsCache.tryFindFirstItemAsync((function(e){return e.isDefault})).then((function(e){return e||(o.CoreLog.error(r.tryGetDefaultEnvironmentAsync,"Could not find default environment. Returning null."),null)}))},t.prototype.tryGetEnvironmentByNameAsync=function(e){return this._environmentsCache.tryFindFirstItemAsync((function(t){return t.name===e}))},t.prototype.tryGetUnfilteredEnvironmentByNameAsync=function(e){return this._unfilteredEnvironmentsCache.tryFindFirstItemAsync((function(t){return t.name===e}))},t.prototype.getCurrentEnvironmentAsync=function(){var e=this;return this._currentEnvironment?Promise.resolve(this._currentEnvironment):(this._initializeEnvironmentPromise||(this._initializeEnvironmentPromise=Object(o.timeout)(0).then((function(){return e._tryGetStartupEnvironmentAsync()})).then((function(t){if(!t)throw new Error("Failed to set current environment. No environments available.");return e._currentEnvironment||e._setCurrentEnvironment(t),e._currentEnvironment})).catch((function(t){return e._initializeEnvironmentPromise=null,Promise.reject(t)}))),this._initializeEnvironmentPromise)},t.prototype.isDefaultCdsEnvironmentAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return Object(o.isNullOrUndefined)(e)&&(e=this._currentFullEnvironment),[4,this._tryGetStartupEnvironmentAsync()];case 1:return[2,t.sent().id===e.id]}}))}))},t.prototype.getFullCurrentEnvironmentAsync=function(){var e=this;return Object(o.isWebAuthoring)()&&this._currentFullEnvironment?Promise.resolve(this._currentFullEnvironment):this.getCurrentEnvironmentAsync().then((function(t){return e.tryGetEnvironmentByIdAsync(t.id)}))},t.prototype.tryGetCurrentEnvironment=function(){return this._currentEnvironment},t.prototype.tryGetFullCurrentEnvironment=function(){return this._currentFullEnvironment},t.prototype.switchEnvironment=function(e){var n,r,i,a;if(Object(o.isWebAuthoring)())if(e instanceof l.a)this._currentFullEnvironment=e,(null===(r=null===(n=null==e?void 0:e.properties)||void 0===n?void 0:n.updateCadence)||void 0===r?void 0:r.id)&&o.Log.setEnvironmentUpdateCadence(null===(a=null===(i=null==e?void 0:e.properties)||void 0===i?void 0:i.updateCadence)||void 0===a?void 0:a.id);else{o.CoreLog.error("EnvironmentService.switchEnvironment","expected full environment (not IEnvironmentReference) in WebAuth (reference only allowed in Player)")}if(this._currentEnvironment&&this._currentEnvironment.id===e.id)return this._currentEnvironment;var s=e instanceof l.a?t._toEnvironmentReference(e):e;return this._setCurrentEnvironment(s),this._currentEnvironment},t.prototype.resetState=function(){this._currentEnvironment=null,Object(o.setEnvironmentName)(null),this._initializeEnvironmentPromise=null,this._settingsProvider.removeValue(t._lastUsedEnvironmentKey)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._environmentChangedEvent.dispose()},t.prototype._setCurrentEnvironment=function(e){var n,i,a,s,c,u,p,l,d,f,y;if(this._isLocked)o.Log.trackActivityEvent("EnvironmentService._setCurrentEnvironment._isLocked",{message:"Prevented set because environment service is locked.",environmentId:e.id});else{var m=null===(i=null===(n=e.properties)||void 0===n?void 0:n.cluster)||void 0===i?void 0:i.environment,g=null===(s=null===(a=e.properties)||void 0===a?void 0:a.cluster)||void 0===s?void 0:s.category,v=null===(u=null===(c=e.properties)||void 0===c?void 0:c.cluster)||void 0===u?void 0:u.geoShortName,b=null===(l=null===(p=e.properties)||void 0===p?void 0:p.cluster)||void 0===l?void 0:l.uriSuffix,h=null===(f=null===(d=e.properties)||void 0===d?void 0:d.cluster)||void 0===f?void 0:f.number;o.Log.setEnvironmentId(e.id),o.Log.setClusterEnvironment(m),o.Log.setClusterCategory(g),o.Log.setEnvironmentSku(null===(y=e.properties)||void 0===y?void 0:y.environmentSku),t._trackEnvironmentTelemetry(r.setEnvironmentAsync,"Setting environment",{prevEnvironmentId:this._currentEnvironment?this._currentEnvironment.id:"None",newEnvironmentId:e.id,newClusterEnvironment:m,newClusterCategory:g,newClusterGeoName:v,newClusterUriSuffix:b,newClusterNumber:h}),this.lastUsedEnvironment=e,this._currentEnvironment=e,Object(o.setEnvironmentName)(e.name),this._ensureCurrentEnvironmentHasDisplayName(),this._environmentChangedEvent.dispatch(this._currentEnvironment)}},t.prototype._ensureCurrentEnvironmentHasDisplayName=function(){!!this._currentEnvironment.properties&&!!this._currentEnvironment.properties.displayName||(o.Log.trackEvent(o.environmentReferenceMissingDisplayName),this._currentEnvironment.properties?this._currentEnvironment.properties.displayName=this._currentEnvironment.name:this._currentEnvironment.properties={displayName:this._currentEnvironment.name})},t._trackEnvironmentTelemetry=function(e,t,n){var r={operationName:e,message:t};Object(o.insertObjectProperties)(r,n),o.Log.trackEvent(o.environmentService,r)},n=t,t._lastUsedEnvironmentKey="LastUsedEnvironment",t.getDataFromPowerPlatformEmbedAsync=function(e,t,r,i){return __awaiter(void 0,void 0,void 0,(function(){var a,s,c,u;return __generator(n,(function(n){switch(n.label){case 0:return a=Object(o.getWebAuthSessionTimeout)(),[4,Object(o.wrapWithTimeout)(new Promise((function(n){var s=o.ObjectFactory.instance.getSingleton(o.ShellEventBroker.singletonKey),c=function(e,u){if(s.unsubscribe([t],c),u){var p=i(u);n(p)}else o.CoreLog.errorEx("EnvironmentService.getDataFromPowerPlatformEmbedAsync",r,{eventData:{webAuthSessionTimeout:a}}),n(null)};s.subscribe([t],c),o.Log.trackActivityEvent(r,{webAuthSessionTimeout:a}),s.publishEvent(e,null)})),a)];case 1:return s=n.sent(),c=s.hasTimedOut,u=s.result,c?(o.Log.trackException(new Error("Timeout"),{webAuthSessionTimeout:a}),[2,null]):[2,u]}}))}))},t._getEnvironmentsFromPowerPlatformEmbedAsync=function(){return Object(o.isWebAuthoringEmbedded)()?t.getDataFromPowerPlatformEmbedAsync(o.EventBrokerId.PowerPlatformEmbed_RequestEnvironments,o.EventBrokerId.PowerPlatformEmbed_EnvironmentsProvided,"EnvironmentService.PowerPlatformEmbed_RequestEnvironments",(function(e){var t=e.map(i.Kb.safeCast).filter((function(e){return null!==e})).map((function(e){return Object(l.k)(e)})).filter((function(e){return null!==e}));return o.Log.trackActivityEvent("EnvironmentService.PowerPlatformEmbed_EnvironmentsProvided",{rawDataCount:null==e?void 0:e.length,environmentCount:null==t?void 0:t.length}),t})):null},t}(o.Disposable)},function(e,t,n){"use strict";n.r(t),n.d(t,"FormUrlEncodedBodyRequestParam",(function(){return r}));n(0),n(152);var r=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}return __extends(t,e),t.prototype._applyValue=function(e,t){e.setFormValue(this.paramName,t)},t}(n(73).NamedHttpRequestParam)},function(e,t,n){"use strict";n.r(t),n.d(t,"FormUrlEncodedTypedBodyRequestParam",(function(){return o}));n(0),n(152);var r=n(7),o=function(e){function t(t,n,o){var i=e.call(this,n,o,r.HttpStringBasedTTypeValueKinds)||this;return i._paramName=t,i}return __extends(t,e),t.prototype._applyValue=function(e,t){e.setFormValue(this._paramName,t)},t}(n(123).TypedRequestParamBase)},function(e,t,n){"use strict";n.r(t),n.d(t,"FunctionParameter",(function(){return o}));n(0);var r=n(5),o=function(){function e(e,t,n,r,o,i,a,s){this._name=e,this._dtype=t,this._ttypeRef=n,this._isRequired=r,this._docId=o,this._options=i,this._defaultValue=a,this._tryItValue=s}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRequired",{get:function(){return this._isRequired},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docId",{get:function(){return this._docId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defaultValue",{get:function(){return this._defaultValue},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tryItValue",{get:function(){return this._tryItValue},enumerable:!1,configurable:!0}),e.prototype.getSchema=function(e){return null!==this._dtype?Object(r.createSchemaForSimple)(this._dtype):this._ttypeRef.getType().computeDValueSchema(e)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"FunctionVariable",(function(){return r}));n(0);var r=function(){function e(e,t){this._name=e,this._valueExpr=t}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"valueExpression",{get:function(){return this._valueExpr},enumerable:!1,configurable:!0}),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"HeaderRequestParam",(function(){return r}));n(0);var r=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}return __extends(t,e),t.prototype._applyValue=function(e,t){e.addHeader(this.paramName,t)},t}(n(73).NamedHttpRequestParam)},function(e,t,n){"use strict";n.r(t),n.d(t,"HostHttpClient",(function(){return i}));var r=n(0),o=(n(97),n(113),n(33)),i=function(){function e(e){this._automater=e}return e.prototype.sendHttpAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var t,n,i,a,s;return __generator(this,(function(c){switch(c.label){case 0:return Object(r.isWebAuthoring)()?(r.ObjectFactory.instance.getSingleton(r.ShellEventBroker.singletonKey).publishEvent(r.EventBrokerId.HostOperations_Trigger,e),[2,{status:200,headers:e.headers,responseType:"text"}]):(t=1e4,e.signal,n=__rest(e,["signal"]),[4,Object(r.wrapWithTimeout)(this._automater.appToHostFunctions.executeSendTriggerAsync(n),t)]);case 1:return(i=c.sent()).hasTimedOut?[2,{status:o.SendTriggerFunctionStatusCode.TimeOut,headers:Object.create(null),responseType:"text",responseText:t.toString()}]:(a=i.result,s=a.data,[2,{status:a.status,headers:Object.create(null),responseType:"json",responseText:void 0,response:s}])}}))}))},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"HttpClient",(function(){return s}));var r=n(0),o=(n(97),n(113),n(64),n(178)),i=n(11),a=n(35),s=function(){function e(t,n){void 0===n&&(n={});var o=this;this._sendHttpPipeline=t,this._getDiagnosticsHttpRequestAsync=function(t){return __awaiter(o,void 0,Promise,(function(){var n,r,o;return __generator(this,(function(i){switch(i.label){case 0:return Core.Diagnostics.isEnabled()?(r=(n=e).getDiagnosticHttpRequest,o=[t.url,t.method,t.headers],[4,this._getBodyText(t.bodyData)]):[2,void 0];case 1:return[2,r.apply(n,o.concat([i.sent()]))]}}))}))},this._sendDiagnosticsTraceAsync=function(t,n,i){return __awaiter(o,void 0,Promise,(function(){var o,a;return __generator(this,(function(s){switch(s.label){case 0:return t?(a={status:n.status,headers:n.headers,size:n.responseSize||0},[4,this._getBodyText(n.response)]):[3,2];case 1:a.body=s.sent(),a.duration=n.duration||0,o=a,Object(r.isDefined)(n.responseType)&&(o.responseType=n.responseType),n.performanceInformation&&(o.performanceInformation=n.performanceInformation),e.handleDiagnosticHttpResponse(__assign(__assign({},t),{headers:i}),o),s.label=2;case 2:return[2]}}))}))},this._sendToAppInstrumentation=function(e,t){Core.AppInstrumentation.isDependencyTrackingEnabled()&&Core.AppInstrumentation.trackDependency(e.url,"Ajax",t.duration,t.status,Object(r.HashTableUtility_create)(e.headers),Object(r.HashTableUtility_create)(t.headers))},this._responseTypeForIgnoreResponse=n.responseTypeForIgnoreResponse||"text"}return Object.defineProperty(e.prototype,"pipeline",{get:function(){return this._sendHttpPipeline},enumerable:!1,configurable:!0}),e.prototype.sendHttpAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var n,o,s,c,u,p,l;return __generator(this,(function(d){switch(d.label){case 0:if(n=Date.now(),e.bodyData instanceof Core.PABinary&&"invalid"===e.bodyData.source.sourceType)throw r.PABinary.createErrorFromInvalid(e.bodyData);return[4,this._getDiagnosticsHttpRequestAsync(e)];case 1:o=d.sent(),s=__assign(__assign({},e),{allowSessionStorage:!0,responseType:t}),e.headers&&(s.headers=Object(r.HashTableUtility_create)(e.headers)),c=s.responseType||"text",d.label=2;case 2:return d.trys.push([2,5,,8]),[4,this._sendHttpPipeline.sendHttpAsync(s)];case 3:return u=d.sent(),Object(r.checkStrictEqual)(u.responseType,c,"HttpClient.sendHttpAsync: pipelineResponse.responseType"),p=Date.now(),[4,this._sendDiagnosticsTraceAsync(o,u,s.headers)];case 4:return d.sent(),this._sendToAppInstrumentation(e,u),Object(i.addSendHttpPipelinePerf)("HttpClient",u,n,p,Date.now()),[2,u];case 5:return l=d.sent(),Object(a.errorHasHttpResponse)(l)?[4,this._sendDiagnosticsTraceAsync(o,l.response,s.headers)]:[3,7];case 6:d.sent(),this._sendToAppInstrumentation(e,l.response),d.label=7;case 7:throw l;case 8:return[2]}}))}))},e.getDiagnosticHttpRequest=function(e,t,n,o){if(!Core.Diagnostics.isEnabled())return null;var i={url:e,method:t,headers:n,body:o};if(n){var a=Object(r.tryGetValueIgnoreCase)(n,Core.Diagnostics.HeaderName.DiagnosticContext);if(a){var s=JSON.parse(a);this.populateDiagnosticContext(i,s),i.context=s}delete n[Core.Diagnostics.HeaderName.DiagnosticContext]}return i},e.handleDiagnosticHttpResponse=function(e,t){var n,o;if(Core.Diagnostics.isEnabled()&&(null===(o=null===(n=null==e?void 0:e.context)||void 0===n?void 0:n.diagnosticContext)||void 0===o?void 0:o.dataOperation)){var i,a=t.body;t.body&&t.size>Core.Diagnostics.maxTraceResponseBodySize&&(a=AppMagic.Strings.MonitorResponseTruncatedLargeSize+JSON.stringify(t.body).substr(0,Core.Diagnostics.maxTraceResponseBodySize),i=!0);var s={duration:Math.floor(100*t.duration||0)/100,size:t.size,status:t.status,headers:t.headers,body:a,responseType:t.responseType},c=e.headers||{},u=(c.Authorization,__rest(c,["Authorization"])),p={url:e.url,method:e.method,headers:u,body:e.body},l={context:e.context,request:p,response:s};if(i&&(l.responseTruncated=!0),t.performanceInformation){Object.keys(t.performanceInformation).forEach((function(e){!function(e,t){Object(r.isNumber)(t)?t>0&&(l[e]=Math.round(100*t)/100):l[e]=t}(e,t.performanceInformation[e])}))}Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.Network,e.context.diagnosticContext.dataOperation.operation,l)}},e.populateDiagnosticContext=function(e,t){try{if(!Core.Diagnostics.isEnabled())return;var n=e.url;if("GET"===e.method){var o=n.indexOf("?");if(-1!==o){for(var i=n.substring(o+1).split("&"),a=0,s=0,c=0,u=i;c<u.length;c++){var p=u[c],l=decodeURIComponent(p);if(l.startsWith("$expand="))a++;else if(l.startsWith("$select=")){var d=l.split("=");if(d.length>1)s+=d[1].split(",").length}}(a>0||s>0)&&t.diagnosticContext&&t.diagnosticContext.dataOperation&&(t.diagnosticContext.dataOperation.requestDetails={RequestedLookups:a,RequestedColumns:s})}}}catch(e){r.CoreLog.warningEx("HttpClient.populateDiagnosticContext",e.toString())}},e.prototype.sendHttpIgnoreResponseAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this.sendHttpAsync(e,this._responseTypeForIgnoreResponse)];case 1:return t.sent(),[2]}}))}))},e.prototype.sendHttpTextResponseAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this.sendHttpAsync(e,"text")];case 1:return[2,t.sent().responseText]}}))}))},e.prototype.sendHttpJsonResponseAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this.sendHttpAsync(e,"json")];case 1:return[2,t.sent().response]}}))}))},e.prototype.sendHttpJsonArrayResponseAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this.sendHttpAsync(e,"json")];case 1:return[2,t.sent().response]}}))}))},e.prototype.sendHttpBlobResponseAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this.sendHttpAsync(e,"blob")];case 1:return[2,t.sent().response]}}))}))},e.prototype.sendHttpPABinaryResponseAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this.sendHttpAsync(e,"pabinary")];case 1:return[2,t.sent().response]}}))}))},e.prototype._getBodyText=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return null==e?[2,""]:"string"==typeof e?[2,e]:e instanceof Core.PABinary?[4,new o.WinJSPABinaryResolver(WinJS.xhr).getAsTextAsync(e)]:[3,2];case 1:return[2,t.sent()];case 2:return[2,JSON.stringify(e)]}}))}))},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"HttpRequestBuilderFactory",(function(){return r}));var r=function(){function e(e){this._prototype=e}return e.prototype.createHttpRequestBuilder=function(e){return this._pathUpdateFunction=e,this._prototype.clone(this._pathUpdateFunction)},e}()},function(e,t,n){"use strict";var r;n.r(t),n.d(t,"OrganizationSettingsConstants",(function(){return r})),function(e){e.OrganizationsDataSourceName="aaecc619-18c9-476b-9b00-1226535c6d87",e.OrganizationsEntitySetName="organizations",e.OrganizationsLogicalName="organization",e.OrganizationsTableName="Organization",e.PremiumOrgSettingsControls=["Copilot","PowerApps.Copilot","CopilotAnswer","PowerApps.CopilotAnswer"]}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"JsonBodyRequestParam",(function(){return o}));n(0),n(44);var r=n(7),o=function(e){function t(t,n,o){var i=e.call(this,n,o,r.JsonTTypeValueKinds)||this;return i._jsonpointer=t,i}return __extends(t,e),t.prototype._applyValue=function(e,t){e.setJsonValue(this._jsonpointer,t)},t.prototype._applyNullValue=function(e){e.setJsonValue(this._jsonpointer,null)},t}(n(123).TypedRequestParamBase)},function(e,t,n){"use strict";n.r(t),n.d(t,"NoOpServiceHost",(function(){return r}));n(0);var r=function(){function e(){}return Object.defineProperty(e.prototype,"timeoutInterval",{get:function(){return-1},enumerable:!1,configurable:!0}),e.prototype.onServiceEvent=function(e){},e.prototype.getReportableError=function(e){},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"PABinarySendHttpPipeline",(function(){return i}));var r=n(0),o=(n(98),n(64),n(11));var i=function(){function e(e,t){this._pipeline=e,this._binaryResolver=t}return e.prototype.sendHttpAsync=function(e){var t;return __awaiter(this,void 0,Promise,(function(){var n,i,a,s,c,u,p,l,d,f;return __generator(this,(function(y){switch(y.label){case 0:return n=Date.now(),i=e.responseType||"text",(a=function(e){if(null===e.bodyData||void 0===e.bodyData)return null;var t=Object(o.tryGetMimeTypeFromRequestOrResponse)(e);if("string"==typeof e.bodyData)return r.PABinary.createFromText(e.bodyData,t);if(e.bodyData instanceof r.PABinary)return e.bodyData;if(e.bodyData instanceof Blob)return r.PABinary.createFromBlob(e.bodyData,t);if(e.bodyData instanceof ArrayBuffer){if(!t)throw new Error("When bodyData is an ArrayBuffer, there must be a Content-Type header specified.");return r.PABinary.createFromArrayBuffer(e.bodyData,t)}throw new r.NotSupportedError("pipelineRequestBodyToPABinaryOrNull","requestParameters.bodyData has a value which is not supported.")}(e))?e.bodyData=a:delete e.bodyData,e.responseType="pabinary",[4,this._pipeline.sendHttpAsync(e)];case 1:return s=y.sent(),c=Date.now(),u=s.response||null,"appRelativeFile"===(null===(t=null==u?void 0:u.source)||void 0===t?void 0:t.sourceType)&&u.source.relativeUrl&&(p=u.source.relativeUrl),"text"!==i&&"json"!==i?[3,5]:(f=void 0,u?[4,this._binaryResolver.getAsTextAsync(u)]:[3,3]);case 2:return f=y.sent(),[3,4];case 3:f="",y.label=4;case 4:return"json"===i?(s.responseType="text",s.response=s.responseText=f,d=Object(o.parseTextResponseToJsonWithStandardErrors)(s,e.url),delete s.responseText):l=s.responseText=f,[3,12];case 5:return u?[3,6]:[3,12];case 6:return"pabinary"!==i?[3,7]:(l=u,p="",[3,12]);case 7:return"arraybuffer"!==i?[3,9]:[4,this._binaryResolver.getAsArrayBufferAsync(u)];case 8:return l=y.sent(),[3,12];case 9:return"blob"!==i?[3,11]:[4,this._binaryResolver.getAsBlobAsync(u)];case 10:return l=y.sent(),[3,12];case 11:throw new r.InvalidOperationError("PABinarySendHttpPipeline.sendHttpAsync","requestedResponseType '".concat(i,"' is not supported."));case 12:return void 0!==l?s.response=l:void 0!==d?s.response=d:delete s.response,s.responseType=i,p&&Object(r.tryDeleteAppRelativeFileAsync)(p),Object(o.addSendHttpPipelinePerf)("PABinarySendHttpPipeline",s,n,c,Date.now()),[2,s]}}))}))},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"AppDraft",(function(){return r}));var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n(15).AppInfo)},function(e,t,n){"use strict";n.r(t),n.d(t,"AppInfoParserError",(function(){return o}));var r=n(0),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(r.ApplicationError)},function(e,t,n){"use strict";n.r(t),n.d(t,"generate",(function(){return i}));var r=n(0),o=n(16);function i(e,t,n,i,a,s){var c=e,u=Object(r.CoreUtility_formatString)(Player.Strings.ShareConnectionRequestSubject,n),p="".concat(Player.Strings.ShareConnectionRequestBodyLine1,"\r\n")+"".concat(Object(r.CoreUtility_formatString)(Player.Strings.ShareConnectionRequestBodyLine2,a,n),"\r\n")+"".concat(Object(r.CoreUtility_formatString)(Player.Strings.ShareConnectionRequestBodyLine3,a),"\r\n")+"".concat(function(e,t){var n=new r.UrlBuilder(o.Region.getCurrentRegion().rawPortalUri);t&&n.appendPath("environments/".concat(t));var i=e.split("/"),a=i[i.length-1],s=i[i.length-3];return n.appendPath("connections/".concat(s,"/").concat(a,"/share")),n.toString()}(i,s),"\r\n")+"".concat(n,"\r\n")+"".concat(function(e,t){var n=new r.UrlBuilder(o.Region.getCurrentRegion().rawPortalUri);t&&n.appendPath("environments/".concat(t));return n.appendPath("apps/".concat(e,"/details")),n.toString()}(t,s));return"mailto:".concat(encodeURIComponent(c),"?subject=").concat(encodeURIComponent(u),"&body=").concat(encodeURIComponent(p))}},function(e,t,n){"use strict";var r;n.r(t),n.d(t,"PackageStatus",(function(){return r})),n.d(t,"ListAppPackageOperationDetails",(function(){return o})),function(e){e[e.Ready=0]="Ready",e[e.InProgress=1]="InProgress",e[e.Error=2]="Error"}(r||(r={}));var o=function(){function e(e,t,n,r,o,i,a){this._rawListAppPackageOperationDetails=e,this._appPackageDetails=t,this._nestedAppsPackageDetails=n,this._packageReturnUri=r,this._retryAfter=o,this._packageStatus=i,this._error=a}return Object.defineProperty(e.prototype,"rawListAppPackageOperationDetails",{get:function(){return this._rawListAppPackageOperationDetails},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appPackageDetails",{get:function(){return this._appPackageDetails},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nestedAppsPackageDetails",{get:function(){return this._nestedAppsPackageDetails},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"packageReturnUri",{get:function(){return this._packageReturnUri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"retryAfter",{get:function(){return this._retryAfter},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"packageStatus",{get:function(){return this._packageStatus},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this._error},enumerable:!1,configurable:!0}),e.parse=function(t){var n=this._getPackageStatus(t.packageStatus),r=this._getRetryAfter(t.retryAfter);return new e(t,t.appPackageDetails,t.nestedAppsPackageDetails,t.packageReturnUri,r,n,t.error)},e.prototype.serializeToJson=function(){return this._rawListAppPackageOperationDetails},e._getPackageStatus=function(e){return"Ready"===e?r.Ready:"InProgress"===e?r.InProgress:"Error"===e?r.Error:void 0},e._getRetryAfter=function(e){return+e.match("/d+/g")},e}()},function(e,t,n){"use strict";var r;n.r(t),n.d(t,"ProcessorCode",(function(){return r})),function(e){e[e.MaxItemsExceeded=0]="MaxItemsExceeded"}(r||(r={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"QueryRequestParam",(function(){return r}));n(0);var r=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}return __extends(t,e),t.prototype._applyValue=function(e,t){e.addQueryParameter(this.paramName,t)},t}(n(73).NamedHttpRequestParam)},function(e,t,n){"use strict";n.r(t),n.d(t,"ResourceBaseUrlRequestParam",(function(){return o}));var r=n(0),o=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype._convertFromDValueAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){return[2,e]}))}))},t.prototype._applyValue=function(e,t){if(!Object(r.isString)(t))throw new Error("ResourceBaseUrlRequestParam expects a string value.");var n=new r.Core_Url(t);if(!n.isAbsolute)throw new Error("ResourceBaseUrlRequestParam expects an absolute url value.");e.setBaseUrl(n)},t}(n(90).RequestParamBase)},function(e,t,n){"use strict";n.r(t),n.d(t,"DocumentResponseProcessor",(function(){return u}));n(0);var r=n(3),o=(n(64),n(31)),i=n(216),a=n(62),s=n(71),c=n(11),u=function(e){function t(t){return e.call(this,"text",null,t)||this}return __extends(t,e),t.prototype.processResponse=function(e){var t=Object(c.parseXmlFromStringWithErrorDetection)(e.responseText,r.MediaType.ApplicationXml);if(!t.success)throw new s.SendHttpErrorWithResponse(AppMagic.Strings.RestErrorUnableToParseXml,e);var n=t.result,i=Object(a.a)(o.ResponseValueType.Document,n);return this.processResponseValueExtractors(i)},t}(i.a)},function(e,t,n){"use strict";n.r(t),n.d(t,"JsonResponseParam",(function(){return c}));var r=n(0),o=n(31),i=n(62),a=n(11),s=(n(7),n(12)),c=function(){function e(e,t){this._jsonpointer=e,this._typeRef=t}return e.prototype.computeDValueSchema=function(e){return this._typeRef.getType().computeDValueSchema(e)},e.prototype.getValue=function(e){var t=Object(s.j)(e.value,this._jsonpointer);if(!t.success)return Object(a.createSuccessfulDataflowResult)(Object(i.a)(o.ResponseValueType.DValue,null));var n=t.value;if(Object(r.isUndefined)(n))return Object(a.createSuccessfulUndefinedDataflowResult)();var c=this._typeRef.getType().convertToDValue(n);return Object(a.createSuccessfulDataflowResult)(Object(i.a)(o.ResponseValueType.DValue,c))},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"ResponseBodyExtractor",(function(){return a}));var r=n(0),o=n(31),i=n(11),a=function(){function e(e,t){this._expectedTBodyType=e,this._typeRef=t}return e.prototype.computeDValueSchema=function(e){return Object(r.checkNonNull)(this._typeRef,"DValue schema may only be computed when a type has been specified."),this._typeRef.getType().computeDValueSchema(e)},e.prototype.getValue=function(e){if(null===this._typeRef)return Object(i.createSuccessfulDataflowResult)(e);var t=this._typeRef.getType().convertToDValue(e.value),n={type:o.ResponseValueType.DValue,value:t};return Object(i.createSuccessfulDataflowResult)(n)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"ResponseHeaderParam",(function(){return a}));n(0);var r=n(31),o=n(62),i=n(11),a=(n(7),function(){function e(e,t){this._headerName=e,this._typeRef=t}return e.prototype.computeDValueSchema=function(e){return this._typeRef.getType().computeDValueSchema(e)},e.prototype.getValue=function(e){var t=e.value.getResponseHeader(this._headerName);if(null===t)return Object(i.createSuccessfulUndefinedDataflowResult)();var n=this._typeRef.getType().convertToDValue(t);return Object(i.createSuccessfulDataflowResult)(Object(o.a)(r.ResponseValueType.DValue,n))},e}())},function(e,t,n){"use strict";n.r(t),n.d(t,"ResponseTypeResponseProcessor",(function(){return i}));var r=n(0),o=(n(64),n(31)),i=function(e){function t(t,n,o){return void 0===o&&(o=Object(r.HashTableUtility_create)()),e.call(this,t,n,o)||this}return __extends(t,e),t.prototype.processResponse=function(e){var t,n;switch(this.responseType){case"text":t=o.ResponseValueType.Text,n=e.responseText;break;case"json":t=o.ResponseValueType.Json,n=e.response;break;case"blob":case"pabinary":t=o.ResponseValueType.BinaryData,n=e.response||null;break;default:throw new r.NotSupportedError("ResponseTypeResponseProcessor.processResponse","The responseType is not supported: "+this.responseType)}var i={type:t,value:n};return this.processResponseValueExtractors(i)},t}(n(216).a)},function(e,t,n){"use strict";n.r(t),n.d(t,"RestClient",(function(){return r}));n(0),n(99);var r=function(){function e(e){this._httpClient=e}return e.prototype.sendRestAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var n,r;return __generator(this,(function(o){switch(o.label){case 0:return n=t.xhrResponseType,[4,this._httpClient.sendHttpAsync(e,n)];case 1:return r=o.sent(),[2,t.processXhr(r)]}}))}))},e.prototype.sendUnprocessedRestAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(n){switch(n.label){case 0:return[4,this._httpClient.sendHttpAsync(e,t)];case 1:return[2,n.sent()]}}))}))},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"XmlAsJsonResponseProcessor",(function(){return p}));var r=n(0),o=(n(64),n(31)),i=n(216),a=n(62),s=n(71),c=n(11),u=n(104),p=function(e){function t(t){return e.call(this,"text",t,Object(r.HashTableUtility_create)())||this}return __extends(t,e),t.prototype.processResponse=function(e){var t=this.parseXml2Json(e);if(!t.success)throw new s.SendHttpErrorWithResponse(AppMagic.Strings.RestErrorUnableToParseXml2Json,e);var n=t.value,r=Object(a.a)(o.ResponseValueType.XmlAsJson,n);return this.processResponseValueExtractors(r)},t.prototype.parseXml2Json=function(e){if(Object(r.isEmptyString)(e.responseText))return Object(c.createSuccessfulDataflowResult)({});if(e.responseText.length>0)try{var t=Object(u.xml2json)(e.responseText);return Object(c.createSuccessfulDataflowResult)(t)}catch(e){}return Object(c.createUnsuccessfulDataflowResult)()},t}(i.a)},function(e,t,n){"use strict";n.r(t),n.d(t,"XPathResponseParam",(function(){return c}));n(0);var r=n(31),o=n(62),i=n(11),a=(n(7),n(10)),s=n(186),c=function(){function e(e,t,n){this._xpath=e,this._selectAllNodes=t,this._nodeTypeRef=n}return e.prototype.computeDValueSchema=function(e){return this._selectAllNodes?Object(a.computeDValueSchemaForArrayTType)(this._nodeTypeRef,e):this._nodeTypeRef.getType().computeDValueSchema(e)},e.prototype.getValue=function(e){var t=e.value,n=s.XmlSelection.selectNodes(t,this._xpath),c=this._nodeTypeRef.getType();if(this._selectAllNodes){var u=Object(a.convertArrayOfTItemsToDTable)(n,c);return Object(i.createSuccessfulDataflowResult)(Object(o.a)(r.ResponseValueType.DValue,u))}if(0===n.length)return Object(i.createSuccessfulUndefinedDataflowResult)();var p=c.convertToDValue(n[0]);return Object(i.createSuccessfulDataflowResult)(Object(o.a)(r.ResponseValueType.DValue,p))},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"ClientSettings",(function(){return r}));n(0);var r=function(){function e(){this._singleSignOnEnabled=!0}return Object.defineProperty(e.prototype,"singleSignOnEnabled",{get:function(){return this._singleSignOnEnabled},set:function(e){this._singleSignOnEnabled=e},enumerable:!1,configurable:!0}),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"IdentityService",(function(){return a}));var r=n(0),o=n(120),i=n(112),a=function(){function e(e){this._authenticationManager=e,this._connectionStatus=i.ConnectionStatus.Disconnected,this._connectionStatusChangeEvent=new r.EventObject,this._identityChangeEvent=new r.EventObject}return Object.defineProperty(e.prototype,"loadError",{get:function(){return this._loadError},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConnected",{get:function(){return this._connectionStatus!==i.ConnectionStatus.Disconnected},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectionStatusChangeEvent",{get:function(){return this._connectionStatusChangeEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"identityChangeEvent",{get:function(){return this._identityChangeEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasIdentity",{get:function(){return!!this._userIdentity},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"identity",{get:function(){return this.getConnectedIdentity()},enumerable:!1,configurable:!0}),e.prototype.getConnectedIdentity=function(){if(!this._userIdentity)throw new Error("Invalid use of identity. Use the hasIdentity property to verify if user is logged in or not.");return this._userIdentity},e.prototype.logInAsync=function(e){var t=this;return Object(r.wrapWithFinally)(this._authenticationManager.logInProvider.authenticateSilentAsync(e).then(null,(function(n){return t._authenticateAndLogInAsync(e)})),(function(){return t._updateConnectionStatusAndIdentity(t._authenticationManager.logInProvider)}))},e.prototype.loadAsync=function(){var e=this,t=this.hasIdentity?{emailAddress:this.identity.email,objectId:this.identity.objectId,tenantId:this.identity.tenantId}:void 0;return this._authenticationManager.logInProvider.authenticateSilentAsync(t).catch((function(t){r.CoreLog.warning("IdentityService.loadAsync",t,"No user is logged in."),e._loadError=t})).then((function(){return e._updateConnectionStatusAndIdentity(e._authenticationManager.logInProvider)}))},e.prototype.logOutAsync=function(){var e=this;return this._authenticationManager.logInProvider.logOutSharedStateAsync().then((function(){return e._updateConnectionStatusAndIdentity(e._authenticationManager.logInProvider),r.Log.trackEvent(r.azureLogOutAsync,{}),!0}))},e.prototype.dispose=function(){this._connectionStatusChangeEvent.dispose()},e.prototype.refreshIdentityServiceAsync=function(){var e=this;return this.logOutAsync().then((function(){e._authenticationManager.refreshProviders()}))},e.prototype.switchTenant=function(){this._authenticationManager.logInProvider.clearUserIdentity(),this._updateConnectionStatusAndIdentity(this._authenticationManager.logInProvider),r.Log.trackActivityEvent(r.azureSwitchTenant,{})},e.prototype._authenticateAndLogInAsync=function(e){return this._authenticationManager.logInProvider.authenticateAsync(e).then((function(){r.Log.trackEvent(r.azureLogInAsyncHTTPRequestResult,{result:!0})}),(function(e){return r.Log.trackEvent(r.azureLogInAsyncHTTPRequestResult,{result:!1}),Promise.reject(e)}))},e.prototype._updateConnectionStatusAndIdentity=function(e){var t=this._updateConnectionStatus(e);this._updateIdentity(e)&&this._identityChangeEvent.dispatch(),t&&this._connectionStatusChangeEvent.dispatch(this._connectionStatus)},e.prototype._updateConnectionStatus=function(e){var t;return t=null===e.store.identityToken?i.ConnectionStatus.Disconnected:i.ConnectionStatus.Connected,this._connectionStatus!==t&&(this._connectionStatus=t,!0)},e.prototype._updateIdentity=function(e){var t=e.store.identityToken;if(null===t){if(this._userIdentity)return this._userIdentity=null,!0}else{var n=o.UserIdentity.fromJsonWebToken(t);if(!this._userIdentity||n.objectId!==this._userIdentity.objectId)return this._userIdentity=n,!0}return!1},__decorate([initializeOnLoad((function(){return Object(r.createFromClass)(e)}))],e,"singletonKey",void 0),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"SendHttpPipelineProvider",(function(){return i}));var r=n(0),o=n(11),i=function(){function e(e){this._lazyPipeline=new r.AsyncLazy("SendHttpPipelineProvider._lazyPipeline",e)}return e.prototype.dispose=function(){this._lazyPipeline.dispose()},e.prototype.sendHttpAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n;return __generator(this,(function(r){switch(r.label){case 0:return[4,this._lazyPipeline.valueAsync()];case 1:return[4,r.sent().sendHttpAsync(e)];case 2:return(t=r.sent()).status>=200&&t.status<=299?[2,Promise.resolve(t)]:[3,3];case 3:return[4,Object(o.createSendHttpErrorWithResponseAsync)(t,e.url)];case 4:return n=r.sent(),[2,Promise.reject(n)]}}))}))},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"ServiceVariable",(function(){return o}));n(0);var r=n(5),o=function(){function e(e,t){this._name=e,this._dtype=t}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dtype",{get:function(){return this._dtype},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._dtype===r.TypeString||this._dtype===r.TypeBoolean||this._dtype===r.TypeNumber||(this._dtype,r.TypeHyperlink),this._value=e},enumerable:!1,configurable:!0}),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"TemplateRequestParam",(function(){return r}));var r=function(e){function t(t,n,r,o,i){var a=e.call(this,n,r,o)||this;return a._pathIndex=t,a._useDoubleEncoding=i,a}return __extends(t,e),t.prototype._applyValue=function(e,t){e.addTemplateToPath(this._pathIndex,this.paramName,this._useDoubleEncoding?Core.Url.encode(t):t)},t}(n(73).NamedHttpRequestParam)},function(e,t,n){"use strict";n.r(t),n.d(t,"DomNodeTType",(function(){return i}));var r=n(0),o=n(7),i=function(){function e(e){this._valueTTypeRef=e}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return o.TTypeValueKind.DomNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return this._valueTTypeRef.getType().computeDValueSchema(e)},e.prototype.convertFromDValue=function(e){throw new r.NotSupportedError("DomNodeTType.convertFromDValue")},e.prototype.convertToDValue=function(e,t){if(null===e)return null;if(!(e instanceof Node))return AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null});var n=e;return this._valueTTypeRef.getType().convertToDValue(n.textContent)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"HttpStringTType",(function(){return i}));var r=n(5),o=n(7),i=function(){function e(){}return Object.defineProperty(e.prototype,"TTypeValueKind",{get:function(){return o.TTypeValueKind.String},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRecordDType",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConvertFromDValueAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.computeDValueSchema=function(e){return Object(r.createSchemaForSimple)(r.TypeString)},e.prototype.convertFromDValue=function(e){return e},e.prototype.convertToDValue=function(e,t){return null===e?null:"string"!=typeof e?AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.ConstraintViolated,AppMagic.Data.ErrorSeverity.Severe,AppMagic.Strings.NetworkErrorInvalidResponse,{errorContext:{entityName:"",id:-1,propertyName:null==t?void 0:t.propertyName},errorMessage:AppMagic.Strings.NetworkErrorInvalidResponse,raiseToastNotification:!1,wasReported:!1,functionName:null}):e},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"DeviceCapabilityConsentSerializer",(function(){return o}));var r=n(0),o=function(){function e(e){this._settingProvider=e}return e.getKey=function(e){return"capabilitiesrequiredconsent_"+e},e.prototype.getConsentedCapabilitiesAsync=function(t){return this._settingProvider.getValue(e.getKey(t))},e.prototype.removeConsentedCapabilitiesAsync=function(t){return this._settingProvider.removeValue(e.getKey(t)),this._saveSettingProviderAsync()},e.prototype.setConsentedCapabilitiesAsync=function(t,n){var o=this._settingProvider.getValue(e.getKey(t));return o&&Object(r.isArray)(o)&&n.concat(o),this._settingProvider.setValue(e.getKey(t),n),this._saveSettingProviderAsync()},e.prototype._saveSettingProviderAsync=function(){return this._settingProvider.save().then((function(e){e||r.CoreLog.error("DeviceCapabilityConsentSerializer._saveSettingProviderAsync","Could not save setting provider successfully.")}),(function(e){r.CoreLog.error("DeviceCapabilityConsentSerializer._saveSettingProviderAsync",e)}))},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"UserServiceHelper",(function(){return r}));var r=function(){function e(){}return e.getCanvasAppInsightsEnabledAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n;return __generator(this,(function(r){switch(r.label){case 0:return[4,e.getTenantSettingsAsync()];case 1:return t=r.sent(),["powerPlatform","powerApps","enableCanvasAppInsights"].every((function(e){var r=t[e];if("boolean"==typeof r)n=r;else if("string"==typeof r||"number"==typeof r)Core.Log.error("UserServiceHelper.getCanvasAppInsightsEnabledAsync","Get unexpected value for enableCanvasAppInsights: ".concat(r)),n=void 0;else if(r)return t=r,!0;return!1})),[2,void 0===n||n]}}))}))},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"xhr",(function(){return i}));n(0);var r,o=n(173);function i(e){return r||(r=o.factory.createXmlHttpRequestSender()),r.xhr(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),o=n(45),i=n(289),a=n(70),s=function(e){function t(t,n){var r=this;return(r=e.call(this)||this)._store=t,r._authenticationContext=n,r}return __extends(t,e),Object.defineProperty(t.prototype,"authenticationContext",{get:function(){return this._authenticationContext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"store",{get:function(){return this._store},enumerable:!1,configurable:!0}),t.prototype._saveTokenResponseAsync=function(e){var t=this;return Promise.resolve().then((function(){var n=a.JsonWebToken.parse(e.idToken);return null===i.a.safeCast(n.payload)?(r.Log.trackErrorEvent("TokenAcquirerBase._saveTokenResponseAsync",{message:"Failed to parse identity token"}),t._authenticationContext.logOutAsync().then((function(){throw new o.AuthenticationError(o.AuthenticationErrorKind.InvalidIdToken,"Failed to safe cast the jsonWebToken.payload.")}))):(t._store.accessToken=e.accessToken,t._store.identityToken=e.idToken,t._store.expiresOn=e.expiresOn,t._store.fromCache=e.fromCache,Object(r.verbose)(Object(r.CoreUtility_formatString)("[TokenAcquirerBase._saveTokenResponseAsync] Adal token credentials extracted and stored.")),e.accessToken)}))},t.prototype.tryGetResource=function(){var e=this.store.accessToken;return e?{success:!0,result:e}:{success:!1,result:null}},t}(n(158).ResourceAcquirerBase)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r,o=n(0);!function(e){function t(e){if(!Object(o.isObject)(e))return o.Log.trackActivityEvent("IdentityToken.isValid",{message:"idToken is not valid because it is not an object"}),!1;var t=Object(o.isString)(e.oid)&&Object(o.isString)(e.tid)&&Object(o.isStringOrUndefined)(e.given_name)&&Object(o.isStringOrUndefined)(e.family_name)&&(Object(o.isStringOrUndefined)(e.unique_name)||Object(o.isStringOrUndefined)(e.preferred_username))&&Object(o.isStringOrUndefined)(e.idp)&&Object(o.isString)(e.iss)&&Object(o.isStringOrUndefined)(e.name);if(!t){var n=[];Object(o.isString)(e.oid)||n.push("oid"),Object(o.isString)(e.tid)||n.push("tid"),Object(o.isStringOrUndefined)(e.given_name)||n.push("given_name"),Object(o.isStringOrUndefined)(e.family_name)||n.push("family_name"),Object(o.isStringOrUndefined)(e.unique_name)||n.push("unique_name"),Object(o.isStringOrUndefined)(e.preferred_username)||n.push("preferred_username"),Object(o.isStringOrUndefined)(e.idp)||n.push("idp"),Object(o.isString)(e.iss)||n.push("iss"),Object(o.isStringOrUndefined)(e.name)||n.push("name"),o.Log.trackActivityEvent("IdentityToken.isValid",{invalidIdTokenProperties:n})}return t}e.safeCast=function(e){return t(e)?e:null},e.isValid=t}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r,o=n(0),i=n(22),a=n(48),s=n(2),c=n(25),u=n(13);!function(e){e.RegionName="rx",e.endpointTitle="USSec",e.powerAppsRedirectUri=new o.Core_Url(""),e.authUri=new o.Core_Url("https://login.microsoftonline.microsoft.scloud/common/"),e.powerAppsServiceResource="https://service.powerapps.microsoft.scloud/",e.flowsResource="https://service.flow.microsoft.scloud/",e.webAuthResource="0f40a980-028e-4214-b21b-21f5eda7a68d",e.powerBIServiceResource="https://analysis.microsoft.scloud/powerbi/api",e.apiHubRuntimeAudience="https://azure-apihub.microsoft.scloud",e.consentServerResource=e.apiHubRuntimeAudience,e.flowRPEndpoint=new o.Core_Url("https://api.flow.microsoft.scloud"),e.flowPortalEndpoint=new o.Core_Url("https://portal.flow.microsoft.scloud"),e.docServerEndpoint=new o.Core_Url("https://create.powerapps.microsoft.scloud/");var t=new o.Core_Url("https://aka.microsoft.scloud/fwlink/?linkid=2160890"),n=new o.Core_Url("https://aka.microsoft.scloud/fwlink/?linkid=2161028");function r(){return new o.Core_Url("https://api.powerapps.microsoft.scloud")}function p(){return s.PowerAppEndpoints.getApiVersion()}e.ecsHostResource="https://config.ecs.teams.microsoft.scloud",e.neptuneResource="https://licensing.powerplatform.microsoft.scloud/",e.neptuneAudience="https://licensing.powerplatform.microsoft.scloud/auth",e.getPowerAppsRpBaseUrl=r,e.getApiVersionValue=p,e.getCdmRpApiVersionValue=function(){return s.PowerAppEndpoints.getCdmRpApiVersion()},e.portalEndPoint=new o.Core_Url("https://make.powerapps.microsoft.scloud/"),e.appDownloadRootEndPoint=new o.Core_Url("https://apps.powerapps.microsoft.scloud/open/"),e.playerResourcesEndpoint=new o.Core_Url(""),e.consumerPortalEndPoint=new o.Core_Url("https://aka.microsoft.scloud/fwlink/?LinkId=2161029"),e.webPlayerSignUpEndPoint=new o.Core_Url("https://aka.microsoft.scloud/fwlink/?LinkId=2160938"),e.webPlayerConsentEndPoint=new o.Core_Url("https://aka.microsoft.scloud/fwlink/?LinkId=2161102"),e.webAuthoringSignUpEndPoint=new o.Core_Url("https://aka.microsoft.scloud/fwlink/?LinkId=2160939"),e.InstallGatewayLinkUrl=new o.Core_Url("https://aka.microsoft.scloud/fwlink/?LinkID=2160891"),e.InstallVNetGatewayLinkUrl=new o.Core_Url("https://TODO"),e.microsoftGraphEndpoint=new o.Core_Url("https://graph.microsoft.scloud/"),e.microsoftGraphResource="https://graph.microsoft.scloud/",e.cesFeedbackEndpoint="",e.getValues=function(){var l=c.a.getValues();return l.name=e.RegionName,l.clusterCategory="rx",l.endpointTitle=e.endpointTitle,l.portalUri=e.portalEndPoint,l.appDownloadRootUri=e.appDownloadRootEndPoint,l.consumerPortalUri=e.consumerPortalEndPoint,l.powerAppsRpBaseUrl=r(),l.powerAppsApiVersion=p(),l.powerPlatformRpBaseUrl=Object(u.b)(l.clusterCategory),l.powerPlatformRpApiVersion=s.PowerAppEndpoints.powerPlatformApiVersion,l.powerPlatformResource=Object(u.e)(l.clusterCategory),l.powerPlatformTenantBaseUrl=Object(u.d)(l.clusterCategory),l.powerPlatformEnvironmentBaseUrl=Object(u.c)(l.clusterCategory),l.bapBaseUrl=i.BapEndpoints.Rx.getBaseUrl(),l.bapApiVersion=i.BapEndpoints.Rx.getApiVersionValue(),l.cdsApiVersion="",l.cdsBaseUrl=new o.Core_Url(""),l.clientConsentEndPoint=c.a.getClientConsentEndPoint(t,n),l.webPlayerSignUpEndPoint=e.webPlayerSignUpEndPoint,l.webPlayerConsentEndPoint=e.webPlayerConsentEndPoint,l.webAuthoringSignUpEndPoint=e.webAuthoringSignUpEndPoint,l.gcmSenderId="",l.intelligenceStudioBaseUrl=a.IntelligenceEndpoints.Rx.intelligenceStudioBaseUrl,l.playerResourcesEndpoint=e.playerResourcesEndpoint,l.docServerEndpoint=e.docServerEndpoint,l.powerAppsServiceResource=e.powerAppsServiceResource,l.logInResource=e.powerAppsServiceResource,l.authUri=e.authUri,l.flowsResource=e.flowsResource,l.webAuthResource=e.webAuthResource,l.powerBIServiceResource=e.powerBIServiceResource,l.apiHubRuntimeAudience=e.apiHubRuntimeAudience,l.consentServerResource=e.consentServerResource,l.microsoftGraphEndpoint=e.microsoftGraphEndpoint,l.microsoftGraphResource=e.microsoftGraphResource,l.powerAppsBadBaseUrl=null,l.powerAppsBadApiVersion=null,l.cesFeedbackEndpoint=e.cesFeedbackEndpoint,l.flowRpBaseUrl=e.flowRPEndpoint,l.flowPortalBaseUrl=e.flowPortalEndpoint,l.ecsHostResource=e.ecsHostResource,l.neptuneResource=e.neptuneResource,l.neptuneAudience=e.neptuneAudience,l}}(r||(r={}))},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){var r;!function(o,i){"use strict";var a="model",s="name",c="type",u="vendor",p="version",l="mobile",d="tablet",f="smarttv",y=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},m=function(e,t){return"string"==typeof e&&-1!==g(t).indexOf(g(e))},g=function(e){return e.toLowerCase()},v=function(e,t){if("string"==typeof e)return e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),void 0===t?e:e.substring(0,350)},b=function(e,t){for(var n,r,o,i,a,s,c=0;c<t.length&&!a;){var u=t[c],p=t[c+1];for(n=r=0;n<u.length&&!a;)if(a=u[n++].exec(e))for(o=0;o<p.length;o++)s=a[++r],"object"==typeof(i=p[o])&&i.length>0?2===i.length?"function"==typeof i[1]?this[i[0]]=i[1].call(this,s):this[i[0]]=i[1]:3===i.length?"function"!=typeof i[1]||i[1].exec&&i[1].test?this[i[0]]=s?s.replace(i[1],i[2]):void 0:this[i[0]]=s?i[1].call(this,s,i[2]):void 0:4===i.length&&(this[i[0]]=s?i[3].call(this,s.replace(i[1],i[2])):void 0):this[i]=s||void 0;c+=2}},h=function(e,t){for(var n in t)if("object"==typeof t[n]&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(m(t[n][r],e))return"?"===n?void 0:n}else if(m(t[n],e))return"?"===n?void 0:n;return e},A={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},C={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[p,[s,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[p,[s,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[s,p],[/opios[\/ ]+([\w\.]+)/i],[p,[s,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[p,[s,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[s,p],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[p,[s,"UCBrowser"]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[p,[s,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[p,[s,"WeChat"]],[/konqueror\/([\w\.]+)/i],[p,[s,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[p,[s,"IE"]],[/yabrowser\/([\w\.]+)/i],[p,[s,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[s,/(.+)/,"$1 Secure Browser"],p],[/\bfocus\/([\w\.]+)/i],[p,[s,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[p,[s,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[p,[s,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[p,[s,"Dolphin"]],[/coast\/([\w\.]+)/i],[p,[s,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[p,[s,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[p,[s,"Firefox"]],[/\bqihu|(qi?ho?o?|360)browser/i],[[s,"360 Browser"]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[s,/(.+)/,"$1 Browser"],p],[/(comodo_dragon)\/([\w\.]+)/i],[[s,/_/g," "],p],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[s,p],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[s],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[s,"Facebook"],p],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[s,p],[/\bgsa\/([\w\.]+) .*safari\//i],[p,[s,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[p,[s,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[s,"Chrome WebView"],p],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[p,[s,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[s,p],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[p,[s,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[p,s],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[s,[p,h,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[s,p],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[s,"Netscape"],p],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[p,[s,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[s,p]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",g]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[["architecture","arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[["architecture","armhf"]],[/windows (ce|mobile); ppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[["architecture",/ower/,"",g]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[["architecture",g]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[a,[u,"Samsung"],[c,d]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[a,[u,"Samsung"],[c,l]],[/\((ip(?:hone|od)[\w ]*);/i],[a,[u,"Apple"],[c,l]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[a,[u,"Apple"],[c,d]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[a,[u,"Huawei"],[c,d]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[a,[u,"Huawei"],[c,l]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[a,/_/g," "],[u,"Xiaomi"],[c,l]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[a,/_/g," "],[u,"Xiaomi"],[c,d]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[a,[u,"OPPO"],[c,l]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[a,[u,"Vivo"],[c,l]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[a,[u,"Realme"],[c,l]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[a,[u,"Motorola"],[c,l]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[a,[u,"Motorola"],[c,d]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[a,[u,"LG"],[c,d]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[a,[u,"LG"],[c,l]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[a,[u,"Lenovo"],[c,d]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[a,/_/g," "],[u,"Nokia"],[c,l]],[/(pixel c)\b/i],[a,[u,"Google"],[c,d]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[a,[u,"Google"],[c,l]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[a,[u,"Sony"],[c,l]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[a,"Xperia Tablet"],[u,"Sony"],[c,d]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[a,[u,"OnePlus"],[c,l]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[a,[u,"Amazon"],[c,d]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[a,/(.+)/g,"Fire Phone $1"],[u,"Amazon"],[c,l]],[/(playbook);[-\w\),; ]+(rim)/i],[a,u,[c,d]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[a,[u,"BlackBerry"],[c,l]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[a,[u,"ASUS"],[c,d]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[a,[u,"ASUS"],[c,l]],[/(nexus 9)/i],[a,[u,"HTC"],[c,d]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony(?!-bra))[-_ ]?([-\w]*)/i],[u,[a,/_/g," "],[c,l]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[a,[u,"Acer"],[c,d]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[a,[u,"Meizu"],[c,l]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[a,[u,"Sharp"],[c,l]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[u,a,[c,l]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[u,a,[c,d]],[/(surface duo)/i],[a,[u,"Microsoft"],[c,d]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[a,[u,"Fairphone"],[c,l]],[/(u304aa)/i],[a,[u,"AT&T"],[c,l]],[/\bsie-(\w*)/i],[a,[u,"Siemens"],[c,l]],[/\b(rct\w+) b/i],[a,[u,"RCA"],[c,d]],[/\b(venue[\d ]{2,7}) b/i],[a,[u,"Dell"],[c,d]],[/\b(q(?:mv|ta)\w+) b/i],[a,[u,"Verizon"],[c,d]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[a,[u,"Barnes & Noble"],[c,d]],[/\b(tm\d{3}\w+) b/i],[a,[u,"NuVision"],[c,d]],[/\b(k88) b/i],[a,[u,"ZTE"],[c,d]],[/\b(nx\d{3}j) b/i],[a,[u,"ZTE"],[c,l]],[/\b(gen\d{3}) b.+49h/i],[a,[u,"Swiss"],[c,l]],[/\b(zur\d{3}) b/i],[a,[u,"Swiss"],[c,d]],[/\b((zeki)?tb.*\b) b/i],[a,[u,"Zeki"],[c,d]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[u,"Dragon Touch"],a,[c,d]],[/\b(ns-?\w{0,9}) b/i],[a,[u,"Insignia"],[c,d]],[/\b((nxa|next)-?\w{0,9}) b/i],[a,[u,"NextBook"],[c,d]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[u,"Voice"],a,[c,l]],[/\b(lvtel\-)?(v1[12]) b/i],[[u,"LvTel"],a,[c,l]],[/\b(ph-1) /i],[a,[u,"Essential"],[c,l]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[a,[u,"Envizen"],[c,d]],[/\b(trio[-\w\. ]+) b/i],[a,[u,"MachSpeed"],[c,d]],[/\btu_(1491) b/i],[a,[u,"Rotor"],[c,d]],[/(shield[\w ]+) b/i],[a,[u,"Nvidia"],[c,d]],[/(sprint) (\w+)/i],[u,a,[c,l]],[/(kin\.[onetw]{3})/i],[[a,/\./g," "],[u,"Microsoft"],[c,l]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[a,[u,"Zebra"],[c,d]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[a,[u,"Zebra"],[c,l]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[u,a,[c,"console"]],[/droid.+; (shield) bui/i],[a,[u,"Nvidia"],[c,"console"]],[/(playstation [345portablevi]+)/i],[a,[u,"Sony"],[c,"console"]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[a,[u,"Microsoft"],[c,"console"]],[/smart-tv.+(samsung)/i],[u,[c,f]],[/hbbtv.+maple;(\d+)/i],[[a,/^/,"SmartTV"],[u,"Samsung"],[c,f]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[u,"LG"],[c,f]],[/(apple) ?tv/i],[u,[a,"Apple TV"],[c,f]],[/crkey/i],[[a,"Chromecast"],[u,"Google"],[c,f]],[/droid.+aft(\w)( bui|\))/i],[a,[u,"Amazon"],[c,f]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[a,[u,"Sharp"],[c,f]],[/(bravia[\w ]+)( bui|\))/i],[a,[u,"Sony"],[c,f]],[/(mitv-\w{5}) bui/i],[a,[u,"Xiaomi"],[c,f]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[u,v],[a,v],[c,f]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[c,f]],[/((pebble))app/i],[u,a,[c,"wearable"]],[/droid.+; (glass) \d/i],[a,[u,"Google"],[c,"wearable"]],[/droid.+; (wt63?0{2,3})\)/i],[a,[u,"Zebra"],[c,"wearable"]],[/(quest( 2)?)/i],[a,[u,"Facebook"],[c,"wearable"]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[u,[c,"embedded"]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[a,[c,l]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[a,[c,d]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[c,d]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[c,l]],[/(android[-\w\. ]{0,9});.+buil/i],[a,[u,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[p,[s,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[p,[s,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[s,p],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[p,s]],os:[[/microsoft (windows) (vista|xp)/i],[s,p],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[s,[p,h,A]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[s,"Windows"],[p,h,A]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[p,/_/g,"."],[s,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[s,"Mac OS"],[p,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[p,s],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[s,p],[/\(bb(10);/i],[p,[s,"BlackBerry"]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[p,[s,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[p,[s,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[p,[s,"webOS"]],[/crkey\/([\d\.]+)/i],[p,[s,"Chromecast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[s,"Chromium OS"],p],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[s,p],[/(sunos) ?([\w\.\d]*)/i],[[s,"Solaris"],p],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[s,p]]},P=function(e,t){if("object"==typeof e&&(t=e,e=void 0),!(this instanceof P))return new P(e,t).getResult();var n=e||(void 0!==o&&o.navigator&&o.navigator.userAgent?o.navigator.userAgent:""),r=t?function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n}(C,t):C;return this.getBrowser=function(){var e={name:void 0,version:void 0};return b.call(e,n,r.browser),e.major=function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0}(e.version),e},this.getCPU=function(){var e={architecture:void 0};return b.call(e,n,r.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return b.call(e,n,r.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return b.call(e,n,r.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return b.call(e,n,r.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n="string"==typeof e&&e.length>350?v(e,350):e,this},this.setUA(n),this};P.VERSION="1.0.32",P.BROWSER=y([s,p,"major"]),P.CPU=y(["architecture"]),P.DEVICE=y([a,u,c,"console",l,f,d,"wearable","embedded"]),P.ENGINE=P.OS=y([s,p]),void 0!==t?(void 0!==e&&e.exports&&(t=e.exports=P),t.UAParser=P):n(349)?void 0===(r=function(){return P}.call(t,n,t,e))||(e.exports=r):void 0!==o&&(o.UAParser=P);var w=void 0!==o&&(o.jQuery||o.Zepto);if(w&&!w.ua){var S=new P;w.ua=S.getResult(),w.ua.get=function(){return S.getUA()},w.ua.set=function(e){S.setUA(e);var t=S.getResult();for(var n in t)w.ua[n]=t[n]}}}("object"==typeof window?window:this)},function(e,t,n){n(351),e.exports=n(350)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PowerPlatformApiDiscovery=void 0;var r=function(){function e(e){this.clusterCategory=e}return e.prototype.getTokenAudience=function(){return"https://"+this._getEnvironmentApiHostNameSuffix()},e.prototype.getTenantEndpoint=function(e){return this._generatePowerPlatformApiDomain(e,"tenant")},e.prototype.getEnvironmentEndpoint=function(e){return this._generatePowerPlatformApiDomain(e,"environment")},e.prototype._generatePowerPlatformApiDomain=function(e,t){if(!/^[a-zA-Z0-9\-]+$/g.test(e))throw new Error("Cannot generate Power Platform API endpoint because the "+t+" identifier contains invalid host name characters, only alphanumeric and dash characters are expected: "+e);var n=this._getHexApiSuffixLength(),r=e.toLowerCase().replace(/-/g,"");if(n>=r.length)throw new Error("Cannot generate Power Platform API endpoint because the normalized "+t+" identifier must be at least "+(n+1)+" characters in length: "+r);var o=r.substring(r.length-n);return r.substring(0,r.length-n)+"."+o+"."+t+"."+this._getEnvironmentApiHostNameSuffix()},e.prototype._getHexApiSuffixLength=function(){switch(this.clusterCategory){case"firstrelease":case"prod":return 2;default:return 1}},e.prototype._getEnvironmentApiHostNameSuffix=function(){switch(this.clusterCategory){case"local":return"api.powerplatform.localhost";case"dev":return"api.dev.powerplatform.com";case"test":return"api.test.powerplatform.com";case"preprod":return"api.preprod.powerplatform.com";case"firstrelease":case"prod":return"api.powerplatform.com";case"gov":return"api.gov.powerplatform.microsoft.us";case"high":return"api.high.powerplatform.microsoft.us";case"dod":return"api.appsplatform.us";case"mooncake":return"api.powerplatform.partner.microsoftonline.cn";case"ex":return"api.powerplatform.eaglex.ic.gov";case"rx":return"api.powerplatform.microsoft.scloud";default:throw new Error("Invalid ClusterCategory value: "+this.clusterCategory)}},e}();t.PowerPlatformApiDiscovery=r},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,n){"use strict";n.r(t);var r=n(97);n.d(t,"DebugServicesContracts",(function(){return r}));var o=n(157);n.d(t,"AccessTokenAcquirer",(function(){return o.AccessTokenAcquirer}));var i=n(45);n.d(t,"AuthenticationError",(function(){return i.AuthenticationError})),n.d(t,"AuthenticationErrorKind",(function(){return i.AuthenticationErrorKind}));var a=n(159);n.d(t,"AuthenticationPluginWrapper",(function(){return a.AuthenticationPluginWrapper}));var s=n(116);n.d(t,"AppMagicServicesAdalAuthenticationResult_isValid",(function(){return s.isValid})),n.d(t,"safeCast",(function(){return s.safeCast})),n.d(t,"safeCastAndThrowIfError",(function(){return s.safeCastAndThrowIfError}));var c=n(223);n.d(t,"AuthenticationErrorResponse",(function(){return c.AuthenticationErrorResponse})),n.d(t,"IAuthenticationErrorResponse",(function(){return c.IAuthenticationErrorResponse}));var u=n(218);n.d(t,"IAcquireTokenOptions",(function(){return u.IAcquireTokenOptions})),n.d(t,"IAuthenticationLoadOptions",(function(){return u.IAuthenticationLoadOptions})),n.d(t,"IAuthenticationPlugin",(function(){return u.IAuthenticationPlugin}));var p=n(291);n.d(t,"IAuthenticationPluginCreator",(function(){return p.IAuthenticationPluginCreator}));var l=n(292);n.d(t,"IAuthenticationPluginWrapper",(function(){return l.IAuthenticationPluginWrapper}));var d=n(293);n.d(t,"AppMagicServicesAdal_IAuthenticationResult",(function(){return d.IAuthenticationResult}));var f=n(224);n.d(t,"IPluginError",(function(){return f.IPluginError})),n.d(t,"PluginError",(function(){return f.PluginError}));var y=n(245);n.d(t,"AsyncResult",(function(){return y.AsyncResult}));var m=n(85);n.d(t,"ConsentDialogNotInitializedError",(function(){return m.a})),n.d(t,"fixedEncodeURIComponent",(function(){return m.b}));var g=n(135);n.d(t,"AppMagicServicesAuthenticationAppHttpClient_AuthorizationScheme",(function(){return g.AuthorizationScheme})),n.d(t,"DynamicResourceAuthorizationScheme",(function(){return g.DynamicResourceAuthorizationScheme})),n.d(t,"formatAppAccessTokenAuthorizationHeader",(function(){return g.formatAppAccessTokenAuthorizationHeader})),n.d(t,"formatDynamicAccessTokenAuthorizationHeader",(function(){return g.formatDynamicAccessTokenAuthorizationHeader}));var v=n(160);n.d(t,"AuthenticationProviderRequestAuthenticator",(function(){return v.AuthenticationProviderRequestAuthenticator}));var b=n(294);n.d(t,"IRequestAuthenticator",(function(){return b.IRequestAuthenticator}));var h=n(70);n.d(t,"JsonWebToken",(function(){return h.JsonWebToken}));var A=n(139);n.d(t,"AuthenticationBrokerManager",(function(){return A.AuthenticationBrokerManager})),n.d(t,"IAuthenticationBrokerManagerResponse",(function(){return A.IAuthenticationBrokerManagerResponse}));var C=n(246);n.d(t,"AuthenticationBrokerManagerFactory",(function(){return C.AuthenticationBrokerManagerFactory}));var P=n(161);n.d(t,"AppMagicServices_AuthenticationProvider",(function(){return P.AuthenticationProvider}));var w=n(109);n.d(t,"AuthenticationStatus",(function(){return w.AuthenticationStatus}));var S=n(234);n.d(t,"AuthenticationManager",(function(){return S.AuthenticationManager})),n.d(t,"IAuthenticationProviders",(function(){return S.IAuthenticationProviders}));var O=n(162);n.d(t,"AppMagicServicesAzure_AuthenticationProvider",(function(){return O.AuthenticationProvider}));var R=n(89);n.d(t,"Authority",(function(){return R.a})),n.d(t,"AuthorizationRequest",(function(){return R.b})),n.d(t,"EnrollProperties",(function(){return R.c})),n.d(t,"Resource",(function(){return R.d}));var _=n(295);n.d(t,"IAuthenticationManager",(function(){return _.IAuthenticationManager}));var T=n(296);n.d(t,"AppMagicServicesAzure_IAuthenticationProvider",(function(){return T.IAuthenticationProvider}));var I=n(247);n.d(t,"IdentityStore",(function(){return I.IdentityStore}));var E=n(16);n.d(t,"Region",(function(){return E.Region}));var U=n(164);n.d(t,"DoD",(function(){return U.a}));var j=n(165);n.d(t,"Ex",(function(){return j.a}));var N=n(166);n.d(t,"GccHigh",(function(){return N.a}));var D=n(167);n.d(t,"GccModerate",(function(){return D.a}));var V=n(225);n.d(t,"IRegionDefinition",(function(){return V.IRegionDefinition})),n.d(t,"IRegionDefinitionOverrides",(function(){return V.IRegionDefinitionOverrides}));var M=n(110);n.d(t,"Int",(function(){return M.a}));var k=n(168);n.d(t,"Mooncake",(function(){return k.a}));var L=n(129);n.d(t,"Preprod",(function(){return L.a}));var F=n(25);n.d(t,"Prod",(function(){return F.a}));var x=n(86);n.d(t,"Test",(function(){return x.a}));var H=n(145);n.d(t,"Tip2",(function(){return H.a}));var B=n(163);n.d(t,"UserContext",(function(){return B.UserContext}));var q=n(120);n.d(t,"UserIdentity",(function(){return q.UserIdentity}));var G=n(51);n.d(t,"BadEndpoints",(function(){return G.BadEndpoints}));var J=n(22);n.d(t,"BapEndpoints",(function(){return J.BapEndpoints})),n.d(t,"PowerAppsP2TrialInternalGuid",(function(){return J.PowerAppsP2TrialInternalGuid}));var W=n(67);n.d(t,"BapUtility",(function(){return W.BapUtility}));var z=n(41);n.d(t,"BodilessHttpRequestBuilder",(function(){return z.BodilessHttpRequestBuilder}));var K=n(226);n.d(t,"CdpConstants",(function(){return K.CdpConstants})),n.d(t,"CdpUtility",(function(){return K.CdpUtility}));var X=n(53);n.d(t,"CdsEndpoints",(function(){return X.CdsEndpoints}));var Q=n(227);n.d(t,"CdsSolutionVersion",(function(){return Q.CdsSolutionVersion})),n.d(t,"CdsSolutionVersionCache",(function(){return Q.CdsSolutionVersionCache}));var $=n(63);n.d(t,"CdsUtility",(function(){return $.CdsUtility}));var Z=n(26);n.d(t,"Api",(function(){return Z.a})),n.d(t,"ApiInterfaceRevisionInfo",(function(){return Z.b})),n.d(t,"ApiProperties",(function(){return Z.c})),n.d(t,"ApiServiceInterface",(function(){return Z.d})),n.d(t,"ApiServiceInterfaceRevision",(function(){return Z.e})),n.d(t,"Creator",(function(){return Z.Creator})),n.d(t,"IApiBasicInfo",(function(){return Z.IApiBasicInfo})),n.d(t,"IApiInterfaceRevisionInfo",(function(){return Z.IApiInterfaceRevisionInfo})),n.d(t,"IApiProperties",(function(){return Z.IApiProperties})),n.d(t,"AppMagicConnectionHub_IApiScopes",(function(){return Z.IApiScopes})),n.d(t,"ICustomCreator",(function(){return Z.ICustomCreator})),n.d(t,"IDefaultCreator",(function(){return Z.IDefaultCreator})),n.d(t,"UserKind",(function(){return Z.m})),n.d(t,"isFileSourceApi",(function(){return Z.n})),n.d(t,"isMsFlowApi",(function(){return Z.o})),n.d(t,"AppMagicConnectionHubApi_parse",(function(){return Z.q})),n.d(t,"AppMagicConnectionHubApi_tryParseFromResponseWithLogging",(function(){return Z.r})),n.d(t,"isSharepointApi",(function(){return Z.p}));var Y=n(121);n.d(t,"ApiConnectionParameter",(function(){return Y.a}));var ee=n(83);n.d(t,"parseMetadata",(function(){return ee.parseMetadata})),n.d(t,"parseParameterSets",(function(){return ee.parseParameterSets})),n.d(t,"parseParameters",(function(){return ee.parseParameters})),n.d(t,"tryParse",(function(){return ee.tryParse}));var te=n(172);n.d(t,"ApiConnectionParameterSet",(function(){return te.a}));var ne=n(146);n.d(t,"AppMagicConnectionHub_ApiConnectionParameterSets",(function(){return ne.a}));var re=n(147);n.d(t,"ApiError",(function(){return re.ApiError}));var oe=n(105);n.d(t,"FlowMetadata",(function(){return oe.FlowMetadata})),n.d(t,"FlowMetadataEx",(function(){return oe.FlowMetadataEx}));var ie=n(84);n.d(t,"ApiInterfaceName",(function(){return ie.a})),n.d(t,"ApiRevisionManager",(function(){return ie.b})),n.d(t,"ApisWithDefaultRevisions",(function(){return ie.c})),n.d(t,"IDefaultPreviewRevisionOptions",(function(){return ie.IDefaultPreviewRevisionOptions}));var ae=n(32);n.d(t,"CompositeConnection",(function(){return ae.CompositeConnection})),n.d(t,"FileSourceCompositeConnection",(function(){return ae.FileSourceCompositeConnection})),n.d(t,"MsFlowCompositeConnection",(function(){return ae.MsFlowCompositeConnection}));var se=n(34);n.d(t,"Connection",(function(){return se.a})),n.d(t,"ConnectionProperties",(function(){return se.b})),n.d(t,"IAppConnectionUsage",(function(){return se.IAppConnectionUsage})),n.d(t,"IConnectionCore",(function(){return se.IConnectionCore})),n.d(t,"IConnectionProperties",(function(){return se.IConnectionProperties})),n.d(t,"IConnectionTestLink",(function(){return se.IConnectionTestLink})),n.d(t,"AppMagicConnectionHub_ICreatedBy",(function(){return se.ICreatedBy})),n.d(t,"isCompositeConnection",(function(){return se.h})),n.d(t,"isFileSourceCompositeConnection",(function(){return se.i})),n.d(t,"isMsFlowCompositeConnection",(function(){return se.j})),n.d(t,"AppMagicConnectionHubConnection_parse",(function(){return se.k})),n.d(t,"AppMagicConnectionHubConnection_tryParseFromResponseWithLogging",(function(){return se.l}));var ce=n(58);n.d(t,"ConnectionError",(function(){return ce.ConnectionError})),n.d(t,"ConnectionErrorSource",(function(){return ce.ConnectionErrorSource}));var ue=n(9);n.d(t,"ApiIds",(function(){return ue.ApiIds})),n.d(t,"ApiNames",(function(){return ue.ApiNames})),n.d(t,"CdsDefaultDatasetName",(function(){return ue.CdsDefaultDatasetName})),n.d(t,"CreateConnectionReference",(function(){return ue.CreateConnectionReference})),n.d(t,"CurrentEnvironmentLogicalName",(function(){return ue.CurrentEnvironmentLogicalName})),n.d(t,"DefaultDatasetName",(function(){return ue.DefaultDatasetName})),n.d(t,"ErrorCode",(function(){return ue.ErrorCode})),n.d(t,"ExpandEntityNames",(function(){return ue.ExpandEntityNames})),n.d(t,"ExtendedMetadataSources",(function(){return ue.ExtendedMetadataSources})),n.d(t,"FileSource",(function(){return ue.FileSource})),n.d(t,"MultiAuthConnectionParametersSetNames",(function(){return ue.MultiAuthConnectionParametersSetNames})),n.d(t,"NextLink",(function(){return ue.NextLink})),n.d(t,"RtsProvisioningStatus",(function(){return ue.RtsProvisioningStatus})),n.d(t,"SolutionId",(function(){return ue.SolutionId})),n.d(t,"Status",(function(){return ue.Status})),n.d(t,"SqlStoredProcedures",(function(){return ue.SqlStoredProcedures})),n.d(t,"UrlEncoding",(function(){return ue.UrlEncoding})),n.d(t,"FlowDependentConnectionSource",(function(){return ue.FlowDependentConnectionSource}));var pe=n(76);n.d(t,"isFileSource",(function(){return pe.isFileSource})),n.d(t,"isMsFlow",(function(){return pe.isMsFlow}));var le=n(79);n.d(t,"ConnectionStatusErrorCode",(function(){return le.ConnectionStatusErrorCode}));var de=n(49);n.d(t,"ApiReleaseStatus",(function(){return de.a})),n.d(t,"ApiTier",(function(){return de.b})),n.d(t,"apiReleaseStatusParse",(function(){return de.c})),n.d(t,"apiTierParse",(function(){return de.d}));var fe=n(111);n.d(t,"ErrorWithResponseTypes",(function(){return fe.ErrorWithResponseTypes}));var ye=n(136);n.d(t,"IConnectionConsentOptions",(function(){return ye.IConnectionConsentOptions})),n.d(t,"IConnectionService",(function(){return ye.IConnectionService})),n.d(t,"IConnectionServiceSingletonKey",(function(){return ye.IConnectionServiceSingletonKey})),n.d(t,"ManualLoginSettings",(function(){return ye.ManualLoginSettings}));var me=n(96);n.d(t,"ICdsNativeTableInfo",(function(){return me.ICdsNativeTableInfo})),n.d(t,"IDataServiceItemInfo",(function(){return me.IDataServiceItemInfo})),n.d(t,"ILicense",(function(){return me.ILicense})),n.d(t,"IRtsDatasetItemInfo",(function(){return me.IRtsDatasetItemInfo})),n.d(t,"IRtsTableInfo",(function(){return me.IRtsTableInfo})),n.d(t,"ISurveyEntityData",(function(){return me.ISurveyEntityData})),n.d(t,"ITabularServiceItemInfo",(function(){return me.ITabularServiceItemInfo}));var ge=n(248);n.d(t,"IEntityConnectionReferenceNameMap",(function(){return ge.IEntityConnectionReferenceNameMap}));var ve=n(107);n.d(t,"ILocalConnectionReferenceStore",(function(){return ve.ILocalConnectionReferenceStore})),n.d(t,"LocalConnectionReferenceStore",(function(){return ve.LocalConnectionReferenceStore}));var be=n(52);n.d(t,"getLocalConnections",(function(){return be.getLocalConnections})),n.d(t,"remove",(function(){return be.remove})),n.d(t,"sanitizeDependencies",(function(){return be.sanitizeDependencies})),n.d(t,"updateExecutionRestrictions",(function(){return be.updateExecutionRestrictions})),n.d(t,"upsertAsync",(function(){return be.upsertAsync}));var he=n(106);n.d(t,"OAuthTokenConnectionParameter",(function(){return he.OAuthTokenConnectionParameter}));var Ae=n(6);n.d(t,"ActionsCapability",(function(){return Ae.a})),n.d(t,"ApiConnectionLimitIndex",(function(){return Ae.b})),n.d(t,"BlobCapability",(function(){return Ae.c})),n.d(t,"Capability",(function(){return Ae.d})),n.d(t,"CloudCapability",(function(){return Ae.e})),n.d(t,"CompositeCapability",(function(){return Ae.f})),n.d(t,"ConsentServerFlowId",(function(){return Ae.g})),n.d(t,"ConsentServerResponseError",(function(){return Ae.h})),n.d(t,"ErrorCodeConfig",(function(){return Ae.i})),n.d(t,"ErrorCodeRequests",(function(){return Ae.j})),n.d(t,"ErrorCodeUnauthenticated",(function(){return Ae.k})),n.d(t,"ErrorCodeUnauthorized",(function(){return Ae.l})),n.d(t,"GatewayCapability",(function(){return Ae.m})),n.d(t,"GetAllEnvironmentFlowsFilterOptions",(function(){return Ae.n})),n.d(t,"IConsentLinkData",(function(){return Ae.IConsentLinkData})),n.d(t,"ParameterType",(function(){return Ae.r})),n.d(t,"ParameterTypes",(function(){return Ae.s})),n.d(t,"PowerAppsConnectionService",(function(){return Ae.t})),n.d(t,"StatusError",(function(){return Ae.u})),n.d(t,"TabularCapability",(function(){return Ae.v})),n.d(t,"TriggersCapability",(function(){return Ae.w})),n.d(t,"GetFlowsFilterOptions",(function(){return Ae.o}));var Ce=n(130);n.d(t,"PowerAppsConnectionServiceError",(function(){return Ce.PowerAppsConnectionServiceError}));var Pe=n(148);n.d(t,"SharedEntityConnectionReferenceNameMap",(function(){return Pe.SharedEntityConnectionReferenceNameMap}));var we=n(249);n.d(t,"SingleEntityConnectionReferenceNameMap",(function(){return we.SingleEntityConnectionReferenceNameMap}));var Se=n(72);n.d(t,"UserConnectionForApp",(function(){return Se.a})),n.d(t,"AppMagicConnectionHubUserConnectionForApp_parse",(function(){return Se.b})),n.d(t,"serializeToJson",(function(){return Se.c})),n.d(t,"AppMagicConnectionHubUserConnectionForApp_tryParseFromResponseWithLogging",(function(){return Se.d}));var Oe=n(112);n.d(t,"ConnectionStatus",(function(){return Oe.ConnectionStatus}));var Re=n(17);n.d(t,"addCustomHeadersOptionsToBuilder",(function(){return Re.addCustomHeadersOptionsToBuilder})),n.d(t,"appendCustomHeadersOptions",(function(){return Re.appendCustomHeadersOptions}));var _e=n(27);n.d(t,"Environment",(function(){return _e.a})),n.d(t,"EnvironmentCreationType",(function(){return _e.b})),n.d(t,"EnvironmentFilterKey",(function(){return _e.c})),n.d(t,"EnvironmentParserError",(function(){return _e.d})),n.d(t,"EnvironmentProperties",(function(){return _e.e})),n.d(t,"EnvironmentsRoute",(function(){return _e.f})),n.d(t,"EnvironmentsValue",(function(){return _e.g})),n.d(t,"IEnvironmentProperties",(function(){return _e.IEnvironmentProperties})),n.d(t,"IPermissionObject",(function(){return _e.IPermissionObject})),n.d(t,"IUserObject",(function(){return _e.IUserObject})),n.d(t,"AppMagicPowerAppsEnvironment_parse",(function(){return _e.k}));var Te=n(250);n.d(t,"EnvironmentService",(function(){return Te.EnvironmentService}));var Ie=n(46);n.d(t,"addEnvironmentFilterToOptions",(function(){return Ie.addEnvironmentFilterToOptions})),n.d(t,"addEnvironmentFilterToUrlBuilder",(function(){return Ie.addEnvironmentFilterToUrlBuilder})),n.d(t,"getEnvironmentFilter",(function(){return Ie.getEnvironmentFilter}));var Ee=n(297);n.d(t,"IEnvironmentService",(function(){return Ee.IEnvironmentService}));var Ue=n(251);n.d(t,"FormUrlEncodedBodyRequestParam",(function(){return Ue.FormUrlEncodedBodyRequestParam}));var je=n(152);n.d(t,"FormUrlEncodedHttpRequestBuilder",(function(){return je.FormUrlEncodedHttpRequestBuilder}));var Ne=n(252);n.d(t,"FormUrlEncodedTypedBodyRequestParam",(function(){return Ne.FormUrlEncodedTypedBodyRequestParam}));var De=n(253);n.d(t,"FunctionParameter",(function(){return De.FunctionParameter}));var Ve=n(254);n.d(t,"FunctionVariable",(function(){return Ve.FunctionVariable}));var Me=n(255);n.d(t,"HeaderRequestParam",(function(){return Me.HeaderRequestParam}));var ke=n(256);n.d(t,"HostHttpClient",(function(){return ke.HostHttpClient}));var Le=n(257);n.d(t,"HttpClient",(function(){return Le.HttpClient}));var Fe=n(3);n.d(t,"ContentDispositionType",(function(){return Fe.ContentDispositionType})),n.d(t,"FailureCauses",(function(){return Fe.FailureCauses})),n.d(t,"HeaderName",(function(){return Fe.HeaderName})),n.d(t,"HeaderValue",(function(){return Fe.HeaderValue})),n.d(t,"HttpStatusCode",(function(){return Fe.HttpStatusCode})),n.d(t,"KnownMethods",(function(){return Fe.KnownMethods})),n.d(t,"MediaType",(function(){return Fe.MediaType})),n.d(t,"Method",(function(){return Fe.Method})),n.d(t,"XhrReadyState",(function(){return Fe.XhrReadyState}));var xe=n(258);n.d(t,"HttpRequestBuilderFactory",(function(){return xe.HttpRequestBuilderFactory}));var He=n(298);n.d(t,"IAsyncResult",(function(){return He.IAsyncResult}));var Be=n(299);n.d(t,"IAuthenticationBroker",(function(){return Be.IAuthenticationBroker}));var qe=n(117);n.d(t,"BrowserType",(function(){return qe.BrowserType})),n.d(t,"IAuthenticationBrokerManager",(function(){return qe.IAuthenticationBrokerManager}));var Ge=n(300);n.d(t,"IAuthenticationBrokerManagerFactory",(function(){return Ge.IAuthenticationBrokerManagerFactory}));var Je=n(301);n.d(t,"AppMagicServices_IAuthenticationProvider",(function(){return Je.IAuthenticationProvider}));var We=n(302);n.d(t,"AppMagicServices_IAuthenticationResult",(function(){return We.IAuthenticationResult}));var ze=n(303);n.d(t,"IConnectedDataConnectorService",(function(){return ze.IConnectedDataConnectorService}));var Ke=n(304);n.d(t,"IConnectedMetadata",(function(){return Ke.IConnectedMetadata}));var Xe=n(131);n.d(t,"AnyTValue",(function(){return Xe.AnyTValue})),n.d(t,"IDataFlowData",(function(){return Xe.IDataFlowData})),n.d(t,"IDataflowResult",(function(){return Xe.IDataflowResult})),n.d(t,"ISuccessfulDataflowResult",(function(){return Xe.ISuccessfulDataflowResult})),n.d(t,"IUnsuccessfulDataflowResult",(function(){return Xe.IUnsuccessfulDataflowResult}));var Qe=n(228);n.d(t,"IEncryptionProvider",(function(){return Qe.IEncryptionProvider})),n.d(t,"IEncryptionProviderSingletonKey",(function(){return Qe.IEncryptionProviderSingletonKey}));var $e=n(35);n.d(t,"IErrorWithHttpResponse",(function(){return $e.IErrorWithHttpResponse})),n.d(t,"errorHasHttpResponse",(function(){return $e.errorHasHttpResponse}));var Ze=n(305);n.d(t,"IFunctionExecutionContext",(function(){return Ze.IFunctionExecutionContext}));var Ye=n(306);n.d(t,"IFunctionValueExpression",(function(){return Ye.IFunctionValueExpression}));var et=n(113);n.d(t,"HttpClientSupportedXhrResponseTypes",(function(){return et.HttpClientSupportedXhrResponseTypes})),n.d(t,"ICoreHttpClient",(function(){return et.ICoreHttpClient})),n.d(t,"IHttpClient",(function(){return et.IHttpClient}));var tt=n(153);n.d(t,"IOperationsExecutor",(function(){return tt.IOperationsExecutor})),n.d(t,"Operation",(function(){return tt.Operation})),n.d(t,"OperationPriority",(function(){return tt.OperationPriority}));var nt=n(307);n.d(t,"IParamValueStringifier",(function(){return nt.IParamValueStringifier}));var rt=n(308);n.d(t,"IPathItem",(function(){return rt.IPathItem}));var ot=n(309);n.d(t,"IRequestInfo",(function(){return ot.IRequestInfo}));var it=n(310);n.d(t,"IRequestParam",(function(){return it.IRequestParam}));var at=n(311);n.d(t,"ISendHttpPipeline",(function(){return at.ISendHttpPipeline}));var st=n(98);n.d(t,"ISendHttpPipelineRequestParameters",(function(){return st.ISendHttpPipelineRequestParameters})),n.d(t,"SendHttpCoreSupportedXhrResponseTypes",(function(){return st.SendHttpCoreSupportedXhrResponseTypes})),n.d(t,"SendHttpPipelineRequestBodyData",(function(){return st.SendHttpPipelineRequestBodyData})),n.d(t,"SendHttpPipelineRequestParameters",(function(){return st.SendHttpPipelineRequestParameters}));var ct=n(229);n.d(t,"ISendHttpPipelinePABinaryResponse",(function(){return ct.ISendHttpPipelinePABinaryResponse})),n.d(t,"ISendHttpPipelineTextResponse",(function(){return ct.ISendHttpPipelineTextResponse}));var ut=n(99);n.d(t,"IExtendedBatchInfo",(function(){return ut.IExtendedBatchInfo})),n.d(t,"ISendHttpRequestParameters",(function(){return ut.ISendHttpRequestParameters})),n.d(t,"SendHttpRequestBodyData",(function(){return ut.SendHttpRequestBodyData})),n.d(t,"SendHttpRequestParameters",(function(){return ut.SendHttpRequestParameters}));var pt=n(64);n.d(t,"ISendHttpResponse",(function(){return pt.ISendHttpResponse})),n.d(t,"SendHttpResponse",(function(){return pt.SendHttpResponse}));var lt=n(312);n.d(t,"IService",(function(){return lt.IService}));var dt=n(313);n.d(t,"IServiceDefinition",(function(){return dt.IServiceDefinition}));var ft=n(314);n.d(t,"IServiceExecutionContext",(function(){return ft.IServiceExecutionContext}));var yt=n(236);n.d(t,"IServiceFunction",(function(){return yt.IServiceFunction})),n.d(t,"IServiceFunctionRunAsyncOptionalArgs",(function(){return yt.IServiceFunctionRunAsyncOptionalArgs}));var mt=n(315);n.d(t,"IServiceFunctionInvocation",(function(){return mt.IServiceFunctionInvocation}));var gt=n(316);n.d(t,"IServiceFunctionMetadata",(function(){return gt.IServiceFunctionMetadata}));var vt=n(317);n.d(t,"IServiceFunctionParameterMetadata",(function(){return vt.IServiceFunctionParameterMetadata}));var bt=n(318);n.d(t,"IServiceFunctionVariableMetadata",(function(){return bt.IServiceFunctionVariableMetadata}));var ht=n(319);n.d(t,"IServiceHost",(function(){return ht.IServiceHost}));var At=n(320);n.d(t,"IServiceInRuntime",(function(){return At.IServiceInRuntime}));var Ct=n(321);n.d(t,"IServiceMetadata",(function(){return Ct.IServiceMetadata}));var Pt=n(322);n.d(t,"IServiceVariableMetadata",(function(){return Pt.IServiceVariableMetadata}));var wt=n(323);n.d(t,"IStaticWorkerResult",(function(){return wt.IStaticWorkerResult}));var St=n(237);n.d(t,"IEnvironmentInstance",(function(){return St.IEnvironmentInstance})),n.d(t,"IUserInstance",(function(){return St.IUserInstance}));var Ot=n(114);n.d(t,"IPlanValidationRequest",(function(){return Ot.IPlanValidationRequest})),n.d(t,"IPlanValidationResultInfo",(function(){return Ot.IPlanValidationResultInfo})),n.d(t,"IPlansFound",(function(){return Ot.IPlansFound})),n.d(t,"IUserService",(function(){return Ot.IUserService})),n.d(t,"PlanValidationResult",(function(){return Ot.PlanValidationResult}));var Rt=n(324);n.d(t,"IXml2JsonElement",(function(){return Rt.IXml2JsonElement}));var _t=n(230);n.d(t,"IXmlHttpRequest",(function(){return _t.IXmlHttpRequest})),n.d(t,"AppMagicServicesXmlHttpRequest_isValid",(function(){return _t.b}));var Tt=n(325);n.d(t,"IXmlHttpRequestOptions",(function(){return Tt.IXmlHttpRequestOptions}));var It=n(48);n.d(t,"AiModelType",(function(){return It.AiModelType})),n.d(t,"IAiModel",(function(){return It.IAiModel})),n.d(t,"IAiModelInfo",(function(){return It.IAiModelInfo})),n.d(t,"IntelligenceConstants",(function(){return It.IntelligenceConstants})),n.d(t,"isPrebuiltAiModel",(function(){return It.isPrebuiltAiModel}));var Et=n(68);n.d(t,"IoTApplicationCollection",(function(){return Et.IoTApplicationCollection})),n.d(t,"IoTDevice",(function(){return Et.IoTDevice})),n.d(t,"IoTDeviceCollection",(function(){return Et.IoTDeviceCollection})),n.d(t,"IoTAppIDPropertyName",(function(){return Et.a})),n.d(t,"IoTApplication",(function(){return Et.IoTApplication})),n.d(t,"IoTDeviceIDPropertyName",(function(){return Et.f})),n.d(t,"IoTPaneType",(function(){return Et.g}));var Ut=n(33);n.d(t,"IAttributeDescriptor",(function(){return Ut.IAttributeDescriptor})),n.d(t,"IAttributeDescriptorByName",(function(){return Ut.IAttributeDescriptorByName})),n.d(t,"ICdsMdlMetadataClient",(function(){return Ut.ICdsMdlMetadataClient})),n.d(t,"IHttpRequestBuilder",(function(){return Ut.IHttpRequestBuilder})),n.d(t,"IMdlMetadataContext",(function(){return Ut.IMdlMetadataContext})),n.d(t,"IMinimalXMLHttpRequestResult",(function(){return Ut.IMinimalXMLHttpRequestResult})),n.d(t,"IOptionDescriptor",(function(){return Ut.IOptionDescriptor})),n.d(t,"IPABinaryResolver",(function(){return Ut.IPABinaryResolver})),n.d(t,"ISendTriggerResponse",(function(){return Ut.ISendTriggerResponse})),n.d(t,"MinimalXMLHttpRequest",(function(){return Ut.MinimalXMLHttpRequest})),n.d(t,"SendTriggerFunctionStatusCode",(function(){return Ut.SendTriggerFunctionStatusCode})),n.d(t,"WinJSXhrFunction",(function(){return Ut.WinJSXhrFunction})),n.d(t,"IUserAndOrgSettingsMetadata",(function(){return Ut.IUserAndOrgSettingsMetadata})),n.d(t,"ITimeZoneDefinitionsByCode",(function(){return Ut.ITimeZoneDefinitionsByCode})),n.d(t,"ITimeZoneDefinitionState",(function(){return Ut.ITimeZoneDefinitionState})),n.d(t,"IViewMetadata",(function(){return Ut.IViewMetadata})),n.d(t,"IViewQuery",(function(){return Ut.IViewQuery})),n.d(t,"OptionSetType",(function(){return Ut.OptionSetType}));var jt=n(93);n.d(t,"InvalidJsonServerResponse",(function(){return jt.InvalidJsonServerResponse}));var Nt=n(259);n.d(t,"OrganizationSettingsConstants",(function(){return Nt.OrganizationSettingsConstants}));var Dt=n(260);n.d(t,"JsonBodyRequestParam",(function(){return Dt.JsonBodyRequestParam}));var Vt=n(44);n.d(t,"JsonHttpRequestBuilder",(function(){return Vt.JsonHttpRequestBuilder}));var Mt=n(73);n.d(t,"NamedHttpRequestParam",(function(){return Mt.NamedHttpRequestParam}));var kt=n(261);n.d(t,"NoOpServiceHost",(function(){return kt.NoOpServiceHost}));var Lt=n(60);n.d(t,"INpsService",(function(){return Lt.INpsService})),n.d(t,"NpsNativeClients",(function(){return Lt.NpsNativeClients})),n.d(t,"NpsOtherClients",(function(){return Lt.NpsOtherClients})),n.d(t,"NpsService",(function(){return Lt.NpsService})),n.d(t,"NpsUrlOrigin",(function(){return Lt.NpsUrlOrigin}));var Ft=n(154);n.d(t,"token",(function(){return Ft.token})),n.d(t,"tokenExpiresIn",(function(){return Ft.tokenExpiresIn})),n.d(t,"tokenTimeStamp",(function(){return Ft.tokenTimeStamp}));var xt=n(21);n.d(t,"ODataConstants",(function(){return xt.ODataConstants})),n.d(t,"ODataUtility",(function(){return xt.ODataUtility})),n.d(t,"SupportedOdataVersion",(function(){return xt.SupportedOdataVersion}));var Ht=n(28);n.d(t,"GetItemsResultCode",(function(){return Ht.GetItemsResultCode})),n.d(t,"IGetItemsResult",(function(){return Ht.IGetItemsResult})),n.d(t,"IODataQueryOptions",(function(){return Ht.IODataQueryOptions})),n.d(t,"ODataListItemsTool",(function(){return Ht.ODataListItemsTool}));var Bt=n(262);n.d(t,"PABinarySendHttpPipeline",(function(){return Bt.PABinarySendHttpPipeline}));var qt=n(115);n.d(t,"BooleanParamValueStringifier",(function(){return qt.BooleanParamValueStringifier})),n.d(t,"DateParamValueStringifier",(function(){return qt.DateParamValueStringifier})),n.d(t,"DateTimeParamValueStringifier",(function(){return qt.DateTimeParamValueStringifier})),n.d(t,"NumberParamValueStringifier",(function(){return qt.NumberParamValueStringifier})),n.d(t,"StringParamValueStringifier",(function(){return qt.StringParamValueStringifier}));var Gt=n(263);n.d(t,"AppDraft",(function(){return Gt.AppDraft}));var Jt=n(15);n.d(t,"AppInfo",(function(){return Jt.AppInfo})),n.d(t,"AppLifeCycleId",(function(){return Jt.AppLifeCycleId})),n.d(t,"EmbeddedAppMetadata",(function(){return Jt.EmbeddedAppMetadata})),n.d(t,"IAppInfoProperties",(function(){return Jt.IAppInfoProperties})),n.d(t,"IAppSourceControlMetadata",(function(){return Jt.IAppSourceControlMetadata})),n.d(t,"IAppPackageMetadata",(function(){return Jt.IAppPackageMetadata})),n.d(t,"ISharepointEmbeddedApp",(function(){return Jt.ISharepointEmbeddedApp}));var Wt=n(43);n.d(t,"AppInfoParser",(function(){return Wt.AppInfoParser}));var zt=n(264);n.d(t,"AppInfoParserError",(function(){return zt.AppInfoParserError}));var Kt=n(100);n.d(t,"AppLease",(function(){return Kt.AppLease})),n.d(t,"IAcquireLeaseResult",(function(){return Kt.IAcquireLeaseResult})),n.d(t,"IAppLease",(function(){return Kt.IAppLease})),n.d(t,"IAppLeaseContext",(function(){return Kt.IAppLeaseContext})),n.d(t,"LeaseStatus",(function(){return Kt.LeaseStatus}));var Xt=n(124);n.d(t,"IComponentInfo",(function(){return Xt.IComponentInfo})),n.d(t,"parseComponentInfo",(function(){return Xt.parseComponentInfo}));var Qt=n(119);n.d(t,"AppComponentUpdateInfo",(function(){return Qt.AppComponentUpdateInfo})),n.d(t,"AppComponentUpdateInfos",(function(){return Qt.AppComponentUpdateInfos})),n.d(t,"IAppComponentUpdateInfo",(function(){return Qt.IAppComponentUpdateInfo}));var $t=n(179);n.d(t,"ConsolidatedDatabaseReferencesManager",(function(){return $t.ConsolidatedDatabaseReferencesManager}));var Zt=n(2);n.d(t,"AlmModeFromRP",(function(){return Zt.AlmModeFromRP})),n.d(t,"APIs",(function(){return Zt.APIs})),n.d(t,"ApimBaseGccUrlSuffix",(function(){return Zt.ApimBaseGccUrlSuffix})),n.d(t,"ApimBaseUrlSuffix",(function(){return Zt.ApimBaseUrlSuffix})),n.d(t,"ApimFirstSegment",(function(){return Zt.ApimFirstSegment})),n.d(t,"ApimInvokeHeader",(function(){return Zt.ApimInvokeHeader})),n.d(t,"ApimInvokeRequestMethodHeader",(function(){return Zt.ApimInvokeRequestMethodHeader})),n.d(t,"ApimInvokeUrlPath",(function(){return Zt.ApimInvokeUrlPath})),n.d(t,"AppModuleSettingsKeys",(function(){return Zt.AppModuleSettingsKeys})),n.d(t,"AppTypesFromRP",(function(){return Zt.AppTypesFromRP})),n.d(t,"RPAppTypeByIndex",(function(){return Zt.RPAppTypeByIndex})),n.d(t,"BadRpBaseUrlSuffix",(function(){return Zt.BadRpBaseUrlSuffix})),n.d(t,"CapabilityStatus",(function(){return Zt.CapabilityStatus})),n.d(t,"CdsDefaultWebApiVersion",(function(){return Zt.CdsDefaultWebApiVersion})),n.d(t,"EmbeddedAppTypes",(function(){return Zt.EmbeddedAppTypes})),n.d(t,"GalleryItem",(function(){return Zt.GalleryItem})),n.d(t,"GalleryItemTypes",(function(){return Zt.GalleryItemTypes})),n.d(t,"GetAppExpandParameters",(function(){return Zt.GetAppExpandParameters})),n.d(t,"Links",(function(){return Zt.Links})),n.d(t,"Notification",(function(){return Zt.Notification})),n.d(t,"ParameterHintNames",(function(){return Zt.ParameterHintNames})),n.d(t,"PowerAppEndpoints",(function(){return Zt.PowerAppEndpoints})),n.d(t,"PowerAppsAppNameKey",(function(){return Zt.PowerAppsAppNameKey})),n.d(t,"PowerAppsNextLink",(function(){return Zt.PowerAppsNextLink})),n.d(t,"PowerAppsPackageDefaultValues",(function(){return Zt.PowerAppsPackageDefaultValues})),n.d(t,"PowerAppsRpBaseGccUrlSuffix",(function(){return Zt.PowerAppsRpBaseGccUrlSuffix})),n.d(t,"PowerAppsRpBaseUrlSuffix",(function(){return Zt.PowerAppsRpBaseUrlSuffix})),n.d(t,"PowerAppsRpInvokeHeader",(function(){return Zt.PowerAppsRpInvokeHeader})),n.d(t,"PowerAppsSaveDisplayNameConflictError",(function(){return Zt.PowerAppsSaveDisplayNameConflictError})),n.d(t,"PowerAppsTemplateProperties",(function(){return Zt.PowerAppsTemplateProperties})),n.d(t,"ProtocolHandler",(function(){return Zt.ProtocolHandler})),n.d(t,"Publish",(function(){return Zt.Publish})),n.d(t,"TemplateTags",(function(){return Zt.TemplateTags})),n.d(t,"favoriteValue",(function(){return Zt.favoriteValue})),n.d(t,"hiddenParametersTag",(function(){return Zt.hiddenParametersTag})),n.d(t,"idTokenKey",(function(){return Zt.idTokenKey})),n.d(t,"TabularActions",(function(){return Zt.TabularActions}));var Yt=n(180);n.d(t,"ApiPolicyViolation",(function(){return Yt.ApiPolicyViolation}));var en=n(149);n.d(t,"ApiPolicyViolationError",(function(){return en.ApiPolicyViolationError}));var tn=n(231);n.d(t,"DataLossPreventionClient",(function(){return tn.DataLossPreventionClient})),n.d(t,"ErrorMoreInfoLink",(function(){return tn.ErrorMoreInfoLink}));var nn=n(181);n.d(t,"DataLossPreventionService",(function(){return nn.a})),n.d(t,"evaluatePolicyUrlTemplate",(function(){return nn.b}));var rn=n(326);n.d(t,"IDataLossPreventionClient",(function(){return rn.IDataLossPreventionClient}));var on=n(61);n.d(t,"DatabaseReferencesManager",(function(){return on.DatabaseReferencesManager})),n.d(t,"IDatabaseReferenceComponentInfo",(function(){return on.IDatabaseReferenceComponentInfo})),n.d(t,"IDatabaseReferenceComponentUpsertInfo",(function(){return on.IDatabaseReferenceComponentUpsertInfo})),n.d(t,"IDatabaseReferenceUpsertInfo",(function(){return on.IDatabaseReferenceUpsertInfo})),n.d(t,"ILocalCdsDatabaseReference",(function(){return on.ILocalCdsDatabaseReference}));var an=n(141);n.d(t,"DisambiguationResultProcessor",(function(){return an.DisambiguationResultProcessor})),n.d(t,"IDisambiguationResult",(function(){return an.IDisambiguationResult}));var sn=n(169);n.d(t,"DisambiguationRuleManager",(function(){return sn.DisambiguationRuleManager}));var cn=n(140);n.d(t,"AuthResource",(function(){return cn.AuthResource})),n.d(t,"IAuthResource",(function(){return cn.IAuthResource}));var un=n(238);n.d(t,"IClientConnectionReference",(function(){return un.IClientConnectionReference})),n.d(t,"IConnectionReference",(function(){return un.IConnectionReference}));var pn=n(24);n.d(t,"DeleteAppResultCode",(function(){return pn.DeleteAppResultCode})),n.d(t,"GetAppResultCode",(function(){return pn.GetAppResultCode})),n.d(t,"IGetAppResult",(function(){return pn.IGetAppResult})),n.d(t,"IUpdateDisplayNameResult",(function(){return pn.IUpdateDisplayNameResult})),n.d(t,"UpdateDisplayNameResultCode",(function(){return pn.UpdateDisplayNameResultCode}));var ln=n(54);n.d(t,"IAppCdsDataSourceConfig",(function(){return ln.IAppCdsDataSourceConfig})),n.d(t,"IAppDataSourceConfig",(function(){return ln.IAppDataSourceConfig})),n.d(t,"IAppMetadata",(function(){return ln.IAppMetadata})),n.d(t,"IConnectionReferenceValue",(function(){return ln.IConnectionReferenceValue})),n.d(t,"IDynamicResourceConfig",(function(){return ln.IDynamicResourceConfig})),n.d(t,"IHostMetadata",(function(){return ln.IHostMetadata})),n.d(t,"IPowerAppsClient",(function(){return ln.IPowerAppsClient})),n.d(t,"IPowerAppsClientSingletonKey",(function(){return ln.IPowerAppsClientSingletonKey})),n.d(t,"ITableConfig",(function(){return ln.ITableConfig}));var dn=n(327);n.d(t,"IPowerAppsService",(function(){return dn.IPowerAppsService}));var fn=n(239);n.d(t,"IUploadablePackage",(function(){return fn.IUploadablePackage})),n.d(t,"IUploadableWebPackageFile",(function(){return fn.IUploadableWebPackageFile}));var yn=n(88);n.d(t,"IAuthConsent",(function(){return yn.IAuthConsent})),n.d(t,"IDeviceConsent",(function(){return yn.IDeviceConsent})),n.d(t,"UserConsent",(function(){return yn.UserConsent})),n.d(t,"tryFromServerUserConsent",(function(){return yn.tryFromServerUserConsent}));var mn=n(170);n.d(t,"ModelAppInfo",(function(){return mn.ModelAppInfo}));var gn=n(103);n.d(t,"PostConnectionUsageManager",(function(){return gn.PostConnectionUsageManager})),n.d(t,"ScopeConsentType",(function(){return gn.ScopeConsentType}));var vn=n(36);n.d(t,"AppExtendedMetadataStatus",(function(){return vn.AppExtendedMetadataStatus})),n.d(t,"IAppExtendedMetadataResult",(function(){return vn.IAppExtendedMetadataResult})),n.d(t,"IClientVersionForListPackage",(function(){return vn.IClientVersionForListPackage})),n.d(t,"AppMagicPowerApps_IListAppPackageResult",(function(){return vn.IListAppPackageResult})),n.d(t,"AppMagicPowerApps_ListAppPackageResultStatus",(function(){return vn.ListAppPackageResultStatus})),n.d(t,"PowerAppsApp",(function(){return vn.PowerAppsApp})),n.d(t,"UpsertAppOptions",(function(){return vn.UpsertAppOptions}));var bn=n(101);n.d(t,"AppDisplayNameValidationStatus",(function(){return bn.a})),n.d(t,"IAppListPageData",(function(){return bn.IAppListPageData})),n.d(t,"IPowerAppsAppService",(function(){return bn.IPowerAppsAppService})),n.d(t,"IValidateAppDisplayNameResult",(function(){return bn.IValidateAppDisplayNameResult})),n.d(t,"PowerAppsAppService",(function(){return bn.e}));var hn=n(155);n.d(t,"IConnectionConsentError",(function(){return hn.IConnectionConsentError})),n.d(t,"IConsentConnectionReference",(function(){return hn.IConsentConnectionReference})),n.d(t,"PowerAppsClient",(function(){return hn.PowerAppsClient}));var An=n(118);n.d(t,"IToastWithLinksClickHandlers",(function(){return An.IToastWithLinksClickHandlers})),n.d(t,"tryGetToastWithLinksMessageData",(function(){return An.tryGetToastWithLinksMessageData})),n.d(t,"tryMapErrorResponse",(function(){return An.tryMapErrorResponse}));var Cn=n(40);n.d(t,"DebugPlayerPackageLocallySetting",(function(){return Cn.a})),n.d(t,"GetAppsClassificationFilter",(function(){return Cn.b})),n.d(t,"IGetAppOptions",(function(){return Cn.IGetAppOptions})),n.d(t,"IPackageAppRequestBody",(function(){return Cn.IPackageAppRequestBody})),n.d(t,"OptInApi",(function(){return Cn.e})),n.d(t,"PowerAppsService",(function(){return Cn.f}));var Pn=n(4);n.d(t,"IDocumentServerEndpointHeader",(function(){return Pn.IDocumentServerEndpointHeader})),n.d(t,"PowerAppsUtility",(function(){return Pn.PowerAppsUtility}));var wn=n(65);n.d(t,"IRPSessionResult",(function(){return wn.IRPSessionResult})),n.d(t,"IRPSessionClientContext",(function(){return wn.IRPSessionClientContext})),n.d(t,"IRPPresenceDetails",(function(){return wn.IRPPresenceDetails})),n.d(t,"IRPSession",(function(){return wn.IRPSession})),n.d(t,"PresentUserStatus",(function(){return wn.PresentUserStatus})),n.d(t,"RPSessionResourceTypes",(function(){return wn.RPSessionResourceTypes})),n.d(t,"RPSessionType",(function(){return wn.RPSessionType})),n.d(t,"IRPListSessionsResponse",(function(){return wn.IRPListSessionsResponse}));var Sn=n(265);n.d(t,"generate",(function(){return Sn.generate}));var On=n(184);n.d(t,"SharedDatabaseReferencesManager",(function(){return On.SharedDatabaseReferencesManager}));var Rn=n(38);n.d(t,"ComponentType",(function(){return Rn.ComponentType})),n.d(t,"ITemplateComponentCoreInfo",(function(){return Rn.ITemplateComponentCoreInfo})),n.d(t,"ITemplateComponentDependencyInfo",(function(){return Rn.ITemplateComponentDependencyInfo})),n.d(t,"ITemplateComponentInfo",(function(){return Rn.ITemplateComponentInfo})),n.d(t,"ITemplateConnectionReference",(function(){return Rn.ITemplateConnectionReference})),n.d(t,"ITemplateEntityReference",(function(){return Rn.ITemplateEntityReference})),n.d(t,"ITemplatePackage",(function(){return Rn.ITemplatePackage})),n.d(t,"ITemplatePackageAppUris",(function(){return Rn.ITemplatePackageAppUris})),n.d(t,"ITemplatePackageForPatchConnectionReferences",(function(){return Rn.ITemplatePackageForPatchConnectionReferences})),n.d(t,"ITemplatePackageProperties",(function(){return Rn.ITemplatePackageProperties})),n.d(t,"ITemplatePackagePropertiesForPatchConnectionReferences",(function(){return Rn.ITemplatePackagePropertiesForPatchConnectionReferences})),n.d(t,"ITemplatePackageUri",(function(){return Rn.ITemplatePackageUri}));var _n=n(171);n.d(t,"TemplatePackageBuilder",(function(){return _n.TemplatePackageBuilder}));var Tn=n(232);n.d(t,"IPrimitiveDArgument",(function(){return Tn.IPrimitiveDArgument})),n.d(t,"PrimitiveDArgument",(function(){return Tn.PrimitiveDArgument}));var In=n(267);n.d(t,"ProcessorCode",(function(){return In.ProcessorCode}));var En=n(268);n.d(t,"QueryRequestParam",(function(){return En.QueryRequestParam}));var Un=n(132);n.d(t,"IChannelRegistrar",(function(){return Un.IChannelRegistrar})),n.d(t,"IPlayerType",(function(){return Un.IPlayerType})),n.d(t,"IRegisterDeviceRequest",(function(){return Un.IRegisterDeviceRequest})),n.d(t,"IRegistrationIdentity",(function(){return Un.IRegistrationIdentity})),n.d(t,"IUnregisterDeviceRequest",(function(){return Un.IUnregisterDeviceRequest}));var jn=n(125);n.d(t,"NotificationCategories",(function(){return jn.a})),n.d(t,"NotificationCategory",(function(){return jn.b})),n.d(t,"NotificationSubcategory",(function(){return jn.c}));var Nn=n(182);n.d(t,"PowerAppsChannelRegistrar",(function(){return Nn.a}));var Dn=n(90);n.d(t,"RequestParamBase",(function(){return Dn.RequestParamBase}));var Vn=n(158);n.d(t,"ResourceAcquirerBase",(function(){return Vn.ResourceAcquirerBase}));var Mn=n(102);n.d(t,"IResourceAcquirer",(function(){return Mn.IResourceAcquirer})),n.d(t,"ITryGetAcquireResult",(function(){return Mn.ITryGetAcquireResult})),n.d(t,"ResourceAwaiterPool",(function(){return Mn.ResourceAwaiterPool}));var kn=n(269);n.d(t,"ResourceBaseUrlRequestParam",(function(){return kn.ResourceBaseUrlRequestParam}));var Ln=n(23);n.d(t,"ResponseType",(function(){return Ln.ResponseType})),n.d(t,"ResponseTypes",(function(){return Ln.ResponseTypes}));var Fn=n(270);n.d(t,"DocumentResponseProcessor",(function(){return Fn.DocumentResponseProcessor}));var xn=n(31);n.d(t,"ResponseValueType",(function(){return xn.ResponseValueType}));var Hn=n(328);n.d(t,"IResponse",(function(){return Hn.IResponse}));var Bn=n(329);n.d(t,"IResponseValueExtractor",(function(){return Bn.IResponseValueExtractor}));var qn=n(330);n.d(t,"IRestClient",(function(){return qn.IRestClient}));var Gn=n(331);n.d(t,"IXhrResponseProcessor",(function(){return Gn.IXhrResponseProcessor}));var Jn=n(271);n.d(t,"JsonResponseParam",(function(){return Jn.JsonResponseParam}));var Wn=n(272);n.d(t,"ResponseBodyExtractor",(function(){return Wn.ResponseBodyExtractor}));var zn=n(273);n.d(t,"ResponseHeaderParam",(function(){return zn.ResponseHeaderParam}));var Kn=n(274);n.d(t,"ResponseTypeResponseProcessor",(function(){return Kn.ResponseTypeResponseProcessor}));var Xn=n(275);n.d(t,"RestClient",(function(){return Xn.RestClient}));var Qn=n(277);n.d(t,"XPathResponseParam",(function(){return Qn.XPathResponseParam}));var $n=n(185);n.d(t,"XhrProcessor",(function(){return $n.XhrProcessor}));var Zn=n(276);n.d(t,"XmlAsJsonResponseProcessor",(function(){return Zn.XmlAsJsonResponseProcessor}));var Yn=n(92);n.d(t,"Type",(function(){return Yn.Type})),n.d(t,"correctObjectWithSchema",(function(){return Yn.correctObjectWithSchema})),n.d(t,"correctSchemaDictionaryAndCreateNameRemapping",(function(){return Yn.correctSchemaDictionaryAndCreateNameRemapping}));var er=n(183);n.d(t,"AppResources",(function(){return er.AppResources}));var tr=n(240);n.d(t,"IServerItemCacheOptions",(function(){return tr.IServerItemCacheOptions})),n.d(t,"IServerItemCacheSerializationOptions",(function(){return tr.IServerItemCacheSerializationOptions}));var nr=n(332);n.d(t,"ITimedCacheOptions",(function(){return nr.ITimedCacheOptions}));var rr=n(278);n.d(t,"ClientSettings",(function(){return rr.ClientSettings}));var or=n(142);n.d(t,"createCommonJsonRestCallHeaders",(function(){return or.createCommonJsonRestCallHeaders})),n.d(t,"getAppPremiumFeaturesRequirements",(function(){return or.getAppPremiumFeaturesRequirements}));var ir=n(156);n.d(t,"AppPreloadDataContractVersion",(function(){return ir.AppPreloadDataContractVersion})),n.d(t,"IAppInfoPreloadData",(function(){return ir.IAppInfoPreloadData})),n.d(t,"IAppPreloadData",(function(){return ir.IAppPreloadData}));var ar=n(219);n.d(t,"DraftAppModule",(function(){return ar.DraftAppModule})),n.d(t,"IAppResourceManager",(function(){return ar.IAppResourceManager})),n.d(t,"IAppResourceManagerEvent",(function(){return ar.IAppResourceManagerEvent}));var sr=n(81);n.d(t,"AppIdentifier",(function(){return sr.AppIdentifier})),n.d(t,"AppPackageType",(function(){return sr.AppPackageType})),n.d(t,"IAppPreloadDataWithAppResourcesPromise",(function(){return sr.IAppPreloadDataWithAppResourcesPromise})),n.d(t,"IAppResources",(function(){return sr.IAppResources})),n.d(t,"UnifiedAppIdentifier",(function(){return sr.UnifiedAppIdentifier})),n.d(t,"generatePreloadConnectionUsages",(function(){return sr.generatePreloadConnectionUsages}));var cr=n(266);n.d(t,"ListAppPackageOperationDetails",(function(){return cr.ListAppPackageOperationDetails}));var ur=n(233);n.d(t,"AppListType",(function(){return ur.AppListType})),n.d(t,"IAppsManager",(function(){return ur.IAppsManager}));var pr=n(333);n.d(t,"IClientConfigurationLoader",(function(){return pr.IClientConfigurationLoader}));var lr=n(334);n.d(t,"IIdentityService",(function(){return lr.IIdentityService}));var dr=n(335);n.d(t,"IUserFeaturesManager",(function(){return dr.IUserFeaturesManager}));var fr=n(336);n.d(t,"IUserTenantsManager",(function(){return fr.IUserTenantsManager}));var yr=n(279);n.d(t,"IdentityService",(function(){return yr.IdentityService}));var mr=n(143);n.d(t,"AppMagicRuntimeClient_IListAppPackageResult",(function(){return mr.IListAppPackageResult})),n.d(t,"AppMagicRuntimeClient_ListAppPackageResultStatus",(function(){return mr.b})),n.d(t,"ListPackageClient",(function(){return mr.c}));var gr=n(8);n.d(t,"AppMagicRuntimeClient_AuthorizationScheme",(function(){return gr.a})),n.d(t,"AuthorizationSchemeWithSpace",(function(){return gr.b})),n.d(t,"ResourceName",(function(){return gr.ResourceName})),n.d(t,"ResourceNames",(function(){return gr.d})),n.d(t,"addAuthorizationOptions",(function(){return gr.e})),n.d(t,"addAuthorizationOptionsToBuilder",(function(){return gr.f})),n.d(t,"hasClientAuthorizationScheme",(function(){return gr.g})),n.d(t,"isClientAuthorizationScheme",(function(){return gr.h}));var vr=n(39);n.d(t,"SafeCastError",(function(){return vr.SafeCastError}));var br=n(5);n.d(t,"IComplexSchema",(function(){return br.IComplexSchema})),n.d(t,"IPrimitiveSchema",(function(){return br.IPrimitiveSchema})),n.d(t,"ISchema",(function(){return br.ISchema})),n.d(t,"ISchemaMap",(function(){return br.ISchemaMap})),n.d(t,"KeyName",(function(){return br.KeyName})),n.d(t,"KeyPtr",(function(){return br.KeyPtr})),n.d(t,"KeyType",(function(){return br.KeyType})),n.d(t,"TypeArray",(function(){return br.TypeArray})),n.d(t,"TypeAttachment",(function(){return br.TypeAttachment})),n.d(t,"TypeBlob",(function(){return br.TypeBlob})),n.d(t,"TypeBoolean",(function(){return br.TypeBoolean})),n.d(t,"TypeColor",(function(){return br.TypeColor})),n.d(t,"TypeControl",(function(){return br.TypeControl})),n.d(t,"TypeCurrency",(function(){return br.TypeCurrency})),n.d(t,"TypeDate",(function(){return br.TypeDate})),n.d(t,"TypeDateTime",(function(){return br.TypeDateTime})),n.d(t,"TypeDateTimeNoTimeZone",(function(){return br.TypeDateTimeNoTimeZone})),n.d(t,"TypeEntity",(function(){return br.TypeEntity})),n.d(t,"TypeError",(function(){return br.TypeError})),n.d(t,"TypeFile",(function(){return br.TypeFile})),n.d(t,"TypeGuid",(function(){return br.TypeGuid})),n.d(t,"TypeHyperlink",(function(){return br.TypeHyperlink})),n.d(t,"TypeImage",(function(){return br.TypeImage})),n.d(t,"TypeLargeImage",(function(){return br.TypeLargeImage})),n.d(t,"TypeMedia",(function(){return br.TypeMedia})),n.d(t,"TypeNumber",(function(){return br.TypeNumber})),n.d(t,"TypeObjNull",(function(){return br.TypeObjNull})),n.d(t,"TypeObject",(function(){return br.TypeObject})),n.d(t,"TypeOptionSet",(function(){return br.TypeOptionSet})),n.d(t,"TypeOptionSetValue",(function(){return br.TypeOptionSetValue})),n.d(t,"TypePenImage",(function(){return br.TypePenImage})),n.d(t,"TypePolymorphic",(function(){return br.TypePolymorphic})),n.d(t,"TypeString",(function(){return br.TypeString})),n.d(t,"TypeTable",(function(){return br.TypeTable})),n.d(t,"TypeTime",(function(){return br.TypeTime})),n.d(t,"TypeUnknown",(function(){return br.TypeUnknown})),n.d(t,"TypeUntypedObject",(function(){return br.TypeUntypedObject})),n.d(t,"TypeViewValue",(function(){return br.TypeViewValue})),n.d(t,"addSchemaMember",(function(){return br.addSchemaMember})),n.d(t,"containsSchemaMember",(function(){return br.containsSchemaMember})),n.d(t,"createSchemaForArrayFromPointer",(function(){return br.createSchemaForArrayFromPointer})),n.d(t,"createSchemaForControlFromPointer",(function(){return br.createSchemaForControlFromPointer})),n.d(t,"createSchemaForObjectFromPointer",(function(){return br.createSchemaForObjectFromPointer})),n.d(t,"createSchemaForSimple",(function(){return br.createSchemaForSimple})),n.d(t,"getChildSchemaAtMemberNameOrIndex",(function(){return br.getChildSchemaAtMemberNameOrIndex})),n.d(t,"getPrimitiveTypes",(function(){return br.getPrimitiveTypes})),n.d(t,"getSchemaFollowingDataJsonPointer",(function(){return br.getSchemaFollowingDataJsonPointer})),n.d(t,"getSchemaOfProperty",(function(){return br.getSchemaOfProperty})),n.d(t,"getSchemaString",(function(){return br.getSchemaString})),n.d(t,"isSchemaComplexSchema",(function(){return br.isSchemaComplexSchema})),n.d(t,"isSchemaOfPrimitiveType",(function(){return br.isSchemaOfPrimitiveType})),n.d(t,"isSchemaOfType",(function(){return br.isSchemaOfType})),n.d(t,"isSchemaOfTypeArray",(function(){return br.isSchemaOfTypeArray})),n.d(t,"isSchemaOfTypeObject",(function(){return br.isSchemaOfTypeObject})),n.d(t,"removeSchemaMember",(function(){return br.removeSchemaMember})),n.d(t,"schemasAreEqual",(function(){return br.schemasAreEqual})),n.d(t,"stringizeSchema",(function(){return br.stringizeSchema})),n.d(t,"transformSchemaMapToArray",(function(){return br.transformSchemaMapToArray}));var hr=n(82);n.d(t,"SendHttpError",(function(){return hr.SendHttpError})),n.d(t,"SendHttpErrorName",(function(){return hr.SendHttpErrorName}));var Ar=n(71);n.d(t,"SendHttpErrorWithResponse",(function(){return Ar.SendHttpErrorWithResponse}));var Cr=n(122);n.d(t,"HttpResponseErrorKind",(function(){return Cr.HttpResponseErrorKind})),n.d(t,"SendHttpInvalidResponseError",(function(){return Cr.SendHttpInvalidResponseError}));var Pr=n(280);n.d(t,"SendHttpPipelineProvider",(function(){return Pr.SendHttpPipelineProvider}));var wr=n(47);n.d(t,"Kind",(function(){return wr.a})),n.d(t,"ServiceCallCanceledEventArgs",(function(){return wr.b})),n.d(t,"ServiceCallErrorContextEventArgs",(function(){return wr.c})),n.d(t,"ServiceCallEventArgs",(function(){return wr.d})),n.d(t,"ServiceCallFailedEventArgs",(function(){return wr.e})),n.d(t,"ServiceCallRequestIdEventArgs",(function(){return wr.f})),n.d(t,"ServiceCallStartEventArgs",(function(){return wr.g})),n.d(t,"ServiceCallSucceededEventArgs",(function(){return wr.h})),n.d(t,"ServiceCallTimeoutEventArgs",(function(){return wr.i}));var Sr=n(337);n.d(t,"IAuthenticationProviderDefinition",(function(){return Sr.IAuthenticationProviderDefinition}));var Or=n(338);n.d(t,"IConnectionAuthenticationProviderDefinition",(function(){return Or.IConnectionAuthenticationProviderDefinition}));var Rr=n(220);n.d(t,"IDocDictionaryDefinition",(function(){return Rr.IDocDictionaryDefinition})),n.d(t,"IDocEntry",(function(){return Rr.IDocEntry})),n.d(t,"IHasDocDefinition",(function(){return Rr.IHasDocDefinition}));var _r=n(151);n.d(t,"ICompositeFunctionDefinition",(function(){return _r.ICompositeFunctionDefinition})),n.d(t,"IFunctionDefinition",(function(){return _r.IFunctionDefinition})),n.d(t,"IPollingSettings",(function(){return _r.IPollingSettings})),n.d(t,"IRestFunctionDefinition",(function(){return _r.IRestFunctionDefinition}));var Tr=n(339);n.d(t,"IFunctionParameterDefinition",(function(){return Tr.IFunctionParameterDefinition}));var Ir=n(80);n.d(t,"IFunctionResultDefinition",(function(){return Ir.IFunctionResultDefinition})),n.d(t,"IFunctionResultFormAggregateDefinition",(function(){return Ir.IFunctionResultFormAggregateDefinition})),n.d(t,"IFunctionResultFormAggregateParamDefinition",(function(){return Ir.IFunctionResultFormAggregateParamDefinition})),n.d(t,"IFunctionResultFormSelfBodyDefinition",(function(){return Ir.IFunctionResultFormSelfBodyDefinition})),n.d(t,"IFunctionResultFormSelfDefinition",(function(){return Ir.IFunctionResultFormSelfDefinition})),n.d(t,"IFunctionResultFormSingleDefinition",(function(){return Ir.IFunctionResultFormSingleDefinition})),n.d(t,"IFunctionResultFormVoidDefinition",(function(){return Ir.IFunctionResultFormVoidDefinition})),n.d(t,"IResponseJsonAggregateParamDefinition",(function(){return Ir.IResponseJsonAggregateParamDefinition})),n.d(t,"IResponseXmlAggregateParamDefinition",(function(){return Ir.IResponseXmlAggregateParamDefinition}));var Er=n(340);n.d(t,"IFunctionVariableDefinition",(function(){return Er.IFunctionVariableDefinition}));var Ur=n(341);n.d(t,"IJsonBodyRequestParamDefinition",(function(){return Ur.IJsonBodyRequestParamDefinition}));var jr=n(342);n.d(t,"IPathItemDefinition",(function(){return jr.IPathItemDefinition}));var Nr=n(19);n.d(t,"AuthTypeName",(function(){return Nr.AuthTypeName})),n.d(t,"DateTimeNamedFormats",(function(){return Nr.DateTimeNamedFormats})),n.d(t,"DefTypes",(function(){return Nr.DefTypes})),n.d(t,"JsonPrimitives",(function(){return Nr.JsonPrimitives})),n.d(t,"ParamType",(function(){return Nr.ParamType})),n.d(t,"RequestMediaType",(function(){return Nr.RequestMediaType})),n.d(t,"ResponseMediaType",(function(){return Nr.ResponseMediaType})),n.d(t,"ResultForm",(function(){return Nr.ResultForm})),n.d(t,"ResultForms",(function(){return Nr.ResultForms}));var Dr=n(133);n.d(t,"IBinaryRequestBodyDefinition",(function(){return Dr.IBinaryRequestBodyDefinition})),n.d(t,"IFormUrlEncodedRequestBodyDefinition",(function(){return Dr.IFormUrlEncodedRequestBodyDefinition})),n.d(t,"IJsonRequestBodyDefinition",(function(){return Dr.IJsonRequestBodyDefinition})),n.d(t,"IMultipartFormDataRequestBodyDefinition",(function(){return Dr.IMultipartFormDataRequestBodyDefinition})),n.d(t,"IRequestBodyDefinition",(function(){return Dr.IRequestBodyDefinition}));var Vr=n(241);n.d(t,"IRequestDefinition",(function(){return Vr.IRequestDefinition})),n.d(t,"IRequestResourceDefinition",(function(){return Vr.IRequestResourceDefinition}));var Mr=n(221);n.d(t,"IRequestKeyedParamDefinition",(function(){return Mr.IRequestKeyedParamDefinition})),n.d(t,"IRequestNamedParamDefinition",(function(){return Mr.IRequestNamedParamDefinition})),n.d(t,"IRequestParamDefinition",(function(){return Mr.IRequestParamDefinition}));var kr=n(134);n.d(t,"IResponseBodyValueDefinition",(function(){return kr.IResponseBodyValueDefinition})),n.d(t,"IResponseHeaderParamDefinition",(function(){return kr.IResponseHeaderParamDefinition})),n.d(t,"IResponseJsonParamDefinition",(function(){return kr.IResponseJsonParamDefinition})),n.d(t,"IResponseParamDefinition",(function(){return kr.IResponseParamDefinition})),n.d(t,"IResponseXmlParamDefinition",(function(){return kr.IResponseXmlParamDefinition}));var Lr=n(222);n.d(t,"IServiceConfigDefinition",(function(){return Lr.IServiceConfigDefinition})),n.d(t,"IServiceVariableDefinition",(function(){return Lr.IServiceVariableDefinition})),n.d(t,"ICdsActionInfo",(function(){return Lr.ICdsActionInfo}));var Fr=n(244);n.d(t,"ICdsDeserializationContext",(function(){return Fr.ICdsDeserializationContext})),n.d(t,"ITypeSystemDeserializationContext",(function(){return Fr.ITypeSystemDeserializationContext}));var xr=n(20);n.d(t,"IBase64BinaryTypeDefinition",(function(){return xr.IBase64BinaryTypeDefinition})),n.d(t,"IBlobTypeDefinition",(function(){return xr.IBlobTypeDefinition})),n.d(t,"ICdpArrayOptionSetDefinition",(function(){return xr.ICdpArrayOptionSetDefinition})),n.d(t,"ICdpAttachmentTypeDefinition",(function(){return xr.ICdpAttachmentTypeDefinition})),n.d(t,"ICdpNavigationTypeDefinition",(function(){return xr.ICdpNavigationTypeDefinition})),n.d(t,"ICdpObjectOptionSetDefinition",(function(){return xr.ICdpObjectOptionSetDefinition})),n.d(t,"ICdpPolymorphicLookupTypeDefinition",(function(){return xr.ICdpPolymorphicLookupTypeDefinition})),n.d(t,"ICdsArrayOptionSetDefinition",(function(){return xr.ICdsArrayOptionSetDefinition})),n.d(t,"ICdsAttachmentTypeDefinition",(function(){return xr.ICdsAttachmentTypeDefinition})),n.d(t,"ICdsEntityTypeDefinition",(function(){return xr.ICdsEntityTypeDefinition})),n.d(t,"ICdsNavigationTypeDefinition",(function(){return xr.ICdsNavigationTypeDefinition})),n.d(t,"ICdsOptionSetTypeDefinition",(function(){return xr.ICdsOptionSetTypeDefinition})),n.d(t,"IFileTypeDefinition",(function(){return xr.IFileTypeDefinition})),n.d(t,"IIdentityTypeDefinition",(function(){return xr.IIdentityTypeDefinition})),n.d(t,"IJsonArrayTypeDefinition",(function(){return xr.IJsonArrayTypeDefinition})),n.d(t,"IJsonDateString",(function(){return xr.IJsonDateString})),n.d(t,"IJsonDateTimeNoTimeZoneString",(function(){return xr.IJsonDateTimeNoTimeZoneString})),n.d(t,"IJsonDateTimeNumber",(function(){return xr.IJsonDateTimeNumber})),n.d(t,"IJsonDateTimeString",(function(){return xr.IJsonDateTimeString})),n.d(t,"IJsonGuid",(function(){return xr.IJsonGuid})),n.d(t,"IJsonMapObjectTypeDefinition",(function(){return xr.IJsonMapObjectTypeDefinition})),n.d(t,"IJsonMapObjectValuesDefinition",(function(){return xr.IJsonMapObjectValuesDefinition})),n.d(t,"IJsonNumberTypeDefinition",(function(){return xr.IJsonNumberTypeDefinition})),n.d(t,"IJsonObjectPropertyDefinition",(function(){return xr.IJsonObjectPropertyDefinition})),n.d(t,"IJsonObjectTypeDefinition",(function(){return xr.IJsonObjectTypeDefinition})),n.d(t,"IJsonPrimitiveTypeDefinition",(function(){return xr.IJsonPrimitiveTypeDefinition})),n.d(t,"IJsonRelativeBlobDefinition",(function(){return xr.IJsonRelativeBlobDefinition})),n.d(t,"IJsonStringTypeDefinition",(function(){return xr.IJsonStringTypeDefinition})),n.d(t,"IJsonTupleItemDefinition",(function(){return xr.IJsonTupleItemDefinition})),n.d(t,"IJsonTupleTypeDefinition",(function(){return xr.IJsonTupleTypeDefinition})),n.d(t,"ILargeImageTypeDefinition",(function(){return xr.ILargeImageTypeDefinition})),n.d(t,"INavigationReferentialConstraintsItem",(function(){return xr.INavigationReferentialConstraintsItem})),n.d(t,"ISampleXmlElementTypeDefinition",(function(){return xr.ISampleXmlElementTypeDefinition})),n.d(t,"ITypeDefinition",(function(){return xr.ITypeDefinition})),n.d(t,"ITypeRefDefinition",(function(){return xr.ITypeRefDefinition})),n.d(t,"ITypedDefinitionMetadata",(function(){return xr.ITypedDefinitionMetadata})),n.d(t,"ITypesByName",(function(){return xr.ITypesByName})),n.d(t,"IXmlSimpleIdentityTypeDefinition",(function(){return xr.IXmlSimpleIdentityTypeDefinition})),n.d(t,"IXmlSimpleTypeTypeDefinition",(function(){return xr.IXmlSimpleTypeTypeDefinition}));var Hr=n(59);n.d(t,"IBuiltInFunctionCallDefinition",(function(){return Hr.IBuiltInFunctionCallDefinition})),n.d(t,"IDateTimeFormatExpressionDefinition",(function(){return Hr.IDateTimeFormatExpressionDefinition})),n.d(t,"IFunctionCallArgumentDefinition",(function(){return Hr.IFunctionCallArgumentDefinition})),n.d(t,"IFunctionCallExpressionDefinition",(function(){return Hr.IFunctionCallExpressionDefinition})),n.d(t,"ILiteralExpressionDefinition",(function(){return Hr.ILiteralExpressionDefinition})),n.d(t,"IO365ParseEmailAddressesExpressionDefinition",(function(){return Hr.IO365ParseEmailAddressesExpressionDefinition})),n.d(t,"IParameterReferenceExpressionDefinition",(function(){return Hr.IParameterReferenceExpressionDefinition})),n.d(t,"IQuoteStringExpressionDefinition",(function(){return Hr.IQuoteStringExpressionDefinition})),n.d(t,"IServiceVariableReferenceExpressionDefinition",(function(){return Hr.IServiceVariableReferenceExpressionDefinition})),n.d(t,"IStringFormatExpressionDefinition",(function(){return Hr.IStringFormatExpressionDefinition})),n.d(t,"IValueExpressionDefinition",(function(){return Hr.IValueExpressionDefinition})),n.d(t,"IVariableReferenceExpressionDefinition",(function(){return Hr.IVariableReferenceExpressionDefinition}));var Br=n(214);n.d(t,"Base64BinaryTType",(function(){return Br.Base64BinaryTType}));var qr=n(215);n.d(t,"PABinaryTType",(function(){return qr.PABinaryTType}));var Gr=n(138);n.d(t,"ITypesByPrefixDefinition",(function(){return Gr.ITypesByPrefixDefinition})),n.d(t,"parseTypeDefinition",(function(){return Gr.parseTypeDefinition})),n.d(t,"parseTypedDefinitionMetadata",(function(){return Gr.parseTypedDefinitionMetadata})),n.d(t,"parseTypesManager",(function(){return Gr.parseTypesManager}));var Jr=n(69);n.d(t,"IServiceErrorParams",(function(){return Jr.IServiceErrorParams})),n.d(t,"ServiceError",(function(){return Jr.ServiceError})),n.d(t,"ServiceErrorCodes",(function(){return Jr.ServiceErrorCodes})),n.d(t,"ServiceErrorName",(function(){return Jr.ServiceErrorName}));var Wr=n(42);n.d(t,"addServiceErrorOptions",(function(){return Wr.addServiceErrorOptions}));var zr=n(18);n.d(t,"ApiHub",(function(){return zr.a})),n.d(t,"Connector",(function(){return zr.b})),n.d(t,"Other",(function(){return zr.c})),n.d(t,"RP",(function(){return zr.e})),n.d(t,"ServiceType",(function(){return zr.ServiceType})),n.d(t,"AppMagicServicesServiceType_isValid",(function(){return zr.g}));var Kr=n(11);n.d(t,"WindowsErrorNumber",(function(){return Kr.WindowsErrorNumber})),n.d(t,"addSendHttpPipelinePerf",(function(){return Kr.addSendHttpPipelinePerf})),n.d(t,"castToUnsuccessfulAnyAsyncResult",(function(){return Kr.castToUnsuccessfulAnyAsyncResult})),n.d(t,"computeNormalizedRequestContentType",(function(){return Kr.computeNormalizedRequestContentType})),n.d(t,"createNormalizedErrorFromWinJSXhrErrorAsync",(function(){return Kr.createNormalizedErrorFromWinJSXhrErrorAsync})),n.d(t,"createSendHttpError",(function(){return Kr.createSendHttpError})),n.d(t,"createSendHttpErrorWithResponseAsync",(function(){return Kr.createSendHttpErrorWithResponseAsync})),n.d(t,"createSendHttpPipelineResponseFromXMLHttpRequest",(function(){return Kr.createSendHttpPipelineResponseFromXMLHttpRequest})),n.d(t,"createSuccessfulAsyncResult",(function(){return Kr.createSuccessfulAsyncResult})),n.d(t,"createSuccessfulDataflowResult",(function(){return Kr.createSuccessfulDataflowResult})),n.d(t,"createSuccessfulUndefinedDataflowResult",(function(){return Kr.createSuccessfulUndefinedDataflowResult})),n.d(t,"createUnsuccessfulAsyncResult",(function(){return Kr.createUnsuccessfulAsyncResult})),n.d(t,"createUnsuccessfulDataflowResult",(function(){return Kr.createUnsuccessfulDataflowResult})),n.d(t,"getAllResponseHeadersFromHashTable",(function(){return Kr.getAllResponseHeadersFromHashTable})),n.d(t,"getAsyncResultResultOrThrow",(function(){return Kr.getAsyncResultResultOrThrow})),n.d(t,"getDataflowResultValueOrThrow",(function(){return Kr.getDataflowResultValueOrThrow})),n.d(t,"isParserErrorDocument",(function(){return Kr.isParserErrorDocument})),n.d(t,"normalizeHttpHeaderName",(function(){return Kr.normalizeHttpHeaderName})),n.d(t,"parseResponseHeaders",(function(){return Kr.parseResponseHeaders})),n.d(t,"parseTextResponseToJsonWithStandardErrors",(function(){return Kr.parseTextResponseToJsonWithStandardErrors})),n.d(t,"parseXmlFromStringWithErrorDetection",(function(){return Kr.parseXmlFromStringWithErrorDetection})),n.d(t,"promiseErrorToDataflowResult",(function(){return Kr.promiseErrorToDataflowResult})),n.d(t,"sendHttpErrorHandler_ConvertToAsyncResult",(function(){return Kr.sendHttpErrorHandler_ConvertToAsyncResult})),n.d(t,"tryGetMimeTypeFromContentType",(function(){return Kr.tryGetMimeTypeFromContentType})),n.d(t,"tryGetMimeTypeFromRequestOrResponse",(function(){return Kr.tryGetMimeTypeFromRequestOrResponse}));var Xr=n(281);n.d(t,"ServiceVariable",(function(){return Xr.ServiceVariable}));var Qr=n(14);n.d(t,"sendHttpAsync",(function(){return Qr.sendHttpAsync})),n.d(t,"sendHttpIgnoreResponseAsync",(function(){return Qr.sendHttpIgnoreResponseAsync})),n.d(t,"sendHttpJsonResponseAsync",(function(){return Qr.sendHttpJsonResponseAsync})),n.d(t,"sendHttpTextResponseAsync",(function(){return Qr.sendHttpTextResponseAsync}));var $r=n(30);n.d(t,"TelemetryScheme",(function(){return $r.TelemetryScheme})),n.d(t,"TelemetrySchemeWithSpace",(function(){return $r.TelemetrySchemeWithSpace})),n.d(t,"addTelemetryAdditionalData",(function(){return $r.addTelemetryAdditionalData})),n.d(t,"addTelemetryOptions",(function(){return $r.addTelemetryOptions})),n.d(t,"addTelemetryOptionsToBuilder",(function(){return $r.addTelemetryOptionsToBuilder}));var Zr=n(282);n.d(t,"TemplateRequestParam",(function(){return Zr.TemplateRequestParam}));var Yr=n(187);n.d(t,"CdpAttachmentTType",(function(){return Yr.CdpAttachmentTType}));var eo=n(188);n.d(t,"CdpNavigationTType",(function(){return eo.CdpNavigationTType}));var to=n(189);n.d(t,"CdpOptionSetMultiSelectTType",(function(){return to.CdpOptionSetMultiSelectTType}));var no=n(190);n.d(t,"CdpOptionSetTType",(function(){return no.CdpOptionSetTType}));var ro=n(191);n.d(t,"CdpPolymorphicLookupTType",(function(){return ro.CdpPolymorphicLookupTType}));var oo=n(192);n.d(t,"CdsAttachmentTType",(function(){return oo.CdsAttachmentTType}));var io=n(126);n.d(t,"CdsEntityObjectTType",(function(){return io.CdsEntityObjectTType}));var ao=n(78);n.d(t,"CdsNavigationTTypeRef",(function(){return ao.CdsNavigationTTypeRef}));var so=n(193);n.d(t,"CdsOptionSetMultiSelectTType",(function(){return so.CdsOptionSetMultiSelectTType}));var co=n(77);n.d(t,"CdsOptionSetTType",(function(){return co.CdsOptionSetTType}));var uo=n(94);n.d(t,"CdsPolymorphicLookupTType",(function(){return uo.CdsPolymorphicLookupTType}));var po=n(194);n.d(t,"CdsPolymorphicTTypeRef",(function(){return po.CdsPolymorphicTTypeRef}));var lo=n(57);n.d(t,"optionSetConvertFromDValue",(function(){return lo.optionSetConvertFromDValue})),n.d(t,"optionSetMultiSelectFromDValue",(function(){return lo.optionSetMultiSelectFromDValue}));var fo=n(37);n.d(t,"CdsConstants",(function(){return fo.CdsConstants})),n.d(t,"DateTimeBehavior",(function(){return fo.DateTimeBehavior})),n.d(t,"DateTimeBehaviors",(function(){return fo.DateTimeBehaviors})),n.d(t,"DateTimeFormat",(function(){return fo.DateTimeFormat})),n.d(t,"DateTimeFormats",(function(){return fo.DateTimeFormats})),n.d(t,"SupportedBinaryDTypes",(function(){return fo.SupportedBinaryDTypes}));var yo=n(195);n.d(t,"ConverterTType",(function(){return yo.ConverterTType}));var mo=n(75);n.d(t,"convertHyperlinkToString",(function(){return mo.convertHyperlinkToString})),n.d(t,"convertNumberToString",(function(){return mo.convertNumberToString})),n.d(t,"convertStringToHyperlink",(function(){return mo.convertStringToHyperlink})),n.d(t,"convertStringToNumber",(function(){return mo.convertStringToNumber}));var go=n(150);n.d(t,"createStringConverter",(function(){return go.createStringConverter}));var vo=n(29);n.d(t,"convertDateStringFromDValue",(function(){return vo.convertDateStringFromDValue})),n.d(t,"convertDateStringToDValue",(function(){return vo.convertDateStringToDValue})),n.d(t,"convertDateTimeNumberFromDValue",(function(){return vo.convertDateTimeNumberFromDValue})),n.d(t,"convertDateTimeNumberToDValue",(function(){return vo.convertDateTimeNumberToDValue})),n.d(t,"convertDateTimeStringFromDValue",(function(){return vo.convertDateTimeStringFromDValue})),n.d(t,"convertDateTimeStringToDValue",(function(){return vo.convertDateTimeStringToDValue})),n.d(t,"isAllowedRfc3339DateString",(function(){return vo.isAllowedRfc3339DateString}));var bo=n(50);n.d(t,"DelayedLoadingCdsObjectTType",(function(){return bo.DelayedLoadingCdsObjectTType})),n.d(t,"IDelayedLoadingTType",(function(){return bo.IDelayedLoadingTType}));var ho=n(283);n.d(t,"DomNodeTType",(function(){return ho.DomNodeTType}));var Ao=n(7);n.d(t,"HttpStringBasedTTypeValueKinds",(function(){return Ao.HttpStringBasedTTypeValueKinds})),n.d(t,"JsonTTypeValueKinds",(function(){return Ao.JsonTTypeValueKinds})),n.d(t,"NumericXsdType",(function(){return Ao.NumericXsdType})),n.d(t,"TTypeValueKind",(function(){return Ao.TTypeValueKind})),n.d(t,"XmlSimpleTTypeValueKinds",(function(){return Ao.XmlSimpleTTypeValueKinds}));var Co=n(56);n.d(t,"DataSourceType",(function(){return Co.DataSourceType})),n.d(t,"FileNameHeader",(function(){return Co.FileNameHeader})),n.d(t,"TempFileUrl",(function(){return Co.TempFileUrl}));var Po=n(196);n.d(t,"FileTType",(function(){return Po.FileTType}));var wo=n(284);n.d(t,"HttpStringTType",(function(){return wo.HttpStringTType}));var So=n(242);n.d(t,"IDValueConverter",(function(){return So.IDValueConverter})),n.d(t,"IDValueConverterTarget",(function(){return So.IDValueConverterTarget}));var Oo=n(343);n.d(t,"ISchemaProvider",(function(){return Oo.ISchemaProvider}));var Ro=n(243);n.d(t,"IServiceTType",(function(){return Ro.IServiceTType})),n.d(t,"ITValueContext",(function(){return Ro.ITValueContext}));var _o=n(127);n.d(t,"IdentityTType",(function(){return _o.IdentityTType})),n.d(t,"XmlIdentityTType",(function(){return _o.XmlIdentityTType}));var To=n(74);n.d(t,"JsonArrayTType",(function(){return To.JsonArrayTType}));var Io=n(197);n.d(t,"JsonBooleanTType",(function(){return Io.JsonBooleanTType}));var Eo=n(198);n.d(t,"JsonDateStringTType",(function(){return Eo.JsonDateStringTType}));var Uo=n(199);n.d(t,"JsonDateTimeNoTimeZoneStringTType",(function(){return Uo.JsonDateTimeNoTimeZoneStringTType}));var jo=n(200);n.d(t,"JsonDateTimeNumberTType",(function(){return jo.JsonDateTimeNumberTType}));var No=n(201);n.d(t,"JsonDateTimeStringTType",(function(){return No.JsonDateTimeStringTType}));var Do=n(202);n.d(t,"JsonGuidTType",(function(){return Do.JsonGuidTType}));var Vo=n(203);n.d(t,"JsonMapObjectTType",(function(){return Vo.JsonMapObjectTType}));var Mo=n(204);n.d(t,"JsonNumberTType",(function(){return Mo.JsonNumberTType}));var ko=n(144);n.d(t,"IJsonObjectTTypeProperty",(function(){return ko.IJsonObjectTTypeProperty})),n.d(t,"JsonObjectTType",(function(){return ko.JsonObjectTType}));var Lo=n(205);n.d(t,"JsonUntypedObjectTType",(function(){return Lo.JsonUntypedObjectTType}));var Fo=n(206);n.d(t,"JsonStringTType",(function(){return Fo.JsonStringTType}));var xo=n(128);n.d(t,"JsonTupleTType",(function(){return xo.JsonTupleTType})),n.d(t,"JsonTupleTTypeItem",(function(){return xo.JsonTupleTTypeItem}));var Ho=n(207);n.d(t,"LargeImageTType",(function(){return Ho.LargeImageTType}));var Bo=n(208);n.d(t,"SampleXmlElementTType",(function(){return Bo.SampleXmlElementTType}));var qo=n(66);n.d(t,"ITTypeRef",(function(){return qo.ITTypeRef})),n.d(t,"InlinedTTypeRef",(function(){return qo.InlinedTTypeRef})),n.d(t,"LazyTTypeRef",(function(){return qo.LazyTTypeRef}));var Go=n(10);n.d(t,"DTableOfValues",(function(){return Go.DTableOfValues})),n.d(t,"computeDValueSchemaForArrayTType",(function(){return Go.computeDValueSchemaForArrayTType})),n.d(t,"convertArrayOfTItemsToDTable",(function(){return Go.convertArrayOfTItemsToDTable})),n.d(t,"convertDTableToArrayOfTItems",(function(){return Go.convertDTableToArrayOfTItems})),n.d(t,"convertFromDValueAsync",(function(){return Go.convertFromDValueAsync})),n.d(t,"isExpressionRuntime",(function(){return Go.isExpressionRuntime})),n.d(t,"isNaNType",(function(){return Go.isNaNType})),n.d(t,"makeODataEntityRecordPointer",(function(){return Go.makeODataEntityRecordPointer})),n.d(t,"tryGetPrimaryKey",(function(){return Go.tryGetPrimaryKey}));var Jo=n(91);n.d(t,"IReadOnlyTypesManager",(function(){return Jo.IReadOnlyTypesManager})),n.d(t,"TypesManager",(function(){return Jo.TypesManager}));var Wo=n(209);n.d(t,"XmlAnyUriTType",(function(){return Wo.XmlAnyUriTType}));var zo=n(210);n.d(t,"XmlBooleanTType",(function(){return zo.XmlBooleanTType}));var Ko=n(211);n.d(t,"XmlDateTimeTType",(function(){return Ko.XmlDateTimeTType}));var Xo=n(212);n.d(t,"XmlNumericTType",(function(){return Xo.XmlNumericTType}));var Qo=n(213);n.d(t,"XmlStringTType",(function(){return Qo.XmlStringTType}));var $o=n(55);n.d(t,"XsdTypeNames",(function(){return $o.XsdTypeNames})),n.d(t,"coerceNumberToXsdNumericType",(function(){return $o.coerceNumberToXsdNumericType})),n.d(t,"tryParseNumericXsdTypeFromXsdTypeName",(function(){return $o.tryParseNumericXsdTypeFromXsdTypeName}));var Zo=n(123);n.d(t,"TypedRequestParamBase",(function(){return Zo.TypedRequestParamBase}));var Yo=n(285);n.d(t,"DeviceCapabilityConsentSerializer",(function(){return Yo.DeviceCapabilityConsentSerializer}));var ei=n(137);n.d(t,"isLaunchableUrl",(function(){return ei.isLaunchableUrl})),n.d(t,"parseFormUrlEncodedStringToHashTable",(function(){return ei.parseFormUrlEncodedStringToHashTable})),n.d(t,"parseUriComponents",(function(){return ei.parseUriComponents})),n.d(t,"urlHasProtocol",(function(){return ei.urlHasProtocol}));var ti=n(12);n.d(t,"IsMdlIntegrationEnabled",(function(){return ti.a})),n.d(t,"createInferredSchemaFromArray",(function(){return ti.b})),n.d(t,"createInferredSchemaFromObject",(function(){return ti.c})),n.d(t,"encodeJsonPointerReferenceToken",(function(){return ti.d})),n.d(t,"escapeXmlString",(function(){return ti.e})),n.d(t,"flattenSchema",(function(){return ti.f})),n.d(t,"getJsonValueViaJsonPointer",(function(){return ti.i})),n.d(t,"getJsonValueViaJsonPointerExtended",(function(){return ti.j})),n.d(t,"hasHtml",(function(){return ti.l})),n.d(t,"isExpectedMediaType",(function(){return ti.m})),n.d(t,"isJsonPointer",(function(){return ti.o})),n.d(t,"isSignInCancelError",(function(){return ti.q})),n.d(t,"jsonClone",(function(){return ti.r})),n.d(t,"parseJsonPointer",(function(){return ti.s})),n.d(t,"replaceAllSingleOrDoubleQuotes",(function(){return ti.t})),n.d(t,"stripHtml",(function(){return ti.u})),n.d(t,"tryPopFirstDecodedReferenceToken",(function(){return ti.v})),n.d(t,"getCdsMdlMetadataClient",(function(){return ti.h})),n.d(t,"isMdlIntegrationEnabled_TestOnly",(function(){return ti.p}));var ni=n(104);n.d(t,"json2xml",(function(){return ni.json2xml})),n.d(t,"xml2json",(function(){return ni.xml2json}));var ri=n(186);n.d(t,"XmlSelection",(function(){return ri.XmlSelection}));var oi=n(178);n.d(t,"WinJSPABinaryResolver",(function(){return oi.WinJSPABinaryResolver}));var ii=n(344);n.d(t,"ISerializedXmlHttpRequest",(function(){return ii.ISerializedXmlHttpRequest}));var ai=n(345);n.d(t,"IXmlHttpRequestSender",(function(){return ai.IXmlHttpRequestSender}));var si=n(87);n.d(t,"PostMessageXmlHttpRequestConstants",(function(){return si.PostMessageXmlHttpRequestConstants}));var ci=n(175);n.d(t,"PostMessageXmlHttpRequestReceiver",(function(){return ci.PostMessageXmlHttpRequestReceiver}));var ui=n(176);n.d(t,"PostMessageXmlHttpRequestSender",(function(){return ui.PostMessageXmlHttpRequestSender}));var pi=n(174);n.d(t,"XmlHttpRequestFactory",(function(){return pi.XmlHttpRequestFactory}));var li=n(177);n.d(t,"XmlHttpRequestSender",(function(){return li.XmlHttpRequestSender}));var di=n(108);n.d(t,"XmlHttpRequestSerializer",(function(){return di.XmlHttpRequestSerializer}));var fi=n(1);n.d(t,"AcquireLeaseServerResponse",(function(){return fi.a})),n.d(t,"AppMagicConnectionHubDataInterfaces_ApiConnectionParameterSets",(function(){return fi.b})),n.d(t,"ApiConnectionParametersResponse",(function(){return fi.c})),n.d(t,"ApiConnectionParametersSet",(function(){return fi.d})),n.d(t,"ApiConnectionReference",(function(){return fi.e})),n.d(t,"ApiInterface",(function(){return fi.f})),n.d(t,"ApiInterfaceRevision",(function(){return fi.g})),n.d(t,"ApiMetadata",(function(){return fi.h})),n.d(t,"ApiPropertiesResponse",(function(){return fi.i})),n.d(t,"ApiReference",(function(){return fi.j})),n.d(t,"ApiResponse",(function(){return fi.k})),n.d(t,"ApiScopes",(function(){return fi.l})),n.d(t,"AppClientVersion",(function(){return fi.n})),n.d(t,"AppInfoAuthor",(function(){return fi.p})),n.d(t,"AppModuleSettingsDetail",(function(){return fi.q})),n.d(t,"AppOverrides",(function(){return fi.r})),n.d(t,"AppPackage",(function(){return fi.s})),n.d(t,"AppProperties",(function(){return fi.t})),n.d(t,"AppUri",(function(){return fi.v})),n.d(t,"AppUris",(function(){return fi.w})),n.d(t,"AuthorizationOptions",(function(){return fi.y})),n.d(t,"CanvasStudioVersionsResponse",(function(){return fi.B})),n.d(t,"CanvasStudioVersionsResponseVersion",(function(){return fi.C})),n.d(t,"CdsDatabaseReference",(function(){return fi.D})),n.d(t,"CdsMigrationDetails",(function(){return fi.F})),n.d(t,"CdsPVABotsResponse",(function(){return fi.G})),n.d(t,"CheckPlansResponse",(function(){return fi.H})),n.d(t,"ClientConfiguration",(function(){return fi.J})),n.d(t,"ClientConfigurationSet",(function(){return fi.K})),n.d(t,"ClientIPResponse",(function(){return fi.L})),n.d(t,"CommonAppProperties",(function(){return fi.N})),n.d(t,"ConnectionParameterConstraints",(function(){return fi.O})),n.d(t,"ConnectionParameterSet",(function(){return fi.P})),n.d(t,"ConnectionPropertiesResponse",(function(){return fi.Q})),n.d(t,"ConnectionPropertiesResponseStatusResponse",(function(){return fi.R})),n.d(t,"ConnectionPropertiesResponseTestLink",(function(){return fi.S})),n.d(t,"ConnectionReferenceInfo",(function(){return fi.T})),n.d(t,"ConnectionResponse",(function(){return fi.U})),n.d(t,"ConnectionUsage",(function(){return fi.V})),n.d(t,"ConnectionUsageProperties",(function(){return fi.W})),n.d(t,"ConnectorResponseError",(function(){return fi.X})),n.d(t,"ConnectorResponseGatewayError",(function(){return fi.Y})),n.d(t,"ConsentInfoResponse",(function(){return fi.Z})),n.d(t,"CoreAppComponentInfoProperties",(function(){return fi.ab})),n.d(t,"CreatedBy",(function(){return fi.bb})),n.d(t,"CustomHeadersOptions",(function(){return fi.hb})),n.d(t,"DataSourceReference",(function(){return fi.ib})),n.d(t,"DataUsage",(function(){return fi.jb})),n.d(t,"DataUsageParameter",(function(){return fi.kb})),n.d(t,"DatabaseDataSource",(function(){return fi.lb})),n.d(t,"DatasetMetadata",(function(){return fi.mb})),n.d(t,"DatasetReference",(function(){return fi.nb})),n.d(t,"DocServerTestProfile",(function(){return fi.ob})),n.d(t,"DocServerTestProfileSettings",(function(){return fi.pb})),n.d(t,"DocServerTestProfileVariant",(function(){return fi.qb})),n.d(t,"DocumentServerVersion",(function(){return fi.rb})),n.d(t,"DraftResources",(function(){return fi.sb})),n.d(t,"DynamicTreeOptions",(function(){return fi.tb})),n.d(t,"DynamicTreeSelectOption",(function(){return fi.ub})),n.d(t,"EmbeddedApp",(function(){return fi.vb})),n.d(t,"EmbeddedAppPropertySet",(function(){return fi.wb})),n.d(t,"EnrollResponse",(function(){return fi.xb})),n.d(t,"EnrollResponseGraphTenantDetails",(function(){return fi.yb})),n.d(t,"EnrollResponsePlanDetailPolicies",(function(){return fi.zb})),n.d(t,"EnrollResponsePlanDetailProperties",(function(){return fi.Ab})),n.d(t,"EnrollResponsePlanDetails",(function(){return fi.Bb})),n.d(t,"EnrollResponseTenant",(function(){return fi.Cb})),n.d(t,"EnrollmentOptionsResponse",(function(){return fi.Db})),n.d(t,"EnvironmentCadence",(function(){return fi.Fb})),n.d(t,"EnvironmentPropertiesConnectedGroup",(function(){return fi.Hb})),n.d(t,"EnvironmentPropertiesResponse",(function(){return fi.Ib})),n.d(t,"EnvironmentReference",(function(){return fi.Jb})),n.d(t,"EnvironmentResponse",(function(){return fi.Kb})),n.d(t,"EvaluatePolicyRequest",(function(){return fi.Mb})),n.d(t,"EvaluatePolicyResponse",(function(){return fi.Nb})),n.d(t,"FileServiceItem",(function(){return fi.Pb})),n.d(t,"FileSourceSet",(function(){return fi.Qb})),n.d(t,"Gateway",(function(){return fi.Yb})),n.d(t,"GatewayConnectionParameter",(function(){return fi.Zb})),n.d(t,"GatewayProperties",(function(){return fi.ac})),n.d(t,"GetApisOrConnectionsResponse",(function(){return fi.bc})),n.d(t,"GetConnectionConsentLinkResponse",(function(){return fi.cc})),n.d(t,"GetGatewaysResponse",(function(){return fi.ec})),n.d(t,"GlobalConfigSettingResponse",(function(){return fi.fc})),n.d(t,"GraphUser",(function(){return fi.hc})),n.d(t,"IAcquireLeaseServerResponse",(function(){return fi.IAcquireLeaseServerResponse})),n.d(t,"IApiConnectionParameterSets",(function(){return fi.IApiConnectionParameterSets})),n.d(t,"IApiConnectionParametersResponse",(function(){return fi.IApiConnectionParametersResponse})),n.d(t,"IApiConnectionParametersSet",(function(){return fi.IApiConnectionParametersSet})),n.d(t,"IApiConnectionReference",(function(){return fi.IApiConnectionReference})),n.d(t,"IApiInterface",(function(){return fi.IApiInterface})),n.d(t,"IApiInterfaceRevision",(function(){return fi.IApiInterfaceRevision})),n.d(t,"IApiMetadata",(function(){return fi.IApiMetadata})),n.d(t,"IApiPropertiesResponse",(function(){return fi.IApiPropertiesResponse})),n.d(t,"IApiReference",(function(){return fi.IApiReference})),n.d(t,"IApiResponse",(function(){return fi.IApiResponse})),n.d(t,"AppMagicConnectionHubDataInterfaces_IApiScopes",(function(){return fi.IApiScopes})),n.d(t,"IAppClientVersion",(function(){return fi.IAppClientVersion})),n.d(t,"IAppInfoAuthor",(function(){return fi.IAppInfoAuthor})),n.d(t,"IAppModuleSettingsDetail",(function(){return fi.IAppModuleSettingsDetail})),n.d(t,"IAppOverrides",(function(){return fi.IAppOverrides})),n.d(t,"IAppPackage",(function(){return fi.IAppPackage})),n.d(t,"IAppProperties",(function(){return fi.IAppProperties})),n.d(t,"IAppUri",(function(){return fi.IAppUri})),n.d(t,"IAppUris",(function(){return fi.IAppUris})),n.d(t,"IAuthorizationOptions",(function(){return fi.IAuthorizationOptions})),n.d(t,"IBAPTenantDataResponse",(function(){return fi.IBAPTenantDataResponse})),n.d(t,"ICanvasStudioVersionsResponse",(function(){return fi.ICanvasStudioVersionsResponse})),n.d(t,"ICanvasStudioVersionsResponseVersion",(function(){return fi.ICanvasStudioVersionsResponseVersion})),n.d(t,"ICdsDatabaseReference",(function(){return fi.ICdsDatabaseReference})),n.d(t,"ICdsMigrationDetails",(function(){return fi.ICdsMigrationDetails})),n.d(t,"ICheckPlansResponse",(function(){return fi.ICheckPlansResponse})),n.d(t,"IClientConfiguration",(function(){return fi.IClientConfiguration})),n.d(t,"IClientConfigurationSet",(function(){return fi.IClientConfigurationSet})),n.d(t,"IClientIPResponse",(function(){return fi.IClientIPResponse})),n.d(t,"ICommonAppProperties",(function(){return fi.ICommonAppProperties})),n.d(t,"IConnectionParameterConstraints",(function(){return fi.IConnectionParameterConstraints})),n.d(t,"IConnectionParameterSet",(function(){return fi.IConnectionParameterSet})),n.d(t,"IConnectionPropertiesResponse",(function(){return fi.IConnectionPropertiesResponse})),n.d(t,"IConnectionPropertiesResponseStatusResponse",(function(){return fi.IConnectionPropertiesResponseStatusResponse})),n.d(t,"IConnectionPropertiesResponseTestLink",(function(){return fi.IConnectionPropertiesResponseTestLink})),n.d(t,"IConnectionReferenceInfo",(function(){return fi.IConnectionReferenceInfo})),n.d(t,"IConnectionResponse",(function(){return fi.IConnectionResponse})),n.d(t,"IConnectionUsage",(function(){return fi.IConnectionUsage})),n.d(t,"IConnectionUsageProperties",(function(){return fi.IConnectionUsageProperties})),n.d(t,"IConnectorResponseError",(function(){return fi.IConnectorResponseError})),n.d(t,"IConnectorResponseGatewayError",(function(){return fi.IConnectorResponseGatewayError})),n.d(t,"IConsentInfoResponse",(function(){return fi.IConsentInfoResponse})),n.d(t,"ICoreAppComponentInfoProperties",(function(){return fi.ICoreAppComponentInfoProperties})),n.d(t,"AppMagicConnectionHubDataInterfaces_ICreatedBy",(function(){return fi.ICreatedBy})),n.d(t,"ICustomHeadersOptions",(function(){return fi.ICustomHeadersOptions})),n.d(t,"IDataSourceReference",(function(){return fi.IDataSourceReference})),n.d(t,"IDataUsage",(function(){return fi.IDataUsage})),n.d(t,"IDataUsageParameter",(function(){return fi.IDataUsageParameter})),n.d(t,"IDatabaseDataSource",(function(){return fi.IDatabaseDataSource})),n.d(t,"IDatasetMetadata",(function(){return fi.IDatasetMetadata})),n.d(t,"IDatasetReference",(function(){return fi.IDatasetReference})),n.d(t,"IDocServerTestProfile",(function(){return fi.IDocServerTestProfile})),n.d(t,"IDocServerTestProfileSettings",(function(){return fi.IDocServerTestProfileSettings})),n.d(t,"IDocServerTestProfileVariant",(function(){return fi.IDocServerTestProfileVariant})),n.d(t,"IDocumentServerVersion",(function(){return fi.IDocumentServerVersion})),n.d(t,"IDraftResources",(function(){return fi.IDraftResources})),n.d(t,"IDynamicTreeOptions",(function(){return fi.IDynamicTreeOptions})),n.d(t,"IDynamicTreeSelectOption",(function(){return fi.IDynamicTreeSelectOption})),n.d(t,"IEmbeddedApp",(function(){return fi.IEmbeddedApp})),n.d(t,"IEmbeddedAppPropertySet",(function(){return fi.IEmbeddedAppPropertySet})),n.d(t,"IEnrollResponse",(function(){return fi.IEnrollResponse})),n.d(t,"IEnrollResponseGraphTenantDetails",(function(){return fi.IEnrollResponseGraphTenantDetails})),n.d(t,"IEnrollResponsePlanDetailPolicies",(function(){return fi.IEnrollResponsePlanDetailPolicies})),n.d(t,"IEnrollResponsePlanDetailProperties",(function(){return fi.IEnrollResponsePlanDetailProperties})),n.d(t,"IEnrollResponsePlanDetails",(function(){return fi.IEnrollResponsePlanDetails})),n.d(t,"IEnrollResponseTenant",(function(){return fi.IEnrollResponseTenant})),n.d(t,"IEnrollmentOptionsResponse",(function(){return fi.IEnrollmentOptionsResponse})),n.d(t,"IEnvironmentCadence",(function(){return fi.IEnvironmentCadence})),n.d(t,"IEnvironmentPropertiesConnectedGroup",(function(){return fi.IEnvironmentPropertiesConnectedGroup})),n.d(t,"IEnvironmentPropertiesResponse",(function(){return fi.IEnvironmentPropertiesResponse})),n.d(t,"IEnvironmentReference",(function(){return fi.IEnvironmentReference})),n.d(t,"IEnvironmentResponse",(function(){return fi.IEnvironmentResponse})),n.d(t,"IEvaluatePolicyForAppResponse",(function(){return fi.IEvaluatePolicyForAppResponse})),n.d(t,"IEvaluatePolicyRequest",(function(){return fi.IEvaluatePolicyRequest})),n.d(t,"IEvaluatePolicyResponse",(function(){return fi.IEvaluatePolicyResponse})),n.d(t,"IFlowMetadata",(function(){return fi.IFlowMetadata})),n.d(t,"IFlowMetadataEx",(function(){return fi.IFlowMetadataEx})),n.d(t,"IFileServiceItem",(function(){return fi.IFileServiceItem})),n.d(t,"IFileSourceSet",(function(){return fi.IFileSourceSet})),n.d(t,"IFlowMachineGroup",(function(){return fi.IFlowMachineGroup})),n.d(t,"IFlowTrigger",(function(){return fi.IFlowTrigger})),n.d(t,"FlowTriggersApiProperties",(function(){return fi.Xb})),n.d(t,"IGateway",(function(){return fi.IGateway})),n.d(t,"IGatewayConnectionParameter",(function(){return fi.IGatewayConnectionParameter})),n.d(t,"IGatewayProperties",(function(){return fi.IGatewayProperties})),n.d(t,"IGetApisOrConnectionsResponse",(function(){return fi.IGetApisOrConnectionsResponse})),n.d(t,"IGetConnectionConsentLinkResponse",(function(){return fi.IGetConnectionConsentLinkResponse})),n.d(t,"IGetFlowMachineGroupsResponse",(function(){return fi.IGetFlowMachineGroupsResponse})),n.d(t,"IGetGatewaysResponse",(function(){return fi.IGetGatewaysResponse})),n.d(t,"IGraphUser",(function(){return fi.IGraphUser})),n.d(t,"IGlobalConfigSettingResponse",(function(){return fi.IGlobalConfigSettingResponse})),n.d(t,"IInstallFlowRequest",(function(){return fi.IInstallFlowRequest})),n.d(t,"IInstallFlowResponse",(function(){return fi.IInstallFlowResponse})),n.d(t,"IIsPaiEnabledResponse",(function(){return fi.IIsPaiEnabledResponse})),n.d(t,"IIsPaiEnabledResponseTemplate",(function(){return fi.IIsPaiEnabledResponseTemplate})),n.d(t,"IJsonErrorResponse",(function(){return fi.IJsonErrorResponse})),n.d(t,"ILastPublishedBy",(function(){return fi.ILastPublishedBy})),n.d(t,"ILastUsedEnvironmentMetadata",(function(){return fi.ILastUsedEnvironmentMetadata})),n.d(t,"ILaunchAppServerResponse",(function(){return fi.ILaunchAppServerResponse})),n.d(t,"ILinkedEnvironmentMetadata",(function(){return fi.ILinkedEnvironmentMetadata})),n.d(t,"IListAppPackageResponse",(function(){return fi.IListAppPackageResponse})),n.d(t,"IAppExtendedMetadata",(function(){return fi.IAppExtendedMetadata})),n.d(t,"ILocalConnection",(function(){return fi.ILocalConnection})),n.d(t,"IMobileCustomBrandingConfig",(function(){return fi.IMobileCustomBrandingConfig})),n.d(t,"IModelAppProperties",(function(){return fi.IModelAppProperties})),n.d(t,"IMsFlowSet",(function(){return fi.IMsFlowSet})),n.d(t,"IMultiAuthConnectionParameterValue",(function(){return fi.IMultiAuthConnectionParameterValue})),n.d(t,"IMultiAuthConnectionParametersSet",(function(){return fi.IMultiAuthConnectionParametersSet})),n.d(t,"INpsPromptResponse",(function(){return fi.INpsPromptResponse})),n.d(t,"IOAuthSettingsResponse",(function(){return fi.IOAuthSettingsResponse})),n.d(t,"IOptInCountryResponse",(function(){return fi.IOptInCountryResponse})),n.d(t,"IOptInCountryResponseDetails",(function(){return fi.IOptInCountryResponseDetails})),n.d(t,"IOptInUserConsentData",(function(){return fi.IOptInUserConsentData})),n.d(t,"IOptInUserConsentDataDetails",(function(){return fi.IOptInUserConsentDataDetails})),n.d(t,"IPackageUri",(function(){return fi.IPackageUri})),n.d(t,"IParameterHint",(function(){return fi.IParameterHint})),n.d(t,"IPlansResponse",(function(){return fi.IPlansResponse})),n.d(t,"IPostConnectionUsageRequest",(function(){return fi.IPostConnectionUsageRequest})),n.d(t,"IPremiumFeatures",(function(){return fi.IPremiumFeatures})),n.d(t,"IPutConnectionParametersSet",(function(){return fi.IPutConnectionParametersSet})),n.d(t,"IPutConnectionParametersSetValue",(function(){return fi.IPutConnectionParametersSetValue})),n.d(t,"IPutConnectionRequest",(function(){return fi.IPutConnectionRequest})),n.d(t,"IPutConnectionRequestProperties",(function(){return fi.IPutConnectionRequestProperties})),n.d(t,"IRecordScopeConsent",(function(){return fi.IRecordScopeConsent})),n.d(t,"IRecordScopeConsentRequest",(function(){return fi.IRecordScopeConsentRequest})),n.d(t,"IResourceProviderResponseError",(function(){return fi.IResourceProviderResponseError})),n.d(t,"IRuntimeEndpoints",(function(){return fi.IRuntimeEndpoints})),n.d(t,"IRuntimeNamespaceOwner",(function(){return fi.IRuntimeNamespaceOwner})),n.d(t,"IRuntimeUserNamespace",(function(){return fi.IRuntimeUserNamespace})),n.d(t,"IRuntimeUserNamespaceProperties",(function(){return fi.IRuntimeUserNamespaceProperties})),n.d(t,"IRuntimeUserNamespaceResponse",(function(){return fi.IRuntimeUserNamespaceResponse})),n.d(t,"IServerAppInfo",(function(){return fi.IServerAppInfo})),n.d(t,"IServerAuthReference",(function(){return fi.IServerAuthReference})),n.d(t,"IServerCommonAppInfo",(function(){return fi.IServerCommonAppInfo})),n.d(t,"IServerComponentInfo",(function(){return fi.IServerComponentInfo})),n.d(t,"IServerConnectionReference",(function(){return fi.IServerConnectionReference})),n.d(t,"IServerListConnectionUsage",(function(){return fi.IServerListConnectionUsage})),n.d(t,"IServerModelAppInfo",(function(){return fi.IServerModelAppInfo})),n.d(t,"IServerSharepointEmbeddedApp",(function(){return fi.IServerSharepointEmbeddedApp})),n.d(t,"IServerUserConsent",(function(){return fi.IServerUserConsent})),n.d(t,"IServiceErrorOptions",(function(){return fi.IServiceErrorOptions})),n.d(t,"ISharePointConnectorErrorResponse",(function(){return fi.ISharePointConnectorErrorResponse})),n.d(t,"ISolutionFlowMetadata",(function(){return fi.ISolutionFlowMetadata})),n.d(t,"ISolutionInfo",(function(){return fi.ISolutionInfo})),n.d(t,"ISolutionVersionResponse",(function(){return fi.ISolutionVersionResponse})),n.d(t,"ITabularMetadata",(function(){return fi.ITabularMetadata})),n.d(t,"ITabularMetadataParameter",(function(){return fi.ITabularMetadataParameter})),n.d(t,"ITabularParameterItem",(function(){return fi.ITabularParameterItem})),n.d(t,"ITelemetryOptions",(function(){return fi.ITelemetryOptions})),n.d(t,"ITemplateCategoryResponseValue",(function(){return fi.ITemplateCategoryResponseValue})),n.d(t,"ITemplateResponse",(function(){return fi.ITemplateResponse})),n.d(t,"ITemplateResponseArtifact",(function(){return fi.ITemplateResponseArtifact})),n.d(t,"ITemplateResponseImage",(function(){return fi.ITemplateResponseImage})),n.d(t,"ITemplateResponseImageContext",(function(){return fi.ITemplateResponseImageContext})),n.d(t,"ITemplateResponseMetadata",(function(){return fi.ITemplateResponseMetadata})),n.d(t,"ITemplateResponseProperties",(function(){return fi.ITemplateResponseProperties})),n.d(t,"ITemplateResponseValue",(function(){return fi.ITemplateResponseValue})),n.d(t,"ITenant",(function(){return fi.ITenant})),n.d(t,"ITenants",(function(){return fi.ITenants})),n.d(t,"ITestProfile",(function(){return fi.ITestProfile})),n.d(t,"IUIDefinitionResponse",(function(){return fi.IUIDefinitionResponse})),n.d(t,"IUnifiedAppIcons",(function(){return fi.IUnifiedAppIcons})),n.d(t,"IUnifiedAppInfo",(function(){return fi.IUnifiedAppInfo})),n.d(t,"IUnifiedAppProperties",(function(){return fi.IUnifiedAppProperties})),n.d(t,"IUpdateVersion",(function(){return fi.IUpdateVersion})),n.d(t,"IUserAppMetadata",(function(){return fi.IUserAppMetadata})),n.d(t,"IUserConnectionForAppPropertiesResponse",(function(){return fi.IUserConnectionForAppPropertiesResponse})),n.d(t,"IUserConnectionForAppResponse",(function(){return fi.IUserConnectionForAppResponse})),n.d(t,"IUserFeatureResponse",(function(){return fi.IUserFeatureResponse})),n.d(t,"IUserFeaturesResponse",(function(){return fi.IUserFeaturesResponse})),n.d(t,"IUserObjectResponse",(function(){return fi.IUserObjectResponse})),n.d(t,"IUserPlans",(function(){return fi.IUserPlans})),n.d(t,"IUserProperties",(function(){return fi.IUserProperties})),n.d(t,"IValidateAppDisplayNameServerResponse",(function(){return fi.IValidateAppDisplayNameServerResponse})),n.d(t,"IViolation",(function(){return fi.IViolation})),n.d(t,"IViolationParameters",(function(){return fi.IViolationParameters})),n.d(t,"IViolationPolicy",(function(){return fi.IViolationPolicy})),n.d(t,"IWebAuthenticationResponse",(function(){return fi.IWebAuthenticationResponse})),n.d(t,"IXrmConnectionReferences",(function(){return fi.IXrmConnectionReferences})),n.d(t,"InstallFlowRequest",(function(){return fi.Kf})),n.d(t,"InstallFlowResponse",(function(){return fi.Lf})),n.d(t,"IsPaiEnabledResponse",(function(){return fi.Mf})),n.d(t,"IsPaiEnabledResponseTemplate",(function(){return fi.Nf})),n.d(t,"JsonErrorResponse",(function(){return fi.Of})),n.d(t,"LastPublishedBy",(function(){return fi.Pf})),n.d(t,"LastUsedEnvironmentMetadata",(function(){return fi.Qf})),n.d(t,"LaunchAppServerResponse",(function(){return fi.Rf})),n.d(t,"LinkedEnvironmentMetadata",(function(){return fi.Sf})),n.d(t,"ListAppPackageResponse",(function(){return fi.Uf})),n.d(t,"LocalConnection",(function(){return fi.Vf})),n.d(t,"ModelAppProperties",(function(){return fi.Yf})),n.d(t,"MsFlowSet",(function(){return fi.Zf})),n.d(t,"MultiAuthConnectionParameterValue",(function(){return fi.ag})),n.d(t,"MultiAuthConnectionParametersSet",(function(){return fi.bg})),n.d(t,"NpsPromptResponse",(function(){return fi.dg})),n.d(t,"OAuthSettingsResponse",(function(){return fi.eg})),n.d(t,"OptInCountryResponse",(function(){return fi.gg})),n.d(t,"OptInCountryResponseDetails",(function(){return fi.hg})),n.d(t,"OptInUserConsentData",(function(){return fi.ig})),n.d(t,"OptInUserConsentDataDetails",(function(){return fi.jg})),n.d(t,"PackageUri",(function(){return fi.mg})),n.d(t,"ParameterHint",(function(){return fi.ng})),n.d(t,"PlansResponse",(function(){return fi.og})),n.d(t,"PostConnectionUsageRequest",(function(){return fi.pg})),n.d(t,"PremiumFeatures",(function(){return fi.qg})),n.d(t,"PutConnectionParametersSet",(function(){return fi.sg})),n.d(t,"PutConnectionParametersSetValue",(function(){return fi.tg})),n.d(t,"PutConnectionRequest",(function(){return fi.ug})),n.d(t,"PutConnectionRequestProperties",(function(){return fi.vg})),n.d(t,"RecordScopeConsent",(function(){return fi.wg})),n.d(t,"RecordScopeConsentRequest",(function(){return fi.xg})),n.d(t,"ResourceProviderResponseError",(function(){return fi.yg})),n.d(t,"RuntimeEndpoints",(function(){return fi.Ag})),n.d(t,"RuntimeNamespaceOwner",(function(){return fi.Bg})),n.d(t,"RuntimeUserNamespace",(function(){return fi.Cg})),n.d(t,"RuntimeUserNamespaceProperties",(function(){return fi.Dg})),n.d(t,"RuntimeUserNamespaceResponse",(function(){return fi.Eg})),n.d(t,"ServerAppInfo",(function(){return fi.Fg})),n.d(t,"ServerAuthReference",(function(){return fi.Gg})),n.d(t,"ServerCommonAppInfo",(function(){return fi.Hg})),n.d(t,"ServerComponentInfo",(function(){return fi.Ig})),n.d(t,"ServerConnectionReference",(function(){return fi.Jg})),n.d(t,"ServerListConnectionUsage",(function(){return fi.Kg})),n.d(t,"ServerModelAppInfo",(function(){return fi.Lg})),n.d(t,"ServerSharepointEmbeddedApp",(function(){return fi.Mg})),n.d(t,"ServerUserConsent",(function(){return fi.Ng})),n.d(t,"ServiceErrorOptions",(function(){return fi.Og})),n.d(t,"SharePointConnectorErrorResponse",(function(){return fi.Pg})),n.d(t,"SolutionInfo",(function(){return fi.Sg})),n.d(t,"SolutionVersionResponse",(function(){return fi.Tg})),n.d(t,"TabularMetadata",(function(){return fi.Ug})),n.d(t,"TabularMetadataParameter",(function(){return fi.Vg})),n.d(t,"TabularParameterItem",(function(){return fi.Wg})),n.d(t,"TelemetryOptions",(function(){return fi.Yg})),n.d(t,"TemplateCategoryResponseValue",(function(){return fi.Zg})),n.d(t,"TemplateResponse",(function(){return fi.ah})),n.d(t,"TemplateResponseArtifact",(function(){return fi.bh})),n.d(t,"TemplateResponseImage",(function(){return fi.ch})),n.d(t,"TemplateResponseImageContext",(function(){return fi.dh})),n.d(t,"TemplateResponseMetadata",(function(){return fi.eh})),n.d(t,"TemplateResponseProperties",(function(){return fi.fh})),n.d(t,"TemplateResponseValue",(function(){return fi.gh})),n.d(t,"Tenant",(function(){return fi.hh})),n.d(t,"Tenants",(function(){return fi.ih})),n.d(t,"TestProfile",(function(){return fi.jh})),n.d(t,"UIDefinitionResponse",(function(){return fi.mh})),n.d(t,"UnifiedAppIcons",(function(){return fi.nh})),n.d(t,"UnifiedAppInfo",(function(){return fi.oh})),n.d(t,"UnifiedAppProperties",(function(){return fi.ph})),n.d(t,"UpdateVersion",(function(){return fi.qh})),n.d(t,"UserAppMetadata",(function(){return fi.rh})),n.d(t,"UserConnectionForAppPropertiesResponse",(function(){return fi.sh})),n.d(t,"UserConnectionForAppResponse",(function(){return fi.th})),n.d(t,"UserFeatureResponse",(function(){return fi.uh})),n.d(t,"UserFeaturesResponse",(function(){return fi.vh})),n.d(t,"UserObjectResponse",(function(){return fi.wh})),n.d(t,"UserPlans",(function(){return fi.xh})),n.d(t,"UserProperties",(function(){return fi.yh})),n.d(t,"ValidateAppDisplayNameServerResponse",(function(){return fi.zh})),n.d(t,"Violation",(function(){return fi.Hh})),n.d(t,"ViolationParameters",(function(){return fi.Jh})),n.d(t,"ViolationPolicy",(function(){return fi.Kh})),n.d(t,"WebAuthenticationResponse",(function(){return fi.Lh})),n.d(t,"XrmConnectionReferences",(function(){return fi.Mh})),n.d(t,"ICuratedAppProperties",(function(){return fi.ICuratedAppProperties})),n.d(t,"CuratedAppProperties",(function(){return fi.eb})),n.d(t,"CuratedAppCreatedBy",(function(){return fi.cb})),n.d(t,"ICuratedAppCreatedBy",(function(){return fi.ICuratedAppCreatedBy}));var yi=n(173);n.d(t,"factory",(function(){return yi.factory}));var mi=n(287);n.d(t,"xhr",(function(){return mi.xhr}));var gi=n(286);n.d(t,"UserServiceHelper",(function(){return gi.UserServiceHelper}))},function(e,t,n){"use strict";n.r(t);var r=n(1);Core.exportToNamespace(["AppMagic","ConnectionHub"],{ApiConnectionParametersResponse:r.c,ApiResponse:r.k,ConnectionParameterConstraints:r.O,ConnectionParameterSet:r.P,ConnectionPropertiesResponse:r.Q,ConnectionPropertiesResponseStatusResponse:r.R,ConnectionPropertiesResponseTestLink:r.S,ConnectionReferenceInfo:r.T,ConnectionResponse:r.U,ConnectionUsage:r.V,ConnectionUsageProperties:r.W,ConsentInfoResponse:r.Z,DatasetMetadata:r.mb,DynamicTreeOptions:r.tb,DynamicTreeSelectOption:r.ub,FileServiceItem:r.Pb,Gateway:r.Yb,GatewayConnectionParameter:r.Zb,GatewayProperties:r.ac,GetApisOrConnectionsResponse:r.bc,GetConnectionConsentLinkResponse:r.cc,GetGatewaysResponse:r.ec,LocalConnection:r.Vf,MultiAuthConnectionParametersSet:r.bg,MultiAuthConnectionParameterValue:r.ag,OAuthSettingsResponse:r.eg,PostConnectionUsageRequest:r.pg,PutConnectionRequest:r.ug,PutConnectionRequestProperties:r.vg,RuntimeNamespaceOwner:r.Bg,RuntimeUserNamespace:r.Cg,RuntimeUserNamespaceProperties:r.Dg,RuntimeUserNamespaceResponse:r.Eg,ServerListConnectionUsage:r.Kg,SharePointConnectorErrorResponse:r.Pg,TabularMetadata:r.Ug,TabularMetadataParameter:r.Vg,TabularParameterItem:r.Wg,UIDefinitionResponse:r.mh,UserConnectionForAppPropertiesResponse:r.sh,UserConnectionForAppResponse:r.th,XrmConnectionReferences:r.Mh}),Core.exportToNamespace(["AppMagic","ConnectionHub","ConnectionParameterSets"],{FileSourceSet:r.Qb,MsFlowSet:r.Zf}),Core.exportToNamespace(["AppMagic","ConnectionHub","DataInterfaces"],{ApiConnectionParameterSets:r.b,ApiConnectionParametersSet:r.d,ApiInterface:r.f,ApiInterfaceRevision:r.g,ApiMetadata:r.h,ApiPropertiesResponse:r.i,ApiScopes:r.l,CreatedBy:r.bb,PutConnectionParametersSet:r.sg,PutConnectionParametersSetValue:r.tg,RecordScopeConsent:r.wg,RecordScopeConsentRequest:r.xg}),Core.exportToNamespace(["AppMagic","Data"],{CdsPVABotsResponse:r.G}),Core.exportToNamespace(["AppMagic","PowerApps"],{AcquireLeaseServerResponse:r.a,ApiConnectionReference:r.e,AppCdsComponent:r.m,AppClientVersion:r.n,AppExtendedMetadata:r.o,AppInfoAuthor:r.p,AppModuleSettingsDetail:r.q,AppOverrides:r.r,AppPackage:r.s,AppProperties:r.t,AppSourceControlPropertySet:r.u,AppUri:r.v,AppUris:r.w,BAPTenant:r.z,BAPTenantDataResponse:r.A,CdsDatabaseReference:r.D,CdsMigrationDetails:r.F,CheckPlansResponse:r.H,ClientIPResponse:r.L,Cluster:r.M,CommonAppProperties:r.N,ConnectorResponseError:r.X,ConnectorResponseGatewayError:r.Y,CoreAppComponentInfoProperties:r.ab,CuratedAppCreatedBy:r.cb,CuratedAppInfo:r.db,CuratedAppProperties:r.eb,DatabaseDataSource:r.lb,DatasetReference:r.nb,DataSourceReference:r.ib,DocumentServerVersion:r.rb,DraftResources:r.sb,EmbeddedApp:r.vb,EmbeddedAppPropertySet:r.wb,EnrollmentOptionsResponse:r.Db,EnrollResponse:r.xb,EnrollResponseGraphTenantDetails:r.yb,EnrollResponsePlanDetailPolicies:r.zb,EnrollResponsePlanDetailProperties:r.Ab,EnrollResponsePlanDetails:r.Bb,EnrollResponseTenant:r.Cb,EnvironmentCadence:r.Fb,EnvironmentGovernanceConfiguration:r.Gb,EnvironmentPropertiesConnectedGroup:r.Hb,EnvironmentPropertiesResponse:r.Ib,EnvironmentReference:r.Jb,EnvironmentResponse:r.Kb,ExecutionRestrictionsPolicy:r.Ob,FlowConnectionReferences:r.Rb,FlowMachineGroup:r.Sb,FlowMetadata:r.Tb,FlowMetadataEx:r.Ub,FlowMetadataProperties:r.Vb,FlowTrigger:r.Wb,FlowTriggersApiProperties:r.Xb,GetFlowMachineGroupsResponse:r.dc,GlobalConfigSettingResponse:r.fc,GovernanceConfigurationSettings:r.gc,GraphUser:r.hc,InstallFlowConnectionMetadata:r.If,InstallFlowConnectionProperties:r.Jf,InstallFlowRequest:r.Kf,InstallFlowResponse:r.Lf,LastPublishedBy:r.Pf,LastUsedEnvironmentMetadata:r.Qf,LinkedEnvironmentMetadata:r.Sf,ListAppPackageOperationDetailsResponse:r.Tf,ModelAppProperties:r.Yf,NestedAction:r.cg,NpsPromptResponse:r.dg,OfflineProfileDetails:r.fg,OptInCountryResponse:r.gg,OptInCountryResponseDetails:r.hg,OptInUserConsentData:r.ig,OptInUserConsentDataDetails:r.jg,ParameterHint:r.ng,PlansResponse:r.og,ResourceProviderResponseError:r.yg,ResourceReference:r.zg,RuntimeEndpoints:r.Ag,ServerAppInfo:r.Fg,ServerAuthReference:r.Gg,ServerCommonAppInfo:r.Hg,ServerComponentInfo:r.Ig,ServerConnectionReference:r.Jg,ServerModelAppInfo:r.Lg,ServerSharepointEmbeddedApp:r.Mg,ServerUserConsent:r.Ng,SolutionFlowClientDataResponse:r.Qg,SolutionFlowMetadata:r.Rg,SolutionVersionResponse:r.Tg,TagDictionary:r.Xg,UnifiedAppIcons:r.nh,UnifiedAppInfo:r.oh,UnifiedAppProperties:r.ph,UpdateVersion:r.qh,UserAppMetadata:r.rh,UserFeatureResponse:r.uh,UserFeaturesResponse:r.vh,UserObjectResponse:r.wh,ValidateAppDisplayNameServerResponse:r.zh}),Core.exportToNamespace(["AppMagic","PowerApps","DataLossPrevention","Service"],{ApiReference:r.j,AppViolation:r.x,DataUsage:r.jb,DataUsageParameter:r.kb,EvaluatePolicyForAppResponse:r.Lb,EvaluatePolicyRequest:r.Mb,EvaluatePolicyResponse:r.Nb,Violation:r.Hh,ViolationByPolicy:r.Ih,ViolationParameters:r.Jh,ViolationPolicy:r.Kh}),Core.exportToNamespace(["AppMagic","PowerApps","GlobalConfigSetting"],{CanvasStudioVersionsResponse:r.B,CanvasStudioVersionsResponseVersion:r.C}),Core.exportToNamespace(["AppMagic","Runtime","Client"],{AuthorizationOptions:r.y,LaunchAppServerResponse:r.Rf,SolutionInfo:r.Sg,Tenant:r.hh,Tenants:r.ih}),Core.exportToNamespace(["AppMagic","Runtime","Client","DataInterfaces"],{ClientConfiguration:r.J,ClientConfigurationSet:r.K,DocServerTestProfile:r.ob,DocServerTestProfileSettings:r.pb,DocServerTestProfileVariant:r.qb,MobileCustomBrandingConfig:r.Wf,MobileCustomBrandingImageLinks:r.Xf,TestProfile:r.jh}),Core.exportToNamespace(["AppMagic","Runtime","Client","EnrollPropertiesCache"],{PremiumFeatures:r.qg,UserPlans:r.xh,UserProperties:r.yh}),Core.exportToNamespace(["AppMagic","Services"],{CdsFileSasUrlResponse:r.E,CheckPrivileges:r.I,CurrencyAllocation:r.fb,CurrencyReport:r.gb,CustomHeadersOptions:r.hb,EnvironmentAllocationsResponse:r.Eb,IsPaiEnabledResponse:r.Mf,IsPaiEnabledResponseTemplate:r.Nf,IWhoAmIResponse:r.Gf,JsonErrorResponse:r.Of,ListAppPackageResponse:r.Uf,OrganizationItem:r.kg,OrganizationsResponse:r.lg,PackageUri:r.mg,Privilege:r.rg,ServiceErrorOptions:r.Og,TelemetryOptions:r.Yg,TemplateCategoryResponseValue:r.Zg,TemplateResponse:r.ah,TemplateResponseArtifact:r.bh,TemplateResponseImage:r.ch,TemplateResponseImageContext:r.dh,TemplateResponseMetadata:r.eh,TemplateResponseProperties:r.fh,TemplateResponseValue:r.gh,TrialCurrencyUnit:r.kh,TrialResponse:r.lh,Version:r.Ah,VersionAppDefinition:r.Bh,VersionAppProperties:r.Ch,VersionHistory:r.Dh,VersionProperties:r.Eh,VersionTag:r.Fh,VersionTimestamp:r.Gh}),Core.exportToNamespace(["AppMagic","Services","Adal","Web"],{WebAuthenticationResponse:r.Lh});var o=n(0),i=n(157);Object(o.exportToNamespace)(["AppMagic","Services","Adal"],i);var a=n(45);Object(o.exportToNamespace)(["AppMagic","Services","Adal"],a);var s=n(159);Object(o.exportToNamespace)(["AppMagic","Services","Adal"],s);var c=n(116);Object(o.exportToNamespace)(["AppMagic","Services","Adal","AuthenticationResult"],c);var u=n(223);Object(o.exportToNamespace)(["AppMagic","Services","Adal"],u);n(218),n(291),n(292),n(293);var p=n(224);Object(o.exportToNamespace)(["AppMagic","Services","Adal","DataInterfaces"],p);var l=n(245);Object(o.exportToNamespace)(["AppMagic","Services"],l);var d=n(135);Object(o.exportToNamespace)(["AppMagic","Services","Authentication","AppHttpClient"],d);var f=n(160);Object(o.exportToNamespace)(["AppMagic","Services","Authentication"],f);n(294);var y=n(70);Object(o.exportToNamespace)(["AppMagic","Services","Authentication"],y);var m=n(139);Object(o.exportToNamespace)(["AppMagic","Services"],m);var g=n(246);Object(o.exportToNamespace)(["AppMagic","Services"],g);var v=n(161);Object(o.exportToNamespace)(["AppMagic","Services"],v);var b=n(109);Object(o.exportToNamespace)(["AppMagic","Services"],b);var h=n(85);Object(o.exportToNamespace)(["AppMagic","Services","AuthUtility"],{fixedEncodeURIComponent:h.b}),Object(o.exportToNamespace)(["AppMagic","Services"],{ConsentDialogNotInitializedError:h.a});var A=n(234);Object(o.exportToNamespace)(["AppMagic","Services","Azure"],A);var C=n(162);Object(o.exportToNamespace)(["AppMagic","Services","Azure"],C);var P=n(89);Object(o.exportToNamespace)(["AppMagic","Services","Azure","Constants"],{Authority:P.a,Resource:P.d,EnrollProperties:P.c,AuthorizationRequest:P.b});n(295),n(296);var w=n(247);Object(o.exportToNamespace)(["AppMagic","Services","Azure"],w);var S=n(16);Object(o.exportToNamespace)(["AppMagic","Services","Azure"],S);var O=n(164),R=n(165),_=n(166),T=n(167),I=n(110),E=n(225),U=n(168),j=n(129),N=n(25),D=n(290),V=n(86),M=n(145);Object(o.exportToNamespace)(["AppMagic","Services","Azure","Constants","DefaultRegionProperties"],{DoD:O.a,Ex:R.a,GccHigh:_.a,GccModerate:T.a,Int:I.a,Mooncake:U.a,Preprod:j.a,Prod:N.a,Rx:D.a,Test:V.a,Tip2:M.a}),Object(o.exportToNamespace)(["AppMagic","Services","Azure"],E);var k=n(163);Object(o.exportToNamespace)(["AppMagic","Services","Azure"],k);var L=n(120);Object(o.exportToNamespace)(["AppMagic","Services","Azure"],L);var F=n(51);Object(o.exportToNamespace)(["AppMagic","PowerApps","Constants"],F);var x=n(22);Object(o.exportToNamespace)(["AppMagic","PowerApps","Constants"],x);var H=n(67);Object(o.exportToNamespace)(["AppMagic","PowerApps"],H);var B=n(41);Object(o.exportToNamespace)(["AppMagic","Services"],B);var q=n(226);Object(o.exportToNamespace)(["AppMagic","Services"],q);var G=n(53);Object(o.exportToNamespace)(["AppMagic","PowerApps","Constants"],G);var J=n(63);Object(o.exportToNamespace)(["AppMagic","PowerApps"],J);var W=n(227);Object(o.exportToNamespace)(["AppMagic","PowerApps"],W);var z=n(26);Object(o.exportToNamespace)(["AppMagic","ConnectionHub"],{UserKind:z.m,ApiServiceInterface:z.d,ApiServiceInterfaceRevision:z.e,ApiInterfaceRevisionInfo:z.b,Api:z.a}),Object(o.exportToNamespace)(["AppMagic","ConnectionHub","Api"],{parse:z.q,tryParseFromResponseWithLogging:z.r,isMsFlowApi:z.o,isFileSourceApi:z.n,ApiProperties:z.c,isSharepointApi:z.p});var K=n(121);Object(o.exportToNamespace)(["AppMagic","ConnectionHub"],{ApiConnectionParameter:K.a});var X=n(172);Object(o.exportToNamespace)(["AppMagic","ConnectionHub"],{ApiConnectionParameterSet:X.a});var Q=n(146);Object(o.exportToNamespace)(["AppMagic","ConnectionHub"],{ApiConnectionParameterSets:Q.a});var $=n(83);Object(o.exportToNamespace)(["AppMagic","ConnectionHub","ApiConnectionParameter"],$);var Z=n(147);Object(o.exportToNamespace)(["AppMagic","ConnectionHub"],Z);var Y=n(84);Object(o.exportToNamespace)(["AppMagic","ConnectionHub"],{ApiInterfaceName:Y.a,ApiRevisionManager:Y.b,ApisWithDefaultRevisions:Y.c});var ee=n(32);Object(o.exportToNamespace)(["AppMagic","ConnectionHub"],ee);var te=n(34);Object(o.exportToNamespace)(["AppMagic","ConnectionHub"],{Connection:te.a}),Object(o.exportToNamespace)(["AppMagic","ConnectionHub","Connection"],{parse:te.k,tryParseFromResponseWithLogging:te.l,isCompositeConnection:te.h,isFileSourceCompositeConnection:te.i,isMsFlowCompositeConnection:te.j});var ne=n(58);Object(o.exportToNamespace)(["AppMagic","ConnectionHub"],ne);var re=n(9);Object(o.exportToNamespace)(["AppMagic","ConnectionHub","Constants"],re),Object(o.exportToNamespace)(["AppMagic","ConnectionHub","Constants"],{NextLink:re.NextLink,FileSource:re.FileSource,DefaultDatasetName:re.DefaultDatasetName,CdsDefaultDatasetName:re.CdsDefaultDatasetName,CreateConnectionReference:re.CreateConnectionReference,SolutionId:re.SolutionId});var oe=n(76);Object(o.exportToNamespace)(["AppMagic","ConnectionHub","ConnectionParametersSet"],oe);var ie=n(79);Object(o.exportToNamespace)(["AppMagic","ConnectionHub"],ie);var ae=n(49);Object(o.exportToNamespace)(["AppMagic","ConnectionHub"],{ApiReleaseStatus:ae.a,ApiTier:ae.b,apiReleaseStatusParse:ae.c,apiTierParse:ae.d});var se=n(111);Core.exportToNamespace(["AppMagic","ConnectionHub"],se);var ce=n(136);Object(o.exportToNamespace)(["AppMagic","ConnectionHub"],ce);n(96);var ue=n(248);Object(o.exportToNamespace)(["AppMagic","ConnectionHub"],ue);var pe=n(107);Object(o.exportToNamespace)(["AppMagic","ConnectionHub"],pe);var le=n(52);Object(o.exportToNamespace)(["AppMagic","ConnectionHub","LocalConnectionReferenceStoreUtility"],le);var de=n(106);Object(o.exportToNamespace)(["AppMagic","ConnectionHub"],de);var fe=n(6);Object(o.exportToNamespace)(["AppMagic","ConnectionHub"],{Capability:fe.d,ParameterType:fe.r,GetFlowsFilterOptions:fe.o,GetAllEnvironmentFlowsFilterOptions:fe.n,PowerAppsConnectionService:fe.t}),Object(o.exportToNamespace)(["AppMagic","ConnectionHub","Constants"],{BlobCapability:fe.c,TabularCapability:fe.v,CompositeCapability:fe.f,ActionsCapability:fe.a,TriggersCapability:fe.w,CloudCapability:fe.e,GatewayCapability:fe.m,StatusError:fe.u,ConsentServerResponseError:fe.h,ConsentServerFlowId:fe.g,ErrorCodeConfig:fe.i,ErrorCodeUnauthorized:fe.l,ErrorCodeUnauthenticated:fe.k,ErrorCodeRequests:fe.j,ApiConnectionLimitIndex:fe.b,ParameterTypes:fe.s});var ye=n(130);Object(o.exportToNamespace)(["AppMagic","ConnectionHub"],ye);var me=n(148);Object(o.exportToNamespace)(["AppMagic","ConnectionHub"],me);var ge=n(249);Object(o.exportToNamespace)(["AppMagic","ConnectionHub"],ge);var ve=n(72);Object(o.exportToNamespace)(["AppMagic","ConnectionHub"],{UserConnectionForApp:ve.a}),Object(o.exportToNamespace)(["AppMagic","ConnectionHub","UserConnectionForApp"],{parse:ve.b,serializeToJson:ve.c,tryParseFromResponseWithLogging:ve.d});var be=n(105);Object(o.exportToNamespace)(["AppMagic","ConnectionHub"],be);var he=n(112);Object(o.exportToNamespace)(["AppMagic","Services"],he);var Ae=n(17);Object(o.exportToNamespace)(["AppMagic","Services"],Ae);var Ce=n(97);Object(o.exportToNamespace)(["DebugContracts"],Ce);var Pe=n(173);Object(o.exportToNamespace)(["AppMagic","Services","XmlHttpRequest"],Pe);var we=n(27);Object(o.exportToNamespace)(["AppMagic","PowerApps"],{Environment:we.a,EnvironmentCreationType:we.b,EnvironmentParserError:we.d,EnvironmentProperties:we.e}),Object(o.exportToNamespace)(["AppMagic","PowerApps","Environment"],{parse:we.k}),Object(o.exportToNamespace)(["AppMagic","PowerApps","Constants"],{EnvironmentsRoute:we.f,EnvironmentsValue:we.g,EnvironmentFilterKey:we.c});var Se=n(250);Object(o.exportToNamespace)(["AppMagic","PowerApps"],Se);var Oe=n(46);Object(o.exportToNamespace)(["AppMagic","PowerApps","EnvironmentUtility"],Oe);n(297);var Re=n(251);Object(o.exportToNamespace)(["AppMagic","Services"],Re);var _e=n(152);Object(o.exportToNamespace)(["AppMagic","Services"],_e);var Te=n(252);Object(o.exportToNamespace)(["AppMagic","Services"],Te);var Ie=n(253);Object(o.exportToNamespace)(["AppMagic","Services"],Ie);var Ee=n(254);Object(o.exportToNamespace)(["AppMagic","Services"],Ee);var Ue=n(255);Object(o.exportToNamespace)(["AppMagic","Services"],Ue);var je=n(256);Object(o.exportToNamespace)(["AppMagic","Services"],je);var Ne=n(257);Object(o.exportToNamespace)(["AppMagic","Services"],Ne);var De=n(3);Object(o.exportToNamespace)(["AppMagic","Services","HttpConstants"],De);var Ve=n(258);Object(o.exportToNamespace)(["AppMagic","Services"],Ve);n(298),n(299);var Me=n(117);Object(o.exportToNamespace)(["AppMagic","Services"],Me);n(300),n(301),n(302),n(303),n(304),n(131);var ke=n(228);Object(o.exportToNamespace)(["AppMagic","Encryption"],ke);var Le=n(35);Object(o.exportToNamespace)(["AppMagic","Services"],Le);n(305),n(306);var Fe=n(113);Object(o.exportToNamespace)(["AppMagic","Services"],Fe);var xe=n(48),He=n(259),Be=n(33);Object(o.exportToNamespace)(["AppMagic","Services"],Be),Object(o.exportToNamespace)(["AppMagic","Services"],xe),Object(o.exportToNamespace)(["AppMagic","Services"],He);var qe=n(93);Object(o.exportToNamespace)(["AppMagic","Services"],qe);var Ge=n(153);Object(o.exportToNamespace)(["AppMagic","Runtime","Client"],Ge);var Je=n(68);Object(o.exportToNamespace)(["AppMagic","Services"],{IoTPaneType:Je.g}),Object(o.exportToNamespace)(["AppMagic","PowerApps","Constants"],{IoTDeviceIDPropertyName:Je.f,IoTAppIDPropertyName:Je.a});n(307),n(308),n(309),n(310),n(311);var We=n(98);Object(o.exportToNamespace)(["AppMagic","Services"],We);var ze=n(229);Object(o.exportToNamespace)(["AppMagic","Services"],ze);var Ke=n(99);Object(o.exportToNamespace)(["AppMagic","Services"],Ke);var Xe=n(64);Object(o.exportToNamespace)(["AppMagic","Services"],Xe);n(312),n(313),n(314),n(236),n(315),n(316),n(317),n(318),n(319),n(320),n(321),n(322),n(323),n(237);var Qe=n(114);Object(o.exportToNamespace)(["AppMagic","Runtime","Client"],Qe);n(324);var $e=n(230);Object(o.exportToNamespace)(["AppMagic","Services","XmlHttpRequest"],{isValid:$e.b});n(325);var Ze=n(260);Object(o.exportToNamespace)(["AppMagic","Services"],Ze);var Ye=n(44);Object(o.exportToNamespace)(["AppMagic","Services"],Ye);var et=n(73);Object(o.exportToNamespace)(["AppMagic","Services"],et);var tt=n(261);Object(o.exportToNamespace)(["AppMagic","Services"],tt);var nt=n(60);Object(o.exportToNamespace)(["AppMagic","PowerApps"],nt);var rt=n(154);Object(o.exportToNamespace)(["AppMagic","Services","OAuth2Constants","CacheKey"],rt);var ot=n(21);Object(o.exportToNamespace)(["AppMagic","Services"],ot);var it=n(28);Object(o.exportToNamespace)(["AppMagic","Services"],it);var at=n(262);Object(o.exportToNamespace)(["AppMagic","Services"],at);var st=n(115);Object(o.exportToNamespace)(["AppMagic","Services"],st);var ct=n(263);Object(o.exportToNamespace)(["AppMagic","PowerApps"],ct);var ut=n(15);Object(o.exportToNamespace)(["AppMagic","PowerApps"],ut);var pt=n(43);Object(o.exportToNamespace)(["AppMagic","PowerApps"],pt);var lt=n(264);Object(o.exportToNamespace)(["AppMagic","PowerApps"],lt);var dt=n(100);Object(o.exportToNamespace)(["AppMagic","PowerApps"],dt),Object(o.exportToNamespace)(["AppMagic","PowerApps"],{LeaseStatus:dt.LeaseStatus});var ft=n(124);Object(o.exportToNamespace)(["AppMagic","PowerApps"],ft);var yt=n(119);Object(o.exportToNamespace)(["AppMagic","PowerApps"],yt);var mt=n(179);Object(o.exportToNamespace)(["AppMagic","PowerApps"],mt);var gt=n(2);Object(o.exportToNamespace)(["AppMagic","PowerApps","Constants"],gt);var vt=n(61);Object(o.exportToNamespace)(["AppMagic","PowerApps"],vt);var bt=n(180);Object(o.exportToNamespace)(["AppMagic","PowerApps","DataLossPrevention"],bt);var ht=n(149);Object(o.exportToNamespace)(["AppMagic","PowerApps","DataLossPrevention"],ht);var At=n(231);Object(o.exportToNamespace)(["AppMagic","PowerApps","DataLossPrevention"],At);var Ct=n(181);Object(o.exportToNamespace)(["AppMagic","PowerApps","DataLossPrevention"],{evaluatePolicyUrlTemplate:Ct.b,DataLossPreventionService:Ct.a});n(326);var Pt=n(141);Object(o.exportToNamespace)(["AppMagic","PowerApps"],Pt);var wt=n(169);Object(o.exportToNamespace)(["AppMagic","PowerApps"],wt);var St=n(140);Object(o.exportToNamespace)(["AppMagic","Runtime","Client"],St);n(238);var Ot=n(24);Object(o.exportToNamespace)(["AppMagic","PowerApps"],Ot);var Rt=n(54);Object(o.exportToNamespace)(["AppMagic","PowerApps"],Rt);n(327),n(239);var _t=n(88);Object(o.exportToNamespace)(["AppMagic","Runtime","Client"],_t),Object(o.exportToNamespace)(["AppMagic","Runtime","Client","UserConsent"],{tryFromServerUserConsent:_t.tryFromServerUserConsent});var Tt=n(170);Object(o.exportToNamespace)(["AppMagic","PowerApps"],Tt);var It=n(103);Object(o.exportToNamespace)(["AppMagic","PowerApps"],It);var Et=n(36);Object(o.exportToNamespace)(["AppMagic","PowerApps"],{ListAppPackageResultStatus:Et.ListAppPackageResultStatus,AppExtendedMetadataStatus:Et.AppExtendedMetadataStatus,PowerAppsApp:Et.PowerAppsApp,UpsertAppOptions:Et});var Ut=n(101);Object(o.exportToNamespace)(["AppMagic","PowerApps"],{AppDisplayNameValidationStatus:Ut.a,PowerAppsAppService:Ut.e});var jt=n(155);Object(o.exportToNamespace)(["AppMagic","PowerApps"],jt);var Nt=n(118);Object(o.exportToNamespace)(["AppMagic","PowerApps","PowerAppsErrorUtility"],Nt);var Dt=n(40);Object(o.exportToNamespace)(["AppMagic","PowerApps"],{DebugPlayerPackageLocallySetting:Dt.a,GetAppsClassificationFilter:Dt.b,PowerAppsService:Dt.f,OptInApi:Dt.e});var Vt=n(4);Object(o.exportToNamespace)(["AppMagic","PowerApps"],Vt);var Mt=n(65);Object(o.exportToNamespace)(["AppMagic","PowerApps"],Mt);var kt=n(184);Object(o.exportToNamespace)(["AppMagic","PowerApps"],kt);var Lt=n(265);Object(o.exportToNamespace)(["AppMagic","PowerApps","ShareRequestEmailGenerator"],Lt);var Ft=n(38);Object(o.exportToNamespace)(["AppMagic","PowerApps","TemplatePackage"],Ft);var xt=n(171);Object(o.exportToNamespace)(["AppMagic","PowerApps","TemplatePackage"],xt);var Ht=n(266);Object(o.exportToNamespace)(["AppMagic","PowerApps"],Ht);var Bt=n(232);Object(o.exportToNamespace)(["AppMagic","Services"],Bt);var qt=n(267);Object(o.exportToNamespace)(["AppMagic","Services"],qt);var Gt=n(268);Object(o.exportToNamespace)(["AppMagic","Services"],Gt);n(132);var Jt=n(125);Object(o.exportToNamespace)(["AppMagic","Services","RemoteNotification"],{NotificationCategory:Jt.b,NotificationSubcategory:Jt.c,NotificationCategories:Jt.a});var Wt=n(182);Object(o.exportToNamespace)(["AppMagic","Services","RemoteNotification"],{PowerAppsChannelRegistrar:Wt.a});var zt=n(90);Object(o.exportToNamespace)(["AppMagic","Services"],zt);var Kt=n(158);Object(o.exportToNamespace)(["AppMagic","Services"],Kt);var Xt=n(102);Object(o.exportToNamespace)(["AppMagic","Services"],Xt);var Qt=n(269);Object(o.exportToNamespace)(["AppMagic","Services"],Qt);var $t=n(23);Object(o.exportToNamespace)(["AppMagic","Services"],$t);var Zt=n(270);Object(o.exportToNamespace)(["AppMagic","Services","Rest"],Zt);var Yt=n(31);Object(o.exportToNamespace)(["AppMagic","Services","Rest"],Yt);n(328),n(329),n(330),n(331);var en=n(271);Object(o.exportToNamespace)(["AppMagic","Services","Rest"],en);var tn=n(272);Object(o.exportToNamespace)(["AppMagic","Services","Rest"],tn);var nn=n(273);Object(o.exportToNamespace)(["AppMagic","Services","Rest"],nn);var rn=n(274);Object(o.exportToNamespace)(["AppMagic","Services","Rest"],rn);var on=n(275);Object(o.exportToNamespace)(["AppMagic","Services","Rest"],on);var an=n(185);Object(o.exportToNamespace)(["AppMagic","Services","Rest"],an);var sn=n(276);Object(o.exportToNamespace)(["AppMagic","Services","Rest"],sn);var cn=n(277);Object(o.exportToNamespace)(["AppMagic","Services","Rest"],cn);var un=n(92);Object(o.exportToNamespace)(["AppMagic","Services","Results"],un);var pn=n(183);Object(o.exportToNamespace)(["AppMagic","Runtime","Client"],pn);n(240),n(332);var ln=n(278);Object(o.exportToNamespace)(["AppMagic","Runtime","Client"],ln);var dn=n(142);Object(o.exportToNamespace)(["AppMagic","Runtime","Client","ClientUtility"],dn);var fn=n(156);Object(o.exportToNamespace)(["AppMagic","Runtime","Client"],fn);n(219);var yn=n(81);Object(o.exportToNamespace)(["AppMagic","Runtime","Client"],yn);var mn=n(233);Object(o.exportToNamespace)(["AppMagic","Runtime","Client"],mn);n(333);var gn=n(279);Object(o.exportToNamespace)(["AppMagic","Runtime","Client"],gn);n(334),n(335),n(336);var vn=n(143);Object(o.exportToNamespace)(["AppMagic","Runtime","Client"],{ListAppPackageResultStatus:vn.b,ListPackageClient:vn.c});var bn=n(8);Object(o.exportToNamespace)(["AppMagic","Runtime","Client"],{AuthorizationScheme:bn.a,AuthorizationSchemeWithSpace:bn.b,addAuthorizationOptions:bn.e,addAuthorizationOptionsToBuilder:bn.f,isClientAuthorizationScheme:bn.h,hasClientAuthorizationScheme:bn.g,ResourceNames:bn.d});var hn=n(39);Object(o.exportToNamespace)(["AppMagic","Services"],hn);var An=n(5);Object(o.exportToNamespace)(["AppMagic","Schema"],An);var Cn=n(82);Object(o.exportToNamespace)(["Core"],Cn);var Pn=n(71);Object(o.exportToNamespace)(["Core"],Pn);var wn=n(122);Object(o.exportToNamespace)(["Core"],wn);var Sn=n(280);Object(o.exportToNamespace)(["AppMagic","Services"],Sn);var On=n(47);Object(o.exportToNamespace)(["AppMagic","Services"],{ServiceCallRequestIdEventArgs:On.f,ServiceCallErrorContextEventArgs:On.c,ServiceCallStartEventArgs:On.g,ServiceCallSucceededEventArgs:On.h,ServiceCallFailedEventArgs:On.e,ServiceCallCanceledEventArgs:On.b,ServiceCallTimeoutEventArgs:On.i,ServiceCallEventArgs:On.d}),Object(o.exportToNamespace)(["AppMagic","Services","ServiceCallEventArgs"],{Kind:On.a});n(337),n(338),n(220),n(151),n(339),n(80),n(340),n(341),n(342);var Rn=n(19);Object(o.exportToNamespace)(["AppMagic","Services","ServiceConfigDeserialization","IRConstants"],Rn);n(133),n(241),n(221),n(134),n(222),n(20),n(59);var _n=n(138);Object(o.exportToNamespace)(["AppMagic","Services","ServiceConfigDeserialization","TypesManagerDeserializer"],_n);var Tn=n(69);Object(o.exportToNamespace)(["AppMagic","Services"],Tn);var In=n(42);Object(o.exportToNamespace)(["AppMagic","Services"],In);var En=n(18);Object(o.exportToNamespace)(["AppMagic","Services","ServiceType"],{RP:En.e,Other:En.c,Connector:En.b,ApiHub:En.a,PPApi:En.d,isValid:En.g});var Un=n(11);Object(o.exportToNamespace)(["AppMagic","Services","ServiceUtility"],Un);var jn=n(281);Object(o.exportToNamespace)(["AppMagic","Services"],jn);var Nn=n(14);Object(o.exportToNamespace)(["AppMagic","Services","PowerAppsHttpTelemetry"],Nn);var Dn=n(30);Object(o.exportToNamespace)(["AppMagic","Services"],Dn);var Vn=n(282);Object(o.exportToNamespace)(["AppMagic","Services"],Vn);var Mn=n(123);Object(o.exportToNamespace)(["AppMagic","Services"],Mn);var kn=n(187);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],kn);var Ln=n(188);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],Ln);var Fn=n(189);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],Fn);var xn=n(190);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],xn);var Hn=n(191);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],Hn);var Bn=n(94);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],Bn);var qn=n(194);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],qn);var Gn=n(126);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],Gn);var Jn=n(78);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],Jn);var Wn=n(192);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],Wn);var zn=n(196);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],zn);var Kn=n(56);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem","FileConstants"],Kn);var Xn=n(207);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],Xn);var Qn=n(37);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],Qn);var $n=n(195);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],$n);var Zn=n(29);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem","DateTimeUtility"],Zn);var Yn=n(283);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],Yn);var er=n(75);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem","DValueConverter"],er);var tr=n(150);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem","DValueConverterFactory"],tr);var nr=n(7);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],nr);var rr=n(284);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],rr);var or=n(127);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],or);n(242),n(343),n(243);var ir=n(74);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],ir);var ar=n(197);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],ar);var sr=n(198);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],sr);var cr=n(50);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],cr);var ur=n(199);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],ur);var pr=n(200);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],pr);var lr=n(201);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],lr);var dr=n(202);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],dr);var fr=n(203);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],fr);var yr=n(204);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],yr);var mr=n(144);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],mr);var gr=n(205);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],gr);var vr=n(206);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],vr);var br=n(128);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],br);var hr=n(208);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],hr);var Ar=n(66);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],Ar);var Cr=n(10);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem","TTypeUtility"],Cr);var Pr=n(91);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],Pr);var wr=n(209);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],wr);var Sr=n(210);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],Sr);var Or=n(211);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],Or);var Rr=n(212);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],Rr);var _r=n(213);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],_r);var Tr=n(55);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem","XsdUtility"],Tr);var Ir=n(193);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],Ir);var Er=n(77);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],Er);var Ur=n(57);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],Ur);var jr=n(285);Object(o.exportToNamespace)(["AppMagic","Utility"],jr);var Nr=n(137);Object(o.exportToNamespace)(["AppMagic","UriUtility"],Nr);var Dr=n(12);Object(o.exportToNamespace)(["AppMagic","Utility"],{jsonClone:Dr.r,escapeXmlString:Dr.e,isJsonPointer:Dr.o,encodeJsonPointerReferenceToken:Dr.d,parseJsonPointer:Dr.s,isExpectedMediaType:Dr.m,stripHtml:Dr.u,tryPopFirstDecodedReferenceToken:Dr.v,getJsonValueViaJsonPointer:Dr.i,getJsonValueViaJsonPointerExtended:Dr.j,isSignInCancelError:Dr.q,replaceAllSingleOrDoubleQuotes:Dr.t,createInferredSchemaFromObject:Dr.c,createInferredSchemaFromArray:Dr.b,flattenSchema:Dr.f,getCdsMdlHttpClient:Dr.g,getCdsMdlMetadataClient:Dr.h,getWebViewFileTransferService:Dr.k,IsMdlIntegrationEnabled:Dr.a}),Object(o.exportToNamespace)(["AppMagic","Services"],{hasHtml:Dr.l,getCdsMdlMetadataClient:Dr.h});var Vr=n(104);Object(o.exportToNamespace)(["AppMagic","Services"],Vr);var Mr=n(186);Object(o.exportToNamespace)(["AppMagic","Utility"],Mr);var kr=n(286);Core.exportToNamespace(["AppMagic","Runtime","Client"],kr);var Lr=n(178);Object(o.exportToNamespace)(["AppMagic","Services"],Lr);var Fr=n(287);Object(o.exportToNamespace)(["AppMagic","Services"],Fr);n(344),n(345);var xr=n(87);Object(o.exportToNamespace)(["AppMagic","Services","XmlHttpRequest"],xr);var Hr=n(175);Object(o.exportToNamespace)(["AppMagic","Services","XmlHttpRequest"],Hr);var Br=n(176);Object(o.exportToNamespace)(["AppMagic","Services","XmlHttpRequest"],Br);var qr=n(174);Object(o.exportToNamespace)(["AppMagic","Services","XmlHttpRequest"],qr);var Gr=n(177);Object(o.exportToNamespace)(["AppMagic","Services","XmlHttpRequest"],Gr);var Jr=n(108);Object(o.exportToNamespace)(["AppMagic","Services","XmlHttpRequest"],Jr);var Wr=n(214);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],Wr);var zr=n(215);Object(o.exportToNamespace)(["AppMagic","Services","TypeSystem"],zr);n(244)}]);
//# sourceMappingURL=D:/a/_work/1/s/obj/Assets/js/Core.Services/Core.Services.js.map
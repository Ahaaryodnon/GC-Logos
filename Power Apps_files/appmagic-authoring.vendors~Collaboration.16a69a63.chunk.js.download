/*! For license information please see appmagic-authoring.vendors~Collaboration.16a69a63.chunk.js.LICENSE.txt */
(window.webpackJsonpPA_Client_AppMagicAuthoring=window.webpackJsonpPA_Client_AppMagicAuthoring||[]).push([[7],Array(1004).concat([function(e,t,n){"use strict";n.d(t,"i",(function(){return i})),n.d(t,"h",(function(){return c})),n.d(t,"j",(function(){return s})),n.d(t,"b",(function(){return r})),n.d(t,"k",(function(){return d})),n.d(t,"a",(function(){return a})),n.d(t,"f",(function(){return l})),n.d(t,"c",(function(){return p})),n.d(t,"g",(function(){return h})),n.d(t,"l",(function(){return v})),n.d(t,"e",(function(){return m})),n.d(t,"d",(function(){return b})),n.d(t,"m",(function(){return C})),n.d(t,"n",(function(){return T}));n(1221);var r,o,a=!1,i=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];a&&console.log.apply(console,e)},c=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];a&&console.error.apply(console,e)},s=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];a&&console.warn.apply(console,e)};!function(e){e[e.None=0]="None",e[e.Redux=1]="Redux",e[e.Comments=2]="Comments"}(r||(r={}));function d(e,t){if(o){var n=null===window||void 0===window?void 0:window.performance;if(n&&"function"==typeof n.measure&&"function"==typeof n.mark)return new o(e,t,n)}}function u(e,t){return void 0===t&&(t=0),e?e.split("\n").slice(1+t,a?void 0:2+t).join("\n"):"<unable to get stack>"}function l(){try{throw new Error}catch(e){return e instanceof Error?u(e.stack,1):""}}var f=Boolean;function m(e,t,n,r){return[p.enableMessageLogging&&n?n:void 0,"Tag: ".concat(e),p.enableStackLogging?t:void 0,r?"----------\nInner exception: ".concat(v(r)):void 0].filter(f).join("\n")}var p=function e(t,n,r){var o=function(e,t,n){return new Error(e)}(t);return o.name="StructuredError",o.innerException=r,o.tag=n,Object.setPrototypeOf(o,Object.getPrototypeOf(this)),Error.captureStackTrace&&Error.captureStackTrace(o,e),o};function h(e,t){return!(!e||!(e instanceof p||void 0!==e.isStructuredError)||t&&e.name!==t)}function v(e){if(h(e))return e.stringify();if(e instanceof Error){var t=p.enableUnknownMessageLogging&&e.message?" - ".concat(e.message):"";return"".concat(e.name).concat(t,":\n").concat(p.enableStackLogging?u(e.stack):"")}return p.enableUnknownMessageLogging&&"string"==typeof e?e:"Unknown error"}p.enableStackLogging=a,p.enableMessageLogging=a,p.enableUnknownMessageLogging=a,p.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0},stringify:{value:function(){return m(this.tag,this.stack,void 0,this.innerException)},enumerable:!1,writable:!0,configurable:!0},isStructuredError:{value:!0,enumerable:!1,writable:!1,configurable:!1}}),Object.setPrototypeOf?Object.setPrototypeOf(p,Error):p.__proto__=Error;var g=n(1418),y=Object(g.a)(0),b={reserve:function(){return y},reserveTag:g.a};function C(e){throw new Error("Unreachable throw hit! Passed in value is ".concat(e,"."))}function T(e,t,n){if(!e)throw new p(t,n)}},function(e,t,n){"use strict";var r,o,a,i,c,s,d,u,l,f;function m(e,t){return{visit:function(){}}}function p(e,t,n){return{key:e,value:t,dataClassification:n}}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"l",(function(){return m})),n.d(t,"o",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"i",(function(){return N})),n.d(t,"k",(function(){return F})),n.d(t,"m",(function(){return ke})),n.d(t,"j",(function(){return E})),n.d(t,"n",(function(){return Pe})),function(e){e[e.None=0]="None",e[e.Always=1]="Always",e[e.OnSuccess=2]="OnSuccess",e[e.AggregateSubtree=3]="AggregateSubtree",e[e.NotSet=999]="NotSet"}(r||(r={})),function(e){e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.NecessaryServiceDataEvent=110]="NecessaryServiceDataEvent"}(o||(o={})),function(e){e[e.EventExportability_NotSet=0]="EventExportability_NotSet",e[e.EventExportability_NotExported=1]="EventExportability_NotExported"}(a||(a={})),function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact"}(i||(i={})),function(e){e[e.NotSet=0]="NotSet",e[e.ProductServiceUsage=2]="ProductServiceUsage"}(c||(c={})),function(e){e[e.None=0]="None",e[e.Required=1]="Required",e[e.Basic=2]="Basic",e[e.All=3]="All"}(s||(s={})),function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Info=3]="Info",e[e.Verbose=4]="Verbose",e[e.Spam=5]="Spam"}(d||(d={})),function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"}(u||(u={})),function(e){e[e.GlobalAPI=1]="GlobalAPI",e[e.ReviewedAsNotNecessary=2]="ReviewedAsNotNecessary",e[e.Test=3]="Test",e[e.Todo=4]="Todo"}(l||(l={})),function(e){e[e.Normal=0]="Normal",e[e.Critical=1]="Critical"}(f||(f={}));var h=n(1004),v=h.d.reserveTag(590899029),g=h.d.reserveTag(590899030),y=h.d.reserveTag(590899031),b=h.d.reserveTag(590899032),C=h.d.reserveTag(590899033),T=h.d.reserveTag(578937436),I=h.d.reserveTag(578937437),S=h.d.reserveTag(578937438),O=(h.d.reserveTag(576717443),h.d.reserveTag(576717444)),w=h.d.reserveTag(576717445),j=(h.d.reserveTag(523891986),h.d.reserveTag(523891987),h.d.reserveTag(523629772),h.d.reserveTag(523629773),n(307));function E(){return{aggregationMode:r.NotSet,diagnosticLevel:o.NecessaryServiceDataEvent,dataCategories:c.ProductServiceUsage,samplingPolicy:i.Measure,exportability:a.EventExportability_NotSet}}var k=E();var P,x,A=function(){function e(){this.isInitialized=!1,this.deferredInitializationCallbacks=[]}return e.prototype.init=function(e){var t,n=this;this.isInitialized?this.assertConditionTag(!1,"ClientTelemetryAPI init called twice!",595644941):(this.hostAPI=e,this.isInitialized=!0,this.deferredInitializationCallbacks.map((function(e){return e(n)})),this.deferredInitializationCallbacks=[],this.logDiagnosticTrace=null===(t=this.hostAPI.logDiagnosticTrace)||void 0===t?void 0:t.bind(this.hostAPI))},e.prototype.hasBeenInitialized=function(){return this.isInitialized},e.prototype.onInitialized=function(e){this.isInitialized?e(this):this.deferredInitializationCallbacks.push(e)},e.prototype.createActivityObject=function(e,t,n,r){this.checkIsInitialized(),Object(h.n)(e[0]>="A"&&e[0]<="Z","Activity name should start with a capital letter.",T),Object(h.n)(this.hostAPI,"Host API must be defined",I);var o=function(e){var t,n;return Object(j.a)(Object(j.a)({},k),{diagnosticLevel:null!==(t=e.diagnosticLevel)&&void 0!==t?t:k.diagnosticLevel,samplingPolicy:null!==(n=e.samplingPolicy)&&void 0!==n?n:k.samplingPolicy})}(n);return this.hostAPI.createActivityObject(e,t,o,r)},e.prototype.assertCondition=function(e,t){this.checkIsInitialized(),this.assertConditionTag(e,t,y)},e.prototype.assertConditionTag=function(e,t,n){this.checkIsInitialized(),e||(Object(h.j)("*ASSERT* 0x".concat(n.toString(16)," : ").concat(t)),Object(h.n)(this.hostAPI,"Host API must be defined",I),this.hostAPI.logErrorData(n,t))},e.prototype.getMetadata=function(){return Object(h.n)(this.hostAPI,"Host API must be defined",I),this.hostAPI.getMetadata()},e.prototype.checkIsInitialized=function(){if(!this.isInitialized||!this.hostAPI)throw new h.c("ClientTelemetryAPI is not initialized",S)},e.prototype.logFloodgateActivity=function(e){this.checkIsInitialized(),Object(h.n)(this.hostAPI,"Host API must be defined",I),this.hostAPI.logFloodgateActivity&&this.hostAPI.logFloodgateActivity(e)},e}(),D=void 0;function R(e){return!0===e.testOnly}function F(){if(P||(P=Object(h.f)()),!D){var e=new A;return function(e){if(D){if(R(D))return void(R(e)&&(D=e));if(P)throw new h.c(["'getTelemetryAPI' was called before a stub API was injected.","First call to getTelemetryAPI originated from:",P].join("\n"),O);throw new h.c("ClientTelemetryAPI cannot be re-initialized.\nFirst initialized from ".concat(x),w)}x||(x=Object(h.f)()),D=e}(e),e}return D}function N(){D=void 0,P=void 0,x=void 0}var M=function(){var e=[];return{fireEvent:function(t){e.forEach((function(e){return e(t)}))},addListener:function(t){t&&e.push(t)}}}();function L(e,t,n){M.fireEvent({level:e,category:t,message:n})}var B={};function V(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?B[e]?(t.ariaTenantToken&&(B[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(B[e].dnmToken=t.dnmToken)):B[e]=t:L(0,0,(function(){return"Namespace: ".concat(e)}))}function U(e,t){for(var n=e.length;n>0;){var r=e.substr(0,n);if(B[r]){var o=B[r];return t.ariaTenantToken=o.ariaTenantToken,t.dnmToken=o.dnmToken,!0}n=e.lastIndexOf(".",n-1)}return!1}var _=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,H=/^[a-zA-Z0-9_\.]{1,95}$/;function G(e){if(!function(e){if(!e||e.length>98)return!1;return _.test(e)}(e.eventName))throw new Error("Invalid eventName");var t=e.eventContract;if(t){if(t.name&&!q(t.name))throw new Error("Invalid eventContract");z(t.dataFields)}z(e.dataFields)}function q(e){return H.test(e)}function z(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!q(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>9007199254740991)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}function W(e,t,n){return X(e,1,t,n)}function Y(e,t,n){return X(e,2,t,n)}function K(e,t,n){return X(e,0,t,n)}function X(e,t,n,r){return{name:e,dataType:t,value:n,classification:r||4}}function Q(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?Object(j.a)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var J=function(){function e(e,t,n){var r,o,a;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(r=this.persistentDataFields).push.apply(r,e.persistentDataFields),this.config=Object(j.a)(Object(j.a)({},e.getConfig()),this.config),(o=this.partAFields).push.apply(o,e.partAFields)),t&&(a=this.persistentDataFields).push.apply(a,t)}return e.prototype.addEventContentType=function(e,t){e.push(Y("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=Q(e),n=t.telemetryProperties;n.nexusTenantToken=-1;var r=n.ariaTenantToken;if(!r&&(!U(t.eventName,n)&&!r))return void L(0,0,(function(){return"No tenant token: "+e.eventName}));this.sendTelemetryEventInternal(t,1)},e.prototype.sendCustomerContent=function(e){var t=Q(e),n=t.telemetryProperties,r=n.customerContentVersion;return(!r||r>2)&&(n.customerContentVersion=2),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,n.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=Q(e),n=t.telemetryProperties;if(!n.dnmToken&&(!U(t.eventName,n)&&!n.dnmToken))return void L(0,0,(function(){return"No dnm token: "+t.eventName}));this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):L(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(e){return void function(e,t,n){L(0,e,(function(){var e=n instanceof Error?n.message:"";return"".concat(t,": ").concat(e)}))}(0,"SendTelemetryEvent",e)}this.telemetrySinks.forEach((function(n){try{3===t||2===t?n.sendNonStandardEvent&&n.sendNonStandardEvent(e,t):n.sendTelemetryEvent(e)}catch(e){}}))}else L(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var n,r,o;if(e.dataFields&&(null===(o=e.dataFields)||void 0===o||o.unshift(K("OTelJS.Version","4.17.2")),3!==t&&this.persistentDataFields&&(n=e.dataFields).unshift.apply(n,this.persistentDataFields)),this.partAFields.length>0){var a=e.eventContract||{name:"",dataFields:[]};(r=a.dataFields).push.apply(r,this.partAFields),e.eventContract=a}this.config.disableValidation||G(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,n=e;t<n.length;t++){var r=n[t],o=r[0],a=r[1];this.sendTelemetryEventInternal(o,a)}},e.prototype.setTenantToken=function(e,t,n){V(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.setDNMToken=function(e,t){V(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return Q(e)},e.prototype.getConfig=function(){return this.config},e}();function Z(e,t){return e?e+"."+t:t}function $(e,t,n,r,o){void 0===o&&(o=4),r&&e.push(K("".concat(Z(t,n)),r,o))}function ee(e,t,n,r){"boolean"==typeof r&&e.push(W("".concat(Z(t,n)),r))}function te(e,t,n,r){"number"==typeof r&&e.push(Y("".concat(Z(t,n)),r))}var ne,re=function(e){var t=[];return te(t,"Activity.Result","Code",e.code),$(t,"Activity.Result","Type",e.type),te(t,"Activity.Result","Tag",e.tag),ee(t,"Activity.Result","IsExpected",e.isExpected),t.push(K("zC.Activity.Result","Office.System.Result")),t},oe={contractName:"Office.System.Activity",getFields:function(e){var t=[];return $(t,"Activity","CV",e.cV),te(t,"Activity","Duration",e.duration),te(t,"Activity","Count",e.count),te(t,"Activity","AggMode",e.aggMode),ee(t,"Activity","Success",e.success),e.result&&t.push.apply(t,re(e.result)),t.push(K("zC.Activity",this.contractName)),t}};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.iOS="iOS",e.Android="Android"}(ne||(ne={}));var ae;!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(ae||(ae={}));var ie,ce;function se(e){return(se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e){!function(e){e.IsEnabled="IsEnabled",e.IsSeen="IsSeen",e.IsTried="IsTried",e.IsKept="IsKept",e.IsRejected="IsRejected"}(e.FeatureActionType||(e.FeatureActionType={})),function(e){e.ContentGeneration="Content Generation",e.Commanding="Commanding",e.QAandSummaries="QA and Summaries",e.Collaboration="Collaboration",e.Suggestions="Suggestions"}(e.Capability||(e.Capability={})),function(e){e.Chat="Chat",e.Canvas="Canvas"}(e.EntryPoint||(e.EntryPoint={})),e.getFields=function(e){var t=[];return $(t,"Copilot","FeatureActionType",e.featureActionType),ee(t,"Copilot","IsUserInitiated",e.isUserInitiated),$(t,"Copilot","FeatureName",e.featureName),$(t,"Copilot","SubFeatureName",e.subFeatureName),$(t,"Copilot","Capability",e.capability),ee(t,"Copilot","IsThumbsUp",e.isThumbsUp),$(t,"Copilot","EntryPoint",e.entryPoint),t.push(K("zC.".concat("Copilot"),"Office.System.Copilot")),t}}(ie||(ie={})),function(e){!function(e){e.Pillar="Pillar",e.Error="Error"}(e.EventType||(e.EventType={})),e.getFields=function(e){var t=[];return $(t,"Asha","EventType",e.eventType),$(t,"Asha","Pillar",e.pillar),$(t,"Asha","Scenario",e.scenario),$(t,"Asha","Veto",e.veto),$(t,"Asha","Error",e.error),ee(t,"Asha","InStaging",e.inStaging),ee(t,"Asha","IsSessionEndingError",e.isSessionEndingError),ee(t,"Asha","IsIntentional",e.isIntentional),ee(t,"Asha","IsInternal",e.isInternal),t.push(K("zC.".concat("Asha"),"Office.System.Asha")),t}}(ce||(ce={}));var de=function(){return 1e3*Date.now()};"object"===("undefined"==typeof window?"undefined":se(window))&&"object"===se(window.performance)&&"now"in window.performance&&(de=function(){return 1e3*Math.floor(window.performance.now())});var ue,le=function e(t){var n,r=de(),o=Q(t.telemetryEvent);return{cv:t.parentCv.getNext(),eventName:t.telemetryEvent.eventName,dataFields:o.dataFields,eventFlags:o.eventFlags,telemetryProperties:o.telemetryProperties,createChildActivity:function(n){return e({telemetryEvent:n,sendTelemetryEvent:t.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,n){this.result={code:e,type:t,tag:n}},endNow:function(){if(!n){void 0===this.success&&void 0===this.result&&L(1,0,(function(){return"Activity does not have success or result set"}));var e=de();n=!0;var o={duration:e-r,count:1,aggMode:0,cV:this.cv.value,success:this.success,result:this.result},a=this.eventContract&&this.eventContract.dataFields?this.eventContract.dataFields:[];return a.push.apply(a,oe.getFields(o)),this.eventContract={name:oe.contractName,dataFields:a},t.sendTelemetryEvent(this)}L(0,0,(function(){return"Already ended"}))}}},fe=function(e){var t=[];return t.push(K("".concat("Error",".ErrorGroup"),e.errorGroup)),t.push(Y("".concat("Error",".Tag"),e.tag)),void 0!==e.code&&t.push(Y("".concat("Error",".Code"),e.code)),void 0!==e.id&&t.push(Y("".concat("Error",".Id"),e.id)),void 0!==e.count&&t.push(Y("".concat("Error",".Count"),e.count)),t},me=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e}();var pe=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.baseCv=function(){if(!ue){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],n=0;n<22;n++)t.push(e.charAt(Math.floor(Math.random()*e.length)));ue=new me(t.join(""))}return ue}(),o}return Object(j.c)(t,e),t.prototype.createActivity=function(e){return le({sendTelemetryEvent:this.sendTelemetryEvent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t.prototype.sendActivity=function(e,t,n,r){return this.sendTelemetryEvent({eventName:e,eventContract:{name:oe.contractName,dataFields:oe.getFields(t)},dataFields:n,eventFlags:r})},t.prototype.sendError=function(e){var t=fe(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return le({sendTelemetryEvent:this.sendCustomerContent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t}(J),he=function(){function e(){this.EMPTY_IMPL=!0}return e.prototype.success=function(){},e.prototype.successTag=function(e){},e.prototype.fail=function(e){},e.prototype.failTag=function(e,t){},e.prototype.addDataField=function(e,t,n){},e.prototype.addDocumentMetadata=function(e){},e.prototype.attachContext=function(e){},e.prototype.isEnded=function(){return!1},e}(),ve={appName:"TestHost",appVersion:"1.0",releaseAudience:"Internal",releaseChannel:"Insiders",sessionId:"D9430514-C886-445F-891C-6C0E7F774EF7"};var ge,ye=function(){function e(e,t){void 0===t&&(t=function(){return ve}()),this.sdxMetadata=e,this.hostTelemetrySupport=t,this.logDiagnosticTrace=void 0}return e.prototype.getMetadata=function(){var e=this.hostTelemetrySupport;return{appName:e.appName,appVersion:e.appVersion,dataCenter:e.dataCenter,releaseAudience:e.releaseAudience,releaseAudienceGroup:e.releaseAudienceGroup,releaseChannel:e.releaseChannel,ring:e.ring,sessionId:e.sessionId,sovereignEnvironmentName:e.sovereignEnvironmentName}},e}(),be=function(){function e(e){this._visitor=e,this._ended=!1}return e.prototype.finalize=function(){return this._ended?(Object(h.h)("ActivityObject has already been ended"),!1):(this._visitor&&this._visitor.visit(this),this._ended=!0,!0)},e.prototype.success=function(){this.successTag(0)},e.prototype.fail=function(e){this.failTag(0,e)},e.prototype.isEnded=function(){return this._ended},e}();function Ce(e){return(Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam",e[e.ShiftFactor=1e3]="ShiftFactor"}(ge||(ge={}));var Te=function(e){function t(t,n,r,o,a,i){var c=e.call(this,o)||this;return c.activityNamespace=t,c.activityName=n,c.fullActivityName="".concat(c.activityNamespace,".").concat(c.activityName),c.activityScope=r.createActivity({eventName:c.fullActivityName,eventFlags:{dataCategories:Se(i.dataCategories),diagnosticLevel:Ie(i.diagnosticLevel),samplingPolicy:Oe(i.samplingPolicy)}}),c.hostTelemetrySupport=a,c}return Object(j.c)(t,e),t.prototype.successTag=function(e){this.finalize()&&(this.activityScope.success=!0,this.activityScope.setResult(0,void 0,e),this.activityScope.endNow(),this.hostTelemetrySupport.recordActivity&&this.hostTelemetrySupport.recordActivity(this.activityName))},t.prototype.failTag=function(e,t){this.finalize()&&(this.activityScope.success=!1,this.activityScope.setResult(t,void 0,e),void 0!==this.hostTelemetrySupport.sendULSTrace&&this.hostTelemetrySupport.sendULSTrace(e,201,ge.Error,"".concat(this.fullActivityName," Failed")),this.activityScope.endNow())},t.prototype.addDataField=function(e,t,n,r){if(!this.isEnded()&&n===u.SystemMetadata){var o,a=n||4;switch(Ce(t)){case"boolean":(o=W(e,t)).classification=a;break;case"number":(o=function(e,t,n){return X(e,3,t,n)}(e,t)).classification=a;break;case"string":(o=K(e,t)).classification=a;break;default:throw new Error("Unknown type")}this.activityScope.dataFields.push(o),r&&function(e,t){t.recordActivity&&t.recordActivity(e.name)}(o,this.hostTelemetrySupport)}},t.prototype.attachContext=function(e){},t.prototype.addDocumentMetadata=function(e){},t}(be);function Ie(e){switch(e){case o.BasicEvent:return 10;case o.FullEvent:return 100;case o.NecessaryServiceDataEvent:return 110;default:throw new Error("UnSupported ActivityDiagnosticLevel")}}function Se(e){switch(e){case c.NotSet:case c.ProductServiceUsage:return 2;default:throw new Error("UnSupported DataCategories")}}function Oe(e){switch(e){case i.NotSet:case i.Measure:return 1;case i.CriticalBusinessImpact:return 191;default:throw new Error("UnSupported ActivitySamplingPolicy")}}var we=function(){function e(e){this.hostTelemetrySupport=e}return e.prototype.sendTelemetryEvent=function(e,t){var n;if(void 0!==this.hostTelemetrySupport.sendOtelEvent){this.hostTelemetrySupport.sendOtelEvent({otelEvent:e});try{if(this.hostTelemetrySupport.recordPerfData&&e.eventContract&&e.dataFields){if("Activity.Duration"!==e.eventContract.dataFields[1].name)return;var r=+e.eventContract.dataFields[1].value;if(isNaN(r))return;var o=r/1e3;if("Office.Docs.SharedComments.RenderPaneIntoView"===e.eventName)this.hostTelemetrySupport.recordPerfData("RenderPaneIntoView",o);else if("Office.Docs.SharedComments.E2EPerfTracker"===e.eventName&&"OperationType"===e.dataFields[0].name)switch(e.dataFields[0].value){case"REPLY":this.hostTelemetrySupport.recordPerfData("SharedCommentsCommentReply",o);break;case"CREATE":this.hostTelemetrySupport.recordPerfData("SharedCommentsCreateThread",o);break;case"EDIT":this.hostTelemetrySupport.recordPerfData("SharedCommentsEditComment",o)}}}catch(e){return void(void 0!==this.hostTelemetrySupport.sendULSTrace&&this.hostTelemetrySupport.sendULSTrace(g,201,ge.Error,"Error recording performance data: ".concat(null!==(n=null==e?void 0:e.message)&&void 0!==n?n:Object(h.l)(e))))}}else void 0!==this.hostTelemetrySupport.sendULSTrace&&this.hostTelemetrySupport.sendULSTrace(g,201,ge.Error,"sendOtelEvent API undefined")},e}();function je(e,t,n){e.persistentDataFields=function(e,t){var n=[];return n.push(K("SDX.Name",e.name)),n.push(K("SDX.Version",e.version)),n}(t),e.addSink(new we(n))}var Ee=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.sdxMetadata=t,r.namespaceString="Office.Docs.SharedComments",r.ariaTenantToken="c274b3e05ac5448dae8fbb7466da6acb-fd6dc8de-18b7-409c-a696-4bd66f7a5322-7902",r.disableUpload=h.a,r.telemetryLogger=new pe,r.isFloodgateServiceEnabled=!1,r.logDiagnosticTrace=function(e,t,n,o,a){for(var i=[],c=5;c<arguments.length;c++)i[c-5]=arguments[c];if(r.hostTelemetrySupport.sendULSTrace){var s=327,u=ge.Spam;switch(n){case d.Spam:break;case d.Verbose:u=ge.Verbose;break;case d.Info:u=ge.Info;break;case d.Warning:u=ge.Warning,s=201;break;case d.Error:u=ge.Error,s=201;break;default:Object(h.m)(n)}r.hostTelemetrySupport.sendULSTrace(t,s,u,r.formatDetails(e,i))}},r.initialize(),r}return Object(j.c)(t,e),t.prototype.initialize=function(){var e=this;void 0!==this.hostTelemetrySupport.disableUpload&&(this.disableUpload=this.hostTelemetrySupport.disableUpload),this.disableUpload||(function(){return M}().addListener((function(t){void 0===e.hostTelemetrySupport.sendULSTrace||0!==t.level&&1!==t.level||e.hostTelemetrySupport.sendULSTrace(v,201,ge.Error,"OTel Notification - Level: ".concat(t.level,", Category: ").concat(t.category,", Message: ").concat(t.message()))})),this.telemetryLogger.setTenantToken(this.namespaceString,this.ariaTenantToken,-1),je(this.telemetryLogger,this.sdxMetadata,this.hostTelemetrySupport))},t.prototype.createActivityObject=function(e,t,n){return this.disableUpload?new he:function(e,t,n,r,o,a){return new Te(e,t,n,o,r,a)}(this.namespaceString,e,this.telemetryLogger,this.hostTelemetrySupport,function(e,t){return void 0===e?t:{visit:function(n){e.visit(n),t.visit(n)}}}(t,this),n)},t.prototype.logErrorData=function(e,t){this.disableUpload||(void 0!==this.hostTelemetrySupport.sendULSTrace&&this.hostTelemetrySupport.sendULSTrace(e,201,ge.Error,t),this.createActivityObject("LogError",m(l.ReviewedAsNotNecessary),E()).failTag(e,-2130957533))},t.prototype.logFloodgateActivity=function(e){!this.disableUpload&&window.OfficeBrowserFeedback&&window.OfficeBrowserFeedback.floodgate&&this.ensureFloodgateServiceEnabled().then((function(){var t=OfficeBrowserFeedback.floodgate.getEngine();if(t){var n=t.getActivityListener();n&&n.logActivity(e)}return Promise.resolve()})).catch((function(){}))},t.prototype.ensureFloodgateServiceEnabled=function(){var e=this;return this.isFloodgateServiceEnabled?Promise.resolve():window.OfficeBrowserFeedback.floodgate.initialize().then((function(){return window.OfficeBrowserFeedback.floodgate.start().then((function(){return e.isFloodgateServiceEnabled=!0,Promise.resolve()})).catch((function(e){return F().assertConditionTag(!1,"floodgate.start() failed: ".concat(e.message),b),Promise.reject()}))})).catch((function(e){return F().assertConditionTag(!1,"floodgate.initialize() failed: ".concat(e.message),C),Promise.reject()}))},t.prototype.visit=function(e){},t.prototype.formatDetails=function(e,t){return"".concat(e,"\n").concat(t.map(this.transformDataField).join(""))},t.prototype.transformDataField=function(e){return"{ ".concat(e.key,": ").concat(e.value,", DataFieldClassification: ").concat(e.dataClassification," }\n")},t}(ye);function ke(e,t){F().init(new Ee(e,t))}function Pe(e){return e}},function(e,t,n){"use strict";n.d(t,"z",(function(){return s})),n.d(t,"G",(function(){return d})),n.d(t,"E",(function(){return u})),n.d(t,"r",(function(){return l})),n.d(t,"n",(function(){return f})),n.d(t,"U",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"F",(function(){return h})),n.d(t,"L",(function(){return v})),n.d(t,"d",(function(){return g})),n.d(t,"v",(function(){return y})),n.d(t,"e",(function(){return b})),n.d(t,"k",(function(){return C})),n.d(t,"t",(function(){return T})),n.d(t,"K",(function(){return I})),n.d(t,"C",(function(){return S})),n.d(t,"J",(function(){return O})),n.d(t,"g",(function(){return w})),n.d(t,"X",(function(){return j})),n.d(t,"b",(function(){return E})),n.d(t,"x",(function(){return k})),n.d(t,"A",(function(){return P})),n.d(t,"P",(function(){return x})),n.d(t,"M",(function(){return A})),n.d(t,"I",(function(){return D})),n.d(t,"p",(function(){return R})),n.d(t,"w",(function(){return F})),n.d(t,"q",(function(){return N})),n.d(t,"V",(function(){return M})),n.d(t,"l",(function(){return L})),n.d(t,"B",(function(){return B})),n.d(t,"W",(function(){return V})),n.d(t,"m",(function(){return U})),n.d(t,"s",(function(){return _})),n.d(t,"o",(function(){return H})),n.d(t,"D",(function(){return G})),n.d(t,"R",(function(){return q})),n.d(t,"f",(function(){return z})),n.d(t,"S",(function(){return W})),n.d(t,"Y",(function(){return Y})),n.d(t,"i",(function(){return K})),n.d(t,"h",(function(){return X})),n.d(t,"a",(function(){return Q})),n.d(t,"y",(function(){return J})),n.d(t,"H",(function(){return Z})),n.d(t,"u",(function(){return $})),n.d(t,"j",(function(){return ee})),n.d(t,"T",(function(){return te})),n.d(t,"Q",(function(){return ne})),n.d(t,"O",(function(){return re})),n.d(t,"N",(function(){return oe}));var r=n(1201),o=n(1112),a=n(1005),i=n(1150);function c(e,t){return void 0===t&&(t=new Set),!!Object(o.a)().isFeatureEnabled(e)&&(t.add(e),i.a[e].dependencies.every((function(n){var r=t.has(n)||c(n,t);return Object(a.k)().assertConditionTag(r,"Gate ".concat(e," enabled without dependency gate ").concat(n),544482649),r})))}function s(){return c("LivePersonaPicker")}function d(){return c("PersonaFeature")}function u(){return c("NewCommentButton")}function l(){return c("DiscreteHostedComments")}function f(){return c("CommentsFluentUI")}function m(){return c("RenderDHCInPane")}function p(){return c("CommentTasks")}function h(){return c("NewDraftingUI")}function v(){return c("TaskPaneWithNewInfrastructure")}function g(){return c("CommentTasksFromReply")}function y(){return c("HeadlessBoot")}function b(){return c("HyperlinksInComments")}function C(){return c("AtMentionFloodgateSurvey")}function T(){return c("ExtendedDrafting")}function I(){return c("RichTextFormattingInWeb")}function S(){return c("LogDraftCommentIdPair")}function O(){return c("RichContentEditIntegrationInWeb")}function w(){return c("SmartReplies")}function j(){return c("NewSelectionInteractions")}function E(){return c("CommentReactions")}function k(){return c("HyperlinksWithDisplayText")}function P(){return c("LinkToComment")}function x(){return c("WebThemeIntegration")}function A(){return c("TruncationUIWithReadMoreText")}function D(){return c("QuickEdit")}function R(){return c("CtrlEnterTip")}function F(){return c("HighlightsAndFontColorInWebComments")}function N(){return c("DiagnosticHeartbeat")}function M(){return c("TaskHistoryRecordIDs")}function L(){return c("AtMentionHintMessage")}function B(){return c("LivePersonaCardForWeb")}function V(){return c("MapBasedStore")}function U(){return c("CommentTasksMultiAssignCreation")}function _(){return c("DraftSessionRehydration")}function H(){return c("ConsumerEmailLPPEnabled")}function G(){return!1}function q(){return Object(o.a)().isChangeGateEnabled("DelayLoadImmerES5",Object(r.e)(6051195))}function z(){return Object(o.a)().isChangeGateEnabled("AlignPlaceholderAndA11yLabelValuesV2",Object(r.e)(7522018))}function W(){return Object(o.a)().isChangeGateEnabled("ContentFilterPaneDraftFixes",Object(r.e)(7595190))}function Y(){return Object(o.a)().isChangeGateEnabled("UseSharedIconRegistrationList",Object(r.e)(7773867))}function K(){return Object(o.a)().isChangeGateEnabled("FilterCountNewColor",Object(r.e)(7717507))}function X(){return Object(o.a)().isChangeGateEnabled("TaskAssigneeAriaDescendant",Object(r.e)(7809576))}function Q(){return Object(o.a)().isChangeGateEnabled("TeamsHighContrastTheme",Object(r.e)(7805339))}function J(){return Object(o.a)().isChangeGateEnabled("KeyboardShortcutForStrikethrough",Object(r.e)(7825471))}function Z(){return Object(o.a)().isChangeGateEnabled("PreventReactionInViewMode",Object(r.e)(7974645))}function $(){return Object(o.a)().isChangeGateEnabled("FixMultipleGetFilteredRangeCalls",Object(r.e)(7991826))}function ee(){return Object(o.a)().isChangeGateEnabled("SetSupportsFilterUpdatesToTrue",Object(r.e)(7988779))}function te(){return Object(o.a)().isChangeGateEnabled("MoveNewCommentButton",Object(r.e)(7991302))}function ne(){return Z()&&Object(o.a)().isChangeGateEnabled("PreventReactionForResolvedThread",Object(r.e)(7991344))}function re(){return Object(o.a)().isChangeGateEnabled("V9FilterMenu",Object(r.e)(8027278))}function oe(){return Object(o.a)().isChangeGateEnabled("UrlSanitizing",Object(r.e)(8141725))}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(307);function o(e,t){return Object(r.a)(Object(r.a)({},e),{trackback:t})}function a(e,t,n){return{type:e,payload:t,actionDetail:n}}},,,function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.FullPane=1]="FullPane",e[e.HalfPane=2]="HalfPane",e[e.DiscreteIntegrated=4]="DiscreteIntegrated",e[e.DiscreteIsolated=5]="DiscreteIsolated"}(r||(r={})),t.a=r},function(e,t,n){"use strict";n.d(t,"o",(function(){return u})),n.d(t,"x",(function(){return l})),n.d(t,"r",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"n",(function(){return p})),n.d(t,"d",(function(){return h})),n.d(t,"a",(function(){return v})),n.d(t,"k",(function(){return g})),n.d(t,"b",(function(){return b})),n.d(t,"l",(function(){return C})),n.d(t,"m",(function(){return T})),n.d(t,"s",(function(){return I})),n.d(t,"h",(function(){return S})),n.d(t,"v",(function(){return O})),n.d(t,"t",(function(){return w})),n.d(t,"j",(function(){return j})),n.d(t,"q",(function(){return E})),n.d(t,"u",(function(){return k})),n.d(t,"f",(function(){return P})),n.d(t,"i",(function(){return x})),n.d(t,"g",(function(){return A})),n.d(t,"y",(function(){return D})),n.d(t,"p",(function(){return R})),n.d(t,"w",(function(){return F})),n.d(t,"e",(function(){return N}));var r=n(1028),o=n(14),a=n(1035),i=n(1014),c=n(1025),s=n(1040),d=n(1069),u=function(e){return e.commentState.contextState.isReadOnly},l=function(e){return e.commentState.topVisibleThreadId},f=function(e){return e.commentState.personaIconPropertiesMap},m=function(e){return e.commentState.cardViewState},p=function(e){return e.commentState.highlightedCommentId},h=function(e){return Object(c.e)(e.commentState)?e.commentState.postData:e.commentState.commentData},v=function(e){return Object(c.e)(e.commentState)?e.commentState.commentThreadIds:e.commentState.commentData},g=function(e){var t=s.g(e);if(t){if(s.a(e)){var n=s.d(e);return t.supportedContentTypes!==r.b.CommentThread&&(n=n.filter((function(e){return e.contentType===r.b.CommentThread}))),n.map((function(e){return e.contentId}))}return[]}return v(e)},y={},b=function(e){return Object(c.e)(e.commentState)?e.commentState.cardPostIds:y},C=function(e){return v(e).length>0},T=function(e){return g(e).length>0},I=function(e){return e.commentState.postViewState},S=function(e){return e.commentState.draftState},O=function(e){return Object(i.K)(S(e))},w=function(e){return e.commentState.selectedComment},j=function(e){return e.commentState.expandedComments},E=function(e){return e.commentState.pendingCommentLoad},k=function(e){return e.commentState.selectedThreadIdBeforeCommentSession},P=function(e){return e.commentState.contextState},x=function(e,t,n){return Object(i.G)(S(e),t,n)},A=function(e,t,n){return e.commentState.createdCommentLie&&x(e,t,n)?e.commentState.createdCommentLie:void 0},D=function(){return Object(o.a)([v,s.d,b,h,A,S,d.b,s.g],(function(e,t,n,r,o,i,c,s){return s?a.k(t,n,r,c,o,i):a.m(e,n,r,c)}))},R=function(e){return e.commentState.modelCapabilities},F=function(e){return e.commentState.suggestionsDetails},N=function(e,t){return t?Object(c.b)(h(e),t):void 0}},function(e,t,n){"use strict";n.d(t,"P",(function(){return N})),n.d(t,"Z",(function(){return M})),n.d(t,"Y",(function(){return L})),n.d(t,"O",(function(){return B})),n.d(t,"z",(function(){return V})),n.d(t,"e",(function(){return U})),n.d(t,"L",(function(){return _})),n.d(t,"y",(function(){return H})),n.d(t,"k",(function(){return G})),n.d(t,"t",(function(){return q})),n.d(t,"o",(function(){return z})),n.d(t,"g",(function(){return W})),n.d(t,"f",(function(){return Y})),n.d(t,"j",(function(){return K})),n.d(t,"i",(function(){return X})),n.d(t,"N",(function(){return Q})),n.d(t,"v",(function(){return J})),n.d(t,"x",(function(){return Z})),n.d(t,"w",(function(){return $})),n.d(t,"a",(function(){return ee})),n.d(t,"U",(function(){return te})),n.d(t,"R",(function(){return ne})),n.d(t,"V",(function(){return re})),n.d(t,"m",(function(){return oe})),n.d(t,"l",(function(){return ae})),n.d(t,"A",(function(){return ie})),n.d(t,"C",(function(){return se})),n.d(t,"E",(function(){return de})),n.d(t,"D",(function(){return ue})),n.d(t,"gb",(function(){return le})),n.d(t,"F",(function(){return me})),n.d(t,"bb",(function(){return pe})),n.d(t,"p",(function(){return he})),n.d(t,"q",(function(){return ve})),n.d(t,"B",(function(){return ge})),n.d(t,"G",(function(){return ye})),n.d(t,"fb",(function(){return be})),n.d(t,"b",(function(){return Ce})),n.d(t,"M",(function(){return Ie})),n.d(t,"u",(function(){return Se})),n.d(t,"n",(function(){return Oe})),n.d(t,"W",(function(){return je})),n.d(t,"db",(function(){return Ee})),n.d(t,"eb",(function(){return ke})),n.d(t,"cb",(function(){return Pe})),n.d(t,"H",(function(){return xe})),n.d(t,"I",(function(){return De})),n.d(t,"J",(function(){return Re})),n.d(t,"K",(function(){return Fe})),n.d(t,"X",(function(){return Ne})),n.d(t,"T",(function(){return Me})),n.d(t,"ab",(function(){return Le})),n.d(t,"S",(function(){return Be})),n.d(t,"c",(function(){return Ve})),n.d(t,"Q",(function(){return Ue})),n.d(t,"h",(function(){return _e})),n.d(t,"d",(function(){return He})),n.d(t,"s",(function(){return Ge})),n.d(t,"r",(function(){return qe}));var r=n(307),o=n(1004);function a(e,t){var n=e.filter(t);return n.length===e.length?e:n}var i=n(1005),c=n(1041),s=n(1047),d=n(1260),u=n(1178),l=n(1079),f=n(1031),m=n(1180),p=n(1030),h=n(1066),v=n(1012),g=n(1034),y=n(1015),b=n(1082),C=(new b.a).insert("").toJSON();(new b.a).toJSON();var T=n(1037),I=n(1033),S=n(1016),O=n(1036),w=n(1006),j=n(1050),E=n(1067),k=n(1026),P=n(1083),x=n(1100),A=n(1032),D=n(1025),R=n(1101),F=n(1123);function N(e){return""===e||null===e?void 0:e}function M(e,t){if(!e[t])return e;var n=Object(r.a)({},e);return delete n[t],n}function L(e,t,n){var o=void 0!==n&&e[n]===t?n:-1;if(o<0&&(o=e.findIndex((function(e){return e===t}))),o<0)return e;var a=Object(r.h)([],Object(r.f)(e),!1);return a.splice(o,1),a}function B(e){return e.state===P.a.Placeholder||e.state===P.a.Loading}function V(e,t,n){var r,o;return Object(D.c)(e)?null!==(o=null===(r=t[n])||void 0===r?void 0:r.map((function(t){return e[t]})))&&void 0!==o?o:[]:e.filter((function(e){return Object(f.b)(e)===n}))}function U(e){return{commentId:e,commentBody:C,author:{UserId:"",Provider:"",DisplayName:""},parentId:"",commentFlags:0}}function _(e,t,n,r){if(n<0)return-1;for(var o=0,a=-1,i=0;i<e.length;i++)if(e[i]!==r){if(o===n)return i;if(o>n)return a===i-1?i-2:i-1;o+=t[e[i]].length}else a=i;return o===n?e.length:-1}function H(e,t,n){for(var r={},o=0;o<e.length;++o)r[e[o].commentId]=G(!w.W()&&t.includes(Object(f.b)(e[o]))?z(e[o].date,e[o].displayDate,n.dataCulture):e[o].displayDate);return r}function G(e){return{displayDate:e,displayingErrorUI:!1,pending:x.a.None}}function q(e){return{displayDate:e}}function z(e,t,n){return t||(!e||isNaN(e.getDate())?"":g.a(e,n))}function W(e,t,n,o){for(var a,c=void 0,s=!1,d=0;d<n.length;d++)if(Object(f.b)(n[d])===e){s=!0,Object(i.k)().assertConditionTag(!!t[n[d].commentId],"PostState unexpectedly missing from PostViewState on ensuring its displayDate - creating with defaults",540112392);var u=null!==(a=t[n[d].commentId])&&void 0!==a?a:G(void 0);u.displayDate||(c||(c=Object(r.a)({},t)),c[n[d].commentId]=Object(r.a)(Object(r.a)({},u),{displayDate:z(n[d].date,n[d].displayDate,o.dataCulture)}))}else if(s)break;return c}function Y(e,t,n,o){var a=void 0;return e.forEach((function(e){var c;if(n[e]){Object(i.k)().assertConditionTag(!!t[e],"PostState unexpectedly missing from PostViewState on ensuring its displayDate - creating with defaults",538035351);var s=null!==(c=t[e])&&void 0!==c?c:G(void 0);s.displayDate||(a||(a=Object(r.a)({},t)),a[e]=Object(r.a)(Object(r.a)({},s),{displayDate:z(n[e].date,n[e].displayDate,o.dataCulture)}))}})),a}function K(e,t){for(var n={},r=0;r<e.length;++r)""===e[r].parentId&&(n[e[r].commentId]=X(void 0,t));return n}function X(e,t){return J(e,t===P.a.Loading||t===P.a.Placeholder?{state:t,initialItemCount:1}:{state:null!=t?t:P.a.Loaded})}function Q(e){var t,n,o={};try{for(var a=Object(r.i)(e),i=a.next();!i.done;i=a.next()){var c=i.value;o[c.threadId]=J(void 0,{state:P.a.Placeholder,initialItemCount:c.itemCount})}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return o}function J(e,t){return{loadState:null!=t?t:{state:P.a.Loaded},pending:E.a.None,alternateId:e}}function Z(e){var t={};return t[e]={pending:x.a.Post,displayDate:void 0,displayingErrorUI:!1},t}function $(e){var t={};return t[e]={pending:E.a.Card,loadState:{state:P.a.Loaded},alternateId:e},t}function ee(e,t,n){var r=ne(e,t,n),o=Fe(n);if(w.s()){var a=null==o?void 0:o.commentDraft.sessionConfiguration;"EDIT"===(null==a?void 0:a.sessionType)&&o&&!r.some((function(e){return e===o.threadId}))&&r.push(o.threadId)}return!t||r.includes(t.selectedCardId)?r:o&&o.threadId===t.selectedCardId?[o.threadId]:o&&r.includes(o.threadId)?[t.selectedCardId,o.threadId]:[t.selectedCardId]}function te(e,t,n,r){if(!t.includes(e))return t;var o=Fe(n);return o&&o.threadId===e?t:r&&Object(A.j)(r.selectionDetails)?(Object(i.k)().assertConditionTag(!1,"Trying to collapse a card while it has a selected post",570529298),t):o&&t.includes(o.threadId)?[o.threadId]:[]}function ne(e,t,n){var r=Fe(n);return a(e,(function(e){return e===(null==t?void 0:t.selectedCardId)||e===(null==r?void 0:r.threadId)}))}function re(e,t,n){var r=Fe(n);return a(e,(function(e){return t[e]||e===(null==r?void 0:r.threadId)}))}function oe(e){return{selectedCardId:e,selectionDetails:ae()}}function ae(){return{lowFidelityWarningType:void 0}}function ie(e,t){var n,r=e.draftState.postIdToDraftIdMap[t];if(!r)return e.selectedComment;var a=e.draftState.drafts[r];if(!a.isInCurrentContext)return(null===(n=e.selectedComment)||void 0===n?void 0:n.selectedCardId)===a.threadId?void 0:e.selectedComment;var i=Object(D.b)(Object(D.a)(e),t);if(!i)throw new S.a(O.i,o.d.reserveTag(589103587),-2130957563);return oe(Object(f.b)(i))}function ce(e,t){return{selectedCardId:e,selectionDetails:{selectedPostId:t,lowFidelityWarningType:void 0}}}function se(e,t){switch(t.sessionConfiguration.sessionType){case"CREATE":return oe(t.sessionConfiguration.draftId);case"EDIT":return function(e,t){var n=Object(D.b)(e,t);if(n)return ce(Object(f.b)(n),t);throw new S.a(O.d,o.d.reserveTag(589103616),-2130957556)}(e,t.sessionConfiguration.commentId);case"REPLY":return function(e,t){var n=Object(D.b)(e,t);if(n&&""===n.parentId)return oe(t);throw new S.a(O.d,o.d.reserveTag(589103617),-2130957556)}(e,t.sessionConfiguration.threadId);default:throw new S.a(O.c,o.d.reserveTag(589103618),-2130957532)}}function de(e){switch(e.commentDraft.sessionConfiguration.sessionType){case"CREATE":case"REPLY":return oe(e.threadId);case"EDIT":return ce(e.threadId,e.commentDraft.sessionConfiguration.commentId);default:throw new S.a(O.c,o.d.reserveTag(577610274),-2130957532)}}function ue(e,t,n){return(null==t?void 0:t.selectedCardId)===e&&Object(A.j)(t.selectionDetails)&&!Object(k.l)(n)?oe(e):t}function le(e,t){var n=t.payload;return{selectedCardId:n.selectedCard,selectionDetails:fe(e,n)}}function fe(e,t){return t.selectType===j.a.SelectPost?e&&Object(A.j)(e.selectionDetails)&&t.selectedPost===e.selectionDetails.selectedPostId?e.selectionDetails:{selectedPostId:t.selectedPost,lowFidelityWarningType:void 0}:{lowFidelityWarningType:e&&!Object(A.j)(e.selectionDetails)&&t.selectedCard===e.selectedCardId?e.selectionDetails.lowFidelityWarningType:void 0}}function me(e,t,n){var r,o=t.payload.params;return Object(l.f)(o)?oe(n):Object(l.e)(o)?{selectedCardId:n,selectionDetails:{lowFidelityWarningType:void 0,selectedPostId:o.commentId}}:oe(null!==(r=null==e?void 0:e.selectedCardId)&&void 0!==r?r:n)}function pe(e,t,n){if("CLEAR_COMMENT_SELECTION"===n.type)return!!t&&!Object(k.l)(e);if(!t)return!0;if(Object(k.l)(e))return n.payload.selectedCard===t.selectedCardId&&!Object(A.j)(t.selectionDetails)&&n.payload.selectType===j.a.ExpandCard;if(n.payload.selectedCard===t.selectedCardId)switch(n.payload.selectType){case j.a.SelectCard:return Object(A.j)(t.selectionDetails);case j.a.Polite:return!1;case j.a.SelectPost:case j.a.ExpandCard:return!0;default:Object(o.m)(n.payload)}return!0}function he(e){var t={};return e.commentId&&(t[e.commentId]={pending:E.a.None,loadState:{state:P.a.Loaded},alternateId:e.commentId}),t}function ve(e){var t={};return e.commentId&&(t[e.commentId]={pending:x.a.None,displayDate:void 0,displayingErrorUI:!1}),t}function ge(e,t){return e&&e.selectedCardId===t.payload.commentId?oe(t.payload.commentId):e}function ye(e,t,n){if(e.pendingDraft&&"CREATE"===e.pendingDraft.sessionType)return Object(y.y)();if(e.committedLieId)return e.committedLieId;var r=Fe(e);return!r||"CREATE"!==r.commentDraft.sessionConfiguration.sessionType||t&&!r.isInCurrentContext||n&&r.renderContextType!==n&&r.renderContextType!==v.a.None?void 0:r.commentDraft.sessionConfiguration.draftId}function be(e,t,n,r){var o=L(e,n);if(o.length<e.length){var a=_(o,t,r.flatIndex);a>=0&&o.splice(a,0,n)}return o}function Ce(e,t,n,o){if(!ye(o,!0))return e;var a=ye(o);if(e&&a&&n[a]&&n[a].pending===E.a.None){var i=Object(r.a)({},e),c=t.length;if(i.flatIndex>=c)i.flatIndex=c;else if(i.flatIndex>=0&&t[i.flatIndex].parentId){var s=new u.a(t,i.flatIndex);s.next().done?i.flatIndex=c:i.flatIndex=s.currentIndex()}return i}}function Te(e,t,n){if(!t)return-1;var r=n?t.selectedCardId:Object(A.b)(t);return e.findIndex((function(e){return e.commentId===r}))}function Ie(e,t){return Object(D.f)(e)?t?e.findIndex((function(e){return e===t.selectedCardId})):-1:Te(e,t,!0)}function Se(e,t,n){if(Object(D.c)(e)){if(!n||!t[n.selectedCardId])return-1;var r=Object(A.b)(n);return t[n.selectedCardId].findIndex((function(e){return e===r}))}return Te(e,n,!1)}function Oe(e){if(!Object(k.c)(e))return h.a.NoDraft;if(!function(e){var t=De(e),n=t?e.drafts[e.cardIdToDraftIdMap[t]]:void 0;return!!(null==n?void 0:n.isDraftEmpty)}(e))return h.a.CannotAutoDiscard;var t=Fe(e);return t&&Object(c.k)(t.commentDraft.sessionConfiguration)?h.a.CannotAutoDiscard:h.a.CanAutoDiscard}function we(e,t){if(void 0===t)return Object(i.k)().assertConditionTag(0===Object.keys(e).length,"Invalid number of drafts.",593762516),e;var n=t.sessionConfiguration.draftId;return Object(i.k)().assertConditionTag(1===Object.keys(e).length,"Invalid number of drafts.",593762517),Object(i.k)().assertConditionTag(!!e[n],"Draft is not in map",593762518),w.s()&&n&&Object(m.a)().removeItem(n),M(e,n)}function je(e){return Oe(e)===h.a.CanAutoDiscard?Object(k.h)():e}function Ee(e,t,n,r,a,i){var c,s;if(e.pendingDraft)switch(e.pendingDraft.sessionType){case"REPLY":if(!t[c=e.pendingDraft.threadId])return e;break;case"EDIT":if(!r[s=e.pendingDraft.commentId])return e;break;default:return e}else{var d=Fe(e);if(!d||!d.isInCurrentContext)return e;switch(d.commentDraft.sessionConfiguration.sessionType){case"REPLY":c=d.threadId;break;case"EDIT":s=d.commentDraft.sessionConfiguration.commentId;break;default:return e}}if(c&&!n[c]){var u=Me(e,c);return Object(R.b)(e,u,3,i,o.d.reserveTag(539297118)),u}if(s&&!a[s]){u=Le(e,s);return Object(R.b)(e,u,2,i,o.d.reserveTag(539297119)),u}return e}function ke(e,t){var n=Object(r.a)({},e.drafts),o=!1;return Object.keys(n).forEach((function(e){var a=t(e);a!==n[e].renderContextType&&(n[e]=Object(r.a)(Object(r.a)({},n[e]),{renderContextType:a}),o=!0)})),o?Object(r.a)(Object(r.a)({},e),{drafts:n}):e}function Pe(e,t){if(t===p.a.Closed){if(Object(I.b)(e))return v.a.None}else if(e===v.a.DiscreteIntegrated)return v.a.FullPane;return e}function xe(e){var t=Fe(e);return t?t.commentDraft:void 0}function Ae(e){var t=Object.keys(e);if(t.length>1)throw Object(i.k)().assertConditionTag(!1,"Invalid number of drafts.",593762519),new S.a("Only a single draft is supported at this time.",o.d.reserveTag(589103619),-2130957551);if(0!==t.length)return t[0]}function De(e){return Ae(e.cardIdToDraftIdMap)}function Re(e){return Ae(e.postIdToDraftIdMap)}function Fe(e){var t=e.drafts,n=Ae(t);return n?t[n]:void 0}function Ne(e){var t,n,a=e.drafts,c=Object.keys(a).filter((function(e){var t;return null===(t=a[e])||void 0===t?void 0:t.isInCurrentContext})).map((function(e){return a[e]}));if(0===c.length)return e;var s=Object(r.a)({},e);try{for(var d=Object(r.i)(c),u=d.next();!u.done;u=d.next()){var l=u.value;switch(l.commentDraft.sessionConfiguration.sessionType){case"CREATE":case"REPLY":case"METADATA":Object(i.k)().assertConditionTag("METADATA"!==l.commentDraft.sessionConfiguration.sessionType,"Metadata session removed on context change, but metadata sessions should not be long lived.",545630307),s=Me(s,l.threadId);break;case"EDIT":s=Le(s,l.commentDraft.sessionConfiguration.commentId);break;default:Object(o.m)(l.commentDraft.sessionConfiguration)}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}return s}function Me(e,t){var n,o=e.pendingDraft&&Object(l.f)(e.pendingDraft)&&e.pendingDraft.threadId===t,a=e.cardIdToDraftIdMap[t];return a?Object(r.a)(Object(r.a)({},e),{drafts:we(e.drafts,null===(n=e.drafts[a])||void 0===n?void 0:n.commentDraft),cardIdToDraftIdMap:M(e.cardIdToDraftIdMap,t),pendingDraft:o?void 0:e.pendingDraft}):o?Object(r.a)(Object(r.a)({},e),{pendingDraft:void 0}):e}function Le(e,t){var n,o=e.pendingDraft&&Object(l.e)(e.pendingDraft)&&e.pendingDraft.commentId===t,a=e.postIdToDraftIdMap[t];return a?Object(r.a)(Object(r.a)({},e),{drafts:we(e.drafts,null===(n=e.drafts[a])||void 0===n?void 0:n.commentDraft),postIdToDraftIdMap:M(e.postIdToDraftIdMap,t),pendingDraft:o?void 0:e.pendingDraft}):o?Object(r.a)(Object(r.a)({},e),{pendingDraft:void 0}):e}function Be(e,t,n){var o=Me(e,t),a=Re(o);if(a){var i=o.postIdToDraftIdMap[a],c=o.drafts[i];c&&c.threadId===t&&(o=Le(o,a))}if(o.pendingDraft&&Object(l.e)(o.pendingDraft)){var s=o.pendingDraft.commentId,d=n.find((function(e){return e.commentId===s}));d&&Object(f.b)(d)===t&&(o=Object(r.a)(Object(r.a)({},o),{pendingDraft:void 0}))}return o}function Ve(e){if("web"===Object(T.a)()||"win32"===Object(T.a)()){if(e.tasks===d.a.Unknown){if("win32"===Object(T.a)())return w.c();Object(i.k)().assertConditionTag(!1,"Tasks Model Capability state has not been sent by the app.",590144153)}return e.tasks===d.a.Enabled&&w.c()}return w.c()}function Ue(e,t,n,a){var c,s=e.pendingCommentLoad,d=void 0,u=e.expandedComments,l=function(e,t){var n=t?Object(D.e)(t)?{commentThreadIds:Object(r.h)([],Object(r.f)(t.commentThreadIds),!1),cardPostIds:Object(r.a)({},t.cardPostIds),postData:Object(r.a)({},t.postData)}:{commentData:Object(r.h)(Object(r.h)([],Object(r.f)(t.commentData),!1),Object(r.f)(e),!1)}:w.W()?{commentThreadIds:[],cardPostIds:{},postData:{}}:{commentData:e};if(!Object(D.d)(n))return n;var o=void 0;return e.forEach((function(e){if(Object(f.a)(e))n.commentThreadIds.push(e.commentId),n.cardPostIds[e.commentId]=[e.commentId],o=e.commentId;else if(o===e.parentId)n.cardPostIds[e.parentId].push(e.commentId);else{if(!n.cardPostIds[e.parentId])return void Object(i.k)().assertConditionTag(!1,"Orphaned post detected on processing comments array. Omitting storing data.",528773920);n.cardPostIds[e.parentId]=Object(r.h)(Object(r.h)([],Object(r.f)(n.cardPostIds[e.parentId]),!1),[e.commentId],!1),o=e.parentId}n.postData[e.commentId]=e})),n}(t,e);if(s){var m=s.numberOfLoadedComments+t.length,p=s.numberOfLoadedThreads+t.filter(f.a).length;m>=s.numberOfTotalComments?(Object(i.k)().assertConditionTag(m===s.numberOfTotalComments,"Loaded more comments than expected",525693528),s=void 0):s=Object(r.a)(Object(r.a)({},s),{numberOfLoadedComments:m,numberOfLoadedThreads:p})}if(e.pendingCommentLoad){var h=e.pendingCommentLoad.selectedThreadIndex,v=void 0!==h&&Object(F.a)(s,n,a);if(Object(D.d)(l)&&e.createdCommentLie){var g=ye(e.draftState,!0);if(g&&(!l.cardPostIds[g]||v)){var y=_(l.commentThreadIds,l.cardPostIds,e.createdCommentLie.flatIndex);l.cardPostIds[g]||(y<0&&!s&&(Object(i.k)().assertConditionTag(!1,"Draft thread index too large after loading all data, inserting at end",526262789),y=l.commentThreadIds.length),y>=0&&(l.commentThreadIds.splice(y,0,g),l.cardPostIds[g]=[g])),y>=0&&void 0!==h&&y<=h&&(h+=1)}}if(void 0!==h&&v){var b=Object(D.d)(l)?l.commentThreadIds:l.commentData.filter(f.a);if(!(h>=0&&h<b.length))throw Object(o.i)("selectedThreadIndex out of bounds"),new S.a(O.k,o.d.reserveTag(589103620),-2130957565);u=ee(u,d=oe(Object(D.f)(b)?b[h]:b[h].commentId),e.draftState)}}if(e.selectedComment)if(w.X()){var C=Fe(e.draftState);(null!==(c=null==C?void 0:C.threadId)&&void 0!==c?c:ye(e.draftState))===e.selectedComment.selectedCardId&&(d=e.selectedComment,u=e.expandedComments)}else Object(k.d)(e.draftState)&&(d=e.selectedComment,u=e.expandedComments);return Object(r.a)(Object(r.a)({},l),{pendingCommentLoad:s,selectedComment:d,expandedComments:u})}function _e(e,t){var n=Object(D.b)(e,t);return(null==n?void 0:n.author.DisplayName)&&(null==n?void 0:n.date)?{valid:!0,matchesCurrentUser:!!(null==n?void 0:n.author.IsCurrentUser),timeElapsed:(null==n?void 0:n.date)?Date.now()-n.date.getTime():0}:{valid:!1}}function He(e,t,n){return Object(D.f)(e)?n?Object(D.c)(t)?e.some((function(e){return!(t[e].commentFlags&s.a.Resolved)})):t.some((function(t){return""===t.parentId&&!(t.commentFlags&s.a.Resolved)&&e.find((function(e){return e===t.parentId}))})):e.length>0:Object(D.c)(t)?(Object(o.n)(!1,"ThreadData and CommentData must align if Map-Based",o.d.reserveTag(526402327)),!1):n?t.filter((function(e){return""===e.parentId&&!(e.commentFlags&s.a.Resolved)})).length>0:t.length>0}function Ge(){return{atMention:c.b.Unknown,newThread:!1,resolve:!1,richTextCapabilities:0,tasks:d.a.Unknown,virtualized:!1,presentLinkToComment:!1,UIAAnnotationPattern:!1,ContentExtensionHostingDisabled:!1}}function qe(e,t){var n,o=e.cardIdToDraftIdMap[t.commentId],a=o?e.drafts[o].commentDraft:void 0;if(void 0===a)return Object(i.k)().assertConditionTag(0===Object.keys(e.drafts).length,"Could not find draft for adding smart replies",590202465),e;var c=t.smartReplies,s=a.sessionConfiguration.sessionType,d=c.length;return"REPLY"===s&&(d<=3&&d>0)?Object(r.a)(Object(r.a)({},e),{drafts:Object(r.a)(Object(r.a)({},e.drafts),(n={},n[o]=Object(r.a)(Object(r.a)({},e.drafts[o]),{smartReplies:c}),n))}):e}},function(e,t,n){"use strict";n.d(t,"f",(function(){return o})),n.d(t,"G",(function(){return a})),n.d(t,"x",(function(){return i})),n.d(t,"I",(function(){return c})),n.d(t,"i",(function(){return s})),n.d(t,"A",(function(){return d})),n.d(t,"R",(function(){return u})),n.d(t,"v",(function(){return l})),n.d(t,"S",(function(){return f})),n.d(t,"Q",(function(){return m})),n.d(t,"e",(function(){return p})),n.d(t,"H",(function(){return h})),n.d(t,"O",(function(){return v})),n.d(t,"a",(function(){return g})),n.d(t,"w",(function(){return y})),n.d(t,"t",(function(){return b})),n.d(t,"h",(function(){return C})),n.d(t,"z",(function(){return T})),n.d(t,"l",(function(){return I})),n.d(t,"ab",(function(){return S})),n.d(t,"J",(function(){return O})),n.d(t,"r",(function(){return w})),n.d(t,"d",(function(){return j})),n.d(t,"b",(function(){return E})),n.d(t,"C",(function(){return k})),n.d(t,"p",(function(){return P})),n.d(t,"q",(function(){return x})),n.d(t,"y",(function(){return A})),n.d(t,"D",(function(){return D})),n.d(t,"U",(function(){return R})),n.d(t,"X",(function(){return F})),n.d(t,"W",(function(){return N})),n.d(t,"j",(function(){return M})),n.d(t,"k",(function(){return L})),n.d(t,"V",(function(){return B})),n.d(t,"Y",(function(){return V})),n.d(t,"K",(function(){return U})),n.d(t,"u",(function(){return _})),n.d(t,"L",(function(){return H})),n.d(t,"Z",(function(){return G})),n.d(t,"E",(function(){return q})),n.d(t,"M",(function(){return z})),n.d(t,"g",(function(){return W})),n.d(t,"s",(function(){return Y})),n.d(t,"c",(function(){return K})),n.d(t,"P",(function(){return X})),n.d(t,"F",(function(){return Q})),n.d(t,"B",(function(){return J})),n.d(t,"T",(function(){return Z})),n.d(t,"N",(function(){return $})),n.d(t,"o",(function(){return ee})),n.d(t,"m",(function(){return te})),n.d(t,"n",(function(){return ne}));n(1004),n(1005),n(1012);function r(e){return"_".concat(e.renderContextType,"_").concat(e.id)}function o(e){return"cardEditor".concat(r(e))}function a(e){return"postEditor".concat(r(e))}function i(e){return"editorRoot_".concat(e)}function c(e){return"postRoot".concat(r(e))}function s(e,t){return t?"draftCardRoot".concat(r(e)):"cardRoot".concat(r(e))}function d(){return"GhostCard"}function u(e){return"replyBoxDescription".concat(r(e))}function l(e){return"editorBoxDescription".concat(r(e))}function f(e){return"sendReplyButton".concat(r(e))}function m(e){return"cancelReplyButton".concat(r(e))}function p(e){return"cardContextMenu".concat(r(e))}function h(e){return"postContextMenu".concat(r(e))}function v(e){return"renderableItemList".concat(r(e))}function g(e,t){return"actionBarButton_".concat(t).concat(r(e))}function y(e){return"editorFocusContainer_".concat(e)}function b(e){return"draftCancelButton".concat(r(e))}function C(e){return"innerReplyBoxContainer".concat(r(e))}function T(){return"firstPaneElement5F6E8B9B-F2EF-4238-B749-89D6F5F132DD"}function I(){return"closePaneButton2F313A40-4603-41E4-90DD-12E000896375"}function S(e){return"viewMoreReply".concat(r(e))}function O(e){return"postTimeStamp".concat(r(e))}function w(e,t){return"".concat(t.replace(/\s/g,"")).concat(r(e))}function j(e,t){return"".concat(t.replace(/\s/g,"")).concat(r(e))}function E(e){return"anchorHintText".concat(r(e))}function k(e){return"lowFidelityWarning".concat(r(e))}function P(){return"CommentsListScrollView"}function x(){return"CommentsList"}function A(){return"EmptyCreatedCommentLie"}function D(){return"NewCommentButton"}function R(e){return"taskAssignerCheckbox".concat(r(e))}function F(e){return"cardTaskFooterPickerButton".concat(r(e))}function N(e){return"taskAssignerLabel".concat(r(e))}function M(e){return"cardTaskTopperCheckbox".concat(r(e))}function L(e){return"cardTaskTopperDiv".concat(r(e))}function B(e){return"taskAssignerDiv".concat(r(e))}function V(){return"TaskChevronIcon"}function U(e){return"postWarning".concat(r(e))}function _(e){return"draftWarning".concat(r(e))}function H(e){return"postingTip".concat(r(e),";")}function G(e){return"truncationOverlay".concat(e)}function q(){return"next-thread-button"}function z(){return"previous-thread-button"}function W(e){return"loadingPlaceholder".concat(r(e))}function Y(e){return"DiscreteHostedCommentRoot".concat(r(e))}function K(e){return"AtMentionExtraInfoButton".concat(r(e))}function X(){return"ReopenThread"}function Q(){return"suggestion-list"}function J(){return"lppSuggestionListId"}function Z(e){return"smartReplyHeader_".concat(e)}function $(e){return"reactionButtonDescription_".concat(e)}function ee(e){return"reactionButtonUserList_".concat(e)}function te(e,t){return"".concat(e,"_").concat(t)}function ne(e){return"commentReactionButton".concat(r(e))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(307),o=n(1004),a=function(e){function t(t,n,r){var o=e.call(this,t,n)||this;return o.tag=n,o.errorCode=r,o.name="CommentError",o}return Object(r.c)(t,e),t.prototype.stringify=function(){return Object(o.e)(this.tag,this.stack,"Error ".concat(function(e){return e>4294967295||e<-4294967296?"dword_out_of_range(".concat(e,")"):"0x".concat((e<0?4294967295+e+1:e).toString(16))}(this.errorCode)),this.innerException)},t}(o.c);function i(e){return Object(o.g)(e,"CommentError")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(307),o={WHITE:"#FFFFFF",BLACK:"#000000",GRAY_A:"#F3F3F3",GRAY_B:"#E6E6E6",GRAY_C:"#D2D2D2",GRAY_C2:"#C6C6C6",GRAY_C3:"#B1B1B1",GRAY_D:"#969696",GRAY_E:"#666666",GRAY_F:"#505050",GRAY_H:"#363636",GRAY_H2:"#333333",GRAY_I:"#262626",GRAY_J:"#0A0A0A",Gray26:"#424242",Gray90:"#E5E5E5",GRAY_20:"#F3F2F1",GRAY_30:"#EDEBE9",GRAY_40:"#E1DFDD",GRAY_50:"#D2D0CE",GRAY_60:"#C8C6C4",GRAY_70:"#BEBBB8",GRAY_100:"#979593",GRAY_110:"#8A8886",GRAY_130:"#605E5C",GRAY_140:"#484644",GRAY_150:"#3B3A39",GRAY_160:"#323130",GRAY_180:"#252423",GRAY_200:"#1B1A19"},a={FIRST_RUN_GRAY:"#f7f7f7",COMMENTS_PURPLE:"#9C44A6",COMMENTS_GRAY:"#EAEAEA",FLUENT_RESOLVED:"#B3B0AD",FOCUS_BOX:"#797775",DOT_BLUE:"#006BFF",REST_RESOLVED_BODY:o.GRAY_20,RESOLVED_CARD_TEXT:o.GRAY_130,ACTIVE_COMMENT_TEXT:o.GRAY_H2,SUGGESTED_PICKER_ITEM:"#DEECF9",SUGGESTED_PICKER_ITEM_HOVER:"#C7E0F4"},i=Object(r.a)(Object(r.a)({},o),a)},function(e,t,n){"use strict";n.d(t,"f",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return m})),n.d(t,"m",(function(){return p})),n.d(t,"b",(function(){return h})),n.d(t,"l",(function(){return y})),n.d(t,"k",(function(){return b})),n.d(t,"o",(function(){return I})),n.d(t,"j",(function(){return S})),n.d(t,"a",(function(){return O})),n.d(t,"g",(function(){return w})),n.d(t,"i",(function(){return j})),n.d(t,"h",(function(){return E})),n.d(t,"n",(function(){return k}));var r,o,a,i,c,s=n(2),d=n(1017),u=1e3,l="2px",f="4px",m="@media screen and (-ms-high-contrast: active), (forced-colors: active)",p={content:'""',position:"absolute",left:-1,top:-1,bottom:-1,right:-1,border:0,outline:"none",zIndex:1},h={BUTTON_HOVER:"#F3F2F1",BUTTON_SELECT:"#E1DFDD",BUTTON_DOWN:"#D2D0CE",BUTTON_DISABLED:"#FAF9F8",HIGH_CONTRAST:{BUTTON_FOCUS:"highlight"}},v=((r={forcedColorAdjust:"auto",MsHighContrastAdjust:"auto",svg:{forcedColorAdjust:"auto"}})[m]={color:"revert",stroke:"revert"},r);function g(e){return Object(s.mergeStyles)(e,v)}var y={selectors:(o={},o[s.HighContrastSelector]={backgroundColor:"Highlight",color:"HighlightText",borderColor:"WindowText",MsHighContrastAdjust:"none",selectors:{"svg > path":{fill:"HighlightText"}}},o)},b=Object(s.mergeStyles)(y,{selectors:(a={},a[s.HighContrastSelector]={outline:"2px",outlineOffset:"-2px"},a)}),C=Object(s.mergeStyles)({selectors:(i={},i[s.HighContrastSelector]={outline:"2px",outlineOffset:"-2px"},i)}),T=Object(s.mergeStyles)(((c={})[m]={color:"ButtonText"},c)),I=function(e){void 0===e&&(e={});var t={rootHovered:g(b),rootFocused:g(y),rootDisabled:g(C),icon:g(T)};return Object(s.mergeStyleSets)(e,t)};function S(e){var t;return Object(s.mergeStyleSets)(e,{root:(t={},t[s.HighContrastSelector]={color:"ButtonText"},t)})}var O={LEVEL1:"0px 1px 2px 0px rgba(0,0,0,0.10)",LEVEL2:"0px 2px 4px 0px rgba(0,0,0,0.10)",LEVEL3:"0px 4px 8px 0px rgba(0,0,0,0.10)",LEVEL4:"0px 8px 16px 0px rgba(0,0,0,0.10)",LEVEL5:"0px 16px 24px 0px rgba(0,0,0,0.10)"},w='"Segoe UI"',j='"Segoe UI Web"',E='"Segoe UI Semibold"';function k(e,t,n){var r,o;return!e||t?null!==(r=null==n?void 0:n.CardBackground)&&void 0!==r?r:d.a.WHITE:null!==(o=null==n?void 0:n.ResolvedCardBackground)&&void 0!==o?o:d.a.REST_RESOLVED_BODY}},,function(e,t,n){"use strict";n.r(t),n.d(t,"chainActionDetails",(function(){return r.a})),n.d(t,"createAction",(function(){return r.b})),n.d(t,"addContentExtension",(function(){return o.a})),n.d(t,"addToCurrentMentionees",(function(){return a})),n.d(t,"applyCommentChanges",(function(){return i})),n.d(t,"beginDraftingFailure",(function(){return c.a})),n.d(t,"beginDraftingSuccess",(function(){return s.a})),n.d(t,"beginProcessingCommit",(function(){return d.a})),n.d(t,"beginProcessingDiscard",(function(){return u.a})),n.d(t,"beginViewInitialization",(function(){return l.a})),n.d(t,"cancelCommentCreateThread",(function(){return f})),n.d(t,"cancelCommentPostEdit",(function(){return m})),n.d(t,"cancelCommentReply",(function(){return p})),n.d(t,"cancelDiscard",(function(){return h.a})),n.d(t,"clearCommentHighlight",(function(){return v.a})),n.d(t,"clearCommentSelection",(function(){return g.a})),n.d(t,"clearLowFidelityWarning",(function(){return y})),n.d(t,"clearPostErrorUI",(function(){return b})),n.d(t,"collapseCard",(function(){return C})),n.d(t,"commentContextChanged",(function(){return T})),n.d(t,"commitDraft",(function(){return I.a})),n.d(t,"getCommitDraftSessionType",(function(){return I.b})),n.d(t,"commitFailure",(function(){return S.a})),n.d(t,"dispatchLoadThreads",(function(){return O})),n.d(t,"displayDraftWarning",(function(){return w.a})),n.d(t,"draftEmptinessChanged",(function(){return j})),n.d(t,"emptyAction",(function(){return E.b})),n.d(t,"EMPTY_ACTION",(function(){return E.a})),n.d(t,"endViewInitialization",(function(){return k.a})),n.d(t,"highlightComment",(function(){return P.a})),n.d(t,"loadComment",(function(){return x.a})),n.d(t,"loadDefaultFilter",(function(){return A})),n.d(t,"loadFilter",(function(){return D})),n.d(t,"loadPersonaIconProperties",(function(){return R.a})),n.d(t,"loadVirtualizedComments",(function(){return F.a})),n.d(t,"moveFocusToCanvas",(function(){return N})),n.d(t,"nextPopulatedContextDetailsUpdated",(function(){return M})),n.d(t,"onInitialRender",(function(){return L})),n.d(t,"populateSmartReply",(function(){return B})),n.d(t,"requestPresentLinkToComment",(function(){return V})),n.d(t,"queueLoadThreads",(function(){return U})),n.d(t,"readyToRender",(function(){return _})),n.d(t,"reloadComments",(function(){return H.a})),n.d(t,"removeContentExtensions",(function(){return G})),n.d(t,"requestClosePane",(function(){return q})),n.d(t,"requestDeletePost",(function(){return z})),n.d(t,"requestDeleteThread",(function(){return W})),n.d(t,"requestModalConfirmation",(function(){return Y})),n.d(t,"requestReopenThread",(function(){return K})),n.d(t,"requestShowPane",(function(){return X})),n.d(t,"requestThreadResolve",(function(){return Q})),n.d(t,"resolveAtMentionCapability",(function(){return J.a})),n.d(t,"saveDraft",(function(){return Z.a})),n.d(t,"SelectActionType",(function(){return $.a})),n.d(t,"shouldSelectActionExpandCard",(function(){return $.c})),n.d(t,"selectComment",(function(){return $.b})),n.d(t,"selectContent",(function(){return ee})),n.d(t,"selectFirstThreadInNextCommentContext",(function(){return te})),n.d(t,"selectLastThreadInPreviousCommentContext",(function(){return ne})),n.d(t,"sessionRequestStartedAndLockSelection",(function(){return re.a})),n.d(t,"setContentNavigationEnablement",(function(){return oe})),n.d(t,"setFilteringCapabilities",(function(){return ae})),n.d(t,"showLowFidelityWarning",(function(){return ie.a})),n.d(t,"showPostErrorUI",(function(){return ce})),n.d(t,"toggleTaskAssigner",(function(){return se})),n.d(t,"topVisibleThreadChanged",(function(){return de.a})),n.d(t,"updateContextState",(function(){return ue.a})),n.d(t,"updateDraftRenderContext",(function(){return le})),n.d(t,"updateDraftThread",(function(){return fe})),n.d(t,"updateExtensionPriority",(function(){return me})),n.d(t,"updateFilterRange",(function(){return pe})),n.d(t,"updateMentioneesStillInDraft",(function(){return he})),n.d(t,"updateModelCapabilities",(function(){return ve})),n.d(t,"updateSelectedTaskAssignee",(function(){return ge})),n.d(t,"updateSelectedTaskAssignees",(function(){return ye})),n.d(t,"updateSuggestionsDetails",(function(){return be.a})),n.d(t,"viewContainerChanged",(function(){return Ce})),n.d(t,"viewContainerFoldableLayoutStateChanged",(function(){return Te})),n.d(t,"viewContainerVisibilityChanged",(function(){return Ie}));var r=n(1009),o=n(1154);function a(e,t){return Object(r.b)("ADD_TO_CURRENT_MENTIONEES",{mentionee:t},e)}function i(e,t){return Object(r.b)("APPLY_COMMENT_CHANGES",{changes:t},e)}var c=n(1155),s=n(1156),d=n(1157),u=n(1158),l=n(1159);function f(e,t){return Object(r.b)("CANCEL_COMMENT_CREATE_THREAD",{closeOnDiscard:t},e)}function m(e,t,n){return Object(r.b)("CANCEL_COMMENT_POST_EDIT",{commentId:t,closeOnDiscard:n},e)}function p(e,t,n){return Object(r.b)("CANCEL_COMMENT_REPLY",{commentId:t,closeOnDiscard:n},e)}var h=n(1160),v=n(1161),g=n(1162);function y(e){return Object(r.b)("CLEAR_LOW_FIDELITY_WARNING",void 0,e)}function b(e,t){return Object(r.b)("CLEAR_POST_ERROR_STATE",{commentId:t},e)}function C(e,t){return Object(r.b)("COLLAPSE_CARD",{cardId:t},e)}function T(e,t){return Object(r.b)("COMMENT_CONTEXT_CHANGED",t,e)}var I=n(1163),S=n(1164);function O(e,t){return Object(r.b)("DISPATCH_LOAD_THREADS",t,e)}var w=n(1122);function j(e,t,n){return Object(r.b)("DRAFT_EMPTINESS_CHANGED",{isEmpty:t,draftId:n},e)}var E=n(1078),k=n(1165),P=n(1166),x=n(1167);function A(e,t){return Object(r.b)("LOAD_DEFAULT_FILTER",t,e)}function D(e,t){return Object(r.b)("LOAD_FILTER",t,e)}var R=n(1168),F=n(1169);function N(e,t){return Object(r.b)("MOVE_FOCUS_TO_CANVAS",{resource:t},e)}function M(e,t){return Object(r.b)("NEXT_POPULATED_CONTEXT_DETAILS_UPDATED",{nextPopulatedContextDetails:t},e)}function L(e,t){return Object(r.b)("ON_INITIAL_RENDER",t,e)}function B(e,t){return Object(r.b)("POPULATE_SMART_REPLY",t,e)}function V(e,t){return Object(r.b)("PRESENT_LINK_TO_COMMENT",{commentId:t},e)}function U(e,t){return Object(r.b)("QUEUE_LOAD_THREADS",t,e)}function _(e){return Object(r.b)("READY_TO_RENDER",{},e)}var H=n(1170);function G(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Object(r.b)("REMOVE_CONTENT_EXTENSION",{renderModes:t},e)}function q(e){return Object(r.b)("REQUEST_CLOSE_PANE",{},e)}function z(e,t){return Object(r.b)("REQUEST_DELETE_POST",{commentId:t},e)}function W(e,t,n){return Object(r.b)("REQUEST_DELETE_THREAD",{commentId:t,isTask:n},e)}function Y(e,t,n,o){return Object(r.b)("REQUEST_MODAL_CONFIRMATION",{onConfirm:t,onCancel:n,displayStrings:o},e)}function K(e,t,n){return Object(r.b)("REQUEST_REOPEN_THREAD",{commentId:t,isTask:n},e)}function X(e){return Object(r.b)("REQUEST_SHOW_PANE",{},e)}function Q(e,t,n){return Object(r.b)("REQUEST_THREAD_RESOLVE",{commentId:t,isTask:n},e)}var J=n(1171),Z=n(1172),$=n(1050);function ee(e,t,n,o,a,i,c){return Object(r.b)("SELECT_CONTENT",{selectDirection:t,from:i,reason:c,iterableContentTypes:n,restrictToCurrentContext:o,preventLooping:a},e)}function te(e){return Object(r.b)("SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT",{},e)}function ne(e){return Object(r.b)("SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT",{},e)}var re=n(1173);function oe(e,t){return Object(r.b)("SET_CONTENT_NAVIGATION_ENABLEMENT",{isEnabled:t},e)}function ae(e,t){return Object(r.b)("SET_FILTERING_CAPABILITIES",t,e)}var ie=n(1174);function ce(e,t){return Object(r.b)("SHOW_POST_ERROR_STATE",{commentId:t},e)}function se(e){return Object(r.b)("TOGGLE_TASK_ASSIGNER_TYPE",{},e)}var de=n(1175),ue=n(1176);function le(e,t,n){return Object(r.b)("UPDATE_DRAFT_RENDER_CONTEXT",{isClaimingLock:t,draftId:n},e)}function fe(e,t){return Object(r.b)("UPDATE_DRAFT_THREAD",t,e)}function me(e,t){return Object(r.b)("UPDATE_EXTENSION_PRIORITY",{updates:t},e)}function pe(e,t){return Object(r.b)("UPDATE_FILTER_RANGE",t,e)}function he(e,t){return Object(r.b)("UPDATE_MENTIONEES_STILL_IN_DRAFT",{emailsStillInDraft:t},e)}function ve(e,t,n){return Object(r.b)("UPDATE_MODEL_STATE",{modelCapabilityFlags:t,richTextCapabilityFlags:n},e)}function ge(e,t){return Object(r.b)("UPDATE_SELECTED_TASK_ASSIGNEE",{selectedAssignee:t},e)}function ye(e,t){return Object(r.b)("UPDATE_SELECTED_TASK_ASSIGNEES",{selectedAssignee:t},e)}var be=n(1177);function Ce(e,t){return Object(r.b)("VIEW_CONTAINER_CHANGED",{viewContainer:t},e)}function Te(e,t){return Object(r.b)("VIEW_CONTAINER_FOLDABLE_LAYOUT_STATE_CHANGED",{foldableLayoutState:t},e)}function Ie(e,t){return Object(r.b)("VIEW_CONTAINER_VISIBILITY_CHANGED",{visibilityState:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1004),o=n(1005),a=n(1016),i=function(e){return function(t){Object(a.b)(t)?Object(o.k)().assertConditionTag(!1,t.message,e):Object(o.k)().assertConditionTag(!1,"Unknown error ".concat(Object(r.l)(t)),e)}}},function(e,t,n){"use strict";n.d(t,"l",(function(){return d})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return m})),n.d(t,"k",(function(){return p})),n.d(t,"e",(function(){return h})),n.d(t,"f",(function(){return v})),n.d(t,"o",(function(){return g})),n.d(t,"m",(function(){return y})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return C})),n.d(t,"n",(function(){return T})),n.d(t,"d",(function(){return I})),n.d(t,"c",(function(){return S}));var r=n(1004),o=n(1054),a=n(1005),i=n(1037),c=n(1016),s=n(1006);function d(e,t){return!(!e||!t)&&(e.UserId===t.UserId&&e.Provider===t.Provider)}function u(e){return e?Object(o.e)(e)?e.Name:e.DisplayName:""}function l(e){if(!e)return"";if(!Object(o.e)(e))return Object(a.k)().assertConditionTag(!s.z()||"android"===Object(i.a)(),"LPP feature gate should not be enabled",594392914),e.Email;if(e.UserPrincipalName.length>0)return e.UserPrincipalName;if(e.EmailAddresses.length>0&&e.EmailAddresses[0].length>0)return Object(a.k)().assertConditionTag("win32"===Object(i.a)(),"UserPrincipalName is not available, fallback to EmailAddresses",594401410),e.EmailAddresses[0];throw new c.a("UserPrincipalName and EmailAddresses, both not available",r.d.reserveTag(589103706),-2130957499)}function f(e){if(!e)return"";if(Object(o.d)(e)){var t=e.Email||e.UserId;return Object(a.k)().assertConditionTag(!!t,"Email and UserId are both not available on IUser object",529024399),t}return l(e)}function m(e){return e.UserId?e.UserId:p(e)}function p(e){return void 0!==e.DisplayName?e.DisplayName:(Object(a.k)().assertConditionTag(!1,"user.DisplayName is undefined",595133131),e.Email?e.Email:"")}function h(e){return e.author?e.author:{UserId:e.authorIdentity,Provider:"",DisplayName:e.authorName,Email:e.authorEmail,IsCurrentUser:!0,appAuthorId:e.appAuthorId,authorContextId:e.authorContextId}}function v(e){return 0===Object.keys(e).length&&Object(a.k)().assertConditionTag(!1,"MentioneeMap should not be empty",594641282),e[Object.keys(e)[0]].mentionee}function g(e,t){if(e.size!==t.size)return!0;var n=!1;return e.forEach((function(e){t.has(e)||(n=!0)})),n}function y(e,t){t.forEach((function(t){t.UserId&&e[t.UserId]?delete e[t.UserId]:t.Email&&e[t.Email]&&delete e[t.Email]}))}function b(e,t){return t.forEach((function(t){e[f(t)]={assignee:t}})),e}function C(e,t){Object.keys(t).forEach((function(n){e[n]={assignee:t[n].mentionee}}))}function T(e,t){var n=f(t);e[n]?delete e[n]:e[n]={assignee:t}}function I(e){var t={};for(var n in e)e[n].stillInDraft&&(t[n]=e[n]);return t}function S(e){return e.some((function(e){return e.IsCurrentUser}))}},function(e,t,n){"use strict";var r;!function(e){e[e.SharedComments=0]="SharedComments",e[e.Canvas=1]="Canvas"}(r||(r={})),t.a=r},,function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d}));var r=n(1006);function o(e){return r.W()}function a(e){return r.W()}function i(e){return r.W()||0===e.length||"string"==typeof e[0]}function c(e){return r.W()}function s(e){return c()?e.postData:e.commentData}function d(e,t){return a()?e[t]:e.find((function(e){return e.commentId===t}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"g",(function(){return i})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"l",(function(){return f})),n.d(t,"k",(function(){return m})),n.d(t,"b",(function(){return h})),n.d(t,"i",(function(){return v})),n.d(t,"j",(function(){return g})),n.d(t,"m",(function(){return y}));var r,o=n(307),a=n(1006);function i(e){return{isDraftEmpty:e.isDraftEmpty,savedDraftContent:e.savedDraftContent,draftWarningState:e.draftWarningState,currentMentionees:e.currentMentionees,selectedTaskAssignee:e.selectedTaskAssignee,selectedTaskAssignees:e.selectedTaskAssignees,smartReplies:e.smartReplies}}function c(e){return Object.keys(e.drafts)}function s(e){var t=0;for(var n in e.drafts)e.drafts.hasOwnProperty(n)&&++t;return t}function d(){return{drafts:{},cardIdToDraftIdMap:{},postIdToDraftIdMap:{},pendingDraft:void 0,committedLieId:void 0}}function u(e){return s(e)>0}function l(e){return u(e)||m(e)}function f(e){return!a.X()&&l(e)}function m(e){return void 0!==e.pendingDraft}function p(e,t){var n,r;try{for(var a=Object(o.i)(c(e)),i=a.next();!i.done;i=a.next()){var s=i.value;if(e.drafts[s].pendingState===t)return!0}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return!1}function h(e){return p(e,r.None)}function v(e){return p(e,r.Commit)}function g(e){return p(e,r.Discard)}function y(e,t){return g(e)&&h(t)}!function(e){e[e.None=0]="None",e[e.Discard=1]="Discard",e[e.Commit=2]="Commit"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return s}));var r=n(1030),o=function(e){return e.paneState.visibilityState===r.a.Visible},a=function(e){return e.paneState.visibilityState!==r.a.Closed},i=function(e){return e.paneState.visibilityState},c=function(e){return e.paneState.componentTree},s=function(e){return e.paneState.viewContainer}},function(e,t,n){"use strict";n.d(t,"g",(function(){return x})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return u})),n.d(t,"h",(function(){return m})),n.d(t,"f",(function(){return A}));var r,o=n(307),a=n(1004),i=n(1039);!function(e){e[e.Modify=1]="Modify",e[e.Remove=2]="Remove",e[e.Add=3]="Add",e[e.ReQuery=4]="ReQuery"}(r||(r={}));var c,s,d,u,l=n(1551),f="Default_7210d794-9f0f-4d0a-805c-964303b2676b";function m(e){return e===c.Enabled_Default||e===c.Enabled_ForcePrimary}!function(e){e[e.Invalid=0]="Invalid",e[e.Disabled=1]="Disabled",e[e.Enabled_Default=2]="Enabled_Default",e[e.Enabled_ForcePrimary=3]="Enabled_ForcePrimary"}(c||(c={})),function(e){e[e.Empty=0]="Empty",e[e.CommentThread=1]="CommentThread",e[e.TrackedChange=2]="TrackedChange"}(s||(s={})),function(e){e[e.Disabled=0]="Disabled",e[e.Primary=1]="Primary",e[e.Secondary=2]="Secondary"}(d||(d={})),function(e){e[e.Integrated=0]="Integrated",e[e.Isolated=1]="Isolated",e[e.TaskPane=2]="TaskPane",e[e.TaskPaneItem=3]="TaskPaneItem"}(u||(u={}));var p,h=function(){function e(){this.store=new Map}return e.prototype.getInstanceIdForExtensionKey=function(e){var t;return this.store.forEach((function(n,r){if(n.has(e)){if(t)throw new a.c("Double registration across instances for an extension key.",a.d.reserveTag(589103766));t=r}})),t},e.prototype.insertExtension=function(e,t){var n=t.instanceId;this.store.has(n)||this.store.set(n,new Map);var r=this.store.get(n);if(r.has(e.extensionKey))throw new a.c("Duplicate Registration in same instance.",a.d.reserveTag(589103767));this.store.forEach((function(t,r){if(r!==n&&t.has(e.extensionKey))throw new a.c("Duplicate Registration in different instance.",a.d.reserveTag(589103768))})),r.set(e.extensionKey,t)},e.prototype.updateExtension=function(e,t){var n=this.getInstanceIdForExtensionKey(e);if(n){var r=this.store.get(n);if(r){var a=r.get(e);if(a)return a=Object(o.a)(Object(o.a)({},a),t),r.set(e,a),a}}},e.prototype.removeExtension=function(e){var t=this.getInstanceIdForExtensionKey(e);if(t){var n=this.store.get(t);if(n){var r=n.get(e);return n.delete(e),r}}},e.prototype.getExtension=function(e){var t=this.getInstanceIdForExtensionKey(e);if(t){var n=this.store.get(t);if(n)return n.get(e)}},e.prototype.getExtensionsByInstance=function(e){return this.store.get(e)},e}(),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.c)(t,e),t.prototype.initialize=function(){},t}(function(){function e(){this.onExtensionUpdated=new i.EventImpl((function(){})),this.extensionStore=new h}return e.prototype.triggerExtensionUpdated=function(e,t){this.onExtensionUpdated.trigger({extension:e,updateType:t})},e.prototype.registerExtension=function(e,t,n){var o,a=Object(l.a)(),i=null!==(o=n.priority)&&void 0!==o?o:d.Primary,c={extensionKey:a},s=n.renderMode===u.Isolated?{componentKey:t,contentType:e,priority:i,isContentAvailable:n.isContentAvailable,renderMode:n.renderMode,instanceId:n.instanceId,componentDimensions:n.componentDimensions}:{componentKey:t,contentType:e,priority:i,renderMode:n.renderMode,instanceId:n.instanceId,componentDimensions:n.componentDimensions};this.extensionStore.insertExtension(c,s);var f={id:a,state:s};return this.triggerExtensionUpdated(f,r.Add),f},e.prototype.unregisterExtension=function(e){var t=this.extensionStore.removeExtension(e);t&&this.triggerExtensionUpdated({id:e,state:t},r.Remove)},e.prototype.updateExtension=function(e,t){var n=this,o=function(t,r){t&&n.triggerExtensionUpdated({id:e,state:t},r)};t?o(this.extensionStore.updateExtension(e,t),r.Modify):o(this.extensionStore.getExtension(e),r.ReQuery)},e.prototype.getExtensions=function(e,t){var n=this.extensionStore.getExtensionsByInstance(t);if(!n)return[];var r=[];return n.forEach((function(t,n){t.contentType===e&&r.push({state:t,id:n})})),r},e.prototype.getExtension=function(e){var t=this.extensionStore.getExtension(e);if(void 0!==t)return{id:e,state:t}},e}());function g(){if(void 0===p){var e=new v;e.initialize(),p=e}return p}var y=["SDX::ContentExtension::ContentExtensionHostModule",{initializeExtensionModule:["FireAndForgetMethod",[]],onExtensionUpdate:["FireAndForgetMethod",[["$union",["SDX::ContentExtension::ExtensionRemovedEventArgs","SDX::ContentExtension::ExtensionModifiedEventArgs","SDX::ContentExtension::ExtensionAddedEventArgs"]]]]}],b=(i.RekaServiceRegistry.getNativeService(y),function(){function e(){}e.prototype.initializeExtensionModule=function(){},e.prototype.onExtensionUpdate=function(e){},e.ServiceInfo=y}(),n(1005)),C=function(){function e(e,t){this.extensionKey=e,this.scope=t}return e.prototype.getExtension=function(){var e=g().getExtension(this.extensionKey);if(!e||e.state.renderMode!==u.Integrated)throw Object(b.k)().assertConditionTag(!!e,"No extension data in provider. Querying a removed extension.",592316051),Object(b.k)().assertConditionTag((null==e?void 0:e.state.renderMode)===u.Integrated,"Extension data is not for the Integrated Render Mode.",592316052),new Error("Unable to query extension data within provider.");return{contentType:e.state.contentType,renderMode:e.state.renderMode,instanceId:e.state.instanceId,componentKey:e.state.componentKey,priority:e.state.priority,componentDimensions:e.state.componentDimensions,type:"Integrated"}},e}();function T(e,t){var n=e.isContentAvailable(t),r=function(e,t){switch(e){case d.Primary:case d.Secondary:switch(t){case c.Invalid:case c.Disabled:return d.Disabled;case c.Enabled_Default:return e;case c.Enabled_ForcePrimary:return d.Primary}case d.Disabled:return e}}(e.priority,n),o=n!==c.Invalid;return{contentType:e.contentType,renderMode:e.renderMode,instanceId:e.instanceId,componentKey:e.componentKey,componentDimensions:e.componentDimensions,priority:r,contentId:t,isContentIdValid:o,type:"Isolated"}}var I,S=function(){function e(e,t){var n=this;this.extensionKey=e,this.scope=t,this.cachedExtensions={},this.onExtensionUpdate=function(e){e.updateType!==r.Remove?e.extension.id===n.extensionKey&&n.updateCachedExtensions():n.teardown()},this.teardown=function(){n.cachedExtensions={},n.subscription.unsubscribe()},this.subscription=g().onExtensionUpdated.subscribe(this.onExtensionUpdate)}return e.prototype.getExtension=function(e){var t=this,n=this.cachedExtensions[e];if(n)return n.extension;var r=g().getExtension(this.extensionKey);if(!r||r.state.renderMode!==u.Isolated)throw Object(b.k)().assertConditionTag(!!r,"No extension data in provider. Querying a removed extension.",592316053),Object(b.k)().assertConditionTag((null==r?void 0:r.state.renderMode)===u.Isolated,"Extension data is not for the Isolated Render Mode.",592316054),new Error("Unable to query extension data within provider.");var a=T(r.state,e),c=Object(o.a)(Object(o.a)({},a),{onUpdated:new i.EventImpl((function(n){var r=t.cachedExtensions[e];r&&(n?r.hasListener=!0:delete t.cachedExtensions[e])}))});return this.cachedExtensions[e]={extension:c,hasListener:!1},c},e.prototype.updateCachedExtensions=function(){var e=this,t=g().getExtension(this.extensionKey);if(!t||t.state.renderMode!==u.Isolated)return Object(b.k)().assertConditionTag(!!t,"No extension data in provider. Querying a removed extension.",592314635),void Object(b.k)().assertConditionTag((null==t?void 0:t.state.renderMode)===u.Isolated,"Extension data is not for the Isolated Render Mode.",592314636);var n=t.state;Object.keys(this.cachedExtensions).forEach((function(t){var r=e.cachedExtensions[t],o=null==r?void 0:r.extension;if(o&&r){var a=T(n,t);(o.priority!==a.priority||o.isContentIdValid!==a.isContentIdValid)&&(o.priority=a.priority,o.isContentIdValid=a.isContentIdValid,o.onUpdated.trigger({})),r.hasListener||a.isContentIdValid||delete e.cachedExtensions[t]}else Object(b.k)().assertConditionTag(!1,"Trying to access extension before it has been cached.",591152983)}))},e}(),O=function(){function e(e,t){this.extensionKey=e,this.scope=t}return e.prototype.getExtension=function(){var e=g().getExtension(this.extensionKey);if(!e||e.state.renderMode!==u.TaskPane)throw Object(b.k)().assertConditionTag(!!e,"No extension data in provider. Querying a removed extension.",573384475),Object(b.k)().assertConditionTag(!e||e.state.renderMode===u.TaskPane,"Extension data is not for the TaskPane Render Mode.",573384476),new a.c("Unable to query extension data within provider.",a.d.reserveTag(573384477));return Object(o.a)(Object(o.a)({},e.state),{type:"TaskPane"})},e}(),w=function(){function e(e,t){this.extensionKey=e,this.scope=t}return e.prototype.getExtension=function(){var e=g().getExtension(this.extensionKey);if(!e||e.state.renderMode!==u.TaskPaneItem)throw Object(b.k)().assertConditionTag(!!e,"No extension data in provider. Querying a removed extension.",546174347),Object(b.k)().assertConditionTag(!e||e.state.renderMode===u.TaskPaneItem,"Extension data is not for the TaskPaneItem Render Mode.",546174348),new a.c("Unable to query extension data within provider.",a.d.reserveTag(546174349));return Object(o.a)(Object(o.a)({},e.state),{type:"TaskPaneItem"})},e}(),j=function(){function e(e){this._detached=!1,this._id=e.id;var t={contentType:e.state.contentType,renderMode:e.state.renderMode,instanceId:e.state.instanceId};switch(e.state.renderMode){case u.TaskPane:this._extensionProvider=new O(this._id,t);break;case u.TaskPaneItem:this._extensionProvider=new w(this._id,t);break;case u.Isolated:this._extensionProvider=new S(this._id,t);break;case u.Integrated:this._extensionProvider=new C(this._id,t)}}return e.prototype.triggerUpdate=function(){g().updateExtension(this._id,void 0)},e.prototype.unregisterExtension=function(){this._detached=!0,g().unregisterExtension(this._id)},e.prototype.updateState=function(e){var t=g().getExtension(this._id);if(void 0===t)throw Object(b.k)().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",591005410),new Error("ExtensionController with id ".concat(this._id," does not correspond to a cached ExtensionState"));1===Object.keys(e).length&&void 0!==e.priority&&t.state.priority===e.priority?this.triggerUpdate():g().updateExtension(this._id,e)},Object.defineProperty(e.prototype,"priority",{get:function(){var e=g().getExtension(this._id);if(void 0===e)throw Object(b.k)().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",595620259),new a.c("ExtensionController with id ".concat(this._id," does not correspond to a cached ExtensionState"),a.d.reserveTag(589103770));return e.state.priority},set:function(e){this._detached||this.updateState({priority:e})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"componentDimensions",{get:function(){var e=g().getExtension(this._id);if(void 0===e)throw Object(b.k)().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",591005411),new Error("ExtensionController with id ".concat(this._id," does not correspond to a cached ExtensionState"));return e.state.componentDimensions},set:function(e){this._detached||this.updateState({componentDimensions:e})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"detached",{get:function(){return this._detached},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"provider",{get:function(){return this._extensionProvider},enumerable:!1,configurable:!0}),e}(),E=function(){function e(e,t){var n=this;this.contentTypes=e,this.host=t,this.onUpdated=new i.EventImpl((function(){})),g().onExtensionUpdated.subscribe((function(t){e.find((function(e){return e===t.extension.state.contentType}))&&t.updateType!==r.ReQuery&&n.onUpdated.trigger({})}))}return Object.defineProperty(e.prototype,"providers",{get:function(){var e=[],t=function(t){var r=n.host.extensions[t];r.priority!==d.Disabled&&n.contentTypes.find((function(e){return e===r.provider.scope.contentType}))&&e.push(r.provider)},n=this;for(var r in this.host.extensions)t(r);return e},enumerable:!1,configurable:!0}),e}(),k=function(e){function t(t,n){var r=e.call(this,t)||this;return r.onAfterSubscribe=n,r}return Object(o.c)(t,e),t.prototype.subscribe=function(t){var n=e.prototype.subscribe.call(this,t);return this.onAfterSubscribe(t,n),n},t}(i.EventImpl),P=function(){function e(){var e=this;this.contentTypeRegistrationInfo=new Map,this.extensions={},this.onAfterSubscribe=function(t,n){e.contentTypeRegistrationInfo.forEach((function(e,r){r!==s.Empty&&Object.keys(e).forEach((function(o){e[o]&&t({instanceId:o,contentType:r},n)}))}))},this.onExtensionFirstRequested=new k((function(){}),this.onAfterSubscribe),g().onExtensionUpdated.subscribe((function(t){switch(t.updateType){case r.ReQuery:break;case r.Remove:delete e.extensions[t.extension.id];break;case r.Add:case r.Modify:e.ensureExtensionCached(t.extension.id,t.extension.state);break;default:Object(a.m)(t.updateType)}}))}return e.prototype.registerExtension=function(e,t,n){var r=g().registerExtension(e,t,n);return this.ensureExtensionCached(r.id,r.state),Promise.resolve(this.extensions[r.id])},e.prototype.getExtensions=function(e,t){var n=this,r=new E(e,this);return e.forEach((function(e){var r;g().getExtensions(e,t).forEach((function(e){n.ensureExtensionCached(e.id,e.state)}));var o=n.contentTypeRegistrationInfo.get(e);if(void 0!==o){if(o[t])return;o[t]=!0}else n.contentTypeRegistrationInfo.set(e,((r={})[t]=!0,r));n.onExtensionFirstRequested.trigger({contentType:e,instanceId:t})})),r},e.prototype.ensureExtensionCached=function(e,t){void 0===this.extensions[e]&&(this.extensions[e]=new j({id:e,state:t}))},e}();function x(){return void 0===I&&(I=new P),I}function A(){!function(){I=void 0}(),function(){p=void 0}()}},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return c.a})),n.d(t,"b",(function(){return c.c})),n.d(t,"c",(function(){return c.d})),n.d(t,"d",(function(){return s.a})),n.d(t,"f",(function(){return s.b}));var r,o=n(1),a=o.createContext(void 0);function i(e){return!!e&&e.getFocusState&&e.getId&&e.getData&&e.getNextTabTarget&&e.isTabbable&&e.getChildNodes&&e.addChildNode&&e.getDescendantById&&function(e){return!!e&&void 0!==e.focus&&void 0!==e.blur}(e)}!function(e){e[e.Forward=0]="Forward",e[e.Reverse=1]="Reverse"}(r||(r={}));var c=n(1088),s=n(1121),d=n(307);c.c.Tab,c.a.AtTarget,c.c.Tab,c.a.AtTarget;var u=n(1119);function l(e){return e.isFocusOn?u.a.FocusOn:e.isFocusWithin?u.a.FocusWithin:u.a.Unfocused}n(1206),function(){function e(e,t,n,r,a){this.nodeId=e,this.nodeData=t,this.tabbable=n,this.onFocusStateChange=r,this.focusState=a,this.registrationRef=o.createRef(),this.innerComponentRef=o.createRef()}e.prototype.onEffect=function(e,t,n,r){this.nodeData=e,this.tabbable=t,this.onFocusStateChange=n;var o=this.focusState;this.focusState=r,l(o)!==l(this.focusState)&&(this.onFocusStateChange&&this.onFocusStateChange(this.getFocusState()),this.registrationRef.current&&this.registrationRef.current.onFocusStateChange(this.getFocusState()))},e.prototype.getIterator=function(){return Object(d.d)(this,(function(e){switch(e.label){case 0:return[4,this];case 1:return e.sent(),[2]}}))},e.prototype.getId=function(){return this.nodeId||""},e.prototype.getData=function(){return this.nodeData?this.nodeData():this},e.prototype.getFocusState=function(){return l(this.focusState)},e.prototype.getNextTabTarget=function(){return this.getFocusState()===u.a.Unfocused&&this.isTabbable()?this:void 0},e.prototype.isTabbable=function(){return!!this.tabbable},e.prototype.getChildNodes=function(){return[]},e.prototype.addChildNode=function(){throw new Error("Method not implemented.")},e.prototype.getDescendantById=function(){},e.prototype.focus=function(){var e;null===(e=this.innerComponentRef.current)||void 0===e||e.focus()},e.prototype.blur=function(){var e;null===(e=this.innerComponentRef.current)||void 0===e||e.blur()}}();var f=function(){return function(){var e=this;this.root=null,this.getRoot=function(){return e.root},this.setRoot=function(t){e.root=t}}}();!function(){function e(e){var t=this;this.viewTreeMap=new Map,e&&e.viewTreeMap.forEach((function(e,n){return t.viewTreeMap.set(n,e)}))}e.prototype.updateIdForViewTree=function(e,t){var n=this.viewTreeMap.get(e);return!!n&&(this.viewTreeMap.set(t,n),this.viewTreeMap.delete(e),!0)},e.prototype.getOrCreateViewTreeById=function(e){var t=this.viewTreeMap.get(e);return t||(t=new f,this.viewTreeMap.set(e,t)),t},e.prototype.getViewTrees=function(){return this.viewTreeMap.values()},e.prototype.getDescendantById=function(e){var t,n,r;try{for(var o=Object(d.i)(this.viewTreeMap.values()),a=o.next();!a.done;a=o.next()){var i=null===(r=a.value.getRoot())||void 0===r?void 0:r.getDescendantById(e);if(i)return i}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}}}();!function(){function e(){var e=this;this.ref=o.createRef(),this.focus=function(){e.ref&&e.ref.current&&e.ref.current.focus()},this.blur=function(){e.ref&&e.ref.current&&e.ref.current.blur()},this.getFocusState=function(){return e.ref&&e.ref.current?e.ref.current.getFocusState():c.b.Unfocused},this.getNextTabTarget=function(t,n){if(e.ref&&e.ref.current)return e.ref.current.getNextTabTarget(t,n)},this.isTabbable=function(){return!(!e.ref||!e.ref.current)&&e.ref.current.isTabbable()},this.getChildNodes=function(){return e.ref&&e.ref.current?e.ref.current.getChildNodes():[]},this.addChildNode=function(t,n){if(e.ref&&e.ref.current)return e.ref.current.addChildNode(t,n)},this.getId=function(){return e.ref&&e.ref.current?e.ref.current.getId():""},this.getData=function(){if(e.ref&&e.ref.current)return e.ref.current.getData()},this.getDescendantById=function(t){if(e.ref&&e.ref.current)return e.ref.current.getDescendantById(t)},this.getIterator=function(){return e.ref&&e.ref.current?e.ref.current.getIterator():{next:function(){return{done:!0,value:e}}}}}Object.defineProperty(e.prototype,"disabled",{get:function(){return!(!this.ref.current||!this.ref.current.disabled)},enumerable:!1,configurable:!0})}();var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.registrationToken=void 0,t.onFocusStateChange=function(e){t.registrationToken&&t.registrationToken.onFocusStateChange(e)},t}return Object(d.c)(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.parentNode&&(this.registrationToken=this.props.parentNode.addChildNode(this.props.node,(function(){return e.props.position})))},t.prototype.componentWillUnmount=function(){this.registrationToken&&(this.registrationToken.unregister(),this.registrationToken=void 0)},t.prototype.render=function(){return o.Children.only(this.props.children)},t}(o.PureComponent);!function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.registrationHelperRef=o.createRef(),t.onFocusStateChange=function(e){t.registrationHelperRef.current&&t.registrationHelperRef.current.onFocusStateChange(e)},t}Object(d.c)(t,e),t.prototype.render=function(){var e=this;return o.createElement(a.Consumer,null,(function(t){return o.createElement(m,{parentNode:t,node:e.props.node,ref:e.registrationHelperRef,position:e.props.position},e.props.children)}))}}(o.PureComponent)},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Closed=1]="Closed",e[e.Hidden=2]="Hidden",e[e.Visible=3]="Visible"}(r||(r={}))},function(e,t,n){"use strict";function r(e){return""===e.parentId?e:void 0}function o(e){return e.parentId||e.commentId}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},function(e,t,n){"use strict";var r;function o(e){return e.selectionDetails.lowFidelityWarningType===r.Edit}function a(e){return e.selectionDetails.lowFidelityWarningType===r.DeleteReply}function i(e){return e.selectionDetails.lowFidelityWarningType===r.DeleteThread}function c(e){return a(e)||i(e)}function s(e){return!!e&&(o(e)||a(e))}function d(e){return!!e&&(c(e)||o(e))}function u(e){return void 0!==e.selectedPostId}function l(e){return u(e.selectionDetails)?e.selectionDetails.selectedPostId:e.selectedCardId}function f(e,t){return!!t&&u(t.selectionDetails)&&t.selectionDetails.selectedPostId===e.commentId&&d(t)}n.d(t,"a",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"j",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"i",(function(){return f})),function(e){e[e.Edit=1]="Edit",e[e.DeleteReply=2]="DeleteReply",e[e.DeleteThread=3]="DeleteThread"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(1012);function o(e){return e===r.a.FullPane||e===r.a.HalfPane}function a(e){return e===r.a.DiscreteIntegrated||e===r.a.DiscreteIsolated}},function(e,t,n){"use strict";n.d(t,"v",(function(){return v})),n.d(t,"j",(function(){return g})),n.d(t,"h",(function(){return y})),n.d(t,"g",(function(){return b})),n.d(t,"p",(function(){return C})),n.d(t,"k",(function(){return T})),n.d(t,"a",(function(){return S})),n.d(t,"f",(function(){return O})),n.d(t,"c",(function(){return w})),n.d(t,"m",(function(){return j})),n.d(t,"q",(function(){return E})),n.d(t,"r",(function(){return k})),n.d(t,"u",(function(){return P})),n.d(t,"t",(function(){return x})),n.d(t,"d",(function(){return A})),n.d(t,"l",(function(){return D})),n.d(t,"b",(function(){return R})),n.d(t,"o",(function(){return F})),n.d(t,"s",(function(){return N})),n.d(t,"n",(function(){return M})),n.d(t,"e",(function(){return L})),n.d(t,"i",(function(){return B}));var r=n(1060),o=n(1004),a=n(1552),i=n(1005),c=n(1049),s=n(1022),d=n(1016),u=n(1036),l=n(1006),f=n(1080),m=n(1032),p=n(1081),h=n(1052);n(1099),n(1012);function v(e,t,n){var r=n&&l.n()?t-1:t-2;if(r<1)throw new d.a(u.f,o.d.reserveTag(589103692),-2130957559);var a=l.n();return 1===r?a?e.getString(106):e.getString(9):a?e.formatString(107,String(r)):e.formatString(10,String(r))}function g(e,t){switch(t){case c.a.AtFinishNextCommentIsFirst:return e.getString(8);case c.a.AtStartNextCommentIsFirst:return e.getString(6);case c.a.MoreCommentsUpcoming:case c.a.DocumentHasComments:return e.getString(7);case c.a.OnlyCommentsInCurrent:case c.a.NoComments:case c.a.Unknown:return"";default:Object(o.m)(t)}}function y(e,t,n,r){return n?t?e.getString(16):e.getString(17):l.F()&&void 0!==r&&r!==h.a.InCard?e.getString(108):t?e.getString(11):e.getString(12)}function b(e,t){switch(t){case f.a.ReturnToDraft:return e.getString(110);case f.a.GrantAccessFailedSilently:return e.getString(134);case f.a.GrantAccessCanceled:return e.getString(234);case f.a.CommitFailed:return e.getString(135);case f.a.None:return Object(i.k)().assertConditionTag(!1,"Invalid DraftWarningType: ".concat(t),595686755),""}}function C(e,t){return void 0===t&&(t=!0),t?e.getStringWithStandardPlaceholders(112):e.getStringWithStandardPlaceholders(113)}function T(e,t){return t?Object(m.f)(t)?e.getString(35):Object(m.c)(t)?e.getString(36):"":""}var I=Object(a.a)((function(){try{(new Date).toLocaleDateString("i")}catch(e){return e instanceof Error&&"RangeError"===e.name}return!1}));function S(e,t){var n=!!t&&I();try{if(n){var r={hour:"numeric",minute:"2-digit",day:"numeric",month:"long",year:"numeric",timeZone:void 0};return e.toLocaleDateString(t,r)}return Object(i.k)().assertConditionTag(!1,"The locale and/or options arguments are not supported, doesToLocaleDateStringSupportsLocales: ".concat(I(),", locale Exists: ").concat(!!t),595882385),e.toLocaleDateString()}catch(n){return Object(i.k)().assertConditionTag(!1,"LocaleDateString conversion failed: ".concat(n instanceof Error?n.name:"",", locale Exists: ").concat(!!t,", doesToLocaleDateStringSupportsLocales: ").concat(I(),", Date: ").concat(e.toString()),595953050),""}}function O(e){return{body:e.getString(69),title:e.getString(68),confirmButton:e.getString(70),cancelButton:e.getString(71)}}function w(e,t){switch(e){case p.a.Draft:case p.a.DraftPreCommitPending:return t.getString(16);default:return t.getString(89)}}function j(e){return e.getString(122)}function E(e,t){return 0===e.length?P(t):1===e.length?function(e,t){return e.IsCurrentUser?t.getString(127):t.formatString(111,Object(s.k)(e))}(e[0],t):Object(s.c)(e)?t.getString(250):t.getString(251)}function k(e,t,n){if(0===e.length)return x(t,n);var r=e.map((function(e){return Object(s.k)(e)})).join(", ");return t?n.formatString(130,r):n.formatString(129,r)}function P(e){return e.formatString(111,e.getString(133))}function x(e,t){return e?t.formatString(130,t.getString(133)):t.formatString(129,t.getString(133))}function A(e,t,n,r){var o,a=t===p.a.Draft||t===p.a.DraftPreCommitPending;return null!==(o=R(e,n,r))&&void 0!==o?o:a?e.getString(173):e.getString(174)}function D(e,t,n){var r="";switch(n.length){case 0:r=e.getString(133);break;case 1:r=n[0];break;case 2:r=e.formatString(242,n[0],n[1]);break;case 3:r=e.formatString(243,n[0],n[1],n[2]);break;default:r=e.formatString(244,n[0],(n.length-1).toString())}var o=t?114:252;return e.formatString(o,r)}function R(e,t,n){var r=Object(s.g)(n);if(r)return e.formatString(t?179:178,r)}function F(e,t){return e?t.getString(176):t.getString(126)}function N(e,t){return 0===e.length?t.getString(181):t.formatString(114,e.map((function(e){return Object(s.k)(e)})).join(", "))}function M(e,t){switch(t){case r.a.ActiveOnly:return e.getString(247);case r.a.ResolvedOnly:return e.getString(246);case r.a.All:return e.getString(245);default:Object(o.m)(t)}}function L(e,t){switch(t){case r.c.HostDefaultOrder:return"";case r.c.NewestFirst:return e.getString(248);default:Object(o.m)(t)}}function B(e,t){switch(t){case void 0:return;case 1:return e.getString(256);default:return e.formatString(257,t.toString())}}},function(e,t,n){"use strict";n.d(t,"l",(function(){return C})),n.d(t,"m",(function(){return T})),n.d(t,"k",(function(){return I})),n.d(t,"b",(function(){return S})),n.d(t,"h",(function(){return O})),n.d(t,"g",(function(){return w})),n.d(t,"a",(function(){return j})),n.d(t,"e",(function(){return E})),n.d(t,"i",(function(){return k})),n.d(t,"d",(function(){return P})),n.d(t,"f",(function(){return x})),n.d(t,"j",(function(){return A})),n.d(t,"c",(function(){return D}));var r=n(307),o=n(1004),a=n(1005),i=n(1046),c=n(1031),s=n(1153),d=n(1022),u=n(1016),l=n(1036),f=n(1006),m=n(1014),p=n(1067),h=n(1025),v=n(1068),g=n(1034);function y(e,t,n){for(var r=t;r<e.length;++r)if(e[r].commentId===n.commentId)return r;return-1}function b(e,t,n,r,o,i){for(var c=[],s=t,d=o;s<=n&&d<=i;){var u=e[s].date;Object(a.k)().assertConditionTag(!!u,"commentDate should not be undefined",595719177),!u||u<=r.history[d].records[0].time?(Object(a.k)().assertConditionTag(e[s].parentId===r.commentId,"comments must belong to the same thread",595719173),c.push({commentModel:e[s]}),++s):(Object(a.k)().assertConditionTag(!r.history[d].commentId,"Unanchored history item should not have commentId",595719178),c.push({historyItem:r.history[d],parentThreadId:r.commentId}),++d)}for(;s<=n;++s)c.push({commentModel:e[s]});for(;d<=i;++d)Object(a.k)().assertConditionTag(!r.history[d].commentId,"Unanchored history item should not have commentId",595719179),c.push({historyItem:r.history[d],parentThreadId:r.commentId});return c}function C(e,t){if(!f.c()||!t||0===t.history.length)return e.map((function(e){return{commentModel:e}}));var n=!0;if(f.d()||t.commentId===t.history[0].commentId||(Object(a.k)().assertConditionTag(!1,"taskItem.commentId must match the first history item",595719174),n=!1),e[0].commentId!==t.commentId&&(Object(a.k)().assertConditionTag(!1,"TaskItem must be paired with the root comment",595719303),n=!1),!n)return e.map((function(e){return{commentModel:e}}));var o=[];f.d()||o.push({commentModel:e[0],historyItem:t.history[0]});for(var i=f.d()?0:1,c=f.d()?0:1,s=f.d()?0:1;i<e.length&&s<t.history.length;){var d=y(e,i,t.history[s]);d>=0&&(o.push.apply(o,Object(r.h)([],Object(r.f)(b(e,i,d-1,t,c,s-1)),!1)),Object(a.k)().assertConditionTag(0===d||e[d].parentId===t.commentId,"comments must belong to the same thread",595719175),o.push({commentModel:e[d],historyItem:t.history[s]}),i=d+1,c=s+1),++s}return o.push.apply(o,Object(r.h)([],Object(r.f)(b(e,i,e.length-1,t,c,t.history.length-1)),!1)),o}function T(e,t,n,o){var i=[];if(Object(h.c)(n))Object(h.f)(e)?e.forEach((function(e){i.push.apply(i,Object(r.h)([],Object(r.f)(C(Object(m.z)(n,t,e),o[e])),!1))})):Object(a.k)().assertConditionTag(!1,"Map-Based Data w/o Map-Based Thread Data is unsupported",537515151);else for(var s=0,d=1;d<=n.length;d++)(d===n.length||Object(c.a)(n[d]))&&(i.push.apply(i,Object(r.h)([],Object(r.f)(C(n.slice(s,d),o[n[s].commentId])),!1)),s=d);return i}function I(e,t,n,o,a,i){var s=[];if(0===e.length)return s;if(Object(h.c)(n))e.forEach((function(e){s.push.apply(s,Object(r.h)([],Object(r.f)(C(Object(m.z)(n,t,e.contentId),o[e.contentId])),!1))}));else for(var d=0,u=0,l=function(e,t,n,r){return e<t.length&&!!Object(c.a)(t[e])&&-1===n&&t[e].commentId===r};d<e.length&&!((null==a?void 0:a.newComment_deprecated)&&e[d].contentId===Object(m.G)(i,!0)&&(s.push({commentModel:a.newComment_deprecated}),++d>=e.length));){for(var f=-1,p=0;p<=n.length;p++)if(l(p,n,f,e[d].contentId))f=p;else if(-1!==f&&(p===n.length||Object(c.a)(n[p]))){if(s.push.apply(s,Object(r.h)([],Object(r.f)(C(n.slice(f,p),o[n[f].commentId])),!1)),++d>=e.length)break;l(p,n,f=-1,e[d].contentId)&&(f=p)}u===d&&d++,u=d}return s}function S(e,t){var n=e.find((function(e){return Object(v.a)(e)&&e.commentModel.commentId===t}));if(Object(v.a)(n))return n.commentModel}function O(e){var t=e[0];if(Object(v.a)(t))return t.commentModel;throw new u.a(l.a,o.d.reserveTag(589103627),2130957505)}function w(e){return Object(v.a)(e)?e.commentModel.parentId:e.parentThreadId}function j(e,t){return f.V()?"".concat(e,"__").concat(t):t}function E(e){return Object(v.a)(e)?e.commentModel.commentId:j(e.historyItem.taskId,e.historyItem.records[0].recordId)}function k(e){return Object(v.a)(e)?Object(c.b)(e.commentModel):e.parentThreadId}function P(e,t){var n=[],r=e.records[0];switch(r.type){case s.a.Create:case s.a.UnassignAll:for(var o=[],i=1;i<e.records.length;i++){(u=e.records[i]).type===s.a.Assign&&o.push(Object(d.k)(u.assignee))}n.push({icon:13,description:Object(g.l)(t,!0,o)});break;case s.a.Assign:case s.a.Unassign:o=[];var c=[];for(i=0;i<e.records.length;i++){var u;if((u=e.records[i]).type!==s.a.Assign&&u.type!==s.a.Unassign)return Object(a.k)().assertConditionTag(!1,"Unexpected HistoryRecordType.",528064847),[{icon:0,description:t.getString(119)}];u.type===s.a.Assign?o.push(Object(d.k)(u.assignee)):c.push(Object(d.k)(u.assignee))}o.length>0&&n.push({icon:13,description:Object(g.l)(t,!0,o)}),c.length>0&&n.push({icon:13,description:Object(g.l)(t,!1,c)});break;case s.a.Progress:return 100===r.completion?[{icon:15,description:t.getString(116)}]:[{icon:21,description:t.getString(117)}];case s.a.Schedule:return[{icon:17,description:t.getString(118)}];default:return Object(a.k)().assertConditionTag(!1,"Unexpected HistoryRecordType",527759317),[{icon:0,description:t.getString(119)}]}return 0===n.length&&n.push({icon:0,description:t.getString(119)}),n}function x(e,t){return e.findIndex((function(e){return e.length>0&&k(e[0])===t}))}function A(e,t){return e.some((function(e){return Object(v.a)(e)&&!!(e.commentModel.commentFlags&i.f.LowFidelity)&&(void 0===t||t===Object(c.b)(e.commentModel))}))}function D(e,t,n,r,o){for(var i=[],c=!f.W()&&!o&&void 0!==n,s=-1,d=-1,u=0;u<e.length;u+=1){var l=e[u],m=Object(v.a)(l)?l:void 0;if(m&&void 0!==t[m.commentModel.commentId])if(t[m.commentModel.commentId].pending===p.a.Delete&&r)for(Object(v.a)(l)&&++d;!(u+1>=e.length||""===w(e[u+1]));)++u,Object(v.a)(e[u])&&++d;else{++d,i.push([m]),c&&d===(null==n?void 0:n.flatIndex)&&(s=i.length-1);for(var h=u+1;h<e.length;h+=1){if(l=e[h],Object(v.a)(l)){var g=w(l);if(g!==m.commentModel.commentId){Object(a.k)().assertConditionTag(!g,"Orphaned reply",593085889);break}i[i.length-1].push(l),++d}else i[i.length-1].push(l);++u}}else for(Object(a.k)().assertConditionTag(!1,"CommentData corruption detected with orphaned reply. Skipping to allow render. commentDataLength: ".concat(e.length," | cardViewStateLength: ").concat(Object.keys(t).length," | insertingThreadLie: ").concat(c),593085888),Object(v.a)(l)&&++d;!(u+1>=e.length||""===w(e[u+1]));)++u,Object(v.a)(e[u])&&++d}return c&&n&&(-1!==s?i.splice(s,0,[{commentModel:n.newComment_deprecated}]):(Object(a.k)().assertConditionTag(n.flatIndex>d,"Failed to find insertion point for lie in getAllRenderableItemThreads",529094429),n.flatIndex===d+1&&i.push([{commentModel:n.newComment_deprecated}]))),i}},function(e,t,n){"use strict";n.d(t,"i",(function(){return r})),n.d(t,"k",(function(){return o})),n.d(t,"f",(function(){return a})),n.d(t,"m",(function(){return i})),n.d(t,"h",(function(){return c})),n.d(t,"j",(function(){return s})),n.d(t,"g",(function(){return d})),n.d(t,"l",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return h}));var r="Selected comment not found",o="Selected thread index out of bounds",a="Invalid number of posts for display more replies string",i="Unrecognized post display mode",c="Method not implemented",s="StringId is invalid",d="LocalizationModule NativeModule not valid",u="Store state unexpected",l="Editor reference is invalid",f="Invalid arguments",m="Comment ID value is invalid in the current operation",p="Attempting to perform an operation on an inactive draft",h="CommentModel not found in a thread of RenderableItems"},function(e,t,n){"use strict";function r(){return"web"}n.d(t,"a",(function(){return r}))},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataServiceRegistry=t.DataServiceManager=t.EventImpl=t.registerClasses=t.RekaServiceRegistry=t.RekaInstance=t.CustomTypeRegistry=void 0;var r=n(1222);Object.defineProperty(t,"CustomTypeRegistry",{enumerable:!0,get:function(){return r.CustomTypeRegistry}});var o=n(1223);Object.defineProperty(t,"RekaInstance",{enumerable:!0,get:function(){return o.RekaInstance}}),Object.defineProperty(t,"RekaServiceRegistry",{enumerable:!0,get:function(){return o.RekaServiceRegistry}}),Object.defineProperty(t,"registerClasses",{enumerable:!0,get:function(){return o.registerClasses}});var a=n(1224);Object.defineProperty(t,"EventImpl",{enumerable:!0,get:function(){return a.EventImpl}});var i=n(1223);Object.defineProperty(t,"DataServiceManager",{enumerable:!0,get:function(){return i.RekaInstance}}),Object.defineProperty(t,"DataServiceRegistry",{enumerable:!0,get:function(){return i.RekaServiceRegistry}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return l}));var r=function(e){return e.filterState.activeFilterId},o=function(e){return e.filterState.defaultFilterId},a=function(e){var t,n=e.filterState.activeFilterId;if(n)return null===(t=e.filterState.filteredRanges[n])||void 0===t?void 0:t.filter},i=function(e,t){return e.filterState.filteredRanges[t]},c=[],s=function(e){var t,n,r=e.filterState.activeFilterId;return r&&null!==(n=null===(t=e.filterState.filteredRanges[r])||void 0===t?void 0:t.order)&&void 0!==n?n:c},d=function(e){return s(e).length},u=function(e){return e.filterState.filteringCapabilities},l=function(e){return e.filterState.requestDefaultFilter}},function(e,t,n){"use strict";n.d(t,"j",(function(){return r.a})),n.d(t,"k",(function(){return r.c})),n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return o.b})),n.d(t,"d",(function(){return o.d})),n.d(t,"e",(function(){return o.f})),n.d(t,"c",(function(){return o.c})),n.d(t,"h",(function(){return o.k})),n.d(t,"f",(function(){return o.g})),n.d(t,"g",(function(){return o.h})),n.d(t,"i",(function(){return o.l}));var r=n(1200),o=n(1046)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return i}));var r="CREATE",o="EDIT",a="REPLY",i="METADATA"},function(e,t,n){"use strict";function r(e){return void 0!==e.numberOfComments&&void 0!==e.numberOfThreads}function o(e){return void 0!==e.comments||void 0!==e.threads}function a(e){return void 0!==e.threads&&void 0===e.comments}var i;function c(e){return void 0!==e.comments||void 0!==e.commentIds}function s(e){return void 0!==e.commentIds}function d(e){return void 0!==e.changes}function u(e){return void 0!==e.commentId}function l(e){return void 0!==e.commentId}function f(e){return void 0!==e.contextDetails}function m(e){return void 0!==e.modelCapabilityFlags}function p(e){return void 0!==e.errorType}function h(e){return void 0!==e.draftId}function v(e){return void 0!==e.draftId}function g(e){return void 0!==e.commentId&&void 0!==e.smartReplies}n.d(t,"b",(function(){return r})),n.d(t,"i",(function(){return o})),n.d(t,"o",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"j",(function(){return m})),n.d(t,"e",(function(){return p})),n.d(t,"l",(function(){return h})),n.d(t,"n",(function(){return v})),n.d(t,"m",(function(){return g})),function(e){e[e.Thread=0]="Thread",e[e.Reply=1]="Reply"}(i||(i={}))},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return a.a})),n.d(t,"d",(function(){return i.a})),n.d(t,"e",(function(){return c.a})),n.d(t,"f",(function(){return s.a})),n.d(t,"c",(function(){return d.a})),n.d(t,"k",(function(){return d.d})),n.d(t,"i",(function(){return d.c})),n.d(t,"g",(function(){return u.a})),n.d(t,"h",(function(){return l.a})),n.d(t,"j",(function(){return f.a})),n.d(t,"l",(function(){return m.a}));var r,o=n(1117),a=n(1152),i=n(1077);!function(e){e[e.FailedToCommit=1]="FailedToCommit"}(r||(r={}));var c=n(1064),s=n(1047),d=n(1042),u=n(1096),l=n(1048),f=n(1049),m=n(1097)},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.ReadOnly=1]="ReadOnly",e[e.LowFidelity=2]="LowFidelity",e[e.Locked=4]="Locked",e[e.Resolved=8]="Resolved",e[e.EditRestricted=16]="EditRestricted",e[e.IsNew=32]="IsNew",e[e.DeleteRestricted=64]="DeleteRestricted",e[e.ReactionRestricted=128]="ReactionRestricted"}(r||(r={}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unhandled=0]="Unhandled",e[e.Handled=1]="Handled",e[e.Canceled=2]="Canceled",e[e.Failed=3]="Failed"}(r||(r={}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.NoComments=1]="NoComments",e[e.AtStartNextCommentIsFirst=2]="AtStartNextCommentIsFirst",e[e.MoreCommentsUpcoming=3]="MoreCommentsUpcoming",e[e.AtFinishNextCommentIsFirst=4]="AtFinishNextCommentIsFirst",e[e.OnlyCommentsInCurrent=5]="OnlyCommentsInCurrent",e[e.DocumentHasComments=6]="DocumentHasComments"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i}));var r,o=n(1009);function a(e){switch(e){case r.SelectCard:case r.Polite:return!1;case r.ExpandCard:case r.SelectPost:return!0}}function i(e,t,n,r,a){return Object(o.b)("SELECT_COMMENT",{selectedCard:t,selectedPost:n,selectType:r,source:a},e)}!function(e){e[e.ExpandCard=0]="ExpandCard",e[e.SelectCard=1]="SelectCard",e[e.SelectPost=2]="SelectPost",e[e.Polite=3]="Polite"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d}));var r=n(1060),o=n(1005),a=n(1040);function i(e){if(function(e){var t=a.a(e);if(!t||t===a.e(e))return!1;var n=a.f(e,t);return!!n&&n.canUpdateFilter}(e))return a.a(e)}function c(e,t){return!a.g(e)||void 0!==a.d(e).find((function(e){return e.contentId===t}))}function s(e,t){t.addDataField("HasFiltereringCapabilities",!!e.filterState.filteringCapabilities,o.d.SystemMetadata),t.addDataField("IsFilterApplied",!!e.filterState.activeFilterId&&e.filterState.activeFilterId!==a.e(e),o.d.SystemMetadata)}var d=[r.a.ActiveOnly,r.a.ResolvedOnly]},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InCard=1]="InCard",e[e.InChildPost=2]="InChildPost",e[e.InOtherCard=3]="InOtherCard",e[e.InOtherContextOfThisCard=4]="InOtherContextOfThisCard"}(r||(r={}))},,function(e,t,n){"use strict";var r,o,a;function i(e){return!!e&&void 0!==e.Id&&void 0!==e.Name&&void 0!==e.UserPrincipalName&&void 0!==e.EmailAddresses&&void 0!==e.SuggestionType&&void 0!==e.SuggestionSubtype&&void 0!==e.HostAppSuggestion&&void 0!==e.Source&&void 0!==e.SuggestionOrigin}function c(e){return!!e&&void 0!==e.UserId&&void 0!==e.Provider}n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return a})),function(e){e[e.None=0]="None",e[e.MSGraph=1]="MSGraph",e[e.Loki=2]="Loki"}(r||(r={})),function(e){e[e.None=0]="None",e[e.GetContactsForMentions=2]="GetContactsForMentions",e[e.GetAuthToken=4]="GetAuthToken",e[e.GetSuggestionsDetails=8]="GetSuggestionsDetails"}(o||(o={})),function(e){e[e.Success=0]="Success",e[e.UnknownError=1]="UnknownError",e[e.FailedSilently=2]="FailedSilently",e[e.DialogCanceled=3]="DialogCanceled"}(a||(a={}))},,,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.HalfPane="half-pane",e.FullPane="full-pane"}(r||(r={})),t.b=r},function(e,t,n){"use strict";var r;!function(e){e[e.Collapsed=0]="Collapsed",e[e.Expanded=1]="Expanded"}(r||(r={})),t.a=r},function(e,t,n){"use strict";var r;function o(e){return e===r.ClosePaneButton||e===r.NextCommentButton||e===r.PreviousCommentButton||e===r.GhostCard||e===r.NewCommentButton||e===r.PaneRoot||e===r.CommentsList}function a(e){return function(e){return e===r.CardEditor||e===r.PostEditor||e===r.Card||e===r.Post||e===r.DraftCard||e===r.DiscreteHostedCommentRoot||e===r.ReopenThreadButton}(e.componentType)}function i(e){switch(e){case r.CardEditor:case r.Card:case r.DraftCard:case r.DiscreteHostedCommentRoot:case r.ReopenThreadButton:return!0;case r.PostEditor:case r.Post:return!1}}function c(e,t){return a(e)&&a(t)?e.componentType===t.componentType&&e.id===t.id&&e.renderContextType===t.renderContextType:e.componentType===t.componentType}n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return c})),function(e){e[e.ClosePaneButton=1]="ClosePaneButton",e[e.CardEditor=2]="CardEditor",e[e.PostEditor=3]="PostEditor",e[e.Card=4]="Card",e[e.Post=5]="Post",e[e.NextCommentButton=6]="NextCommentButton",e[e.PreviousCommentButton=7]="PreviousCommentButton",e[e.GhostCard=8]="GhostCard",e[e.NewCommentButton=9]="NewCommentButton",e[e.PaneRoot=10]="PaneRoot",e[e.DraftCard=11]="DraftCard",e[e.DiscreteHostedCommentRoot=12]="DiscreteHostedCommentRoot",e[e.ReopenThreadButton=13]="ReopenThreadButton",e[e.CommentsList=14]="CommentsList"}(r||(r={}))},function(e,t,n){"use strict";var r,o,a;n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return g})),n.d(t,"d",(function(){return y})),n.d(t,"e",(function(){return b})),function(e){e[e.HostDefaultOrder=0]="HostDefaultOrder",e[e.NewestFirst=1]="NewestFirst"}(r||(r={})),function(e){e[e.Unknown=0]="Unknown",e[e.UnableToReconcile=1]="UnableToReconcile",e[e.DivergentChange=2]="DivergentChange"}(o||(o={})),function(e){e[e.All=0]="All",e[e.ResolvedOnly=1]="ResolvedOnly",e[e.ActiveOnly=2]="ActiveOnly"}(a||(a={}));var i=n(1004),c=n(1039),s=function(){function e(e){this.getCapabilities=function(){return Promise.resolve(void 0)},this.getHostSpecificLabels=function(){throw new i.c("Method not implemented.",i.d.reserveTag(537743701))},this.getExistingFilteredRange=function(e){throw new i.c("Method not implemented.",i.d.reserveTag(537743702))},this.updateFilterForFilteredRangeId=function(e,t){throw new i.c("Method not implemented.",i.d.reserveTag(537743703))},this.setActiveFilteredRange=function(e){throw new i.c("Method not implemented.",i.d.reserveTag(537743704))},this.getActiveFilteredRangeId=function(){throw new i.c("Method not implemented.",i.d.reserveTag(537743705))},this.onFilteredRangeUpdated=new c.EventImpl((function(){})),this.onUserFilterManagerEvent=new c.EventImpl((function(){})),this.onActiveFilterUpdated=new c.EventImpl((function(){}))}return e.prototype.getFilteredRange=function(e){throw new i.c("Method not implemented.",i.d.reserveTag(537743697))},e.prototype.teardownFilteredRange=function(e){throw new i.c("Method not implemented.",i.d.reserveTag(537743698))},e.prototype.getOrder=function(e){throw new i.c("Method not implemented.",i.d.reserveTag(537743699))},e.prototype.getFilterUsers=function(){throw new i.c("Method not implemented.",i.d.reserveTag(537743706))},e}(),d=n(1139),u=n(1291),l=n(1005),f=n(307),m=function(){function e(e,t,n,r,o,a){this.id=e,this.filter=t,this.order=n,this.hostAPI=r,this.supportsUpdates=o,this.onTeardown=a,this.active=!0,this.onRangeUpdated=new c.EventImpl((function(){}))}return e.prototype.getFilter=function(){return this.filter},e.prototype.getOrder=function(){return this.order},e.prototype.isActive=function(){return this.active},e.prototype.teardown=function(){this.active=!1,this.hostAPI.teardownFilteredRange(this.id),this.onTeardown()},e.prototype.canBeUpdated=function(){return this.supportsUpdates},e.prototype.updateFilter=function(e){return!!this.supportsUpdates&&(this.filter=e,this.hostAPI.updateFilterForFilteredRangeId(this.id,Object(f.a)({},e)),!0)},e.prototype.onChangeEventReceived=function(e){if(this.active){for(var t=0,n=e.changes;t<n.length;t++){var r=n[t];if(this.active)switch(r.type){case"FilterUpdate":this.filter=r.updatedFilter;break;case"Insert":this.order=Object(f.h)(Object(f.h)(Object(f.h)([],this.order.slice(0,r.index),!0),[r.content],!1),this.order.slice(r.index),!0);break;case"Remove":this.order=Object(f.h)(Object(f.h)([],this.order.slice(0,r.index),!0),this.order.slice(r.index+1),!0);break;case"Reload":this.order=r.fullContent,Object(l.k)().assertConditionTag(r.reason===o.DivergentChange,"Received a full reload for an error reason.",537743690);break;case"Teardown":this.active=!1}}this.onRangeUpdated.trigger(e)}},e}(),p=function(){return function(e){var t=this;this.hostApi=e,this.getFilterUsers=function(){return void 0!==t.cachedUsers?Promise.resolve(t.cachedUsers):t.hostApi.getFilterUsers().then((function(e){return t.cachedUsers=e,e}))},this.onUserFilterManagerEventReceived=function(e){if(t.cachedUsers){var n=e.payload.type;switch(n){case"UserAdded":t.cachedUsers=Object(f.h)(Object(f.h)([],t.cachedUsers,!0),[e.payload.user],!1);break;case"UserRemoved":t.cachedUsers=t.cachedUsers.filter((function(t){return t.Provider!==e.payload.user.Provider||t.UserId!==e.payload.user.UserId}));break;default:Object(i.m)(n)}}},this.onUserFilterManagerEvent=this.hostApi.onUserFilterManagerEvent,this.hostApi.onUserFilterManagerEvent.subscribe(this.onUserFilterManagerEventReceived)}}(),h=function(){return function(e){var t=this;this.contentFilteredRangeHostAPI=e,this.filteredRanges=new Map,this.createFilteredRange=function(e){return t.contentFilteredRangeHostAPI.getFilteredRange({contentTypes:e.contentTypes,hostFilter:e.filters,supportsFilterUpdates:e.supportsFilterUpdates}).then((function(e){var n=e.filterId,r=new m(n,e.filter,e.content,t.contentFilteredRangeHostAPI,e.supportsFilterUpdates,(function(){return t.onFilterTearDown(n)}));return t.filteredRanges.set(n,r),r}))},this.getFilteredRange=function(e){return t.filteredRanges.has(e)?Promise.resolve(t.filteredRanges.get(e)):t.contentFilteredRangeHostAPI.getExistingFilteredRange(e).then((function(n){if(n){var r=new m(n.filterId,n.filter,n.content,t.contentFilteredRangeHostAPI,n.supportsFilterUpdates,(function(){return t.onFilterTearDown(e)}));return t.filteredRanges.has(e)||t.filteredRanges.set(e,r),r}}))},this.setActiveFilteredRange=function(e){t.contentFilteredRangeHostAPI.setActiveFilteredRange(e)},this.getActiveFilteredRangeId=function(){return t.contentFilteredRangeHostAPI.getActiveFilteredRangeId()},this.onEventReceived=function(e){var n=t.filteredRanges.get(e.filterId);n&&n.onChangeEventReceived(e.payload)},this.onFilterTearDown=function(e){t.filteredRanges.delete(e)},this.getCapabilities=function(){return t.contentFilteredRangeHostAPI.getCapabilities()},this.getHostSpecificLabels=function(){return t.contentFilteredRangeHostAPI.getHostSpecificLabels()},this.getUserFilterManager=function(){return t.userFilterManager},this.onActiveFilterUpdated=this.contentFilteredRangeHostAPI.onActiveFilterUpdated,this.contentFilteredRangeHostAPI.onFilteredRangeUpdated.subscribe(this.onEventReceived),this.userFilterManager=new p(e)}}();var v=new Map;function g(e,t){Object(l.k)().assertConditionTag(!function(){return!0}()||e===d.a,"Received unexpected API Context for Web. This is not fully supported for all APIs.",538035220);var n=v.get(e);n||(n=new u.a("ContentFilteredRange"),v.set(e,n)),n.injectInstance(new h(t))}function y(e){var t=v.get(e);if(!t)throw new i.c("ContentFilteredRangeAPI not initialized for current apiContenxt ".concat(e,"."),i.d.reserveTag(538035221));return t.getInstanceOrThrow()}function b(e){var t;return void 0!==(null===(t=v.get(e))||void 0===t?void 0:t.getInstance())}!function(){function e(){this.getCapabilities=function(){return Promise.resolve(void 0)},this.getHostSpecificLabels=function(){throw new i.c("Method not implemented.",i.d.reserveTag(537421141))},this.getExistingFilteredRange=function(e){throw new i.c("Method not implemented.",i.d.reserveTag(537421142))},this.updateFilterForFilteredRangeId=function(e,t){throw new i.c("Method not implemented.",i.d.reserveTag(537421143))},this.setActiveFilteredRange=function(e){throw new i.c("Method not implemented.",i.d.reserveTag(537421144))},this.getActiveFilteredRangeId=function(){throw new i.c("Method not implemented.",i.d.reserveTag(537421145))},this.onFilteredRangeUpdated=new c.EventImpl((function(){})),this.onUserFilterManagerEvent=new c.EventImpl((function(){})),this.onActiveFilterUpdated=new c.EventImpl((function(){}))}e.prototype.getFilteredRange=function(e){throw new i.c("Method not implemented.",i.d.reserveTag(537421138))},e.prototype.teardownFilteredRange=function(e){throw new i.c("Method not implemented.",i.d.reserveTag(537421139))},e.prototype.getOrder=function(e){throw new i.c("Method not implemented.",i.d.reserveTag(537421140))},e.prototype.getFilterUsers=function(){throw new i.c("Method not implemented.",i.d.reserveTag(537421146))}}()},function(e,t,n){"use strict";var r,o,a;n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"h",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"e",(function(){return m})),function(e){e[e.None=0]="None",e[e.Canvas=1]="Canvas"}(r||(r={})),function(e){e[e.Keyboarding=1]="Keyboarding",e[e.HostAction=2]="HostAction"}(o||(o={})),function(e){e[e.None=0]="None",e[e.Next=1]="Next",e[e.Previous=2]="Previous"}(a||(a={}));var i,c=n(1004),s=function(){function e(e){this.apiContext=e}return e.prototype.selectNextOrPreviousContent=function(e){throw new c.c("Method not implemented.",c.d.reserveTag(523633811))},e.prototype.moveFocus=function(e){throw new c.c("Method not implemented.",c.d.reserveTag(523633812))},e.prototype.bringContentIntoView=function(e){throw new c.c("Method not implemented.",c.d.reserveTag(523633813))},e.prototype.isAPIEnabled=function(){return!1},e}(),d=function(){function e(){}return e.prototype.selectNextOrPreviousContent=function(e){},e.prototype.moveFocus=function(e){},e.prototype.bringContentIntoView=function(e){},e}();function u(e,t){i=e}function l(e){return void 0===i&&(i=new d),i}function f(e){return void 0!==i}function m(e){i=void 0}},function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return d}));var r,o=n(1004),a=n(1005),i=n(1016);function c(e){if(r)throw Object(a.k)().assertConditionTag(!1,"WebAppColors cannot be re-initialized.",578647955),new i.a("WebAppColors cannot be re-initialized.",o.d.reserveTag(577610271),-2130957508);r=e}function s(){r=void 0}function d(){if(!r)throw Object(a.k)().assertConditionTag(!1,"WebAppColors is not initialized",578647956),new i.a("WebAppColors is not initialized",o.d.reserveTag(577610272),-2130957509);return r}},function(e,t,n){"use strict";var r;function o(e){if(!e)return!1;var t=e;return void 0!==t.displayMode&&"string"==typeof t.displayMode}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e.Normal="Normal",e.FullScreen="FullScreen",e.Variable="Variable"}(r||(r={}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.CommentContextChanged=0]="CommentContextChanged",e[e.LoadComments=1]="LoadComments",e[e.CommentContextReload=2]="CommentContextReload",e[e.CommentsInserted=3]="CommentsInserted",e[e.CommentsDeleted=4]="CommentsDeleted",e[e.CommentsUpdated=5]="CommentsUpdated",e[e.CommentSelected=6]="CommentSelected",e[e.CommentHighlighted=7]="CommentHighlighted",e[e.NextPopulatedContextDetailsUpdated=8]="NextPopulatedContextDetailsUpdated",e[e.CommentError=9]="CommentError",e[e.CommentsChanged=10]="CommentsChanged",e[e.CommentHostCapabilitiesChanged=11]="CommentHostCapabilitiesChanged",e[e.ModelCapabilitiesChanged=12]="ModelCapabilitiesChanged",e[e.UpdateDraftThread=13]="UpdateDraftThread",e[e.ReturnToDraftRequested=14]="ReturnToDraftRequested",e[e.SmartReplyPopulated=15]="SmartReplyPopulated",e[e.NativeHeartbeat=50]="NativeHeartbeat"}(r||(r={}))},function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));n(1037);var r="sharedcommentsdemo"===e.env.TEST_PAGE,o=!1}).call(this,n(280))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NoDraft=1]="NoDraft",e[e.CanAutoDiscard=2]="CanAutoDiscard",e[e.CannotAutoDiscard=3]="CannotAutoDiscard"}(r||(r={}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Editor=1]="Editor",e[e.Card=2]="Card",e[e.Delete=3]="Delete"}(r||(r={}))},function(e,t,n){"use strict";function r(e){return!!e&&!!e.commentModel}function o(e){return!!e&&!!e.historyItem}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n(1006),o={},a=function(e){return Object(r.c)()?e.commentState.tasks:o},i=function(e){return e.commentState.historyRecordViewState}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1016),o=n(1184);function a(e,t){return Object(r.b)(e)?e.errorCode:Object(o.a)(e)?e.SDXHostAPIErrorCode:void 0===t?-2147467259:t}},,function(e,t,n){"use strict";n.d(t,"h",(function(){return r.j})),n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"c",(function(){return r.e})),n.d(t,"f",(function(){return r.h})),n.d(t,"d",(function(){return r.f})),n.d(t,"e",(function(){return r.g})),n.d(t,"g",(function(){return r.i}));var r=n(1041);n(1179),n(1203)},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d}));var r=n(2),o=n(1062),a=n(1018),i={TASK_ASSIGNER_CHECKED_BOX:"#605E5C",TASK_BORDER_FOCUS:"#797775",TASK_BORDER:"#252423",TASK_CHECKBOX_COLOR:"#31752F",TASK_CHECKBOX_COLOR_COMPLETED_HOVER:"#255924",TASK_CHECKMARK_COLOR:"#31752F",TASK_DISABLED:"#A19F9D",TASK_TEXT:"#252423"},c="10px",s=Object(r.memoizeFunction)((function(e,t){var n,c,s,d=Object(r.mergeStyles)(!t&&{color:i.TASK_TEXT,selectors:{":hover":{selectors:{".ms-Checkbox-text":Object(r.mergeStyles)({color:i.TASK_TEXT,selectors:(n={},n[r.HighContrastSelector]={color:"HighlightText"},n)},e&&{color:Object(o.a)().primary})}}}}),u={alignItems:"center",border:"1px solid transparent",borderRadius:"3px",borderSpacing:"2px",height:"16px",overflow:"hidden",padding:"3px",selectors:(c={":hover":a.l},c[r.HighContrastSelector]={color:"ButtonText"},c)},l=Object(r.mergeStyles)({borderRadius:a.c,boxSizing:"content-box",height:"14px",textAlign:"center",width:"14px"},t&&{borderColor:i.TASK_DISABLED}),f={selectors:(s={},s[".".concat(r.IsFocusVisibleClassName," &:focus + .ms-Checkbox-label:before")]={outline:"none"},s[".".concat(r.IsFocusVisibleClassName," &:focus + .ms-Checkbox-label")]={borderColor:i.TASK_BORDER_FOCUS},s[".".concat(r.IsFocusVisibleClassName," &:focus + label")]=a.k,s[".".concat(r.IsFocusVisibleClassName," &:focus + label .ms-Checkbox-text")]=a.k,s)};return Object(r.mergeStyleSets)({root:d,label:u,checkbox:l,input:f})})),d=Object(r.memoizeFunction)((function(){return{CHECKMARK_ICON_TOPPER:{iconName:"TaskStatusCircleCheckmark",style:{height:"7px",width:"10px",transform:"translateY(-7.5px)"}},CHECKMARK_ICON_ASSIGNER:{iconName:"TaskStatusCircleCheckmark",style:{height:"10px",transform:"translateY(-1px)",width:"14px"}}}}))},function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return l}));var r=n(1004),o=n(1005),a=n(1037),i=!1,c=!1;function s(){var e=void 0;return c||(e=Object(o.k)().createActivityObject("LPPLazyLoad",Object(o.l)(o.g.GlobalAPI),Object(o.j)()),c=!0),f((function(){return n.e(8).then(n.bind(null,1462))}),e).then((function(t){return e&&e.successTag(528282444),t}),(function(t){e&&e.failTag(528282445,-2130957488),c=!1}))}function d(){var e;return i||(e=Object(o.k)().createActivityObject("AtMentionLazyLoad",Object(o.l)(o.g.GlobalAPI),Object(o.j)()),i=!0),Promise.all([n.e(0),n.e(6)]).then(n.bind(null,1541)).then((function(t){return e&&e.successTag(591677089),t})).catch((function(t){e&&e.failTag(595895121,-2130957515),i=!1}))}function u(e){var t,a=Object(o.k)().createActivityObject("SharedCommentsUILazyLoad",Object(o.l)(o.g.GlobalAPI),Object(o.j)());switch(a.addDataField("ContainerName",e,o.d.SystemMetadata),e){case"ExtensionAwareCommentPaneContainer":t=f((function(){return Promise.all([n.e(0),n.e(10)]).then(n.bind(null,1540))}),a);break;case"HostableCommentCardRendererContainer":t=f((function(){return Promise.all([n.e(0),n.e(10)]).then(n.bind(null,1542))}),a);break;default:Object(r.m)(e)}return t.then((function(e){return a.successTag(595731075),e}),(function(e){a.failTag(595734544,-2130957504)}))}function l(){var e=Object(o.k)().createActivityObject("ImmerEs5PluginDelayLoad",Object(o.l)(o.g.GlobalAPI),Object(o.j)());return"undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect?(e.successTag(526254848),Promise.resolve(void 0)):(Object(o.k)().assertConditionTag("web"===Object(a.a)(),"Native should not need to support the ES5 fallback and Immer reducers will fail",526254849),f((function(){return n.e(3).then(n.bind(null,1539))}),e).then((function(t){return e&&e.successTag(526254850),t}),(function(t){e&&e.failTag(526254851,-2130957484)})))}function f(e,t,n){void 0===n&&(n=3);return new Promise((function(r,a){e().then((function(e){t&&t.addDataField("DelayLoadRetryCount",n,o.d.SystemMetadata),r(e)}),(function(o){setTimeout((function(){1!==n?f(e,t,n-1).then(r,a):a(o)}),500)}))}))}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Unknown="unk",e.Insert="ins",e.Modify="mod",e.Delete="del",e.Load="load"}(r||(r={})),t.b=r},function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s}));var r=n(1004),o=n(1005),a=n(1012),i=n(1009);function c(e){return Object(i.b)("",{},e)}var s=c({renderContextType:a.a.None,telemetryVisitor:Object(o.l)(o.g.ReviewedAsNotNecessary),trackback:r.d.reserveTag(595735680)})},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return l}));var r=n(1124),o=n(1077),a=n(1042);function i(e){return e.sessionType===a.a}function c(e){return e.sessionType===a.d&&void 0!==e.threadId}function s(e){return e.sessionType===a.b&&void 0!==e.commentId}var d={CREATE:0,REPLY:1,EDIT:2,METADATA:3},u={CREATE:o.a.Insert,REPLY:o.a.Insert,EDIT:o.a.Modify,METADATA:o.a.Modify};function l(e){return i(e)?r.a.InitCreateCommentSession:c(e)?r.a.InitReplyCommentSession:s(e)?r.a.InitEditCommentSession:r.a.Unknown}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.ReturnToDraft=1]="ReturnToDraft",e[e.GrantAccessFailedSilently=2]="GrantAccessFailedSilently",e[e.CommitFailed=3]="CommitFailed",e[e.GrantAccessCanceled=4]="GrantAccessCanceled"}(r||(r={}))},function(e,t,n){"use strict";var r;!function(e){e[e.Draft=0]="Draft",e[e.Normal=1]="Normal",e[e.Reply=2]="Reply",e[e.ReplyPostCommitPending=4]="ReplyPostCommitPending",e[e.ReplySessionRequestPending=5]="ReplySessionRequestPending",e[e.CardPostCommitPending=6]="CardPostCommitPending",e[e.DraftPreCommitPending=7]="DraftPreCommitPending",e[e.ReplyPreCommitPending=8]="ReplyPreCommitPending",e[e.Resolved=9]="Resolved",e[e.Loading=10]="Loading",e[e.LowFidelityWarningOnDeleteThread=11]="LowFidelityWarningOnDeleteThread"}(r||(r={})),t.a=r},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return s}));n(1004),n(1016);var r,o=function(){function e(){this.ops=[]}return e.prototype.insert=function(e,t,n){return this.ops.push({insert:e,attributes:t,optional:n}),this},e.prototype.toDelta=function(){return{ops:this.ops}},e.prototype.toJSON=function(){return JSON.stringify(this.toDelta())},e}();function a(e,t,n){return{fullName:e,email:t,resolveState:n}}function i(e){return{atmention:{contentId:e.contentId,isCurrentUser:e.isCurrentUser,directoryId:e.directoryId}}}function c(e){return s(JSON.parse(e))}function s(e){return e.ops?e.ops.map((function(e){return e.insert})).join(""):""}!function(e){e[e.Unresolved=0]="Unresolved",e[e.Resolved=1]="Resolved"}(r||(r={}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Placeholder=0]="Placeholder",e[e.Loaded=1]="Loaded",e[e.Loading=2]="Loading",e[e.NeedsReload=3]="NeedsReload"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1058),o=n(1012);function a(e,t,n){return n===o.a.HalfPane||t.includes(e)?r.a.Expanded:r.a.Collapsed}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return s}));var r=n(1004),o=n(1028),a=function(e){return e.contentExtensions.extensions},i=function(e,t){var n=a(e)[t];return void 0!==n&&n.priority!==o.d.Disabled},c=function(e,t){if(!t)return!1;switch(t.renderMode){case o.e.Integrated:case o.e.TaskPaneItem:return void 0!==(n=a(e)[t.renderMode])&&n.priority!==o.d.Disabled;case o.e.Isolated:var n;return void 0!==(n=a(e)[t.renderMode])&&n.controller.provider.getExtension(t.threadId).priority!==o.d.Disabled;default:Object(r.m)(t)}},s=function(e){return e.contentExtensions.contentNavigationSupported}},function(e,t,n){"use strict";n.r(t),n.d(t,"Provider",(function(){return l})),n.d(t,"connectAdvanced",(function(){return j})),n.d(t,"ReactReduxContext",(function(){return a})),n.d(t,"connect",(function(){return Y})),n.d(t,"useDispatch",(function(){return Z})),n.d(t,"createDispatchHook",(function(){return J})),n.d(t,"useSelector",(function(){return te})),n.d(t,"createSelectorHook",(function(){return ee})),n.d(t,"useStore",(function(){return Q})),n.d(t,"createStoreHook",(function(){return X})),n.d(t,"shallowEqual",(function(){return P})),n.d(t,"batch",(function(){return ne.unstable_batchedUpdates}));var r=n(1),o=n.n(r),a=(n(88),o.a.createContext(null));var i=function(e){e()};function c(){var e=function(){return i}(),t=null,n=null;return{clear:function(){t=null,n=null},notify:function(){e((function(){for(var e=t;e;)e.callback(),e=e.next}))},get:function(){for(var e=[],n=t;n;)e.push(n),n=n.next;return e},subscribe:function(e){var r=!0,o=n={callback:e,next:null,prev:n};return o.prev?o.prev.next=o:t=o,function(){r&&null!==t&&(r=!1,o.next?o.next.prev=o.prev:n=o.prev,o.prev?o.prev.next=o.next:t=o.next)}}}}var s={notify:function(){},get:function(){return[]}};function d(e,t){var n,r=s;function o(){i.onStateChange&&i.onStateChange()}function a(){n||(n=t?t.addNestedSub(o):e.subscribe(o),r=c())}var i={addNestedSub:function(e){return a(),r.subscribe(e)},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:o,isSubscribed:function(){return Boolean(n)},trySubscribe:a,tryUnsubscribe:function(){n&&(n(),n=void 0,r.clear(),r=s)},getListeners:function(){return r}};return i}var u="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?r.useLayoutEffect:r.useEffect;var l=function(e){var t=e.store,n=e.context,i=e.children,c=Object(r.useMemo)((function(){var e=d(t);return{store:t,subscription:e}}),[t]),s=Object(r.useMemo)((function(){return t.getState()}),[t]);u((function(){var e=c.subscription;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),s!==t.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}}),[c,s]);var l=n||a;return o.a.createElement(l.Provider,{value:c},i)};function f(){return(f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function m(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}var p=n(45),h=n.n(p),v=n(590),g=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],y=["reactReduxForwardedRef"],b=[],C=[null,null];function T(e,t){var n=e[1];return[t.payload,n+1]}function I(e,t,n){u((function(){return e.apply(void 0,t)}),n)}function S(e,t,n,r,o,a,i){e.current=r,t.current=o,n.current=!1,a.current&&(a.current=null,i())}function O(e,t,n,r,o,a,i,c,s,d){if(e){var u=!1,l=null,f=function(){if(!u){var e,n,f=t.getState();try{e=r(f,o.current)}catch(e){n=e,l=e}n||(l=null),e===a.current?i.current||s():(a.current=e,c.current=e,i.current=!0,d({type:"STORE_UPDATED",payload:{error:n}}))}};n.onStateChange=f,n.trySubscribe(),f();return function(){if(u=!0,n.tryUnsubscribe(),n.onStateChange=null,l)throw l}}}var w=function(){return[null,0]};function j(e,t){void 0===t&&(t={});var n=t,i=n.getDisplayName,c=void 0===i?function(e){return"ConnectAdvanced("+e+")"}:i,s=n.methodName,u=void 0===s?"connectAdvanced":s,l=n.renderCountProp,p=void 0===l?void 0:l,j=n.shouldHandleStateChanges,E=void 0===j||j,k=n.storeKey,P=void 0===k?"store":k,x=(n.withRef,n.forwardRef),A=void 0!==x&&x,D=n.context,R=void 0===D?a:D,F=m(n,g),N=R;return function(t){var n=t.displayName||t.name||"Component",a=c(n),i=f({},F,{getDisplayName:c,methodName:u,renderCountProp:p,shouldHandleStateChanges:E,storeKey:P,displayName:a,wrappedComponentName:n,WrappedComponent:t}),s=F.pure;var l=s?r.useMemo:function(e){return e()};function g(n){var a=Object(r.useMemo)((function(){var e=n.reactReduxForwardedRef,t=m(n,y);return[n.context,e,t]}),[n]),c=a[0],s=a[1],u=a[2],p=Object(r.useMemo)((function(){return c&&c.Consumer&&Object(v.isContextConsumer)(o.a.createElement(c.Consumer,null))?c:N}),[c,N]),h=Object(r.useContext)(p),g=Boolean(n.store)&&Boolean(n.store.getState)&&Boolean(n.store.dispatch);Boolean(h)&&Boolean(h.store);var j=g?n.store:h.store,k=Object(r.useMemo)((function(){return function(t){return e(t.dispatch,i)}(j)}),[j]),P=Object(r.useMemo)((function(){if(!E)return C;var e=d(j,g?null:h.subscription),t=e.notifyNestedSubs.bind(e);return[e,t]}),[j,g,h]),x=P[0],A=P[1],D=Object(r.useMemo)((function(){return g?h:f({},h,{subscription:x})}),[g,h,x]),R=Object(r.useReducer)(T,b,w),F=R[0][0],M=R[1];if(F&&F.error)throw F.error;var L=Object(r.useRef)(),B=Object(r.useRef)(u),V=Object(r.useRef)(),U=Object(r.useRef)(!1),_=l((function(){return V.current&&u===B.current?V.current:k(j.getState(),u)}),[j,F,u]);I(S,[B,L,U,u,_,V,A]),I(O,[E,j,x,k,B,L,U,V,A,M],[j,x,k]);var H=Object(r.useMemo)((function(){return o.a.createElement(t,f({},_,{ref:s}))}),[s,t,_]);return Object(r.useMemo)((function(){return E?o.a.createElement(p.Provider,{value:D},H):H}),[p,H,D])}var j=s?o.a.memo(g):g;if(j.WrappedComponent=t,j.displayName=g.displayName=a,A){var k=o.a.forwardRef((function(e,t){return o.a.createElement(j,f({},e,{reactReduxForwardedRef:t}))}));return k.displayName=a,k.WrappedComponent=t,h()(k,t)}return h()(j,t)}}function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function P(e,t){if(k(e,t))return!0;if("object"!==E(e)||null===e||"object"!==E(t)||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var o=0;o<n.length;o++)if(!Object.prototype.hasOwnProperty.call(t,n[o])||!k(e[n[o]],t[n[o]]))return!1;return!0}function x(e){return function(t,n){var r=e(t,n);function o(){return r}return o.dependsOnOwnProps=!1,o}}function A(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function D(e,t){return function(t,n){n.displayName;var r=function(e,t){return r.dependsOnOwnProps?r.mapToProps(e,t):r.mapToProps(e)};return r.dependsOnOwnProps=!0,r.mapToProps=function(t,n){r.mapToProps=e,r.dependsOnOwnProps=A(e);var o=r(t,n);return"function"==typeof o&&(r.mapToProps=o,r.dependsOnOwnProps=A(o),o=r(t,n)),o},r}}function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var F=[function(e){return"function"==typeof e?D(e):void 0},function(e){return e?void 0:x((function(e){return{dispatch:e}}))},function(e){return e&&"object"===R(e)?x((function(t){return function(e,t){var n={},r=function(r){var o=e[r];"function"==typeof o&&(n[r]=function(){return t(o.apply(void 0,arguments))})};for(var o in e)r(o);return n}(e,t)})):void 0}];var N=[function(e){return"function"==typeof e?D(e):void 0},function(e){return e?void 0:x((function(){return{}}))}];function M(e,t,n){return f({},n,e,t)}var L=[function(e){return"function"==typeof e?function(e){return function(t,n){n.displayName;var r,o=n.pure,a=n.areMergedPropsEqual,i=!1;return function(t,n,c){var s=e(t,n,c);return i?o&&a(s,r)||(r=s):(i=!0,r=s),r}}}(e):void 0},function(e){return e?void 0:function(){return M}}];var B=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function V(e,t,n,r){return function(o,a){return n(e(o,a),t(r,a),a)}}function U(e,t,n,r,o){var a,i,c,s,d,u=o.areStatesEqual,l=o.areOwnPropsEqual,f=o.areStatePropsEqual,m=!1;function p(o,m){var p=!l(m,i),h=!u(o,a,m,i);return a=o,i=m,p&&h?function(){return c=e(a,i),t.dependsOnOwnProps&&(s=t(r,i)),d=n(c,s,i)}():p?function(){return e.dependsOnOwnProps&&(c=e(a,i)),t.dependsOnOwnProps&&(s=t(r,i)),d=n(c,s,i)}():h?function(){var t=e(a,i),r=!f(t,c);return c=t,r&&(d=n(c,s,i)),d}():d}return function(o,u){return m?p(o,u):function(o,u){return c=e(a=o,i=u),s=t(r,i),d=n(c,s,i),m=!0,d}(o,u)}}function _(e,t){var n=t.initMapStateToProps,r=t.initMapDispatchToProps,o=t.initMergeProps,a=m(t,B),i=n(e,a),c=r(e,a),s=o(e,a);return(a.pure?U:V)(i,c,s,e,a)}function H(e){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var G=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function q(e,t,n){for(var r=t.length-1;r>=0;r--){var o=t[r](e);if(o)return o}return function(t,r){throw new Error("Invalid value of type "+H(e)+" for "+n+" argument when connecting component "+r.wrappedComponentName+".")}}function z(e,t){return e===t}function W(e){var t=void 0===e?{}:e,n=t.connectHOC,r=void 0===n?j:n,o=t.mapStateToPropsFactories,a=void 0===o?N:o,i=t.mapDispatchToPropsFactories,c=void 0===i?F:i,s=t.mergePropsFactories,d=void 0===s?L:s,u=t.selectorFactory,l=void 0===u?_:u;return function(e,t,n,o){void 0===o&&(o={});var i=o,s=i.pure,u=void 0===s||s,p=i.areStatesEqual,h=void 0===p?z:p,v=i.areOwnPropsEqual,g=void 0===v?P:v,y=i.areStatePropsEqual,b=void 0===y?P:y,C=i.areMergedPropsEqual,T=void 0===C?P:C,I=m(i,G),S=q(e,a,"mapStateToProps"),O=q(t,c,"mapDispatchToProps"),w=q(n,d,"mergeProps");return r(l,f({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:S,initMapDispatchToProps:O,initMergeProps:w,pure:u,areStatesEqual:h,areOwnPropsEqual:g,areStatePropsEqual:b,areMergedPropsEqual:T},I))}}var Y=W();function K(){return Object(r.useContext)(a)}function X(e){void 0===e&&(e=a);var t=e===a?K:function(){return Object(r.useContext)(e)};return function(){return t().store}}var Q=X();function J(e){void 0===e&&(e=a);var t=e===a?Q:X(e);return function(){return t().dispatch}}var Z=J(),$=function(e,t){return e===t};function ee(e){void 0===e&&(e=a);var t=e===a?K:function(){return Object(r.useContext)(e)};return function(e,n){void 0===n&&(n=$);var o=t(),a=function(e,t,n,o){var a,i=Object(r.useReducer)((function(e){return e+1}),0)[1],c=Object(r.useMemo)((function(){return d(n,o)}),[n,o]),s=Object(r.useRef)(),l=Object(r.useRef)(),f=Object(r.useRef)(),m=Object(r.useRef)(),p=n.getState();try{if(e!==l.current||p!==f.current||s.current){var h=e(p);a=void 0!==m.current&&t(h,m.current)?m.current:h}else a=m.current}catch(e){throw s.current&&(e.message+="\nThe error may be correlated with this previous error:\n"+s.current.stack+"\n\n"),e}return u((function(){l.current=e,f.current=p,m.current=a,s.current=void 0})),u((function(){function e(){try{var e=n.getState();if(e===f.current)return;var r=l.current(e);if(t(r,m.current))return;m.current=r,f.current=e}catch(e){s.current=e}i()}return c.onStateChange=e,c.trySubscribe(),e(),function(){return c.tryUnsubscribe()}}),[n,c]),a}(e,n,o.store,o.subscription);return Object(r.useDebugValue)(a),a}}var te=ee(),ne=n(130);!function(e){i=e}(ne.unstable_batchedUpdates)},function(e,t,n){"use strict";n.d(t,"a",(function(){return re})),n.d(t,"b",(function(){return ce})),n.d(t,"f",(function(){return se})),n.d(t,"c",(function(){return de})),n.d(t,"e",(function(){return ue})),n.d(t,"d",(function(){return le}));var r=n(1552),o=n(1005),a=n(2),i=n(91),c=n(546),s=n(382);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],s=!0,d=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){d=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(d)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==d(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===d(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=c.b.reduce((function(e,t){var n,r=t.slice(0,1).toUpperCase()+t.slice(1),o=(p(n={},"colorPalette".concat(r,"Background1"),i.c[t].shade40),p(n,"colorPalette".concat(r,"Background2"),i.c[t].shade30),p(n,"colorPalette".concat(r,"Background3"),i.c[t].primary),p(n,"colorPalette".concat(r,"Foreground1"),i.c[t].tint30),p(n,"colorPalette".concat(r,"Foreground2"),i.c[t].tint40),p(n,"colorPalette".concat(r,"Foreground3"),i.c[t].tint20),p(n,"colorPalette".concat(r,"BorderActive"),i.c[t].tint30),p(n,"colorPalette".concat(r,"Border1"),i.c[t].primary),p(n,"colorPalette".concat(r,"Border2"),i.c[t].tint20),n);return Object.assign(e,o)}),{});h.colorPaletteRedForeground3=i.c.red.tint30,h.colorPaletteRedBorder2=i.c.red.tint30,h.colorPaletteGreenForeground3=i.c.green.tint40,h.colorPaletteGreenBorder2=i.c.green.tint40,h.colorPaletteDarkOrangeForeground3=i.c.darkOrange.tint30,h.colorPaletteDarkOrangeBorder2=i.c.darkOrange.tint30,h.colorPaletteRedForegroundInverted=i.c.red.primary,h.colorPaletteGreenForegroundInverted=i.c.green.primary,h.colorPaletteYellowForegroundInverted=i.c.yellow.shade30;var v=c.a.reduce((function(e,t){var n,r=t.slice(0,1).toUpperCase()+t.slice(1),o=(p(n={},"colorPalette".concat(r,"Background2"),i.b[t].shade30),p(n,"colorPalette".concat(r,"Foreground2"),i.b[t].tint40),p(n,"colorPalette".concat(r,"BorderActive"),i.b[t].tint30),n);return Object.assign(e,o)}),{});v.colorPaletteDarkRedBackground2=i.b.darkRed.shade20,v.colorPalettePlumBackground2=i.b.plum.shade20;var g=m(m({},h),v),y=Object.entries(s.a).reduce((function(e,t){var n,r=u(t,2),o=r[0],a=r[1],c=o.slice(0,1).toUpperCase()+o.slice(1),s=(p(n={},"colorStatus".concat(c,"Background1"),i.a[a].shade40),p(n,"colorStatus".concat(c,"Background2"),i.a[a].shade30),p(n,"colorStatus".concat(c,"Background3"),i.a[a].primary),p(n,"colorStatus".concat(c,"Foreground1"),i.a[a].tint30),p(n,"colorStatus".concat(c,"Foreground2"),i.a[a].tint40),p(n,"colorStatus".concat(c,"Foreground3"),i.a[a].tint20),p(n,"colorStatus".concat(c,"BorderActive"),i.a[a].tint30),p(n,"colorStatus".concat(c,"ForegroundInverted"),i.a[a].shade10),p(n,"colorStatus".concat(c,"Border1"),i.a[a].primary),p(n,"colorStatus".concat(c,"Border2"),i.a[a].tint20),n);return Object.assign(e,s)}),{});y.colorStatusDangerForeground3=i.a[s.a.danger].tint30,y.colorStatusDangerBorder2=i.a[s.a.danger].tint30,y.colorStatusSuccessForeground3=i.a[s.a.success].tint40,y.colorStatusSuccessBorder2=i.a[s.a.success].tint40,y.colorStatusWarningForegroundInverted=i.a[s.a.warning].shade20;var b=n(25),C=n(958),T=n(959),I=n(960),S=n(547),O=n(586),w=n(587),j=n(545);function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==E(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==E(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===E(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A=function(e){var t=function(e){return{colorNeutralForeground1:b.X,colorNeutralForeground1Hover:b.X,colorNeutralForeground1Pressed:b.X,colorNeutralForeground1Selected:b.X,colorNeutralForeground2:b.r[84],colorNeutralForeground2Hover:b.X,colorNeutralForeground2Pressed:b.X,colorNeutralForeground2Selected:b.X,colorNeutralForeground2BrandHover:e[100],colorNeutralForeground2BrandPressed:e[90],colorNeutralForeground2BrandSelected:e[100],colorNeutralForeground3:b.r[68],colorNeutralForeground3Hover:b.r[84],colorNeutralForeground3Pressed:b.r[84],colorNeutralForeground3Selected:b.r[84],colorNeutralForeground3BrandHover:e[100],colorNeutralForeground3BrandPressed:e[90],colorNeutralForeground3BrandSelected:e[100],colorNeutralForeground4:b.r[60],colorNeutralForegroundDisabled:b.r[36],colorNeutralForegroundInvertedDisabled:b.Y[40],colorBrandForegroundLink:e[100],colorBrandForegroundLinkHover:e[110],colorBrandForegroundLinkPressed:e[90],colorBrandForegroundLinkSelected:e[100],colorNeutralForeground2Link:b.r[84],colorNeutralForeground2LinkHover:b.X,colorNeutralForeground2LinkPressed:b.X,colorNeutralForeground2LinkSelected:b.X,colorCompoundBrandForeground1:e[100],colorCompoundBrandForeground1Hover:e[110],colorCompoundBrandForeground1Pressed:e[90],colorBrandForeground1:e[100],colorBrandForeground2:e[110],colorBrandForeground2Hover:e[130],colorBrandForeground2Pressed:e[160],colorNeutralForeground1Static:b.r[14],colorNeutralForegroundStaticInverted:b.X,colorNeutralForegroundInverted:b.r[14],colorNeutralForegroundInvertedHover:b.r[14],colorNeutralForegroundInvertedPressed:b.r[14],colorNeutralForegroundInvertedSelected:b.r[14],colorNeutralForegroundInverted2:b.r[14],colorNeutralForegroundOnBrand:b.X,colorNeutralForegroundInvertedLink:b.X,colorNeutralForegroundInvertedLinkHover:b.X,colorNeutralForegroundInvertedLinkPressed:b.X,colorNeutralForegroundInvertedLinkSelected:b.X,colorBrandForegroundInverted:e[80],colorBrandForegroundInvertedHover:e[70],colorBrandForegroundInvertedPressed:e[60],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:b.r[16],colorNeutralBackground1Hover:b.r[24],colorNeutralBackground1Pressed:b.r[12],colorNeutralBackground1Selected:b.r[22],colorNeutralBackground2:b.r[12],colorNeutralBackground2Hover:b.r[20],colorNeutralBackground2Pressed:b.r[8],colorNeutralBackground2Selected:b.r[18],colorNeutralBackground3:b.r[8],colorNeutralBackground3Hover:b.r[16],colorNeutralBackground3Pressed:b.r[4],colorNeutralBackground3Selected:b.r[14],colorNeutralBackground4:b.r[4],colorNeutralBackground4Hover:b.r[12],colorNeutralBackground4Pressed:b.d,colorNeutralBackground4Selected:b.r[10],colorNeutralBackground5:b.d,colorNeutralBackground5Hover:b.r[8],colorNeutralBackground5Pressed:b.r[2],colorNeutralBackground5Selected:b.r[6],colorNeutralBackground6:b.r[20],colorNeutralBackgroundInverted:b.X,colorNeutralBackgroundStatic:b.r[24],colorNeutralBackgroundAlpha:b.s[50],colorNeutralBackgroundAlpha2:b.t[70],colorSubtleBackground:"transparent",colorSubtleBackgroundHover:b.r[22],colorSubtleBackgroundPressed:b.r[18],colorSubtleBackgroundSelected:b.r[20],colorSubtleBackgroundLightAlphaHover:b.u[80],colorSubtleBackgroundLightAlphaPressed:b.u[50],colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:b.e[10],colorSubtleBackgroundInvertedPressed:b.e[30],colorSubtleBackgroundInvertedSelected:b.e[20],colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:b.r[8],colorNeutralBackgroundInvertedDisabled:b.Y[10],colorNeutralStencil1:b.r[34],colorNeutralStencil2:b.r[20],colorNeutralStencil1Alpha:b.Y[10],colorNeutralStencil2Alpha:b.Y[5],colorBackgroundOverlay:b.e[50],colorScrollbarOverlay:b.Y[60],colorBrandBackground:e[70],colorBrandBackgroundHover:e[80],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[100],colorCompoundBrandBackgroundHover:e[110],colorCompoundBrandBackgroundPressed:e[90],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[20],colorBrandBackground2Hover:e[40],colorBrandBackground2Pressed:e[10],colorBrandBackgroundInverted:b.X,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralStrokeAccessible:b.r[68],colorNeutralStrokeAccessibleHover:b.r[74],colorNeutralStrokeAccessiblePressed:b.r[70],colorNeutralStrokeAccessibleSelected:e[100],colorNeutralStroke1:b.r[40],colorNeutralStroke1Hover:b.r[46],colorNeutralStroke1Pressed:b.r[42],colorNeutralStroke1Selected:b.r[44],colorNeutralStroke2:b.r[32],colorNeutralStroke3:b.r[24],colorNeutralStrokeSubtle:b.r[4],colorNeutralStrokeOnBrand:b.r[16],colorNeutralStrokeOnBrand2:b.X,colorNeutralStrokeOnBrand2Hover:b.X,colorNeutralStrokeOnBrand2Pressed:b.X,colorNeutralStrokeOnBrand2Selected:b.X,colorBrandStroke1:e[100],colorBrandStroke2:e[50],colorBrandStroke2Hover:e[50],colorBrandStroke2Pressed:e[30],colorBrandStroke2Contrast:e[50],colorCompoundBrandStroke:e[100],colorCompoundBrandStrokeHover:e[110],colorCompoundBrandStrokePressed:e[90],colorNeutralStrokeDisabled:b.r[26],colorNeutralStrokeInvertedDisabled:b.Y[40],colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:b.Y[10],colorNeutralStrokeAlpha2:b.Y[20],colorStrokeFocus1:b.d,colorStrokeFocus2:b.X,colorNeutralShadowAmbient:"rgba(0,0,0,0.24)",colorNeutralShadowKey:"rgba(0,0,0,0.28)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.12)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.40)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.48)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}}(e);return P(P(P(P(P(P(P(P(P(P(P(P(P(P(P({},C.a),T.b),T.d),T.a),T.c),I.a),j.a),j.b),O.a),w.a),t),g),y),Object(S.a)(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey)),Object(S.a)(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand"))}(n(607).a);function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],s=!0,d=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){d=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(d)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){L(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function L(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==D(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===D(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var B=c.b.reduce((function(e,t){var n,r=t.slice(0,1).toUpperCase()+t.slice(1),o=(L(n={},"colorPalette".concat(r,"Background1"),b.x),L(n,"colorPalette".concat(r,"Background2"),b.x),L(n,"colorPalette".concat(r,"Background3"),b.y),L(n,"colorPalette".concat(r,"Foreground1"),b.y),L(n,"colorPalette".concat(r,"Foreground2"),b.y),L(n,"colorPalette".concat(r,"Foreground3"),b.y),L(n,"colorPalette".concat(r,"BorderActive"),b.A),L(n,"colorPalette".concat(r,"Border1"),b.y),L(n,"colorPalette".concat(r,"Border2"),b.y),n);return Object.assign(e,o)}),{});B.colorPaletteRedForegroundInverted=b.y,B.colorPaletteGreenForegroundInverted=b.y,B.colorPaletteYellowForegroundInverted=b.y;var V=c.a.reduce((function(e,t){var n,r=t.slice(0,1).toUpperCase()+t.slice(1),o=(L(n={},"colorPalette".concat(r,"Background2"),b.x),L(n,"colorPalette".concat(r,"Foreground2"),b.y),L(n,"colorPalette".concat(r,"BorderActive"),b.A),n);return Object.assign(e,o)}),{}),U=M(M({},B),V),_=Object.entries(s.a).reduce((function(e,t){var n,r=R(t,2),o=r[0],a=(r[1],o.slice(0,1).toUpperCase()+o.slice(1)),i=(L(n={},"colorStatus".concat(a,"Background1"),b.x),L(n,"colorStatus".concat(a,"Background2"),b.x),L(n,"colorStatus".concat(a,"Background3"),b.y),L(n,"colorStatus".concat(a,"Foreground1"),b.y),L(n,"colorStatus".concat(a,"Foreground2"),b.y),L(n,"colorStatus".concat(a,"Foreground3"),b.y),L(n,"colorStatus".concat(a,"BorderActive"),b.A),L(n,"colorStatus".concat(a,"ForegroundInverted"),b.y),L(n,"colorStatus".concat(a,"Border1"),b.y),L(n,"colorStatus".concat(a,"Border2"),b.y),n);return Object.assign(e,i)}),{});function H(e){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){z(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function z(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==H(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==H(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===H(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var W=function(){var e=function(){return{colorNeutralForeground1:b.y,colorNeutralForeground1Hover:b.B,colorNeutralForeground1Pressed:b.B,colorNeutralForeground1Selected:b.B,colorNeutralForeground2:b.y,colorNeutralForeground2Hover:b.B,colorNeutralForeground2Pressed:b.B,colorNeutralForeground2Selected:b.B,colorNeutralForeground2BrandHover:b.B,colorNeutralForeground2BrandPressed:b.B,colorNeutralForeground2BrandSelected:b.B,colorNeutralForeground3:b.y,colorNeutralForeground3Hover:b.B,colorNeutralForeground3Pressed:b.B,colorNeutralForeground3Selected:b.B,colorNeutralForeground3BrandHover:b.B,colorNeutralForeground3BrandPressed:b.B,colorNeutralForeground3BrandSelected:b.B,colorNeutralForeground4:b.y,colorNeutralForegroundDisabled:b.z,colorNeutralForegroundInvertedDisabled:b.z,colorBrandForegroundLink:b.C,colorBrandForegroundLinkHover:b.C,colorBrandForegroundLinkPressed:b.C,colorBrandForegroundLinkSelected:b.C,colorNeutralForeground2Link:b.C,colorNeutralForeground2LinkHover:b.C,colorNeutralForeground2LinkPressed:b.C,colorNeutralForeground2LinkSelected:b.C,colorCompoundBrandForeground1:b.A,colorCompoundBrandForeground1Hover:b.A,colorCompoundBrandForeground1Pressed:b.A,colorBrandForeground1:b.y,colorBrandForeground2:b.y,colorBrandForeground2Hover:b.y,colorBrandForeground2Pressed:b.y,colorNeutralForeground1Static:b.x,colorNeutralForegroundStaticInverted:b.y,colorNeutralForegroundInverted:b.B,colorNeutralForegroundInvertedHover:b.B,colorNeutralForegroundInvertedPressed:b.B,colorNeutralForegroundInvertedSelected:b.B,colorNeutralForegroundInverted2:b.y,colorNeutralForegroundOnBrand:b.w,colorNeutralForegroundInvertedLink:b.C,colorNeutralForegroundInvertedLinkHover:b.C,colorNeutralForegroundInvertedLinkPressed:b.C,colorNeutralForegroundInvertedLinkSelected:b.C,colorBrandForegroundInverted:b.y,colorBrandForegroundInvertedHover:b.B,colorBrandForegroundInvertedPressed:b.B,colorBrandForegroundOnLight:b.w,colorBrandForegroundOnLightHover:b.B,colorBrandForegroundOnLightPressed:b.B,colorBrandForegroundOnLightSelected:b.B,colorNeutralBackground1:b.x,colorNeutralBackground1Hover:b.A,colorNeutralBackground1Pressed:b.A,colorNeutralBackground1Selected:b.A,colorNeutralBackground2:b.x,colorNeutralBackground2Hover:b.A,colorNeutralBackground2Pressed:b.A,colorNeutralBackground2Selected:b.A,colorNeutralBackground3:b.x,colorNeutralBackground3Hover:b.A,colorNeutralBackground3Pressed:b.A,colorNeutralBackground3Selected:b.A,colorNeutralBackground4:b.x,colorNeutralBackground4Hover:b.A,colorNeutralBackground4Pressed:b.A,colorNeutralBackground4Selected:b.A,colorNeutralBackground5:b.x,colorNeutralBackground5Hover:b.A,colorNeutralBackground5Pressed:b.A,colorNeutralBackground5Selected:b.A,colorNeutralBackground6:b.x,colorNeutralBackgroundInverted:b.x,colorNeutralBackgroundStatic:b.x,colorNeutralBackgroundAlpha:b.x,colorNeutralBackgroundAlpha2:b.x,colorSubtleBackground:"transparent",colorSubtleBackgroundHover:b.A,colorSubtleBackgroundPressed:b.A,colorSubtleBackgroundSelected:b.A,colorSubtleBackgroundLightAlphaHover:b.A,colorSubtleBackgroundLightAlphaPressed:b.A,colorSubtleBackgroundLightAlphaSelected:b.A,colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:b.A,colorSubtleBackgroundInvertedPressed:b.A,colorSubtleBackgroundInvertedSelected:b.A,colorTransparentBackground:"transparent",colorTransparentBackgroundHover:b.A,colorTransparentBackgroundPressed:b.A,colorTransparentBackgroundSelected:b.A,colorNeutralBackgroundDisabled:b.x,colorNeutralBackgroundInvertedDisabled:b.x,colorNeutralStencil1:b.y,colorNeutralStencil2:b.y,colorNeutralStencil1Alpha:b.y,colorNeutralStencil2Alpha:b.y,colorBackgroundOverlay:b.e[50],colorScrollbarOverlay:b.v,colorBrandBackground:b.v,colorBrandBackgroundHover:b.A,colorBrandBackgroundPressed:b.A,colorBrandBackgroundSelected:b.A,colorCompoundBrandBackground:b.A,colorCompoundBrandBackgroundHover:b.A,colorCompoundBrandBackgroundPressed:b.A,colorBrandBackgroundStatic:b.x,colorBrandBackground2:b.x,colorBrandBackground2Hover:b.x,colorBrandBackground2Pressed:b.x,colorBrandBackgroundInverted:b.v,colorBrandBackgroundInvertedHover:b.A,colorBrandBackgroundInvertedPressed:b.A,colorBrandBackgroundInvertedSelected:b.A,colorNeutralStrokeAccessible:b.y,colorNeutralStrokeAccessibleHover:b.A,colorNeutralStrokeAccessiblePressed:b.A,colorNeutralStrokeAccessibleSelected:b.A,colorNeutralStroke1:b.y,colorNeutralStroke1Hover:b.A,colorNeutralStroke1Pressed:b.A,colorNeutralStroke1Selected:b.A,colorNeutralStroke2:b.y,colorNeutralStroke3:b.y,colorNeutralStrokeSubtle:b.y,colorNeutralStrokeOnBrand:b.x,colorNeutralStrokeOnBrand2:b.y,colorNeutralStrokeOnBrand2Hover:b.y,colorNeutralStrokeOnBrand2Pressed:b.y,colorNeutralStrokeOnBrand2Selected:b.y,colorBrandStroke1:b.y,colorBrandStroke2:b.y,colorBrandStroke2Hover:b.A,colorBrandStroke2Pressed:b.A,colorBrandStroke2Contrast:b.x,colorCompoundBrandStroke:b.A,colorCompoundBrandStrokeHover:b.A,colorCompoundBrandStrokePressed:b.A,colorNeutralStrokeDisabled:b.z,colorNeutralStrokeInvertedDisabled:b.z,colorTransparentStroke:b.y,colorTransparentStrokeInteractive:b.A,colorTransparentStrokeDisabled:b.z,colorNeutralStrokeAlpha:b.y,colorNeutralStrokeAlpha2:b.x,colorStrokeFocus1:b.x,colorStrokeFocus2:b.A,colorNeutralShadowAmbient:"rgba(0,0,0,0.24)",colorNeutralShadowKey:"rgba(0,0,0,0.28)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.12)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.40)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.48)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}}();return q(q(q(q(q(q(q(q(q(q(q(q(q(q(q({},C.a),T.b),T.d),T.a),T.c),I.a),j.a),j.b),O.a),w.a),e),U),_),Object(S.a)(e.colorNeutralShadowAmbient,e.colorNeutralShadowKey)),Object(S.a)(e.colorBrandShadowAmbient,e.colorBrandShadowKey,"Brand"))}(),Y=n(997),K=n(1017),X=n(1018),Q=n(1075),J=function(){function e(){}return e.prototype.getThemeMode=function(){return 0},e.prototype.registerOnThemeChanged=function(e){},e.prototype.convertColorForTheme=function(e,t){return e},e}(),Z=n(1006),$=function(e){return Object(o.k)().assertConditionTag(oe(),"Should not retrieve dark mode semantic colors if dark theme is not set.",545067039),{AtMentionHighlight:a.NeutralColors.gray140,AtMentionMessageBackground:a.NeutralColors.gray140,AtMentionMessageText:a.NeutralColors.gray40,AtMentionText:a.NeutralColors.gray40,AtMentionToMeHighlight:e.palette.themeTertiary,AtMentionToMeText:e.palette.black,BlueDot:"#5099FF",CancelDraftButtonIcon:void 0,CancelDraftButtonIconFocused:void 0,CancelDraftButtonIconHovered:void 0,CancelDraftButtonIconPressed:void 0,CardBackground:a.NeutralColors.gray180,CardBorder:a.NeutralColors.gray120,CardBorderEmphasis:"#C480CB",CardTopperContainerBorder:a.NeutralColors.gray140,CheckBoxBackground:"transparent",CheckBoxBackgroundChecked:e.palette.themePrimary,CheckBoxBackgroundCheckedHovered:"#3D7CE8",CheckBoxBackgroundHovered:a.NeutralColors.gray190,CheckBoxBackgroundPressed:e.palette.white,CheckBoxBorder:a.NeutralColors.gray80,CheckBoxBorderCheckedHovered:"#3D7CE8",CheckBoxBorderDisabled:a.NeutralColors.gray130,CheckBoxBorderHovered:a.NeutralColors.gray80,CheckBoxCheckMark:a.NeutralColors.gray80,CheckBoxCheckMarkChecked:e.palette.black,ClosePaneButtonFocused:e.palette.black,ClosePaneButtonHovered:a.NeutralColors.gray160,ClosePaneButtonPressed:a.NeutralColors.gray150,ClosePaneButtonIcon:a.NeutralColors.gray20,ClosePaneButtonIconHovered:a.NeutralColors.gray20,ClosePaneButtonIconPressed:a.NeutralColors.gray20,CommentLikeEmptyBorder:"#FEFEFE",CommentLikeSolidBorder:"#83BEEC",CommentLikeSolidCenter:"#0063B1",CommonControlBorder:a.NeutralColors.gray120,CtrlEnterTip:a.NeutralColors.gray80,DefaultButton:"transparent",DefaultButtonHovered:a.NeutralColors.gray160,DefaultButtonIcon:a.NeutralColors.gray20,DefaultButtonIconDisabled:a.NeutralColors.gray130,DefaultButtonPressed:e.palette.white,DefaultFilterButtonBackground:"transparent",DraftWarning:"#F1BBBD",ExpandButtonTextResolved:a.NeutralColors.gray80,ExpandButtonTextResolvedHovered:a.NeutralColors.gray50,ExpandButtonTextResolvedPressed:a.NeutralColors.gray30,FilterButtonBackground:a.NeutralColors.black,FilterButtonIconAndTextColor:a.NeutralColors.gray90,FilterMenuSectionHeaderText:a.NeutralColors.gray40,Hyperlink:"#7DB0FF",HyperlinkActive:"#FF0000",MenuIcon:e.palette.black,MenuIconDisabled:a.NeutralColors.gray130,MenuIconHoveredPressed:e.palette.black,MoreRepliesColor:e.palette.themeDark,NewCommentButton:"transparent",NewCommentButtonBorderFocused:a.NeutralColors.gray20,NewCommentButtonDisabled:a.NeutralColors.gray130,NewCommentButtonHovered:a.NeutralColors.gray180,NewCommentButtonLabel:a.NeutralColors.gray20,NewCommentButtonLabelHovered:a.NeutralColors.gray20,NewCommentButtonPressed:a.NeutralColors.gray160,NewCommentButtonIconHoveredPressed:"#3D7CE8",PaneBackground:a.NeutralColors.gray200,PersonaColorResolved:a.NeutralColors.gray80,PersonaInitialsTextColor:e.palette.black,PersonaInitialsTextColorResolved:e.palette.white,PrimaryButton:e.palette.themePrimary,PrimaryButtonFocused:e.palette.themePrimary,PrimaryButtonHovered:"#3D7CE8",PrimaryButtonIcon:e.palette.black,PrimaryButtonPressed:e.palette.themeDarker,ResetFilterButtonBackground:"transparent",ResetFilterButtonBackgroundDisabled:"transparent",ResetFilterButtonText:a.NeutralColors.white,ResetFilterButtonTextDisabled:a.NeutralColors.gray130,ResolvedCardBackground:e.palette.white,ResolvedCardText:a.NeutralColors.gray80,ResolvedCardTitle:a.NeutralColors.gray50,SmartRepliesText:a.NeutralColors.gray20,SubText:a.NeutralColors.gray80,SuggestedItem:a.NeutralColors.gray140,SuggestedItemHovered:a.NeutralColors.gray120,SuggestedItemPressed:e.palette.white,TaskAssignerFocus:e.palette.black,TaskAssignerText:a.NeutralColors.gray20,TaskBorder:e.palette.black,TaskPickerButton:e.palette.black,Text:a.NeutralColors.gray20}},ee=function(e){return Object(o.k)().assertConditionTag(ae(),"Should not retrieve light mode semantic colors if light theme is not set.",545067040),{AtMentionHighlight:a.NeutralColors.gray20,AtMentionMessageBackground:"#F0F0F0",AtMentionMessageText:a.NeutralColors.gray160,AtMentionText:a.NeutralColors.gray180,AtMentionToMeHighlight:e.palette.themeLighter,AtMentionToMeText:e.palette.themeDarkAlt,BlueDot:"#006bFF",CancelDraftButtonIcon:K.a.GRAY_E,CancelDraftButtonIconFocused:K.a.GRAY_J,CancelDraftButtonIconHovered:K.a.GRAY_J,CancelDraftButtonIconPressed:K.a.GRAY_J,CardBackground:e.palette.white,CardBorder:K.a.COMMENTS_GRAY,CardBorderEmphasis:K.a.COMMENTS_PURPLE,CardTopperContainerBorder:K.a.GRAY_B,CheckBoxBackground:"transparent",CheckBoxBackgroundChecked:Q.b.TASK_ASSIGNER_CHECKED_BOX,CheckBoxBackgroundCheckedHovered:Q.b.TASK_ASSIGNER_CHECKED_BOX,CheckBoxBackgroundHovered:"transparent",CheckBoxBackgroundPressed:"transparent",CheckBoxBorder:Q.b.TASK_BORDER,CheckBoxBorderCheckedHovered:Q.b.TASK_BORDER,CheckBoxBorderDisabled:Q.b.TASK_DISABLED,CheckBoxBorderHovered:Q.b.TASK_CHECKBOX_COLOR,CheckBoxCheckMark:Q.b.TASK_TEXT,CheckBoxCheckMarkChecked:e.palette.white,ClosePaneButtonFocused:K.a.ACTIVE_COMMENT_TEXT,ClosePaneButtonHovered:a.NeutralColors.gray40,ClosePaneButtonPressed:a.NeutralColors.gray70,ClosePaneButtonIcon:K.a.GRAY_F,ClosePaneButtonIconHovered:K.a.GRAY_J,ClosePaneButtonIconPressed:K.a.GRAY_J,CommentLikeEmptyBorder:"#3A3A38",CommentLikeSolidBorder:"#0063B1",CommentLikeSolidCenter:"#83BEEC",CommonControlBorder:a.NeutralColors.gray110,CtrlEnterTip:a.NeutralColors.gray120,DefaultButton:"transparent",DefaultButtonHovered:void 0,DefaultButtonIcon:a.NeutralColors.gray200,DefaultButtonIconDisabled:a.NeutralColors.gray100,DefaultButtonPressed:void 0,DefaultFilterButtonBackground:a.NeutralColors.gray30,DraftWarning:a.SharedColors.red10,ExpandButtonTextResolved:a.NeutralColors.gray130,ExpandButtonTextResolvedHovered:K.a.GRAY_H,ExpandButtonTextResolvedPressed:K.a.GRAY_H,FilterButtonBackground:"transparent",FilterButtonIconAndTextColor:"#313131",FilterMenuSectionHeaderText:a.NeutralColors.gray130,Hyperlink:"#0000EE",HyperlinkActive:"#FF0000",MenuIcon:K.a.GRAY_F,MenuIconDisabled:K.a.GRAY_C,MenuIconHoveredPressed:K.a.GRAY_J,MoreRepliesColor:e.palette.themePrimary,NewCommentButton:e.palette.white,NewCommentButtonBorderFocused:e.palette.black,NewCommentButtonDisabled:X.b.BUTTON_DISABLED,NewCommentButtonHovered:void 0,NewCommentButtonLabel:a.NeutralColors.gray180,NewCommentButtonLabelHovered:K.a.GRAY_J,NewCommentButtonPressed:void 0,NewCommentButtonIconHoveredPressed:K.a.GRAY_J,PaneBackground:a.NeutralColors.gray30,PersonaColorResolved:a.NeutralColors.gray130,PersonaInitialsTextColor:e.palette.white,PersonaInitialsTextColorResolved:e.palette.white,PrimaryButton:e.palette.themePrimary,PrimaryButtonFocused:e.palette.themeDarkAlt,PrimaryButtonHovered:e.palette.themeDarkAlt,PrimaryButtonIcon:e.palette.white,PrimaryButtonPressed:e.palette.themeDark,ResetFilterButtonBackground:a.NeutralColors.white,ResetFilterButtonBackgroundDisabled:a.NeutralColors.white,ResetFilterButtonText:a.SharedColors.cyanBlue10,ResetFilterButtonTextDisabled:a.NeutralColors.gray70,ResolvedCardBackground:a.NeutralColors.gray20,ResolvedCardText:a.NeutralColors.gray130,ResolvedCardTitle:a.NeutralColors.gray160,SmartRepliesText:a.NeutralColors.gray140,SubText:K.a.GRAY_E,SuggestedItem:K.a.SUGGESTED_PICKER_ITEM,SuggestedItemHovered:K.a.SUGGESTED_PICKER_ITEM_HOVER,SuggestedItemPressed:K.a.SUGGESTED_PICKER_ITEM_HOVER,TaskAssignerFocus:Q.b.TASK_BORDER_FOCUS,TaskAssignerText:e.palette.black,TaskBorder:Q.b.TASK_BORDER,TaskPickerButton:Q.b.TASK_BORDER,Text:K.a.ACTIVE_COMMENT_TEXT}},te=function(e){return Object(o.k)().assertConditionTag(oe(),"Should not retrieve dark mode semantic styles if dark theme is not set.",545067041),{BoxShadowLevel1:"0px 1px 4px 0px rgba(0,0,0,0.2)",BoxShadowLevel2:"0px 1px 8px 8px rgba(0,0,0,0.2)",BoxShadowLevel3:"0px 1px 16px 8px rgba(0,0,0,0.2)",BoxShadowLevel4:"0px 1px 32px 8px rgba(0,0,0,0.2)",BoxShadowLevel5:"0px 1px 48px 8px rgba(0,0,0,0.2)",CalloutBoxShadow:"0px 1px 16px 8px rgba(0,0,0,0.2)",CardBorder:"1px solid",DefaultButtonBoxShadow:"0 2px 4px -.75px rgba(255, 255, 255, 0.2)",DefaultButtonFocusedBorder:"1px solid ".concat(e.palette.black),DisabledButtonBoxShadow:"inset 0px 0px 0px 1px #323130",FocusedButtonBoxShadow:"inset 0px 0px 0px 1px black",PostOverlay:"rgba(0,0,0,0.5)"}},ne=function(e){return Object(o.k)().assertConditionTag(ae(),"Should not retrieve light mode semantic styles if light theme is not set.",545067042),{BoxShadowLevel1:"0px 1px 2px 0px rgba(0,0,0,0.1)",BoxShadowLevel2:"0px 1px 4px 0px rgba(0,0,0,0.1)",BoxShadowLevel3:"0px 1px 8px 0px rgba(0,0,0,0.1)",BoxShadowLevel4:"0px 1px 16px 0px rgba(0,0,0,0.1)",BoxShadowLevel5:"0px 1px 24px 0px rgba(0,0,0,0.1)",CalloutBoxShadow:void 0,CardBorder:"1px solid",DefaultButtonBoxShadow:"0 2px 4px -.75px rgba(0,0,0,0.1)",DefaultButtonFocusedBorder:"1px solid",DisabledButtonBoxShadow:"inset 0px 0px 0px 1px #F3F2F1",FocusedButtonBoxShadow:"inset 0px 0px 0px 1px white",PostOverlay:"rgba(255,255,255,0.5)"}},re=function(){var e=new J;return{setThemeAPI:function(t){e=t},getThemeAPI:function(){return e},resetThemeAPI:function(){e=new J}}}();function oe(){return!!Z.P()&&1===re.getThemeAPI().getThemeMode()}function ae(){return!Z.P()||0===re.getThemeAPI().getThemeMode()}function ie(){return!!Z.P()&&99999===re.getThemeAPI().getThemeMode()}var ce=Object(a.memoizeFunction)((function(e){return Object(o.k)().assertConditionTag(Z.P(),"Semantic color map should not be used if web theme integration is disabled.",553710797),Z.a()?oe()?$(e):ie()?function(e){return Object(o.k)().assertConditionTag(ie(),"Should not retrieve Teams high contrast semantic colors if Teams high contrast theme is not set.",508938275),{AtMentionHighlight:a.NeutralColors.gray140,AtMentionMessageBackground:e.palette.red,AtMentionMessageText:"#1aebff",AtMentionText:"#1aebff",AtMentionToMeHighlight:"#1aebff",AtMentionToMeText:e.palette.black,BlueDot:"#1aebff",CancelDraftButtonIcon:void 0,CancelDraftButtonIconFocused:void 0,CancelDraftButtonIconHovered:void 0,CancelDraftButtonIconPressed:void 0,CardBackground:e.palette.black,CardBorder:"#1aebff",CardBorderEmphasis:"#1aebff",CardTopperContainerBorder:e.palette.white,CheckBoxBackground:"transparent",CheckBoxBackgroundChecked:"#1aebff",CheckBoxBackgroundCheckedHovered:"#1aebff",CheckBoxBackgroundHovered:e.palette.black,CheckBoxBackgroundPressed:"#1aebff",CheckBoxBorder:e.palette.white,CheckBoxBorderCheckedHovered:e.palette.white,CheckBoxBorderDisabled:a.NeutralColors.gray130,CheckBoxBorderHovered:"#1aebff",CheckBoxCheckMark:"#1aebff",CheckBoxCheckMarkChecked:e.palette.black,ClosePaneButtonFocused:e.palette.black,ClosePaneButtonHovered:a.NeutralColors.gray160,ClosePaneButtonPressed:a.NeutralColors.gray150,ClosePaneButtonIcon:a.NeutralColors.gray20,ClosePaneButtonIconHovered:a.NeutralColors.gray20,ClosePaneButtonIconPressed:a.NeutralColors.gray20,CommentLikeEmptyBorder:"#FFFFFF",CommentLikeSolidBorder:"#1aebff",CommentLikeSolidCenter:"#1aebff",CommonControlBorder:e.palette.white,CtrlEnterTip:e.palette.white,DefaultButton:e.palette.black,DefaultButtonHovered:a.NeutralColors.gray50,DefaultButtonIcon:e.palette.white,DefaultButtonIconDisabled:e.palette.white,DefaultButtonPressed:a.NeutralColors.gray50,DefaultFilterButtonBackground:"transparent",DraftWarning:"#FFFF00",ExpandButtonTextResolved:a.NeutralColors.gray80,ExpandButtonTextResolvedHovered:a.NeutralColors.gray50,ExpandButtonTextResolvedPressed:a.NeutralColors.gray30,FilterButtonBackground:a.NeutralColors.black,FilterButtonIconAndTextColor:a.NeutralColors.gray90,FilterMenuSectionHeaderText:a.NeutralColors.gray40,Hyperlink:"#1aebff",HyperlinkActive:"#1aebff",MenuIcon:e.palette.white,MenuIconDisabled:a.NeutralColors.gray130,MenuIconHoveredPressed:e.palette.black,MoreRepliesColor:e.palette.white,NewCommentButton:"transparent",NewCommentButtonBorderFocused:a.NeutralColors.gray20,NewCommentButtonDisabled:a.NeutralColors.gray130,NewCommentButtonHovered:a.NeutralColors.gray180,NewCommentButtonLabel:a.NeutralColors.gray20,NewCommentButtonLabelHovered:a.NeutralColors.gray20,NewCommentButtonPressed:a.NeutralColors.gray160,NewCommentButtonIconHoveredPressed:"#1aebff",PaneBackground:a.NeutralColors.gray200,PersonaColorResolved:a.NeutralColors.gray80,PersonaInitialsTextColor:e.palette.white,PersonaInitialsTextColorResolved:e.palette.white,PrimaryButton:e.palette.white,PrimaryButtonFocused:e.palette.white,PrimaryButtonHovered:"#1aebff",PrimaryButtonIcon:e.palette.black,PrimaryButtonPressed:"#1aebff",ResetFilterButtonBackground:"transparent",ResetFilterButtonBackgroundDisabled:"transparent",ResetFilterButtonText:a.NeutralColors.white,ResetFilterButtonTextDisabled:a.NeutralColors.gray130,ResolvedCardBackground:e.palette.black,ResolvedCardText:a.NeutralColors.white,ResolvedCardTitle:a.NeutralColors.white,SmartRepliesText:e.palette.red,SubText:e.palette.white,SuggestedItem:a.NeutralColors.gray140,SuggestedItemHovered:a.NeutralColors.gray120,SuggestedItemPressed:e.palette.white,TaskAssignerFocus:"#1aebff",TaskAssignerText:"#1aebff",TaskBorder:e.palette.white,TaskPickerButton:e.palette.white,Text:e.palette.white}}(e):ee(e):oe()?$(e):ee(e)}));function se(){Object(a.resetMemoizations)()}var de=Object(a.memoizeFunction)((function(e){return Object(o.k)().assertConditionTag(Z.P(),"Semantic style map should not be used if web theme integration is disabled",545067043),Z.a()?oe()?te(e):ie()?function(e){return Object(o.k)().assertConditionTag(ie(),"Should not retrieve Teams high contrast mode semantic styles if Teams high contrast theme is not set.",508938274),{BoxShadowLevel1:"none",BoxShadowLevel2:"none",BoxShadowLevel3:"none",BoxShadowLevel4:"none",BoxShadowLevel5:"none",CalloutBoxShadow:"none",CardBorder:"1px solid",DefaultButtonBoxShadow:"none",DefaultButtonFocusedBorder:"none",DisabledButtonBoxShadow:"none",FocusedButtonBoxShadow:"none",PostOverlay:"rgba(255,255,255,0.5)"}}():ne():oe()?te(e):ne()})),ue=Object(r.a)((function(){return!!Z.P()&&!!re.getThemeAPI().convertColorForTheme})),le=function(){return oe()?A:ie()?W:Y.a}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a.a})),n.d(t,"c",(function(){return i.a})),n.d(t,"d",(function(){return o})),function(e){e[e.None=0]="None",e[e.Capturing=1]="Capturing",e[e.AtTarget=2]="AtTarget",e[e.Bubbling=3]="Bubbling"}(r||(r={}));var o,a=n(1119),i=n(1120);!function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.Delete=46]="Delete",e[e.a=65]="a",e[e.b=66]="b",e[e.c=67]="c",e[e.d=68]="d",e[e.e=69]="e",e[e.f=70]="f",e[e.g=71]="g",e[e.h=72]="h",e[e.i=73]="i",e[e.j=74]="j",e[e.k=75]="k",e[e.l=76]="l",e[e.m=77]="m",e[e.n=78]="n",e[e.o=79]="o",e[e.p=80]="p",e[e.q=81]="q",e[e.r=82]="r",e[e.s=83]="s",e[e.t=84]="t",e[e.u=85]="u",e[e.v=86]="v",e[e.w=87]="w",e[e.x=88]="x",e[e.y=89]="y",e[e.z=90]="z",e[e.F6=117]="F6"}(o||(o={}))},,,,,function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d}));var r,o=n(1005);function a(e){r=e}function i(){r=void 0}function c(e){r?r.announceToScreenReader(e):Object(o.k)().assertConditionTag(!1,"announceToScreenReader not registered",595632534)}var s=function(){function e(){}return e.prototype.setScreenReaderNotifier=function(e){e&&a(e)},e}(),d=function(){function e(){this.screenReaderNotifierManagerInstance=void 0}return e.prototype.getScreenReaderNotifierManagerInstance=function(){return this.screenReaderNotifierManagerInstance||(this.screenReaderNotifierManagerInstance=new s),this.screenReaderNotifierManagerInstance},e}()},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){var n=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=n)},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.AddComment=0]="AddComment",e[e.NextThread=1]="NextThread",e[e.PreviousThread=2]="PreviousThread",e[e.DeleteThread=3]="DeleteThread",e[e.BackKeyPressed=4]="BackKeyPressed",e[e.ShowHideCommentPane=6]="ShowHideCommentPane"}(r||(r={}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Like=1]="Like"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return r}));var r,o=n(1117);function a(e){return e===o.a.CheckEnabled}function i(e){return e===o.a.CheckToggled}function c(e){return e===o.a.Execute}!function(e){e[e.Success=0]="Success",e[e.Fail=1]="Fail",e[e.NotHandled=2]="NotHandled"}(r||(r={}))},function(e,t,n){"use strict";var r;!function(e){e[e.CancelNewDraft=0]="CancelNewDraft",e[e.CancelReplyDraft=1]="CancelReplyDraft",e[e.CancelPostEdit=2]="CancelPostEdit",e[e.DeleteThread=3]="DeleteThread",e[e.ClosePaneDraft=4]="ClosePaneDraft"}(r||(r={})),t.a=r},function(e,t,n){"use strict";var r;function o(e){return void 0!==e.pending||void 0!==e.displayingErrorUI}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e[e.None=0]="None",e[e.Post=1]="Post",e[e.Delete=2]="Delete"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}));var r=n(1005),o=n(1006),a=n(1026);function i(e,t,n,o,i){if(-1!==n&&Object(a.e)(t)<Object(a.e)(e)){var c=Object(r.k)().createActivityObject("SilentDraftDiscard",Object(r.l)(r.g.GlobalAPI),Object(r.j)());c.addDataField("DiscardReason",null!=n?n:0,r.d.SystemMetadata),c.addDataField("Source",o,r.d.SystemMetadata),c.successTag(i)}}function c(e){if(o.C()){var t=Object(r.k)().createActivityObject("MarkCommentCreation",e,Object(r.j)());t.addDocumentMetadata(r.f.Basic),t.successTag(591152859)}}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.PreserveFocus=0]="PreserveFocus",e[e.FocusComponent=1]="FocusComponent",e[e.DispatchAction=2]="DispatchAction",e[e.Compound=3]="Compound"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1004),o=n(1057),a=n(1012);function i(e){switch(e){case o.b.HalfPane:return a.a.HalfPane;case o.b.FullPane:return a.a.FullPane;default:Object(r.m)(e)}}},function(e,t,n){"use strict";var r;!function(e){e[e.KeyboardShortcut=1]="KeyboardShortcut",e[e.CommitButton=2]="CommitButton",e[e.Programmatic=3]="Programmatic"}(r||(r={})),t.a=r},,,function(e,t,n){"use strict";n.d(t,"d",(function(){return f})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return r}));var r,o=n(307),a=n(1039);!function(e){e[e.Unregistered=0]="Unregistered",e[e.Registered=1]="Registered"}(r||(r={}));var i,c,s=function(){function e(e,t){var n=this;this.componentName=e,this._registryInstance=t,this.onComponentCommand=new a.EventImpl((function(){})),this._registryInstance.onComponentCommand.subscribe((function(e){e.details.componentKey===n.componentName&&n.onComponentCommand.trigger(e)}))}return e.prototype.unregister=function(){this.onComponentCommand.unsubscribeAll(),this._registryInstance.unregisterComponent(this.componentName)},e}(),d=function(){function e(e,t){var n=this;this._componentName=e,this._registryInstance=t,this.onStateChanged=new a.EventImpl((function(){})),this._registryInstance.onComponentStateChanged.subscribe((function(e){e.componentName===n._componentName&&n.onStateChanged.trigger(e.state)}))}return Object.defineProperty(e.prototype,"component",{get:function(){return this._registryInstance.componentMap[this._componentName]},enumerable:!1,configurable:!0}),e}(),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.c)(t,e),t}(function(){function e(){this.componentMap={},this.onComponentStateChanged=new a.EventImpl((function(){})),this.onComponentCommand=new a.EventImpl((function(){}))}return e.prototype.initialize=function(){},e.prototype.registerComponent=function(e,t){return this.componentMap[e]=t,this.onComponentStateChanged.trigger({componentName:e,state:r.Registered}),new s(e,this)},e.prototype.unregisterComponent=function(e){delete this.componentMap[e],this.onComponentStateChanged.trigger({componentName:e,state:r.Unregistered})},e.prototype.getComponent=function(e){return Object(o.b)(this,void 0,void 0,(function(){return Object(o.d)(this,(function(t){return[2,new d(e,this)]}))}))},e}());function l(){i=void 0}function f(){if(void 0===i){var e=new u;e.initialize(),i=e}return i}!function(e){e[e.Unspecified=0]="Unspecified",e[e.Trap=1]="Trap",e[e.DoNotTrap=2]="DoNotTrap"}(c||(c={}))},,,function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=!n(1146)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r,o=n(1004),a=n(1201),i=n(1016);function c(){if(!r)try{r=Object(a.b)()}catch(e){throw new i.a("FeatureGateAPI not initialized",o.d.reserveTag(589103629),-2130957531)}return r}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1057);function o(e){return e.containerType===r.b.HalfPane}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ViewContainerChanged=0]="ViewContainerChanged",e[e.FocusTriggered=2]="FocusTriggered",e[e.VisibilityChanged=3]="VisibilityChanged",e[e.FoldableLayoutStateChanged=4]="FoldableLayoutStateChanged"}(r||(r={}))},function(e,t,n){"use strict";var r;!function(e){e.PaneOpen="Read",e.NewThread="NewThread",e.InitRuntime="InitRuntime"}(r||(r={})),t.a=r},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-1.000000, -24.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("path",{d:"M7.4375,24.8349609 C7.875,24.8349609 8.29654745,24.8919265 8.70214844,25.0058594 C9.10774942,25.1197922 9.48827947,25.2815745 9.84375,25.4912109 C10.1992205,25.7008474 10.522785,25.9514959 10.8144531,26.2431641 C11.1061213,26.5348322 11.3567698,26.8583967 11.5664062,27.2138672 C11.7760427,27.5693377 11.937825,27.9498678 12.0517578,28.3554688 C12.1656907,28.7610697 12.2226562,29.1826172 12.2226562,29.6201172 C12.2226562,30.2444693 12.1030285,30.8471651 11.8637695,31.4282227 C11.6245105,32.0092802 11.2838564,32.5208311 10.8417969,32.9628906 L5.12011719,38.6777344 L4.50488281,38.0625 L10.2197266,32.3408203 C10.5797544,31.9807925 10.8577464,31.5649438 11.0537109,31.0932617 C11.2496755,30.6215797 11.3476562,30.1305364 11.3476562,29.6201172 C11.3476562,29.0869114 11.2439789,28.5833357 11.0366211,28.109375 C10.8292633,27.6354143 10.5478533,27.2207049 10.1923828,26.8652344 C9.83691229,26.5097638 9.42220289,26.2283539 8.94824219,26.0209961 C8.47428148,25.8136383 7.97070579,25.7099609 7.4375,25.7099609 C6.94531004,25.7099609 6.51123235,25.7840162 6.13525391,25.9321289 C5.75927546,26.0802416 5.41178545,26.2762032 5.09277344,26.5200195 C4.77376143,26.7638359 4.46728663,27.0406886 4.17333984,27.3505859 C3.87939306,27.6604833 3.57063964,27.9794905 3.24707031,28.3076172 L6.125,28.3076172 L6.125,29.1826172 L1.75,29.1826172 L1.75,24.8076172 L2.625,24.8076172 L2.625,27.6855469 C2.87565229,27.4303373 3.11604703,27.1831067 3.34619141,26.9438477 C3.57633579,26.7045886 3.80647671,26.479005 4.03662109,26.2670898 C4.26676547,26.0551747 4.50146365,25.8614918 4.74072266,25.6860352 C4.97998167,25.5105785 5.23518745,25.3601894 5.50634766,25.2348633 C5.77750787,25.1095371 6.07145024,25.0115563 6.38818359,24.940918 C6.70491695,24.8702796 7.05468559,24.8349609 7.4375,24.8349609 Z",id:"Reopen"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 15",focusable:"false",version:"1.1"},e.exports=o,o.default=o},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Execute=0]="Execute",e[e.CheckEnabled=1]="CheckEnabled",e[e.CheckToggled=2]="CheckToggled"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(1042);function o(e){return e.sessionType===r.a}function a(e){return e.sessionType===r.d&&void 0!==e.threadId}function i(e){return e.sessionType===r.b&&void 0!==e.commentId}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unfocused=0]="Unfocused",e[e.FocusOn=1]="FocusOn",e[e.FocusWithin=2]="FocusWithin"}(r||(r={}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.A="a",e.C="c",e.V="v",e.X="x",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.ArrowUp="ArrowUp",e.Backspace="Backspace",e.Control="Control",e.Delete="Delete",e.Enter="Enter",e.Escape="Escape",e.Meta="Meta",e.Tab="Tab",e.Home="Home",e.End="End",e.F6="F6",e.F12="F12",e.Space=" "}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(1088);function o(e,t){if(!t)return e;switch(e){case r.c.ArrowLeft:return r.c.ArrowRight;case r.c.ArrowRight:return r.c.ArrowLeft;default:return e}}function a(e){switch(e){case"Down":return r.c.ArrowDown;case"Up":return r.c.ArrowUp;case"Left":return r.c.ArrowLeft;case"Right":return r.c.ArrowRight;case"OS":return r.c.Meta;case"Del":return r.c.Delete;case"Spacebar":return" ";case"Esc":return r.c.Escape;case"Ctrl":case"Ctl":return r.c.Control;case"F6":return r.c.F6;case"F12":return r.c.F12;default:return e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e,t){return Object(r.b)("DISPLAY_DRAFT_WARNING",e,t)}},function(e,t,n){"use strict";function r(e,t,n){return!e||!!t&&(!n&&(0!==e.numberOfLoadedComments&&(void 0===e.selectedThreadIndex||e.selectedThreadIndex<e.numberOfLoadedThreads)))}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.GrantUsersAccessFailure=1]="GrantUsersAccessFailure",e[e.InitCreateCommentSession=2]="InitCreateCommentSession",e[e.InitEditCommentSession=3]="InitEditCommentSession",e[e.InitReplyCommentSession=4]="InitReplyCommentSession",e[e.NextThread=5]="NextThread",e[e.PreviousThread=6]="PreviousThread",e[e.DeleteThread=8]="DeleteThread",e[e.CommitFailure=9]="CommitFailure",e[e.HostRequest=10]="HostRequest",e[e.GhostCard=11]="GhostCard"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n(307),o=n(1102);function a(e){return e.type===o.a.FocusComponent&&void 0!==e.component}function i(e,t,n){return void 0===n&&(n={priorityArgs:{priority:1}}),Object(r.a)({type:o.a.FocusComponent,component:t,causedBy:e},n)}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return u}));n(307),n(1029);var r=n(1014),o=n(1015),a=n(1059);function i(e){var t="";return Object(a.e)(e.componentType)?t=c(e.componentType):Object(a.c)(e)&&(t=s(e)),t}function c(e){switch(e){case a.a.ClosePaneButton:return o.l();case a.a.NextCommentButton:return o.E();case a.a.PreviousCommentButton:return o.M();case a.a.GhostCard:return o.A();case a.a.NewCommentButton:return o.D();case a.a.PaneRoot:return o.z();case a.a.CommentsList:return o.q()}}function s(e){switch(e.componentType){case a.a.Card:return o.i(e,!1);case a.a.DraftCard:return o.i(e,!0);case a.a.PostEditor:return o.w(o.G(e));case a.a.CardEditor:return o.w(o.f(e));case a.a.Post:return o.I(e);case a.a.DiscreteHostedCommentRoot:return o.s(e);case a.a.ReopenThreadButton:return o.d(e,o.P())}}function d(e){return e?a.a.DraftCard:a.a.Card}function u(e,t){return d(Object(r.G)(t)===e)}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function a(e){return!!e&&!!e[X]}function i(e){var t;return!!e&&(function(e){if(!e||"object"!=r(e))return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===Q}(e)||Array.isArray(e)||!!e[K]||!!(null===(t=e.constructor)||void 0===t?void 0:t[K])||p(e)||h(e))}function c(e){return a(e)||o(23,e),e[X].t}function s(e,t,n){void 0===n&&(n=!1),0===d(e)?(n?Object.keys:J)(e).forEach((function(o){n&&"symbol"==r(o)||t(o,e[o],e)})):e.forEach((function(n,r){return t(r,n,e)}))}function d(e){var t=e[X];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:p(e)?2:h(e)?3:0}function u(e,t){return 2===d(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function l(e,t){return 2===d(e)?e.get(t):e[t]}function f(e,t,n){var r=d(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function m(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function p(e){return q&&e instanceof Map}function h(e){return z&&e instanceof Set}function v(e){return e.o||e.t}function g(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=Z(e);delete t[X];for(var n=J(t),r=0;r<n.length;r++){var o=n[r],a=t[o];!1===a.writable&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(t[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[o]})}return Object.create(Object.getPrototypeOf(e),t)}function y(e,t){return void 0===t&&(t=!1),C(e)||a(e)||!i(e)||(d(e)>1&&(e.set=e.add=e.clear=e.delete=b),Object.freeze(e),t&&s(e,(function(e,t){return y(t,!0)}),!0)),e}function b(){o(2)}function C(e){return null==e||"object"!=r(e)||Object.isFrozen(e)}function T(e){var t=$[e];return t||o(18,e),t}function I(e,t){$[e]||($[e]=t)}function S(){return H}function O(e,t){t&&(T("Patches"),e.u=[],e.s=[],e.v=t)}function w(e){j(e),e.p.forEach(k),e.p=null}function j(e){e===H&&(H=e.l)}function E(e){return H={p:[],l:H,h:e,m:!0,_:0}}function k(e){var t=e[X];0===t.i||1===t.i?t.j():t.g=!0}function P(e,t){t._=t.p.length;var n=t.p[0],r=void 0!==e&&e!==n;return t.h.O||T("ES5").S(t,e,r),r?(n[X].P&&(w(t),o(4)),i(e)&&(e=x(t,e),t.l||D(t,e)),t.u&&T("Patches").M(n[X].t,e,t.u,t.s)):e=x(t,n,[]),w(t),t.u&&t.v(t.u,t.s),e!==Y?e:void 0}function x(e,t,n){if(C(t))return t;var r=t[X];if(!r)return s(t,(function(o,a){return A(e,r,t,o,a,n)}),!0),t;if(r.A!==e)return t;if(!r.P)return D(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var o=4===r.i||5===r.i?r.o=g(r.k):r.o,a=o,i=!1;3===r.i&&(a=new Set(o),o.clear(),i=!0),s(a,(function(t,a){return A(e,r,o,t,a,n,i)})),D(e,o,!1),n&&e.u&&T("Patches").N(r,n,e.u,e.s)}return r.o}function A(e,t,n,r,o,c,s){if(a(o)){var d=x(e,o,c&&t&&3!==t.i&&!u(t.R,r)?c.concat(r):void 0);if(f(n,r,d),!a(d))return;e.m=!1}else s&&n.add(o);if(i(o)&&!C(o)){if(!e.h.D&&e._<1)return;x(e,o),t&&t.A.l||D(e,o)}}function D(e,t,n){void 0===n&&(n=!1),!e.l&&e.h.D&&e.m&&y(t,n)}function R(e,t){var n=e[X];return(n?v(n):e)[t]}function F(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function N(e){e.P||(e.P=!0,e.l&&N(e.l))}function M(e){e.o||(e.o=g(e.t))}function L(e,t,n){var r=p(t)?T("MapSet").F(t,n):h(t)?T("MapSet").T(t,n):e.O?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:S(),P:!1,I:!1,R:{},l:t,t:e,k:null,o:null,j:null,C:!1},o=r,a=ee;n&&(o=[r],a=te);var i=Proxy.revocable(o,a),c=i.revoke,s=i.proxy;return r.k=s,r.j=c,s}(t,n):T("ES5").J(t,n);return(n?n.A:S()).p.push(r),r}function B(e){return a(e)||o(22,e),function e(t){if(!i(t))return t;var n,r=t[X],o=d(t);if(r){if(!r.P&&(r.i<4||!T("ES5").K(r)))return r.t;r.I=!0,n=V(t,o),r.I=!1}else n=V(t,o);return s(n,(function(t,o){r&&l(r.t,t)===o||f(n,t,e(o))})),3===o?new Set(n):n}(e)}function V(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return g(e)}function U(){function e(e,t){var n=i[e];return n?n.enumerable=t:i[e]=n={configurable:!0,enumerable:t,get:function(){var t=this[X];return ee.get(t,e)},set:function(t){var n=this[X];ee.set(n,e,t)}},n}function t(e){for(var t=e.length-1;t>=0;t--){var r=e[t][X];if(!r.P)switch(r.i){case 5:o(r)&&N(r);break;case 4:n(r)&&N(r)}}}function n(e){for(var t=e.t,n=e.k,r=J(n),o=r.length-1;o>=0;o--){var a=r[o];if(a!==X){var i=t[a];if(void 0===i&&!u(t,a))return!0;var c=n[a],s=c&&c[X];if(s?s.t!==i:!m(c,i))return!0}}var d=!!t[X];return r.length!==J(t).length+(d?0:1)}function o(e){var t=e.k;if(t.length!==e.t.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);if(n&&!n.get)return!0;for(var r=0;r<t.length;r++)if(!t.hasOwnProperty(r))return!0;return!1}var i={};I("ES5",{J:function(t,n){var r=Array.isArray(t),o=function(t,n){if(t){for(var r=Array(n.length),o=0;o<n.length;o++)Object.defineProperty(r,""+o,e(o,!0));return r}var a=Z(n);delete a[X];for(var i=J(a),c=0;c<i.length;c++){var s=i[c];a[s]=e(s,t||!!a[s].enumerable)}return Object.create(Object.getPrototypeOf(n),a)}(r,t),a={i:r?5:4,A:n?n.A:S(),P:!1,I:!1,R:{},l:n,t:t,k:o,o:null,g:!1,C:!1};return Object.defineProperty(o,X,{value:a,writable:!0}),o},S:function(e,n,i){i?a(n)&&n[X].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==r(t)){var n=t[X];if(n){var a=n.t,i=n.k,c=n.R,d=n.i;if(4===d)s(i,(function(t){t!==X&&(void 0!==a[t]||u(a,t)?c[t]||e(i[t]):(c[t]=!0,N(n)))})),s(a,(function(e){void 0!==i[e]||u(i,e)||(c[e]=!1,N(n))}));else if(5===d){if(o(n)&&(N(n),c.length=!0),i.length<a.length)for(var l=i.length;l<a.length;l++)c[l]=!1;else for(var f=a.length;f<i.length;f++)c[f]=!0;for(var m=Math.min(i.length,a.length),p=0;p<m;p++)i.hasOwnProperty(p)||(c[p]=!0),void 0===c[p]&&e(i[p])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?n(e):o(e)}})}n.d(t,"b",(function(){return U})),n.d(t,"c",(function(){return c}));var _,H,G="undefined"!=typeof Symbol&&"symbol"==r(Symbol("x")),q="undefined"!=typeof Map,z="undefined"!=typeof Set,W="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,Y=G?Symbol.for("immer-nothing"):((_={})["immer-nothing"]=!0,_),K=G?Symbol.for("immer-draftable"):"__$immer_draftable",X=G?Symbol.for("immer-state"):"__$immer_state",Q=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),J="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,Z=Object.getOwnPropertyDescriptors||function(e){var t={};return J(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},$={},ee={get:function(e,t){if(t===X)return e;var n=v(e);if(!u(n,t))return function(e,t,n){var r,o=F(t,n);return o?"value"in o?o.value:null===(r=o.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!i(r)?r:r===R(e.t,t)?(M(e),e.o[t]=L(e.A.h,r,e)):r},has:function(e,t){return t in v(e)},ownKeys:function(e){return Reflect.ownKeys(v(e))},set:function(e,t,n){var r=F(v(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var o=R(v(e),t),a=null==o?void 0:o[X];if(a&&a.t===n)return e.o[t]=n,e.R[t]=!1,!0;if(m(n,o)&&(void 0!==n||u(e.t,t)))return!0;M(e),N(e)}return e.o[t]===n&&(void 0!==n||t in e.o)||Number.isNaN(n)&&Number.isNaN(e.o[t])||(e.o[t]=n,e.R[t]=!0),!0},deleteProperty:function(e,t){return void 0!==R(e.t,t)||t in e.t?(e.R[t]=!1,M(e),N(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=v(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){o(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){o(12)}},te={};s(ee,(function(e,t){te[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),te.deleteProperty=function(e,t){return te.set.call(this,e,t,void 0)},te.set=function(e,t,n){return ee.set.call(this,e[0],t,n,e[0])};var ne=new(function(){function e(e){var t=this;this.O=W,this.D=!0,this.produce=function(e,n,a){if("function"==typeof e&&"function"!=typeof n){var c=n;n=e;var s=t;return function(e){var t=this;void 0===e&&(e=c);for(var r=arguments.length,o=Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];return s.produce(e,(function(e){var r;return(r=n).call.apply(r,[t,e].concat(o))}))}}var d;if("function"!=typeof n&&o(6),void 0!==a&&"function"!=typeof a&&o(7),i(e)){var u=E(t),l=L(t,e,void 0),f=!0;try{d=n(l),f=!1}finally{f?w(u):j(u)}return"undefined"!=typeof Promise&&d instanceof Promise?d.then((function(e){return O(u,a),P(e,u)}),(function(e){throw w(u),e})):(O(u,a),P(d,u))}if(!e||"object"!=r(e)){if(void 0===(d=n(e))&&(d=e),d===Y&&(d=void 0),t.D&&y(d,!0),a){var m=[],p=[];T("Patches").M(e,d,m,p),a(m,p)}return d}o(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var r=arguments.length,o=Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(o))}))};var r,o,a=t.produce(e,n,(function(e,t){r=e,o=t}));return"undefined"!=typeof Promise&&a instanceof Promise?a.then((function(e){return[e,r,o]})):[a,r,o]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){i(e)||o(8),a(e)&&(e=B(e));var t=E(this),n=L(this,e,void 0);return n[X].C=!0,j(t),n},t.finishDraft=function(e,t){var n=(e&&e[X]).A;return O(n,t),P(void 0,n)},t.setAutoFreeze=function(e){this.D=e},t.setUseProxies=function(e){e&&!W&&o(20),this.O=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));var o=T("Patches").$;return a(e)?o(e,t):this.produce(e,(function(e){return o(e,t)}))},e}()),re=ne.produce;ne.produceWithPatches.bind(ne),ne.setAutoFreeze.bind(ne),ne.setUseProxies.bind(ne),ne.applyPatches.bind(ne),ne.createDraft.bind(ne),ne.finishDraft.bind(ne);t.a=re},function(e,t,n){"use strict";var r;!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(r||(r={})),t.a=r},function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var r=n(1004),o=n(1005),a=n(1041),i=n(1042),c=n(1079),s=n(1030),d=n(1066),u=n(1012),l=n(1103),f=n(1033),m=n(1076),p=n(1021),h=n(1016),v=n(1070),g=n(1036),y=n(1006),b=n(1014),C=n(1026),T=n(1013),I=n(1027),S=n(1009),O=n(1023),w=n(1155),j=n(1156),E=n(1078),k=n(1173),P=n(1187),x=n(1130);function A(e,t,n,A,D,R){return function(F,N){var M=N(),L=Object(o.k)().createActivityObject("RequestInitCommentSession",e.telemetryVisitor,Object(o.j)()),B=c.b[n.sessionType];return L.addDataField("SessionType",B,o.d.SystemMetadata),L.addDataField("Trackback",e.trackback,o.d.SystemMetadata),L.addDataField("RenderContextType",e.renderContextType,o.d.SystemMetadata),L.addDataField("PaneVisibilityState",I.e(M),o.d.SystemMetadata),y.c()||n.sessionType!==i.c?(T.p(M).atMention===a.b.Enabled&&Object(m.a)().catch(Object(p.a)(r.d.reserveTag(591397600))),F(Object(P.a)(e,O.a.SharedComments,c.c(n))).catch((function(e){return Object(p.a)(r.d.reserveTag(591397602))(e),{draftDiscardResult:a.g.Unhandled,draftDiscardBehavior:d.a.CannotAutoDiscard}})).then((function(a){var i,d;L.addDataField("DraftDiscardBehavior",a.draftDiscardBehavior,o.d.SystemMetadata);var m=N(),p=T.h(m);return Object(C.d)(p)||!y.W()&&T.g(m)&&c.d(n)?(L.addDataField("SessionAlreadyRequested",!0,o.d.SystemMetadata),L.addDataField("DraftRenderContextType",null!==(d=null===(i=Object(b.K)(p))||void 0===i?void 0:i.renderContextType)&&void 0!==d?d:u.a.None,o.d.SystemMetadata),L.successTag(591397633),Promise.resolve(F(E.a))):(L.addDataField("SessionAlreadyRequested",!1,o.d.SystemMetadata),R||F(Object(k.a)(Object(S.a)(e,r.d.reserveTag(591397634)),n,A)),t.beginDraftingAsync(n).then((function(t){if(void 0===t.sessionConfiguration)throw new h.a(g.c,r.d.reserveTag(589103630),-2130957532);c.d(n)&&y.G()&&F(Object(x.a)(Object(S.a)(e,r.d.reserveTag(591397635)),[],[],D,t.author));var a=N(),i=function(e,t,n){if(t!==s.a.Closed&&e!==u.a.DiscreteIsolated)return Object(l.a)(n);if(!Object(f.b)(e))return e;if(t===s.a.Closed)return u.a.None;return Object(l.a)(n)}(e.renderContextType,I.e(a),I.d(a).containerType);return L.addDataField("DraftRenderContextType",i,o.d.SystemMetadata),Object(o.k)().assertConditionTag(i===e.renderContextType||e.renderContextType===u.a.None,"Requested starting a draft in RenderContextType:".concat(e.renderContextType," but had to lock to RenderContextType:").concat(i," based on pane state"),554714642),L.successTag(591397640),F(Object(j.a)(Object(S.a)(e,r.d.reserveTag(591397641)),t,i,R))})).catch((function(t){return(t.message||t).includes("LegacyConvertDialog")?L.successTag(591397643):L.failTag(591397642,Object(v.a)(t)),F(Object(w.a)(Object(S.a)(e,r.d.reserveTag(591397644)),n,t))})))}))):(L.failTag(591397599,-2130957513),Promise.resolve(F(E.a)))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1004),o=n(1021),a=n(1265),i=n(1013),c=n(1168);function s(e,t,n,s,d){return function(u,l){var f=Object(a.c)(t,n,i.r(l()),d);if(0===f.length)return Promise.resolve();if(s.getPersonaIconPropertiesArray)s.getPersonaIconPropertiesArray(f).then((function(t){u(Object(c.a)(e,Object(a.b)(t)))})).catch(Object(o.a)(r.d.reserveTag(595645964)));else{var m=Object(a.a)(f);u(Object(c.a)(e,Object(a.b)(m)))}return Promise.resolve()}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return s}));var r=n(307),o=n(1054),a=n(1022),i=100;function c(e){return e===i}function s(e,t){var n=Object(r.a)({},t);Object(a.m)(n,e);var i=[];Object.keys(n).forEach((function(e){var t=n[e].assignee;Object(o.d)(t)||i.push(t)}));var c=t?e.filter((function(e){return void 0===t[Object(a.i)(e)]})):Object(r.h)([],Object(r.f)(e),!1);if(0!==i.length||0!==c.length)return{assigneesToAdd:i,assigneesToRemove:c}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s}));var r=n(1014),o=n(1066),a=n(1012),i=n(1267),c=function(e,t,n,o,i){return e&&t===a.a.HalfPane&&void 0===i&&(!o||o.selectedCardId===Object(r.G)(n,!0,t))},s=function(e,t,n,a){if(n&&Object(r.n)(e)===o.a.CannotAutoDiscard){var c=null!=a?a:Object(i.a)(e,t.componentTreeId.renderContextType);return function(e,t){return n(c,e,t)}}}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Shared=0]="Shared",e[e.Cancel=1]="Cancel"}(r||(r={}))},,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}));var r,o,a=n(1235);!function(e){e[e.Enabled=0]="Enabled",e[e.Execute=1]="Execute",e[e.Query=2]="Query"}(o||(o={}));var i,c=((r={})[0]=a.DeltaFormattingType.Weight,r[1]=a.DeltaFormattingType.Highlight,r[2]=a.DeltaFormattingType.Hyperlink,r[3]=a.DeltaFormattingType.Italic,r[4]=a.DeltaFormattingType.Strikethrough,r[5]=a.DeltaFormattingType.Underline,r[6]=a.DeltaFormattingType.Color,r[7]=a.DeltaFormattingType.Image,r),s=n(1005),d=function(){function e(){var e=this;this.selectionChangedHandlers=[],this.keypressHandlers=[],this.onHyperlinkClick=function(t){return!!e.hyperlinkNavigator&&e.hyperlinkNavigator(t)},this.onSelectionChangeHandler=function(){e.invokeHandlers(e.selectionChangedHandlers)},this.onKeypressHandler=function(t){e.invokeHandlers(e.keypressHandlers,t)}}return e.prototype.executeCommand=function(e,t,n){var r,o,i,c,s;if(!this.richContentEditorActor)return 1;if(0===t)return this.isRootCommandEnabled(e)?2:0;if(this.isRootCommandEnabled(e)){if(2===t&&n){var d=this.richContentEditorActor.getFormattingAtCurrentSelection();switch(e){case 0:n.bold=d.bold;break;case 3:n.italic=d.italic;break;case 5:n.underline=d.underline;break;case 4:n.strikethrough=d.strikethrough;break;case 1:n.highlight=d.highlight;break;case 6:n.fontColor=d.fontColor}return 2}var u=void 0,l=void 0;switch(e){case 0:u={type:a.DeltaFormattingType.Weight};break;case 3:u={type:a.DeltaFormattingType.Italic};break;case 5:u={type:a.DeltaFormattingType.Underline};break;case 4:u={type:a.DeltaFormattingType.Strikethrough};break;case 2:if(null===(r=null==n?void 0:n.hyperlinkData)||void 0===r?void 0:r.link){var f=null===(o=null==n?void 0:n.hyperlinkData)||void 0===o?void 0:o.link,m=null!==(c=null===(i=null==n?void 0:n.hyperlinkData)||void 0===i?void 0:i.text)&&void 0!==c?c:f;l={type:a.DeltaFormattingType.Hyperlink,data:{text:m,link:f}}}break;case 7:(null===(s=null==n?void 0:n.imageData)||void 0===s?void 0:s.base64)&&(l={type:a.DeltaFormattingType.Image,data:{src:n.imageData.base64}});break;case 1:(null==n?void 0:n.highlight)&&(u={type:a.DeltaFormattingType.Highlight,data:{color:n.highlight.color}});break;case 6:(null==n?void 0:n.fontColor)&&(u={type:a.DeltaFormattingType.Color,data:{fontColor:n.fontColor.color}})}return u&&this.richContentEditorActor.applyFormattingToCurrentSelection(u),l&&this.richContentEditorActor.addContent(l),2}return 0},e.prototype.getSelection=function(){return this.richContentEditorActor?{text:this.richContentEditorActor.getSelection().text}:{text:""}},e.prototype.initRichContentEditor=function(e){Object(s.k)().assertConditionTag(!this.richContentEditorActor,"[initRichContentEditor] RichContentEditor already set",590141192),this.richContentEditorActor=e,this.richContentEditorActor.registerSelectionChangeHandler(this.onSelectionChangeHandler),this.richContentEditorActor.registerKeypressHandler(this.onKeypressHandler)},e.prototype.registerSelectionChangeHandler=function(e){e&&this.selectionChangedHandlers.push(e)},e.prototype.registerKeypressHandler=function(e){e&&this.keypressHandlers.push(e)},e.prototype.registerSafelinksNavigator=function(e){e&&(this.hyperlinkNavigator=e)},e.prototype.setFocus=function(){this.richContentEditorActor&&this.richContentEditorActor.setFocus()},e.prototype.isRootCommandEnabled=function(e){return!!this.richContentEditorActor&&this.richContentEditorActor.isFormatEnabled(c[e])},e.prototype.invokeHandlers=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(e)for(var r=0;r<e.length;r++)e[r].apply(e,t)},e}();function u(){return void 0===i&&(i=new d),i}function l(){i=void 0}new(function(){function e(){}return e.prototype.getRichContentEditAPI=function(){return u()},e}())},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="Default_7210d794-9f0f-4d0a-805c-964303b2676b"},function(e,t,n){"use strict";n.d(t,"K",(function(){return V})),n.d(t,"D",(function(){return _})),n.d(t,"G",(function(){return H})),n.d(t,"A",(function(){return G})),n.d(t,"E",(function(){return q})),n.d(t,"C",(function(){return z})),n.d(t,"J",(function(){return W})),n.d(t,"z",(function(){return Y})),n.d(t,"k",(function(){return K})),n.d(t,"h",(function(){return X})),n.d(t,"I",(function(){return Q})),n.d(t,"F",(function(){return J})),n.d(t,"a",(function(){return Z})),n.d(t,"b",(function(){return $})),n.d(t,"i",(function(){return ee})),n.d(t,"n",(function(){return te})),n.d(t,"j",(function(){return ne})),n.d(t,"f",(function(){return re})),n.d(t,"g",(function(){return oe})),n.d(t,"e",(function(){return ae})),n.d(t,"c",(function(){return ie})),n.d(t,"l",(function(){return ce})),n.d(t,"m",(function(){return se})),n.d(t,"d",(function(){return de})),n.d(t,"o",(function(){return ue})),n.d(t,"t",(function(){return le})),n.d(t,"q",(function(){return fe})),n.d(t,"x",(function(){return me})),n.d(t,"u",(function(){return pe})),n.d(t,"y",(function(){return he})),n.d(t,"r",(function(){return ve})),n.d(t,"s",(function(){return ge})),n.d(t,"p",(function(){return ye})),n.d(t,"B",(function(){return be})),n.d(t,"H",(function(){return Ce})),n.d(t,"w",(function(){return Te})),n.d(t,"v",(function(){return Ie}));var r=n(1004),o=n(1005),a=n(1205),i=n(1072),c=n(1047),s=n(1048),d=n(1031),u=n(1022),l=n(1063),f=n(1065),m=n(1021),p=n(1016),h=n(1006);function v(e,t,n,r,a){if(!h.X()){var i=Object(o.k)().createActivityObject("SelectionAttemptWhileDrafting",n,Object(o.j)());i.addDataField("Trackback",r,o.d.SystemMetadata),i.addDataField("RenderContextType",a,o.d.SystemMetadata),i.addDataField("SelectionAttemptType",e,o.d.SystemMetadata),i.addDataField("IsDraftInCurrentContext",t.isInCurrentContext,o.d.SystemMetadata),i.successTag(590206682)}}var g,y=n(1020),b=n(1023),C=n(1191),T=n(1190),I=n(1014),S=n(1026),O=n(1032),w=n(1058),j=n(1052);!function(e){e[e.NoDialog=0]="NoDialog",e[e.AbandonDraft=1]="AbandonDraft",e[e.ResumeDrafting=2]="ResumeDrafting"}(g||(g={}));var E=g,k=n(1066),P=n(1099),x=n(1012),A=n(1126),D=n(1183),R=n(1189),F=n(1132),N=n(1192),M=n(1037),L=n(1033),B=n(1035);function V(e){var t=e.comment,n=e.threads,r=e.selectedComment,o=e.warningType,a=!t.parentId,i=!!(t.commentFlags&c.a.LowFidelity);if(!r)return!(!a||o!==O.a.DeleteThread||!i&&!B.j(n,t.commentId))||h.n()&&i&&a;var s=i||a&&(o===O.a.DeleteReply||o===O.a.DeleteThread)&&B.j(n,t.commentId),d=Object(O.j)(r.selectionDetails)?r.selectionDetails.selectedPostId:r.selectedCardId;return!(!s||d===t.commentId&&r.selectionDetails.lowFidelityWarningType===o)}function U(e){var t=e.result,n=e.localizationAPI;t===T.a.Success&&Object(a.a)(n.getString(67))}function _(e){var t=e.trackback,n=e.id,i=e.data,c=e.selectedComment,s=e.renderContextType,d=e.actionDispatchers,u=e.telemetryVisitor,l=e.localizationAPI,f=B.b(i,n);f?V({comment:f,threads:i,selectedComment:c,warningType:O.a.DeleteReply})?d.showLowFidelityWarning({renderContextType:s,telemetryVisitor:u,trackback:r.d.reserveTag(593826118)},n,O.a.DeleteReply):(Object(a.a)(l.getString(65)),d.requestDeleteComment({renderContextType:s,telemetryVisitor:u,trackback:t},n)):Object(o.k)().assertConditionTag(!1,"Comment not found",593826117)}function H(e){var t=e.trackback,n=e.id,r=e.data,a=e.renderContextType,i=e.actionDispatchers,c=e.telemetryVisitor,s=B.b(r,n);s?i.showPostErrorUI({renderContextType:a,telemetryVisitor:c,trackback:t},s.commentId):Object(o.k)().assertConditionTag(!1,"Comment not found",593875075)}function G(e){var t=e.trackback,n=e.id,r=e.data,a=e.renderContextType,i=e.actionDispatchers,c=e.telemetryVisitor,s=B.b(r,n);s?i.clearPostErrorUI({renderContextType:a,telemetryVisitor:c,trackback:t},s.commentId):Object(o.k)().assertConditionTag(!1,"Comment not found",593875076)}function q(e){var t=e.trackback,n=e.id,a=e.data,i=e.selectedComment,c=e.renderContextType,s=e.actionDispatchers,d=e.telemetryVisitor,u=B.b(a,n);u?V({comment:u,threads:a,selectedComment:i,warningType:O.a.Edit})?s.showLowFidelityWarning({renderContextType:c,telemetryVisitor:d,trackback:r.d.reserveTag(593826120)},n,O.a.Edit):s.requestEditCommentSession({renderContextType:c,telemetryVisitor:d,trackback:t},n,u.parentId||u.commentId):Object(o.k)().assertConditionTag(!1,"Comment not found",593826119)}function z(e){var t=e.trackback,n=e.id,a=e.data,i=e.draftState,c=e.contentPromise,s=e.atMentionsEnabled,u=e.componentTree,l=e.actionDispatchers,f=e.telemetryVisitor,h=e.localizationAPI,v=e.commitSource;if(Object(S.i)(i))return Promise.resolve();if(!i.postIdToDraftIdMap[n])return Object(o.k)().assertConditionTag(!1,"Post draft to commit not found",588853381),Promise.reject(new p.a("Post draft to commit not found",r.d.reserveTag(587850403),-2130957492));var g=B.b(a,n);return g?l.commitCommentAndFocus({renderContextType:u.componentTreeId.renderContextType,telemetryVisitor:f,trackback:t},(function(){return c}),{commentId:n,type:"EDIT",previousCommentBody:g.commentBody},s,u,Object(d.b)(g),v).then((function(e){U({result:e,localizationAPI:h})})).catch(Object(m.a)(r.d.reserveTag(593826122))):(Object(o.k)().assertConditionTag(!1,"Comment not found in model",593826121),Promise.reject(new p.a("Comment not found in model",r.d.reserveTag(587850432),2130957505)))}function W(e){var t=e.trackback,n=e.renderableItem,o=e.selectedComment,a=e.cardCollapsedState,i=e.dispatchProps,c=e.telemetryVisitor,s=e.componentTree,d=e.draftState_deprecated,u=e.shouldFocusAfter,l=B.i(n),f=B.e(n);return i.discardDraftIfEmpty({renderContextType:s.componentTreeId.renderContextType,telemetryVisitor:c,trackback:r.d.reserveTag(593237586)},b.a.SharedComments,void 0).then((function(e){if(h.X()||e.draftDiscardBehavior!==k.a.CannotAutoDiscard||o&&Object(O.j)(o.selectionDetails)&&o.selectionDetails.selectedPostId===f){var n=a===w.a.Collapsed;i.selectComment(s,{renderContextType:s.componentTreeId.renderContextType,telemetryVisitor:c,trackback:t},Object(C.a)(l,b.a.SharedComments,n?{selectType:y.SelectActionType.ExpandCard}:{selectType:y.SelectActionType.SelectPost,selectedPost:f}),u||n).catch(Object(m.a)(r.d.reserveTag(590104649)))}else{var p=Object(I.K)(d);p&&v(2,p,c,r.d.reserveTag(590206683),s.componentTreeId.renderContextType)}}),Object(m.a)(r.d.reserveTag(593032901)))}function Y(e){var t=e.trackback,n=e.commentId,i=e.setContents,c=e.data,d=e.draftState,u=e.shouldClosePaneAfterDiscardDraft,l=e.onWillDiscardCallback,f=e.renderContextType,p=e.dispatchProps,h=e.telemetryVisitor,v=e.localizationAPI,g=B.b(c,n);d.postIdToDraftIdMap[n]&&g?(Object(a.a)(v.getString(66)),p.discardDraftAsync({renderContextType:f,telemetryVisitor:h,trackback:t},b.a.SharedComments,u,l).then((function(e){e===s.a.Handled&&g&&i&&i(g.commentBody)})).catch(Object(m.a)(r.d.reserveTag(593826127)))):Object(o.k)().assertConditionTag(!1,"Cannot find comment post to cancel",593826126)}function K(e){var t=e.cardProps,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentCardMounted(n,t)}))}function X(e){var t=e.cardId,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentCardEditorMounted(n,t)}))}function Q(e){var t=e.postId,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentPostMounted(n,t)}))}function J(e){var t=e.postId,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentPostEditorMounted(n,t)}))}function Z(e){var t=e.trackback,n=e.threadId,r=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;o.requestReplyCommentSession({renderContextType:r,telemetryVisitor:a,trackback:t},n)}function $(e){var t=e.trackback,n=e.commentCardRef,r=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;o.collapseCard({renderContextType:r,telemetryVisitor:a,trackback:t},n.getId())}function ee(e){var t=e.trackback,n=e.commentCardRef,o=e.dispatchProps,a=e.telemetryVisitor,i=e.componentTree,c=e.options,s=e.focusManager,d=e.isDraftThread,u={componentType:Object(A.b)(d),id:n.getId(),renderContextType:i.componentTreeId.renderContextType};s.postOnComponentFocusedRequest(u,(function(){f.a&&Object(r.i)("Handling card focus with polite selection on ".concat(n.getId())),i.isFocusOnOrWithin(u)&&te({trackback:t,commentCardRef:n,dispatchProps:o,telemetryVisitor:a,componentTree:i,options:c})}))}function te(e){var t,n=e.trackback,o=e.commentCardRef,a=e.dispatchProps,i=e.telemetryVisitor,c=e.componentTree,s=e.options,d=!1,u=s.selectActionType;switch(u){case y.SelectActionType.ExpandCard:var l=s,f=l.selectRootPost&&(h.X()||!l.relativeDraftingState);d=l.shouldFocusAfter,t=f?{selectType:y.SelectActionType.SelectPost,selectedPost:o.getId()}:{selectType:y.SelectActionType.ExpandCard};break;case y.SelectActionType.SelectCard:case y.SelectActionType.Polite:t={selectType:u};break;default:Object(r.m)(u)}var p=Object(C.a)(o.getId(),b.a.SharedComments,t);s.selectActionType===y.SelectActionType.ExpandCard&&a.discardDraftIfEmpty({renderContextType:c.componentTreeId.renderContextType,telemetryVisitor:i,trackback:r.d.reserveTag(571281760)},b.a.SharedComments,void 0).then((function(e){if(!h.X()&&e.draftDiscardBehavior===k.a.CannotAutoDiscard&&s.relativeDraftingState===j.a.InOtherCard){var t=Object(I.K)(s.draftState);t&&v(1,t,i,r.d.reserveTag(571281761),c.componentTreeId.renderContextType)}})).catch(Object(m.a)(r.d.reserveTag(571281762))),a.selectComment(c,{renderContextType:c.componentTreeId.renderContextType,telemetryVisitor:i,trackback:n},p,d).catch(Object(m.a)(r.d.reserveTag(571340118)))}function ne(e){var t=e.trackback,n=e.commentCardRef,r=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;e.shouldHighlightCard?o.highlightComment({renderContextType:r,telemetryVisitor:a,trackback:t},n.getId()):o.clearCommentHighlight({renderContextType:r,telemetryVisitor:a,trackback:t},n.getId())}function re(e){var t=e.trackback,n=e.focusManager,a=e.componentTree,i=e.cardId,c=e.isCardLie,s=e.newHeight,d=e.renderContextType,u=e.selectedComment,f=e.dispatchProps,p=e.telemetryVisitor;if(d===x.a.HalfPane){if(void 0===s)return Object(o.k)().assertConditionTag(!1,"Height should not be undefined in half-pane mode",593826129);c&&u&&u.selectedCardId===i&&f.requestDisplayConfiguration({renderContextType:d,telemetryVisitor:p,trackback:t},{displayMode:l.a.Variable,desiredHeight:s}).then((function(){n.focusCommentPaneCommand(a)})).catch(Object(m.a)(r.d.reserveTag(593826130)))}}function oe(e){var t=e.trackback,n=e.id,r=e.draftState,o=e.renderContextType,a=e.dispatchProps,c=e.telemetryVisitor;if("android"===Object(M.a)()){var s=r.drafts[r.cardIdToDraftIdMap[n]];s&&s.isDraftEmpty&&s.commentDraft.sessionConfiguration.sessionType===i.f&&a.discardDraftAsync({renderContextType:o,telemetryVisitor:c,trackback:t},b.a.SharedComments,!1)}}function ae(e){var t,n=e.trackback,c=e.showDiscardDialog,d=e.invokeModalDialog,u=e.componentTree,l=e.dispatchProps,f=e.closeOnDiscard,p=e.cardId,h=e.draftState,v=e.telemetryVisitor,g=e.localizationAPI,y=e.focusManager,C=e.lieIndex,T=h.cardIdToDraftIdMap[p];if(T){var I=void 0;c&&(I=Object(F.a)(h,u,d));var S=(null===(t=h.drafts[T])||void 0===t?void 0:t.commentDraft.sessionConfiguration.sessionType)===i.f,O=function(e){var t=e.componentTree,n=e.focusManager,r=e.lieIndex,o=e.cardId,a=e.isReplyDraft,i=e.discardCallback;return function(e,c){if(i){return i((function(){return n.onUserAction(t,{userAction:D.a.CancelNewThreadDraft,threadIndex:r}),e?e():s.a.Unhandled}),c)}return e?(a?n.onUserAction(t,{userAction:D.a.CancelReplyDraft,cardId:o}):n.onUserAction(t,{userAction:D.a.CancelNewThreadDraft,threadIndex:r}),Promise.resolve(e())):Promise.resolve(s.a.Unhandled)}}({componentTree:u,focusManager:y,lieIndex:C,cardId:p,isReplyDraft:S,discardCallback:I});Object(a.a)(g.getString(S?64:103)),l.discardDraftAsync({renderContextType:u.componentTreeId.renderContextType,telemetryVisitor:v,trackback:n},b.a.SharedComments,f,O).then((function(e){e===s.a.Handled&&(S?y.onUserAction(u,{userAction:D.a.CancelReplyDraft,cardId:p}):y.onUserAction(u,{userAction:D.a.CancelNewThreadDraft,threadIndex:C}))}),Object(m.a)(r.d.reserveTag(592840735)))}else Object(o.k)().assertConditionTag(!1,"Card draft to cancel not found",588853382)}function ie(e){var t=e.trackback,n=e.commentCardRef,a=e.draftState,i=e.areMentionsEnabled,c=e.session,s=e.componentTree,d=e.dispatchProps,u=e.telemetryVisitor,l=e.localizationAPI,f=e.commitSource;if(Object(S.i)(a))return Promise.resolve();var h=n.getId();return a.cardIdToDraftIdMap[h]?d.commitCommentAndFocus({trackback:t,telemetryVisitor:u,renderContextType:s.componentTreeId.renderContextType},n.getContentsAsync,c,i,s,h,f).then((function(e){U({result:e,localizationAPI:l})})).catch(Object(m.a)(r.d.reserveTag(593826134))):(Object(o.k)().assertConditionTag(!1,"Card draft to commit not found",588853383),Promise.reject(new p.a("Card draft to commit not found",r.d.reserveTag(587850433),-2130957492)))}function ce(e){var t=e.trackback,n=e.id,r=e.renderContextType,o=e.dispatchProps,i=e.telemetryVisitor,c=e.localizationAPI,s=e.isTask;Object(a.a)(c.getString(125)),o.requestReopenThread({renderContextType:r,telemetryVisitor:i,trackback:t},n,s)}function se(e){var t=e.componentTree,n=e.focusManager,r=e.trackback,o=e.id,i=e.renderContextType,c=e.dispatchProps,s=e.telemetryVisitor,d=e.localizationAPI,u=e.isTask;Object(a.a)(d.getString(124)),n.onUserAction(t,{userAction:D.a.ResolveThread,cardId:o}),c.requestResolveThread({renderContextType:i,telemetryVisitor:s,trackback:r},o,u)}function de(e){var t=e.trackback,n=e.id,i=e.data,c=e.selectedComment,d=e.componentTree,u=e.invokeModalDialog,l=e.dispatchProps,f=e.telemetryVisitor,p=e.localizationAPI,h=e.focusManager,v=e.isTask,g=e.threadIndex;if(e.shouldCheckForLowFidelity){var y=B.b(i,n);if(!y)return void Object(o.k)().assertConditionTag(!1,"Comment not found",593605342);if(V({comment:y,threads:i,selectedComment:c,warningType:O.a.DeleteThread}))return void l.selectCommentCardAndShowLowFidelityWarning({renderContextType:d.componentTreeId.renderContextType,telemetryVisitor:f,trackback:r.d.reserveTag(593605343)},y.commentId,O.a.DeleteThread)}if(d.componentTreeId.renderContextType===x.a.HalfPane&&u){u(P.a.DeleteThread,(function(){return function(e){var t=e.dispatchProps,n=e.componentTree,a=e.selectedComment,i=e.telemetryVisitor;if(a)return t.requestDeleteThread({renderContextType:n.componentTreeId.renderContextType,telemetryVisitor:i,trackback:r.d.reserveTag(592840775)},a.selectedCardId),s.a.Handled;return Object(o.k)().assertConditionTag(!1,"Selected Comment should not be undefined for DeleteThread",592840776),s.a.Unhandled}({dispatchProps:l,componentTree:d,selectedComment:c,telemetryVisitor:f})}),(function(){return s.a.Canceled})).then((function(e){e===s.a.Handled&&h.onUserAction(d,{userAction:D.a.DeleteThread,threadIndex:g})})).catch(Object(m.a)(r.d.reserveTag(595632546)))}else Object(a.a)(p.getString(63)),h.onUserAction(d,{userAction:D.a.DeleteThread,threadIndex:g}),Object(L.a)(d.componentTreeId.renderContextType)?setTimeout((function(){l.requestDeleteThread({renderContextType:d.componentTreeId.renderContextType,telemetryVisitor:f,trackback:t},n,v)}),100):l.requestDeleteThread({renderContextType:d.componentTreeId.renderContextType,telemetryVisitor:f,trackback:t},n,v)}function ue(e){se({componentTree:e.componentTree,focusManager:e.focusManager,trackback:e.trackback,id:e.id,renderContextType:e.renderContextType,dispatchProps:e.dispatchProps,telemetryVisitor:e.telemetryVisitor,localizationAPI:e.localizationAPI,isTask:!0})}function le(e){var t=e.failTag,n=e.successTag,r=e.person,a=e.dispatchProps,i=e.telemetryVisitor,c=e.renderContextType,s=e.trackback,d=Object(o.k)().createActivityObject("CheckUserAccess",i,Object(o.j)()),l={UserId:Object(u.h)(r),Provider:R.b,DisplayName:Object(u.g)(r),Email:Object(u.h)(r)};a.checkUserAccess(l).then((function(e){var t;d.addDataField("UserCanWrite",e.UserCanWrite,o.d.SystemMetadata),d.addDataField("UserCanReview",null!==(t=null==e?void 0:e.UserCanReview)&&void 0!==t&&t,o.d.SystemMetadata),d.successTag(n)}),(function(e){d.failTag(t,-2130957562)})),a.addToCurrentMentionees({telemetryVisitor:i,trackback:s,renderContextType:c},r)}function fe(e){var t=e.trackback,n=e.contentId,r=e.isEmpty,o=e.renderContextType,a=e.draftIdMap,i=e.actionDispatchers,c=e.telemetryVisitor,s=a[n];s&&i.draftEmptinessChanged({renderContextType:o,telemetryVisitor:c,trackback:t},s,r)}function me(e){var t=e.trackback,n=e.id,o=e.editor,a=e.renderContextType,i=e.draftIdMap,c=e.draftMap,s=e.actionDispatchers,d=e.telemetryVisitor,u=i[n];if(u){var l=c[u];Object(r.n)(l,"Draft should be defined if draftId exists!",r.d.reserveTag(587850434)),l.pendingState===S.a.None&&s.saveDraft({renderContextType:a,telemetryVisitor:d,trackback:t},u,{editorContent:o.getContentsAsync(),editorCursorPosition:o.getCursorPositionAsync()})}}function pe(e){var t=e.trackback,n=e.emailsStillInDraft,r=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;o.updateMentioneesStillInDraft({renderContextType:r,telemetryVisitor:a,trackback:t},n)}function he(e){var t=e.trackback,n=e.renderContextType,r=e.dispatchProps,o=e.telemetryVisitor,a=e.selectedAssignee;r.updateSelectedTaskAssignee({renderContextType:n,telemetryVisitor:o,trackback:t},a)}function ve(e){var t=e.selectedState,n=e.renderContextType,a=e.dispatchProps,i=e.telemetryVisitor;t&&Object(O.h)(t)?a.clearLowFidelityWarning({renderContextType:n,telemetryVisitor:i,trackback:r.d.reserveTag(573612046)}):Object(o.k)().assertConditionTag(!1,"onLowFidelityWarningCancel called unexpectedly",593846658)}function ge(e){var t=e.selectedState,n=e.onCardDelete,r=e.onPostDelete,a=e.onPostEdit;if(t)if(!Object(O.j)(t.selectionDetails)||Object(O.d)(t)){if(Object(O.e)(t))return void n(i=t.selectedCardId);if(Object(O.f)(t))return void Object(o.k)().assertConditionTag(!1,"Unexpected LowFidelityWarningOnEdit with card selection",593846662)}else{var i=t.selectionDetails.selectedPostId;if(Object(O.c)(t))return void r(i);if(Object(O.f)(t))return void a(i)}else Object(o.k)().assertConditionTag(!1,"onLowFidelityWarningConfirm called unexpectedly",593846661)}function ye(e){var t=e.ownProps,n=e.dispatchProps,a=e.componentTree,i=e.draftState,c=e.invokeModalDialog;if(a.componentTreeId.renderContextType!==x.a.HalfPane&&Object(S.b)(i)&&!h.r()){n.discardDraftAsync({renderContextType:a.componentTreeId.renderContextType,telemetryVisitor:t.telemetryVisitor,trackback:r.d.reserveTag(592840770)},b.a.SharedComments,!0,Object(F.a)(i,a,c,P.a.ClosePaneDraft)).then((function(e){e===s.a.Canceled?Object(N.b)():e===s.a.Unhandled&&Object(o.k)().assertConditionTag(e!==s.a.Unhandled,"Unhandled request to discard on close pane",592840769)})).catch(Object(m.a)(r.d.reserveTag(592840771)))}else!function(e){var t=e.dispatchProps,n=e.componentTree,a=e.telemetryVisitor,i=Object(o.k)().createActivityObject("ClosePane",a,Object(o.j)());i.addDataField("PaneCloseResult",E.NoDialog,o.d.SystemMetadata),i.successTag(592840773),t.requestClosePane({renderContextType:n.componentTreeId.renderContextType,telemetryVisitor:a,trackback:r.d.reserveTag(592840774)})}({dispatchProps:n,componentTree:a,telemetryVisitor:t.telemetryVisitor})}function be(e,t,n,r,o){n.collapseCard({renderContextType:o.componentTreeId.renderContextType,telemetryVisitor:r,trackback:e},B.i(t))}function Ce(e,t,n,r){if(!Object(S.d)(r)||h.X()||"win32"===Object(M.a)()){var o=B.i(e);n.focusCommentCardCommand(t,o)}}function Te(e,t,n,r,o,a,i){o.requestUpdateCommentReactions({renderContextType:r,telemetryVisitor:a,trackback:e},t,i,n)}function Ie(e,t,n,r,o){r.requestPresentLinkToComment({renderContextType:n,telemetryVisitor:o,trackback:e},t)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return l}));var r=n(1004),o=n(1005),a=n(1016),i=n(1036),c=function(){function e(e){this.localizationDetails=e}return e.prototype.isMac=function(){return window&&window.navigator&&window.navigator.userAgent.indexOf("Macintosh")>0},e.prototype.getLocaleInfo=function(){return{isRightToLeft:this.localizationDetails.isRightToLeft||!1,uiCulture:this.localizationDetails.uiCulture||"en-us",dataCulture:this.localizationDetails.dataCulture||"en-us"}},e.prototype.getString=function(e){var t=this.getStringOrUndefined(e);if(void 0===t)throw new a.a(i.j,r.d.reserveTag(589103688),-2130957554);return t},e.prototype.getStringOrUndefined=function(e){switch(e){case 1:return CommentPaneStrings.EditButtonText;case 2:return CommentPaneStrings.DeleteButtonText;case 120:return CommentPaneStrings.ContextMenuEditButtonText;case 121:return CommentPaneStrings.ContextMenuDeleteButtonText;case 3:return CommentPaneStrings.ResolveThreadButtonText;case 4:return CommentPaneStrings.ReopenThreadButtonText;case 5:return CommentPaneStrings.DeleteThreadButtonText;case 6:return CommentPaneStrings.GoToFirstCommentGhostCardText;case 7:return CommentPaneStrings.GoToNextCommentGhostCardText;case 8:return CommentPaneStrings.ReturnToFirstCommentGhostCardText;case 9:return CommentPaneStrings.View1MoreReplyExpandButtonText;case 10:return CommentPaneStrings.ViewNMoreRepliesExpandButtonText;case 106:return CommentPaneStrings.OneMoreReplyExpandButtonText;case 107:return CommentPaneStrings.NMoreRepliesExpandButtonText;case 11:return CommentPaneStrings.ReplyBoxPlaceholderText;case 12:return CommentPaneStrings.ReplyBoxPlaceholderTextNoMentions;case 13:return CommentPaneStrings.EmptyPaneMessage;case 14:return CommentPaneStrings.SaveButtonText;case 15:return CommentPaneStrings.CancelButtonText;case 16:return CommentPaneStrings.NewThreadPlaceholderText;case 17:return CommentPaneStrings.NewThreadPlaceholderTextNoMentions;case 21:return CommentPaneStrings.NormalPostA11yLabel;case 145:return CommentPaneStrings.NewNormalPostA11yLabel;case 122:return CommentPaneStrings.NormalPostBodyA11yLabel;case 22:return CommentPaneStrings.ResolvedPostA11yLabel;case 136:return CommentPaneStrings.NewResolvedPostA11yLabel;case 23:return CommentPaneStrings.EditingPostA11yLabel;case 25:return CommentPaneStrings.ReadOnlyPostA11yLabel;case 137:return CommentPaneStrings.NewReadOnlyPostA11yLabel;case 26:return CommentPaneStrings.LowFidelityWarningPostA11yLabel;case 27:return CommentPaneStrings.NormalCardA11yLabel;case 29:return CommentPaneStrings.ResolvedCardA11yLabel;case 30:return CommentPaneStrings.ReadOnlyCardA11yLabel;case 28:return CommentPaneStrings.DraftCardA11yLabel;case 31:return CommentPaneStrings.PaneA11yLabel;case 32:return CommentPaneStrings.ListA11yLabel;case 18:return CommentPaneStrings.PaneHeaderLabel;case 19:return CommentPaneStrings.CloseButtonTitle;case 20:return CommentPaneStrings.ClosePaneA11yLabel;case 35:return CommentPaneStrings.LowFidelityWarningOnEdit;case 36:return CommentPaneStrings.LowFidelityWarningOnDelete;case 37:return CommentPaneStrings.ProceedButtonText;case 39:return CommentPaneStrings.PostCancelEditA11yLabel;case 40:return CommentPaneStrings.PostEditA11yLabel;case 41:return CommentPaneStrings.PostDeleteA11yLabel;case 42:return CommentPaneStrings.PostProceedEditA11yLabel;case 43:return CommentPaneStrings.PostCancelDeleteA11yLabel;case 45:return CommentPaneStrings.CardContextMenuA11yLabel;case 123:return CommentPaneStrings.PostContextMenuA11yLabel;case 46:return CommentPaneStrings.CardCancelDraftA11yLabel;case 47:return CommentPaneStrings.PostCancelDraftA11yLabel;case 48:return CommentPaneStrings.SendButtonText;case 55:return this.isMac()?CommentPaneStrings.ReplyBoxA11yDescription_Mac:CommentPaneStrings.ReplyBoxA11yDescription;case 56:return CommentPaneStrings.EditorBoxA11yDescription;case 57:return CommentPaneStrings.PeoplePickerSearching;case 58:return CommentPaneStrings.PeoplePickerTypeToSearch;case 59:return CommentPaneStrings.PeoplePickerSearchDirectory;case 60:return CommentPaneStrings.PeoplePickerTopNResults;case 61:return CommentPaneStrings.PeoplePickerNoResultsFound;case 62:return CommentPaneStrings.PeoplePickerSuggestedContactsHeader;case 73:return CommentPaneStrings.PeoplePickerLoading;case 63:return CommentPaneStrings.DeleteCommentThreadA11yUpdate;case 64:return CommentPaneStrings.CancelledReplyA11yUpdate;case 103:return CommentPaneStrings.CancelledCommentDraftA11yUpdate;case 65:return CommentPaneStrings.DeletedCommentPostA11yUpdate;case 66:return CommentPaneStrings.CancelledEditingA11yUpdate;case 67:return CommentPaneStrings.CommentPostedA11yUpdate;case 124:return CommentPaneStrings.ResolveCommentThreadA11yUpdate;case 125:return CommentPaneStrings.ReopenCommentThreadA11yUpdate;case 68:return CommentPaneStrings.DiscardDialogTitle;case 69:return CommentPaneStrings.DiscardDialogBody;case 70:return CommentPaneStrings.DiscardDialogAbandon;case 71:return CommentPaneStrings.DiscardDialogResume;case 88:return CommentPaneStrings.EditCommentEditorA11yLabel;case 89:return CommentPaneStrings.ReplyCommentEditorA11yLabel;case 91:return CommentPaneStrings.NewCommentButtonText;case 92:return CommentPaneStrings.NewCommentButtonA11yLabel;case 108:return CommentPaneStrings.ReplyBoxDisabledPlaceholderText;case 230:return CommentPaneStrings.FocusMovedToUnpostedDraftA11yUpdate;case 110:return this.isMac()?CommentPaneStrings.PostDraftWarningText_Mac:CommentPaneStrings.PostDraftWarningText;case 111:return CommentPaneStrings.TaskHeaderAssignedToText;case 112:return CommentPaneStrings.TaskFooterAssignText;case 113:return CommentPaneStrings.TaskFooterReassignText;case 114:return CommentPaneStrings.TaskItemAssignedToText;case 115:return CommentPaneStrings.TaskItemReassignedToText;case 116:return CommentPaneStrings.TaskItemCompletedText;case 117:return CommentPaneStrings.TaskItemReopenedText;case 118:return CommentPaneStrings.TaskItemScheduleText;case 119:return CommentPaneStrings.TaskItemUnknownText;case 184:return CommentPaneStrings.RetryButtonText;case 183:return CommentPaneStrings.ContentErrorMessage;case 126:return CommentPaneStrings.ResolveTaskButtonText;case 127:return CommentPaneStrings.TaskHeaderAssignedToYouText;case 128:return CommentPaneStrings.TaskAssignerPeoplePickerA11yLabel;case 129:return CommentPaneStrings.TaskHeaderCheckboxA11yLabel;case 130:return CommentPaneStrings.TaskHeaderResolvedCheckboxA11yLabel;case 131:return CommentPaneStrings.TaskHeaderAssignedToYouCheckboxA11yLabel;case 132:return CommentPaneStrings.TaskHeaderAssignedToYouResolvedCheckboxA11yLabel;case 133:return CommentPaneStrings.TaskHeaderUnassigned;case 134:return CommentPaneStrings.FailedToCommitMentionText;case 234:return CommentPaneStrings.FailedToCommitMentionShareCanceledText;case 135:return CommentPaneStrings.CommitErrorMessage;case 165:return CommentPaneStrings.NormalCardTaskToYouA11yLabel;case 166:return CommentPaneStrings.ReadOnlyCardTaskToYouA11yLabel;case 167:return CommentPaneStrings.ResolvedCardResolvedTaskToYouA11yLabel;case 168:return CommentPaneStrings.CardResolvedTaskToYouA11yLabel;case 160:return CommentPaneStrings.NormalCardTaskA11yLabel;case 161:return CommentPaneStrings.ReadOnlyCardTaskA11yLabel;case 163:return CommentPaneStrings.ResolvedCardResolvedTaskA11yLabel;case 164:return CommentPaneStrings.CardResolvedTaskA11yLabel;case 169:return CommentPaneStrings.NormalCardTaskUnassignedA11yLabel;case 170:return CommentPaneStrings.ReadOnlyCardTaskUnassignedA11yLabel;case 171:return CommentPaneStrings.ResolvedCardResolvedTaskUnassignedA11yLabel;case 172:return CommentPaneStrings.CardResolvedTaskUnassignedA11yLabel;case 173:return this.isMac()?CommentPaneStrings.PostCommentTooltip_Mac:CommentPaneStrings.PostCommentTooltip;case 174:return this.isMac()?CommentPaneStrings.SendButtonTooltip_Mac:CommentPaneStrings.SendButtonTooltip;case 175:return CommentPaneStrings.CancelButtonTooltip;case 176:return CommentPaneStrings.ReopenTaskTooltip;case 177:return CommentPaneStrings.NewCommentButtonTooltip;case 178:return CommentPaneStrings.CommitButtonAssignTooltip;case 179:return CommentPaneStrings.ReplyButtonReassignTooltip;case 180:return CommentPaneStrings.TaskAssignedToYouTooltip;case 181:return CommentPaneStrings.TaskUnassignedTooltip;case 182:return CommentPaneStrings.TaskAssignerChevronTooltip;case 203:return CommentPaneStrings.SmartReplyPickerHeader;case 204:return CommentPaneStrings.TaskUnassignedHistoryString;case 202:return CommentPaneStrings.TaskHeaderResolved;case 197:return CommentPaneStrings.ResolvedCommentCardLabel;case 206:return CommentPaneStrings.DeleteTaskButtonText;case 207:return CommentPaneStrings.LinkToCommentButtonText;case 227:return CommentPaneStrings.PeoplePickerSuggestionSelectedA11yUpdate;case 229:return CommentPaneStrings.TruncationUIReadMoreText;case 231:return CommentPaneStrings.CommentLikeA11yLabel;case 232:return CommentPaneStrings.TaskHistoryItemA11yLabelDesktop;case 223:return CommentPaneStrings.DraftCardA11yLabelDesktop;case 225:return CommentPaneStrings.LoadingCardA11yLabelDesktop;case 216:return CommentPaneStrings.CardA11yLabelDesktopUnassignedTask;case 217:return CommentPaneStrings.CardA11yLabelDesktopUnassignedCompletedTask;case 219:return CommentPaneStrings.CardA11yLabelDesktopOneReplyModifier;case 221:return CommentPaneStrings.CardA11yLabelDesktopLoadingModifier;case 222:return CommentPaneStrings.CardA11yLabelDesktopDraftModifier;case 226:return CommentPaneStrings.A11yLabelSubstringDelimiterDesktop;case 224:return CommentPaneStrings.DraftCardA11yLabelDesktopHintText;case 209:return CommentPaneStrings.NewPostA11yLabelDesktop;case 208:return CommentPaneStrings.PostA11yLabelDesktop;case 210:return CommentPaneStrings.PendingPostA11yLabelDesktop;case 214:return CommentPaneStrings.CardA11yLabelDesktopAssignedTask;case 215:return CommentPaneStrings.CardA11yLabelDesktopAssignedCompletedTask;case 211:return CommentPaneStrings.CardA11yLabelDesktopBaseThread;case 212:return CommentPaneStrings.CardA11yLabelDesktopBaseThreadWithTask;case 213:return CommentPaneStrings.CardA11yLabelDesktopBaseThreadResolved;case 218:return CommentPaneStrings.CardA11yLabelDesktopAnchorHintModifier;case 220:return CommentPaneStrings.CardA11yLabelDesktopMultipleRepliesModifier;case 239:return CommentPaneStrings.CommentLikePluralA11yLabel;case 240:return CommentPaneStrings.CommentLikeDescriptionA11yLabel;case 233:return this.isMac()?CommentPaneStrings.CtrlEnterHint_Mac:CommentPaneStrings.CtrlEnterHint;case 241:return CommentPaneStrings.AtMentionsInfoCommentNotificationUber;case 242:return CommentPaneStrings.AtMentionsInfoCommentMentionsTwoPeopleModifier;case 243:return CommentPaneStrings.AtMentionsInfoCommentMentionsThreePeopleModifier;case 244:return CommentPaneStrings.AtMentionsInfoCommentMentionsMoreThanThreePeopleModifier;case 245:return CommentPaneStrings.FilterShowAllResolutions;case 246:return CommentPaneStrings.FilterShowResolvedOnly;case 247:return CommentPaneStrings.FilterShowActiveOnly;case 248:return CommentPaneStrings.FilterNewestFirst;case 249:return CommentPaneStrings.FilterAtMentionsToMe;case 250:return CommentPaneStrings.TaskHeaderAssignedToYouAndOthersText;case 251:return CommentPaneStrings.TaskHeaderAssignedToMultipleText;case 252:return CommentPaneStrings.TaskItemUnassignedFromText;case 256:return CommentPaneStrings.FilterItemCount;case 257:return CommentPaneStrings.FilterItemCountPlural;case 258:return CommentPaneStrings.FilterOldestFirst;case 260:return CommentPaneStrings.FilterSortBy;case 261:return CommentPaneStrings.FilterFilterBy;case 259:return CommentPaneStrings.FilterCollaborators;case 262:return CommentPaneStrings.FilterResetAll;case 254:return CommentPaneStrings.FilterButtonAccessibilityLabel;case 255:return CommentPaneStrings.FilterMenuAccessibilityLabel;case 265:return CommentPaneStrings.NewCardA11yLabelDesktopBaseThread;case 266:return CommentPaneStrings.NewCardA11yLabelDesktopBaseThreadWithTask;default:return}},e.prototype.getStringWithStandardPlaceholders=function(e){return this.getString(e)},e.prototype.getStringWithStandardPlaceholdersOrUndefined=function(e){return this.getStringOrUndefined(e)},e.prototype.formatString=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.toFormattedString(this.getString(e),t)},e.prototype.toFormattedString=function(e,t){for(var n="",r=0;;){var a=e.indexOf("{",r),i=e.indexOf("}",r);if(a<0&&i<0){n+=e.slice(r);break}if(i>0&&(i<a||a<0))n+=e.slice(r,i+1),r=i+2;else if(n+=e.slice(r,a),r=a+1,"{"!==e.charAt(r)){if(i<0)break;var c=e.substring(r,i),s=c.indexOf(":"),d=t[parseInt(s<0?c:c.substring(0,s),10)];null==d&&(Object(o.k)().assertConditionTag(!1,"Incorrect substitution provided to string",562937946),d=""),n+=d,r=i+1}else n+="{",r++}return n},e}(),s=void 0;function d(){if(!s)throw new a.a(i.g,r.d.reserveTag(589103748),-2130957552);return s}function u(e){return Object(o.k)().assertConditionTag(void 0===s,"LocalizationAPI has already been initialized",589103749),void 0===s&&(s=new c(e)),s}function l(){s=void 0}},,,,function(e,t,n){var r=n(1428),o=n(1433);e.exports=n(1111)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){var r=n(1095),o=n(1094),a=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(1436)?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var r=n(1228);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={LivePersonaPicker:{webSettingName:"LivePersonaPicker",dependencies:[]},PersonaFeature:{webSettingName:"PersonaColor",dependencies:[]},NewCommentButton:{webSettingName:"NewCommentButton",dependencies:[]},DiscreteHostedComments:{webSettingName:"DiscreteHostedComments",dependencies:["NewDraftingUI"]},CommentsFluentUI:{webSettingName:"CommentsFluentUI",dependencies:[]},RenderDHCInPane:{dependencies:[]},CommentTasks:{webSettingName:"CommentTasks",dependencies:["CommentsFluentUI"]},NewDraftingUI:{webSettingName:"DiscreteHostedComments",dependencies:[]},TaskPaneWithNewInfrastructure:{webSettingName:"TaskPaneWithNewInfrastructure",dependencies:[]},CommentTasksFromReply:{webSettingName:"CommentTasksFromReply",dependencies:["CommentTasks"]},HeadlessBoot:{dependencies:[]},HyperlinksInComments:{webSettingName:"HyperlinksInComments",dependencies:[]},HyperlinksWithDisplayText:{webSettingName:"HyperlinksWithDisplayText",dependencies:[]},ContentNavigation:{webSettingName:"ContentNavigation",dependencies:[]},AtMentionFloodgateSurvey:{webSettingName:"AtMentionFloodgateSurvey",dependencies:[]},ExtendedDrafting:{webSettingName:"ExtendedDrafting",dependencies:["NewDraftingUI"]},RichTextFormattingInWeb:{webSettingName:"RichTextFormattingInWeb",dependencies:[]},SmartReplies:{webSettingName:"SmartReplies",dependencies:[]},LogDraftCommentIdPair:{webSettingName:"LogDraftCommentIdPair",dependencies:[]},RichContentEditIntegrationInWeb:{webSettingName:"RichContentEditIntegration",dependencies:[]},NewSelectionInteractions:{webSettingName:"NewSelectionInteractions",dependencies:[]},CommentReactions:{webSettingName:"CommentReactions",dependencies:[]},LinkToComment:{webSettingName:"LinkToComment",dependencies:[]},WebThemeIntegration:{webSettingName:"WebThemeIntegration",dependencies:[]},TruncationUIWithReadMoreText:{webSettingName:"TruncationUIWithReadMoreText",dependencies:[]},QuickEdit:{dependencies:[]},CtrlEnterTip:{webSettingName:"CtrlEnterTip",dependencies:["CommentsFluentUI"]},FluentSVRefreshWin32:{dependencies:[]},HighlightsAndFontColorInWebComments:{webSettingName:"HighlightsAndFontColorInWebComments",dependencies:["RichContentEditIntegrationInWeb"]},DiagnosticHeartbeat:{dependencies:[]},TaskHistoryRecordIDs:{webSettingName:"TaskHistoryRecordIDs",dependencies:[]},AtMentionHintMessage:{webSettingName:"AtMentionHintMessage",dependencies:[]},LivePersonaCardForWeb:{webSettingName:"LivePersonaCardForWeb",dependencies:[]},MapBasedStore:{webSettingName:"MapBasedStore",dependencies:[]},ContentFiltering:{dependencies:[]},CommentTasksMultiAssignCreation:{webSettingName:"CommentTasksMultiAssignCreation",dependencies:["CommentTasks","CommentTasksFromReply"]},DraftSessionRehydration:{webSettingName:"DraftSessionRehydration",dependencies:[]},ConsumerEmailLPPEnabled:{webSettingName:"ConsumerEmailLPPEnabled",dependencies:[]}}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Indeterminate=1]="Indeterminate",e[e.SinglePortrait=2]="SinglePortrait",e[e.DoublePortrait=3]="DoublePortrait",e[e.SingleLandscape=4]="SingleLandscape",e[e.DoubleLandscape=5]="DoubleLandscape"}(r||(r={}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(r||(r={}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Undo=-1]="Undo",e[e.Unknown=0]="Unknown",e[e.Create=1]="Create",e[e.Assign=2]="Assign",e[e.Unassign=3]="Unassign",e[e.UnassignAll=4]="UnassignAll",e[e.Schedule=5]="Schedule",e[e.Progress=6]="Progress",e[e.Delete=7]="Delete",e[e.Restore=8]="Restore",e[e.SetTitle=9]="SetTitle",e[e.Priority=10]="Priority"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e,t){return Object(r.b)("ADD_CONTENT_EXTENSION",{extension:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e,t,n){return Object(r.b)("BEGIN_DRAFTING_FAILURE",{beginDraftingParams:t,errorInfo:n},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e,t,n,o){return Object(r.b)("BEGIN_DRAFTING_SUCCESS",{draftDetails:t,draftRenderContextType:n,rehydratedDraftParams:o},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e){return Object(r.b)("BEGIN_PROCESSING_COMMIT",{},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e){return Object(r.b)("BEGIN_PROCESSING_DISCARD",{},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e){return Object(r.b)("BEGIN_VIEW_INIT",{},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e){return Object(r.b)("CANCEL_DISCARD",{},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e,t,n){return Object(r.b)("CLEAR_COMMENT_HIGHLIGHT",{actionSource:t,commentId:n},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e){return Object(r.b)("CLEAR_COMMENT_SELECTION",{},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(1009);function o(e,t){return Object(r.b)("COMMIT_DRAFT",t,e)}function a(e){switch(e.sessionType){case"CREATE":return"Create";case"REPLY":return"Reply";case"EDIT":return"Edit"}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e,t){return Object(r.b)("COMMIT_FAILURE",{commitText:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e){return Object(r.b)("END_VIEW_INIT",{},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e,t,n){return Object(r.b)("HIGHLIGHT_COMMENT",{commentId:t,actionSource:n},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e,t,n){return Object(r.b)("LOAD_COMMENT",{commentData:t,tasks:n},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e,t){return Object(r.b)("LOAD_PERSONA_ICON_PROPERTIES",{personaIconPropertiesMap:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e,t){return Object(r.b)("VIRTUALIZE_COMMENTS",{threadInfo:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e,t){return Object(r.b)("RELOAD_COMMENTS",t,e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e,t){return Object(r.b)("RESOLVE_ATMENTION_CAPABILITY",{capability:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e,t){return Object(r.b)("SAVE_DRAFT",t,e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e,t,n){return Object(r.b)("SESSION_REQUEST_STARTED",{params:t,captureSelectedThreadIdBeforeSession:n},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e,t,n){return Object(r.b)("SHOW_LOW_FIDELITY_WARNING",{commentId:t,lowFidelityWarningType:n},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e,t){return Object(r.b)("TOP_VISIBLE_THREAD_CHANGED",{threadId:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e,t){return Object(r.b)("UPDATE_CONTEXT_DETAILS",{contextState:t},e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1009);function o(e,t){return Object(r.b)("UPDATE_SUGGESTIONS_DETAILS",{details:t},e)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}));var r=n(1261),o=n(1025),a=n(1046),i=function(){function e(e,t,n){this.threadIds=e,this.commentData=t,this.pointer=0,this.pointer=Math.max(-1,Math.min(n,e.length))}return e.prototype.next=function(){var e=this.pointer,t=this.threadIds.length-1;if(this.pointer<t)do{++this.pointer}while(this.pointer<=t&&Object(r.a)(Object(o.b)(this.commentData,this.threadIds[this.pointer])));return this.pointer<t||this.pointer===t&&e<t?{done:!1,value:this.threadIds[this.pointer]}:{done:!0,value:void 0}},e.prototype.previous=function(){var e=this.pointer;if(this.pointer>0)do{--this.pointer}while(this.pointer>=0&&Object(r.a)(Object(o.b)(this.commentData,this.threadIds[this.pointer])));return this.pointer>0||0===this.pointer&&e>0?{done:!1,value:this.threadIds[this.pointer]}:{done:!0,value:void 0}},e.prototype.currentIndex=function(){return this.pointer},e}(),c=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.model=e,this.startThreadIndex=t,this.pointer=0,this.ignoreResolvedThreads=!1,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t,this.ignoreResolvedThreads=n}return e.prototype.next=function(){var e=this.pointer;if(this.pointer<this.model.length-1)do{++this.pointer}while(this.pointer<this.model.length&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&a.f.Resolved));return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&e<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e=this.pointer;if(this.pointer>0)do{--this.pointer}while(this.pointer>=0&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&a.f.Resolved));return this.pointer>0||0===this.pointer&&e>0?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}()},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=!1;function o(){r=!0}function a(){return r}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r,o=n(307),a=n(1004),i=n(1021),c=n(1006),s=function(){function e(){}return e.prototype.getItem=function(e){return Object(c.s)()?sessionStorage.getItem(e):null},e.prototype.setItem=function(e,t){Object(c.s)()&&sessionStorage.setItem(e,t)},e.prototype.removeItem=function(e){Object(c.s)()&&e&&sessionStorage.removeItem(e)},e.prototype.storeEditorContentFromDraftSave=function(e,t){if(Object(c.s)()){var n=e.draftContent.editorContent,r=e.draftContent.editorCursorPosition;Promise.all([n,r]).then((function(n){var r=Object(o.f)(n,2),a={draftContent:{content:r[0],cursorPosition:r[1]},draftingParams:t};sessionStorage.setItem(e.draftId,JSON.stringify(a))})).catch(Object(i.a)(a.d.reserveTag(523362974)))}},e}();function d(){return r||(r=new s)}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NoCommand=0]="NoCommand",e[e.ComponentNotFound=1]="ComponentNotFound",e[e.ShouldRetry=2]="ShouldRetry",e[e.Handled=3]="Handled"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(1102);function o(e){return e.type===r.a.DispatchAction&&void 0!==e.action}function a(e,t){return{type:r.a.DispatchAction,action:t,causedBy:e,priorityArgs:{priority:1}}}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.CancelNewThreadDraft=1]="CancelNewThreadDraft",e[e.DeleteThread=2]="DeleteThread",e[e.RequestNewCommentFromHost=3]="RequestNewCommentFromHost",e[e.CancelReplyDraft=4]="CancelReplyDraft",e[e.ResolveThread=5]="ResolveThread"}(r||(r={}))},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return"object"===r(e)&&void 0!==e.message&&void 0!==e.SDXHostAPIErrorCode}n.d(t,"a",(function(){return o}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1006),o=n(1014),a=n(1052);function i(e,t,n){var i=Object(o.K)(n);if(i)return i.threadId!==e?a.a.InOtherCard:r.r()&&i.renderContextType!==t?a.a.InOtherContextOfThisCard:"EDIT"===i.commentDraft.sessionConfiguration.sessionType?a.a.InChildPost:a.a.InCard}},function(e,t,n){"use strict";n.d(t,"d",(function(){return g})),n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return b})),n.d(t,"a",(function(){return C}));var r,o=n(307),a=n(1004),i=n(1553),c=n(1005),s=n(1028),d=n(1178),u=n(1031),l=n(1006),f=n(1014),m=n(1026),p=n(1025),h=n(1052),v=n(1012);function g(e,t,n){var r;if(Object(p.f)(t))return t.find((function(t){var r;return t===e||(null===(r=n[t])||void 0===r?void 0:r.alternateId)===e}));for(var o,a=new d.a(t,-1);!(o=a.next()).done;){var i=o.value.commentId,c=n[i];if((null==c?void 0:c.alternateId)===e||i===e)break}return null===(r=o.value)||void 0===r?void 0:r.commentId}function y(e,t,n){var r=Object(p.b)(t,e);return r?Object(f.z)(t,n,Object(u.b)(r)):[]}function b(e,t,n,s,d,m,p){var h,v;if(!l.W()){if(d&&p===e)return{thread:[d.newComment_deprecated],isDraftThread:!0,draftThreadState:m};Object(c.k)().assertConditionTag(!m||!m.isInCurrentContext||"CREATE"!==m.commentDraft.sessionConfiguration.sessionType,"Bad Store State, missing lie for new draft requested.",579372370)}var g=s||e,y=Object(f.z)(t,n,g);y.length>0&&void 0===Object(u.a)(y[0])&&(null===(v=(h=Object(c.k)()).logDiagnosticTrace)||void 0===v||v.call(h,Object(i.a)(r||(r=Object(o.e)(["Possible comment corruption. Could indicate comment persistence issue or intermediate change state."],["Possible comment corruption. Could indicate comment persistence issue or intermediate change state."]))),a.d.reserveTag(540575834),c.h.Info,c.c.ProductServiceUsage,Object(c.l)(c.g.ReviewedAsNotNecessary)),y=[]);var b=l.W()&&p===g;return{thread:y,isDraftThread:b,draftThreadState:b?m:void 0}}function C(e,t,n,r,o){if(t.draftThreadState)return t.draftThreadState.renderContextType===v.a.None||t.draftThreadState.renderContextType===r?s.a.Enabled_ForcePrimary:s.a.Disabled;if(t.isDraftThread||t.thread.length>0)return o===h.a.InCard||o===h.a.InChildPost?s.a.Enabled_ForcePrimary:s.a.Enabled_Default;if(Object(m.k)(n))return s.a.Disabled;var a=Object(f.K)(n);return a&&a.threadId===e?s.a.Disabled:s.a.Invalid}},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(1004),o=n(1005),a=n(1048),i=n(1066),c=n(1014),s=n(1026),d=n(1080),u=n(1013),l=n(1009),f=n(1122),m=n(1188);function p(e,t,n){return function(p,h){var v=h(),g=u.h(v),y=Object(o.k)().createActivityObject("DiscardDraftIfEmpty",e.telemetryVisitor,Object(o.j)()),b=Object(s.i)(g);y.addDataField("Trackback",e.trackback,o.d.SystemMetadata),y.addDataField("RenderContextType",e.renderContextType,o.d.SystemMetadata),y.addDataField("CommitPendingAttemptedCancel",b,o.d.SystemMetadata),y.addDataField("ActionSource",t,o.d.SystemMetadata);var C=Object(c.n)(g);return y.addDataField("DraftDiscardBehavior",C,o.d.SystemMetadata),C===i.a.CanAutoDiscard?p(Object(m.a)(e,t,!1)).then((function(e){return y.successTag(539754957),{draftDiscardResult:e,draftDiscardBehavior:C}})):(void 0!==n&&C===i.a.CannotAutoDiscard&&(y.addDataField("DraftWarningReason",n,o.d.SystemMetadata),p(Object(f.a)({draftWarningType:d.a.ReturnToDraft,draftWarningReason:n},Object(l.a)(e,r.d.reserveTag(591728722))))),y.successTag(539754958),Promise.resolve({draftDiscardResult:a.a.Canceled,draftDiscardBehavior:C}))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(1004),o=n(1005),a=n(1020),i=n(1042),c=n(1048),s=n(1026),d=n(1032),u=n(1013),l=n(1009),f=n(1158),m=n(1160);function p(e,t,n,p){return function(h,v){var g=v(),y=Object(o.k)().createActivityObject("DiscardDraftAsync",e.telemetryVisitor,Object(o.j)()),b=u.h(g),C=u.t(g),T=Object(s.i)(b);y.addDataField("Trackback",e.trackback,o.d.SystemMetadata),y.addDataField("RenderContextType",e.renderContextType,o.d.SystemMetadata),y.addDataField("CommitPendingAttemptedCancel",T,o.d.SystemMetadata),y.addDataField("ActionSource",t,o.d.SystemMetadata);var I=function(e,t,n){var c=u.v(e),s=u.t(e);if(!c)return s&&Object(d.j)(s.selectionDetails)&&Object(d.h)(s)?{cancelAction:a.cancelCommentPostEdit(Object(l.a)(n,r.d.reserveTag(593278744)),s.selectionDetails.selectedPostId,t),sessionType:i.b}:-2130957522;var f=c.commentDraft.sessionConfiguration.sessionType;switch(c.commentDraft.sessionConfiguration.sessionType){case"CREATE":return{cancelAction:a.cancelCommentCreateThread(Object(l.a)(n,r.d.reserveTag(593278745)),t),sessionType:f};case"REPLY":return{cancelAction:a.cancelCommentReply(Object(l.a)(n,r.d.reserveTag(593278746)),c.commentDraft.sessionConfiguration.threadId,t),sessionType:f};case"EDIT":return{cancelAction:a.cancelCommentPostEdit(Object(l.a)(n,r.d.reserveTag(593278747)),c.commentDraft.sessionConfiguration.commentId,t),sessionType:f};default:return Object(o.k)().assertConditionTag(!1,"Unexpected draft type",593278748),-2130957551}}(g,n,e);if("number"==typeof I)return y.failTag(r.d.reserveTag(593278749),I),Promise.resolve(c.a.Handled);var S=I.sessionType,O=I.cancelAction;return y.addDataField("ActiveSessionType",S,o.d.SystemMetadata),T||!Object(s.b)(b)&&!Object(d.g)(C)?(y.addDataField("DiscardUnnecessary",!0,o.d.SystemMetadata),y.successTag(593278755),Promise.resolve(c.a.Unhandled)):(y.addDataField("DiscardUnnecessary",!1,o.d.SystemMetadata),h(Object(f.a)(Object(l.a)(e,r.d.reserveTag(593278750)))),p?p((function(){return h(O),y.addDataField("CancelledByUser",!1,o.d.SystemMetadata),y.successTag(593278751),c.a.Handled}),(function(){return y.addDataField("CancelledByUser",!0,o.d.SystemMetadata),y.successTag(593278752),h(Object(m.a)(Object(l.a)(e,r.d.reserveTag(593278753)))),c.a.Canceled})):(h(O),y.successTag(593278754),Promise.resolve(c.a.Handled)))}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var r="O365",o="@"},function(e,t,n){"use strict";var r;!function(e){e[e.Success=0]="Success",e[e.CommitPending=1]="CommitPending",e[e.ShareFailed=2]="ShareFailed",e[e.CommitFailed=3]="CommitFailed"}(r||(r={})),t.a=r},function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return p}));var r=n(307),o=n(1004),a=n(1005),i=n(1126),c=n(1059),s=n(1065),d=n(1032),u=n(1013),l=n(1009),f=n(1050);function m(e,t,n,r){return function(m,p){m(Object(l.b)("SELECT_COMMENT",n,t));var h=p(),v=Object(u.t)(h);return r&&v&&v.selectedCardId===n.selectedCard&&(n.selectType!==f.a.SelectPost||Object(d.j)(v.selectionDetails)&&v.selectionDetails.selectedPostId===n.selectedPost)?e?new Promise((function(n){return setTimeout((function(){var r;if(Object(d.j)(v.selectionDetails))r={componentType:c.a.Post,id:v.selectionDetails.selectedPostId,renderContextType:t.renderContextType};else{var l=Object(u.h)(h).drafts[v.selectedCardId],f=!!l&&"CREATE"===l.commentDraft.sessionConfiguration.sessionType;r={componentType:Object(i.b)(f),id:v.selectedCardId,renderContextType:t.renderContextType}}var m=e.getComponentById(r);m?(s.a&&Object(o.i)("Focusing comment ".concat(r.id," with render context type ").concat(r.renderContextType," after selection.")),m.focus()):Object(a.k)().assertConditionTag(!1,"Couldn't find focus target after select: ".concat(JSON.stringify(r)),590104655),n()}))})):(Object(a.k)().assertConditionTag(!1,"Expected componentTree to be set",579744148),Promise.resolve()):Promise.resolve()}}function p(e,t,n){return Object(r.a)({selectedCard:e,source:t},n)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(1015);function o(){var e=document.getElementById(r.z());e&&e.focus()}function a(e){if(e&&e.target){var t=e.target.closest(".ql-editor");null!==t&&"true"===t.contentEditable||e.preventDefault()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaFormattingType=void 0,function(e){e[e.None=0]="None",e[e.Text=1]="Text",e[e.Image=2]="Image",e[e.Table=4]="Table",e[e.Weight=8]="Weight",e[e.Underline=16]="Underline",e[e.Strikethrough=32]="Strikethrough",e[e.Italic=64]="Italic",e[e.Mention=128]="Mention",e[e.Hyperlink=256]="Hyperlink",e[e.Color=512]="Color",e[e.Highlight=1024]="Highlight",e[e.FontSize=2048]="FontSize",e[e.FontFamily=4096]="FontFamily",e[e.AltText=8192]="AltText",e[e.Optional=16384]="Optional",e[e.Paragraph=32768]="Paragraph",e[e.Language=65536]="Language",e[e.SubscriptAndSuperscript=131072]="SubscriptAndSuperscript",e[e.BadMentionFormat=134217728]="BadMentionFormat",e[e.UnknownAttribute=268435456]="UnknownAttribute",e[e.Unsupported=536870912]="Unsupported",e[e.Unknown=1073741824]="Unknown",e[e.TextAndMentions=129]="TextAndMentions",e[e.TextAndParagraph=32769]="TextAndParagraph",e[e.AllFormatting=262143]="AllFormatting",e[e.InvalidFormatting=2013265920]="InvalidFormatting"}(t.DeltaFormattingType||(t.DeltaFormattingType={}))},,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return r.b})),n.d(t,"d",(function(){return r.n})),n.d(t,"a",(function(){return o.b})),n.d(t,"c",(function(){return a.a}));n(1098);var r=n(1043),o=n(1031),a=n(1118);n(1153)},function(e,t,n){"use strict";n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return l}));var r=n(1291),o=n(1004),a=function(){function e(e){if(!e)throw new o.c("Missing required arguments in FeatureGateAPIImpl!",o.d.reserveTag(589103760));this.appSettings=e.appSettings,this.gateMapping=e.mapping}return e.prototype.isTrue=function(e){return!!this.appSettings[e]&&"true"===this.appSettings[e]},e.prototype.isFeatureEnabled=function(e){if(!this.appSettings||!this.gateMapping)throw new o.c("FeatureGate API not initialized!",o.d.reserveTag(589103761));var t=this.gateMapping[e].webSettingName;return!!t&&this.isTrue(t)},e.prototype.isChangeGateEnabled=function(e,t){if(!this.appSettings||!this.gateMapping)throw new o.c("FeatureGate API not initialized!",o.d.reserveTag(589103762));var n=this.disabledChangeGates;return!n||n.split(",").indexOf(e)<0},Object.defineProperty(e.prototype,"disabledChangeGates",{get:function(){return this.appSettings.DisabledChangeGates},enumerable:!1,configurable:!0}),e}(),i=new r.a("FeatureGate",a);function c(e){return e}function s(e){return i.getAndInitialize(e)}function d(){i.reset()}function u(){return i.getInstanceOrThrow()}function l(){return void 0!==i.getInstance()}},function(e,t,n){"use strict";n.d(t,"b",(function(){return Q})),n.d(t,"a",(function(){return J}));var r=n(307),o=n(1004),a=n(1021),i=n(1006),c=n(1020),s=n(1023),d=n(1129),u=n(1005),l=n(1042),f=n(1070),m=n(1051),p=n(1014),h=n(1013);var v,g=n(1553),y=n(1054),b=n(1079),C=n(1118),T=n(1058),I=n(1084),S=n(1131),O=n(1266),w=n(1016),j=n(1184),E=n(1190),k=n(1026),P=n(1124),x=n(1080),A=n(1069),D=n(1157),R=n(1164),F=n(1122);function N(e,t,n,a,s,d){return function(f,m){var w,j,N=Object(u.k)().createActivityObject("CommitComment",e.telemetryVisitor,Object(u.j)());N.addDocumentMetadata(u.f.Basic);var B=b.b[s.type],V=m(),U=A.b(V),_=h.v(V);if(void 0===_||_.commentDraft.sessionConfiguration.sessionType!==s.type)return N.failTag(593278784,-2130957522),Promise.resolve(E.a.CommitFailed);var H="",G=!1;switch(s.type){case l.b:H=s.commentId;break;case l.d:H=s.parentId,G=!0;break;case l.a:_&&(H=_.commentDraft.sessionConfiguration.draftId||"")}var q=h.j(V),z=!G||Object(I.a)(H,q,e.renderContextType)===T.a.Expanded;N.addDataField("IsCardExpanded",z,u.d.SystemMetadata);var W=function(e,t){var n;if(!t||Object(C.b)(t.commentDraft.sessionConfiguration)||!i.c())return;var r=void 0,o=i.m()?Object(S.b)(null!==(n=null==e?void 0:e.currentState.assignees)&&void 0!==n?n:[],t.selectedTaskAssignees):void 0;if(o)r={Task:{type:"Task",assigneeUpdate:o}};else{var a=t.selectedTaskAssignee;r=a?{Task:{type:"Task",assignee:a}}:void 0}return r}(U[H],_);if((null==W?void 0:W.Task)&&!Object(p.c)(V.commentState.modelCapabilities)&&(Object(u.k)().assertConditionTag(!1,"Unexpected task assignment when Task Capability is disabled'",590435658),W.Task=void 0),(i.c()&&s.type===l.a||i.d()&&s.type===l.d)&&(N.addDataField("IsPreExistingTask",!!U[H],u.d.SystemMetadata,u.e.Critical),N.addDataField("AffectingTaskMetadata",!!(null==W?void 0:W.Task),u.d.SystemMetadata,u.e.Critical)),N.addDataField("SessionType",B,u.d.SystemMetadata),s.type!==l.a){var Y=Object(p.h)(h.d(V),H);Y.valid&&(N.addDataField("MatchesCommentAuthor",Y.matchesCurrentUser,u.d.SystemMetadata),N.addDataField("ThreadCreationDeltaMs",Y.timeElapsed,u.d.SystemMetadata))}N.addDataField("AtMentionsEnabled",n,u.d.SystemMetadata),N.addDataField("Trackback",e.trackback,u.d.SystemMetadata),N.addDataField("RenderContextType",e.renderContextType,u.d.SystemMetadata),N.addDataField("CommitSource",d,u.d.SystemMetadata);var K=h.h(V);return Object(k.i)(K)?(null===(j=(w=Object(u.k)()).logDiagnosticTrace)||void 0===j||j.call(w,Object(g.a)(v||(v=Object(r.e)(["NoCommitDueToCommitPending"],["NoCommitDueToCommitPending"]))),o.d.reserveTag(556827598),u.h.Info,u.c.ProductServiceUsage,e.telemetryVisitor),Promise.resolve(E.a.CommitPending)):(f(Object(D.a)(c.chainActionDetails(e,o.d.reserveTag(593278785)))),a().then((function(r){if(!n){var a=L(f,s,r,0,N,o.d.reserveTag(593278786),o.d.reserveTag(593278787),e,W);return Promise.resolve(a)}var c=new O.a(r),d=c.Mentions,l=Object(u.k)();if(i.k()&&d.length>0&&l.logFloodgateActivity&&l.logFloodgateActivity("Office_Docs_SharedComments_CommitComment"),N.addDataField("CreateCommentWithRichFormatting",c.HasRichTextFormatting,u.d.SystemMetadata),!d.length){a=L(f,s,r,0,N,o.d.reserveTag(593278788),o.d.reserveTag(593278789),e,W);return Promise.resolve(a)}return t.grantUsersAccess(d).then((function(t){var n=function(e){var t=e.OperationResult;return"boolean"==typeof t?t:t===y.a.Success}(t),a=function(e){return!!e.Details&&e.Details.Canceled}(t);if(N.addDataField("AllUsersGrantedAccess",n,u.d.SystemMetadata),N.addDataField("ShareDialogCanceled",a,u.d.SystemMetadata),t.OperationResult===y.a.FailedSilently)return Object(o.i)("Check Access Phase failed - share dialog not shown"),N.failTag(593278790,-2130957561),M(f,r,x.a.GrantAccessFailedSilently,o.d.reserveTag(593278791),o.d.reserveTag(593278792),e),Promise.resolve(E.a.ShareFailed);if(a)return Object(o.i)("Share dialog was canceled by user"),N.successTag(593278793),M(f,r,x.a.GrantAccessCanceled,o.d.reserveTag(593278794),o.d.reserveTag(554801174),e),Promise.resolve(E.a.ShareFailed);if(!n)return Object(o.i)("Not all users have been granted access - going back to initial state"),N.successTag(593278795),M(f,r,x.a.GrantAccessCanceled,o.d.reserveTag(593278796),o.d.reserveTag(554784648),e),Promise.resolve(E.a.ShareFailed);var i=L(f,s,r,d.length,N,o.d.reserveTag(593278797),o.d.reserveTag(593278798),e,W);return Promise.resolve(i)}),(function(t){return N.failTag(593278799,-2130957561),Object(o.i)("Grant Users Access has failed",Object(o.l)(t)),M(f,r,x.a.GrantAccessFailedSilently,o.d.reserveTag(593278800),o.d.reserveTag(554784393),e),Promise.resolve(E.a.ShareFailed)}))}),(function(t){return N.failTag(593278801,-2130957539),f(Object(R.a)(c.chainActionDetails(e,o.d.reserveTag(593278802)),void 0)),Object(o.i)("getCommentBody failed",Object(o.l)(t)),i.F()&&f(Object(F.a)({draftWarningReason:P.a.CommitFailure,draftWarningType:x.a.CommitFailed},c.chainActionDetails(e,o.d.reserveTag(593278803)))),Promise.resolve(E.a.CommitFailed)})))}}function M(e,t,n,r,o,a){e(Object(R.a)(c.chainActionDetails(a,r),t)),e(Object(F.a)({draftWarningType:n,draftWarningReason:P.a.GrantUsersAccessFailure},c.chainActionDetails(a,o)))}function L(e,t,n,r,a,s,d,m,p){var h=function(e,t,n,r,a){try{switch(t.type){case"CREATE":e(c.commitDraft(c.chainActionDetails(r,o.d.reserveTag(593278804)),{sessionType:t.type,data:{commentBody:n},metadataUpdates:a}));break;case"EDIT":e(c.commitDraft(c.chainActionDetails(r,o.d.reserveTag(593278805)),{sessionType:t.type,data:{commentBody:n,commentId:t.commentId}}));break;case"REPLY":e(c.commitDraft(c.chainActionDetails(r,o.d.reserveTag(593278806)),{sessionType:t.type,data:{commentBody:n,parentId:t.parentId},metadataUpdates:a}));break;default:return Object(u.k)().assertConditionTag(!1,"Unexpected session type '".concat(t.type,"'"),593278807),e(Object(R.a)(c.chainActionDetails(r,o.d.reserveTag(593278808)),n)),-2130957532}}catch(t){if(!Object(w.b)(t)&&!Object(j.a)(t))throw t;return e(Object(R.a)(c.chainActionDetails(r,o.d.reserveTag(593278809)),n)),i.F()&&e(Object(F.a)({draftWarningReason:P.a.CommitFailure,draftWarningType:x.a.CommitFailed},c.chainActionDetails(r,o.d.reserveTag(593278810)))),Object(f.a)(t)}return}(e,t,n,m,p);return h?(a.failTag(d,h),E.a.CommitFailed):r?(t.type===l.a?(a.addDataField("CreateThreadWithMentions",!0,u.d.SystemMetadata,u.e.Critical),p&&p.Task&&a.addDataField("CreateThreadWithTaskAssigned",!0,u.d.SystemMetadata,u.e.Critical)):t.type===l.d&&(a.addDataField("CreateReplyWithMentions",!0,u.d.SystemMetadata,u.e.Critical),p&&p.Task&&a.addDataField("CreateReplyWithTaskAssigned",!0,u.d.SystemMetadata,u.e.Critical)),a.successTag(s),E.a.Success):(a.successTag(s),E.a.Success)}var B=n(1187),V=n(1188),U=n(1063),_=n(1115),H=n(1012),G=n(1159),q=n(1165),z=n(1209);var W=n(1050),Y=n(1174);var K=n(1191);function X(e,t){return{requestDeleteComment:function(t,n){e(c.requestDeletePost(t,n))},requestDeleteThread:function(t,n,r){e(c.requestDeleteThread(t,n,r))},requestReopenThread:function(t,n,r){e(c.requestReopenThread(t,n,r))},requestResolveThread:function(t,n,r){e(c.requestThreadResolve(t,n,r))},requestEditCommentSession:function(n,r,c){e(Object(d.a)(n,t.commentAPI,{sessionType:"EDIT",commentId:r,rootCommentId:Object(i.s)()?c:void 0},!1,t.peopleAPI)).catch(Object(a.a)(o.d.reserveTag(574362624)))},requestReplyCommentSession:function(n,r){e(Object(d.a)(n,t.commentAPI,{sessionType:"REPLY",threadId:r},!1,t.peopleAPI)).catch(Object(a.a)(o.d.reserveTag(574362625)))},commitCommentAndFocus:function(n,r,o,a,i,c,s){return e(N(n,t.peopleAPI,a,r,o,s)).then((function(e){return e===E.a.Success&&t.focusManager.focusCommentCardCommand(i,c),e}))},discardDraftAsync:function(t,n,r,o){return e(Object(V.a)(t,n,r,o))},discardDraftIfEmpty:function(t,n,r){return e(Object(B.a)(t,n,r))},showLowFidelityWarning:function(t,n,r){e(c.showLowFidelityWarning(t,n,r))},clearLowFidelityWarning:function(t){e(c.clearLowFidelityWarning(t))},saveDraft:function(t,n,r){e(c.saveDraft(t,{draftId:n,draftContent:r}))},clearCommentHighlight:function(t,n){e(c.clearCommentHighlight(t,s.a.SharedComments,n))},checkUserAccess:function(e){return t.peopleAPI.checkUserAccess(e)},updateMentioneesStillInDraft:function(t,n){e(c.updateMentioneesStillInDraft(t,n))},addToCurrentMentionees:function(t,n){e(c.addToCurrentMentionees(t,n))},updateSelectedTaskAssignee:function(t,n){e(c.updateSelectedTaskAssignee(t,n))},updateSelectedTaskAssignees:function(t,n){e(c.updateSelectedTaskAssignees(t,n))},toggleTaskAssigner:function(t){e(c.toggleTaskAssigner(t))},displayDraftWarning:function(t,n,r){e(c.displayDraftWarning({draftWarningType:n,draftWarningReason:r},t))},showPostErrorUI:function(t,n){e(c.showPostErrorUI(t,n))},clearPostErrorUI:function(t,n){e(c.clearPostErrorUI(t,n))},selectCommentCardAndShowLowFidelityWarning:function(t,n,r){e(function(e,t,n){return function(r,o){var a,i=o();(null===(a=h.t(i))||void 0===a?void 0:a.selectedCardId)!==t&&r(Object(W.b)(e,t,void 0,W.a.ExpandCard,s.a.SharedComments)),r(Object(Y.a)(e,t,n))}}(t,n,r))},draftEmptinessChanged:function(t,n,r){e(c.draftEmptinessChanged(t,r,n))},selectComment:function(t,n,r,o){return e(Object(K.b)(t,n,r,o))},collapseCard:function(t,n){e(c.collapseCard(t,n))},requestUpdateCommentReactions:function(n,r,o,a){e(function(e,t,n,r,o){return function(a,i){var c=Object(u.k)().createActivityObject("CommentReaction",e.telemetryVisitor,Object(u.j)());c.addDataField("UserReactionAction",o,u.d.SystemMetadata);var s=i();if(n.sessionType===l.c){var d=Object(p.h)(h.d(s),n.threadId);d.valid&&(c.addDataField("MatchesCommentAuthor",d.matchesCurrentUser,u.d.SystemMetadata),c.addDataField("ThreadCreationDeltaMs",d.timeElapsed,u.d.SystemMetadata))}Object(m.c)(s,c),t.beginDraftingAsync(n).then((function(e){e.updateProperties("Reaction",{type:"Reaction",reactionType:r,isActive:o}),e.commit(),e.endDrafting(),c.successTag(587317280)})).catch((function(e){c.failTag(587317281,Object(f.a)(e))}))}}(n,t.commentAPI,{sessionType:"METADATA",threadId:r},o,a))},requestPresentLinkToComment:function(t,n){e(c.requestPresentLinkToComment(t,n))},onClickableTextClicked:function(e){var n,r;null===(r=(n=t.commentAPI).onClickableTextClicked)||void 0===r||r.call(n,e)}}}function Q(e,t){return Object(r.a)(Object(r.a)({},X(e,t)),{highlightComment:function(t,n){e(c.highlightComment(t,n,s.a.SharedComments))},discardDraftAndStartNewCommentSession:function(n){e(Object(d.a)(n,t.commentAPI,{sessionType:"CREATE"},!1,t.peopleAPI)).catch(Object(a.a)(o.d.reserveTag(592314377)))},queueLoadThreads:function(t,n){e(c.queueLoadThreads(t,{threadIds:n}))},requestClosePane:function(t){e(c.requestClosePane(t))},requestDisplayConfiguration:function(t,n){return e(Object(z.a)(t,n))},readyToRender:function(t){e(c.readyToRender(t))},requestModalConfirmation:function(t,n,r,o){e(c.requestModalConfirmation(t,n,r,o))},initializeView:function(n){e(function(e,t,n,r,i){return function(c){return c(Object(G.a)({renderContextType:e,trackback:o.d.reserveTag(595899542),telemetryVisitor:i})),t===_.a.NewThread?(e===H.a.HalfPane&&c(Object(z.a)({renderContextType:e,trackback:o.d.reserveTag(595899543),telemetryVisitor:i},{displayMode:U.a.Variable,desiredHeight:0})).catch(Object(a.a)(o.d.reserveTag(595645966))),c(Object(d.a)({renderContextType:e,trackback:o.d.reserveTag(595898586),telemetryVisitor:i},n,{sessionType:"CREATE"},!1,r)).then((function(){c(Object(q.a)({renderContextType:e,trackback:o.d.reserveTag(595899545),telemetryVisitor:i}))}))):c(Object(q.a)({renderContextType:e,trackback:o.d.reserveTag(595899546),telemetryVisitor:i}))}}(n,t.initializationReason,t.commentAPI,t.peopleAPI,t.telemetryVisitor))},updateRenderLocksForAllDrafts:function(t,n){e(c.updateDraftRenderContext(t,n))}})}function J(e,t){return Object(r.a)(Object(r.a)({},X(e,t)),{updateRenderLockForDraft:function(t,n,r){e(c.updateDraftRenderContext(t,n,r))},highlightComment:function(n){e(c.highlightComment(n,t.resource.id,s.a.SharedComments))},requestDisplayConfiguration:function(n,r){return t.componentTree.componentTreeId.renderContextType!==H.a.HalfPane?Promise.resolve(void 0):e(Object(z.a)(n,r))},queueLoadThread:function(n){return e(c.queueLoadThreads(n,{threadIds:[t.resource.id]}))}})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return o.b}));var r=n(1151),o=(n(1113),n(1204))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return o.a}));n(1063);var r=n(1114),o=n(1057)},function(e,t,n){"use strict";n.d(t,"b",(function(){return r.d})),n.d(t,"a",(function(){return r.b}));var r=n(1093);new r.a},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u}));var r,o=n(1),a=n(307);function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!r)throw new Error("[internal error] useHook used outside of makeReactHookGuard!");return r((function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e.apply(void 0,Object(a.h)(Object(a.h)([],n,!1),t,!1))}),t)}function c(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!r)throw new Error("[internal error] useHook used outside of makeReactHookGuard!");return r((function(){return e.apply(void 0,t)}),t)}function s(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(r)throw new Error("Recursive calls of hooks is not supported!");r=e;var o=c.apply(void 0,t);return r=void 0,o}}s(o.useMemo);var d=s(o.useEffect),u=(s(o.useLayoutEffect),function(e){}(o.useCallback),function(e,t,n){return e()&&n?n(t):null})},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(2),o=n(1),a=n(1133),i=n(595),c=n(116);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(){d=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var a=t&&t.prototype instanceof y?t:y,i=Object.create(a.prototype),c=new A(r||[]);return o(i,"_invoke",{value:E(e,n,c)}),i}function m(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=f;var p="suspendedStart",h="executing",v="completed",g={};function y(){}function b(){}function C(){}var T={};l(T,i,(function(){return this}));var I=Object.getPrototypeOf,S=I&&I(I(D([])));S&&S!==n&&r.call(S,i)&&(T=S);var O=C.prototype=y.prototype=Object.create(T);function w(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function j(e,t){function n(o,a,i,c){var d=m(e[o],e,a);if("throw"!==d.type){var u=d.arg,l=u.value;return l&&"object"==s(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(l).then((function(e){u.value=e,i(u)}),(function(e){return n("throw",e,i,c)}))}c(d.arg)}var a;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return a=a?a.then(o,o):o()}})}function E(t,n,r){var o=p;return function(a,i){if(o===h)throw new Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:e,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var s=k(c,r);if(s){if(s===g)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=h;var d=m(t,n,r);if("normal"===d.type){if(o=r.done?v:"suspendedYield",d.arg===g)continue;return{value:d.arg,done:r.done}}"throw"===d.type&&(o=v,r.method="throw",r.arg=d.arg)}}}function k(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var a=m(o,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var i=a.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function D(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(s(t)+" is not iterable")}return b.prototype=C,o(O,"constructor",{value:C,configurable:!0}),o(C,"constructor",{value:b,configurable:!0}),b.displayName=l(C,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,l(e,u,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},w(j.prototype),l(j.prototype,c,(function(){return this})),t.AsyncIterator=j,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new j(f(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(O),l(O,u,"Generator"),l(O,i,(function(){return this})),l(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=D,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(x),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),d=r.call(i,"finallyLoc");if(s&&d){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),x(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;x(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:D(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function u(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){u(a,r,o,i,c,"next",e)}function c(e){u(a,r,o,i,c,"throw",e)}i(void 0)}))}}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],s=!0,d=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){d=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(d)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var p=function(e){var t=Object(c.b)().graphService,n=e.users,s=e.deferred,u=e.strings,m=e.errorMessage,p=e.onClickShare,h=f(o.useState(),2),v=h[0],g=h[1],y=f(o.useState(!1),2),b=y[0],C=y[1],T=function(){return Object(r.mergeStyleSets)({usersList:{paddingTop:12,paddingBottom:20,overflowY:"auto"},footer:{height:33,selectors:{"& > .ms-Dialog-actionsRight":{display:"flex",justifyContent:"flex-end"}}}})}();return o.useEffect((function(){n&&s&&t.getUserPhotos(n.map((function(e){return e.id}))).then((function(e){return g(e)}))}),[n,s]),s&&n?o.createElement(r.Dialog,{maxWidth:560,hidden:!s,onDismiss:function(){C(!1),null==s||s.resolve(a.a.Cancel)},dialogContentProps:{type:r.DialogType.normal,title:u.title},modalProps:{isBlocking:!0}},m&&o.createElement(r.MessageBar,{messageBarType:r.MessageBarType.error},m),o.createElement(r.Text,null,u.text),o.createElement(r.Stack,{tokens:{childrenGap:10,maxHeight:240},className:T.usersList},n.map((function(e){return o.createElement(r.Persona,{key:e.id,text:e.displayName,secondaryText:e.userPrincipalName,showSecondaryText:!0,imageUrl:null==v?void 0:v[e.id],size:r.PersonaSize.size32,hidePersonaDetails:!1})}))),o.createElement(r.DialogFooter,{className:T.footer},o.createElement(i.a,{loading:b,disabled:b,onClick:function(){var e=l(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,C(!0),e.next=4,p();case 4:C(!1),null==s||s.resolve(a.a.Shared),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),C(!1);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},u.shareButton),o.createElement(r.DefaultButton,{onClick:function(){var e=l(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C(!1),null==s||s.resolve(a.a.Cancel);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},u.cancelButton))):null}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return y}));var r,o=n(1060),a=n(1004),i=n(1005),c=n(1028),s=n(1012),d=n(1021),u=n(1006),l=n(1020),f=n(1040),m=n(1051);!function(e){e[e.None=1]="None",e[e.Error=2]="Error",e[e.RequestDefaultFilter=3]="RequestDefaultFilter",e[e.LoadDefaultFilter=4]="LoadDefaultFilter",e[e.LoadFilter=5]="LoadFilter",e[e.UpdateFilter=6]="UpdateFilter"}(r||(r={}));var p=function(e,t,n){if(e!==r.None){var o=Object(i.k)().createActivityObject("FilterPerfScenario",t,Object(i.j)());return o.addDataField("FilterScenario",e,i.d.SystemMetadata),Object(m.c)(n,o),o}},h=function(e){switch(e){case"LOAD_DEFAULT_FILTER":return r.LoadDefaultFilter;case"LOAD_FILTER":return r.LoadFilter;case"UPDATE_FILTER_RANGE":return r.UpdateFilter;default:return r.None}},v=!1,g={mentionsToCurrentUser:!1,CommentThread:{resolutionStatus:o.a.All},TrackedChange:{stubField:""},contentOrder:o.c.HostDefaultOrder,includeAllDocumentContexts:!1,userFilter:void 0},y=function(e,t){return function(n){var o=new Map;return function(c){return function(s){if(!f.g(n.getState()))return c(s);var d,m=p(h(s.type),t,n.getState()),g=f.a(n.getState());switch(s.type){case"LOAD_DEFAULT_FILTER":case"LOAD_FILTER":d=f.f(n.getState(),s.payload.filteredRange.id);break;case"UPDATE_FILTER_RANGE":d=f.f(n.getState(),s.payload.filterId);break;case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":s.payload.filteringEnabled=!0}var y=c(s),T=function(e,o){if(!m){Object(i.k)().assertConditionTag(!1,"Activity should not be undefined",e);var c=h(o);m=p(c!==r.None?c:r.Error,t,n.getState())}return Object(a.n)(m,"Perf activity not defined in error fallback case.",a.d.reserveTag(520168332)),m};switch(s.type){case"LOAD_DEFAULT_FILTER":u.u()&&v&&!f.h(n.getState())&&(v=!1);case"LOAD_FILTER":!function(e,t,n,r,o,c,s,d){void 0===s&&f.f(n.getState(),r.payload.filteredRange.id)&&(o.set(r.payload.filteredRange.id,{filter:r.payload.filteredRange,changeToken:r.payload.filteredRange.onRangeUpdated.subscribe((function(e){!function(e,t,n,r,o,c){o.get(n)?t(l.updateFilterRange({renderContextType:r,telemetryVisitor:e,trackback:a.d.reserveTag(528779331)},{filterId:n,changes:c.changes})):Object(i.k)().assertConditionTag(!1,"How did we receive an update, when we aren't tracking a filter? Did you forget to teardown an old filter?",528779330)}(t,n.dispatch,r.payload.filteredRange.id,r.actionDetail.renderContextType,o,e)}))}),"LOAD_DEFAULT_FILTER"!==r.type&&!r.payload.shouldSetActive||f.a(n.getState())!==r.payload.filteredRange.id||(e.setActiveFilteredRange(r.payload.filteredRange.id),d&&d!==f.a(n.getState())&&d!==f.e(n.getState())&&n.dispatch(l.updateFilterRange({renderContextType:r.actionDetail.renderContextType,telemetryVisitor:t,trackback:a.d.reserveTag(528779332)},{filterId:d,changes:[{type:"Teardown"}]}))));c.successTag(a.d.reserveTag(520198023))}(e,t,n,s,o,T(a.d.reserveTag(520198025),s.type),d,g);break;case"UPDATE_FILTER_RANGE":!function(e,t,n,r,o,a,c,s){f.a(n.getState())!==s&&e.setActiveFilteredRange(f.a(n.getState()));var d=f.f(n.getState(),r.payload.filterId);if(c&&d&&c.filter!==d.filter){var l=o.get(r.payload.filterId);l&&l.filter.canBeUpdated()?l.filter.updateFilter(d.filter)?a.successTag(520198022):(Object(i.k)().assertConditionTag(!1,"The filter should have been able to update",528527826),b(e,t,a,n,d.filter,s===r.payload.filterId)):b(e,t,a,n,d.filter,s===r.payload.filterId)}var m=function(){return r.payload.changes.findIndex((function(e){return"Teardown"===e.type}))>=0};if(!f.f(n.getState(),r.payload.filterId)){Object(i.k)().assertConditionTag(m(),"Range should not be removed unless there was a Teardown",528749966);var p=o.get(r.payload.filterId);p&&(p.filter.teardown(),p.changeToken.unsubscribe(),o.delete(r.payload.filterId))}u.u()&&v||f.e(n.getState())||(Object(i.k)().assertConditionTag(m(),"Default filter should not be removed unless there was a Teardown",528749967),C(e,t,a,n));a.isEnded()||a.successTag(520198021)}(e,t,n,s,o,T(a.d.reserveTag(520198024),s.type),d,g)}return u.u()&&v||!f.h(n.getState())||(m=p(r.RequestDefaultFilter,t,n.getState()),C(e,t,T(a.d.reserveTag(520168331),s.type),n),v=!0),y}}}};var b=function(e,t,n,r,o,i){e.createFilteredRange({contentTypes:[c.b.CommentThread],filters:o,supportsFilterUpdates:!1}).then((function(e){r.dispatch(l.loadFilter({renderContextType:s.a.None,telemetryVisitor:t,trackback:a.d.reserveTag(528532107)},{filteredRange:e,shouldSetActive:i})),n.successTag(520198020)})).catch(function(e,t,n){return null==e||e.failTag(t,-2147467259),Object(d.a)(n)}(n,a.d.reserveTag(520198019),a.d.reserveTag(528532108)))},C=function(e,t,n,r){e.createFilteredRange({contentTypes:[c.b.CommentThread],filters:g,supportsFilterUpdates:u.j()}).then((function(e){r.dispatch(l.loadDefaultFilter({renderContextType:s.a.None,telemetryVisitor:t,trackback:a.d.reserveTag(528779333)},{filteredRange:e})),n.successTag(520198018),v=!1})).catch((function(e){Object(i.k)().assertConditionTag(!1,"Error creating new filter: ".concat(Object(a.l)(e)),528779334),n.failTag(a.d.reserveTag(520198017),-2147467259),v=!1}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1004),o=n(1063),a=n(1113),i=n(1021),c=n(1016),s=n(1027),d=n(1009);function u(e,t){return function(n,u){var l=s.d(u());return Object(a.a)(l)&&Object(o.b)(t)?l.setDisplayConfiguration(t).then((function(t){return n(function(e,t){return Object(d.b)("VIEW_CONTAINER_DISPLAY_CONFIGURATION_CHANGED",{displayConfiguration:t},e)}(e,t)),Promise.resolve(t)})).catch((function(e){return function(e){return Object(i.a)(r.d.reserveTag(578426816))(e),Promise.resolve(void 0)}(e)})):Promise.reject(new c.a("Not half pane or half pane configuration",r.d.reserveTag(577610273),-2130957557))}}},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var r=n(132),o=n(151),a=n(107),i=n(189),c=n(165);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(){l=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",d=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var a=t&&t.prototype instanceof y?t:y,i=Object.create(a.prototype),c=new A(r||[]);return o(i,"_invoke",{value:E(e,n,c)}),i}function m(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=f;var p="suspendedStart",h="executing",v="completed",g={};function y(){}function b(){}function C(){}var T={};u(T,i,(function(){return this}));var I=Object.getPrototypeOf,S=I&&I(I(D([])));S&&S!==n&&r.call(S,i)&&(T=S);var O=C.prototype=y.prototype=Object.create(T);function w(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function j(e,t){function n(o,a,i,c){var d=m(e[o],e,a);if("throw"!==d.type){var u=d.arg,l=u.value;return l&&"object"==s(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(l).then((function(e){u.value=e,i(u)}),(function(e){return n("throw",e,i,c)}))}c(d.arg)}var a;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return a=a?a.then(o,o):o()}})}function E(t,n,r){var o=p;return function(a,i){if(o===h)throw new Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:e,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var s=k(c,r);if(s){if(s===g)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=h;var d=m(t,n,r);if("normal"===d.type){if(o=r.done?v:"suspendedYield",d.arg===g)continue;return{value:d.arg,done:r.done}}"throw"===d.type&&(o=v,r.method="throw",r.arg=d.arg)}}}function k(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var a=m(o,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var i=a.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function D(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(s(t)+" is not iterable")}return b.prototype=C,o(O,"constructor",{value:C,configurable:!0}),o(C,"constructor",{value:b,configurable:!0}),b.displayName=u(C,d,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,u(e,d,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},w(j.prototype),u(j.prototype,c,(function(){return this})),t.AsyncIterator=j,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new j(f(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(O),u(O,d,"Generator"),u(O,i,(function(){return this})),u(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=D,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(x),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),d=r.call(i,"finallyLoc");if(s&&d){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),x(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;x(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:D(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function f(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function m(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){f(a,r,o,i,c,"next",e)}function c(e){f(a,r,o,i,c,"throw",e)}i(void 0)}))}}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function h(e){var t=function(e,t){if("object"!==s(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===s(t)?t:String(t)}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b(e);if(t){var o=b(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return y(this,n)}}function y(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(n,e);var t=g(n);function n(e,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(o=t.call(this,e,"systemusers")).telemetryService=r,o}return function(e,t,n){t&&p(e.prototype,t),n&&p(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"whoAmI",value:function(){var e=m(l().mark((function e(){var t,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.whoAmICache){e.next=2;break}return e.abrupt("return",this.whoAmICache);case 2:return t=this.telemetryService.createScenarioTracker(i.e.GetWhoAmI,a.a.Load),e.prev=3,e.next=6,this.requestor.makeRequestAsync({service:o.a.cds,path:"".concat(this.odataPath,"/WhoAmI()"),method:r.a.Get,responseType:"json"});case 6:return n=e.sent,t.complete(),this.whoAmICache=n.body,e.abrupt("return",this.whoAmICache);case 12:throw e.prev=12,e.t0=e.catch(3),t.failure(Object(c.a)(e.t0)),e.t0;case 16:case"end":return e.stop()}}),e,this,[[3,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"getUserPrivileges",value:function(){var e=m(l().mark((function e(t,n){var s,u,f=this;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this.telemetryService.createScenarioTracker(i.e.GetUserByDomainName,a.a.Load,{userId:t}),e.prev=1,e.next=4,Promise.all(n.map((function(e){return f.requestor.makeRequestAsync({service:o.a.cds,path:"".concat(f.entityPath,"(").concat(t,")/Microsoft.Dynamics.CRM.RetrieveUserPrivilegeByPrivilegeName(PrivilegeName=@PrivilegeName)?@PrivilegeName='").concat(e,"'"),method:r.a.Get,responseType:"json"})})));case 4:return u=e.sent,s.complete(),e.abrupt("return",u.map((function(e){return e.body.RolePrivileges})).reduce((function(e,t){return[].concat(d(e),d(t))}),[]));case 9:throw e.prev=9,e.t0=e.catch(1),s.failure(Object(c.a)(e.t0)),e.t0;case 13:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getUserByDomainName",value:function(){var e=m(l().mark((function e(t){var n,s,d;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this.telemetryService.createScenarioTracker(i.e.GetUserByDomainName,a.a.Load),e.prev=1,e.next=4,this.requestor.makeRequestAsync({service:o.a.cds,path:"".concat(this.entityPath,"?$filter=domainname eq '").concat(t,"'&$select=systemuserid"),method:r.a.Get,responseType:"json"});case 4:return d=e.sent,s.complete(),e.abrupt("return",null===(n=d.body.value)||void 0===n?void 0:n[0]);case 9:throw e.prev=9,e.t0=e.catch(1),s.failure(Object(c.a)(e.t0)),e.t0;case 13:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getUserByAadId",value:function(){var e=m(l().mark((function e(t){var n,s,d;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this.telemetryService.createScenarioTracker(i.e.GetUserByAadId,a.a.Load,{aadId:t}),e.prev=1,e.next=4,this.requestor.makeRequestAsync({service:o.a.cds,path:"".concat(this.entityPath,"?$filter=azureactivedirectoryobjectid eq ").concat(t,"&$select=systemuserid"),method:r.a.Get,responseType:"json"});case 4:return d=e.sent,s.complete(),e.abrupt("return",null===(n=d.body.value)||void 0===n?void 0:n[0]);case 9:throw e.prev=9,e.t0=e.catch(1),s.failure(Object(c.a)(e.t0)),e.t0;case 13:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()}]),n}(n(596).a)},function(e,t,n){"use strict";(function(e){}).call(this,n(280))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomTypeRegistry=void 0;var r=n(1419),o=function(){function e(){this.typeInfos={},this.typeInfosCache=[],this.externalTypes={}}return e.prototype.constuctor=function(e){void 0===e&&(e=!1),this.throwOnError=e},e.prototype.registerTypeInfos=function(e){if(-1===this.typeInfosCache.indexOf(e)){this.typeInfosCache.push(e);for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],o=this.typeInfos[r];o?o!==e[r]&&this.handleError("There are two definitions of the same namespace and interface: ".concat(r)):this.typeInfos[r]=e[r]}}},e.prototype.getTypeInfo=function(e){var t=this.typeInfos[e];if(t)return t;this.handleError('CustomTypeInfo "'.concat(e,'" not registered as a custom types.'))},e.prototype.registerExternalTypeInfos=function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];this.externalTypes[r]?this.handleError('The external type "'.concat(r,'" is already defined.')):this.externalTypes[r]=e[r]}},e.prototype.getExternalType=function(e){return this.externalTypes[e]},e.prototype.getExternalTypeInfos=function(){return this.externalTypes},e.prototype.validateParsedObj=function(e,t){for(var n=0,o=Object.keys(t);n<o.length;n++){var a=o[n];e[a]=(0,r.verifyType)(this,e[a],t[a])}return e},e.prototype.setThrowOnError=function(e){this.throwOnError=e},e.prototype.handleError=function(e){if(this.throwOnError)throw new Error(e)},e}();t.CustomTypeRegistry=new o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerClasses=t.registerServiceInstance=t.registerClass=t.RekaServiceRegistry=t.RekaInstance=void 0;var r=n(1421),o=n(1422);function a(e){t.RekaServiceRegistry.registerService({serviceInfo:e.ServiceInfo,factory:function(){return new e}})}function i(e){t.RekaServiceRegistry.registerService({serviceInfo:e.ServiceInfo,factory:function(){return e}})}function c(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.forEach((function(e){return a(e)}))}t.RekaInstance=new r.CRekaInstance(c,i),t.RekaServiceRegistry=new o.CRekaServiceRegistry(t.RekaInstance),t.registerClass=a,t.registerServiceInstance=i,t.registerClasses=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventImpl=void 0;var r=function(){function e(e){this.event=e}return e.prototype.unsubscribe=function(){this.event.unsubscribe(this)},e}(),o=function(){function e(e){this.listenerUpdate=e,this.handlers=new Map,this.hasListener=!1}return e.prototype.subscribe=function(e){var t=new r(this);return this.handlers.set(t,e),this.hasListener||this.sendUpdate(!0),t},e.prototype.unsubscribe=function(e){this.handlers.delete(e),this.hasListener&&0===this.handlers.size&&this.sendUpdate(!1)},e.prototype.unsubscribeAll=function(){this.handlers.clear(),this.hasListener&&this.sendUpdate(!1)},e.prototype.trigger=function(e){this.handlers.forEach((function(t,n){return t(e,n)}))},e.prototype.sendUpdate=function(e){this.hasListener=e,this.listenerUpdate(e)},e}();t.EventImpl=o},function(e,t,n){var r=n(1094),o=n(1095),a=n(1145),i=n(1434),c=n(1227),s=function(e,t,n){var d,u,l,f,m=e&s.F,p=e&s.G,h=e&s.S,v=e&s.P,g=e&s.B,y=p?r:h?r[t]||(r[t]={}):(r[t]||{}).prototype,b=p?o:o[t]||(o[t]={}),C=b.prototype||(b.prototype={});for(d in p&&(n=t),n)l=((u=!m&&y&&void 0!==y[d])?y:n)[d],f=g&&u?c(l,r):v&&"function"==typeof l?c(Function.call,l):l,y&&i(y,d,l,e&s.U),b[d]!=l&&a(b,d,f),v&&C[d]!=l&&(C[d]=l)};r.core=o,s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,e.exports=s},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(1437);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(1230);e.exports=function(e){return Object(r(e))}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(1232),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(1148)("wks"),o=n(1147),a=n(1094).Symbol,i="function"==typeof a;(e.exports=function(e){return r[e]||(r[e]=i&&a[e]||(i?a:o)("Symbol."+e))}).store=r},function(e,t,n){var r=n(1149),o=n(1230);e.exports=function(e){return r(o(e))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaFormattingType=void 0,function(e){e[e.None=0]="None",e[e.Text=1]="Text",e[e.Image=2]="Image",e[e.Table=4]="Table",e[e.Weight=8]="Weight",e[e.Underline=16]="Underline",e[e.Strikethrough=32]="Strikethrough",e[e.Italic=64]="Italic",e[e.Mention=128]="Mention",e[e.Hyperlink=256]="Hyperlink",e[e.Color=512]="Color",e[e.Highlight=1024]="Highlight",e[e.FontSize=2048]="FontSize",e[e.FontFamily=4096]="FontFamily",e[e.AltText=8192]="AltText",e[e.Optional=16384]="Optional",e[e.Paragraph=32768]="Paragraph",e[e.Language=65536]="Language",e[e.SubscriptAndSuperscript=131072]="SubscriptAndSuperscript",e[e.BadMentionFormat=134217728]="BadMentionFormat",e[e.UnknownAttribute=268435456]="UnknownAttribute",e[e.Unsupported=536870912]="Unsupported",e[e.Unknown=1073741824]="Unknown",e[e.TextAndMentions=129]="TextAndMentions",e[e.TextAndParagraph=32769]="TextAndParagraph",e[e.AllFormatting=262143]="AllFormatting",e[e.InvalidFormatting=2013265920]="InvalidFormatting"}(t.DeltaFormattingType||(t.DeltaFormattingType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventImpl=void 0;var r=function(){function e(e){this.event=e}return e.prototype.unsubscribe=function(){this.event.unsubscribe(this)},e}(),o=function(){function e(e){this.listenerUpdate=e,this.handlers=new Map,this.hasListener=!1}return e.prototype.subscribe=function(e){var t=new r(this);return this.handlers.set(t,e),this.hasListener||this.sendUpdate(!0),t},e.prototype.unsubscribe=function(e){this.handlers.delete(e),this.hasListener&&0===this.handlers.size&&this.sendUpdate(!1)},e.prototype.unsubscribeAll=function(){this.handlers.clear(),this.hasListener&&this.sendUpdate(!1)},e.prototype.trigger=function(e){this.handlers.forEach((function(t,n){return t(e,n)}))},e.prototype.sendUpdate=function(e){this.hasListener=e,this.listenerUpdate(e)},e}();t.EventImpl=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M 192 768 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15 m 768 0 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15 m 768 0 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15"}))}o.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,[r.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1965 173 l -850 851 l 850 851 l -90 90 l -851 -850 l -851 850 l -90 -90 l 850 -851 l -850 -851 l 90 -90 l 851 850 l 851 -850",key:0}),r.createElement("path",{className:"OfficeIconColors_m22",fill:"currentColor",d:"M 1965 173 l -850 851 l 850 851 l -90 90 l -851 -850 l -851 850 l -90 -90 l 850 -851 l -850 -851 l 90 -90 l 851 850 l 851 -850",key:1})])}o.defaultProps={width:"100%",height:"100%",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M 1920 128 v 1280 h -256 v 512 l -512 -512 h -1024 v -512 h 128 v 384 h 949 l 331 331 v -331 h 256 v -1024 h -1024 v -128 m 128 384 h -384 v 384 h -128 v -384 h -384 v -128 h 384 v -384 h 128 v 384 h 384 z"}))}o.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M 896 512 h -384 v 384 h -128 v -384 h -384 v -128 h 384 v -384 h 128 v 384 h 384 m 1024 -256 v 1280 h -1024 l -512 512 v -512 h -256 v -640 h 128 v 512 h 256 v 331 l 331 -331 h 949 v -1024 h -1024 v -128 z"}))}o.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,[r.createElement("path",{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",key:0}),r.createElement("path",{type:"path",fill:"currentColor",className:"OfficeIconColors_m22",d:"M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",key:1})])}o.defaultProps={height:"100%",width:"100%",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M0,7.93,1.32,4,0,0,11.9,4ZM2,3.59H8.41L1.18,1.18ZM1.18,6.75,8.41,4.34H2Z"}))}o.defaultProps={viewBox:"-0.25 0.5 11.9 7.93",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M9.75,2.25H9v8.63a1,1,0,0,1-.09.43,1.1,1.1,0,0,1-.6.6,1,1,0,0,1-.43.09h-6a1,1,0,0,1-.44-.09,1.1,1.1,0,0,1-.6-.6,1,1,0,0,1-.09-.43V2.25H0V1.5H3V.75A.68.68,0,0,1,3.06.46.78.78,0,0,1,3.22.22.78.78,0,0,1,3.46.06.68.68,0,0,1,3.75,0H6a.68.68,0,0,1,.29.06.78.78,0,0,1,.24.16.78.78,0,0,1,.16.24.68.68,0,0,1,.06.29V1.5h3Zm-1.5,0H1.5v8.63a.38.38,0,0,0,.11.26.39.39,0,0,0,.27.11h6a.38.38,0,0,0,.37-.37Zm-4.5,7.5H3v-6h.75Zm0-8.25H6V.75H3.75Zm1.5,8.25H4.5v-6h.75Zm1.5,0H6v-6h.75Z"})))])}o.defaultProps={viewBox:"0 0 9.75 12",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M12,2a1.93,1.93,0,0,1-.15.75,1.87,1.87,0,0,1-.42.65L3.71,11.07,0,12,.93,8.29,8.64.57A1.87,1.87,0,0,1,9.29.15,1.93,1.93,0,0,1,10,0a1.79,1.79,0,0,1,.76.16,1.79,1.79,0,0,1,.62.42,1.79,1.79,0,0,1,.42.62A1.79,1.79,0,0,1,12,2ZM1,11,3,10.49A1.84,1.84,0,0,0,2.77,10a2.29,2.29,0,0,0-.32-.43A2.29,2.29,0,0,0,2,9.23,1.84,1.84,0,0,0,1.51,9Zm.88-2.6a2.64,2.64,0,0,1,1.72,1.72L10,3.75,8.25,2ZM10.5,3.22l.28-.28A2,2,0,0,0,11,2.67a1.34,1.34,0,0,0,.17-.31A1.14,1.14,0,0,0,11.25,2a1,1,0,0,0-.1-.47A1.2,1.2,0,0,0,10.5.85,1,1,0,0,0,10,.75a1.14,1.14,0,0,0-.39.06A1.34,1.34,0,0,0,9.33,1a2,2,0,0,0-.27.24l-.28.28Z"})))])}o.defaultProps={viewBox:"0 0 12 12",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M0,5,.53,4.5,3.64,7.61,11.25,0l.53.53L3.64,8.67Z"})))])}o.defaultProps={viewBox:"0 0 10 10",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,[r.createElement("path",{className:"OfficeIconColors_HighContrast",fillOpacity:"1.000",d:"M 737 384 q 87 6 163 44 q 75 37 132 98 q 56 60 88 139 q 32 79 32 167 q 0 69 -19 131 q -20 61 -55 115 l -94 -94 q 19 -35 30 -72 q 10 -38 10 -80 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -331 l 294 293 l -91 91 l -448 -448 l 448 -448 l 91 91 l -294 293 m 1547 -256 v 1280 h -1024 l -512 512 v -512 h -256 v -689 l 128 128 v 433 h 256 v 331 l 331 -331 h 949 v -1024 h -813 q -36 -17 -73 -31 q -38 -14 -80 -22 l 75 -75 z",key:0}),r.createElement("path",{className:"reopenThreadIconShading",fillOpacity:"1.000",d:"M 1073 1344 h -203 l -422 422 v -422 h -256 v -561 l 384 385 l 195 -196 l -25 46 m 1110 -826 v 1152 h -723 l 105 -160 q 52 -79 79 -168 q 27 -90 27 -184 q 0 -115 -39 -220 q -40 -105 -109 -188 q -69 -84 -164 -141 q -95 -58 -206 -80 l 11 -11 z",key:1}),r.createElement("path",{className:"reopenThreadIconArrow",fillOpacity:"1.000",d:"M 1920 128 v 1280 h -1024 l -512 512 v -512 h -256 v -689 l 128 128 v 433 h 256 v 331 l 331 -331 h 949 v -1024 h -813 q -36 -17 -74 -31 q -38 -14 -79 -22 l 75 -75 z",key:2}),r.createElement("path",{className:"reopenThreadIconBubble",fillOpacity:"1.000",d:"M 737 384 q 87 6 163 44 q 75 37 132 98 q 56 60 88 139 q 32 79 32 167 q 0 69 -19 131 q -20 61 -55 115 l -94 -94 q 19 -35 30 -72 q 10 -38 10 -80 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -331 l 294 293 l -91 91 l -448 -448 l 448 -448 l 91 91 l -294 293 z",key:3})])}o.defaultProps={width:"14",height:"14",viewBox:"200,0,2048,2048",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("path",{className:"cls-1",d:"M7.5 0C8.19271 0 8.85677 0.0885417 9.49219 0.265625C10.1328 0.442708 10.7318 0.695312 11.2891 1.02344C11.8464 1.34635 12.3516 1.73698 12.8047 2.19531C13.263 2.64844 13.6536 3.15365 13.9766 3.71094C14.3047 4.26823 14.5573 4.86719 14.7344 5.50781C14.9115 6.14323 15 6.80729 15 7.5C15 8.19271 14.9115 8.85938 14.7344 9.5C14.5573 10.1354 14.3047 10.7318 13.9766 11.2891C13.6536 11.8464 13.263 12.3542 12.8047 12.8125C12.3516 13.2656 11.8464 13.6562 11.2891 13.9844C10.7318 14.3073 10.1328 14.5573 9.49219 14.7344C8.85677 14.9115 8.19271 15 7.5 15C6.80729 15 6.14062 14.9115 5.5 14.7344C4.86458 14.5573 4.26823 14.3073 3.71094 13.9844C3.15365 13.6562 2.64583 13.2656 2.1875 12.8125C1.73438 12.3542 1.34375 11.8464 1.01562 11.2891C0.692708 10.7318 0.442708 10.1354 0.265625 9.5C0.0885417 8.85938 0 8.19271 0 7.5C0 6.80729 0.0885417 6.14323 0.265625 5.50781C0.442708 4.86719 0.692708 4.26823 1.01562 3.71094C1.34375 3.15365 1.73438 2.64844 2.1875 2.19531C2.64583 1.73698 3.15365 1.34635 3.71094 1.02344C4.26823 0.695312 4.86458 0.442708 5.5 0.265625C6.14062 0.0885417 6.80729 0 7.5 0ZM7.5 14C8.09375 14 8.66667 13.9219 9.21875 13.7656C9.77604 13.6094 10.2943 13.3906 10.7734 13.1094C11.2578 12.8281 11.6979 12.4896 12.0938 12.0938C12.4896 11.6979 12.8281 11.2604 13.1094 10.7812C13.3906 10.2969 13.6094 9.77865 13.7656 9.22656C13.9219 8.67448 14 8.09896 14 7.5C14 6.90625 13.9219 6.33333 13.7656 5.78125C13.6094 5.22396 13.3906 4.70573 13.1094 4.22656C12.8281 3.74219 12.4896 3.30208 12.0938 2.90625C11.6979 2.51042 11.2578 2.17188 10.7734 1.89062C10.2943 1.60938 9.77604 1.39062 9.21875 1.23438C8.66667 1.07812 8.09375 1 7.5 1C6.90104 1 6.32552 1.07812 5.77344 1.23438C5.22135 1.39062 4.70312 1.60938 4.21875 1.89062C3.73958 2.17188 3.30208 2.51042 2.90625 2.90625C2.51042 3.30208 2.17188 3.74219 1.89062 4.22656C1.60938 4.70573 1.39062 5.22396 1.23438 5.78125C1.07812 6.33333 1 6.90625 1 7.5C1 8.09375 1.07812 8.66927 1.23438 9.22656C1.39062 9.77865 1.60938 10.2969 1.89062 10.7812C2.17188 11.2604 2.51042 11.6979 2.90625 12.0938C3.30208 12.4896 3.73958 12.8281 4.21875 13.1094C4.70312 13.3906 5.22135 13.6094 5.77344 13.7656C6.32552 13.9219 6.90104 14 7.5 14ZM7 4H8V9H7V4ZM7 10H8V11H7V10Z",fill:"#252423",key:1})])}o.defaultProps={width:"15",height:"15",viewBox:"0 0 15 15",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,[r.createElement("path",{fill:"#F9F9F9",fillOpacity:"1.000",d:"M 800 1888 v -749 l -640 -655 v -324 h 1664 v 351 l -731 764 l 91 90 v 523 z",key:0}),r.createElement("path",{fill:"#3A3A38",fillOpacity:"1.000",d:"M 1856 128 v 369 l -582 596 l -45 -45 l 563 -577 v -279 h -1600 v 279 l 640 655 v 730 h 320 v -523 l 64 64 v 470 l -53 53 h -395 v -768 l -640 -655 v -369 z",key:1}),r.createElement("path",{fill:"#ED3D3B",fillOpacity:"1.000",d:"M 1677 1632 l 371 371 l -45 45 l -371 -371 l -371 371 l -45 -45 l 371 -371 l -371 -371 l 45 -45 l 371 371 l 371 -371 l 45 45 z",key:2})])}o.defaultProps={viewBox:"0,0,2048,2048",width:"100%",height:"100%"},e.exports=o,o.default=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,[r.createElement("path",{fill:"#FCFCFC",fillOpacity:"1.000",d:"M 800 1888 v -749 l -640 -655 v -324 h 1664 v 351 l -731 764 l 91 90 v 523 z",key:0}),r.createElement("path",{fill:"#919190",fillOpacity:"1.000",d:"M 1856 128 v 369 l -582 596 l -45 -45 l 563 -577 v -279 h -1600 v 279 l 640 655 v 730 h 320 v -523 l 64 64 v 470 l -53 53 h -395 v -768 l -640 -655 v -369 z",key:1}),r.createElement("path",{fill:"#FF9091",fillOpacity:"1.000",d:"M 1677 1632 l 371 371 l -45 45 l -371 -371 l -371 371 l -45 -45 l 371 -371 l -371 -371 l 45 -45 l 371 371 l 371 -371 l 45 45 z",key:2})])}o.defaultProps={viewBox:"0,0,2048,2048",width:"100%",height:"100%"},e.exports=o,o.default=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(0.000000, 0.648438)",fill:"currentColor",fillRule:"nonzero"},r.createElement("polygon",{id:"Reassign",points:"7.52636719 0 13.9589844 6.43261719 7.52636719 12.8652344 6.91113281 12.25 12.2910156 6.87011719 0 6.87011719 0 5.99511719 12.2910156 5.99511719 6.91113281 0.615234375"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 14 14",focusable:"false",version:"1.1"},e.exports=o,o.default=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-32.000000, -2.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("polygon",{id:"Resolve",points:"42.5673828 2.625 43.1826172 3.24023438 35.875 10.5546875 32.0673828 6.74023438 32.6826172 6.125 35.875 9.31054688"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 9",focusable:"false",version:"1.1"},e.exports=o,o.default=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-62.000000, -26.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("polygon",{id:"Cancel",points:"73.5888672 27.0839844 68.8720703 31.8076172 73.5888672 36.53125 72.9736328 37.1464844 68.25 32.4296875 63.5263672 37.1464844 62.9111328 36.53125 67.6279297 31.8076172 62.9111328 27.0839844 63.5263672 26.46875 68.25 31.1855469 72.9736328 26.46875"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 11",focusable:"false",version:"1.1"},e.exports=o,o.default=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-30.000000, -24.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("path",{d:"M44.625,27.0976562 C44.625,27.398439 44.5680344,27.6901028 44.4541016,27.9726562 C44.3401687,28.2552097 44.1738292,28.5058583 43.9550781,28.7246094 L34.9521484,37.7275391 L30.625,38.8076172 L31.7050781,34.4804688 L40.7080078,25.4775391 C40.9267589,25.258788 41.1774074,25.0924485 41.4599609,24.9785156 C41.7425144,24.8645828 42.0341782,24.8076172 42.3349609,24.8076172 C42.6494156,24.8076172 42.9456366,24.8680007 43.2236328,24.9887695 C43.501629,25.1095384 43.7443023,25.2735992 43.9516602,25.480957 C44.159018,25.6883148 44.3230788,25.9309882 44.4438477,26.2089844 C44.5646165,26.4869806 44.625,26.7832016 44.625,27.0976562 Z M32.8535156,34.5693359 C33.336591,34.7288419 33.7524397,34.9829084 34.1010742,35.331543 C34.4497088,35.6801775 34.7037752,36.0960262 34.8632812,36.5791016 L42.2529297,29.1826172 L40.25,27.1796875 L32.8535156,34.5693359 Z M31.828125,37.6044922 L34.0771484,37.0439453 C34.0315753,36.8343088 33.95752,36.6360686 33.8549805,36.4492188 C33.7524409,36.2623689 33.6282559,36.0960294 33.4824219,35.9501953 C33.3365878,35.8043612 33.1702483,35.6801763 32.9833984,35.5776367 C32.7965485,35.4750971 32.5983083,35.4010419 32.3886719,35.3554688 L31.828125,37.6044922 Z M42.875,28.5605469 C42.9889329,28.446614 43.0983068,28.3395187 43.203125,28.2392578 C43.3079432,28.1389969 43.4013668,28.0330409 43.4833984,27.9213867 C43.5654301,27.8097325 43.6303709,27.6889655 43.6782227,27.559082 C43.7260745,27.4291986 43.75,27.2776701 43.75,27.1044922 C43.75,26.9085277 43.7124027,26.7250985 43.637207,26.5541992 C43.5620113,26.3832999 43.4594733,26.2329108 43.3295898,26.1030273 C43.1997064,25.9731439 43.0493173,25.8706058 42.878418,25.7954102 C42.7075187,25.7202145 42.5240895,25.6826172 42.328125,25.6826172 C42.1549471,25.6826172 42.0034186,25.7065427 41.8735352,25.7543945 C41.7436517,25.8022463 41.6228847,25.8671871 41.5112305,25.9492188 C41.3995763,26.0312504 41.2936203,26.124674 41.1933594,26.2294922 C41.0930985,26.3343104 40.9860032,26.4436843 40.8720703,26.5576172 L42.875,28.5605469 Z",id:"Edit"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",x:"0",y:"0",viewBox:"0 0 15 15",focusable:"false",version:"1.1"},e.exports=o,o.default=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("path",{d:"M1 4L3.5 6.5L9 1"}))}o.defaultProps={viewBox:"0 0 10 8",focusable:"false",fill:"none",fillOpacity:"0.0"},e.exports=o,o.default=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,[r.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z",key:0}),r.createElement("path",{fill:"currentColor",fillOpacity:"1.000",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z",key:1})])}o.defaultProps={width:"12",height:"12",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,r.createElement("path",{className:"LikeEmptyBorder",d:"M 1600 1792 h -512 q -163 0 -345 -76 q -123 -52 -295 -52 h -448 v -896 h 384 q 33 0 77 -9 q 43 -9 87 -24 q 44 -15 83 -35 q 38 -19 60 -41 l 509 -574 q 6 -7 20 -21 q 13 -14 35 -29 q 22 -14 52 -25 q 30 -10 69 -10 q 36 0 66 17 q 29 17 50 44 q 21 27 33 61 q 11 35 11 70 q 0 75 -16 142 q -17 67 -55 142 q -23 45 -35 84 q -13 40 -18 80 h 380 q 40 0 86 10 q 46 11 85 32 q 38 21 64 53 q 25 32 25 76 q 0 10 -2 20 q -2 10 -5 21 l -263 802 q -10 30 -28 55 q -19 26 -43 44 q -24 19 -52 29 q -29 10 -59 10 m -1472 -256 h 320 q 197 0 345 62 q 159 66 295 66 h 512 q 19 0 36 -15 q 17 -14 25 -36 l 262 -801 q -2 -6 -13 -14 q -12 -7 -30 -14 q -18 -6 -40 -11 q -23 -5 -48 -5 h -512 v -64 q 0 -74 17 -141 q 16 -67 54 -143 q 30 -62 44 -115 q 13 -53 13 -113 q 0 -11 -3 -23 q -3 -11 -8 -20 q -5 -9 -10 -15 q -6 -6 -11 -6 q -31 0 -48 12 q -18 13 -31 29 l -513 577 q -33 33 -83 60 q -50 28 -105 48 q -56 20 -112 31 q -56 11 -100 11 h -256 z"}))}o.defaultProps={width:"16px",height:"16px",viewBox:"0,0,2048,2048",focusable:"false",version:"1.1"},e.exports=o,o.default=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,[r.createElement("path",{className:"LikeSolidCenter",d:"M 1721 1633 q -13 40 -46 67 q -33 28 -75 28 h -512 q -86 0 -166 -20 q -80 -20 -154 -51 q -74 -31 -154 -44 q -80 -13 -166 -13 h -384 v -768 h 320 q 38 0 88 -10 q 50 -10 100 -27 q 49 -17 93 -41 q 44 -23 71 -50 l 512 -576 q 6 -7 16 -18 q 10 -11 26 -22 q 15 -10 37 -17 q 21 -7 49 -7 q 23 0 41 12 q 18 13 30 32 q 12 19 19 41 q 6 23 6 43 q 0 73 -16 133 q -17 60 -48 123 q -31 63 -47 123 q -17 60 -17 133 h 448 q 30 0 64 7 q 34 7 64 20 q 29 14 49 33 q 19 20 19 46 q 0 5 -1 10 q -1 6 -3 12 z",key:0}),r.createElement("path",{className:"LikeSolidBorder",d:"M 1600 1792 h -512 q -163 0 -345 -76 q -123 -52 -295 -52 h -448 v -896 h 384 q 33 0 77 -9 q 43 -9 87 -24 q 44 -15 83 -35 q 38 -19 60 -41 l 509 -574 q 6 -7 20 -21 q 13 -14 35 -29 q 22 -14 52 -25 q 30 -10 69 -10 q 36 0 66 17 q 29 17 50 44 q 21 27 33 61 q 11 35 11 70 q 0 75 -16 142 q -17 67 -55 142 q -23 45 -35 84 q -13 40 -18 80 h 380 q 40 0 86 10 q 46 11 85 32 q 38 21 64 53 q 25 32 25 76 q 0 10 -2 20 q -2 10 -5 21 l -263 802 q -10 30 -28 55 q -19 26 -43 44 q -24 19 -52 29 q -29 10 -59 10 m -1472 -256 h 320 q 197 0 345 62 q 159 66 295 66 h 512 q 19 0 36 -15 q 17 -14 25 -36 l 262 -801 q -2 -6 -13 -14 q -12 -7 -30 -14 q -18 -6 -40 -11 q -23 -5 -48 -5 h -512 v -64 q 0 -74 17 -141 q 16 -67 54 -143 q 30 -62 44 -115 q 13 -53 13 -113 q 0 -11 -3 -23 q -3 -11 -8 -20 q -5 -9 -10 -15 q -6 -6 -11 -6 q -31 0 -48 12 q -18 13 -31 29 l -513 577 q -33 33 -83 60 q -50 28 -105 48 q -56 20 -112 31 q -56 11 -100 11 h -256 z",key:1})])}o.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048"},e.exports=o,o.default=o},function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M 2048 1216 q 0 93 -35 175 q -36 81 -96 142 q -61 60 -142 96 q -82 35 -175 35 h -512 q -93 0 -174 -35 q -82 -36 -142 -96 q -61 -61 -96 -142 q -36 -82 -36 -175 q 0 -93 36 -174 q 35 -82 96 -142 q 60 -61 142 -96 q 81 -36 174 -36 h 64 v 128 h -64 q -66 0 -124 26 q -59 25 -102 69 q -44 43 -69 101 q -25 58 -25 124 q 0 66 25 125 q 25 58 69 102 q 43 43 102 68 q 58 25 124 25 h 512 q 66 0 124 -25 q 58 -25 102 -68 q 43 -44 69 -102 q 25 -59 25 -125 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -64 v -128 h 64 q 93 0 175 36 q 81 35 142 96 q 60 60 96 142 q 35 81 35 174 m -640 -384 q 0 93 -35 175 q -36 81 -96 142 q -61 60 -142 96 q -82 35 -175 35 h -64 v -128 h 64 q 66 0 124 -25 q 58 -25 102 -68 q 43 -44 69 -102 q 25 -59 25 -125 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -512 q -66 0 -124 26 q -59 25 -102 69 q -44 43 -69 101 q -25 58 -25 124 q 0 66 25 125 q 25 58 69 102 q 43 43 102 68 q 58 25 124 25 h 64 v 128 h -64 q -93 0 -174 -35 q -82 -36 -142 -96 q -61 -61 -96 -142 q -36 -82 -36 -175 q 0 -93 36 -174 q 35 -82 96 -142 q 60 -61 142 -96 q 81 -36 174 -36 h 512 q 93 0 175 36 q 81 35 142 96 q 60 60 96 142 q 35 81 35 174 z"})))])}o.defaultProps={width:"100%",height:"100%",viewBox:"0,0,2048,2048",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},function(e,t,n){"use strict";var r=n(1454).SharedCommentsVersion;t.a=r},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return u}));var r=n(1005),o=n(1072),a=n(1020),i=n(1023);function c(e){return void 0!==e&&0!=(e.commentFlags&o.c.Resolved)}function s(e){return e!==i.a.Canvas}function d(e){return Object(a.shouldSelectActionExpandCard)(e)}function u(e,t){e.addDataField("IsCommentResolved",t,r.d.SystemMetadata)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}));var r=n(1004),o=n(1065),a=n(1102),i=n(1263),c=50;function s(e,t){var n=function n(c,s,d,u,l){if(!t||!c||-1===t.indexOf(c.type)||3===c.priorityArgs.priority)return c&&-1!==(null==t?void 0:t.indexOf(c.type))&&(o.a&&(null==c?void 0:c.type)===a.a.FocusComponent&&Object(r.i)("Executing non-debounced focus command ".concat(JSON.stringify(c))),void 0!==n.pendingCommand&&clearTimeout(n.pendingCommand),n.pendingCommand=void 0),void u(c,Object(i.a)(c,s,d,l));void 0!==n.pendingCommand&&clearTimeout(n.pendingCommand),o.a&&c.type===a.a.FocusComponent&&Object(r.i)("Caching debounced command ".concat(JSON.stringify(c))),n.pendingCommand=setTimeout((function(){o.a&&c.type===a.a.FocusComponent&&Object(r.i)("Executing debounced command ".concat(JSON.stringify(c))),u(c,Object(i.a)(c,s,d,l)),n.pendingCommand=void 0}),e)};return n.pendingCommand=void 0,n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(1004),o=n(1005),a=n(1065),i=n(1181),c=n(1059),s=n(1264),d=n(1182),u=n(1125);function l(e,t,n,f){if(!e)return i.a.NoCommand;var m=i.a.Handled;if(Object(u.b)(e)){var p=e.component;m=function(e,t,n){return t?(a.a&&Object(r.i)("Calling focus for componentType: ".concat(e.component.componentType)),n(e.component),t.focus(e.preventScroll?{preventScroll:e.preventScroll}:void 0),i.a.Handled):function(e){return 1!==e.priorityArgs.priority&&0!==e.priorityArgs.phase}(e)?i.a.ShouldRetry:i.a.ComponentNotFound}(e,Object(c.c)(p)?t.getComponentById(p):t.getComponent(p.componentType),f)}else if(Object(d.b)(e))n.dispatch(e.action);else if(Object(s.b)(e)){var h=l(e.first,t,n,f),v=l(e.then,t,n,f);Object(o.k)().assertConditionTag(h!==i.a.ShouldRetry&&v!==i.a.ShouldRetry,"Compound command failed with status FocusManagerResult.ShouldRetry. No retry will occur.",559748948)}return e.stopPropagation&&e.causedBy&&e.causedBy.stopPropagation(),e.preventDefault&&e.causedBy&&e.causedBy.preventDefault(),m}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(1102);function o(e,t,n){return t?n?{type:r.a.Compound,priorityArgs:{priority:1},first:t,then:n,causedBy:e}:t:n}function a(e){return e.type===r.a.Compound&&void 0!==e.first&&void 0!==e.then}},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return d}));var r=n(1555),o=n(1022),a=n(1017);function i(e,t,n,a){var i,c=e.map((function(e){return e.author})),s=null!==(i=null==t?void 0:t.map((function(e){return e.history.map((function(e){return e.records[0].user}))})))&&void 0!==i?i:[];return function(e,t){var n={};return e.filter((function(e){var r=Object(o.j)(e);return!(!r||n[r]||d(t,e))&&(n[r]=!0)}))}(Object(r.a)([c,s,null!=a?a:[]]),n)}function c(e){return e.reduce((function(e,t){var n=function(e){if(!e.authorID&&!e.authorName)return;return e.authorID||e.authorName}(t);return n?(e[n]=t,e):e}),{})}function s(e){var t=[];return e.forEach((function(e){t.push({authorName:e.DisplayName||"",authorID:e.UserId,authorColor:a.a.COMMENTS_PURPLE,authorImageURL:""})})),t}function d(e,t){var n=Object(o.j)(t);if(n){var r=e[n];return void 0!==r?r:t.DisplayName&&e[t.DisplayName]?e[t.DisplayName]:void 0}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1189),o=function(){function e(e,t){void 0===t&&(t=!0),this.rawDelta=e,this.onlyNewMentions=t,this._deserializedDelta=void 0,this._NumHyperlinks=0,this._hasRichTextFormatting=!1,this._users=[]}return Object.defineProperty(e.prototype,"NumHyperlinks",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._NumHyperlinks},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Mentions",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._users},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HasRichTextFormatting",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._hasRichTextFormatting},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return this.rawDelta},e.prototype.parseDelta=function(){var e,t,n=this;this._deserializedDelta=JSON.parse(this.rawDelta),null===(t=null===(e=this._deserializedDelta)||void 0===e?void 0:e.ops)||void 0===t||t.forEach((function(e){var t,o;if(null==e?void 0:e.attributes){e.attributes.link&&(n._NumHyperlinks+=1);var a=e.attributes.atmention,i=e.optional;!a||n.onlyNewMentions&&void 0!==(null===(t=null==i?void 0:i.atmention)||void 0===t?void 0:t.contentId)||null===(o=n._users)||void 0===o||o.push({UserId:a.email,Provider:r.b}),(e.attributes.weight||e.attributes.italic||e.attributes.underline)&&(n._hasRichTextFormatting=!0)}}))},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1005),o=n(1014),a=n(1099),i=n(1033);function c(e,t){var n=Object(o.K)(e);if(!n)return Object(r.k)().assertConditionTag(!1,"Attempting to discard a draft when no draft is active within card.",593085890),Object(i.b)(t)?a.a.ClosePaneDraft:a.a.CancelNewDraft;switch(n.commentDraft.sessionConfiguration.sessionType){case"CREATE":return a.a.CancelNewDraft;case"EDIT":return a.a.CancelPostEdit;case"REPLY":return a.a.CancelReplyDraft;case"METADATA":return Object(r.k)().assertConditionTag(!1,"Metadata session should not be canceled with modal dialog.",593085891),a.a.CancelNewDraft}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1042),o=n(1014);function a(e,t){var n=Object(o.K)(e);return void 0!==n&&n.renderContextType!==t&&n.commentDraft.sessionConfiguration.sessionType===r.a}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Dialog=1]="Dialog",e[e.ForceDiscard=2]="ForceDiscard",e[e.TryAutoDiscard=3]="TryAutoDiscard"}(r||(r={}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.CanView="CanView",e.CanViewWithComponentImport="CanViewWithComponentImport",e.CanViewWithShare="CanViewWithShare",e.CanViewDocument="CanViewDocument",e.CanEdit="CanEdit",e.Owner="Owner"}(r||(r={}))},,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return Ls})),n.d(t,"d",(function(){return Bs})),n.d(t,"a",(function(){return E})),n.d(t,"c",(function(){return w})),n.d(t,"e",(function(){return Cc}));var r,o=n(969),a=n(2),i=n(1),c=n.n(i),s=n(116),d=n(186);function u(e){return!!(Object(d.b)(e)&&e.body&&e.body.error&&e.body.error.code)}!function(e){e.RecordNotFoundByEntityKey="0x80060891",e.CdsResourceNotFound="0x8006088a",e.unManagedIdsAccessDenied="0x80048306",e.UserNotAssignedRoles="0x80042f09",e.MissingPrivilege="0x80040220",e.DuplicateRecordEntityKey="0x80060892"}(r||(r={}));var l=function(e,t){return u(e)&&e.body.error.code===t},f=n(165);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==m(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===m(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=function(e,t){return h(h({},Object(f.b)(e)),{},{errorCode:t})},y=function(e,t){return!!e&&e.errorCode===t},b=n(1220),C=function(e,t){return t.every((function(t){return e.some((function(e){return e.PrivilegeName===t}))}))};function T(e){return function(e){if(Array.isArray(e))return I(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var S,O,w,j,E,k,P,x,A,D,R,F={read:["prvReadComment"],create:["prvCreateComment","prvAppendComment","prvAppendToComment"],write:["prvWriteComment"],delete:["prvDeleteComment"]},N=[].concat(T(F.read),T(F.create),T(F.write),T(F.delete));!function(e){e[e.Container=0]="Container",e[e.Thread=1]="Thread",e[e.Reply=2]="Reply"}(S||(S={})),function(e){e[e.Open=0]="Open",e[e.Resolved=1]="Resolved"}(O||(O={})),function(e){e.CreateThread="CreateThread",e.DeleteOrphanedComments="DeleteOrphanedComments",e.DeselectThread="DeselectThread"}(w||(w={})),function(e){e[e.SolutionNotInstalled=0]="SolutionNotInstalled",e[e.UnknownCode=1]="UnknownCode",e[e.MissingPrivileges=2]="MissingPrivileges"}(j||(j={})),function(e){e[e.Flow=0]="Flow",e[e.CanvasApp=1]="CanvasApp",e[e.BotComponent=2]="BotComponent",e[e.ModernAppDesigner=3]="ModernAppDesigner",e[e.Bot=4]="Bot",e[e.PowerPageSite=5]="PowerPageSite",e[e.Undefined=99]="Undefined"}(E||(E={})),function(e){e[e.Active=1]="Active",e[e.Inactive=2]="Inactive"}(k||(k={})),function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive"}(P||(P={})),function(e){e.Dogfood="Df",e.MSIT="Msit",e.Blackforest="Blackforest",e.GccModerate="GccModerate",e.GccHigh="GccHigh",e.DOD="DoD",e.Gallatin="Gallatin",e.TopLevel="Prod",e.AG08="AG08",e.AG09="AG09"}(x||(x={})),function(e){e.MissingWritePermission="MissingWritePermission",e.MissingReadPermission="MissingReadPermission",e.MissingAssignPermission="MissingAssignPermission",e.MissingDeletePermission="MissingDeletePermission",e.MissingCreatePermission="MissingCreatePermission",e.MentionedUserWithoutAccess="MentionedUserWithoutAccess",e.FeatureNotEnabled="FeatureNotEnabled",e.GenericError="GenericError"}(A||(A={})),function(e){e.CommentsPaneError="CommentsPaneError",e.CommentsPaneEventReceived="CommentsPaneEventReceived",e.CommentsPaneCrashed="CommentsPaneCrashed",e.CommentsPaneOpen="UI/CommentsPaneOpen",e.CommentsPaneClose="UI/CommentsPaneClose",e.AtMentionsCommentSelected="UI/AtMentionsCommentSelected"}(D||(D={})),function(e){e.CreateContainerComment="CommentsService/Data/CreateContainer",e.GetComments="CommentsService/Data/Get",e.CreateComment="CommentsService/Data/Create",e.UpdateComment="CommentsService/Data/Update",e.DeleteComment="CommentsService/Data/Delete",e.DeactivateComment="CommentsService/Data/Deactivate",e.ActivateComment="CommentsService/Data/Activate",e.LoadPane="UI/Comments/LoadCommentsPane",e.CommentAdded="UI/Comments/FirstCommentAdded",e.CheckAndGrantUerPermissions="UI/Comments/CheckAndGrantUerPermissions"}(R||(R={}));var M=n(1139),L=n(1004),B=n(1551),V=n(1201),U=n(1005),_=n(1093),H=n(1107),G=n(1028),q=(n(1426),n(1443),n(1138)),z=n(1141),W=n(1062),Y=n(1087),K=n(1203),X=n(307),Q=n(1006),J=function(){function e(){this._listeners=[]}return e.prototype.add=function(e){this._listeners.push(e)},e.prototype.remove=function(e){var t=this._listeners.indexOf(e);t>=-1&&this._listeners.splice(t,1)},Object.defineProperty(e.prototype,"invoke",{get:function(){var e=this;return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e._listeners.forEach((function(e){return e.apply(void 0,Object(X.h)([],Object(X.f)(t),!1))}))}},enumerable:!1,configurable:!0}),e}(),Z=function(){function e(){var e=this;this.changedEvent=new J,this.fireEvent=function(t){e.changedEvent.invoke(t)}}return e.prototype.registerForViewContainerEvents=function(e){this.changedEvent.add(e)},e.prototype.unregisterForViewContainerEvents=function(e){this.changedEvent.remove(e)},e}(),$=function(){function e(e,t,n){this.viewContainerBase=e,this.containerType=e.containerType,this.onReadyToRender=e.onReadyToRender,this.onReadyToRender&&(this.onReadyToRender=this.onReadyToRender.bind(e)),this.invokeModalConfirmationDialog=e.invokeModalConfirmationDialog,this.invokeModalConfirmationDialog&&(this.invokeModalConfirmationDialog=this.invokeModalConfirmationDialog.bind(e)),this.setDisplayConfiguration=e.setDisplayConfiguration,this.setDisplayConfiguration&&(this.setDisplayConfiguration=this.setDisplayConfiguration.bind(e)),this.closeView=e.closeView.bind(e),this.identifier=e.identifier}return e.prototype.openView=function(){this.viewContainerBase.openView&&this.viewContainerBase.openView()},e.prototype.moveFocusToCanvas_donotuse=function(){this.viewContainerBase.moveFocusToCanvas_donotuse&&this.viewContainerBase.moveFocusToCanvas_donotuse()},e}(),ee=n(130),te=n(1015),ne=n(1021);function re(e,t){return"".concat(e,"-").concat(t)}var oe,ae=n(1060),ie=n(1061),ce=n(1236);!function(e){e[e.Invalid=0]="Invalid",e[e.DataReceived=1]="DataReceived"}(oe||(oe={}));var se={sendCodeMarker:function(e){},onStartEvent:new ce.EventImpl((function(){})),onStopEvent:new ce.EventImpl((function(){}))},de=function(){return function(e){this.onMockUIAction=new ce.EventImpl((function(){}))}}(),ue=n(1151),le=n(1057),fe=n(1115),me=n(1016),pe=function(){return function(e,t){var n=this;this.commentViewManager=e,this.correlationId=t,this.visit=function(e){e.attachContext(n.commentViewManager.apiContext),n.correlationId&&e.addDataField("InstanceCorrelationId",n.correlationId,U.d.SystemMetadata)}}}();function he(e){return new pe(ge(e),e.correlationId)}var ve=function(){throw new Error("ViewManagerFactory not set")},ge=ve;var ye=new(function(){function e(){this.instanceMap=new Map,this.initialized=!1}return e.prototype.getTelemetryVisitor=function(e){var t=this;return this.instanceMap.get(e)||{visit:function(n){var r=t.instanceMap.get(e);if(!r)return n.attachContext(e),void n.addDataField("MissingInstanceTelemetry",!0,U.d.SystemMetadata);r.visit(n)}}},e.prototype.closeViewManager=function(e){var t=this.instanceMap.get(e);t&&(t.commentViewManager.teardown(),this.instanceMap.delete(e))},e.prototype.disposeViewManager=function(){var e=this;this.instanceMap.forEach((function(t,n){Object(ie.e)(n),e.closeViewManager(n)}))},e.prototype.doesViewManagerExist=function(e){return this.instanceMap.has(e)},e.prototype.ensureViewManager=function(e){var t=e.apiContext,n=e.displayMode,r=e.contentNavigationAPIMockSettings,o=e.contentFilteredRangeHostAPIMockSettings;this.initialized||this.ensureInitialized();var a=this.instanceMap.get(t);return a?this.updateInstanceObject(a,n):(this.initializeContentNavigationAPI(t,r),this.initializeContentFilteredRangeAPI(t,o),a=he(e),this.instanceMap.set(t,a)),a.commentViewManager},e.prototype.getCorrelationId=function(e){var t=this.instanceMap.get(e);return t&&t.correlationId},e.prototype.getStore=function(e){var t=this.instanceMap.get(e);if(!t)throw new me.a("Instance is not initialized",L.d.reserveTag(589103622),-2130957512);return t.commentViewManager.getCommentStore()},e.prototype.getViewManager=function(e){var t=this.tryGetViewManager(e);if(!t)throw new me.a("Instance is not initialized",L.d.reserveTag(589103623),-2130957512);return t},e.prototype.tryGetViewManager=function(e){var t;return null===(t=this.instanceMap.get(e))||void 0===t?void 0:t.commentViewManager},e.prototype.ensureInitialized=function(){var e=this;Q.v()&&se.onStartEvent.subscribe((function(t){e.initializeContentNavigationAPI(t.context,void 0),e.initializeContentFilteredRangeAPI(t.context,void 0),e.initializeViewManager(t.context,t.correlationId,t.useMockMode)})),se.onStopEvent.subscribe((function(t){e.closeViewManager(t.context),Object(ie.e)(t.context)})),this.initialized=!0},e.prototype.initializeViewManager=function(e,t,n){var r=this.instanceMap.get(e);if(r)r.correlationId=t;else{var o=void 0;n&&Q.r()&&(Object(U.k)().createActivityObject("OnMockUIDriverCreated",this.getTelemetryVisitor(e),Object(U.n)({diagnosticLevel:U.b.FullEvent})).successTag(592511450),o=new de(e)),this.instanceMap.set(e,he({apiContext:e,correlationId:t,initializationReason:fe.a.PaneOpen,displayMode:le.b.FullPane,foldableLayoutState:ue.a.Indeterminate,paneVisible:!1,initializeImmediately:!0,mockDriver:o}))}},e.prototype.updateInstanceObject=function(e,t){var n=e.commentViewManager.viewProvider;n.getViewContainer().containerType!==t&&n.changeViewContainerType(t)},e.prototype.initializeContentNavigationAPI=function(e,t){if(!Object(ie.g)(e)){if(t)return void(t.useMock&&Object(ie.h)(t.mock,e));var n=new ie.b(e);n.isAPIEnabled()&&Object(ie.h)(n,e)}},e.prototype.initializeContentFilteredRangeAPI=function(e,t){if(!Object(ae.e)(e)){if(t)return void(t.useMock&&Object(ae.f)(e,t.mock));Object(ae.f)(e,new ae.b(e))}},e}()),be=n(1030),Ce=n(1114),Te=function(){function e(e,t,n){var r=this;this.viewContainerBase=e,this.context=t,this.viewContainerProvider=n,this.rootNode=null,this.lastRenderFailed=!1,this.processVisibilityEvent=function(e){switch(e.viewContainerVisibilityState){case be.a.Visible:r.viewContainerBase.identifier?r.rootNode=document.getElementById(r.viewContainerBase.identifier):Object(U.k)().assertConditionTag(!1,"View container base identifier expected",558401364),r.providerPromise.then((function(e){r.renderIntoView(e)})).catch(Object(ne.a)(L.d.reserveTag(558401365)));break;case be.a.Closed:r.viewContainerBase.identifier&&r.rootNode&&(Object(ee.unmountComponentAtNode)(r.rootNode),r.rootNode=null);break;case be.a.Hidden:Object(U.k)().assertConditionTag(!1,"ViewContainerVisibilityState.Hidden is not currently supported for web.",558401366);break;default:Object(L.m)(e.viewContainerVisibilityState)}},this.containerType=e.containerType,this.onReadyToRender=e.onReadyToRender,this.onReadyToRender&&(this.onReadyToRender=this.onReadyToRender.bind(e)),this.invokeModalConfirmationDialog=e.invokeModalConfirmationDialog,this.invokeModalConfirmationDialog&&(this.invokeModalConfirmationDialog=this.invokeModalConfirmationDialog.bind(e)),this.setDisplayConfiguration=e.setDisplayConfiguration,this.setDisplayConfiguration&&(this.setDisplayConfiguration=this.setDisplayConfiguration.bind(e)),this.closeView=e.closeView.bind(e),this.onViewEventReceived=this.onViewEventReceived.bind(this),this.onProviderStateChange=this.onProviderStateChange.bind(this);var o=re("SharedCommentPane",t);this.viewContainerProvider&&(this.viewContainerProvider.registerForViewContainerEvents(this.onViewEventReceived),this.providerPromise=Object(H.d)().getComponent(o),this.providerPromise.then((function(e){e.onStateChanged.subscribe(r.onProviderStateChange)})).catch(Object(ne.a)(L.d.reserveTag(558401359))))}return Object.defineProperty(e.prototype,"identifier",{get:function(){return this.viewContainerBase.identifier},enumerable:!1,configurable:!0}),e.prototype.renderIntoView=function(e){this.renderPane(e)},e.prototype.renderPane=function(e){var t=this,n=e.component,r=Object(U.k)().createActivityObject("RenderPaneIntoView",ye.getTelemetryVisitor(this.context),Object(U.j)());if(!n)return this.lastRenderFailed&&r.failTag(558401360,-2130957502),void(this.lastRenderFailed=!0);Object(ee.render)(i.createElement(n,{resource:{id:"CommentPane"}}),this.rootNode,(function(){var e=document.getElementById(te.z());e&&e.focus(),t.lastRenderFailed=!1})),r.successTag(558401361)},e.prototype.onProviderStateChange=function(e){var t=this;this.rootNode&&(e===H.a.Registered?this.providerPromise.then((function(e){t.renderIntoView(e)})).catch((function(e){Object(U.k)().assertConditionTag(!1,"Unexpected promise rejection from component provider promise",558401362)})):e===H.a.Unregistered&&Object(ee.unmountComponentAtNode)(this.rootNode))},e.prototype.onViewEventReceived=function(e){var t;switch(e.eventType){case Ce.a.VisibilityChanged:this.processVisibilityEvent(e);break;case Ce.a.ViewContainerChanged:e.newViewContainer!==this&&(null===(t=this.viewContainerProvider)||void 0===t||t.unregisterForViewContainerEvents(this.onViewEventReceived));break;case Ce.a.FoldableLayoutStateChanged:case Ce.a.FocusTriggered:break;default:Object(L.m)(e)}},e.prototype.openView=function(){this.viewContainerBase.openView&&this.viewContainerBase.openView()},e.prototype.closeView=function(){this.viewContainerBase.closeView()},e.prototype.moveFocusToCanvas_donotuse=function(){},e}(),Ie=function(e){function t(t,n){var r=e.call(this)||this;return r.viewContainerProvider=n,r.apiContext=t,n.registerForViewContainerEvents(r.fireEvent),r}return Object(X.c)(t,e),t.prototype.getViewContainer=function(){return this.currentContainer||(Q.L()?this.currentContainer=new $(this.viewContainerProvider.getViewContainer(),this.apiContext,this):this.currentContainer=new Te(this.viewContainerProvider.getViewContainer(),this.apiContext,this)),this.currentContainer},t.prototype.changeViewContainerType=function(e){},t}(Z);var Se=n(1205),Oe=Object(a.memoizeFunction)((function(){return{offscreenLiveRegion:{clip:"rect(1px, 1px, 1px, 1px)",height:0,overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:0}}})),we=function(e){function t(t){var n=e.call(this,t)||this;return n.state={liveRegionUpdate:t.liveRegionUpdate,liveRegionCounter:0},n}return Object(X.c)(t,e),t.prototype.appendLiveRegionUpdate=function(e){var t=this,n=this.state.liveRegionCounter+1;this.setState({liveRegionUpdate:e,liveRegionCounter:n}),setTimeout((function(){t.state.liveRegionCounter===n&&t.setState({liveRegionUpdate:void 0,liveRegionCounter:0})}),1e3)},t.prototype.render=function(){var e=Oe();return i.createElement("span",{role:"region","aria-live":"assertive","aria-atomic":"true","aria-relevant":"additions",style:e.offscreenLiveRegion},this.state.liveRegionUpdate)},t}(i.PureComponent),je=void 0;function Ee(){if(Q.Y())je=document.createElement("div"),document.body.appendChild(je),ee.render(i.createElement(we,{ref:Pe}),je);else{var e=document.createElement("div");document.body.appendChild(e),ee.render(i.createElement(we,{ref:Pe}),e)}Object(Se.b)({announceToScreenReader:function(e){var t=function(){return ke}();t&&function(e){return!function(e){return null==e}(e)}(e)&&t.appendLiveRegionUpdate(e)}})}var ke=void 0;function Pe(e){ke=e}var xe=n(1076),Ae=(n(1112),n(1150));function De(e){var t=n(1237),r=n(1238),o=Object(a.getRTL)()?n(1239):n(1240),c=n(1241),s=n(1242),d=n(1243),u=n(1244),l=n(1245),f=n(1246),m=n(1247),p=n(1116),h=n(1248),v=n(1249),g={HintBarEllipses_16:i.createElement(t,null),CancelGlyph:i.createElement(r,null),NewComment:i.createElement(o,null),CancelGlyph_TaskPane:i.createElement(c,null),Send2_Fluent:i.createElement(s,null),Delete_Fluent:i.createElement(d,null),Edit_Fluent:i.createElement(u,null),Checkmark_Fluent:i.createElement(l,null),CommentReopen_Fluent:i.createElement(f,null),Error:i.createElement(m,null),ReopenThread:i.createElement(p,null),DeleteFilter:i.createElement(h,null),DeleteFilterDefault:i.createElement(v,null)};if(e||Q.c()){var y=n(1250),b=n(1251),C=n(1252),T=n(1253),I=n(1116),S=n(1254),O=n(1255);g.TaskAssign=i.createElement(y,null),g.TaskComplete=i.createElement(b,null),g.TaskDelete=i.createElement(C,null),g.TaskEdit=i.createElement(T,null),g.TaskReopen=i.createElement(I,null),g.TaskStatusCircleCheckmark=i.createElement(S,null),g.ChevronDown12=i.createElement(O,null)}if(e||Q.b()){var w=n(1256),j=n(1257);g.CommentLikeEmpty=i.createElement(w,null),g.CommentLikeSolid=i.createElement(j,null)}if(e||Q.A()){var E=n(1258);g.LinkToComment=i.createElement(E,null)}return{icons:g}}var Re={name:"OfficeSharedComments",version:n(1259).a};function Fe(){return ye.getViewManager(M.a)}function Ne(){Fe().beginInitialization()}var Me=n(1022),Le=n(1036),Be=n(1046),Ve=n(1200),Ue=function(){function e(e,t,n,r,o){var a=this;this.hostCommentAPI=e,this.author=t,this._anchorHintText=n,this.sessionConfiguration=r,this._insertIndex=o,this._active=!0,this._propertiesToUpdate={},this.updateDraft=function(e){e.draftId===a.sessionConfiguration.draftId&&(e.anchorHintText&&(a._anchorHintText=e.anchorHintText),void 0!==e.insertIndex&&(a._insertIndex=e.insertIndex))},this.handleCommentEvents=function(e,t){e===Be.e.CommentContextChanged&&Object(Ve.b)(t)&&t.contextDrafts?t.contextDrafts.forEach((function(e){return a.updateDraft(e)})):e===Be.e.UpdateDraftThread&&Object(Ve.d)(t)&&a.updateDraft(t)},this.hostCommentAPI.registerForCommentEvents(this.handleCommentEvents)}return Object.defineProperty(e.prototype,"active",{get:function(){return this._active},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchorHintText",{get:function(){return this._anchorHintText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"insertIndex",{get:function(){return this._insertIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"propertiesToUpdate",{get:function(){return this._propertiesToUpdate},enumerable:!1,configurable:!0}),e.prototype.updateProperties=function(e,t){this._propertiesToUpdate[e]=Object(X.a)({},t)},e.prototype.commit=function(e){if(!this.hostCommentAPI.commit)throw new me.a(Le.h,L.d.reserveTag(589103689),-2130957526);if(!this._active)throw new me.a(Le.b,L.d.reserveTag(589103690),-2130957525);var t=Q.c()||Q.b(),n=t&&this.sessionConfiguration.sessionType===Be.i;if(void 0===e&&!n||n&&void 0!==e)throw new me.a(Le.c,L.d.reserveTag(589103691),-2130957507);return t?this.hostCommentAPI.commit(this.sessionConfiguration.draftId,e,this._propertiesToUpdate):this.hostCommentAPI.commit(this.sessionConfiguration.draftId,e)},e.prototype.endDrafting=function(){this._active=!1,this.hostCommentAPI.unregisterForCommentEvents(this.handleCommentEvents),this.hostCommentAPI.endCommentSession(this.sessionConfiguration.draftId)},e}(),_e=function(){function e(e){this.hostCommentAPI=e,this.loadThreads=e.loadThreads.bind(e),this.deleteComment=e.deleteComment.bind(e),this.selectComment=e.selectComment.bind(e),this.highlightComment=e.highlightComment.bind(e),this.setThreadResolvedState=e.setThreadResolvedState.bind(e),this.selectFirstThreadInNextCommentContext=e.selectFirstThreadInNextCommentContext.bind(e),this.selectLastThreadInPreviousCommentContext=e.selectLastThreadInPreviousCommentContext.bind(e),this.registerForCommentEvents=e.registerForCommentEvents.bind(e),this.unregisterForCommentEvents=e.unregisterForCommentEvents.bind(e),this.registerForAction=e.registerForAction.bind(e),this.unregisterForAction=e.unregisterForAction.bind(e),this.checkAtMentionCapability=e.checkAtMentionCapability.bind(e),e.getCommentReactionData&&(this.getCommentReactionData=e.getCommentReactionData.bind(e)),Q.A()&&(this.presentLinkToComment=e.presentLinkToComment.bind(e)),e.registerForInterruptableCommands&&(this.registerForInterruptableCommands=e.registerForInterruptableCommands.bind(e)),e.unregisterForInterruptableCommands&&(this.unregisterForInterruptableCommands=e.unregisterForInterruptableCommands.bind(e)),e.onClickableTextClicked&&(this.onClickableTextClicked=e.onClickableTextClicked.bind(e)),Q.q()&&e.diagnosticHeartbeat&&setInterval((function(){var t;null===(t=e.diagnosticHeartbeat)||void 0===t||t.call(e)}),1e3)}return e.prototype.beginDraftingAsync=function(e){var t=this;if(!this.hostCommentAPI.beginDraftingAsync||!this.hostCommentAPI.commit)throw new me.a("Drafting APIs are undefined on Host Comment API",L.d.reserveTag(589103700),-2130957527);var n=Object(B.a)(),r=Object(X.a)(Object(X.a)({},e),{draftId:n});return this.hostCommentAPI.beginDraftingAsync(r).then((function(e){return new Ue(t.hostCommentAPI,Object(Me.e)(e),e.anchorHintText,e.updatedDraftSessionConfiguration||r,e.insertIndex)}))},e}(),He=n(1017),Ge={themeId:1,palette:{ButtonBorder:He.a.GRAY_B,CardAccent:He.a.GRAY_B,CardBackground:He.a.WHITE,CardHoveredBackground:He.a.GRAY_20,CardDraftBoxBackgroundHovered:He.a.WHITE,CardDraftBoxBorderHovered:He.a.GRAY_160,CardDraftBoxBorder:He.a.GRAY_110,CardDraftBoxBackground_HalfPane:He.a.WHITE,CardDraftBoxBackground:He.a.GRAY_A,CardExpandButtonBorder:He.a.GRAY_B,CardHeroBarBackground_HalfPane:He.a.GRAY_A,CardHeroBarBackground:He.a.WHITE,CardReplyBackground_HalfPane:He.a.GRAY_A,CardReplyBackground:He.a.GRAY_A,CardReplyTopBorder:He.a.GRAY_B,CardSelectionColor:He.a.COMMENTS_PURPLE,CardShadowColor:He.a.BLACK,CardBorder:He.a.GRAY_B,CardBorderEmphasis:He.a.COMMENTS_PURPLE,CommandBarBorder:He.a.GRAY_B,CommandBarTopBorder:He.a.GRAY_B,IconButtonDisabledTint:He.a.GRAY_C,IconButtonFocusedTint:He.a.GRAY_I,NavigationBarBackground:He.a.WHITE,NavigationBarBorder:He.a.GRAY_B,PaneBackground_HalfPane:He.a.WHITE,PaneBackground:He.a.GRAY_A,UnreadDotColor:He.a.DOT_BLUE,UnreadDotBorderColor:He.a.WHITE,ExpandButtonHoverBackground:"transparent",ExpandButtonBackground:"transparent",FocusBorderColor:He.a.GRAY_150,CardPlaceholderColor:He.a.GRAY_130,ResolvedCardBackground:He.a.GRAY_20}},qe=function(){function e(){}return e.prototype.getTheme=function(){return Object(U.k)().assertConditionTag(!1,"Should not be called",592986821),Ge},e.prototype.registerForThemeChange=function(e){},e.prototype.unregisterForThemeChange=function(e){},e}(),ze=n(1553),We=n(1029),Ye=n(1063),Ke=n(1065),Xe=n(1020),Qe=n(1023),Je=n(1051),Ze=n(1123),$e=n(1014),et=n(1067),tt=n(1026),nt=n(1032),rt=n(1013),ot=n(1040),at=n(1027),it=n(1025),ct=n(1058),st=n(1052),dt=n(1181),ut=n(1012),lt=n(1084),ft=n(1037),mt=n(1033),pt=n(1182),ht=n(1125),vt=n(1262),gt=n(1126),yt=n(1059);function bt(e,t){return!!(Object(yt.c)(t)?e.getComponentById(t):e.getComponent(t.componentType))}function Ct(e,t){if(function(e){return!("win32"===Object(ft.a)()||"web"===Object(ft.a)()&&Q.L())&&!!Object(mt.b)(e)}(e.componentTreeId.renderContextType)){if(e.getComponent(yt.a.ClosePaneButton))return Object(ht.a)(void 0,{componentType:yt.a.ClosePaneButton},{priorityArgs:t});Object(U.k)().assertConditionTag(!1,"cant find close button on platform where we should be able to find it",579086371)}}function Tt(e,t,n){var r,o;if(void 0===n&&(n={priority:1}),Object(mt.b)(e.componentTreeId.renderContextType)){var a=null!==(o=null!==(r=function(e,t,n){if(Q.E()&&e.componentTreeId.renderContextType===ut.a.FullPane){var r=t.getState();if(rt.p(r).newThread){if(e.getComponent(yt.a.NewCommentButton))return Object(ht.a)(void 0,{componentType:yt.a.NewCommentButton},{priorityArgs:n});Object(U.k)().assertConditionTag(!1,"cant find new comment button, but its enabled",579086400)}}}(e,t,n))&&void 0!==r?r:Ct(e,n))&&void 0!==o?o:function(e){if("web"!==Object(ft.a)())return Object(ht.a)(void 0,{componentType:yt.a.CommentsList},{priorityArgs:e})}(n);if(a)return a;Object(U.k)().assertConditionTag(!1,"Couldn't find a focus target",576337158)}else Object(U.k)().assertConditionTag(!1,"Shouldn't be called with renderContextType: ".concat(e.componentTreeId.renderContextType),576337157)}var It=function(e){function t(t){var n=e.call(this,t)||this,r=t.nativeEvent,o=r.altKey,a=r.shiftKey,i=r.ctrlKey,c=r.metaKey,s=r.key;return n.altKey=o,n.shiftKey=a,n.ctrlKey=i,n.metaKey=c,n.key=Object(We.f)(s),n}return Object(X.c)(t,e),t}(function(){function e(e){this._sourceEvent=e,this.eventPhase=e.eventPhase}return e.prototype.isEventTarget=function(e){return e===this._sourceEvent.target},e.prototype.stopPropagation=function(){this._sourceEvent.stopPropagation()},e.prototype.preventDefault=function(){this._sourceEvent.preventDefault()},e}());function St(e){return new It(e)}function Ot(e,t,n,r,o){var a=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return r.apply(void 0,Object(X.h)([e],Object(X.f)(t),!1))},i=function(r){for(var i=[],c=1;c<arguments.length;c++)i[c-1]=arguments[c];var s=a.apply(void 0,Object(X.h)([r],Object(X.f)(i),!1));o(s,r,e(),t,n)};return i.processCommand=a,i}function wt(e,t,n,r,o){var a=function(t,n){var r=Object(X.f)(n),a=r[0],c=r.slice(1),s=a();o(i.apply(void 0,Object(X.h)([St(t),s],Object(X.f)(c),!1)),s,e(),(function(){}),(function(){}))},i=function(e,o){for(var a=[],i=2;i<arguments.length;i++)a[i-2]=arguments[i];if(n(o)){var c=Object(We.d)(Object(We.f)(e.key),t),s=r[We.b[c]];return s?s.handler.apply(s,Object(X.h)([e,o],Object(X.f)(a),!1)):void 0}},c=Object.keys(r).map((function(e){return{key:e,eventPhase:r[e].phase}})),s=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{onKeyDown:function(t){return a(t,e)},getKeyDownEvents:function(){return c}}};return s.processEvent=i,s}var jt,Et=n(1102),kt=n(1183),Pt=n(1049),xt=n(1031),At=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.model=e,this.startPostIndex=t,this.pointer=0,this.ignoreResolvedThreads=!1,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t,this.ignoreResolvedThreads=n}return e.prototype.getRootCommentForCurrentElement=function(e){if(this.model[this.pointer]){var t=Object(xt.b)(this.model[this.pointer]);return e&&e.commentId===t?e:this.model.find((function(e){return e.commentId===t}))}},e.prototype.next=function(){var e,t=this.pointer;if(this.pointer<this.model.length-1)if(this.ignoreResolvedThreads)do{++this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer<this.model.length&&e&&e.commentFlags&Be.f.Resolved);else++this.pointer;return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&t<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e,t=this.pointer;if(this.pointer>0)if(this.ignoreResolvedThreads)do{--this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer>-1&&e&&e.commentFlags&Be.f.Resolved);else--this.pointer;return this.pointer>0||0===this.pointer&&t>0?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}(),Dt=n(1178),Rt=n(1035),Ft=n(1047),Nt=n(1068),Mt=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.items=e,this.startItemIndex=t,this.ignoreResolvedThreads=n,this.pointer=0,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t}return e.prototype.getRootCommentForCurrentElement=function(e){if(this.items[this.pointer]){var t=Rt.i(this.items[this.pointer]);if(e&&e.commentId===t)return e;for(var n=this.pointer;n>=0;--n){var r=this.items[n];if(Object(Nt.a)(r)&&r.commentModel.commentId===t)return r.commentModel}for(n=this.pointer+1;n<this.items.length;++n){r=this.items[n];if(Object(Nt.a)(r)&&r.commentModel.commentId===t)return r.commentModel}}},e.prototype.next=function(){var e,t=this.pointer;if(this.pointer<this.items.length-1)if(this.ignoreResolvedThreads)do{++this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer<this.items.length&&e&&e.commentFlags&Ft.a.Resolved);else++this.pointer;return this.pointer<this.items.length-1||this.pointer===this.items.length-1&&t<this.items.length-1?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e,t=this.pointer;if(this.pointer>0)if(this.ignoreResolvedThreads)do{--this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer>-1&&e&&e.commentFlags&Ft.a.Resolved);else--this.pointer;return this.pointer>0||0===this.pointer&&t>0?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}(),Lt=n(1264),Bt=function(){function e(e,t,n){this.commentStore=e,this.telemetryVisitor=t,this.useContentNavigationAPI=n}return e.prototype.selectThreadInCurrentContext=function(e,t,n,r,o){return Object(pt.a)(e,Xe.selectComment(t,n,void 0,r?Xe.SelectActionType.ExpandCard:Xe.SelectActionType.SelectCard,o))},e.prototype.collapseThreadInCurrentContext=function(e,t,n){return Object(pt.a)(e,Xe.collapseCard(t,n))},e.prototype.selectPost=function(e,t,n,r,o){return Object(pt.a)(e,Xe.selectComment(t,n,r,Xe.SelectActionType.SelectPost,o))},e.prototype.selectFirstThreadInCurrentContext=function(e,t,n,r,o){if(!Q.W()&&Q.X()){var a=rt.g(this.commentStore.getState(),!0,r),i=Object($e.G)(rt.h(this.commentStore.getState()),!0,r);if(i&&a&&0===a.flatIndex)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:L.d.reserveTag(588129411),telemetryVisitor:this.telemetryVisitor},i,!1,n)}var c=void 0,s=o?rt.a(this.commentStore.getState()):rt.k(this.commentStore.getState());if(Object(it.f)(s))c=o?new Dt.b(s,rt.d(this.commentStore.getState()),-1).next().value:s[0];else{var d=void 0;if(o)d=new Dt.a(s,-1,o).next().value;else d=s[0];c=null==d?void 0:d.commentId}if(c)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:L.d.reserveTag(593278811),telemetryVisitor:this.telemetryVisitor},c,t,n)},e.prototype.selectLastThreadInCurrentContext=function(e,t,n,r,o){var a=rt.d(this.commentStore.getState());if(!Object(it.c)(a)&&Q.X()){var i=rt.g(this.commentStore.getState(),!0,r),c=Object($e.G)(rt.h(this.commentStore.getState()),!0,r);if(c&&i&&i.flatIndex===a.length)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:L.d.reserveTag(588129412),telemetryVisitor:this.telemetryVisitor},c,!1,n)}var s=o?rt.a(this.commentStore.getState()):rt.k(this.commentStore.getState());if(Object($e.d)(s,a,o)){var d=void 0;if(Object(it.f)(s))d=o?new Dt.b(s,a,s.length).previous().value:s[s.length-1];else{var u=new Dt.a(s,s.length,o).previous().value;d=null==u?void 0:u.commentId}if(d)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:L.d.reserveTag(593278813),telemetryVisitor:this.telemetryVisitor},d,t,n);Object(U.k)().assertConditionTag(!1,"Unable to find last thread",593278812)}},e.prototype.focusAndCollapseSelectedThread=function(e,t){var n=rt.t(this.commentStore.getState());if(n){if(Q.X()&&Object($e.G)(rt.h(this.commentStore.getState()))===n.selectedCardId)return;var r=rt.j(this.commentStore.getState());if(Object(lt.a)(n.selectedCardId,r,t)===ct.a.Expanded)return Object(Lt.a)(e,Object(ht.a)(e,{componentType:yt.a.Card,id:n.selectedCardId,renderContextType:t}),this.collapseThreadInCurrentContext(e,{renderContextType:t,trackback:L.d.reserveTag(593278814),telemetryVisitor:this.telemetryVisitor},n.selectedCardId))}},e.prototype.selectNextOrPreviousGetIdOrFocusCommandIfNecessary_deprecated=function(e,t,n,r,o,a,i,c){var s,d=t.direction===ie.d.Next?e.next():e.previous();if(Q.X()&&n&&r&&o.selectedCardId!==n&&(t.direction===ie.d.Next?a<r.flatIndex&&(d.done||e.currentIndex()>=r.flatIndex):a>=r.flatIndex&&(d.done||e.currentIndex()<r.flatIndex)))return this.selectThreadInCurrentContext(i,{renderContextType:c,trackback:L.d.reserveTag(588289059),telemetryVisitor:this.telemetryVisitor},n,!1,t.source);return d.done||(s=d.value.commentId),s},e.prototype.selectNextOrPreviousThread=function(e,t,n,r,o){var a=this.commentStore.getState(),i=rt.t(a);if(this.useContentNavigationAPI&&(!i||r===ut.a.DiscreteIntegrated||r===ut.a.None&&at.e(a)!==be.a.Visible)){if(void 0!==n)return Object(pt.a)(e,Xe.selectContent({renderContextType:r,trackback:L.d.reserveTag(578352064),telemetryVisitor:this.telemetryVisitor},t.direction,t.iterableContentTypes,!!t.restrictToCurrentContext,!!t.restrictToCurrentContext,i?{contentId:i.selectedCardId,contentType:G.b.CommentThread}:void 0,n));Object(U.k)().assertConditionTag(!1,"contentNavigationReason undefined when expecting to use content navigation",560756106)}var c=o?rt.a(this.commentStore.getState()):rt.k(this.commentStore.getState()),s=rt.f(a).nextPopulatedContextDetails,d=t.direction===ie.d.Next,u=rt.g(a,!0,r);if(void 0!==i&&(o||Object(Je.b)(this.commentStore.getState(),i.selectedCardId))){var l=Object($e.G)(rt.h(a),!0,r),f=void 0;f=!Object(it.f)(c)&&Q.X()&&u&&i.selectedCardId===l?u.flatIndex+(d?-1:0):this.getSelectedThreadIndex(c);var m=void 0;if(Object(it.f)(c))if(o){var p=new Dt.b(c,rt.d(a),f);m=d?p.next().value:p.previous().value}else m=c[f+(d?1:-1)];else{p=new Dt.a(c,f,o);var h=this.selectNextOrPreviousGetIdOrFocusCommandIfNecessary_deprecated(p,t,l,u,i,f,e,r);if(h&&"string"!=typeof h)return h;m=h}if(m)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:L.d.reserveTag(593278816),telemetryVisitor:this.telemetryVisitor},m,t.expandCard,t.source);if(!t.restrictToCurrentContext)return this.selectAcrossContexts(e,t,r,s,o)}else{if(Object($e.d)(o?rt.a(this.commentStore.getState()):rt.k(this.commentStore.getState()),rt.d(a),o)||!Q.W()&&Q.X()&&u)return this.selectFirstThreadInCurrentContext(e,t.expandCard,t.source,r,o);if(!t.restrictToCurrentContext&&s!==Pt.a.NoComments)return this.selectAcrossContexts(e,t,r,s,o)}},e.prototype.selectAcrossContexts=function(e,t,n,r,o){return this.useContentNavigationAPI&&!at.a(this.commentStore.getState())&&Object(U.k)().assertConditionTag(!1,"This method should not be used for DHC iteration across contexts when the content navigation API is being used.",560551957),t.direction===ie.d.Next?r===Pt.a.OnlyCommentsInCurrent?this.selectFirstThreadInCurrentContext(e,t.expandCard,t.source,n,o):Object(pt.a)(e,Xe.selectFirstThreadInNextCommentContext({renderContextType:n,trackback:L.d.reserveTag(593278817),telemetryVisitor:this.telemetryVisitor})):r===Pt.a.OnlyCommentsInCurrent?this.selectLastThreadInCurrentContext(e,t.expandCard,t.source,n,o):Object(pt.a)(e,Xe.selectLastThreadInPreviousCommentContext({renderContextType:n,trackback:L.d.reserveTag(593278818),telemetryVisitor:this.telemetryVisitor}))},e.prototype.selectNextPostWithinCard=function(e,t,n){var r=rt.t(this.commentStore.getState());if(void 0!==r){if(!Q.c()){var o=rt.d(this.commentStore.getState()),a=this.getSelectedIndex(),i=void 0,c=void 0;if(Object(it.c)(o)){var s=rt.b(this.commentStore.getState())[r.selectedCardId];s&&a<s.length-1&&(i=r.selectedCardId,c=s[a+1])}else{var d=new At(o,a).next(),u=o[a];!d.done&&d.value.parentId&&d.value.parentId===Object(xt.b)(u)&&(i=d.value.parentId,c=d.value.commentId)}return i&&c?this.selectPost(e,{renderContextType:t,trackback:L.d.reserveTag(593278854),telemetryVisitor:this.telemetryVisitor},i,c,Qe.a.SharedComments):void 0}if(n){var l=this.getSelectedIndexFromRenderableItems(n);if(!(l<0)){var f=new Mt(n,l).next(),m=n[l],p=Rt.i(m);return f.done||Rt.i(f.value)!==p?void 0:this.selectPost(e,{renderContextType:t,trackback:L.d.reserveTag(593278856),telemetryVisitor:this.telemetryVisitor},Rt.i(f.value),Rt.e(f.value),Qe.a.SharedComments)}Object(U.k)().assertConditionTag(!1,"Selection not found in renderableItems",571777352)}else Object(U.k)().assertConditionTag(!1,"renderableItems must not be undefined",593278855)}else Object(U.k)().assertConditionTag(!1,"Expected selectedComment",593278853)},e.prototype.selectPreviousPostWithinCard=function(e,t,n){var r=rt.t(this.commentStore.getState());if(void 0!==r){if(!Q.c()){var o=rt.d(this.commentStore.getState()),a=this.getSelectedIndex(),i=void 0,c=void 0;if(Object(it.c)(o)){var s=rt.b(this.commentStore.getState())[r.selectedCardId];s&&a>0&&(i=r.selectedCardId,c=s[a-1])}else{var d=o[a];if(d.parentId)(l=new At(o,a).previous()).done||Object(xt.b)(l.value)!==d.parentId||(i=Object(xt.b)(l.value),c=l.value.commentId)}return i&&c?this.selectPost(e,{renderContextType:t,trackback:L.d.reserveTag(593278858),telemetryVisitor:this.telemetryVisitor},i,c,Qe.a.SharedComments):void 0}if(n){var u=this.getSelectedIndexFromRenderableItems(n);if(u<0)Object(U.k)().assertConditionTag(!1,"Selection not found in renderableItems",571777353);else{var l,f=n[u],m=Rt.g(f);if(m)if(!(l=new Mt(n,u).previous()).done&&Rt.i(l.value)===m)return this.selectPost(e,{renderContextType:t,trackback:L.d.reserveTag(593278860),telemetryVisitor:this.telemetryVisitor},Rt.i(l.value),Rt.e(l.value),Qe.a.SharedComments)}}else Object(U.k)().assertConditionTag(!1,"renderableItems must not be undefined",593278859)}else Object(U.k)().assertConditionTag(!1,"Expected selectedComment",593278857)},e.prototype.selectRootPostOfSelectedThread=function(e,t){var n=rt.t(this.commentStore.getState());if(n&&!Object(nt.j)(n.selectionDetails))return this.selectPost(e,{renderContextType:t,trackback:L.d.reserveTag(593278861),telemetryVisitor:this.telemetryVisitor},n.selectedCardId,n.selectedCardId,Qe.a.SharedComments)},e.prototype.focusAndSelectSiblingThread=function(e,t){if(!(t<0)){var n=rt.k(this.commentStore.getState()),r=Object(it.f)(n)?n:n.filter((function(e){return!e.parentId}));if(0!==r.length&&(0!==t||1!==r.length)){var o;t>r.length?(Object(U.k)().assertConditionTag(!1,"Passed in threadIndex too large.",526660886),o=r.length-1):o=t>=1?t-1:t+1;var a=Object(it.f)(r)?r[o]:r[o].commentId;return Object(Lt.a)(void 0,Object(ht.a)(void 0,{componentType:yt.a.Card,id:a,renderContextType:e}),Object(pt.a)(void 0,Xe.selectComment({renderContextType:e,trackback:L.d.reserveTag(593278862),telemetryVisitor:this.telemetryVisitor},a,void 0,Xe.SelectActionType.SelectCard,Qe.a.SharedComments)))}}},e.prototype.getSelectedIndex=function(){var e=this.commentStore.getState();return Object($e.u)(rt.d(e),rt.b(e),rt.t(e))},e.prototype.getSelectedThreadIndex=function(e){return Object($e.M)(e,rt.t(this.commentStore.getState()))},e.prototype.getSelectedIndexFromRenderableItems=function(e){var t=rt.t(this.commentStore.getState());if(!t)return-1;var n=Object(nt.b)(t);return Q.V()?e.findIndex((function(e){return Rt.e(e)===n})):e.findIndex((function(e){return Object(Nt.a)(e)?e.commentModel.commentId===n:e.historyItem.records[0].recordId===n}))},e}(),Vt=function(){function e(e,t){var n=this;this.isRTL=e,this.telemetryVisitor=t,this.focusToRetry=void 0,this.draftToFocus=void 0,this._commentStore=void 0,this.commandExecutor=Object(vt.b)(vt.a,[Et.a.FocusComponent]),this.pendingOnComponentFocusedRequest=void 0,this.clearPendingOnComponentFocusedRequest=function(e){var t=e?Object(gt.d)(e):"";!n.pendingOnComponentFocusedRequest||""!==t&&t===Object(gt.d)(n.pendingOnComponentFocusedRequest.targetedComponent)||(Ke.a&&Object(L.i)("Pending component focused request cleared."),clearTimeout(n.pendingOnComponentFocusedRequest.token),n.pendingOnComponentFocusedRequest=void 0)},this.commandOnWillFocusCallback=function(e){n.clearPendingOnComponentFocusedRequest(e)},this.commandExecuteCallback=function(e,t){e&&Object(ht.b)(e)&&(t===dt.a.ShouldRetry?n.focusToRetry={command:e,timestamp:Date.now()}:t===dt.a.Handled&&(n.focusToRetry=void 0))},this.commentContentsKeyDown=wt((function(){return n.commentStore}),this.isRTL,(function(e){var t=rt.h(n.commentStore.getState());if(Q.X()){var r=Object($e.I)(t);if(r&&e.isFocusOnOrWithin({componentType:yt.a.CardEditor,id:r,renderContextType:t.drafts[t.cardIdToDraftIdMap[r]].renderContextType}))return!1;var o=Object($e.J)(t);if(o&&e.isFocusOnOrWithin({componentType:yt.a.PostEditor,id:o,renderContextType:t.drafts[t.postIdToDraftIdMap[o]].renderContextType}))return!1}else if(Object(tt.c)(t))return!1;return!e.isFocusOn({componentType:yt.a.GhostCard})}),{ArrowDown:{handler:function(e,t,r){var o=n.onDownKey(e,t,r?r():void 0);return o&&(o.stopPropagation=!0,o.preventDefault=!0),o},phase:We.a.Bubbling},ArrowUp:{handler:function(e,t,r){var o=n.onUpKey(e,t,r?r():void 0);return o&&(o.stopPropagation=!0,o.preventDefault=!0),o},phase:We.a.Bubbling},ArrowRight:{handler:function(e,t){if(t.componentTreeId.renderContextType!==ut.a.HalfPane){var r=n.onRightKey(e,t);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r}},phase:We.a.Bubbling},ArrowLeft:{handler:function(e,t){if(t.componentTreeId.renderContextType!==ut.a.HalfPane){var r=n.onLeftKey(e,t.componentTreeId.renderContextType);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r}},phase:We.a.Bubbling},Home:{handler:function(e,t){if(t.componentTreeId.renderContextType===ut.a.FullPane){var r=n.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!0,Qe.a.SharedComments,t.componentTreeId.renderContextType,!1);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r}},phase:We.a.Capturing},End:{handler:function(e,t){if(t.componentTreeId.renderContextType===ut.a.FullPane){var r=n.selectionCommandFactory.selectLastThreadInCurrentContext(e,!0,Qe.a.SharedComments,t.componentTreeId.renderContextType,!1);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r}},phase:We.a.Capturing},F12:{handler:function(e,t){var r=e.altKey?n.handleMoveFocusEvent(e,t):void 0;return r&&(r.stopPropagation=!0),r},phase:We.a.None},Escape:{handler:function(e,t){var r="win32"===Object(ft.a)()?n.handleMoveFocusEvent(e,t):void 0;return r&&(r.stopPropagation=!0),r},phase:We.a.None}},this.commandExecutor),this.focusCommentCardCommand=Ot((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){var r=rt.h(n.commentStore.getState()),o=Object($e.K)(r),a=void 0;return(a=n.checkForRetryOfEditorFocus(e,r))||!Q.X()&&(null==o?void 0:o.threadId)===t&&(a=n.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,r))?a:Object(ht.a)(void 0,{componentType:Object(gt.c)(t,r),id:t,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:1},preventScroll:e.componentTreeId.renderContextType===ut.a.DiscreteIntegrated})}),this.commandExecutor),this.focusCommentPostCommand=Ot((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){var r=rt.h(n.commentStore.getState());if(!Q.X()&&r.postIdToDraftIdMap[t]){var o=n.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,r);if(o)return o}return Object(ht.a)(void 0,{componentType:yt.a.Post,id:t,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:2,phase:1}})}),this.commandExecutor),this.focusCommentPaneCommand=Ot((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e){if(Object(mt.b)(e.componentTreeId.renderContextType)){var t=rt.h(n.commentStore.getState()),r=rt.t(n.commentStore.getState()),o=void 0;if(o=n.checkForRetryOfEditorFocus(e,t))return o;if(!e.isFocusWithinPane()||e.isFocusOn({componentType:yt.a.PaneRoot})){if(!Q.X()&&(o=n.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,t)))return o;if(o=n.checkForCommentSelectionFocus(e.componentTreeId.renderContextType,r,t))return o;if(!Q.E()&&!e.getComponent(yt.a.ClosePaneButton)){var a=rt.k(n.commentStore.getState());return a.length>0?n.focusCommentCardCommand.processCommand(e,Object(it.f)(a)?a[0]:a[0].commentId):void Object(U.k)().assertConditionTag("win32"===Object(ft.a)(),"Shouldn't be reached on current config",575239243)}return Tt(e,n.commentStore)}}else Object(U.k)().assertConditionTag(!1,"paneContainerFocusHandler called outside of a pane render context",575239242)}),this.commandExecutor),this.commentCardMounted=Ot((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){var r,o=rt.h(n.commentStore.getState()),a={componentType:Object(gt.c)(t.id,o),id:t.id,renderContextType:e.componentTreeId.renderContextType};if(r=n.handleFocusRetry(e,a,o,1))return r;if(t.selected&&!e.isFocusWithin(a)){var i=Object(mt.b)(e.componentTreeId.renderContextType);if((!i||e.isFocusWithinPane())&&(i||e.isFocusWithinAny(yt.a.Card)||e.isFocusWithinAny(yt.a.DraftCard)))return n.focusCommentCardCommand.processCommand(e,t.id)}}),this.commandExecutor),this.commentCardEditorMounted=Ot((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){return n.handleFocusRetry(e,{componentType:yt.a.CardEditor,id:t,renderContextType:e.componentTreeId.renderContextType},rt.h(n.commentStore.getState()),1)}),this.commandExecutor),this.commentPostMounted=Ot((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){return n.handleFocusRetry(e,{componentType:yt.a.Post,id:t,renderContextType:e.componentTreeId.renderContextType},rt.h(n.commentStore.getState()),1)}),this.commandExecutor),this.commentPostEditorMounted=Ot((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){return n.handleFocusRetry(e,{componentType:yt.a.PostEditor,id:t,renderContextType:e.componentTreeId.renderContextType},rt.h(n.commentStore.getState()),1)}),this.commandExecutor),this.commentPanePropsUpdated=Ot((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t,r){var o=void 0;if(o=n.checkForRetryCommandOnPropsUpdated(e,r.draftState,!1))return o;var a=t.draftState,i=r.draftState,c=t.selectedComment,s=r.selectedComment;return(o=n.checkForDiscard(e,a,i,c,s))||(o=n.checkForHalfPaneFullTransition(e,t,r))?o:e.isFocusWithinPane()?(o=n.checkForLowFidelityWarning(e,c,s))||(o=n.checkForSelectionChange(e,i,c,s))||(o=n.checkForCardPendingChange(e,t.cardViewStates,r.cardViewStates,i))||(o=n.checkForReplyFinished(e,s,t.draftState,r.draftState,s&&r.cardViewStates[s.selectedCardId]))?o:n.checkForLowFidelityWarning(e,c,s):void 0}),this.commandExecutor),this.discreteCommentCardRootRefMounted=function(e){},this.discreteCommentCardPropsUpdated=Ot((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t,r){var o=void 0;return(o=n.checkForRetryCommandOnDiscreteCardPropsUpdated(e,r))||(o=n.checkForDiscard(e,t.draftState,r.draftState,t.selectedState,r.selectedState))?o:e.isFocusWithinAny(yt.a.Card)||e.isFocusWithinAny(yt.a.DraftCard)?n.shouldFocusFromCardPendingStateChange(t.cardState,r.cardState)?Object(ht.a)(void 0,{renderContextType:e.componentTreeId.renderContextType,componentType:Object(gt.b)(r.isDraftThread),id:r.threadId}):(o=n.checkForLowFidelityWarning(e,t.selectedState,r.selectedState))||(o=n.checkForSelectionChange(e,r.draftState,t.selectedState,r.selectedState))||(o=n.checkForReplyFinished(e,r.selectedState,t.draftState,r.draftState,r.cardState))?o:n.checkForLowFidelityWarning(e,t.selectedState,r.selectedState):void 0}),this.commandExecutor),this.paneContainerKeyDown=wt((function(){return n.commentStore}),this.isRTL,(function(e){return!!Object(mt.b)(e.componentTreeId.renderContextType)||(Object(U.k)().assertConditionTag(!1,"paneContainerKeyDownHandler called outside of a pane render context",575239244),!1)}),{Escape:{handler:function(e,t){return Object(pt.a)(e,Xe.requestClosePane({renderContextType:t.componentTreeId.renderContextType,trackback:L.d.reserveTag(575239245),telemetryVisitor:n.telemetryVisitor}))},phase:We.a.Capturing},Tab:{handler:function(e,t){return n.paneContainerTabHandling(e,t)},phase:We.a.None}},this.commandExecutor),this.commentEditorKeyDown=wt((function(){return n.commentStore}),this.isRTL,(function(){return!0}),{F12:{handler:function(e,t){var r=e.altKey?n.handleMoveFocusEvent(e,t):void 0;return r&&(r.stopPropagation=!0),r},phase:We.a.None}},this.commandExecutor),this.onUserAction=Ot((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){var r;switch(t.userAction){case kt.a.RequestNewCommentFromHost:if(!Object(mt.b)(e.componentTreeId.renderContextType))return;return Tt(e,n.commentStore);case kt.a.CancelReplyDraft:return Object(ht.a)(void 0,{componentType:yt.a.Card,id:t.cardId,renderContextType:e.componentTreeId.renderContextType});case kt.a.DeleteThread:case kt.a.CancelNewThreadDraft:if(!Object(mt.b)(e.componentTreeId.renderContextType))return;if(e.componentTreeId.renderContextType===ut.a.HalfPane&&t.userAction===kt.a.CancelNewThreadDraft)return;return null!==(r=Tt(e,n.commentStore,{priority:3,phase:0}))&&void 0!==r?r:n.selectionCommandFactory.focusAndSelectSiblingThread(e.componentTreeId.renderContextType,t.threadIndex);case kt.a.ResolveThread:if("android"!==Object(ft.a)())return;return Object(ht.a)(void 0,{componentType:yt.a.ReopenThreadButton,id:t.cardId,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:2,phase:3}});default:Object(L.m)(t)}}),this.commandExecutor)}return e.prototype.postOnComponentFocusedRequest=function(e,t){this.clearPendingOnComponentFocusedRequest();var n=setTimeout(t,500);this.pendingOnComponentFocusedRequest={callback:t,token:n,targetedComponent:e},Ke.a&&Object(L.i)("Pending component focused request added for ".concat(Object(gt.d)(e),"."))},e.prototype.initialize=function(e,t,n){if(this._commentStore)throw new me.a("FocusManager already initialized",L.d.reserveTag(575239239),-2130957489);this._commentStore=e,this.selectionCommandFactory=null!=n?n:new Bt(e,this.telemetryVisitor,t)},Object.defineProperty(e.prototype,"commentStore",{get:function(){if(!this._commentStore)throw new me.a("FocusManager not initialized",L.d.reserveTag(575239240),-2130957490);return this._commentStore},enumerable:!1,configurable:!0}),e.prototype.setDeferredActiveEditorFocusCommand=function(e){this.draftToFocus={draftId:e,timestamp:Date.now(),isPendingSetFocus:!0}},e.prototype.handleFocusRetry=function(e,t,n,r){var o;if(o=this.checkForRetryOfEditorFocus(e,n))return o;if(this.focusToRetry&&t){var a=this.focusToRetry.command.component,i=Date.now()-this.focusToRetry.timestamp;if(i>15e3)return Object(U.k)().assertConditionTag(!1,"Took too long to mount component type ".concat(a.componentType," for focus retry: ").concat(i," ms"),575239241),void(this.focusToRetry=void 0);if(this.shouldRetryFocusForPhase(this.focusToRetry,r)&&Object(yt.b)(a,t)){var c=this.focusToRetry.command;return this.focusToRetry=void 0,c}}},e.prototype.shouldArrowNavigatePosts=function(e,t,n){return Object(lt.a)(e.selectedCardId,t,n.componentTreeId.renderContextType)!==ct.a.Collapsed&&(e.selectedCardId!==Object($e.G)(rt.h(this.commentStore.getState()))&&n.isFocusWithinAny(yt.a.Post))},e.prototype.onDownKey=function(e,t,n){var r=Q.r()&&!at.a(this.commentStore.getState()),o=rt.t(this.commentStore.getState()),a=rt.j(this.commentStore.getState());if(o){if(!this.shouldArrowNavigatePosts(o,a,t)){if(t.componentTreeId.renderContextType===ut.a.DiscreteIsolated)return;var i={direction:ie.d.Next,source:Qe.a.SharedComments,expandCard:!1,restrictToCurrentContext:!0,iterableContentTypes:void 0};return this.selectionCommandFactory.selectNextOrPreviousThread(e,i,ie.c.Keyboarding,t.componentTreeId.renderContextType,r)}return this.selectionCommandFactory.selectNextPostWithinCard(e,t.componentTreeId.renderContextType,n)}if(t.componentTreeId.renderContextType!==ut.a.DiscreteIsolated)return this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,Qe.a.SharedComments,t.componentTreeId.renderContextType,r);Object(U.k)().assertConditionTag(!1,"selectedComment missing on down key handler for DiscreteIsolated card",575239249)},e.prototype.onUpKey=function(e,t,n){var r=Q.r()&&!at.a(this.commentStore.getState()),o=rt.t(this.commentStore.getState()),a=rt.j(this.commentStore.getState());if(o){if(!this.shouldArrowNavigatePosts(o,a,t)){if(t.componentTreeId.renderContextType===ut.a.DiscreteIsolated)return;var i={direction:ie.d.Previous,source:Qe.a.SharedComments,expandCard:!1,restrictToCurrentContext:!0,iterableContentTypes:void 0};return this.selectionCommandFactory.selectNextOrPreviousThread(e,i,ie.c.Keyboarding,t.componentTreeId.renderContextType,r)}return this.selectionCommandFactory.selectPreviousPostWithinCard(e,t.componentTreeId.renderContextType,n)}if(t.componentTreeId.renderContextType!==ut.a.DiscreteIsolated)return this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,Qe.a.SharedComments,t.componentTreeId.renderContextType,r);Object(U.k)().assertConditionTag(!1,"selectedComment missing on up key handler for DiscreteIsolated card",575239250)},e.prototype.onRightKey=function(e,t){var n=rt.t(this.commentStore.getState());if(!Q.X()||!n||n.selectedCardId!==Object($e.G)(rt.h(this.commentStore.getState()))){var r=this.selectionCommandFactory.selectRootPostOfSelectedThread(e,t.componentTreeId.renderContextType);return r||(n&&Object(nt.j)(n.selectionDetails)&&t.isFocusOn({componentType:yt.a.Card,id:n.selectedCardId,renderContextType:t.componentTreeId.renderContextType})&&(r=this.focusCommentPostCommand.processCommand(t,n.selectionDetails.selectedPostId)),r||void 0)}},e.prototype.onLeftKey=function(e,t){return this.selectionCommandFactory.focusAndCollapseSelectedThread(e,t)},e.prototype.onTabKeyInPane=function(e,t){var n=rt.t(this.commentStore.getState());return void 0!==n&&Object(Je.b)(this.commentStore.getState(),n.selectedCardId)||!rt.m(this.commentStore.getState())?Q.X()?void 0:this.checkForActiveEditorFocus(e,t,rt.h(this.commentStore.getState())):this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,Qe.a.SharedComments,t,!1)},e.prototype.isDraftInOtherContext=function(){var e=rt.v(this.commentStore.getState());return!!e&&!e.isInCurrentContext},e.prototype.logEditorRetryError=function(e,t,n,r){var o,a,i;null===(a=(o=Object(U.k)()).logDiagnosticTrace)||void 0===a||a.call(o,Object(ze.a)(jt||(jt=Object(X.e)(["CommentsEditorFocusRetry"],["CommentsEditorFocusRetry"]))),r,U.h.Info,U.c.ProductServiceUsage,this.telemetryVisitor,Object(U.o)("RenderContextType",t.componentTreeId.renderContextType,U.d.SystemMetadata),Object(U.o)("IsDraftInCurrentContext",!!e&&e.isInCurrentContext,U.d.SystemMetadata),Object(U.o)("DraftRenderContextType",null!==(i=null==e?void 0:e.renderContextType)&&void 0!==i?i:ut.a.None,U.d.SystemMetadata),Object(U.o)("ComponentType",null!=n?n:0,U.d.SystemMetadata))},e.prototype.checkForRetryOfEditorFocus=function(e,t){var n=this;if(void 0!==this.draftToFocus){if(!this.draftToFocus.isPendingSetFocus)return{causedBy:void 0,type:Et.a.PreserveFocus,priorityArgs:{priority:1}};var r=t.drafts[this.draftToFocus.draftId],o=Date.now()-this.draftToFocus.timestamp;if(o>15e3)return Object(U.k)().assertConditionTag(!1,"Took too long to focus draft editor: ".concat(o," ms, expected draft still exists: ").concat(!!r),575239251),this.draftToFocus=void 0,void this.logEditorRetryError(r,e,void 0,L.d.reserveTag(556607431));if(r&&r.renderContextType===e.componentTreeId.renderContextType){var a=this.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,t,{priority:2,phase:0});if(a&&bt(e,a.component))return this.draftToFocus=Object(X.a)(Object(X.a)({},this.draftToFocus),{isPendingSetFocus:!1}),setTimeout((function(){return n.draftToFocus=void 0})),this.clearPendingOnComponentFocusedRequest(),a;this.logEditorRetryError(r,e,null==a?void 0:a.component.componentType,L.d.reserveTag(556794947))}else this.logEditorRetryError(r,e,void 0,L.d.reserveTag(556794945))}},e.prototype.checkForActiveEditorFocus=function(e,t,n,r){if(void 0===r&&(r={priority:1}),!this.isDraftInOtherContext()){var o=Object($e.J)(n);if(o)return Object(ht.a)(e,{componentType:yt.a.PostEditor,id:o,renderContextType:t},{priorityArgs:r});var a=Object($e.I)(n);return a?Object(ht.a)(e,{componentType:yt.a.CardEditor,id:a,renderContextType:t},{priorityArgs:r}):void 0}},e.prototype.handleMoveFocusEvent=function(e,t){var n=rt.t(this.commentStore.getState()),r=n?{contentId:null==n?void 0:n.selectedCardId,contentType:G.b.CommentThread}:void 0;return Object(pt.a)(e,Xe.moveFocusToCanvas({renderContextType:t.componentTreeId.renderContextType,trackback:L.d.reserveTag(575239252),telemetryVisitor:this.telemetryVisitor},r))},e.prototype.checkForCommentSelectionFocus=function(e,t,n){if(Q.X()||!this.isDraftInOtherContext())return t&&t.selectedCardId?Object(ht.a)(void 0,{componentType:Object(gt.c)(t.selectedCardId,n),id:t.selectedCardId,renderContextType:e},{priorityArgs:{priority:2,phase:1}}):void 0},e.prototype.checkForDiscard=function(e,t,n,r,o){if("web"!==Object(ft.a)()&&r&&o){var a=r.selectionDetails,i=o.selectionDetails;if(Object(tt.j)(t)&&!Object(tt.c)(n))return this.focusCommentCardCommand.processCommand(e,o.selectedCardId);if(Object(nt.j)(a)===Object(nt.j)(i)&&r.selectedCardId===o.selectedCardId&&Object(tt.m)(t,n)){if(!Object(nt.j)(a)||!Object(nt.j)(i))return Object(ht.a)(void 0,{componentType:yt.a.CardEditor,id:o.selectedCardId,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:3,phase:1}});if(a.selectedPostId===i.selectedPostId)return Object(ht.a)(void 0,{componentType:yt.a.PostEditor,id:i.selectedPostId,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:3,phase:1}})}}},e.prototype.paneContainerTabHandling=function(e,t){if("win32"!==Object(ft.a)()){var n=this.commentStore.getState(),r=rt.p(n).virtualized;if(!Object(Ze.a)(rt.q(n),r,!!ot.g(n)))return(d=Object(ht.a)(e,{componentType:yt.a.ClosePaneButton})).stopPropagation=!0,d.preventDefault=!0,d;var o=t.getComponent(yt.a.ClosePaneButton),a=t.getComponent(yt.a.NewCommentButton),i=!rt.p(n).newThread||!a?o:a;if(Q.n()){var c=rt.t(n),s=rt.h(n),d=void 0;return c&&Object(Je.b)(n,c.selectedCardId)?Q.X()||t.isFocusWithin({componentType:Object(gt.c)(c.selectedCardId,s),id:c.selectedCardId,renderContextType:t.componentTreeId.renderContextType})||(d=this.checkForActiveEditorFocus(e,t.componentTreeId.renderContextType,s)):i&&e.isEventTarget(i)&&!e.shiftKey&&(d=this.onTabKeyInPane(e,t.componentTreeId.renderContextType)),d&&(d.stopPropagation=!0,d.preventDefault=!0),d}if(o&&e.isEventTarget(o)&&e.shiftKey)return(d=this.onTabKeyInPane(e,t.componentTreeId.renderContextType))&&(d.preventDefault=!0,d.stopPropagation=!0),d;if(i&&e.isEventTarget(i)&&!e.shiftKey)return(d=this.onTabKeyInPane(e,t.componentTreeId.renderContextType))&&(d.preventDefault=!0,d.stopPropagation=!0),d}},e.prototype.checkForSelectionChange=function(e,t,n,r){if(r&&((!n||Object(nt.b)(n)!==Object(nt.b)(r)||Object(nt.j)(n.selectionDetails)!==Object(nt.j)(r.selectionDetails))&&(this.clearPendingOnComponentFocusedRequest(),(Q.X()||!Object(tt.d)(t))&&!e.isFocusOn({componentType:yt.a.NextCommentButton})&&!e.isFocusOn({componentType:yt.a.PreviousCommentButton})))){if(!Object(nt.j)(r.selectionDetails)){if(e.isFocusOnOrWithin({componentType:r.selectedCardId!==(null==n?void 0:n.selectedCardId)?Object(gt.c)(r.selectedCardId,t):yt.a.CardEditor,id:r.selectedCardId,renderContextType:e.componentTreeId.renderContextType},!0))return;return this.focusCommentCardCommand.processCommand(e,r.selectedCardId)}if(!e.isFocusOnOrWithin({componentType:yt.a.Post,id:r.selectionDetails.selectedPostId,renderContextType:e.componentTreeId.renderContextType}))return this.focusCommentPostCommand.processCommand(e,r.selectionDetails.selectedPostId)}},e.prototype.checkForReplyFinished=function(e,t,n,r,o){var a=Object($e.I)(n),i=Object($e.I)(r);if(o&&o.pending!==et.a.Editor)return a&&!i&&(null==t?void 0:t.selectedCardId)===a&&e.isFocusWithin({componentType:yt.a.Card,id:a,renderContextType:e.componentTreeId.renderContextType})?this.focusCommentCardCommand.processCommand(e,a):void 0},e.prototype.checkForHalfPaneFullTransition=function(e,t,n){if(e.componentTreeId.renderContextType===ut.a.HalfPane&&Object(Ye.b)(n.displayConfigurationState)&&n.displayConfigurationState.displayMode===Ye.a.Normal&&(!Object(Ye.b)(t.displayConfigurationState)||t.displayConfigurationState.displayMode===Ye.a.Variable))return Object(ht.a)(void 0,{componentType:yt.a.ClosePaneButton})},e.prototype.shouldFocusFromCardPendingStateChange=function(e,t){return!!e&&(e.pending!==t.pending&&t.pending!==et.a.Editor)},e.prototype.checkForCardPendingChange=function(e,t,n,r){var o=this,a=Object.entries(n).find((function(e){var n=t[e[0]];return o.shouldFocusFromCardPendingStateChange(n,e[1])}));if(a)return Object(ht.a)(void 0,{renderContextType:e.componentTreeId.renderContextType,componentType:Object(gt.c)(a[0],r),id:a[0]})},e.prototype.checkForRetryCommandOnPropsUpdated=function(e,t,n){var r=!n&&this.focusToRetry&&this.shouldRetryFocusForPhase(this.focusToRetry,2)&&bt(e,this.focusToRetry.command.component)?this.focusToRetry.command.component:void 0;return this.handleFocusRetry(e,r,t,2)},e.prototype.checkForRetryCommandOnDiscreteCardPropsUpdated=function(e,t){var n=this.focusToRetry&&this.shouldRetryFocusForPhase(this.focusToRetry,2)&&(!Object(yt.c)(this.focusToRetry.command.component)||!Object(yt.d)(this.focusToRetry.command.component.componentType)||this.focusToRetry.command.component.id===t.threadId),r=this.draftToFocus&&(t.cardRelativeDraftingState===st.a.InCard||t.cardRelativeDraftingState===st.a.InChildPost);if(n||r)return this.checkForRetryCommandOnPropsUpdated(e,t.draftState,!n)},e.prototype.checkForLowFidelityWarning=function(e,t,n){if(n&&(Q.n()?Object(nt.h)(n):Object(nt.g)(n))){var r=t?Object(nt.b)(t):void 0,o=Object(nt.b)(n);if(o!==r||n.selectionDetails.lowFidelityWarningType!==(null==t?void 0:t.selectionDetails.lowFidelityWarningType))return Object(ht.a)(void 0,{componentType:yt.a.Post,renderContextType:e.componentTreeId.renderContextType,id:o})}},e.prototype.shouldRetryFocusForPhase=function(e,t){return 1!==e.command.priorityArgs.priority&&0!=(e.command.priorityArgs.phase&t)},e}(),Ut=n(199);function _t(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(o){return"function"==typeof o?o(n,r,e):t(o)}}}}var Ht=_t();Ht.withExtraArgument=_t;var Gt,qt=Ht,zt=function(){return function(e){return function(t){return Object(ee.unstable_batchedUpdates)((function(){return e(t)}))}}},Wt=function(){return function(e){return function(t){var n="string"==typeof t.type?t.type:t.name||"Unknown Action",r=Object(L.k)(L.b.Redux,n),o=e(t);return null==r||r.end(),o}}},Yt=n(1078),Kt=n(1127),Xt=n(1041),Qt=n(1077),Jt=n(1260),Zt=n(1079),$t=n(1118);!function(e){e[e.None=0]="None",e[e.AtMentionKnown=1]="AtMentionKnown",e[e.AtMentionEnabled=2]="AtMentionEnabled",e[e.NewThread=4]="NewThread",e[e.Resolve=8]="Resolve",e[e.Virtualized=16]="Virtualized",e[e.TasksKnown=32]="TasksKnown",e[e.TasksEnabled=64]="TasksEnabled",e[e.PresentLinkToComment=128]="PresentLinkToComment",e[e.UIAAnnotationPattern=256]="UIAAnnotationPattern",e[e.ContentExtensionHostingDisabled=512]="ContentExtensionHostingDisabled"}(Gt||(Gt={}));var en=n(1103),tn=n(1043);function nn(e,t){for(var n=null==t?void 0:t(),r=[],o=0,a=void 0;o<e.length;){if(e[o].type===tn.a.Thread){var i=e[o].id;a=i,r.push(rn(i,void 0,n))}else r.push(rn(e[o].id,a,n));o++}return r}function rn(e,t,n){var r=void 0;return n&&(r=Object(it.b)(Object(it.a)(n),e)),r||Object(X.a)(Object(X.a)({},Object($e.e)(e)),{parentId:null!=t?t:""})}var on,an=n(1082),cn=n(1083),sn=n(1100),dn=n(1101);function un(e,t){var n=Object(Kt.c)(e);if(n)return n;Object(U.k)().assertConditionTag(!1,"immerDraft does not have original state",t)}function ln(e,t,n){var r=!1;if(Object(xt.a)(t)){var o=void 0===n;if(n){var a=function(e,t,n){if(n.insertFlatIndex<0)return{insertThreadIndex:-1};for(var r=!!(null==n?void 0:n.draftIdToSkip)||void 0,o=0,a=0;a<e.length;a++){if(o===n.insertFlatIndex)return{insertThreadIndex:a,beforeDraft:r};if(e[a]!==n.draftIdToSkip){if(o+=t[e[a]].length,n.insertFlatIndex<=o)return{insertThreadIndex:a+1,beforeDraft:r}}else r=!1}if(o===n.insertFlatIndex)return{insertThreadIndex:e.length,beforeDraft:r};return{insertThreadIndex:-1}}(e.commentThreadIds,e.cardPostIds,n);r=!!a.beforeDraft,a.insertThreadIndex>=0?e.commentThreadIds.splice(a.insertThreadIndex,0,t.commentId):(Object(U.k)().assertConditionTag(!1,"Invalid thread insert flat index.",512508103),o=!0)}o&&e.commentThreadIds.push(t.commentId),e.cardPostIds[t.commentId]=[t.commentId]}else{if(!e.cardPostIds[t.parentId])return void Object(U.k)().assertConditionTag(!1,"Orphaned post detected on processing comments array. Omitting storing data.",526242826);if(n){var i=function(e,t,n,r){for(var o=!!r||void 0,a=0,i=0;i<t.length;i++){if(t[i]===e)return{flatIndex:a,beforeDraft:o};t[i]!==r?a+=n[t[i]].length:o=!1}return{flatIndex:-1}}(t.parentId,e.commentThreadIds,e.cardPostIds,n.draftIdToSkip);r=!!i.beforeDraft;var c=n.insertFlatIndex-i.flatIndex;Object(U.k)().assertConditionTag(c>=1&&c<=e.cardPostIds[t.parentId].length,"Invalid insert post index.",520646683),c=Math.max(Math.min(c,e.cardPostIds[t.parentId].length),1),e.cardPostIds[t.parentId].splice(c,0,t.commentId)}else e.cardPostIds[t.parentId].push(t.commentId)}e.postData[t.commentId]=t,(null==n?void 0:n.draftIdToSkip)&&e.createdCommentLie&&r&&e.createdCommentLie.flatIndex++}function fn(e,t){var n=un(e,L.d.reserveTag(524031042));if(n){var r,o;if(e.draftState.pendingDraft)switch(e.draftState.pendingDraft.sessionType){case"REPLY":if(r=e.draftState.pendingDraft.threadId,!n.cardViewState[r])return;break;case"EDIT":if(o=e.draftState.pendingDraft.commentId,!n.postViewState[o])return;break;default:return}else{var a=$e.K(e.draftState);if(!a||!a.isInCurrentContext)return;switch(a.commentDraft.sessionConfiguration.sessionType){case"REPLY":r=a.threadId;break;case"EDIT":o=a.commentDraft.sessionConfiguration.commentId;break;default:return}}r&&!e.cardViewState[r]?(pn(e.draftState,r),Object(dn.b)(n.draftState,e.draftState,3,t,L.d.reserveTag(526242828))):o&&!e.postViewState[o]&&(hn(e.draftState,o),Object(dn.b)(n.draftState,e.draftState,2,t,L.d.reserveTag(526242829)))}}function mn(e,t,n,r){var o,a,i=un(e,L.d.reserveTag(524031047));if(i&&function(e,t){return!(!(e&&e.commentFlags&Ft.a.Resolved&&t)||t.commentFlags&Ft.a.Resolved)}(t,n)&&(e.selectedComment&&e.selectedComment.selectedCardId===t.commentId&&(Object(nt.j)(e.selectedComment.selectionDetails)||void 0!==e.selectedComment.selectionDetails.lowFidelityWarningType)&&(e.selectedComment.selectionDetails=$e.l()),t.commentId===(null===(o=$e.K(e.draftState))||void 0===o?void 0:o.threadId)&&(!function(e,t,n){pn(e,n);var r=$e.J(e);if(r){var o=e.postIdToDraftIdMap[r],a=e.drafts[o];a&&a.threadId===n&&hn(e,r)}if(e.pendingDraft&&Object(Zt.e)(e.pendingDraft)){var i=e.pendingDraft.commentId,c=t[i];c&&Object(xt.b)(c)===n&&(e.pendingDraft=void 0)}}(e.draftState,e.postData,t.commentId),Object(dn.b)(i.draftState,e.draftState,1,r,L.d.reserveTag(526242836))),(null===(a=i.cardViewState[t.commentId])||void 0===a?void 0:a.loadState.state)===cn.a.Loaded)){var c=$e.U(t.commentId,e.expandedComments,e.draftState,e.selectedComment);c!==e.expandedComments&&(e.expandedComments=c)}}function pn(e,t){e.pendingDraft&&Object(Zt.f)(e.pendingDraft)&&e.pendingDraft.threadId===t&&(e.pendingDraft=void 0);var n=e.cardIdToDraftIdMap[t];n&&(vn(e,n),delete e.cardIdToDraftIdMap[t])}function hn(e,t){e.pendingDraft&&Object(Zt.e)(e.pendingDraft)&&e.pendingDraft.commentId===t&&(e.pendingDraft=void 0);var n=e.postIdToDraftIdMap[t];n&&(vn(e,n),delete e.postIdToDraftIdMap[t])}function vn(e,t){e.drafts[t]?(Object(U.k)().assertConditionTag(1===Object.keys(e.drafts).length,"Invalid number of drafts",526131555),delete e.drafts[t]):Object(U.k)().assertConditionTag(0===Object.keys(e.drafts).length,"Invalid draftId",526131554)}function gn(e,t,n){var r,o,a=n,i=t.model.parentId;if(i&&(e.cardViewState[i]?e.cardViewState[i].pending=et.a.None:null===(o=null===(r=Object(U.k)())||void 0===r?void 0:r.logDiagnosticTrace)||void 0===o||o.call(r,Object(ze.a)(on||(on=Object(X.e)(["Inserting orphaned reply without root post?"],["Inserting orphaned reply without root post?"]))),L.d.reserveTag(520646684),U.h.Warning,U.c.ProductServiceUsage,Object(U.l)(U.g.ReviewedAsNotNecessary))),t.tempId){if(delete e.cardViewState[t.tempId],delete e.postViewState[t.tempId],e.draftState.committedLieId===t.tempId){var c=e.commentThreadIds.findIndex((function(e){return t.tempId===e}));c<0?Object(U.k)().assertConditionTag(!1,"ThreadId to delete not found",520646688):(e.commentThreadIds.splice(c,1),delete e.cardPostIds[t.tempId]),delete e.postData[t.tempId],e.createdCommentLie=void 0,e.draftState.committedLieId=void 0,a=void 0}if(e.selectedComment&&e.selectedComment.selectedCardId===t.tempId)if(e.selectedComment=$e.m(Object(xt.b)(t.model)),t.model.parentId)e.expandedComments.findIndex((function(e){return t.tempId===e}))>=0&&(e.expandedComments=$e.U(t.tempId,e.expandedComments,e.draftState,e.selectedComment));else e.expandedComments=$e.a(e.expandedComments,e.selectedComment,e.draftState)}Object(U.k)().assertConditionTag(!e.postViewState[t.model.commentId],"Received insert for existing comment",522856031),i||(e.cardViewState[t.model.commentId]=$e.i(t.tempId||void 0)),e.postViewState[t.model.commentId]=$e.k(t.model.displayDate),ln(e,t.model,{insertFlatIndex:t.index,draftIdToSkip:a})}function yn(e,t){var n=un(e,L.d.reserveTag(522856032));if(n){var r=e.postData[t.model.commentId],o=n.modelCapabilities.virtualized;if(r){e.postData[t.model.commentId]=t.model;var a=Object(xt.b)(t.model),i=e.cardViewState[a];i?(e.cardViewState[a].pending=et.a.None,i.loadState.state!==cn.a.Loading&&o||(e.cardViewState[a].loadState={state:cn.a.Loaded})):(Object(U.k)().assertConditionTag(!1,"Received Modify change without existing card state? Creating default.",522856033),e.cardViewState[a]=$e.i(void 0,o?cn.a.Placeholder:void 0)),e.postViewState[t.model.commentId]?r.displayDate===t.model.displayDate&&r.date===t.model.date||(e.postViewState[t.model.commentId].displayDate=$e.o(t.model.date,t.model.displayDate,e.localizationDetails.dataCulture),e.postViewState[t.model.commentId].pending=sn.a.None):e.postViewState[t.model.commentId]=$e.k($e.o(t.model.date,t.model.displayDate,e.localizationDetails.dataCulture)),mn(e,e.postData[t.model.commentId],r,2)}else Object(U.k)().assertConditionTag(!1,"change commentId not found in postData",522856034),Object(L.i)("change commentId not found in postData ".concat(t.model.commentId))}}function bn(e,t,n){var r,o,a,i=e.postData[t.model.commentId];if(i){var c=-1,s=0;if(Object(xt.a)(i))(c=e.commentThreadIds.findIndex((function(e){return i.commentId===e})))<0?Object(U.k)().assertConditionTag(!1,"ThreadId to delete not found",520646687):e.commentThreadIds.splice(c,1),s=null!==(o=null===(r=e.cardPostIds[i.commentId])||void 0===r?void 0:r.length)&&void 0!==o?o:0,e.cardPostIds[i.commentId].forEach((function(t){delete e.postData[t]})),delete e.cardPostIds[i.commentId];else{if(Object(U.k)().assertConditionTag(void 0!==e.cardPostIds[i.parentId],"Orphaned reply delete received",520646686),c=e.commentThreadIds.findIndex((function(e){return i.parentId===e})),e.cardPostIds[i.parentId]){var d=e.cardPostIds[i.parentId].findIndex((function(e){return i.commentId===e}));d<0?Object(U.k)().assertConditionTag(!1,"PostID to delete not found",520646685):(s=1,e.cardPostIds[i.parentId].splice(d,1))}delete e.postData[t.model.commentId]}if(n&&void 0!==(null===(a=e.createdCommentLie)||void 0===a?void 0:a.flatIndex)&&c>=0)c<e.commentThreadIds.findIndex((function(e){return e===n}))&&(e.createdCommentLie.flatIndex-=s)}if(e.highlightedCommentId===t.model.commentId&&(e.highlightedCommentId=void 0),e.topVisibleThreadId===t.model.commentId&&(e.topVisibleThreadId=void 0),delete e.cardViewState[t.model.commentId],delete e.postViewState[t.model.commentId],t.model.commentId===e.selectedThreadIdBeforeCommentSession&&i){var u=e.commentThreadIds.length;u?t.index>=e.commentThreadIds.length?e.selectedThreadIdBeforeCommentSession=e.commentThreadIds[u-1]:e.selectedThreadIdBeforeCommentSession=e.commentThreadIds[t.index]:e.selectedThreadIdBeforeCommentSession=void 0}}function Cn(e,t,n,r){var o,a,i,c,s;if(Q.c()&&n.tasks){var d=!1,u={},l={},f=new Set,m=Object.keys(e);n.comments.forEach((function(e){""===e.parentId&&f.add(e.commentId)}));try{for(var p=Object(X.i)(m),h=p.next();!h.done;h=p.next()){var v=h.value;if(!f.has(v)){d=!0;break}}}catch(e){o={error:e}}finally{try{h&&!h.done&&(a=p.return)&&a.call(p)}finally{if(o)throw o.error}}m.length!==(null===(s=n.tasks)||void 0===s?void 0:s.length)&&(d=!0);try{for(var g=Object(X.i)(n.tasks),y=g.next();!y.done;y=g.next()){var b=y.value;d=In(t,l,b,r)||d,u[b.commentId]=On(b)}}catch(e){i={error:e}}finally{try{y&&!y.done&&(c=g.return)&&c.call(g)}finally{if(i)throw i.error}}if(d)return{updatedTasks:u,updatedHistoryRecordViewState:l}}}function Tn(e,t,n,r){if(Q.c()){var o=Object(X.a)({},e),a=Object(X.a)({},t),i=!1;if(n.changes.forEach((function(n){if(n.type!==Xt.d.Unknown){var c=n.model.commentId;switch(n.type){case Xt.d.Delete:if(delete o[c],void 0!==e[c])Object.keys(e).includes(c)&&(Sn(a,e[c],void 0),i=!0);break;case Xt.d.Load:case Xt.d.Insert:case Xt.d.Modify:Object(U.k)().assertConditionTag(n.type===Xt.d.Modify||!o[c],"Task should not already be populated on initial load",554836097);var s=n.task;if(s)i=In(t,a,s,r)||i||!o[c]||!function(e,t){if(e.completion!==t.completion||e.title!==t.title||e.isLossy!==t.isLossy||e.priority!==t.priority||e.schedule.dueDate!==t.schedule.dueDate||e.schedule.startDate!==t.schedule.startDate||e.assignees.length!==t.assignees.length)return!1;for(var n=0;n<e.assignees.length;n++)if(!Object(Me.l)(e.assignees[n],t.assignees[n]))return!1;return!0}(o[c].currentState,s.currentState),o[c]=On(s);else if(""===n.model.parentId&&o[c]){var d=o[c];Sn(a,d,void 0),delete o[c],i=!0}}}else Object(U.k)().assertConditionTag(!1,"Unknown change type",554836096)})),i)return{updatedTasks:o,updatedHistoryRecordViewState:a}}}function In(e,t,n,r){var o,a,i,c;if(0===n.history.length)return!0;var s=!1,d=e&&Object.keys(e).length>0,u=d?new Set:void 0;try{for(var l=Object(X.i)(n.history),f=l.next();!f.done;f=l.next()){var m=f.value;try{for(var p=(i=void 0,Object(X.i)(m.records)),h=p.next();!h.done;h=p.next()){var v=h.value;null==u||u.add(v.recordId);var g=Rt.a(n.id,v.recordId);e[g]?t[g]=e[g]:(s=!0,t[g]=Object($e.t)(Object($e.o)(v.time,v.displayTime,r.dataCulture)))}}catch(e){i={error:e}}finally{try{h&&!h.done&&(c=p.return)&&c.call(p)}finally{if(i)throw i.error}}}}catch(e){o={error:e}}finally{try{f&&!f.done&&(a=l.return)&&a.call(l)}finally{if(o)throw o.error}}if(d){var y=Sn(t,n,u);s=s||y}return s}function Sn(e,t,n){var r,o,a,i,c=!1;try{for(var s=Object(X.i)(t.history),d=s.next();!d.done;d=s.next()){var u=d.value;try{for(var l=(a=void 0,Object(X.i)(u.records)),f=l.next();!f.done;f=l.next()){var m=f.value;n&&n.has(m.recordId)||(delete e[Rt.a(t.id,m.recordId)],c=!0)}}catch(e){a={error:e}}finally{try{f&&!f.done&&(i=l.return)&&i.call(l)}finally{if(a)throw a.error}}}}catch(e){r={error:e}}finally{try{d&&!d.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return c}function On(e){var t,n,r,o,a=Object(X.a)({},e),i=[];try{for(var c=Object(X.i)(e.history),s=c.next();!s.done;s=c.next()){var d=s.value,u=Object(X.a)({},d);Q.V()&&!u.taskId&&(u.taskId=e.id);var l=[];try{for(var f=(r=void 0,Object(X.i)(d.records)),m=f.next();!m.done;m=f.next()){var p=m.value;l.push(Object(X.a)({},p))}}catch(e){r={error:e}}finally{try{m&&!m.done&&(o=f.return)&&o.call(f)}finally{if(r)throw r.error}}u.records=l,i.push(u)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return a.history=i,a}function wn(e){if(e){var t={};if(void 0!==e.isReadOnly&&(t.isReadOnly=e.isReadOnly),void 0!==e.nextPopulatedContextDetails&&(t.nextPopulatedContextDetails=e.nextPopulatedContextDetails),void 0!==e.commentThreadCounts&&(t.commentThreadCounts=e.commentThreadCounts||void 0),Object.keys(t).length)return t}}var jn=n(1128),En=function(e){for(var t=[],n=0;n<e.length;++n)t.push(e[n]);return t};function kn(e){return An(Object(yt.c)(e)?Object(gt.a)(e):Object(gt.e)(e.componentType))}function Pn(e){var t=document.activeElement;return!!e&&t===e}function xn(e,t,n){var r=document.activeElement,o=t!==yt.a.CardEditor&&t!==yt.a.PostEditor&&!n;return!!e&&(r&&e.contains(r)||o&&function(e){return e===document.body||null===e||0===Object.keys(e).length}(r))}function An(e){var t=document.getElementById(e);return null!=t?t:void 0}var Dn=function(){function e(e,t,n){this.componentTreeId={renderContextType:e,contextIdentifier:t}}return e.prototype.getComponent=function(e){return An(Object(gt.e)(e))},e.prototype.getComponentById=function(e){return An(Object(gt.a)(e))},e.prototype.isEventTarget=function(e,t){return e===t},e.prototype.isFocusOn=function(e){return Pn(kn(e))},e.prototype.isFocusWithin=function(e){return xn(kn(e),e.componentType)},e.prototype.isFocusOnOrWithin=function(e,t){var n=kn(e);return Pn(n)||xn(n,e.componentType,t)},e.prototype.isFocusWithinAny=function(e){var t=void 0;switch(e){case yt.a.Card:t=En(document.querySelectorAll("[id*='".concat(te.i({id:"",renderContextType:this.componentTreeId.renderContextType},!1),"']")));break;case yt.a.DraftCard:t=En(document.querySelectorAll("[id*='".concat(te.i({id:"",renderContextType:this.componentTreeId.renderContextType},!0),"']")));break;case yt.a.PostEditor:t=En(document.querySelectorAll("[id*='".concat(te.w(te.G({id:"",renderContextType:this.componentTreeId.renderContextType})),"']")));break;case yt.a.CardEditor:t=En(document.querySelectorAll("[id*='".concat(te.w(te.f({id:"",renderContextType:this.componentTreeId.renderContextType})),"']")));break;case yt.a.Post:t=En(document.querySelectorAll("[id*='".concat(te.I({id:"",renderContextType:this.componentTreeId.renderContextType}),"']")))}if(t)for(var n=0;n<t.length;++n){if(xn(t[n],e))return!0}return!1},e.prototype.isFocusWithinPane=function(){return xn(document.getElementById(te.z()),yt.a.PaneRoot)},e.prototype.getCurrentlyFocused=function(){return this.isFocusWithinPane()?[document.activeElement]:[]},e}();function Rn(){return{extensions:{},contentNavigationSupported:!1}}function Fn(e,t){switch(void 0===e&&(e=Rn()),void 0===t&&(t=Xe.EMPTY_ACTION),t.type){case"ADD_CONTENT_EXTENSION":return function(e,t){var n;Object(U.k)().assertConditionTag(void 0===e[t.payload.extension.provider.scope.renderMode],"Attempting to register extension on surface where extension is already registered. Overwriting previous registration.",594834317);var r=t.payload.extension;return Object(X.a)(Object(X.a)({},e),{extensions:Object(X.a)(Object(X.a)({},e.extensions),(n={},n[t.payload.extension.provider.scope.renderMode]={controller:r,priority:r.priority},n))})}(e,t);case"REMOVE_CONTENT_EXTENSION":return function(e,t){var n,r,o=Object(X.a)({},e.extensions);try{for(var a=Object(X.i)(t.payload.renderModes),i=a.next();!i.done;i=a.next()){var c=i.value;delete o[c]}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return Object(X.a)(Object(X.a)({},e),{extensions:o})}(e,t);case"UPDATE_EXTENSION_PRIORITY":return function(e,t){var n=Object(X.a)({},e.extensions);for(var r in t.payload.updates)n[r]&&(n[r]=Object(X.a)(Object(X.a)({},n[r]),{priority:t.payload.updates[r]}));return Object(X.a)(Object(X.a)({},e),{extensions:n})}(e,t);case"SET_CONTENT_NAVIGATION_ENABLEMENT":return function(e,t){return Object(X.a)(Object(X.a)({},e),{contentNavigationSupported:t.payload.isEnabled})}(e,t);default:return e}}function Nn(e,t){return void 0===e&&(e=Mn()),void 0===t&&(t=Xe.EMPTY_ACTION),Object(Kt.a)(e,(function(n){switch(t.type){case"VIEW_CONTAINER_VISIBILITY_CHANGED":return void function(e,t){void 0===e.defaultFilterId&&t.payload.visibilityState!==be.a.Closed&&(e.requestDefaultFilter=!0)}(n,t);case"LOAD_DEFAULT_FILTER":return void function(e,t){Ln(e,t.payload.filteredRange,!0)&&(e.defaultFilterId=t.payload.filteredRange.id);e.requestDefaultFilter=!1}(n,t);case"LOAD_FILTER":return void function(e,t){Object(U.k)().assertConditionTag(!!e.defaultFilterId,"Default filter should be loaded before new filters are loaded",528779299),Ln(e,t.payload.filteredRange,t.payload.shouldSetActive)}(n,t);case"SET_FILTERING_CAPABILITIES":return void function(e,t){e.filteringCapabilities=t.payload.capabilities}(n,t);case"UPDATE_FILTER_RANGE":return void function(e,t){if(Object(U.k)().assertConditionTag(t.payload.filterId.length>0,"FilterId must not be empty string",529138905),0===t.payload.changes.length||!t.payload.filterId)return;var n=e.filteredRanges[t.payload.filterId];if(!n)return void Object(U.k)().assertConditionTag(!1,"Processing update for a filter that is not found?",529138910);t.payload.changes.forEach((function(r){switch(r.type){case"FilterUpdate":if(t.payload.filterId===e.defaultFilterId){Object(U.k)().assertConditionTag(!1,"Should not attempt to update the default filter",528532106);break}Object(U.k)().assertConditionTag(n.canUpdateFilter,"Should not get into FilterUpdate if canUpdateFilter is false",528749965),n.filter=r.updatedFilter;break;case"Insert":if(r.index<0||r.index>n.order.length){Object(U.k)().assertConditionTag(!1,"Insert index out of bounds?",529138908);break}n.order=Object(X.h)(Object(X.h)(Object(X.h)([],Object(X.f)(n.order.slice(0,r.index)),!1),[r.content],!1),Object(X.f)(n.order.slice(r.index)),!1);break;case"Reload":n.order=r.fullContent;break;case"Remove":if(r.index<0||r.index>=n.order.length){Object(U.k)().assertConditionTag(!1,"Processing Remove with index out of bounds?",529138911);break}n.order.splice(r.index,1);break;case"Teardown":t.payload.filterId===e.defaultFilterId&&(Object(U.k)().assertConditionTag(!1,"Is tearing down default filter expected?",528779328),e.defaultFilterId=void 0),t.payload.filterId===e.activeFilterId&&(Object(U.k)().assertConditionTag(!!e.defaultFilterId,"Active was removed, but no default to fallback on",528779329),e.activeFilterId=e.defaultFilterId),delete e.filteredRanges[t.payload.filterId]}}))}(n,t);default:return e}}))}function Mn(){return{filteredRanges:{},filteringCapabilities:void 0,requestDefaultFilter:!1}}function Ln(e,t,n){return void 0!==e.filteredRanges[t.id]?(Object(U.k)().assertConditionTag(!1,"Should not load a filter with the same id as a previously loaded filter",528527825),!1):(n&&(e.activeFilterId=t.id),e.filteredRanges[t.id]={filter:t.getFilter(),order:t.getOrder(),canUpdateFilter:e.defaultFilterId!==t.id&&t.canBeUpdated()},!0)}function Bn(e){return Object(X.a)(Object(X.a)({},Q.W()?{commentThreadIds:[],cardPostIds:{},postData:{}}:{commentData:[]}),{cardViewState:{},postViewState:{},selectedComment:void 0,expandedComments:[],pendingCommentLoad:void 0,contextState:{nextPopulatedContextDetails:Pt.a.Unknown,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:0},highlightedCommentId:void 0,topVisibleThreadId:void 0,createdCommentLie:void 0,selectedThreadIdBeforeCommentSession:void 0,personaIconPropertiesMap:{},draftState:Object(tt.h)(),modelCapabilities:Object($e.s)(),localizationDetails:e,suggestionsDetails:void 0,tasks:{},historyRecordViewState:{}})}function Vn(e,t,n,r){return function(e,t,n,r){return{paneState:{viewContainer:e,componentTree:new Dn(Object(en.a)(e.containerType),r),visibilityState:t?be.a.Visible:be.a.Closed,initializationStatus:jn.a.NotInitialized,viewContainerDisplayConfiguration:void 0},contentExtensions:Rn(),commentState:Bn(n),filterState:Mn()}}(e,t,n,r)}var Un,_n={isRightToLeft:!1,dataCulture:"",uiCulture:""};function Hn(e,t){void 0===e&&(e=Bn(_n)),void 0===t&&(t=Yt.a);var n=function(e,t){switch(t.type){case"HIGHLIGHT_COMMENT":return function(e,t){var n=$e.P(t.payload.commentId);if(n===e.highlightedCommentId)return e;return Object(X.a)(Object(X.a)({},e),{highlightedCommentId:n})}(e,t);case"APPLY_COMMENT_CHANGES":return Object(it.e)(e)?Object(Kt.a)((function(e){!function(e,t){var n,r;if(!t.payload.changes.length)return;var o,a=$e.G(e.draftState,!0);try{for(var i=Object(X.i)(t.payload.changes),c=i.next();!c.done;c=i.next())switch((o=c.value).type===Qt.b.Load&&(o=void 0!==e.postViewState[o.model.commentId]?Object(X.a)(Object(X.a)({},o),{type:Qt.b.Modify}):Object(X.a)(Object(X.a)({},o),{type:Qt.b.Insert})),o.type){case Qt.b.Insert:gn(e,o,a),void 0===e.createdCommentLie&&(a=void 0);break;case Qt.b.Modify:yn(e,o);break;case Qt.b.Delete:bn(e,o,a)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}fn(e,2),e.selectedComment&&!Object(tt.l)(e.draftState)&&(e.cardViewState[e.selectedComment.selectedCardId]?Object(nt.j)(e.selectedComment.selectionDetails)&&!e.postViewState[e.selectedComment.selectionDetails.selectedPostId]&&(e.selectedComment=$e.m(e.selectedComment.selectedCardId)):e.selectedComment=void 0);e.expandedComments=$e.V(e.expandedComments,e.cardViewState,e.draftState);var s=un(e,L.d.reserveTag(520646682));if(!s)return;var d=Tn(s.tasks,s.historyRecordViewState,t.payload,s.localizationDetails);(null==d?void 0:d.updatedTasks)&&(e.tasks=d.updatedTasks);(null==d?void 0:d.updatedHistoryRecordViewState)&&(e.historyRecordViewState=d.updatedHistoryRecordViewState)}(e,t)}))(e):function(e,t){var n,r,o,a,i,c,s;if(!t.payload.changes.length)return e;var d,u={commentData:Object(X.h)([],Object(X.f)(e.commentData),!1),cardViewState:Object(X.a)({},e.cardViewState),postViewState:Object(X.a)({},e.postViewState),highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,selectedComment:e.selectedComment,expandedComments:e.expandedComments,selectedThreadIdBeforeCommentSession:e.selectedThreadIdBeforeCommentSession,draftState:e.draftState},l=e.createdCommentLie,f=!!$e.G(e.draftState,!0),m=null==l?void 0:l.flatIndex,p=e.modelCapabilities.virtualized;try{for(var h=Object(X.i)(t.payload.changes),v=h.next();!v.done;v=h.next())if((d=v.value).type===Qt.b.Load&&(d=void 0!==u.postViewState[d.model.commentId]?Object(X.a)(Object(X.a)({},d),{type:Qt.b.Modify}):Object(X.a)(Object(X.a)({},d),{type:Qt.b.Insert})),d.type===Qt.b.Insert){if((y=d.model.parentId)&&(u.cardViewState[y]?u.cardViewState[y]=Object(X.a)(Object(X.a)({},u.cardViewState[y]),{pending:et.a.None}):null===(i=null===(a=Object(U.k)())||void 0===a?void 0:a.logDiagnosticTrace)||void 0===i||i.call(a,Object(ze.a)(Un||(Un=Object(X.e)(["Inserting orphaned reply without root post?"],["Inserting orphaned reply without root post?"]))),L.d.reserveTag(526960065),U.h.Warning,U.c.ProductServiceUsage,Object(U.l)(U.g.ReviewedAsNotNecessary))),u.commentData.splice(d.index,0,d.model),d.tempId){if(!y)(g={})[d.model.commentId]=$e.i(d.tempId),u.cardViewState=Object(X.a)(Object(X.a)({},$e.Z(u.cardViewState,d.tempId)),g);u.postViewState=Object(X.a)(Object(X.a)({},$e.Z(u.postViewState,d.tempId)),$e.y([d.model],u.expandedComments,e.localizationDetails)),u.draftState.committedLieId===d.tempId&&(u.draftState=Object(X.a)(Object(X.a)({},u.draftState),{committedLieId:void 0}),m=void 0),u.selectedComment&&u.selectedComment.selectedCardId===d.tempId&&(u.selectedComment=$e.m(Object(xt.b)(d.model)),d.model.parentId||(u.expandedComments=$e.a(u.expandedComments,u.selectedComment,u.draftState)))}else{var g;if(Object(U.k)().assertConditionTag(!u.postViewState[d.model.commentId],"Received insert for existing comment",594122589),!y)(g={})[d.model.commentId]=$e.i(void 0),u.cardViewState=Object(X.a)(Object(X.a)({},u.cardViewState),g);u.postViewState=Object(X.a)(Object(X.a)({},u.postViewState),$e.y([d.model],u.expandedComments,e.localizationDetails))}f&&void 0!==m&&d.index<=m&&m++}else if(d.type===Qt.b.Modify){if((I=u.commentData[d.index]).commentId===d.model.commentId){u.commentData[d.index]=d.model;var y=Object(xt.b)(d.model),b=u.cardViewState[y];b?u.cardViewState[y]=Object(X.a)(Object(X.a)({},b),{pending:et.a.None,loadState:b.loadState.state!==cn.a.Loading&&p?b.loadState:{state:cn.a.Loaded}}):(Object(U.k)().assertConditionTag(!1,"Received Modify change without existing card state? Creating default.",527962186),u.cardViewState[y]=$e.i(void 0,p?cn.a.Placeholder:void 0));var C=I.displayDate===d.model.displayDate&&I.date===d.model.date?u.postViewState[d.model.commentId].displayDate:$e.o(d.model.date,d.model.displayDate,e.localizationDetails.dataCulture);if(u.postViewState=Object(X.a)(Object(X.a)({},u.postViewState),((o={})[d.model.commentId]=Object(X.a)(Object(X.a)({},u.postViewState[d.model.commentId]),{pending:sn.a.None,displayDate:C}),o)),d.model.commentFlags&Ft.a.Resolved&&!(I.commentFlags&Ft.a.Resolved)){var T=u.draftState;u.selectedComment&&u.selectedComment.selectedCardId===d.model.commentId&&(u.selectedComment=$e.m(u.selectedComment.selectedCardId)),u.draftState=$e.S(u.draftState,d.model.commentId,u.commentData),Object(dn.b)(T,u.draftState,1,2,L.d.reserveTag(539297114)),(null==b?void 0:b.loadState.state)===cn.a.Loaded&&(u.expandedComments=$e.U(d.model.commentId,u.expandedComments,u.draftState,u.selectedComment))}}else Object(U.k)().assertConditionTag(!1,"Found changeIndex mismatch",593762526),Object(L.i)("changeIndex did not match comment for ".concat(d.model.commentId))}else if(d.type===Qt.b.Delete){var I;if((I=u.commentData[d.index]).commentId===d.model.commentId&&u.commentData.splice(d.index,1),u.highlightedCommentId===d.model.commentId&&(u.highlightedCommentId=void 0),u.topVisibleThreadId===d.model.commentId&&(u.topVisibleThreadId=void 0),u.cardViewState=$e.Z(u.cardViewState,d.model.commentId),u.postViewState=$e.Z(u.postViewState,d.model.commentId),d.model.commentId===u.selectedThreadIdBeforeCommentSession){var S=d.index;u.commentData.length?(S>=u.commentData.length&&(S=u.commentData.length-1),u.selectedThreadIdBeforeCommentSession=Object(xt.b)(u.commentData[S])):u.selectedThreadIdBeforeCommentSession=void 0}f&&void 0!==m&&d.index<m&&m--}}catch(e){n={error:e}}finally{try{v&&!v.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}f&&(void 0===m?l=void 0:l&&m!==l.flatIndex&&(l=Object(X.a)(Object(X.a)({},l),{flatIndex:m})));u.draftState=$e.db(u.draftState,e.cardViewState,u.cardViewState,e.postViewState,u.postViewState,2),u.selectedComment&&!Object(tt.l)(u.draftState)&&(u.cardViewState[u.selectedComment.selectedCardId]?Object(nt.j)(u.selectedComment.selectionDetails)&&!u.postViewState[u.selectedComment.selectionDetails.selectedPostId]&&(u.selectedComment=$e.m(u.selectedComment.selectedCardId)):u.selectedComment=void 0);var O=Tn(e.tasks,e.historyRecordViewState,t.payload,e.localizationDetails);return Object(X.a)(Object(X.a)({},e),{createdCommentLie:l,draftState:u.draftState,selectedComment:u.selectedComment,expandedComments:$e.V(u.expandedComments,u.cardViewState,u.draftState),commentData:u.commentData,cardViewState:u.cardViewState,postViewState:u.postViewState,highlightedCommentId:u.highlightedCommentId,topVisibleThreadId:u.topVisibleThreadId,selectedThreadIdBeforeCommentSession:u.selectedThreadIdBeforeCommentSession,tasks:null!==(c=null==O?void 0:O.updatedTasks)&&void 0!==c?c:e.tasks,historyRecordViewState:null!==(s=null==O?void 0:O.updatedHistoryRecordViewState)&&void 0!==s?s:e.historyRecordViewState})}(e,t);case"LOAD_COMMENT":return function(e,t){var n,r,o,a=e.modelCapabilities.virtualized,i=$e.Q(e,t.payload.commentData,a,!!t.payload.filteringEnabled);o=$e.j(t.payload.commentData,a?cn.a.Placeholder:cn.a.Loaded);var c=function(e,t){var n,r;if(e&&Q.c()){var o={},a={};try{for(var i=Object(X.i)(e),c=i.next();!c.done;c=i.next()){var s=c.value;In({},a,s,t),o[s.commentId]=On(s)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return{updatedTasks:o,updatedHistoryRecordViewState:a}}}(t.payload.tasks,e.localizationDetails);return Object(X.a)(Object(X.a)(Object(X.a)({},e),i),{cardViewState:Object(X.a)(Object(X.a)({},e.cardViewState),o),postViewState:Object(X.a)(Object(X.a)({},e.postViewState),$e.y(t.payload.commentData,i.expandedComments,e.localizationDetails)),tasks:null!==(n=null==c?void 0:c.updatedTasks)&&void 0!==n?n:e.tasks,historyRecordViewState:null!==(r=null==c?void 0:c.updatedHistoryRecordViewState)&&void 0!==r?r:e.historyRecordViewState})}(e,t);case"VIRTUALIZE_COMMENTS":return function(e,t){if(!e.modelCapabilities.virtualized)throw new me.a("virtualizeCommentsReducer requires virtualization",L.d.reserveTag(589103643),-2130957500);var n=function(e){return e.map((function(e){return rn(e,void 0,void 0)}))}(t.payload.threadInfo.map((function(e){return e.threadId}))),r=$e.Q(e,n,!0,!!t.payload.filteringEnabled);return Object(X.a)(Object(X.a)(Object(X.a)({},e),r),{cardViewState:Object(X.a)(Object(X.a)({},e.cardViewState),$e.N(t.payload.threadInfo)),postViewState:Object(X.a)(Object(X.a)({},e.postViewState),$e.y(n,r.expandedComments,e.localizationDetails))})}(e,t);case"CANCEL_COMMENT_CREATE_THREAD":return function(e,t){var n;if(!Object(tt.c)(e.draftState))return e;var r,o=$e.G(e.draftState);if(!o)return e;var a=!1;(null===(n=e.selectedComment)||void 0===n?void 0:n.selectedCardId)!==o?r=e.selectedComment:e.selectedThreadIdBeforeCommentSession&&(r={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{lowFidelityWarningType:void 0}},a=!0);var i=$e.T(e.draftState,o);return Object(X.a)(Object(X.a)(Object(X.a)({},e),Object(it.e)(e)?{commentThreadIds:$e.Y(e.commentThreadIds,o),cardPostIds:$e.Z(e.cardPostIds,o),postData:$e.Z(e.postData,o)}:{}),{createdCommentLie:void 0,selectedComment:r,expandedComments:r&&a?$e.a(e.expandedComments,r,i):$e.R(e.expandedComments,r,i),cardViewState:$e.Z(e.cardViewState,o),postViewState:$e.Z(e.postViewState,o),selectedThreadIdBeforeCommentSession:void 0,draftState:i})}(e);case"CANCEL_COMMENT_POST_EDIT":return function(e,t){var n=$e.A(e,t.payload.commentId),r=$e.ab(e.draftState,t.payload.commentId);return Object(X.a)(Object(X.a)({},e),{selectedComment:n,expandedComments:$e.R(e.expandedComments,n,r),selectedThreadIdBeforeCommentSession:void 0,draftState:r})}(e,t);case"CANCEL_COMMENT_REPLY":return function(e,t){var n=$e.T(e.draftState,t.payload.commentId);return Object(X.a)(Object(X.a)({},e),{expandedComments:$e.R(e.expandedComments,e.selectedComment,n),selectedThreadIdBeforeCommentSession:void 0,draftState:n})}(e,t);case"COLLAPSE_CARD":return function(e,t){var n=$e.K(e.draftState);if((null==n?void 0:n.threadId)===t.payload.cardId)return e;var r=$e.D(t.payload.cardId,e.selectedComment,e.draftState);return Object(X.a)(Object(X.a)({},e),{selectedComment:r,expandedComments:$e.U(t.payload.cardId,e.expandedComments,e.draftState,r)})}(e,t);case"SELECT_COMMENT":return function(e,t){var n=e.selectedComment;if(!$e.bb(e.draftState,n,t))return e;if(!t.payload.selectedCard)throw new me.a(Le.d,L.d.reserveTag(589103644),-2130957536);var r=$e.gb(e.selectedComment,t),o=Object(Xe.shouldSelectActionExpandCard)(t.payload.selectType)?$e.a(e.expandedComments,r,e.draftState):$e.R(e.expandedComments,r,e.draftState);return Object(X.a)(Object(X.a)({},e),{selectedComment:r,expandedComments:o})}(e,t);case"REQUEST_THREAD_RESOLVE":return function(e,t){var n;return Object(X.a)(Object(X.a)({},e),{cardViewState:Object(X.a)(Object(X.a)({},e.cardViewState),(n={},n[t.payload.commentId]=Object(X.a)(Object(X.a)({},e.cardViewState[t.payload.commentId]),{pending:et.a.Card,loadState:{state:cn.a.Loaded}}),n)),selectedComment:$e.B(e.selectedComment,t)})}(e,t);case"RELOAD_COMMENTS":return Object(it.e)(e)?Object(Kt.a)((function(e){!function(e,t){var n=un(e,L.d.reserveTag(524031011));if(!n)return;var r=!1,o=!1,a=!1,i=!1,c=n.selectedComment&&Object(nt.j)(n.selectedComment.selectionDetails),s=!1;e.commentThreadIds=[],e.cardPostIds={},e.postData={},e.cardViewState={},e.postViewState={},t.payload.comments.forEach((function(t){if(t.commentId===n.highlightedCommentId&&(r=!0),t.commentId===n.topVisibleThreadId&&(o=!0),n.selectedComment&&(t.commentId===n.selectedComment.selectedCardId&&(a=!0),n.selectedComment.selectedCardId===Object(xt.b)(t)&&Object(nt.j)(n.selectedComment.selectionDetails)&&n.selectedComment.selectionDetails.selectedPostId===t.commentId&&(i=!0)),t.commentId in n.postData)Object(xt.a)(t)&&function(e,t){var n=un(e,L.d.reserveTag(523604707));if(n){var r=n.cardViewState[t];Object(U.k)().assertConditionTag(!r||r.pending!==et.a.Delete,"Card pending delete remained after a reload.",523604736);var o=n.modelCapabilities.virtualized?cn.a.NeedsReload:cn.a.Loaded;if(r){var a=r.pending!==et.a.None,i=(a||n.modelCapabilities.virtualized)&&r.loadState.state!==cn.a.Placeholder&&r.loadState.state!==o;e.cardViewState[t]=a||i?Object(X.a)(Object(X.a)({},r),{pending:et.a.None}):r,i&&(e.cardViewState[t].loadState=Object(X.a)(Object(X.a)({},e.cardViewState[t].loadState),{state:o}))}else Object(U.k)().assertConditionTag(!1,"Card state missing for existing card on reload? Creating default",523604737),e.cardViewState[t]=$e.i(void 0,o)}}(e,t.commentId),function(e,t){var n=un(e,L.d.reserveTag(523604738));if(n){var r=n.postViewState[t];Object(U.k)().assertConditionTag(!r||r.pending!==sn.a.Delete,"Post pending delete remained after a reload.",523604739),r?e.postViewState[t]=r.pending!==sn.a.None?Object(X.a)(Object(X.a)({},r),{pending:sn.a.None}):r:(Object(U.k)().assertConditionTag(!1,"Post state missing for existing post on reload. Creating default",523604740),e.postViewState[t]=$e.k(void 0))}}(e,t.commentId),mn(e,t,n.postData[t.commentId],1),n.selectedThreadIdBeforeCommentSession&&n.selectedThreadIdBeforeCommentSession===t.commentId&&(s=!0);else{if(Object(xt.a)(t)){var c=t.commentId,d=n.modelCapabilities.virtualized?{state:cn.a.Placeholder,initialItemCount:1}:{state:cn.a.Loaded};e.cardViewState[t.commentId]=$e.v(c,d)}e.postViewState[t.commentId]=$e.k(t.displayDate)}ln(e,t)})),r||(e.highlightedCommentId=void 0);o||(e.topVisibleThreadId=void 0);!s&&n.selectedThreadIdBeforeCommentSession&&function(e){var t=un(e,L.d.reserveTag(523604741));if(null==t?void 0:t.selectedThreadIdBeforeCommentSession){var n=t.commentThreadIds.indexOf(t.selectedThreadIdBeforeCommentSession);n<0&&(Object(U.k)().assertConditionTag(!1,"selectedThreadIdBeforeCommentSession not found in original commentThreadIds. Falling back to first comment",523604742),n=0);var r=e.commentThreadIds.length-1;e.commentThreadIds.length?(n>=e.commentThreadIds.length&&(n=r),e.selectedThreadIdBeforeCommentSession=e.commentThreadIds[n]):e.selectedThreadIdBeforeCommentSession=void 0}}(e);(function(e){var t=un(e,L.d.reserveTag(523604706));if(t&&e.createdCommentLie){var n=$e.G(e.draftState,!0);if(n&&t.createdCommentLie&&t.cardViewState[n]&&t.cardViewState[n].pending===et.a.None){var r=Object.keys(e.postData).length;e.createdCommentLie&&e.createdCommentLie.flatIndex>r&&(e.createdCommentLie.flatIndex=r);var o=$e.L(e.commentThreadIds,e.cardPostIds,e.createdCommentLie.flatIndex);o>=0?(e.commentThreadIds.splice(o,0,n),e.cardPostIds[n]=[n],e.postData[n]=t.postData[n],e.cardViewState[n]=t.cardViewState[n],e.postViewState[n]=t.postViewState[n]):Object(U.k)().assertConditionTag(!1,"getThreadIndexFromFlatIndex unexpected failure to get threadIndex",523100547)}else e.createdCommentLie=void 0}})(e),e.draftState.committedLieId=void 0;var d=$e.G(e.draftState);d&&e.selectedComment&&d===e.selectedComment.selectedCardId&&(a=!0);fn(e,1),Object(tt.l)(e.draftState)||(a?c&&!i&&e.selectedComment&&!n.modelCapabilities.virtualized&&(e.selectedComment.selectionDetails=$e.l()):e.selectedComment=void 0);e.pendingCommentLoad=void 0;var u=Cn(n.tasks,n.historyRecordViewState,t.payload,n.localizationDetails);(null==u?void 0:u.updatedTasks)&&(e.tasks=u.updatedTasks);(null==u?void 0:u.updatedHistoryRecordViewState)&&(e.historyRecordViewState=u.updatedHistoryRecordViewState);var l=$e.V(e.expandedComments,e.cardViewState,e.draftState);l!==e.expandedComments&&(e.expandedComments=l)}(e,t)}))(e):function(e,t){var n,r,o,a,i={},c={},s=e.selectedComment,d=e.expandedComments,u=s&&Object(nt.j)(s.selectionDetails),l=!1,f=!1,m=!1,p=e.selectedThreadIdBeforeCommentSession,h=e.draftState,v=e.modelCapabilities.virtualized,g=null===(n=$e.K(h))||void 0===n?void 0:n.threadId,y={};e.commentData.forEach((function(e){y[e.commentId]=e}));var b=!1,C=!1;t.payload.comments.forEach((function(n){if(n.commentId===e.highlightedCommentId&&(b=!0),n.commentId===e.topVisibleThreadId&&(C=!0),s&&(n.commentId===s.selectedCardId&&(f=!0),s.selectedCardId===Object(xt.b)(n)&&Object(nt.j)(s.selectionDetails)&&s.selectionDetails.selectedPostId===n.commentId&&(l=!0)),n.commentId in y){if(""===n.parentId){e.cardViewState[n.commentId]&&Object(U.k)().assertConditionTag(e.cardViewState[n.commentId].pending!==et.a.Delete,"Card pending delete remained after a reload.",593762527);var r=e.cardViewState[n.commentId];if(r)if(r.pending!==et.a.None||v){var o=r.loadState;c[n.commentId]=Object(X.a)(Object(X.a)({},r),{pending:et.a.None,loadState:o.state===cn.a.Placeholder?o:{state:v?cn.a.NeedsReload:cn.a.Loaded}})}else c[n.commentId]=r;else Object(U.k)().assertConditionTag(!1,"Card state missing for existing card on reload? Creating default.",527958879),c[n.commentId]=$e.i(void 0,v?cn.a.NeedsReload:cn.a.Loaded)}if(Object(U.k)().assertConditionTag(!e.postViewState[n.commentId]||e.postViewState[n.commentId].pending!==sn.a.Delete,"Post pending delete remained after a reload.",593762528),e.postViewState[n.commentId]?e.postViewState[n.commentId].pending!==sn.a.None?i[n.commentId]=Object(X.a)(Object(X.a)({},e.postViewState[n.commentId]),{pending:sn.a.None}):i[n.commentId]=e.postViewState[n.commentId]:i[n.commentId]=$e.k(void 0),n.commentFlags&Ft.a.Resolved&&(!y[n.commentId]||!(y[n.commentId].commentFlags&Ft.a.Resolved))){if(s&&s.selectedCardId===n.commentId&&(s=$e.m(s.selectedCardId)),n.commentId===g){var a=h;h=$e.S(h,n.commentId,t.payload.comments),Object(dn.b)(a,h,1,1,L.d.reserveTag(539297115))}d=$e.U(n.commentId,d,h,s)}p&&p===n.commentId&&(m=!0)}else{if(""===n.parentId){var u=n.commentId,T=v?{state:cn.a.Placeholder,initialItemCount:1}:{state:cn.a.Loaded};c[n.commentId]=$e.v(u,T)}i[n.commentId]=$e.k(d.includes(Object(xt.b)(n))?$e.o(n.date,n.displayDate,e.localizationDetails.dataCulture):n.displayDate)}})),a=$e.b(e.createdCommentLie,t.payload.comments,e.cardViewState,e.draftState),h=Object(X.a)(Object(X.a)({},h),{committedLieId:void 0});var T=$e.G(h);T&&(s&&T===s.selectedCardId&&(f=!0),c[T]=e.cardViewState[T],i[T]=e.postViewState[T]);h=$e.db(h,e.cardViewState,c,e.postViewState,i,1),Object(tt.l)(h)||(f?u&&!l&&s&&!v&&(s={selectedCardId:s.selectedCardId,selectionDetails:{lowFidelityWarningType:void 0}}):s=void 0);if(!m&&p){var I=e.commentData.findIndex((function(e){return e.commentId===p}));if(I<0&&(Object(U.k)().assertConditionTag(!1,"selectedThreadIdBeforeCommentSession not found in old commentData. Falling back to first comment",593762529),I=0),t.payload.comments.length){I>=t.payload.comments.length&&(I=t.payload.comments.length-1);var S=t.payload.comments[I];p=Object(xt.b)(S)}else p=void 0}var O=Cn(e.tasks,e.historyRecordViewState,t.payload,e.localizationDetails);return Object(X.a)(Object(X.a)({},e),{draftState:h,commentData:Object(X.h)([],Object(X.f)(t.payload.comments),!1),cardViewState:c,postViewState:i,selectedComment:s,expandedComments:$e.V(d,c,h),pendingCommentLoad:void 0,highlightedCommentId:b?e.highlightedCommentId:void 0,topVisibleThreadId:C?e.topVisibleThreadId:void 0,createdCommentLie:a,selectedThreadIdBeforeCommentSession:p,tasks:null!==(r=null==O?void 0:O.updatedTasks)&&void 0!==r?r:e.tasks,historyRecordViewState:null!==(o=null==O?void 0:O.updatedHistoryRecordViewState)&&void 0!==o?o:e.historyRecordViewState})}(e,t);case"REQUEST_REOPEN_THREAD":return function(e,t){var n,r=Object(X.a)(Object(X.a)({},e.cardViewState),((n={})[t.payload.commentId]=Object(X.a)(Object(X.a)({},e.cardViewState[t.payload.commentId]),{pending:et.a.Card}),n));return Object(X.a)(Object(X.a)({},e),{cardViewState:r})}(e,t);case"REQUEST_DELETE_POST":return function(e,t){var n,r=Object(X.a)(Object(X.a)({},e.postViewState),((n={})[t.payload.commentId]=Object(X.a)(Object(X.a)({},e.postViewState[t.payload.commentId]),{pending:sn.a.Delete}),n));return Object(X.a)(Object(X.a)({},e),{postViewState:r})}(e,t);case"REQUEST_DELETE_THREAD":return function(e,t){var n,r=Object(X.a)(Object(X.a)({},e.cardViewState),((n={})[t.payload.commentId]=Object(X.a)(Object(X.a)({},e.cardViewState[t.payload.commentId]),{pending:et.a.Delete}),n));return Object(X.a)(Object(X.a)({},e),{cardViewState:r})}(e,t);case"DISPATCH_LOAD_THREADS":return function(e,t){var n=Object(X.a)({},e.cardViewState);return t.payload.threadIds.forEach((function(e){if(n[e]){var t=n[e].loadState;n[e]=Object(X.a)(Object(X.a)({},n[e]),{loadState:{state:cn.a.Loading,initialItemCount:$e.O(t)?t.initialItemCount:1}})}else Object(U.k)().assertConditionTag(!1,"Loading an unexpected thread?",528021317)})),Object(X.a)(Object(X.a)({},e),{cardViewState:n})}(e,t);case"BEGIN_DRAFTING_SUCCESS":return function(e,t){var n,r,o,a,i,c,s,d,u,l,f;if($e.H(e.draftState))throw new me.a("Draft already active!",L.d.reserveTag(589103640),-2130957551);var m=e.selectedThreadIdBeforeCommentSession,p=t.payload.draftDetails,h=null===(u=null===(d=t.payload.rehydratedDraftParams)||void 0===d?void 0:d.inCurrentContext)||void 0===u||u,v=null===(f=null===(l=t.payload.rehydratedDraftParams)||void 0===l?void 0:l.isDraftEmpty)||void 0===f||f;switch(p.sessionConfiguration.sessionType){case"CREATE":var g=p.sessionConfiguration.draftId,y=Object(X.a)(Object(X.a)({},$e.e(g)),{author:p.author,anchorHintText:p.anchorHintText}),b=h?$e.C(Object(it.a)(e),p):e.selectedComment,C=Object(X.a)(Object(X.a)({},e.draftState),{drafts:Object(X.a)(Object(X.a)({},e.draftState.drafts),(n={},n[g]={commentDraft:p,isDraftEmpty:v,isInCurrentContext:h,pendingState:tt.a.None,renderContextType:t.payload.draftRenderContextType,threadId:g},n)),cardIdToDraftIdMap:Object(X.a)(Object(X.a)({},e.draftState.cardIdToDraftIdMap),(r={},r[g]=g,r)),pendingDraft:void 0}),T={};if(Object(it.e)(e)){var I=$e.L(e.commentThreadIds,e.cardPostIds,p.insertIndex),S=e.commentThreadIds,O=e.cardPostIds;I>=0&&(S=Object(X.h)(Object(X.h)(Object(X.h)([],Object(X.f)(S.slice(0,I)),!1),[g],!1),Object(X.f)(S.slice(I)),!1),O=Object(X.a)(Object(X.a)({},e.cardPostIds),((o={})[g]=[g],o))),T={commentThreadIds:S,cardPostIds:O,postData:Object(X.a)(Object(X.a)({},e.postData),(a={},a[g]=y,a))}}return Object(X.a)(Object(X.a)(Object(X.a)({},e),T),{createdCommentLie:{flatIndex:p.insertIndex,newComment_deprecated:y},cardViewState:Object(X.a)(Object(X.a)({},e.cardViewState),$e.p(y)),postViewState:Object(X.a)(Object(X.a)({},e.postViewState),$e.q(y)),selectedComment:b,expandedComments:$e.a(e.expandedComments,b,C),selectedThreadIdBeforeCommentSession:m,draftState:C});case"EDIT":case"REPLY":if(!Object($t.b)(p.sessionConfiguration)&&!Object($t.c)(p.sessionConfiguration))throw Object(U.k)().assertConditionTag(!1,"Expected BeginDraftingResult id to be set with CommentSessionType.Reply/Edit in beginDraftingSuccessReducer",593762523),new me.a(Le.c,L.d.reserveTag(589103642),-2130957532);var w=void 0,j=Object($t.c)(p.sessionConfiguration)&&(!e.selectedComment||p.sessionConfiguration.threadId!==e.selectedComment.selectedCardId),E=Zt.e(p.sessionConfiguration)&&(!e.selectedComment||!Object(nt.j)(e.selectedComment.selectionDetails)||p.sessionConfiguration.commentId!==e.selectedComment.selectionDetails.selectedPostId);w=h?!e.selectedComment||j||E?$e.C(Object(it.a)(e),p):Object(X.a)(Object(X.a)({},e.selectedComment),{selectionDetails:Object(X.a)(Object(X.a)({},e.selectedComment.selectionDetails),{lowFidelityWarningType:void 0})}):e.selectedComment;var k=e.draftState.cardIdToDraftIdMap,P=e.draftState.postIdToDraftIdMap,x="",A=!1,D=!1;if(Zt.f(p.sessionConfiguration))k=Object(X.a)(Object(X.a)({},k),((i={})[p.sessionConfiguration.threadId]=p.sessionConfiguration.draftId,i)),x=p.sessionConfiguration.threadId,D=v;else if(Zt.e(p.sessionConfiguration)){var R=p.sessionConfiguration.commentId;if(P=Object(X.a)(Object(X.a)({},P),((c={})[R]=p.sessionConfiguration.draftId,c)),A=!0,Object(it.e)(e)){var F=e.postData[R],N=Object(an.e)(F.commentBody);D=0===N.length||"web"===Object(ft.a)()&&"\n"===N,x=Object(xt.b)(F)}else e.commentData.some((function(e){if(e.commentId===R){var t=Object(an.e)(e.commentBody);return D=0===t.length||"web"===Object(ft.a)()&&"\n"===t,x=Object(xt.b)(e),!0}return!1}));!x&&p.sessionConfiguration.rootCommentId&&(x=p.sessionConfiguration.rootCommentId)}else Object(L.m)(p.sessionConfiguration);var M=Object(X.a)(Object(X.a)({},e.draftState),{drafts:Object(X.a)(Object(X.a)({},e.draftState.drafts),(s={},s[p.sessionConfiguration.draftId]={commentDraft:p,isDraftEmpty:D,isInCurrentContext:h,pendingState:tt.a.None,renderContextType:t.payload.draftRenderContextType,threadId:x},s)),cardIdToDraftIdMap:k,postIdToDraftIdMap:P,pendingDraft:void 0});return Object(X.a)(Object(X.a)({},e),{selectedComment:w,expandedComments:A?$e.a(e.expandedComments,w,M):$e.R(e.expandedComments,w,M),selectedThreadIdBeforeCommentSession:m,draftState:M,createdCommentLie:void 0});default:return e}}(e,t);case"BEGIN_DRAFTING_FAILURE":return function(e,t){if(void 0===e.selectedComment)return Object(U.k)().assertConditionTag(!1,"SelectedComment already undefined when failing selected comment",593762525),e;var n=void 0;"CREATE"!==t.payload.beginDraftingParams.sessionType?n=Object(X.a)(Object(X.a)({},e.selectedComment),{selectionDetails:Object(X.a)(Object(X.a)({},e.selectedComment.selectionDetails),{lowFidelityWarningType:void 0})}):e.selectedThreadIdBeforeCommentSession&&(n={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{lowFidelityWarningType:void 0}});var r=Object(X.a)(Object(X.a)({},e.draftState),{pendingDraft:void 0});return Object(X.a)(Object(X.a)({},e),{selectedComment:n,expandedComments:$e.R(e.expandedComments,n,r),selectedThreadIdBeforeCommentSession:void 0,createdCommentLie:void 0,draftState:r})}(e,t);case"SESSION_REQUEST_STARTED":return function(e,t){var n;if(e.createdCommentLie)return Object(U.k)().assertConditionTag(!1,"SessionRequestStartedAndLockSelection unexpected defined comment lie in state",593764356),e;if(Zt.f(t.payload.params))n=t.payload.params.threadId;else if(Zt.e(t.payload.params)){var r=t.payload.params.commentId,o=Object(it.b)(Object(it.a)(e),r);if(!o)return Object(U.k)().assertConditionTag(!1,"Could not lock selection on missing comment",593764357),e;n=Object(xt.b)(o)}else n=Object(te.y)();var a=void 0;t.payload.captureSelectedThreadIdBeforeSession&&e.selectedComment&&(a=e.selectedComment.selectedCardId);var i=Object(X.a)(Object(X.a)({},e.draftState),{pendingDraft:t.payload.params,committedLieId:void 0}),c=$e.F(e.selectedComment,t,n),s=Object(nt.j)(c.selectionDetails)?$e.a(e.expandedComments,c,i):e.expandedComments;return Object(X.a)(Object(X.a)({},e),{selectedThreadIdBeforeCommentSession:a,selectedComment:c,expandedComments:s,draftState:i})}(e,t);case"COMMENT_CONTEXT_CHANGED":return function(e,t){var n,r,o,a=Object(tt.h)(),i={},c={},s=void 0,d=void 0,u=void 0,l=void 0,f=$e.G(e.draftState),m=!!e.createdCommentLie;o=t.payload.contextDetails?Object(X.a)(Object(X.a)({},wn(t.payload.contextDetails)),{lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1}):{nextPopulatedContextDetails:Pt.a.Unknown,isReadOnly:Q.E()&&e.contextState.isReadOnly,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1};var p,h=t.payload.contextDrafts;if(h){var v=$e.W(e.draftState);if(Object(tt.e)(v)>0){var g={},y=void 0,b=void 0,C=!Q.X();if(Object(tt.f)(v).forEach((function(n){var r,o,a=h.find((function(e){return e.draftId===n}));g[n]=Object(X.a)(Object(X.a)({},v.drafts[n]),{isInCurrentContext:!!a}),f===n&&(m=!!a,a&&(y=a.insertIndex,b=a.anchorHintText,(null===(r=t.payload.contextDetails)||void 0===r?void 0:r.selectedCommentId)===f&&(s=$e.m(f)))),C||s||!a||g[n].threadId!==(null===(o=e.selectedComment)||void 0===o?void 0:o.selectedCardId)||(C=!0)})),a=Object(X.a)(Object(X.a)({},e.draftState),{drafts:g}),d=e.createdCommentLie,u=f?Object(it.e)(e)?e.postData[f]:null==d?void 0:d.newComment_deprecated:void 0,C&&(s=e.selectedComment),d&&f&&m){Object(U.k)().assertConditionTag(void 0!==y,"Index unknown for lie in latest context",587309136);var T=null!=y?y:0;T!==d.flatIndex&&(d=Object(X.a)(Object(X.a)({},d),{flatIndex:T})),u&&void 0!==b&&b!==d.newComment_deprecated.anchorHintText&&(u=Object(X.a)(Object(X.a)({},u),{anchorHintText:b}),d=Object(X.a)(Object(X.a)({},d),{newComment_deprecated:u})),i=$e.w(f),c=$e.x(f),d.flatIndex>-1&&(i[f].pending=et.a.None,c[f].pending=sn.a.None)}}else l=null!=l?l:-1}else l=null!=l?l:4;o.isReadOnly&&(m&&(d=void 0),a=$e.X(a),l=null!=l?l:5);if(Object(dn.b)(e.draftState,a,l,4,L.d.reserveTag(539297116)),Object(it.e)(e)){var I=[],S={},O={};d&&f&&u&&((n={})[f]=u,O=n,m&&!d.flatIndex&&(I=[f],(r={})[f]=[f],S=r)),p={commentThreadIds:I,cardPostIds:S,postData:O}}else p={commentData:[]};return Object(X.a)(Object(X.a)(Object(X.a)({},e),p),{cardViewState:i,postViewState:c,selectedComment:s,expandedComments:$e.R(e.expandedComments,s,a),pendingCommentLoad:0===t.payload.numberOfComments?void 0:{numberOfLoadedComments:0,numberOfLoadedThreads:0,numberOfTotalComments:t.payload.numberOfComments,numberOfTotalThreads:t.payload.numberOfThreads,selectedThreadIndex:void 0!==t.payload.selectedThreadIndex&&t.payload.selectedThreadIndex<t.payload.numberOfThreads?t.payload.selectedThreadIndex:void 0},contextState:o,highlightedCommentId:void 0,topVisibleThreadId:t.payload.contextDetails?$e.P(t.payload.contextDetails.topVisibleThreadId):void 0,createdCommentLie:d,selectedThreadIdBeforeCommentSession:void 0,draftState:a,tasks:{},historyRecordViewState:{}})}(e,t);case"NEXT_POPULATED_CONTEXT_DETAILS_UPDATED":return function(e,t){return Object(X.a)(Object(X.a)({},e),{contextState:{nextPopulatedContextDetails:t.payload.nextPopulatedContextDetails,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement}})}(e,t);case"SHOW_LOW_FIDELITY_WARNING":return function(e,t){var n,r=t.payload,o=r.commentId,a=r.lowFidelityWarningType,i=Object(it.b)(Object(it.a)(e),o);if(!i)return Object(U.k)().assertConditionTag(!1,"Comment not found",593762530),e;if(Object(tt.d)(e.draftState))return Object(U.k)().assertConditionTag(!1,"Cannot show warning with pending or active session",593762531),e;var c=e.expandedComments;a===nt.a.DeleteThread?n={selectedCardId:o,selectionDetails:{lowFidelityWarningType:a}}:(n={selectedCardId:Object(xt.b)(i),selectionDetails:{selectedPostId:o,lowFidelityWarningType:a}},c=$e.a(c,n,e.draftState));return Object(X.a)(Object(X.a)({},e),{selectedComment:n,expandedComments:c})}(e,t);case"CLEAR_LOW_FIDELITY_WARNING":return function(e,t){var n=e.selectedComment;if(!n||void 0===n.selectionDetails.lowFidelityWarningType)return e;return Object(X.a)(Object(X.a)({},e),{selectedComment:Object(X.a)(Object(X.a)({},n),{selectionDetails:{lowFidelityWarningType:void 0}})})}(e);case"CLEAR_COMMENT_SELECTION":return function(e,t){if(!$e.bb(e.draftState,e.selectedComment,t))return e;return Object(X.a)(Object(X.a)({},e),{selectedComment:void 0})}(e,t);case"CLEAR_COMMENT_HIGHLIGHT":return function(e,t){if(void 0!==t.payload.commentId&&t.payload.commentId!==e.highlightedCommentId)return e;return Object(X.a)(Object(X.a)({},e),{highlightedCommentId:void 0})}(e,t);case"TOP_VISIBLE_THREAD_CHANGED":return function(e,t){return Object(X.a)(Object(X.a)({},e),{topVisibleThreadId:t.payload.threadId})}(e,t);case"UPDATE_CONTEXT_DETAILS":return function(e,t){var n=!1,r=Object(X.a)({},e.contextState),o=e.createdCommentLie,a=e.draftState,i=void 0;void 0!==t.payload.contextState.commentThreadCounts&&(n=!0,r.commentThreadCounts=t.payload.contextState.commentThreadCounts);void 0!==t.payload.contextState.nextPopulatedContextDetails&&(n=!0,r.nextPopulatedContextDetails=t.payload.contextState.nextPopulatedContextDetails);void 0!==t.payload.contextState.isReadOnly&&(n=!0,r.isReadOnly=t.payload.contextState.isReadOnly,r.isReadOnly&&(a=$e.X(e.draftState),i=null!=i?i:5,$e.G(e.draftState,!0)&&(o=void 0)));if(!n)return e;return Object(dn.b)(e.draftState,a,i,5,L.d.reserveTag(539297117)),Object(X.a)(Object(X.a)({},e),{draftState:a,contextState:r,createdCommentLie:o})}(e,t);case"BEGIN_PROCESSING_COMMIT":return function(e,t){var n;if(!Object(tt.b)(e.draftState))return Object(U.k)().assertConditionTag(!1,"BeginProcessingCommitAction unexpected",593764352),e;var r=e.draftState,o=$e.K(e.draftState);o&&(r=Object(X.a)(Object(X.a)({},r),{drafts:Object(X.a)(Object(X.a)({},r.drafts),(n={},n[o.commentDraft.sessionConfiguration.draftId]=Object(X.a)(Object(X.a)({},o),{pendingState:tt.a.Commit}),n))}));return Object(X.a)(Object(X.a)({},e),{draftState:r})}(e);case"COMMIT_FAILURE":return function(e,t){var n;if(!Object(tt.i)(e.draftState))return Object(U.k)().assertConditionTag(!1,"CommitFailureAction unexpected",593764353),e;var r=e.draftState,o=$e.K(e.draftState);o&&(r=Object(X.a)(Object(X.a)({},r),{drafts:Object(X.a)(Object(X.a)({},r.drafts),(n={},n[o.commentDraft.sessionConfiguration.draftId]=Object(X.a)(Object(X.a)({},o),{pendingState:tt.a.None,savedDraftContent:void 0!==t.payload.commitText?{editorContent:Promise.resolve(t.payload.commitText),editorCursorPosition:Promise.resolve(void 0)}:o.savedDraftContent}),n))}));return Object(X.a)(Object(X.a)({},e),{draftState:r})}(e,t);case"BEGIN_PROCESSING_DISCARD":return function(e){var t;if(!Object(tt.b)(e.draftState)&&!Object(nt.g)(e.selectedComment))return Object(U.k)().assertConditionTag(!1,"BeginProcessingDiscardAction unexpected",593764355),e;var n=e.draftState,r=$e.K(e.draftState);r&&(n=Object(X.a)(Object(X.a)({},n),{drafts:Object(X.a)(Object(X.a)({},n.drafts),(t={},t[r.commentDraft.sessionConfiguration.draftId]=Object(X.a)(Object(X.a)({},r),{pendingState:tt.a.Discard}),t))}));return Object(X.a)(Object(X.a)({},e),{draftState:n})}(e);case"CANCEL_DISCARD":return function(e){var t;if(!Object(tt.j)(e.draftState))return Object(U.k)().assertConditionTag(!1,"CancelDiscardAction unexpected",593764354),e;var n=e.draftState,r=$e.K(e.draftState);r&&(n=Object(X.a)(Object(X.a)({},n),{drafts:Object(X.a)(Object(X.a)({},n.drafts),(t={},t[r.commentDraft.sessionConfiguration.draftId]=Object(X.a)(Object(X.a)({},r),{pendingState:tt.a.None}),t))}));return Object(X.a)(Object(X.a)({},e),{draftState:n})}(e);case"LOAD_PERSONA_ICON_PROPERTIES":return function(e,t){if(0===Object.keys(t.payload.personaIconPropertiesMap).length)return e;var n=Object(X.a)(Object(X.a)({},e.personaIconPropertiesMap),t.payload.personaIconPropertiesMap);return Object(X.a)(Object(X.a)({},e),{personaIconPropertiesMap:n})}(e,t);case"COMMIT_DRAFT":return function(e,t){var n=$e.H(e.draftState);if(void 0===n)return Object(U.k)().assertConditionTag(!1,"Invalid number of drafts during commit.",593762521),e;if(n.sessionConfiguration.sessionType!==t.payload.sessionType)return e;switch(t.payload.sessionType){case"CREATE":return function(e,t){var n;if(!e.createdCommentLie)return e;var r=$e.G(e.draftState);if(!r)return e;var o=t.temporaryCommentId;if(!o)throw Object(U.k)().assertConditionTag(!1,"Expected middleware to set temporaryCommentId",593762520),new me.a(Le.c,L.d.reserveTag(589103637),-2130957545);var a=Object(it.e)(e)?e.postData[r]:e.createdCommentLie.newComment_deprecated;if(Object(it.e)(e)&&!a)return Object(U.k)().assertConditionTag(!1,"Did not find model for draft thread on commit",527251200),e;var i=Object(X.a)(Object(X.a)({},a),{commentId:o,commentBody:t.commentBody}),c=Object(X.a)(Object(X.a)({},e.cardViewState),$e.w(o)),s=Object(X.a)(Object(X.a)({},e.postViewState),$e.x(o)),d=e.selectedComment&&{selectedCardId:o,selectionDetails:{lowFidelityWarningType:void 0}},u=$e.T(e.draftState,r);return Object(X.a)(Object(X.a)(Object(X.a)(Object(X.a)({},e),{selectedComment:d,expandedComments:$e.a(e.expandedComments,d,u)}),Object(it.e)(e)?{postData:Object(X.a)(Object(X.a)({},e.postData),(n={},n[r]=i,n))}:{createdCommentLie:Object(X.a)(Object(X.a)({},e.createdCommentLie),{newComment_deprecated:i})}),{cardViewState:c,postViewState:s,selectedThreadIdBeforeCommentSession:void 0,draftState:Object(X.a)(Object(X.a)({},u),{committedLieId:o})})}(e,t.payload.data);case"REPLY":return function(e,t){var n;if(!t.parentId)throw new me.a(Le.d,L.d.reserveTag(589103638),-2130957536);var r=Object(X.a)(Object(X.a)({},e.cardViewState),((n={})[t.parentId]=Object(X.a)(Object(X.a)({},e.cardViewState[t.parentId]),{pending:et.a.Editor,loadState:{state:cn.a.Loaded}}),n)),o=$e.m(t.parentId),a=$e.T(e.draftState,t.parentId);return Object(X.a)(Object(X.a)({},e),{cardViewState:r,selectedComment:o,expandedComments:$e.R(e.expandedComments,o,a),selectedThreadIdBeforeCommentSession:void 0,draftState:a})}(e,t.payload.data);case"EDIT":return function(e,t){var n,r=$e.A(e,t.commentId),o=Object(X.a)(Object(X.a)({},e.postViewState[t.commentId]),{pending:sn.a.Post}),a=$e.ab(e.draftState,t.commentId);return Object(X.a)(Object(X.a)({},e),{postViewState:Object(X.a)(Object(X.a)({},e.postViewState),(n={},n[t.commentId]=o,n)),selectedComment:r,expandedComments:$e.R(e.expandedComments,r,a),selectedThreadIdBeforeCommentSession:void 0,draftState:a})}(e,t.payload.data);default:throw new me.a("Unexpected session type for commit",L.d.reserveTag(589103639),-2130957532)}}(e,t);case"RESOLVE_ATMENTION_CAPABILITY":return function(e,t){return Object(X.a)(Object(X.a)({},e),{modelCapabilities:Object(X.a)(Object(X.a)({},e.modelCapabilities),{atMention:t.payload.capability})})}(e,t);case"SAVE_DRAFT":return function(e,t){var n,r=e.draftState.drafts;if(void 0===r[t.payload.draftId])return Object(U.k)().assertConditionTag(!Object(tt.c)(e.draftState),"saveDraftReducer called with an invalid draft id while a draft is active",587531107),e;var o=Object(X.a)(Object(X.a)({},r),((n={})[t.payload.draftId]=Object(X.a)(Object(X.a)({},r[t.payload.draftId]),{savedDraftContent:t.payload.draftContent}),n));return Object(X.a)(Object(X.a)({},e),{draftState:Object(X.a)(Object(X.a)({},e.draftState),{drafts:o})})}(e,t);case"DRAFT_EMPTINESS_CHANGED":return function(e,t){var n,r=e.draftState.drafts;if(void 0===r[t.payload.draftId])return Object(U.k)().assertConditionTag(!1,"draftEmptinessChangedReducer called with an invalid draft id",592213846),e;var o=Object(X.a)(Object(X.a)({},r),((n={})[t.payload.draftId]=Object(X.a)(Object(X.a)({},r[t.payload.draftId]),{isDraftEmpty:t.payload.isEmpty}),n));return Object(X.a)(Object(X.a)({},e),{draftState:Object(X.a)(Object(X.a)({},e.draftState),{drafts:o})})}(e,t);case"UPDATE_DRAFT_RENDER_CONTEXT":return function(e,t){var n=$e.eb(e.draftState,(function(n){var r=e.draftState.drafts[n];return void 0!==t.payload.draftId&&t.payload.draftId!==n?r.renderContextType:t.payload.isClaimingLock&&r.renderContextType===ut.a.None?t.actionDetail.renderContextType:t.payload.isClaimingLock||r.renderContextType!==t.actionDetail.renderContextType?r.renderContextType:ut.a.None}));return Object(X.a)(Object(X.a)({},e),{draftState:n})}(e,t);case"VIEW_CONTAINER_CHANGED":return function(e,t){var n=$e.eb(e.draftState,(function(n){var r=e.draftState.drafts[n];return Object(mt.b)(r.renderContextType)?Object(en.a)(t.payload.viewContainer.containerType):r.renderContextType}));return Object(X.a)(Object(X.a)({},e),{draftState:n})}(e,t);case"DISPLAY_DRAFT_WARNING":return function(e,t){var n,r,o=$e.H(e.draftState);if(void 0===o)return Object(U.k)().assertConditionTag(!1,"Expected active draft to be present",593764360),e;var a=o.sessionConfiguration.draftId,i=e.draftState.drafts;if(!i[a])return Object(U.k)().assertConditionTag(!1,"Expected draft to be present on display draft warning",593764361),e;var c=i[a].draftWarningState,s=Object(X.a)(Object(X.a)({},i[a]),{draftWarningState:{warningCounter:c?c.warningCounter+1:0,type:t.payload.draftWarningType}}),d=Object(X.a)(Object(X.a)({},i),((n={})[a]=s,n)),u=Q.X()&&(Object($t.b)(s.commentDraft.sessionConfiguration)||(null===(r=e.selectedComment)||void 0===r?void 0:r.selectedCardId)!==s.threadId)?$e.E(s):e.selectedComment,l=Object(X.a)(Object(X.a)({},e.draftState),{drafts:d});return Object(X.a)(Object(X.a)({},e),{draftState:l,selectedComment:u,expandedComments:$e.R(e.expandedComments,u,l)})}(e,t);case"UPDATE_MODEL_STATE":return function(e,t){var n={atMention:t.payload.modelCapabilityFlags&Gt.AtMentionKnown?t.payload.modelCapabilityFlags&Gt.AtMentionEnabled?Xt.b.Enabled:Xt.b.Disabled:Xt.b.Unknown,newThread:!!(t.payload.modelCapabilityFlags&Gt.NewThread),resolve:!!(t.payload.modelCapabilityFlags&Gt.Resolve),richTextCapabilities:t.payload.richTextCapabilityFlags,virtualized:!!(t.payload.modelCapabilityFlags&Gt.Virtualized),tasks:t.payload.modelCapabilityFlags&Gt.TasksKnown?t.payload.modelCapabilityFlags&Gt.TasksEnabled?Jt.a.Enabled:Jt.a.Disabled:Jt.a.Unknown,presentLinkToComment:!!(t.payload.modelCapabilityFlags&Gt.PresentLinkToComment),UIAAnnotationPattern:!!(t.payload.modelCapabilityFlags&Gt.UIAAnnotationPattern),ContentExtensionHostingDisabled:!!(t.payload.modelCapabilityFlags&Gt.ContentExtensionHostingDisabled)};return Object(X.a)(Object(X.a)({},e),{modelCapabilities:n})}(e,t);case"UPDATE_MENTIONEES_STILL_IN_DRAFT":return function(e,t){var n,r=$e.H(e.draftState);if(void 0===r)return Object(U.k)().assertConditionTag(!1,"Expected active draft to be present",593764366),e;var o=r.sessionConfiguration;if(Object($t.b)(o))return e;var a=e.draftState.drafts[o.draftId];if(!a)return Object(U.k)().assertConditionTag(!1,"Missing draft for updating mentionees",593764367),e;var i=a.currentMentionees,c={};for(var s in i)c[s]={mentionee:Object(X.a)({},i[s].mentionee),stillInDraft:t.payload.emailsStillInDraft.has(s)};var d=a.selectedTaskAssignee;if(d){var u=Object(Me.h)(d);c[u]&&c[u].stillInDraft||(d=void 0)}var l=Object(X.a)(Object(X.a)({},e.draftState),{drafts:Object(X.a)(Object(X.a)({},e.draftState.drafts),(n={},n[o.draftId]=Object(X.a)(Object(X.a)({},e.draftState.drafts[o.draftId]),{currentMentionees:c,selectedTaskAssignee:d}),n))});return Object(X.a)(Object(X.a)({},e),{draftState:l})}(e,t);case"ADD_TO_CURRENT_MENTIONEES":return function(e,t){var n,r,o=$e.H(e.draftState);if(void 0===o)return Object(U.k)().assertConditionTag(!1,"Expected active draft to be present",593764364),e;var a=o.sessionConfiguration;if(Object($t.b)(a))return e;var i=e.draftState.drafts[a.draftId];if(!i)return Object(U.k)().assertConditionTag(!1,"Missing draft for adding mentionees",593764365),e;var c=i.currentMentionees,s=Object(Me.h)(t.payload.mentionee);if(c&&c[s])return e;var d={};for(var u in c)d[u]={mentionee:Object(X.a)({},c[u].mentionee),stillInDraft:c[u].stillInDraft};d[s]={mentionee:Object(X.a)({},t.payload.mentionee),stillInDraft:!0};var l=void 0;e.draftState.drafts[a.draftId].selectedTaskAssignees&&(l=Object(X.a)({},e.draftState.drafts[a.draftId].selectedTaskAssignees),Object(Me.b)(l,((n={})[s]={mentionee:Object(X.a)({},t.payload.mentionee),stillInDraft:!0},n)));var f=Object(X.a)(Object(X.a)({},e.draftState),{drafts:Object(X.a)(Object(X.a)({},e.draftState.drafts),(r={},r[a.draftId]=Object(X.a)(Object(X.a)({},e.draftState.drafts[a.draftId]),{currentMentionees:d,selectedTaskAssignees:l}),r))});return Object(X.a)(Object(X.a)({},e),{draftState:f})}(e,t);case"TOGGLE_TASK_ASSIGNER_TYPE":return function(e){var t;if(!Q.m())return Object(U.k)().assertConditionTag(!1,"toggleTaskAssigner should not be called unless CommentTasksWithMultiAssign is enabled.",529143576),e;var n=$e.K(e.draftState);if(void 0===n)return Object(U.k)().assertConditionTag(!1,"No draft available while initializing selected task assignees.",529143577),e;var r=n.commentDraft,o=n.selectedTaskAssignees,a={};if(void 0===o){if(Object($t.c)(r.sessionConfiguration)){var i=e.tasks[r.sessionConfiguration.threadId];Object(U.k)().assertConditionTag(!!i,"Task not found.",529143616),Object(Me.a)(a,i.currentState.assignees)}void 0!==n.currentMentionees&&Object(Me.b)(a,n.currentMentionees)}else a=void 0;var c=r.sessionConfiguration.draftId,s=Object(X.a)(Object(X.a)({},e.draftState),{drafts:Object(X.a)(Object(X.a)({},e.draftState.drafts),(t={},t[c]=Object(X.a)(Object(X.a)({},e.draftState.drafts[c]),{selectedTaskAssignees:a}),t))});return Object(X.a)(Object(X.a)({},e),{draftState:s})}(e);case"UPDATE_SELECTED_TASK_ASSIGNEE":return function(e,t){var n;if(Q.m())return Object(U.k)().assertConditionTag(!1,"Should not update selectedTaskAssignee if CommentTasksWithMultiAssign is on.",529096909),e;var r=$e.H(e.draftState);if(void 0===r)return Object(U.k)().assertConditionTag(!1,"Expected active draft to be present",593764368),e;var o=r.sessionConfiguration;if(Object($t.b)(o))return e;var a=o.draftId,i=e.draftState.drafts;if(!i[a])return Object(U.k)().assertConditionTag(!1,"Expected draft to be present on update selected task assignee",593764369),e;var c=Object(X.a)(Object(X.a)({},i),((n={})[a]=Object(X.a)(Object(X.a)({},i[a]),{selectedTaskAssignee:t.payload.selectedAssignee}),n));return Object(X.a)(Object(X.a)({},e),{draftState:Object(X.a)(Object(X.a)({},e.draftState),{drafts:c})})}(e,t);case"UPDATE_SELECTED_TASK_ASSIGNEES":return function(e,t){var n,r;if(!Q.m())return Object(U.k)().assertConditionTag(!1,"Should not update selectedTaskAssignees if CommentTasksWithMultiAssign is off.",529096910),e;var o=$e.H(e.draftState);if(void 0===o)return Object(U.k)().assertConditionTag(!1,"Expected active draft to be present",529143574),e;var a=o.sessionConfiguration;if(Object($t.b)(a))return e;var i=a.draftId,c=e.draftState.drafts;if(!c[i])return Object(U.k)().assertConditionTag(!1,"Expected draft to be present on update selected task assignees",529143575),e;var s=null!==(r=c[i].selectedTaskAssignees)&&void 0!==r?r:{},d=Object(X.a)({},s);Object(Me.n)(d,t.payload.selectedAssignee);var u=Object(X.a)(Object(X.a)({},c),((n={})[i]=Object(X.a)(Object(X.a)({},c[i]),{selectedTaskAssignees:d}),n));return Object(X.a)(Object(X.a)({},e),{draftState:Object(X.a)(Object(X.a)({},e.draftState),{drafts:u})})}(e,t);case"POPULATE_SMART_REPLY":return function(e,t){return Object(X.a)(Object(X.a)({},e),{draftState:$e.r(e.draftState,t.payload)})}(e,t);case"SHOW_POST_ERROR_STATE":return function(e,t){var n=Object(X.a)(Object(X.a)({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!0}),r=Object(X.a)({},e.postViewState);return r[t.payload.commentId]=n,Object(X.a)(Object(X.a)({},e),{postViewState:r})}(e,t);case"CLEAR_POST_ERROR_STATE":return function(e,t){var n=Object(X.a)(Object(X.a)({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!1}),r=Object(X.a)({},e.postViewState);return r[t.payload.commentId]=n,Object(X.a)(Object(X.a)({},e),{postViewState:r})}(e,t);case"UPDATE_DRAFT_THREAD":return function(e,t){var n;if(!e.createdCommentLie)return e;if($e.G(e.draftState)!==t.payload.draftId)return Object(U.k)().assertConditionTag(!1,"Unexpected draft ID in updateDraftThread payload",593844429),e;if(void 0===t.payload.anchorHintText&&void 0===t.payload.insertIndex)return e;var r=Object(it.e)(e)?e.postData[t.payload.draftId]:e.createdCommentLie.newComment_deprecated;if(Object(it.e)(e)&&!r)return Object(U.k)().assertConditionTag(!1,"Did not find model for draft thread on update",527251201),e;var o=e.createdCommentLie,a={};if(void 0!==t.payload.insertIndex&&t.payload.insertIndex!==o.flatIndex&&(o=Object(X.a)(Object(X.a)({},o),{flatIndex:t.payload.insertIndex}),Object(it.e)(e))){var i=$e.fb(e.commentThreadIds,e.cardPostIds,t.payload.draftId,o);a=Object(X.a)(Object(X.a)({},a),{commentThreadIds:i})}if(void 0!==t.payload.anchorHintText&&t.payload.anchorHintText!==r.anchorHintText){var c=Object(X.a)(Object(X.a)({},r),{anchorHintText:t.payload.anchorHintText});if(Object(it.e)(e)){var s=Object(X.a)(Object(X.a)({},e.postData),((n={})[t.payload.draftId]=c,n));a=Object(X.a)(Object(X.a)({},a),{postData:s})}else o=Object(X.a)(Object(X.a)({},o),{newComment_deprecated:c})}return Object(X.a)(Object(X.a)(Object(X.a)({},e),a),{createdCommentLie:o})}(e,t);case"VIEW_CONTAINER_VISIBILITY_CHANGED":return function(e,t){var n=e.draftState,r=e.selectedComment,o=e.expandedComments;if(t.payload.visibilityState!==be.a.Visible&&!Q.r()&&(n=$e.W(n),e.selectedComment&&0===Object.keys(n.drafts).length&&Object.keys(e.draftState.drafts).length>0)){var a=$e.I(e.draftState);a&&(r=$e.m(a),o=$e.R(e.expandedComments,r,n))}return n=$e.eb(n,(function(n){var r=e.draftState.drafts[n];return $e.cb(r.renderContextType,t.payload.visibilityState)})),Object(X.a)(Object(X.a)({},e),{selectedComment:r,expandedComments:o,draftState:n})}(e,t);case"UPDATE_SUGGESTIONS_DETAILS":return function(e,t){return Object(X.a)(Object(X.a)({},e),{suggestionsDetails:t.payload.details})}(e,t);default:return e}}(e,t);return function(e,t){var n,r,o=t,a="android"===Object(ft.a)(),i=null===(n=o.selectedComment)||void 0===n?void 0:n.selectedCardId,c=$e.G(o.draftState);if(Object(it.e)(o)){var s=a&&i&&!o.expandedComments.includes(i)?Object(X.h)(Object(X.h)([],Object(X.f)(o.expandedComments),!1),[i],!1):o.expandedComments,d=o.cardPostIds,u=o.postData,l=void 0;s.forEach((function(e){e!==c&&d[e]&&(l=$e.f(d[e],null!=l?l:o.postViewState,u,o.localizationDetails))})),l&&(o=Object(X.a)(Object(X.a)({},o),{postViewState:l}))}else{if(i&&i!==c&&(a?i!==(null===(r=e.selectedComment)||void 0===r?void 0:r.selectedCardId):o.expandedComments.includes(i)&&!e.expandedComments.includes(i)))(f=$e.g(i,o.postViewState,o.commentData,o.localizationDetails))&&(o=Object(X.a)(Object(X.a)({},o),{postViewState:f}));var f,m=$e.G(e.draftState);if(m&&m!==c&&(a||o.expandedComments.includes(m)))(f=$e.g(m,o.postViewState,o.commentData,o.localizationDetails))&&(o=Object(X.a)(Object(X.a)({},o),{postViewState:f}))}return o}(e,n)}function Gn(){Object(U.k)().assertConditionTag(!1,"Must specify initial pane state!",595918942)}function qn(e,t){switch(void 0===e&&(e=function(){return{viewContainer:{closeView:Gn,openView:Gn,containerType:le.b.FullPane,moveFocusToCanvas_donotuse:Gn},componentTree:new Dn(ut.a.FullPane,M.a),visibilityState:be.a.Closed,initializationStatus:jn.a.NotInitialized,viewContainerDisplayConfiguration:void 0}}()),void 0===t&&(t=Xe.EMPTY_ACTION),t.type){case"VIEW_CONTAINER_CHANGED":return function(e,t){var n=e.viewContainer.containerType!==t.payload.viewContainer.containerType;return Object(X.a)(Object(X.a)({},e),{viewContainer:t.payload.viewContainer,componentTree:n?new Dn(Object(en.a)(t.payload.viewContainer.containerType),e.componentTree.componentTreeId.contextIdentifier,e.componentTree):e.componentTree})}(e,t);case"VIEW_CONTAINER_DISPLAY_CONFIGURATION_CHANGED":return function(e,t){if(t.payload.displayConfiguration===e.viewContainerDisplayConfiguration)return e;return Object(X.a)(Object(X.a)({},e),{viewContainerDisplayConfiguration:t.payload.displayConfiguration})}(e,t);case"VIEW_CONTAINER_VISIBILITY_CHANGED":return function(e,t){return Object(X.a)(Object(X.a)({},e),{initializationStatus:t.payload.visibilityState!==be.a.Closed||Q.v()?e.initializationStatus:jn.a.NotInitialized,visibilityState:t.payload.visibilityState})}(e,t);case"VIEW_CONTAINER_FOLDABLE_LAYOUT_STATE_CHANGED":return function(e,t){var n=Object(X.a)(Object(X.a)({},e.viewContainer),{foldableLayoutState:t.payload.foldableLayoutState});return Object(X.a)(Object(X.a)({},e),{viewContainer:n})}(e,t);case"BEGIN_VIEW_INIT":return function(e){return Object(X.a)(Object(X.a)({},e),{initializationStatus:jn.a.Initializing})}(e);case"END_VIEW_INIT":return function(e){return Object(X.a)(Object(X.a)({},e),{initializationStatus:jn.a.Initialized})}(e);default:return e}}var zn=void 0;function Wn(e,t){void 0===t&&(t=Yt.a),zn||(zn=Object(Ut.combineReducers)({paneState:qn,contentExtensions:Fn,commentState:Hn,filterState:Nn}));var n=zn(e,t);return n}var Yn=n(1042);var Kn=function(){return{threadIdRequests:new Map,sequenceId:0}};function Xn(e){return e&&(e.loadState.state===cn.a.Placeholder||e.loadState.state===cn.a.NeedsReload)}var Qn=function(e,t,n){return void 0===n&&(n=20),function(e,t,n,r,o){var a,i=n(),c=function e(){var o=t(i);o?(i=o,a=setTimeout(e,r)):(i=n(),a=void 0)},s=function(t){i=e(i,t),a||o||(a=setTimeout(c,0)),a||(a=setTimeout(c,o||r))};return s.reset=function(){void 0!==a&&(clearTimeout(a),i=n(),a=void 0)},s}(function(e){return function(t,n){var r,o,a=rt.c(e.getState());try{for(var i=Object(X.i)(n),c=i.next();!c.done;c=i.next()){var s=c.value;Xn(a[s])&&t.threadIdRequests.set(s,t.sequenceId++)}}catch(e){r={error:e}}finally{try{c&&!c.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return t}}(e),function(e,t,n){return function(r){for(var o=Array.from(r.threadIdRequests.entries()).sort((function(e,t){var n=Object(X.f)(e,2),r=(n[0],n[1]),o=Object(X.f)(t,2);o[0];return r-o[1]})),a=[],i=rt.c(e.getState()),c=o.pop();c&&a.length<n;c=o.pop()){var s=Object(X.f)(c,1)[0];r.threadIdRequests.delete(s),Xn(i[s])&&a.push(s)}if(a.length&&e.dispatch(Object(Xe.dispatchLoadThreads)({renderContextType:ut.a.None,telemetryVisitor:t,trackback:L.d.reserveTag(594888212)},{threadIds:a})),r.threadIdRequests.size>0)return r}}(e,t,n),Kn,500)},Jn=n(1085),Zn=n(1069),$n=function(e,t){return function(n){var r=Qn(n,t);return function(t){return function(o){var a=n.getState();switch(o.type){case"COMMENT_CONTEXT_CHANGED":case"RELOAD_COMMENTS":r.reset();break;case"COMMIT_DRAFT":var i=Zn.b(a),c=rt.v(a);if(void 0!==c){var s=c.commentDraft;if(o.payload.metadataUpdates&&o.payload.metadataUpdates.Task){var d=void 0;s.sessionConfiguration.sessionType!==Yn.a&&s.sessionConfiguration.sessionType!==Yn.b&&(d=i[s.sessionConfiguration.threadId]&&i[s.sessionConfiguration.threadId].id),o.payload.metadataUpdates.Task.taskId=d,s.updateProperties("Task",o.payload.metadataUpdates.Task)}o.payload.data.temporaryCommentId=s.commit(o.payload.data.commentBody)}break;case"QUEUE_LOAD_THREADS":return rt.p(a).virtualized?void r(o.payload.threadIds):void Object(U.k)().assertConditionTag(!1,"Load threads should not be queued if host is not virtualizing comments.",593768920);case"DISPATCH_LOAD_THREADS":if(!rt.p(a).virtualized)return;e.loadThreads(o.payload.threadIds);break;case"HIGHLIGHT_COMMENT":o.payload.actionSource===Qe.a.SharedComments&&e.highlightComment(o.payload.commentId);break;case"REQUEST_DELETE_POST":case"REQUEST_DELETE_THREAD":var u=rt.h(a);if(Object(tt.d)(u))return;e.deleteComment(o.payload.commentId);break;case"REQUEST_THREAD_RESOLVE":Q.c()?e.beginDraftingAsync({sessionType:"METADATA",threadId:o.payload.commentId}).then((function(e){var t=Zn.b(a)[o.payload.commentId];t&&e.updateProperties("Task",{type:"Task",completion:100,taskId:t.id}),e.updateProperties("Resolve",{type:"Resolve",isResolved:!0}),e.commit(),e.endDrafting()})).catch(Object(ne.a)(L.d.reserveTag(593768922))):e.setThreadResolvedState(o.payload.commentId,!0);break;case"REQUEST_REOPEN_THREAD":Q.c()?e.beginDraftingAsync({sessionType:"METADATA",threadId:o.payload.commentId}).then((function(e){var t=Zn.b(a)[o.payload.commentId];t&&e.updateProperties("Task",{type:"Task",completion:0,taskId:t.id}),e.updateProperties("Resolve",{type:"Resolve",isResolved:!1}),e.commit(),e.endDrafting()})).catch(Object(ne.a)(L.d.reserveTag(593768924))):e.setThreadResolvedState(o.payload.commentId,!1);break;case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":e.selectFirstThreadInNextCommentContext();break;case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":e.selectLastThreadInPreviousCommentContext();break;case"PRESENT_LINK_TO_COMMENT":e.presentLinkToComment(o.payload.commentId)}var l=t(o),f=n.getState(),m=rt.t(a),p=rt.t(f),h=void 0;switch("LOAD_COMMENT"===o.type||"VIRTUALIZE_COMMENTS"===o.type||"SELECT_COMMENT"===o.type&&o.payload.source!==Qe.a.SharedComments||!p||p.selectedCardId===(null==m?void 0:m.selectedCardId)||p.selectedCardId===Object(te.y)()||(h=p.selectedCardId),o.type){case"CLEAR_COMMENT_HIGHLIGHT":o.payload.actionSource===Qe.a.SharedComments&&void 0!==a.commentState.highlightedCommentId&&void 0===f.commentState.highlightedCommentId&&e.highlightComment("");break;case"DISPLAY_DRAFT_WARNING":if(Q.F()&&!Jn.b(n.getState())){var v=rt.v(f);v&&(h=v.threadId)}}return h&&e.selectComment(h),l}}}};function er(e,t,n){var r=e.getState(),o=Jn.a(r)[G.e.Isolated];return!!o&&(n(t),o.controller.triggerUpdate(),!0)}function tr(e,t,n,r){return"CREATE"===r&&er(e,t,n)}function nr(e,t){return 0===rt.f(t).lastContextChangeIncrement?G.d.Disabled:e===G.e.TaskPane||e===G.e.TaskPaneItem?at.a(t)?G.d.Primary:G.d.Disabled:rt.q(t)?G.d.Disabled:nr(G.e.TaskPane,t)!==G.d.Primary?G.d.Primary:e===G.e.Integrated?G.d.Disabled:G.d.Secondary}function rr(e,t){var n=Jn.a(e)[t];n&&(n.controller.priority=n.priority)}var or=function(e){return function(t){return function(n){return function(r){var o,a,i;switch(r.type){case"ADD_CONTENT_EXTENSION":r.payload.extension.priority=nr(r.payload.extension.provider.scope.renderMode,t.getState());break;case"REMOVE_CONTENT_EXTENSION":try{for(var c=Object(X.i)(r.payload.renderModes),s=c.next();!s.done;s=c.next()){var d=s.value,u=Jn.a(t.getState())[d];u&&u.controller.unregisterExtension()}}catch(e){o={error:e}}finally{try{s&&!s.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}break;case"UPDATE_EXTENSION_PRIORITY":n(r),rr(t.getState(),G.e.TaskPane),rr(t.getState(),G.e.TaskPaneItem),rr(t.getState(),G.e.Integrated),rr(t.getState(),G.e.Isolated);break;case"APPLY_COMMENT_CHANGES":case"CANCEL_COMMENT_CREATE_THREAD":if(er(t,r,n))return;break;case"COMMENT_CONTEXT_CHANGED":case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":case"RELOAD_COMMENTS":case"VIEW_CONTAINER_VISIBILITY_CHANGED":return n(r),void t.dispatch(Object(Xe.updateExtensionPriority)({renderContextType:ut.a.None,telemetryVisitor:e,trackback:L.d.reserveTag(594834319)},(i={},i[G.e.TaskPane]=nr(G.e.TaskPane,t.getState()),i[G.e.TaskPaneItem]=nr(G.e.TaskPaneItem,t.getState()),i[G.e.Integrated]=nr(G.e.Integrated,t.getState()),i[G.e.Isolated]=nr(G.e.Isolated,t.getState()),i)));case"BEGIN_DRAFTING_SUCCESS":if(tr(t,r,n,r.payload.draftDetails.sessionConfiguration.sessionType))return;break;case"BEGIN_DRAFTING_FAILURE":if(tr(t,r,n,r.payload.beginDraftingParams.sessionType))return;break;case"UPDATE_DRAFT_RENDER_CONTEXT":if(r.payload.isClaimingLock||r.actionDetail.renderContextType===ut.a.DiscreteIsolated)break;var l=rt.v(t.getState());if(l&&tr(t,r,n,l.commentDraft.sessionConfiguration.sessionType))return}return n(r)}}}},ar=function(e){return function(t){return function(n){return function(r){var o;if(!e||!Jn.b(t.getState()))return n(r);var a=t.getState(),i=n(r),c=t.getState();switch(r.type){case"DISPLAY_DRAFT_WARNING":var s=rt.t(a),d=rt.t(c),u=!d||d.selectedCardId===(null==s?void 0:s.selectedCardId);if(Q.F()&&u){var l=rt.v(c);l&&e.bringContentIntoView({contentIdentifier:{contentId:l.threadId,contentType:G.b.CommentThread}})}break;case"SELECT_COMMENT":var f=rt.t(c);r.payload.source===Qe.a.SharedComments&&r.payload.selectType!==Xe.SelectActionType.Polite&&Object(mt.b)(r.actionDetail.renderContextType)&&f&&e.bringContentIntoView({contentIdentifier:{contentId:f.selectedCardId,contentType:G.b.CommentThread}});break;case"VIEW_CONTAINER_VISIBILITY_CHANGED":if(at.a(c))break;var m=rt.v(c),p=m&&m.isInCurrentContext&&(null===(o=rt.t(c))||void 0===o?void 0:o.selectedCardId)===m.threadId?m.threadId:void 0;p&&e.bringContentIntoView({contentIdentifier:{contentId:p,contentType:G.b.CommentThread}});break;case"SELECT_CONTENT":e.selectNextOrPreviousContent(r.payload);break;case"MOVE_FOCUS_TO_CANVAS":e.moveFocus({region:ie.a.Canvas,resource:r.payload.resource})}return i}}}},ir=n(1180),cr=function(e){return function(t){return function(n){return function(r){var o=t.getState().commentState.draftState.drafts;n(r);var a=t.getState().commentState.draftState.drafts;if(Object.keys(o).forEach((function(t){if(void 0===a[t]){var n=Object(U.k)().createActivityObject("EndDraftingCalledOnAction",e,Object(U.j)());n.addDataField("ActionName",r.type,U.d.SystemMetadata),n.successTag(539313865),o[t].commentDraft.endDrafting()}})),Object(Q.s)()&&"SAVE_DRAFT"===r.type){var i=a[r.payload.draftId];i&&Object(ir.a)().storeEditorContentFromDraftSave(r.payload,i.commentDraft.sessionConfiguration)}}}}},sr=n(1070),dr=n(1184),ur=n(1163),lr=Object(U.j)();function fr(e){switch(e.type){case"APPLY_COMMENT_CHANGES":return{name:"ApplyCommentChangesAction",activityConfig:Object(U.n)({aggregationMode:U.a.OnSuccess})};case"BEGIN_PROCESSING_COMMIT":return{name:"BeginProcessingCommitAction",activityConfig:lr};case"CANCEL_COMMENT_CREATE_THREAD":return{name:"CancelCommentCreateThreadAction",activityConfig:lr};case"CANCEL_COMMENT_POST_EDIT":return{name:"CancelCommentPostEditAction",activityConfig:lr};case"CANCEL_COMMENT_REPLY":return{name:"CancelCommentReplyAction",activityConfig:lr};case"COLLAPSE_CARD":return{name:"CollapseCardAction",activityConfig:lr};case"COMMIT_DRAFT":return{name:"CommitDraftAction",activityConfig:lr};case"DISPLAY_DRAFT_WARNING":return{name:"DisplayDraftWarningAction",activityConfig:lr};case"RELOAD_COMMENTS":return{name:"ReloadCommentsAction",activityConfig:Object(U.n)({aggregationMode:U.a.OnSuccess})};case"REQUEST_DELETE_POST":return{name:"DeletePostAction",activityConfig:lr};case"REQUEST_DELETE_THREAD":return{name:"DeleteThreadAction",activityConfig:lr,logDocumentMetadata:U.f.Basic};case"DISPATCH_LOAD_THREADS":return{name:"LoadThreadsAction",activityConfig:Object(U.n)({aggregationMode:U.a.OnSuccess})};case"REQUEST_REOPEN_THREAD":return{name:"ReopenThreadAction",activityConfig:lr};case"REQUEST_THREAD_RESOLVE":return{name:"ResolveThreadAction",activityConfig:lr,logDocumentMetadata:U.f.Basic};case"SELECT_COMMENT":return{name:"SelectCommentAction",activityConfig:lr};case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":return{name:"SelectFirstThreadInNextCommentContextAction",activityConfig:lr};case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":return{name:"SelectLastThreadInPreviousCommentContextAction",activityConfig:lr};case"SESSION_REQUEST_STARTED":return{name:"SessionRequestStartedAndLockSelectionAction",activityConfig:lr};case"SHOW_LOW_FIDELITY_WARNING":return{name:"ShowLowFidelityWarningAction",activityConfig:lr};case"CLEAR_LOW_FIDELITY_WARNING":return{name:"ClearLowFidelityWarningAction",activityConfig:lr};case"UPDATE_DRAFT_RENDER_CONTEXT":return{name:"UpdateDraftRenderContext",activityConfig:lr};case"PRESENT_LINK_TO_COMMENT":return{name:"PresentLinkToCommentAction",activityConfig:lr};case"CLEAR_COMMENT_SELECTION":default:return}}var mr=function(){return function(e){return function(t){try{return e(t)}catch(e){if(void 0===fr(t)){var n=Object(U.k)().createActivityObject("ExceptionMiddlewareCatch",t.actionDetail.telemetryVisitor,Object(U.j)());n.addDataField("OperationType",t.type,U.d.SystemMetadata),n.addDataField("Trackback",t.actionDetail.trackback,U.d.SystemMetadata),n.failTag(593278723,Object(sr.a)(e))}!function(e){if(Object(dr.a)(e))throw e;if(!Object(me.b)(e))throw Object(U.k)().assertConditionTag(!1,"Unknown error encountered, rethrowing: ".concat(Object(L.l)(e)),593278724),e;switch(e.errorCode){case-2130957565:case-2130957551:throw e;case-2130957536:return;default:Object(U.k)().assertConditionTag(!1,"Unexpected error: Name: ".concat(e.name," errorCode: ").concat(e.errorCode," Tag: ").concat(e.tag," internalDetails: ").concat(Object(L.l)(e)),e.tag)}}(e)}}}};var pr=n(1208),hr=n(1080),vr=function(e){return function(t){return function(n){return function(r){var o,a,i=t.getState(),c=n(r),s=t.getState();switch(r.type){case"BEGIN_DRAFTING_SUCCESS":var d=rt.h(s),u=r.payload.draftDetails.sessionConfiguration.draftId;(l=d.drafts[u])&&e.setDeferredActiveEditorFocusCommand(u);break;case"DISPLAY_DRAFT_WARNING":if(r.payload.draftWarningType===hr.a.CommitFailed)break;var l;d=rt.h(s);(l=Object($e.H)(d))&&e.setDeferredActiveEditorFocusCommand(l.sessionConfiguration.draftId)}return(null===(o=rt.t(s))||void 0===o?void 0:o.selectedCardId)===(null===(a=rt.t(i))||void 0===a?void 0:a.selectedCardId)&&rt.h(s)===rt.h(i)||e.clearPendingOnComponentFocusedRequest(),c}}}},gr=n(1034),yr=function(e){return function(t){return function(t){return function(n){switch(n.type){case"DISPLAY_DRAFT_WARNING":if(!Q.F())break;var r=gr.g(e,n.payload.draftWarningType);Object(Se.a)(n.payload.draftWarningType===hr.a.ReturnToDraft?e.formatString(230,r):r)}return t(n)}}}},br=n(1554),Cr=n(1261);var Tr;function Ir(e){e.timerHandle&&clearTimeout(e.timerHandle)}!function(e){e[e.Yes=0]="Yes",e[e.No=1]="No",e[e.Unknown=2]="Unknown"}(Tr||(Tr={}));var Sr=function(){function e(e){var t=this;this.telemetryVisitor=e,this.trackerActivityName="E2EPerfTracker",this.performanceActivities={},this.failTracker=function(e,n,r){var o=t.performanceActivities[e];o&&(o.activity.failTag(n,null!=r?r:-2130957541),Ir(o),delete t.performanceActivities[e])},this.timeoutTracker=function(e,n,r){var o=t.performanceActivities[e];o&&(Ir(o),o.activity.addDataField("Timeout",!0,U.d.SystemMetadata),n.failOnTimeout?o.activity.failTag(r,-2130957491):o.activity.successTag(r),delete t.performanceActivities[e])}}return e.prototype.beginTracking=function(e,t,n,r,o){var a=this;void 0===o&&(o={timeout:5e3,failOnTimeout:!0});var i=r||Object(U.k)().createActivityObject(this.trackerActivityName,this.telemetryVisitor,Object(U.j)());i.addDataField("OperationType",n,U.d.SystemMetadata),this.performanceActivities.hasOwnProperty(e)&&(Object(U.k)().assertConditionTag(!1,"Duplicate ID used for PerfActivity. Overwriting initial perf tracker with failure.",595132703),this.failTracker(e,L.d.reserveTag(595907678)));var c={activity:i,expectedChangeType:t};c.timerHandle=setTimeout((function(){return a.timeoutTracker(e,o,L.d.reserveTag(575484417))}),o.timeout),this.performanceActivities[e]=c},e.prototype.updateTrackerId=function(e,t){if(e!==t){this.performanceActivities.hasOwnProperty(t)&&(Object(U.k)().assertConditionTag(!1,"Duplicate ID used for updateTrackerId. Overwriting initial perf tracker with failure.",595132704),this.failTracker(t,L.d.reserveTag(595132705)));var n=this.performanceActivities[e];n&&(this.performanceActivities[t]=n,delete this.performanceActivities[e])}},e.prototype.failAllTrackers=function(e,t){var n=this;Object.keys(this.performanceActivities).forEach((function(r){var o=n.performanceActivities[r];Ir(o),o.activity.failTag(e,null!=t?t:-2130957541)})),this.performanceActivities={}},e.prototype.endTracker=function(e,t,n){var r=this.performanceActivities[e];r&&(Ir(r),r.activity.addDataField("ExpectedChangeArrived",r.expectedChangeType===t?Tr.Yes:Tr.No,U.d.SystemMetadata),r.activity.successTag(n),delete this.performanceActivities[e])},e.prototype.endAllTrackers=function(e){for(var t in this.performanceActivities){var n=this.performanceActivities[t];Ir(n),n.activity.addDataField("ExpectedChangeArrived",Tr.Unknown,U.d.SystemMetadata),n.activity.successTag(e)}this.performanceActivities={}},e.prototype.getTracker=function(e,t){var n=this.performanceActivities[e];if(n&&n.expectedChangeType===t)return n},e}(),Or=function(){function e(e){this.telemetryVisitor=e,this.trackerActivityName="LowFidelityScenarioTracker"}return e.prototype.beginTracking=function(e){var t=Object(nt.b)(e);this.activity&&t!==this.selectedCommentId&&(this.activity.addDataField("OperationType","SHOW_LOW_FIDELITY_WARNING",U.d.SystemMetadata),this.activity.successTag(593098840),this.activity=void 0,this.selectedCommentId=void 0),this.activity||this.selectedCommentId||(this.activity=Object(U.k)().createActivityObject(this.trackerActivityName,this.telemetryVisitor,Object(U.j)()),this.selectedCommentId=t)},e.prototype.endTrackingIfWarningDismissed=function(e,t){var n=Object(nt.b)(t);!this.activity||n===this.selectedCommentId&&Object(nt.h)(t)||(this.activity.addDataField("OperationType",e.type,U.d.SystemMetadata),this.activity.successTag(593098841),this.activity=void 0,this.selectedCommentId=void 0)},e}();function wr(e,t){t?e.addDataField("AffectingTaskMetadata",!0,U.d.SystemMetadata):e.addDataField("AffectingTaskMetadata",!1,U.d.SystemMetadata)}function jr(e,t,n,r){var o=Object(it.b)(t,r);if(o){var a,i=Object(Xt.j)(o);(a=Object(it.c)(t)?n[i].some((function(e){return 0!=(t[e].commentFlags&Xt.e.IsNew)})):t.some((function(e){return(e.commentId===i||e.parentId===i)&&0!=(e.commentFlags&Xt.e.IsNew)})))&&e.addDataField("HasNewComment",a,U.d.SystemMetadata)}}var Er=function(e){var t=new Sr(e),n=new Or(e),r=Object(br.a)((function(e){Object(U.k)().createActivityObject("PostButtonTeachingCallout",e.actionDetail.telemetryVisitor,Object(U.j)()).successTag(573687565)}));return function(e){return function(o){return function(a){var i,c,s=function(){var t,n,r,i,c,s,d=fr(a);if(!d)return Object(U.k)().assertConditionTag(!1,"Event name not defined for action type: ".concat(a.type),595616738),o(a);var u=Object(U.k)().createActivityObject(d.name,a.actionDetail.telemetryVisitor,d.activityConfig);u.addDataField("Trackback",a.actionDetail.trackback,U.d.SystemMetadata),u.addDataField("RenderContextType",a.actionDetail.renderContextType,U.d.SystemMetadata),d.logDocumentMetadata&&u.addDocumentMetadata(d.logDocumentMetadata);var l=function(e,t,n){var r=Object($e.h)(e,n);r.valid&&(u.addDataField("MatchesCommentAuthor",r.matchesCurrentUser,U.d.SystemMetadata),u.addDataField("ThreadCreationDeltaMs",r.timeElapsed,U.d.SystemMetadata)),jr(u,e,t,n)},f=e.getState(),m=Zn.b(f);switch(Object(Je.c)(f,u),a.type){case"COMMIT_DRAFT":var p=function(e){if("COMMIT_DRAFT"===e.type)return{name:"CommitDraft".concat(Object(ur.b)(e.payload),"Action"),activityConfig:lr}}(a);if(!p)return Object(U.k)().assertConditionTag(!1,"Event name not defined for given draft action type",595903002),o(a);var h=Object(U.k)().createActivityObject(p.name,a.actionDetail.telemetryVisitor,Object(U.j)());h.addDataField("RenderContextType",a.actionDetail.renderContextType,U.d.SystemMetadata),h.successTag(595903074);var v=Zt.b[a.payload.sessionType];u.addDataField("SessionType",v,U.d.SystemMetadata),"REPLY"===a.payload.sessionType&&jr(u,rt.d(f),rt.b(f),a.payload.data.parentId);break;case"DISPLAY_DRAFT_WARNING":u.addDataField("DraftWarningType",a.payload.draftWarningType,U.d.SystemMetadata),u.addDataField("DraftWarningReason",a.payload.draftWarningReason,U.d.SystemMetadata);var g=Object($e.K)(f.commentState.draftState);g&&u.addDataField("IsDraftInCurrentContext",g.isInCurrentContext,U.d.SystemMetadata);break;case"UPDATE_DRAFT_RENDER_CONTEXT":u.addDataField("IsClaimingDraftLock",a.payload.isClaimingLock,U.d.SystemMetadata),u.addDataField("IsUpdatingAllDraftLocks",!a.payload.draftId,U.d.SystemMetadata);break;case"SELECT_COMMENT":u.addDataField("SelectType",Xe.SelectActionType[a.payload.selectType],U.d.SystemMetadata),u.addDataField("ActionSource",Qe.a[a.payload.source],U.d.SystemMetadata);var y=rt.t(f),b=!(!y||y.selectedCardId!==a.payload.selectedCard);u.addDataField("IsCurrentCard",b,U.d.SystemMetadata),b||jr(u,rt.d(f),rt.b(f),a.payload.selectedCard),Object(Cr.b)(a.payload.source)&&Object(Cr.c)(a.payload.selectType)&&Object(Cr.d)(u,Object(Cr.a)(rt.e(f,a.payload.selectedCard)));break;case"REQUEST_THREAD_RESOLVE":case"REQUEST_REOPEN_THREAD":wr(u,a.payload.isTask),l(rt.d(f),rt.b(f),a.payload.commentId);var C=void 0;if(a.payload.isTask){C="REQUEST_THREAD_RESOLVE"===a.type?"ResolveThreadWithTask":"ReopenThreadWithTask",u.addDataField(C,!0,U.d.SystemMetadata,U.e.Critical);var T=null===(r=null===(n=null===(t=m[a.payload.commentId])||void 0===t?void 0:t.history[0])||void 0===n?void 0:n.records[0])||void 0===r?void 0:r.time;u.addDataField("TaskCreationTimeDeltaMs",T?Date.now()-T.getTime():0,U.d.SystemMetadata,U.e.Critical)}Object(Cr.d)(u,Object(Cr.a)(rt.e(f,a.payload.commentId)));break;case"REQUEST_DELETE_THREAD":if(wr(u,a.payload.isTask),a.payload.isTask){u.addDataField("DeleteThreadWithTask",!0,U.d.SystemMetadata,U.e.Critical);T=null===(s=null===(c=null===(i=m[a.payload.commentId])||void 0===i?void 0:i.history[0])||void 0===c?void 0:c.records[0])||void 0===s?void 0:s.time;u.addDataField("TaskCreationTimeDeltaMs",T?Date.now()-T.getTime():0,U.d.SystemMetadata,U.e.Critical)}Object(Cr.d)(u,Object(Cr.a)(rt.e(f,a.payload.commentId))),l(rt.d(f),rt.b(f),a.payload.commentId);break;case"REQUEST_DELETE_POST":l(rt.d(f),rt.b(f),a.payload.commentId)}try{var I=e.getState(),S=o(a),O=e.getState(),w=rt.h(I),j=rt.h(O);switch(a.type){case"UPDATE_DRAFT_RENDER_CONTEXT":var E=a.payload.draftId?w.drafts[a.payload.draftId]:Object($e.K)(w),k=a.payload.draftId?j.drafts[a.payload.draftId]:Object($e.K)(j),P=void 0!==E&&void 0!==k&&E.renderContextType!==k.renderContextType;u.addDataField("DidDraftLockUpdate",P,U.d.SystemMetadata)}return u.successTag(595616739),S}catch(e){throw u.failTag(595616768,Object(sr.a)(e,-2130957541)),e}};switch(a.type){case"BEGIN_PROCESSING_COMMIT":var d=Object(U.k)().createActivityObject(t.trackerActivityName,a.actionDetail.telemetryVisitor,Object(U.j)());try{s()}catch(e){throw d.failTag(595687567,Object(sr.a)(e,-2130957541)),e}if(!(l=rt.v(e.getState()))){d.failTag(595687569,-2130957541);break}var u=l.commentDraft.sessionConfiguration;t.beginTracking(u.draftId,Zt.a[u.sessionType],u.sessionType,d);break;case"COMMIT_FAILURE":var l=rt.v(e.getState());Object(U.k)().assertConditionTag(!!l,"Draft should exist when failing a commit.",595132701),l&&t.failTracker(l.commentDraft.sessionConfiguration.draftId,L.d.reserveTag(595132702)),o(a);break;case"REQUEST_THREAD_RESOLVE":case"REQUEST_REOPEN_THREAD":t.beginTracking(a.payload.commentId,Qt.a.Modify,a.type);try{s()}catch(e){throw t.failTracker(a.payload.commentId,L.d.reserveTag(595907670),Object(sr.a)(e,-2130957541)),e}break;case"REQUEST_DELETE_POST":case"REQUEST_DELETE_THREAD":t.beginTracking(a.payload.commentId,Qt.a.Delete,a.type);try{s()}catch(e){throw t.failTracker(a.payload.commentId,L.d.reserveTag(595907671),Object(sr.a)(e,-2130957541)),e}break;case"COMMENT_CONTEXT_CHANGED":try{o(a)}catch(e){throw t.failAllTrackers(L.d.reserveTag(595731294),Object(sr.a)(e,-2130957541)),e}break;case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":if(("LOAD_COMMENT"===a.type?a.payload.commentData:a.payload.threadInfo).length>0&&!t.getTracker("LoadCommentTracker",Qt.a.Load)){d=Object(U.k)().createActivityObject(t.trackerActivityName,a.actionDetail.telemetryVisitor,Object(U.j)());t.beginTracking("LoadCommentTracker",Qt.a.Load,a.type,d,{timeout:1e6,failOnTimeout:!1})}o(a);break;case"RELOAD_COMMENTS":try{s()}catch(e){throw t.failAllTrackers(L.d.reserveTag(595907672),Object(sr.a)(e,-2130957541)),e}t.endAllTrackers(L.d.reserveTag(595907673));break;case"ON_INITIAL_RENDER":var f=t.getTracker("LoadCommentTracker",Qt.a.Load);f&&(f.activity.addDataField("RenderContextType",a.payload.renderContextType,U.d.SystemMetadata),t.endTracker("LoadCommentTracker",Qt.a.Load,L.d.reserveTag(595646476))),o(a);break;case"APPLY_COMMENT_CHANGES":try{s()}catch(e){throw t.failAllTrackers(L.d.reserveTag(595907674),Object(sr.a)(e,-2130957541)),e}try{for(var m=Object(X.i)(a.payload.changes),p=m.next();!p.done;p=m.next()){var h=p.value;if(h.type===Qt.a.Load||h.type===Qt.a.Unknown)break;if(h.type!==Qt.a.Delete&&h.type!==Qt.a.Modify){if(h.type===Qt.a.Insert){void 0!==h.tempId&&""===h.model.parentId&&Object(dn.a)(a.actionDetail.telemetryVisitor);var v=h.tempId||h.model.parentId;void 0!==v&&t.endTracker(v,h.type,L.d.reserveTag(595857620))}}else t.endTracker(h.model.commentId,h.type,L.d.reserveTag(595907675))}}catch(e){i={error:e}}finally{try{p&&!p.done&&(c=m.return)&&c.call(m)}finally{if(i)throw i.error}}break;case"COMMIT_DRAFT":l=rt.v(e.getState());if(s(),a.payload.data.temporaryCommentId&&l){var g=void 0;switch((u=l.commentDraft.sessionConfiguration).sessionType){case"CREATE":!function(e){Object(dn.a)(e)}(a.actionDetail.telemetryVisitor),g=a.payload.data.temporaryCommentId;break;case"REPLY":g=a.payload.data.temporaryCommentId;break;case"EDIT":g=u.commentId;break;case"METADATA":g=u.threadId;break;default:Object(L.m)(u)}g&&t.updateTrackerId(u.draftId,g)}break;case"DISPATCH_LOAD_THREADS":case"CANCEL_COMMENT_CREATE_THREAD":case"CANCEL_COMMENT_POST_EDIT":case"CANCEL_COMMENT_REPLY":case"PRESENT_LINK_TO_COMMENT":case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":case"SESSION_REQUEST_STARTED":case"UPDATE_DRAFT_RENDER_CONTEXT":case"SELECT_COMMENT":case"DISPLAY_DRAFT_WARNING":case"CLEAR_LOW_FIDELITY_WARNING":s();break;case"SHOW_LOW_FIDELITY_WARNING":s();var y=rt.t(e.getState());y&&n.beginTracking(y);break;case"VIEW_CONTAINER_VISIBILITY_CHANGED":var b="";switch(a.payload.visibilityState){case be.a.Closed:b="ViewContainerClosed";break;case be.a.Hidden:b="ViewContainerHidden";break;case be.a.Visible:b="ViewContainerVisible";break;default:Object(L.m)(a.payload.visibilityState)}var C=Object(U.k)().createActivityObject(b,a.actionDetail.telemetryVisitor,Object(U.n)({aggregationMode:U.a.Always}));o(a),C.successTag(592241220);break;case"DRAFT_EMPTINESS_CHANGED":var T=rt.h(e.getState()).drafts[a.payload.draftId].commentDraft.sessionConfiguration.sessionType;T!==Xt.c&&T!==Xt.h||r(a),o(a);break;case"CLEAR_COMMENT_SELECTION":default:o(a)}var I=rt.t(e.getState());I&&n.endTrackingIfWarningDismissed(a,I)}}}},kr=n(1152),Pr=n(1113),xr=n(1209),Ar=function(e,t){return function(e){return function(n){return function(r){switch(r.type){case"REQUEST_SHOW_PANE":(a=at.d(e.getState())).openView();break;case"REQUEST_CLOSE_PANE":(a=at.d(e.getState())).closeView();break;case"MOVE_FOCUS_TO_CANVAS":if(!Jn.b(e.getState()))(a=at.d(e.getState())).moveFocusToCanvas_donotuse();break;case"REQUEST_MODAL_CONFIRMATION":(a=at.d(e.getState())).invokeModalConfirmationDialog?a.invokeModalConfirmationDialog(r.payload.onConfirm,r.payload.onCancel,r.payload.displayStrings):(Object(U.k)().assertConditionTag(!1,"Host does not have modal dialog implemented",593278688),a.closeView());break;case"READY_TO_RENDER":(a=at.d(e.getState())).onReadyToRender&&a.onReadyToRender();break;case"RESOLVE_ATMENTION_CAPABILITY":if(Q.z()){var o=r.payload.capability===kr.a.Enabled;t.initializeController(o)}break;case"BEGIN_DRAFTING_SUCCESS":var a=at.d(e.getState());Object(Pr.a)(a)&&"CREATE"===r.payload.draftDetails.sessionConfiguration.sessionType&&Rr(e.dispatch,r.actionDetail,{displayMode:Ye.a.Variable,desiredHeight:0}),Dr(e.getState(),a);break;case"DISPLAY_DRAFT_WARNING":Dr(e.getState());break;case"CANCEL_COMMENT_CREATE_THREAD":case"CANCEL_COMMENT_POST_EDIT":case"CANCEL_COMMENT_REPLY":if(r.payload.closeOnDiscard){a=at.d(e.getState());return n(r),void a.closeView()}}var i=e.getState(),c=n(r),s=e.getState();return function(e,t,n,r){var o=at.d(r);if(!Object(Pr.a)(o))return;var a=rt.h(r),i=rt.h(n),c=Object(tt.c)(a),s=Object(tt.c)(i),d=!!Object($e.G)(a),u=!!Object($e.G)(i);if(c!==s||!Object(Pr.a)(at.d(n))||!d&&u){if(!c)return d?void Rr(e,t,{displayMode:Ye.a.Variable,desiredHeight:0}):void Rr(e,t,{displayMode:Ye.a.Normal});var l=rt.t(r);if(l&&l.selectedCardId===Object($e.G)(a))return;Rr(e,t,{displayMode:Ye.a.FullScreen})}}(e.dispatch,r.actionDetail,i,s),c}}}};function Dr(e,t){(function(e){var t=at.e(e);return Q.v()&&(Q.r()?t===be.a.Hidden:t!==be.a.Visible)})(e)&&(t||at.d(e)).openView()}function Rr(e,t,n){e(Object(xr.a)(t,n)).catch(Object(ne.a)(L.d.reserveTag(578426776)))}var Fr=n(1054),Nr=n(1117),Mr=n(1064),Lr=n(1096),Br=n(1048),Vr=n(1098),Ur=n(1263),_r=function(){function e(e,t,n){this.commentStore=e,this.commandFactory=new Bt(this.commentStore,t,n)}return e.prototype.selectNextOrPreviousThread=function(e,t,n){var r=Q.r()&&!at.a(this.commentStore.getState()),o=at.c(this.commentStore.getState());return Ur.a(this.commandFactory.selectNextOrPreviousThread(void 0,e,t,n,r),o,this.commentStore,(function(){}))===dt.a.Handled},e.prototype.selectAcrossContexts=function(e,t){var n=at.c(this.commentStore.getState()),r=rt.f(this.commentStore.getState()),o=Q.r()&&!at.a(this.commentStore.getState());Ur.a(this.commandFactory.selectAcrossContexts(void 0,{direction:e,source:Qe.a.SharedComments,expandCard:!0,iterableContentTypes:void 0},t,r.nextPopulatedContextDetails,o),n,this.commentStore,(function(){}))},e}(),Hr=n(1185),Gr=n(1186),qr={PostHeight:69,ExpandButtonHeight:26,ReplyDraftHeight:44,TaskTopper:29};function zr(e){var t=e.itemCount,n=e.readOnly,r=e.isTask,o=function(){return qr}(),a=o.PostHeight;return t>1&&(a+=o.PostHeight+0),t>2&&(a+=o.ExpandButtonHeight+0),n||(a+=o.ReplyDraftHeight+0),r&&(a+=o.TaskTopper),a}function Wr(e,t){return function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return Object(X.c)(r,n),r.prototype.render=function(){var n=Object(X.a)(Object(X.a)({},t),this.props);return i.createElement(e,n)},r}(i.PureComponent)}var Yr=n(1086);function Kr(e,t){return function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return Object(X.c)(r,n),r.prototype.render=function(){return i.createElement(Yr.Provider,{store:t},i.createElement(e,Object(X.a)({},this.props)))},r}(i.PureComponent)}var Xr,Qr=function(){function e(e){var t=this;this.internalHandler=e,this.eventQueue=[],this._isProcessingEvents=!1,this.handler=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t._isProcessingEvents?t.internalHandler.apply(t,Object(X.h)([],Object(X.f)(e),!1)):t.eventQueue.push(e)}}return Object.defineProperty(e.prototype,"isProcessingEvents",{get:function(){return this._isProcessingEvents},enumerable:!1,configurable:!0}),e.prototype.pauseProcessing=function(){this._isProcessingEvents=!1},e.prototype.startProcessing=function(){var e,t;if(!this._isProcessingEvents){this._isProcessingEvents=!0;try{for(var n=Object(X.i)(this.eventQueue),r=n.next();!r.done;r=n.next()){var o=r.value;this.handler.apply(this,Object(X.h)([],Object(X.f)(o),!1))}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.eventQueue=[]}},e}(),Jr=n(14),Zr=n(1072);!function(e){e.CreateThread="CreateThread",e.CancelCreateThread="CancelCreateThread",e.StartReplySession="StartReplySession",e.CancelReplySession="CancelReplySession",e.PostReply="PostReply",e.DeleteComment="DeleteComment",e.DeleteThread="DeleteThread",e.ResolveThread="ResolveThread",e.ReopenThread="ReopenThread",e.StartEditSession="StartEditSession",e.CancelEditSession="CancelEditSession",e.PostEdit="PostEdit",e.SelectComment="SelectComment",e.ClosePane="ClosePane",e.ClickGhostCard="ClickGhostCard"}(Xr||(Xr={}));var $r,eo=n(1202),to=n(1099),no=n(1140),ro=n(1268),oo=n(1132),ao=(L.d.reserveTag(595723983),L.d.reserveTag(595723984),L.d.reserveTag(574456150)),io=L.d.reserveTag(574456151),co=L.d.reserveTag(574456152),so=L.d.reserveTag(574456153),uo=n(1104),lo=function(){function e(e,t){this.mockId="",this.mockContents="",this.getContentsAsync=this.getContentsAsync.bind(this),this.getId=this.getId.bind(this),this.getCursorPositionAsync=this.getCursorPositionAsync.bind(this),e&&(this.mockId=e),t&&(this.mockContents=t)}return e.prototype.getId=function(){return this.mockId},e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e}(),fo=function(){function e(e){this.mockContents="",this.mockId="",e&&(this.mockId=e)}return e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e.prototype.setContents=function(e){this.mockContents=e},e.prototype.getId=function(){return this.mockId},e}();!function(e){e[e.None=0]="None",e[e.NeedDrafting=1]="NeedDrafting",e[e.NeedNotDrafting=2]="NeedNotDrafting"}($r||($r={}));var mo=function(){function e(e){this.mockContents="",this.mockId="",e&&(this.mockId=e)}return e.prototype.getId=function(){return this.mockId},e}(),po=function(){function e(e,t){var n=this;this.viewManager=e,this.mockUIDriver=t,this.pendingActionReason=$r.None,this.pendingAction=void 0,this.startProcessingActionsPending=void 0,this.getActiveComponentTree=function(e){return at.a(e)?at.c(e):n.viewManager.getComponentTreeForRenderMode(G.e.Integrated)},this.makeGetRenderableItemThreads=function(e){return Object(Jr.a)([rt.h,rt.g,rt.c,e,n.getActiveComponentTree],(function(e,t,n,r,o){return Rt.c(r,n,t,o.componentTreeId.renderContextType!==ut.a.HalfPane,Object(ro.a)(e,o.componentTreeId.renderContextType))}))},this.getCompleteHostableCommentCardRendererOwnProps=function(e){return Object(X.a)(Object(X.a)({},n.viewManager.getHostableCommentCardRendererProps(G.e.Integrated)),{resource:{id:e},componentInstanceId:Object(B.a)()})},this.getCompletePaneOwnProps=function(){return Object(X.a)(Object(X.a)({},n.viewManager.getPaneOwnProps()),{resource:{id:"CommentPane"}})},this.getDispatchProps=function(e){var t=n.commentStore.getState(),r=n.commentStore.dispatch;return at.a(t)?Object(eo.b)(r,n.getCompletePaneOwnProps()):Object(eo.a)(r,n.getCompleteHostableCommentCardRendererOwnProps(e))},this.getNewThreadDraftId=function(){return Object($e.G)(rt.h(n.commentStore.getState()),!0)},this.getParentId=function(e){var t=n.commentStore.getState(),r=rt.d(t),o=Object(it.b)(r,e);return o?Object(Zr.h)(o):void 0},this.invokeModalDialog=function(e,t,r){var o=n.commentStore.getState(),a={renderContextType:n.getActiveComponentTree(o).componentTreeId.renderContextType,trackback:L.d.reserveTag(592240791),telemetryVisitor:n.viewManager.getTelemetryVisitor()},i=n.commentStore.dispatch,c=n.getCompletePaneOwnProps(),s=Object(eo.b)(i,c),d=rt.t(o);switch(e){case to.a.CancelNewDraft:case to.a.CancelReplyDraft:case to.a.CancelPostEdit:return s.discardDraftAsync(a,Qe.a.SharedComments,!1);case to.a.DeleteThread:return d&&s.requestDeleteThread(a,d.selectedCardId),Promise.resolve(Br.a.Handled);case to.a.ClosePaneDraft:return no.p({ownProps:c,dispatchProps:s,componentTree:n.getActiveComponentTree(o),draftState:rt.h(o),invokeModalDialog:n.invokeModalDialog}),Promise.resolve(Br.a.Handled);default:Object(L.m)(e)}},this.updateEventProcessingState=function(e){var t=rt.q(n.previousStoreState),r=rt.q(e);!t&&r&&n.pauseProcessing(),t&&!r&&n.beginProcessing()},this.handleStoreUpdate=function(){var e=n.commentStore.getState(),t=rt.h(e),r=rt.h(n.previousStoreState);!Object(tt.d)(t)&&n.pendingActionReason===$r.NeedNotDrafting&&n.pendingAction&&(Object(U.k)().createActivityObject("TriggerPendingActionNeedNotDrafting",n.viewManager.getTelemetryVisitor(),Object(U.n)({diagnosticLevel:U.b.FullEvent})).successTag(592269458),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=$r.None);var o=Object(tt.b)(t),a=Object(tt.b)(r);o&&!a&&n.pendingActionReason===$r.NeedDrafting&&n.pendingAction&&(Object(U.k)().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),Object(U.n)({diagnosticLevel:U.b.FullEvent})).successTag(592269459),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=$r.None),n.updateEventProcessingState(e),n.previousStoreState=e},this.onDrafting=function(e){var t=Object(U.k)().createActivityObject("OnDraftingCallback",n.viewManager.getTelemetryVisitor(),Object(U.n)({diagnosticLevel:U.b.FullEvent}));Object(tt.b)(rt.h(n.commentStore.getState()))?(t.addDataField("ActionDeferred",!1,U.d.SystemMetadata),e(),t.successTag(592269460)):(t.addDataField("ActionDeferred",!0,U.d.SystemMetadata),n.pendingAction=e,n.pendingActionReason=$r.NeedDrafting,t.successTag(592269461))},this.onNotDrafting=function(e){var t=Object(U.k)().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),Object(U.n)({diagnosticLevel:U.b.FullEvent}));Object(tt.d)(rt.h(n.commentStore.getState()))?(t.addDataField("ActionDeferred",!0,U.d.SystemMetadata),n.pendingAction=e,n.pendingActionReason=$r.NeedNotDrafting,t.successTag(592269462)):(t.addDataField("ActionDeferred",!1,U.d.SystemMetadata),e(),t.successTag(592269463))},this.runAction=function(e,t){switch(e){case $r.NeedDrafting:return n.onDrafting(t);case $r.NeedNotDrafting:return n.onNotDrafting(t);case $r.None:return t()}},this.onMockUIAction=new Qr((function(e){var t=Object(U.k)().createActivityObject("OnMockUIAction",n.viewManager.getTelemetryVisitor(),Object(U.n)({diagnosticLevel:U.b.FullEvent}));t.addDataField("MockUIActionType",e.actionType,U.d.SystemMetadata);try{switch(e.actionType){case Xr.CreateThread:!function(e){return e.actionType===Xr.CreateThread&&void 0!==e.content}(e)?Object(U.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269464):n.runAction($r.NeedDrafting,(function(){return n.onCreateOrReply(new lo(n.getNewThreadDraftId(),e.content))}));break;case Xr.CancelCreateThread:!function(e){return e.actionType===Xr.CancelCreateThread}(e)?Object(U.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269465):n.runAction($r.NeedDrafting,(function(){return n.onCancelCreateThread(new lo(n.getNewThreadDraftId()))}));break;case Xr.StartReplySession:!function(e){return e.actionType===Xr.StartReplySession&&void 0!==e.threadId}(e)?Object(U.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269466):n.runAction($r.NeedNotDrafting,(function(){return n.onStartReplySession(new lo(e.threadId))}));break;case Xr.CancelReplySession:!function(e){return e.actionType===Xr.CancelReplySession&&void 0!==e.threadId}(e)?Object(U.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269467):n.runAction($r.NeedDrafting,(function(){return n.onCancelReplySession(new lo(e.threadId))}));break;case Xr.PostReply:!function(e){return e.actionType===Xr.PostReply&&void 0!==e.threadId&&void 0!==e.content}(e)?Object(U.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269468):n.runAction($r.NeedDrafting,(function(){return n.onCreateOrReply(new lo(e.threadId,e.content))}));break;case Xr.DeleteComment:!function(e){return e.actionType===Xr.DeleteComment&&void 0!==e.commentId}(e)?Object(U.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269469):n.runAction($r.NeedNotDrafting,(function(){return n.onDeleteComment(e.commentId)}));break;case Xr.DeleteThread:!function(e){return e.actionType===Xr.DeleteThread&&void 0!==e.threadId}(e)?Object(U.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269470):n.runAction($r.NeedNotDrafting,(function(){return n.onDeleteThread(e.threadId)}));break;case Xr.ResolveThread:!function(e){return e.actionType===Xr.ResolveThread&&void 0!==e.threadId}(e)?Object(U.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269471):n.runAction($r.NeedNotDrafting,(function(){return n.onResolveThread(e.threadId)}));break;case Xr.ReopenThread:!function(e){return e.actionType===Xr.ReopenThread&&void 0!==e.threadId}(e)?Object(U.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269472):n.runAction($r.NeedNotDrafting,(function(){return n.onReopenThread(e.threadId)}));break;case Xr.StartEditSession:!function(e){return e.actionType===Xr.StartEditSession&&void 0!==e.commentId}(e)?Object(U.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269473):n.runAction($r.NeedNotDrafting,(function(){return n.onStartEditSession(e.commentId)}));break;case Xr.CancelEditSession:!function(e){return e.actionType===Xr.CancelEditSession&&void 0!==e.commentId}(e)?Object(U.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269474):n.runAction($r.NeedDrafting,(function(){return n.onCancelEditSession(new fo(e.commentId))}));break;case Xr.PostEdit:if(function(e){return e.actionType===Xr.PostEdit&&void 0!==e.commentId&&void 0!==e.content}(e)){var r=new fo(e.commentId);r.setContents(e.content),n.runAction($r.NeedDrafting,(function(){return n.onPostEdit(r)}))}else Object(U.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269475);break;case Xr.SelectComment:!function(e){return e.actionType===Xr.SelectComment&&void 0!==e.commentId}(e)?Object(U.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269504):n.runAction($r.NeedNotDrafting,(function(){return n.onSelectComment(new mo(e.commentId))}));break;case Xr.ClosePane:n.onClosePane();break;case Xr.ClickGhostCard:!function(e){return e.actionType===Xr.ClickGhostCard}(e)?Object(U.k)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269505):n.runAction($r.NeedNotDrafting,(function(){return n.onGhostCommentClicked()}));break;default:Object(L.m)(e.actionType)}}catch(e){return void t.failTag(592269507,Object(sr.a)(e))}t.successTag(592269508)})),this.onStartEditSession=function(e){var t=n.commentStore.getState();no.E({trackback:L.d.reserveTag(592269509),id:e,data:n.getFilteredRenderableItems(t),selectedComment:rt.t(t),renderContextType:n.getActiveComponentTree(t).componentTreeId.renderContextType,actionDispatchers:n.getDispatchProps(e),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.onResolveThread=function(e,t){var r=n.commentStore.getState();no.m({componentTree:n.getActiveComponentTree(r),focusManager:n.viewManager.getFocusManager(),trackback:L.d.reserveTag(592269510),id:e,renderContextType:n.getActiveComponentTree(r).componentTreeId.renderContextType,dispatchProps:n.getDispatchProps(e),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,isTask:t})},this.onClosePane=function(){var e=n.commentStore.getState();if(at.b(e)){var t=n.commentStore.dispatch;Object(eo.b)(t,n.getCompletePaneOwnProps()).requestClosePane({telemetryVisitor:n.viewManager.getTelemetryVisitor(),renderContextType:ut.a.None,trackback:L.d.reserveTag(592269511)})}else Object(U.k)().assertConditionTag(!1,"Pane was already closed.",592269512)},this.onCreateOrReply=function(e){var t=e.getId(),r=n.commentStore.getState(),o=rt.h(r),a=Object($e.K)(o),i=a&&"CREATE"===a.commentDraft.sessionConfiguration.sessionType?{type:"CREATE"}:{type:"REPLY",parentId:t};no.c({trackback:L.d.reserveTag(592269513),commentCardRef:e,draftState:o,areMentionsEnabled:rt.p(r).atMention===Zr.b.Enabled,session:i,componentTree:n.getActiveComponentTree(r),dispatchProps:n.getDispatchProps(t),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,commitSource:uo.a.Programmatic}).catch(Object(ne.a)(L.d.reserveTag(592269514)))},this.onCancelCreateThread=function(e){var t=e.getId(),r=n.getDispatchProps(t),o=n.commentStore.getState(),a=rt.t(o),i=rt.h(o),c=at.b(o),s=n.getActiveComponentTree(o).componentTreeId.renderContextType,d=rt.u(o),u=(null==a?void 0:a.selectedCardId)===e.getId()&&Object(oo.b)(c,s,i,a,d),l=Rt.f(n.getRenderableItemThreads(o),t);no.e({trackback:L.d.reserveTag(592269516),showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(o),dispatchProps:r,closeOnDiscard:u,cardId:t,draftState:i,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),lieIndex:l})},this.onGhostCommentClicked=function(){var e=n.commentStore.getState();at.b(e)||Object(U.k)().assertConditionTag(!1,"There is no Ghost Card because the pane is closed.",592269517),n.viewManager.getPaneOwnProps().selectionManager.selectAcrossContexts(ie.d.Next,n.getActiveComponentTree(e).componentTreeId.renderContextType)},this.onPostEdit=function(e){var t=n.commentStore.getState(),r=n.getParentId(e.getId());r&&no.C({trackback:L.d.reserveTag(592269518),id:e.getId(),data:n.getFilteredRenderableItems(t),draftState:rt.h(t),contentPromise:e.getContentsAsync(),atMentionsEnabled:rt.p(t).atMention===Zr.b.Enabled,componentTree:n.getActiveComponentTree(t),actionDispatchers:n.getDispatchProps(r),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,commitSource:uo.a.Programmatic}).catch(Object(ne.a)(L.d.reserveTag(592269519)))},this.onCancelEditSession=function(e){var t=n.commentStore.getState(),r=rt.h(t),o=rt.t(t),a=at.b(t),i=rt.u(t),c=Object(oo.b)(a,n.getActiveComponentTree(t).componentTreeId.renderContextType,r,o,i),s=n.getFilteredRenderableItems(t),d=n.getParentId(e.getId());if(d){var u=n.getDispatchProps(d);no.z({trackback:L.d.reserveTag(592269521),commentId:e.getId(),setContents:e.setContents.bind(e),data:s,draftState:r,shouldClosePaneAfterDiscardDraft:c,onWillDiscardCallback:void 0,renderContextType:n.getActiveComponentTree(t).componentTreeId.renderContextType,dispatchProps:u,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})}},this.onCancelReplySession=function(e){var t=n.commentStore.getState(),r=rt.t(t),o=rt.h(t),a=e.getId(),i=n.getDispatchProps(a),c=at.b(t),s=n.getActiveComponentTree(t).componentTreeId.renderContextType,d=rt.u(n.commentStore.getState()),u=(null==r?void 0:r.selectedCardId)===e.getId()&&Object(oo.b)(c,s,o,r,d);no.e({trackback:L.d.reserveTag(592269522),showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(t),dispatchProps:i,closeOnDiscard:u,cardId:e.getId(),draftState:o,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),lieIndex:-1})},this.onDeleteThread=function(e){var t=n.commentStore.getState(),r=rt.t(t),o=n.getDispatchProps(e);no.d({trackback:L.d.reserveTag(592269523),id:e,data:n.getFilteredRenderableItems(t),selectedComment:r,componentTree:n.getActiveComponentTree(t),invokeModalDialog:n.invokeModalDialog,dispatchProps:o,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),isTask:!!Zn.b(t)[e],threadIndex:Rt.f(n.getRenderableItemThreads(t),e),shouldCheckForLowFidelity:!0})},this.onDeleteComment=function(e){var t=n.commentStore.getState(),r=rt.t(t),o=n.getParentId(e);if(o){var a=n.getDispatchProps(o);no.D({trackback:L.d.reserveTag(592269524),id:e,data:n.getFilteredRenderableItems(t),selectedComment:r,renderContextType:n.getActiveComponentTree(t).componentTreeId.renderContextType,actionDispatchers:a,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})}},this.onSelectComment=function(e){var t,r=n.commentStore.getState(),o=rt.g(r,!0),a=n.getNewThreadDraftId(),i=n.getFilteredRenderableItems(r),c=e.getId(),s=Q.W()||c!==a?i.find((function(e){return Rt.e(e)===c})):o&&{commentModel:o.newComment_deprecated};if(s&&Object(Nt.a)(s)){var d=s,u=n.getDispatchProps(null!==(t=d.commentModel.parentId)&&void 0!==t?t:d.commentModel.commentId),l=rt.t(r),f=rt.h(r),m=n.getActiveComponentTree(r),p=Object(lt.a)(Rt.i(s),rt.j(r),m.componentTreeId.renderContextType);no.J({trackback:L.d.reserveTag(592269526),renderableItem:s,selectedComment:l,cardCollapsedState:p,dispatchProps:u,telemetryVisitor:n.viewManager.getTelemetryVisitor(),shouldFocusAfter:!1,componentTree:m,draftState_deprecated:f}).catch(Object(ne.a)(L.d.reserveTag(590123734)))}else Object(U.k)().assertConditionTag(!1,"Selection coming from an unknown post?",592269525)},this.onStartReplySession=function(e){no.a({trackback:L.d.reserveTag(592269527),threadId:e.getId(),renderContextType:n.getActiveComponentTree(n.commentStore.getState()).componentTreeId.renderContextType,dispatchProps:n.getDispatchProps(e.getId()),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.commentStore=this.viewManager.getCommentStore(),this.previousStoreState=this.commentStore.getState(),this.unsubscribeStoreListener=this.commentStore.subscribe(this.handleStoreUpdate),this.getFilteredRenderableItems=rt.y(),this.getRenderableItemThreads=this.makeGetRenderableItemThreads(this.getFilteredRenderableItems)}return e.prototype.initialize=function(){var e=Object(U.k)().createActivityObject("InitializeMockCommentViewHelper",this.viewManager.getTelemetryVisitor(),Object(U.n)({diagnosticLevel:U.b.FullEvent}));this.registrationToken=this.mockUIDriver.onMockUIAction.subscribe(this.onMockUIAction.handler),e.successTag(co)},e.prototype.teardown=function(){var e,t=Object(U.k)().createActivityObject("TeardownMockCommentViewHelper",this.viewManager.getTelemetryVisitor(),Object(U.n)({diagnosticLevel:U.b.FullEvent}));null===(e=this.registrationToken)||void 0===e||e.unsubscribe(),this.unsubscribeStoreListener(),t.successTag(so)},e.prototype.beginProcessing=function(){var e=this,t=Object(U.k)().createActivityObject("StartMockUIActionProcessing",this.viewManager.getTelemetryVisitor(),Object(U.n)({diagnosticLevel:U.b.FullEvent}));this.startProcessingActionsPending=setTimeout((function(){e.onMockUIAction.startProcessing(),e.startProcessingActionsPending=void 0,t.successTag(ao)}),100)},e.prototype.pauseProcessing=function(){var e=Object(U.k)().createActivityObject("PauseMockUIActionProcessing",this.viewManager.getTelemetryVisitor(),Object(U.n)({diagnosticLevel:U.b.FullEvent}));this.startProcessingActionsPending&&(clearTimeout(this.startProcessingActionsPending),this.startProcessingActionsPending=void 0),this.onMockUIAction.pauseProcessing(),e.successTag(io)},e.prototype.onReopenThread=function(e,t){no.l({trackback:L.d.reserveTag(592269528),id:e,renderContextType:this.getActiveComponentTree(this.commentStore.getState()).componentTreeId.renderContextType,dispatchProps:this.getDispatchProps(e),telemetryVisitor:this.viewManager.getTelemetryVisitor(),localizationAPI:this.viewManager.localizationAPI,isTask:t})},e}(),ho=n(1177);var vo=n(1154);function go(e,t,n,r){return function(o){return Object(G.g)().registerExtension(t,n,r).then((function(t){return o(Object(vo.a)(e,t)),t}))}}var yo=n(1171);var bo,Co=function(){function e(){this.hostableComponentRegistry=new Map}return e.prototype.registerComponent=function(e,t,n){this.hostableComponentRegistry.has(e)||this.hostableComponentRegistry.set(e,new Map);var r=this.hostableComponentRegistry.get(e);n?r.set(t,n):r.delete(t)},e.prototype.getComponent=function(e,t){var n=this.hostableComponentRegistry.get(e);if(n)return n.get(t)},e}(),To=function(e){function t(t){var n=e.call(this,t)||this;return t.initializeImmediately&&n.beginInitialization(),n}return Object(X.c)(t,e),t}(function(){function e(e){var t=e.apiContext,n=e.viewProvider,r=e.commentAPI,o=e.peopleAPI,a=e.localizationAPI,i=e.themeAPI,c=e.focusManager,s=e.lppManager,d=e.initializationReason,u=e.commentStore,l=e.viewStrategyFactory,f=e.mockUIDriver,m=e.contentFilteredRangeAPI,p=e.contentNavigationAPI,h=this;this.initialized=!1,this.initialLoadComplete=!1,this.commentUIActionListeners=[],this.commentInterruptableCommandListeners=[],this.unprocessedActionPayloads=[],this.onInitialRender=function(e){h.commentStore.dispatch(Xe.onInitialRender({renderContextType:ut.a.None,trackback:L.d.reserveTag(595646478),telemetryVisitor:h.telemetryVisitor},{commentId:e.commentId,renderContextType:e.renderContextType})),Object(mt.b)(e.renderContextType)&&h.sendDataReceivedCodeMarker()},this.sendDataReceivedCodeMarker=Object(br.a)((function(){se.sendCodeMarker({context:h.apiContext,type:oe.DataReceived,assertTag:L.d.reserveTag(595731293)})})),this.getComponentTree=function(e){switch(e){case ut.a.None:Object(L.n)(!1,"Unexpected render context type:".concat(e),L.d.reserveTag(589088338));case ut.a.FullPane:case ut.a.HalfPane:return h.getComponentTreeForRenderMode(G.e.TaskPaneItem);case ut.a.DiscreteIntegrated:return h.getComponentTreeForRenderMode(G.e.Integrated);case ut.a.DiscreteIsolated:return h.getComponentTreeForRenderMode(G.e.Isolated)}},this.getCommentContainerOwnProps=function(){return{commentAPI:h.commentAPI,localizationAPI:h.localizationAPI,peopleAPI:h.peopleAPI,focusManager:h.focusManager,telemetryVisitor:h.telemetryVisitor,onInitialRender:h.onInitialRender,correlationId:h.correlationId,lppManager:h.lppManager}},this.setComponentRef=function(e,t,n){h.viewManagerRefRegistry.registerComponent(e,t,n)},this.onSuggestionsDetailsChange=function(e){h.commentStore.dispatch(Xe.updateSuggestionsDetails({renderContextType:ut.a.None,trackback:L.d.reserveTag(592492758),telemetryVisitor:h.telemetryVisitor},e))},this.internalInterruptableCommandHandler=function(e){return h.activeViewStrategy.handleCommentInterruptableCommand(e,h.commentStore.dispatch,h.commentStore.getState)},this.createOrUpdateFilter=function(e){var t=h.contentFilteredRangeAPI;if(t&&Object(ot.g)(h.commentStore.getState())){var n=ot.h(h.commentStore.getState());if(Object(U.k)().assertConditionTag(n||!!Object(ot.e)(h.commentStore.getState()),"We should have a default filter already or a default filter request should be in flight.",528779339),!n){var r=Object(Je.a)(h.commentStore.getState());r?h.updateFilter(r,e):h.createFilter(t,e)}}else Object(U.k)().assertConditionTag(!1,"Should not request new filter with gate off",528779338)},this.updateFilter=function(e,t){h.commentStore.dispatch(Xe.updateFilterRange({renderContextType:ut.a.FullPane,telemetryVisitor:h.telemetryVisitor,trackback:L.d.reserveTag(528779344)},{filterId:e,changes:[{type:"FilterUpdate",updatedFilter:t}]}))},this.createFilter=function(e,t){e.createFilteredRange({contentTypes:[G.b.CommentThread],filters:t,supportsFilterUpdates:!0}).then((function(e){h.commentStore.dispatch(Xe.loadFilter({renderContextType:ut.a.FullPane,telemetryVisitor:h.telemetryVisitor,trackback:L.d.reserveTag(528779340)},{filteredRange:e,shouldSetActive:!0}))})).catch(Object(ne.a)(L.d.reserveTag(528779341)))},this.apiContext=t,this.viewProvider=n,this.commentAPI=r,this.peopleAPI=o,this.localizationAPI=a,this.themeAPI=i,this.focusManager=c,this.contentFilteredRangeAPI=m,this.contentNavigationAPI=p,this.lastInitializationReason=d,this.viewStrategyFactory=l,this.mockUIDriver=f,this.telemetryVisitor=ye.getTelemetryVisitor(this.apiContext),this.correlationId=ye.getCorrelationId(this.apiContext)||Object(B.a)(),this.lppManager=s,this.registerComponentUIActionListener=this.registerComponentUIActionListener.bind(this),this.registerInterruptableCommandListener=this.registerInterruptableCommandListener.bind(this),this.onCommentEventReceived=this.onCommentEventReceived.bind(this),this.onCommentUIAction=this.onCommentUIAction.bind(this),this.onCommentInterruptableCommandReceived=this.onCommentInterruptableCommandReceived.bind(this),this.unregisterComponentUIActionListener=this.unregisterComponentUIActionListener.bind(this),this.unregisterComponentInterruptableCommandListener=this.unregisterComponentInterruptableCommandListener.bind(this),this.onViewContainerEvent=this.onViewContainerEvent.bind(this),this.observeStore=this.observeStore.bind(this),this.onChange=this.onChange.bind(this),this.onFirstLoadComplete=this.onFirstLoadComplete.bind(this),this.getComponentTreeForRenderMode=this.getComponentTreeForRenderMode.bind(this),this.selectionManager=new _r(u,this.telemetryVisitor,!!this.contentNavigationAPI);var v=u.getState();this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(v.paneState.viewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor),this.commentStore=u,this.discreteIntegratedComponentTree=new Dn(ut.a.DiscreteIntegrated,this.apiContext),this.discreteIsolatedComponentTree=new Dn(ut.a.DiscreteIsolated,this.apiContext),this.viewManagerRefRegistry=new Co,this.registerActions(),this.observeStore(this.commentStore),this.mockUIDriver&&(this.mockCommentViewHelper=new po(this,this.mockUIDriver)),this.registerInterruptableCommandListener(this.internalInterruptableCommandHandler)}return e.prototype.getMockDriver=function(){return this.mockUIDriver},e.prototype.refreshAtMentionCapability=function(){(0,this.commentStore.dispatch)(function(e,t){return function(n){var r=Object(U.k)().createActivityObject("ResolveAtMentionCapabilityState",e.telemetryVisitor,Object(U.j)());return t.checkAtMentionCapability().then((function(t){r.addDataField("AtMentionsEnabled",t,U.d.SystemMetadata),r.successTag(595903522),n(Object(yo.a)(e,t?Xt.b.Enabled:Xt.b.Disabled))}),(function(t){r.failTag(595903523,Object(sr.a)(t,-2130957528)),n(Object(yo.a)(e,Xt.b.Disabled))}))}}({renderContextType:ut.a.None,trackback:L.d.reserveTag(595616912),telemetryVisitor:this.telemetryVisitor},this.commentAPI)).catch(Object(ne.a)(L.d.reserveTag(595152915)))},e.prototype.getCommentStore=function(){return this.commentStore},e.prototype.getFocusManager=function(){return this.focusManager},e.prototype.getInitializationReason=function(){return this.lastInitializationReason},e.prototype.getSelectionManager=function(){return this.selectionManager},e.prototype.beginInitialization=function(){var e,t=this;this.initialized||(this.contentNavigationAPI&&(this.commentStore.dispatch(Xe.setContentNavigationEnablement({renderContextType:ut.a.None,trackback:L.d.reserveTag(526405722),telemetryVisitor:this.telemetryVisitor},!0)),null===(e=this.contentFilteredRangeAPI)||void 0===e||e.getCapabilities().then((function(e){t.commentStore.dispatch(Xe.setFilteringCapabilities({renderContextType:ut.a.None,trackback:L.d.reserveTag(537421135),telemetryVisitor:t.telemetryVisitor},{capabilities:e}))})).catch(Object(ne.a)(L.d.reserveTag(528779335)))),this.commentAPI.registerForCommentEvents(this.onCommentEventReceived),void 0!==this.commentAPI.registerForInterruptableCommands&&this.commentAPI.registerForInterruptableCommands(this.onCommentInterruptableCommandReceived),Q.r()&&this.initializeContentExtensions(),this.viewProvider.registerForViewContainerEvents(this.onViewContainerEvent),this.refreshAtMentionCapability(),this.peopleAPI.capabilities&Fr.b.GetSuggestionsDetails&&(this.commentStore.dispatch(function(e,t){return function(n){if(!(t.capabilities&Fr.b.GetSuggestionsDetails))return Promise.resolve();var r=Object(U.k)().createActivityObject("RefreshSuggestionsDetails",e.telemetryVisitor,Object(U.n)({aggregationMode:U.a.OnSuccess}));return t.getSuggestionsDetails?t.getSuggestionsDetails().then((function(t){r.successTag(592492760),n(Object(ho.a)(e,t))}),(function(e){r.failTag(592492761,-2130957495)})):(r.failTag(592492759,-2130957494),Promise.resolve())}}({renderContextType:ut.a.None,trackback:L.d.reserveTag(592492753),telemetryVisitor:this.telemetryVisitor},this.peopleAPI)).catch(Object(ne.a)(L.d.reserveTag(592492754))),Object(U.k)().assertConditionTag(!!this.peopleAPI.registerForSuggestionsDetailsChanges,"registerForSuggestionsDetailsChanges expected to be defined if capability is set",592492756),this.peopleAPI.registerForSuggestionsDetailsChanges&&this.peopleAPI.registerForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),this.mockCommentViewHelper&&this.mockCommentViewHelper.initialize(),this.initialized=!0)},e.prototype.getTelemetryVisitor=function(){return this.telemetryVisitor},e.prototype.getAtMentionAuthToken=function(){return Promise.resolve(void 0)},e.prototype.onChange=function(e){!this.initialLoadComplete&&e&&void 0===rt.q(e)&&rt.l(e)&&this.onFirstLoadComplete()},e.prototype.observeStore=function(e){var t,n=this;return e.subscribe((function(){var r=e.getState(),o=rt.q(r);o!==t&&(t=o,n.onChange(r))}))},e.prototype.onFirstLoadComplete=function(){var e=this;Object(U.k)().assertConditionTag(!this.initialLoadComplete,"Process initial pending actions should only run once.",576570016),this.initialLoadComplete=!0,this.unprocessedActionPayloads.forEach((function(t){e.onCommentUIAction(t)})),this.unprocessedActionPayloads=[],this.mockCommentViewHelper&&this.mockCommentViewHelper.beginProcessing()},e.prototype.registerActions=function(){this.commentAPI.registerForAction(Lr.a.AddComment,this.onCommentUIAction),this.commentAPI.registerForAction(Lr.a.NextThread,this.onCommentUIAction),this.commentAPI.registerForAction(Lr.a.PreviousThread,this.onCommentUIAction),this.commentAPI.registerForAction(Lr.a.DeleteThread,this.onCommentUIAction),this.commentAPI.registerForAction(Lr.a.BackKeyPressed,this.onCommentUIAction),this.commentAPI.registerForAction(Lr.a.ShowHideCommentPane,this.onCommentUIAction)},e.prototype.getComponentTreeForRenderMode=function(e){switch(e){case G.e.Integrated:return this.discreteIntegratedComponentTree;case G.e.Isolated:return this.discreteIsolatedComponentTree;case G.e.TaskPane:case G.e.TaskPaneItem:return at.c(this.getCommentStore().getState())}},e.prototype.getPaneOwnProps=function(){return Object(X.a)(Object(X.a)({},this.getCommentContainerOwnProps()),{selectionManager:this.selectionManager,initializationReason:this.lastInitializationReason,registerComponentUIActionListener:this.registerComponentUIActionListener,registerComponentInterruptableCommandListener:this.registerInterruptableCommandListener,unregisterComponentInterruptableCommandListener:this.unregisterComponentInterruptableCommandListener,unregisterComponentUIActionListener:this.unregisterComponentUIActionListener,correlationId:this.correlationId,createOrUpdateFilter:this.createOrUpdateFilter})},e.prototype.getHostableCommentCardRendererProps=function(e){var t=this;return Object(X.a)(Object(X.a)({},this.getCommentContainerOwnProps()),{componentTree:this.getComponentTreeForRenderMode(e),setComponentRef:function(n,r){t.setComponentRef(e,n,r)},correlationId:this.correlationId,themeAPI:this.themeAPI})},e.prototype.registerCommentCardHostableComponent=function(e,t,n){var r=this,o=Kr(Wr(n.HostableCommentCardRendererContainer,Object(X.a)({},this.getHostableCommentCardRendererProps(e))),this.commentStore),a=re(t,this.apiContext),i=Object(H.d)().registerComponent(a,o);return i.onComponentCommand.subscribe((function(t){r.processHostableComponentCommand(t,e)})),{componentController:i,contextAwareName:a}},e.prototype.initializeContentExtensions=function(){var e=this;Object(xe.d)("ExtensionAwareCommentPaneContainer").then((function(t){var n;if(void 0!==t){var r=Kr(Wr(t.ExtensionAwareCommentPane,Object(X.a)(Object(X.a)({},e.getPaneOwnProps()),{extensionRenderMode:G.e.Integrated,themeAPI:e.themeAPI})),e.commentStore),o=re("SharedCommentPane",e.apiContext);e.commentPaneComponentController=Object(H.d)().registerComponent(o,r),Q.L()&&e.commentStore.dispatch(go({renderContextType:ut.a.None,trackback:L.d.reserveTag(573384478),telemetryVisitor:e.telemetryVisitor},G.b.CommentThread,o,{renderMode:G.e.TaskPane,priority:G.d.Disabled,instanceId:e.apiContext,componentDimensions:void 0})).catch(Object(ne.a)(L.d.reserveTag(573384479)))}Object(xe.d)("HostableCommentCardRendererContainer").then((function(t){if(void 0!==(n=t)){var r=e.registerCommentCardHostableComponent(G.e.Integrated,"DiscreteIntegratedCommentCard",n),o=r.componentController,a=r.contextAwareName;e.discreteIntegratedComponentController=o;var i=e.registerCommentCardHostableComponent(G.e.Isolated,"DiscreteIsolatedCommentCard",n),c=i.componentController,s=i.contextAwareName;e.discreteIsolatedComponentController=c;var d=e.registerCommentCardHostableComponent(G.e.TaskPaneItem,"TaskPaneItemCommentCard",n),u=d.componentController,l=d.contextAwareName;e.commentPaneItemComponentController=u,e.commentStore.dispatch(go({renderContextType:ut.a.None,trackback:L.d.reserveTag(574428426),telemetryVisitor:e.telemetryVisitor},G.b.CommentThread,a,{renderMode:G.e.Integrated,priority:G.d.Disabled,instanceId:e.apiContext,componentDimensions:e.getAverageCardSize()})).catch(Object(ne.a)(L.d.reserveTag(595645980))),e.commentStore.dispatch(go({renderContextType:ut.a.None,trackback:L.d.reserveTag(595616916),telemetryVisitor:e.telemetryVisitor},G.b.CommentThread,s,{renderMode:G.e.Isolated,priority:G.d.Disabled,instanceId:e.apiContext,componentDimensions:e.getAverageCardSize(),isContentAvailable:function(t){var n=e.commentStore.getState(),r=Object(Gr.d)(t,rt.a(n),rt.c(n)),o=rt.h(n);return Object(Gr.a)(t,Object(Gr.c)(t,rt.d(n),rt.b(n),r,rt.g(n,!0),o.drafts[t],Object($e.G)(o)),o,ut.a.DiscreteIsolated,Object(Hr.a)(t,ut.a.DiscreteIsolated,o))}})).catch(Object(ne.a)(L.d.reserveTag(595645982))),e.commentStore.dispatch(go({renderContextType:ut.a.None,trackback:L.d.reserveTag(546174344),telemetryVisitor:e.telemetryVisitor},G.b.CommentThread,l,{renderMode:G.e.TaskPaneItem,priority:G.d.Disabled,instanceId:e.apiContext,componentDimensions:e.getAverageCardSize()})).catch(Object(ne.a)(L.d.reserveTag(546174345)))}})).catch(Object(ne.a)(L.d.reserveTag(595645984)))})).catch(Object(ne.a)(L.d.reserveTag(595645986)))},e.prototype.getAverageCardSize=function(){return{width:259,height:zr({itemCount:3,readOnly:!1,isTask:!1})}},e.prototype.processHostableComponentCommand=function(e,t){var n=this;switch(e.command){case"Focus":return void setTimeout((function(){var r;return null===(r=n.viewManagerRefRegistry.getComponent(t,e.details.componentInstanceId))||void 0===r?void 0:r.focus()}));case"UpdateComponentDataProps":break;default:return void Object(U.k)().assertConditionTag(!1,"Unexpected command type",593786644)}},e.prototype.teardownContentExtensions=function(){var e,t,n,r,o=[G.e.Integrated,G.e.Isolated,G.e.TaskPaneItem];Q.L()&&o.push(G.e.TaskPane),this.commentStore.dispatch(Xe.removeContentExtensions.apply(Xe,Object(X.h)([{renderContextType:ut.a.None,trackback:L.d.reserveTag(595616917),telemetryVisitor:this.telemetryVisitor}],Object(X.f)(o),!1))),null===(e=this.commentPaneComponentController)||void 0===e||e.unregister(),null===(t=this.commentPaneItemComponentController)||void 0===t||t.unregister(),null===(n=this.discreteIntegratedComponentController)||void 0===n||n.unregister(),null===(r=this.discreteIsolatedComponentController)||void 0===r||r.unregister()},e.prototype.teardown=function(){this.initialized&&(this.viewProvider.unregisterForViewContainerEvents(this.onViewContainerEvent),this.commentAPI.unregisterForCommentEvents(this.onCommentEventReceived),this.commentAPI.unregisterForAction(Lr.a.AddComment),this.commentAPI.unregisterForAction(Lr.a.NextThread),this.commentAPI.unregisterForAction(Lr.a.PreviousThread),this.commentAPI.unregisterForAction(Lr.a.DeleteThread),this.commentAPI.unregisterForAction(Lr.a.BackKeyPressed),this.commentAPI.unregisterForAction(Lr.a.ShowHideCommentPane),void 0!==this.commentAPI.unregisterForInterruptableCommands&&this.commentAPI.unregisterForInterruptableCommands(this.onCommentInterruptableCommandReceived),this.peopleAPI.capabilities&Fr.b.GetSuggestionsDetails&&(Object(U.k)().assertConditionTag(!!this.peopleAPI.unregisterForSuggestionsDetailsChanges,"unregisterForSuggestionsDetailsChanges should be defined if capability is set",592492757),this.peopleAPI.unregisterForSuggestionsDetailsChanges&&this.peopleAPI.unregisterForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),Q.r()&&this.teardownContentExtensions(),this.initialized=!1)},e.prototype.registerComponentUIActionListener=function(e){this.commentUIActionListeners.push(e)},e.prototype.unregisterComponentUIActionListener=function(e){var t=this.commentUIActionListeners.indexOf(e);t>-1&&this.commentUIActionListeners.splice(t,1)},e.prototype.registerInterruptableCommandListener=function(e){this.commentInterruptableCommandListeners.push(e)},e.prototype.unregisterComponentInterruptableCommandListener=function(e){var t=this.commentInterruptableCommandListeners.indexOf(e);t>-1&&this.commentInterruptableCommandListeners.splice(t,1)},e.prototype.onCommentUIAction=function(e){var t,n;if(Q.r()&&e.actionBehavior===Nr.a.Execute&&(this.initialized||this.beginInitialization(),!this.initialLoadComplete))return this.unprocessedActionPayloads.push(e),!0;try{for(var r=Object(X.i)(this.commentUIActionListeners),o=r.next();!o.done;o=r.next()){var a=(0,o.value)(e);if(a!==Vr.a.NotHandled)return a===Vr.a.Success}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return this.activeViewStrategy.processCommentUIAction(e,this.commentStore.dispatch,this.commentStore.getState)===Vr.a.Success},e.prototype.onCommentEventReceived=function(e,t){var n=Object(L.k)(L.b.Comments,Mr.a[e]);this.activeViewStrategy.processCommentEvent(e,t,this.commentStore.dispatch,this.commentStore.getState),null==n||n.end(),Q.r()&&!this.initialLoadComplete&&e===Mr.a.CommentContextChanged&&tn.b(t)&&0===t.numberOfComments&&this.onFirstLoadComplete()},e.prototype.onCommentInterruptableCommandReceived=function(e){var t=Promise.resolve(Br.a.Unhandled);return this.commentInterruptableCommandListeners.reduce((function(t,n){return t.then((function(t){return t!==Br.a.Unhandled?Promise.resolve(t):n(e)}))}),t)},e.prototype.onViewContainerEvent=function(e){var t=this,n=this.commentStore.dispatch;switch(e.eventType){case Ce.a.VisibilityChanged:return void n(Xe.viewContainerVisibilityChanged({renderContextType:ut.a.None,trackback:L.d.reserveTag(592241221),telemetryVisitor:this.telemetryVisitor},e.viewContainerVisibilityState));case Ce.a.ViewContainerChanged:return n(Xe.viewContainerChanged({renderContextType:ut.a.None,trackback:L.d.reserveTag(595616919),telemetryVisitor:this.telemetryVisitor},e.newViewContainer)),void(this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(e.newViewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor));case Ce.a.FocusTriggered:return void(Q.L()?setTimeout((function(){t.focusManager.focusCommentPaneCommand(at.c(t.commentStore.getState()))})):this.focusManager.focusCommentPaneCommand(at.c(this.commentStore.getState())));case Ce.a.FoldableLayoutStateChanged:n(Xe.viewContainerFoldableLayoutStateChanged({renderContextType:ut.a.None,trackback:L.d.reserveTag(591660549),telemetryVisitor:this.telemetryVisitor},e.newFoldableLayoutState))}},e}()),Io=function(){function e(e,t,n){}return e.prototype.getAccountID=function(){return""},e.prototype.getLPPController=function(){},e.prototype.ensureLPPController=function(){throw new Error("ensureLPPController not supported in Web")},e.prototype.initializeController=function(e){},e.prototype.isInitialized=function(){return!1},e.prototype.isOnline=function(){return!1},e.prototype.refreshLPPController=function(){},e}(),So=n(1269),Oo=function(){function e(){this.maxAcceptableInterval=3e3,this.lastHeartbeatReceived=0,this.timerStarted=!1}return e.prototype.heartbeatReceived=function(){var e,t,n=this;this.lastHeartbeatReceived=Date.now(),null===(t=(e=Object(U.k)()).logDiagnosticTrace)||void 0===t||t.call(e,Object(ze.a)(bo||(bo=Object(X.e)(["Native HeartbeatReceived"],["Native HeartbeatReceived"]))),L.d.reserveTag(540361865),U.h.Info,U.c.ProductServiceUsage,Object(U.l)(U.g.ReviewedAsNotNecessary),Object(U.o)("HeartbeatTimestamp",this.lastHeartbeatReceived,U.d.SystemMetadata)),this.timerStarted||(this.timerStarted=!0,setInterval((function(){n.checkHeartbeatInterval()}),this.maxAcceptableInterval))},e.prototype.checkHeartbeatInterval=function(){var e=Date.now()-this.lastHeartbeatReceived;e>this.maxAcceptableInterval&&Object(U.k)().assertConditionTag(!1,"Max heartbeat interval exceeded: ".concat(e),561071552)},e}(),wo=n(1066),jo=n(1129),Eo=n(1187),ko=n(1188);var Po=n(1172);var xo=n(1191),Ao=n(1124);function Do(e){return function(e){var t=Q.r()&&!at.b(e);return rt.f(e).nextPopulatedContextDetails!==Pt.a.NoComments||Object($e.d)(t?rt.a(e):rt.k(e),rt.d(e),t)}(e)&&Ro(rt.h(e))}function Ro(e){return Q.F()||!Object(tt.d)(e)}var Fo=function(){function e(e,t,n,r,o){this.localizationAPI=e,this.peopleAPI=t,this.commentAPI=n,this.selectionManager=r,this.telemetryVisitor=o}return e.prototype.processCommentEvent=function(e,t,n,r){var o,a=this,i=r();switch(e){case Mr.a.CommentContextChanged:if(!tn.b(t))return void Object(U.k)().assertConditionTag(!1,"Invalid eventPayload",595912090);t.rehydrationDrafts&&t.rehydrationDrafts.forEach((function(e){n(function(e,t,n,r,o){return function(a,i){var c=Object(ir.a)().getItem(t);if(!c)return Object(U.k)().assertConditionTag(!1,"no saved sessionStorage data for provided draft id",523510273),Promise.resolve(a(Yt.a));var s=JSON.parse(c);if(!function(e){return void 0!==e.draftContent&&void 0!==e.draftContent.content&&void 0!==e.draftingParams&&void 0!==e.draftingParams.sessionType&&void 0!==e.draftingParams.draftId}(s))return Object(U.k)().assertConditionTag(!1,"sessionStorage information is the wrong format",523510274),Promise.resolve(a(Yt.a));Object(ir.a)().removeItem(t);var d={inCurrentContext:!!(null==n?void 0:n.some((function(e){return e.draftId===s.draftingParams.draftId}))),isDraftEmpty:""===s.draftContent.content};return a(Object(jo.a)(e,r,s.draftingParams,!1,o,d)).then((function(){var t=rt.v(i());if(!t)return Object(U.k)().assertConditionTag(!1,"no active draft to save to session",520136543),a(Yt.a);var n={draftId:t.commentDraft.sessionConfiguration.draftId,draftContent:{editorContent:Promise.resolve(s.draftContent.content),editorCursorPosition:Promise.resolve(s.draftContent.cursorPosition)}};return a(Object(Po.a)(e,n))}))}}({renderContextType:ut.a.None,trackback:L.d.reserveTag(595912089),telemetryVisitor:a.telemetryVisitor},e.draftId,t.contextDrafts,a.commentAPI,a.peopleAPI)).catch(Object(ne.a)(L.d.reserveTag(523362973)))})),n(Xe.commentContextChanged({renderContextType:ut.a.None,trackback:L.d.reserveTag(512361622),telemetryVisitor:this.telemetryVisitor},t));break;case Mr.a.CommentsChanged:if(!tn.h(t))return void Object(U.k)().assertConditionTag(!1,"Invalid eventPayload",595912091);break;case Mr.a.LoadComments:if(!tn.i(t))return void Object(U.k)().assertConditionTag(!1,"Invalid eventPayload",595912092);break;case Mr.a.CommentSelected:if(!tn.g(t))return void Object(U.k)().assertConditionTag(!1,"Invalid eventPayload",595912096);if(t.commentId){var c=void 0;if(void 0!==rt.c(i)[t.commentId])c=Object(xo.a)(t.commentId,Qe.a.Canvas,{selectType:t.selectionReason&&"ContentNavigation"===t.selectionReason.type&&t.selectionReason.contentNavigationReason===ie.c.Keyboarding?Xe.SelectActionType.SelectCard:Xe.SelectActionType.ExpandCard});else{var s=Object(it.b)(rt.d(i),t.commentId);if(void 0===s)return;c=Object(xo.a)(s.parentId,Qe.a.Canvas,{selectType:Xe.SelectActionType.SelectPost,selectedPost:t.commentId})}n(Object(xo.b)(void 0,{renderContextType:ut.a.None,trackback:L.d.reserveTag(579744149),telemetryVisitor:this.telemetryVisitor},c,!1)).catch(Object(ne.a)(L.d.reserveTag(579744150)))}else n(Xe.clearCommentSelection({renderContextType:ut.a.None,trackback:L.d.reserveTag(595912095),telemetryVisitor:this.telemetryVisitor}));break;case Mr.a.CommentContextReload:if(!tn.d(t))return void Object(U.k)().assertConditionTag(!1,"Invalid eventPayload",595912097);break;case Mr.a.CommentHighlighted:if(!tn.f(t))return void Object(U.k)().assertConditionTag(!1,"Invalid eventPayload",595912128);t.commentId?n(Xe.highlightComment({renderContextType:ut.a.None,trackback:L.d.reserveTag(595912098),telemetryVisitor:this.telemetryVisitor},t.commentId,Qe.a.Canvas)):n(Xe.clearCommentHighlight({renderContextType:ut.a.None,trackback:L.d.reserveTag(578586723),telemetryVisitor:this.telemetryVisitor},Qe.a.Canvas,void 0));break;case Mr.a.NextPopulatedContextDetailsUpdated:if(!tn.k(t)||!t.contextDetails.nextPopulatedContextDetails)return void Object(U.k)().assertConditionTag(!1,"Invalid eventPayload",595912130);n(Xe.nextPopulatedContextDetailsUpdated({renderContextType:ut.a.None,trackback:L.d.reserveTag(595912129),telemetryVisitor:this.telemetryVisitor},t.contextDetails.nextPopulatedContextDetails));break;case Mr.a.ModelCapabilitiesChanged:tn.j(t)?n(Xe.updateModelCapabilities({renderContextType:ut.a.None,trackback:L.d.reserveTag(595685376),telemetryVisitor:this.telemetryVisitor},t.modelCapabilityFlags,t.richTextCapabilityFlags)):Object(U.k)().assertConditionTag(!1,"Invalid eventPayload",595616784);break;case Mr.a.CommentError:if(!tn.e(t))return void Object(U.k)().assertConditionTag(!1,"Invalid eventPayload",595912131);break;case Mr.a.ReturnToDraftRequested:tn.l(t)&&n(Xe.displayDraftWarning({draftWarningType:hr.a.ReturnToDraft,draftWarningReason:Ao.a.HostRequest},{renderContextType:ut.a.None,trackback:L.d.reserveTag(593376912),telemetryVisitor:this.telemetryVisitor}));break;case Mr.a.UpdateDraftThread:tn.n(t)?n(Xe.updateDraftThread({renderContextType:ut.a.None,trackback:L.d.reserveTag(594023371),telemetryVisitor:this.telemetryVisitor},t)):Object(U.k)().assertConditionTag(!1,"Invalid eventPayload",594023372);break;case Mr.a.SmartReplyPopulated:if(!tn.m(t))return void Object(U.k)().assertConditionTag(!1,"Invalid eventPayload for smart replies",590202467);n(Xe.populateSmartReply({renderContextType:ut.a.None,trackback:L.d.reserveTag(590202466),telemetryVisitor:this.telemetryVisitor},t));break;case Mr.a.NativeHeartbeat:this.heartbeatHelper||(this.heartbeatHelper=new Oo),null===(o=this.heartbeatHelper)||void 0===o||o.heartbeatReceived();break;default:return void Object(U.k)().assertConditionTag(!1,"Deprecated event detected.",595912132)}},e.prototype.processCommentUIAction=function(e,t,n,r){var o=this,a=n();switch(e.actionType){case Lr.a.ShowHideCommentPane:return Vr.c(e.actionBehavior)?at.b(a)?Vr.a.Success:Vr.a.Fail:(Vr.d(e.actionBehavior)&&(at.b(a)?t(Xe.requestClosePane({renderContextType:ut.a.None,trackback:L.d.reserveTag(595912133),telemetryVisitor:this.telemetryVisitor})):t(Xe.requestShowPane({renderContextType:ut.a.None,trackback:L.d.reserveTag(595912134),telemetryVisitor:this.telemetryVisitor}))),Vr.a.Success);case Lr.a.AddComment:if(Vr.b(e.actionBehavior)){if(!function(e){return!!Q.F()||!Object(tt.d)(e)&&!e.committedLieId}(rt.h(a)))return Vr.a.Fail}else if(Vr.d(e.actionBehavior)){var i={renderContextType:ut.a.None,trackback:L.d.reserveTag(595146382),telemetryVisitor:this.telemetryVisitor};return t(Object(jo.a)(i,this.commentAPI,{sessionType:"CREATE"},!(!r||!r.retainSelectionOnAddComment),this.peopleAPI)).catch(Object(ne.a)(L.d.reserveTag(592314376))),Vr.a.Success}return Vr.a.Success;case Lr.a.NextThread:if(Object(U.k)().assertConditionTag(!Vr.c(e.actionBehavior),"This action type does not support toggled status",595899713),Vr.d(e.actionBehavior))this.handleActionOrReturnToDraft((function(){return o.selectionManager.selectNextOrPreviousThread({direction:ie.d.Next,source:Qe.a.SharedComments,expandCard:!0,iterableContentTypes:[G.b.CommentThread]},ie.c.HostAction,ut.a.None)}),t,Q.X()?void 0:Ao.a.NextThread,L.d.reserveTag(591729749));else if(Vr.b(e.actionBehavior))return Do(a)?Vr.a.Success:Vr.a.Fail;return Vr.a.Success;case Lr.a.PreviousThread:if(Object(U.k)().assertConditionTag(!Vr.c(e.actionBehavior),"This action type does not support toggled status",595899714),Vr.d(e.actionBehavior))this.handleActionOrReturnToDraft((function(){return o.selectionManager.selectNextOrPreviousThread({direction:ie.d.Previous,source:Qe.a.SharedComments,expandCard:!0,iterableContentTypes:[G.b.CommentThread]},ie.c.HostAction,ut.a.None)}),t,Q.X()?void 0:Ao.a.PreviousThread,L.d.reserveTag(591729750));else if(Vr.b(e.actionBehavior))return Do(a)?Vr.a.Success:Vr.a.Fail;return Vr.a.Success;case Lr.a.DeleteThread:if(Object(U.k)().assertConditionTag(!Vr.c(e.actionBehavior),"This action type does not support toggled status",595899715),Vr.b(e.actionBehavior)){if(!function(e){return!!e.selectedComment&&Ro(e.draftState)}(a.commentState))return Vr.a.Fail}else Vr.d(e.actionBehavior)&&this.handleActionOrReturnToDraft((function(){var e=rt.t(a);e&&t(Xe.requestDeleteThread({renderContextType:ut.a.None,trackback:L.d.reserveTag(591738706),telemetryVisitor:o.telemetryVisitor},e.selectedCardId))}),t,Ao.a.DeleteThread,L.d.reserveTag(591729751));return Vr.a.Success}return Vr.a.NotHandled},e.prototype.beginDraftingHelper=function(e,t,n,r){return e(Object(jo.a)({renderContextType:ut.a.None,trackback:n,telemetryVisitor:this.telemetryVisitor},this.commentAPI,t,!1,this.peopleAPI)).catch(Object(ne.a)(r)).then((function(){return Zr.e.Handled}))},e.prototype.handleCommentInterruptableCommand=function(e,t,n){switch(e.type){case"CreateComment":return this.beginDraftingHelper(t,{sessionType:"CREATE"},L.d.reserveTag(574371082),L.d.reserveTag(574371083));case"EditComment":var r,o=n(),a=rt.t(o);r=Object(Rt.l)(Object(Gr.b)(e.commentId,rt.d(o),rt.b(o)),void 0);var i=Object(Rt.b)(r,e.commentId);return i?Object(no.K)({comment:i,threads:r,selectedComment:a,warningType:nt.a.Edit})?(t(Xe.showLowFidelityWarning({renderContextType:ut.a.None,telemetryVisitor:this.telemetryVisitor,trackback:L.d.reserveTag(593000206)},e.commentId,nt.a.Edit)),Promise.resolve(Zr.e.Handled)):this.beginDraftingHelper(t,{sessionType:"EDIT",commentId:e.commentId},L.d.reserveTag(593000207),L.d.reserveTag(593000208)):(Object(U.k)().assertConditionTag(!1,"Comment not found",593000205),Promise.resolve(Zr.e.Handled));case"ReplyComment":return this.beginDraftingHelper(t,{sessionType:"REPLY",threadId:e.threadId},L.d.reserveTag(593000209),L.d.reserveTag(593000210));case"DiscardDraft":var c=n();if(e.mode===So.a.TryAutoDiscard)return t(Object(Eo.a)({renderContextType:ut.a.None,telemetryVisitor:this.telemetryVisitor,trackback:L.d.reserveTag(575411521)},Qe.a.Canvas)).then((function(e){return e.draftDiscardResult}));a=rt.t(c);if(e.mode===So.a.Dialog&&Object($e.n)(rt.h(c))===wo.a.CannotAutoDiscard)return at.a(c)?Promise.resolve(Zr.e.Unhandled):Promise.resolve(Zr.e.Canceled);var s=Object(oo.b)(at.e(c)===be.a.Visible,Object(en.a)(at.d(c).containerType),rt.h(c),a,rt.u(c));return t(Object(ko.a)({renderContextType:ut.a.None,telemetryVisitor:this.telemetryVisitor,trackback:L.d.reserveTag(575411522)},Qe.a.Canvas,s,void 0));default:return Promise.resolve(Zr.e.Unhandled)}},e.prototype.handleActionOrReturnToDraft=function(e,t,n,r){t(Object(Eo.a)({renderContextType:ut.a.None,trackback:r,telemetryVisitor:this.telemetryVisitor},Qe.a.SharedComments,n)).then((function(t){void 0!==n&&t.draftDiscardBehavior!==wo.a.NoDraft&&t.draftDiscardResult!==Zr.e.Handled||e()})).catch(Object(ne.a)(L.d.reserveTag(591738704)))},e}(),No=n(1161),Mo=n(1162),Lo=n(1166),Bo=n(1050),Vo=n(1175),Uo=n(1176);function _o(e,t,n,r){return function(o,a){var i=a();r&&o(r);var c=r?r.actionDetail.telemetryVisitor:t;if(n){if(void 0!==n.topVisibleThreadId&&o(Object(Vo.a)({renderContextType:e,telemetryVisitor:c,trackback:L.d.reserveTag(595953696)},n.topVisibleThreadId||void 0)),void 0!==n.selectedCommentId){var s=rt.t(i);if(n.selectedCommentId)if(s&&s.selectedCardId===n.selectedCommentId)if(Object(nt.j)(s.selectionDetails)){var d=s.selectionDetails.selectedPostId,u=a();Object(it.b)(rt.d(u),d)?o(Object(Bo.b)({renderContextType:e,telemetryVisitor:c,trackback:L.d.reserveTag(595953698)},n.selectedCommentId,d,Bo.a.SelectPost,Qe.a.Canvas)):o(Object(Bo.b)({renderContextType:e,telemetryVisitor:c,trackback:L.d.reserveTag(595953699)},n.selectedCommentId,void 0,Bo.a.ExpandCard,Qe.a.Canvas))}else o(Object(Bo.b)({renderContextType:e,telemetryVisitor:c,trackback:L.d.reserveTag(595953697)},n.selectedCommentId,void 0,Bo.a.SelectCard,Qe.a.Canvas));else o(Object(Bo.b)({renderContextType:e,telemetryVisitor:c,trackback:L.d.reserveTag(595953728)},n.selectedCommentId,void 0,Bo.a.ExpandCard,Qe.a.Canvas));else if(s){var l=rt.h(i),f=l.cardIdToDraftIdMap[s.selectedCardId];f&&"CREATE"===l.drafts[f].commentDraft.sessionConfiguration.sessionType||o(Object(Mo.a)({renderContextType:e,telemetryVisitor:c,trackback:L.d.reserveTag(595953729)}))}}void 0!==n.highlightedCommentId&&(n.highlightedCommentId?o(Object(Lo.a)({renderContextType:e,telemetryVisitor:c,trackback:L.d.reserveTag(595953730)},n.highlightedCommentId,Qe.a.Canvas)):o(Object(No.a)({renderContextType:e,telemetryVisitor:c,trackback:L.d.reserveTag(578586722)},Qe.a.Canvas,void 0)));var m=wn(n);m&&o(Object(Uo.a)({renderContextType:e,telemetryVisitor:c,trackback:L.d.reserveTag(595953732)},m))}}}var Ho=n(1009),Go=n(1130);var qo=n(1167),zo=n(1169);function Wo(e,t,n){return function(r){tn.o(t)?r(Object(zo.a)(Object(Ho.a)(e,L.d.reserveTag(595137280)),t.threads)):(Q.G()&&r(Object(Go.a)(Object(Ho.a)(e,L.d.reserveTag(595137282)),t.comments,t.tasks,n)),r(Object(qo.a)(Object(Ho.a)(e,L.d.reserveTag(595137283)),t.comments,t.tasks)))}}var Yo=function(){function e(e,t,n,r){this.commonViewStrategy=e,this.peopleAPI=t,this.focusManager=n,this.telemetryVisitor=r}return e.prototype.processCommentEvent=function(e,t,n,r){switch(e){case Mr.a.CommentsChanged:tn.h(t)&&n(_o(ut.a.None,this.telemetryVisitor,t.contextDetails,Object(Xe.applyCommentChanges)({renderContextType:ut.a.None,trackback:L.d.reserveTag(595937042),telemetryVisitor:this.telemetryVisitor},t.changes)));break;case Mr.a.LoadComments:tn.i(t)&&n(Wo({renderContextType:ut.a.None,trackback:L.d.reserveTag(595899532),telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI));break;case Mr.a.CommentContextReload:tn.d(t)&&n(function(e,t,n,r){return function(o,a){var i=[];Object(tn.c)(t)?(Object(U.k)().assertConditionTag(!a||rt.p(a()).virtualized,"contextReloadThunk's payload should only include comment ids when state is virtualized",595162893),i=nn(t.commentIds,(function(){return a().commentState}))):i=t.comments;var c=Object(tn.c)(t)?[]:t.tasks;o(_o(e.renderContextType,r,t.contextDetails,Object(Xe.reloadComments)(Object(Ho.a)(e,L.d.reserveTag(595953694)),{comments:i,tasks:c}))),Q.G()&&o(Object(Go.a)(Object(Ho.a)(e,L.d.reserveTag(595932895)),i,c,n)).catch(Object(ne.a)(L.d.reserveTag(595645974)))}}({renderContextType:ut.a.None,trackback:L.d.reserveTag(595899533),telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI,this.telemetryVisitor))}this.commonViewStrategy.processCommentEvent(e,t,n,r)},e.prototype.processCommentUIAction=function(e,t,n){if(e.actionType===Zr.d.AddComment&&e.actionBehavior!==Zr.a.CheckEnabled){var r=n();at.b(r)&&this.focusManager.onUserAction(r.paneState.componentTree,{userAction:kt.a.RequestNewCommentFromHost})}return this.commonViewStrategy.processCommentUIAction(e,t,n)},e.prototype.handleCommentInterruptableCommand=function(e,t,n){return this.commonViewStrategy.handleCommentInterruptableCommand(e,t,n)},e}();var Ko=n(1170);var Xo=function(){function e(e,t,n,r){this.commonViewStrategy=e,this.peopleAPI=t,this.lastInitializationReason=n,this.telemetryVisitor=r}return e.prototype.processCommentEvent=function(e,t,n,r){switch(e){case Mr.a.CommentsChanged:tn.h(t)&&n(function(e,t){return function(n,r){var o,a,i,c,s,d=r(),u=!1,l=e.contextDetails;if(""===(null==l?void 0:l.selectedCommentId)&&(l=Object(X.a)(Object(X.a)({},l),{selectedCommentId:void 0})),n(_o(ut.a.None,t,l,Object(Xe.applyCommentChanges)({renderContextType:ut.a.None,trackback:L.d.reserveTag(595953743),telemetryVisitor:t},e.changes))),!e.contextDetails||!e.contextDetails.selectedCommentId){var f=rt.t(d),m=f?f.selectedCardId:void 0,p=r(),h=rt.t(p);Object(U.k)().assertConditionTag(!Object(ot.g)(d),"applyCommentChangesAndPreserveSelectionPositionThunk is not presently supported with filtering enabled",526402329);var v=rt.a(d),g=rt.a(p);if(m){if(m&&e.changes.some((function(e){return e.type===Qt.a.Delete&&e.model.commentId===m}))){var y=void 0;if(Object(it.f)(v)){var b=rt.b(d),C=[],T=0;y=-1;for(var I=0;I<v.length;I++)C.push(T),T+=b[v[I]].length,v[I]===m&&(y=I);try{for(var S=Object(X.i)(e.changes),O=S.next();!O.done;O=S.next()){switch((P=O.value).type){case Qt.a.Insert:var w=void 0;for(w=C.length-1;w>=0&&P.index<=C[w];w--)C[w]+=1;Object(xt.a)(P.model)&&(w<y&&++y,C.splice(w+1,0,P.index));break;case Qt.a.Delete:var j=void 0;for(j=C.length-1;j>=0;j--){if(!(P.index<C[j])){P.index===C[j]&&(j<y&&--y,C.splice(j,1));break}C[j]-=1}break;case Qt.a.Modify:case Qt.a.Unknown:case Qt.a.Load:break;default:Object(L.m)(P)}}}catch(e){o={error:e}}finally{try{O&&!O.done&&(a=S.return)&&a.call(S)}finally{if(o)throw o.error}}}else{y=v.findIndex((function(e){return e.commentId===m}));try{for(var E=Object(X.i)(e.changes),k=E.next();!k.done;k=E.next()){var P;switch((P=k.value).type){case Qt.a.Insert:P.index<=y&&++y;break;case Qt.a.Delete:P.index<y&&--y;break;case Qt.a.Modify:case Qt.a.Unknown:case Qt.a.Load:break;default:Object(L.m)(P)}}}catch(e){i={error:e}}finally{try{k&&!k.done&&(c=E.return)&&c.call(E)}finally{if(i)throw i.error}}}if(h)throw new me.a(Le.l,L.d.reserveTag(589103626),-2130957551);if(g.length){var x=y;x===g.length&&(x-=1);var A=Object(it.f)(g)?g[x]:Object(xt.b)(g[x]);n(Object(Xe.selectComment)({renderContextType:ut.a.None,trackback:L.d.reserveTag(595953744),telemetryVisitor:t},A,void 0,Bo.a.ExpandCard,Qe.a.SharedComments)),u=!0}}}else!v.length&&g.length&&(n(Object(Xe.selectComment)({renderContextType:ut.a.None,trackback:L.d.reserveTag(595947723),telemetryVisitor:t},Object(it.f)(g)?g[0]:g[0].commentId,void 0,Bo.a.ExpandCard,Qe.a.SharedComments)),u=!0);Object(U.k)().assertConditionTag(u||0===g.length||""!==(null===(s=e.contextDetails)||void 0===s?void 0:s.selectedCommentId),"Received empty selection from context details with existing comments and without setting selection afterwards in applyCommentChangesAndPreserveSelectionPositionThunk",590991767)}}}(t,this.telemetryVisitor));break;case Mr.a.LoadComments:tn.i(t)&&(r().paneState.initializationStatus!==jn.a.Initialized&&this.lastInitializationReason===fe.a.NewThread||!at.b(r())?n(Wo({renderContextType:ut.a.None,trackback:L.d.reserveTag(595899531),telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI)):n(function(e,t,n,r){return function(o,a){o(Wo({renderContextType:e,trackback:L.d.reserveTag(595899530),telemetryVisitor:r},t,n));var i=a();Object(U.k)().assertConditionTag(void 0===Object(ot.g)(i),"Half pane specific logic should not run with filtering enabled.",523866629);var c=rt.p(i).virtualized,s=rt.t(i),d=rt.k(i);!Object(Ze.a)(rt.q(i),c,!!Object(ot.g)(a()))||!d.length||s&&Object(Je.b)(i,s.selectedCardId)||o(Object(Xe.selectComment)({renderContextType:e,trackback:L.d.reserveTag(595953680),telemetryVisitor:r},Object(it.f)(d)?d[0]:d[0].commentId,void 0,Bo.a.ExpandCard,Qe.a.SharedComments))}}(ut.a.HalfPane,t,this.peopleAPI,this.telemetryVisitor)));break;case Mr.a.CommentContextReload:tn.d(t)&&n(function(e,t,n,r){return function(o,a){var i,c,s=a(),d=!1,u=[];Object(tn.c)(t)?(Object(U.k)().assertConditionTag(rt.p(s).virtualized,"reloadCommentsAndPreserveSelectionPositionThunk's payload should only include comment ids when state is virtualized",595162891),u=nn(t.commentIds)):u=t.comments;var l=t.contextDetails;""===(null==l?void 0:l.selectedCommentId)&&(l=Object(X.a)(Object(X.a)({},l),{selectedCommentId:void 0}));var f=Object(tn.c)(t)?[]:t.tasks;o(_o(e,r,l,Object(Ko.a)({renderContextType:e,telemetryVisitor:r,trackback:L.d.reserveTag(595953677)},{comments:u,tasks:f}))),Q.G()&&o(Object(Go.a)({renderContextType:e,telemetryVisitor:r,trackback:L.d.reserveTag(595162892)},u,f,n)).catch(Object(ne.a)(L.d.reserveTag(595645962))),Object(U.k)().assertConditionTag(!Object(ot.g)(s),"reloadCommentsAndPreserveSelectionPositionThunk is not presently supported with filtering enabled",526402328);var m=null===(i=rt.t(s))||void 0===i?void 0:i.selectedCardId,p=rt.a(s),h=a(),v=rt.a(h);if(m){if(!rt.t(h)){var g=Object(it.f)(p)?p.findIndex((function(e){return e===m})):p.findIndex((function(e){return e.commentId===m}));if(g<0)return;if(v.length){var y=g;y===v.length&&(y-=1);var b=Object(it.f)(v)?v[y]:Object(xt.b)(v[y]);o(Object(Xe.selectComment)({renderContextType:e,telemetryVisitor:r,trackback:L.d.reserveTag(595953678)},b,void 0,Bo.a.ExpandCard,Qe.a.SharedComments)),d=!0}}}else!p.length&&v.length&&(o(Object(Xe.selectComment)({renderContextType:e,telemetryVisitor:r,trackback:L.d.reserveTag(595947722)},Object(it.f)(v)?v[0]:v[0].commentId,void 0,Bo.a.ExpandCard,Qe.a.SharedComments)),d=!0);Object(U.k)().assertConditionTag(d||0===v.length||""!==(null===(c=t.contextDetails)||void 0===c?void 0:c.selectedCommentId),"Received empty selection from context details with existing comments and without setting selection afterwards in reloadCommentsAndPreserveSelectionPositionThunk",590991766)}}(ut.a.HalfPane,t,this.peopleAPI,this.telemetryVisitor))}this.commonViewStrategy.processCommentEvent(e,t,n,r)},e.prototype.processCommentUIAction=function(e,t,n){return this.commonViewStrategy.processCommentUIAction(e,t,n,{retainSelectionOnAddComment:!0})},e.prototype.handleCommentInterruptableCommand=function(e,t,n){return this.commonViewStrategy.handleCommentInterruptableCommand(e,t,n)},e}(),Qo=function(){function e(){}return e.prototype.createViewStrategy=function(e,t,n,r,o,a,i,c){var s=new Fo(t,n,r,o,c);switch(e.containerType){case le.a.HalfPane:return new Xo(s,n,i,c);case le.a.FullPane:return new Yo(s,n,a,c)}},e}();function Jo(e){if(void 0===e.hostCommentAPI)throw new me.a("'hostCommentAPI' was not supplied",L.d.reserveTag(589103634),-2130957511);if(void 0===e.peopleAPI)throw new me.a("'peopleAPI' was not supplied",L.d.reserveTag(589103635),-2130957511);if(void 0===e.viewContainerProvider)throw new me.a("'viewContainerProvider' was not supplied",L.d.reserveTag(589103636),-2130957511);var t=Object(ie.g)(e.apiContext)?Object(ie.f)(e.apiContext):void 0,n=Object(ae.e)(e.apiContext)?Object(ae.d)(e.apiContext):void 0,r=Object(z.b)(),o=e.themeAPI||new qe,a=new _e(e.hostCommentAPI),i=ye.getTelemetryVisitor(e.apiContext),c=new Vt(r.getLocaleInfo().isRightToLeft,i),s=new Io(e.peopleAPI,i,e.correlationId||"");Q.z()&&s.initializeController(!1);var d=function(e,t,n,r,o,a,i,c,s){var d=s?[Object(pr.b)(s,r)]:[],u=Object(Ut.compose)(Ut.applyMiddleware.apply(void 0,Object(X.h)([Wt,zt,qt,mr,Er(r),$n(e,r),cr(r),vr(i),Ar(0,c),yr(a),or(r),ar(o)],Object(X.f)(d),!1))),l=Object(Ut.createStore)(Wn,n,u);return i.initialize(l,!!o),l}(a,e.viewContainerProvider,Vn(e.viewContainerProvider.getViewContainer(),e.paneVisible,r.getLocaleInfo(),e.apiContext),ye.getTelemetryVisitor(e.apiContext),t,r,c,s,n);return new To({apiContext:e.apiContext,viewProvider:e.viewContainerProvider,commentAPI:a,peopleAPI:e.peopleAPI,localizationAPI:r,themeAPI:o,focusManager:c,lppManager:s,initializationReason:e.initializationReason,commentStore:d,viewStrategyFactory:new Qo,initializeImmediately:e.initializeImmediately,mockUIDriver:e.mockDriver,contentNavigationAPI:t,contentFilteredRangeAPI:n})}function Zo(e,t,r,o,c,s,d,u,l){try{try{if(Fe())return void Object(U.k)().assertConditionTag(!1,"View manager singleton cannot be instantiated more than once!",595891844)}catch(e){if(!Object(me.b)(e))throw e}!function(e){ge=e}(Jo);var f=[];Object(V.d)()?f.push([!d,"App settings should not be passed in when feature gate API is already initialized. Please inspect feature gate initialization on host.",L.d.reserveTag(527754333)]):(f.push([!!d,"Must initialize feature gate API but no appSettings passed to instantiate.",L.d.reserveTag(527754332)]),Object(V.c)({appSettings:null!=d?d:{},mapping:Ae.a})),Object(U.k)().hasBeenInitialized()?Object(U.k)().assertConditionTag(!t,"Telemetry details should not be passed in if telemetry API is already initialized. Please inspect telemetry API initialization on host.",527754334):Object(U.m)(Re,t),f.forEach((function(e){Object(U.k)().assertConditionTag(e[0],e[1],e[2])})),Object(U.k)().assertConditionTag(!!d,"appSettings should not be undefined",595616278);var m=function(){var t=Object(z.c)(c);Object(a.setRTL)(t.getLocaleInfo().isRightToLeft),function(e){if(Q.Y())Object(a.registerIcons)(De(e));else{var t=n(1237),r=n(1238),o=Object(a.getRTL)()?n(1239):n(1240),c=n(1241),s=n(1242),d=n(1243),u=n(1244),l=n(1245),f=n(1246),m=n(1247),p=n(1116),h=n(1248),v=n(1249),g={HintBarEllipses_16:i.createElement(t,null),CancelGlyph:i.createElement(r,null),NewComment:i.createElement(o,null),CancelGlyph_TaskPane:i.createElement(c,null),Send2_Fluent:i.createElement(s,null),Delete_Fluent:i.createElement(d,null),Edit_Fluent:i.createElement(u,null),Checkmark_Fluent:i.createElement(l,null),CommentReopen_Fluent:i.createElement(f,null),Error:i.createElement(m,null),ReopenThread:i.createElement(p,null),DeleteFilter:i.createElement(h,null),DeleteFilterDefault:i.createElement(v,null)};if(e||Q.c()){var y=n(1250),b=n(1251),C=n(1252),T=n(1253),I=n(1116),S=n(1254),O=n(1255);g.TaskAssign=i.createElement(y,null),g.TaskComplete=i.createElement(b,null),g.TaskDelete=i.createElement(C,null),g.TaskEdit=i.createElement(T,null),g.TaskReopen=i.createElement(I,null),g.TaskStatusCircleCheckmark=i.createElement(S,null),g.ChevronDown12=i.createElement(O,null)}if(e||Q.b()){var w=n(1256),j=n(1257);g.CommentLikeEmpty=i.createElement(w,null),g.CommentLikeSolid=i.createElement(j,null)}if(e||Q.A()){var E=n(1258);g.LinkToComment=i.createElement(E,null)}Object(a.registerIcons)({icons:g})}}();var d=function(e,t){return new Ie(e,t)}(M.a,o);ye.ensureViewManager({apiContext:M.a,displayMode:K.b.FullPane,foldableLayoutState:K.a.Indeterminate,initializationReason:s||fe.a.PaneOpen,correlationId:Object(B.a)(),viewContainerProvider:d,peopleAPI:r,hostCommentAPI:e,paneVisible:!1,initializeImmediately:!1}),Object(W.c)(u),Q.P()&&l&&Y.a.setThemeAPI(l),Ee(),Object(G.g)().onExtensionFirstRequested.subscribe((function(e){e.contentType===G.b.CommentThread&&e.instanceId===G.c&&Ne()}))};Q.R()?Object(xe.b)().then((function(){m()})).catch((function(e){return Object(ne.a)(L.d.reserveTag(526254819))(e)})):m()}catch(e){throw Object(ne.a)(L.d.reserveTag(594367139))(e),e}}function $o(){try{try{Fe()}catch(e){if(!Object(me.b)(e))throw e;return}!function(){ge=ve}(),Object(q.a)(),Object(H.c)(),Object(G.f)(),function(){Q.Y()&&(void 0!==je&&document.body.removeChild(je),je=void 0),Pe(null)}(),Object(_.c)(),Object(W.b)(),Q.P()&&(Y.a.resetThemeAPI(),Object(Y.f)()),ye.disposeViewManager(),function(e){var t=De(e),n=[];for(var r in t.icons)void 0!==r&&n.push(r);n.length&&Object(a.unregisterIcons)(n)}(),Object(z.a)(),Object(U.i)(),Object(V.a)()}catch(e){throw e}}var ea=n(1204);function ta(e){return(ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function na(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ra(r.key),r)}}function ra(e){var t=function(e,t){if("object"!==ta(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ta(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===ta(t)?t:String(t)}var oa,aa,ia,ca=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.eventCallbacks=[]}return function(e,t,n){t&&na(e.prototype,t),n&&na(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"add",value:function(e){this.eventCallbacks.push(e)}},{key:"remove",value:function(e){var t=this.eventCallbacks.indexOf(e);t>=-1&&this.eventCallbacks.splice(t,1)}},{key:"invoke",get:function(){var e=this;return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.eventCallbacks.forEach((function(e){return e.apply(void 0,n)}))}}}]),e}();function sa(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return{trackInfo:function(n,r){e.trackInfo("".concat(t).concat(n),r)},trackError:function(n,r,o){e.trackError("".concat(t).concat(n),r,o)},trackWarning:function(n,r){e.trackWarning("".concat(t).concat(n),r)},createScenarioTracker:function(n,r,o){return e.createScenarioTracker("".concat(t).concat(n),r,o)}}}function da(){if(!ia)throw new Error("The logger has not been initialized yet. Please call `initializeTelemetryAPI` first");return ia}!function(e){e.OpenPane="OpenPane",e.ClosePane="ClosePane"}(oa||(oa={})),function(e){e.PaneClosed="PaneClosed"}(aa||(aa={}));var ua=new ca;function la(e){ua.add(e)}function fa(e){ua.remove(e)}function ma(e){da().trackInfo("ViewContainerProvider/setViewContainerVisibilityState",{isVisible:e}),ua.invoke({eventType:ea.a.VisibilityChanged,viewContainerVisibilityState:e?be.a.Visible:be.a.Closed})}function pa(e){return e.setViewContainerEventEmitter(function(){return function(e){switch(e){case oa.OpenPane:ma(!0);break;case oa.ClosePane:ma(!1)}}}()),{changeViewContainerType:ha,registerForViewContainerEvents:la,unregisterForViewContainerEvents:fa,getViewContainer:function(){return{openView:function(){return ma(!0)},identifier:"ppux-shared-comments-pane",containerType:le.b.FullPane,closeView:function(){e.onViewContainerEvent(aa.PaneClosed),ma(!1)},moveFocusToCanvas_donotuse:ha}}}}function ha(){}var va,ga,ya=n(1193);!function(e){e.CommentAdded="CommentAdded",e.CommentEdited="CommentEdited",e.CommentDeleted="CommentDeleted",e.ThreadSelected="ThreadSelected",e.GetCurrentlySelectedAnchorId="GetCurrentlySelectedAnchorId"}(va||(va={})),function(e){e.SetInitialViewData="SetInitialViewData",e.LoadComments="LoadComments",e.GetOrphanedComments="GetOrphanedComments",e.GetUnresolvedThreadCountsForAnchors="GetUnresolvedThreadCountsForAnchors",e.SelectFirstThreadRelatedToAnchor="SelectFirstThreadRelatedToAnchor",e.SelectComment="SelectComment",e.DeselectThread="DeselectThread",e.CreateThread="CreateThread",e.ContextViewDataChanged="ContextViewDataChanged",e.InsertComments="InsertComments",e.EditComment="EditComment",e.DeleteReply="DeleteReply"}(ga||(ga={}));var ba=n(995),Ca=n(1266);function Ta(e){return Ia(new Ca.a(e).Mentions)}function Ia(e){return e.map((function(e){return{email:e.UserId}}))}function Sa(e){return(Sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oa(e){return function(e){if(Array.isArray(e))return wa(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return wa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wa(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ja(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ea(r.key),r)}}function Ea(e){var t=function(e,t){if("object"!==Sa(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Sa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Sa(t)?t:String(t)}var ka=function(){function e(t,n,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.contextWidgetAnchorMap=new Map,this.activeContextId="",this.currentContextView=[],this.draftInfoMap=new Map,this.setActiveContextAndView=function(e){o.activeContextId=e.activeContextId,o.contextWidgetAnchorMap=e.contextWidgetAnchorMap;var t=o.getOrderedCommentsInCurrentContext();o.setCommentFlagsForComments(t),o.setCurrentContextView(t)},this.getOrderedCommentsInCurrentContext=function(){var e=o.contextWidgetAnchorMap.get(o.getActiveContextId())||[],t=o.allComments.filter((function(t){var n=t.anchorId;return n===o.getActiveContextId()||e.includes(n)}));o.sortCommentsByDate(t);var n=[],r=[];t.forEach((function(e){o.isThreadRoot(e)?n.push(e):r.push(e)}));var a=[],i=[];n.forEach((function(e){e.anchorId===o.getActiveContextId()?a.push(e):i.push(e)})),o.sortCommentsInAnchorOrder(i,e);var c=[].concat(a,i),s=new Map;r.forEach((function(e){var t=s.get(e.parentId)||[];t.push(e),s.set(e.parentId,t)}));var d=[];return c.forEach((function(e){d.push(e);var t=s.get(e.commentId)||[];d.push.apply(d,Oa(t))})),d},this.setCurrentContextView=function(e){var t=o.allComments.filter((function(e){var t=e.anchorId,n=o.contextWidgetAnchorMap.get(o.getActiveContextId())||[];return t!==o.getActiveContextId()&&!n.includes(t)}));o.currentContextView=e,o.allComments=[].concat(Oa(o.currentContextView),Oa(t))},this.getCurrentContextView=function(){return o.currentContextView},this.getActiveContextId=function(){return o.activeContextId},this.setCommentsArray=function(e){o.allComments=e,o.setActiveContextAndView({activeContextId:o.getActiveContextId(),contextWidgetAnchorMap:o.contextWidgetAnchorMap})},this.getDraftInfo=function(e){return o.draftInfoMap.get(e)},this.setDraftInfo=function(e,t){try{var n,r,a,i,c=e.draftId,s=e.sessionType;switch(s){case"CREATE":r=Object(ba.a)(),n="",a=(null==t?void 0:t.anchorId)||o.getActiveContextId(),i=o.getIndexForNewThread(a);break;case"REPLY":r=Object(ba.a)(),n=e.threadId,a=o.getCommentAnchor(n),i=o.getIndexForNewReply(n);break;case"EDIT":r=e.commentId,n=o.getParentId(r),a=o.getCommentAnchor(r),i=o.getCommentIndex(r);break;default:throw new Error("Unsupported draft session type")}o.draftInfoMap.set(c,{sessionType:s,parentId:n,commentId:r,anchorId:a,draftIndex:i})}catch(t){throw da().trackError("CommentViewManager/setDraftInfo-Error",{configuration:e},t),t}},this.saveComment=function(e,t){try{var n=o.draftInfoMap.get(e);if(!n)throw new Error("Draft info not found");switch(n.sessionType){case"CREATE":o.createThread(t);break;case"REPLY":o.addReply(t);break;case"EDIT":o.editComment(t)}o.draftInfoMap.delete(e)}catch(t){throw da().trackError("CommentViewManager/saveComment-Error",{draftId:e},t),t}},this.createCommentInfoForDraft=function(e,t){try{var n=o.draftInfoMap.get(e);if(!n)throw new Error("Draft info not found");var r=n.parentId,a=n.commentId,i=n.anchorId;return{date:new Date,parentId:r,anchorHintText:"",commentFlags:Be.f.None,commentBody:t||"",commentId:a,author:o.authorInfo,anchorId:i}}catch(t){throw da().trackError("CommentViewManager/createCommentInfoForDraft-Error",{draftId:e},t),t}},this.deleteComment=function(e){try{var t=o.getComment(e);if(!t)throw new Error("Comment to be deleted not found...");var n=o.getCurrentContextView(),r=n.indexOf(t),a=o.getReplyCount(e),i=[].concat(Oa(n.slice(0,r)),Oa(n.slice(r+a+1)));o.setCurrentContextView(i)}catch(t){throw da().trackError("CommentViewManager/deleteComment-Error",{commentId:e},t),t}},this.setThreadResolvedState=function(e,t){da().trackInfo("CommentViewManager/SetThreadResolvedState-Start",{threadId:e,isResolved:t});try{var n=o.getComment(e);if(!n)throw new Error("Thread not found...");n.commentFlags=o.setCommentFlagsForComment(n,t?Be.f.Resolved:Be.f.None);var r=o.getCurrentContextView(),a=o.getCommentIndex(n.commentId);r.splice(a,1,n),o.setCurrentContextView(r)}catch(n){throw da().trackError("CommentViewManager/setThreadResolvedState-Error",{threadId:e,isResolved:t},n),n}},this.getThreadCountInCurrentContext=function(){return o.getCurrentContextView().filter((function(e){return o.isThreadRoot(e)})).length},this.modifyCommentFields=function(e,t){var n;try{var r=o.getComment(e);if(!r)throw new Error("Comment not found...");r.commentId=t.commentId,r.commentFlags=null!==(n=t.commentFlags)&&void 0!==n?n:r.commentFlags}catch(t){throw da().trackError("CommentViewManager/modifyCommentId-Error",{commentId:e},t),t}},this.insertCommentsManually=function(e){da().trackInfo("CommentViewManager/insertCommentsManually-Start",{commentIds:e.map((function(e){return e.commentId}))}),e.forEach((function(e){try{if(o.isThreadRoot(e))return void o.createThread(e);o.addReply(e)}catch(e){throw da().trackError("CommentViewManager/insertCommentsManually-Error",{},e),e}}))},this.createThread=function(e){var t=o.getIndexForNewThread(e.anchorId),n=[].concat(Oa(o.getCurrentContextView().slice(0,t)),[e],Oa(o.getCurrentContextView().slice(t)));o.setCurrentContextView(n)},this.addReply=function(e){var t=o.getComment(e.parentId);if(!t)throw new Error("Parent comment of reply not found");var n=o.getIndexForNewReply(t.commentId),r=[].concat(Oa(o.getCurrentContextView().slice(0,n)),[e],Oa(o.getCurrentContextView().slice(n)));o.setCurrentContextView(r)},this.editComment=function(e){if(!o.getComment(e.commentId))throw new Error("Original comment not found...");var t=o.getCurrentContextView(),n=o.getCommentIndex(e.commentId);t.splice(n,1,e),o.setCurrentContextView(t)},this.setCommentFlagsForComments=function(e){e.forEach((function(e){e.commentFlags=o.setCommentFlagsForComment(e)}))},this.setCommentFlagsForComment=function(e,t){var n=e.author,r=null!=t?t:e.commentFlags;return n.UserId!==o.authorInfo.UserId&&(r|=Be.f.EditRestricted),r},this.getReplies=function(e){return o.getCurrentContextView().filter((function(t){return t.parentId===e}))},this.getReplyCount=function(e){return o.getReplies(e).length},this.isThreadRoot=function(e){return""===e.parentId},this.getParentId=function(e){var t;return(null===(t=o.getComment(e))||void 0===t?void 0:t.parentId)||""},this.getComment=function(e){return o.getCurrentContextView().find((function(t){return t.commentId===e}))},this.getCommentIndex=function(e){return o.getCurrentContextView().findIndex((function(t){return t.commentId===e}))},this.getCommentsAnchoredToCurrentContext=function(){return o.getCurrentContextView().filter((function(e){return e.anchorId===o.getActiveContextId()}))},this.sortCommentsInAnchorOrder=function(e,t){e.sort((function(e,n){return t.indexOf(e.anchorId)-t.indexOf(n.anchorId)}))},this.sortCommentsByDate=function(e){e.sort((function(e,t){return e.date.getTime()-t.date.getTime()}))},this.getIndexForNewThread=function(e){if(e===o.getActiveContextId())return o.getCommentsAnchoredToCurrentContext().length;var t=o.contextWidgetAnchorMap.get(o.getActiveContextId())||[],n=t.findIndex((function(t){return t===e}));if(n<0)throw new Error("Anchor for new thread not found");var r=o.getCurrentContextView(),a=r.length,i=new Map;t.forEach((function(e,t){return i.set(e,t)}));for(var c=0;c<r.length;c++){var s=i.get(r[c].anchorId);if(s&&s>n){a=c;break}}return a},this.getIndexForNewReply=function(e){if(o.getCommentIndex(e)<0)throw new Error("Thread root for reply not found");return o.getCommentIndex(e)+o.getReplyCount(e)+1},this.getCommentsRelatedToAnchor=function(e){return o.getCurrentContextView().filter((function(t){return t.anchorId===e}))},this.getCommentAnchor=function(e){var t;return(null===(t=o.getComment(e))||void 0===t?void 0:t.anchorId)||o.getActiveContextId()},this.getAnchorThreadCountMap=function(){var e=new Map;return o.allComments.forEach((function(t){if(o.isThreadRoot(t)&&!o.isCommentResolved(t)&&o.getAllAnchors().has(t.anchorId)){var n=e.get(t.anchorId)||0;e.set(t.anchorId,n+1)}})),e},this.getOrphanedComments=function(){return o.allComments.filter((function(e){return!o.getAllAnchors().has(e.anchorId)}))},this.getAllAnchors=function(){var e=[];return o.contextWidgetAnchorMap.forEach((function(t){e.push.apply(e,Oa(t))})),e.push.apply(e,Oa(o.contextWidgetAnchorMap.keys())),new Set(e)},this.getMentionedUsers=function(e){return e?Ta(e):[]},this.getTotalCommentsCount=function(){var e=o.getAllAnchors();return o.allComments.filter((function(t){return e.has(t.anchorId)})).length},this.authorInfo=r,this.allComments=t,this.activeContextId=n.activeContextId,this.setActiveContextAndView(n)}return function(e,t,n){t&&ja(e.prototype,t),n&&ja(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"isCommentResolved",value:function(e){return(e.commentFlags&Be.f.Resolved)===Be.f.Resolved}}]),e}();function Pa(e){return(Pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xa(e){return function(e){if(Array.isArray(e))return Aa(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Aa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Aa(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Aa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Da(){Da=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),c=new P(r||[]);return o(i,"_invoke",{value:w(e,n,c)}),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="executing",p="completed",h={};function v(){}function g(){}function y(){}var b={};d(b,i,(function(){return this}));var C=Object.getPrototypeOf,T=C&&C(C(x([])));T&&T!==n&&r.call(T,i)&&(b=T);var I=y.prototype=v.prototype=Object.create(b);function S(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function n(o,a,i,c){var s=l(e[o],e,a);if("throw"!==s.type){var d=s.arg,u=d.value;return u&&"object"==Pa(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){d.value=e,i(d)}),(function(e){return n("throw",e,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return a=a?a.then(o,o):o()}})}function w(t,n,r){var o=f;return function(a,i){if(o===m)throw new Error("Generator is already running");if(o===p){if("throw"===a)throw i;return{value:e,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var s=j(c,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===f)throw o=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=m;var d=l(t,n,r);if("normal"===d.type){if(o=r.done?p:"suspendedYield",d.arg===h)continue;return{value:d.arg,done:r.done}}"throw"===d.type&&(o=p,r.method="throw",r.arg=d.arg)}}}function j(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,j(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var a=l(o,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,h;var i=a.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function x(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(Pa(t)+" is not iterable")}return g.prototype=y,o(I,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:g,configurable:!0}),g.displayName=d(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,d(e,s,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},S(O.prototype),d(O.prototype,c,(function(){return this})),t.AsyncIterator=O,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new O(u(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},S(I),d(I,s,"Generator"),d(I,i,(function(){return this})),d(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=x,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),d=r.call(i,"finallyLoc");if(s&&d){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:x(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),h}},t}function Ra(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ra(Object(n),!0).forEach((function(t){Na(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ra(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Na(e,t,n){return(t=Va(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ma(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function La(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Va(r.key),r)}}function Ba(e,t,n){return t&&La(e.prototype,t),n&&La(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Va(e){var t=function(e,t){if("object"!==Pa(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Pa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Pa(t)?t:String(t)}var Ua=Ba((function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.highlightComment=_a,this.selectFirstThreadInNextCommentContext=_a,this.selectLastThreadInPreviousCommentContext=_a,this.registerForAction=_a,this.unregisterForAction=_a,this.presentLinkToComment=_a,this.loadThreads=_a,this.endCommentSession=_a,this.registerForCommentEvents=function(e){r.commentEventRegistry.add(e),r.invokeModelCapabilitiesChangedEvent()},this.unregisterForCommentEvents=function(e){r.commentEventRegistry.remove(e)},this.registerForInterruptableCommands=function(e){r.interruptableCommandEventRegistry.add(e)},this.unregisterForInterruptableCommands=function(e){r.interruptableCommandEventRegistry.remove(e)},this.deleteComment=function(e){da().trackInfo("CommentAPI/DeleteComment-Start",{commentId:e});var t=r.commentViewManager.getComment(e);if(!t){throw da().trackError("CommentAPI/DeleteComment-Error",{message:"Comment to be deleted not found"}),new Error("Comment to be deleted not found")}var n=r.commentViewManager.isThreadRoot(t)?r.commentViewManager.getReplies(t.commentId):[];r.commentViewManager.deleteComment(e),r.hostEventHandler(va.CommentDeleted,{comment:t,commentId:e,replies:n},(function(){da().trackInfo("CommentAPI/DeleteComment-Successful",{commentId:e}),r.reloadContext()}),(function(n){da().trackError("CommentAPI/DeleteComment-Failed",{commentId:e},n),r.commentViewManager.insertCommentsManually([t]),r.reloadContext()}))},this.selectComment=function(e){var t,n,o=null!==(n=null===(t=r.commentViewManager.getDraftInfo(e))||void 0===t?void 0:t.anchorId)&&void 0!==n?n:r.commentViewManager.getCommentAnchor(e);da().trackInfo("CommentAPI/SelectComment-Start",{threadId:e,anchorId:o}),r.hostEventHandler(va.ThreadSelected,{anchorId:o})},this.resolveSupported=function(){return!0},this.setThreadResolvedState=function(e,t){da().trackInfo("CommentAPI/SetThreadResolvedState-Start",{threadId:e,isResolved:t}),r.commentViewManager.setThreadResolvedState(e,t);var n=r.commentViewManager.getComment(e);r.hostEventHandler(va.CommentEdited,{comment:n,mentions:r.commentViewManager.getMentionedUsers(n.commentBody)},(function(){da().trackInfo("CommentAPI/SetThreadResolvedState-Successful",{threadId:e,isResolved:t}),r.reloadContext()}),(function(n){da().trackError("CommentAPI/SetThreadResolvedState-Failed",{threadId:e,isResolved:t},n),r.commentViewManager.setThreadResolvedState(e,!t),r.reloadContext()}))},this.checkAtMentionCapability=function(){var e=!!(r.modelCapabilities&Gt.AtMentionKnown)&&!!(r.modelCapabilities&Gt.AtMentionEnabled);return Promise.resolve(e)},this.beginDraftingAsync=function(){var e=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Ma(a,r,o,i,c,"next",e)}function c(e){Ma(a,r,o,i,c,"throw",e)}i(void 0)}))}}(Da().mark((function e(t){var n,o,a;return Da().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return da().trackInfo("CommentAPI/beginDraftingAsync-Start",{draftConfig:t}),n=new Promise((function(e){"CREATE"!==t.sessionType?(r.commentViewManager.setDraftInfo(t),e(r.getDraftResult(t.draftId))):r.hostEventHandler(va.GetCurrentlySelectedAnchorId,null,(function(n){var o=null==n?void 0:n.anchorId;da().trackInfo("CommentAPI/GetCurrentlySelectedAnchorId-Successful",{anchorId:o}),r.commentViewManager.setDraftInfo(t,{anchorId:o||r.commentViewManager.getActiveContextId()}),e(r.getDraftResult(t.draftId))}))})),e.next=4,n;case 4:return o=e.sent,a=Fa(Fa({},o.updatedSessionParams||t),{},{draftId:t.draftId}),e.abrupt("return",Fa(Fa({},o),{},{updatedDraftSessionConfiguration:a}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getDraftResult=function(e){var t=r.commentViewManager.getDraftInfo(e);if(!t){throw da().trackError("CommentAPI/getDraftResult-Error",{errorMessage:"DraftInfo not found",draftId:e}),new Error("DraftInfo not found")}return{insertIndex:t.draftIndex,authorName:r.authorInfo.DisplayName||r.authorInfo.Email||r.authorInfo.UserId,authorIdentity:r.authorInfo.UserId,authorEmail:r.authorInfo.Email,author:r.authorInfo}},this.commit=function(e,t){var n=r.commentViewManager.createCommentInfoForDraft(e,t),o=r.commentViewManager.getDraftInfo(e);if(!o){throw da().trackError("CommentAPI/commit-Error",{errorMessage:"Draft info does not exist",draftId:e}),new Error("Draft info does not exist")}switch(da().trackInfo("CommentAPI/commit-Start",{sessionType:o.sessionType,draftId:e}),o.sessionType){case"CREATE":case"REPLY":r.hostEventHandler(va.CommentAdded,{comment:n,mentions:r.commentViewManager.getMentionedUsers(t)},(function(t){var a=t;r.commentViewManager.saveComment(e,n);var i=null==a?void 0:a.comment;i&&r.commentViewManager.modifyCommentFields(n.commentId,{commentId:i.commentId,commentFlags:i.commentFlags}),da().trackInfo("CommentAPI/commit-Successful",{sessionType:o.sessionType,draftId:e}),r.reloadContext(),setTimeout((function(){"CREATE"===o.sessionType&&i&&r.selectCommentCommandHandler(i.commentId)}),0)}),(function(t){da().trackError("CommentAPI/commit-Failed",{sessionType:o.sessionType,draftId:e},t),r.reloadContext()}));break;case"EDIT":r.hostEventHandler(va.CommentEdited,{comment:n,mentions:r.commentViewManager.getMentionedUsers(t)},(function(){r.commentViewManager.saveComment(e,n),da().trackInfo("CommentAPI/commit-Successful",{sessionType:o.sessionType,draftId:e}),r.reloadContext()}),(function(t){da().trackError("CommentAPI/commit-Failed",{sessionType:o.sessionType,draftId:e},t),r.reloadContext()}))}return e},this.loadInitialComments=function(){da().trackInfo("CommentAPI/loadInitialComments-Start"),r.invokeChangeContextAndLoadCommentsEvents()},this.eventEmitter=function(e,t,n,o){try{switch(e){case ga.SetInitialViewData:var a=t.comments,i=t.initialContextInfo,c=t.isPaneReadOnly;r.isPaneReadOnly=c,r.createViewManager(a,i),r.loadInitialComments(),null==n||n();break;case ga.LoadComments:var s=t.comments;r.commentViewManager.setCommentsArray(s),r.reloadContext(),null==n||n();break;case ga.SelectFirstThreadRelatedToAnchor:var d=t.anchorId;r.selectFirstThreadRelatedToAnchorCommandHandler(d),null==n||n();break;case ga.DeselectThread:r.deselectThreadCommandHandler(),null==n||n();break;case ga.SelectComment:var u=t.commentId;r.selectCommentCommandHandler(u),null==n||n();break;case ga.CreateThread:r.createNewThreadDraftCommandHandler(),null==n||n();break;case ga.ContextViewDataChanged:var l=t,f=r.commentViewManager.getActiveContextId();if(r.commentViewManager.setActiveContextAndView(l),f!==l.activeContextId)return r.invokeChangeContextAndLoadCommentsEvents(),void(null==n||n());r.reloadContext(),null==n||n();break;case ga.GetOrphanedComments:null==n||n({comments:r.commentViewManager.getOrphanedComments()});break;case ga.GetUnresolvedThreadCountsForAnchors:null==n||n({anchorThreadCountMap:r.commentViewManager.getAnchorThreadCountMap()});break;case ga.InsertComments:var m=t.comments;r.commentViewManager.insertCommentsManually(m),r.reloadContext(),null==n||n();break;case ga.EditComment:var p=t.comment;r.commentViewManager.editComment(p),r.reloadContext(),null==n||n();break;case ga.DeleteReply:var h=t.reply;r.commentViewManager.deleteComment(h.commentId),r.reloadContext(),null==n||n()}}catch(t){da().trackError("CommentAPI/eventEmitter-Error",{eventName:e},t),null==o||o(t)}},this.invokeChangeContextAndLoadCommentsEvents=function(){r.commentEventRegistry.invoke(Mr.a.CommentContextChanged,{numberOfComments:r.commentViewManager.getCurrentContextView().length,numberOfThreads:r.commentViewManager.getThreadCountInCurrentContext(),contextDetails:{isReadOnly:r.isPaneReadOnly,nextPopulatedContextDetails:0===r.commentViewManager.getTotalCommentsCount()?Be.j.NoComments:Be.j.Unknown}}),r.commentEventRegistry.invoke(Mr.a.LoadComments,{comments:r.commentViewManager.getCurrentContextView()})},this.invokeModelCapabilitiesChangedEvent=function(){r.commentEventRegistry.invoke(Mr.a.ModelCapabilitiesChanged,{modelCapabilityFlags:r.modelCapabilities,richTextCapabilityFlags:ya.DeltaFormattingType.None})},this.createViewManager=function(e,t){try{r.commentViewManager=new ka(e,t,r.authorInfo)}catch(e){throw da().trackError("CommentAPI/createViewManager-Error",{},e),e}},this.createNewThreadDraftCommandHandler=function(){r.interruptableCommandEventRegistry.invoke({type:"CreateComment"})},this.selectFirstThreadRelatedToAnchorCommandHandler=function(e){var t=r.commentViewManager.getCommentsRelatedToAnchor(e);t.length<1?da().trackWarning("CommentAPI/SelectFirstThreadRelatedToAnchorCommandHandler-Warning",{message:"No comments related to the anchor found",anchorId:e}):r.commentEventRegistry.invoke(Mr.a.CommentSelected,{commentId:t[0].commentId})},this.selectCommentCommandHandler=function(e){r.commentViewManager.getComment(e)?r.commentEventRegistry.invoke(Mr.a.CommentSelected,{commentId:e}):da().trackWarning("CommentAPI/selectCommentCommandHandler-Warning",{message:"Comment not found"})},this.deselectThreadCommandHandler=function(){r.commentEventRegistry.invoke(Mr.a.CommentSelected,{commentId:""})},this.reloadContext=function(){setTimeout((function(){r.commentEventRegistry.invoke(Mr.a.CommentContextReload,{comments:xa(r.commentViewManager.getCurrentContextView()),numberOfThreads:r.commentViewManager.getThreadCountInCurrentContext(),contextDetails:{isReadOnly:r.isPaneReadOnly,nextPopulatedContextDetails:0===r.commentViewManager.getTotalCommentsCount()?Be.j.NoComments:Be.j.Unknown}})}),0)},this.hostEventHandler=t.onCommentAPIEvent,t.setCommentAPIEventEmitter(this.eventEmitter),this.commentEventRegistry=new ca,this.interruptableCommandEventRegistry=new ca;var o=t.getCurrentUser();this.authorInfo={UserId:o.userId,DisplayName:o.displayName,Provider:""},this.modelCapabilities=Gt.Resolve|Gt.NewThread,n&&(this.modelCapabilities=this.modelCapabilities|Gt.AtMentionKnown|Gt.AtMentionEnabled)}));function _a(){}function Ha(e){return(Ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ga(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,za(r.key),r)}}function qa(e,t,n){return t&&Ga(e.prototype,t),n&&Ga(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function za(e){var t=function(e,t){if("object"!==Ha(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ha(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ha(t)?t:String(t)}var Wa,Ya=qa((function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getString=Ka,this.getStringOrUndefined=Ka,this.getStringWithStandardPlaceholders=Ka,this.getStringWithStandardPlaceholdersOrUndefined=Ka,this.formatString=Ka,this.getLocaleInfo=function(){return{isRightToLeft:n.isRTL,uiCulture:n.currentLocale,dataCulture:n.currentLocale}},this.populateCommentsPaneStrings=function(e){window.CommentPaneStrings=e};var r=t.currentLocale,o=t.isRTL,a=t.localizedStrings;this.currentLocale=r.toLocaleLowerCase(),this.isRTL=o,this.populateCommentsPaneStrings(a)}));function Ka(){return""}function Xa(e){return(Xa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ja(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qa(Object(n),!0).forEach((function(t){Za(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Za(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Xa(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Xa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Xa(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $a(e){return($a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ei(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ni(r.key),r)}}function ti(e,t,n){return t&&ei(e.prototype,t),n&&ei(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ni(e){var t=function(e,t){if("object"!==$a(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==$a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===$a(t)?t:String(t)}!function(e){e.GetAuthToken="GetAuthToken",e.CheckMentions="CheckMentions"}(Wa||(Wa={}));var ri=ti((function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.checkUserAccess=function(e){return new Promise((function(t){t({Id:e.UserId,Provider:e.Provider,UserCanWrite:!0})}))},this.grantUsersAccess=function(e){return new Promise((function(t){n.hostEventHandler(Wa.CheckMentions,{users:Ia(e)},(function(e){var n=null==e?void 0:e.areUsersAllowedInMentions;da().trackInfo("PeopleAPI/CheckMentions-Successful",{areUsersAllowedInMentions:n}),t({OperationResult:n})}),(function(e){da().trackError("PeopleAPI/CheckMentions-Failed",{},e),t({OperationResult:!1})}))}))},this.getContactsForMentions=function(e,t,n){return new Promise((function(e,t){t("getContactsForMentions: Not implemented")}))},this.getAuthToken=function(e){return new Promise((function(e,t){n.hostEventHandler(Wa.GetAuthToken,{lokiResource:"394866fc-eedb-4f01-8536-3ff84b16be2a"},(function(t){da().trackInfo("PeopleAPI/GetAuthToken-Successful");var n=null==t?void 0:t.token;e(n)}),(function(e){da().trackError("PeopleAPI/GetAuthToken-Failed",{},e),t(e.message)}))}))},this.hostEventHandler=t.onPeopleAPIEvent,this.capabilities=Fr.b.GetAuthToken}));var oi,ai,ii,ci,si,di=function(e){return i.useEffect((function(){return function(e){ia=sa(e.telemetryFunctions,"ppux-shared-comments-ui/")}(e.telemetryAPIConfig),function(e){var t=e.commentAPIConfig,n=e.localizationAPIConfig,r=e.telemetryAPIConfig,o=e.peopleAPIConfig,a=e.viewContainerConfig,i=e.paneColors,c=e.webTheme,s=e.onInitializeAndMountComplete,d=o.isAtMentionsEnabled,u=function(e,t){return new Ua(e,t)}(t,!!d),l=pa(a),f=function(e){var t=new Ya(e);return Ja(Ja({},t),t.getLocaleInfo())}(n),m=function(e){return new ri(e)}(o);try{Zo(u,r,m,l,f,void 0,function(){return{AccessibilityAnnotationTarget:"true",AccessibilityDescription:"true",CommentsFluentUI:"true",DiscreteHostedComments:"true",NewCommentButton:"true",NewDraftingUI:"true",PersonaFeature:"true",CommentsFluentUIV2:"true",CommentTasks:"false",CommentTasksFromReply:"false",HyperlinksInComments:"true",HyperlinksWithDisplayText:"true",LinkToComment:"false",LivePersonaPicker:"true",LogDraftCommentIdPair:"true",NewBorderAndFocusLookInWeb:"true",NewResolvedCardDesignInWeb:"true",NoDiscardOnFocusLoss:"true",RichContentEditIntegrationInWeb:"true",RichTextFormattingInWeb:"true",SmartReplies:"false",QuillInitializationTelemetry:"false",WebThemeIntegration:"true",CtrlEnterTip:"true",AtMentionHintMessage:"true"}}(),i,c),Object(xe.b)().then((function(){Ne(),null==s||s()}))}catch(e){da().trackError("CommentsPaneView/initializeSharedComments-Error",{},e)}}(e),ui}),[]),i.createElement("div",{style:{position:"relative",height:"100%"}},i.createElement("div",{id:"ppux-shared-comments-pane",style:{position:"absolute",height:"100%"}}))};function ui(){try{$o()}catch(e){da().trackError("CommentsPaneView/disposeSharedCommentsRuntime-Error",{},e)}}function li(){if(!ii)throw new Error("The logger has not been initialized yet. Please call `initializeLogger` first");return ii}!function(e){e.PaneReady="PaneReady",e.GetAllComments="GetAllComments"}(oi||(oi={})),function(e){e.BeginPolling="BeginPolling",e.SuspendPolling="SuspendPolling",e.ChangePollingInterval="ChangePollingInterval"}(ai||(ai={}));var fi,mi,pi,hi=!1;function vi(e,t){hi=!0,yi(),function(e){si=e}(t),ci=window.setInterval(e,si)}function gi(e){hi&&(yi(),function(){if(!si)throw new Error("Polling interval has not been set.")}(),ci=window.setInterval(e,si))}function yi(){ci&&window.clearInterval(ci)}function bi(e){return(bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ci(){Ci=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),c=new P(r||[]);return o(i,"_invoke",{value:w(e,n,c)}),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="executing",p="completed",h={};function v(){}function g(){}function y(){}var b={};d(b,i,(function(){return this}));var C=Object.getPrototypeOf,T=C&&C(C(x([])));T&&T!==n&&r.call(T,i)&&(b=T);var I=y.prototype=v.prototype=Object.create(b);function S(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function n(o,a,i,c){var s=l(e[o],e,a);if("throw"!==s.type){var d=s.arg,u=d.value;return u&&"object"==bi(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){d.value=e,i(d)}),(function(e){return n("throw",e,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return a=a?a.then(o,o):o()}})}function w(t,n,r){var o=f;return function(a,i){if(o===m)throw new Error("Generator is already running");if(o===p){if("throw"===a)throw i;return{value:e,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var s=j(c,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===f)throw o=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=m;var d=l(t,n,r);if("normal"===d.type){if(o=r.done?p:"suspendedYield",d.arg===h)continue;return{value:d.arg,done:r.done}}"throw"===d.type&&(o=p,r.method="throw",r.arg=d.arg)}}}function j(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,j(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var a=l(o,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,h;var i=a.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function x(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(bi(t)+" is not iterable")}return g.prototype=y,o(I,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:g,configurable:!0}),g.displayName=d(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,d(e,s,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},S(O.prototype),d(O.prototype,c,(function(){return this})),t.AsyncIterator=O,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new O(u(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},S(I),d(I,s,"Generator"),d(I,i,(function(){return this})),d(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=x,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),d=r.call(i,"finallyLoc");if(s&&d){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:x(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),h}},t}function Ti(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function Ii(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Ti(a,r,o,i,c,"next",e)}function c(e){Ti(a,r,o,i,c,"throw",e)}i(void 0)}))}}function Si(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Si(Object(n),!0).forEach((function(t){wi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Si(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function wi(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==bi(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==bi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===bi(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ji(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],s=!0,d=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){d=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(d)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ei(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ei(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ei(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ki=!1,Pi=function(e){var t=ji(i.useState(null),2),n=t[0],r=t[1];pi=e.onCommentsPaneEvent,i.useEffect((function(){return function(e){ii=sa(e.telemetryFunctions,"ppux-shared-comments/")}(e.telemetryAPIConfig),pi(oi.GetAllComments,null,(function(t){var n=null==t?void 0:t.comments;if(!n){var o="Unable to get comments for pane initialization";throw li().trackError("CommentsPane/Initialization/GetAllComments-Error",{message:o}),new Error(o)}r({comments:n,initialContextInfo:e.getInitialViewInfo(),isPaneReadOnly:e.isReadOnly})}),(function(e){li().trackError("CommentsPane/Initialization/GetAllComments-Failed",{},e)})),yi}),[]),i.useEffect((function(){n&&(!function(e){e.setCommentsPaneEventEmitter((function(e,t,n,r){switch(e){case ai.BeginPolling:case ai.ChangePollingInterval:var o=t.pollingInterval;li().trackInfo("CommentsPane/emitterEvent",{eventName:e,pollingInterval:o}),function(e){vi(Ri(),e)}(o),null==n||n();break;case ai.SuspendPolling:li().trackInfo("CommentsPane/emitterEvent",{eventName:e}),function(){hi=!1,yi()}(),null==n||n();break;case oa.OpenPane:case oa.ClosePane:li().trackInfo("CommentsPane/emitterEvent",{eventName:e}),mi(e),null==n||n();break;default:fi(e,t,n,r)}}))}(e),fi(ga.SetInitialViewData,n,(function(){li().trackInfo("CommentsPane/Initialization/SetInitialViewData-Successful")}),(function(e){throw li().trackError("CommentsPane/Initialization/SetInitialViewData-Failed",{},e),e})))}),[n]);var o=i.useCallback((function(){pi(oi.PaneReady,null)}),[pi]);return n?i.createElement(di,Oi(Oi({},function(e){return Oi(Oi({},e),{},{commentAPIConfig:{getCurrentUser:e.getCurrentUser,setCommentAPIEventEmitter:function(e){return fi=e},onCommentAPIEvent:xi()},viewContainerConfig:{setViewContainerEventEmitter:function(e){return mi=e},onViewContainerEvent:Ai()},peopleAPIConfig:{isAtMentionsEnabled:e.isAtMentionsEnabled,onPeopleAPIEvent:Di()}})}(e)),{},{onInitializeAndMountComplete:o})):null};function xi(){return function(e,t,n,r){var o=n,a=r;e!==va.CommentDeleted&&e!==va.CommentAdded&&e!==va.CommentEdited||(ki=!0,o=function(t){null==n||n(t),ki=!1,hi&&li().trackInfo("CommentsPane/ResumingPollingAfterEventSuccess",{eventName:e}),gi(Ri())},a=function(t){null==r||r(t),ki=!1,hi&&li().trackError("CommentsPane/ResumingPollingAfterEventFailure",{eventName:e},t),gi(Ri())}),pi(e,t,o,a)}}function Ai(){return function(e){pi(e,null)}}function Di(){return function(e,t,n,r){pi(e,t,n,r)}}function Ri(){return Ii(Ci().mark((function e(){return Ci().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ki){e.next=4;break}return li().trackInfo("CommentsPane/pollForCommentUpdates/StopPollingAndshouldDisregardPollingResult",{event:oi.GetAllComments}),yi(),e.abrupt("return");case 4:pi(oi.GetAllComments,null,(function(e){var t=null==e?void 0:e.comments;if(!t){throw li().trackError("CommentsPane/pollForCommentUpdates/GetAllComments-Error",{message:"Unable to get latest comment updates"}),new Error("Unable to get latest comment updates")}fi(ga.LoadComments,{comments:t},(function(){if(ki)return li().trackInfo("CommentsPane/pollForCommentUpdates/StopPollingAndshouldDisregardPollingResult",{event:ga.LoadComments}),void yi()}),(function(e){li().trackError("CommentsPane/pollForCommentUpdates/LoadCommentsAfterPolling-Failed",{},e)}))}),(function(e){li().trackError("CommentsPane/pollForCommentUpdates/GetAllComments-Failure",{},e)}));case 5:case"end":return e.stop()}}),e)})))}var Fi=n(654),Ni=n.n(Fi),Mi=n(1455),Li=n.n(Mi),Bi=n(132),Vi=n(151),Ui=n(107),_i=n(596);function Hi(e){return(Hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,qi(r.key),r)}}function qi(e){var t=function(e,t){if("object"!==Hi(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Hi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Hi(t)?t:String(t)}var zi,Wi,Yi=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.comments={}}return function(e,t,n){t&&Gi(e.prototype,t),n&&Gi(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"addComment",value:function(e){this.comments[e.commentid]=e}},{key:"updateComment",value:function(e){var t,n=this.getComment(e.commentId);n&&(n.body=null!==(t=e.body)&&void 0!==t?t:n.body,n.state=e.state)}},{key:"getComment",value:function(e){return this.comments[e]}},{key:"deleteComment",value:function(e){delete this.comments[e]}}]),e}();function Ki(e){return(Ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xi(Object(n),!0).forEach((function(t){ac(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ji(){Ji=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),c=new P(r||[]);return o(i,"_invoke",{value:w(e,n,c)}),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="executing",p="completed",h={};function v(){}function g(){}function y(){}var b={};d(b,i,(function(){return this}));var C=Object.getPrototypeOf,T=C&&C(C(x([])));T&&T!==n&&r.call(T,i)&&(b=T);var I=y.prototype=v.prototype=Object.create(b);function S(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function n(o,a,i,c){var s=l(e[o],e,a);if("throw"!==s.type){var d=s.arg,u=d.value;return u&&"object"==Ki(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){d.value=e,i(d)}),(function(e){return n("throw",e,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return a=a?a.then(o,o):o()}})}function w(t,n,r){var o=f;return function(a,i){if(o===m)throw new Error("Generator is already running");if(o===p){if("throw"===a)throw i;return{value:e,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var s=j(c,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===f)throw o=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=m;var d=l(t,n,r);if("normal"===d.type){if(o=r.done?p:"suspendedYield",d.arg===h)continue;return{value:d.arg,done:r.done}}"throw"===d.type&&(o=p,r.method="throw",r.arg=d.arg)}}}function j(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,j(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var a=l(o,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,h;var i=a.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function x(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(Ki(t)+" is not iterable")}return g.prototype=y,o(I,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:g,configurable:!0}),g.displayName=d(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,d(e,s,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},S(O.prototype),d(O.prototype,c,(function(){return this})),t.AsyncIterator=O,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new O(u(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},S(I),d(I,s,"Generator"),d(I,i,(function(){return this})),d(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=x,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),d=r.call(i,"finallyLoc");if(s&&d){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:x(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),h}},t}function Zi(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function $i(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Zi(a,r,o,i,c,"next",e)}function c(e){Zi(a,r,o,i,c,"throw",e)}i(void 0)}))}}function ec(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ic(r.key),r)}}function tc(e,t){return(tc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function nc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=oc(e);if(t){var o=oc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return rc(this,n)}}function rc(e,t){if(t&&("object"===Ki(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function oc(e){return(oc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ac(e,t,n){return(t=ic(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ic(e){var t=function(e,t){if("object"!==Ki(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Ki(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Ki(t)?t:String(t)}var cc=(ac(zi={},E.ModernAppDesigner,"appmodules"),ac(zi,E.Bot,"botcomponents"),ac(zi,E.CanvasApp,"canvasapps"),ac(zi,E.PowerPageSite,"powerpagesites"),zi),sc=(ac(Wi={},E.ModernAppDesigner,"AppModule"),ac(Wi,E.Bot,"BotComponent"),ac(Wi,E.CanvasApp,"CanvasApp"),ac(Wi,E.PowerPageSite,"PowerPageSite"),Wi),dc=function(e){return e?e.substring(e.indexOf("(")+1,e.length-1):e},uc=function(e,t){try{return e?Ta(e).map((function(e){return e.email})):[]}catch(e){return null==t||t.progress({message:"Can not extract mentions"}),[]}},lc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tc(e,t)}(n,e);var t=nc(n);function n(e,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(o=t.call(this,e,"comments")).stopLoggingContainerNotFound=!1,o.commentStore=new Yi,o.telemetryService=r,o}return function(e,t,n){t&&ec(e.prototype,t),n&&ec(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"getContainer",value:function(){var e=$i(Ji().mark((function e(t,n){var o;return Ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.requestor.makeRequestAsync({service:Vi.a.cds,path:"".concat(this.entityPath,"(artifactid='").concat(t,"',artifacttype=").concat(n,")?$select=commentid"),method:Bi.a.Get,headers:{Prefer:'odata.include-annotations="*"'},responseType:"json"});case 3:return o=e.sent,e.abrupt("return",{commentid:o.body.commentid});case 7:if(e.prev=7,e.t0=e.catch(0),!u(e.t0)||404!==e.t0.status||e.t0.body.error.code!==r.RecordNotFoundByEntityKey){e.next=13;break}return this.stopLoggingContainerNotFound||this.telemetryService.trackWarning("comment container for artifact ".concat(t," not found.")),this.stopLoggingContainerNotFound=!0,e.abrupt("return",null);case 13:throw this.telemetryService.trackError(JSON.stringify(Object(f.a)(e.t0))),e.t0;case 15:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createContainer",value:function(){var e=$i(Ji().mark((function e(t,n,r,o){var a,i,c;return Ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.telemetryService.createScenarioTracker(R.CreateContainerComment,Ui.a.Create,{artifactId:t,artifactType:n}),e.prev=1,i={kind:S.Container,"ownerid@odata.bind":o?"/systemusers(".concat(o,")"):void 0,artifactid:t,artifacttype:n},sc[n]&&(i["".concat(sc[n],"@odata.bind")]=r?"/".concat(cc[n],"(").concat(t,")"):void 0),e.next=6,this.requestor.makeRequestAsync({service:Vi.a.cds,path:this.entityPath,method:Bi.a.Post,headers:{"Content-Type":"application/json"},body:JSON.stringify(i),responseType:"text"},a);case 6:return c=e.sent,this.stopLoggingContainerNotFound=!1,a.complete(),e.abrupt("return",{commentid:dc(c.headers["odata-entityid"])});case 12:throw e.prev=12,e.t0=e.catch(1),a.failure(Object(f.a)(e.t0)),e.t0;case 16:case"end":return e.stop()}}),e,this,[[1,12]])})));return function(t,n,r,o){return e.apply(this,arguments)}}()},{key:"getComments",value:function(){var e=$i(Ji().mark((function e(t){var n,r,o,a,i=this;return Ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=["createdon","modifiedon","commentid","kind","body","anchor","artifactid","artifacttype","_parent_value","_container_value","statecode","statuscode","state"],r=["internalemailaddress","fullname","azureactivedirectoryobjectid"],o=this.telemetryService.createScenarioTracker(R.GetComments,Ui.a.Load,{containerId:t}),e.prev=3,e.next=6,this.requestor.makeRequestAsync({service:Vi.a.cds,path:"".concat(this.entityPath,"(").concat(t,")/Comment_Container_Comment?$select=").concat(n.join(","),"&$expand=createdby($select=").concat(r.join(","),")"),method:Bi.a.Get,responseType:"json"},o);case 6:return(a=e.sent).body.value.forEach((function(e){return i.commentStore.addComment(Qi(Qi({},e),{},{"Parent@odata.bind":e._parent_value,"Container@odata.bind":e._container_value}))})),o.complete(),e.abrupt("return",a.body.value);case 12:throw e.prev=12,e.t0=e.catch(3),o.failure(Object(f.a)(e.t0)),e.t0;case 16:case"end":return e.stop()}}),e,this,[[3,12]])})));return function(t){return e.apply(this,arguments)}}()},{key:"createComment",value:function(){var e=$i(Ji().mark((function e(t,n,r){var o,a,i,c,s;return Ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.telemetryService.createScenarioTracker(R.CreateComment,Ui.a.Create),e.prev=1,a="",i=uc(t.body),""!==n&&(i.length>0||t.kind===S.Reply)&&(a="?tag=".concat(escape(JSON.stringify({schema:"EmailTagV1",commentLink:n,artifactDisplayName:r})))),e.next=7,this.requestor.makeRequestAsync({service:Vi.a.cds,path:"".concat(this.entityPath).concat(a),method:Bi.a.Post,headers:{"Content-Type":"application/json"},body:JSON.stringify(t),responseType:"text"},o);case 7:return c=e.sent,s=dc(c.headers["odata-entityid"]),this.commentStore.addComment(Qi(Qi({},t),{},{commentid:s})),o.complete(),e.abrupt("return",s);case 14:throw e.prev=14,e.t0=e.catch(1),o.failure(Object(f.a)(e.t0)),e.t0;case 18:case"end":return e.stop()}}),e,this,[[1,14]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"updateComment",value:function(){var e=$i(Ji().mark((function e(t,n,r){var o,a,i,c,s,d,u;return Ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.commentId,a=t.body,i=this.telemetryService.createScenarioTracker(R.UpdateComment,Ui.a.Update,{commentId:o}),e.prev=2,c=this.commentStore.getComment(o),s="",""!==n&&(null==c?void 0:c.body)!==a&&(d=Ni()(uc(null==c?void 0:c.body)),u=Ni()(uc(a)),Li()(d,u).length>0&&(s="?tag=".concat(escape(JSON.stringify({schema:"EmailTagV1",commentLink:n,artifactDisplayName:r}))))),e.next=8,this.requestor.makeRequestAsync({service:Vi.a.cds,path:"".concat(this.entityPath,"(").concat(o,")").concat(s),method:Bi.a.Patch,headers:{"Content-Type":"application/json","If-Match":"*"},body:JSON.stringify({body:(null==c?void 0:c.body)!==a?a:void 0,state:(null==c?void 0:c.state)!==t.state?t.state:void 0}),responseType:"text"},i);case 8:this.commentStore.updateComment(t),i.complete(),e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(2),i.failure(Object(f.a)(e.t0)),e.t0;case 16:case"end":return e.stop()}}),e,this,[[2,12]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"deleteComment",value:function(){var e=$i(Ji().mark((function e(t){var n;return Ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.telemetryService.createScenarioTracker(R.DeleteComment,Ui.a.Delete,{commentId:t}),e.prev=1,e.next=4,this.requestor.makeRequestAsync({service:Vi.a.cds,path:"".concat(this.entityPath,"(").concat(t,")"),method:Bi.a.Delete,headers:{"Content-Type":"application/json"},responseType:"text"},n);case 4:this.commentStore.deleteComment(t),n.complete(),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(1),n.failure(Object(f.a)(e.t0)),e.t0;case 12:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"deactivateComment",value:function(){var e=$i(Ji().mark((function e(t){var n;return Ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.telemetryService.createScenarioTracker(R.DeactivateComment,Ui.a.Update,{commentId:t}),e.prev=1,e.next=4,this.requestor.makeRequestAsync({service:Vi.a.cds,path:"".concat(this.entityPath,"(").concat(t,")"),method:Bi.a.Patch,headers:{"Content-Type":"application/json","If-Match":"*"},body:JSON.stringify({statecode:P.Inactive,statuscode:k.Inactive}),responseType:"text"},n);case 4:n.complete(),e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(1),n.failure(Object(f.a)(e.t0)),e.t0;case 11:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"activateComment",value:function(){var e=$i(Ji().mark((function e(t){var n;return Ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.telemetryService.createScenarioTracker(R.ActivateComment,Ui.a.Update,{commentId:t}),e.prev=1,e.next=4,this.requestor.makeRequestAsync({service:Vi.a.cds,path:"".concat(this.entityPath,"(").concat(t,")"),method:Bi.a.Patch,headers:{"Content-Type":"application/json","If-Match":"*"},body:JSON.stringify({statecode:P.Active,statuscode:k.Active}),responseType:"text"},n);case 4:n.complete(),e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(1),n.failure(Object(f.a)(e.t0)),e.t0;case 11:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()}]),n}(_i.a);function fc(e,t,n){if(!e||!t)return e===t;var r=e.keys(),o=t.keys(),a=e.values(),i=t.values();return mc(r,o,(function(e,t){return e===t}))&&mc(a,i,n)}function mc(e,t,n){for(var r=e.next(),o=t.next();!r.done&&!o.done;){if(!n(r.value,o.value))return!1;r=e.next(),o=t.next()}return!(!r.done||!o.done)}function pc(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function hc(e){for(var t=[],n=e.next();!n.done;)t.push(n.value),n=e.next();return t}function vc(e){return function(e){if(Array.isArray(e))return yc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||gc(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gc(e,t){if(e){if("string"==typeof e)return yc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yc(e,t):void 0}}function yc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function bc(e){var t=Object(i.useRef)();return Object(i.useEffect)((function(){var n,r=new Map,o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=gc(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}(e);try{for(o.s();!(n=o.n()).done;){var a=n.value;r.set(a[0],vc(a[1]))}}catch(e){o.e(e)}finally{o.f()}t.current=r})),t.current}var Cc,Tc=c.a.createContext({}),Ic=function(){return c.a.useContext(Tc)},Sc=function(e){return Object(a.mergeStyles)({height:"100%",width:e.isPaneOpen?293:0,selectors:{"#NewCommentButton .ms-Button-icon":{boxSizing:"unset"},"#ppux-shared-comments-pane > div > div > div:nth-child(2)":e.paneStyles?e.paneStyles:{background:e.theme.palette.neutralLighter,borderLeft:"1px solid ".concat(e.theme.palette.neutralLight),borderRight:"1px solid ".concat(e.theme.palette.neutralLight)},"#ppux-shared-comments-pane > div > div > div:nth-child(2) > div:nth-child(2)":{flex:"0 1 0%"}}})};function Oc(e){return(Oc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wc(Object(n),!0).forEach((function(t){Ec(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ec(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Oc(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Oc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Oc(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.Success="Success",e.CannotGrantPermission="CannotGrantPermission",e.UserDoesNotExist="UserDoesNotExist",e.Failed="Failed"}(Cc||(Cc={}));var kc=function(e,t,n,r){return n.map((function(n){return{anchorId:n.anchor,date:new Date(n.createdon),author:{Provider:"O365",UserId:n.createdby.azureactivedirectoryobjectid,DisplayName:n.createdby.fullname,Email:n.createdby.azureactivedirectoryobjectid,IsCurrentUser:e(n.createdby)},commentBody:n.body,commentId:n.commentid,parentId:n._parent_value===t?"":n._parent_value,commentFlags:Ac(n.state===O.Resolved?Be.f.Resolved:Be.f.None,r)}}))},Pc=function(e,t){return{"Container@odata.bind":"/comments(".concat(e,")"),"Parent@odata.bind":t.parentId?"/comments(".concat(t.parentId,")"):"/comments(".concat(e,")"),anchor:t.anchorId,body:t.commentBody,kind:t.parentId?S.Reply:S.Thread,state:O.Open}},xc=function(e,t){var n={state:(e.commentFlags&Be.f.Resolved)===Be.f.Resolved?O.Resolved:O.Open,commentId:e.commentId};return t(e.author)?jc(jc({},n),{},{body:e.commentBody}):n},Ac=function(e,t){return t.delete||(e|=Be.f.DeleteRestricted),t.write||(e|=Be.f.ReadOnly),e};function Dc(e){return(Dc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rc(Object(n),!0).forEach((function(t){Nc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Nc(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Dc(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Dc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Dc(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Mc(){Mc=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),c=new P(r||[]);return o(i,"_invoke",{value:w(e,n,c)}),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="executing",p="completed",h={};function v(){}function g(){}function y(){}var b={};d(b,i,(function(){return this}));var C=Object.getPrototypeOf,T=C&&C(C(x([])));T&&T!==n&&r.call(T,i)&&(b=T);var I=y.prototype=v.prototype=Object.create(b);function S(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function n(o,a,i,c){var s=l(e[o],e,a);if("throw"!==s.type){var d=s.arg,u=d.value;return u&&"object"==Dc(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){d.value=e,i(d)}),(function(e){return n("throw",e,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return a=a?a.then(o,o):o()}})}function w(t,n,r){var o=f;return function(a,i){if(o===m)throw new Error("Generator is already running");if(o===p){if("throw"===a)throw i;return{value:e,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var s=j(c,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===f)throw o=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=m;var d=l(t,n,r);if("normal"===d.type){if(o=r.done?p:"suspendedYield",d.arg===h)continue;return{value:d.arg,done:r.done}}"throw"===d.type&&(o=p,r.method="throw",r.arg=d.arg)}}}function j(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,j(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var a=l(o,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,h;var i=a.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function x(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(Dc(t)+" is not iterable")}return g.prototype=y,o(I,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:g,configurable:!0}),g.displayName=d(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,d(e,s,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},S(O.prototype),d(O.prototype,c,(function(){return this})),t.AsyncIterator=O,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new O(u(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},S(I),d(I,s,"Generator"),d(I,i,(function(){return this})),d(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=x,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),d=r.call(i,"finallyLoc");if(s&&d){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:x(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),h}},t}function Lc(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function Bc(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Lc(a,r,o,i,c,"next",e)}function c(e){Lc(a,r,o,i,c,"throw",e)}i(void 0)}))}}var Vc=function(e,t){return e.map((function(e){var n;return null!==(n=t.find((function(t){return t.userPrincipalName===e.userPrincipalName})))&&void 0!==n?n:{status:Cc.UserDoesNotExist,userPrincipalName:e.userPrincipalName}})).filter((function(e){return e.status!==Cc.Success}))},Uc=function(e){var t={};return e.filter((function(e){var n=t[e.userPrincipalName];return t[e.userPrincipalName]=!0,!n}))},_c=function(){var e=Bc(Mc().mark((function e(t,n,r,o,a){var i,c,s,d,u,l,f,m,p,h,v,y;return Mc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=n.createScenarioTracker(R.CheckAndGrantUerPermissions),t.checkUsersAccess){e.next=7;break}return l=g(new Error("Feature is not enabled"),A.FeatureNotEnabled),a(l),null===(i=t.onError)||void 0===i||i.call(t,l),u.failure(l),e.abrupt("return",l);case 7:return f=Uc(r.users.map((function(e){return{userPrincipalName:e.email}}))),e.prev=8,e.next=11,t.checkUsersAccess(f,u);case 11:if(m=e.sent,!((p=Vc(f,m)).length>0)){e.next=25;break}if(!t.grantUsersAccess){e.next=19;break}return e.next=17,null===(c=t.grantUsersAccess)||void 0===c?void 0:c.call(t,p,u);case 17:h=e.sent,p=Vc(p,h);case 19:if(!(p.length>0)){e.next=25;break}return v=g(new Error("Grant access was not successful for all users."),A.MentionedUserWithoutAccess),a(v),null===(s=t.onError)||void 0===s||s.call(t,v),u.completeWithWarning(v),e.abrupt("return",v);case 25:u.complete(),o({areUsersAllowedInMentions:!0}),e.next=36;break;case 29:return e.prev=29,e.t0=e.catch(8),y=g(e.t0,A.MentionedUserWithoutAccess),a(y),null===(d=t.onError)||void 0===d||d.call(t,y),u.completeWithWarning(y),e.abrupt("return",y);case 36:case"end":return e.stop()}}),e,null,[[8,29]])})));return function(t,n,r,o,a){return e.apply(this,arguments)}}(),Hc=function(){var e=Bc(Mc().mark((function e(t,n,o,a,i,c,s,d){var l,m,p,h,v,y,b,C,T,I,S;return Mc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y=a?void 0:o.createScenarioTracker(R.CommentAdded),e.prev=1,a){e.next=32;break}return e.prev=3,null==y||y.progress({message:"Attempting to get additional properties"}),e.next=7,null===(l=t.onBeforeCommentContainerCreated)||void 0===l?void 0:l.call(t);case 7:return b=e.sent,null==y||y.progress({message:"Attempting to create container comment",ownerId:null==b?void 0:b.ownerId}),e.next=11,n.createContainer(t.artifactId,t.artifactType,t.isArtifactInDataVerse,null==b?void 0:b.ownerId);case 11:return C=e.sent,a=C.commentid,null==y||y.progress({message:"Container comment created, notifying host"}),e.next=16,i(a);case 16:e.next=32;break;case 18:if(e.prev=18,e.t0=e.catch(3),!u(e.t0)||e.t0.body.error.code!==r.DuplicateRecordEntityKey){e.next=30;break}return null==y||y.progress({message:"Container creation failed with DuplicateRecordEntityKey error, trying to get container"}),e.next=24,n.getContainer(t.artifactId,t.artifactType);case 24:if(T=e.sent,a=null==T?void 0:T.commentid){e.next=28;break}throw new Error("Container not found, failing comment creation");case 28:e.next=31;break;case 30:throw e.t0;case 31:null==y||y.progress({message:"Got container successfully"});case 32:return null==y||y.progress({message:"Creating comment"}),e.next=35,n.createComment(Pc(a,c.comment),null===(m=t.getCommentDeepLinkTemplate)||void 0===m?void 0:m.call(t,"{commentId}",c.comment.anchorId),t.artifactDisplayName);case 35:return I=e.sent,null==y||y.progress({message:"Created comment, notifying host"}),S={comment:Fc(Fc({},c.comment),{},{commentId:I,commentFlags:Ac(c.comment.commentFlags,t.userPrivileges)})},e.next=40,null===(p=t.onCommentCreated)||void 0===p?void 0:p.call(t);case 40:s(S),null==y||y.complete(),e.next=49;break;case 44:e.prev=44,e.t1=e.catch(1),null==y||y.failure(Object(f.a)(e.t1)),u(e.t1)&&e.t1.body.error.code===r.MissingPrivilege?null===(h=t.onError)||void 0===h||h.call(t,g(e.t1,A.MissingCreatePermission)):null===(v=t.onError)||void 0===v||v.call(t,g(e.t1,A.GenericError)),d(new Error("Failed to create comment"));case 49:case"end":return e.stop()}}),e,null,[[1,44],[3,18]])})));return function(t,n,r,o,a,i,c,s){return e.apply(this,arguments)}}(),Gc=function(){var e=Bc(Mc().mark((function e(t,n,o,a,i,c){var s,d,l;return Mc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.updateComment(xc(a.comment,o),null===(s=t.getCommentDeepLinkTemplate)||void 0===s?void 0:s.call(t,"{commentId}",a.comment.anchorId),t.artifactDisplayName);case 3:i(),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),u(e.t0)&&e.t0.body.error.code===r.MissingPrivilege?null===(d=t.onError)||void 0===d||d.call(t,g(e.t0,A.MissingWritePermission)):null===(l=t.onError)||void 0===l||l.call(t,g(e.t0,A.GenericError)),c(new Error("Failed to update comment"));case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,n,r,o,a,i){return e.apply(this,arguments)}}(),qc=function(){var e=Bc(Mc().mark((function e(t,n,o,a,i){var c,s,d;return Mc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=o.commentId,e.prev=1,e.next=4,n.deactivateComment(d);case 4:a(),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),u(e.t0)&&e.t0.body.error.code===r.MissingPrivilege?null===(c=t.onError)||void 0===c||c.call(t,g(e.t0,A.MissingDeletePermission)):null===(s=t.onError)||void 0===s||s.call(t,g(e.t0,A.GenericError)),i(new Error("Failed to delete comment"));case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n,r,o,a){return e.apply(this,arguments)}}(),zc=function(){var e=Bc(Mc().mark((function e(t,n,o,a,i,c,s,d){var u,f,m;return Mc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o||!s){e.next=7;break}return e.next=4,n.getContainer(t.artifactId,t.artifactType);case 4:f=e.sent,(o=null==f?void 0:f.commentid)&&d(o);case 7:if(!o){e.next=14;break}return e.next=10,n.getComments(o);case 10:m=e.sent,i({comments:kc(a,o,m.filter((function(e){return e.statecode===P.Active&&e.statuscode===k.Active})),t.userPrivileges)}),e.next=15;break;case 14:i({comments:[]});case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(0),(l(e.t0,r.unManagedIdsAccessDenied)||l(e.t0,r.UserNotAssignedRoles)||l(e.t0,r.MissingPrivilege))&&(null===(u=t.onError)||void 0===u||u.call(t,g(e.t0,A.MissingReadPermission))),c(new Error("Failed to get comments"));case 21:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t,n,r,o,a,i,c,s){return e.apply(this,arguments)}}();function Wc(e){return(Wc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yc(){Yc=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),c=new P(r||[]);return o(i,"_invoke",{value:w(e,n,c)}),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="executing",p="completed",h={};function v(){}function g(){}function y(){}var b={};d(b,i,(function(){return this}));var C=Object.getPrototypeOf,T=C&&C(C(x([])));T&&T!==n&&r.call(T,i)&&(b=T);var I=y.prototype=v.prototype=Object.create(b);function S(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function n(o,a,i,c){var s=l(e[o],e,a);if("throw"!==s.type){var d=s.arg,u=d.value;return u&&"object"==Wc(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){d.value=e,i(d)}),(function(e){return n("throw",e,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return a=a?a.then(o,o):o()}})}function w(t,n,r){var o=f;return function(a,i){if(o===m)throw new Error("Generator is already running");if(o===p){if("throw"===a)throw i;return{value:e,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var s=j(c,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===f)throw o=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=m;var d=l(t,n,r);if("normal"===d.type){if(o=r.done?p:"suspendedYield",d.arg===h)continue;return{value:d.arg,done:r.done}}"throw"===d.type&&(o=p,r.method="throw",r.arg=d.arg)}}}function j(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,j(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var a=l(o,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,h;var i=a.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function x(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(Wc(t)+" is not iterable")}return g.prototype=y,o(I,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:g,configurable:!0}),g.displayName=d(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,d(e,s,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},S(O.prototype),d(O.prototype,c,(function(){return this})),t.AsyncIterator=O,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new O(u(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},S(I),d(I,s,"Generator"),d(I,i,(function(){return this})),d(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=x,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),d=r.call(i,"finallyLoc");if(s&&d){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:x(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),h}},t}function Kc(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function Xc(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Kc(a,r,o,i,c,"next",e)}function c(e){Kc(a,r,o,i,c,"throw",e)}i(void 0)}))}}function Qc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],s=!0,d=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){d=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(d)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Jc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jc(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Zc,$c=function(e){var t,n,r,d,u=Ic().commentsService,l=Object(s.b)().telemetryService,m=Object(i.useRef)(e);m.current=e;var p=Object(a.useTheme)(),h=Object(i.useRef)(),v=Qc(Object(i.useState)(!1),2),y=v[0],b=v[1],C=Qc(Object(i.useState)(e.containerId),2),T=C[0],I=C[1],S=Qc(Object(i.useState)(),2),O=S[0],j=S[1],E=Qc(Object(i.useState)(!1),2),k=E[0],P=E[1],x=Qc(Object(i.useState)(!1),2),R=x[0],F=x[1],N=Qc(Object(i.useState)(!1),2),M=N[0],L=N[1],B=Qc(Object(i.useState)(null!==(t=e.pollingInterval)&&void 0!==t?t:1e4),2),V=B[0],U=B[1],_=c.a.useRef(new Map),H=Object(i.useRef)((function(){}));H.current=Object(i.useCallback)((function(){var t;y&&(null===(t=h.current)||void 0===t||t.call(h,ga.GetUnresolvedThreadCountsForAnchors,null,(function(t){var n;(function(e,t,n){var r=hc(e.keys());if(!pc(r,hc(t.keys())))return!1;for(var o=0;o<r.length;o++)if(!n(e.get(r[o]),t.get(r[o])))return!1;return!0})(_.current,t.anchorThreadCountMap,(function(e,t){return e===t}))||(null===(n=e.onAnchorThreadCountsMapUpdated)||void 0===n||n.call(e,t.anchorThreadCountMap),_.current=t.anchorThreadCountMap)})))}),[y]),Object(i.useEffect)((function(){h.current&&y&&(e.isCommentsPaneOpen?(h.current(oa.OpenPane,null),l.trackInfo(D.CommentsPaneOpen)):(h.current(oa.ClosePane,null),l.trackInfo(D.CommentsPaneClose)))}),[e.isCommentsPaneOpen,y]);var G=Object(o.a)(e.activeContextId),q=bc(e.contexts);Object(i.useEffect)((function(){var t=G!==e.activeContextId||!fc(q,e.contexts,pc);!t||y&&h.current||F(!0),y&&(t||R)&&h.current&&(h.current(ga.ContextViewDataChanged,{activeContextId:e.activeContextId,contextWidgetAnchorMap:e.contexts}),R&&F(!1))}),[e.activeContextId,e.contexts,y]),Object(i.useEffect)((function(){q&&!fc(q,e.contexts,pc)&&H.current()}),[e.contexts]),Object(i.useEffect)((function(){var t;h.current&&e.isCommentsPaneOpen&&y&&O!==e.selectedAnchor&&((null===(t=e.featureGates)||void 0===t?void 0:t.clearSelectionForAnchorWithoutComments)&&h.current(ga.DeselectThread,null),h.current(ga.SelectFirstThreadRelatedToAnchor,{anchorId:e.selectedAnchor}),e.selectedCommentId&&!k&&(h.current(ga.SelectComment,{commentId:e.selectedCommentId}),P(!0),l.trackInfo(D.AtMentionsCommentSelected)),j(e.selectedAnchor))}),[e.selectedAnchor,e.isCommentsPaneOpen,y]),Object(i.useEffect)((function(){var t,n;if(y&&(null===(t=e.featureGates)||void 0===t?void 0:t.enablePolling)&&h.current){var r=e.pollingInterval!==V,o=null!==(n=e.pollingInterval)&&void 0!==n?n:V;return e.pollComments&&!M?(h.current(ai.BeginPolling,{pollingInterval:o}),L(!0),U(o)):e.pollComments&&M&&r?(h.current(ai.ChangePollingInterval,{pollingInterval:o}),U(o)):!e.pollComments&&M&&(h.current(ai.SuspendPolling,null),L(!1)),function(){h.current&&M&&(h.current(ai.SuspendPolling,null),L(!1))}}}),[y,null===(n=e.featureGates)||void 0===n?void 0:n.enablePolling,e.pollingInterval,e.pollComments]),Object(i.useEffect)((function(){H.current()}),[y]);var z=Object(i.useCallback)((function(e){var t,n,r;switch(e){case w.CreateThread:null===(t=null==h?void 0:h.current)||void 0===t||t.call(h,ga.CreateThread,null);break;case w.DeleteOrphanedComments:null===(n=null==h?void 0:h.current)||void 0===n||n.call(h,ga.GetOrphanedComments,null,(function(e){var t,n=e;null===(t=null==n?void 0:n.comments)||void 0===t||t.forEach((function(e){return u.deactivateComment(e.commentId)}))}));break;case w.DeselectThread:null===(r=null==h?void 0:h.current)||void 0===r||r.call(h,ga.DeselectThread,null)}}),[]);Object(i.useEffect)((function(){var t;y&&(e.eventDispatcherProvider&&e.eventDispatcherProvider(z),null===(t=e.onPaneLoaded)||void 0===t||t.call(e,!1))}),[y]);var W={userId:e.userInfo.azureActiveDirectoryObjectId,displayName:e.userInfo.displayName};return c.a.createElement(a.Stack.Item,{className:Sc({isPaneOpen:e.isCommentsPaneOpen,theme:p,paneStyles:null===(r=e.styles)||void 0===r?void 0:r.pane})},c.a.createElement(Pi,{isAtMentionsEnabled:(null===(d=e.featureGates)||void 0===d?void 0:d.isAtMentionsEnabled)&&!!e.getAuthToken,getCurrentUser:function(){return W},getInitialViewInfo:function(){return{activeContextId:e.activeContextId,contextWidgetAnchorMap:e.contexts}},isReadOnly:!e.userPrivileges.create&&!e.userPrivileges.write&&!e.userPrivileges.delete,localizationAPIConfig:{isRTL:e.localization.isRTL,currentLocale:e.localization.currentLocale,localizedStrings:e.localization.strings},setCommentsPaneEventEmitter:function(e){return h.current=e},onCommentsPaneEvent:function(){var e=Xc(Yc().mark((function e(t,n,r,o){var a,i,c,s,d,p,h;return Yc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t!==oi.GetAllComments&&l.trackInfo(D.CommentsPaneEventReceived,{eventName:t}),e.prev=1,e.t0=t,e.next=e.t0===oi.PaneReady?5:e.t0===va.ThreadSelected?7:e.t0===aa.PaneClosed?11:e.t0===va.GetCurrentlySelectedAnchorId?13:e.t0===oi.GetAllComments?15:e.t0===va.CommentAdded?19:e.t0===va.CommentEdited?23:e.t0===va.CommentDeleted?27:e.t0===Wa.GetAuthToken?31:e.t0===Wa.CheckMentions?43:46;break;case 5:return b(!0),e.abrupt("break",47);case 7:return p=n.anchorId,null===(i=(a=m.current).onThreadSelected)||void 0===i||i.call(a,p),j(p),e.abrupt("break",47);case 11:return m.current.onDismiss(),e.abrupt("break",47);case 13:return r({anchorId:null!==(c=m.current.selectedAnchor)&&void 0!==c?c:m.current.activeContextId}),e.abrupt("break",47);case 15:return e.next=17,zc(m.current,u,T,(function(e){return W.userId===e.azureactivedirectoryobjectid}),r,o,M,(function(e){return I(e)}));case 17:return H.current(),e.abrupt("break",47);case 19:return e.next=21,Hc(m.current,u,l,T,function(){var e=Xc(Yc().mark((function e(t){var n,r;return Yc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I(t),e.next=3,null===(r=(n=m.current).onCommentContainerCreated)||void 0===r?void 0:r.call(n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n,r,o);case 21:return H.current(),e.abrupt("break",47);case 23:return e.next=25,Gc(m.current,u,(function(e){return e.UserId===W.userId}),n,r,o);case 25:return H.current(),e.abrupt("break",47);case 27:return e.next=29,qc(m.current,u,n,r,o);case 29:return H.current(),e.abrupt("break",47);case 31:if(e.prev=31,!m.current.getAuthToken){e.next=37;break}return e.next=35,m.current.getAuthToken(n.lokiResource);case 35:h=e.sent,r({token:h});case 37:e.next=42;break;case 39:e.prev=39,e.t1=e.catch(31),o(e.t1);case 42:return e.abrupt("break",47);case 43:return e.next=45,_c(m.current,l,n,r,o);case 45:case 46:return e.abrupt("break",47);case 47:e.next=53;break;case 49:e.prev=49,e.t2=e.catch(1),l.trackError(D.CommentsPaneError,Object(f.a)(e.t2)),null===(d=(s=m.current).onError)||void 0===d||d.call(s,g(e.t2,A.GenericError));case 53:case"end":return e.stop()}}),e,null,[[1,49],[31,39]])})));return function(t,n,r,o){return e.apply(this,arguments)}}(),telemetryAPIConfig:{telemetryFunctions:l,appName:"dataverse-comments-pane",appVersion:"1.0.0",releaseAudience:"internal",releaseChannel:"test",sessionId:"",sovereignEnvironmentName:e.sovereignEnvironmentName},paneColors:{primary:p.palette.themePrimary,shade10:p.palette.themeDark,shade20:p.palette.themeDarker,shade30:p.palette.themeDarkAlt,tint10:p.palette.themeLight,tint20:p.palette.themeLighter,tint30:p.palette.themeLighterAlt,tint40:p.palette.themeSecondary},webTheme:{getThemeMode:function(){return m.current.isDarkMode?1:0}}}))},es=function(){return i.createElement("svg",{width:"48",height:"48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i.createElement("path",{d:"M5 47V35h4a6 6 0 010 12H5zM4 44H1m3-6H1M43 1v12h-4a6 6 0 010-12h4zM44 4h3m-3 6h3",stroke:"#742774","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),i.createElement("path",{d:"M5 30V7h28M43 18v23H15",stroke:"#742774","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),i.createElement("circle",{cx:"18",cy:"24",r:"2",fill:"#742774"}),i.createElement("circle",{cx:"24",cy:"24",r:"2",fill:"#742774"}),i.createElement("circle",{cx:"30",cy:"24",r:"2",fill:"#742774"}))},ts=function(e){var t=e.errorMessage;return c.a.createElement(a.Stack,{horizontalAlign:"center",verticalAlign:"center",style:{height:"100%"},tokens:{childrenGap:25}},c.a.createElement(es,null),c.a.createElement(a.Text,{role:"status","aria-live":"assertive","aria-label":t,styles:{root:{fontSize:a.FontSizes.size14,fontWeight:a.FontWeights.semibold,textAlign:"center"}}},t))},ns=n(426),rs=function(e){var t=e.isOpen,n=e.onDismiss,r=e.strings,o=e.children,s=e.rootPaneStyles,d=Object(a.useTheme)(),u=c.a.useRef(null);return Object(i.useEffect)((function(){t&&u.current&&u.current.focus(!0)}),[t]),c.a.createElement(a.FocusZone,{direction:a.FocusZoneDirection.vertical,componentRef:u},c.a.createElement(ns.a,{"aria-label":r.header,isOpen:t,onDismiss:n,hasCloseButton:!0,closeButtonAriaLabel:r.close,headerText:r.header,styles:{root:s||{background:d.palette.neutralLighter,width:293,minWidth:293},scrollableContent:{height:"100%"},content:{height:"100%",boxSizing:"border-box",paddingBottom:20},headerText:{fontSize:a.FontSizes.size16},header:{paddingLeft:8}}},o))},os=function(e){var t=e.strings;return c.a.createElement(a.Stack,{verticalAlign:"center",horizontalAlign:"center",styles:{root:{height:"100%"}}},c.a.createElement(a.Spinner,{size:a.SpinnerSize.large,ariaLabel:t.loadingTooltip,ariaLive:"assertive"}))},as=function(){return i.createElement("img",{style:{width:"100%"},src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQoAAAB8CAYAAACRx/6hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAFi3SURBVHgB7X0JgB1Vlfatqvd6X7LvOwRIEEiEACGAUf8BEQIMMwQcFeKMguDMKCoguCSIioiIDgKKo4I46BAcYQIijkgcYJTBQEgG0ABJZ9+X3rvfUvc/36l7bt16/V6nEwIk3e+E5r1XdevWreWce5bvnKtUmcpUpjKVqUxlKlOZylSmMpWpTGUqU5nKVKYylalMZSpTmcpUpjKVaQCRh/9prT3nt2d+9/iuylSmAUa+GriUYPxFixb5HpGK7gn+PPl94YUX+vPnz/elPdriryw8yrQ3umXGLXNVP6CUGlgEzQASAIIBDM8bSRB4L730kpo7dy4z/BFHHOEtW7aM902ZMsUbPHiwxu/jjz9e1dfX66VLl6rhw4frSI5EJP3iqypTmQz5yr+UPpaqQ5wG0kzIQoK/ED3wwAPenXfeaQXD7t27vRdeeMEbN26cvSfd3d3esGHDvB07dmjarrZv366rq6u5k7Vr1+pTTz1VjxkzRpOQ0UcffTRvX7hwoS4LjDKBoE2QoPgl/U2+avlVe9QhTP1aUMA0ANO6WgQxtUcM75FG4EOLmDhxordnzx42wSorKwM5lgSCNcvS6bRl+q6urpDa6U2bNkG7CLdt2xZCeJDGoUkjUaRthCopJMoCY4DSrTNu/SV9nB+q8Iarl1+9SB3C1N81CvE/WAHR2trqjRgxwu/s7PQqKiqCxsZGr62tzc9ms96CixcMete73nVqujI9sTpdPT7wg0YImVCHzVrp5j3Ne/6vva296YMf/eD/jR49OqyrqwshOKhPFhbQMqjvEGYJNAw6L4REWVAMQPrWjG99kt6Zb5ufe/Iq/+5rll+zXB2i1K8FBRyO+ISQWL16NQsHYuCAvntjx44NfN8PzjvzvEHnnXPeFVVVVXOCIJij8/R48zFvh/lQ+YGvwpA+fVIi077Svl6XzWSf2bJly8+u+MwV/039QmDkoWGQkAipfw1fBmkYoRmHdFgWGgOAvjHjGzMCFbxQsLkpozLvvm75dU3qEKR+KyiM2eERs/rwQaxfv96HiUGMnGppaQmuv/r6SaeeeOp3fc+fE2aJn/OKhQFYGYKBWdrcnXwuz5/Yns/nVZAKOC4SpANFauUzze3N939gwQfupyY5CAtoGBAYpMGEBaZIWVD0cyrQJAqpif5u+Mzyz9yjDjHqj4LCYiEgJMiH4MPUIOb1oUXMP2P+kPdf8P7raytrL8t351W2O8v+i1SQIi62zk7bmThAoVlAQJCJokjziNvQh1/hq5zO/ey55c/dfN2XrltDZkhIjtB8c3NzXkyRxYsXh9KlKlO/okUzFg2qV/ULPOWdR+/Q3D4c8hC1u7dNtS1dtHzRIeHk7JeCArgHcVjSpw9fBDFtcOOXbpxy2smn/aeX88ZnOjPcmPwQKpfPMePjD0IAmoWHf350e6BRwOzAb1dwiIZBWgnv86v99dt2bvv8pZdfuoSa5PAH3wUcnvPmzcuXTZD+RbfNuG0QfQwirfL8fRASeLP20DHL6fNeMmaXUkSkSR3k1K8EhZgbBhcRQJOAkCDGT910400zj5l6zMO6WzeA2fEHJocmgU8QmxToJzR87CW1C+c8kYDwTWBEK9ZGICyCikB1ZDpu+ZsP/83XlDFFyP+RgxkCn0U5fNp/iQTHJHoPnqS/Sb00u4eEw1WHWrj0YBMU7ni0Kj0+XeJYFhJwXEJIEDOnKKqRuvH6G+dOGjfpoWxHlmd/imJYzQCUSqUs80vv0CykV/ZLGHMjl8vxd95G2kg+jIQN+mRNhNqkq9KqI9fxjQs+eMFNZKrkaXtu3LhxefFZAOhFf6EqU7+kW2bcQl50f2HhdnpDrqIw6bfVIUgHi6CQfAoteIfeGjsqvIuI7CEkMplM+ouf+eKU2SfOflJndEN0Is86JF2tAhqB9AWNAtqBYDBEKLApYsSXaCVigrB2oeOrgd+ipaPlCx++/MN3Ufg1m06ns0UcnGWtop/SN2d88x56gy6V34c6liJQbw9JfgTnT8Cn8PLLLyv68yl86eGzqanJu+eee7jdypUr/VWrVvmbN2/mbXBSzpo1yzNtAXJCPgag1hAQPmkIuK7Utf907ZTZJ8+GuTECjMxMTZ9gcPY5kCCAhgEhAWEgZobsiwbqRYIhjI7hyIgXR0LwHUKEt5F2wb4NCBgKsVZWVL5n2rRpjz/51JNbEQkBcIs0Er1gwQKGgZep/9JZo85aSh8X0x/8GPd8dvlnr1KHML3VSWFWU3C0BgZCHX/88WDugGbfFDkAmdGJ+dP4JEekT7Z+gO3Tp0/nSAbaQnuAkLjsssv499NPP+1BSBAzsjYx64RZ14Zd4XgwN/5gMkBIiC+icD6HMMAf2rLGAF+FFwkL1kCMsJArgSbBQiFyUrDAEM0EhKjKsdOPvffcc88dQj/TCM9i7BizKieT9WuCDyKv8t/Bd9I3b1CHOL1VGoVlCmL+wGgBLBygBQwbNswH7d6926dZNyBG84mpkc0JwRHU1dWhXdDe3u6jfUNDQ0AOQg+/STD4O3fu9Ds6OrxJkyaxyUF9VHznm9+ZN6RmyOcxs7MZoSKGFlMBjM0+CTA8aRWsGZAg4QiGMTlYUGhlNRAcy5qGMT3YHDHREfF7cPRETBSiMBc2TjtqWm7xQ4ufIdMD/hBN2oUm7Qi7y6ZHP6b3j3r/n+ktmv3p5Z8+JP0SLr1l2aOSrWm0B0ZJgsFHjx7twVygJl5tbW1AmoD39S9+fcLYCWOPIYYeXF1ZPQ5M2p3tXtfe3L6utaO1eeFNC1eSUNFTpkzRGzduZKcgINgkVDxEOIjh02OHjP1yPpO3IU4WFIbhhT3Z9DCmCLZZTcIIAehbjMj0fNse5oU4OllTIQEReEEsXHSE7MRvQXPWVtR+7KLzL/rBI//1yBYTqtUkMMPFixerMvVfglZx64xb71H9gN5sQZHItUAaN7ANtMkfM2YMg6BIYPiXnHvJ4DPOPeODtVW1c2jGnUP7G4GUFBUenxXpCtU4upEZ/t/v+ffmXDb3TFt726N//4m//xnakLnhQcjgmr76ha+eRsePFyEhDMyaheOQhGZhnaFGKPCgvUhD8EpYBoK5QBvWOEIHqGX8GTx2o3l4Oa/hA/M/cNlDjz10E3AVU6dORbjUNT3KmkU/JTI7HlL9gN4UG1myNuUccD5KMhaZEQBBBfAlXHLeJUPOveDcy4l5Pk6M3QiUJN1YN5LBBJWfmdIQZnvkXLDh5Kv1mVzmmd8v/f23bv/h7RtJO0kv/uHiH1Snqv/KhkCdq5R+4YyUyIacQ/aLABHnpwgQ8VMIvkLCqRAoLFiMc9Q1QwSM5aW8lvMvPf8oOqaD+syRVpJ77LHHctHt4htWFhZlOmjpzXSmWYQkHHiSzj1o0KA0krHuu/u+z5EGcXmuO9fohdEwgFEApoGZ2Nj67Fx0cA/sMHQ0DW6X9hCO3LCredcv7rr7rp9e/8nrn0P+BnwS4mAU00CckaSR2BBpQnMQLcBEOywZUJUcL4IEZHNDcLgfh1SxjdGexnn68msvz7/2xmt/19XVlRFsBW3OO5mmKnnGMpXp4KA3Q1C4dSd9RCkEIQm66h+vmnLaSafdRxrEOzIdEYwawsHa9F40gwvDFUNGggTbgLOIgAkq2a/Qmu/M16MN4yEcXwF/Gti1nNcFXnFUw2gTfAEF54ZwSaUjaw3nBEkkhaMqgrVQkYYCfwaInKv82dLZ8qO//+Tff54cr110P7JkKuVJ08rPmzcPgiKUilsFQqMsMMr0ttOBjnpYnwR9AOuAyAWm4BRMgq8s+so7T5px0uNhZzg+l8lZDIOo8WA65F1wR75ncy4E1yAzPTsQDVOKv4CZmyZ40iQqmcFNFij7C6AJeL71U/BMb/qVjFHph8/tfE9cnCO8BC8hGgZ/mlAqBARrL+b65DzkZ6lcvGTx/Ugao0OQA6JIw1IUvUGhHA84EXxHVEglBW45jFqmt5UOOI5CHJfwSUhCFvwRX//K12ced8RxDyHXAu04FAlEowlHyszMg/LjWV80AmFmMKEwoMy1wqzCwAKeEkg1Rym8eD+fN4gZXAQVtADBUeC3OClhCok5YcfjFTgxQeIkpT7l+uy4MA4/mE5aRAWZHhV0TypI04J6ktqwYUNAERzBjwQIG5taGi7ewq0GXqYyvaV0wDQKSciCkBCEJM2YKWKG9BX/cMVhs2fM/nWuM9cgWgFrDMZZyMzv2P7MZL4fIyQd+1/CmczYBkgFku/i9BSBwBqIg3+AxiJhUMndgNBh88eZuMUJyZmjBlglQoLzPkz/9vodX4q0xRhhdkh+CPblvNySZS8s20MCFChNhQpbiP5UVVVxlS1lhMPWrVs92qeOPPJIjzQz0TLUDTfcEF1emcr0FtKBeuG4cC29xFzKHk5MmjVTQEh+9srPHj775NkPwdxw8yQE5CTCAkyJWg8JJ6JWiciEHCczujCzm7PhMquFahstQ84DBpXoBEh8FeJnsHfGgLLEdLDZpTifgXCz6WSEhgvzFlNE/CcgHFPZWBljLjzdQseso/brEOp9/dXXn/rSzV9ah6gI6nIC9k3ahiaBEZLGAdyF+CvKCWVlekvpgM1MEBBScm7nzp3B2LFj0zRLViy+d/Gd6Xx6PtpYE8EIA1bpDeSZ073DfGwqKBX7F9yEq6gDJpntxb/BwiIVQ0M4rBrGSVvSXgSW1VYcweQKoWiTTggzC88WAZIPrbnh+jhkfFIMR8aHfkUTkVCrn6JjA48/s/nsrzZt2/T9j33iY/9NTXIQFqSV5VHTQsrrwdlphGHZ0fkW0Jrb1gzqUl0zpl01bakaoHSgfBS2eC0iHKQqA0Yd/OiuH32wyq+az8xhmN2iF83s60Y8RD0X6DQP0GgQ4iBkjcHkZHCRmXykBeCThYQAoHTMvOx7kBwPHYc2RROxOR5Gw8A5xbRh5jY1M9HGxU7YawhSVujI+N3rk/PxeM34rQMV2k42r5ACn23LKpVR7x8/fPzDD//84bu+dN2XDoMfA7B03Fc3T6RUNKhMB55yKvfJQAWXqgFMB0JQWK88XmQ4Lnfv3h2QDV4xvGH4ZwFnFibnf4bZsE2YVJKuhNES7Q2TuU5Ne6yKmF98HKKBiPkhjM8aihEgYhZIfQn2Q0AoGCQmZ5KGsSNVohsSkXGjHeK74LEUXJ8IGb7JJHgEs+FeH84pTlQrjHJadbd3qyAfXDz7+NlLvvft750HWHpdXV1ahAUAbCayVI6IvMm06lurPkl66SJ6cgteve3VhWqA0oF4ySywir6nULx2165dlf96x79+aGTdyG+LnS/+ArcupYs9ECYWhhVGltRtd1aX4y2j5/I2ZGrVep08j8CqhcFxDAsZA+5y0ZjC9C3bWxSXzHNMHZvnoUMbcnU1EYFui1ZiC+CoOAmN2xrfifg4xF8j0RwriCo89fqK17+xY/OOtSk/laPtLMuof23OaWybgqeSN9vcT1Xw3T0ur/ZOQUH/pfoodt6+9FPYJt+HbaWOLdV/wVg97e2Zd/28HjBrmBuZMPMpmkqhSUwym/fQe3SD9vVDZIY0qQFEB0RQqEhYwDkQrFu3Lk3Ot6oHf/TgQ37eny0MaNGUYSww5Lsb9pSIhPgEJCTpIiylHzFXRCOACcADcgrfuiQCAwLCOhmNFiP+BxlnR1uHeuDGB1R3W7cNs7p4DB6DHGc0GesIVXG+iIC4wpxBiqYjM0nCwjZfREft2E1p9AQxV1hLcup4Ft5L/q7ibdZX4lyTCCVr0gVxGT+5//JdtC65NpszY66TjzcanGTOumn2NpHOQbmKAJXIkqvB2XC3Stb9SNxT41yW++Im4bnX4r5bbjavOML5fXKKEuE8E94x4eGLb774fFWEXrntlUkksp9UUW3MmQNNQAgdiKQwjnQ8++yzHtLBJ0yYkLrw7Asnpf30bIExC6PxS+07L7NvZmbl25fJFqw1YVN5oFD7+eXzlc325PAmbWetRHu2jcUvOJJCxsDnzMcZoSABa8mLjBdp9bLVas3za2JHqsgeUwGLXpo4AhOdjK9D2tnzqRiE5QK0XJxHIhrkZLOKtmGMmviGO2AxuU/KlO+TbcLEYkaJgHOxKq6AkP5cQeEysL2PRnNzI0tyD5kRw3xCQFuBaISHmInuNrl2V3goJ8PXDTfL2K2vq0BA24iTSmqV8twKNVrQ7g27G1UJgmAgYfER+jppoAoJ0AFxZm7atMlD2jiZH0gj92fOmHmqmAjiV7AFa4ts4xnLiwvBuNERYXYXn2BnOc+ZAelYFhjyQoSxGZGgInECmTHNSSPB1J2Lxyp4KoGUe/HY5KVnh6oxQRKwcPMyu6Ay8aHIjJYQQrJdx7gQYSicQ65R2oumIX25QgLEjKqSiFOZWbWT52IZT8wz37fndsdaKHBc/IoIJYyRzKQe55XEOfHhyDmsMBD/j0q+B9bB7TwH+bPP3B1TAZ7FFSpyPa6mKnD8UmSiHUvVAKY3qlFYDsOCvoMGDfLJPxEMbhh8puugY3IY1IVWo5YDb/NjmWVnVSMIAh2rn6J1JCIloU4kkrEW4wCv5Pw8GwaBxUCI5mJVaJPkJTOaO2PKuCFaC5GgAjvnjFYdnxPXBs1DfjOTedoyL0Ki0r8raIRheCzCoLhm0ppCL9RIokM/PMy8YxrQNu1H983Oyn48TglJs4BLmWfjqwSEXdqhH74vqRg6z8/Mi+uK0lj4GmSs9lmzBRUmBITV5OQ5Byq+Bi/u13NQrgkhrZxJxexnDc6cC2MRTcf6h/wg1sxgbmjj+9KsSe1T5GggaxOgNyIo+C6jViVWAsdq3y0tLakhQ4akU17K1oKw9q5BQbqzlYCSZFay+8KYYSwIynmmlsF1/PK4poQLeHIZzs6y4sw0CEv3JZRZymUwVpeJsQaPHazIpFJvN3V3dLfqCAqrXTXdteNVEdyJJV2kbW8801v/Xom2quCYwm17O5cq0Y9X0LbYWArH63yHUCEHdaVu19Vy/N40ijLtv6DwJKdj8eLFXG9CsYkcQEojv2MasAG8zoVvFtQJYmZ2HVAuziFht6vY7mXfg5mJ7KylVCKikHByQp01KRF2zQ4jbGx4NGWiKg5Eu7Afd7aHdtBY2agqU5UJ38fbQF42yKbymXwnfhg/BuM8eaf5jk+zP7G9aIcFbQv3SX+9He+eR/oq/N7bWEpdQ+Fn4Th7G3sxwrvRnGkOMyqjJPxepr1TXwUFPwQpiAsBgZRolLQ766yzuG4l+ShQ6zL1gQs/MEHUfF/HmoOYCYWzgqzC5Zab4+35vFXPXTATyLXTC2cDAUDJqIsJE+kfUQ9bnds4UcWGF/OA7V3jVITdzba30TRkO8h1PMY3Ld7nbtNFps1SbYXc7X6FX0HX3ckOVRWZM8rMnSI43O/O2IpyhXOeovtxnGnj9lU4Pl34O9GFipna3V9w/7TV7uJxa/eaip3r9GtPb2ic2Jh6/OrHd2faM/rYi4+tmXj6xCr87m7v1uNPHl8588Mza5+969nWTS9uysq7lIDsl6lX2pugsE8DWAkSEAp1HiEgpk+fDhQmV72GXyKdTntAY+a784FND4etqPOW4WwCVz7GT7Afw2FUgWC7dR6sje+YEwKPtovxGJQmD9oxe2x1Kj+wOAZ3FhGzhU0OJ4NVOQ5GC85yohjuZ6lthftK/e7LPnc7jSeV83I+CWK+ONKe6L8k4xUb0/5qQn25zn25xt7a78+5Bk0clErXpO1GCI3aYbX+4CmDU1tXbs0OmTQkqB1e69eNqINUyMk7IKFU8ZOVqTT1JiisFiFFcZE6DgFRX18P80KK4gbkxAyQOg2Nwst7gfgaXB8CKe82lCn4Bc6qhFqfSlatKszZkHnOhgMFN2Hg31wVyyA1McMKmEoclYIJQAgU33FeZHVah5dS8RqiBi9RqH3gZSqcRd9OIidjOsyGGZlpRViU0lj6M/366l/vxie0CXw+dfNTLfUj6/3Wra0sSFf8fEXHmifXdLVsbRGUip1wQAPtfu0PlRIUwg0ecgtIg0BRXGzzhw4dypWyieG8mpqa4NOXf3pCt+4ObvrmTduy2WzQme1MicfarXOJHt0sSpnB5Uxu+FQEifXAK50QEJJEhgeNjNN0Kh1HP8I4osFCyJgeUiMTx1ohIaaQik0C8ZNwZMQ4wKzgOIjeJ5QThOnBtrsfvfEeXP/K3jc9UBhABIRLIiQKf1vBqrw4qlWWE3ulooLCOBbx8nlSFHfDhg1+ZWUlzIrgvh/ed/awQcOuoBn4GIWK2USn/+J0MO0r69avewS/JZznrudpoxlmdgeJ2SEhONEmxNFkQ3YqztmAOcNl86VMvtLW91FYSp/Pp+K6lSykvNiJhWM7WzpVdUN17Pg0RWfs+ek6Kqoq1Iy/nqGqK6tju7bA3wJ/SuK3FyMS3ZexMOwqAtG9/2ZHyZeYriMbVAT1JDBSrOiY9nQs3R7d0b6n/WVyeLaa7RRgDrQJ1Q5ctqArz4QZf8UfVkzY89yeIwVLArTsgaBFMxYNqlSVg65bfl2T6mdUTFBARvA6njA3qqurOdGLhIT/xWu/OOXkE06+M9DBnLA7VNlc1jIxA1k8PW3ymMlRxENF4VAJcbpgpUREwfgFBGEo2oQqEd6zYVUVtUF7aBVm4PY4qZ7FzI/moTGBnHR0jKNtR5t67t+eU++56j28zfo1jGoqOIB0dVqNO26cqq2ttYLCRf7xC1cRxLBp1TM93oZodez8VH0IL7p+GjmOhFID31uT5u70hZhvPV3/SXSdy3NdueXaZylMrmXyani+pjHwWWyeyAAhMn09eif9jZs31q19fm0MfMsfmNvQoBqepN5m3DLjlndfvfzqpaofUSEykwvQiJCQbFBUqvrWN771zjmz5jzlZ/w5YSa0N9fNK2AYdXfOoiLF5hckHp/Qi7MuBTEHAeGGPSWrUtRDKwDM83SzM9kH4cVl7SSZSrAaIDFJLJoviDNVn7n7GfWXJ/6iNq3cZPtwTRIZl6sZ2ZvlhHETN9GsTGb7cFdPl+hN4btpdxdkv2rHeecIL+4nLOhT+olqh+K+zEhVpU6kZwWvnWeRjuHALKfnqzjEbnNbDqzPaQ/1t4ee4R7Vz6gHhBtVqkRIwORAROPGL904ZdqkaUtQ7zKxNqcDjcV/UO/5zyQyiUNRQo48Owq81o/VcknDluiDMKU1KUy4VWZTt0ye1IswB8SYCK0sXoL/JD/BFO3dsGKDWvKFJWrNH9fwoQ9f97B67v7nVMuWlhiW7OZrODkHLiW2eyphBll0Kf75PUOdWjnMLf3JPwnBap2Itsh5zAa7qJGbMyJ9Q5jTPZ1O2tBxaEEzqh/K2giK7+mAFBggSTo7kHLi08s//W66z5OvWX7NctXPqIegkMK4WIeDfnIdhDknzLlDZRULCUQuuJ5EPp6hWRAEcUVrywgOpl6Ym7c7NSgSx7pkZk8ICKlzCZIHzJqBCCWTZCaYCFeI2e4ky9OYOZW1lfwnxN8h7KqDRFo8v0uO5lDoICwG2BHnp13OsNjSA57qkYfA16dDK3DcLEcrAOS6ipkoOk5Qk3FAWJAvZwY96TEkI7DkoucKi4FEIatacUKcmMX7AuXeG2EZQdUPyRUU7LyENoEEr2HDhqVgdtz21dtO1xl9ivsyS3KSC5t2ySYPOaqxKwjE3LBJUe4gTKKOfZguk+p4wWERLm7yk6jtVgNxtR5xXhqNaPCkwerM689UR7znCN5+3k3nqRM+cAILDDm/MHeh49EN5bqf7vWV2ifXWIgREOZ3NRgrILw4KuOaKMXOUSggxQZPpVPHsQaBW6j8AWt+yBvP2Bjjs8qFZQj33sh1ZmIRGoRDFbSJ9evXe93d3cHI4SMvZji0FzNxYk1PJ6wpGoOkX0tKspCb92HDkl5yBS+uNWBmf9kvWkMp6e9WwxaotvhJ3NRryfGQTFOcd/Y/zFZV9VVq6JSh1n8h2gmYEREWuyiRibC0725Xj9zOwR11zj+eo+qH1tvzJ3wqKmLwtT9ZqTqbmlVRKhXZcLdzf3rfjncoTb74CQuOHRlWhVV+6HfmVM5L+SkNYbHr+V3vbGtqO77UsZVDKpvSDemd6hCk9LD0tvrJ9euL7ZMJik1kVQZc7Y0SGgWAVTA7sPQftInBgwdXpFX6HXgZ7RJ5fpzSLOq1KyxAwpiMdfC9RCqxmCduARaX+V0twpoypp1oKeIjSZzTQWUKo7vgKVuXIfATtRyq66vV8R84Pi4M48VRGpwP11BoNuzcsFO17mrlvzUr1yTG4YY28T3b3KXa1+yme2BK3+kw8RmG8fZ8aD6d76HRvuLjdLRN2oTJ4+w+0xb7unZ1qpaXd4AhhihRZny+V7o3IXGoU3ZHdkSPjWKdmfeMJ77UgHXV9JmsRoGXev78+azobtiwQSEcSjcS0OyjOZXZDeU5poQUo3EdaVLZyTUjxEwQfH0xs4MRlmBo2QyT0ku2EfNHAFWyZoYUwLFajmFUcX4mYOAqGa2BueH6AVzTxWpBjqkw+vDRatIxk1R3Z7eafOxkd3DKzYWQseTZJ9PDu2E+C1QCbbQHzytop4r/1oWbddG2uc4sTlVPz5LD3xhmobD1K4xWl+m/qwEgId2txSETQpl6Jyso8O5QWJS/k3/CI+ZDxMO3q3c762ewI7JUslWuAH5t9jMYSSVtcMkB4SQuL7av5XiXUV3b2829AOjKRkmciIkwrQioRHEapRI+CPmT421SmBv+dByElTWV6oyPnqGKUaGPIVQ9BWKSSsVJ92JP7COJ/4Y0L4/9OyahzKVhfz1MBXWB2vPfe1Tnq509+iBVvi4YEtSrg5jynflMdn22pKmEmqM9oNtlObFXKtQo7A4yQcCwPs3YG+nnWGxzMQZu3F4K3LIwUUk1XZhdBAujL4GqNHahmCfStjAEKUJBCs8KUEpMCV6cOIg0C/FJcF+OgBNy19mQPBFXuMj1SVEdGY+bXNarP8DRqCy2gxPjwlhZcZWFAnKUsh7be+w0vws3FRlOFGGOqn7lTP6LJ+FqIQiIoC66d+khadWpigiK8emRJCgGqYOYUvlUPtwVtubb85lSbRKFjfF8y+sp7ZV6aBRtbW1QzZDHwQvmZnKZjekgzYJCzAZmdHFq6hiGLb6BHmTAQVYjMMeKCcLL+ukoB0OYngWI4QTxP7BpYtLSbSq5GbusGC4hXLcit0sieAq1FTlWwoxSz0L2W/W0N3PWMK8LAFPFNIo+KgtBTUrVjK2Pza3OvOrc0LrP/YA4zJzL7SYNDBm/0C2gN9ke8m151fJsCwuJ9pfai/bR8ULH6+oQJ6k4JghfMUHK1DslbAQsWXf88cfzSttkfoRQ07bv2P7ExHETT7SNdFzEVUrUFWoQkqxlmcwvKKqaj9PQbWQiH9rK2NYUMSXubPana8prE9VIBdFShCY6gnEhScyORcWoRklpl8xTmVlEyMj1sWDzYl9IYcixJHnJ8GmkjezN9EgShMOId09QQ08erSqGVvXYn9nZpVpf3a02P7qav/eV8rmwncbVpoLYqyFQbqH2/2tX/Z0o6qPINZyoyyoTUZlKU9GksJ07d2L5upAYMHfv4nt/+YVPfeETxNS8Crkbv0/kRBiGdLULAVVJ2NFV4Xn29lW83001V9qCsqSIrtRbdJO7CrUXcXBKSXbRgMQUsAVd8/HiPIX+FBctKYCvRDXqXuSFXJNtZ0yfvgqKke+doMacfRgfvOfF7apl1W7Vsb6VNImsCqrTLESGzR6jGo4YrIbeOEft/MNmtfHR11VmR6cz/ogK58i2Xa1Ng9SoHvkdNL4MjbtC9UMK0kG3+9v6ZJzIR6gLspzLVJQSXILw6NKlS3Vzc7Ourq4OyfwIl61YtqdpXdP3pkyccg3aFOIY3LUnJFzqFqaxq3ybAra2/qWOhY5oBsLoiRi3WUEs7+XZpEiZIUuBXkbaeXHIU6DecHKiziW31cniOCAxoezSAaJ4eHExWd4eGu3CU4kw6dqVaznqccSJRyQ0iMT9MdpJXvfi36DmqZq0mjj/KBYCW55YqzY+8rrKdWSTfglzbPOfIz/dqP83UY075zBVd8Qg9cqtz6nuHZ2qNEUhVXpOIbQICAsRGCPfO/IXba+2HVHqyFRDao9f5ffW+UFL1UOrd/fYaGSFJAayKTpwkex9poQzEx8AXE2dOlV1dnaGJCzofuYzV1535T0/+OYPBo0bNe4ybuxoEcJE8iKDWfEAOGzpBZZ5JVTK3vd8MptUoNIiJCTcyXiGMA4zChMmVg9zFhC2C7wINNegOG0bZ551IeGuX8FGQRzYNWs8Tsbo5tc2q8f/9XH+na5Kc6g0ke8hKFIV+0Is0xfxOE648EgWEq/9eIXa/szGHvuLRVI3/WaN2vn8FnX01SepaZ+ZpV665dmiwsLiabWRoNFPa3ZUDKpoHTJryDI1AMg6LX1n0Wi/59olZepJVnenl1wjIWzu3Lnh+PHjw6ampty2bdsyZL9n6GZmP3H9J77btL7pbjePwzU93JstGZ3iN2AmNNgE8XEIY0ndBx6DHyMixY/h4jXEfPHiWGWyfJ02UZBUYM0VyZmwzGsS1Lg/KWyj44xUF/ptzSc5rxsuNZTpysTbjAYhx4ngyOcLAFUOUGrsvMPV8FPGqlU/WqG2PL2+JPCqx3f669jerlbe/Ec+7WEfOabIOfL2U6MmhaNRqAFMsj6smK4SQTvA5DmfXi+/DwkqND34BaLoRzh06FA1ZcqU/K5du8AJKJzrf/rLn77zPbPf8+glF12ysK6m7p0sIPLarlUhq3S74VAXgyBOI/cBibCQtlyTIkglVpMSkpneRVC6SWVswjhwXJtV6YxDNINcNhfXTAxiP4YrYCS3RMYs+S5jpo5R8/5pHm8H+ErICgtDYvuKgCykqmE1asK5U1XTQ6vUlqfWJnf2kZU7trepv/zrcnXctbPV6P83SW38zeoIgqGTCWw0Nk0aXog/NUDJjxYBSaB3DxTgSvPqCZ41Fk2Veu4YdWYFowQ6+uijtWljD1fF9c2DhgqdmTxgE/1AkZZcRUUFA6/IsQlMhXr0d4+ueeSJRz52zhnnTJg5feYRI0eOPMI4iTwsqoK3k5xIHgkQBrYYyc03UZuSjnahHYpBIucg8ln6XIEJRW9QcYhrX0b+BHsDZWZXMUzSKAy+luI1fA4+QGsOsQYszKKHaKwlvCwouoOCwOQU1Yh62H5ZPmhvzV/WHE7dnGb6RGQl39Xdta0iVZEP/VANHT+Uz9fd3R0NJ1rgpgswEfeGdrV1pHP5/BRVBGg5/rypqmtHh1r361fJ/+IcVsLcKEq0f+dLW9XuV3aoiecdodY+9qpyXLLRaSFgsV5PgBV7VKJwzYpHVkxa9eSqI3KduaIOzSNnH7ltyvFTDsmMyKoRVdsqh1Umx26j3F4iB+gNEoNdsbQmsq+RWLlkyRIPPLRs2TKFOrNuYxSpHjx4MPMYBQ1g7ocQGkZwaEfoHDRULOrBA6QLzOMiNmzYoEkY6CFDhujW1taQmCpHDFvx69/9+tXHnnisiW72f9Gfj4urqqqCNECcHhiMPD65pmU6uWgO1v8gIWCZG/tJCPF53WPQjhgxBJwc7d1je1wImRxdXV0ax+O3CZka8zwSHhgfjpU+SvWF7YdtPezshrDhNAgb44zNU/8bIChYdS+iOOb83C5i0RjoQ0zZ1dZeSwJ0insSOXTYzNFq+/ObVHdbV3zjVVFcVQ+/5sT3TVWbn2pS2fboHr7+Hy+rEz5/umo4cggJje0iIcwBLBshGMLC6lbL7l82u7OlsyTasnt6dybfnn9TdPM3mzrWddSQoLC1ISTN3K5BakxOQQ3vB1lzAsWeiOFRW9Yn3x6bFps3b/bHjBmj1q5d61GAQG3ZskWNGjUK6RF69+7dmqKLesSIEZoEiQ9hQccgMVO7mok6SLSMUsV1eXAYPPksMGvm6GLJca7zZJLk4OCEsKALztINQJl+YU4zgXkQGsz0dEyIGgjYTtqJymQyLMnx3Q1NynccA0CQbEc/1C9mfa6lgO8Ag4lgQX/SL9riE0QPyx4nfbm/xekqpg36kP3ogy6BQ2sCzDE+jZAERy5SIIrMQr7KaV/bnGU88G4vyOetD4UdGPx1yLThKl2bVk2kAfTYb6VD3N7df8zHT1BjT5uktjy3QeXbMtx+x8vbWGgMP340f3eW+ogODRmO2cM/0ZuQONSJNMmeaaFRMlwiXO+mI/SRXPPCW716NWsSKPREk4nf0tISoITkRRddNOjYycdOHDl+5NHCA2TytnQ0dzTd9N2b/m/atGmhCRrgJQxJYITgORI6GuaJuAIOBup1XQ/oQPPnz9ekJuXWr1/vk3NTk5TMYdlAEhJdHR0dKZgVJEh8lPBHWLWxsdEz4VXrMKKbwYzb1tbGn6RtsKqGkv/ElHwzDJNr41TkmwrAF46lc3nGAepRHxrtsA37Ib3p4fCxaAMmlzGgD5gGOCf6pO/MgviU8aE9+kK/Rrjw2Kq96k4JoZoFijT9ztFLlqfzJB+gYWwjRCJJZep0plOpTAJHYYRC3YRoAe09a3YV3vS4T/e3oWM/PouFxIq7/le1b2tLjGHXK9vI71Hbw6/TV6obVaeGHT5MNT3dpPojiXCX5EELjdm3mpl2lTyYEEQB3n3y56Ww/u78c+cPef9Z77+iMl15Kp1njvjx+Dw4ZxVpkvXD1Pdv/T7erWda21vvv/xTl99P5kp+3Lhx4apVq/KkuefpNwRFaITF2+6/6E1QSPIMD5ZUpZAERTh69OiQ1KscMaJPDA81CyX8PYqSqLFjx/IBw4YN4w6gbhHTcl9mO+9HgVo6VhODexMmTFDr1q1TIjCgTcDUIDUtJDXNR1v0gb5AJLX598svv6zr6uqgfQAcBkHFfYLZwfxyLhkH+oW2gHYQMNSvJ+3xXbZt3LhR4zqCliCD+DowGBg9fBrUJk9/IVR46ZuBXMZpSQIkS2os2wKC6+gi4SHRIdeOSNWkOGrRY5+9+6qHX/y4K05S406fpF6861m1/vdretglmXa67ukjHACRZwUNKRS9Rjsq6irUBT+6QFXWVaplP16mnv/x8z3bTKkYEdQGNeogp66/dK3XNOeU2i/1VoX2ITxqoxXQIqBBoCQD8UPqgvdcMPSs8876HJmmH6BzN6huFaUSpOLV8WzaAL0z2a4s3pc59RX1c+7/wf3XdmW6fv7hyz789WOPPTZH7yAm5RygCjBpyGcYvt1+iz4tKWikGqtCAGSRhgF1C5qCt3XrVg+4i0GDBrGEJUHCCxabVHWNfBFIWjDujh07oJHoSZMm8TbsX7NmDWw5vgHYDm0DZgU0ArLvAvhFyJlq+5Tj6QHhnIzXwB8EFYQBteMHiWPQFuPBeSBM0JeMkdrbc6It2uCT+uTPirCiGw9aIOimjgVg7fnWHa3pJ+594rBMZyb1vsvft2rwyMFsppCQgLbBbyAcnsCRBL4X5t2oh1mCJjQMnNhHnzXDa9WJV5+uXrjjj6p5bYwXeueVs9X4d01WL9z5R7Vu6er44TjHRlEZxWnt8c7oLe0LBB1Cwv0sJMauVPsHNYpTZ3XeT/tBPtPTryI4Cpv8p/W+aFwsJMC45KhkIYEykfQX/MvN//KhQfWDvhZ2hQ0oaszCIPBjIZHoxEtA/TEZ5TvyE6pSVdc8+JMHL37qj0+dd9t3b1ttsEjQLPLQYN5u52ZfBIUdoAiMJ598kovwYptZqBhChPU6SEGyr0L6w7KDbLrg5mLfmWeeqdEe3xEuglaA33/4wx/UAw88gN9cYQs0c+ZMnCtHnmEt56HjcSyYndstWLAAK5fZ8Ul/dG4ZW+LmoijPrFmz2P7DwkbYRrNBog32oY/wJYRwPIsTMfgIzMrh9rXba7at3caQ9tXPrx504jknbsZ3MkuiyIJSUZg24GPCYklhmbZula4x0RbHb9XdFqGO5yx6r3pq4X+p5qbd6vhPnKLGz52slt3xP2rdk46QKFBT4PPoIHMk6jPpD8vvBaacIV/HI//8iBo6dah6lSMnPal7dfc2/KlDnGxhIt/vk6Awszm+ckTjmGOOCWhCS5Hpnf7JnT+5rraq9mosXyHaQjHQHR/sRdExxhelovwmC/zL0We7mnDa8ae9MOP7Mz5/2T9fdidNWlmaXJXhidCs2ve2hLf3ZzVz7dxcV4jwGy9SGr9JSPBFIY6sorArPkPzPWF7mRT35NsdH8O/5TvCSEY4Jca14qYVgxctXrQbK6wXjM9zb7Lpx51x7HnNuNQ106+xa53GjSIsxoSjJ7SQFoEkK2/qCVOtk8HUOiicQ3Q0wyc3t21tI8auYCxF+7Z2uz/f2qWWfvFx9a4vn6FOu+Gv1A4KfY4+cbz603efUU2/6z15s2HiYLXpf9cbABHLVBlDSY0iVZHK5DJRaHTz8s38N1DI1h+JoP6ebCsQHvK+A4yIok7wfKaIiVM/+d5Pvl7lVV2W744TB1E60a6ba/A4LJB0XMxIYANuTRZBGcMkaahq+Ord377bu+xTl90BMx7CAkEFZfXRt95fsT+CQqjYYK0QKeKx1UW+F+2jxHdLxbzBr9z2yiQyDhZgd5Hj+uJB1skfEWdZyEb0UHlbTX1N7oOLPriisINS6mFYBPm31awjMmHuFPXSz5PV3btJWDz5hV+ruV95HwuJF374rHr9t6+q3ua+2hF1/Ld15eaiSWiF5QqFpr9/+rI1z6yZmuvOFbU3yAzpLEyuOlSoYnjF9lL7JOrF9U1I4GMRbmzHhIV3xcE1cIlIYlT44wLyj2Gt3dQPb//h9dV+9WVuNTWJokmtC4saNlqpTUfQOlGRXogTI5EbRdoFCYuv3HbTbRuu/PSVvyQzOySTWhsN+W3BWbwRQXFQETkdF9EDOW/NbWu+PfmqyW8cIBRGSxcy0YOu0BUWj7GvlC/CuNActhFTT3rP4WrF/c8X3f/fX/0tORkr1Z7Ve69tO/2iGRwFWf+HpqL7wxIaxakfPXUl/lQ/Jlm/BM8vm89y0o/kehiEJvbbGOmmTZs0CQYtZjDW3iXnIlbNC1Ca/vZv3n5JpV95NRjaRe7Kp10XRoW2ChuIUxR0vAaNRS0XPBoWFuTrGN44/F8+eeUnVy78ysLXEAVRxvxQb4NG0S+KgL1626sL6YZfSl8HZVTmSRIWb7gKk9Qs4BdJ2aUD9vkBQflMFMF1/l4kAQEtYOq86UX3t25pUTtf217yePmrIgfo5Pcerl777aqSbQZqKjWEBCp64Y/D7ppxqrzPFlqiDeQ8T+OPInGplStXItSZJv8VkIIpCuNDPqTJiZ/+yN99ZOSQmiGfJaephYCLwJE0Al7QigQR1zwxUTGurmY0Cjc7mnOJ/LiKm4yL92d1wynHn3I7NBiMA4IKvkBvX2LeB4gOWY0CwoC8wjN0Si+kxzPX2TWDhMULq25ddUPaTz+0v9oFnJGiIorzS+3P4wmLaRSRS2TTixvVyw+tVMf+3TvV5hUb1a7X970qPjSOv7rp/eTzaFXLf/qnku1C/ZZPQm8riYCQ74apUQPWJx+OL3k7eLbDJgyb+NMf/PSfSYNs7mztXPc/z/7Pytt/cPtuaBbIeQJR6NzfvXt3+ryzz7ucGHi8u4i1JD0KlF/qqUQJgZHPgiH+JhoCYnyOWRmPl7XwgqQT1MgCirOdcvOXb37XP1z5D78j4ZVHYSnAwtVb7Ks4ZDUKCIBcKtdEN3Vt4T56YE15P9/0hkwQXyWEhEl48/z9uGVRFqf7F9rvz//0OdIcWtW7v3CGapw8uEjb0n8oZHPmTeeoCnKK/uqa/+y1rQ4HjkbBQgLusmipCDwwIHqR2FiVqkzNGDpm6EwpOwCGbBzaOKE2Vfu1hnTDHaNHjF7yt+f/bdOTjzz5qwfve/DST33iU1MowlFB7SspJFpVX1V/kS1GZBibmd9TidIEtnBSKko4FL8FyHMqwLuZz7Y0gpsMSdbvlLFTroZWgZXrgV+Cv8Rc6lumWRzSPoppV01roo8F5MikWKf/Y2wj7eJe2r5AHQByw1rmZeDENWgba15c09DV3pWadsq0Xb32ocKiPgqhzpZO9ZsbfqXOWHiWOv+OC9Xz9z2nlt33v2pvNPq4sWruZ9/LQKkln31INW/uXSaWCo+27GypXPbIsomljpt67NTWYaOGlSxUe9BRlJzHgiLdkG4P02GOnl99ZU3lcfQwDs9mspGW58AsuPZJ1ixGnckLpHtOQ2XDnNkzZ6uf//Dnt/5u6e9++Y53vGM2BcDHiabpZp5KlEO2WzPCmBYs2E3JR675alIW3IJLtkqcjuu1GMzH7PPPOn/4w79+eDNySYAHgq9i4cKF+q2yQvqFM5MEwz1/ufUvk+glufRACQlWDZWfXGTZEITEo9979Gh8pxngL0edfNSu3vvqfTZv3rRHLb78Z+qUK09T7/zwLDX1jCNV0zNr1JpnVqudr2+32Ir6kQ1q8qlT1KRTpqgxJChgujx5y2/Zl7E3KhUeveNjd1zQ0dxRMt9Dn6ubak6pOWRWChOHM7QKL+1lB79zMBhtBjkeK9wCSFLe0JZd9BynpGdKLZLjEcmFNamaz8w7e97FFEZuYbyDirNPJaIhxZlkjnczUqUUJMhWcjOmrRSqZhCeKZvAjlaVj3EZJNPOOfOci+574L7v1tTU5AEOXLJkCbrLm7C/lk/1Jpkj/SbqUeFXfLtLdTWpA0T88Ax/A75dERYHJHa2d/Z6D2GxlBYULmxEqae++3v14uIX1KwFJ6kjzjhKHXPBcUWP2rh8g/rlVQ+yoOgbaQetmaTehMShRgkhQXMtMeVkeo7DUbpAKpWJ+i9lEbnIkpNqLpqArE0K5CTXXOnUY6mvsVx7xY+Wpkye3DEl5DsEUOD1AHXZBbGMwJLjpNKbu4CWFHGqqaw5ZtSoUZV1dXUh+U6Qnq6effZZQL2RuIkMVDeke8CFRb8RFPBHkIPzIXWASFYsg+QXrzSrhvQIJh83ueW9H37vX9Bub6aH7auPtHvzbvWbm37N38ceN141jGpQDaMbVMvmFtYsNr643moY+0K6D1GPI+ceqUZNHaWe/fmzqqu17xW+DwbqISRqgwnE/ENEEBhkbVxOUVYLkwK7TlFo0w9X7LZ+COXbgs5Sx8KlxJq6XlwMmte7MT6LKLM90mCkzqyQgLBk8W+AwASTgX5qqmtOzmQyFTt27MghzQCJmMgHmTJlit/W1hYCKLh69WqgoMOCzNMDIjT6jaAAHRD8hCGu36nCuPKVjpGZoL4IiIj0Xk2PUrTuhbXqQFF+L1EPLNR80S0X2e+Pf+vxnm2mV41LDUkdlAsAaWUwLjmV71zZibTaIQkYtYqdhtpZ00VKIvIuqQJvjrNlH4Fr8EObOmNrsToJfeKIdHODXIGA9lg1nTWVILkyPWsx5r2yVd/82PfBjtFs2HDHrXdcVldbV0Gxm90dbR3rmtY3rbjl27esSafTEBKoH8PITVMIx2aeGoH4hgRGvxIUB5Tiglf80zzYffYcMUrGxs17UgKvrvat31LJprpY/30IjzZvblaNoxvJZ1J85fX8znwb1g9SBxlZIYH/51W1X+kPR+6Fq0FwwRphfi/WAKwwMdEGqSbPPgRjrgmzY5aXle4sEjMf+xXkZku/EvkQs4aLS4c6GdnwVMmlIwT7Avg3HLJjhoy5jq+X+mgc0qjGDh+rZt83ez1FZe568eUXH73x5htXb9iwIY8ETVTYUlGawgFxeJYFRQmCMwmxbUnqEbDMPodH6Vnn3pzirQ7tLaTuFYWRuwRT497L72VtYsuqLUXbZLdm9+BPHUTkmhzg5XR9epqYiTa3woRBpQ6FKyDYPDBmCDO9H69RY1fC06FdahK7eHHsfM5iJNxV8GwkxDE/xO8hRZDQJ443yzvGC3nr2FGqTeV3WwsWkZNsjL3gco4ZXtJhfHW6+muzj599xX/823/87IIPXnAT+TFynZ2dSKhE3dtQ0tS57/3ULMqCogRx9qdOriO6f1HrcN9Mj72pFm4qndf34/oCuNqDEOshmBPGuAmUYKxKjSJGqHDBcfI9AY5SKsHgYooIrBski1fZ3A0dl89j7cJLOj8Ta9wi0SwqSxD158Vrz4jfQjQaOY4Fh+eAsST8avwmOIYjK0HsYxGNCSFd3a3HV1VVXfPoA4/Oef6F5z/xuS9/bjUcnigHoSKt4g1FRPoFhPtNIxP6EjCNFADeF6odUt9dVV/d2hNwVfiXd0rtFwdnRfsLPmW/LtEfVN900H3iX5+0qtj4RkwasUkdouTm3gDW7Kf9wdGPaFuqOhWbHtZFoW3hGtxD2S8OawgLXmIiSGoCILt+jPFByKLcsl8iFRAw1ukpy1F4KuEIddesUaY+hQ2z+snUdFkA3I7FM/Bvs4qewMUBK/e6vTmkSSxZsGABqkelSFgE9BtOGF+9AYBWWaPojYzjS1REeTE7WjtSj9zxyJEoXHP2FWf/efCowSXDEPVD6jPX/uLan216dVPpMGQpy2FvTojC/SX6rhtcl2kY2lB0jP/0w396pLex1TbU5usa6w664rqS6EUM7xPTBcQ0kyorKzmGbdGRac/eF4PStJErMUXErGAtQPt29pdlKaOcYc8unC1p49ynihfalucjjM3CRjA4aV9Wk5exK7eAjYwPbU02a5w7YgSLaDHuwso8Zs9PLEnBAqTTG/938/7uvgcffPBclIJEESiT5FbMjdUnKguK3shT8bIBkTzmG7zupXUNUrjm1T+9OkQK1/RGY6aOaVUHKR3MYytGnLsRokoQhULzxGI5L0xXpkdaZ6T2YtNDxb4D+W2h1r5ngU/sU8Di1SQM2DQIYvi+LDsofYgvw3RoTRLxabAWYf4lFkH2nPVhnDwiLg5uzAq7sp05v6Sq83GetunqNm1dReYJr8xnCgYbv8ec++++/3OXXHnJTY2NjShjaU2P/YmClE2PUiTr2ZqV+IwDjHM9xh89voVm2m78uYVryvTWkK39GUWmPDIifNo2UhjTJdfj72JhRCsQB6OYHMLoFqkJJiT/gZifovYL2QWwdRg7RY2AwaeUU3TDoaIRgLntQtzu9Rmzxzphfb/ntfjGxAnMcpwG+SnpBljgqjJVefkVH71iyogRI1Io3YfCO4X99JXKGkUpCqMXwtZWVLGPora+NveRmz/yvCrTW05icrAgxzKzUdizkl7+WuXUeIhWmtKx+WC0CBH8snqbi6+wi2qHMfhKzAEQozFN1MP1IYDcpS2FuRM4ChNpAQML6lPqVEhUQ/AU4i8RrYIXVA6iMVjnrNEqpF/JJRHhwmPWquGEY0+4IpPJXFtRUcHV41FbA2v2KHvVfaOyRtELFVNby/T2EASELUDDK6myIeiRQ5L4KagTdd5VKOzM6URARKtI+dGylbzAk3H+Sm0J8TVIjQipbWl9ASoGZIn/QBg08c54MbiLGduJpHCbUFvhwL4S4wQFWSeoVjYXRP7EbHLHbH0VJiwrY66tqL1w3hnzhtH3FJkfAQpim+xTH7UtTK3bvaoYZY2iF2Knllk5XVTB/aH25vZ0e0t7WpVpn0jqSdjfcCbjtUbx6jDEH2pLBMT0deRwjRuaGbdxeKPFPoiAkGcIlKStV+msdG/Dmk4uh2AcpJ1oJuwMDeNFrdnZ6DC4aBUu3FvOw4VsVOwo521mHRwu8x8k19DtsVCR49CWMcOUETOINZSozkXDKbNOOe6Jp59wE/uwyFBoVifj3yp2qRedDcuCogQBcMXrejjxbCGYH/sCvPrJdT95b0dLx0G/HsbBTAVC2v6A8KCZOF1ZY0p+OtEhLCZ97lXnRpvDJLZCzBKB5wvJ7A8SxhQNwOZiyDvh+7YAjWSPynnA7LIcZaAjU4NneRNlkesRzYSzSnMG8WmOAwkUHGO0RXDMdYq/BcRCIlqoygowjAfjGDFsxKm7du16GhXnsRYOlgCgSEiI5ToHDRqEFcqw/ACSy1hgFMtCLQuKEsR2orFz5UXgGcD86yvtWL+jpiwk3hg5QoLhEkE6QBiUHwIxRL4UPJ3CvomIhEQJ2D/gx/4Bqy04vgU321SYVXwbCKNaE8Gkq4smIUhMOV6QlMhAFVQmn1fHbZyLU+aaYjSo0V4kYiKUmLx0fJ9EK5Ex4/zpID3+6zd+fe6UiVMOr66qrkW1+PaO9hWXXn7po9Q+h6gICRFeFgDCxGShlgVFX0jqUQgIRsgtXIPfyCTtrZ9h44d1zJk/Z9nGP28cpsq0V9I9CxizLyJdna6vH1w/gX6nCxO9XByBFQr0nZ5N7GB0cAvuei0WEm2If7srRobRbB0PxjBzPvIpSMaohDS5jQm7SrsEeCt00tjZFxtaYeZGUFwSEzi6yBganrimIDadeJkAp6wAaQ3nzxo+63wU55EICxZ5WvKzJevau9u/97cf+tu7Vq9enSGtghccis4ii2JGVBYUJQgPWqS+jV2rCKSze8vuSilcc/bHz35pb8Li5HNPXqvOVWtVmfZKrsOSXnjfwLOHV1VVnUGfaYlsCIPasKMDJbI1J3w/0cZGPYygsTUhDMpS2kpquA236tgEcJ2RgphkJ2UQWAZ3/Qlcgl/rRJVu68Q0hONR88TWpwg8G2oVhhcBx/4LP0jgOKJShzoBCbfn0hGuJNuZtdcn8HXaP6EmVfO1h//t4WP/5tK/+TgiJVhiE5qFyT6N+1JlKkmCzQcZZJ+HGWDP1j12DYw9O/ZUqTIdUOKK2RLloBAfC4lQV1jIs7GgJeyYwCE4EQvuS8Xah8318GIsA8iaBzoWMNKHi2FwwU8Ww2DO6WoBrh/BLLqdqEmCY3m5QS+uqCX+BYmosMBQnl2a0E1ekzbsTzEOUTcb1mo2XowcZZxIKnCFRFSHIxOqtEpf/MCPHri5tbW1AmupYkU9s6KfvbFlQVGKBHBlZh0T/uI3CRrEqRee+tqss2c1zXzvzEN+ib2DiVhIwItMtx3wbPJHzGAhoWO8g/JiIVHoo7eCxPlt2yoT2gyTYVQJMQoziyYpM7IIFkkYS/hEjNASJmVNwey2jO06Ph2Gt+PTcao7nz+MNVn2O5gIiTWXjFYiQkgiL5KHIj4SwWBYIaiT9wTEDs9sTlWnqi//3re+dzoK+CI/BEsnqrKg6APJ8p1KJdQ/cWTOeM+M7Sedc9LAWX/vLSALppLvnmqg+30YftvgppMGrqIdMenYF2F3O8LEAueCuEy+NT+cQjECiJLZ2RbCNfY/+wAczAUzbD6utC2mCfqQ1cj4eCdzVa5H/BJu9MV1pFp8hRcV2BEnLGsafmDDsNbRqZXVHCRBTUwdEZKMwcglBQh+Dx00dB6qfZsFvT1ZKY3Pp8pUnPx41kKWoYXl7mP2aJn2g0KuyuRTmHCkjQw4YCOZWQu1CbfknCtM3DL6LiUYTCmbKwHnpWuaWOehMT9ArlYh2aZoLkLGJnNpnUjsKgTvCQpTNAYel4PHsAJMxUV3WBDpOG/F1YbsLXTK9Vlsh3K0pSBOc5drqkpVvS+bzaZJSPBq7a6PouzMLEFu1INj58bu2591PX7/s98fTmHSRlWmXsmJeKDcvl/XUDeqsrYy4ay0FbMLYiMWWOXsmHTcJP4zfcehRpVkdMnHEAZ0E7N4NjYhUakzwQys/ER+hZAb8rTM6dS+dIUbM602S0HIMh4GqyFhW3usKQZstRYVmxfWHJNIR6gSCxC590rGbM0qFYeO6bzjOjs7gwkTJvjpdBrrscpi4mVBUYqkbBk/MBXGUFsTHu0rAZX5p0f/dKwqU58J1jk+UxWpmnRlHwCtbtTDIQphq4988yNxv044NFGT0jCxLQbjx8ljNnRpzAn7HpjFfXh3GDOcjMdmdxoAVaFfg/M3pPSdjhPRBFHJ48vFGopUwrI5K0ZjsOunBnEBYXFyWqi4jtPW3YI9bq0OQZzW1dUFmUzG27hxIzAVdshl06MUheamq9Bd5MXbn65qGmo6VJn2hZirtGaUWzwL6xKtSzwVRmsak0WiCG4uhq2cbX6LGeAKHsksZeHh1IxgIaFUvNykigUGNBTODJVsU8chapGYfjzZiJ8gETKVKIuK80FcTIiYSXbM9hZp67+Q87N/w/gtZMzSVoCEGDNpE6+Q4MGqatyhcWiWNYpeyY8hsjLrIOqxr6ZHbWNt9tKbLn1i3Z/XHZTVqw86ivI4gJ8I6OWtGD5q+F8ldmvdI/Qp35WDUKyorlD1w+oTxyRCq2ZWdqML1qSxARZtHZcW4OQncRyF0Gxsc4vkuvkeCf+KSgoZId7nmA4wTSTTtRDrYRc3dgrhiLbSazg48N2V3K3wa+9s/zMJuLCtrU1XV1cD7i0iU5cFRS8k8WyWwCYZSe0H1TTWZI866ajtqky9kiwsnAtzAbJCs93ZiqrKqlcrKiqmcgOHgUEJRKahwiiH1UK82NkpDJJwMqp4SUBhfglpyrkT1bAMs0nWJocrTWUrF9ch0Qb5FE1CamQmwrCGySUagjR0FKuRyIW5R1Fkw4/h3e5KY4LFAAmi0015lyRHCaPidyodlQx8+PGHv0u+ibCysjLECmnin+C+VJmKUxjPHLJ8vahqZXpzCPU+iMk0fYYpndL0Yoc0y71MzyEy3Qz/FeZIuGTRlyquKcnbQytlbGhTNABXsAguQRhPnn90qLa+CYui9J3Cu16MkrTXJGAo34neqDhU6pnSeaIF2JRyg7iUscnqYTJOW68zjEO1gjblMGoQJAQlCxujgUmkRMwyfN+wacNdi5csXktjzXV1daEilrzo3ENZUJQiP07CkYQgpv3SKd4E0iU+99Z+X/s/ENTXvkw7UyAIlaND+t7Z3NL8e3qZO6ImOqH6C+MLCT5BO0hLYQg5XoBJfC6Toi0zrkQP7II+xqSRMKJlMp1EY4pPQWZt+Cg4zKpi/4N1JIbOhGMcmfY6DErTpqAbGLcVNuZdtI7SVMpqGe4iRCIQrC/F8X+I01PGvGHjhrs/+tmP3k7Hd2/evDlLzsz8smXLHCRR2UdRkrhikBevt8AAFTzgXOhldAa3GY+QP2UGCDN4r9lrxu+jTUcXcRz2kqLuF+xPpORE+8UJZcu4hQX9u4RJMaAx5qMaDj2WwQvjPgurQ7ufiS7DntcTfRQZs9/zevl7FCLUXPeyoH9nTJ558TUcmqSmt+7avevp2praacQYo+i4tPgNXOQjkxOpSCAyHc+/+B2sc9ApcGOjIl4sPGTWdrUAxkwIPNrkcwgiUtLEXS2UNQdTqcrO9H4cmhT/g5Tyt8LFMLqNrHjJBbNdqLm9F8Ys4sfgxSkI1pnrRX6U5tbm5//43B+//50ffed/6PhOatZF15sx2oSja5UFRVH9ADf7M9M+YxkTRDe8csVvV8yODkoeBjsSazJpn+GEedchZk+UhBCDSbTMIjLLIarCgoebe4LMERvXoxdAS1/m5YVc0jbnwfMSUGD35bIMpJIOQTtL6WhMZp8XfVF2rAnGKggDuveNP/PRqlrW25+LVWU53t5DL75GKYqLsdj7EoVKPblGGk82XZFO22PtyeMnKvUbmBG9GAEpY928arN1AqLdpqZNry1buWwxFxCge5zzcp6UE6D7rklQeXxPPG3U8GhtUHrmbCrRdj80q0CLwOTFhnzNpRPp+j1U1KLJR7MzNIwqdJHQ4P1YIZ2PS9N15iFDTXTNj00XLp7rB9r4Tfg9AcSd/AvaPGueuMx+3mdfOCKcH+PB+4KSeL97+nfLfrP0N+toFxaZ7aqqqupob2/vxsJBRx99dP7ll192ns7Bo0i/VcQv4A033MBJLyb8wzn4+C6fS5cu1VdNv+qSIAx+hP3iGbax6zB2YhV6rgvBN5aM+sphM89LzHRWnTZOJvFg25nNsUULj3XtdVE35dzubGsBR47G4M5EVsio2K63GoyTrCTjlZnKNc8EoCQZjkC0clVrc7+4T50sGls4HveeumN3z2VvqTmnqNUyLu3An5WJQhReo5gQfI0ptey5oc9dRk7TwFx36JuTobhL2silmpoaBScfPUONP+rXwycEKanrOA/fOWyjviLNyBC20fGeHIf2sh2fcqzbFm3Qt9sP2mF8bh8yDvmO8RLD25cSY8F+bMcnXXdYW1ub37NnT4Y+M3SNndRlV0NDQ4aOy9P736OmZt+RQ4c28UpSoDvvvNMnaelv3brVHzduHKZKv7m5mRdIGTFiRIDsuWnTpvlj28fOoNt0rhtWsiqovOAOE7svPkjaJZJylEqg9RIk5rTBboidbbUOHXuyxXMvmoIL85V+xCMvs7XrwXe1D/kT1VgEglsXodRYLURZO4vauELPCFMbenSOseq1ju+phAQT4CdH2FrQk1l9XO6naAwuyMgdpyvI5bmJah7dELVha/3WxTTTZmk71j/J0jEZYtYs7HYSDt34TozZTYzWRYyHT2au+vr6brQhJsRnFz7xR9fQTf11O2066VrQJ2btLmLoDPWDPropypCRY/GJ33RO/k3j6KQwJZ06wzM/+kTf9N32T/10Ud/d+CTCfm5HQgDHY/x8PowZ/dC2LhpHJ7XFmDpIm+gmcyNzzDHH6F/84hdh8u5FNCBMj0WLFkFGKEBSV69e7SM7jm6qRwLCb2xshAT2Wlpa9K5duwA24VkjG2ZTgsCUF9CmH5uZX7ZDUrsM5woIYUi33qF1ahkGxgxsATZoS74Rt6ZjBOdIQpd1AdIPZGPq2kmJNpWcOdzn+YlqTeJhd5lSNBoZm8zw0j+H1/w4fVnGbz3/3DAWTnaIYpd7sbYjdrxrBoGgdcks7mbvin2NY2hOtwvySAVqt73NaXD8CiLIoOlYbEGUZ4FwYAd8IgAcEaOyuUXbeBYmRtL0foTEZCHNutAgoHFoLNm3Y8eOELM/zgHsAY3d6+jo4BtBbfnU69atC8eMGcNtoKlg9XF8NxpNSO099AHthZg7QqUC19DermksPr2XGn3hN/IwcF6QtMc5pT9qz/vgZzDn9Hbv3s3fqb0ePHgw9wOtggRQnvgh99prr+WIN9T3v//98O677y7qeh4QpodoE5dddlmQeSEztGJPxT/SiwXHI2sa2VzWMzOdJgcgVDtVoSqOSXvpswR7b8kF5OhkGMxlOAsGckwIUYWlBoHF45v4u5gGro9BQnEyc4oaL/a/9CfhMxfK62oxbX6b6kh1JByhxUwYF9rs+j5EsxEGHN413AoiEQLieLNtnXNEt8KLhY3D/F4B9sGaWH68QLR7X90alXKuQqHkOipdaLZoFHKfQCSU13cH3Q+acWr2GYhvIJsLxTlJQczlm6dsXkIMFmLVcNJIgV7U9B2mhj7xxBP9pqYmNWnSJC7+MmvWLJi3fBZswz6QfM6dO1c9/fTTvJ/6gulr28t3OQ7nQBu3H9lW8Lrb7TIWEIQYKnDj87HHHgtlAWPswyLG7r3ziiwONCA0CtEmVq1aFUxITcB6TP/ohV4j8vAZ3kr/aI6IZz146/1QdYadfLwkh4HkpZXahGKOJJasl9i3mCrA8es4gxGrUtsZ0HjgUYBVmF9i4XBmCRRYTAlXSxBTAwlLtsSaFyTGABJG2eHviIxN19nqOWPubbuKhceQ7iGKdC4eVyaXiYQcvVuo0iTXbU0MM2a7sreO6zXYTMx8XH5ezscO0cC3QkEg2IKCtFEHEzEAc3OfJlfCRm1k/J6ysHxoI37et6AnuqbxKZ26Su4/F1XGPc1GeT04b8pjLM3n6F5yuThS0/OYqYnZ+WqQaUkmLd9BfAeTLliwgLfj3bvnnnukFqW9q7TNPqMPfehDys3WlD7lePjN0AbkHjdz5kxO3Co8Vo4XoeL2h/PPmzfPW7hwoSxeLJOpTvjVHBoozkxkwvn0gKHPVh224bBvkLbwsQQ6T8fxbUHf8YznxWs2yOzPKi1m0rzj3AsiLzleWpguUnNAbHZhCmFaeYFtxqLRIizyzyDnMJ50Kp2YQfk4Qfo5Y7VPU5yReWfdSuXbmZwZTCUFnvWphPm4CrSOtSFW12VlPAfdKEvZic0PgSlgJll6zwo1FUGS5bt7T0TYusVhRFBwG0EUenHpfNdfxMeEjiln7odoIq5WJuXwiz1/68/p+fxb9tTsmbtl8JZXabbPPPDAAzkvuUK4587GwngqKX4T72SR7cXiOKpIf+7+RD9Ou8T3gv6Lmhe90YABXCGaQTYa23M7hu74Nr34rwjTWuY3JgGIX2JfWQi3vEiikrozmyA38TKLuo32skCL9VkYkIzUDxAosGteyLkFNs6RknxU3DVhDgRx7QUBCll/guOzkDbCXBwB8HTC71AsyuBWUGIfhDGDAPeVsYAslNkcJ2Xj3XqSfE2m6Iq77AHaCqO62pkIDbn31kHpqQSk2oKZTCUnXKP4ezBON9ohZov4M/gZFHn+CSHmW1xFS3dl943bh23fROo6/FyaImeFr5h2mdL5XoopdYltuti+gv50qX5KjEGVOLbPNFA0Cqy7iDc0Rc6fanLm1NKLUDNxx8SLUtnUu3VWNwrc102uSaiwYYzEYwx+oG1kgj/hbzBxe1alg+hT1mvgQZjiJnIcz8apuEpRwjtv0tv5OD+up+gKATccKMLEnd35tx/EWkI+WgiXV+YGE+U1myKypB0LpWwuwWCsvRjAGTQbl8QPYytMqzChSZlGsRPWMLfcD743+djcsJoOn1Tx/ZR0bNEC3LUt0I81+cx95b5xP1PxCuA8NimI6wgaOdYuOizPX56BClvJTNnYXNP84x31O16ne9JG52ZgUrEQYn+mgQK4wrLv4ZIlS/LkDc4OHToUISN/w8gNi+nFexjgFBBMBpDEpd24uBurJocQR0cgsZG7j0/3GNnnHlNIbtxczlGsHc7lxsTd38Vi5u44MAa5JrTDd3d8fGNM6rzE2FUfqHAMxbAA7rl7G1fhce69oGiDj7wDGSdwDDiv9INtEh0pHLucD3/op9i1FXs+sg1jRESCoghZhBYrw0qEG7MUPs8Bb2OaDwghARowPgptgFbPPvtseu3atekRI0ZU0ctaQaGmCnopAgqVKnoRfDJP8NKF5iX05Dt3EgEWET5TJCC02ID0IvmMtFQcsuIQFUAy+MRvd19hP9gmv2WwEuJySdohrIvf6F/AOAjjFR6L9hg/2siYZMxYLQqpxL2dV8aKtvgkLSyUc6Mf3CucV9q51yLt3HHIfUR/cpzcO7QD0Ad9yrlwjDwDtHevS46T68ZvHIvj3HHhGBwvfWIfrtu9TrkW+Y390iedA0IqR30BlNRNArKb2ueWLVsG9W3ACAnQgNEooP4CT0EvKiCq+rnnnsuNHDkSCBUfsWrMkjTzeJhRdu7cGZLW4WP2AqoNcXGJlSOGTbFsDjfRPn7B1qxZE06dOtXD9mHDonV+8B2zJswGOR4vqHwHjNbE7G176R8ksXg5r/tyb9myRY8aNcqTsQChR4IvoXmgvcz8+I52FEtXW7duZSajbYkXHW2BE5DzCZEA5XG640IbbMcnrhd90i5UzeY+XUGBbdC65HjcE+kDn7K4DvAAMkacD/fHHRfN5LyNnhm3c/uYOHEiHNX8rERTMWPh5ylaCAqyDBo0yCtELaINaZoMbcZzx/OHwBgyZAiOydMYQvrDQHMUdtQkKAaUkAANFGQmE2LbFMLS8+fP1/TiaXop8xQ+yh511FG5lStXZkhQZF977bUMqZb8CYgrvVhAzeUoNp2hlyVLL0+W+shQaCw7evToHPDxkydPzhHzAtWXpRc3+/rrr/Nx1DcfQ3/A2vLvhoaGHNqRAMEsxcdAtaUXMEt9ZXEeEjr0fmYzGzduzKIftJPtUH9B+E0Mwr9xHBB4bjuMj4RgBn3jvMQcQAVm6JoxI2ZaWlp4bNiP633xxRe7GxsbgT7MECMmxkFj53a4BpqhsziPXBOFnPl4bIP1hj/pE2OYMGECjw/bZHzTp0/PYdwkYLtxLtwT7N+8eTOPEfeG7j9fG64BgwBqkgRSBp9oi2cin90R8b1E/7hnuE4cj+vCdWIceG5AOWJs9Jz4vuAaSVhk5LmTQOFrpIkkQxMKrjP/29/+Njtr1qz8r371q5D6GJB1BgZaUpiNeStO41J5Yz+wZiBxapeQEwINBGsxUlzcBiCBZIPQkTZnnnlmj+97I+lbPikezqAvEmRwvmr33AjvSryctiliNk/Oj98Sb5dzYxsIsXKYXAWn5n7dDTg34v44p5wH54BQdWP0ZmEYJceb9sw8ZoxYYcreJ9lH4US/sC+cE7/RB+0PofXhHuO34BPc+yS/cQy1x9jcc9l7L/cCx+A+YDuel7mXfKzcO9OfdvsBAbdw0kknebIPK2epMpXpDZK3j9v3tc3+0lvlg3IRHF6R7YXf34xz72/7vT27geLHK1OZylSmN0b/H8zDeeYd/9HtAAAAAElFTkSuQmCC"})},is=function(e){var t=e.strings,n=e.onSave;return c.a.createElement(a.Stack,{horizontalAlign:"center",style:{paddingTop:40},tokens:{childrenGap:8}},c.a.createElement(as,null),c.a.createElement(a.Text,{role:"status","aria-live":"polite","aria-label":t.appSaveRequired,styles:{root:{fontSize:a.FontSizes.size14,fontWeight:a.FontWeights.semibold,textAlign:"center",marginBottom:8}}},t.appSaveRequired),n&&c.a.createElement(a.PrimaryButton,{text:t.save,onClick:n,ariaLabel:t.save}))};!function(e){e.NotStarted="NotStarted",e.Initializing="Initializing",e.PreloadedContainer="PreloadedContainer",e.SolutionNotInstalled="SolutionNotInstalled",e.MissingPrivileges="MissingPrivileges",e.Loaded="Loaded",e.Failed="Failed"}(Zc||(Zc={}));var cs,ss=function(e,t){switch(e){case Zc.NotStarted:t.progress({message:"Initializing"});break;case Zc.Initializing:t.progress({message:"Checking pre-requisites to start"});break;case Zc.PreloadedContainer:t.progress({message:"Preloaded comments container successfully"});break;case Zc.SolutionNotInstalled:t.failure({message:"Solution checked, env is invalid"});break;case Zc.MissingPrivileges:t.failure({message:"User missing read privileges"});break;case Zc.Failed:t.failure({message:"Comments pane failed to load"});break;case Zc.Loaded:t.complete({message:"Comments pane has loaded"});break;default:t.failure({message:"Comments pane is in unknown loadingState",loadingState:e}),function(e){throw new Error("Unsupported switch case value.")}()}};function ds(e){return(ds="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function us(){us=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),c=new P(r||[]);return o(i,"_invoke",{value:w(e,n,c)}),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="executing",p="completed",h={};function v(){}function g(){}function y(){}var b={};d(b,i,(function(){return this}));var C=Object.getPrototypeOf,T=C&&C(C(x([])));T&&T!==n&&r.call(T,i)&&(b=T);var I=y.prototype=v.prototype=Object.create(b);function S(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function n(o,a,i,c){var s=l(e[o],e,a);if("throw"!==s.type){var d=s.arg,u=d.value;return u&&"object"==ds(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){d.value=e,i(d)}),(function(e){return n("throw",e,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return a=a?a.then(o,o):o()}})}function w(t,n,r){var o=f;return function(a,i){if(o===m)throw new Error("Generator is already running");if(o===p){if("throw"===a)throw i;return{value:e,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var s=j(c,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===f)throw o=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=m;var d=l(t,n,r);if("normal"===d.type){if(o=r.done?p:"suspendedYield",d.arg===h)continue;return{value:d.arg,done:r.done}}"throw"===d.type&&(o=p,r.method="throw",r.arg=d.arg)}}}function j(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,j(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var a=l(o,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,h;var i=a.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function x(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(ds(t)+" is not iterable")}return g.prototype=y,o(I,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:g,configurable:!0}),g.displayName=d(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,d(e,s,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},S(O.prototype),d(O.prototype,c,(function(){return this})),t.AsyncIterator=O,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new O(u(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},S(I),d(I,s,"Generator"),d(I,i,(function(){return this})),d(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=x,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),d=r.call(i,"finallyLoc");if(s&&d){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:x(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),h}},t}function ls(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function fs(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){ls(a,r,o,i,c,"next",e)}function c(e){ls(a,r,o,i,c,"throw",e)}i(void 0)}))}}function ms(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ps(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ms(Object(n),!0).forEach((function(t){hs(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ms(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hs(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==ds(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ds(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===ds(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e[e.None=0]="None",e[e.Loading=1]="Loading",e[e.SaveApp=2]="SaveApp",e[e.Error=3]="Error",e[e.LoadingOverlay=4]="LoadingOverlay"}(cs||(cs={}));var vs={root:{width:0,height:0,display:"none",visibility:"hidden"}};function gs(e){return(gs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ys(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,bs(r.key),r)}}function bs(e){var t=function(e,t){if("object"!==gs(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==gs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===gs(t)?t:String(t)}function Cs(e,t){return(Cs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Ts(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ss(e);if(t){var o=Ss(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Is(this,n)}}function Is(e,t){if(t&&("object"===gs(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ss(e){return(Ss=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Os=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cs(e,t)}(n,e);var t=Ts(n);function n(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(r=t.call(this,e)).state={hasError:!1},r}return function(e,t,n){t&&ys(e.prototype,t),n&&ys(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"render",value:function(){return this.state.hasError?c.a.createElement(rs,{isOpen:this.props.isOpen,onDismiss:this.props.onDismiss,strings:this.props.strings},c.a.createElement(ts,{errorMessage:this.props.strings.paneLoadFailed})):this.props.children}},{key:"componentDidCatch",value:function(e,t){this.props.telemetryService.trackError(D.CommentsPaneCrashed,{eventData:t},e),this.props.onError&&this.props.onError(e,t)}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),n}(c.a.PureComponent);function ws(e){return(ws="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function js(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Es(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?js(Object(n),!0).forEach((function(t){ks(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):js(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ks(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==ws(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ws(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===ws(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ps(){Ps=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),c=new P(r||[]);return o(i,"_invoke",{value:w(e,n,c)}),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="executing",p="completed",h={};function v(){}function g(){}function y(){}var b={};d(b,i,(function(){return this}));var C=Object.getPrototypeOf,T=C&&C(C(x([])));T&&T!==n&&r.call(T,i)&&(b=T);var I=y.prototype=v.prototype=Object.create(b);function S(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function n(o,a,i,c){var s=l(e[o],e,a);if("throw"!==s.type){var d=s.arg,u=d.value;return u&&"object"==ws(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){d.value=e,i(d)}),(function(e){return n("throw",e,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return a=a?a.then(o,o):o()}})}function w(t,n,r){var o=f;return function(a,i){if(o===m)throw new Error("Generator is already running");if(o===p){if("throw"===a)throw i;return{value:e,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var s=j(c,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===f)throw o=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=m;var d=l(t,n,r);if("normal"===d.type){if(o=r.done?p:"suspendedYield",d.arg===h)continue;return{value:d.arg,done:r.done}}"throw"===d.type&&(o=p,r.method="throw",r.arg=d.arg)}}}function j(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,j(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var a=l(o,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,h;var i=a.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function x(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(ws(t)+" is not iterable")}return g.prototype=y,o(I,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:g,configurable:!0}),g.displayName=d(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,d(e,s,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},S(O.prototype),d(O.prototype,c,(function(){return this})),t.AsyncIterator=O,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new O(u(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},S(I),d(I,s,"Generator"),d(I,i,(function(){return this})),d(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=x,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),d=r.call(i,"finallyLoc");if(s&&d){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:x(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),h}},t}function xs(e){return function(e){if(Array.isArray(e))return Ns(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Fs(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function As(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function Ds(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){As(a,r,o,i,c,"next",e)}function c(e){As(a,r,o,i,c,"throw",e)}i(void 0)}))}}function Rs(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],s=!0,d=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){d=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(d)throw o}}return c}}(e,t)||Fs(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fs(e,t){if(e){if("string"==typeof e)return Ns(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ns(e,t):void 0}}function Ns(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ms=function(e){var t,n=Ic(),d=n.commentsService,u=n.systemUsersService,f=Object(s.b)().telemetryService,m=Object(i.useRef)(),p=Rs(c.a.useState(),2),h=p[0],v=p[1],b=Object(i.useRef)();m.current||(m.current=f.createScenarioTracker(R.LoadPane));var T=Rs(Object(i.useState)(Zc.NotStarted),2),I=T[0],S=T[1],O=Rs(c.a.useState(!1),2),w=O[0],E=O[1],k=Rs(c.a.useState({create:!0,write:!0,delete:!0}),2),P=k[0],x=k[1];Object(i.useEffect)((function(){m.current&&ss(I,m.current)}),[I]);var D=c.a.useCallback(Ds(Ps().mark((function t(){var n,r;return Ps().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(b.current){t.next=11;break}return t.next=3,u.whoAmI();case 3:return r=t.sent,m.current&&m.current.progress({message:"Fetched Who Am I"}),t.next=7,u.getUserPrivileges(r.UserId,e.requireAssignContainerUserPrivilege?[].concat(xs(N),["prvAssignComment"]):N);case 7:b.current=t.sent,m.current&&m.current.progress({message:"Fetched current user privileges"}),t.next=12;break;case 11:null===(n=m.current)||void 0===n||n.progress({message:"Using cached current user privileges"});case 12:if(C(b.current,F.read)){t.next=14;break}throw g(new Error("User has no required privileges to read comments"),A.MissingReadPermission);case 14:return t.abrupt("return",b.current);case 15:case"end":return t.stop()}}),t)}))),[e.onPaneLoaded,u]),M=c.a.useCallback((function(t,n){if(e.requireAssignContainerUserPrivilege&&!n&&!C(t,["prvAssignComment"]))throw g(new Error("User has no required privileges to assign comments"),A.MissingAssignPermission);x({create:C(t,F.create),write:C(t,F.write),delete:C(t,F.delete)})}),[e.requireAssignContainerUserPrivilege]),L=c.a.useCallback(function(){var t=Ds(Ps().mark((function t(n,o){var a,i,c,s,u,f,m;return Ps().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!(null===(a=e.featureGates)||void 0===a?void 0:a.checkUserPrivileges)){t.next=5;break}return t.next=4,D();case 4:f=t.sent;case 5:return t.next=7,d.getContainer(n,o);case 7:(m=t.sent)&&v(m.commentid),(null===(i=e.featureGates)||void 0===i?void 0:i.checkUserPrivileges)&&f&&M(f,!!m),S(Zc.PreloadedContainer),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),l(t.t0,r.CdsResourceNotFound)?(null===(c=e.onPaneLoaded)||void 0===c||c.call(e,!0,j.SolutionNotInstalled),S(Zc.SolutionNotInstalled)):l(t.t0,r.unManagedIdsAccessDenied)||l(t.t0,r.UserNotAssignedRoles)||y(t.t0,A.MissingReadPermission)||y(t.t0,A.MissingAssignPermission)?(null===(s=e.onPaneLoaded)||void 0===s||s.call(e,!0,j.MissingPrivileges),S(Zc.MissingPrivileges)):(null===(u=e.onPaneLoaded)||void 0===u||u.call(e,!0,j.UnknownCode),S(Zc.Failed));case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e,n){return t.apply(this,arguments)}}(),[e.onPaneLoaded,D,M,d]),B=Object(o.a)(e.artifactId),V=Object(o.a)(e.artifactType),U=B!==e.artifactId||V!==e.artifactType;Object(i.useEffect)((function(){!U||I!==Zc.Loaded&&I!==Zc.Failed||(m.current=f.createScenarioTracker(R.LoadPane),S(Zc.NotStarted))}),[e.artifactId,e.artifactType,U,I]),Object(i.useEffect)((function(){e.artifactId&&I===Zc.NotStarted&&(S(Zc.Initializing),L(e.artifactId,e.artifactType))}),[e.artifactId,e.artifactType,I]);var _=function(e,t,n,r,o){var a,i,s=cs.None,d="";return!e.artifactId&&(null===(a=e.featureGates)||void 0===a?void 0:a.showSaveForEmptyArtifactId)?s=n?cs.Loading:cs.SaveApp:e.artifactId||(null===(i=e.featureGates)||void 0===i?void 0:i.showSaveForEmptyArtifactId)?t===Zc.NotStarted||t===Zc.Initializing?s=cs.Loading:t===Zc.SolutionNotInstalled||t===Zc.MissingPrivileges||t===Zc.Failed?(s=cs.Error,d=t===Zc.SolutionNotInstalled?e.localization.strings.solutionNotInstalled:t===Zc.MissingPrivileges?e.localization.strings.missingPrivileges:e.localization.strings.paneLoadFailed):t===Zc.PreloadedContainer&&(s=cs.LoadingOverlay):(s=cs.Error,d=e.localization.strings.paneLoadFailed),s===cs.Loading||s===cs.LoadingOverlay?c.a.createElement(rs,ps({},o),c.a.createElement(os,{strings:e.localization.strings})):s===cs.Error?c.a.createElement(rs,ps({},o),c.a.createElement(ts,{errorMessage:d})):s===cs.SaveApp?c.a.createElement(rs,ps({},o),c.a.createElement(is,{strings:e.localization.strings,onSave:e.onClickSave?fs(us().mark((function t(){var n;return us().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r(!0),t.next=3,null===(n=e.onClickSave)||void 0===n?void 0:n.call(e);case 3:r(!1);case 4:case"end":return t.stop()}}),t)}))):void 0})):null}(e,I,w,E,{isOpen:e.isCommentsPaneOpen,onDismiss:e.onDismiss,strings:e.localization.strings,rootPaneStyles:null===(t=e.styles)||void 0===t?void 0:t.pane});return _&&I!==Zc.PreloadedContainer?_:c.a.createElement(c.a.Fragment,null,_,c.a.createElement(a.Stack,{styles:I!==Zc.Loaded?vs:void 0,key:"".concat(e.artifactType,"-").concat(e.artifactId)},c.a.createElement($c,Es(Es({},e),{},{userPrivileges:P,containerId:h,artifactId:e.artifactId,onPaneLoaded:function(t){var n;S(t?Zc.Failed:Zc.Loaded),null===(n=e.onPaneLoaded)||void 0===n||n.call(e,t)}}))))},Ls=function(e){var t=Object(s.b)(),n=t.httpRequestor,r=t.telemetryService,o=c.a.useMemo((function(){return{commentsService:e.commentsServiceOverride?e.commentsServiceOverride:new lc(n,r),systemUsersService:new b.a(n,r)}}),[n,r,e.commentsServiceOverride]);return c.a.createElement(Os,{telemetryService:r,isOpen:e.isCommentsPaneOpen,onDismiss:e.onDismiss,strings:e.localization.strings},c.a.createElement(Tc.Provider,{value:o},c.a.createElement(Ms,Es({},e))))},Bs=(n(1207),n(1133),function(){return i.createElement(a.Overlay,{styles:{root:{zIndex:5}}},i.createElement(a.Spinner,{size:a.SpinnerSize.large,styles:{root:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}}))})},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(307),o=n(1004),a=function(){function e(e,t){var n=this;this.apiName=e,this.DefaultCtor=t,this.reset=function(){n.instance=void 0,n.ctorStack=void 0,n.injectionStack=void 0}}return e.prototype.getAndInitialize=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(this.instance)throw new o.c("'".concat(this.apiName,"' singleton is already initialized"),o.d.reserveTag(538035215));if(!this.DefaultCtor)throw new o.c("'".concat(this.apiName,"' not initialized but no default constructor exists"),o.d.reserveTag(538035216));return this.ctorStack=Object(o.f)(),this.instance=new((e=this.DefaultCtor).bind.apply(e,Object(r.h)([void 0],t,!1)))},e.prototype.getInstanceOrThrow=function(){var e=this.instance;if(!e)throw new o.c("'".concat(this.apiName,"' singleton has not been initialized"),o.d.reserveTag(538035217));return e},e.prototype.getInstance=function(){return this.instance},e.prototype.injectImplementation=function(e){if(this.getInstance())throw new o.c("API has already been initialized.\nFirst initialization: ".concat(this.ctorStack),o.d.reserveTag(538035218));this.DefaultCtor=e},e.prototype.injectInstance=function(e){if(this.getInstance())throw new o.c("API has already been initialized or injected.\nInitialize or Inject Callstack: ".concat(this.getInjectOrInitializeStack()),o.d.reserveTag(538035219));this.injectionStack=Object(o.f)(),this.instance=e},e.prototype.getInjectOrInitializeStack=function(){var e,t;return null!==(t=null!==(e=this.ctorStack)&&void 0!==e?e:this.injectionStack)&&void 0!==t?t:"Callstack Not Retrieved"},e}()},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){return e}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.verifyType=void 0;var o=n(1420);function a(e,t){t&&e.handleError("Type of property does not match type in CustomTypes definition.")}function i(e,t,n,r){for(var a=0,i=Object.keys(t);a<i.length;a++){var c=i[a],s=n[c];if(s){var d=(0,o.readPropertyInfo)(s)[1];t[c]=u(e,t[c],d,r)}else c.startsWith("$")||e.handleError('Property "'.concat(c,'" does not exist in CustomType definition.'))}return t}function c(e,t,n){for(var r=0,o=Object.keys(t);r<o.length;r++){var a=o[r];t[a]=u(e,t[a],n)}return t}function s(e,t,n,r){if(!n)return e.handleError("Unable to generate default value for unregistered type."),t;for(var a=0,i=Object.keys(n);a<i.length;a++){var c=i[a],s=(0,o.readPropertyInfo)(n[c]),u=s[0],l=s[1];if((t.hasOwnProperty(c)||!u)&&void 0===t[c]){var f=d(e,void 0,l,r);void 0!==f&&(t[c]=f)}}return t}function d(e,t,n,r,o){if(void 0===r&&(r=!1),void 0===o&&(o=!1),!r&&!o&&null==t)if("string"==typeof n)switch(n){case"$string":return"";case"$number":return 0;case"$boolean":return!1;case"$any":return;default:return s(e,t={},e.getTypeInfo(n),r)}else{var a=n[0],i=n[1];switch(a){case"$array":return[];case"$indexer":return{};case"$union":return s(e,t={},e.getTypeInfo(i[0]),r)}}return null!=t?t:void 0}function u(e,t,n,o){if(void 0===o&&(o=!1),null!=t)if("string"==typeof n)switch(n){case"$string":a(e,"string"!=typeof t);break;case"$number":a(e,"number"!=typeof t);break;case"$boolean":a(e,"boolean"!=typeof t);break;case"$any":if("object"===r(t))for(var l=0,f=Object.keys(t);l<f.length;l++){var m=f[l];t[m]=u(e,t[m],n,o)}break;default:var p=e.getTypeInfo(n);return p?(i(e,t,p,o),s(e,t,p,o)):t}else{var h=n[0],v=n[1];switch(h){case"$array":var g=Array.isArray(t);return a(e,!g),g?c(e,t,v):t;case"$indexer":var y=!("object"===r(t)&&Array.isArray(t)||"object"!==r(t));return a(e,!y),y?c(e,t,v):t;case"$union":var b=function(e,t,n,r){for(var o=0,a=Object.keys(n);o<a.length;o++){var i=a[o],c=!0,s=e.getTypeInfo(n[i]);if(s){for(var d=0,u=Object.keys(t);d<u.length;d++){if(!s[u[d]]){c=!1;break}}if(c)return s}}}(e,t,v);return b?(i(e,t,b,o),s(e,t,b,o)):(e.handleError("Json object is not assignable to any custom type in union."),t);case"$optional":return u(e,t,v),d(e,t,n,o,!0);case"$external":if("object"===r(t)){t=u(e,t,"$any",o);var C=e.getExternalType(v);if(C&&C.parse)return C.parse(t)}}}else t=d(e,t,n,o);return t}t.verifyType=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readPropertyInfo=void 0,t.readPropertyInfo=function(e){return Array.isArray(e)&&2===e.length&&"opt-field"===e[0]?[!0,e[1]]:[!1,e]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CRekaInstance=void 0;var r=function(){function e(e,t){this.services={},this.factories={},this.nextNativePromiseId=0,this.nativePromises={},this.nativeBridge=void 0,this.registerClasses=e,this.registerServiceInstanceImpl=t}return e.prototype.initBridge=function(e,t){this.nativeBridge=e,this.registerClasses.apply(this,t),this.nativeBridge.invokeNative({serviceName:"$RekaBridge",methodName:"init",value:"",promiseId:0})},e.prototype.getConstantJson=function(e,t){this.verifyNativeBridgePresent();var n=this.nativeBridge.RekaConstants;if(void 0!==n){var r=n[e];if(void 0!==r){var o=r[t];if(void 0!==o)return o}}throw new Error('Reka native service "'.concat(e,'" must be registered before accessing it\'s constant property "').concat(t,'".')+" This error also happens when the service implementation does not use the generated code from the correct (usually the latest) version of Reka service definition.")},e.prototype.InvokeNative=function(e,t,n){this.verifyNativeBridgePresent(),this.nativeBridge.invokeNative({serviceName:e,methodName:t,value:n,promiseId:0})},e.prototype.InvokeNativeAndReturn=function(e,t,n){var r=this;return new Promise((function(o,a){var i=++r.nextNativePromiseId;r.nativePromises[i]={onSuccess:function(e){return o(e)},onFailure:function(e){return a(e)}},r.nativeBridge?r.nativeBridge.invokeNative({serviceName:e,methodName:t,value:n,promiseId:i}):a("Native bridge is not initialized.")}))},e.prototype.RegisterService=function(e,t){this.factories[e]=t},e.prototype.registerServiceInstance=function(e){this.registerServiceInstanceImpl(e)},e.prototype.invokeJavaScript=function(e){var t=this,n=e.serviceName,r=void 0===n?"":n,o=e.methodName,a=void 0===o?"":o,i=e.value,c=void 0===i?"":i,s=e.promiseId,d=void 0===s?0:s;if("$RekaBridge"===r)return this.invokeJavaScriptBridge(a,c,d);var u=(this.services[r]||(this.services[r]=this.factories[r]())).Invoke(a,c);this.nativeBridge&&u&&u.then&&u.then((function(e){return t.invokeNativeBridge("onSuccess",e,d)}),(function(e){return t.invokeNativeBridge("onFailure",e,d)}))},e.prototype.invokeNativeBridge=function(e,t,n){this.nativeBridge.invokeNative({serviceName:"$RekaBridge",methodName:e,value:t,promiseId:n})},e.prototype.invokeJavaScriptBridge=function(e,t,n){var r=this.nativePromises[n];r&&(delete this.nativePromises[n],r[e](t))},e.prototype.verifyNativeBridgePresent=function(){if(!this.nativeBridge)throw new Error("Native bridge is not initialized.")},e}();t.CRekaInstance=r},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.CRekaServiceRegistry=t.stringifyJson=t.parseJson=void 0;var o=n(1222),a=n(1224);function i(e,t){var n=e?JSON.parse(e):[];if(Array.isArray(n))return t?o.CustomTypeRegistry.validateParsedObj(n,t):n;throw new Error("Everything should be an array")}function c(e,t){if("object"===r(t))for(var n=o.CustomTypeRegistry.getExternalTypeInfos(),a=0,i=Object.keys(n);a<i.length;a++){var c=n[i[a]];if(t instanceof c.typeConstructor){c.stringify&&(t=c.stringify(t));break}}return t}function s(e){if(Array.isArray(e))return 0===e.length?"":JSON.stringify(e,c);throw new Error("Everything should be an array")}function d(e){var t,n,r;if("string"!=typeof e){switch(e[0]){case"FireAndForgetMethod":return[(t=e)[0],void 0,t[1]];case"ReturnsPromiseMethod":return[(n=e)[0],[n[1]],n[2]];case"Event":case"Constant":return[(r=e)[0],[r[1]],void 0]}}return[e,void 0,void 0]}t.parseJson=i,t.stringifyJson=s;var u=function(){function e(e,t){this.service=e,this.methodInfos=t}return e.prototype.Invoke=function(e,t){var n,r,o=d(this.methodInfos[e])[2];try{r=i(t,o)}catch(n){throw new Error("Reka service invocation failed: JSON payload (length=".concat(t.length,") for ").concat(e," is invalid.\nInner exception: ").concat(n.stack))}var a=(n=this.service)[e].apply(n,r);if(a&&a.then)return a.then((function(e){return s([e])}))},e}(),l=function(){function e(e,t){this.service=e,this.methodInfos=t}return e.prototype.Invoke=function(e,t){var n,r=d(this.methodInfos[e])[1];try{n=i(t,r)}catch(n){throw new Error("Reka native service invocation failed: JSON payload (length=".concat(t.length,") for ").concat(e," is invalid.\nInner exception: ").concat(n.stack))}this.service[e].trigger(n[0])},e}(),f=function(){function e(e){this.nativeServices={},this.rekaInstance=e}return e.prototype.registerService=function(e){var t=e.serviceInfo,n=t[0],r=t[1],o=e.factory;this.rekaInstance.RegisterService(n,(function(){return new u(o(),r)}))},e.prototype.getNativeService=function(e){var t=this,n=e[0],r=e[1],o=this.nativeServices[n];if(!o){this.nativeServices[n]=o={};for(var c=!1,u={},f=function(e){var l=d(r[e]),f=l[0],m=l[1];switch(f){case"ReturnsPromiseMethod":o[e]=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return t.rekaInstance.InvokeNativeAndReturn(n,e,s(r)).then((function(e){return i(e,m)[0]}))};break;case"FireAndForgetMethod":o[e]=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return t.rekaInstance.InvokeNative(n,e,s(r))};break;case"Event":o[e]=new a.EventImpl((function(t){t&&o.eventSubscribed(e)})),c=!0;break;case"Constant":Object.defineProperty(o,e,{configurable:!1,enumerable:!0,get:function(){return void 0===u[e]&&(u[e]=i(t.rekaInstance.getConstantJson(n,e),m)[0]),u[e]}})}},m=0,p=Object.keys(r);m<p.length;m++){f(p[m])}c&&(o.eventSubscribed=function(e){t.rekaInstance.InvokeNative("$RekaBridge","createService",n)},this.rekaInstance.RegisterService(n,(function(){return new l(o,r)})))}return o},e}();t.CRekaServiceRegistry=f},function(e,t,n){var r=n(1424),o=n(1425);e.exports=function(e,t,n){var a=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||r)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var c=0;c<16;++c)t[a+c]=i[c];return t||o(i)}},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,o=n;return[o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]]].join("")}},function(e,t,n){n(1427),e.exports=n(1095).Array.findIndex},function(e,t,n){"use strict";var r=n(1225),o=n(1438)(6),a="findIndex",i=!0;a in[]&&Array(1)[a]((function(){i=!1})),r(r.P+r.F*i,"Array",{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(1442)(a)},function(e,t,n){var r=n(1429),o=n(1430),a=n(1432),i=Object.defineProperty;t.f=n(1111)?Object.defineProperty:function(e,t,n){if(r(e),t=a(t,!0),r(n),o)try{return i(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(1110);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){e.exports=!n(1111)&&!n(1146)((function(){return 7!=Object.defineProperty(n(1431)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(1110),o=n(1094).document,a=r(o)&&r(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},function(e,t,n){var r=n(1110);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(1094),o=n(1145),a=n(1226),i=n(1147)("src"),c=n(1435),s=(""+c).split("toString");n(1095).inspectSource=function(e){return c.call(e)},(e.exports=function(e,t,n,c){var d="function"==typeof n;d&&(a(n,"name")||o(n,"name",t)),e[t]!==n&&(d&&(a(n,i)||o(n,i,e[t]?""+e[t]:s.join(String(t)))),e===r?e[t]=n:c?e[t]?e[t]=n:o(e,t,n):(delete e[t],o(e,t,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[i]||c.call(this)}))},function(e,t,n){e.exports=n(1148)("native-function-to-string",Function.toString)},function(e,t){e.exports=!1},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(1227),o=n(1149),a=n(1229),i=n(1231),c=n(1439);e.exports=function(e,t){var n=1==e,s=2==e,d=3==e,u=4==e,l=6==e,f=5==e||l,m=t||c;return function(t,c,p){for(var h,v,g=a(t),y=o(g),b=r(c,p,3),C=i(y.length),T=0,I=n?m(t,C):s?m(t,0):void 0;C>T;T++)if((f||T in y)&&(v=b(h=y[T],T,g),e))if(n)I[T]=v;else if(v)switch(e){case 3:return!0;case 5:return h;case 6:return T;case 2:I.push(h)}else if(u)return!1;return l?-1:d||u?u:I}}},function(e,t,n){var r=n(1440);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){var r=n(1110),o=n(1441),a=n(1233)("species");e.exports=function(e){var t;return o(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!o(t.prototype)||(t=void 0),r(t)&&null===(t=t[a])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){var r=n(1228);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(1233)("unscopables"),o=Array.prototype;null==o[r]&&n(1145)(o,r,{}),e.exports=function(e){o[r][e]=!0}},function(e,t,n){n(1444),e.exports=n(1095).Object.assign},function(e,t,n){var r=n(1225);r(r.S+r.F,"Object",{assign:n(1445)})},function(e,t,n){"use strict";var r=n(1111),o=n(1446),a=n(1452),i=n(1453),c=n(1229),s=n(1149),d=Object.assign;e.exports=!d||n(1146)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=d({},e)[n]||Object.keys(d({},t)).join("")!=r}))?function(e,t){for(var n=c(e),d=arguments.length,u=1,l=a.f,f=i.f;d>u;)for(var m,p=s(arguments[u++]),h=l?o(p).concat(l(p)):o(p),v=h.length,g=0;v>g;)m=h[g++],r&&!f.call(p,m)||(n[m]=p[m]);return n}:d},function(e,t,n){var r=n(1447),o=n(1451);e.exports=Object.keys||function(e){return r(e,o)}},function(e,t,n){var r=n(1226),o=n(1234),a=n(1448)(!1),i=n(1450)("IE_PROTO");e.exports=function(e,t){var n,c=o(e),s=0,d=[];for(n in c)n!=i&&r(c,n)&&d.push(n);for(;t.length>s;)r(c,n=t[s++])&&(~a(d,n)||d.push(n));return d}},function(e,t,n){var r=n(1234),o=n(1231),a=n(1449);e.exports=function(e){return function(t,n,i){var c,s=r(t),d=o(s.length),u=a(i,d);if(e&&n!=n){for(;d>u;)if((c=s[u++])!=c)return!0}else for(;d>u;u++)if((e||u in s)&&s[u]===n)return e||u||0;return!e&&-1}}},function(e,t,n){var r=n(1232),o=Math.max,a=Math.min;e.exports=function(e,t){return(e=r(e))<0?o(e+t,0):a(e,t)}},function(e,t,n){var r=n(1148)("keys"),o=n(1147);e.exports=function(e){return r[e]||(r[e]=o(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t){t.f={}.propertyIsEnumerable},function(e){e.exports=JSON.parse('{"SharedCommentsVersion":"3.70.10"}')},function(e,t,n){var r=n(726),o=n(728),a=n(1456),i=n(727),c=o((function(e){return a(r(e,i))}));e.exports=c},function(e,t,n){var r=n(1457),o=n(1459),a=n(729);e.exports=function(e,t,n){var i=e.length;if(i<2)return i?a(e[0]):[];for(var c=-1,s=Array(i);++c<i;)for(var d=e[c],u=-1;++u<i;)u!=c&&(s[c]=r(s[c]||d,e[u],t,n));return a(o(s,1),t,n)}},function(e,t,n){var r=n(593),o=n(730),a=n(731),i=n(1458),c=n(541),s=n(594);e.exports=function(e,t,n,d){var u=-1,l=o,f=!0,m=e.length,p=[],h=t.length;if(!m)return p;n&&(t=i(t,c(n))),d?(l=a,f=!1):t.length>=200&&(l=s,f=!1,t=new r(t));e:for(;++u<m;){var v=e[u],g=null==n?v:n(v);if(v=d||0!==v?v:0,f&&g==g){for(var y=h;y--;)if(t[y]===g)continue e;p.push(v)}else l(t,g,d)||p.push(v)}return p}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}},function(e,t,n){var r=n(592),o=n(1460);e.exports=function e(t,n,a,i,c){var s=-1,d=t.length;for(a||(a=o),c||(c=[]);++s<d;){var u=t[s];n>0&&a(u)?n>1?e(u,n-1,a,i,c):r(c,u):i||(c[c.length]=u)}return c}},function(e,t,n){var r=n(412),o=n(591),a=n(361),i=r?r.isConcatSpreadable:void 0;e.exports=function(e){return a(e)||o(e)||!!(i&&e&&e[i])}},function(e,t,n){"use strict";function r(){var e,t=new Promise((function(t){e={isSettled:!1,resolve:function(n){e.isSettled=!0,t(n)}}}));return Object.assign(t,e)}n.d(t,"a",(function(){return r}))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r,o=n(132),a=n(107),i=n(189);!function(e){e.Notify="Notify",e.DoNotNotify="DoNotNotify"}(r||(r={}));var c=n(1270),s=n(165);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(){u=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var a=t&&t.prototype instanceof y?t:y,i=Object.create(a.prototype),c=new A(r||[]);return o(i,"_invoke",{value:E(e,n,c)}),i}function m(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=f;var p="suspendedStart",h="executing",v="completed",g={};function y(){}function b(){}function C(){}var T={};l(T,i,(function(){return this}));var I=Object.getPrototypeOf,S=I&&I(I(D([])));S&&S!==n&&r.call(S,i)&&(T=S);var O=C.prototype=y.prototype=Object.create(T);function w(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function j(e,t){function n(o,a,i,c){var s=m(e[o],e,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==d(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(l).then((function(e){u.value=e,i(u)}),(function(e){return n("throw",e,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return a=a?a.then(o,o):o()}})}function E(t,n,r){var o=p;return function(a,i){if(o===h)throw new Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:e,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var s=k(c,r);if(s){if(s===g)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=h;var d=m(t,n,r);if("normal"===d.type){if(o=r.done?v:"suspendedYield",d.arg===g)continue;return{value:d.arg,done:r.done}}"throw"===d.type&&(o=v,r.method="throw",r.arg=d.arg)}}}function k(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var a=m(o,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var i=a.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function D(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(d(t)+" is not iterable")}return b.prototype=C,o(O,"constructor",{value:C,configurable:!0}),o(C,"constructor",{value:b,configurable:!0}),b.displayName=l(C,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,l(e,s,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},w(j.prototype),l(j.prototype,c,(function(){return this})),t.AsyncIterator=j,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new j(f(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(O),l(O,s,"Generator"),l(O,i,(function(){return this})),l(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=D,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(x),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),d=r.call(i,"finallyLoc");if(s&&d){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),x(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;x(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:D(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function l(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){l(a,r,o,i,c,"next",e)}function c(e){l(a,r,o,i,c,"throw",e)}i(void 0)}))}}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function p(e){var t=function(e,t){if("object"!==d(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===d(t)?t:String(t)}var h=function(){function e(t,n,r,o,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.httpRequestor=t,this.telemetryService=n,this.userId=o,this.environmentId=a,this.collaborationUrls=r}return function(e,t,n){t&&m(e.prototype,t),n&&m(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"getUsersPermissions",value:function(){var e=f(u().mark((function e(t){var n,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.telemetryService.createScenarioTracker(i.d.GetPermissions,a.a.Load),e.prev=1,e.next=4,this.httpRequestor.makeRequestAsync({method:o.a.Get,path:this.collaborationUrls.rpUrls.getUsersPermissionsUrl(t,this.environmentId,this.userId),responseType:"json",service:this.collaborationUrls.rpUrls.getTargetService()},n);case 4:return r=e.sent,n.complete(),e.abrupt("return",r.body.value);case 9:throw e.prev=9,e.t0=e.catch(1),null==n||n.failure(Object(s.a)(e.t0)),e.t0;case 13:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"shareAndNotify",value:function(){var e=f(u().mark((function e(t,n){var d,l,f,m=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=m.length>2&&void 0!==m[2]?m[2]:c.a.CanEdit,l=this.telemetryService.createScenarioTracker(i.d.ModifyPermissions,a.a.Update),e.prev=2,f={put:n.map((function(e){return{properties:{NotifyShareTargetOption:r.Notify,roleName:d,principal:{id:e,type:"User",tenantId:null}}}})),delete:[]},e.next=6,this.httpRequestor.makeRequestAsync({method:o.a.Post,headers:{"Content-Type":"application/json"},path:this.collaborationUrls.rpUrls.getModifyPermissionsUrl(t,this.environmentId),body:JSON.stringify(f),responseType:"json",service:this.collaborationUrls.rpUrls.getTargetService()},l);case 6:l.complete(),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(2),null==l||l.failure(Object(s.a)(e.t0)),e.t0;case 13:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"synchronizePrivileges",value:function(){var e=f(u().mark((function e(t){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.telemetryService.createScenarioTracker(i.d.ModifyPermissions,a.a.Update),e.prev=1,e.next=4,this.httpRequestor.makeRequestAsync({method:o.a.Post,headers:{"Content-Type":"application/json"},path:this.collaborationUrls.rpUrls.getSyncCommentPrivilegesUrl(t),responseType:"text",service:this.collaborationUrls.rpUrls.getTargetService()},n);case 4:n.complete(),e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(1),null==n||n.failure(Object(s.a)(e.t0)),e.t0;case 11:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()}]),e}()},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1423),o=n.n(r).a},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));var r=n(307);function o(e){var t,n=[{}];return function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];return n.every((function(e,t){return e===o[t]}))?t:(n=o,t=e.apply(void 0,Object(r.h)([],Object(r.f)(o),!1)))}}function a(e,t){var n=o(e);return function(){return n.apply(void 0,Object(r.h)([],Object(r.f)(t()),!1))}}function i(e,t,n){var a=o(t);return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.apply(void 0,Object(r.h)(Object(r.h)([],Object(r.f)(e),!1),Object(r.f)(n()),!1))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(307),o=n(1418);function a(e){var t=Object(r.f)(e,1)[0];return Object(o.a)(t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(307);function o(e){var t=e;return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t&&t.apply(void 0,Object(r.h)([],Object(r.f)(e),!1)),t=void 0}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(307);function o(e){return e.reduce((function(e,t){return Array.isArray(t)?e.push.apply(e,Object(r.h)([],Object(r.f)(o(t)),!1)):e.push(t),e}),[])}}])]);
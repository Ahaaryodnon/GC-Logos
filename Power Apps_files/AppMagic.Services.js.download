/*! For license information please see AppMagic.Services.js.LICENSE.txt */
(function(){return this?this:window}())["@pa-client/appmagic-services"]=function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=92)}([function(e,t){!function(){e.exports=function(){return this?this:window}()["@pa-client/appmagic-runtime-app"]}()},function(e,t,r){"use strict";r.r(t),r.d(t,"createEmptyGetRowsResult",(function(){return c})),r.d(t,"throwTabularErrorFromServerError",(function(){return u})),r.d(t,"logWarning",(function(){return l})),r.d(t,"logError",(function(){return p})),r.d(t,"addColumnParameter",(function(){return d})),r.d(t,"getDataValue",(function(){return h})),r.d(t,"addPatchColumnParameter",(function(){return m})),r.d(t,"followGetRowsNextLinksAsync",(function(){return y})),r.d(t,"getRemainingRowsIfNeededAsync",(function(){return v})),r.d(t,"returnLeftovers",(function(){return g})),r.d(t,"hadEnoughLeftovers",(function(){return C})),r.d(t,"validateServerResult",(function(){return _})),r.d(t,"ensureKeyIfReadOnlyTable",(function(){return b})),r.d(t,"processHttpResponse",(function(){return A}));var n=r(0),a=AppMagic.Services.Rest,o=AppMagic.Data,i=AppMagic.Services.HttpConstants,s=AppMagic.Services;function c(){return{results:o.DataTable.create()}}function u(e,t,r,a){var o,c,u,d,h,m;if(Core.Utility.isCanceledError(t))throw l(e,"Server operation cancelled.",a,t),t;if(t instanceof n.TabularDataError)throw p(e,"TabularDataError",a,t,{errorKind:n.ConnectedDataErrorKind[t.errorKind]}),t;var y=null,f=null,v=null!==(o=null==t?void 0:t.isOnline)&&void 0!==o&&o;if(t&&s.errorHasHttpResponse(t)&&Core.Utility.isNumber(t.response.status)){if(t.response.status>=200&&t.response.status<300)throw new n.TabularDataError({message:AppMagic.Strings.ConnectedDataProcessingError,errorKind:n.ConnectedDataErrorKind.InvalidServerResponse,errorClassification:Core.Telemetry.ErrorClassification.Service});400==t.response.status&&(null===(c=t.response.responseText)||void 0===c?void 0:c.indexOf("list view threshold"))>=0&&function(e){var t;if(!Core.Diagnostics.isEnabled())return;var r=Core.Diagnostics.createErrorContext({protocol:"cdp",operation:"getRowsCount",dataSource:null!==(t=null==e?void 0:e.dataSourceName)&&void 0!==t?t:""});Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.Network,"getRowsCount",{context:r,info:AppMagic.Strings.SPOListViewThrottlingExceededDetails,helpUrl:Core.Utility.formatString(AppMagic.Strings.SPOListViewThrottlingHelpURL)},Core.Diagnostics.MonitorLogLevel.Warning)}(a);var g=function(e){var t,r,n,a,o,i,s=e.response.responseText||"";if(Core.Utility.isNonEmptyString(s)){var c=AppMagic.PowerApps.ConnectorResponseError.safeCast(Core.Utility.tryParseJson(s));if(c)return c.message;var u=AppMagic.PowerApps.ConnectorResponseGatewayError.safeCast(Core.Utility.tryParseJson(s));return(null===(r=null===(t=null==u?void 0:u.error)||void 0===t?void 0:t.innerError)||void 0===r?void 0:r.message)?null===(a=null===(n=null==u?void 0:u.error)||void 0===n?void 0:n.innerError)||void 0===a?void 0:a.message:null!==(i=null===(o=null==u?void 0:u.error)||void 0===o?void 0:o.message)&&void 0!==i?i:AppMagic.Strings.UnknownServerMessage}return null}(t);y=Core.Utility.formatString(AppMagic.Strings.RuntimeErrorServiceFunctionCallFailedFormat_ServiceFunction_Error,null!==(u=null==a?void 0:a.dataSourceName)&&void 0!==u?u:"",g);var C=t.response.status;switch(t.response.headers[i.HeaderName.MsFailureCause]===i.FailureCauses.ApiHubTokenExchange&&(C=i.HttpStatusCode.ApiHubTokenExchangeError),C){case i.HttpStatusCode.XhrRequestIncomplete:d=AppMagic.Strings.ConnectedDataIncompleteError,h=n.ConnectedDataErrorKind.RequestIncomplete,f=!v;break;case i.HttpStatusCode.Conflict:d=AppMagic.Strings.ConnectedDataItemExists,h=n.ConnectedDataErrorKind.ItemExists;break;case i.HttpStatusCode.NotFound:d=AppMagic.Strings.ConnectedDataRowNotFound,h=n.ConnectedDataErrorKind.ItemNotFound,m=Core.Telemetry.ErrorClassification.User,f=!0;break;case i.HttpStatusCode.BadRequest:d=AppMagic.Strings.ConnectedDataInvalidRequest,h=n.ConnectedDataErrorKind.InvalidRequest;break;case i.HttpStatusCode.Unauthorized:d=r,h=n.ConnectedDataErrorKind.UnauthorizedRequest;break;case i.HttpStatusCode.PreconditionFailed:d=AppMagic.Strings.ConnectedDataETagMismatch,h=n.ConnectedDataErrorKind.ETagMismatch;break;case i.HttpStatusCode.Locked:d=AppMagic.Strings.ConnectedDateResourceIsLocked,h=n.ConnectedDataErrorKind.ResourceLocked,f=!0;break;case i.HttpStatusCode.Forbidden:d=r,h=n.ConnectedDataErrorKind.ForbiddenRequest,m=Core.Telemetry.ErrorClassification.User,f=!0;break;case i.HttpStatusCode.InternalServerError:case i.HttpStatusCode.NotImplemented:case i.HttpStatusCode.BadGateway:case i.HttpStatusCode.ServiceUnavailable:case i.HttpStatusCode.GatewayTimeout:case i.HttpStatusCode.HttpVersionNotSupported:d=AppMagic.Strings.ConnectedDataServerError,h=n.ConnectedDataErrorKind.ServerError,m=Core.Telemetry.ErrorClassification.Service;break;default:d=AppMagic.Strings.ConnectedDataServerError,h=n.ConnectedDataErrorKind.ServerError}}else l(e,"Unknown error occurred.",a,t),d=AppMagic.Strings.ConnectedDataUnknownError,h=n.ConnectedDataErrorKind.UnknownError;throw new n.TabularDataError({message:d,errorKind:h,serverErrorMessage:y,serverError:t,errorClassification:m,isExpectedError:f})}function l(e,t,r,n){void 0===n&&(n=null),Core.Log.warningEx(e,{message:t,error:n,eventData:r})}function p(e,t,r,n,a){void 0===n&&(n=null),void 0===a&&(a={}),Core.Log.errorEx(e,{message:t,error:n,eventData:__assign(__assign({},r),a)})}function d(e,t,r,n){if(e.creation!==o.CreationKind.ServerGenerated){var a=h(e,t,r,n);return Core.Utility.isNullOrUndefined(a),a}}function h(e,t,r,n){var a,o=e.name;return e.isPolymorphic?a=t[n(o)]:e.isNavigation?e.isArray||(a=t[n(o)]):e.isBlob?null!==r&&(a=r[o]):a=t[o],a}function m(e,t,r,n){var a=h(e,t,r,n);return Core.Utility.isUndefined(a),a}function y(e,t,r,n,a,o,i){return __awaiter(this,void 0,Promise,(function(){var s,c,u,d,h,m=this;return __generator(this,(function(y){return s=e.length,c=t,u=!1,d=function(){return __awaiter(m,void 0,void 0,(function(){var e,t,n;return __generator(this,(function(o){switch(o.label){case 0:e=[],o.label=1;case 1:o.trys.push([1,5,,6]),o.label=2;case 2:return c&&s<r&&!u?[4,a(c,s,i)]:[3,4];case 3:return null!=(t=o.sent())&&(e.push(t.items),s+=t.items.length),c=t.nextLink,[3,2];case 4:return[2,e];case 5:if(n=o.sent(),Core.PromiseUtils.throwIfCanceled(n),0===e.length)throw p("followGetRowsNextLinksAsync","Error occurred executing page.",n),n;return p("followGetRowsNextLinksAsync","Partial success executing paging. Total successful pages: ".concat(e.length),n),[2,e];case 6:return[2]}}))}))}().then((function(t){return f(e.concat.apply(e,t),n,r,c)})),h=Core.PromiseUtils.createCancellablePromise(void 0,(function(){l("TabularDataProcessorUtilities.followGetRowsNextLinksAsync","Canceled.",o),u=!0})),d.then((function(e){return h.complete(e)}),(function(e){return h.error(e)})),[2,h.promise]}))}))}function f(e,t,r,n){var a;return e.length>r&&(a=e.splice(r,e.length-r)),Core.Log.verbose("ConnectedDataConnector[{0}]: getRowsAsync (paginated) returned {1} out of {2} requested rows.",t,e.length,r),{results:e,nextLink:n,leftovers:a}}function v(e,t,r,n,a){return __awaiter(this,void 0,Promise,(function(){var o,i;return __generator(this,(function(s){switch(s.label){case 0:return null===e?(Core.Log.verbose("ConnectedDataConnector[{0}]: getRowsAsync - first page is not valid.",r),[2,null]):(o=e.items,e.nextLink&&o.length<t?[4,y(o,e.nextLink,t,r,n,a,e.maxPageSize)]:[3,2]);case 1:return i=s.sent(),[3,4];case 2:return[4,f(e.items,r,t,e.nextLink)];case 3:i=s.sent(),s.label=4;case 4:return null==e.totalRecordCount||isNaN(e.totalRecordCount)||(i.serverRowCount=e.totalRecordCount),null!=e.totalRecordLimitExceeded&&"boolean"==typeof e.totalRecordLimitExceeded&&(i.serverRowLimitExceeded=e.totalRecordLimitExceeded),[2,i]}}))}))}function g(e,t){var r=e.leftovers,n=r&&r.splice(t,r.length-t),a={results:r,nextLink:e.nextLink,leftovers:n&&(n.length>0?n:void 0)};return null==e.serverRowCount||isNaN(e.serverRowCount)||(a.serverRowCount=e.serverRowCount),a}function C(e,t){return e.leftovers&&e.leftovers.length>=t}function _(e){if(Core.Utility.isNullOrUndefined(e))throw new n.TabularDataError({message:AppMagic.Strings.ConnectedDataInvalidResult,errorKind:n.ConnectedDataErrorKind.InvalidResult});return e}function b(e,t,r){if(r.isReadonly){var n=r.tempKeyColumn.name;e.forEach((function(e,r){Core.Utility.isDefined(e[n])||(e[n]=t+r)}))}}function A(e,t){return new a.ResponseTypeResponseProcessor("json",null,t).processResponse(e).bodyParams}},function(e,t,r){"use strict";r.r(t),r.d(t,"parseServiceConfigDefinition",(function(){return f})),r.d(t,"parseServiceVariableDefinition",(function(){return v})),r.d(t,"parseAuthenticationProviderDefinition",(function(){return g})),r.d(t,"parseServiceFunctionDefinition",(function(){return C})),r.d(t,"parseFunctionParameters",(function(){return _})),r.d(t,"parseResourceDefinition",(function(){return b})),r.d(t,"parseMultipartFormDataBodyParamDefinitionListing",(function(){return A})),r.d(t,"parseFormUrlEncodedBodyParamDefinitionListing",(function(){return S})),r.d(t,"parseHeaderParamDefinitionListing",(function(){return R})),r.d(t,"parseQueryParamDefinitionListing",(function(){return D})),r.d(t,"parseParamValueStringifier",(function(){return P})),r.d(t,"implyDTypeFromJsonValue",(function(){return T})),r.d(t,"getDocTitleOrDefault",(function(){return E}));var n=r(91),a=r(14),o=r(52),i=r(54),s=r(56),c=r(58),u=r(70),l=r(17),p=r(10),d=AppMagic.Schema,h=AppMagic.Services.TypeSystem,m=AppMagic.Services.FunctionParameter,y=AppMagic.Services.ServiceConfigDeserialization.TypesManagerDeserializer;function f(e,t,r,n,o,i,s,c,u){void 0===c&&(c=null),void 0===u&&(u=null);var l=AppMagic.Services.ServiceConfigDeserialization.TypesManagerDeserializer.parseTypesManager(r.typesbyprefix,o,i,c,u);return new a.ImportedService(e,t,r,r.serviceid,l,n,s)}function v(e,t,r){return new AppMagic.Services.ServiceVariable(e,t.dtype)}function g(e,t){return(new u.ConnectionAuthenticationProviderDefinitionDeserializer).deserialize(e,t)}function C(e,t){var r;switch(e.deftype){case AppMagic.Services.ServiceConfigDeserialization.IRConstants.DefTypes.RestFunction:r=l.parseFunctionDefinition(e,t);break;case AppMagic.Services.ServiceConfigDeserialization.IRConstants.DefTypes.CompositeFunction:r=c.parseFunctionDefinition(e,t);break;default:throw new Core.NotImplementedError("parseServiceFunctionDefinition")}return e.polling&&(r=new s.PollingServiceFunction(r,e.polling.interval)),r}function _(e,t){var r=HashTableUtility.create(),n=[],a=[];return e.forEach((function(e){var o=function(e,t){var r=null,n=null;e.dtype?r=e.dtype:n=y.parseTypedDefinitionMetadata(e,t);var a=e.docid||null,o=null;void 0!==e.options&&(o=e.options);var i=void 0===e.default?null:e.default,s=void 0===e.sampledefault?null:e.sampledefault;return new m(e.name,r,n,e.required,a,o,i,s)}(e,t);r[o.name]=!0,o.isRequired?n.push(o):a.push(o)})),{requiredParameters:n,optionalParameters:a}}function b(e,t,r){var n=Object(p.parseValueExpressionDefinition)(e.baseurlvalueexpression);r.push(new AppMagic.Services.ResourceBaseUrlRequestParam(n)),e.paths&&function(e,t,r){e.forEach((function(e){var n=e.path;if(""!==n){var a=t.addPath(n),o=e.templates;o&&w(o,"name",r,(function(e,t,r,n){return new AppMagic.Services.TemplateRequestParam(a,e,t,r,n)}),null)}}))}(e.paths,t,r)}function A(e,t,r){return w(e,"name",t,(function(e,t,r){return new i.MultipartFormDataBodyTextRequestParam(e,t,r)}),(function(e,t,n){var a=new h.InlinedTTypeRef(new AppMagic.Services.TypeSystem.PABinaryTType(t,r.mediaRuntime));return new o.MultipartFormDataBodyBinaryRequestParam(e,a,n,r.guidGenerator,r.binaryResolver)}))}function S(e,t,r){return w(e,"name",t,(function(e,t,r){return new AppMagic.Services.FormUrlEncodedBodyRequestParam(e,t,r)}),(function(e,t,n){var a=new h.InlinedTTypeRef(new AppMagic.Services.TypeSystem.Base64BinaryTType(t,r.mediaRuntime,r.binaryResolver));return new AppMagic.Services.FormUrlEncodedTypedBodyRequestParam(e,a,n)}))}function w(e,t,r,n,a){e.forEach((function(e){var o,i=e[t],s=Object(p.parseValueExpressionDefinition)(e.valueexpression);if(e.type===AppMagic.Services.ServiceConfigDeserialization.IRConstants.ParamType.Base64Binary){var c=d.TypeBlob;o=a(i,c,s)}else{var u=P(e);o=n(i,u,s,!!e.useDoubleEncoding)}r.push(o)}))}function R(e,t){return w(e,"key",t,(function(e,t,r){return new AppMagic.Services.HeaderRequestParam(e,t,r)}),null)}function D(e,t){return w(e,"key",t,(function(e,t,r){return new AppMagic.Services.QueryRequestParam(e,t,r)}),null)}function P(e){var t=h.XsdUtility.tryParseNumericXsdTypeFromXsdTypeName(e.type);if(null!==t)return new AppMagic.Services.NumberParamValueStringifier(t);switch(e.type){case AppMagic.Services.ServiceConfigDeserialization.IRConstants.ParamType.Boolean:return new AppMagic.Services.BooleanParamValueStringifier;case AppMagic.Services.ServiceConfigDeserialization.IRConstants.ParamType.String:case AppMagic.Services.ServiceConfigDeserialization.IRConstants.ParamType.AnyURI:return new AppMagic.Services.StringParamValueStringifier;case AppMagic.Services.ServiceConfigDeserialization.IRConstants.ParamType.Date:return new AppMagic.Services.DateParamValueStringifier;case AppMagic.Services.ServiceConfigDeserialization.IRConstants.ParamType.DateTime:return new AppMagic.Services.DateTimeParamValueStringifier;case AppMagic.Services.ServiceConfigDeserialization.IRConstants.ParamType.Base64Binary:}}function T(e){switch(typeof e){case"boolean":return AppMagic.Schema.TypeBoolean;case"number":return AppMagic.Schema.TypeNumber;case"string":return AppMagic.Schema.TypeString;default:return null}}function E(e,t,r,a){if(!r||!Core.Utility.isString(e.docid))return t;var o=a||Object(n.currentCulture)().currentLocaleName.toLowerCase();return M(e.docid,r,o)||M(e.docid,r,"")||t}function M(e,t,r){var n=t[r];if(n){var a=n[e];if(a)return a.title}return null}},function(e,t,r){"use strict";r.r(t),r.d(t,"TableName",(function(){return n})),r.d(t,"Id",(function(){return a})),r.d(t,"FileName",(function(){return o})),r.d(t,"ObjectIdValue",(function(){return i})),r.d(t,"DocumentBody",(function(){return s})),r.d(t,"Subject",(function(){return c})),r.d(t,"MimeType",(function(){return u}));var n="annotations",a="annotationid",o="filename",i="_objectid_value",s="documentbody",c="subject",u="mimetype"},function(e,t,r){"use strict";r.r(t),r.d(t,"unwrapCdsServerErrorResponse",(function(){return o})),r.d(t,"processAndThrowTabularError",(function(){return i}));var n=r(0),a=r(1);function o(e){if(!(Core.Utility.isCanceledError(e)||e instanceof n.TabularDataError)&&AppMagic.Services.errorHasHttpResponse(e)){var t=e.response.responseText||"",r=Core.Utility.tryParseJson(t);if(r){var a=r.error;if(a){var o=JSON.stringify(a);e.response.responseText=o,e.response.response=o}}}}function i(e,t,r,n){throw o(t),Object(a.throwTabularErrorFromServerError)(e,t,r,n)}},function(e,t,r){"use strict";r.r(t),r.d(t,"ApiRuntimeUrl",(function(){return n})),r.d(t,"ConnectionName",(function(){return a})),r.d(t,"ConnectionApiId",(function(){return o})),r.d(t,"SqlDatabaseName",(function(){return i})),r.d(t,"SqlServerName",(function(){return s}));var n="api.runtimeUrl",a="connection.name",o="connection.apiId",i="database.name",s="server.name"},function(e,t,r){"use strict";r.r(t),r.d(t,"isValid",(function(){return a})),r.d(t,"safeCast",(function(){return o})),r.d(t,"createEmpty",(function(){return i}));var n=r(0);function a(e){return Core.Utility.isAnyHashTable(e)&&Object(n.AppMagicDataDataTable_isValid)(e.items)&&Core.Utility.isAbsoluteUrlStringOrUndefined(e.nextLink)&&Core.Utility.isNumberOrUndefined(e.resultCount)}function o(e){var t=e;return a(t)?t:null}function i(){return{items:[],resultCount:0}}},function(e,t,r){"use strict";r.r(t),r.d(t,"processExpandForDataRecord",(function(){return c})),r.d(t,"processTable",(function(){return u})),r.d(t,"processAttachments",(function(){return l})),r.d(t,"processAttachment",(function(){return p})),r.d(t,"processRow",(function(){return d})),r.d(t,"processBlobsAndAttachments",(function(){return h}));var n=r(0),a=AppMagic.Data,o=AppMagic.Services.ODataConstants,i=AppMagic.AppResourceUri,s=AppMagic.Services.CdpConstants;function c(e,t,r,o,i,s){var u=f(e,o.metadata),l=HashTableUtility.isEmpty(r),p=function(e){var t=0;for(var r in e){if(t>=1)return!1;t++}return 1===t}(r),d={};return HashTableUtility.forEach(e,(function(u,p){if(0!==p.indexOf("@")&&0!==p.indexOf("x-ms-")&&(l||r[p])&&!HashTableUtility.isEmpty(e)){var h=e[p];if(h){var m=t[p];if(!m)return a.DataValue.isDataRecord(u)?g(u):a.DataValue.isDataTable(u)&&u.forEach((function(e){a.DataValue.isDataRecord(e)&&g(e)})),void(d[p]=u);var y=i.tryGetNavigationConnector(o,p);if(y){if(a.DataValue.isDataRecord(h))d[p]=c(h,n.Expand.toExpandsHashTable(m.expands),n.Expand.toSelectsHashTable(m.selects),y,i,s);else{if(!a.DataValue.isDataTable(h))return;d[p]=h.map((function(e){return c(e,n.Expand.toExpandsHashTable(m.expands),n.Expand.toSelectsHashTable(m.selects),y,i,s)}))}h.nextLink&&(d[p].nextLink=h.nextLink)}else Core.Log.error("ConnectedDataProcessor.processExpandForDataRecord","Could not get connector information for property name ".concat(p,". ")+"Make sure that the navigation column exists in the current table ".concat(o.metadata.name,"."))}}})),o.metadata.hasValidPrimaryKey(e)&&!a.DataEntityRecord.isDataEntityRecord(d)&&(d=y(e,d,o,u)),h(d,o,s),p&&HashTableUtility.forEach(r,(function(e,t){var r=d[t];a.DataValue.isDataRecord(r)&&(d=r)})),d}function u(e,t,r,n,o){for(var i=r.tryGet(t),s=0,c=0,u=e.length;c<u;++c){var l=d(e[c],i,r,n,o);null!==l&&(e[s]=l,++s)}if(e.length=s,o&&o.expands&&o.selects&&1===o.selects.length){for(var p=o.selects[0],h=a.DataTable.create(),m=0;m<e.length;m++){var y=e[m][p];if(!a.DataTable.isDataTable(y))return e;h=h.concat(y)}e=h}return e}function l(e,t,r,n,a,o){for(var i=AppMagic.AppResourceUri.Templates.ConnectedDataSourceAttachmentType.expandUrl({datasourceName:t,tableName:r}),s=0,c=0,u=e.length;s<u;++s){var l=p(e[s],i,t,r,a,n,o);null!==l&&(e[c]=l,++c)}return e.length=c,e}function p(e,t,r,o,i,s,c){var u=e.Id;if(!Core.Utility.isNonEmptyString(u)||e.Value||!Core.Utility.isNonEmptyString(e.DisplayName))throw new n.TabularDataError({errorKind:n.ConnectedDataErrorKind.InvalidServerResponse,message:AppMagic.Strings.ConnectedDataUnknownError});var l=new Core.UrlBuilder(s);l.appendPath(i),l.appendPath(c.targetEntity),l.appendPath(encodeURI(u)),l.appendPath("$value");var p=l.toString();return e.Value=AppMagic.AppResourceUri.Templates.ConnectedDataSourceBlobReference.expandUrlString({datasourceName:r,tableName:o,internalRowId:i,downloadUrl:p}),a.DataEntityRecord.makeEntityRecord(e,{entityType:t,etag:null,hiddenProperties:null,odataId:null,source:"cdp",tableName:o,canonicalId:i}),e}function d(e,t,r,o,i){if(HashTableUtility.isEmpty(e))return null;var s=!1;if(i&&i.expands&&(e=c(e,n.Expand.toExpandsHashTable(i.expands),n.Expand.toSelectsHashTable(i.selects),t,r,o),s=!0),!t.metadata.hasValidPrimaryKey(e))return i&&i.selects?(v(e),e):(Core.Log.errorEx("ConnectedDataProcessor.processRow",{message:"Row is undefined, null or lacks a valid primary key. queryOptions.select not provided.",eventData:{dataSourceName:t.dataSourceName,apiId:t.connectionApiId,tableName:t.metadata.name}}),null);a.DataEntityRecord.isDataEntityRecord(e)||(e=y(e,e,t,f(e,r.primaryConnector.metadata)));return s?e:h(e,t,o)}function h(e,t,r){if(!function(e){return e.referencedblobProcessor&&(e.referencedblobProcessor.hasReferencedBlobs||e.metadata.inlineBlobColumns.length>0||e.metadata.attachmentColumns.length>0)}(t))return e;for(var n=t.metadata.getPrimaryKey(e),a=t.metadata.attachmentColumns,o=Core.Utility.generate128BitUUID(),s=0,c=a.length;s<c;++s){e[l=a[s].name]=i.Templates.ConnectedDataSourceAttachmentsId.expandUrlString({datasourceName:t.dataSourceName,tableName:t.metadata.name,internalRowId:n,propertyName:l,uniqueId:o})}var u=t.metadata.inlineBlobColumns;for(s=0,c=u.length;s<c;++s){var l,p=m(e[l=u[s].name]),d=i.Templates.ConnectedDataSourceInlineBlob.expandUrlString({datasourceName:t.dataSourceName,tableName:t.metadata.name,internalRowId:n,columnName:l});p&&r.AppReferenceToBlobLinker.updateReference(d,p),e[l]=d}return t.referencedblobProcessor.processRow(e,n),e}function m(e){if(!e)return null;var t=Core.Url.tryParse(e);return t.scheme===i.Scheme&&t.host===i.Hosts.DataSources?null:e}function y(e,t,r,n){var o=r.metadata.name;return a.DataEntityRecord.makeEntityRecord(t,{entityType:r.entityType,canonicalId:r.metadata.getPrimaryKey(e),tableName:o,odataId:n.odataId,etag:n.etag,hiddenProperties:n.hiddenProperties,source:"cdp"})}function f(e,t){var r=e[o.MetadataPropertyName.ETag]||null,n=function(e){var t=null;Core.Utility.isNonEmptyString(e[s.CdpNavigationRefIdKey])?t=e[s.CdpNavigationRefIdKey]:Core.Utility.isNonEmptyString(e[o.MetadataPropertyName.Id])&&(t=e[o.MetadataPropertyName.Id]);return t}(e),i=HashTableUtility.create();return HashTableUtility.forEach(e,(function(r,n){if(n.indexOf("@")>=0||n.indexOf("_x-ms-")>=0){if(n.indexOf("@".concat(o.NextLink))>=0||n.indexOf(AppMagic.Services.CdpConstants.MetadataPropertyNames.NextLink)>=0){var c=n.indexOf(AppMagic.Services.CdpConstants.MetadataPropertyNames.NextLink)>=0;!function(e,t,r,n){var i=n?s.MetadataPropertyNames.NextLink:"@".concat(o.NextLink),c=t.substring(0,t.indexOf(i));if(!r.navigationColumns[c]||r.navigationColumns[c].kind!==a.ColumnKind.Array)return void Core.Log.error("ConnectedDataProcessor.processAnnotatedMetadata","Column ".concat(c," with nextLink annotation should be a navigation array column. Is there a metadata mismatch?"));e[c]||(e[c]=a.DataTable.create());var u=e[t];if(!u)return;e[c].nextLink=u}(e,n,t,c)}i[n]=r,delete e[n]}})),v(e),{etag:r,odataId:n,hiddenProperties:i}}function v(e){delete e[o.MetadataPropertyName.ETag],delete e[s.CdpNavigationRefIdKey],delete e[o.MetadataPropertyName.Id]}function g(e){v(e),HashTableUtility.forEach(e,(function(e){a.DataRecord.isDataRecord(e)?g(e):Core.Utility.isArray(e)&&e.forEach((function(e){a.DataRecord.isDataRecord(e)&&g(e)}))}))}},function(e,t,r){"use strict";r.r(t),r.d(t,"safeCastListAttachmentResponse",(function(){return a})),r.d(t,"safeCastAttachmentResponse",(function(){return o})),r.d(t,"safeCastDownloadAttachmentResponse",(function(){return i})),r.d(t,"isValidListAttachmentsResponse",(function(){return s})),r.d(t,"isValidAttachmentResponse",(function(){return c})),r.d(t,"isValidDownloadAttachmentResponse",(function(){return u}));var n=r(3);function a(e){return s(e)?e:null}function o(e){return c(e)?e:null}function i(e){return u(e)?e:null}function s(e){return e&&Core.Utility.isArray(e.value)&&e.value.every(c)}function c(e){return e&&Core.Utility.isNonEmptyNonWhitespaceString(e[n.FileName])&&Core.Utility.isNonEmptyNonWhitespaceString(e[n.Id])}function u(e){return e&&Core.Utility.isNonEmptyNonWhitespaceString(e[n.DocumentBody])&&Core.Utility.isNonEmptyStringOrNullOrUndefined(e[n.MimeType])}},function(e,t,r){"use strict";r.r(t),r.d(t,"RequestDefinitionDeserializer",(function(){return a}));var n=r(2),a=function(){function e(e){this._builder=e,this._requestParams=[]}return e.prototype.parseMethod=function(e){this._builder.setMethod(e)},e.prototype.parseResource=function(e){Object(n.parseResourceDefinition)(e,this._builder,this._requestParams)},e.prototype.parseHeaderParamDefinitionListing=function(e){Object(n.parseHeaderParamDefinitionListing)(e,this._requestParams)},e.prototype.parseQueryParamDefinitionListing=function(e){Object(n.parseQueryParamDefinitionListing)(e,this._requestParams)},e.prototype.parseBody=function(e){},e.prototype.getParams=function(){return{httpRequestBuilder:this._builder,requestParams:this._requestParams}},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"parseValueExpressionDefinition",(function(){return v}));var n=r(59),a=r(34),o=r(60),i=r(61),s=r(62),c=r(63),u=r(64),l=r(65),p=r(66),d=r(2),h=r(67),m=r(68),y=r(69),f=AppMagic.Services.ServiceConfigDeserialization.IRConstants;function v(e){switch(e.deftype){case f.DefTypes.Literal:return function(e){var t=e.dtype;void 0===t&&(t=Object(d.implyDTypeFromJsonValue)(e.value));return new i.LiteralValueExpression(e.value,t)}(e);case f.DefTypes.ServiceVariableReference:return function(e){return new h.ServiceVariableReferenceExpression(e.name)}(e);case f.DefTypes.ParameterReference:return function(e){return new l.ParameterReferenceExpression(e.name)}(e);case f.DefTypes.VariableReference:return function(e){var t=new y.VariableReferenceExpression(e.name);return"string"==typeof e.pointer&&""!==e.pointer?new o.JsonPointerExpression(t,e.pointer):t}(e);case f.DefTypes.QuoteString:return function(e){var t=v(e.valueexpression);return new p.QuoteStringExpression(e.quotechar,e.escape,t)}(e);case f.DefTypes.DateTimeFormat:return function(e){var t=v(e.valueexpression);return new n.DateTimeFormatExpression(e.format,t)}(e);case f.DefTypes.StringFormat:return function(e){var t=e.valueexpressions.map((function(e){return v(e)}));return new m.StringFormatExpression(e.format,t)}(e);case f.DefTypes.FunctionCall:return function(e){var t=e.arguments.map((function(e){var t=v(e.valueexpression);return{name:e.name,expression:t}}));return new a.FunctionCallExpression(e.name,t)}(e);case f.DefTypes.BuiltInFunctionCall:return function(e){var t=HashTableUtility.create();switch(e.arguments.forEach((function(e){var r=v(e.valueexpression);t[e.name]=r})),e.name){case f.DefTypes.BuiltInFunctionName_O365ComposeRecipientsArray:return function(e,t){var r=t.emails;return new c.ComposeRecipientsArrayExpression(r)}(0,t);case f.DefTypes.BuiltInFunctionName_O365ComposeAttendeesArray:return function(e,t){var r=t.emails,n=t.type;return new s.ComposeAttendeesArrayExpression(r,n)}(0,t);default:return}}(e);case f.DefTypes.O365ParseEmailAddresses:return function(e){var t=v(e.valueexpression);return new u.ParseEmailAddressesExpression(t)}(e);default:return}}},function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i}));var n=r(19),a=AppMagic.Data,o=function(e){function t(t,r,n,a){return e.call(this,t,r,n,a)||this}return __extends(t,e),t.prototype._getDataCore=function(e,t,r,n){var a=new i(this);return this.service.addJob((function(){return a.execute(e,t,r)}),n)},t.prototype._onComplete=function(e,t){Core.Utility.isUndefined(t)&&(t=null);var r=new AppMagic.Services.ServiceCallSucceededEventArgs(this.invocationId,e.requestId,e.errorContext,t);return this.host.onServiceEvent(r),t},t.prototype._onError=function(e,t){var r;if(Core.Utility.isCanceledError(t)){var n=new AppMagic.Services.ServiceCallCanceledEventArgs(this.invocationId,e.requestId,e.errorContext,t);r=this.host.getReportableError(n)}else{var o=new AppMagic.Services.ServiceCallFailedEventArgs(this.invocationId,e.requestId,e.errorContext,t);r=this.host.getReportableError(o)}if(null!=r){var i=void 0;return AppMagic.Services.SendHttpResponse.isValid(t.response)&&(i=t.response),a.ErrorValue.createGatedError(a.ErrorKind.Network,a.ErrorSeverity.Moderate,r.errorMessage,r,i)}return a.ErrorValue.createGatedError(a.ErrorKind.Unknown,a.ErrorSeverity.Moderate)},t.prototype._onTimeout=function(e){var t=new AppMagic.Services.ServiceCallTimeoutEventArgs(this.invocationId,e.requestId,e.errorContext,e);this.host.onServiceEvent(t)},t}(n.b),i=function(e){function t(t){var r=e.call(this,t)||this;return r._timeoutId=null,r}return __extends(t,e),t.prototype.execute=function(e,t,r){var n=new AppMagic.Services.ServiceCallStartEventArgs(this.instance.invocationId,this.requestId,this.instance.serviceFunction);return this.instance.host.onServiceEvent(n),this._executeCore(e,t,r)},t.prototype.cancel=function(){null!==this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null),e.prototype.cancel.call(this)},t.prototype._onComplete=function(e){return this.instance._onComplete(this,e)},t.prototype._onError=function(e){return this.instance._onError(this,e)},t.prototype._onBeforeAsyncStep=function(){var e=this,t=this.instance.timeout;t>=0&&(this._timeoutId=setTimeout((function(){e._timeoutId=null,e.instance._onTimeout(e)}),t))},t.prototype._onAfterAsyncStep=function(){null!==this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null)},t}(n.a)},function(e,t,r){"use strict";r.r(t),r.d(t,"createConnectedDataConnector",(function(){return h})),r.d(t,"createDataSourceForExtensionDataComponent",(function(){return m})),r.d(t,"parseDataSourceDefinition",(function(){return y})),r.d(t,"createDataSourceFromCdsTableMetadata",(function(){return f})),r.d(t,"createCdsDataSetConnector",(function(){return v})),r.d(t,"createClientDataProcessingService",(function(){return C}));var n=r(0),a=r(43),o=r(40),i=r(42),s=r(35),c=r(46),u=r(14),l=r(28),p=r(38),d=AppMagic.Services;function h(e,t,r,n,a,i,s,c,p,h,m,y,f,v){void 0===f&&(f=!1),void 0===v&&(v=!0);var g,C=AppMagic.Data.ConnectedDataDeserialization.parseCdpTableDefinitionMetadata(t);g=t.cdpTabularRevisionBaseUrl?new Core.Url(t.cdpTabularRevisionBaseUrl):null;var _=t.datasetName,b=function(e){return e&&(_=e),_},A=u.ImportedService.createService(t.name,!1,t.serviceDef,r,i,s,Core.GuidGenerator.DefaultInstance,l.a,new d.NoOpServiceHost,c,h,n,a,b,m);return new o.CdpConnector(e,C,t.datasetName,m,g,r,a,p,c,y,A,f,v,b)}function m(e,t,r,a,o,i,s,u,l){var p=new Core.Lazy((function(){return l.dataSources.getDataSources().find((function(e){return e instanceof n.CdsDataSource&&e.logicalName===r})).connector.metadata})),d=new c.DataComponentConnector(e,p,a,o);return new n.DataComponentDataSource(e,t,o,d,p,u,l.dataManager.queryDataProvider,i,!1,s)}function y(e,t,r,a,o,s,c,u){var l=new i.CdpConnectorManager(e,t.primaryTableName,t.entityDefinitions,r,a,s,c,u&&u.strongConsistency,t.encodeDataset);return new n.CdpDataSource(e,o,l,a.dataManager.queryDataProvider,t.maxGetRowsCount,u&&u.selects)}function f(e,t,r,a,o,i,c,u,l){var p=new s.CdsConnector(e,r,a,o.mediaRuntime,i,g(null==c?void 0:c.name)?o.cdsNativeHttpClient:o.appHttpClient,o.appHostClient,t,c);return new n.CdsDataSource(e,t.name,t.datasetName,t.entitySetName,p,new Core.Lazy((function(){return t})),u,o.dataManager.queryDataProvider,c,t.isHidden,t.maxGetRowsCount,function(e,t,r,a){return g(r)&&AppMagic.Utility.IsMdlIntegrationEnabled()?new n.MdlCdsMetadataProvider(AppMagic.Utility.getCdsMdlMetadataClient(),void 0):new n.NativeCdsMetadataProvider(e,t,a)}(o.dataManager.queryDataProvider,e,null==c?void 0:c.name,p),l)}function v(e){return new a.CdsDataSetConnector(e)}function g(e){return e===AppMagic.ConnectionHub.Constants.CdsDefaultDatasetName}function C(){return new p.ClientDataProcessingService}},function(e,t,r){"use strict";r.r(t),r.d(t,"ServiceFunctionBase",(function(){return a}));var n=r(11),a=function(){function e(e,t,r,n,a,o,i,s,c,u,l){void 0===u&&(u=!1),void 0===l&&(l=0),this._service=e,this.functionDefinition=t,this._name=r,this._docId=n,this._disableTryIt=a,this._isHiddenFromRules=o,this._isShownInBackstage=i,this._invocations=HashTableUtility.create(),this._defaultInvocation=null,this._requiredParameters=s,this._optionalParameters=c,this._isCacheEnabled=u,this._cacheTimeoutMs=l}return Object.defineProperty(e.prototype,"service",{get:function(){return this._service},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docId",{get:function(){return this._docId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"disableTryIt",{get:function(){return this._disableTryIt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHiddenFromRules",{get:function(){return this._isHiddenFromRules},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isShownInBackstage",{get:function(){return this._isShownInBackstage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCacheEnabled",{get:function(){return this._isCacheEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cacheTimeoutMs",{get:function(){return this._cacheTimeoutMs},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isAutoRefreshable",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isGenerated",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBehaviorOnly",{get:function(){Contracts.checkAbstract()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"requiredParameters",{get:function(){return this._requiredParameters},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"optionalParameters",{get:function(){return this._optionalParameters},enumerable:!1,configurable:!0}),e.prototype.getParameter=function(e){return this.tryGetParameter(e)},e.prototype.tryGetParameter=function(e){for(var t=0;t<this._requiredParameters.length;t++)if(this._requiredParameters[t].name===e)return this._requiredParameters[t];for(t=0;t<this._optionalParameters.length;t++)if(this._optionalParameters[t].name===e)return this._optionalParameters[t];return null},e.prototype.getVariable=function(e){return this.tryGetVariable(e)},e.prototype.tryGetVariable=function(e){return null},e.prototype._ensureServiceIsValidAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this._service.loadAsync()];case 1:if(e.sent(),!this._service.executionContext.isServiceValid){if(this._service.executionContext.error)throw new Error(this._service.executionContext.error.message);throw new Error(AppMagic.Strings.ServiceFunctionErrorServiceInvalid)}return[2]}}))}))},e.prototype.removeFunctionInvocation=function(e){var t=this._invocations[e];Core.Utility.isObject(t)&&(delete this._invocations[e],t.dispose())},e.prototype.getFunctionInvocation=function(e,t){if(Core.Utility.isUndefined(e))return Core.Utility.isDefined(t)?this.createDefaultFunctionInvocation(t):(null===this._defaultInvocation&&(this._defaultInvocation=this.createDefaultFunctionInvocation(void 0)),this._defaultInvocation);var r=this._invocations[e];return Core.Utility.isObject(r)||(r=this.createFunctionInvocation(e,t),this._invocations[e]=r),r},e.prototype.createFunctionInvocation=function(e,t){return new n.b(this,this._service.serviceHost,t,e)},e.prototype.createDefaultFunctionInvocation=function(e){return new n.b(this,this._service.serviceHost,e,null)},e.prototype.dispose=function(){},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ImportedService",(function(){return c}));var n=r(0),a=r(5),o=r(17),i=r(2),s=r(18),c=function(){function e(e,t,r,a,o,i,c){this._serviceNamespace=e,this._isConnectedService=t,this._isValid=!0,this._serviceDef=r,this._id=a,this._typesMgr=o,this._authenticationProviders=HashTableUtility.create(),this._functions=HashTableUtility.create(),this._variables=HashTableUtility.create(),this._serviceHost=i,this._appHostClient=c,this._promiseCollection=new n.PromiseCollection,this._executionContext=new s.ServiceExecutionContext(this),this._connectedMetadata=null}return e.createService=function(e,t,r,n,a,o,s,c,u,l,p,d,h,m,y){void 0===m&&(m=null),void 0===y&&(y=null);var f=Object(i.parseServiceConfigDefinition)(e,t,r,u,l,p,h,m,y);return f.parseContext={serviceNamespace:e,service:f,appHttpClient:n,guidGenerator:s,multipartBoundaryGenerator:c,typesMgr:f.typesManager,mediaRuntime:l,binaryResolver:p,authenticationService:d,restHostClient:o,restXhrClient:a},r.variables&&HashTableUtility.forEach(r.variables,(function(e,t){f._variables[t]=Object(i.parseServiceVariableDefinition)(t,e,f.parseContext)})),null!==r.auths&&r.auths.forEach((function(e){var t=Object(i.parseAuthenticationProviderDefinition)(e,f.parseContext);f.authenticationProviders[e.id]=t})),r.functions.forEach((function(e){var t=Object(i.parseServiceFunctionDefinition)(e,f.parseContext);f.functions[t.name]=t})),f},e.prototype.addDynamicResponse=function(e,t,r,n){var a=AppMagic.Services.ServiceConfigDeserialization.TypesManagerDeserializer.parseTypesManager(JSON.parse(e),this.parseContext.mediaRuntime,this.parseContext.binaryResolver);this.parseContext.typesMgr.combineTypesManagers(a);var i=this.functions[n],s=Object(o.parseFunctionResultDefinition)(JSON.parse(t),this.parseContext);i.addDynamicResultForm(r,s)},e.prototype.removeDynamicResponse=function(e,t){this.functions[t].removeDynamicResultForm(e),this.parseContext.typesMgr.removeTypesBySubstring(e)},Object.defineProperty(e.prototype,"serviceNamespace",{get:function(){return this._serviceNamespace},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serviceDefinition",{get:function(){return this._serviceDef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typesManager",{get:function(){return this._typesMgr},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"functions",{get:function(){return this._functions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authenticationProviders",{get:function(){return this._authenticationProviders},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serviceHost",{get:function(){return this._serviceHost},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"executionContext",{get:function(){return this._executionContext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"variableNames",{get:function(){return Object.keys(this._variables)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectedMetadata",{get:function(){return this._connectedMetadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"promiseCollection",{get:function(){return this._promiseCollection},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isValid",{get:function(){return this._isValid},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sharedConnectionId",{get:function(){return this._sharedConnectionId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDisposed",{get:function(){return null===this._promiseCollection},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parseContext",{get:function(){return this._parseContext},set:function(e){this._parseContext=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this._error},set:function(e){this._error=e},enumerable:!1,configurable:!0}),e.prototype.getVariable=function(e){return this._variables[e]},e.prototype.addJob=function(e,t){return this._promiseCollection.addJob(e,t)},e.prototype.setConnectedMetadata=function(e){this._connectedMetadata={apiId:e}},e.prototype.getCdsActionInfo=function(){var e;return null===(e=this._serviceDef)||void 0===e?void 0:e.cdsActionInfo},e.prototype.loadAsync=function(){var e;return __awaiter(this,void 0,Promise,(function(){var t,r,n,o;return __generator(this,(function(i){switch(i.label){case 0:return this._isConnectedService?(t=this.getCdsActionInfo(),r=null,t?[4,this._appHostClient.getCdsDataSourceConfigAsync(this.serviceNamespace)]:[3,2]):[2];case 1:return n=i.sent(),r={apiId:this.serviceNamespace,connectionName:this.serviceNamespace,runtimeUrl:null===(e=null==n?void 0:n.config)||void 0===e?void 0:e.runtimeUrl},[3,4];case 2:return[4,this._appHostClient.tryGetDataSourceConfigAsync(this.serviceNamespace)];case 3:r=i.sent(),i.label=4;case 4:return!r||r.error?(Core.Telemetry.Log.trackActivityEvent("ImportedService.loadAsync",{message:"The connection reference has not been resolved. This instance will be put into an invalid state.",serviceNamespace:this.serviceNamespace,error:null==r?void 0:r.error}),this._isValid=!1,this._error=null==r?void 0:r.error,[2]):(Core.Telemetry.Log.trackActivityEvent("ImportedService.loadAsync",{message:"The datasource config was successfully retrieved.",serviceNamespace:this.serviceNamespace,isDataverseAction:!!t,appDataSourceConfig:JSON.stringify(r)}),this.getVariable(a.ApiRuntimeUrl).value=r.runtimeUrl,(o=this.getVariable(a.ConnectionName)).value=r.connectionName,!Core.Environment.isAuthoringTool()&&Core.Utility.isNonEmptyString(r.runtimePolicyName)&&(o.value=r.runtimePolicyName,this._sharedConnectionId=r.connectionName,Core.Telemetry.Log.trackActivityEvent("UsingRuntimePolicy",{apiId:r.apiId,sharedConnectionId:r.connectionName,runtimePolicyId:r.runtimePolicyName})),this.getVariable(a.ConnectionApiId).value=r.apiId,this.updateConnectorSpecificServiceVariables(r),this.setConnectedMetadata(r.apiId),[2])}}))}))},e.prototype.updateConnectorSpecificServiceVariables=function(e){var t,r;if(AppMagic.ConnectionHub.PowerAppsConnectionService.isSqlApi(e.apiId)){var n=this.getVariable(a.SqlServerName),o=this.getVariable(a.SqlDatabaseName),i=null!==(r=null===(t=e.cdpOverrides)||void 0===t?void 0:t.datasetName)&&void 0!==r?r:e.datasetName;if(n&&o&&i){var s=i.split(",");s&&2==s.length?(n.value=s[0],o.value=s[1]):s&&s.length>2&&(n.value=encodeURIComponent(s.slice(0,-1).join(",")),o.value=s[s.length-1])}}},e.prototype.dispose=function(){HashTableUtility.forEach(this._authenticationProviders,(function(e){return e.dispose()})),this._authenticationProviders=null,this._promiseCollection.cancelAll(),this._promiseCollection=null,HashTableUtility.forEach(this._functions,(function(e){return e.dispose()})),this._functions=null},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"RestResponseValueExpressionBase",(function(){return n}));var n=function(){function e(e){this._paramSchemaProvider=e}return e.prototype.computeSchema=function(e){return this._paramSchemaProvider.computeDValueSchema(e)},e}()},function(e,t,r){"use strict";function n(e){if(null===e||"string"!=typeof e)return null;var t=e.trim().split(";"),r=[];return t.forEach((function(e){var t=function(e){if(null===e)return null;var t=e.trim();if(""===t)return null;var r=/[^\s@]+@[^\s@]+\.[^\s@]+/,n=/\s/g,a=null,o=null,i=r.test(t),s=t.match(/<(.*?)>/);if(null!==s&&2===s.length){var c=s[1].trim();r.test(c)&&!n.test(c)&&(o=c);var u=t.match(/(.*?)</);null!==u&&2===u.length&&(a=u[1].trim())}else if(i&&!n.test(t))o=t;else{if(i)return null;a=t}var l={};null!==a&&(l.Name=a);null!==o&&(l.Address=o);return l}(e);null!==t&&r.push(t)})),r}r.r(t),r.d(t,"parseEmailAddressesString",(function(){return n}))},function(e,t,r){"use strict";r.r(t),r.d(t,"parseFunctionDefinition",(function(){return A})),r.d(t,"parseFunctionResultDefinition",(function(){return S}));var n=r(36),a=r(47),o=r(27),i=r(48),s=r(49),c=r(20),u=r(51),l=r(71),p=r(72),d=r(73),h=r(74),m=r(75),y=r(76),f=r(2),v=r(77),g=AppMagic.Services.Rest,C=AppMagic.Schema,_=AppMagic.Services.HttpConstants,b=AppMagic.Services.ServiceConfigDeserialization.IRConstants;function A(e,t){var r,n,a=Object(f.parseFunctionParameters)(e.parameters,t),o=null;switch(e.request.body&&(o=e.request.body.mediatype),o){case b.RequestMediaType.FormUrlEncoded:n=new d.FormUrlEncodedRequestDefinitionDeserializer(t);break;case b.RequestMediaType.Json:n=new h.JsonRequestDefinitionDeserializer(t);break;case b.RequestMediaType.MultipartFormData:n=new y.MultipartFormDataRequestDefinitionDeserializer(t);break;case b.RequestMediaType.Binary:n=new u.BinaryBodyRequestDefinitionDeserializer(t);break;default:n=new p.BodilessRequestDefinitionDeserializer}!function(e,t){t.parseMethod(e.method),t.parseResource(e.resource),t.parseQueryParamDefinitionListing(e.querystringparameters),t.parseHeaderParamDefinitionListing(e.headers),t.parseBody(e.body)}(e.request,n);var i=e.request.auth,c=n.getParams(),l=S(e.response,t),m=new Map;null===(r=e.dynamicResponses)||void 0===r||r.forEach((function(e){return m.set(e.id,S(e.response,t))}));var v=e.isSafe||function(e){return e===_.Method.GET||e===_.Method.HEAD}(e.request.method),g=!0===e.disabletryit,C=e.docid||null;return new s.RestServiceFunction(t.service,e,e.name,C,g,!1,!0,!v,a.requiredParameters,a.optionalParameters,i,c.httpRequestBuilder,c.requestParams,l,m,e.isHostFunction?t.restHostClient:t.restXhrClient,e.isCacheEnabled,e.cacheTimeoutMs)}function S(e,t){switch(e.resultform){case b.ResultForm.Void:return function(e){var t=new i.RestResponseLiteralValueExpression(e,C.TypeUntypedObject),r=HashTableUtility.create(),n=new g.XhrProcessor(e,r,null);return new c.RestServiceFunctionResultForm(n,t)}(e);case b.ResultForm.Self:return function(e,t){var r=w(e.body.mediatype,t),n=r.parseResponseBodyValueDefinition(e.body),o=new a.RestResponseBodyValueExpression(n),i=HashTableUtility.create(),s=r.createResponseProcessor(n,i),u=HashTableUtility.create(),l=new g.XhrProcessor(e,u,s);return new c.RestServiceFunctionResultForm(l,o)}(e,t);case b.ResultForm.Single:return function(e,t){var r=w(e.body.mediatype,t),a=e.body.param,o=r.parseResponseParamDefinition(a),i=HashTableUtility.create();i.single=o;var s=new n.RestResponseBodyParamValueExpression("single",o),u=r.createResponseProcessor(null,i),l=HashTableUtility.create(),p=new g.XhrProcessor(e,l,u);return new c.RestServiceFunctionResultForm(p,s)}(e,t);case b.ResultForm.Aggregate:return function(e,t){var r=HashTableUtility.create(),a=HashTableUtility.create(),i=w(e.body.mediatype,t);Object.keys(e.body.params).forEach((function(t){var s=t,c=e.body.params[t],u=i.parseResponseParamDefinition(c);a[t]=u;var l=new n.RestResponseBodyParamValueExpression(t,u);r[s]=o.RestResponseComposeObjectValueExpression.createProperty(c.displayidx,l)}));var s=new o.RestResponseComposeObjectValueExpression(r),u=i.createResponseProcessor(null,a),l=HashTableUtility.create(),p=new g.XhrProcessor(e,l,u);return new c.RestServiceFunctionResultForm(p,s)}(e,t);default:return}}function w(e,t){switch(e){case b.ResponseMediaType.Json:return new m.JsonResponseBodyDefinitionDeserializer(t);case b.ResponseMediaType.Xml:return new v.XmlResponseBodyDefinitionDeserializer(t);default:return new l.BinaryDataResponseBodyDefinitionDeserializer(t)}}},function(e,t,r){"use strict";r.r(t),r.d(t,"ServiceExecutionContext",(function(){return n}));var n=function(){function e(e){this._service=e}return Object.defineProperty(e.prototype,"isServiceValid",{get:function(){return this._service.isValid},enumerable:!1,configurable:!0}),e.prototype.getFunction=function(e){return this._service.functions[e]},e.prototype.getVariableValue=function(e){return this._service.getVariable(e).value},Object.defineProperty(e.prototype,"error",{get:function(){return this._service.error},enumerable:!1,configurable:!0}),e}()},function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return i}));var n=AppMagic.Services.PrimitiveDArgument,a=function(){function e(e,t,r,n){this._serviceFunction=e,this._host=t,this._dynamicInstanceId=r,this._invocationId=n,this._disposed=!1}return Object.defineProperty(e.prototype,"disposed",{get:function(){return this._disposed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"service",{get:function(){return this._serviceFunction.service},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serviceFunction",{get:function(){return this._serviceFunction},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"host",{get:function(){return this._host},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeout",{get:function(){return this._host.timeoutInterval},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"invocationId",{get:function(){return this._invocationId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dynamicInstanceId",{get:function(){return this._dynamicInstanceId},enumerable:!1,configurable:!0}),e.prototype.getData=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n,a=AppMagic.Data.ErrorValue.getFirstError(t);return a?Promise.resolve(a):(Core.PromiseUtils.throwIfAborted(null==e?void 0:e.abortSignal),t[0]instanceof AbortController&&(n=t[0],t=t.slice(1)),this._getDataCore(e,!1,t,n))},e.prototype.getDataWithoutValidation=function(e,t){return this._getDataCore(e,!0,t)},e.prototype.dispose=function(){this._disposed=!0,this.disposeCore()},e.prototype.disposeCore=function(){},e}(),o=0,i=function(){function e(e,t){void 0===t&&(t=new AbortController),this._instance=e,this._requestId=o++,this._promise=null,this._promiseAbortController=t,this._errorContext=null}return Object.defineProperty(e.prototype,"instance",{get:function(){return this._instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"requestId",{get:function(){return this._requestId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"errorContext",{get:function(){return this._errorContext},enumerable:!1,configurable:!0}),e.prototype.cancel=function(){null!==this._promise&&Core.PromiseUtils.abortPromise(this._promise,this._promiseAbortController)},e.prototype._executeCore=function(e,t,r){var n=this;this._errorContext=e;for(var a=0,o=this._instance.serviceFunction.requiredParameters.length;a<o;a++)if(!Core.Utility.isValue(r[a])){var i=this._createNullParamError(this._instance.serviceFunction.requiredParameters[a].name);return this._promise=Promise.reject(i),this._promise.then(null,(function(e){return n._onError(e)}))}var s=this._generateArgMap(r),c=Core.Diagnostics.createErrorContext({protocol:"rest",operation:this._instance.serviceFunction.name,dataSource:this._instance.service.serviceNamespace},e);return this._promise=this._instance.serviceFunction.runAsync(s,{onBeforeAsyncStep:function(){n._onBeforeAsyncStep()},onAfterAsyncStep:function(){n._onAfterAsyncStep()},skipValidation:t,dynamicInstanceId:this.instance.dynamicInstanceId,errorContext:c},this._promiseAbortController).then((function(e){return n._onComplete(e)}),(function(e){return n._onError(e)})),this._promise},e.prototype._onBeforeAsyncStep=function(){},e.prototype._onAfterAsyncStep=function(){},e.prototype._createNullParamError=function(e){return new Error(Core.Utility.formatString(AppMagic.Strings.RestErrorNullParam,this._instance.serviceFunction.name,e))},e.prototype._generateArgMap=function(e){var t=HashTableUtility.create();return this._populateRequiredParameterValues(e,t),this._populateOptionalParameterValues(e,t),t},e.prototype._populateRequiredParameterValues=function(e,t){for(var r=this._instance.serviceFunction.requiredParameters,a=r.length,o=0;o<a;o++){var i=r[o],s=e[o];t[i.name]=new n(s)}},e.prototype._populateOptionalParameterValues=function(e,t){var r=this._instance.serviceFunction.requiredParameters,a=this._instance.serviceFunction.optionalParameters,o=a.length;if(0!==o){var i=e[r.length];i=Core.Utility.isUndefined(i)?HashTableUtility.create():HashTableUtility.fromJsonObject(i);for(var s=0;s<o;s++){var c=a[s],u=i[c.name];Core.Utility.isUndefined(u)&&Core.Utility.isValue(c.defaultValue)&&(u=c.defaultValue),Core.Utility.isDefined(u)&&(t[c.name]=new n(u))}}},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"RestServiceFunctionResultForm",(function(){return n}));var n=function(){function e(e,t){this._xhrProcessor=e,this._responseValueExpr=t}return Object.defineProperty(e.prototype,"xhrProcessor",{get:function(){return this._xhrProcessor},enumerable:!1,configurable:!0}),e.prototype.computeSchema=function(e){return this._responseValueExpr.computeSchema(e)},e.prototype.evaluate=function(e){return this._responseValueExpr.evaluate(e)},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ReferencedBlobProcessor",(function(){return l}));var n=r(0),a=r(29),o=AppMagic.Data,i=AppMagic.AppResourceUri,s=function(){function e(e){this._metadata=e}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this._metadata},enumerable:!1,configurable:!0}),e.prototype.upload=function(e,t,r){Core.Utility.isDefined(e)&&(t[this._metadata.name]=e)},e.prototype.tryConvertServerValue=function(e,t){return null},e}(),c=[Core.UrlScheme.Blob,Core.UrlScheme.Data,Core.UrlScheme.MsAppx,Core.UrlScheme.MsAppData,i.Scheme],u=function(e){function t(t,r,n){var a=e.call(this,t)||this;return a._processor=r,a._info=n,a}return __extends(t,e),t.prototype.upload=function(e,t,r){if(!Core.Utility.isUndefined(e)){var a=this.metadata.name;if(Core.Utility.isNonEmptyString(e)){var o=Core.Url.tryParse(e),s=!1;if(o&&(o.isAbsolute&&c.indexOf(o.scheme)>=0||Object(n.isSessionStorageUrl)(o.toString()))&&(s=!0),s){if(o.scheme===i.Scheme){var u=this._processor.tryGetExistingBlobReference(o);if(u)return void(t[a]=u)}r.push(this._processor.startUploadMediaUriOperation(a,this._info,t,o))}else t[a]=e}else t[a]=e}},t.prototype.tryConvertServerValue=function(e,t){if(!Core.Utility.isNonEmptyString(e))return null;var r=Core.Url.tryParse(e);return r&&r.isAbsolute&&this._info.baseUrl.isBaseOf(r)?this._processor.createBlobReferenceAppResUri(t,e):null},t}(s),l=function(){function e(e,t){this._owner=e,this._mediaResolver=t,this._columns=[]}return Object.defineProperty(e.prototype,"hasReferencedBlobs",{get:function(){var e=this._columns;return e&&e.length>0},enumerable:!1,configurable:!0}),e.prototype.parseMetadata=function(e){if(this._columns=[],e){var t=o.JsonSchemaObjectType.safeCast(e.schema.items);if(null!==t)for(var r=this._owner.metadata.columns,n=0,a=r.length;n<a;++n){var i=r[n];i.containsReferencedBlobs()&&this._columns.push(this._getColumnProcessor(i,t.properties[i.name]))}}},e.prototype.uploadReferencedBlobsAsync=function(e,t){for(var r=this,n=[],a=0,o=this._columns.length;a<o;++a){var i=this._columns[a];i.upload(e[i.metadata.name],t,n)}return Core.PromiseUtils.join(n.map((function(e){return e.promise}))).then((function(){return t}),(function(e){var t=e[Object.keys(e)[0]];Core.Log.verbose("CdpConnector[{0}]: _prepareBlobColumnsAsync - blob processing failed, deleting uploaded blobs",r._owner.dataSourceName);var a=n.map((function(e){if(e.uploaded)return r._owner.callDeleteReferencedBlobAsync(e.info.baseUrl,e.info.folderPath,e.uploadedEntity.Name).catch(Core.Utility.noOpFn)}));return Core.PromiseUtils.join(a).then((function(){return Promise.reject(t)}))}))},e.prototype.processRow=function(e,t){for(var r=0,n=this._columns.length;r<n;++r){var a=this._columns[r],o=a.metadata.name,i=e[o];if(i){var s=a.tryConvertServerValue(i,t);s&&(e[o]=s)}}},e.prototype._getColumnProcessor=function(e,t){if(!e.containsReferencedBlobs())return new s(e);var r=o.ConnectedDataRelativeMediaType.safeCast(t);if(null===r)return new s(e);var n,a=new Core.Url(r["x-ms-media-base-url"]);if(!a.isAbsolute)throw new Error("Relative media column '".concat(e.name,"' must define the property '").concat("x-ms-media-base-url","' and it must be an absolute url."));return n=Core.Utility.equalsIgnoreCase(r["x-ms-media-upload-format"],o.BlobUploadFormat[o.BlobUploadFormat.InlineDataUri])?o.BlobUploadFormat.InlineDataUri:o.BlobUploadFormat.UploadFile,new u(e,this,{baseUrl:a,folderPath:r["x-ms-media-default-folder-path"],uploadFormat:n})},e.prototype.createBlobReferenceAppResUri=function(e,t){return i.Templates.ConnectedDataSourceBlobReference.expandUrlString({datasourceName:this._owner.dataSourceName,tableName:this._owner.metadata.name,internalRowId:e,downloadUrl:t})},e.prototype.tryGetExistingBlobReference=function(e){return this._owner.tryGetExistingBlobReference(e)},e.prototype.startUploadMediaUriOperation=function(e,t,r,n){var i=this;Core.Log.verbose("ReferencedBlobProcessor[{0}]: startUploadMediaUriOperation",this._owner.dataSourceName);var s={info:t,uploaded:!1,promise:null};return s.promise=Promise.resolve().then((function(){return __awaiter(i,void 0,void 0,(function(){var e;return __generator(this,(function(r){switch(r.label){case 0:return t.uploadFormat===o.BlobUploadFormat.InlineDataUri?[2,n.toString()]:[4,this._mediaResolver.getMediaAsBinaryAsync(n.toString())];case 1:if(!(e=r.sent()))throw new a.MediaResourceError("Failed to resolve media uri.");return[2,this._createRelativeBlobUrlUploadValueAsync(e,t.baseUrl,t.folderPath,s)]}}))}))})).then((function(t){r[e]=t}),(function(e){return Core.PromiseUtils.throwIfCanceled(e),Core.Log.error("ReferencedBlobProcessor.startUploadMediaUriOperation",e,"mediaUri: ".concat(n.toString(),", dataSourceName: ").concat(i._owner.dataSourceName,".")),Promise.reject(e)})),s},e.prototype._createRelativeBlobUrlUploadValueAsync=function(t,r,n,a){var o=this,i=Core.Utility.generateNonDashedUUID();if(t.contentType){var s=AppMagic.Services.ServiceUtility.tryGetMimeTypeFromContentType(t.contentType);s&&(i+=Core.MimeTypes.tryGetFileExtension(s)||"")}return this._owner.uploadReferencedBlobAsync(r,n,i,t).then((function(t){return Core.Log.verbose("ReferencedBlobProcessor[{0}]: startUploadMediaUriOperation - appres blob uploaded successfully",o._owner.dataSourceName),a.uploaded=!0,a.uploadedEntity=t,e.composeRelativeBlobUrlStringFromEntity(r,t.Path)}))},e.composeRelativeBlobUrlStringFromEntity=function(e,t){var r=new Core.UrlBuilder(e);return r.appendSegment("GetFileContentByPath"),r.setQueryParam("path",t),r.doneToString()},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"MultipartFormDataHttpRequestBuilder",(function(){return n}));var n=function(e){function t(t){var r=e.call(this)||this;return r._boundaryGenerator=t,r._parts=[],r}return __extends(t,e),t.prototype.clone=function(){var e=new t(this._boundaryGenerator);return this._cloneTo(e),e},t.prototype._cloneTo=function(t){e.prototype._cloneTo.call(this,t),t._parts=this._parts.map((function(e){return e.clone()}))},t.prototype.addPart=function(e){this._parts.push(e)},t.prototype._generateBodyBinary=function(){var e=this._boundaryGenerator.generateBoundary(),t=this.generateBodyDatums(e),r="".concat(AppMagic.Services.HttpConstants.MediaType.MultipartFormData,'; boundary="').concat(e,'"'),n=new Blob(t,{type:r});return Core.PABinary.createFromBlob(n)},t.prototype.generateBodyDatums=function(e){var t=[];return 0===this._parts.length?t.push("--"+e+"\r\n\r\n\r\n"):this._parts.forEach((function(r){t.push("--"+e+"\r\n"),r.addParts(t)})),t.push("--"+e+"--\r\n"),t},t}(AppMagic.Services.BodilessHttpRequestBuilder)},function(e,t,r){"use strict";r.r(t),r.d(t,"preProcessViewResponse",(function(){return d})),r.d(t,"containsViewFilter",(function(){return h}));var n=r(0),a=AppMagic.Services.ResponseTypes,o=AppMagic.Data,i=AppMagic.Services.ODataConstants,s=AppMagic.Services.ODataUtility,c=i.MetadataPropertyName.AssociatedNavigationProperty,u=i.MetadataPropertyName.AttributeName,l=i.MetadataPropertyName.ViewDotNotation,p=i.MetadataPropertyName.ViewLookupFieldAliasEnding;function d(e,t,r){if(e.responseType!==a.Json)return e;var n=e.response,i=n.value;if(!i||0===i.length)return e;var d=function(e,t){var r=HashTableUtility.create();return HashTableUtility.forEach(e,(function(e,n){if(n.endsWith(p)){var a=n.slice(1,n.length-p.length),o=e;t&&!t[o]&&HashTableUtility.forEach(t,(function(e,t){e.referencingFieldName!==o||e.isArray||(o=e.name)})),r[a]=o}})),r}(n,t);return i.forEach((function(e){var t=HashTableUtility.filter(e,(function(e,t){return t.endsWith(u)}));t&&HashTableUtility.forEach(t,(function(t,n){var a,i=Object.keys(d).find((function(e){return n.startsWith(e+l)})),p=function(e,t){var r=e[t],n=t.slice(0,t.length-u.length),a=e[n];return delete e[t],delete e[n],{attrName:r,attrValue:a,aliasKey:n}}(e,n);if(i){var h=d[i];e["".concat(s.formatAnnotatedPropName(h)).concat(c)]&&(h=e["".concat(s.formatAnnotatedPropName(h)).concat(c)]),r&&h===o.PolymorphicLookup.ActivitiesPrimaryKey?e[p.attrName]=p.attrValue:e[h]=__assign(__assign({},e[h]),((a={})[p.attrName]=p.attrValue,a))}else e[p.attrName]=p.attrValue;var m=HashTableUtility.filter(e,(function(e,t){return t.startsWith(p.aliasKey)&&-1!==t.indexOf("@OData")}));m&&HashTableUtility.forEach(m,(function(t,n){var a,u=n.slice(p.aliasKey.length),l=p.attrName+u;if(delete e[n],i){var h=d[i];e["".concat(s.formatAnnotatedPropName(h)).concat(c)]&&(h=e["".concat(s.formatAnnotatedPropName(h)).concat(c)]),r&&h===o.PolymorphicLookup.ActivitiesPrimaryKey?e[l]=t:e[h]=__assign(__assign({},e[h]),((a={})[l]=t,a))}else e[l]=t}))}))})),e}function h(e){return!!(e.queryOptions&&e.queryOptions.filter&&Object(n.getCdsViewIdFromFilterQuery)(e.queryOptions.filter))}},function(e,t,r){"use strict";r.r(t),r.d(t,"FunctionExecutionContext",(function(){return n}));var n=function(){function e(e,t,r,n,a){this._service=e,this._parameterValues=t,this._variableValues=r,this.onBeforeAsyncStep=n,this.onAfterAsyncStep=a}return Object.defineProperty(e.prototype,"service",{get:function(){return this._service},enumerable:!1,configurable:!0}),e.prototype.getParameterDValue=function(e){var t=this._parameterValues[e];if(t)return t.value},e.prototype.addVariable=function(e,t){this._variableValues[e]=t},e.prototype.getVariableValue=function(e){return this._variableValues[e].value},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ODataScalarUtility",(function(){return c}));var n=r(0),a=r(1),o=AppMagic.Services.Rest,i=AppMagic.Schema,s=AppMagic.Services.TypeSystem,c=function(){function e(){this._valueExtractorsByExpectedDType=HashTableUtility.create()}return e.prototype.createScalarResponse=function(e,t){if(this._valueExtractorsByExpectedDType[t])return this._processScalarResult(e,this._valueExtractorsByExpectedDType[t]);var r=HashTableUtility.create(),n=HashTableUtility.create();t===i.TypeNumber?n.result={displayIdx:0,ttypeRef:new s.InlinedTTypeRef(new s.JsonNumberTType(t,null))}:t===i.TypeDateTime&&(n.result={displayIdx:0,ttypeRef:new s.InlinedTTypeRef(new s.JsonDateTimeStringTType(s.DateTimeFormat.Iso8601ExtendedUtc,s.DateTimeBehavior.UserLocal))});var a=new s.JsonObjectTType(n);return r.value=new o.JsonResponseParam("/value",new s.InlinedTTypeRef(new s.JsonArrayTType(new s.InlinedTTypeRef(a)))),this._valueExtractorsByExpectedDType[t]=r,this._processScalarResult(e,this._valueExtractorsByExpectedDType[t])},e.prototype._processScalarResult=function(e,t){var r=Object(a.processHttpResponse)(e,t);if(r&&Core.Utility.isArray(r.value)){if(0===r.value.length)throw new n.TabularDataError({message:AppMagic.Strings.ConnectedDataInvalidResult,errorKind:n.ConnectedDataErrorKind.InvalidResult});return r.value[0]}throw new n.TabularDataError({message:AppMagic.Strings.ConnectedDataInvalidResult,errorKind:n.ConnectedDataErrorKind.InvalidResult})},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"createListRowsResponseProcessor",(function(){return p})),r.d(t,"createGetRowRequestProcessor",(function(){return d}));var n=AppMagic.Services.Rest,a=AppMagic.Schema,o=AppMagic.Services.TypeSystem,i=AppMagic.Services.ResponseTypes,s=new n.JsonResponseParam("/@odata.count",new o.InlinedTTypeRef(new o.JsonNumberTType(a.TypeNumber,o.NumericXsdType.Int))),c=new n.JsonResponseParam("/@odata.nextLink",new o.InlinedTTypeRef(new o.JsonStringTType)),u=new n.JsonResponseParam("/@Microsoft.Dynamics.CRM.totalrecordcount",new o.InlinedTTypeRef(new o.JsonNumberTType(a.TypeNumber,o.NumericXsdType.Int))),l=new n.JsonResponseParam("/@Microsoft.Dynamics.CRM.totalrecordcountlimitexceeded",new o.InlinedTTypeRef(new o.JsonBooleanTType));function p(e){var t=HashTableUtility.create();return t.items=new n.JsonResponseParam("/value",new o.InlinedTTypeRef(new o.JsonArrayTType(e))),t.nextLink=c,t.resultCount=s,t.totalRecordCount=u,t.totalRecordLimitExceeded=l,new n.ResponseTypeResponseProcessor(i.Json,null,t)}function d(e){var t=new n.ResponseBodyExtractor(n.ResponseValueType.Json,e);return new n.ResponseTypeResponseProcessor(i.Json,t)}},function(e,t,r){"use strict";r.r(t),r.d(t,"RestResponseComposeObjectValueExpression",(function(){return a}));var n=AppMagic.Schema,a=function(){function e(e){this._properties=e}return e.createProperty=function(e,t){return{displayIdx:e,valueExpr:t}},e.prototype.computeSchema=function(e){var t=this;if(e<=0)return n.createSchemaForObjectFromPointer([]);var r=Object.keys(this._properties).sort((function(e,r){return t._properties[e].displayIdx-t._properties[r].displayIdx})),a=e-1,o=[];return r.forEach((function(e){var r=t._properties[e].valueExpr.computeSchema(a);r.name=e,o.push(r)})),n.createSchemaForObjectFromPointer(o)},e.prototype.evaluate=function(e){var t=this,r={};return Object.keys(this._properties).forEach((function(n){var a=t._properties[n].valueExpr.evaluate(e);!0===a.success&&Core.Utility.isDefined(a.value)&&(r[n]=a.value)})),AppMagic.Services.ServiceUtility.createSuccessfulDataflowResult(r)},e}()},function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return a}));var n=function(){function e(e){this._guidGenerator=e}return e.prototype.generateBoundary=function(){return this._guidGenerator.generateGuid()},e}(),a=new n(Core.GuidGenerator.DefaultInstance)},function(e,t){!function(){e.exports=function(){return this?this:window}()["@pa-client/appmagic-runtime"]}()},function(e,t,r){},function(e,t,r){"use strict";r.r(t),r.d(t,"BinaryBodyHttpRequestBuilder",(function(){return n}));var n=function(e){function t(){var t=e.call(this)||this;return t._binary=null,t}return __extends(t,e),t.prototype.clone=function(){var e=new t;return this._cloneTo(e),e},t.prototype._cloneTo=function(t){e.prototype._cloneTo.call(this,t)},t.prototype.setBodyBinary=function(e){this._binary=e},t.prototype._generateBodyBinary=function(){return this._binary},t}(AppMagic.Services.BodilessHttpRequestBuilder)},function(e,t,r){"use strict";r.r(t),r.d(t,"CdpGetRowsFunction",(function(){return c}));var n=r(25),a=r(1),o=AppMagic.Services.HttpConstants,i=AppMagic.Services,s=AppMagic.Services.PowerAppsHttpTelemetry,c=function(){function e(e,t,r,a,o,i,s){this._resourceUrl=e,this._apiId=t,this._authProvider=r,this._dataSourceName=a,this._appHttpClient=o,this._strongConsistency=i,this._odataScalarUtilityLazy=new Core.Lazy((function(){return new n.ODataScalarUtility})),this._sharedConnectionId=s}return e.prototype.getRowsAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,c;return __generator(this,(function(u){switch(u.label){case 0:return(r=new Core.UrlBuilder(this._resourceUrl)).setQueryParams(e.queryParams),n={method:o.Method.GET,url:r.doneToString(),headers:this._getHeaders(t)},[4,this._authProvider.authenticator.authenticateRequestAsync(n)];case 1:return u.sent(),i.appendCustomHeadersOptions(n,{addCustomHeaders:!0}),[4,s.sendHttpAsync(this._appHttpClient,n,"CdpGetRowsFunction.GetRows",{apiId:this._apiId},i.ResponseTypes.Json)];case 2:return c=u.sent(),[2,Object(a.processHttpResponse)(c,e.responseParams)]}}))}))},e.prototype.getScalarResultAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,a,c,u,l,p;return __generator(this,(function(d){switch(d.label){case 0:return n=new Core.UrlBuilder(this._resourceUrl),c=(a=n).setQueryParams,[4,t.getStringParametersAsync(e)];case 1:return c.apply(a,[d.sent()]),u={headers:this._getHeaders(r),method:o.Method.GET,url:n.doneToString()},[4,this._authProvider.authenticator.authenticateRequestAsync(u)];case 2:return d.sent(),i.appendCustomHeadersOptions(u,{addCustomHeaders:!0}),[4,s.sendHttpAsync(this._appHttpClient,u,"CdpGetRowsFunction.getScalarResultAsync",{apiId:this._apiId},i.ResponseTypes.Json)];case 3:return l=d.sent(),p="",p=e.func?e.func.returnType:e.expectedDType,[2,this._odataScalarUtilityLazy.value.createScalarResponse(l,p)]}}))}))},e.prototype.getMoreRowsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,c,u;return __generator(this,(function(l){switch(l.label){case 0:return Core.FallbackSwitch.isActivated("AppConnectivity.EncodeNextLinkLegacyBehavior")&&(n=new Core.UrlBuilder(e),e=n.doneToString()),c={method:o.Method.GET,url:e,headers:this._getHeaders(r)},[4,this._authProvider.authenticator.authenticateRequestAsync(c)];case 1:return l.sent(),i.appendCustomHeadersOptions(c,{addCustomHeaders:!0}),[4,s.sendHttpAsync(this._appHttpClient,c,"CdpGetRowsFunction.getMoreRowsAsync",{apiId:this._apiId},i.ResponseTypes.Json)];case 2:return u=l.sent(),[2,Object(a.processHttpResponse)(u,t)]}}))}))},e.prototype._getHeaders=function(e){var t=HashTableUtility.create();return t[o.HeaderName.Accept]=o.MediaType.ApplicationJson,t[i.HttpConstants.HeaderName.PowerAppsConnectorProtocolSemantics]=i.HttpConstants.HeaderValue.PowerAppsConnectorProtocolSemanticsValue,this._strongConsistency&&(t[o.HeaderName.Consistency]=o.HeaderValue.ConsistencyStrong),this._sharedConnectionId&&(t[o.HeaderName.SharedConnectionId]=this._sharedConnectionId),this._dataSourceName&&(t[AppMagic.Services.HttpConstants.HeaderName.ServiceNamespace]=this._dataSourceName),e&&HashTableUtility.forEach(e,(function(e,r){t[r]=e})),t},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ODataConnector",(function(){return l}));var n=r(25),a=r(26),o=(AppMagic.Data,AppMagic.Services.TypeSystem),i=AppMagic.Services.ODataConstants,s=AppMagic.Services.HttpConstants,c=AppMagic.Services,u=(AppMagic.Services.SendHttpResponse,AppMagic.Services.PowerAppsHttpTelemetry),l=function(e){function t(t,r,a,o,i,s,c,u,l){void 0===u&&(u=null),void 0===l&&(l=500);var p=e.call(this)||this;return p._typeManager=t,p._typePrefix=r,p._authProvider=a,p._serviceConfig=o,p._dvDataConfig=i,p._appHttpClient=s,p._queryStringBuilder=c,p._defaultHeaders=u,p._defaultMaxPageSize=l,p._odataActionUrlTemplates={entityBoundWithNamespace:new Core.Lazy((function(){return new Core.TypedUrlTemplate("".concat(p._serviceConfig.baseUrl,"/{tableName}({entityId})/{namespace}.{action}"))})),entityBoundWithoutNamespace:new Core.Lazy((function(){return new Core.TypedUrlTemplate("".concat(p._serviceConfig.baseUrl,"/{tableName}({entityId})/{action}"))})),collectionBoundWithNamespace:new Core.Lazy((function(){return new Core.TypedUrlTemplate("".concat(p._serviceConfig.baseUrl,"/{tableName}/{namespace}.{action}"))})),collectionBoundWithoutNamespace:new Core.Lazy((function(){return new Core.TypedUrlTemplate("".concat(p._serviceConfig.baseUrl,"/{tableName}/{action}"))}))},p._listRowsProcessors=HashTableUtility.create(),p._getRowProcessors=HashTableUtility.create(),p._odataScalarUtilityLazy=new Core.Lazy((function(){return new n.ODataScalarUtility})),p}return __extends(t,e),t._processListHttpResponse=function(e,t){return t.processResponse(e).bodyParams},t._processItemHttpResponse=function(e,t){return t.processResponse(e).body},t.prototype._appendExtendedBatchInfoHeader=function(e,t,r){var n=__assign({baseUrl:this._serviceConfig.baseUrl.toString(),headers:r},t);e.headers.BatchInfo=JSON.stringify(n)},t.prototype.getRowsAsync=function(e,r,n){var a;return void 0===n&&(n={}),__awaiter(this,void 0,Promise,(function(){var o,s,u,l,p,d,h,m,y;return __generator(this,(function(f){switch(f.label){case 0:return n=__assign(__assign({},{skip:0}),n),o=Date.now(),[4,this._queryStringBuilder.getStringParametersAsync(e.queryOptions)];case 1:return s=f.sent(),Core.Utility.isFiniteNumber(n.top)&&(s[i.QueryOption.Top]=n.top.toString()),Core.Utility.isNumber(n.skip)&&0!==n.skip&&(s[i.QueryOption.Skip]=n.skip.toString()),n.includeCounts&&(s[i.QueryOption.Count]="true"),(u=new Core.UrlBuilder(this._serviceConfig.baseUrl)).appendPath(e.tableName),u.setQueryParams(s),l=n.top||n.maxPageSize?{maxPageSize:null!==(a=n.top)&&void 0!==a?a:n.maxPageSize}:void 0,p=this._createHeadersForGet(void 0,n.errorContext,l),d=this._createRequestParamForGet(u.doneToUrl(),p),n.batchInfo&&this._appendExtendedBatchInfoHeader(d,n.batchInfo,this._createHeadersForGet(void 0,void 0,l)),[4,this._authProvider.authenticator.authenticateRequestAsync(d)];case 2:return f.sent(),c.appendCustomHeadersOptions(d,{addCustomHeaders:!0}),[4,AppMagic.Services.PowerAppsHttpTelemetry.sendHttpAsync(this._appHttpClient,d,"ODataConnector.getRowsAsync",null,c.ResponseTypes.Json)];case 3:return h=f.sent(),m=Date.now(),[4,this.preProcessResponse(h,n.preProcessor)];case 4:return f.sent(),[4,t._processListHttpResponse(h,this._getListRowsProcessors(r))];case 5:return y=f.sent(),Core.FeatureGates.services.EnableSendHttpPipelinePerf&&(AppMagic.Services.ServiceUtility.addSendHttpPipelinePerf("ODataConnector_getRowsAsync",h,o,m,Date.now()),Core.Telemetry.Log.trackActivityEvent("SendHttpPipelinePerf_ODataConnector_getRowsAsync",{sendHttpPipelinePerf:JSON.stringify(h.sendHttpPipelinePerf)})),[2,y]}}))}))},t.prototype._getListRowsProcessors=function(e){if(!this._listRowsProcessors[e]){var t=this._typeManager.getType(this._typePrefix,e);this._listRowsProcessors[e]=Object(a.createListRowsResponseProcessor)(new o.InlinedTTypeRef(t))}return this._listRowsProcessors[e]},t.prototype._getGetRowProcessor=function(e){if(!this._getRowProcessors[e]){var t=this._typeManager.getType(this._typePrefix,e);this._getRowProcessors[e]=Object(a.createGetRowRequestProcessor)(new o.InlinedTTypeRef(t))}return this._getRowProcessors[e]},t.prototype._getHeaders=function(e){var t=HashTableUtility.create();return this._defaultHeaders&&Object.assign(t,this._defaultHeaders),t[s.HeaderName.Accept]=s.MediaType.ApplicationJson,Core.Diagnostics.addHeaders(t,e),t},t.prototype._getHeaderForWrite=function(e){var t=this._getHeaders(e);t[s.HeaderName.ContentType]=s.MediaType.ApplicationJson;var r=i.HeaderValue.ReturnRepresentation;return this._serviceConfig.annotationFormat&&(r+=","+Core.Utility.formatString(i.HeaderValue.IncludeAnnotations_Annotation,this._serviceConfig.annotationFormat)),t[i.HeaderName.Prefer]=r,t},t.prototype.getMoreRowsAsync=function(e,r,n){return void 0===n&&(n={}),__awaiter(this,void 0,Promise,(function(){var a,o,i,s,l;return __generator(this,(function(p){switch(p.label){case 0:return Core.FallbackSwitch.isActivated("AppConnectivity.EncodeNextLinkLegacyBehavior")&&(a=new Core.UrlBuilder(e),e=a.doneToString()),o=n.maxPageSize?{maxPageSize:n.maxPageSize}:void 0,i=this._createHeadersForGet(void 0,n.errorContext,o),s=this._createRequestParamForGetNoEncoding(e,i),n.batchInfo&&this._appendExtendedBatchInfoHeader(s,n.batchInfo,this._createHeadersForGet(void 0,void 0,o)),[4,this._authProvider.authenticator.authenticateRequestAsync(s)];case 1:return p.sent(),c.appendCustomHeadersOptions(s,{addCustomHeaders:!0}),[4,u.sendHttpAsync(this._appHttpClient,s,"ODataConnector.getMoreRowsAsync",null,c.ResponseTypes.Json)];case 2:return l=p.sent(),[4,this.preProcessResponse(l,n.preProcessor)];case 3:return p.sent(),[2,t._processListHttpResponse(l,this._getListRowsProcessors(r))]}}))}))},t.prototype._createHeadersForGet=function(e,t,r){var n=this._getHeaders(t),a=Core.Utility.formatString(i.HeaderValue.MaxPage_Size,(null==r?void 0:r.maxPageSize)?r.maxPageSize:this._defaultMaxPageSize);return this._serviceConfig.annotationFormat&&(a+=","+Core.Utility.formatString(i.HeaderValue.IncludeAnnotations_Annotation,this._serviceConfig.annotationFormat)),n[i.HeaderName.Prefer]=a,Object.assign(n,e),n},t.prototype._createRequestParamForGet=function(e,t){return this._createRequestParamForGetNoEncoding(e.toString(),t)},t.prototype._createRequestParamForGetNoEncoding=function(e,t){return{method:s.Method.GET,url:e,headers:t}},t.prototype.getRowAsync=function(e,r,n){return void 0===n&&(n={}),__awaiter(this,void 0,Promise,(function(){var a,o;return __generator(this,(function(i){switch(i.label){case 0:return a={method:s.Method.GET,url:e.toString(),headers:this._createHeadersForGet(void 0,n.errorContext)},[4,this._authProvider.authenticator.authenticateRequestAsync(a)];case 1:return i.sent(),c.appendCustomHeadersOptions(a,{addCustomHeaders:!0}),n.batchInfo&&this._appendExtendedBatchInfoHeader(a,n.batchInfo,this._createHeadersForGet(void 0,n.errorContext)),[4,u.sendHttpAsync(this._appHttpClient,a,"ODataConnector.getRowAsync",null,c.ResponseTypes.Json)];case 2:return o=i.sent(),[4,this.preProcessResponse(o,n.preProcessor)];case 3:return i.sent(),[2,t._processItemHttpResponse(o,this._getGetRowProcessor(r))]}}))}))},t.prototype.createRowAsync=function(e,r,n,a){return void 0===a&&(a={}),__awaiter(this,void 0,Promise,(function(){var i,l,p,d,h,m;return __generator(this,(function(y){switch(y.label){case 0:return i=this._typeManager.getType(this._typePrefix,n),[4,o.TTypeUtility.convertFromDValueAsync(i,r)];case 1:return l=y.sent(),p=this._getHeaderForWrite(a.errorContext),Object.assign(p,a.optionalHeaders),d=new Core.UrlBuilder(e),h={url:d.doneToString(),method:s.Method.POST,headers:p,bodyData:JSON.stringify(l)},[4,this._authProvider.authenticator.authenticateRequestAsync(h)];case 2:return y.sent(),c.appendCustomHeadersOptions(h,{addCustomHeaders:!0}),a.batchInfo&&this._appendExtendedBatchInfoHeader(h,a.batchInfo,Object.assign(this._getHeaderForWrite(),a.optionalHeaders)),[4,u.sendHttpAsync(this._appHttpClient,h,"ODataConnector.createRowAsync",null,c.ResponseTypes.Json)];case 3:return m=y.sent(),[4,this.preProcessResponse(m,a.preProcessor)];case 4:return y.sent(),[2,t._processItemHttpResponse(m,this._getGetRowProcessor(n))]}}))}))},t.prototype.patchRowAsync=function(e,r,n,a){return void 0===a&&(a={}),__awaiter(this,void 0,Promise,(function(){var i,l,p,d,h,m;return __generator(this,(function(y){switch(y.label){case 0:return i=this._typeManager.getType(this._typePrefix,n),[4,o.TTypeUtility.convertFromDValueAsync(i,r)];case 1:return l=y.sent(),p=this._getHeaderForWrite(a.errorContext),Object.assign(p,a.optionalHeaders),d=Core.Diagnostics.createErrorContext({protocol:"cds",operation:"patchRow"},a.errorContext),Core.Diagnostics.addHeaders(p,d),h={url:e.toString(),method:s.Method.PATCH,headers:p,bodyData:JSON.stringify(l)},[4,this._authProvider.authenticator.authenticateRequestAsync(h)];case 2:return y.sent(),c.appendCustomHeadersOptions(h,{addCustomHeaders:!0}),a.batchInfo&&this._appendExtendedBatchInfoHeader(h,a.batchInfo,Object.assign(this._getHeaderForWrite(),a.optionalHeaders)),[4,u.sendHttpAsync(this._appHttpClient,h,"ODataConnector.patchRowAsync",null,c.ResponseTypes.Json)];case 3:return m=y.sent(),[4,this.preProcessResponse(m,a.preProcessor)];case 4:return y.sent(),[2,t._processItemHttpResponse(m,this._getGetRowProcessor(n))]}}))}))},t.prototype.deleteRowAsync=function(e,t){var r;return void 0===t&&(t={}),__awaiter(this,void 0,Promise,(function(){var n,a;return __generator(this,(function(o){switch(o.label){case 0:return n=this._getHeaders(t.errorContext),a={method:s.Method.DELETE,url:e.toString(),headers:n},(null===(r=t.errorContext)||void 0===r?void 0:r.abortSignal)&&(a.signal=Core.PromiseUtils.createAbortController(t.errorContext.abortSignal)),[4,this._authProvider.authenticator.authenticateRequestAsync(a)];case 1:return o.sent(),c.appendCustomHeadersOptions(a,{addCustomHeaders:!0}),t.batchInfo&&this._appendExtendedBatchInfoHeader(a,t.batchInfo,this._getHeaders()),[4,u.sendHttpIgnoreResponseAsync(this._appHttpClient,a,"ODataConnector.deleteRowAsync",null)];case 2:return o.sent(),[2]}}))}))},t.prototype.getScalarResultAsync=function(e,t,r){return void 0===r&&(r={}),__awaiter(this,void 0,Promise,(function(){var n,a,o,i,s;return __generator(this,(function(c){switch(c.label){case 0:return(n=new Core.UrlBuilder(this._serviceConfig.baseUrl)).appendPath(e),o=(a=n).setQueryParams,[4,this._queryStringBuilder.getStringParametersAsync(t)];case 1:return o.apply(a,[c.sent()]),[4,this.getScalarResultCoreAsync(n,t,{errorContext:r.errorContext,batchInfo:r.batchInfo})];case 2:return i=c.sent(),s=t.func?t.func.returnType:t.expectedDType,[2,this._odataScalarUtilityLazy.value.createScalarResponse(i,s)]}}))}))},t.prototype.getScalarResultCoreAsync=function(e,t,r){return void 0===r&&(r={}),__awaiter(this,void 0,Promise,(function(){var t,n;return __generator(this,(function(a){switch(a.label){case 0:return t=this._getHeaders(r.errorContext),n={headers:t,method:s.Method.GET,url:e.doneToString()},[4,this._authProvider.authenticator.authenticateRequestAsync(n)];case 1:return a.sent(),c.appendCustomHeadersOptions(n,{addCustomHeaders:!0}),r.batchInfo&&this._appendExtendedBatchInfoHeader(n,r.batchInfo,this._getHeaders()),[4,u.sendHttpAsync(this._appHttpClient,n,"ODataConnector.getScalarResultCoreAsync",null,c.ResponseTypes.Json)];case 2:return[2,a.sent()]}}))}))},t.prototype.unsafeInvokeActionAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,a;return __generator(this,(function(o){switch(o.label){case 0:return r=e,[4,this._getActionUrlAsync(r)];case 1:return n=o.sent(),a=this._createRequestParamForWriteRequest(n,s.Method.POST,r.payload,void 0,t),[4,this._authProvider.authenticator.authenticateRequestAsync(a)];case 2:return o.sent(),c.appendCustomHeadersOptions(a,{addCustomHeaders:!0}),[4,u.sendHttpAsync(this._appHttpClient,a,"ODataConnector.unsafeInvokeActionAsync",null,c.ResponseTypes.Json)];case 3:return[2,o.sent()]}}))}))},t.prototype._getActionUrlAsync=function(e){return __awaiter(this,void 0,void 0,(function(){var t,r,n,a,o,i;return __generator(this,(function(s){switch(s.label){case 0:return t=!!(e.entityId&&e.entityId.length>0),r=!!(e.namespace&&e.namespace.length>0),n=this._getActionUrlTemplate(t,r),a=n.expandUrl(e),[4,this._queryStringBuilder.getStringParametersAsync(e.queryOptions)];case 1:return o=s.sent(),(i=new Core.UrlBuilder(a)).setQueryParams(o),[2,i.doneToUrl()]}}))}))},t.prototype._getActionUrlTemplate=function(e,t){return e?t?this._odataActionUrlTemplates.entityBoundWithNamespace.value:this._odataActionUrlTemplates.entityBoundWithoutNamespace.value:t?this._odataActionUrlTemplates.collectionBoundWithNamespace.value:this._odataActionUrlTemplates.collectionBoundWithoutNamespace.value},t.prototype._createRequestParamForWriteRequest=function(e,t,r,n,a){var o=this._getHeaderForWrite(a);o[i.HeaderName.Prefer]=Core.Utility.formatString(i.HeaderValue.MaxPage_Size,this._defaultMaxPageSize),Object.assign(o,n);var s={method:t,url:e.toString(),headers:o};return r&&(s.bodyData=r),s},t.prototype.runUnsafeGetQueryAsync=function(e,t,r){return void 0===r&&(r={}),__awaiter(this,void 0,Promise,(function(){var n,a;return __generator(this,(function(o){switch(o.label){case 0:return n=this._createHeadersForGet(r.optionalHeaders,r.errorContext),a=this._createRequestParamForGet(t,n),r.batchInfo&&this._appendExtendedBatchInfoHeader(a,r.batchInfo,this._createHeadersForGet(r.optionalHeaders)),[4,this._authProvider.authenticator.authenticateRequestAsync(a)];case 1:return o.sent(),c.appendCustomHeadersOptions(a,{addCustomHeaders:!0}),[4,u.sendHttpAsync(this._appHttpClient,a,e,null,r.responseType||c.ResponseTypes.Json)];case 2:return[2,o.sent()]}}))}))},t.prototype.createUnsafeWriteRequestAsync=function(e,t,r,n,a){return void 0===a&&(a={}),__awaiter(this,void 0,Promise,(function(){var e;return __generator(this,(function(o){switch(o.label){case 0:return e=this._createRequestParamForWriteRequest(t,r,n,a.optionalHeaders,a.errorContext),a.batchInfo&&this._appendExtendedBatchInfoHeader(e,a.batchInfo,Object.assign(this._getHeaderForWrite(),a.optionalHeaders)),[4,this._authProvider.authenticator.authenticateRequestAsync(e)];case 1:return o.sent(),c.appendCustomHeadersOptions(e,{addCustomHeaders:!0}),[2,e]}}))}))},t.prototype.runUnsafeWriteRequestAsync=function(e,t,r,n,a,o){return void 0===o&&(o={}),__awaiter(this,void 0,Promise,(function(){var i;return __generator(this,(function(s){switch(s.label){case 0:return[4,this.createUnsafeWriteRequestAsync(e,t,r,n,o)];case 1:return i=s.sent(),[4,u.sendHttpAsync(this._appHttpClient,i,e,null,a)];case 2:return[2,s.sent()]}}))}))},t.prototype.runUnsafeWriteRequestNoResponseAsync=function(e,t,r,n,a){return void 0===a&&(a={}),__awaiter(this,void 0,Promise,(function(){var o;return __generator(this,(function(i){switch(i.label){case 0:return[4,this.createUnsafeWriteRequestAsync(e,t,r,n,a)];case 1:return o=i.sent(),[4,u.sendHttpIgnoreResponseAsync(this._appHttpClient,o,e,null)];case 2:return[2,i.sent()]}}))}))},t.prototype.runUnsafeDeleteRequestAsync=function(e,t,r){return void 0===r&&(r={}),__awaiter(this,void 0,Promise,(function(){var n,a;return __generator(this,(function(o){switch(o.label){case 0:return n=this._getHeaders(r.errorContext),a={method:s.Method.DELETE,url:t.toString(),headers:n},[4,this._authProvider.authenticator.authenticateRequestAsync(a)];case 1:return o.sent(),c.appendCustomHeadersOptions(a,{addCustomHeaders:!0}),r.batchInfo&&this._appendExtendedBatchInfoHeader(a,r.batchInfo,this._getHeaders()),[4,u.sendHttpIgnoreResponseAsync(this._appHttpClient,a,e,null)];case 2:return[2,o.sent()]}}))}))},t.prototype.dispose=function(){this._listRowsProcessors=null,e.prototype.dispose.call(this)},t.prototype.preProcessResponse=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r;return __generator(this,(function(n){switch(n.label){case 0:return t?(r=t(e)).then?[4,r]:[3,2]:[3,3];case 1:return e=n.sent(),[3,3];case 2:e=r,n.label=3;case 3:return[2]}}))}))},t.prototype.getRuntimeBaseUrl=function(){return this._serviceConfig.baseUrl},t.prototype.getDataverseRuntimeBaseUrl=function(){return this._dvDataConfig.baseUrl},t}(Core.Disposable)},function(e,t,r){"use strict";r.r(t),r.d(t,"FunctionCallExpression",(function(){return a}));var n=AppMagic.Data,a=function(){function e(e,t){this._name=e,this._argumentExpressions=t}return e.prototype.computeResultSchema=function(e,t){return e.service.functions[this._name].computeResultSchema(t)},e.prototype.isBehaviorOnly=function(e){return e.service.functions[this._name].isBehaviorOnly||this._argumentExpressions.some((function(t){return t.expression.isBehaviorOnly(e)}))},e.prototype.evaluateAsync=function(e){var t=e.service.getFunction(this._name),r=HashTableUtility.create(),a=!1,o=null,i=this._argumentExpressions.map((function(t){return t.expression.evaluateAsync(e).then((function(e){Core.Utility.isUndefined(e)||(n.ErrorValue.isGatedError(e)&&!o&&(a=!0,o=e),r[t.name]=new AppMagic.Services.PrimitiveDArgument(e))}))}));return Core.PromiseUtils.join(i).then((function(){return a?o:t.runAsync(r,{onBeforeAsyncStep:e.onBeforeAsyncStep,onAfterAsyncStep:e.onAfterAsyncStep})}))},e}()},function(e,t,r){"use strict";r.r(t);var n=r(0),a=r(29),o=r(23),i=r(6),s=r(44),c=r(4),u=r(45),l=r(33),p=AppMagic.Services.HttpConstants,d=AppMagic.Services,h=AppMagic.Services.PowerAppsHttpTelemetry,m=function(e){function t(t,r,n){var a=e.call(this)||this;return a._authProvider=t,a._serviceConfig=r,a._appHttpClient=n,a._actionUrlTemplate=new Core.TypedUrlTemplate("".concat(a._serviceConfig.baseUrl,"/{action}")),a}return __extends(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this)},t.prototype.getRuntimeBaseUrl=function(){return this._serviceConfig.baseUrl},t.prototype.runUnsafeRequestAsync=function(e,t,r,n,a,o){return __awaiter(this,void 0,Promise,(function(){var i,s;return __generator(this,(function(c){switch(c.label){case 0:return i=this._actionUrlTemplate.expandUrl({action:t}),[4,this._createUnsafeRequestAsync(e,i,r,n,o)];case 1:return s=c.sent(),[4,h.sendHttpAsync(this._appHttpClient,s,e,null,a)];case 2:return[2,c.sent()]}}))}))},t.prototype._createUnsafeRequestAsync=function(e,t,r,n,a){return void 0===a&&(a={}),__awaiter(this,void 0,Promise,(function(){var e,o,i;return __generator(this,(function(s){switch(s.label){case 0:return e=__assign(__assign({},a.optionalHeaders),((i={})[AppMagic.Services.HttpConstants.HeaderName.MsCorrelationId]=Core.Utility.generate128BitUUID(),i)),o=this._createRequestParam(t,r,n,e,a.errorContext),[4,this._authProvider.authenticator.authenticateRequestAsync(o)];case 1:return s.sent(),d.appendCustomHeadersOptions(o,{addCustomHeaders:!0,optInMSHeaders:!0,headersToRemove:[AppMagic.Services.HttpConstants.HeaderName.CdsNativeAppId]}),[2,o]}}))}))},t.prototype._createRequestParam=function(e,t,r,n,a){var o=__assign(__assign({},this._addBaseHeaders(a)),n),i={method:t,url:e.toString(),headers:o};return r&&(i.bodyData=r),i},t.prototype._addBaseHeaders=function(e){var t=HashTableUtility.create();return t[p.HeaderName.Accept]=p.MediaType.ApplicationJson,t[p.HeaderName.ContentType]=p.MediaType.ApplicationJson,Core.Diagnostics.addHeaders(t,e),t},t}(Core.Disposable),y=r(1);r.d(t,"CdsConnector",(function(){return S}));var f=AppMagic.AppResourceUri,v=AppMagic.Data,g=AppMagic.Services.ODataConstants,C=AppMagic.PowerApps.Constants.CdsTableTypes,_=AppMagic.Services.HttpConstants,b=AppMagic.Services,A=AppMagic.Services.DirectConnector.CdsTransferTypes,S=function(e){function t(r,o,i,c,p,d,h,g,C){var _=e.call(this)||this;return _._dataSourceName=r,_._mediaResolver=c,_._binaryResolver=p,_._tableMetadata=g,_._dataSet=C,_._maxPageSizeLimit=5e3,_._maxColumnStringLength=4864,_._maxSupportedNumberOfFilters=25,_._lazyBooleanOptionSetUrlTemplate=new Core.Lazy((function(){return new Core.TypedUrlTemplate("/EntityDefinitions(LogicalName='{entityLogicalName}')/Attributes(LogicalName='{columnLogicalName}')/Microsoft.Dynamics.CRM.{optionSetType}AttributeMetadata?$expand=OptionSet($select=MetadataId,TrueOption,FalseOption)&$select=MetadataId")})),_._lazyOptionSetUrlTemplate=new Core.Lazy((function(){return new Core.TypedUrlTemplate("/EntityDefinitions(LogicalName='{entityLogicalName}')/Attributes(LogicalName='{columnLogicalName}')/Microsoft.Dynamics.CRM.{optionSetType}AttributeMetadata?$expand=OptionSet($select=Options)&$select=OptionSet")})),_._lazyUserEntityPrivilegeUrlTemplate=new Core.Lazy((function(){return new Core.TypedUrlTemplate("/systemusers({sytemuserId})/Microsoft.Dynamics.CRM.RetrieveUserPrivilegeByPrivilegeName(PrivilegeName='{privilegeName}')")})),_._lazyLocalizedDisplayNameTemplate=new Core.Lazy((function(){return new Core.TypedUrlTemplate("/EntityDefinitions(LogicalName='{entityLogicalName}')?$select=LogicalName&$expand=Attributes($select=DisplayName,LogicalName;$filter={columnLogicalNames})")})),_._telemetryBaseData={dataSourceName:r,apiId:"CdsNative"},_._queryStringBuilder=Object(n.CreateCdsQueryStringBuilder)(),_._lazyConfigAsync=new Core.AsyncLazy("CdsConnector.connectionConfig",(function(){return __awaiter(_,void 0,void 0,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return[4,h.getCdsDataSourceConfigAsync(this._dataSourceName)];case 1:return(e=t.sent()).state!==a.CdsDataSourceState.Configured?(Object(y.logError)("CdsConnector._lazyConfigAsync","We could not get runtime url for CDS datasource. This is fatal error. configState is: ".concat(a.CdsDataSourceState[e.state],"."),this._telemetryBaseData),[2,{state:e.state,baseUrl:null,entitySetName:null,logicalName:null}]):[2,{state:e.state,baseUrl:new Core.Url(e.config.runtimeUrl),entitySetName:e.config.entitySetName,logicalName:e.config.logicalName}]}}))}))})),_._lazyOdataConnector=new Core.AsyncLazy("CdsConnector._lazyOdataConnector",(function(){return __awaiter(_,void 0,void 0,(function(){var e,r,n;return __generator(this,(function(a){switch(a.label){case 0:return[4,this._lazyConfigAsync.valueAsync()];case 1:return e=a.sent(),this._verifyCdsConnectorConfigured(e),r={baseUrl:e.baseUrl,annotationFormat:"*"},n={baseUrl:new Core.Url("".concat(e.baseUrl.origin(),"/api/data/v9.0"))},[2,new l.ODataConnector(o,v.ConnectedDataConstants.TypesManagerPrefix,i,r,n,d,this.queryStringBuilder,t._getDefaultHeaders(this._tableMetadata.logicalName))]}}))}))})),_._lazyCopilotConnector=new Core.AsyncLazy("CdsConnector._lazyCopilotConnector",(function(){return __awaiter(_,void 0,void 0,(function(){var e,t;return __generator(this,(function(r){switch(r.label){case 0:return[4,this._lazyConfigAsync.valueAsync()];case 1:return e=r.sent(),this._verifyCdsConnectorConfigured(e),t={baseUrl:new Core.Url("".concat(e.baseUrl.origin(),"/api/copilot/v1.0"))},[2,new m(i,t,d)]}}))}))})),_._lazyAttachmentsHelper=new Core.Lazy((function(){return new s.CdsAttachmentsHelper(_._dataSourceName,_._lazyConfigAsync,_._lazyOdataConnector,_._tableMetadata,_._telemetryBaseData)})),_._lazyFileHelper=new Core.Lazy((function(){return new u.CdsFileHelper(_._dataSourceName,_._lazyConfigAsync,_._lazyOdataConnector,_._tableMetadata,_._telemetryBaseData,_._mediaResolver)})),_._entityType=f.Templates.ConnectedDataSourceEntityType.expandUrl({datasourceName:_.dataSourceName}),_}return __extends(t,e),t.prototype._verifyCdsConnectorConfigured=function(e){if(e.state===a.CdsDataSourceState.NotConfigured)throw new n.TabularDataError({message:AppMagic.Strings.CdsDataSourceNotConfigured,errorKind:n.ConnectedDataErrorKind.NotConfigured,isExpectedError:!0});if(e.state===a.CdsDataSourceState.ClientNotSupported)throw new n.TabularDataError({message:AppMagic.Strings.DataSourceWinClientNotSupported,errorKind:n.ConnectedDataErrorKind.ClientNotSupported});if(e.state===a.CdsDataSourceState.ClientNeedsUpgrade)throw new n.TabularDataError({message:AppMagic.Strings.DataSourceClientUpgradeNeeded,errorKind:n.ConnectedDataErrorKind.ClientUpgradeNeeded})},t._getDefaultHeaders=function(e){if(AppMagic.Utility.IsMdlIntegrationEnabled()){var t=HashTableUtility.create();return t[_.HeaderName.CdsLogicalNameForMdl]=e,t[_.HeaderName.CustomHeadersOptions]=JSON.stringify({optInMSHeaders:!0}),Core.Telemetry.Log.trackActivityEvent("CdsConnector._getDefaultHeaders",{logicalName:e}),t}return null},Object.defineProperty(t.prototype,"metadata",{get:function(){return this._tableMetadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entityType",{get:function(){return this._entityType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataSourceName",{get:function(){return this._dataSourceName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isConfigLoaded",{get:function(){return this._lazyConfigAsync.isValueCreated},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"queryStringBuilder",{get:function(){return this._queryStringBuilder},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cdsAttachmentHelper",{get:function(){return this._lazyAttachmentsHelper.value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectorType",{get:function(){return"CdsConnector"},enumerable:!1,configurable:!0}),t.prototype.getRowsAsync=function(e,t){var r,a,o;return void 0===t&&(t={}),__awaiter(this,void 0,Promise,(function(){var i,s,u,l,p,d,h,m,f=this;return __generator(this,(function(v){switch(v.label){case 0:if(t=__assign(__assign({},{maxRowCount:1/0,skip:0}),t),e.queryOptions&&e.queryOptions.skipCall)return[2,Object(y.createEmptyGetRowsResult)()];if(!Object(n.isValidFilterQuery)(null===(r=e.queryOptions)||void 0===r?void 0:r.filter)||Object(n.doesFilterEvaluateToFalse)(e.queryOptions))return[2,Object(y.createEmptyGetRowsResult)()];i="CdsConnector.getRowsAsync",v.label=1;case 1:return v.trys.push([1,5,,6]),[4,this._lazyOdataConnector.valueAsync()];case 2:return s=v.sent(),u=this.getPreProcessFunc(e),l=(null==t?void 0:t.forceDataLimit)?Math.min(this._maxPageSizeLimit,t.maxRowCount):void 0,[4,s.getRowsAsync(e,this.metadata.name,{top:null===(a=e.queryOptions)||void 0===a?void 0:a.top,skip:t.skip,maxPageSize:l,includeCounts:!Core.FallbackSwitch.isActivated("Controls.DisablePcfCdsServerRecordCountV2"),preProcessor:u,errorContext:this._createErrorContext("getRows",i,t.errorContext),batchInfo:null!==(o=t.batchInfo)&&void 0!==o?o:{batchId:""}})];case 3:return p=v.sent(),d=this._processGetRowsResult(p,t.skip,this,l),h=function(r,n,a){return __awaiter(f,void 0,Promise,(function(){var o;return __generator(this,(function(s){switch(s.label){case 0:return o=this._createErrorContext("getMoreRows",i,t.errorContext),[4,this._getMoreRowsCoreAsync(r,e.tableLogicalName,n,u,o,a)];case 1:return[2,s.sent()]}}))}))},[4,Object(y.getRemainingRowsIfNeededAsync)(d,t.maxRowCount,this._dataSourceName,h,this._telemetryBaseData)];case 4:return[2,v.sent()];case 5:throw m=v.sent(),Object(c.processAndThrowTabularError)(i,m,AppMagic.Strings.ConnectedDataGetRowsPermissionDenied,this._telemetryBaseData);case 6:return[2]}}))}))},t.prototype.getPreProcessFunc=function(e){return o.containsViewFilter(e)?this._preProcessCdsViewResponse.bind(this):void 0},t.prototype._preProcessCdsViewResponse=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){return[2,o.preProcessViewResponse(e,this._tableMetadata.navigationColumns,this._tableMetadata.entitySetName===v.PolymorphicLookup.ActivitiesSetName)]}))}))},t.prototype._processGetRowsResult=function(e,t,r,n){var a=Object(i.safeCast)(e);return a.maxPageSize=n,Object(y.ensureKeyIfReadOnlyTable)(a.items,t,this.metadata),r.cdsAttachmentHelper.addAttachmentsAppResUrisToResult(a),Object(y.validateServerResult)(a)},t.prototype._getMoreRowsCoreAsync=function(e,t,r,n,a,o){return __awaiter(this,void 0,Promise,(function(){var s,c,u,l;return __generator(this,(function(p){switch(p.label){case 0:return[4,this._lazyOdataConnector.valueAsync()];case 1:return s=p.sent(),c={batchId:""},l=i.safeCast,[4,s.getMoreRowsAsync(e,t,{preProcessor:n,errorContext:a,batchInfo:c,maxPageSize:o})];case 2:return u=l.apply(void 0,[p.sent()]),[2,this._processGetRowsResult(u,r,this,o)]}}))}))},t.prototype.getOptionSetItemsAsync=function(e,r,n){return __awaiter(this,void 0,Promise,(function(){var a,o,i,s,c,u,l;return __generator(this,(function(p){switch(p.label){case 0:a=this.metadata.tryGetColumn(e),o=a,i="CdsConnector.getOptionSetItemsAsync",p.label=1;case 1:return p.trys.push([1,4,,5]),[4,this._lazyOdataConnector.valueAsync()];case 2:return s=p.sent(),c=void 0,c=o.optionSetType!==v.OptionSetTypes.BooleanOptionSet?this._lazyOptionSetUrlTemplate.value.expandUrl({columnLogicalName:o.name,entityLogicalName:this.metadata.name,optionSetType:this._getQueryOptionSetType(o.optionSetType)}):this._lazyBooleanOptionSetUrlTemplate.value.expandUrl({columnLogicalName:o.name,entityLogicalName:this.metadata.name,optionSetType:this._getQueryOptionSetType(o.optionSetType)}),u=this._createErrorContext("getOptionSetItems",i,r),[4,s.runUnsafeGetQueryAsync(i,Core.UrlBuilder.composeUrlAppendToBase(this._lazyConfigAsync.value.baseUrl,c),{errorContext:u,batchInfo:n||{batchId:""},optionalHeaders:w()})];case 3:return l=p.sent(),[2,{results:t._mapCdsOptionSetToPAOptionChoices(l,o.optionSetType)}];case 4:return p.sent(),Core.Log.warning("CdsConnector._getOptionSetChoicesAsync","Fallback to get optionset from column metadata."),[2,{results:o.optionSetValues}];case 5:return[2]}}))}))},t._mapCdsOptionSetToPAOptionChoices=function(e,r){return r===v.OptionSetTypes.BooleanOptionSet?t._mapCdsBooleanOptionSetToPAOptionSet(e):t._mapCdsOptionSetNonBooleanToPAOptionSet(e)},t._mapCdsBooleanOptionSetToPAOptionSet=function(e){var r=[],n=A.CdsBooleanOptionSetOptions.safeCast(e.response);return t._validateOptionSetCast(n),r.push({Value:{Id:!0,Value:n.OptionSet.TrueOption.Label.UserLocalizedLabel.Label}}),r.push({Value:{Id:!1,Value:n.OptionSet.FalseOption.Label.UserLocalizedLabel.Label}}),r},t._mapCdsOptionSetNonBooleanToPAOptionSet=function(e){var r=[],n=AppMagic.Services.DirectConnector.CdsTransferTypes.CdsOptionSetOptions.safeCast(e.response);return t._validateOptionSetCast(n),n.OptionSet.Options.forEach((function(e){var t={Value:{Id:e.Value,Value:e.Label.UserLocalizedLabel.Label}};r.push(t)})),r},t._validateOptionSetCast=function(e){if(!e)throw new n.TabularDataError({errorKind:n.ConnectedDataErrorKind.InvalidServerResponse,message:AppMagic.Strings.ConnectedDataInvalidResult})},t.prototype._getQueryOptionSetType=function(e){switch(e){case v.OptionSetTypes.BooleanOptionSet:return"Boolean";case v.OptionSetTypes.PicklistType:return"Picklist";case v.OptionSetTypes.StateType:return"State";case v.OptionSetTypes.StatusType:return"Status";case v.OptionSetTypes.MultiSelectOptionSet:return"MultiSelectPicklist";case v.OptionSetTypes.Virtual:return"Virtual";default:return Object(y.logError)("CdsConnector._getQueryOptionSetType","".concat(e," is not supported."),this._telemetryBaseData),""}},t.prototype.getViewsAsync=function(e,r,n){return __awaiter(this,void 0,Promise,(function(){var a,o,i,s,u,l,p;return __generator(this,(function(d){switch(d.label){case 0:a="CdsConnector.getViewsAsync",d.label=1;case 1:return d.trys.push([1,4,,5]),[4,this._lazyOdataConnector.valueAsync()];case 2:return o=d.sent(),(i=new Core.UrlBuilder(this._lazyConfigAsync.value.baseUrl)).appendPath("savedqueries"),(s=HashTableUtility.create())[g.QueryOption.Filter]="returnedtypecode eq '".concat(e,"' and (querytype eq 0 or querytype eq 1 or querytype eq 2 or querytype eq 64) and statuscode eq 1 and fetchxml ne null and fetchxml ne ''"),s[g.QueryOption.Select]="savedqueryid,name,fetchxml",i.setQueryParams(s),u=this._createErrorContext("getViews",a,r),[4,o.runUnsafeGetQueryAsync(a,i.toUrl(),{errorContext:u,batchInfo:n||{batchId:""}})];case 3:return l=d.sent(),[2,{results:t._mapCdsViewsToPAViews(l)}];case 4:throw p=d.sent(),Object(c.processAndThrowTabularError)(a,p,AppMagic.Strings.ConnectedDataGetRowsPermissionDenied,this._telemetryBaseData);case 5:return[2]}}))}))},t._mapCdsViewsToPAViews=function(e){var r=[],n=A.CdsViews.safeCast(e.response);return t._validateAndThrowViewsCast(n),n.value.sort((function(e,t){return e.name.localeCompare(t.name)})).forEach((function(e){var t={Value:{Id:e.savedqueryid,Value:e.name,DoesNotSupportBinary:!(!e.fetchxml||-1===e.fetchxml.indexOf('distinct="true"'))}};r.push(t)})),r},t._validateAndThrowViewsCast=function(e){if(!e)throw new n.TabularDataError({errorKind:n.ConnectedDataErrorKind.InvalidServerResponse,message:AppMagic.Strings.ConnectedDataInvalidResult})},t.prototype.getMoreRowsAsync=function(e,t,r,n,a){return void 0===r&&(r=1/0),__awaiter(this,void 0,Promise,(function(){var a,o=this;return __generator(this,(function(i){"CdsConnector.getMoreRowsAsync",Core.Telemetry.Log.trackActivityEvent("CdsConnector.getMoreRowsAsync",{dataSourceName:this.dataSourceName,maxRowCount:r});try{return Object(y.hadEnoughLeftovers)(e,r)?[2,Object(y.returnLeftovers)(e,r)]:(a=function(e,r){return __awaiter(o,void 0,Promise,(function(){var a,o,i;return __generator(this,(function(s){switch(s.label){case 0:return"cdsNavigatedColumnArrayQueryDefinition"===t.sourceType?a=t.tableLogicalName:(a=t.tableLogicalName,o=this.getPreProcessFunc(t)),i=this._createErrorContext("getMoreRows","CdsConnector.getMoreRowsAsync",n),[4,this._getMoreRowsCoreAsync(e,a,r,o,i)];case 1:return[2,s.sent()]}}))}))},[2,Object(y.followGetRowsNextLinksAsync)(e.leftovers||[],e.nextLink,r,this._dataSourceName,a,this._telemetryBaseData)])}catch(e){throw Object(c.processAndThrowTabularError)("CdsConnector.getMoreRowsAsync",e,AppMagic.Strings.ConnectedDataGetRowsPermissionDenied,this._telemetryBaseData)}return[2]}))}))},t.prototype.getConnectorTypeNameAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,{tableName:this.metadata.entitySetName,serverTableName:this.metadata.entitySetName}]}))}))},t.prototype.createRowAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,a,o,i,s,u,l,p,d,h,m,f,g,C;return __generator(this,(function(_){switch(_.label){case 0:n="CdsConnector.createRowAsync",_.label=1;case 1:return _.trys.push([1,6,,7]),[4,this._lazyOdataConnector.valueAsync()];case 2:for(a=_.sent(),o=v.DataRecord.create(),i=this.metadata.columns,s=0,u=i.length;s<u;s++)l=i[s],p=e[l.name],Core.Utility.isNullOrUndefined(p)||(l.isPolymorphic?o[l.name]=p:l.isNavigation?l.isArray||(o[l.name]=p):void 0!==(d=Object(y.addColumnParameter)(l,e,this._prepareBlobColumns(e),AppMagic.Services.ODataUtility.formatNavigationBindPropertyName))&&(o[l.name]=d));return[4,this.getConnectorTypeNameAsync()];case 3:return h=_.sent(),[4,this._getBaseUrlBuilderAsync()];case 4:return(m=_.sent()).appendPath(h.serverTableName),f=this._createErrorContext("createRow",n,t),[4,a.createRowAsync(m.doneToUrl(),o,this.metadata.name,{errorContext:f,batchInfo:r||{batchId:""}})];case 5:return g=_.sent(),[2,this._processRow(g)];case 6:throw C=_.sent(),Object(c.processAndThrowTabularError)(n,C,AppMagic.Strings.ConnectedDataCreateRowPermissionDenied,this._telemetryBaseData);case 7:return[2]}}))}))},t.prototype.patchRowAsync=function(e,t,r,n){return __awaiter(this,void 0,Promise,(function(){var a,o,i,s,u,l,p,d,h,m,f,g,b,A,S;return __generator(this,(function(w){switch(w.label){case 0:a="CdsConnector.patchRowAsync",w.label=1;case 1:return w.trys.push([1,5,,6]),[4,this._lazyOdataConnector.valueAsync()];case 2:for(o=w.sent(),i=v.DataRecord.create(),s=this.metadata.columns,u=!1,l=0;l<s.length;l++)p=s[l],d=t[p.name],Core.Utility.isUndefined(d)||p.isNavigation&&p.isArray||(p.isPolymorphic||p.isNavigation?(i[p.name]=d,null===d&&(u=!0)):void 0!==(h=Object(y.addPatchColumnParameter)(p,t,this._prepareBlobColumns(t),AppMagic.Services.ODataUtility.formatNavigationBindPropertyName))&&(i[p.name]=h));return HashTableUtility.isEmpty(i)?[2,e]:[4,this._getReadWriteUrlAsync(e)];case 3:return m=w.sent(),f=void 0,u&&(f=HashTableUtility.create(((S={})[_.HeaderName.CdsAutoDisassociate]="true",S))),this._tableMetadata.tableType!==C.Elastic||Core.FallbackSwitch.isActivated("AppConnectivity.sendMatchIfHeaderForElasticTablePatch")||(f||(f=HashTableUtility.create()),f[_.HeaderName.IfMatch]=_.HeaderValue.MatchAll),g=this._createErrorContext("patchRow",a,r),[4,o.patchRowAsync(m,i,this.metadata.name,{errorContext:g,batchInfo:n||{batchId:""},optionalHeaders:f})];case 4:return b=w.sent(),[2,this._processRow(b)];case 5:throw A=w.sent(),Core.Utility.isArray(A)&&(A=A[0]),Object(c.processAndThrowTabularError)(a,A,AppMagic.Strings.ConnectedDataPatchRowPermissionDenied,this._telemetryBaseData);case 6:return[2]}}))}))},t.prototype.deleteRowAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,a,o,i,s;return __generator(this,(function(u){switch(u.label){case 0:n="CdsConnector.deleteRowAsync",u.label=1;case 1:return u.trys.push([1,5,,6]),[4,this._lazyOdataConnector.valueAsync()];case 2:return a=u.sent(),[4,this._getReadWriteUrlAsync(e)];case 3:return o=u.sent(),i=this._createErrorContext("deleteRow",n,t),[4,a.deleteRowAsync(o,{errorContext:i,batchInfo:r||{batchId:""}})];case 4:return u.sent(),[3,6];case 5:throw s=u.sent(),Object(c.processAndThrowTabularError)(n,s,AppMagic.Strings.ConnectedDataDeleteRowPermissionDenied,this._telemetryBaseData);case 6:return[2]}}))}))},t.prototype.getAttachmentsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this._lazyAttachmentsHelper.value.getAttachmentsAsync(t,r)];case 1:return[2,e.sent()]}}))}))},t.prototype.createAttachmentAsync=function(e,t,r,n,a){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(o){switch(o.label){case 0:return[4,this._lazyAttachmentsHelper.value.createAttachmentAsync(e,t,r,this._mediaResolver,this._binaryResolver,n,a)];case 1:return[2,o.sent()]}}))}))},t.prototype.deleteAttachmentAsync=function(e,t,r,n){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this._lazyAttachmentsHelper.value.deleteAttachmentAsync(r,n)];case 1:return[2,e.sent()]}}))}))},t.prototype.downloadAttachmentAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this._lazyAttachmentsHelper.value.downloadAttachmentAsync(e,this._mediaResolver)];case 1:return[2,t.sent()]}}))}))},t.prototype.createFileAsync=function(e,t,r,n,a){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(o){switch(o.label){case 0:return[4,this._lazyFileHelper.value.createFileAsync(e,t,r,n,a)];case 1:return[2,o.sent()]}}))}))},t.prototype.deleteFileAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(n){switch(n.label){case 0:return[4,this._lazyFileHelper.value.deleteFileAsync(e,t,r)];case 1:return[2,n.sent()]}}))}))},t.prototype.downloadFileAsync=function(e,t,r,n){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(a){switch(a.label){case 0:return[4,this._lazyFileHelper.value.downloadFileAsync(e,t,r,n)];case 1:return[2,a.sent()]}}))}))},t.prototype.validateFileAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){switch(r.label){case 0:return[4,this._lazyFileHelper.value.validateFileAsync(e,t)];case 1:return[2,r.sent()]}}))}))},t.prototype.relateAsync=function(e,t,r,n,a){return __awaiter(this,void 0,Promise,(function(){var o,i,s,u,l,p,d,h;return __generator(this,(function(m){switch(m.label){case 0:o="CdsConnector.relateAsync",Core.Telemetry.Log.trackActivityEvent(o,{dataSourceName:this.dataSourceName}),m.label=1;case 1:return m.trys.push([1,7,,8]),[4,this.getConnectorTypeNameAsync()];case 2:return i=m.sent(),[4,this._getBaseUrlBuilderAsync()];case 3:return(s=m.sent()).appendPath("".concat(i.serverTableName,"(").concat(e,")")),s.appendPath("".concat(t)),s.appendPath("$ref"),u=s.doneToUrl(),[4,this._getBaseUrlBuilderAsync()];case 4:return(l=m.sent()).appendPath(r),(p=HashTableUtility.create())[b.ODataConstants.MetadataPropertyName.Id]=l.toString(),d=this._createErrorContext("relate",o,n),[4,this._lazyOdataConnector.valueAsync()];case 5:return[4,m.sent().runUnsafeWriteRequestAsync(o,u,_.Method.POST,JSON.stringify(p),b.ResponseTypes.Text,{errorContext:d,batchInfo:a||{batchId:""}})];case 6:return m.sent(),[2,!0];case 7:throw h=m.sent(),Object(c.processAndThrowTabularError)(o,h,AppMagic.Strings.ConnectedDataRelateUnrelatePermissionDenied,this._telemetryBaseData);case 8:return[2]}}))}))},t.prototype.unrelateAsync=function(e,t,r,n,a){return __awaiter(this,void 0,Promise,(function(){var o,i,s,u,l;return __generator(this,(function(p){switch(p.label){case 0:o="CdsConnector.unrelateAsync",Core.Telemetry.Log.trackActivityEvent(o,{dataSourceName:this.dataSourceName}),p.label=1;case 1:return p.trys.push([1,6,,7]),[4,this.getConnectorTypeNameAsync()];case 2:return i=p.sent(),[4,this._getBaseUrlBuilderAsync()];case 3:return(s=p.sent()).appendPath("".concat(i.serverTableName,"(").concat(e,")")),s.appendPath("".concat(t,"(").concat(r,")")),s.appendPath("$ref"),u=s.doneToUrl(),[4,this._lazyOdataConnector.valueAsync()];case 4:return[4,p.sent().runUnsafeDeleteRequestAsync(o,u,{errorContext:n,batchInfo:a||{batchId:""}})];case 5:return p.sent(),[2,!0];case 6:throw l=p.sent(),Object(c.processAndThrowTabularError)(o,l,AppMagic.Strings.ConnectedDataRelateUnrelatePermissionDenied,this._telemetryBaseData);case 7:return[2]}}))}))},t.prototype._getBaseUrlBuilderAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return[4,this._lazyConfigAsync.value.baseUrl];case 1:return e=t.sent(),[2,new Core.UrlBuilder(e)]}}))}))},t.prototype.getBaseUrlAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this._lazyConfigAsync.isValueCreated?[4,this._lazyConfigAsync.value.baseUrl.toString()]:[3,2];case 1:return[2,e.sent()];case 2:return[2,""]}}))}))},t.prototype.getNavigatedRowInTableRowAsync=function(e,t,r,n){var a,o,i,s;return __awaiter(this,void 0,Promise,(function(){var u,l,p,d,h,m,y,f,v;return __generator(this,(function(g){switch(g.label){case 0:u="CdsConnector.getNavigatedRowInTableRowAsync",g.label=1;case 1:return g.trys.push([1,7,,8]),[4,this._lazyOdataConnector.valueAsync()];case 2:return l=g.sent(),[4,this._getBaseUrlBuilderAsync()];case 3:return p=g.sent(),[4,this.getConnectorTypeNameAsync()];case 4:return d=g.sent(),[4,this._queryStringBuilder.getStringParametersAsync(null==n?void 0:n.queryOptions)];case 5:return h=g.sent(),p.appendPath("".concat(d.serverTableName,"(").concat(t,")/").concat(r)),p.setQueryParams(h),m=this._createErrorContext("getNavigatedRowInTableRow",u,null==n?void 0:n.errorContext),[4,l.getMoreRowsAsync(p.doneToString(),e.metadata.name,{errorContext:m,batchInfo:(null==n?void 0:n.batchInfo)||{batchId:""},maxPageSize:null!==(o=null===(a=null==n?void 0:n.queryOptions)||void 0===a?void 0:a.top)&&void 0!==o?o:null==n?void 0:n.maxPageSize})];case 6:return y=g.sent(),[2,{results:(f=this._processGetRowsResult(y,0,e,null!==(s=null===(i=null==n?void 0:n.queryOptions)||void 0===i?void 0:i.top)&&void 0!==s?s:null==n?void 0:n.maxPageSize)).items,nextLink:f.nextLink}];case 7:throw v=g.sent(),Object(c.processAndThrowTabularError)(u,v,AppMagic.Strings.ConnectedDataGetRowsPermissionDenied,this._telemetryBaseData);case 8:return[2]}}))}))},t.prototype.getRowAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,a,o,i,s,u;return __generator(this,(function(l){switch(l.label){case 0:n="CdsConnector.getRowAsync",l.label=1;case 1:return l.trys.push([1,5,,6]),[4,this._lazyOdataConnector.valueAsync()];case 2:return a=l.sent(),[4,this._getReadWriteUrlAsync(e)];case 3:return o=l.sent(),i=this._createErrorContext("getRow",n,t),[4,a.getRowAsync(o,this.metadata.name,{errorContext:i,batchInfo:r||{batchId:""}})];case 4:return s=l.sent(),[2,this._processRow(s)];case 5:throw u=l.sent(),Object(c.processAndThrowTabularError)(n,u,AppMagic.Strings.ConnectedDataGetRowPermissionDenied,this._telemetryBaseData);case 6:return[2]}}))}))},t.prototype._prepareBlobColumns=function(e){if(0===this._tableMetadata.inlineBlobColumns.length)return null;var t=v.DataRecord.create();return this._tableMetadata.inlineBlobColumns.forEach((function(r){var n=e[r.name];Core.Utility.isValue(n)&&(t[r.name]=n)})),t},t.prototype._getReadWriteUrlAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,n,a;return __generator(this,(function(o){switch(o.label){case 0:return[4,this._getBaseUrlBuilderAsync()];case 1:return t=o.sent(),[4,this.getConnectorTypeNameAsync()];case 2:r=o.sent(),n=this.metadata.getPrimaryKey(e);try{a=JSON.parse(n),t.appendPath("".concat(r.serverTableName,"(").concat(a,")"))}catch(e){throw e}return[2,t.doneToUrl()]}}))}))},t.prototype._processRow=function(e){return v.DataRecord.isDataRecord(e)?(this.cdsAttachmentHelper.addAttachmentsAppResUriToRecord(e,Core.Utility.generate128BitUUID()),e):null},t.prototype.getScalarResultAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var a,o,i,s,u,l;return __generator(this,(function(p){switch(p.label){case 0:if(!Core.FallbackSwitch.isActivated("AppConnectivity.shortCircuitAggregateFailures")&&(!Object(n.isValidFilterQuery)(null==e?void 0:e.filter)||Object(n.doesFilterEvaluateToFalse)(e)))return Object(n.isCountFunction)(e)?[2,{result:0}]:[2,{}];a="CdsConnector.getScalarResultAsync",p.label=1;case 1:return p.trys.push([1,8,,9]),[4,this.getConnectorTypeNameAsync()];case 2:return o=p.sent(),[4,this._lazyOdataConnector.valueAsync()];case 3:return i=p.sent(),s=this._createErrorContext("getScalarResult",a,t),u=void 0,Object(n.isUnfilteredCountFunction)(e)?[4,this._getUnfilteredCountResultAsync(this.metadata.name,e,s,r||{batchId:""})]:[3,5];case 4:return u=p.sent(),[3,7];case 5:return[4,i.getScalarResultAsync(o.serverTableName,e,{errorContext:s,batchInfo:r||{batchId:""}})];case 6:u=p.sent(),p.label=7;case 7:return[2,Object(y.validateServerResult)(u)];case 8:throw l=p.sent(),Object(c.processAndThrowTabularError)(a,l,AppMagic.Strings.ConnectedDataGetRowsPermissionDenied,this._telemetryBaseData);case 9:return[2]}}))}))},t.prototype._getUnfilteredCountResultAsync=function(e,t,r,a){return __awaiter(this,void 0,Promise,(function(){var o,i,s;return __generator(this,(function(c){switch(c.label){case 0:return[4,this._lazyOdataConnector.valueAsync()];case 1:return o=c.sent(),[4,this._getBaseUrlBuilderAsync()];case 2:return(i=c.sent()).appendSegment(Object(n.formatCdsUnfilteredCount)(e)),[4,o.getScalarResultCoreAsync(i,t,{errorContext:r,batchInfo:a})];case 3:return s=c.sent(),[2,this._createUnfilteredCountResponse(s)]}}))}))},t.prototype._createUnfilteredCountResponse=function(e){var t,r,a,o;if(Core.Utility.isNullOrUndefined(null===(r=null===(t=e.response)||void 0===t?void 0:t.EntityRecordCountCollection)||void 0===r?void 0:r.Values[0]))throw new n.TabularDataError({message:AppMagic.Strings.ConnectedDataInvalidResult,errorKind:n.ConnectedDataErrorKind.InvalidResult});return{result:null===(o=null===(a=e.response)||void 0===a?void 0:a.EntityRecordCountCollection)||void 0===o?void 0:o.Values[0]}},t.prototype._createErrorContext=function(e,t,r){return Core.Diagnostics.createErrorContext({protocol:"cds",operation:e,dataSource:this.dataSourceName,apiId:this._telemetryBaseData.apiId,table:this.metadata.entitySetName,operationName:t},r)},t.prototype.unsafeInvokeActionAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,n,a,o;return __generator(this,(function(i){switch(i.label){case 0:t=__assign(__assign({},e),{tableName:this.metadata.entitySetName}),r="CdsConnector.unsafeInvokeActionAsync",i.label=1;case 1:return i.trys.push([1,4,,5]),[4,this._lazyOdataConnector.valueAsync()];case 2:return n=i.sent(),a=this._createErrorContext("invokeAction",r),[4,n.unsafeInvokeActionAsync(t,a)];case 3:return[2,i.sent()];case 4:throw o=i.sent(),Object(y.logError)(r,"Error invoking action: ".concat(t.action," on ").concat(t.tableName),this._telemetryBaseData,o),o;case 5:return[2]}}))}))},t.prototype.unsafeInvokeCopilotActionAsync=function(e,t,r){return __awaiter(this,void 0,void 0,(function(){var n,a,o,i,s;return __generator(this,(function(c){switch(c.label){case 0:n="CdsConnector.unsafeInvokeCopilotActionAsync",c.label=1;case 1:return c.trys.push([1,4,,5]),[4,this._lazyCopilotConnector.valueAsync()];case 2:return a=c.sent(),o=this._createErrorContext("invokeAction",n),i=r?"POST":"GET",[4,a.runUnsafeRequestAsync(n,e,i,r?JSON.stringify(r):void 0,b.ResponseTypes.Json,{errorContext:o,optionalHeaders:t})];case 3:return[2,c.sent()];case 4:throw s=c.sent(),Object(y.logError)(n,"Error invoking action: ".concat(e),this._telemetryBaseData,s),s;case 5:return[2]}}))}))},t.prototype.getOrganizationSettingsAsync=function(e,t,r){return __awaiter(this,void 0,void 0,(function(){var n,a,o,i,s;return __generator(this,(function(c){switch(c.label){case 0:n="CdsConnector.getOrganizationSettingsAsync",c.label=1;case 1:return c.trys.push([1,5,,6]),[4,this._lazyOdataConnector.valueAsync()];case 2:return a=c.sent(),o=this._createErrorContext("invokeAction",n),[4,this._createDataverseRequestUrl(a.getDataverseRuntimeBaseUrl(),t,e)];case 3:return i=c.sent(),[4,a.runUnsafeGetQueryAsync(n,i,{errorContext:o,optionalHeaders:r,responseType:b.ResponseTypes.Json})];case 4:return[2,c.sent()];case 5:throw s=c.sent(),Object(y.logError)(n,"Error invoking operation: ".concat(n),this._telemetryBaseData,s),s;case 6:return[2]}}))}))},t.prototype.getResultCountAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var a,o;return __generator(this,(function(i){switch(i.label){case 0:return Core.FallbackSwitch.isActivated("AppConnectivity.shortCircuitAggregateFailures")||Object(n.isValidFilterQuery)(null==e?void 0:e.filter)&&!Object(n.doesFilterEvaluateToFalse)(e)?((a=Object(n.getScalarQueryOptions)(Object(n.createCountFunctionOperand)(),"n")).filter=e.filter,[4,this.getScalarResultAsync(a,t,r)]):[2,0];case 1:o=i.sent();try{if(Core.Utility.isNumber(o))return[2,o];if(v.DataRecord.isDataRecord(o)&&Core.Utility.isNumber(o.result))return[2,o.result];Contracts.check(!1)}catch(e){throw Object(c.processAndThrowTabularError)("CdsConnector.getResultCountAsync",e,AppMagic.Strings.ConnectedDataInvalidResult,this._telemetryBaseData)}return[2]}}))}))},t.prototype.downloadReferencedBlobAsync=function(e){throw new Core.NotImplementedError},t.prototype.downloadInlineBlobAsync=function(e,t){throw new Core.NotImplementedError},t.prototype.replaceRowAsync=function(e,t){throw new Core.NotImplementedError},t.prototype.getUserPrivilegeForEntityAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,n,a,o,i,s,c;return __generator(this,(function(u){switch(u.label){case 0:t="CdsConnector.getUserPrivilegeForEntityAsync",r=!0,u.label=1;case 1:return u.trys.push([1,6,,7]),[4,this._lazyOdataConnector.valueAsync()];case 2:return n=u.sent(),[4,this._dataSet.cdsDataSetConnector.getSystemUserIdAsync(n)];case 3:return(a=u.sent())?(o=this._lazyUserEntityPrivilegeUrlTemplate.value.expandUrl({sytemuserId:a,privilegeName:e}),i=this._createErrorContext("getUserPrivilegeForEntityAsync",t),[4,n.runUnsafeGetQueryAsync(t,Core.UrlBuilder.composeUrlAppendToBase(n.getRuntimeBaseUrl(),o),{errorContext:i,batchInfo:{batchId:""}})]):[3,5];case 4:s=u.sent(),r=this._parsePrivilegeResponse(s),u.label=5;case 5:return[3,7];case 6:return c=u.sent(),Object(y.logWarning)(t,"Error retrieving User Entity privilege ".concat(e," for the current user"),this._telemetryBaseData,c),[3,7];case 7:return[2,{results:[{value:r}]}]}}))}))},t.prototype._parsePrivilegeResponse=function(e){var t,r;return!(0==(null===(r=null===(t=e.response)||void 0===t?void 0:t.RolePrivileges)||void 0===r?void 0:r.length))},t.prototype.getUserPrivilegeForRecordAsync=function(e){var t,r;return __awaiter(this,void 0,Promise,(function(){var a,o,i,s,c,u,l,p;return __generator(this,(function(d){switch(d.label){case 0:a="CdsConnector.getUserPrivilegeForRecordAsync",o=n.AccessList,d.label=1;case 1:return d.trys.push([1,6,,7]),[4,this._lazyOdataConnector.valueAsync()];case 2:return i=d.sent(),[4,this._dataSet.cdsDataSetConnector.getSystemUserIdAsync(i)];case 3:return(s=d.sent())&&this.metadata.entitySetName?(c=new Core.Url("/systemusers(".concat(s,")/Microsoft.Dynamics.CRM.RetrievePrincipalAccess(Target=@tid)?@tid={'@odata.id':'").concat(this.metadata.entitySetName,"(").concat(e,")'}")),u=this._createErrorContext("getUserPrivilegeForRecordAsync",a),[4,i.runUnsafeGetQueryAsync(a,Core.UrlBuilder.composeUrlAppendToBase(i.getRuntimeBaseUrl(),c),{errorContext:u,batchInfo:{batchId:""}})]):[3,5];case 4:l=d.sent(),o=null===(r=null===(t=null==l?void 0:l.response)||void 0===t?void 0:t.AccessRights)||void 0===r?void 0:r.split(", "),d.label=5;case 5:return[3,7];case 6:return p=d.sent(),Object(y.logWarning)(a,"Error retrieving Record privilege ".concat(e," for the current user"),this._telemetryBaseData,p),[3,7];case 7:return[2,{results:[{AccessRights:o}]}]}}))}))},t.prototype.getLocalizedDisplayNamesAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,a,o,i,s,c,u=this;return __generator(this,(function(l){switch(l.label){case 0:for(r={},n=[],a="",o=0,i=0,s=t;i<s.length;i++)c=s[i],(o>this._maxSupportedNumberOfFilters||a.length+c.length>this._maxColumnStringLength)&&(n.push(a),a="",o=0),o++,""!==a&&(a+=" or "),a+="LogicalName eq '".concat(c,"'");return n.push(a),[4,Core.PromiseUtils.join(n.map((function(t){return u._getLocalizedDisplayNamesInternalAsync(e,t)})))];case 1:return l.sent().forEach((function(e){return r=__assign(__assign({},r),e)})),[2,{results:[{value:r}]}]}}))}))},t.prototype._getLocalizedDisplayNamesInternalAsync=function(e,t){var r;return __awaiter(this,void 0,Promise,(function(){var n,a,o,i,s,c,u,l,p,d;return __generator(this,(function(h){switch(h.label){case 0:n="CdsConnector.getLocalizedDisplayNamesAsync",a={},h.label=1;case 1:return h.trys.push([1,4,,5]),[4,this._lazyOdataConnector.valueAsync()];case 2:return o=h.sent(),i=this._lazyLocalizedDisplayNameTemplate.value.expandUrl({entityLogicalName:e,columnLogicalNames:t}),s=this._createErrorContext("getLocalizedDisplayNamesAsync",n),[4,o.runUnsafeGetQueryAsync(n,Core.UrlBuilder.composeUrlAppendToBase(o.getRuntimeBaseUrl(),i),{errorContext:s,batchInfo:{batchId:""},optionalHeaders:w()})];case 3:for(c=h.sent(),u=0,l=null===(r=null==c?void 0:c.response)||void 0===r?void 0:r.Attributes;u<l.length;u++)p=l[u],a[p.LogicalName]=p.DisplayName.UserLocalizedLabel.Label;return[3,5];case 4:return d=h.sent(),Object(y.logWarning)(n,"Error retrieving the localized label for columns ".concat(t.toString()," and entity ").concat(e),this._telemetryBaseData,d),[3,5];case 5:return[2,a]}}))}))},t.prototype._createDataverseRequestUrl=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n;return __generator(this,(function(a){return(n=new Core.UrlBuilder(e)).appendPath(t),n.setQueryParam("$select",r.join(",")),[2,n.toUrl()]}))}))},t}(Core.Disposable);function w(){var e=HashTableUtility.create();return e[_.HeaderName.Consistency]=_.HeaderValue.ConsistencyStrong,e}},function(e,t,r){"use strict";r.r(t),r.d(t,"RestResponseBodyParamValueExpression",(function(){return n}));var n=function(e){function t(t,r){var n=e.call(this,r)||this;return n._name=t,n}return __extends(t,e),t.prototype.evaluate=function(e){return AppMagic.Services.ServiceUtility.createSuccessfulDataflowResult(e.bodyParams[this._name])},t}(r(15).RestResponseValueExpressionBase)},function(e,t,r){"use strict";r.r(t),r.d(t,"BinaryBodyRequestParam",(function(){return n}));r(31);var n=function(e){function t(t,r){return e.call(this,t,r,[AppMagic.Services.TypeSystem.TTypeValueKind.Binary])||this}return __extends(t,e),t.prototype._applyValue=function(e,t){e.setBodyBinary(t)},t}(AppMagic.Services.TypedRequestParamBase)},function(e,t,r){"use strict";r.r(t),r.d(t,"ClientDataProcessingService",(function(){return p}));var n=r(0),a=AppMagic.Schema,o=AppMagic.Functions,i=AppMagic.Services.TypeSystem.DateTimeUtility.convertDateStringToDValue,s=AppMagic.Services.TypeSystem.DateTimeUtility.convertDateTimeStringToDValue,c=AppMagic.Services.TypeSystem.DateTimeBehavior.NoTimeZone,u=function(e){return!0};function l(e,t){return!(!e||!t)&&(e in t&&!Core.Utility.isNullOrUndefined(t[e]))}var p=function(){function e(){}return e.prototype._evaluateOperand=function(e){switch(e.operandKind){case n.OperandKind.Filter:return this._evaluateFilterOperand(e);case n.OperandKind.Function:return this._evaluateFunctionOperand(e);default:return u}},e.prototype._evaluateFilterOperand=function(e){var t=this,r=e;switch(r.operator){case n.FilterOperator.None:return this._evaluateOperand(r.firstOperand);case n.FilterOperator.And:return function(e){return o.and(null,(function(){return t._evaluateOperand(r.firstOperand)(e)}),(function(){return t._evaluateOperand(r.secondOperand)(e)}))};case n.FilterOperator.Or:return function(e){return o.or(null,(function(){return t._evaluateOperand(r.firstOperand)(e)}),(function(){return t._evaluateOperand(r.secondOperand)(e)}))};case n.FilterOperator.Not:return function(e){return o.not(t._evaluateOperand(r.firstOperand)(e))};case n.FilterOperator.Equals:return function(e){var n=t._evaluatePropertyOperand(r.firstOperand),a=t._evaluateValueOperand(r.secondOperand);return n in e&&void 0!==e[n]&&o._eq(e[n],a)};case n.FilterOperator.NotEquals:return function(e){var n=t._evaluatePropertyOperand(r.firstOperand),a=t._evaluateValueOperand(r.secondOperand);return n in e?void 0!==e[n]&&o._neq(e[n],a):void 0===e[n]};case n.FilterOperator.GreaterThan:return function(e){var n=t._evaluatePropertyOperand(r.firstOperand),a=t._evaluateValueOperand(r.secondOperand);return n in e&&void 0!==e[n]&&o._gt(e[n],a)};case n.FilterOperator.GreaterThanOrEqual:return function(e){var n=t._evaluatePropertyOperand(r.firstOperand),a=t._evaluateValueOperand(r.secondOperand);return n in e&&void 0!==e[n]&&o._geq(e[n],a)};case n.FilterOperator.LessThan:return function(e){var n=t._evaluatePropertyOperand(r.firstOperand),a=t._evaluateValueOperand(r.secondOperand);return n in e&&void 0!==e[n]&&o._lt(e[n],a)};case n.FilterOperator.LessThanOrEqual:return function(e){var n=t._evaluatePropertyOperand(r.firstOperand),a=t._evaluateValueOperand(r.secondOperand);return n in e&&void 0!==e[n]&&o._leq(e[n],a)};default:return u}},e.prototype._evaluateFunctionOperand=function(e){var t=e,r=t.functionArguments,i=this._evaluatePropertyOperand(r[0]),s=this._evaluateValueOperand(r[1],a.TypeString,t.functionKind);switch(t.functionKind){case n.AppMagicDataQuery_FunctionKind.Contains:return function(e){return i in e&&void 0!==e[i]&&o.in_SS(s,e[i])};case n.AppMagicDataQuery_FunctionKind.StartsWith:return function(e){return i in e&&void 0!==e[i]&&o.startsWith(e[i],s)};case n.AppMagicDataQuery_FunctionKind.EndsWith:return function(e){return i in e&&void 0!==e[i]&&o.endsWith(e[i],s)};default:return u}},e.prototype._evaluateSortOnPropertyOperand=function(e,t){var r=e.onProperty,a=e.sortAscending,i=this._evaluatePropertyOperand(r),s=t.filter((function(e){return e.name===i}));if(!s.length)return function(e,t){return-1};var c=s[0].dataType;return function(e,t){var r=-1;if(l(i,e)&&l(i,t))switch(c){case n.PcfTypes.SingleLineText:var s=e[i].toLocaleLowerCase(),u=t[i].toLocaleLowerCase();r=o._lt(s,u)?-1:1;break;case n.PcfTypes.Decimal:case n.PcfTypes.DateAndTime:case n.PcfTypes.DateAndTimeDateOnly:r=o._lt(e[i],t[i])?-1:1}else l(i,t)&&(r=1);return a?r:-r}},e.prototype._evaluatePropertyOperand=function(e){return e.propertyName},e.prototype._evaluateValueOperand=function(e,t,r){var o=e;switch(o.dType){case a.TypeNumber:return parseFloat(o.value);case a.TypeDate:case a.TypeDateTime:case a.TypeDateTimeNoTimeZone:var u=s(c,o.value);return(u.hasOwnProperty("kind")||null===u)&&(u=i(o.value)),u;case a.TypeString:default:if(r===n.AppMagicDataQuery_FunctionKind.Contains){var l=null==o?void 0:o.value;if(l)return"%"===l[0]&&"%"===l[l.length-1]&&(l=l.slice(1,l.length-1)),l}return o.value}},e.prototype.getFilteredResult=function(e,t){if(Core.Telemetry.Log.trackActivityEvent("ClientDataProcessingService.getFilteredResult"),(null==t?void 0:t.filter)&&e){var r=this._evaluateOperand(t.filter),n=[];return e.forEach((function(e){null!=e&&r(e)&&n.push(e)})),n}return e},e.prototype.getSortedResult=function(e,t,r){if(Core.Telemetry.Log.trackActivityEvent("ClientDataProcessingService.getSortedResult"),e&&(null==t?void 0:t.sorts)&&t.sorts.length>0&&Core.Utility.isArray(r)&&r.length>0){var n=this._evaluateSortOnPropertyOperand(t.sorts[0],r);return e.sort(n)}return e},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"CompositeServiceFunction",(function(){return a}));var n=r(24),a=function(e){function t(t,r,n,a,o,i,s,c,u,l,p){var d=e.call(this,t,r,n,a,o,i,s,c,u)||this;return d._variables=l,d._returnExpression=p,d}return __extends(t,e),Object.defineProperty(t.prototype,"isBehaviorOnly",{get:function(){var e=this;return this._variables.some((function(t){return t.valueExpression.isBehaviorOnly(e)}))||this._returnExpression.isBehaviorOnly(this)},enumerable:!1,configurable:!0}),t.prototype.tryGetVariable=function(e){for(var t=0;t<this._variables.length;t++)if(this._variables[t].name===e)return this._variables[t];return null},t.prototype.computeResultSchema=function(e){return this._returnExpression.computeResultSchema(this,e)},t.prototype.runAsync=function(e,t){var r=this,a=HashTableUtility.create(),o=new n.FunctionExecutionContext(this.service.executionContext,e,a,null==t?void 0:t.onBeforeAsyncStep,null==t?void 0:t.onAfterAsyncStep);return this.executeVariablesAsync(o).then((function(){return r._returnExpression.evaluateAsync(o)}))},t.prototype.processRawResponse=function(e,t){return e},t.prototype.executeVariablesAsync=function(e){var t=Promise.resolve();return this._variables.forEach((function(r){t=t.then((function(){return r.valueExpression.evaluateAsync(e)})).then((function(t){Core.Utility.isUndefined(t)||e.addVariable(r.name,new AppMagic.Services.PrimitiveDArgument(t))}))})),t},t}(r(13).ServiceFunctionBase)},function(e,t,r){"use strict";r.r(t),r.d(t,"CdpConnector",(function(){return A}));var n=r(0),a=r(5),o=r(1),i=r(32),s=r(7),c=r(6),u=r(21),l=r(41),p=AppMagic.Services.CdpConstants.CdpNavigationRefIdKey,d=AppMagic.Services.HttpConstants.Method,h=AppMagic.Services.HttpConstants.HeaderName,m=AppMagic.Data,y=AppMagic.Services.PrimitiveDArgument,f=AppMagic.Services.TypeSystem,v=AppMagic.Services.ODataConstants,g=AppMagic.Services.HttpConstants,C=AppMagic.Services,_=new Core.UrlTemplate("{+baseUrl}{/tableId}/Relationship/{relationship}"),b=new Core.UrlTemplate("{+baseUrl}{/tableId}/Relationship/{relationship}/RelatedId/{relatedId}"),A=function(){function e(e,t,r,s,c,l,p,d,h,y,f,v,g,C){void 0===v&&(v=!1),void 0===g&&(g=!0),void 0===C&&(C=null);var _=this;this._dataSourceName=e,this._tableMetadata=t,this._connectionApiId=s,this._cdpTabularRevisionBaseUrl=c,this._appHttpClient=l,this._blobManager=d,this._mediaResolver=h,this._cdcManager=y,this._isStrongConsistencyRequired=v,this._referencedBlobProcessor=new u.ReferencedBlobProcessor(this,h),this._connectionApiId=s,this._cdpTabularRevisionBaseUrl=c,this._service=f,this._isDisposed=!1,this._entityType=AppMagic.AppResourceUri.Templates.ConnectedDataSourceEntityType.expandUrl({datasourceName:this.dataSourceName}),this._telemetryBaseData={dataSourceName:e,apiId:s},this._queryStringBuilder=Object(n.CreateCdpQueryStringBuilder)(t.capabilities.oDataVersion),this._lazyConnectionConfig=new Core.AsyncLazy("CdpConnector.connectionConfig",(function(){return __awaiter(_,void 0,void 0,(function(){var t,n,a,c,u,l,d,h,y,f,v,_,b;return __generator(this,(function(A){switch(A.label){case 0:return[4,p.tryGetDataSourceConfigAsync(e)];case 1:return!(t=A.sent())||t.error?(Object(o.logWarning)("CdpConnector._lazyRuntimeConfig","The connection reference has not been resolved. This instance will be put into an invalid state.",this._telemetryBaseData,null==t?void 0:t.error),[2,{isValid:!1,datasetName:"",tableName:"",connectionBaseUrl:void 0,itemsBaseUrl:void 0,serverTableName:"",isOverrideTableName:!1,error:t.error}]):(Core.Telemetry.Log.trackActivityEvent("CdpConnector._lazyRuntimeConfig",__assign(__assign({},this._telemetryBaseData),{message:"The datasource config was successfully retrieved.",appDataSourceConfig:JSON.stringify(t)})),n=new Core.UrlBuilder(t.runtimeUrl),a=!Core.Environment.isAuthoringTool()&&Core.Utility.isNonEmptyString(t.runtimePolicyName),c=t.connectionName,a&&(c=t.runtimePolicyName,u=t.connectionName,Core.Telemetry.Log.trackActivityEvent("UsingRuntimePolicy",{apiId:s,sharedConnectionId:t.connectionName,runtimePolicyId:t.runtimePolicyName})),n.appendSegment(c),l=n.toUrl(),d=r,h=this._tableMetadata.name,y=h,f=!1,t.cdpOverrides&&(t.cdpOverrides.datasetName&&(d=t.cdpOverrides.datasetName,Core.Utility.equalsIgnoreCase(this._connectionApiId,AppMagic.ConnectionHub.Constants.ApiIds.SharepointOnline)&&C&&C(d)),t.cdpOverrides.tableName&&(h=t.cdpOverrides.tableName,f=!0)),a&&this._connectionApiId.toLowerCase()===AppMagic.ConnectionHub.Constants.ApiIds.Sql&&"default"!==d&&(d="default,default"),v=new Core.UrlTemplate("{+baseUrl}{/version}/datasets/{datasetName}/tables/{tableName}/items"),_=v.expandUrl({baseUrl:l.toString(),version:this._cdpTabularRevisionBaseUrl&&this._cdpTabularRevisionBaseUrl.getSegment(0)||null,datasetName:g?Core.Url.encode(d):d,tableName:Core.Url.encode(h)}),b={isValid:!0,datasetName:d,tableName:h,connectionBaseUrl:l,itemsBaseUrl:_,serverTableName:y,isOverrideTableName:f,sharedConnectionId:u},this._telemetryBaseData.datasetName=b.datasetName,this._telemetryBaseData.tableName=b.tableName,this._service.getVariable(m.ConnectedDataDeserialization.ServiceVariableName.BaseUrl).value=b.connectionBaseUrl.toString(),this._service.getVariable(m.ConnectedDataDeserialization.ServiceVariableName.DatasetName).value=b.datasetName,this._service.getVariable(m.ConnectedDataDeserialization.ServiceVariableName.TableName).value=b.tableName,this._getFunctions=new i.CdpGetRowsFunction(_,this._connectionApiId,this._service.authenticationProviders[m.ConnectedDataConstants.AuthProviderId],this._dataSourceName,this._appHttpClient,this._isStrongConsistencyRequired,u),[2,b])}}))}))})),this._service.getVariable(a.ConnectionApiId).value=this._connectionApiId,f.setConnectedMetadata(this._connectionApiId)}return Object.defineProperty(e.prototype,"name",{get:function(){return this._tableMetadata.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConfigLoaded",{get:function(){return this._lazyConnectionConfig.isValueCreated},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataSourceName",{get:function(){return this._dataSourceName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._tableMetadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectionApiId",{get:function(){return this._connectionApiId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"entityType",{get:function(){return this._entityType},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"referencedblobProcessor",{get:function(){return this._referencedBlobProcessor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_isConnectionConfigValid",{get:function(){return this._lazyConnectionConfig.isValueCreated&&this._lazyConnectionConfig.value.isValid},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isStrongConsistencyRequired",{get:function(){return this._isStrongConsistencyRequired},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"queryStringBuilder",{get:function(){return this._queryStringBuilder},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_sharedConnectionId",{get:function(){return this._lazyConnectionConfig.isValueCreated?this._lazyConnectionConfig.value.sharedConnectionId:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tableRowTypeRef",{get:function(){return this._tableRowTypeRef||(this._tableRowTypeRef=new f.InlinedTTypeRef(this._service.typesManager.getType(m.ConnectedDataConstants.TypesManagerPrefix,"TableRowObject"))),this._tableRowTypeRef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectorType",{get:function(){return"CdpConnector"},enumerable:!1,configurable:!0}),e.mustSupportCdpCoreDefinitionAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return"cdpQueryDefinition"!==e.sourceType?[3,2]:(t={dataSourceName:e.dataSourceName,queryOptions:e.queryOptions,responseParams:e.responseParams,tableName:e.tableName},[4,e.queryParamsPromise]);case 1:return[2,(t.queryParams=r.sent(),t)];case 2:if("cdpNavigatedColumnArrayQueryDefinition"===e.sourceType)return[2,{dataSourceName:e.dataSourceName,queryOptions:e.queryOptions,tableName:e.tableName,responseParams:e.responseParams}];throw new Error("Fatal Error: unexpected query definition. sourceType: ".concat(e.sourceType))}}))}))},e._isFilterFalse=function(e){return!!e[m.ConnectedDataConstants.FilterParameterName]&&"false"===e[m.ConnectedDataConstants.FilterParameterName].value},e.prototype.loadAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this._lazyConnectionConfig.isValueCreated?[3,2]:[4,this._lazyConnectionConfig.valueAsync()];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype.getDatasetNameAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this._lazyConnectionConfig.valueAsync()];case 1:return[2,e.sent().datasetName]}}))}))},e.prototype.getConnectorTypeNameAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return[4,this._lazyConnectionConfig.valueAsync()];case 1:return[2,{tableName:(e=t.sent()).tableName,serverTableName:e.serverTableName}]}}))}))},e.prototype.getSchema=function(){return this._tableMetadata.getSchema()},e.prototype.getAttachmentsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var a,i,c,u,l,p,d;return __generator(this,(function(h){switch(h.label){case 0:if(Core.Log.verbose("CdpConnector[{0}]: getAttachmentsAsync()",this.dataSourceName),!(a=this.metadata.tryGetColumn(e)))throw Object(o.logError)("CdpConnector.getAttachmentsAsync","Cannot find column with name: ".concat(e," "),this._telemetryBaseData),new n.TabularDataError({message:AppMagic.Strings.ConnectedDataUnknownError,errorKind:n.ConnectedDataErrorKind.UnknownError});i="CdpConnector.getAttachmentsAsync",h.label=1;case 1:return h.trys.push([1,4,,5]),[4,this._ensureMetadataLoadedAsync(i)];case 2:return h.sent(),(c=HashTableUtility.create())[m.ConnectedDataConstants.ExpandedRecordKeyName]=new y(t),u=this._createErrorContext("getAttachments",i,r),Object(n.addParameters)(c,u),[4,this._service.functions[a.attachmentMetadata.listFunctionName].runAsync(c)];case 3:return l=h.sent(),p=Object(s.processAttachments)(l,this.dataSourceName,this._lazyConnectionConfig.value.serverTableName,this._lazyConnectionConfig.value.itemsBaseUrl.toString(),t,a),[2,Object(o.validateServerResult)(p)];case 4:throw d=h.sent(),Object(o.throwTabularErrorFromServerError)(i,d,AppMagic.Strings.ConnectedDataGetRowsPermissionDenied,this._telemetryBaseData);case 5:return[2]}}))}))},e.prototype.deleteAttachmentAsync=function(e,t,r,a){return __awaiter(this,void 0,Promise,(function(){var i,s,c,u,l,p;return __generator(this,(function(d){switch(d.label){case 0:if(Core.Log.verbose("CdpConnector[{0}]: deleteAttachmentAsync",this.dataSourceName),!(i=this._tableMetadata.tryGetColumn(t)))throw Object(o.logError)("CdpConnector.deleteAttachmentAsync","Cannot find column with name: ".concat(t," "),this._telemetryBaseData),new n.TabularDataError({message:AppMagic.Strings.ConnectedDataUnknownError,errorKind:n.ConnectedDataErrorKind.UnknownError});return s="CdpConnector.deleteAttachmentAsync",[4,this._ensureMetadataLoadedAsync(s)];case 1:d.sent(),c=HashTableUtility.create(),this._setPrimaryKeyParameters(e,c),m.DataEntityRecord.isDataEntityRecord(e)&&this._addETagParameterIfSpecified(c,m.ConnectedDataConstants.IfMatchParameterName,e),c[m.ConnectedDataConstants.AttachmentIdParameterName]=new y(r),u=this._createErrorContext("deleteAttachment",s,a),Object(n.addParameters)(c,u),l=this._service.functions[i.attachmentMetadata.deleteFunctionName],d.label=2;case 2:return d.trys.push([2,4,,5]),[4,l.runAsync(c)];case 3:return d.sent(),[3,5];case 4:throw p=d.sent(),Object(o.throwTabularErrorFromServerError)(s,p,AppMagic.Strings.ConnectedDataPatchRowPermissionDenied,this._telemetryBaseData);case 5:return[2]}}))}))},e.prototype.createAttachmentAsync=function(e,t,r,a,i){return __awaiter(this,void 0,Promise,(function(){var c,u,l,p,d,h,y,f,v,C,_,b,A;return __generator(this,(function(S){switch(S.label){case 0:return Core.Log.verbose("CdpConnector[{0}]: createAttachmentAsync()",this.dataSourceName),c=this._tableMetadata.tryGetColumn(r),[4,this._mediaResolver.getMediaAsBinaryAsync(t)];case 1:if(!(u=S.sent()))throw Object(o.logError)("CdpConnector.createAttachmentAsync","The media has no content.",this._telemetryBaseData),new n.TabularDataError({errorKind:n.ConnectedDataErrorKind.UnknownError,message:AppMagic.Strings.ConnectedDataUnknownError});l=this._tableMetadata.keyColumns.map((function(t){return e[t.name].toString()})).join(","),d="CdpConnector.createAttachmentAsync",S.label=2;case 2:return S.trys.push([2,6,,7]),[4,this._ensureMetadataLoadedAsync(d)];case 3:return S.sent(),(h=new Core.UrlBuilder(this._lazyConnectionConfig.value.itemsBaseUrl)).appendPath(Core.Url.encode(l)),h.appendPath(Core.Url.encode(c.targetEntity)),h.setQueryParam("displayName",a),y=this._createAndGetHeaders(),f=this._createErrorContext("createAttachment",d,i),Core.Diagnostics.addHeaders(y,f),this._addAdditionalHeaders(y),v={method:g.Method.POST,url:h.doneToString(),bodyData:u,headers:y},[4,this._service.authenticationProviders[m.ConnectedDataConstants.AuthProviderId].authenticator.authenticateRequestAsync(v)];case 4:return S.sent(),AppMagic.Services.appendCustomHeadersOptions(v,{addCustomHeaders:!0}),[4,this._appHttpClient.sendHttpJsonResponseAsync(v)];case 5:return p=S.sent(),[3,7];case 6:throw C=S.sent(),Object(o.throwTabularErrorFromServerError)(d,C,AppMagic.Strings.ConnectedDataCreateBlobPermissionDenied,this._telemetryBaseData);case 7:if(!(_=Object(n.AppMagicDataAttachments_safeCast)(p)))throw new n.TabularDataError({errorKind:n.ConnectedDataErrorKind.InvalidServerResponse,message:AppMagic.Strings.ConnectedDataInvalidResult});return b=this._lazyConnectionConfig.value.serverTableName,A=AppMagic.AppResourceUri.Templates.ConnectedDataSourceAttachmentType.expandUrl({datasourceName:this.dataSourceName,tableName:b}),[2,Object(s.processAttachment)(_,A,this.dataSourceName,b,l,this._lazyConnectionConfig.value.itemsBaseUrl.toString(),c)]}}))}))},e.prototype._applyParametersAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n;return __generator(this,(function(a){switch(a.label){case 0:return[4,this._queryStringBuilder.getStringParametersAsync(e,r)];case 1:return(n=a.sent())[v.QueryOption.Filter]&&(t[m.ConnectedDataConstants.FilterParameterName]=new y(n[v.QueryOption.Filter])),n[v.QueryOption.OrderBy]&&(t[m.ConnectedDataConstants.OrderByParameterName]=new y(n[v.QueryOption.OrderBy])),n[v.QueryOption.Apply]&&(t[m.ConnectedDataConstants.ApplyParameterName]=new y(n[v.QueryOption.Apply])),n[v.QueryOption.Count]&&(t[m.ConnectedDataConstants.CountParameterName]=new y("true"===n[v.QueryOption.Count])),[2]}}))}))},e.prototype.getResultCountAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,a,i,s,c;return __generator(this,(function(u){switch(u.label){case 0:Core.Log.verbose("CdpConnector[{0}]: getResultCountAsync()",this.dataSourceName),r="CdpConnector.getResultCountAsync",u.label=1;case 1:return u.trys.push([1,5,,6]),[4,this._ensureMetadataLoadedAsync(r,e.expands)];case 2:return u.sent(),a=HashTableUtility.create(),[4,this._applyParametersAsync(e,a)];case 3:return u.sent(),i=this._createErrorContext("getResultCount",r,t),Object(n.addParameters)(a,i),[4,this._callServiceFunctionPaginatedTableResultAsync(m.ConnectedDataConstants.GetRowsFuncName,a,0,e)];case 4:return null===(s=u.sent())?(Core.Log.verbose("CdpConnector[{0}]: getResultCountAsync - result is not valid.",this.dataSourceName),[2,null]):[2,Object(o.validateServerResult)(s.resultCount)];case 5:throw c=u.sent(),Object(o.throwTabularErrorFromServerError)(r,c,AppMagic.Strings.ConnectedDataGetRowsPermissionDenied,this._telemetryBaseData);case 6:return[2]}}))}))},e.prototype.getScalarResultAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,a,i,s;return __generator(this,(function(c){switch(c.label){case 0:Core.Log.verbose("CdpConnector[{0}]: getScalarResultAsync()",this.dataSourceName),r="CdpConnector.getScalarResultAsync",c.label=1;case 1:return c.trys.push([1,4,,5]),[4,this._ensureMetadataLoadedAsync(r,e.expands)];case 2:return c.sent(),n=this._createErrorContext("getScalarResult",r,t),a=Core.Diagnostics.createHeaders(n),this._addAdditionalHeaders(a),[4,this._getFunctions.getScalarResultAsync(e,this.queryStringBuilder,a)];case 3:return i=c.sent(),[2,Object(o.validateServerResult)(i)];case 4:throw s=c.sent(),Object(o.throwTabularErrorFromServerError)(r,s,AppMagic.Strings.ConnectedDataGetRowsPermissionDenied,this._telemetryBaseData);case 5:return[2]}}))}))},e.prototype.getRowsAsync=function(t,r){var n;return void 0===r&&(r={}),__awaiter(this,void 0,Promise,(function(){var a,i,s,c,u,l,p,d,h,m,y=this;return __generator(this,(function(f){switch(f.label){case 0:return Core.Log.verbose("CdpConnector[{0}]: getRowsAsync({1})",this.dataSourceName,r.maxRowCount),t.queryOptions&&t.queryOptions.skipCall?[2,Object(o.createEmptyGetRowsResult)()]:(a=this.metadata.parameterPkColumnInfo,[4,t.queryParamsPromise]);case 1:i=f.sent(),a&&""!==a.pkColumnName&&(i[v.QueryOption.PkColumn]=a.pkColumnName,i[v.QueryOption.PkIsAutoGenerated]=String(a.isAutoGenerated)),r=__assign(__assign({},{maxRowCount:1/0,skip:0}),r),t.queryOptions&&(s=t.queryOptions.expands),c="CdpConnector.getRowsAsync",f.label=2;case 2:return f.trys.push([2,7,,8]),[4,this._ensureMetadataLoadedAsync(c,s)];case 3:return f.sent(),[4,e.mustSupportCdpCoreDefinitionAsync(t)];case 4:return u=f.sent(),l=this._createErrorContext("getRows",c,r.errorContext),[4,this._getRowsCoreAsync(u,r.maxRowCount,r.skip,l)];case 5:return p=f.sent(),this._showGetRowsCountToMonitor(r.maxRowCount,null!==(n=null==p?void 0:p.items.length)&&void 0!==n?n:0,r.errorContext),d=function(e,t){return __awaiter(y,void 0,Promise,(function(){var n;return __generator(this,(function(a){return n=this._createErrorContext("getMoreRows",c,r.errorContext),[2,this._getMoreRowsAsync(e,u,t,n)]}))}))},[4,Object(o.getRemainingRowsIfNeededAsync)(p,r.maxRowCount,this.dataSourceName,d,this._telemetryBaseData)];case 6:return h=f.sent(),[2,Object(o.validateServerResult)(h)];case 7:throw m=f.sent(),Object(o.throwTabularErrorFromServerError)(c,m,AppMagic.Strings.ConnectedDataGetRowsPermissionDenied,this._telemetryBaseData);case 8:return[2]}}))}))},e.prototype._getRowsCoreAsync=function(e,t,r,n){var a;return void 0===t&&(t=1/0),void 0===r&&(r=0),__awaiter(this,void 0,Promise,(function(){var o;return __generator(this,(function(i){return delete(o=e.queryParams)[v.QueryOption.Skip],(null===(a=e.queryOptions)||void 0===a?void 0:a.top)||delete o[v.QueryOption.Top],"number"==typeof r&&r>0&&r<1/0&&(o[v.QueryOption.Skip]=r.toString()),!o[v.QueryOption.Top]&&"number"==typeof t&&t>0&&t<1/0&&(this._tableMetadata.capabilities.serverPagingOptions.indexOf("top")>=0||this._tableMetadata.isClientPagable)&&(o[v.QueryOption.Top]=t.toString()),[2,this._callCdpGetRowsFunctionAsync({queryParams:o,responseParams:e.responseParams},r,e.queryOptions,n)]}))}))},e.prototype._callCdpGetRowsFunctionAsync=function(e,t,r,a){return __awaiter(this,void 0,Promise,(function(){var o,i;return __generator(this,(function(s){switch(s.label){case 0:return Object(n.doesFilterEvaluateToFalse)(r)?[2,Object(c.createEmpty)()]:(o=Core.Diagnostics.createHeaders(a),this._addAdditionalHeaders(o),[4,this._getFunctions.getRowsAsync(e,o)]);case 1:return i=s.sent(),[2,this._processGetRowsResult(i,t,r)]}}))}))},e.prototype._processGetRowsResult=function(e,t,r){var n=Object(c.safeCast)(e);return null===n?null:(Object(o.ensureKeyIfReadOnlyTable)(n.items,t,this._tableMetadata),n.items=Object(s.processTable)(n.items,this._tableMetadata.name,this._cdcManager,this._mediaResolver,r),n)},e.prototype.getMoreRowsAsync=function(t,r,n,a){return void 0===n&&(n=1/0),__awaiter(this,void 0,Promise,(function(){var i,s,c,u,l,p=this;return __generator(this,(function(d){switch(d.label){case 0:if(Core.Log.verbose("CdpConnector[{0}]: getMoreRowsAsync({1})",this.dataSourceName,n),Object(o.hadEnoughLeftovers)(t,n))return[2,Object(o.returnLeftovers)(t,n)];if(!r)return[3,6];i="CdpConnector.getMoreRowsAsync",d.label=1;case 1:return d.trys.push([1,5,,6]),[4,this._ensureMetadataLoadedAsync(i)];case 2:return d.sent(),[4,e.mustSupportCdpCoreDefinitionAsync(r)];case 3:return s=d.sent(),c=function(e,t){return __awaiter(p,void 0,Promise,(function(){var r;return __generator(this,(function(n){return r=this._createErrorContext("getMoreRows",i,a),[2,this._getMoreRowsAsync(e,s,t,r)]}))}))},[4,Object(o.followGetRowsNextLinksAsync)(t.leftovers||[],t.nextLink,n,this.dataSourceName,c,this._telemetryBaseData)];case 4:return u=d.sent(),[2,Object(o.validateServerResult)(u)];case 5:throw l=d.sent(),Object(o.throwTabularErrorFromServerError)(i,l,AppMagic.Strings.ConnectedDataGetRowsPermissionDenied,this._telemetryBaseData);case 6:return[2]}}))}))},e.prototype._getMoreRowsAsync=function(e,t,r,a){return __awaiter(this,void 0,Promise,(function(){var o,i,s;return __generator(this,(function(c){switch(c.label){case 0:return t?(o=Core.Diagnostics.createHeaders(a),this._addAdditionalHeaders(o),[4,this._getFunctions.getMoreRowsAsync(e,t.responseParams,o)]):[3,2];case 1:return i=c.sent(),this._showGetMoreRowsCountToMonitor(i,a),[2,this._processGetRowsResult(i,r,t.queryOptions)];case 2:return(s=HashTableUtility.create())[m.ConnectedDataConstants.GetNextRowsNextLinkParameterName]=new y(e),Object(n.addParameters)(s,a),[4,this._callServiceFunctionPaginatedTableResultAsync(m.ConnectedDataConstants.GetNextRowsFuncName,s,r)];case 3:return[2,c.sent()]}}))}))},e.prototype.getRowAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,a,i,s,c;return __generator(this,(function(u){switch(u.label){case 0:Core.Log.verbose("CdpConnector[{0}]: getRowAsync",this.dataSourceName),r="CdpConnector.getRowAsync",u.label=1;case 1:return u.trys.push([1,4,,5]),[4,this._ensureMetadataLoadedAsync(r)];case 2:return u.sent(),a=HashTableUtility.create(),this._setPrimaryKeyParameters(e,a),i=this._createErrorContext("getRow",r,t),Object(n.addParameters)(a,i),[4,this._callServiceFunctionRowResultAsync(m.ConnectedDataConstants.GetRowFuncName,a)];case 3:return s=u.sent(),[2,Object(o.validateServerResult)(s)];case 4:throw c=u.sent(),Object(o.throwTabularErrorFromServerError)(r,c,AppMagic.Strings.ConnectedDataGetRowPermissionDenied,this._telemetryBaseData);case 5:return[2]}}))}))},e.prototype.createRowAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,a,i,s,c,u,l,p,d,h,f;return __generator(this,(function(v){switch(v.label){case 0:Core.Log.verbose("CdpConnector[{0}]: createRowAsync",this.dataSourceName),r="CdpConnector.createRowAsync",v.label=1;case 1:return v.trys.push([1,5,,6]),[4,this._ensureMetadataLoadedAsync(r)];case 2:return v.sent(),[4,this._prepareBlobColumnsAsync(e)];case 3:for(a=v.sent(),i=HashTableUtility.create(),this._isStrongConsistencyRequired&&(i[m.ConnectedDataConstants.ConsistencyParameterName]=new y(g.HeaderValue.ConsistencyStrong)),(s=this.metadata.parameterPkColumnInfo)&&""!==s.pkColumnName&&(i[m.ConnectedDataConstants.PkColumnParameterName]=new y(s.pkColumnName),i[m.ConnectedDataConstants.PkIsAutoGeneratedColumnParameterName]=new y(String(s.isAutoGenerated))),c=this._tableMetadata.columns,u=0,l=c.length;u<l;++u)void 0!==(p=Object(o.addColumnParameter)(c[u],e,a,AppMagic.Services.CdpUtility.formatNavigationBindPropertyName))&&(i[c[u].name]=new y(p));return d=this._createErrorContext("createRow",r,t),Object(n.addParameters)(i,d),[4,this._callServiceFunctionRowResultAsync(m.ConnectedDataConstants.CreateRowFuncName,i)];case 4:return h=v.sent(),[2,Object(o.validateServerResult)(h)];case 5:throw f=v.sent(),Object(o.throwTabularErrorFromServerError)(r,f,AppMagic.Strings.ConnectedDataCreateRowPermissionDenied,this._telemetryBaseData);case 6:return[2]}}))}))},e.prototype.replaceRowAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var a,i,s,c,u,l,p,d,h,f;return __generator(this,(function(v){switch(v.label){case 0:Core.Log.verbose("CdpConnector[{0}]: replaceRowAsync",this.dataSourceName),a="CdpConnector.replaceRowAsync",v.label=1;case 1:return v.trys.push([1,5,,6]),[4,this._ensureMetadataLoadedAsync(a)];case 2:return v.sent(),[4,this._prepareBlobColumnsAsync(t)];case 3:for(i=v.sent(),s=HashTableUtility.create(),this._setPrimaryKeyParameters(e,s,m.ConnectedDataConstants.PreviousKeyNameSuffix),m.DataEntityRecord.isDataEntityRecord(e)&&this._addETagParameterIfSpecified(s,m.ConnectedDataConstants.IfMatchParameterName,e),this._isStrongConsistencyRequired&&(s[m.ConnectedDataConstants.ConsistencyParameterName]=new y(AppMagic.Services.HttpConstants.HeaderValue.ConsistencyStrong)),c=this._tableMetadata.columns,u=0,l=c.length;u<l;++u)void 0!==(p=Object(o.addColumnParameter)(c[u],t,i,AppMagic.Services.CdpUtility.formatNavigationBindPropertyName))&&(s[c[u].name]=new y(p));return d=this._createErrorContext("replaceRow",a,r),Object(n.addParameters)(s,d),[4,this._callServiceFunctionRowResultAsync(m.ConnectedDataConstants.ReplaceRowFuncName,s)];case 4:return h=v.sent(),[2,Object(o.validateServerResult)(h)];case 5:throw f=v.sent(),Object(o.throwTabularErrorFromServerError)(a,f,AppMagic.Strings.ConnectedDataPatchRowPermissionDenied,this._telemetryBaseData);case 6:return[2]}}))}))},e.prototype.relateAsync=function(e,t,r,n){return __awaiter(this,void 0,Promise,(function(){var a,i,s,c,u,l,h;return __generator(this,(function(y){switch(y.label){case 0:Core.Log.verbose("CdpConnector[{0}]: relateAsync",this.dataSourceName),a="CdpConnector.relateAsync",y.label=1;case 1:return y.trys.push([1,5,,6]),[4,this._ensureMetadataLoadedAsync(a)];case 2:return y.sent(),i=_.expandUrl({baseUrl:this._lazyConnectionConfig.value.itemsBaseUrl.toString(),tableId:e,relationship:t}),s=this._createAndGetHeaders(g.MediaType.ApplicationJson),c=this._createErrorContext("relate",a,n),Core.Diagnostics.addHeaders(s,c),this._addAdditionalHeaders(s),(u=HashTableUtility.create())[p]=r,l={method:d.PATCH,url:i.toString(),bodyData:JSON.stringify(u),headers:s},[4,this._service.authenticationProviders[m.ConnectedDataConstants.AuthProviderId].authenticator.authenticateRequestAsync(l)];case 3:return y.sent(),C.appendCustomHeadersOptions(l,{addCustomHeaders:!0}),[4,this._appHttpClient.sendHttpIgnoreResponseAsync(l)];case 4:return y.sent(),[2,!0];case 5:throw h=y.sent(),Object(o.throwTabularErrorFromServerError)(a,h,AppMagic.Strings.ConnectedDataRelateUnrelatePermissionDenied,this._telemetryBaseData);case 6:return[2]}}))}))},e.prototype.unrelateAsync=function(e,t,r,n){return __awaiter(this,void 0,Promise,(function(){var a,i,s,c,u,l;return __generator(this,(function(p){switch(p.label){case 0:Core.Log.verbose("CdpConnector[{0}]: unrelateAsync",this.dataSourceName),a="CdpConnector.unrelateAsync",p.label=1;case 1:return p.trys.push([1,5,,6]),[4,this._ensureMetadataLoadedAsync(a)];case 2:return p.sent(),i=b.expandUrl({baseUrl:this._lazyConnectionConfig.value.itemsBaseUrl.toString(),tableId:e,relationship:t,relatedId:r}),s=this._createAndGetHeaders(),c=this._createErrorContext("unrelate",a,n),Core.Diagnostics.addHeaders(s,c),this._addAdditionalHeaders(s),u={method:d.DELETE,url:i.toString(),headers:s},[4,this._service.authenticationProviders[m.ConnectedDataConstants.AuthProviderId].authenticator.authenticateRequestAsync(u)];case 3:return p.sent(),C.appendCustomHeadersOptions(u,{addCustomHeaders:!0}),[4,this._appHttpClient.sendHttpIgnoreResponseAsync(u)];case 4:return p.sent(),[2,!0];case 5:throw l=p.sent(),Object(o.throwTabularErrorFromServerError)(a,l,AppMagic.Strings.ConnectedDataRelateUnrelatePermissionDenied,this._telemetryBaseData);case 6:return[2]}}))}))},e.prototype._createAndGetHeaders=function(e){var t=HashTableUtility.create();return t[h.Accept]=C.HttpConstants.MediaType.ApplicationJson,t[h.PowerAppsConnectorProtocolSemantics]=C.HttpConstants.HeaderValue.PowerAppsConnectorProtocolSemanticsValue,e&&(t[h.ContentType]=e),t},e.prototype._addAdditionalHeaders=function(e){e||(e=HashTableUtility.create()),this._sharedConnectionId&&(e[h.SharedConnectionId]=this._sharedConnectionId)},e.prototype.patchRowAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,a,i;return __generator(this,(function(s){switch(s.label){case 0:Core.Log.verbose("CdpConnector[{0}]: patchRowAsync",this.dataSourceName),n="CdpConnector.patchRowAsync",s.label=1;case 1:return s.trys.push([1,5,,8]),[4,this._ensureMetadataLoadedAsync(n)];case 2:return s.sent(),[4,this._prepareBlobColumnsAsync(t)];case 3:return a=s.sent(),[4,this._updateRow(e,a,t,n,r)];case 4:return[2,s.sent()];case 5:return i=s.sent(),this._isServerConflict(i)&&Core.FeatureGates.services.enablePatchRetryOnServerConflict?[4,this._handleServerConflictErrorAsync(i,t,a,e,n,r)]:[3,7];case 6:return[2,s.sent()];case 7:throw Object(o.throwTabularErrorFromServerError)(n,i,AppMagic.Strings.ConnectedDataPatchRowPermissionDenied,this._telemetryBaseData);case 8:return[2]}}))}))},e.prototype._updateRow=function(e,t,r,a,i){return __awaiter(this,void 0,Promise,(function(){var s,c,u,l,p,d,h,f;return __generator(this,(function(v){switch(v.label){case 0:for(s=HashTableUtility.create(),this._setPrimaryKeyParameters(e,s,m.ConnectedDataConstants.PreviousKeyNameSuffix),m.DataEntityRecord.isDataEntityRecord(e)&&this._addETagParameterIfSpecified(s,m.ConnectedDataConstants.IfMatchParameterName,e),this._isStrongConsistencyRequired&&(s[m.ConnectedDataConstants.ConsistencyParameterName]=new y(g.HeaderValue.ConsistencyStrong)),(c=this.metadata.parameterPkColumnInfo)&&""!==c.pkColumnName&&(s[m.ConnectedDataConstants.PkColumnParameterName]=new y(c.pkColumnName),s[m.ConnectedDataConstants.PkIsAutoGeneratedColumnParameterName]=new y(String(c.isAutoGenerated))),u=this._tableMetadata.columns,l=0,p=u.length;l<p;++l)void 0!==(d=Object(o.addPatchColumnParameter)(u[l],r,t,AppMagic.Services.CdpUtility.formatNavigationBindPropertyName))&&(s[u[l].name]=new y(d));return h=this._createErrorContext("patchRow",a,i),Object(n.addParameters)(s,h),[4,this._callServiceFunctionRowResultAsync(m.ConnectedDataConstants.PatchRowFuncName,s)];case 1:return f=v.sent(),[2,Object(o.validateServerResult)(f)]}}))}))},e.prototype._isServerConflict=function(e){return e&&C.errorHasHttpResponse(e)&&e.response.status===g.HttpStatusCode.PreconditionFailed},e.prototype._handleServerConflictErrorAsync=function(e,t,r,n,a,i){return __awaiter(this,void 0,Promise,(function(){var s,c;return __generator(this,(function(u){switch(u.label){case 0:return u.trys.push([0,5,,6]),[4,this._getLatestRow(n)];case 1:if(s=u.sent(),this._isPatchConflictRetryable(t,r,n,s))return[3,2];throw Object(o.throwTabularErrorFromServerError)(a,e,AppMagic.Strings.ConnectedDataPatchRowPermissionDenied,this._telemetryBaseData);case 2:return[4,this._updateRow(s,r,t,a,i)];case 3:return[2,u.sent()];case 4:return[3,6];case 5:throw c=u.sent(),Object(o.throwTabularErrorFromServerError)(a,c,AppMagic.Strings.ConnectedDataPatchRowPermissionDenied,this._telemetryBaseData);case 6:return[2]}}))}))},e.prototype._getLatestRow=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return t=HashTableUtility.create(),this._setPrimaryKeyParameters(e,t),[4,this._callServiceFunctionRowResultAsync(m.ConnectedDataConstants.GetRowFuncName,t)];case 1:return[2,r.sent()]}}))}))},e.prototype._isPatchConflictRetryable=function(e,t,r,n){for(var a=this._tableMetadata.columns,i=0,s=a.length;i<s;++i){if(void 0!==Object(o.addPatchColumnParameter)(a[i],e,t,AppMagic.Services.CdpUtility.formatNavigationBindPropertyName)){var c=Object(o.getDataValue)(a[i],n,t,AppMagic.Services.CdpUtility.formatNavigationBindPropertyName);if(Object(o.getDataValue)(a[i],r,t,AppMagic.Services.CdpUtility.formatNavigationBindPropertyName)!==c)return!1}}return!0},e.prototype.deleteRowAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,a,i,s,c,u,l;return __generator(this,(function(p){switch(p.label){case 0:Core.Log.verbose("CdpConnector[{0}]: deleteRowAsync",this.dataSourceName),r="CdpConnector.deleteRowAsync",p.label=1;case 1:return p.trys.push([1,4,,5]),[4,this._ensureMetadataLoadedAsync(r)];case 2:return p.sent(),a=HashTableUtility.create(),this._setPrimaryKeyParameters(e,a),m.DataEntityRecord.isDataEntityRecord(e)&&this._addETagParameterIfSpecified(a,m.ConnectedDataConstants.IfMatchParameterName,e),(i=this.metadata.parameterPkColumnInfo)&&""!==i.pkColumnName&&(a[m.ConnectedDataConstants.PkColumnParameterName]=new y(i.pkColumnName),a[m.ConnectedDataConstants.PkIsAutoGeneratedColumnParameterName]=new y(String(i.isAutoGenerated))),s=this._createErrorContext("deleteRow",r,t),Object(n.addParameters)(a,s),c=this._service.functions[m.ConnectedDataConstants.DeleteRowFuncName],u=Core.PromiseUtils.createAbortController(null==t?void 0:t.abortSignal),[4,c.runAsync(a,void 0,u)];case 3:return p.sent(),[3,5];case 4:throw l=p.sent(),Object(o.throwTabularErrorFromServerError)(r,l,AppMagic.Strings.ConnectedDataDeleteRowPermissionDenied,this._telemetryBaseData);case 5:return[2]}}))}))},e.prototype.getLookupResultsAsync=function(e,t,r,a,i){return void 0===r&&(r=1/0),__awaiter(this,void 0,Promise,(function(){var s,u,l,p,d,h,f,v,g,C,_,b,A=this;return __generator(this,(function(S){switch(S.label){case 0:Core.Log.verbose("CdpConnector[{0}]: getLookupResultsAsync('{1}', {2})",this.dataSourceName,e,t?"'"+t+"'":"null"),s="CdpConnector.getLookupResultAsync",S.label=1;case 1:return S.trys.push([1,7,,8]),[4,this._ensureMetadataLoadedAsync(s)];case 2:return S.sent(),u=HashTableUtility.create(),r!==1/0&&(u[m.ConnectedDataConstants.TopParameterName]=new y(r)),t&&(u[m.ConnectedDataConstants.SearchTextParameterName]=new y(t)),l=this._createErrorContext("getLookupResults",s,a),Object(n.addParameters)(u,l),p=this._service.functions[e],d=void 0,!Core.FallbackSwitch.isActivated("AppConnectivity.SpoChoicesLookup")&&this._lazyConnectionConfig.value.isOverrideTableName&&Core.Utility.equalsIgnoreCase(this._connectionApiId,AppMagic.ConnectionHub.Constants.ApiIds.SharepointOnline)?(h=c.safeCast,[4,p.runAsync(u,void 0,i,this._lazyConnectionConfig.value.tableName,this._lazyConnectionConfig.value.serverTableName)]):[3,4];case 3:return d=h.apply(void 0,[S.sent()]),[3,6];case 4:return f=c.safeCast,[4,p.runAsync(u)];case 5:d=f.apply(void 0,[S.sent()]),S.label=6;case 6:return null===d?(Core.Log.verbose("CdpConnector[{0}]: getLookupResultsAsync - first page is not valid.",this.dataSourceName),[2,Promise.resolve(null)]):(v=d.items,d.nextLink&&v.length<r?(g=function(e,t){return __awaiter(A,void 0,Promise,(function(){var r;return __generator(this,(function(n){switch(n.label){case 0:return r=this._createErrorContext("getMoreRows",s,a),[4,this._getMoreRowsAsync(e,null,t,r)];case 1:return[2,n.sent()]}}))}))},[2,Object(o.followGetRowsNextLinksAsync)(v,d.nextLink,r,this.dataSourceName,g,this._telemetryBaseData)]):(C=void 0,v.length>r&&(C=v.splice(r,v.length-r)),Core.Log.verbose("CdpConnector[{0}]: getLookupResultsAsync returned {1} out of {2} requested rows.",this.dataSourceName,v.length,r),_={results:v,nextLink:d.nextLink,leftovers:C},[2,Object(o.validateServerResult)(_)]));case 7:throw b=S.sent(),Object(o.throwTabularErrorFromServerError)(s,b,AppMagic.Strings.ConnectedDataGetLookupResultsPermissionDenied,this._telemetryBaseData);case 8:return[2]}}))}))},e.prototype.downloadInlineBlobAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,a,i,s;return __generator(this,(function(c){switch(c.label){case 0:r="CdpConnector.downloadInlineBlobAsync",c.label=1;case 1:return c.trys.push([1,4,,5]),[4,this._ensureMetadataLoadedAsync(r)];case 2:return c.sent(),a=HashTableUtility.create(),this._tableMetadata.keyColumns.forEach((function(t){a[t.name]=new y(e[t.name])})),a[m.ConnectedDataConstants.ColumnNameParameterName]=new y(t),i=this._createErrorContext("downloadInlineBlob",r),Object(n.addParameters)(a,i),[4,this._getInlineBlobFromJsonAsync(t,a)];case 3:return[2,c.sent()];case 4:throw s=c.sent(),Object(o.throwTabularErrorFromServerError)(r,s,AppMagic.Strings.ConnectedDataGetRowPermissionDenied,this._telemetryBaseData);case 5:return[2]}}))}))},e.prototype.downloadReferencedBlobAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var t,r,a,i;return __generator(this,(function(s){switch(s.label){case 0:t="CdpConnector.downloadReferencedBlobAsync",s.label=1;case 1:return s.trys.push([1,4,,5]),[4,this._ensureMetadataLoadedAsync(t)];case 2:return s.sent(),(r=HashTableUtility.create())[m.ConnectedDataConstants.MediaBaseUrlParameterName]=new y(e.toString()),a=this._createErrorContext("downloadReferencedBlob",t),Object(n.addParameters)(r,a),[4,this._callServiceFunctionBlobResultAsync(m.ConnectedDataConstants.GetReferencedBlobFuncName,r)];case 3:return[2,s.sent()];case 4:throw i=s.sent(),Object(o.throwTabularErrorFromServerError)(t,i,AppMagic.Strings.ConnectedDataGetBlobPermissionDenied,this._telemetryBaseData);case 5:return[2]}}))}))},e.prototype._getInlineBlobFromJsonAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,a;return __generator(this,(function(i){switch(i.label){case 0:return Core.Log.verbose("CdpConnector[{0}]: _getInlineBlobFromJsonAsync",this.dataSourceName),[4,this._service.functions[m.ConnectedDataConstants.GetInlineBlobsFromJsonFuncName].runAsync(t)];case 1:if(!(r=i.sent()))throw new n.TabularDataError({message:AppMagic.Strings.ConnectedDataInvalidResult,errorKind:n.ConnectedDataErrorKind.InvalidResult});return a=r[e],Core.Utility.isNullOrUndefined(a)?[2,null]:Core.Utility.isNonEmptyString(a)?[2,a]:(Object(o.logWarning)("CdpConnector._getInlineBlobFromJsonAsync","Value for inline blob column '".concat(e,"' is invalid.value is ").concat(Core.Log.getPiiValueInfo(a)," "),this._telemetryBaseData),[2,null])}}))}))},e.prototype._ensureMetadataLoadedAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,a=this;return __generator(this,(function(i){switch(i.label){case 0:if(this._isDisposed)throw new n.TabularDataError({errorKind:n.ConnectedDataErrorKind.ComponentDisposed,message:Core.Utility.formatString(AppMagic.Strings.ConnectedDataConnectorDisposed_Name,this.dataSourceName)});return[4,this.loadAsync()];case 1:if(i.sent(),!this._lazyConnectionConfig.value.isValid)throw new n.TabularDataError({message:AppMagic.Strings.ConnectedDataNotDisambiguated,errorKind:n.ConnectedDataErrorKind.NotDisambiguated});return t&&t.length>0?[4,this._ensureAllMetadataForExpandsLoadedAsync(e,t)]:[3,3];case 2:i.sent(),i.label=3;case 3:return this._ensureMetadataLoadedPromise||(r=function(){return __awaiter(a,void 0,Promise,(function(){var r,n;return __generator(this,(function(a){switch(a.label){case 0:a.label=1;case 1:return a.trys.push([1,4,,5]),this._tableMetadata.containsReferencedBlobs()?[4,this._getMetadataAsync(this._lazyConnectionConfig.value.connectionBaseUrl)]:[3,3];case 2:r=a.sent(),this._parseMetadata(r),a.label=3;case 3:return[3,5];case 4:return n=a.sent(),Core.PromiseUtils.throwIfCanceled(n),Object(o.logError)("CdpConnector._ensureMetadataLoadedPromise","Error occurred loading metadata.operationName: ".concat(e," "),this._telemetryBaseData,n,{operationName:e,expandProperties:t?t.map((function(e){return e.propertyName})).join(","):"<none>"}),[3,5];case 5:return[2]}}))}))},this._ensureMetadataLoadedPromise=r()),[4,Core.PromiseUtils.preventCancel(this._ensureMetadataLoadedPromise)];case 4:return[2,i.sent()]}}))}))},e.prototype._ensureAllMetadataForExpandsLoadedAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n=this;return __generator(this,(function(a){switch(a.label){case 0:return r=t.map((function(t){return __awaiter(n,void 0,void 0,(function(){var r,n;return __generator(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),r=this.metadata.tryGetColumn(t.propertyName),Contracts.checkObject(r,"Expected column to exist in metadata for expand property'"),Contracts.check(r.isNavigation,"Expanded property should be a navigation column in metadata."),[4,this._cdcManager.getAsync(r.targetTableName)];case 1:return[4,a.sent()._ensureMetadataLoadedAsync(e,t.expands)];case 2:return a.sent(),[3,4];case 3:return n=a.sent(),Object(o.logError)("CdpConnector._ensureAllMetadataForExpandsLoadedAsync","Could not parse metadata for expanded property '".concat(t.propertyName,"'. Skipping loading metadata for this column."),this._telemetryBaseData,n,{parentOperationName:e,expandPropertyName:t.propertyName}),[3,4];case 4:return[2]}}))}))})),[4,Core.PromiseUtils.join(r)];case 1:return a.sent(),[2]}}))}))},e.prototype._getMetadataAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,n,a,o,i,s;return __generator(this,(function(c){switch(c.label){case 0:return Core.Log.verbose("CdpConnector[{0}]: _getMetadataAsync.",this.dataSourceName),t=new Core.UrlBuilder(e),this._cdpTabularRevisionBaseUrl&&t.appendUrl(this._cdpTabularRevisionBaseUrl),t.appendPath(l.TableMetadata.expand({datasetName:Core.Url.encode(this._lazyConnectionConfig.value.datasetName),tableName:Core.Url.encode(this._lazyConnectionConfig.value.tableName)})),(r=new AppMagic.Services.BodilessHttpRequestBuilder).setMethod(g.Method.GET),r.setBaseUrl(t.doneToUrl()),r.addHeader(g.HeaderName.PowerAppsConnectorProtocolSemantics,g.HeaderValue.PowerAppsConnectorProtocolSemanticsValue),(n=this._service.authenticationProviders[m.ConnectedDataConstants.AuthProviderId])?[4,n.authenticateRequestAsync(r)]:[3,2];case 1:c.sent(),c.label=2;case 2:return a=r.generateSendHttpRequestParameters(),C.appendCustomHeadersOptions(a,{addCustomHeaders:!0}),"CdpConnector._getMetadataAsync",o=this._createErrorContext("getMetadata","CdpConnector._getMetadataAsync"),Core.Diagnostics.addHeaders(a.headers,o),[4,AppMagic.Services.PowerAppsHttpTelemetry.sendHttpJsonResponseAsync(this._appHttpClient,a,"CdpConnector._getMetadataAsync",{apiId:this._connectionApiId})];case 3:if(i=c.sent(),!(s=m.ConnectedDataDescription.safeCast(i))||s.name!==this._tableMetadata.name)throw new Error("Missing or invalid table metadata returned from service.");return Core.Log.verbose("CdpConnector[{0}]: _getMetadataAsync success.",this.dataSourceName),[2,s]}}))}))},e.prototype._setPrimaryKeyParameters=function(e,t,r){this._tableMetadata.keyColumns.forEach((function(n){var a=e[n.name],o=r?n.name+r:n.name;t[o]=new y(a)}))},e.prototype._addETagParameterIfSpecified=function(e,t,r){var n=m.DataEntityRecord.tryGetETag(r);n&&(e[t]=new y(n))},e.prototype._parseMetadata=function(e){this._referencedBlobProcessor.parseMetadata(e)},e.prototype._prepareBlobColumnsAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,n,a,o,i;return __generator(this,(function(s){if(!(t=this._referencedBlobProcessor.hasReferencedBlobs)&&0===this._tableMetadata.inlineBlobColumns.length)return[2,null];for(Core.Log.verbose("CdpConnector[{0}]: _prepareBlobColumnsAsync",this.dataSourceName),r=m.DataRecord.create(),n=0,a=this._tableMetadata.inlineBlobColumns.length;n<a;++n)o=this._tableMetadata.inlineBlobColumns[n].name,(i=e[o])&&(r[o]=i);return t?[2,this._referencedBlobProcessor.uploadReferencedBlobsAsync(e,r)]:[2,r]}))}))},e.prototype.tryGetExistingBlobReference=function(e){if(!AppMagic.AppResourceUri.isValidForDataSource(e,this.dataSourceName))return null;if(e.getSegment(AppMagic.AppResourceUri.SegmentIndexes.ConnectedDataSourceResourceType)!==AppMagic.AppResourceUri.ConnectedDataSourceResourceType.ReferencedBlob)return null;var t=e.getSegment(AppMagic.AppResourceUri.SegmentIndexes.ConnectedDataSourceReferenceBlobUrl);return Core.Utility.isAbsoluteUrlString(t)?t:null},e.prototype._callServiceFunctionPaginatedTableResultAsync=function(t,r,n,a){return __awaiter(this,void 0,Promise,(function(){var o;return __generator(this,(function(i){switch(i.label){case 0:return e._isFilterFalse(r)?[2,Object(c.createEmpty)()]:[4,this._service.functions[t].runAsync(r)];case 1:return o=i.sent(),[2,this._processGetRowsResult(o,n,a)]}}))}))},e.prototype._callServiceFunctionRowResultAsync=function(t,r,n){return __awaiter(this,void 0,Promise,(function(){var a;return __generator(this,(function(o){switch(o.label){case 0:return e._isFilterFalse(r)?[2,HashTableUtility.create()]:[4,this._service.functions[t].runAsync(r)];case 1:return a=o.sent(),[2,Object(s.processRow)(a,this,this._cdcManager,this._mediaResolver,n)]}}))}))},e.prototype._callServiceFunctionBlobResultAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){switch(r.label){case 0:return[4,this._service.functions[e].runAsync(t)];case 1:return[2,r.sent()]}}))}))},e.prototype.uploadReferencedBlobAsync=function(e,t,r,a,o){return __awaiter(this,void 0,Promise,(function(){var i,s,c;return __generator(this,(function(u){i=this._blobManager.addBinary(a);try{return(s=HashTableUtility.create())[m.ConnectedDataConstants.MediaBaseUrlParameterName]=new y(e.toString()),s[m.ConnectedDataConstants.MediaFolderPathParameterName]=new y(t),s[m.ConnectedDataConstants.MediaFileNameParameterName]=new y(r),s[m.ConnectedDataConstants.MediaContentParameterName]=new y(i),c=this._createErrorContext("uploadReferencedBlob","CdpConnector.uploadReferencedBlobAsync",o),Object(n.addParameters)(s,c),[2,this._callCreateReferencedBlobAsync(s)]}finally{this._blobManager.release(i)}return[2]}))}))},e.prototype._callCreateReferencedBlobAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,n,a;return __generator(this,(function(i){switch(i.label){case 0:t=this._service.functions[m.ConnectedDataConstants.CreateReferencedBlobFuncName],i.label=1;case 1:return i.trys.push([1,3,,4]),[4,t.runAsync(e)];case 2:return r=i.sent(),null===(n=m.CdpServiceTypes.BlobEntity.safeCast(r))&&Core.Log.warning("CdpConnector.callCreateReferencedBlobAsync","response is not valid CDP BlobEntity."),[2,Object(o.validateServerResult)(n)];case 3:throw a=i.sent(),Object(o.throwTabularErrorFromServerError)("CdpConnector.callCreateReferencedBlobAsync",a,AppMagic.Strings.ConnectedDataCreateBlobPermissionDenied,this._telemetryBaseData);case 4:return[2]}}))}))},e.prototype.callDeleteReferencedBlobAsync=function(e,t,r,a){return __awaiter(this,void 0,Promise,(function(){var i,s,c,u,l;return __generator(this,(function(p){switch(p.label){case 0:(i=HashTableUtility.create())[m.ConnectedDataConstants.MediaBaseUrlParameterName]=new y(e.toString()),i[m.ConnectedDataConstants.MediaFolderPathParameterName]=new y(t),i[m.ConnectedDataConstants.MediaFileNameParameterName]=new y(r),s="CdpConnector.callDeleteReferencedBlobAsync",c=this._createErrorContext("callDeleteReferencedBlob",s,a),Object(n.addParameters)(i,c),u=this._service.functions[m.ConnectedDataConstants.DeleteReferencedBlobFuncName],p.label=1;case 1:return p.trys.push([1,3,,4]),[4,u.runAsync(i)];case 2:return p.sent(),[3,4];case 3:throw l=p.sent(),Object(o.throwTabularErrorFromServerError)(s,l,AppMagic.Strings.ConnectedDataDeleteBlobPermissionDenied,this._telemetryBaseData);case 4:return[2]}}))}))},e.prototype.downloadAttachmentAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){throw new Core.NotImplementedError("CdpConnector.downloadAttachmentAsync")}))}))},e.prototype.createFileAsync=function(e,t,r,n,a){return __awaiter(this,void 0,Promise,(function(){var n,i,s,c,u,l,p,d,h;return __generator(this,(function(y){switch(y.label){case 0:return Core.Log.verbose("CdpConnector[{0}]: createFileAsync",this.dataSourceName),n=this._tableMetadata.tryGetColumn(r),i="CdpConnector.createFileAsync",[4,this.validateFileAsync(t,n)];case 1:return y.sent(),[4,this._mediaResolver.getMediaAsBinaryAsync(t)];case 2:s=y.sent(),c=this._tableMetadata.keyColumns.map((function(t){return e[t.name].toString()})).join(","),y.label=3;case 3:return y.trys.push([3,7,,8]),[4,this._ensureMetadataLoadedAsync(i)];case 4:return y.sent(),(u=new Core.UrlBuilder(this._lazyConnectionConfig.value.itemsBaseUrl)).appendPath(Core.Url.encode(c)),u.appendPath(Core.Url.encode("imagefields")),u.appendPath(Core.Url.encode(n.name)),l=this._createAndGetHeaders(),p=this._createErrorContext("createFileAsync",i,a),Core.Diagnostics.addHeaders(l,p),this._addAdditionalHeaders(l),d={method:g.Method.POST,url:u.doneToString(),bodyData:s,headers:l},[4,this._service.authenticationProviders[m.ConnectedDataConstants.AuthProviderId].authenticator.authenticateRequestAsync(d)];case 5:return y.sent(),AppMagic.Services.appendCustomHeadersOptions(d,{addCustomHeaders:!0}),[4,this._appHttpClient.sendHttpIgnoreResponseAsync(d)];case 6:return y.sent(),[3,8];case 7:throw h=y.sent(),Object(o.throwTabularErrorFromServerError)(i,h,AppMagic.Strings.ConnectedDataCreateBlobPermissionDenied,this._telemetryBaseData);case 8:return[2]}}))}))},e.prototype.deleteFileAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var a,i,s,c,u,l,p,d;return __generator(this,(function(h){switch(h.label){case 0:if(Core.Log.verbose("CdpConnector[{0}]: deleteFileAsync",this.dataSourceName),a=this._tableMetadata.tryGetColumn(t),i="CdpConnector.deleteFileAsync",!(null==a?void 0:a.isImageColumn))throw Object(o.logError)(i,"Cannot find column with name: ".concat(t," of type image"),this._telemetryBaseData),new n.TabularDataError({message:AppMagic.Strings.ConnectedDataUnknownError,errorKind:n.ConnectedDataErrorKind.UnknownError});s=this._tableMetadata.keyColumns.map((function(t){return e[t.name].toString()})).join(","),h.label=1;case 1:return h.trys.push([1,5,,6]),[4,this._ensureMetadataLoadedAsync(i)];case 2:return h.sent(),(c=new Core.UrlBuilder(this._lazyConnectionConfig.value.itemsBaseUrl)).appendPath(Core.Url.encode(s)),c.appendPath(Core.Url.encode("imagefields")),c.appendPath(Core.Url.encode(a.name)),u=this._createAndGetHeaders(),l=this._createErrorContext("deleteFileAsync",i,r),Core.Diagnostics.addHeaders(u,l),this._addAdditionalHeaders(u),p={method:g.Method.DELETE,url:c.doneToString(),headers:u},[4,this._service.authenticationProviders[m.ConnectedDataConstants.AuthProviderId].authenticator.authenticateRequestAsync(p)];case 3:return h.sent(),AppMagic.Services.appendCustomHeadersOptions(p,{addCustomHeaders:!0}),[4,this._appHttpClient.sendHttpIgnoreResponseAsync(p)];case 4:return h.sent(),[3,6];case 5:throw d=h.sent(),Object(o.throwTabularErrorFromServerError)(i,d,AppMagic.Strings.ConnectedDataDeleteBlobPermissionDenied,this._telemetryBaseData);case 6:return[2]}}))}))},e.prototype.downloadFileAsync=function(e,t,r,n){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){throw new Core.NotImplementedError("downloadFileAsync")}))}))},e.prototype.validateFileAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r;return __generator(this,(function(a){switch(a.label){case 0:if(r="CdpConnector.validateFileAsync",!t.isImageColumn)throw Object(o.logError)(r,"Column ".concat(t.name," is not of type image"),this._telemetryBaseData),new n.TabularDataError({message:AppMagic.Strings.ConnectedDataUnknownError,errorKind:n.ConnectedDataErrorKind.InvalidRequest});if(t.isReadOnly)throw Object(o.logError)(r,"Image column ".concat(t.name," is ReadOnly"),this._telemetryBaseData),new n.TabularDataError({message:AppMagic.Strings.ConnectedDataReadOnlyColumn,errorKind:n.ConnectedDataErrorKind.InvalidRequest});return[4,this._mediaResolver.getMediaAsBinaryAsync(e)];case 1:if(!a.sent())throw Object(o.logError)(r,"The media has no content.",this._telemetryBaseData),new n.TabularDataError({errorKind:n.ConnectedDataErrorKind.UnknownError,message:AppMagic.Strings.ConnectedDataUnknownError});return[2,null]}}))}))},e.prototype.dispose=function(){null!==this._service&&(this._service.dispose(),this._service=null),this._isDisposed=!0},e.prototype._createErrorContext=function(e,t,r){return Core.Diagnostics.createErrorContext({protocol:"cdp",operation:e,apiId:this.connectionApiId,dataSource:this.dataSourceName,table:this.name,operationName:t},r)},e.prototype._showGetMoreRowsCountToMonitor=function(e,t){var r;if(Core.Diagnostics.isEnabled()){var n=Object(c.safeCast)(e),a=null!==(r=null==n?void 0:n.items.length)&&void 0!==r?r:0,o=this._createErrorContext("showGetMoreRowsCount","getMoreRowsCount",t);Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.Network,"getMoreRowsCount",{context:o,info:Core.Utility.formatString(AppMagic.Strings.ReceivedMoreRows,a)},Core.Diagnostics.MonitorLogLevel.Trace)}},e.prototype._showGetRowsCountToMonitor=function(e,t,r){if(Core.Diagnostics.isEnabled()){var n=this._createErrorContext("showGetRowsCount","getRowsCount",r);Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.Network,"getRowsCount",{context:n,info:Core.Utility.formatString(AppMagic.Strings.RequestedReceivedRows,e,t)},Core.Diagnostics.MonitorLogLevel.Trace)}},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"TableMetadata",(function(){return n}));var n=new Core.TypedUrlTemplate("$metadata.json/datasets{/datasetName}/tables{/tableName}")},function(e,t,r){"use strict";r.r(t),r.d(t,"CdpConnectorManager",(function(){return a}));var n=r(12),a=function(e){function t(t,r,n,a,o,i,s,c,u,l){void 0===c&&(c=!1),void 0===u&&(u=!0),void 0===l&&(l=1e4);var p=e.call(this)||this;return p._appInstance=o,p._blobManager=i,p._binaryResolver=s,p._strongConsistency=c,p._encodeDataset=u,p._connectorTimeout=l,p._dataSourceName=t,p._primaryTableName=r,p._appInstance=o,p._blobManager=i,p._connectionApiId=a,p._connectorsTable=HashTableUtility.create(),p._connectorWaitersTable=HashTableUtility.create(),p.track("_connectionTable",p._connectorsTable),p.track("_connectionWaitersTable",p._connectorWaitersTable),n.forEach((function(e){return p.add(e.dataEntityName,e.dataEntityDefinition)})),p}return __extends(t,e),Object.defineProperty(t.prototype,"_isValid",{get:function(){return!this.isDisposed&&!!this._connectorsTable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"primaryTableName",{get:function(){return this._primaryTableName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allConnectorsTable",{get:function(){return this._connectorsTable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"primaryConnector",{get:function(){return this._connectorsTable[this._primaryTableName]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataSourceName",{get:function(){return this._dataSourceName},enumerable:!1,configurable:!0}),t.prototype.add=function(e,t){var r=Object(n.createConnectedDataConnector)(this._dataSourceName,t,this._appInstance.appHttpClient,this._appInstance.authenticationService,this._appInstance.appHostClient,this._appInstance.restXhrClient,this._appInstance.restHostClient,this._appInstance.mediaRuntime,this._blobManager,this._binaryResolver,this._connectionApiId,this,this._strongConsistency,this._encodeDataset);this._connectorWaitersTable[e]&&this._connectorWaitersTable[e].dispatch(r);this._connectorsTable[e]=r},t.prototype.getAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return(t=this.tryGet(e))?[3,2]:(this._connectorWaitersTable[e]=new OneTimeEvent("CdpConnectorManager.getAsync(".concat(e,")")),[4,Core.PromiseUtils.wrapWithTimeout(this._connectorWaitersTable[e].waitAsync(),this._connectorTimeout)]);case 1:if(r.sent().hasTimedOut)throw new Error("Error getting connector for entity '".concat(e,"'. The operation has timed out after ").concat(this._connectorTimeout/1e3," second(s)."));r.label=2;case 2:return[2,t]}}))}))},t.prototype.tryGet=function(e){return this._connectorsTable[e]||null},t.prototype.tryGetNavigationConnector=function(e,t){var r=e.metadata.tryGetColumn(t);if(!r||!r.isNavigation)return null;var n=r;return this.tryGet(n.targetTableName)},t}(Core.Disposable)},function(e,t,r){"use strict";r.r(t),r.d(t,"CdsDataSetConnector",(function(){return a}));var n=r(1),a=function(e){function t(t){var r=e.call(this)||this;return r._dataSetName=t,r._whoAmIUrl=new Core.Url("/WhoAmI()"),r}return __extends(t,e),t.prototype._createErrorContext=function(e,t,r){return Core.Diagnostics.createErrorContext({protocol:"cds",operation:e,apiId:this._telemetryBaseData.apiId,operationName:t},r)},t.prototype.getSystemUserIdAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){return this._systemUserId||(this._systemUserId=this._getSystemUserIdAsync(e)),[2,this._systemUserId]}))}))},t.prototype._parseSystemUserIdResponse=function(e){var t;return null===(t=e.response)||void 0===t?void 0:t.UserId},t.prototype._getSystemUserIdAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,a,o;return __generator(this,(function(i){switch(i.label){case 0:t="CdsDataSetConnector.getSystemUserId",this._telemetryBaseData={dataSourceName:this._dataSetName,apiId:"CdsNative"},i.label=1;case 1:return i.trys.push([1,3,,4]),r=this._createErrorContext("getSystemUserId",t),[4,e.runUnsafeGetQueryAsync(t,Core.UrlBuilder.composeUrlAppendToBase(e.getRuntimeBaseUrl(),this._whoAmIUrl),{errorContext:r,batchInfo:{batchId:""}})];case 2:return a=i.sent(),[2,this._parseSystemUserIdResponse(a)];case 3:return o=i.sent(),Object(n.logWarning)(t,"Error retrieving systemuserid for user from CDS",this._telemetryBaseData,o),[2,null];case 4:return[2]}}))}))},t}(Core.Disposable)},function(e,t,r){"use strict";r.r(t),r.d(t,"CdsAttachmentsHelper",(function(){return d}));var n=r(0),a=r(3),o=r(8),i=r(1),s=r(4),c=AppMagic.AppResourceUri,u=AppMagic.Data,l=AppMagic.Services.ODataConstants,p=AppMagic.Services.HttpConstants,d=function(){function e(e,t,r,n,a){this._dataSourceName=e,this._lazyConfigAsync=t,this._lazyOdataConnector=r,this._metadata=n,this._telemetryBaseData=a,this._attachmentType=c.Templates.ConnectedDataSourceAttachmentType.expandUrl({datasourceName:this._dataSourceName,tableName:this._metadata.name})}return e.prototype.addAttachmentsAppResUriToRecord=function(e,t){if(0!==this._metadata.attachmentColumns.length){var r=Core.Utility.tryParseJson(this._metadata.getPrimaryKey(e));if(!Core.Utility.isDefined(r))return!1;var n=this._metadata.attachmentColumns[0].name;return e[n]=c.Templates.ConnectedDataSourceAttachmentsId.expandUrlString({datasourceName:this._dataSourceName,tableName:this._metadata.name,internalRowId:r,propertyName:n,uniqueId:t}),!0}},e.prototype.addAttachmentsAppResUrisToResult=function(e){var t=this;if(0!==this._metadata.attachmentColumns.length){var r=[],n=Core.Utility.generate128BitUUID();e.items.forEach((function(e,a){t.addAttachmentsAppResUriToRecord(e,n)||r.push(a)})),0!==r.length&&Core.Log.error("CdsAttachmentHelper.addAttachmentsAppResUrisToResult","Could not find the primary key for rows with indices ".concat(r.join(" ,"),"."))}},e.prototype.getAttachmentsAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,o,c,u,p;return __generator(this,(function(d){switch(d.label){case 0:r="CdsAttachmentsHelper.getAttachmentsAsync",d.label=1;case 1:return d.trys.push([1,3,,4]),(o=new Core.UrlBuilder(this._lazyConfigAsync.value.baseUrl)).appendPath(a.TableName),o.setQueryParam(l.QueryOption.Filter,"".concat(a.ObjectIdValue," eq '").concat(e,"' and ").concat(a.FileName," ne null")),o.setQueryParam(l.QueryOption.Select,"".concat(a.FileName,", ").concat(a.Id)),c=this._createErrorContext("getAttachments",r,t),[4,this._lazyOdataConnector.value.runUnsafeGetQueryAsync(r,o.toUrl(),{errorContext:c,batchInfo:{batchId:""}})];case 2:return u=d.sent(),n=u.response,Object(i.validateServerResult)(n),[3,4];case 3:return p=d.sent(),Object(s.processAndThrowTabularError)(r,p,AppMagic.Strings.ConnectedDataGetRowsPermissionDenied,this._telemetryBaseData),[3,4];case 4:return[2,this._processAnnotationsResponse(r,e,n)]}}))}))},e.prototype.createAttachmentAsync=function(e,t,r,o,c,u,l){return __awaiter(this,void 0,Promise,(function(){var d,h,m,y,f,v,g,C,_,b,A,S;return __generator(this,(function(w){switch(w.label){case 0:return d="CdsAttachmentsHelper.createAttachmentAsync",[4,o.getMediaAsBinaryAsync(t)];case 1:if(!(h=w.sent()))throw Object(i.logError)(d,"The media has no content.",this._telemetryBaseData),new n.TabularDataError({errorKind:n.ConnectedDataErrorKind.UnknownError,message:AppMagic.Strings.ConnectedDataUnknownError});m=this._metadata.keyColumns.map((function(t){return e[t.name].toString()})).join(","),y=this._metadata.tryGetColumn(r),w.label=2;case 2:return w.trys.push([2,5,,6]),f="".concat(y.annotationNavigationPropertyName,"@odata.bind"),v="/".concat(this._lazyConfigAsync.value.entitySetName,"(").concat(m,")"),(S={})[a.FileName]=u,C=a.DocumentBody,[4,c.getAsBase64StringAsync(h)];case 3:return S[C]=w.sent(),S[a.Subject]=u,S[a.MimeType]=h.mimeType,S[f]=v,g=S,(_=new Core.UrlBuilder(this._lazyConfigAsync.value.baseUrl)).appendPath(a.TableName),b=this._createErrorContext("createAttachment",d,l),[4,this._lazyOdataConnector.value.runUnsafeWriteRequestNoResponseAsync(d,_.toUrl(),p.Method.POST,JSON.stringify(g),{errorContext:b,batchInfo:{batchId:""}})];case 4:return w.sent(),[2,null];case 5:return A=w.sent(),Object(s.processAndThrowTabularError)(d,A,AppMagic.Strings.ConnectedDataCreateBlobPermissionDenied,this._telemetryBaseData),[3,6];case 6:return[2]}}))}))},e.prototype.deleteAttachmentAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,o,i,c;return __generator(this,(function(u){switch(u.label){case 0:r="CdsAttachmentsHelper.deleteAttachmentAsync",u.label=1;case 1:return u.trys.push([1,3,,4]),(n=HashTableUtility.create())[a.FileName]=null,n[a.DocumentBody]=null,n[a.Id]=e,(o=new Core.UrlBuilder(this._lazyConfigAsync.value.baseUrl)).appendPath("".concat(a.TableName,"(").concat(e,")")),i=this._createErrorContext("deleteAttachment",r,t),[4,this._lazyOdataConnector.value.runUnsafeWriteRequestNoResponseAsync(r,o.toUrl(),p.Method.PATCH,JSON.stringify(n),{errorContext:i,batchInfo:{batchId:""}})];case 2:return u.sent(),[3,4];case 3:return c=u.sent(),Object(s.processAndThrowTabularError)(r,c,AppMagic.Strings.ConnectedDataPatchRowPermissionDenied,this._telemetryBaseData),[3,4];case 4:return[2]}}))}))},e.prototype.downloadAttachmentAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,a,i,c,u,l;return __generator(this,(function(p){switch(p.label){case 0:r="CdsAttachmentsHelper.downloadReferencedBlobAsync",p.label=1;case 1:return p.trys.push([1,3,,4]),n=new Core.UrlBuilder(e),this._createErrorContext("downloadAttachment",r),[4,this._lazyOdataConnector.value.runUnsafeGetQueryAsync(r,n.toUrl(),{batchInfo:{batchId:""}})];case 2:return a=p.sent(),i=a.response,c=Object(o.safeCastDownloadAttachmentResponse)(i),u=Core.PABinary.createFromBase64String(c.documentbody,c.mimetype||Core.MimeTypes.ApplicationOctetStream),[2,t.registerDataBinaryAndAddRef(u)];case 3:return l=p.sent(),Object(s.processAndThrowTabularError)(r,l,AppMagic.Strings.ConnectedDataGetBlobPermissionDenied,this._telemetryBaseData),[3,4];case 4:return[2]}}))}))},e.prototype._processAnnotationsResponse=function(e,t,r){var a=this,s=Object(o.safeCastListAttachmentResponse)(r);if(!s)throw Object(i.logError)(e,"Server returned invalid response",this._telemetryBaseData),new n.TabularDataError({errorKind:n.ConnectedDataErrorKind.InvalidServerResponse,message:AppMagic.Strings.ConnectedDataInvalidResult});return s.value.map((function(e){return a._convertToAttachmentDataRecord(t,e)}))},e.prototype._convertToAttachmentDataRecord=function(e,t){var r=new Core.UrlBuilder(this._lazyConfigAsync.value.baseUrl);r.appendPath("".concat(a.TableName,"(").concat(t.annotationid,")")),r.setQueryParam(l.QueryOption.Select,"".concat(a.DocumentBody,",").concat(a.MimeType));var n=c.Templates.CdsDataSourceAttachmentReference.expandUrlString({datasourceName:this._dataSourceName,tableName:this._metadata.name,internalRowId:e,downloadUrl:r.toString()}),o={Id:t.annotationid,DisplayName:t.filename,AbsoluteUri:r.toString(),Value:n};return u.DataEntityRecord.makeEntityRecord(o,{entityType:this._attachmentType,etag:null,hiddenProperties:null,odataId:null,source:"cdsNative",tableName:this._metadata.name,canonicalId:e}),o},e.prototype._createErrorContext=function(e,t,r){return Core.Diagnostics.createErrorContext({protocol:"cds",operation:e,dataSource:this._dataSourceName,table:this._metadata.name,operationName:t},r)},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"CdsFileHelper",(function(){return s}));var n=r(0),a=r(1),o=r(4),i=(AppMagic.Data,AppMagic.Services.HttpConstants),s=function(){function e(e,t,r,n,a,o){this._dataSourceName=e,this._lazyCdsConnectorConfig=t,this._lazyOdataConnector=r,this._metadata=n,this._telemetryBaseData=a,this._mediaRuntime=o}return e.prototype.validateFileAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,o,i,s,c;return __generator(this,(function(u){switch(u.label){case 0:return r="CdsFileHelper.validateFileAsync ",o=0,t.isFileColumn?(o=t.maxSizeInKB,r+="(File)"):t.isImageColumn&&(o=t.maxSizeInKB,r+="(Image)"),[4,this._mediaRuntime.getMediaAsBinaryAsync(e)];case 1:if(!(i=u.sent()))throw Object(a.logError)(r,"The media has no content.",this._telemetryBaseData),new n.TabularDataError({errorKind:n.ConnectedDataErrorKind.UnknownError,message:AppMagic.Strings.ConnectedDataUnknownError});return s="",c=i.size/1024,o>0&&c>o&&(s=Core.Utility.formatString(AppMagic.Strings.MaxCDSFileSizeError,t.name,o),Core.Telemetry.Log.trackActivityEvent(r,{message:Core.Utility.formatString("Failure. Max upload size for field '{0}' is {1} KB but trying to upload {2} KB",t.name,o,c)})),s?[2,[{error:AppMagic.Data.ErrorKind.ConstraintViolated,message:s,propertyName:t.name}]]:[2,null]}}))}))},e.prototype.createFileAsync=function(e,t,r,s,c){return __awaiter(this,void 0,Promise,(function(){var u,l,p,d,h,m,y,f,v,g;return __generator(this,(function(C){switch(C.label){case 0:return[4,this._lazyCdsConnectorConfig.valueAsync()];case 1:return u=C.sent(),[4,this._lazyOdataConnector.valueAsync()];case 2:return l=C.sent(),p=this._metadata.tryGetColumn(r),d="CdsFileHelper.createFileAsync "+(p.isFileColumn?"(File)":"(Image)"),[4,this._mediaRuntime.getMediaAsBinaryAsync(t)];case 3:if(!(h=C.sent()))throw Object(a.logError)(d,"The media has no content.",this._telemetryBaseData),new n.TabularDataError({errorKind:n.ConnectedDataErrorKind.UnknownError,message:AppMagic.Strings.ConnectedDataUnknownError});m=this._metadata.keyColumns.map((function(t){return e[t.name].toString()})).join(","),C.label=4;case 4:return C.trys.push([4,6,,7]),(y=new Core.UrlBuilder(u.baseUrl)).appendPath("".concat(u.entitySetName,"(").concat(m,")/").concat(r)),(f=HashTableUtility.create())[i.HeaderName.ContentType]=i.MediaType.ApplicationOctetStream,s&&y.setQueryParam(AppMagic.Services.TypeSystem.FileConstants.FileNameHeader,s),Core.Telemetry.Log.trackActivityEvent(d,{message:"Uploading file",binarySizeBytes:h.size}),v=this._createErrorContext("createFile",d,c),[4,l.runUnsafeWriteRequestNoResponseAsync(d,y.toUrl(),i.Method.PATCH,h,{errorContext:v,optionalHeaders:f})];case 5:return C.sent(),[3,7];case 6:return g=C.sent(),Object(o.processAndThrowTabularError)(d,g,AppMagic.Strings.ConnectedDataCreateBlobPermissionDenied,this._telemetryBaseData),[3,7];case 7:return[2]}}))}))},e.prototype.tryGetFileSasUrlAsync=function(e,t){var r;return __awaiter(this,void 0,Promise,(function(){var n,a,o,i,s,c,u,l,p;return __generator(this,(function(d){switch(d.label){case 0:return[4,this._lazyOdataConnector.valueAsync()];case 1:return n=d.sent(),[4,this._lazyCdsConnectorConfig.valueAsync()];case 2:a=d.sent(),o=this._metadata.tryGetColumn(e),i="CdsFileHelper.tryGetFileSasUrlAsync",(s=new Core.UrlBuilder(a.baseUrl)).appendPath("GetFileSasUrl(Target=@p1,FileAttributeName='".concat(o.name,"')")),s.appendQuery("@p1={'@odata.id':'".concat(this._metadata.entitySetName,"(").concat(t,")'}")),d.label=3;case 3:return d.trys.push([3,5,,6]),c=this._createErrorContext("getFileSasUrl",i),[4,n.runUnsafeGetQueryAsync(i,s.doneToUrl(),{responseType:AppMagic.Services.ResponseTypes.Json,errorContext:c})];case 4:return u=d.sent(),l=AppMagic.Services.CdsFileSasUrlResponse.safeCast(u.response),(null===(r=null==l?void 0:l.Result)||void 0===r?void 0:r.SasUrl)?(Core.Telemetry.Log.trackActivityEvent(i,{message:"Downloading file",binarySizeBytes:l.Result.FileSizeInBytes}),[2,new Core.Url(l.Result.SasUrl)]):[3,6];case 5:return p=d.sent(),Core.Log.warningEx(i,p),[3,6];case 6:return[2,null]}}))}))},e.prototype.downloadFileAsync=function(e,t,r,n){return __awaiter(this,void 0,Promise,(function(){var r,n,a,i,s,c,u,l,p;return __generator(this,(function(d){switch(d.label){case 0:return[4,this._lazyOdataConnector.valueAsync()];case 1:return r=d.sent(),n=this._metadata.tryGetColumn(e),[4,this.tryGetFileSasUrlAsync(e,t)];case 2:return a=d.sent(),i="CdsFileHelper.downloadFileAsync "+(n.isFileColumn?"(File)":"(Image)"),a?[3,4]:(Core.Telemetry.Log.trackActivityEvent(i,{message:"FileSasUrl not available, using the $value route to download."}),[4,this._lazyCdsConnectorConfig.valueAsync()]);case 3:s=d.sent(),(c=new Core.UrlBuilder(s.baseUrl)).appendPath("".concat(this._metadata.entitySetName,"(").concat(t,")")),c.appendPath("".concat(n.name)),c.appendPath("$value"),n.isImageColumn&&c.appendQuery("size=full"),a=c.doneToUrl(),d.label=4;case 4:d.label=5;case 5:return d.trys.push([5,7,,8]),u=this._createErrorContext("downloadFile",i),[4,r.runUnsafeGetQueryAsync(i,a,{responseType:AppMagic.Services.ResponseTypes.PABinary,errorContext:u})];case 6:return l=d.sent(),[2,this._mediaRuntime.registerDataBinaryAndAddRef(l.response)];case 7:return p=d.sent(),Object(o.processAndThrowTabularError)(i,p,AppMagic.Strings.ConnectedDataGetBlobPermissionDenied,this._telemetryBaseData),[3,8];case 8:return[2]}}))}))},e.prototype.deleteFileAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,a,i,s,c,u,l,p;return __generator(this,(function(d){switch(d.label){case 0:return[4,this._lazyCdsConnectorConfig.valueAsync()];case 1:return n=d.sent(),[4,this._lazyOdataConnector.valueAsync()];case 2:a=d.sent(),i=this._metadata.tryGetColumn(t),s="CdsFileHelper.deleteFileAsync "+(i.isFileColumn?"(File)":"(Image)"),c=this._metadata.keyColumns.map((function(t){return e[t.name].toString()})).join(","),this._metadata.tryGetColumn(t),d.label=3;case 3:return d.trys.push([3,5,,6]),(u=new Core.UrlBuilder(n.baseUrl)).appendPath("".concat(n.entitySetName,"(").concat(c,")/").concat(t)),l=this._createErrorContext("deleteFile",s,r),[4,a.runUnsafeDeleteRequestAsync(s,u.toUrl(),{errorContext:l,batchInfo:{batchId:""}})];case 4:return d.sent(),[3,6];case 5:return p=d.sent(),Object(o.processAndThrowTabularError)(s,p,AppMagic.Strings.ConnectedDataPatchRowPermissionDenied,this._telemetryBaseData),[3,6];case 6:return[2]}}))}))},e.prototype._createErrorContext=function(e,t,r){return Core.Diagnostics.createErrorContext({protocol:"cds",operation:e,dataSource:this._dataSourceName,table:this._metadata.name,operationName:t},r)},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"DataComponentConnector",(function(){return i}));var n=r(0),a=AppMagic.AppResourceUri,o=AppMagic.Data,i=function(e){function t(t,r,o,i){var s=e.call(this)||this;return s._componentTableName=t,s._tableMetadata=r,s._controlId=o,s._entitySetName=i,s._queryStringBuilder=Object(n.CreateCdsQueryStringBuilder)(),s._entityType=a.Templates.ConnectedDataSourceEntityType.expandUrl({datasourceName:s.dataSourceName}),s}return __extends(t,e),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._tableMetadata.value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entityType",{get:function(){return this._entityType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataSourceName",{get:function(){return this._componentTableName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isConfigLoaded",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"queryStringBuilder",{get:function(){return this._queryStringBuilder},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectorType",{get:function(){return"DataComponentConnector"},enumerable:!1,configurable:!0}),t.prototype.getRowsAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var e,t;return __generator(this,(function(r){return e=OpenAjax.widget.controlManager.getControlInstanceById(this.controlId),(t=e.control.OpenAjax.getPropertyValue("Items"))||(t=[]),[2,{results:t}]}))}))},Object.defineProperty(t.prototype,"controlId",{get:function(){return this._controlId},enumerable:!1,configurable:!0}),t.prototype.getResultCountAsync=function(e,t){throw new Error("Not implemented")},t.prototype.getScalarResultAsync=function(e,t){throw new Error("Not implemented")},t.prototype.getMoreRowsAsync=function(e,t,r,n){throw new Error("Not implemented")},t.prototype.getRowAsync=function(e,t){throw new Error("Not implemented")},t.prototype.getBaseUrlAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,""]}))}))},t.prototype._throwIfError=function(e){if(o.DataValue.isGatedError(e))throw new n.ComponentDataError(e);return!0},t.prototype.createRowAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return[4,Object(n.executeFunctionAsync)(this.controlId,"OnCreate",{numberOfArguments:2,arguments:[null,e]})];case 1:return t=r.sent(),this._throwIfError(t),[2,this._returnAsDataRecord(t)]}}))}))},t.prototype._returnAsDataRecord=function(e){var t=e;return this._ensureDataEntityRecord(t),t},t.prototype._ensureDataEntityRecord=function(e){o.DataEntityRecord.isDataEntityRecord(e)||o.DataEntityRecord.makeEntityRecord(e,{canonicalId:this.metadata.getPrimaryKey(e),entitySetName:this._entitySetName,entityType:this._entityType,source:"cdsNative",tableName:this.metadata.name})},t.prototype.patchRowAsync=function(e,t,r){return void 0===r&&(r=null),__awaiter(this,void 0,Promise,(function(){var a;return __generator(this,(function(o){switch(o.label){case 0:return[4,Object(n.executeFunctionAsync)(this.controlId,"OnUpdate",{numberOfArguments:3,arguments:[r,e,t]})];case 1:return a=o.sent(),this._throwIfError(a),[2,this._returnAsDataRecord(a)]}}))}))},t.prototype.deleteRowAsync=function(e,t){return void 0===t&&(t=null),__awaiter(this,void 0,Promise,(function(){var r;return __generator(this,(function(a){switch(a.label){case 0:return[4,Object(n.executeFunctionAsync)(this.controlId,"OnDelete",{numberOfArguments:2,arguments:[t,e]})];case 1:return r=a.sent(),this._throwIfError(r),[2]}}))}))},t.prototype.downloadInlineBlobAsync=function(e,t,r){throw new Error("Not implemented")},t.prototype.downloadReferencedBlobAsync=function(e,t){throw new Error("Not implemented")},t.prototype.getAttachmentsAsync=function(e,t,r){throw new Error("Not implemented")},t.prototype.deleteAttachmentAsync=function(e,t,r,n){throw new Error("Not implemented")},t.prototype.createAttachmentAsync=function(e,t,r,n,a){throw new Error("Not implemented")},t.prototype.downloadAttachmentAsync=function(e){throw new Error("Not implemented")},t.prototype.getConnectorTypeNameAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,{tableName:this._componentTableName,serverTableName:this._componentTableName}]}))}))},t.prototype.relateAsync=function(e,t,r,n){throw new Error("Not implemented")},t.prototype.unrelateAsync=function(e,t,r,n){throw new Error("Not implemented")},t.prototype.replaceRowAsync=function(e,t,r){throw new Error("Not implemented")},t.prototype.createFileAsync=function(e,t,r,n,a){throw new Error("Not implemented")},t.prototype.downloadFileAsync=function(e,t,r,n){throw new Error("Not implemented")},t.prototype.deleteFileAsync=function(e,t,r){throw new Error("Not implemented")},t.prototype.validateFileAsync=function(e,t){throw new Error("Not implemented")},t.prototype.getNavigatedRowInTableRowAsync=function(e,t,r,n){throw new Error("Not implemented")},t.prototype.unsafeInvokeActionAsync=function(e,t){throw new Error("Not implemented")},t.prototype.getOptionSetItemsAsync=function(e,t){throw new Error("Not implemented")},t.prototype.getViewsAsync=function(e,t){throw new Error("Not implemented")},t.prototype.getTopNRowsAsync=function(e,t,r){throw new Error("Not implemented")},t.prototype.getUserPrivilegeForEntityAsync=function(e){throw new Error("Method not implemented.")},t.prototype.getUserPrivilegeForRecordAsync=function(e){throw new Error("Method not implemented.")},t.prototype.getLocalizedDisplayNamesAsync=function(e,t){throw new Error("Method not implemented.")},t}(Core.Disposable)},function(e,t,r){"use strict";r.r(t),r.d(t,"RestResponseBodyValueExpression",(function(){return n}));var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.evaluate=function(e){return AppMagic.Services.ServiceUtility.createSuccessfulDataflowResult(e.body)},t}(r(15).RestResponseValueExpressionBase)},function(e,t,r){"use strict";r.r(t),r.d(t,"RestResponseLiteralValueExpression",(function(){return a}));var n=AppMagic.Services.ServiceUtility,a=function(){function e(e,t){this._value=e,this._dtype=t}return e.prototype.computeSchema=function(e){return AppMagic.Schema.createSchemaForSimple(this._dtype)},e.prototype.evaluate=function(e){return n.createSuccessfulDataflowResult(this._value)},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"RestServiceFunction",(function(){return u}));var n=r(24),a=r(14),o=r(50),i=r(13),s=AppMagic.Services.ServiceUtility,c=AppMagic.Services.HttpConstants,u=function(e){function t(t,r,n,a,i,s,c,u,l,p,d,h,m,y,f,v,g,C){var _=e.call(this,t,r,n,a,i,s,c,l,p,g,C)||this;return _._isBehaviorOnly=u,_.authProviderId=d,_._requestBuilderFactory=new AppMagic.Services.HttpRequestBuilderFactory(h),_._requestParams=m,_._resultForm=y,_._dynamicResultForms=f,_._restClient=v,_._requestCache=new o.RestServiceCache(v,g,C,_.service.serviceNamespace+"."+_.name),_}return __extends(t,e),Object.defineProperty(t.prototype,"isBehaviorOnly",{get:function(){return this._isBehaviorOnly},enumerable:!1,configurable:!0}),t.prototype.computeResultSchema=function(e){return this._resultForm.computeSchema(e)},t.prototype.addDynamicResultForm=function(e,t){this._dynamicResultForms.set(e,t)},t.prototype.removeDynamicResultForm=function(e){this._dynamicResultForms.delete(e)},t.prototype.runAsync=function(e,t,r,o,i){var u,l,p,d;return __awaiter(this,void 0,Promise,(function(){var h,m,y,f,v,g,C;return __generator(this,(function(_){switch(_.label){case 0:return h=this.service instanceof a.ImportedService&&(null===(u=this.service)||void 0===u?void 0:u.getCdsActionInfo()),[4,this._ensureServiceIsValidAsync()];case 1:return _.sent(),m=new n.FunctionExecutionContext(this.service.executionContext,e,HashTableUtility.create(),null==t?void 0:t.onBeforeAsyncStep,null==t?void 0:t.onAfterAsyncStep),y=function(e){return o?e.replace(i,o):e},f=this._requestBuilderFactory.createHttpRequestBuilder(o?y:void 0),h?[4,this._generateCdsActionRequest(m,f)]:[3,3];case 2:return v=_.sent(),[3,7];case 3:return this.service.connectedMetadata&&AppMagic.Services.addTelemetryOptionsToBuilder(f,{operationName:"".concat(this.service.connectedMetadata.apiId,".").concat(this.name)}),[4,Core.PromiseUtils.join(this._requestParams.map((function(e){return e.applyAsync(f,m)})))];case 4:return _.sent(),this.authProviderId?[4,this.service.authenticationProviders[this.authProviderId].authenticateRequestAsync(f)]:[3,6];case 5:_.sent(),_.label=6;case 6:this.service.serviceNamespace&&f.addHeader(AppMagic.Services.HttpConstants.HeaderName.ServiceNamespace,this.service.serviceNamespace),v=f.generateSendHttpRequestParameters(),_.label=7;case 7:v.signal=r,(null==t?void 0:t.errorContext)&&(v.headers||(v.headers=HashTableUtility.create()),Core.Diagnostics.addHeaders(v.headers,null==t?void 0:t.errorContext)),Core.AppInstrumentation.addTracingHeaders(v.headers),(null===(l=this.service)||void 0===l?void 0:l.sharedConnectionId)&&(v.headers||(v.headers=HashTableUtility.create()),v.headers[AppMagic.Services.HttpConstants.HeaderName.SharedConnectionId]=null===(p=this.service)||void 0===p?void 0:p.sharedConnectionId),g=null!==(d=this._dynamicResultForms.get(null==t?void 0:t.dynamicInstanceId))&&void 0!==d?d:this._resultForm,Core.Utility.isFunction(null==t?void 0:t.onBeforeAsyncStep)&&t.onBeforeAsyncStep,_.label=8;case 8:return _.trys.push([8,,15,16]),C=void 0,this.functionDefinition.isHostFunction&&"void"===this.functionDefinition.response.resultform?(this._restClient.sendRestAsync(v,g.xhrProcessor),C={status:200,headerParams:{},bodyParams:{},body:{}},[3,14]):[3,9];case 9:return(null==t?void 0:t.skipValidation)?[2,this._restClient.sendUnprocessedRestAsync(v,g.xhrProcessor.xhrResponseType)]:[3,10];case 10:return v.method!==c.Method.GET?[3,12]:[4,this._requestCache.getCachedResponseOrSendRequestAsync(v,g.xhrProcessor)];case 11:return C=_.sent(),[3,14];case 12:return[4,this._restClient.sendRestAsync(v,g.xhrProcessor)];case 13:C=_.sent(),_.label=14;case 14:return[2,s.getDataflowResultValueOrThrow(g.evaluate(C))];case 15:return Core.Utility.isFunction(null==t?void 0:t.onAfterAsyncStep)&&t.onAfterAsyncStep(),[7];case 16:return[2]}}))}))},t.prototype._generateCdsActionRequest=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n;return __generator(this,(function(a){switch(a.label){case 0:return AppMagic.Services.addTelemetryOptionsToBuilder(t,{operationName:"DataverseAction.".concat(this.service.serviceNamespace,".").concat(this.name)}),[4,Core.PromiseUtils.join(this._requestParams.map((function(r){return r.applyAsync(t,e)})))];case 1:return a.sent(),this.service.serviceNamespace&&t.addHeader(AppMagic.Services.HttpConstants.HeaderName.ServiceNamespace,this.service.serviceNamespace),(r=this.service.authenticationProviders[this.service.serviceNamespace])?[4,r.authenticateRequestAsync(t)]:[3,3];case 2:a.sent(),a.label=3;case 3:return(n=t.generateSendHttpRequestParameters()).url=n.url,[2,n]}}))}))},t.prototype.processRawResponse=function(e,t){var r,n=null!==(r=this._dynamicResultForms.get(t))&&void 0!==r?r:this._resultForm;return s.getDataflowResultValueOrThrow(n.evaluate(n.xhrProcessor.processXhr(e)))},t}(i.ServiceFunctionBase)},function(e,t,r){"use strict";r.r(t),r.d(t,"RestServiceCache",(function(){return a}));var n=AppMagic.Services.HttpConstants,a=function(){function e(e,t,r,n){void 0===t&&(t=!1),void 0===r&&(r=0),this._cachedQueries=new Map,this._pendingRequests=new Map,this._restClient=e,this._isCacheEnabled=t,this._cacheTimeoutMs=r,this._requestName=n}return e.prototype._cleanupExpiredCacheEntries=function(){var e=this,t=(new Date).getTime();this._cachedQueries.forEach((function(r,n){r.expirationTime<t&&e._cachedQueries.delete(n)}))},e._getCacheKeyForRequest=function(e){var t=JSON.parse(JSON.stringify({url:e.url,headers:e.headers}));return t.headers&&(delete t.headers[n.HeaderName.Authorization],delete t.headers[n.HeaderName.DiagnosticContext]),JSON.stringify(t)},e.prototype.getCachedResponseOrSendRequestAsync=function(t,r){return __awaiter(this,void 0,Promise,(function(){var n,a,o;return __generator(this,(function(i){switch(i.label){case 0:return this._cleanupExpiredCacheEntries(),n=e._getCacheKeyForRequest(t),this._cachedQueries.has(n)?(Core.Telemetry.Log.trackActivityEvent("RestServiceCache.getCachedResponseOrSendRequestAsync",{message:"Request serviced from cache for ".concat(this._requestName,".")}),[2,this._cachedQueries.get(n).response]):this._pendingRequests.has(n)?(Core.Telemetry.Log.trackActivityEvent("RestServiceCache.getCachedResponseOrSendRequestAsync",{message:"Request coalesced for function ".concat(this._requestName,".")}),[4,this._pendingRequests.get(n)]):[3,2];case 1:return[2,i.sent()];case 2:a=this._restClient.sendRestAsync(t,r),i.label=3;case 3:return i.trys.push([3,,5,6]),this._pendingRequests.set(n,a),[4,a];case 4:return o=i.sent(),[3,6];case 5:return this._pendingRequests.delete(n),[7];case 6:return o.status>=200&&o.status<300&&this._isCacheEnabled&&this._cachedQueries.set(n,{response:o,expirationTime:(new Date).getTime()+this._cacheTimeoutMs}),[2,o]}}))}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"BinaryBodyRequestDefinitionDeserializer",(function(){return s}));var n=r(31),a=r(37),o=r(9),i=r(10),s=(AppMagic.Services.TypeSystem,AppMagic.Services.ServiceConfigDeserialization.IRConstants,function(e){function t(t){var r=e.call(this,new n.BinaryBodyHttpRequestBuilder)||this;return r._typeSystemContext=t,r}return __extends(t,e),t.prototype.parseBody=function(e){var t=Object(i.parseValueExpressionDefinition)(e.valueexpression),r=AppMagic.Services.ServiceConfigDeserialization.TypesManagerDeserializer.parseTypedDefinitionMetadata(e,this._typeSystemContext),n=new a.BinaryBodyRequestParam(r,t);this._requestParams.push(n)},t}(o.RequestDefinitionDeserializer))},function(e,t,r){"use strict";r.r(t),r.d(t,"MultipartFormDataBodyBinaryRequestParam",(function(){return a}));var n=r(53),a=(r(22),function(e){function t(t,r,n,a,o){var i=e.call(this,r,n,[AppMagic.Services.TypeSystem.TTypeValueKind.Binary])||this;return i._paramName=t,i._guidGenerator=a,i._binaryResolver=o,i}return __extends(t,e),t.prototype._convertFromDValueAsync=function(t,r){return __awaiter(this,void 0,Promise,(function(){var n;return __generator(this,(function(a){switch(a.label){case 0:return[4,e.prototype._convertFromDValueAsync.call(this,t,r)];case 1:if(null===(n=a.sent()))return[2,null];if(!(n instanceof Core.PABinary))throw new Core.InvalidOperationError("MultipartFormDataBodyBinaryRequestParam.MultipartFormDataBodyBinaryRequestParam","Expected a PABinary instance.");return[4,this._binaryResolver.getAsBlobAsync(n)];case 2:return[2,a.sent()]}}))}))},t.prototype._applyValue=function(e,t){var r="file_"+this._guidGenerator.generateGuid(),a=Core.MediaType.tryExtractMimeTypeFromMediaType(t.type||"");a&&(r+=Core.MimeTypes.tryGetFileExtension(a)||""),e.addPart(new n.MultipartFormDataBinaryPart(this._paramName,r,t))},t}(AppMagic.Services.TypedRequestParamBase))},function(e,t,r){"use strict";r.r(t),r.d(t,"MultipartFormDataBinaryPart",(function(){return n}));var n=function(){function e(e,t,r){this._partName=e,this._filename=t,this._blob=r}return e.prototype.clone=function(){return new e(this._partName,this._filename,this._blob)},e.prototype.addParts=function(e){e.push("".concat(AppMagic.Services.HttpConstants.HeaderName.ContentDisposition,": ").concat(AppMagic.Services.HttpConstants.ContentDispositionType.FormData,'; name="').concat(this._partName.replace('"','\\"'),'"; filename="').concat(this._filename.replace('"','\\"'),'"\r\n').concat(AppMagic.Services.HttpConstants.HeaderName.ContentType,": ").concat(this._blob.type,"\r\n\r\n")),e.push(this._blob),e.push("\r\n")},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"MultipartFormDataBodyTextRequestParam",(function(){return a}));r(22);var n=r(55),a=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return __extends(t,e),t.prototype._applyValue=function(e,t){e.addPart(new n.MultipartFormDataTextPart(this.paramName,t))},t}(AppMagic.Services.NamedHttpRequestParam)},function(e,t,r){"use strict";r.r(t),r.d(t,"MultipartFormDataTextPart",(function(){return n}));var n=function(){function e(e,t){this._partName=e,this._text=t}return e.prototype.clone=function(){return new e(this._partName,this._text)},e.prototype.addParts=function(e){e.push("".concat(AppMagic.Services.HttpConstants.HeaderName.ContentDisposition,": ").concat(AppMagic.Services.HttpConstants.ContentDispositionType.FormData,'; name="').concat(this._partName.replace('"','\\"'),'"\r\n\r\n')),e.push(this._text+"\r\n")},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"PollingServiceFunction",(function(){return a}));var n=r(57),a=function(e){function t(t,r){var n=this;return(n=e.call(this,t.service,t.functionDefinition,t.name,t.docId,t.disableTryIt,t.isHiddenFromRules,t.isShownInBackstage,t.requiredParameters,t.optionalParameters)||this)._serviceFunction=t,n._pollingInterval=r,n}return __extends(t,e),Object.defineProperty(t.prototype,"isBehaviorOnly",{get:function(){return this._serviceFunction.isBehaviorOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAutoRefreshable",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.tryGetVariable=function(e){return this._serviceFunction.tryGetVariable(e)},t.prototype.computeResultSchema=function(e){return this._serviceFunction.computeResultSchema(e)},t.prototype.runAsync=function(e,t,r){return this._serviceFunction.runAsync(e,t,r)},t.prototype.processRawResponse=function(e,t){return this._serviceFunction.processRawResponse(e,t)},t.prototype.createFunctionInvocation=function(e){return new n.PollingServiceFunctionInvocation(this,this.service.serviceHost,e,this._pollingInterval)},t.prototype.dispose=function(){this._serviceFunction.dispose(),e.prototype.dispose.call(this)},t}(r(13).ServiceFunctionBase)},function(e,t,r){"use strict";r.r(t),r.d(t,"PollingServiceFunctionInvocation",(function(){return n}));var n=function(e){function t(t,r,n,a){var o=e.call(this,t,r,void 0,n)||this;return o._timerId=null,o._interval=a,o}return __extends(t,e),t.prototype._getDataCore=function(t,r,n,a){return this._stopTimer(),e.prototype._getDataCore.call(this,t,r,n,a)},t.prototype._onComplete=function(t,r){return this._startTimer(),e.prototype._onComplete.call(this,t,r)},t.prototype._onError=function(t,r){return this._startTimer(),e.prototype._onError.call(this,t,r)},t.prototype.disposeCore=function(){this._stopTimer(),e.prototype.disposeCore.call(this)},t.prototype._startTimer=function(){var e=this;this.disposed||(this._stopTimer(),this._timerId=setTimeout((function(){e._timerId=null;var t=new AppMagic.Services.ServiceCallEventArgs(AppMagic.Services.ServiceCallEventArgs.Kind.PollingTimerElapsed,e.invocationId);e.host.onServiceEvent(t)}),this._interval))},t.prototype._stopTimer=function(){null!==this._timerId&&(clearTimeout(this._timerId),this._timerId=null)},t}(r(11).b)},function(e,t,r){"use strict";r.r(t),r.d(t,"parseFunctionDefinition",(function(){return i}));var n=r(39),a=r(2),o=r(10);function i(e,t){var r=Object(a.parseFunctionParameters)(e.parameters,t),i=function(e){return e.map((function(e){var t=Object(o.parseValueExpressionDefinition)(e.valueexpression);return new AppMagic.Services.FunctionVariable(e.name,t)}))}(e.variables),s=!0===e.disabletryit,c=e.docid||null,u=Object(o.parseValueExpressionDefinition)(e.returnexpression);return new n.CompositeServiceFunction(t.service,e,e.name,c,s,!1,!0,r.requiredParameters,r.optionalParameters,i,u)}},function(e,t,r){"use strict";r.r(t),r.d(t,"DateTimeFormatExpression",(function(){return i}));var n=AppMagic.Schema,a=AppMagic.Data,o=AppMagic.Services.TypeSystem,i=function(){function e(e,t){this._format=e,this._valueExpr=t}return e.prototype.computeResultSchema=function(e){return AppMagic.Schema.createSchemaForSimple(n.TypeString)},e.prototype.isBehaviorOnly=function(e){return this._valueExpr.isBehaviorOnly(e)},e.prototype.evaluateAsync=function(e){var t=this;return this._valueExpr.evaluateAsync(e).then((function(e){if(!Core.Utility.isUndefined(e)){if(a.ErrorValue.isGatedError(e))return e;if(null===e)return null;var r=o.DateTimeBehavior.UserLocal;return t._format===o.DateTimeFormat.Iso8601ExtendedUtc&&o.DateTimeBehavior.NoTimeZone,o.DateTimeUtility.convertDateTimeStringFromDValue(r,e)}}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"JsonPointerExpression",(function(){return a}));var n=AppMagic.Data,a=function(){function e(e,t){this._valueExpr=e,this._pointer=t}return e.prototype.computeResultSchema=function(e,t){t+=AppMagic.Utility.parseJsonPointer(this._pointer).length;var r=this._valueExpr.computeResultSchema(e,t);return r=AppMagic.Schema.getSchemaFollowingDataJsonPointer(r,this._pointer)},e.prototype.isBehaviorOnly=function(e){return this._valueExpr.isBehaviorOnly(e)},e.prototype.evaluateAsync=function(e){var t=this;return this._valueExpr.evaluateAsync(e).then((function(e){if(!Core.Utility.isUndefined(e))return n.ErrorValue.isGatedError(e)?e:AppMagic.Utility.getJsonValueViaJsonPointer(e,t._pointer)}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"LiteralValueExpression",(function(){return n}));var n=function(){function e(e,t){this._dvalue=e,this._dtype=t}return e.prototype.computeResultSchema=function(e){return AppMagic.Schema.createSchemaForSimple(this._dtype)},e.prototype.isBehaviorOnly=function(e){return!1},e.prototype.evaluateAsync=function(e){return Promise.resolve(this._dvalue)},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ComposeAttendeesArrayExpression",(function(){return i}));var n=r(16),a=AppMagic.Schema,o=AppMagic.Data,i=function(){function e(e,t){this._emailsValueExpr=e,this._typeValueExpr=t}return e.prototype.computeResultSchema=function(e){var t=[a.createSchemaForSimple(a.TypeString,"Name"),a.createSchemaForSimple(a.TypeString,"Address")],r=[a.createSchemaForObjectFromPointer(t,"EmailAddress"),a.createSchemaForSimple(AppMagic.Schema.TypeString,"Type")];return a.createSchemaForArrayFromPointer(r)},e.prototype.isBehaviorOnly=function(e){return this._emailsValueExpr.isBehaviorOnly(e)||this._typeValueExpr.isBehaviorOnly(e)},e.prototype.evaluateAsync=function(e){var t,r,n=this,a=!1,i=null,s=[this._emailsValueExpr.evaluateAsync(e).then((function(e){Core.Utility.isUndefined(e)&&(e=null),o.ErrorValue.isGatedError(e)?(a=!0,null===i&&o.ErrorValue.isGatedError(e)&&(i=e)):t=e})),this._typeValueExpr.evaluateAsync(e).then((function(e){Core.Utility.isUndefined(e)&&(e=null),o.ErrorValue.isGatedError(e)?(a=!0,null===i&&o.ErrorValue.isGatedError(e)&&(i=e)):r=e}))];return Core.PromiseUtils.join(s).then((function(){return a?i:n.composeAttendeesFromEmails(t,r)}))},e.prototype.composeAttendeesFromEmails=function(e,t){if("string"!=typeof e)return e;if("string"!=typeof t)return t;var r=Object(n.parseEmailAddressesString)(e);return null===r?null:r.map((function(e){return{EmailAddress:e,Type:t}}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ComposeRecipientsArrayExpression",(function(){return i}));var n=r(16),a=AppMagic.Schema,o=AppMagic.Data,i=function(){function e(e){this._emailsValueExpr=e}return e.prototype.computeResultSchema=function(e){var t=[a.createSchemaForSimple(a.TypeString,"Name"),a.createSchemaForSimple(a.TypeString,"Address")],r=[a.createSchemaForObjectFromPointer(t,"EmailAddress")];return a.createSchemaForArrayFromPointer(r)},e.prototype.isBehaviorOnly=function(e){return this._emailsValueExpr.isBehaviorOnly(e)},e.prototype.evaluateAsync=function(e){var t=this;return this._emailsValueExpr.evaluateAsync(e).then((function(e){return Core.Utility.isUndefined(e)&&(e=null),o.ErrorValue.isGatedError(e)?e:t.composeRecipientsFromEmails(e)}))},e.prototype.composeRecipientsFromEmails=function(e){if("string"!=typeof e)return null;var t=Object(n.parseEmailAddressesString)(e);return null===t?null:t.map((function(e){return{EmailAddress:e}}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ParseEmailAddressesExpression",(function(){return i}));var n=r(16),a=AppMagic.Schema,o=AppMagic.Data,i=function(){function e(e){this._valueExpr=e}return e.prototype.computeResultSchema=function(e){var t=[a.createSchemaForSimple(a.TypeString,"Name"),a.createSchemaForSimple(a.TypeString,"Address")];return a.createSchemaForArrayFromPointer(t)},e.prototype.isBehaviorOnly=function(e){return this._valueExpr.isBehaviorOnly(e)},e.prototype.evaluateAsync=function(e){var t=this;return this._valueExpr.evaluateAsync(e).then((function(e){return Core.Utility.isUndefined(e)&&(e=null),o.ErrorValue.isGatedError(e)?e:t.parseEmailsString(e)}))},e.prototype.parseEmailsString=function(e){return"string"!=typeof e?null:Object(n.parseEmailAddressesString)(e)},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ParameterReferenceExpression",(function(){return n}));var n=function(){function e(e){this._parameterName=e}return e.prototype.computeResultSchema=function(e,t){return e.getParameter(this._parameterName).getSchema(t)},e.prototype.isBehaviorOnly=function(e){return!1},e.prototype.evaluateAsync=function(e){var t=e.getParameterDValue(this._parameterName);return Promise.resolve(t)},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"QuoteStringExpression",(function(){return o}));var n=r(0),a=AppMagic.Data,o=function(){function e(e,t,r){this._quoteChar=e,this._escapeStr=t,this._valueExpr=r}return e.prototype.computeResultSchema=function(e){return AppMagic.Schema.createSchemaForSimple(AppMagic.Schema.TypeString)},e.prototype.isBehaviorOnly=function(e){return this._valueExpr.isBehaviorOnly(e)},e.prototype.evaluateAsync=function(e){var t=this;return this._valueExpr.evaluateAsync(e).then((function(e){if(!Core.Utility.isUndefined(e))return a.ErrorValue.isGatedError(e)?e:t._quoteValue(e)}))},e.prototype._quoteValue=function(e){if(null===e)return null;var t=e.toString(),r=Object(n.escapeCharacters)(t,this._quoteChar+this._escapeStr,this._escapeStr);return this._quoteChar+r+this._quoteChar},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ServiceVariableReferenceExpression",(function(){return a}));var n=AppMagic.Schema,a=function(){function e(e){this._variableName=e}return e.prototype.computeResultSchema=function(e,t){var r=e.service.getVariable(this._variableName);return n.createSchemaForSimple(r.dtype)},e.prototype.isBehaviorOnly=function(e){return!1},e.prototype.evaluateAsync=function(e){var t=e.service.getVariableValue(this._variableName);return Promise.resolve(t)},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"StringFormatExpression",(function(){return o}));var n=r(0),a=AppMagic.Data,o=function(){function e(e,t){this._format=e,this._argumentExpressions=t}return e.prototype.computeResultSchema=function(e){return AppMagic.Schema.createSchemaForSimple(AppMagic.Schema.TypeString)},e.prototype.isBehaviorOnly=function(e){return this._argumentExpressions.some((function(t){return t.isBehaviorOnly(e)}))},e.prototype.evaluateAsync=function(e){var t=this,r=[],o=!1,i=null,s=this._argumentExpressions.map((function(t,n){return t.evaluateAsync(e).then((function(e){Core.Utility.isDefined(e)&&a.ErrorValue.isGatedError(e)&&!i&&(o=!0,i=e),r[n]=e}))}));return Core.PromiseUtils.join(s).then((function(){return o?i:Object(n.dotNetStringFormat_format_args)(t._format,r)}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"VariableReferenceExpression",(function(){return n}));var n=function(){function e(e){this._variableName=e}return e.prototype.computeResultSchema=function(e,t){return e.getVariable(this._variableName).valueExpression.computeResultSchema(e,t)},e.prototype.isBehaviorOnly=function(e){return e.getVariable(this._variableName).valueExpression.isBehaviorOnly(e)},e.prototype.evaluateAsync=function(e){var t=e.getVariableValue(this._variableName);return Promise.resolve(t)},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ConnectionAuthenticationProviderDefinitionDeserializer",(function(){return o}));var n=r(0),a=r(5),o=(AppMagic.Services.ServiceConfigDeserialization.IRConstants,function(){function e(){}return e.prototype.deserialize=function(e,t){var r=t.service.getVariable(a.ConnectionApiId);return new n.ConnectionAuthenticationProvider((function(){return r.value}),t.authenticationService)},e}())},function(e,t,r){"use strict";r.r(t),r.d(t,"BinaryDataResponseBodyDefinitionDeserializer",(function(){return a}));var n=AppMagic.Services.Rest,a=(AppMagic.Services.TypeSystem,function(){function e(e){this._parseContext=e}return e.prototype.parseResponseParamDefinition=function(e){Contracts.check(!1,"Not supported.")},e.prototype.parseResponseBodyValueDefinition=function(e){var t=AppMagic.Services.ServiceConfigDeserialization.TypesManagerDeserializer.parseTypedDefinitionMetadata(e,this._parseContext);return new n.ResponseBodyExtractor(n.ResponseValueType.BinaryData,t)},e.prototype.createResponseProcessor=function(e,t){return Contracts.check(0===Object.keys(t).length,"Parameters are not supported for BinaryData responses."),new n.ResponseTypeResponseProcessor("pabinary",e)},e}())},function(e,t,r){"use strict";r.r(t),r.d(t,"BodilessRequestDefinitionDeserializer",(function(){return n}));var n=function(e){function t(){return e.call(this,new AppMagic.Services.BodilessHttpRequestBuilder)||this}return __extends(t,e),t.prototype.parseBody=function(e){},t}(r(9).RequestDefinitionDeserializer)},function(e,t,r){"use strict";r.r(t),r.d(t,"FormUrlEncodedRequestDefinitionDeserializer",(function(){return o}));var n=r(9),a=r(2),o=function(e){function t(t){var r=e.call(this,new AppMagic.Services.FormUrlEncodedHttpRequestBuilder)||this;return r._requestContext=t,r}return __extends(t,e),t.prototype.parseBody=function(e){Object(a.parseFormUrlEncodedBodyParamDefinitionListing)(e.params,this._requestParams,this._requestContext)},t}(n.RequestDefinitionDeserializer)},function(e,t,r){"use strict";r.r(t),r.d(t,"JsonRequestDefinitionDeserializer",(function(){return o}));var n=r(9),a=r(10),o=function(e){function t(t){var r=e.call(this,new AppMagic.Services.JsonHttpRequestBuilder)||this;return r._typeSystemContext=t,r}return __extends(t,e),t.prototype.parseBody=function(e){this.parseJsonBodyParamDefinitionListing(e.params)},t.prototype.parseJsonBodyParamDefinitionListing=function(e){var t=this;e.forEach((function(e){var r=e.jsonpointer,n=Object(a.parseValueExpressionDefinition)(e.valueexpression),o=AppMagic.Services.ServiceConfigDeserialization.TypesManagerDeserializer.parseTypedDefinitionMetadata(e,t._typeSystemContext),i=new AppMagic.Services.JsonBodyRequestParam(r,o,n);t._requestParams.push(i)}))},t}(n.RequestDefinitionDeserializer)},function(e,t,r){"use strict";r.r(t),r.d(t,"JsonResponseBodyDefinitionDeserializer",(function(){return a}));AppMagic.Services.TypeSystem;var n=AppMagic.Services.Rest,a=function(){function e(e){this._parseContext=e}return e.prototype.parseResponseParamDefinition=function(e){var t=AppMagic.Services.ServiceConfigDeserialization.TypesManagerDeserializer.parseTypedDefinitionMetadata(e,this._parseContext);return new n.JsonResponseParam(e.jsonpointer,t)},e.prototype.parseResponseBodyValueDefinition=function(e){var t=AppMagic.Services.ServiceConfigDeserialization.TypesManagerDeserializer.parseTypedDefinitionMetadata(e,this._parseContext);return new n.ResponseBodyExtractor(n.ResponseValueType.Json,t)},e.prototype.createResponseProcessor=function(e,t){return new n.ResponseTypeResponseProcessor("json",e,t)},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"MultipartFormDataRequestDefinitionDeserializer",(function(){return i}));var n=r(22),a=r(9),o=r(2),i=function(e){function t(t){var r=this;return(r=e.call(this,new n.MultipartFormDataHttpRequestBuilder(t.multipartBoundaryGenerator))||this)._requestContext=t,r}return __extends(t,e),t.prototype.parseBody=function(e){Object(o.parseMultipartFormDataBodyParamDefinitionListing)(e.params,this._requestParams,this._requestContext)},t}(a.RequestDefinitionDeserializer)},function(e,t,r){"use strict";r.r(t),r.d(t,"XmlResponseBodyDefinitionDeserializer",(function(){return o}));var n=AppMagic.Services.Rest,a=AppMagic.Services.TypeSystem,o=function(){function e(e){this._parseContext=e}return e.prototype.parseResponseParamDefinition=function(e){var t=AppMagic.Services.ServiceConfigDeserialization.TypesManagerDeserializer.parseTypedDefinitionMetadata(e,this._parseContext),r=new a.InlinedTTypeRef(new a.DomNodeTType(t));return new n.XPathResponseParam(e.xpath,e.selectallnodes,r)},e.prototype.parseResponseBodyValueDefinition=function(e){var t=AppMagic.Services.ServiceConfigDeserialization.TypesManagerDeserializer.parseTypedDefinitionMetadata(e,this._parseContext);return new n.ResponseBodyExtractor(n.ResponseValueType.XmlAsJson,t)},e.prototype.createResponseProcessor=function(e,t){return Object.keys(t).length>0?new n.DocumentResponseProcessor(t):new n.XmlAsJsonResponseProcessor(e)},e}()},function(e,t,r){},function(e,t,r){},function(e,t,r){"use strict";r.r(t),r.d(t,"NeptuneService",(function(){return l}));var n,a=AppMagic.Runtime,o=AppMagic.Services;!function(e){e.AI="AI"}(n||(n={}));var i=new Core.Lazy((function(){return new Core.UrlTemplate("{+baseUrl}/v0.1-alpha/tenants/{tenantId}/CurrencyReports")})),s=new Core.Lazy((function(){return new Core.UrlTemplate("{+baseUrl}/v0.1-alpha/tenants/{tenantId}/allocationsByEnvironment/{environmentId}")})),c=new Core.Lazy((function(){return new Core.UrlTemplate("{+baseUrl}/v1.0/tenants/{tenantId}/Users/{oid}/Trials/{currencyType}")})),u=new Core.Lazy((function(){return new Core.UrlTemplate("{+baseUrl}/v1.0/tenants/{tenantId}/Users/{oid}/Trials")})),l=function(){function e(e,t){this._httpClient=e,this._neptuneAuthProvider=Core.Loader.ObjectFactory.instance.getSingleton(a.Client.ComponentKeys.ClientAuthenticationRuntime).azureAuthenticationManager.neptuneServiceProvider,this._resourceUrl=t}return e.prototype.getTenantCurrencyReports=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,n,a;return __generator(this,(function(s){switch(s.label){case 0:t=i.value.expandUrl({baseUrl:this._resourceUrl,tenantId:e}),r={method:o.HttpConstants.Method.GET,url:t.toString()},s.label=1;case 1:return s.trys.push([1,4,,5]),[4,this._neptuneAuthProvider.authenticator.authenticateRequestAsync(r)];case 2:return s.sent(),[4,this._httpClient.sendHttpJsonArrayResponseAsync(r)];case 3:return n=s.sent(),[2,n.map((function(e){return AppMagic.Services.CurrencyReport.safeCast(e)}))];case 4:throw a=s.sent(),Core.Log.errorEx("NeptuneService.getTenantCurrencyReports",{error:a}),a;case 5:return[2]}}))}))},e.prototype._getEnvironmentAllocations=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,a,i;return __generator(this,(function(c){switch(c.label){case 0:r=s.value.expandUrl({baseUrl:this._resourceUrl,tenantId:e,environmentId:t}),n={method:o.HttpConstants.Method.GET,url:r.toString()},c.label=1;case 1:return c.trys.push([1,4,,5]),[4,this._neptuneAuthProvider.authenticator.authenticateRequestAsync(n)];case 2:return c.sent(),[4,this._httpClient.sendHttpJsonResponseAsync(n)];case 3:return a=c.sent(),[2,AppMagic.Services.EnvironmentAllocationsResponse.safeCast(a)];case 4:if((i=c.sent())instanceof AppMagic.Services.ServiceError){if(404===i.response.status)return[2,null];throw Core.Log.errorEx("NeptuneService.getEnvironmentAllocations",{error:i}),i}return[3,5];case 5:return[2]}}))}))},e.prototype._getAIUserTrialStateAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,a,i,s;return __generator(this,(function(u){switch(u.label){case 0:if(!this._isAIBTrialsAvailable())return[2,null];r=c.value.expandUrl({baseUrl:this._resourceUrl,oid:e,tenantId:t,currencyType:n.AI}),a={method:o.HttpConstants.Method.GET,url:r.toString()},u.label=1;case 1:return u.trys.push([1,4,,5]),[4,this._neptuneAuthProvider.authenticator.authenticateRequestAsync(a)];case 2:return u.sent(),[4,this._httpClient.sendHttpJsonResponseAsync(a)];case 3:return i=u.sent(),[2,AppMagic.Services.TrialResponse.safeCast(i)];case 4:if((s=u.sent())instanceof AppMagic.Services.ServiceError){if(404===s.response.status)return[2,null];throw Core.Log.errorEx("NeptuneService.getAIUserTrialStateAsync",{error:s}),s}return[3,5];case 5:return[2]}}))}))},e.prototype._getUserTrial=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,a,o;return __generator(this,(function(i){switch(i.label){case 0:return[4,this._getAIUserTrialStateAsync(e,t)];case 1:return(r=i.sent())&&(o=r.trialCurrencyUnits.find((function(e){return e.currencyType===n.AI})),a={expirationDate:new Date(r.expiryDate),remainingCapacityRatio:null!=o?this._computeRemainingTrialCreditsRatio(o.trialUnits,o.trialConsumedUnits):1,trialCount:r.trialCount}),[2,a]}}))}))},e.prototype._hasEnvironmentCapacity=function(e,t){var r,a;return __awaiter(this,void 0,Promise,(function(){var o,i,s;return __generator(this,(function(c){switch(c.label){case 0:o=!1,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this._getEnvironmentAllocations(e,t)];case 2:return i=c.sent(),s=null!==(a=null===(r=null==i?void 0:i.currencyAllocations.find((function(e){return e.currencyType===n.AI})))||void 0===r?void 0:r.allocated)&&void 0!==a?a:0,o=s>0,[3,4];case 3:return c.sent(),o=!0,[3,4];case 4:return[2,o]}}))}))},e.prototype.getAIBuilderEntitlements=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var a,o,i,s,c,u,l;return __generator(this,(function(p){switch(p.label){case 0:return[4,Core.PromiseUtils.join([this._getUserTrial(e,t),this.getTenantCurrencyReports(t),this._hasEnvironmentCapacity(t,r)])];case 1:return a=p.sent(),o=a[0],i=a[1],s=a[2],c=!1,u=!1,(l=i.find((function(e){return e.currencyType===n.AI})))&&(c=l.purchased>0,u=c&&l.allocated<l.purchased),[2,{hasEnvironmentCapacity:s,userTrial:o,hasPurchasedCredits:c,hasUnallocatedCredits:u}]}}))}))},e.prototype.tryStartAIUserTrialAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,a,i,s;return __generator(this,(function(c){switch(c.label){case 0:if(!this._isAIBTrialsAvailable())return[2,!1];r=u.value.expandUrl({baseUrl:this._resourceUrl,oid:e,tenantId:t}),(a=HashTableUtility.create())[o.HttpConstants.HeaderName.ContentType]=o.HttpConstants.MediaType.ApplicationJson,i={method:o.HttpConstants.Method.POST,url:r.toString(),headers:a,bodyData:JSON.stringify({trialType:n.AI})},c.label=1;case 1:return c.trys.push([1,4,,5]),[4,this._neptuneAuthProvider.authenticator.authenticateRequestAsync(i)];case 2:return c.sent(),[4,this._httpClient.sendHttpAsync(i)];case 3:return[2,200===c.sent().status];case 4:throw s=c.sent(),Core.Log.errorEx("NeptuneService.tryStartAIUserTrialAsync",{error:s}),s;case 5:return[2]}}))}))},e.prototype._isAIBTrialsAvailable=function(){var e=AppMagic.Services.Azure.Region.getCurrentRegion().name;return"gcchigh"!==e&&"gccmoderate"!==e},e.prototype._computeRemainingTrialCreditsRatio=function(e,t){if(t>=e)return 0;if(0===t&&e>0)return 1;var r=e/1e3;return(r-Math.floor(t/1e3))/r},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"CdsSolutionService",(function(){return o}));var n=AppMagic.Runtime,a=AppMagic.Services,o=function(){function e(e){this._httpClient=e,this._authManager=Core.Loader.ObjectFactory.instance.getSingleton(n.Client.ComponentKeys.ClientAuthenticationRuntime).azureAuthenticationManager}return e.prototype.tryGetSolutionAsync=function(e,t,r){var o;return __awaiter(this,void 0,Promise,(function(){var i,s,c,u,l,p,d;return __generator(this,(function(h){switch(h.label){case 0:return(null===(o=null==e?void 0:e.properties)||void 0===o?void 0:o.linkedEnvironmentMetadata)?(i=e.properties.linkedEnvironmentMetadata.instanceUrl,s=r?"?".concat(r):"",c=new Core.UrlTemplate("{+baseUrl}/api/data{/version}/solutions({solutionid})"+s),u=c.expandUrl({baseUrl:i,version:AppMagic.PowerApps.Constants.CdsDefaultWebApiVersion,solutionid:t}),l=this._authManager.getProviderForResourceUrl(i,!0),p={method:a.HttpConstants.Method.GET,url:u.toString()},l.authenticator.authenticateRequestAsync(p),[4,this._httpClient.sendHttpJsonResponseAsync(p)]):(Core.Log.warningEx("CdsSolutionService.tryGetSolutionAsync","Could not find solution with undefined environment.properties.linkedEnvironmentMetadata"),[2,null]);case 1:return d=h.sent(),[2,n.Client.SolutionInfo.safeCast(d)]}}))}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"CdpRowsResponseHelper",(function(){return s}));var n=r(0),a=r(1),o=r(7),i=r(6),s=(AppMagic.Services,function(){function e(e,t,r,n,a){var o=this;this._connectorTypeName=e,this._tableMetadata=t,this._cdcManager=r,this._mediaRuntime=n,this._queryStringProvider=a,this._pkColumnNames=[],this._tableName=this._tableMetadata.name,this._tableMetadata.keyColumns.forEach((function(e){o._pkColumnNames.push(e.name)}))}return Object.defineProperty(e.prototype,"dataSourceName",{get:function(){return this._cdcManager.dataSourceName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tableName",{get:function(){return this._tableName},enumerable:!1,configurable:!0}),e.prototype.tryGetRowsResponseAndQuery=function(e,t){if(1===this._pkColumnNames.length){var r=this._pkColumnNames[0],a=this._createCachableQuery(r,e),o=new n.TabularCachableQuery(a),i=this._getRowsResponse(a,t);if(i)return{rowsResponse:i,cdpCachableQuery:o};Core.Telemetry.Log.trackErrorEvent("CdpRowsResponseHelper.tryGetRowsResponse.Error",{message:"We couldn't parse the http response into a valid row.",status:t.status,responseType:t.responseType,response:t.response,responseText:t.responseText})}else Core.Telemetry.Log.trackErrorEvent("CdpRowsResponseHelper.tryGetRowsResponse.Error",{message:"The table doesn't have exactly one primary key. This is not supported.",tableName:this._tableName,primaryKeyColumnNames:this._pkColumnNames,dataSourceName:this._cdcManager.dataSourceName});return null},e.prototype._getRowsResponse=function(e,t){t.response.value||(t.response={value:[t.response]});var r=Object(a.processHttpResponse)(t,e.responseParams),n=Object(i.safeCast)(r);return n?{results:Object(o.processTable)(n.items,this._tableMetadata.name,this._cdcManager,this._mediaRuntime,e.queryOptions),nextLink:n.nextLink}:null},e.prototype._createCachableQuery=function(e,t){var r=new n.TableQueryOptions;return r.filter=new n.Filter(n.FilterOperator.Equals,new n.PropertyOperand(e),new n.ValueOperand(t,AppMagic.Schema.TypeNumber)),new n.CdpQueryDefinition(new n.ConnectedDataTypesManager(this._cdcManager),this.dataSourceName,this._connectorTypeName,this._queryStringProvider,r)},e}())},function(e,t,r){"use strict";r.r(t),r.d(t,"RestResponseHeaderParamValueExpression",(function(){return o}));var n=r(15),a=AppMagic.Services.ServiceUtility,o=function(e){function t(t,r){var n=e.call(this,r)||this;return n._name=t,n}return __extends(t,e),t.prototype.evaluate=function(e){return a.createSuccessfulDataflowResult(e.headerParams[this._name])},t}(n.RestResponseValueExpressionBase)},function(e,t,r){"use strict";function n(e){var t={typesMgr:new AppMagic.Services.TypeSystem.TypesManager,mediaRuntime:null,binaryResolver:null};return{entityName:e.entityName,hostTypeName:e.hostTypeName,behaviors:e.behaviors||[],properties:e.properties?HashTableUtility.map(e.properties,(function(e){return{isOutput:!!e.isOutput,ttype:AppMagic.Services.ServiceConfigDeserialization.TypesManagerDeserializer.parseTypeDefinition(e.type,t)}}),!1):HashTableUtility.create()}}r.r(t),r.d(t,"createHostControlContext",(function(){return n}))},function(e,t,r){"use strict";r.r(t),r.d(t,"TabularDataService",(function(){return c}));var n=r(0),a=r(5),o=r(2),i=r(18),s=AppMagic.Services.ServiceVariable,c=function(){function e(e,t,r,c,u,l,p,d,h,m,y,f,v,g,C){var _=this;this._getRuntimeUrlAsync=r,this._serviceNamespace=e,this._id=t,this._isValid=!0,this._typesMgr=c,this._authenticationProviders=HashTableUtility.create(),this._authenticationProviders[e]=u,this._functions=HashTableUtility.create(),this._serviceUrlVariables=HashTableUtility.create(),this._serviceUrlVariables[a.ApiRuntimeUrl]=new s(a.ApiRuntimeUrl,AppMagic.Schema.TypeHyperlink),this._serviceHost=y,this._promiseCollection=new n.PromiseCollection,this._executionContext=new i.ServiceExecutionContext(this),this._connectedMetadata=null;var b={serviceNamespace:e,service:this,appHttpClient:p,guidGenerator:h,multipartBoundaryGenerator:m,typesMgr:this.typesManager,mediaRuntime:f,binaryResolver:v,authenticationService:g,restHostClient:d,restXhrClient:d};l.forEach((function(e){var t=Object(o.parseServiceFunctionDefinition)(e,b);_.functions[t.name]=t}))}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serviceNamespace",{get:function(){return this._serviceNamespace},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typesManager",{get:function(){return this._typesMgr},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"functions",{get:function(){return this._functions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authenticationProviders",{get:function(){return this._authenticationProviders},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serviceHost",{get:function(){return this._serviceHost},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"executionContext",{get:function(){return this._executionContext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"variableNames",{get:function(){return Object.keys(this._serviceUrlVariables)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectedMetadata",{get:function(){return this._connectedMetadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"promiseCollection",{get:function(){return this._promiseCollection},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isValid",{get:function(){return this._isValid},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDisposed",{get:function(){return null===this._promiseCollection},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this._error},set:function(e){this._error=e},enumerable:!1,configurable:!0}),e.prototype.addDynamicResponse=function(e,t,r,n){throw new Error("Not implemented")},e.prototype.removeDynamicResponse=function(e,t){throw new Error("Not implemented")},e.prototype.getVariable=function(e){return this._serviceUrlVariables[e]},e.prototype.addJob=function(e,t){return this._promiseCollection.addJob(e,t)},e.prototype.loadAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return[4,this._getRuntimeUrlAsync()];case 1:return(e=t.sent())?(Core.Telemetry.Log.trackActivityEvent("TabularDataService.loadAsync",{message:"The runtime url was successfully retrieved.",serviceNamespace:this.serviceNamespace,runtimeUrl:e}),this.getVariable(a.ApiRuntimeUrl).value=e,[2]):(Core.Telemetry.Log.trackActivityEvent("TabularDataService.loadAsync",{message:"Unable to fetch runtime url.",serviceNamespace:this.serviceNamespace}),this._isValid=!1,[2])}}))}))},e.prototype.dispose=function(){HashTableUtility.forEach(this._authenticationProviders,(function(e){return e.dispose()})),this._authenticationProviders=null,this._promiseCollection.cancelAll(),this._promiseCollection=null,HashTableUtility.forEach(this._functions,(function(e){return e.dispose()})),this._functions=null},e}()},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t){!function(){e.exports=function(){return this?this:window}()["@pa-client/core-globalization"]}()},function(e,t,r){r(94),e.exports=r(93)},function(e,t,r){"use strict";r.r(t);var n=r(31);r.d(t,"BinaryBodyHttpRequestBuilder",(function(){return n.BinaryBodyHttpRequestBuilder}));var a=r(37);r.d(t,"BinaryBodyRequestParam",(function(){return a.BinaryBodyRequestParam}));var o=r(81);r.d(t,"CdsSolutionService",(function(){return o.CdsSolutionService}));var i=r(23);r.d(t,"containsViewFilter",(function(){return i.containsViewFilter})),r.d(t,"preProcessViewResponse",(function(){return i.preProcessViewResponse}));var s=r(39);r.d(t,"CompositeServiceFunction",(function(){return s.CompositeServiceFunction}));var c=r(40);r.d(t,"CdpConnector",(function(){return c.CdpConnector}));var u=r(42);r.d(t,"CdpConnectorManager",(function(){return u.CdpConnectorManager}));var l=r(32);r.d(t,"CdpGetRowsFunction",(function(){return l.CdpGetRowsFunction})),r.d(t,"ICdpGetRowsRequest",(function(){return l.ICdpGetRowsRequest}));var p=r(82);r.d(t,"CdpRowsResponseHelper",(function(){return p.CdpRowsResponseHelper}));var d=r(7);r.d(t,"processAttachment",(function(){return d.processAttachment})),r.d(t,"processAttachments",(function(){return d.processAttachments})),r.d(t,"processBlobsAndAttachments",(function(){return d.processBlobsAndAttachments})),r.d(t,"processExpandForDataRecord",(function(){return d.processExpandForDataRecord})),r.d(t,"processRow",(function(){return d.processRow})),r.d(t,"processTable",(function(){return d.processTable}));var h=r(86);r.d(t,"IPaginatedItemsFunctionResult",(function(){return h.IPaginatedItemsFunctionResult}));var m=r(6);r.d(t,"createEmpty",(function(){return m.createEmpty})),r.d(t,"isValid",(function(){return m.isValid})),r.d(t,"safeCast",(function(){return m.safeCast}));var y=r(21);r.d(t,"IReferencedBlobInfo",(function(){return y.IReferencedBlobInfo})),r.d(t,"IUploadOperation",(function(){return y.IUploadOperation})),r.d(t,"ReferencedBlobProcessor",(function(){return y.ReferencedBlobProcessor}));var f=r(41);r.d(t,"TableMetadata",(function(){return f.TableMetadata}));var v=r(12);r.d(t,"createCdsDataSetConnector",(function(){return v.createCdsDataSetConnector})),r.d(t,"createConnectedDataConnector",(function(){return v.createConnectedDataConnector})),r.d(t,"createDataSourceForExtensionDataComponent",(function(){return v.createDataSourceForExtensionDataComponent})),r.d(t,"createDataSourceFromCdsTableMetadata",(function(){return v.createDataSourceFromCdsTableMetadata})),r.d(t,"parseDataSourceDefinition",(function(){return v.parseDataSourceDefinition}));var g=r(59);r.d(t,"DateTimeFormatExpression",(function(){return g.DateTimeFormatExpression}));var C=r(3);r.d(t,"DocumentBody",(function(){return C.DocumentBody})),r.d(t,"FileName",(function(){return C.FileName})),r.d(t,"Id",(function(){return C.Id})),r.d(t,"MimeType",(function(){return C.MimeType})),r.d(t,"ObjectIdValue",(function(){return C.ObjectIdValue})),r.d(t,"Subject",(function(){return C.Subject})),r.d(t,"TableName",(function(){return C.TableName}));var _=r(8);r.d(t,"ICdsAttachmentResponse",(function(){return _.ICdsAttachmentResponse})),r.d(t,"ICdsDownloadAttachmentResponse",(function(){return _.ICdsDownloadAttachmentResponse})),r.d(t,"ICdsListAttachmentsResponse",(function(){return _.ICdsListAttachmentsResponse})),r.d(t,"isValidAttachmentResponse",(function(){return _.isValidAttachmentResponse})),r.d(t,"isValidDownloadAttachmentResponse",(function(){return _.isValidDownloadAttachmentResponse})),r.d(t,"isValidListAttachmentsResponse",(function(){return _.isValidListAttachmentsResponse})),r.d(t,"safeCastAttachmentResponse",(function(){return _.safeCastAttachmentResponse})),r.d(t,"safeCastDownloadAttachmentResponse",(function(){return _.safeCastDownloadAttachmentResponse})),r.d(t,"safeCastListAttachmentResponse",(function(){return _.safeCastListAttachmentResponse}));var b=r(44);r.d(t,"CdsAttachmentsHelper",(function(){return b.CdsAttachmentsHelper}));var A=r(35);r.d(t,"CdsConnector",(function(){return A.CdsConnector})),r.d(t,"ICdsConnectorConfig",(function(){return A.ICdsConnectorConfig}));var S=r(43);r.d(t,"CdsDataSetConnector",(function(){return S.CdsDataSetConnector}));var w=r(4);r.d(t,"processAndThrowTabularError",(function(){return w.processAndThrowTabularError})),r.d(t,"unwrapCdsServerErrorResponse",(function(){return w.unwrapCdsServerErrorResponse}));var R=r(45);r.d(t,"CdsFileHelper",(function(){return R.CdsFileHelper}));var D=r(46);r.d(t,"DataComponentConnector",(function(){return D.DataComponentConnector}));var P=r(34);r.d(t,"FunctionCallExpression",(function(){return P.FunctionCallExpression})),r.d(t,"IFunctionCallExpressionArgument",(function(){return P.IFunctionCallExpressionArgument}));var T=r(24);r.d(t,"FunctionExecutionContext",(function(){return T.FunctionExecutionContext}));var E=r(87);r.d(t,"IRestResponseValueExpression",(function(){return E.IRestResponseValueExpression}));var M=r(88);r.d(t,"IRestServiceFunctionResultForm",(function(){return M.IRestServiceFunctionResultForm}));var N=r(14);r.d(t,"ImportedService",(function(){return N.ImportedService}));var x=r(78);r.d(t,"IMultipartBoundaryGenerator",(function(){return x.IMultipartBoundaryGenerator})),r.d(t,"IMultipartFormDataPart",(function(){return x.IMultipartFormDataPart})),r.d(t,"MultipartBodyDatum",(function(){return x.MultipartBodyDatum}));var U=r(60);r.d(t,"JsonPointerExpression",(function(){return U.JsonPointerExpression}));var O=r(61);r.d(t,"LiteralValueExpression",(function(){return O.LiteralValueExpression}));var B=r(28);r.d(t,"DefaultInstance",(function(){return B.a})),r.d(t,"MultipartBoundaryGenerator",(function(){return B.b}));var I=r(53);r.d(t,"MultipartFormDataBinaryPart",(function(){return I.MultipartFormDataBinaryPart}));var F=r(52);r.d(t,"MultipartFormDataBodyBinaryRequestParam",(function(){return F.MultipartFormDataBodyBinaryRequestParam}));var H=r(54);r.d(t,"MultipartFormDataBodyTextRequestParam",(function(){return H.MultipartFormDataBodyTextRequestParam}));var j=r(22);r.d(t,"MultipartFormDataHttpRequestBuilder",(function(){return j.MultipartFormDataHttpRequestBuilder}));var q=r(55);r.d(t,"MultipartFormDataTextPart",(function(){return q.MultipartFormDataTextPart}));var V=r(80);r.d(t,"IAIBuilderEntitlements",(function(){return V.IAIBuilderEntitlements})),r.d(t,"NeptuneService",(function(){return V.NeptuneService}));var L=r(62);r.d(t,"ComposeAttendeesArrayExpression",(function(){return L.ComposeAttendeesArrayExpression}));var z=r(63);r.d(t,"ComposeRecipientsArrayExpression",(function(){return z.ComposeRecipientsArrayExpression}));var k=r(79);r.d(t,"IAttendee",(function(){return k.IAttendee})),r.d(t,"IEmailAddress",(function(){return k.IEmailAddress})),r.d(t,"IRecipient",(function(){return k.IRecipient}));var G=r(16);r.d(t,"parseEmailAddressesString",(function(){return G.parseEmailAddressesString}));var K=r(64);r.d(t,"ParseEmailAddressesExpression",(function(){return K.ParseEmailAddressesExpression}));var J=r(25);r.d(t,"ODataScalarUtility",(function(){return J.ODataScalarUtility}));var Q=r(65);r.d(t,"ParameterReferenceExpression",(function(){return Q.ParameterReferenceExpression}));var W=r(56);r.d(t,"PollingServiceFunction",(function(){return W.PollingServiceFunction}));var X=r(57);r.d(t,"PollingServiceFunctionInvocation",(function(){return X.PollingServiceFunctionInvocation}));var $=r(33);r.d(t,"IODataConnectorConfig",(function(){return $.IODataConnectorConfig})),r.d(t,"ODataConnector",(function(){return $.ODataConnector}));var Z=r(26);r.d(t,"createGetRowRequestProcessor",(function(){return Z.createGetRowRequestProcessor})),r.d(t,"createListRowsResponseProcessor",(function(){return Z.createListRowsResponseProcessor}));var Y=r(66);r.d(t,"QuoteStringExpression",(function(){return Y.QuoteStringExpression}));var ee=r(36);r.d(t,"RestResponseBodyParamValueExpression",(function(){return ee.RestResponseBodyParamValueExpression}));var te=r(47);r.d(t,"RestResponseBodyValueExpression",(function(){return te.RestResponseBodyValueExpression}));var re=r(27);r.d(t,"IRestResponseComposeObjectValueExpressionProperty",(function(){return re.IRestResponseComposeObjectValueExpressionProperty})),r.d(t,"RestResponseComposeObjectValueExpression",(function(){return re.RestResponseComposeObjectValueExpression}));var ne=r(83);r.d(t,"RestResponseHeaderParamValueExpression",(function(){return ne.RestResponseHeaderParamValueExpression}));var ae=r(48);r.d(t,"RestResponseLiteralValueExpression",(function(){return ae.RestResponseLiteralValueExpression}));var oe=r(15);r.d(t,"RestResponseValueExpressionBase",(function(){return oe.RestResponseValueExpressionBase}));var ie=r(50);r.d(t,"RestServiceCache",(function(){return ie.RestServiceCache}));var se=r(49);r.d(t,"RestServiceFunction",(function(){return se.RestServiceFunction}));var ce=r(20);r.d(t,"RestServiceFunctionResultForm",(function(){return ce.RestServiceFunctionResultForm}));var ue=r(84);r.d(t,"createHostControlContext",(function(){return ue.createHostControlContext}));var le=r(89);r.d(t,"IAuthenticationProviderDeserializer",(function(){return le.IAuthenticationProviderDeserializer}));var pe=r(51);r.d(t,"BinaryBodyRequestDefinitionDeserializer",(function(){return pe.BinaryBodyRequestDefinitionDeserializer}));var de=r(71);r.d(t,"BinaryDataResponseBodyDefinitionDeserializer",(function(){return de.BinaryDataResponseBodyDefinitionDeserializer}));var he=r(72);r.d(t,"BodilessRequestDefinitionDeserializer",(function(){return he.BodilessRequestDefinitionDeserializer}));var me=r(58);r.d(t,"AppMagicServicesServiceConfigDeserializationCompositeFunctionDefinitionDeserializer_parseFunctionDefinition",(function(){return me.parseFunctionDefinition}));var ye=r(5);r.d(t,"ApiRuntimeUrl",(function(){return ye.ApiRuntimeUrl})),r.d(t,"ConnectionApiId",(function(){return ye.ConnectionApiId})),r.d(t,"ConnectionName",(function(){return ye.ConnectionName})),r.d(t,"SqlDatabaseName",(function(){return ye.SqlDatabaseName})),r.d(t,"SqlServerName",(function(){return ye.SqlServerName}));var fe=r(70);r.d(t,"ConnectionAuthenticationProviderDefinitionDeserializer",(function(){return fe.ConnectionAuthenticationProviderDefinitionDeserializer}));var ve=r(73);r.d(t,"FormUrlEncodedRequestDefinitionDeserializer",(function(){return ve.FormUrlEncodedRequestDefinitionDeserializer}));var ge=r(90);r.d(t,"IResponseBodyDefinitionDeserializer",(function(){return ge.IResponseBodyDefinitionDeserializer}));var Ce=r(30);r.d(t,"IAuthenticationDeserializationContext",(function(){return Ce.IAuthenticationDeserializationContext})),r.d(t,"IRequestDeserializationContext",(function(){return Ce.IRequestDeserializationContext})),r.d(t,"IRestServiceDeserializationContext",(function(){return Ce.IRestServiceDeserializationContext})),r.d(t,"IServiceDeserializationContext",(function(){return Ce.IServiceDeserializationContext})),r.d(t,"IServiceDeserializationContextBase",(function(){return Ce.IServiceDeserializationContextBase}));var _e=r(74);r.d(t,"JsonRequestDefinitionDeserializer",(function(){return _e.JsonRequestDefinitionDeserializer}));var be=r(75);r.d(t,"JsonResponseBodyDefinitionDeserializer",(function(){return be.JsonResponseBodyDefinitionDeserializer}));var Ae=r(76);r.d(t,"MultipartFormDataRequestDefinitionDeserializer",(function(){return Ae.MultipartFormDataRequestDefinitionDeserializer}));var Se=r(9);r.d(t,"RequestDefinitionDeserializer",(function(){return Se.RequestDefinitionDeserializer}));var we=r(17);r.d(t,"AppMagicServicesServiceConfigDeserializationRestFunctionDefinitionDeserializer_parseFunctionDefinition",(function(){return we.parseFunctionDefinition})),r.d(t,"parseFunctionResultDefinition",(function(){return we.parseFunctionResultDefinition}));var Re=r(2);r.d(t,"IFunctionParameters",(function(){return Re.IFunctionParameters})),r.d(t,"getDocTitleOrDefault",(function(){return Re.getDocTitleOrDefault})),r.d(t,"implyDTypeFromJsonValue",(function(){return Re.implyDTypeFromJsonValue})),r.d(t,"parseAuthenticationProviderDefinition",(function(){return Re.parseAuthenticationProviderDefinition})),r.d(t,"parseFormUrlEncodedBodyParamDefinitionListing",(function(){return Re.parseFormUrlEncodedBodyParamDefinitionListing})),r.d(t,"parseFunctionParameters",(function(){return Re.parseFunctionParameters})),r.d(t,"parseHeaderParamDefinitionListing",(function(){return Re.parseHeaderParamDefinitionListing})),r.d(t,"parseMultipartFormDataBodyParamDefinitionListing",(function(){return Re.parseMultipartFormDataBodyParamDefinitionListing})),r.d(t,"parseParamValueStringifier",(function(){return Re.parseParamValueStringifier})),r.d(t,"parseQueryParamDefinitionListing",(function(){return Re.parseQueryParamDefinitionListing})),r.d(t,"parseResourceDefinition",(function(){return Re.parseResourceDefinition})),r.d(t,"parseServiceConfigDefinition",(function(){return Re.parseServiceConfigDefinition})),r.d(t,"parseServiceFunctionDefinition",(function(){return Re.parseServiceFunctionDefinition})),r.d(t,"parseServiceVariableDefinition",(function(){return Re.parseServiceVariableDefinition}));var De=r(10);r.d(t,"parseValueExpressionDefinition",(function(){return De.parseValueExpressionDefinition}));var Pe=r(77);r.d(t,"XmlResponseBodyDefinitionDeserializer",(function(){return Pe.XmlResponseBodyDefinitionDeserializer}));var Te=r(18);r.d(t,"IServiceForServiceExecutionContext",(function(){return Te.IServiceForServiceExecutionContext})),r.d(t,"ServiceExecutionContext",(function(){return Te.ServiceExecutionContext}));var Ee=r(13);r.d(t,"ServiceFunctionBase",(function(){return Ee.ServiceFunctionBase}));var Me=r(11);r.d(t,"DownloadRequest",(function(){return Me.a})),r.d(t,"ServiceFunctionInvocation",(function(){return Me.b}));var Ne=r(19);r.d(t,"Request",(function(){return Ne.a})),r.d(t,"ServiceFunctionInvocationBase",(function(){return Ne.b}));var xe=r(67);r.d(t,"ServiceVariableReferenceExpression",(function(){return xe.ServiceVariableReferenceExpression}));var Ue=r(68);r.d(t,"StringFormatExpression",(function(){return Ue.StringFormatExpression}));var Oe=r(1);r.d(t,"GetMoreRowsFunc",(function(){return Oe.GetMoreRowsFunc})),r.d(t,"ITabularConnectorTelemetryBaseData",(function(){return Oe.ITabularConnectorTelemetryBaseData})),r.d(t,"addColumnParameter",(function(){return Oe.addColumnParameter})),r.d(t,"addPatchColumnParameter",(function(){return Oe.addPatchColumnParameter})),r.d(t,"createEmptyGetRowsResult",(function(){return Oe.createEmptyGetRowsResult})),r.d(t,"ensureKeyIfReadOnlyTable",(function(){return Oe.ensureKeyIfReadOnlyTable})),r.d(t,"followGetRowsNextLinksAsync",(function(){return Oe.followGetRowsNextLinksAsync})),r.d(t,"getDataValue",(function(){return Oe.getDataValue})),r.d(t,"getRemainingRowsIfNeededAsync",(function(){return Oe.getRemainingRowsIfNeededAsync})),r.d(t,"hadEnoughLeftovers",(function(){return Oe.hadEnoughLeftovers})),r.d(t,"logError",(function(){return Oe.logError})),r.d(t,"logWarning",(function(){return Oe.logWarning})),r.d(t,"processHttpResponse",(function(){return Oe.processHttpResponse})),r.d(t,"returnLeftovers",(function(){return Oe.returnLeftovers})),r.d(t,"throwTabularErrorFromServerError",(function(){return Oe.throwTabularErrorFromServerError})),r.d(t,"validateServerResult",(function(){return Oe.validateServerResult}));var Be=r(85);r.d(t,"TabularDataService",(function(){return Be.TabularDataService}));var Ie=r(69);r.d(t,"VariableReferenceExpression",(function(){return Ie.VariableReferenceExpression}));var Fe=r(38);r.d(t,"ClientDataProcessingService",(function(){return Fe.ClientDataProcessingService}))},function(e,t,r){"use strict";r.r(t);var n=r(31);Core.exportToNamespace(["AppMagic","Services"],n);var a=r(37);Core.exportToNamespace(["AppMagic","Services"],a);var o=r(81);Core.exportToNamespace(["AppMagic","Services"],o);var i=r(23);Core.exportToNamespace(["AppMagic","Services","CdsViewPreProcessor"],i);var s=r(38);Core.exportToNamespace(["AppMagic","Services","ClientDataProcessingService"],s);var c=r(39);Core.exportToNamespace(["AppMagic","Services"],c);var u=r(40);Core.exportToNamespace(["AppMagic","Services"],u);var l=r(42);Core.exportToNamespace(["AppMagic","Services"],l);var p=r(32);Core.exportToNamespace(["AppMagic","Services"],p);var d=r(82);Core.exportToNamespace(["AppMagic","Services"],d);var h=r(7);Core.exportToNamespace(["AppMagic","Services","ConnectedDataProcessor"],h);r(86);var m=r(6);Core.exportToNamespace(["AppMagic","Services","PaginatedItemsFunctionResult"],m);var y=r(21);Core.exportToNamespace(["AppMagic","Services"],y);var f=r(41);Core.exportToNamespace(["AppMagic","Services","ServicePaths"],f);var v=r(12);Core.exportToNamespace(["AppMagic","Data","ConnectedDataDeserialization"],v);var g=r(59);Core.exportToNamespace(["AppMagic","Services"],g);var C=r(3);Core.exportToNamespace(["AppMagic","Services","DirectConnector","AnnotationConstants"],C);var _=r(8);Core.exportToNamespace(["AppMagic","Services","DirectConnector","CdsAttachments"],_);var b=r(44);Core.exportToNamespace(["AppMagic","Services","DirectConnector"],b);var A=r(35);Core.exportToNamespace(["AppMagic","Services","DirectConnector"],A);var S=r(43);Core.exportToNamespace(["AppMagic","Services","DirectConnector","CdsDataSetConnector"],S);var w=r(4);Core.exportToNamespace(["AppMagic","Services","DirectConnector","CdsErrorProcessorUtilities"],w);var R=r(45);Core.exportToNamespace(["AppMagic","Services","DirectConnector"],R);var D=r(46);Core.exportToNamespace(["AppMagic","Services","DirectConnector"],D);var P=r(34);Core.exportToNamespace(["AppMagic","Services"],P);var T=r(24);Core.exportToNamespace(["AppMagic","Services"],T);var E=r(14);Core.exportToNamespace(["AppMagic","Services"],E);r(78),r(87),r(88);var M=r(60);Core.exportToNamespace(["AppMagic","Services"],M);var N=r(61);Core.exportToNamespace(["AppMagic","Services"],N);var x=r(28);Core.exportToNamespace(["AppMagic","Services"],{MultipartBoundaryGenerator:x.b}),Core.exportToNamespace(["AppMagic","Services","MultipartBoundaryGenerator"],{DefaultInstance:x.a});var U=r(53);Core.exportToNamespace(["AppMagic","Services"],U);var O=r(52);Core.exportToNamespace(["AppMagic","Services"],O);var B=r(54);Core.exportToNamespace(["AppMagic","Services"],B);var I=r(22);Core.exportToNamespace(["AppMagic","Services"],I);var F=r(55);Core.exportToNamespace(["AppMagic","Services"],F);var H=r(80);Core.exportToNamespace(["AppMagic","Services"],H);var j=r(62);Core.exportToNamespace(["AppMagic","Services","O365"],j);var q=r(63);Core.exportToNamespace(["AppMagic","Services","O365"],q);r(79);var V=r(16);Core.exportToNamespace(["AppMagic","Services","O365","O365Utility"],V);var L=r(64);Core.exportToNamespace(["AppMagic","Services","O365"],L);var z=r(25);Core.exportToNamespace(["AppMagic","Services"],z);var k=r(65);Core.exportToNamespace(["AppMagic","Services"],k);var G=r(56);Core.exportToNamespace(["AppMagic","Services"],G);var K=r(57);Core.exportToNamespace(["AppMagic","Services"],K);var J=r(33);Core.exportToNamespace(["AppMagic","Services","ProtocolBasedConnector"],J);var Q=r(26);Core.exportToNamespace(["AppMagic","Services","ProtocolBasedConnector","ODataProcessorTools"],Q);var W=r(66);Core.exportToNamespace(["AppMagic","Services"],W);var X=r(36);Core.exportToNamespace(["AppMagic","Services"],X);var $=r(47);Core.exportToNamespace(["AppMagic","Services"],$);var Z=r(27);Core.exportToNamespace(["AppMagic","Services"],Z);var Y=r(83);Core.exportToNamespace(["AppMagic","Services"],Y);var ee=r(48);Core.exportToNamespace(["AppMagic","Services"],ee);var te=r(15);Core.exportToNamespace(["AppMagic","Services"],te);var re=r(50);Core.exportToNamespace(["AppMagic","Services"],re);var ne=r(49);Core.exportToNamespace(["AppMagic","Services"],ne);var ae=r(20);Core.exportToNamespace(["AppMagic","Services"],ae);var oe=r(84);Core.exportToNamespace(["AppMagic","Runtime","App","Deserialization"],oe);r(89);var ie=r(51);Core.exportToNamespace(["AppMagic","Services","ServiceConfigDeserialization"],ie);var se=r(71);Core.exportToNamespace(["AppMagic","Services","ServiceConfigDeserialization"],se);var ce=r(72);Core.exportToNamespace(["AppMagic","Services","ServiceConfigDeserialization"],ce);var ue=r(58);Core.exportToNamespace(["AppMagic","Services","ServiceConfigDeserialization","CompositeFunctionDefinitionDeserializer"],ue);var le=r(5);Core.exportToNamespace(["AppMagic","Services","ServiceConfigDeserialization","ConnectedServices","ServiceVariableName"],le);var pe=r(70);Core.exportToNamespace(["AppMagic","Services","ServiceConfigDeserialization"],pe);var de=r(73);Core.exportToNamespace(["AppMagic","Services","ServiceConfigDeserialization"],de);r(90),r(30);var he=r(74);Core.exportToNamespace(["AppMagic","Services","ServiceConfigDeserialization"],he);var me=r(75);Core.exportToNamespace(["AppMagic","Services","ServiceConfigDeserialization"],me);var ye=r(76);Core.exportToNamespace(["AppMagic","Services","ServiceConfigDeserialization"],ye);var fe=r(9);Core.exportToNamespace(["AppMagic","Services","ServiceConfigDeserialization"],fe);var ve=r(17);Core.exportToNamespace(["AppMagic","Services","ServiceConfigDeserialization","RestFunctionDefinitionDeserializer"],ve);var ge=r(2);Core.exportToNamespace(["AppMagic","Services","ServiceConfigDeserialization"],ge);var Ce=r(10);Core.exportToNamespace(["AppMagic","Services","ServiceConfigDeserialization"],Ce);var _e=r(77);Core.exportToNamespace(["AppMagic","Services","ServiceConfigDeserialization"],_e);var be=r(18);Core.exportToNamespace(["AppMagic","Services"],be);var Ae=r(13);Core.exportToNamespace(["AppMagic","Services"],Ae);var Se=r(11);Core.exportToNamespace(["AppMagic","Services"],{ServiceFunctionInvocation:Se.b}),Core.exportToNamespace(["AppMagic","Services","ServiceFunctionInvocation"],{DownloadRequest:Se.a});var we=r(19);Core.exportToNamespace(["AppMagic","Services"],{ServiceFunctionInvocationBase:we.b}),Core.exportToNamespace(["AppMagic","Services","ServiceFunctionInvocationBase"],{Request:we.a});var Re=r(67);Core.exportToNamespace(["AppMagic","Services"],Re);var De=r(68);Core.exportToNamespace(["AppMagic","Services"],De);var Pe=r(1);Core.exportToNamespace(["AppMagic","Services","TabularDataProcessorUtilities"],Pe);var Te=r(85);Core.exportToNamespace(["AppMagic","Services"],Te);var Ee=r(69);Core.exportToNamespace(["AppMagic","Services"],Ee)}]);
//# sourceMappingURL=D:/a/_work/1/s/obj/Assets/js/AppMagic.Services/AppMagic.Services.js.map
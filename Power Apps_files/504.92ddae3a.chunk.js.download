/*! For license information please see 504.92ddae3a.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[504],{19170:function(n,t,e){"use strict";e.d(t,"a",(function(){return u}));var r=e(14103),o=e(19171),i=e(13556);function a(n,t,e,r,o,i,a){try{var u=n[i](a),c=u.value}catch(l){return void e(l)}u.done?t(c):Promise.resolve(c).then(r,o)}function u(n,t,e,u){var c,l,s,d={aadId:t,roleTemplateIds:e=e.map(n=>n.toLowerCase())},{data:f,refetch:p}=Object(r.a)(d,i.c,!u),v=0!==(null==f||null===(c=f.systemUserRoles)||void 0===c?void 0:c.length),h={aadId:t},{teams:m,refetch:y,loading:b}=Object(o.a)(h,"",u),g=m&&m.map(n=>{var t;return null!==(t=null==n?void 0:n.cdsRoles)&&void 0!==t?t:[]}).reduce((n,t)=>n.concat(t),[]).map(n=>{var t,e;return null!==(t=null===(e=n.roleTemplateIdValue)||void 0===e?void 0:e.toLowerCase())&&void 0!==t?t:""}).filter(n=>n).some(n=>e.includes(n));return{loading:b,result:Boolean(v||g),reCheck:(l=function*(){yield Promise.all([p(),y()])},s=function(){var n=this,t=arguments;return new Promise((function(e,r){var o=l.apply(n,t);function i(n){a(o,e,r,i,u,"next",n)}function u(n){a(o,e,r,i,u,"throw",n)}i(void 0)}))},function(){return s.apply(this,arguments)})}}},19171:function(n,t,e){"use strict";e.d(t,"a",(function(){return g}));var r=e(10926),o=e(12313),i=e(11868),a=e(11021),u=e(14449),c=e(14426),l=e(14430),s=e(12353),d=e(14428),f=e(14435);function p(n,t,e,r,o,i,a){try{var u=n[i](a),c=u.value}catch(l){return void e(l)}u.done?t(c):Promise.resolve(c).then(r,o)}function v(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(n){p(i,r,o,a,u,"next",n)}function u(n){p(i,r,o,a,u,"throw",n)}a(void 0)}))}}function h(){return(h=v((function*(n,t){var e;if(!n)return"";var r="https://cds-org".concat(Object(u.j)(n)),o=yield Object(i.f)(r,t),a=null==o||null===(e=o.data)||void 0===e?void 0:e.value;return null!=a&&a.length?a[0].systemuserid:""}))).apply(this,arguments)}function m(){return(m=v((function*(n,t){var e;if(!n)return[];var r="https://cds-org".concat(Object(u.f)("(systemuserid eq ".concat(n,")"))),o=yield Object(i.f)(r,t),a=null==o||null===(e=o.data)||void 0===e?void 0:e.value;return(null!=a?a:[]).map(n=>n.teamid).filter(n=>null!==n&&""!==n)}))).apply(this,arguments)}function y(){return(y=v((function*(n){if(0===(null!=n?n:[]).length)return[];var t=b(n,1200),e=new c.a;for(var r of t){var o="Microsoft.Dynamics.CRM.In(PropertyName='teamid',PropertyValues=['"+r.join("', '")+"'])",i={method:"GET",url:"https://cds-org".concat(Object(u.h)("".concat(o)))};e.addOperation(i)}var a=yield Object(l.a)(e);if(a){var s=[];for(var f of a)if(f&&f){var p,v=null===(p=JSON.parse((null==f?void 0:f.response)||"{}"))||void 0===p?void 0:p.value;s.push(...(null!=v?v:[]).map(d.a))}return s}return[]}))).apply(this,arguments)}function b(n,t){return n&&0!==n.length&&0!==t?Object(s.chunk)(n,t):[[]]}function g(n,t,e){var i,u,[c,l]=Object(r.useState)(""),{isInitialLoading:s,data:d,isFetching:p,refetch:b}=Object(o.a)({queryKey:Object(f.b)("powerapps-ui-common","cdsSystemUserTeamMemberships",n),queryFn:(i=v((function*(){var t={headers:{Accept:"application/json","Content-Type":"application/json",Prefer:'odata.include-annotations= "*"'},method:"GET",team:a.j.PowerAppsTeamsIntegration},e=yield function(n,t){return h.apply(this,arguments)}(n.aadId,t),r=yield function(n,t){return m.apply(this,arguments)}(e,t);return yield function(n){return y.apply(this,arguments)}(r)})),function(){return i.apply(this,arguments)}),onError:n=>{var e=n&&(null==n?void 0:n.message)||t||"";l(e)},onSuccess:()=>{l("")},enabled:!e});return Object(r.useEffect)(()=>{(s||p)&&l("")},[s,p]),{loading:s||p,errorMessage:c,teams:d,refetch:(u=v((function*(){yield b()})),function(){return u.apply(this,arguments)})}}},21519:function(n,t,e){"use strict";function r(n,t){if(!n||!t)return!1;for(var e=n.split(".").map(n=>Number(n)),r=t.split(".").map(n=>Number(n)),o=0;o<e.length&&o<t.length;o++){if(e[o]<r[o])return!1;if(e[o]>r[o])return!0}return e.length>=r.length}e.d(t,"a",(function(){return r}))},21528:function(n,t,e){"use strict";var r=e(21529);e.d(t,"a",(function(){return r.a})),e.d(t,"b",(function(){return r.b})),e.d(t,"c",(function(){return r.c}))}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/504.92ddae3a.chunk.js.map
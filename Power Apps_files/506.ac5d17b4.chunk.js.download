/*! For license information please see 506.ac5d17b4.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[506],{21508:function(e,t,n){"use strict";function r(e){return!!e&&"set"===e.type&&!!e.format}function o(e,t,n,r){return{type:"set",format:e,seed:t,nextSeqnumValue:void 0===n?t:n,wasSeedValueNotRetrieved:r}}function i(e){return!!e&&"remove"===e.type}function a(){return{type:"remove"}}n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a}))},21509:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"f",(function(){return c})),n.d(t,"j",(function(){return l})),n.d(t,"l",(function(){return u})),n.d(t,"i",(function(){return s})),n.d(t,"g",(function(){return d})),n.d(t,"k",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"h",(function(){return m}));var r=1e3,o=(Number.MAX_SAFE_INTEGER||9007199254740991)-1,i=Number.MIN_SAFE_INTEGER||-9007199254740991,a=function(e){return e[e.Custom=0]="Custom",e[e.StringPrefixed=1]="StringPrefixed",e[e.DatePrefixed=2]="DatePrefixed",e}({});function c(e){return!!e&&e.type===a.Custom}function l(){return{type:a.Custom}}function u(e,t){return{type:a.StringPrefixed,prefix:e,minNumberLength:t}}function s(e){return!!(t=e)&&t.type===a.StringPrefixed||d(e);var t}function d(e){return!!e&&e.type===a.DatePrefixed}function p(e,t){return{type:a.DatePrefixed,dateString:e,minNumberLength:t}}var f=["yyyy-dd-MM","M-dd-yyyy","M-dd-yy","MM-dd-yy","dd-MMM","dd-MMM-yyyy"];function m(e){return f.indexOf(e)>=0}},21510:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return s}));var r=n(21511),o=n(21513),i=n(21509),a=n(21514);function c(e){return void 0!==e&&!isNaN(e)}function l(e,t){if(function(e,t){if(t<i.c||t>i.b)return!0;for(var n;null!==(n=Object(o.b)(o.a.DATETIMEUTC).exec(e));){var{startIndex:r,lengthOfPlaceholder:a,stringValueOfPlaceholder:c}=Object(o.d)(n);if(c.replace(/d/g,"").replace(/M/g,"").replace(/m/g,"").replace(/Y/g,"").replace(/y/g,"").replace(/H/g,"").replace(/h/g,"").replace(/-/g,"").replace(/:/g,"").replace(/\//g,""))return!0;e=e.substring(0,r)+e.substring(r+a)}return!1}(e,t))return null;var n=new Date,{nextRecordPreview:r,nextSeqnumValue:c}=Object(a.a)(e,t,n);n.setDate(n.getDate()+1);var{nextRecordPreview:l,nextSeqnumValue:u}=Object(a.a)(e,c,n);n.setDate(n.getDate()+1);var{nextRecordPreview:s}=Object(a.a)(e,u,n);return{value1:r,value2:l,value3:s}}function u(){return i.e.map(e=>({key:e,text:Object(r.a)(e,new Date)}))}function s(e,t,n){if(!e)return!0;for(var r,i=Object(o.b)(t);null!==(r=i.exec(e));){var{stringValueOfPlaceholder:a}=Object(o.d)(r);if(n(parseInt(a,10)))return!1}return!0}},21511:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(14320),o=n(21512),i=n(21513);function a(e,t){if("d"===e)return Object(r.d)(t.getMonth()+1,2)+"/"+Object(r.d)(t.getDate(),2)+"/"+t.getFullYear().toString();if("M"===e||"m"===e)return o.b[t.getMonth()]+" "+Object(r.d)(t.getDate(),2);if("Y"===e||"y"===e)return t.getFullYear().toString()+" "+o.b[t.getMonth()];var n=e,{format:a}=o.a.reduce((e,n)=>function(e,t,n,r){var o;for(;null!==(o=n.regex.exec(e));){var{startIndex:a,lengthOfPlaceholder:c}=Object(i.d)(o),l=n.datePatternGenerator(r);t=t.substring(0,a)+l+t.substring(a+c);var u=Array(l.length+1).join("X");e=e.substring(0,a)+u+e.substring(a+c)}return{format:t,formatChangesTracker:e}}(e.formatChangesTracker,e.format,n,t),{format:e,formatChangesTracker:n});return a}},21512:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(14320),o=[{regex:/dd/g,datePatternGenerator:e=>Object(r.d)(e.getDate(),2)},{regex:/d/g,datePatternGenerator:e=>e.getDate().toString()},{regex:/hh/g,datePatternGenerator:e=>Object(r.d)(e.getHours()%12||12,2)},{regex:/h/g,datePatternGenerator:e=>(e.getHours()%12||12).toString()},{regex:/HH/g,datePatternGenerator:e=>Object(r.d)(e.getHours(),2)},{regex:/H/g,datePatternGenerator:e=>e.getHours().toString()},{regex:/mm/g,datePatternGenerator:e=>Object(r.d)(e.getMinutes(),2)},{regex:/m/g,datePatternGenerator:e=>e.getMinutes().toString()},{regex:/MMMM/g,datePatternGenerator:e=>i[e.getMonth()]},{regex:/MMM/g,datePatternGenerator:e=>i[e.getMonth()].slice(0,3)},{regex:/MM/g,datePatternGenerator:e=>Object(r.d)(e.getMonth()+1,2)},{regex:/M/g,datePatternGenerator:e=>(e.getMonth()+1).toString()},{regex:/yyyy/g,datePatternGenerator:e=>Object(r.d)(e.getFullYear(),4)},{regex:/yyy/g,datePatternGenerator:e=>Object(r.d)(e.getFullYear(),3)},{regex:/yy/g,datePatternGenerator:e=>Object(r.d)(parseInt(e.getFullYear().toString().substr(2,2),10),2)}],i=["January","February","March","April","May","June","July","August","September","October","November","December"]},21513:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return l}));var r=n(21509),o=n(14320),i=function(e){return e[e.SEQNUM=0]="SEQNUM",e[e.RANDSTRING=1]="RANDSTRING",e[e.DATETIMEUTC=2]="DATETIMEUTC",e}({});function a(e){return e===i.SEQNUM?/{SEQNUM:([-]*[0-9]+)}/g:e===i.RANDSTRING?/{RANDSTRING:([-]*[0-9]+)}/g:/{DATETIMEUTC:([^}]+)}/g}function c(e){var t=e.index;return{startIndex:t,lengthOfPlaceholder:t+e[0].length-t,stringValueOfPlaceholder:e[1]}}function l(e){return e===i.SEQNUM?"{SEQNUM:4}":e===i.RANDSTRING?"{RANDSTRING:4}":Object(o.c)("{DATETIMEUTC:{0}}",r.e[0])}},21514:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(21511),o=n(21513);function i(e,t,n){var i=e;return i=a(i,o.a.SEQNUM,e=>{var n=Math.abs(t).toString(),r=n.length,o=parseInt(e,10);if(o>99)n="D"+o.toString().charAt(0)+n;else for(var i=o-r;i>0;)n="0"+n,i--;return t<0&&(n="-"+n),t++,n}),i=a(i,o.a.RANDSTRING,e=>function(e){for(var t="",n=0;n<e;n++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".charAt(Math.floor(Math.random()*"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".length));return t}(parseInt(e,10))),{nextRecordPreview:i=a(i,o.a.DATETIMEUTC,e=>Object(r.a)(e,n)),nextSeqnumValue:t}}function a(e,t,n){for(var r;null!==(r=Object(o.b)(t).exec(e));){var{startIndex:i,lengthOfPlaceholder:a,stringValueOfPlaceholder:c}=Object(o.d)(r),l=n(c);e=e.substring(0,i)+l+e.substring(i+a)}return e}},21589:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return u}));var r=n(21513),o=n(21508),i=n(21509);function a(e){var t;if(null===(t=s("endsWithSeqNumPlaceholder").exec(e)))return Object(i.j)();var{startIndex:n,stringValueOfPlaceholder:o}=Object(r.d)(t),a=parseInt(o,10);if(0===n)return Object(i.l)(void 0,a);var c,l=e.substr(0,n);if(null===s("containsAnyPlaceholders").exec(l)&&"-"===l.charAt(l.length-1)){var u="-"===l.charAt(l.length-1)?l.slice(0,-1):l;return Object(i.l)(u||void 0,a)}if(null!==(c=s("containsDateTimeUTCPlaceholders").exec(l))){var{lengthOfPlaceholder:d,stringValueOfPlaceholder:p}=Object(r.d)(c);if(d===l.length&&Object(i.h)(p))return Object(i.k)(p,a)}return Object(i.j)()}function c(e){var t;e.type===i.a.StringPrefixed?t=(e.prefix?e.prefix+"-":"")+"{SEQNUM:"+e.minNumberLength+"}":t="{DATETIMEUTC:"+e.dateString+"}-{SEQNUM:"+e.minNumberLength+"}";return t}function l(){var e=Object(i.l)(void 0,4);return{autonumberType:i.a.StringPrefixed,properties:Object(o.d)(c(e),i.d)}}function u(e){return e===i.a.StringPrefixed?Object(i.l)(void 0,4):Object(i.k)(i.e[0],4)}function s(e){return"endsWithSeqNumPlaceholder"===e?/{SEQNUM:([-]*[0-9]+|NaN)}$/g:"containsAnyPlaceholders"===e?/{SEQNUM:[-]*[0-9]+}|{RANDSTRING:([-]*[0-9]+)}|{DATETIMEUTC:([^}]+)}/g:/{DATETIMEUTC:([^}]+)}-/g}},21605:function(e,t,n){"use strict";var r=n(16207),o=n(12219),i=n(21606),a=n(13556),c=n(11465),l=n(12353),u=n(10926),s=n.n(u),d=n(21611),p=n(21517),f=n(21612),m=n(21614),b=n(13807),v=n(13737),h=["updateChoice"],O=["createChoice"];function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}t.a=Object(c.s)(p.b)(e=>{var t,{t:n,isOpen:c,isSolutionFirst:p,choiceId:y,isLoading:j,solutionId:S,onBack:P,onSaved:w,onDismiss:E}=e,N=!!y,D=a.c,{currentEnvironment:x}=Object(o.W)(),M=Object(b.G)(Object(b.C)(null==x||null===(t=x.properties)||void 0===t?void 0:t.environmentSku)),I=Object(v.e)({isSolutionFirst:p}),k=Object(r.b)({solutionId:S,t:n}),{disguisedSolution:T,disguisedSolutionUniqueName:R}=Object(f.a)({solution:k,isCDSLiteUX:M,t:n}),F=x?Object(o.E)(x):0,V=Object(i.d)(D,n("Choices.ScreenReader.UpdateSuccessful"),n("Choices.ScreenReader.UpdateFailed")),{updateChoice:A}=V,L=C(V,h),B=Object(i.a)(D,n("Choices.ScreenReader.CreateSuccessful"),n("Choices.ScreenReader.CreateFailed")),{createChoice:G}=B,U=C(B,O),q=Object(u.useRef)(),W=Object(i.b)({id:null!=y?y:""},D,"",!N),z=Object(d.m)(null==W?void 0:W.choice),H=Object(u.useCallback)(e=>{var t,n,r,o,i,a=N&&!Object(l.isEqual)(Object(l.omit)(e,"options"),Object(l.omit)(z,"options")),c=e.options,u=null!==(t=null==z?void 0:z.options)&&void 0!==t?t:[],s=c.map(e=>e.value),p=u.map(e=>e.value),f=new Set(p),m=new Set(s),b=!(null!=s&&s.every((e,t)=>(null==p?void 0:p[t])===e)),v=c.filter(e=>!f.has(e.value)),h=null!==(n=u.filter(e=>!m.has(e.value)))&&void 0!==n?n:[],O=c.filter(e=>f.has(e.value)&&!Object(l.isEqual)(Object(l.omit)(u.find(t=>t.value===e.value),"id"),Object(l.omit)(e,"id")));N&&A(g(g({},{didChoiceChange:a,solutionUniqueName:R,langCode:F}),{},{choice:Object(d.k)(e),deletedChoiceOptions:null!==(r=null==h?void 0:h.map(e=>Number(e.value)))&&void 0!==r?r:[],newChoiceOptions:null!==(o=null==v?void 0:v.map(e=>Object(d.l)(e)))&&void 0!==o?o:[],sortedChoiceOptions:b?null==s?void 0:s.map(e=>Number(e)):[],updatedChoiceOptions:null!==(i=null==O?void 0:O.map(e=>Object(d.l)(e)))&&void 0!==i?i:[],isPreferredSolutionFeatureEnabled:I}))},[N,z,R,F,I]),Q=Object(u.useCallback)(e=>{if(N)H(e);else{var t={choice:Object(d.k)(e),solutionUniqueName:R,langCode:F,isPreferredSolutionFeatureEnabled:I};G(t)}q.current=e},[N,R,F,H,G,I]),J=j||(null==T?void 0:T.loading)||W.loading,Y=L.loading||U.loading,Z=W.errorMessage||U.errorMessage||L.errorMessage,_={isEditMode:N,choice:z,isLoading:J,onBack:P,solution:T,isOpen:c,onDismiss:E,onSave:Q,errorMessage:Z,isSaving:Y};return Object(u.useEffect)(()=>{c&&!Z&&(U.isSuccess||L.isSuccess)&&(null==w||w(q.current),E())},[L,U]),s.a.createElement(m.a,_)})},21606:function(e,t,n){"use strict";n.d(t,"c",(function(){return O})),n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return g})),n.d(t,"d",(function(){return j}));var r=n(11021),o=n(10926),i=n(12313),a=n(13771),c=n(13556),l=n(14276),u=n(14435),s=n(21607),d=n(13770),p=n(12219);function f(e,t,n,r,o,i,a){try{var c=e[i](a),l=c.value}catch(u){return void n(u)}c.done?t(l):Promise.resolve(l).then(r,o)}function m(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){f(i,r,o,a,c,"next",e)}function c(e){f(i,r,o,a,c,"throw",e)}a(void 0)}))}}var b=(e,t,n,r,o)=>i=>{var a=Object(d.c)(i,n);t(a),e.current&&(null!=o&&o(i)?e.current.completeWithError({error:a,clientError:a}):e.current.failure({error:a,clientError:a}),e.current=void 0),r&&Object(l.a)(r,"assertive")};function v(e,t,n){e.current&&(e.current.complete(),e.current=void 0),n&&Object(l.a)(n,"assertive"),t("")}function h(e,t,n,i){Object(o.useEffect)(()=>{e&&(t.current=Object(c.j)(n,i,c.d.DataExperience,c.e.DataFetchHooks,r.j.PowerappsPortal,r.f.Medium))},[e])}function O(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=c.g.getChoices,a=Object(o.useRef)(),[l,d]=Object(o.useState)(""),{currentEnvironment:f}=Object(p.W)(),{isInitialLoading:v,isFetching:O,data:y,refetch:g}=Object(i.a)(Object(u.b)("powerapps-ui-common","getChoices",null==f?void 0:f.name),m((function*(){return Object(s.c)()})),{enabled:!n,onSuccess:e=>{a.current&&(a.current.complete({numOfChoices:null==e?void 0:e.length}),a.current=void 0),d("")},onError:b(a,d,t)});return h(v||O,a,e,r),{loading:v||O,choices:y,errorMessage:l,refetch:()=>m((function*(){return yield g()}))()}}function y(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=c.g.getChoiceById,l=Object(o.useRef)(),[d,p]=Object(o.useState)(""),{isInitialLoading:f,data:O}=Object(i.a)(Object(u.b)("powerapps-ui-common","getChoiceById",e.id),m((function*(){return Object(s.b)(e)})),{staleTime:0,cacheTime:0,enabled:!r,onSuccess:()=>v(l,p),onError:b(l,p,n)});return h(f,l,t,a),{loading:f,choice:O,errorMessage:d}}function g(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=c.g.createChoice,l=Object(o.useRef)(),[p,f]=Object(o.useState)(""),{mutate:m,isLoading:O,data:y}=Object(a.a)(s.a,{mutationKey:Object(u.a)("powerapps-ui-common","createChoice"),onSuccess:()=>v(l,f,t),onError:b(l,f,r,n,e=>404===Object(d.b)(e)&&"0x80044363"===Object(d.a)(e))});return h(O,l,e,i),{createChoice:m,loading:O,isSuccess:y,errorMessage:p}}function j(e,t,n){var r,i,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",d=c.g.updateChoice,f=Object(o.useRef)(),[m,O]=Object(o.useState)(""),{currentEnvironment:y}=Object(p.W)(),g=Object(s.d)(null==y||null===(r=y.properties)||void 0===r||null===(i=r.linkedEnvironmentMetadata)||void 0===i?void 0:i.version),{mutate:j,isLoading:C,data:S}=Object(a.a)(g,{mutationKey:Object(u.a)("powerapps-ui-common","updateChoice",null==y?void 0:y.name),onSuccess:()=>v(f,O,t),onError:b(f,O,l,n)});return h(C,f,e,d),{updateChoice:j,loading:C,isSuccess:S,errorMessage:m}}},21607:function(e,t,n){"use strict";n.d(t,"d",(function(){return j})),n.d(t,"b",(function(){return P})),n.d(t,"c",(function(){return E})),n.d(t,"a",(function(){return D}));var r=n(21608),o=n(14426),i=n(21609),a=n(21610),c=n(14430),l=n(11868),u=n(11021);function s(e,t,n,r,o,i,a){try{var c=e[i](a),l=c.value}catch(u){return void n(u)}c.done?t(l):Promise.resolve(l).then(r,o)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){s(i,r,o,a,c,"next",e)}function c(e){s(i,r,o,a,c,"throw",e)}a(void 0)}))}}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){return h(f({Accept:"application/json","Content-Type":"application/json"},t?{}:{"MSCRM.SolutionUniqueName":e}))}function v(e,t){return h(f({},t?{}:{"MSCRM.SolutionUniqueName":e}))}function h(e){return f(f({},e),{},{Consistency:"Strong"})}function O(e){return f(f({},e),{},{"@odata.type":"Microsoft.Dynamics.CRM.OptionSetMetadata"})}var y=Object(r.b)("GlobalOptionSetDefinitions"),g=e=>"".concat(y,"(").concat(e,")"),j=e=>function(){var t=d((function*(t){var{solutionUniqueName:n,choice:o,newChoiceOptions:a,updatedChoiceOptions:c,deletedChoiceOptions:u,sortedChoiceOptions:s,didChoiceChange:d,langCode:p,isPreferredSolutionFeatureEnabled:f}=t,m=v(n,f),b=O(Object(i.d)(o,p)),h=d?Object(i.h)(b,g(o.metadataId),m):void 0,y=s.length>0;if(Object(r.a)({hasOrderChanged:y,createdOptions:a,updatedOptions:c,deletedOptions:u})){var{url:j,requestConfig:S}=Object(i.c)(s,o.name,m);yield Object(l.f)(j,S)}else yield function(e,t,n,r,o,i,a,c,l,u){return C.apply(this,arguments)}(n,o.name,p,h,a,c,u,s,null!=e?e:"0",f);return!0}));return function(e){return t.apply(this,arguments)}}();function C(){return(C=d((function*(e,t,n,r,l,u,s,d,p,f){var m=Object(a.a)(p),b=v(e,f),h=[...u.map(e=>Object(i.i)(e,t,b,n,m)),...l.map(e=>Object(i.a)(e,t,b,n,m)),...s.map(e=>Object(i.b)(e,t,b)),...d.length>0?[Object(i.f)(d,t,b)]:[],...r?[r]:[]],O=Object(o.e)(h,e=>e);return yield Promise.all(O.map(e=>Object(c.a)(e))),!0}))).apply(this,arguments)}function S(e){var t;if(204!==(null==e?void 0:e.status)&&200!==(null==e?void 0:e.status))throw new Error(null==e||null===(t=e.data)||void 0===t?void 0:t.errorMessage)}function P(e){return w.apply(this,arguments)}function w(){return(w=d((function*(e){var t={headers:h({}),team:u.j.PowerappsPortal,method:"GET"},n=yield Object(l.f)(g(e.id),t);return S(n),Object(i.e)(null==n?void 0:n.data)}))).apply(this,arguments)}function E(){return N.apply(this,arguments)}function N(){return(N=d((function*(){var e,t,n={headers:h({}),team:u.j.PowerappsPortal,method:"GET"},r=yield Object(l.f)(y,n);return S(r),(null==r||null===(e=r.data)||void 0===e||null===(t=e.value)||void 0===t?void 0:t.map(i.e))||[]}))).apply(this,arguments)}function D(e){return x.apply(this,arguments)}function x(){return(x=d((function*(e){var{solutionUniqueName:t,choice:n,langCode:r,isPreferredSolutionFeatureEnabled:o}=e,a={headers:b(t,o),method:"POST",data:JSON.stringify(O(Object(i.d)(n,r)))};return S(yield Object(l.f)(y,a)),!0}))).apply(this,arguments)}},21610:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(11853);function o(e){return Object(r.e)(e,"9.2.21114.00013")}function i(e){return Object(r.e)(e,"9.2.22023.00000")}function a(e){return{externalValueOnUpdate:o(e),colorForBooleanAndStatusReason:i(e)}}},21611:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"i",(function(){return f})),n.d(t,"l",(function(){return m})),n.d(t,"m",(function(){return b})),n.d(t,"k",(function(){return v})),n.d(t,"j",(function(){return h})),n.d(t,"g",(function(){return O})),n.d(t,"e",(function(){return y})),n.d(t,"f",(function(){return g})),n.d(t,"b",(function(){return j})),n.d(t,"h",(function(){return C})),n.d(t,"n",(function(){return S}));var r=n(11630),o=n(11885),i=n(12353),a=n(21517);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s="choiceLabel",d=()=>Object(r.a)("choiceOption"),p=e=>e+s,f=e=>Number.isInteger(e)&&e>-1,m=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return l(l(l({label:null==e?void 0:e.label,metadataId:null==e?void 0:e.metadataId,color:null==e?void 0:e.color,value:Number(null==e?void 0:e.value)},t?{}:{description:null==e?void 0:e.description,externalValue:null==e?void 0:e.externalValue}),void 0!==(null==e?void 0:e.state)?{state:e.state}:{}),void 0!==(null==e?void 0:e.defaultStatus)?{defaultStatus:e.defaultStatus}:{})},b=e=>{var t;if(void 0!==e){var n=(e=>e.map(e=>l(l({},e),{},{id:d(),value:e.value.toString()})))((null==e?void 0:e.optionSetType)!==o.p.Boolean||Object(i.isNil)(e.trueOption)||Object(i.isNil)(e.falseOption)?null==e?void 0:e.options:[null==e?void 0:e.falseOption,null==e?void 0:e.trueOption]);return l(l({},e),{},{isCustom:null==e?void 0:e.isCustomOptionSet,externalTypeName:null!==(t=null==e?void 0:e.externalTypeName)&&void 0!==t?t:"",optionSetType:null==e?void 0:e.optionSetType,options:n})}},v=e=>l({name:null==e?void 0:e.name,isManaged:null==e?void 0:e.isManaged,isGlobal:null==e?void 0:e.isGlobal,isCustomizable:null==e?void 0:e.isCustomizable,isBoolean:null==e?void 0:e.isBoolean,introducedVersion:null==e?void 0:e.introducedVersion,displayName:null==e?void 0:e.displayName,description:null==e?void 0:e.description,metadataId:null==e?void 0:e.metadataId,isCustomOptionSet:null==e?void 0:e.isCustom,optionSetType:null==e?void 0:e.optionSetType,externalTypeName:null==e?void 0:e.externalTypeName},(e=>{var t,n=null==e||null===(t=e.options)||void 0===t?void 0:t.map(t=>m(t,null==e?void 0:e.isBoolean));return null!=e&&e.isBoolean?{trueOption:n.find(e=>1===e.value),falseOption:n.find(e=>0===e.value)}:{options:n}})(e)),h=(e,t)=>{if(t)return o.d.Virtual;switch(e){case o.p.Boolean:return o.d.Boolean;case o.p.State:return o.d.State;case o.p.Status:return o.d.Status;case o.p.Picklist:default:return o.d.Picklist}};function O(e,t){return e}function y(e){return 1e4*(null!=e?e:1)}function g(e){return e/1e4}function j(e){return(null==e?void 0:e.attributeTypeName)===o.e.MultiSelectPicklistType?null==e?void 0:e.attributeTypeName:null==e?void 0:e.attributeType}function C(e){return e>=a.c.valueMinValue&&e<=a.c.valueMaxValue}function S(e){return e&&((e,t)=>{var n,r=(null==e?void 0:e.optionSetType)===o.p.Boolean&&!Object(i.isNil)(e.trueOption)&&!Object(i.isNil)(e.falseOption);return l(l({},e),r?{trueOption:Object(i.omit)(e.trueOption,t),falseOption:Object(i.omit)(e.falseOption,t)}:{options:null===(n=e.options)||void 0===n?void 0:n.map(e=>Object(i.omit)(e,t))})})(e,["isManaged"])}},21612:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(21613),o=n(12219),i=n(12217),a=n(14760);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var{isCDSLiteUX:n,solution:c}=e,u=n&&!(null==c||!c.solutionIsManaged),{currentEnvironment:s}=Object(o.W)(),{data:d}=Object(a.f)({solutionId:o.s,telemetryScope:i.h,environment:s},t),p=null==d?void 0:d.solution;return{disguisedSolution:Object(r.a)(u,c,p,(e,t)=>{var n,r;return l(l({},e),{},{customizationPrefix:null===(n=t.publisher)||void 0===n?void 0:n.customizationPrefix,solutionIsManaged:!1,publisherCustomizationOptionValuePrefix:null===(r=t.publisher)||void 0===r?void 0:r.customizationOptionValuePrefix})}),disguisedSolutionUniqueName:Object(r.c)(u,(null==p?void 0:p.uniqueName)||"",(null==c?void 0:c.solutionUniqueName)||"")}}},21613:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(12219);function o(e,t,n,r){if(t&&(!e||n))return e?r(t,n):t}function i(e,t,n){return e?t:n}function a(e,t){return e?r.s:t}},21614:function(e,t,n){"use strict";var r=n(11623),o=n(11932),i=n(11934),a=n(12687),c=n(12685),l=n(11625),u=n(11465),s=n(10926),d=n.n(s),p=n(21517),f=n(21615),m=n(21616),b=n(21617),v=n(21633),h=n(21634),O=n(21635);function y(){return(y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function g(e,t,n,r,o,i,a){try{var c=e[i](a),l=c.value}catch(u){return void n(u)}c.done?t(l):Promise.resolve(l).then(r,o)}function j(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){g(i,r,o,a,c,"next",e)}function c(e){g(i,r,o,a,c,"throw",e)}a(void 0)}))}}t.a=Object(u.s)(p.b)(Object(l.a)(e=>{var{t:t,styles:n,theme:l,choice:u,solution:v,isOpen:g,onDismiss:C,onBack:S,onSave:P,isLoading:w,isSaving:E,isEditMode:N,errorMessage:D}=e,[x,M]=Object(s.useState)(!0),[I,k]=Object(s.useState)(!0),[T,R]=Object(s.useState)(!1),F=Object(s.useRef)({}),V=Object(s.useMemo)(()=>{var e;return null===(e=w||(null==v?void 0:v.loading))||void 0===e||e},[v,w]),A=V||E,L=Object(s.useCallback)(e=>!!e.choice.displayName.trim()&&!!e.choice.name&&e.choice.options.every(e=>!!e.value&&!!e.label),[]),B=Object(s.useCallback)(e=>{x||T?(M(!0),e()):R(!0)},[x,T,R,M]),G=()=>B(C),U=S?()=>B(S):void 0,q=Object(s.useCallback)(e=>{M(!1),k(e.isValid&&L(e)),F.current=e},[M,k,L,F]),W=Object(s.useCallback)(j((function*(){P(F.current.choice,N),M(!0)})),[F,N,P,M]),z=Object(s.useMemo)(()=>t(N?"ChoicesPanel.EditChoice":"ChoicesPanel.NewChoice"),[t,N]),H=Object(s.useMemo)(()=>Object(r.a)()(n,{theme:l}),[n,l]),Q=Object(s.useCallback)(()=>d.a.createElement(O.a,{title:z,"data-test-id":z,classNames:H,onDismiss:G,onBack:U}),[z,H,G,S]),J=Object(s.useCallback)(()=>d.a.createElement(h.a,{onCancelClick:G,onSaveClick:W,isSaveDisabled:x||A||!I,isCancelDisabled:A,footerClassName:H.panelFooter}),[H,A,x,I,G,W]),Y=Object(m.a)(E,l),Z=Object(s.useCallback)(()=>d.a.createElement(b.a,{choice:u,solution:v,onFormUpdate:q}),[v,u,q]),_=Object(s.useCallback)(()=>d.a.createElement(o.a,{messageBarType:i.a.error,className:H.messageBar,dismissButtonAriaLabel:t("Common.Close")},D),[H,D]),K={role:"presentation",type:a.a.medium,isFooterAtBottom:!0,isLightDismiss:!0,hasCloseButton:!1,styles:{commands:H.commands,content:H.mainContentArea},isOpen:g,onLightDismissClick:G,onRenderHeader:Q,onRenderFooter:J};return d.a.createElement(d.a.Fragment,null,d.a.useMemo(()=>d.a.createElement(f.a,{onPanelDismiss:G,openDialog:T,setOpenDiscardDialog:R,translationFile:p.b,titleAriaId:"choicesFormClosePanelDialogTitle"}),[G,R,T]),d.a.createElement(c.a,y({key:"choicesPanelKey",title:t(N?"ChoicesPanel.EditChoice":"ChoicesPanel.NewChoice")},K),!!D&&_(),!V&&Z(),(V||E)&&Y()))},v.a))},21616:function(e,t,n){"use strict";var r=n(11698),o=n(11940),i=n(11942),a=n(11466),c=n(10926),l=n.n(c),u=n(21517),s=Object(a.f)(u.b)(e=>{var t,{t:n,isSaving:a,theme:c}=e,u=n(a?"Common.Saving":"Common.Loading"),s={root:{backgroundColor:(null==c||null===(t=c.palette)||void 0===t?void 0:t.white)||"#fff",opacity:.9}};return l.a.createElement(r.a,{styles:s},l.a.createElement(o.a,{size:i.a.large,label:u,ariaLabel:u,ariaLive:"assertive",labelPosition:"right"}))});t.a=(e,t)=>Object(c.useCallback)(()=>l.a.createElement(s,{isSaving:e,theme:t}),[e,t])},21617:function(e,t,n){"use strict";var r=n(11623),o=n(11932),i=n(11934),a=n(12139),c=n(11625),l=n(13639),u=n(21618),s=n(14145),d=n(11465),p=n(10926),f=n.n(p),m=n(21611),b=n(21517),v=n(21620),h=n(21621),O=n(21630),y=n(21632),g=n(21626);t.a=Object(d.s)(b.b)(Object(c.a)(e=>{var t,n,{t:c,theme:d,styles:v,choice:j,solution:C,onFormUpdate:S}=e,P=Object(m.e)(null==C?void 0:C.publisherCustomizationOptionValuePrefix),[w,E]=Object(y.a)(j,{newChoiceBaseValue:P}),N=null!==(t=Object(s.h)(null==C?void 0:C.solutionIsManaged,null==C?void 0:C.solutionIsPatched,w.choice.isManaged,[w.choice.isCustomizable]))&&void 0!==t&&t,D=Object(p.useMemo)(()=>Object(r.a)()(v,{theme:d}),[v,d]),x=Object(p.useMemo)(()=>Object(u.b)(null==C?void 0:C.customizationPrefix),[C]),M=Object(p.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";E({type:g.a.updateDisplayName,payload:{displayName:t,namePrefix:x}})}),[x]),I=Object(p.useCallback)(()=>w.isEditMode&&f.a.createElement(o.a,{className:D.messageBar,messageBarType:i.a.info,dismissButtonAriaLabel:c("Common.Close")},c("ChoicesPanel.EditGlobalChoiceMessage")),[w.isEditMode,D]);return Object(p.useEffect)(()=>{Object(y.b)(w)||null==S||S(Object.freeze(w))},[w,S]),f.a.createElement(f.a.Fragment,null,I(),f.a.createElement(a.a,null,f.a.createElement(a.a.Item,null,f.a.createElement(l.a,{shouldFocus:()=>!w.isEditMode,name:"displayName",label:c("Form.DisplayName"),ariaLabel:c("Form.DisplayName"),id:"ChoiceForm_DisplayName","aria-required":!0,required:!0,disabled:N,maxLength:b.c.displayNameMaxLength,defaultValue:null!==(n=w.choice.displayName)&&void 0!==n?n:"",onChange:M,onGetErrorMessage:e=>!e.length||e.trim()?"":c("ChoicesPanel.ChoicesForm.ValueCannotBeSpaces")})),f.a.createElement(h.a,{choicesList:w.choice.options,dispatch:E,isReadonlyMode:N,isInitialState:Object(y.b)(w),isChoiceBooleanType:w.choice.isBoolean}),f.a.createElement(O.a,{choice:w.choice,isEditMode:w.isEditMode,shouldDisplayNameSetName:w.shouldDisplayNameSetName,columnPrefix:x,dispatch:E,isReadonlyMode:N})))},v.a))},21620:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=e=>({messageBar:{paddingBlock:2,paddingInline:6}})},21621:function(e,t,n){"use strict";var r=n(13286),o=n(11623),i=n(12738),a=n(13259),c=n(12139),l=n(12839),u=n(12871),s=n(13256),d=n(12715),p=n(11625),f=n(12217),m=n(11465),b=n(11021),v=n(12353),h=n(10926),O=n.n(h),y=n(21517),g=n(21622),j=n(21623),C=n(21624),S=n(21626);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function N(){return(N=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var D=Object(h.memo)(e=>O.a.createElement(r.a,N({},e,{styles:e.styles,focusZoneProps:{tabIndex:0}})),(e,t)=>e.item===t.item&&e.itemIndex===t.itemIndex&&e.choicesList.length===t.choicesList.length&&e.rowWidth===t.rowWidth);t.a=Object(m.s)(y.b)(Object(p.a)(e=>{var t,{t:n,styles:r,theme:p,choicesList:m,dispatch:y,isReadonlyMode:j,isInitialState:P,isStateCodeColumn:E,isStatusCodeColumn:x,isChoiceBooleanType:M,onRenderTitle:I,selectedChoiceGroup:k}=e,T=E||M,R=Object(h.useRef)(),F=m.length>1&&!E&&!j&&!M,V=Object(h.useMemo)(()=>Object(o.a)()(r,{theme:p}),[r,p]),A=Object(h.useCallback)(()=>{var e;return null!==(e=j||E)&&void 0!==e&&e},[j,E]),L=[{key:"handle",name:"handle",minWidth:20,maxWidth:20,isIconOnly:!0,columnActionsMode:i.b.disabled,onRender:()=>O.a.createElement(C.e,{classNames:V})},{key:"colorPicker",name:"colorPicker",minWidth:28,maxWidth:28,isIconOnly:!0,className:V.colorPicker,columnActionsMode:i.b.disabled,onRender:(e,t)=>O.a.createElement(C.b,{choice:e,index:t,dispatch:y,isReadonlyMode:A()})},{key:"label",name:n("ChoicesPanel.ChoicesForm.Label"),minWidth:94,maxWidth:M?358:x?318:284,columnActionsMode:i.b.disabled,headerClassName:V.columnRequired,onRender:(e,t)=>O.a.createElement(C.d,{t:n,choice:e,index:t,dispatch:y,choicesList:m,shouldAutoFocus:!P,isReadonlyMode:A()})},{key:"value",name:n("ChoicesPanel.ChoicesForm.Value"),minWidth:100,maxWidth:206,headerClassName:V.columnRequired,columnActionsMode:i.b.disabled,onRender:(e,t)=>O.a.createElement(C.f,{choice:e,index:t,dispatch:y,choicesList:m,isReadonlyMode:A()||M||x,t:n})},...T||x?[]:[{key:"additionalProperties",name:"additionalProperties",minWidth:36,maxWidth:36,isIconOnly:!0,columnActionsMode:i.b.disabled,onRender:(e,t)=>O.a.createElement(C.a,{dispatch:y,index:t,choice:e,t:n,classNames:V,isReadonlyMode:A()})}],...T?[]:[{key:"deleteRow",name:"deleteRow",minWidth:18,maxWidth:18,isIconOnly:!0,columnActionsMode:i.b.disabled,onRender:(e,t)=>O.a.createElement(C.c,{dispatch:y,choice:e,isDisabled:1===m.length||A(),t:n})}]],B={items:[{key:"sortAToZ",text:n("ChoicesPanel.ChoicesForm.SortAtoZ"),iconProps:{iconName:"SortDown"},onClick:()=>{y({type:S.a.sortChoices,payload:{isDescending:!1}}),Object(b.fb)(f.h,g.a.ChoicesAtoZSort)}},{key:"sortZToA",text:n("ChoicesPanel.ChoicesForm.SortZtoA"),iconProps:{iconName:"SortUp"},onClick:()=>{y({type:S.a.sortChoices,payload:{isDescending:!0}}),Object(b.fb)(f.h,g.a.ChoicesAtoZSort)}}]},G=Object(h.useMemo)(()=>({canDrop:Object(v.constant)(F),canDrag:Object(v.constant)(F),onDragEnter:e=>{var t,n=m.findIndex(e=>{var t;return e.id===(null===(t=R.current)||void 0===t?void 0:t.id)}),r=m.findIndex(t=>t.id===e.id);return null!==(t=n<r?V.onDragEnterItem:n===r?"":V.onDragEnterItemTopBorder)&&void 0!==t?t:""},onDragStart:e=>R.current=e,onDrop:e=>{var t;R.current&&y({type:S.a.moveChoice,payload:{choice:R.current,beforeIndex:null!==(t=m.findIndex(t=>t.id===(null==e?void 0:e.id)))&&void 0!==t?t:0}}),Object(b.fb)(f.h,g.a.ChoicesDragAndDropSort),R.current=void 0},onDragEnd:()=>R.current=void 0}),[m,R.current,F,V]);return O.a.createElement(c.a,{className:V.mainContent},O.a.createElement(c.a,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center",tokens:{childrenGap:8,maxHeight:20}},null!==(t=null==I?void 0:I(V))&&void 0!==t?t:O.a.createElement(l.a,{nowrap:!0,as:"h2"},n("ChoicesPanel.ChoicesForm.Choices")),!T&&O.a.createElement(u.a,{text:n("ChoicesPanel.ChoicesForm.Sort"),menuProps:B,disabled:j||E})),O.a.createElement(s.a,{selectionMode:d.d.none,items:m,columns:L,onRenderDetailsHeader:e=>{if(e){return O.a.createElement(a.a,N({},e,{styles:{root:{borderBottom:"none"}}}))}return null},onRenderRow:e=>{if(e){var t={root:w({},(j||E)&&{"&:hover":{background:"none"}})};return O.a.createElement(D,N({},w(w({},e),{},{choicesList:m}),{styles:t}))}return null},dragDropEvents:G,cellStyleProps:{cellExtraRightPadding:0,cellLeftPadding:0,cellRightPadding:0}}),!T&&O.a.createElement(c.a.Item,null,O.a.createElement(u.a,{text:n("ChoicesPanel.NewChoice"),"data-test-id":"ChoicesPanelNewChoice",iconProps:{iconName:"Add"},disabled:j||E,onClick:()=>y({type:S.a.addChoice,state:null==k?void 0:k.value})})))},j.a))},21623:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=e=>{var t,n,r=null==e||null===(t=e.theme)||void 0===t?void 0:t.palette;return{mainContent:{gap:8,h2:{fontWeight:600},".ms-DetailsHeader":{paddingTop:0},".ms-DetailsHeader, .ms-DetailsHeader-cell":{height:26,lineHeight:26,".ms-DetailsHeader-cellName":{fontSize:12}},".ms-DetailsRow":{borderBottom:"none"},".ms-DetailsList":{overflowX:"hidden"},".ms-DetailsRow-cell .ms-Button.is-disabled":{background:"none"},".ms-DetailsRow-cell":{padding:4,".ms-TextField-errorMessage":{whiteSpace:"normal"}},".ms-Button--commandBar":{padding:"8px 6px",width:"auto"},".ms-TextField":{maxWidth:"inherit"},".ms-TextField-fieldGroup, input, textarea":{maxWidth:"initial"}},colorPicker:{".ba-ColorInput":{paddingBlockStart:6},".ba-ColorInput-labelContainer, .ba-ColorInput-colorTextField":{display:"none"},".ba-ColorInput-colorBox, .ba-ColorInput-colorBoxDisabled":{maxHeight:20,maxWidth:20}},additionalPropertiesCallout:{textArea:{minWidth:252},h2:{fontSize:20,fontWeight:600}},columnRequired:{height:26,".ms-DetailsHeader-cellName":{"::after":{content:'" *"',color:null!==(n=null==r?void 0:r.redDark)&&void 0!==n?n:"#a4262c"}}},handleIcon:{fontSize:16,height:"100%"},statusReasonDropdown:{overflow:"hidden",maxWidth:"none !important",".ms-Dropdown-title":{fontWeight:600,border:"none"}},onDragEnterItem:{"&.ms-DetailsRow":{borderBottom:"1px solid",borderBottomColor:(null==r?void 0:r.themeSecondary)||"#8d308d"}},onDragEnterItemTopBorder:{"&.ms-DetailsRow":{borderTop:"1px solid",borderTopColor:(null==r?void 0:r.themeSecondary)||"#8d308d"}}}}},21624:function(e,t,n){"use strict";n.d(t,"e",(function(){return b})),n.d(t,"b",(function(){return v})),n.d(t,"d",(function(){return h})),n.d(t,"f",(function(){return O})),n.d(t,"a",(function(){return y})),n.d(t,"c",(function(){return g}));var r=n(12139),o=n(11666),i=n(12661),a=n(11712),c=n(10926),l=n.n(c),u=n(21611),s=n(21517),d=n(21625),p=n(21626),f=n(21627),m=n(21628),b=e=>{var{classNames:t}=e;return l.a.createElement(r.a,{verticalAlign:"center",className:null==t?void 0:t.handleIcon},l.a.createElement(o.a,{iconName:"GripperDotsVertical"}))},v=e=>{var{dispatch:t,choice:n,isReadonlyMode:r}=e;return l.a.createElement(d.a,{key:n.id,formValues:{tableColor:n.color},setFormValues:e=>{t({type:p.a.setChoiceColor,payload:{choiceId:n.id,color:e.tableColor}})},disabled:r})},h=e=>{var t,{t:n,choice:r,index:o,dispatch:a,choicesList:c,shouldAutoFocus:s,isReadonlyMode:d}=e,f=c.length>1&&o===c.length-1,m=u.a;return l.a.createElement(i.a,{name:m,"data-testid":m,value:null!==(t=r.label)&&void 0!==t?t:"",ariaLabel:null==n?void 0:n("ChoicesPanel.ChoicesForm.Label"),autoFocus:s&&f,disabled:d,validateOnLoad:!1,"aria-required":!0,onGetErrorMessage:e=>""===e.trim()?null==n?void 0:n("ChoicesPanel.ChoicesForm.BlankLabel"):void 0,onNotifyValidationResult:e=>{var t=r.id+m;a(e?{type:p.a.addInvalidRow,payload:{rowId:t}}:{type:p.a.removeInvalidRow,payload:{rowId:t}})},onChange:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return a({type:p.a.setChoiceLabel,payload:{choiceId:null!==(t=r.id)&&void 0!==t?t:0,label:n}})}})},O=e=>{var{dispatch:t,choice:n,t:r,choicesList:o,isReadonlyMode:a}=e,d=""===n.value?n.value:+n.value,f=Number.isInteger(d)?(new Intl.NumberFormat).format(d||0):n.value,b=e=>e.replace(/(\.|,)/g,""),{allChoiceOptions:v}=Object(c.useContext)(m.a);return l.a.createElement(i.a,{key:n.id,name:"choiceValue","data-testid":"choiceValue",disabled:a,"aria-required":!0,onCopy:e=>{var t=b(e.currentTarget.value);navigator.clipboard.writeText(t)},value:null!=f?f:"",ariaLabel:null==r?void 0:r("ChoicesPanel.ChoicesForm.Value"),onChange:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t({type:p.a.setChoiceValue,payload:{choiceId:n.id,value:b(r)}})},onGetErrorMessage:e=>{var t,n,i=b(e),a=(null!==(t=null==o||null===(n=o.filter(e=>(null==e?void 0:e.value)===i))||void 0===n?void 0:n.length)&&void 0!==t?t:0)>1,c=v.filter(e=>(null==e?void 0:e.value)===i).length>1,l=""===e,d=Number.isInteger(+i),p=Object(u.h)(d?Number(i):-1);return l?null==r?void 0:r("ChoicesPanel.ChoicesForm.ValueCannotBeEmpty"):a?null==r?void 0:r("ChoicesPanel.ChoicesForm.ValueAlreadyExists"):c?null==r?void 0:r("ChoicesPanel.ChoicesForm.ValueAlreadyExistsInAnotherStatus"):d?p?"":null==r?void 0:r("ChoicesPanel.ChoicesForm.ValueMustBeInRange",{minValue:s.c.valueMinValue,maxValue:s.c.valueMaxValue}):null==r?void 0:r("ChoicesPanel.ChoicesForm.ValueMustBeInteger")},onNotifyValidationResult:e=>{var r=n.id+"choiceValue";t(e?{type:p.a.addInvalidRow,payload:{rowId:r}}:{type:p.a.removeInvalidRow,payload:{rowId:r}})},validateOnLoad:!1})},y=e=>{var t,n,r,{dispatch:o,choice:i,t:a,classNames:c,isReadonlyMode:u=!1}=e;return l.a.createElement(f.a,{t:a,description:null!==(t=i.description)&&void 0!==t?t:"",externalValue:null!==(n=i.externalValue)&&void 0!==n?n:"",setExternalValue:e=>{o({type:p.a.setChoiceExternalValue,payload:{choiceId:i.id,externalValue:e}})},setDescription:e=>{o({type:p.a.setChoiceDescription,payload:{choiceId:i.id,description:e}})},isReadonlyMode:u,additionalPropertiesCalloutClassName:null!==(r=null==c?void 0:c.additionalPropertiesCallout)&&void 0!==r?r:""})},g=e=>{var{dispatch:t,choice:n,isDisabled:r,t:o}=e;return l.a.createElement(a.a,{iconProps:{iconName:"Delete"},onClick:()=>{t({type:p.a.deleteChoice,payload:{choiceId:n.id}})},disabled:r,ariaLabel:o("ChoicesPanel.ChoicesForm.Delete")})}},21626:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){return e.setFormError="setFormError",e.addInvalidRow="addInvalidRow",e.removeInvalidRow="removeInvalidRow",e.updateName="updateName",e.updateDescription="updateDescription",e.updateDisplayName="updateDisplayName",e.addChoice="addChoice",e.deleteChoice="deleteChoice",e.setChoiceColor="setChoiceColor",e.setChoiceDescription="setChoiceDescription",e.setChoiceLabel="setChoiceLabel",e.setChoiceValue="setChoiceValue",e.setChoiceExternalValue="setChoiceExternalValue",e.moveChoice="moveChoice",e.sortChoices="sortChoices",e.updateExternalTypeName="updateExternalTypeName",e.setDefaultChoice="setDefaultChoice",e}({})},21627:function(e,t,n){"use strict";var r=n(11712),o=n(13093),i=n(12139),a=n(12839),c=n(12661),l=n(11823),u=n(11824),s=n(11648),d=n(11645),p=n(10926),f=n.n(p);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.a=e=>{var{t:t,description:n,externalValue:m,setDescription:v,setExternalValue:h,additionalPropertiesCalloutClassName:O,isReadonlyMode:y}=e,[g,j]=Object(p.useState)(!0),[C,S]=Object(p.useState)({description:n,externalValue:m}),[P,{toggle:w}]=Object(s.a)(!1),E=Object(d.a)("choiceCallout"),N=Object(p.useCallback)(()=>{v(C.description),h(C.externalValue),j(!0),w()},[v,h,j,w,C.description,C.externalValue]),D=Object(p.useCallback)(()=>{j(!0),w()},[j,w]);return f.a.createElement(f.a.Fragment,null,f.a.createElement(r.a,{iconProps:{iconName:"Equalizer"},onClick:w,id:E,ariaLabel:t("ChoicesPanel.ChoicesForm.AdditionalProperties")}),P&&f.a.createElement(o.a,{onDismiss:D,target:"#".concat(E),className:O,focusTrapProps:{isClickableOutsideFocusTrap:!0}},f.a.createElement(i.a,{tokens:{padding:"16px 24px",childrenGap:16}},f.a.createElement(i.a,{horizontal:!0,horizontalAlign:"space-between"},f.a.createElement(a.a,{as:"h2"},t("ChoicesPanel.ChoicesForm.AdditionalProperties")),f.a.createElement(r.a,{onClick:D,ariaLabel:t("Common.Close"),iconProps:{iconName:"Cancel"}})),f.a.createElement(c.a,{label:t("Form.Description"),name:"choiceDescription",defaultValue:n,multiline:!0,rows:3,resizable:!1,onChange:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";j(!1),S(b(b({},C),{},{description:t}))},disabled:y}),f.a.createElement(c.a,{name:"choiceExternalValue",label:t("ChoicesPanel.ChoicesForm.ExternalValue"),defaultValue:m,maxLength:64,onChange:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";j(!1),S(b(b({},C),{},{externalValue:t}))},disabled:y}),f.a.createElement(i.a,{horizontal:!0,horizontalAlign:"end",tokens:{childrenGap:8}},f.a.createElement(i.a.Item,null,f.a.createElement(l.a,{text:t("Common.Save"),onClick:N,disabled:g,"data-test-id":"AdditionalPropertiesSaveButton"})),f.a.createElement(i.a.Item,null,f.a.createElement(u.a,{text:t("Common.Cancel"),onClick:D,"data-test-id":"AdditionalPropertiesCancelButton"}))))))}},21628:function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var r=n(12680),o=n(11932),i=n(11934),a=n(11860),c=n(12217),l=n(11465),u=n(11021),s=n(10926),d=n.n(s),p=n(21629),f=n(21517),m=n(21622),b=n(21621),v=["t","choicesList","choiceGroupNames","selectedChoiceGroup","onChoiceGroupNameSelect"];function h(){return(h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var C=Object(s.createContext)({allChoiceOptions:[]});t.b=Object(l.s)(f.b)(e=>{var{t:t,choicesList:n,choiceGroupNames:l,selectedChoiceGroup:f,onChoiceGroupNameSelect:O}=e,g=j(e,v),S=Object(s.useMemo)(()=>{var e;return null!==(e=null==l?void 0:l.map((e,t)=>y(y({},e),{},{key:e.value,text:"".concat(e.name," (").concat(t+1," of ").concat(l.length,")"),title:"".concat(e.name," (").concat(t+1," of ").concat(l.length,")")})))&&void 0!==e?e:[]},[l]),P=Object(s.useMemo)(()=>n.filter(e=>e.state===(null==f?void 0:f.value)),[n,S,f,l,O]),w=Object(s.useCallback)(e=>d.a.createElement(r.a,{calloutProps:{styles:{root:{width:"fit-content"}}},className:e.statusReasonDropdown,options:S,selectedKey:null==f?void 0:f.value,onChange:(e,t)=>{Object(u.fb)(c.h,m.a.ChoicesSelectStateCodeDropdownClick),null==O||O(t)}}),[O,f,S]);return Object(s.useEffect)(()=>{!f&&l&&(null==O||O(null==l?void 0:l[0]))},[f,l,O]),d.a.createElement(C.Provider,{value:{allChoiceOptions:n}},d.a.createElement(o.a,{messageBarType:i.a.info},t("ChoicesPanel.ChoicesForm.StatusReasonMessageBar"),d.a.createElement(a.a,{href:p.a.statusReason,target:"_blank"},t("Common.LearnMore"))),d.a.createElement(b.a,h({},g,{choicesList:P,onRenderTitle:w,selectedChoiceGroup:f})))})},21629:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={statusReason:"https://go.microsoft.com/fwlink/?linkid=2192119",externalTypeName:"https://go.microsoft.com/fwlink/?linkid=2185989"}},21630:function(e,t,n){"use strict";var r=n(12861),o=n(11860),i=n(12139),a=n(12661),c=n(12372),l=n(21631),u=n(21618),s=n(12217),d=n(11466),p=n(11021),f=n(10926),m=n.n(f),b=n(21629),v=n(21517),h=n(21622),O=n(14279),y=n(21626);t.a=Object(d.f)(v.b)(e=>{var{t:t,choice:n,isEditMode:d,columnPrefix:g,shouldDisplayNameSetName:j,isReadonlyMode:C,dispatch:S}=e,{name:P,description:w,externalTypeName:E,isBoolean:N}=n,D=C||N,[x,M]=Object(f.useState)(!1),I=C||d,k=e=>m.a.createElement(O.a,{id:"externalType",customLabelStyles:{root:{margin:"0 0",padding:"5px 0",fontWeight:600}},label:null==e?void 0:e.label,translationFile:v.b,calloutContent:m.a.createElement("span",null,t("ChoicesPanel.ChoicesForm.ExternalTypeCalloutContent")," ",m.a.createElement(o.a,{href:b.a.externalTypeName,target:"_blank"},t("Common.LearnMore")))}),T=Object(f.useCallback)(()=>m.a.createElement(i.a,null,m.a.createElement(a.a,{name:"name",label:t("Form.Name"),prefix:I?void 0:g,ariaLabel:t("Form.Name"),required:!0,"aria-required":!0,disabled:I,"data-test-id":t("Form.Name"),maxLength:v.c.nameMaxLength,value:I?P:Object(u.g)(null!=P?P:"",g),onGetErrorMessage:e=>Object(u.f)(/^[A-Za-z]\w*$/,e,t("Form.MustStartWithLetterAndContinue")),onNotifyValidationResult:e=>{S(e?{type:y.a.addInvalidRow,payload:{rowId:"name"}}:{type:y.a.removeInvalidRow,payload:{rowId:"name"}})},validateOnLoad:!1,onChange:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=""===t?t:g+t;S({type:y.a.updateName,payload:{name:n}})}}),m.a.createElement(a.a,{rows:3,maxLength:64,name:"externalTypeName",onRenderLabel:k,label:t("Form.ExternalTypeName"),ariaLabel:t("Form.ExternalTypeName"),defaultValue:null!=E?E:"",disabled:D,onChange:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return S({type:y.a.updateExternalTypeName,payload:{externalTypeName:t}})}}),m.a.createElement(a.a,{rows:3,name:"description",label:t("Form.Description"),ariaLabel:t("Form.Description"),defaultValue:null!=w?w:"",disabled:D,resizable:!1,multiline:!0,onChange:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return S({type:y.a.updateDescription,payload:{description:t}})}})),[w,P,C,g,d,j,S]);return m.a.createElement(i.a.Item,null,m.a.createElement(r.Accordion,{text:t("Form.AdvancedOptions"),"data-test-id":"ChoicesPanelAdvancedOptions",onRenderContent:T,isHiddenOnDismiss:!0,styles:l.a,buttonAs:c.a,"aria-expanded":x,onOpen:()=>{Object(p.fb)(s.h,h.a.ChoicesPanelAdvancedOptionsClick),M(!0)},onClose:()=>{M(!1)}}))})},21632:function(e,t,n){"use strict";n.d(t,"b",(function(){return O}));var r=n(14328),o=n(11885),i=n(12353),a=n(10926),c=n(21611),l=n(21622),u=n(21626),s=n(13556),d=n(11021);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;return f({color:"",description:"",label:t,value:e.toString(),id:Object(c.d)(),metadataId:""},void 0!==n?{state:n}:{})},v={displayName:"",description:"",name:"",metadataId:"",externalTypeName:"",introducedVersion:"",isGlobal:!0,isCustom:!0,isManaged:!1,isCustomizable:!0,isBoolean:!1,optionSetType:o.p.Picklist,options:[]},h={choice:v,formError:"",isValid:!1,isEditMode:!1,invalidRows:new Set,shouldDisplayNameSetName:!0,defaultChoice:-1,newChoiceBaseValue:1},O=e=>e===h,y=(e,t)=>{switch(t.type){case u.a.updateDisplayName:var{isEditMode:n,shouldDisplayNameSetName:o,choice:a}=e,{displayName:l,namePrefix:s}=t.payload,d=!n&&o?s.concat(Object(r.b)(null!=l?l:"")):a.name;return f(f({},e),{},{choice:f(f({},a),{},{displayName:l,name:d})});case u.a.updateName:return f(f({},e),{},{shouldDisplayNameSetName:!1,choice:f(f({},e.choice),{},{name:t.payload.name})});case u.a.updateExternalTypeName:return f(f({},e),{},{choice:f(f({},e.choice),{},{externalTypeName:t.payload.externalTypeName})});case u.a.updateDescription:return f(f({},e),{},{choice:f(f({},e.choice),{},{description:t.payload.description})});case u.a.addInvalidRow:var{invalidRows:p}=e,m=t.payload.rowId;return f(f({},e),{},{invalidRows:new Set(p).add(m),isValid:!1});case u.a.removeInvalidRow:var v=t.payload.rowId,{invalidRows:h}=e,O=new Set(h);return O.delete(v),f(f({},e),{},{invalidRows:O,isValid:!O.size});case u.a.setFormError:return f(f({},e),{},{formError:t.payload.formError});case u.a.addChoice:var{state:y}=t,{choice:C,newChoiceBaseValue:S,invalidRows:P}=e,w=g(C.options,S),E=b(w,"",y),N=[...C.options,E],D=Object(c.c)(E.id),x=new Set(P).add(D);return f(f({},e),{},{invalidRows:x,isValid:!1,choice:f(f({},C),{},{options:N})});case u.a.deleteChoice:var{choiceId:M}=t.payload,{choice:{options:I},invalidRows:k}=e,T=I.findIndex(e=>e.id===M),R=I.slice(0,T).concat(I.slice(T+1)),F=new Set(k);return F.forEach(e=>e.startsWith(M)&&F.delete(e)),f(f({},e),{},{invalidRows:F,isValid:!F.size,choice:f(f({},e.choice),{},{options:R})});case u.a.moveChoice:var{payload:{choice:V,beforeIndex:A}}=t,{choice:{options:L}}=e,B=L.filter(e=>e.id!==V.id),G=B.slice(0,A).concat([V,...B.slice(A)]);return f(f({},e),{},{choice:f(f({},e.choice),{},{options:G})});case u.a.sortChoices:var{payload:{isDescending:U}}=t,{choice:{options:q}}=e,W=Object(i.orderBy)(q,"label",U?"desc":"asc");return f(f({},e),{},{choice:f(f({},e.choice),{},{options:W})});case u.a.setDefaultChoice:var{defaultChoice:z}=t.payload;return f(f({},e),{},{defaultChoice:z});case u.a.setChoiceLabel:var{choiceId:H,label:Q}=t.payload,J=e.choice.options.findIndex(e=>e.id===H);return j(e,J,"label",null!=Q?Q:"");case u.a.setChoiceValue:var{choiceId:Y,value:Z}=t.payload,_=e.choice.options.findIndex(e=>e.id===Y);return j(e,_,"value",null!=Z?Z:"");case u.a.setChoiceColor:var{choiceId:K,color:X}=t.payload,$=e.choice.options.findIndex(e=>e.id===K);return j(e,$,"color",null!=X?X:"");case u.a.setChoiceDescription:var{choiceId:ee,description:te}=t.payload,ne=e.choice.options.findIndex(e=>e.id===ee);return j(e,ne,"description",null!=te?te:"");case u.a.setChoiceExternalValue:var{choiceId:re,externalValue:oe}=t.payload,ie=e.choice.options.findIndex(e=>e.id===re);return j(e,ie,"externalValue",null!=oe?oe:"");default:return e}};function g(e,t){var n=!!e.length?e.map(e=>Number(e.value)).filter(c.i):[],r=Object(c.f)(t).toString(),o=n.filter(e=>e.toString().startsWith(r));return(o.length?Math.max(...o):t)+1}function j(e,t,n,r){var{choice:{options:o}}=e;return f(f({},e),{},{choice:f(f({},e.choice),{},{options:o.map((e,o)=>o===t?f(f({},e),{},{[n]:r}):e)})})}t.a=(e,t,n,r)=>{var u,p=Object(a.useMemo)(()=>b(t.newChoiceBaseValue),[]),m=!!e||!n||!(null!==(u=r)&&void 0!==u&&u.length)||(null==t?void 0:t.isChoiceBooleanType),O=!1,j=[];if(!m)try{var C,S,P;t.isMultiChoiceChecked&&(r=r?Object(i.flatMap)(r,e=>e.split(",")):void 0),null===(S=r=r?[...null===(C=new Set(r))||void 0===C?void 0:C.values()]:void 0)||void 0===S||S.sort((e,t)=>null==e?void 0:e.localeCompare(null==t?void 0:t.toString())),null===(P=r)||void 0===P||P.forEach(e=>{var n;if(null!=e&&null!==(n=e.trim())&&void 0!==n&&n.length){var r=j.length>=1?g(j,t.newChoiceBaseValue):t.newChoiceBaseValue,o=b(r,e);j.push(o),O=!0}})}catch(N){var w;Object(d.U)(s.c,{eventName:l.a.ErrorGettingListOptionChoicesSimpleColumn,eventData:{dataRowsCount:null===(w=r)||void 0===w?void 0:w.length}})}j.length||(j=[p]);var E=e?Object.assign(h,f({choice:f(f({},e),{},{options:[...e.options]||!1}),isEditMode:!0,isValid:!0,newChoiceBaseValue:t.newChoiceBaseValue,invalidRows:new Set},void 0!==(null==t?void 0:t.defaultChoiceValue)?{defaultChoice:null==t?void 0:t.defaultChoiceValue}:{})):Object.assign(h,{choice:f(f(f({},v),{},{options:j},n?{isGlobal:!1}:{}),n?{isCustomizable:!0}:{}),isEditMode:!1,isValid:O,newChoiceBaseValue:t.newChoiceBaseValue,invalidRows:O?new Set:new Set([Object(c.c)(j[0].id)]),defaultChoice:-1});return e&&!n||E.choice.isBoolean||null==t||!t.isChoiceBooleanType?e&&!n||!E.choice.isBoolean||null!=t&&t.isChoiceBooleanType||(E.choice.isBoolean=!1,E.choice.optionSetType=o.p.Picklist,E.choice.options=j,Object.assign(E,{isValid:O,invalidRows:O?new Set:new Set([Object(c.c)(j[0].id)])})):(Object.assign(E,{isValid:!0,invalidRows:new Set}),E.choice.isBoolean=!0,E.choice.isGlobal=!1,E.choice.optionSetType=o.p.Boolean,E.choice.options=[b(0,null==t?void 0:t.noLabel),b(1,null==t?void 0:t.yesLabel)]),Object(a.useReducer)(y,E)}},21633:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21631),o=e=>{var t,n=null==e||null===(t=e.theme)||void 0===t?void 0:t.palette;return{commands:{display:"none"},panelHeader:{paddingInline:r.c,paddingBlock:14,color:(null==n?void 0:n.neutralPrimary)||"#323130",h1:{fontSize:20,fontWeight:600}},mainContentArea:{paddingInline:0,paddingBlockEnd:r.c,"> .ms-Stack":{paddingInline:r.c,gap:r.c,paddingBlock:4},".ms-TextField-fieldGroup, input, textarea":{maxWidth:308},".ba-Accordion":{".ba-Accordion-header":{marginTop:0}},".ba-Accordion-content > .ms-Stack":{display:"flex",gap:r.c},".ms-Spinner":{height:"100%"}},headerCloseButtonLabel:{color:(null==n?void 0:n.neutralSecondary)||"#605E5C"},panelFooter:{padding:r.c,"@media screen and (-ms-high-contrast: active), (forced-colors: active)":{".is-disabled":{opacity:"50%"}}},messageBar:{paddingBlock:2,paddingInline:6}}}},21634:function(e,t,n){"use strict";var r=n(12139),o=n(11823),i=n(11824),a=n(11465),c=n(10926),l=n.n(c),u=n(21631),s=n(21517);t.a=Object(a.s)(s.b)(e=>{var{t:t,isSaveDisabled:n,isCancelDisabled:a,onSaveClick:c,onCancelClick:s,footerClassName:d}=e;return l.a.createElement(r.a,{horizontal:!0,tokens:{childrenGap:u.c},className:d},l.a.createElement(o.a,{disabled:n,text:t("Common.Save"),id:"ChoicePanelFooter_Save",onClick:c}),l.a.createElement(i.a,{disabled:a,text:t("Common.Cancel"),id:"ChoicePanelFooter_Cancel",onClick:s}))})},21635:function(e,t,n){"use strict";var r=n(11712),o=n(12671),i=n(11932),a=n(11934),c=n(12139),l=n(11465),u=n(10926),s=n.n(u),d=n(21517);t.a=Object(l.s)(d.b)(e=>{var{t:t,classNames:n,title:l,formError:d,onDismiss:p,onBack:f}=e,[m,b]=Object(u.useState)(!1);return Object(u.useEffect)(()=>{d&&b(!0)},[d,b]),s.a.createElement(s.a.Fragment,null,s.a.createElement(c.a,{className:n.panelHeader,horizontal:!0,horizontalAlign:"space-between",wrap:!1},s.a.createElement(c.a,{horizontal:!0,horizontalAlign:"center",tokens:{childrenGap:8}},f&&s.a.createElement(r.a,{iconProps:{iconName:"Back"},ariaLabel:t("Common.Back"),onClick:f}),s.a.createElement("h1",null,l)),s.a.createElement(c.a,null,s.a.createElement(o.a,{content:t("Common.Close")},s.a.createElement(r.a,{ariaLabel:t("Common.Close"),iconProps:{iconName:"Cancel"},id:"ChoicePanelHeader_CancelButton",onClick:()=>p(),className:n.headerCloseButtonLabel})))),s.a.createElement(c.a.Item,null,m&&d&&s.a.createElement(i.a,{messageBarType:a.a.error,onDismiss:()=>b(!1),dismissButtonAriaLabel:t("Common.Close")},d)))})},21879:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i}));var r={aboutColumns:"https://go.microsoft.com/fwlink/?linkid=2192539",searchable:"https://go.microsoft.com/fwlink/?linkid=2192541",behavior:"https://go.microsoft.com/fwlink/?linkid=869151",autoNumber:{seedValue:"https://go.microsoft.com/fwlink/?linkid=2069334",format:"https://go.microsoft.com/fwlink/?linkid=2068054"},formulaColumns:"https://go.microsoft.com/fwlink/?linkid=2199626",schemaName:"https://go.microsoft.com/fwlink/?linkid=869153",requiredLevel:"https://go.microsoft.com/fwlink/?linkid=2192540",isSecured:"https://go.microsoft.com/fwlink/?linkid=2192451",globalSearch:"https://go.microsoft.com/fwlink/?linkid=2192452",sortable:"https://go.microsoft.com/fwlink/?linkid=2192542",isAuditEnabled:"https://go.microsoft.com/fwlink/?linkid=2192453",dataType:"https://go.microsoft.com/fwlink/?linkid=2069351",previewTerms:"https://go.microsoft.com/fwlink/?linkid=2225468",privacyStatement:"https://privacy.microsoft.com/en-US/data-privacy-notice"},o=(e,t,n,r)=>{var o="".concat(e,"tools/systemcustomization/calculatedfields/manageCalculatedFields.aspx?BRlaunchpoint=AttributeEditor&appSolutionId={").concat(t,"}&attributeId={").concat(r,"}&entityId={").concat(n,"}");return encodeURI(o)};function i(e,t,n,r){var o="".concat(e,"tools/systemcustomization/RollupFields/manageRollupFields.aspx?BRlaunchpoint=AttributeEditor&appSolutionId={").concat(t,"}&attributeId={").concat(r,"}&entityId={").concat(n,"}");return encodeURI(o)}},21910:function(e,t,n){"use strict";n.d(t,"c",(function(){return G})),n.d(t,"d",(function(){return U})),n.d(t,"b",(function(){return q})),n.d(t,"e",(function(){return W})),n.d(t,"a",(function(){return z})),n.d(t,"f",(function(){return H}));var r=n(14226),o=n(14426),i=n(11885),a=n(19360),c=n(11853),l=n(12313),u=n(13771),s=n(21610),d=n(11868),p=n(11021),f=n(12219),m=n(12353),b=n(10926),v=n(21911),h=n(21913),O=n(21915),y=n(21916),g=n(21917),j=n(21918),C=n(21922),S=n(21919),P=n(21923),w=n(21609),E=n(21924),N=n(21926),D=n(21927),x=n(14430),M=n(21608),I=n(21938),k=n(21939),T=n(13770),R=n(13556);function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L(e,t,n,r,o,i,a){try{var c=e[i](a),l=c.value}catch(u){return void n(u)}c.done?t(l):Promise.resolve(l).then(r,o)}function B(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){L(i,r,o,a,c,"next",e)}function c(e){L(i,r,o,a,c,"throw",e)}a(void 0)}))}}function G(e){var{tableId:t,columnId:n,telemetryScope:r,tableName:o,crmAttributeType:i,enabled:a,refetchQuery:c,defaultErrorMessage:u}=e,s=Object(b.useRef)(),[d,f]=Object(b.useState)(""),[m,v]=Object(b.useState)(void 0),{isInitialLoading:h,refetch:O,isFetching:y}=Object(l.a)(["powerapps-ui-common","GetColumnById",t,n],B((function*(){return yield Y(t,n,i,o)})),{enabled:a,staleTime:0,cacheTime:0,onSuccess:e=>{v(e),s.current.complete({columnData:null==e?void 0:e.id}),f(""),s.current=void 0},onError:e=>{var t;v(void 0),f((null==e?void 0:e.message)||u),null===(t=s.current)||void 0===t||t.failure({error:e}),s.current=void 0}});return Object(b.useEffect)(()=>{(h||y)&&(s.current=Object(R.j)(r,R.g.getCdsColumnById,R.d.DataExperience,R.e.DataFetchHooks,p.j.PowerappsPortal,p.f.Medium))},[h,y]),Object(b.useEffect)(()=>{c&&O&&a&&O()},[c,a]),{loading:!!h,fetching:!!y,errorMessage:d,column:m}}function U(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5?arguments[5]:void 0,a=!o,c=R.g.getColumnByName,u=Object(b.useRef)(),[s,f]=Object(b.useState)(""),[m,v]=Object(b.useState)(void 0),{isInitialLoading:h,isFetching:O,refetch:y}=Object(l.a)(["powerapps-ui-common","GetColumnByLogicalNameQuery",e,t],B((function*(){var n={headers:{Consistency:"Strong"},method:"get"},r=Object(I.d)(e,t),o=yield Object(d.f)(r,n);return Object(N.j)(null==o?void 0:o.data)})),{enabled:a,onSuccess:e=>{var t;v(e),null===(t=u.current)||void 0===t||t.complete({columnId:null==e?void 0:e.id}),f(""),u.current=void 0},onError:e=>{var t;v(void 0),f((null==e?void 0:e.message)||r),null===(t=u.current)||void 0===t||t.failure({error:e}),u.current=void 0}});return Object(b.useEffect)(()=>{i&&a&&y&&y()},[i,a]),Object(b.useEffect)(()=>{(h||O)&&(u.current=Object(R.j)(n,c,R.d.DataExperience,R.e.DataFetchHooks,p.j.PowerappsPortal,p.f.Medium))},[h,O]),{loading:h,fetching:O,errorMessage:s,column:m}}function q(e,t,n,r,o){var i,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6?arguments[6]:void 0,u=Object(R.j)(n,R.g.useGetAttributeByLogicalName,R.d.DataExperience,R.e.DataFetchHooks,r,p.f.Medium),{currentEnvironment:s,hasDataverse:d}=Object(f.W)(),m=!!s&&d&&!a,v=Object(l.a)({queryKey:["powerapps-ui-common","GetAttributeByLogicalName",e,t,null==s?void 0:s.name],queryFn:(i=B((function*(){return oe(s,e,t)})),function(){return i.apply(this,arguments)}),enabled:m,onSuccess:e=>{null==u||u.complete()},onError:e=>null==u?void 0:u.failure(e)});return Object(b.useEffect)(()=>{c&&v.refetch&&m&&v.refetch()},[c,m,v]),{column:v.data,loading:v.isLoading,errorMessage:v.error?Object(T.c)(v.error,o):""}}function W(e,t,n,r,o){var i=R.g.getCdsColumnsDefaultInfo,a=Object(b.useRef)(),[c,u]=Object(b.useState)(""),{isInitialLoading:s,isFetching:f,data:m,refetch:v}=Object(l.a)(["powerapps-ui-common","useGetColumnsDefaultInfoQuery",e],B((function*(){var t,n,r=yield d.f.get("".concat(Object(k.b)(e),"/").concat(I.a));return(null==r||null===(t=r.data)||void 0===t||null===(n=t.value)||void 0===n?void 0:n.map(e=>Object(N.k)(e)))||[]})),{enabled:r,staleTime:0,cacheTime:0,onSuccess:e=>{var t;null===(t=a.current)||void 0===t||t.complete({columnsLength:null==e?void 0:e.length}),u(""),a.current=void 0},onError:e=>{var t;u((null==e?void 0:e.message)||n),null===(t=a.current)||void 0===t||t.failure({error:e}),a.current=void 0}});return Object(b.useEffect)(()=>{(s||f)&&(a.current=Object(R.j)(t,i,R.d.DataExperience,R.e.DataFetchHooks,p.j.PowerappsPortal,p.f.Medium))},[s,f]),Object(b.useEffect)(()=>{o&&v&&r&&v()},[o,r]),{loading:!!s,fetching:!!f,errorMessage:c,columns:m}}function z(e,t){var n=R.g.createColumn,r=Object(b.useRef)(),[o,i]=Object(b.useState)(""),{mutate:a,isLoading:c,data:l}=Q({onSuccess:()=>{var e;null===(e=r.current)||void 0===e||e.complete(),i("")},onError:e=>{var n;i((null==e?void 0:e.message)||t),null===(n=r.current)||void 0===n||n.failure({error:e})}});return Object(b.useEffect)(()=>{c&&(r.current=Object(R.j)(e,n,R.d.DataExperience,R.e.DataFetchHooks,p.j.PowerappsPortal,p.f.Medium))},[c]),{createColumn:a,loading:c,errorMessage:o,columnCreated:null==l?void 0:l.createColumn}}function H(e,t){var{currentEnvironment:n}=Object(f.W)(),r=n?Object(c.t)(n):"0",o=R.g.updateColumn,i=Object(b.useRef)(),[a,l]=Object(b.useState)(""),{mutate:u,isLoading:s,data:d}=J({onSuccess:()=>{var e;null===(e=i.current)||void 0===e||e.complete(),l("")},onError:e=>{var n;l((null==e?void 0:e.message)||t),null===(n=i.current)||void 0===n||n.failure({error:e})}},r||"0");return Object(b.useEffect)(()=>{s&&(i.current=Object(R.j)(e,o,R.d.DataExperience,R.e.DataFetchHooks,p.j.PowerappsPortal,p.f.Medium))},[s,e,o]),{updateColumn:u,loading:s,errorMessage:a,columnUpdated:null==d?void 0:d.updateColumn}}var Q=e=>Object(u.a)(function(){var e=B((function*(e){var t,n,r,o=V(V({Consistency:"Strong","Accept-Language":null==e?void 0:e.localeString},null==e||!e.solutionUniqueName||null!=e&&e.isPreferredSolutionFeatureEnabled?{}:{"MSCRM.SolutionUniqueName":null==e?void 0:e.solutionUniqueName}),{},{"MSCRM.MergeLabels":"true","Content-Type":"application/json"}),c=Object(N.f)(e.column,e.localeId||1033,e.isFormulaOptionSetEnabled),l={headers:o,method:"post",data:JSON.stringify(c)},u=(null===(t=e.column)||void 0===t?void 0:t.attributeType)===i.d.String&&(null===(n=e.column)||void 0===n?void 0:n.autoNumberFormat),s=u?"".concat(Object(k.c)(e.tableId),"/").concat(I.a):"".concat(Object(k.b)(e.tableId),"/").concat(I.a);try{r=yield Object(d.f)(s,l)}catch(b){var p,f,m;throw new Error(null===(p=b.response)||void 0===p||null===(f=p.data)||void 0===f||null===(m=f.error)||void 0===m?void 0:m.message)}if(204!==r.status&&200!==r.status)throw new Error(r.statusText);return e.tableName&&u&&"number"==typeof e.column.autoNumberSeed&&e.column.autoNumberSeed>=0&&e.column.autoNumberSeed!==a.f&&X(o,e.tableName,e.column.schemaName,e.column.autoNumberSeed),{createColumn:!0}}));return function(t){return e.apply(this,arguments)}}(),{onError:(t,n)=>{var r;null===(r=e.onError)||void 0===r||r.call(e,t,n,void 0)},onSuccess:(t,n)=>{var r;null===(r=e.onSuccess)||void 0===r||r.call(e,t,n,void 0)}}),J=(e,t)=>Object(u.a)(function(){var e=B((function*(e){var n,r=e.localeId||1033,o=e.localeString||"en-US",i=e.column,a=e.tableId,c=e.solutionUniqueName,l=V(V({Accept:"application/json","Accept-Language":o,"Content-Type":"application/json",Consistency:"Strong"},c&&!e.isPreferredSolutionFeatureEnabled?{"MSCRM.SolutionUniqueName":c}:{}),{},{"MSCRM.MergeLabels":"true"}),u=Object(N.g)(i,r),s=Object(N.d)(i),p={headers:l,method:"put",data:JSON.stringify(u)};Object(E.a)(i)&&(yield function(e,t,n,r,o,i){return ne.apply(this,arguments)}(i,a,c||"",r,t,e.isPreferredSolutionFeatureEnabled));try{n=yield Object(d.f)("".concat(Object(k.b)(a),"/").concat(Object(I.b)(null==i?void 0:i.id),"/").concat(s||""),p)}catch(v){var f,m,b;throw new Error(null===(f=v.response)||void 0===f||null===(m=f.data)||void 0===m||null===(b=m.error)||void 0===b?void 0:b.message)}if(204!==n.status&&200!==n.status)throw new Error(n.statusText);return e.tableName&&"number"==typeof i.autoNumberSeed&&i.autoNumberSeed>=0&&X(l,e.tableName,i.schemaName,i.autoNumberSeed),{updateColumn:!0}}));return function(t){return e.apply(this,arguments)}}(),{onError:(t,n)=>{var r;null===(r=e.onError)||void 0===r||r.call(e,t,n,void 0)},onSuccess:(t,n)=>{var r;null===(r=e.onSuccess)||void 0===r||r.call(e,t,n,void 0)}});function Y(e,t,n,r){return Z.apply(this,arguments)}function Z(){return(Z=B((function*(e,t,n,r){var o,i,a=n&&null!==(o=null!==(i=Object(N.b)(n))&&void 0!==i?i:Object(N.c)(n))&&void 0!==o?o:"",c="".concat(a).concat(Object(N.e)(n)),l={headers:{Consistency:"Strong"},method:"get"},u=yield Object(d.f)("".concat(Object(k.b)(e),"/").concat(Object(I.b)(t),"/").concat(n?c:""),l),s=Object(N.j)(null==u?void 0:u.data);if(Object(D.a)(s)&&s.autoNumberFormat){var p,f,m;if(!r){var b=Object(k.b)(e);m=yield Object(d.f)(b,l)}var v=r||(null===(p=m)||void 0===p||null===(f=p.data)||void 0===f?void 0:f.SchemaName);v&&(s.autoNumberSeed=yield _(v,s.schemaName))}return s}))).apply(this,arguments)}function _(e,t){return K.apply(this,arguments)}function K(){return(K=B((function*(e,t){var n,r,o,i={EntityName:e,AttributeName:t},a={headers:{Consistency:"Strong",Accept:"application/json","Content-Type":"application/json"},method:"POST",data:JSON.stringify(i)};try{o=yield Object(d.f)(Object(I.c)(),a)}catch(s){var c,l,u;throw new Error(null===(c=s.response)||void 0===c||null===(l=c.data)||void 0===l||null===(u=l.error)||void 0===u?void 0:u.message)}if(204!==o.status&&200!==o.status)throw new Error(o.statusText);return null===(n=o)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.AutoNumberSeedValue}))).apply(this,arguments)}function X(e,t,n,r){return $.apply(this,arguments)}function $(){return($=B((function*(e,t,n,r){var o,i={EntityName:t,AttributeName:n,Value:r},a={headers:e,method:"POST",data:JSON.stringify(i)};try{o=yield Object(d.f)(Object(I.e)(),a)}catch(s){var c,l,u;throw new Error(null===(c=s.response)||void 0===c||null===(l=c.data)||void 0===l||null===(u=l.error)||void 0===u?void 0:u.message)}if(204!==o.status&&200!==o.status)throw new Error(o.statusText)}))).apply(this,arguments)}function ee(e){var t,n,r,o;return null!==(t=e.choice)&&void 0!==t&&t.isBoolean?[null===(n=e.choice)||void 0===n?void 0:n.trueOption,null===(r=e.choice)||void 0===r?void 0:r.falseOption]:null===(o=e.choice)||void 0===o?void 0:o.options}function te(e,t,n){return null==e?void 0:e.filter(e=>{var r=t.find(t=>t.value===e.value),o=["color","label","metadataId","value",...void 0!==(null==r?void 0:r.state)?[]:["description","externalValue"]];return n.has(e.value)&&!Object(m.isEqual)(Object(m.pick)(e,o),Object(m.pick)(r,o))})}function ne(){return(ne=B((function*(e,t,n,r,a,c){var l=V({Consistency:"Strong"},c?{}:{"MSCRM.SolutionUniqueName":n}),{id:u,attributeType:p,attributeTypeName:f}=e,m=f===i.e.MultiSelectPicklistType,b=yield Y(t,u,m?f:p,""),v=e.attributeType===i.d.Status,{logicalName:h,entityLogicalName:O}=b,y=ee(b),g=ee(e),j=g.map(e=>e.value),C=new Set(y.map(e=>e.value)),S=new Set(j),P=!j.every((e,t)=>{var n;return(null==y||null===(n=y[t])||void 0===n?void 0:n.value)===e}),E=te(g,y,C),N=y.filter(e=>!S.has(e.value)),D=g.filter(e=>!C.has(e.value)),I=Object(M.a)({hasOrderChanged:P,createdOptions:D,updatedOptions:E,deletedOptions:N}),k=p===i.d.Boolean,T=Object(s.a)(a);if(I){var{url:R,requestConfig:F}=Object(w.c)(j,h,l,O);yield Object(d.f)(R,F)}else{var A=[...E.map(e=>Object(w.i)(e,h,l,r,T,O,k)),...D.map(e=>Object(w.a)(e,h,l,r,T,O)),...v&&e.stateCodeDefaultValues?e.stateCodeDefaultValues.map(e=>Object(w.g)(e,"statecode",l,O)):[],...N.map(e=>Object(w.b)(Number(e.value),h,l,O)),...P?[Object(w.f)(j,h,l,O)]:[]],L=Object(o.e)(A,e=>e);yield Promise.all(L.map(e=>Object(x.a)(e)))}return!0}))).apply(this,arguments)}var re=new Map([["Boolean",h.a],["Picklist",S.a],["State",S.a],["Status",S.a],["EntityName",S.a],["PartyList",y.a],["Customer",y.a],["Lookup",y.a],["Owner",y.a],["Integer",C.a],["Double",C.a],["Decimal",C.a],["Money",C.a],["DateTime",O.a],["String",P.b],["Memo",g.a],["MultiSelectPicklist",j.a]]);function oe(e,t,n){return ie.apply(this,arguments)}function ie(){return(ie=B((function*(e,t,n){var o=yield Object(r.c)(e),i=yield o.fetch("Attribute",{entityId:"",entityName:t,name:n,solutionName:""});if(!i)return null;var a=i.AttributeType,c=yield ae(o,a,t,n);if(c&&(i=c),!re.has(a))return v.a(i);if("String"!==a||!P.a(i))return re.get(a)(i);try{var l=yield o.executeAction("AutoNumberSeed","GetAutoNumberSeed",void 0,{EntityName:t,AttributeName:n}),u=yield o.executeAction("AutoNumberSeed","GetNextAutoNumberValue",void 0,{EntityName:t,AttributeName:n});return re.get(a)(V(V({},i),{},{AutoNumberSeed:l.AutoNumberSeedValue,AutoNumberNextValue:u.NextAutoNumberValue}))}catch(s){return re.get(a)(i)}}))).apply(this,arguments)}function ae(e,t,n,r){return ce.apply(this,arguments)}function ce(){return(ce=B((function*(e,t,n,r){var o;switch(t){case"Boolean":o=yield e.fetch("BooleanAttribute",{entityName:n,entityId:"",solutionName:"",name:r},{expand:{OptionSet:{}}});break;case"Picklist":o=yield e.fetch("PicklistAttribute",{entityName:n,entityId:"",solutionName:"",name:r},{expand:{OptionSet:{}}});break;case"State":o=yield e.fetch("StateAttribute",{entityName:n,entityId:"",solutionName:"",name:r},{expand:{OptionSet:{}}});break;case"Status":o=yield e.fetch("StatusAttribute",{entityName:n,entityId:"",solutionName:"",name:r},{expand:{OptionSet:{}}});break;case"MultiSelectPicklist":o=yield e.fetch("MultiSelectPicklistAttribute",{entityName:n,entityId:"",solutionName:"",name:r},{expand:{OptionSet:{}}});break;case"EntityName":o=yield e.fetch("EntityNameAttribute",{entityName:n,entityId:"",solutionName:"",name:r},{expand:{OptionSet:{}}});break;default:return}if(!o)throw new Error("Could not expand "+t);return o}))).apply(this,arguments)}},21911:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l}));var r=n(13752),o=n.n(r),i=n(21912),a=n(19581),c={id:"MetadataId",logicalName:"LogicalName",schemaName:"SchemaName",attributeType:"AttributeType",formulaDefinition:"FormulaDefinition",isCustom:"IsCustomAttribute",isValidForForm:"IsValidForForm",isValidForGrid:"IsValidForGrid",isValidForCreate:"IsValidForCreate",sourceType:"SourceType",isValidForAdvancedFind:"IsValidForAdvancedFind.Value",isRenameable:"IsRenameable.Value",isCustomizable:"IsCustomizable.Value",isManaged:"IsManaged",isValidForUpdate:"IsValidForUpdate",isLogical:"IsLogical",isPrimaryNameField:"IsPrimaryName",isSearchable:"IsSearchable",appearsInGlobalFilter:"IsGlobalFilterEnabled.Value",isSortable:"IsSortableEnabled.Value",isAuditable:"IsAuditEnabled.Value",isSecured:"IsSecured",attributeTypeName:"AttributeTypeName.Value",requiredLevel:e=>i.b(e.RequiredLevel),canRequiredLevelBeChanged:e=>i.a(e.RequiredLevel),format:"Format",formatName:e=>e.FormatName?e.FormatName.Value:void 0,isRequiredForForm:"IsRequiredForForm",displayName:e=>a.a(e.DisplayName)||e.LogicalName,description:e=>a.a(e.Description)};function l(e){return o()(c,e)}},21912:function(e,t,n){"use strict";function r(e){return e?e.Value:null}function o(e){return e?e.CanBeChanged:null}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},21913:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(13752),o=n.n(r),i=n(21914);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=c(c({},n(21911).b),{},{trueOption:e=>i.a(e.OptionSet.TrueOption),falseOption:e=>i.a(e.OptionSet.FalseOption),defaultValue:"DefaultValue"});function s(e){return o()(u,e)}},21914:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(13752),o=n.n(r),i=n(19581),a={displayName:e=>i.a(e.Label)||(e.Value?e.Value.toString():""),description:e=>i.a(e.Description),color:"Color",value:"Value"};function c(e){return o()(a,e)}},21915:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(13752),o=n.n(r),i=n(21912);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=c(c({},n(21911).b),{},{dateTimeBehavior:e=>i.b(e.DateTimeBehavior),canChangeDateTimeBehavior:e=>i.b(e.CanChangeDateTimeBehavior)});function s(e){return o()(u,e)}},21916:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(13752),o=n.n(r);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=a(a({},n(21911).b),{},{targets:"Targets"});function u(e){return o()(l,e)}},21917:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(13752),o=n.n(r);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=a(a({},n(21911).b),{},{maxLength:"MaxLength",yomiOf:"YomiOf"});function u(e){return o()(l,e)}},21918:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21919);function o(e){var t=r.a(e);return t.attributeType="MultiSelectPicklist",t}},21919:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(13752),o=n.n(r),i=n(21920);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=c(c({},n(21911).b),{},{optionSet:e=>e.OptionSet?i.a(e.OptionSet):null,defaultFormValue:"DefaultFormValue"});function s(e){return o()(u,e)}},21920:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(13752),o=n.n(r),i=n(21921),a=n(19581),c=n(21914),l={id:"MetadataId",displayName:e=>a.a(e.DisplayName),options:e=>e.OptionSetType===i.a.Boolean&&(e.TrueOption||e.FalseOption)?[c.a(e.TrueOption),c.a(e.FalseOption)]:e.Options.map(e=>c.a(e)),optionSetType:"OptionSetType"};function u(e){return o()(l,e)}},21921:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){return e.Picklist="Picklist",e.State="State",e.Status="Status",e.Boolean="Boolean",e}({})},21922:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(13752),o=n.n(r);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=a(a({},n(21911).b),{},{maxValue:"MaxValue",minValue:"MinValue",decimalPrecision:"Precision"});function u(e){return o()(l,e)}},21923:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return d}));var r=n(13752),o=n.n(r),i=n(21912);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=c(c({},n(21911).b),{},{maxLength:"MaxLength",formatName:e=>i.b(e.FormatName),yomiOf:"YomiOf",autoNumberFormat:"AutoNumberFormat",autoNumberSeed:"AutoNumberSeed",autoNumberNextValue:"AutoNumberNextValue"});function s(e){return o()(u,e)}function d(e){return!!e.AutoNumberFormat}},21938:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return l}));var r=n(13791);function o(){return"".concat(r.a,"SetAutoNumberSeed")}function i(){return"".concat(r.a,"GetAutoNumberSeed")}var a="Attributes",c=e=>"".concat(a,"(").concat(e,")"),l=(e,t)=>"".concat(r.a,"/EntityDefinitions(").concat(e,")/").concat(a,"(LogicalName = '").concat(t.toLowerCase(),"')/")}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/506.ac5d17b4.chunk.js.map
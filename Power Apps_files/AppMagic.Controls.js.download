"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,OpenAjax,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic,AppMagic;!function(e){!function(e){!function(e){e.AlignInContainer="AlignInContainer",e.AutoHeight="AutoHeight",e.AutoLayoutHeight="#AutoLayoutHeight",e.AutoLayoutWidth="#AutoLayoutWidth",e.AutoLayoutX="#AutoLayoutX",e.AutoLayoutY="#AutoLayoutY",e.AutoWidth="AutoWidth",e.BorderStyle="BorderStyle",e.BorderThickness="BorderThickness",e.ChildTabPriority="ChildTabPriority",e.Conditions="Conditions",e.ContentLanguage="ContentLanguage",e.Data="Data",e.DataField="DataField",e.DataSource="DataSource",e.Default="Default",e.DisplayName="DisplayName",e.EnableChildFocus="EnableChildFocus",e.Error="Error",e.ErrorKind="ErrorKind",e.FieldDisplayName="FieldDisplayName",e.FieldName="FieldName",e.FillPortions="FillPortions",e.Height="Height",e.Image="Image",e.IsErrorMessage="IsErrorMessage",e.Item="Item",e.Items="Items",e.LastSubmit="LastSubmit",e.Layout="Layout",e.LayoutAlignItems="LayoutAlignItems",e.LayoutDirection="LayoutDirection",e.LayoutGap="LayoutGap",e.LayoutHeight="LayoutHeight",e.LayoutJustifyContent="LayoutJustifyContent",e.LayoutMode="LayoutMode",e.LayoutOverflowX="LayoutOverflowX",e.LayoutOverflowY="LayoutOverflowY",e.LayoutWidth="LayoutWidth",e.LayoutWrap="LayoutWrap",e.LayoutX="LayoutX",e.LayoutY="LayoutY",e.Mode="Mode",e.OptimizeForDevices="OptimizeForDevices",e.NewItem="NewItem",e.NumberOfColumns="NumberOfColumns",e.OnHidden="OnHidden",e.OnVisible="OnVisible",e.Order="Order",e.PaddingBottom="PaddingBottom",e.PaddingLeft="PaddingLeft",e.PaddingRight="PaddingRight",e.PaddingTop="PaddingTop",e.PreserveAspectRatio="PreserveAspectRatio",e.Printing="Printing",e.Reset="Reset",e.Size="Size",e.SnapToColumns="SnapToColumns",e.TabIndex="TabIndex",e.TemplateHeight="TemplateHeight",e.TemplatePadding="TemplatePadding",e.TemplateSize="TemplateSize",e.TemplateWidth="TemplateWidth",e.Theme="Theme",e.Text="Text",e.Update="Update",e.Valid="Valid",e.Visible="Visible",e.Width="Width",e.WrapCount="WrapCount",e.X="X",e.Y="Y",e.ZIndex="ZIndex"}(e.OpenAjaxPropertyNames||(e.OpenAjaxPropertyNames={}))}(e.AuthoringTool||(e.AuthoringTool={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t;e.MinimumTemplateWidth=1,e.MinimumTemplateHeight=1,e.listboxIndexFieldName="_listboxIndex_cd91d9fe20c24537a781aa6aeed65b1f",e.dropdownIndexFieldName="_dropDownIndex_da28762f5ba44a28b385d78eeeb66c8a",e.comboboxIndexFieldName="_comboboxIndex_06bc0d5d3b8c450a8326efbcf04c6bef",e.switchVersionDialogDropdownCalloutClassName="switch-version-dialog-dropdown-callout",e.activeScreenClassName="activeScreen",e.activeComponentClassName="activeComponent",e.screenReaderButtonClassName="a11y",e.authoringAreaContextId="authoringArea",e.replicatedTemplateContextId="replicatedTemplate",e.confirmExitMessageAppControlPropertyName="ConfirmExitMessage",e.confirmExitAppControlPropertyName="ConfirmExit",e.frameDuration60FPS=16,e.backEnabledAppControlPropertyName="BackEnabled",function(e){e.data=0,e.design=1,e.behavior=2,e.constantData=3,e.onDemandData=4,e.scope=5,e.unknown=6,e.formulas=7,e.functions=8}(e.PropertyRuleCategory||(e.PropertyRuleCategory={})),function(e){e.videoMinPlayerWidth=300,e.videoMinPlayerHeight=168,e.defaultScaleFactor=3}(e.Video||(e.Video={})),function(e){e.timerVisibilityThreshold=300,e.volumeVisibilityThreshold=215,e.seekbarVisibilityThreshold=90,e.audioMinPlayerWidth=65}(e.Audio||(e.Audio={})),function(e){e.MinLabelAutoHeight=10,e.MinHTMLLabelAutoHeight=10,e.toggleSwitchHandleSize=10,e.controlsFadeDelay=3e3,e.onChangeMediaThrottle=1e3,e.GalleryContentDivClassName="galleryCanvasContentDiv",e.GalleryTemplateClassName="AppMagic.Controls.Gallery.GalleryControl",e.GalleryTemplateTemplateClassName="AppMagic.Controls.Gallery.Template",e.GroupTemplateClassName="AppMagic.Controls.Group",e.GroupContainerTemplateName="groupContainer",e.DataTableTemplateName="dataTable",e.AppTestControlClassName="AppMagic.Controls.AppTest",e.CanvasContentDivClassName="canvasContentDiv",e.GroupContainerVariantNames={HorizontalAutoLayout:"horizontalAutoLayoutContainer",VerticalAutoLayout:"verticalAutoLayoutContainer",Manual:"manualLayoutContainer"},e.GroupContainerVariantKeys={horizontalAutoLayoutContainer:"HorizontalAutoLayout",verticalAutoLayoutContainer:"VerticalAutoLayout",manualLayoutContainer:"Manual"},e.HeroTeamsAppTemplateName="teamsHeroApp",e.HeroTeamsAppTemplateNameVersioned="".concat(e.HeroTeamsAppTemplateName,"_ver1.0"),e.HeroTeamsAppTemplateNamePostfixVersioned="".concat(e.HeroTeamsAppTemplateNameVersioned,"template"),e.CopilotAppHomePageTemplateName="copilotAppHomePage",e.CopilotAppHomePageTemplateNameVersioned="".concat(e.CopilotAppHomePageTemplateName,"_ver1.0"),e.CopilotAppHomePageTemplateNamePostfixVersioned="".concat(e.CopilotAppHomePageTemplateNameVersioned,"template"),e.CopilotAppTablePageTemplateName="copilotAppTablePage",e.CopilotAppTablePageTemplateNameVersioned="".concat(e.CopilotAppTablePageTemplateName,"_ver1.0"),e.CopilotAppTablePageTemplateNamePostfixVersioned="".concat(e.CopilotAppTablePageTemplateNameVersioned,"template"),e.CopilotAppSinglePageTemplateName="copilotAppSinglePage",e.CopilotAppSinglePageTemplateNameVersioned="".concat(e.CopilotAppSinglePageTemplateName,"_ver1.0"),e.CopilotAppSinglePageTemplateNamePostfixVersioned="".concat(e.CopilotAppSinglePageTemplateNameVersioned,"template"),e.CopilotAppSinglePageOfflineTemplateName="copilotAppSinglePage_Offline",e.CopilotAppSinglePageOfflineTemplateNameVersioned="".concat(e.CopilotAppSinglePageOfflineTemplateName,"_ver1.0"),e.CopilotAppSinglePageOfflineTemplateNamePostfixVersioned="".concat(e.CopilotAppSinglePageOfflineTemplateNameVersioned,"template"),e.AutoLayoutHeaderFooterTemplateName="autoLayout_HeaderFooter",e.AutoLayoutHeaderFooterTemplateNameVersioned="".concat(e.AutoLayoutHeaderFooterTemplateName,"_ver1.0"),e.AutoLayoutHeaderFooterTemplateNamePostfixVersioned="".concat(e.AutoLayoutHeaderFooterTemplateNameVersioned,"template"),e.AutoLayoutSidebarTemplateName="autoLayout_Sidebar",e.AutoLayoutSidebarTemplateNameVersioned="".concat(e.AutoLayoutSidebarTemplateName,"_ver1.0"),e.AutoLayoutSidebarTemplateNamePostfixVersioned="".concat(e.AutoLayoutSidebarTemplateNameVersioned,"template"),e.AutoLayoutSplitScreenTemplateName="autoLayout_SplitScreen",e.AutoLayoutSplitScreenTemplateNameVersioned="".concat(e.AutoLayoutSplitScreenTemplateName,"_ver1.0"),e.AutoLayoutSplitScreenTemplateNamePostfixVersioned="".concat(e.AutoLayoutSplitScreenTemplateNameVersioned,"template"),e.AutoLayoutApprovalTemplateName="autoLayout_Approval",e.AutoLayoutApprovalTemplateNameVersioned="".concat(e.AutoLayoutApprovalTemplateName,"_ver1.0"),e.WelcomeLayoutTemplateName="welcomeLayout",e.WelcomeLayoutTemplateNameVersioned="".concat(e.WelcomeLayoutTemplateName,"_ver1.0"),e.HeaderGalleryLayoutTemplateName="headerGalleryLayout",e.HeaderGalleryLayoutTemplateNameVersioned="".concat(e.HeaderGalleryLayoutTemplateName,"_ver1.0"),function(e){e.Container="http://microsoft.com/appmagic/groupContainer",e.DataTable="http://microsoft.com/appmagic/dataTable"}(e.TemplateIds||(e.TemplateIds={})),e.GalleryTemplateVersionIds={Ver4:"ver4.0",Ver5:"ver5.0",PcfCore:"pcfCore",FluentV9:"fluentV9"}}(e.Controls||(e.Controls={})),e.DisplayMode={Disabled:"disabled",Edit:"edit",View:"view"},e.LayoutMode={Manual:"manual",Auto:"auto"},e.LayoutDirection={Horizontal:"row",Vertical:"column"},e.LayoutAlignItems={Start:"flex-start",Center:"center",End:"flex-end",Stretch:"stretch"},e.AlignInContainer={Start:"flex-start",Center:"center",End:"flex-end",Stretch:"stretch",SetByContainer:"auto"},e.LayoutJustifyContent={Start:"flex-start",Center:"center",End:"flex-end",SpaceEvenly:"space-evenly",SpaceAround:"space-around",SpaceBetween:"space-between"},e.LayoutOverflow={Hide:"hidden",Scroll:"auto"},e.ImageRotation={None:"none",Rotate90:"rotate90",Rotate180:"rotate180",Rotate270:"rotate270"},e.Namespaces={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"},e.ControlIdDataAttribute="data-control-id",e.RootContainerDataAttribute="data-pa-is-root",e.RootContainerCssSelector="[".concat(e.RootContainerDataAttribute,"]"),e.ParentItemIdDataAttribute="data-pa-parent-item-id",e.ItemIdDataAttribute="data-pa-item-id",e.ItemTypeDataAttribute="data-pa-type",e.SingleControlType="pa-single-control-container",e.SingleControlCssSelector="[".concat(e.ItemTypeDataAttribute,"='").concat(e.SingleControlType,"']"),e.ItemsContainerType="pa-items-container",e.ItemsContainerCssSelector="[".concat(e.ItemTypeDataAttribute,"='").concat(e.ItemsContainerType,"']"),e.IconControlBuiltInValuePrefix="builtinicon:",e.PublishedCanvasId="publishedCanvas",e.CanvasControlCssClass="app-canvas",e.EntityScope={global:"0",app:Core.FeatureGates.authoring.scopedEntityNames?"1":"0"},e.pdfRequirements=[{requirementPlatform:31,requirementType:3,resource:"/openSource/modified/html2canvas/html2canvas.js",shouldInclude:!0},{requirementPlatform:31,requirementType:3,resource:"/openSource/modified/jspdf/jspdf.umd.js",shouldInclude:!0},{requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-bundle.js",shouldInclude:!0}],e.pdfFontsDancingScriptRequirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-dancing-script-bundle.js",shouldInclude:!0},e.pdfFontsGreatVibesRequirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-great-vibes-bundle.js",shouldInclude:!0},e.pdfFontsLatoRequirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-lato-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansCNJPPart1Requirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-cnjp-part-1-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansCNJPPart2Requirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-cnjp-part-2-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansCNJPItalicPart1Requirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-cnjp-italic-part-1-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansCNJPItalicPart2Requirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-cnjp-italic-part-2-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansCNJPBoldPart1Requirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-cnjp-bold-part-1-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansCNJPBoldPart2Requirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-cnjp-bold-part-2-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansCNJPBoldItalicPart1Requirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-cnjp-bold-italic-part-1-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansCNJPBoldItalicPart2Requirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-cnjp-bold-italic-part-2-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansCNJPLightPart1Requirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-cnjp-light-part-1-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansCNJPLightPart2Requirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-cnjp-light-part-2-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansCNJPLightItalicPart1Requirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-cnjp-light-italic-part-1-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansCNJPLightItalicPart2Requirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-cnjp-light-italic-part-2-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansDevanagariRequirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-devanagari-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansKRRequirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-kr-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansKRItalicPart1Requirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-kr-italic-part-1-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansKRItalicPart2Requirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-kr-italic-part-2-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansKRBoldRequirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-kr-bold-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansKRBoldItalicPart1Requirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-kr-bold-italic-part-1-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansKRBoldItalicPart2Requirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-kr-bold-italic-part-2-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansKRLightRequirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-kr-light-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansKRLightItalicPart1Requirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-kr-light-italic-part-1-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansKRLightItalicPart2Requirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-kr-light-italic-part-2-bundle.js",shouldInclude:!0},e.pdfFontsNotoSansThaiRequirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-noto-sans-thai-bundle.js",shouldInclude:!0},e.pdfFontsOpenSansRequirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-open-sans-bundle.js",shouldInclude:!0},e.pdfFontsOpenSansCondensedRequirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-open-sans-condensed-bundle.js",shouldInclude:!0},e.pdfFontsPatrickHandRequirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-patrick-hand-bundle.js",shouldInclude:!0},e.pdfFontsSegoeUIRequirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-segoe-ui-bundle.js",shouldInclude:!0},e.pdfFontsSegoeUISymbolRequirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-segoe-ui-symbol-bundle.js",shouldInclude:!0},e.pdfFontsSegoeUISymbolBoldRequirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-segoe-ui-symbol-bold-bundle.js",shouldInclude:!0},e.pdfFontsArialRequirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-arial-bundle.js",shouldInclude:!0},e.pdfFontsVerdanaRequirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-verdana-bundle.js",shouldInclude:!0},e.pdfFontsGeorgiaRequirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-georgia-bundle.js",shouldInclude:!0},e.pdfFontsCourierNewRequirement={requirementPlatform:31,requirementType:3,resource:"/js/powerapps-pdffonts-courier-new-bundle.js",shouldInclude:!0},e.saxRequirement={requirementPlatform:31,requirementType:3,resource:"/openSource/unmodified/sax/sax.js",shouldInclude:!0},e.DropShadowStyles=((t={}).none="none",t.light="0px 1px 2px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)",t.semilight="0px 2px 4px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)",t.regular="0px 4px 8px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)",t.semibold="0px 8px 16px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)",t.bold="0px 14px 28.8px rgba(0, 0, 0, 0.24), 0px 0px 8px rgba(0, 0, 0, 0.2)",t.extrabold="0px 32px 64px rgba(0, 0, 0, 0.24), 0px 0px 8px rgba(0, 0, 0, 0.2)",t)}(e.Constants||(e.Constants={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n;t.isDelayControlRenderingEnabled=!1,t.enableDelayControlRendering=function(e){t.isDelayControlRenderingEnabled=e},t.isDynamicSchemaEnabled=Core.FeatureGates.documentPreviewFlags.dynamicSchema,t.enableDynamicSchema=function(e){t.isDynamicSchemaEnabled=e},t.isPcfModernDataSetsEnabled=!1,t.enablePcfModernDataSets=function(e){t.isPcfModernDataSetsEnabled=e},t.isImprovedMediaCaptureEnabled=!1,t.enableImprovedMediaCapture=function(e){t.isImprovedMediaCaptureEnabled=e},t.isFluentV9ThemeWrapperEnabled=!1,t.enableFluentV9ThemeWrapper=function(e){t.isFluentV9ThemeWrapperEnabled=e},t.isPowerAppsOneGridEnabled=!1,t.enablePowerAppsOneGrid=function(e){t.isPowerAppsOneGridEnabled=e},t.isRtlSupportEnabled=!1,t.enableRtlSupport=function(e){t.isRtlSupportEnabled=e},t.improvedTabStopBehaviorEnabled=!1,t.enableImprovedTabStopBehavior=function(e){t.improvedTabStopBehaviorEnabled=e},t.zeroAllTabIndexesEnabled=!1,t.enableZeroAllTabIndexes=function(e){t.zeroAllTabIndexesEnabled=e};var o=!1;t.maxScreensToRender=function(){return o?5:1},t.enableKeepRecentScreensLoaded=function(e){o=e};var r={},i=((n={})[e.Constants.Controls.GalleryTemplateTemplateClassName]=!0,n[e.Constants.Controls.GroupTemplateClassName]=!0,n);function a(e){return!0===i[e]}function s(e){return e.enabledPredicate()}t.isNonVisualControl=a,t.isVisualControl=function(e){return!a(e)},t.doesControlHaveVisualChildren=function(t){var n;if(!t)return!1;var o=t.template.className===e.Constants.Controls.GalleryTemplateClassName?1:0,r=t.uniqueId,i=null===(n=t.controlManager.controlInstancesFlatTree[r])||void 0===n?void 0:n.childIds;return(null==i?void 0:i.length)>o},t.ResolveControlWidgetClassNameOrConstructor=function(e){var t=r[e];return t&&s(t)?t.controlClass:e},t.ResolveControlComponent=function(e){var n=r[e];return n&&s(n)?n.reactComponent:t.KnockoutControl},t.RegisterReactConvertedControl=function(e,t,n,o){r[e]={controlClass:t,reactComponent:n,enabledPredicate:o}},t.IsReactConvertedControlRegistered=function(e){return!Core.Utility.isUndefined(r[e])}}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=function(){function t(){}return t.fitControlHeightToContent=function(e,n,o,r){t._fitControlHeightToContent(e,n,o,r)},t.fitControlHeightToContentAsync=function(e,n,o,r,i){return void 0===i&&(i=0),new Promise((function(i){t._fitControlHeightToContent(e,n,o,r,i)})).then((function(a){return a||i<=0?Promise.resolve(a):new Promise((function(a){return window.setTimeout((function(){t.fitControlHeightToContentAsync(e,n,o,r,--i).then(a)}),50)}))}))},t._fitControlHeightToContent=function(t,n,o,r,i){if(void 0===i&&(i=function(e){}),t.initialized&&t.realized&&t.modelProperties&&t.modelProperties.Height){var a=t.controlWidget.getId()+"_"+t.bindingContext.id,s=t.controlWidget.nestingLevel;Core.UI.DOMMutationScheduler.scheduleDOMAction(a,s,(function(){if(t.initialized&&t.realized){if(n.offsetWidth||n.offsetHeight){var a=0;t.controlWidget.hasProperty("PaddingTop")&&(a+=Math.max(t.controlWidget.getPropertyValue("PaddingTop",t.bindingContext),0)),t.controlWidget.hasProperty("PaddingBottom")&&(a+=Math.max(t.controlWidget.getPropertyValue("PaddingBottom",t.bindingContext),0));var s=n.scrollHeight/e.Controls.converters.pxLogicalToNativeVerticalConverter(1),l=Core.Utility.clamp(s,o-a,r-a)+a;return function(){t.initialized?(ko.isObservable(t.contentHeight)&&t.contentHeight(l),t.modelProperties.Height.setValue(l,!1,!1,!0),i(!0)):i(!1)}}i(!1)}else i(!1)}))}else i(!1)},t}();t.ControlAutoSizeUtil=n}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.init=function(e,o,r,i,a){var s={constraints:{get to(){return n._findCanvasParent(e)},attachment:"together none",pin:!0},scaleFn:n._getScaleFunction(),skipEscKey:!0};t.init.call(this,e,o,r,i,a,s)},n._findCanvasParent=function(t){for(var n=t;null!==n&&!n.classList.contains("canvasContainer")&&n.id!==e.Constants.PublishedCanvasId;)n=n.parentElement;return n},n._scaleFunction=function(){return e.DocumentLayout.getInstance().scaleFactor},n._getScaleFunction=function(){return Core.Environment.isAuthoringTool()&&!Core.Environment.isWebAuthoring()?null:Core.Environment.getBrowserId()!==Core.Environment.BrowserId.InternetExplorer?n._scaleFunction:null},n}(Core.Knockout.BindingHandlers.Flyout);t.ControlFlyout=n,ko.bindingHandlers.controlFlyout=n}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n,o=e.Utility;!function(e){e[e.Publish=0]="Publish",e[e.Editable=1]="Editable",e[e.Preview=2]="Preview",e[e.Recording=3]="Recording"}(n=t.AppMode||(t.AppMode={}));var r=function(r){function a(o,i){var a,s=r.call(this)||this;return s._appLifecycleEvents=i,s.AppRootInstanceId="__AppRootInstance__",Contracts.checkObject(o),s._controlInstances=HashTableUtility.create(),s._exportedComponents=HashTableUtility.create(),s._controlCreationWaitingPromisesByUniqueId=HashTableUtility.create(),s._missingControlIds=new Set,s._controlInstancesFlatTree=((a={})[s.AppRootInstanceId]={id:s.AppRootInstanceId,name:s.AppRootInstanceId,childIds:[],control:null,type:null},a),s._controlUpdatedEvent=new EventObject,s._requirementsManager=o,s._pcfDataConnectorService=Core.Loader.ObjectFactory.instance.getSingleton(e.Controls.IPcfDataConnectorServiceSingletonKey),s._appMode=ko.observable(n.Publish),s._textDirection=ko.observable(Core.FeatureGates.controls.forceRTL?"rtl":"ltr"),s._hostScale=1,s.checkIfControlIsAddedToControlManager=s.checkIfControlIsAddedToControlManager.bind(s),t.ControlWidget.isAuthoring=e.AuthoringTool.Runtime.isAuthoring,t.ControlPropertyBase.initializeStaticClassProperties(),OpenAjax.widget.setControlManager(s),s._controlCreatedCallback=Core.Environment.getRuntimeCapabilityCallback("PushCreateControl"),s}return __extends(a,r),Object.defineProperty(a.prototype,"controlUpdatedEvent",{get:function(){return this._controlUpdatedEvent},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"appModeObservable",{get:function(){return this._appMode},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"authoringInteractionModeObservable",{get:function(){return ko.observable(!1)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"textDirection",{get:function(){return this._textDirection},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"textDirectionObservable",{get:function(){var t=this;return this._textDirectionComputed||(this._textDirectionComputed=ko.pureComputed((function(){return t._appMode()===n.Editable?"ltr":e.Controls.isRtlSupportEnabled||Core.FeatureGates.controls.forceRTL?t._textDirection():"ltr"}))),this._textDirectionComputed},enumerable:!1,configurable:!0}),a.prototype.enableUpdateViewStates=function(){return!0},a.prototype._getOrCreateWaitingPromise=function(e,t){if(Contracts.checkPureObject(e),Contracts.checkNonEmpty(t),t in e)return e[t].promise;var n,o=new Promise((function(e){n=e}));return e[t]={promise:o,completed:n},o},a.prototype._completeWaitingPromise=function(e,t,n){Contracts.checkPureObject(e),Contracts.checkNonEmpty(t),Contracts.checkDefined(n),t in e&&(Contracts.checkFunction(e[t].completed),e[t].completed(n),delete e[t])},Object.defineProperty(a.prototype,"controlInstances",{get:function(){return this._controlInstances},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"controlInstancesFlatTree",{get:function(){return this._controlInstancesFlatTree},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"appRootInstance",{get:function(){return this._controlInstancesFlatTree[this.AppRootInstanceId]},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"appScreens",{get:function(){var e=this;return this.appRootInstance.childIds.map((function(t){return e._controlInstancesFlatTree[t]}))},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"hostScale",{get:function(){return this._hostScale},enumerable:!1,configurable:!0}),a.prototype.setHostScale=function(e){this._hostScale=e},a.prototype.getInitialControlId=function(e){return null},a.prototype.normalizedParentUniqueId=function(e){var t=e.OpenAjax.parentUniqueId;return-1===t.indexOf("_parent")?t:this.AppRootInstanceId},a.prototype.getControlInstance=function(e){var t=this._controlInstancesFlatTree[e];if(t)return t;for(var n in this._controlInstancesFlatTree)if(this._controlInstancesFlatTree[n].name===e)return this._controlInstancesFlatTree[n]},a.prototype.getControlInstanceById=function(e){var t=this._controlInstancesFlatTree[e];if(t)return t},a.prototype.getControl=function(e){return this._controlInstances[e]||null},a.prototype.getAllChildControlIds=function(e){var t=this._controlInstancesFlatTree[e];return t?t.childIds:(this.reportMissingControlInstance(e,"ControlManager.getAllChildControlIds"),[])},a.prototype.getAllDescendantControlIds=function(e){var t=this,n=this._controlInstancesFlatTree[e];if(!n)return this.reportMissingControlInstance(e,"ControlManager.getAllDescendantControlIds"),[];var o=n.childIds,r=o.map((function(e){return t.getAllDescendantControlIds(e)})).reduce((function(e,t){return e.push.apply(e,t),e}),[]);return __spreadArray(__spreadArray([],o,!0),r,!0)},a.prototype.reportMissingControlInstance=function(e,t){if(!(this._missingControlIds.size>=50||this._missingControlIds.has(e))){this._missingControlIds.add(e);var n={controlUniqueId:e,callstack:Contracts._sourceFromStacktrace()};50===this._missingControlIds.size&&(n.extendedMessage="Reporting count has reached maximum of ".concat(50," and will now be paused.")),Core.Log.warningEx(t,"Control instance missing from flat tree",{eventData:n})}},a.prototype.getExportedComponent=function(e){return this._exportedComponents[e]||null},a.prototype.waitForControlCreationAsync=function(e){Contracts.checkNonEmpty(e);var t=this.getControlIfAddedToControlManager(e);return t?Promise.resolve(t):this._getOrCreateWaitingPromise(this._controlCreationWaitingPromisesByUniqueId,e)},a.prototype.getControlIfAddedToControlManager=function(e){var t=this._controlInstancesFlatTree[e];return t?t.control:null},a.prototype.checkIfControlIsAddedToControlManager=function(e){return e in this._controlInstancesFlatTree},a.prototype.updateControlTreeAsync=function(e,t,n){return Promise.resolve()},a.prototype.create=function(t){var n;return __awaiter(this,void 0,void 0,(function(){var r,a,s,l,c,p,u,d,h,C,g,m,f,y,_;return __generator(this,(function(v){switch(v.label){case 0:return Contracts.checkObject(t),Contracts.checkNonEmpty(t.displayName),Contracts.checkObject(t.template),r=null,t.parent&&(Contracts.checkNonEmpty(t.parent.displayName),r=t.parent.displayName),a=t.displayName,s=t.template,Contracts.check(!this._controlInstances[a]),[4,this._requirementsManager.ensureRequirements(s.requirements)];case 1:return v.sent(),[4,this._pcfDataConnectorService.addDataConnectorsAsync(t)];case 2:if(v.sent(),this.isDisposed)return[2];if(l=this.getClassName(s),c=s.name,p=null,u=null,d=this.getInitialControlId(a),o.isCustomControl(c)){if(!(r=this._getNonCustomParentName(t)))return[2,null];if(!(h=OpenAjax.widget.byId(r)))return[2,null];if(!(C=t.metaDataId))return[2,null];if(!(u=i.createControlWidget({ctrlName:a,icontrol:t,ctrl:h,ctrlMgr:this,metadataId:C,uniqueId:d})))return[2,null];if(!(g=h.OpenAjax))return[2,null];g.addCustomChildControlWidget(C,u),(p=Object.create(null)).OpenAjax=u,null===(n=this._controlCreatedCallback)||void 0===n||n.call(this,u,s)}else p=e.Controls.ControlFactory.build({originalClassName:l,ctrlName:a,icontrol:t,ctrlMgr:this,uniqueId:d}),u=p.OpenAjax;return Core.Environment.isDefaultRenderMode()||(this._controlInstances[a]=p),u.initializeControl(r),this._controlInstances[a]=p,t.globalIdentifier&&!e.AuthoringTool.Runtime.isAuthoring&&(this._exportedComponents[t.globalIdentifier]=p),m=p.OpenAjax.uniqueId,this._controlInstancesFlatTree[m]={name:a,control:p,type:l,id:m,childIds:[]},f=this.normalizedParentUniqueId(p),this._controlInstancesFlatTree[f].childIds.push(m),this._completeWaitingPromise(this._controlCreationWaitingPromisesByUniqueId,m,p),y=t.topParentOrSelf,e.Utility.isAppInfoTemplate(p.OpenAjax.template.name)||y.isAppGlobalControl||(_=Core.Environment.isAuthoringTool()?y.displayName:y.index)&&_===e.AuthoringTool.Runtime.getCurrentScreenName()&&this.fireScreenUpdatedEvent(_),[2,p]}}))}))},a.prototype._getNonCustomParentName=function(e){for(var t=this.getControl(e.parent.displayName);t&&t.OpenAjax;){var n=t.OpenAjax.template.name;if(!o.isCustomControl(n))return t.OpenAjax.controlName;t=this.getControl(t.OpenAjax.parentControlName)}throw new Error("Parent control doesn't exist")},a.prototype.fireAppInteractionEvent=function(e,t){var n;null===(n=this._appLifecycleEvents)||void 0===n||n.onInteractionEvent("dom",e,{target:t})},a.prototype.fireScreenUpdatedEvent=function(e){this._controlUpdatedEvent.dispatch({screenName:e})},a.prototype.getClassName=function(e){return Contracts.checkValue(e),e.className},a.prototype.getAuthoringDataSourceNameAsync=function(e,t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){return[2,null]}))}))},a.prototype.initializeNestedCanvas=function(e,t,n,o,r,i){return Contracts.checkNonEmpty(e),Contracts.checkNumber(t),{}},a.prototype.initializeScrollingAdorner=function(e){return null},a.prototype.changeOutputTypeAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){return[2]}))}))},a.prototype.changeOutputTypeUsingDocTypeAsync=function(e,t,n,o){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){return[2]}))}))},a.prototype.getInputDataType=function(e,t){return"e"},a.prototype.getInputDataTypeJSONAsync=function(e,t){return Promise.resolve("{}")},a.prototype.shouldShowBlankScreenWatermark=function(e,t){return!1},a.prototype.renderBlankScreenWatermark=function(){return null},a.prototype.renderAuthoringPlaceholder=function(e){return null},a.prototype.executeShellAction=function(e){},a.prototype.subscribeDocumentDimensionChange=function(e){},a.prototype.unsubscribeDocumentDimensionChange=function(e){},a}(Core.Knockout.KnockoutDisposable);t.ControlManager=r;var i=function(){function n(){}return n.build=function(e){var t=e.originalClassName,o=e.ctrlName,r=e.icontrol,i=e.ctrlMgr,a=e.onValueChangedFn,s=e.runOptimizedReplicatedDataFlowFn,l=e.onEventFn,c=e.entityPropertyChangedFn,p=e.updatePropertyRuleFn,u=e.uniqueId;if(Contracts.checkNonEmpty(t),Contracts.checkNonEmpty(o),Contracts.checkValue(r),Contracts.checkValue(i),!(t&&o&&r&&i))return null;var d=n.createControlFromClassName(t);if(!d)return null;var h=n.createControlWidget({ctrlName:o,icontrol:r,ctrl:d,ctrlMgr:i,onValueChangedFn:a,runOptimizedReplicatedDataFlowFn:s,onEventFn:l,entityPropertyChangedFn:c,updatePropertyRuleFn:p,uniqueId:u});return d.OpenAjax=h,d},n.createControlFromClassName=function(e){if(!e)return null;var n,o=t.ResolveControlWidgetClassNameOrConstructor(e);if(Core.Utility.isString(o)){if(!o)return null;for(var r=globalScopeObject,i=o.split("."),a=i.length,s=0;r&&s<a;s++)r=r[i[s]];if(!r&&Core.Environment.isRuntimeCapabilityEnabled("OffloadRequirements"))return{OpenAjax:null};if(Contracts.checkValue(r),Contracts.check("function"==typeof r),!r)return null;n=r}else n=o;var l=new n;return Contracts.checkValue(l),l},n.createControlWidget=function(t){var n=t.ctrlName,o=t.icontrol,r=t.ctrl,i=t.ctrlMgr,a=t.metadataId,s=t.onValueChangedFn,l=t.runOptimizedReplicatedDataFlowFn,c=t.onEventFn,p=t.entityPropertyChangedFn,u=t.updatePropertyRuleFn,d=t.uniqueId;if(Contracts.checkNonEmpty(n),Contracts.checkValue(o),Contracts.checkValue(i),!(n&&o&&r&&i))return null;var h=e.context&&e.context.document;return void 0===s&&(s=e.AuthoringTool.Runtime.onValueChanged.bind(e.AuthoringTool.Runtime)),Contracts.checkFunction(s),void 0===l&&(l=e.AuthoringTool.Runtime.runOptimizedReplicatedDataFlow.bind(e.AuthoringTool.Runtime)),Contracts.checkFunction(l),void 0===c&&(c=e.AuthoringTool.Runtime.onEvent.bind(e.AuthoringTool.Runtime)),Contracts.checkFunction(c),void 0===p&&(p=h?e.context.documentViewModel.notifyEntityPropertyChanged.bind(e.context.documentViewModel):null),Contracts.checkFunctionOrNull(p),void 0===u&&(u=h?e.context.documentViewModel.updatePropertyRuleAsync.bind(e.context.documentViewModel):null),Contracts.checkFunctionOrNull(u),new e.Controls.ControlWidget(n,r,o,i,s,l,c,p,u,e.AuthoringTool.Runtime.activeScreenIndex,a,d)},n}();t.ControlFactory=i}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=function(e){function t(t){var n=this;return(n=e.call(this)||this).addShortcutKey(Core.UI.Constants.Keys.enter,t),n.addShortcutKey(Core.UI.Constants.Keys.space,t),n}return __extends(t,e),t}(Core.UI.Shortcuts.BaseShortcutProvider);e.ControlShortcutProvider=t}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=Core.UI,o=n.useDebounceUntilNextAnimationFrame,r=n.useKnockoutSubscription,i=n.useOnWillUnmount,a=n.useResizeObserver,s=n.useScrollObserver,l=e.Constants,c=l.RootContainerCssSelector,p=l.ItemsContainerCssSelector,u=l.ParentItemIdDataAttribute,d=l.ItemIdDataAttribute,h=Object.freeze({x:0,y:0,width:0,height:0});function C(e){for(var t={x:0,y:0,width:e.offsetWidth,height:e.offsetHeight},n=e;n;)t.x+=n.offsetLeft+n.scrollLeft+n.clientLeft,t.y+=n.offsetTop+n.scrollTop+n.clientTop,n=n.offsetParent;return t.width=Math.round(t.width),t.height=Math.round(t.height),t.x=Math.round(t.x),t.y=Math.round(t.y),t}function g(e){var t,n=C(e),o=n,r=e.matches(c)?e:null===(t=e.parentElement)||void 0===t?void 0:t.closest(p);r&&r instanceof HTMLElement&&(o=_(n,e===r?n:C(r)));return[n,o]}var m=ko.observable(!1);t.useMemoizedItemMeasurerContextForCanvas=function(){var e=React.useMemo((function(){return Core.UI.EventEmitter.createEventEmitter()}),[]),t=React.useState({}),n=t[0],r=t[1],a=React.useRef(n),s=React.useRef([]),l=o(React.useCallback((function(){if(m.peek())l();else{r(a.current);var t={};s.current.forEach((function(n){if(!t[n]){t[n]=!0;var o=a.current[n];o?e.emit(n,o):Core.Telemetry.Log.trackUIActivityEvent("debouncedNotifyMeasuredItemsChanged.latestMeasuredPositionNull")}})),s.current=[]}}),[m,r,s,e])),c=React.useCallback((function(e,t,n){var o;void 0===n&&(n={});var r=a.current,i=r[t]||h,c=__assign(__assign({itemId:t,parentItemId:e},i),n),p=__assign(__assign({},r),((o={})[t]=c,o));s.current.push(t),a.current=p,l()}),[a,l]),p=React.useCallback((function(e){return a.current[e]||h}),[a]),u=React.useCallback((function(e){var t=__assign({},a.current);delete t[e],a.current=t,l()}),[a]),d=React.useMemo((function(){return{eventEmitter:e,measuredItemsById:n,getMeasuredPositionForItemID:p,onItemMeasured:c,onItemRemoved:u,isCurrentlyDirectManipulatingObservable:m}}),[e,n,p,c,m]);return i((function(){m(!1)})),d};var f={eventEmitter:Core.UI.EventEmitter.createEventEmitter(),measuredItemsById:{},getMeasuredPositionForItemID:function(e){return h},onItemMeasured:function(e,t,n){},onItemRemoved:function(e){},isCurrentlyDirectManipulatingObservable:m};function y(e){var n=e.parentItemId,o=e.itemId,l=e.ref,c=e.onResizeCallback,p=e.isDisabled,u=void 0!==p&&p,d=e.onFinishedMeasuring,h=React.useContext(t.ItemMeasurerContext),C=h.onItemMeasured,f=h.eventEmitter,y=h.onItemRemoved;i((function(){y(o)})),React.useEffect((function(){var e=!1;return d&&(e=!0,f.on(o,d)),function(){e&&(f.off(o,d),e=!1)}}),[f,o,d]);var _=React.useCallback((function(e){C(n,o,e),null==c||c(o)}),[C,o,n,c]),v=React.useCallback((function(){C(n,o),null==c||c(o)}),[C,o,n]),b=React.useRef(null);r(m,(function(e){if(!e&&b.current){var t=b.current;b.current=null,_(t)}}));var x=React.useCallback((function(e){u||(m.peek()?b.current=e:_(e))}),[u,m,b,_]),P=React.useCallback((function(){u||m.peek()||v()}),[u,m]);s(l,P),a({element:l.current,isDisabled:u,shouldRoundValues:!0,onResize:x});var A=React.useRef(!1),I=l.current;React.useEffect((function(){if(!Core.FallbackSwitch.isActivated("Authoring.useAutoMeasureItem.DisableInitialMeasurement")&&!A.current&&d&&I instanceof HTMLElement){var e=g(I),t=(e[0],e[1]);d(t),A.current=!0}}),[d,I,A])}function _(e,t){return{x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}}t.ItemMeasurerContext=React.createContext(f),t.useAutoMeasureItem=y,t.useAutoMeasureItemsContainer=function(e){var n=e.parentItemId,i=e.containerItemId,a=e.containerRef,s=e.isDisabled,l=React.useContext(t.ItemMeasurerContext).onItemMeasured,c=React.useCallback((function(){var e=a.current&&ReactDOM.findDOMNode(a.current);if(e instanceof HTMLDivElement){var t=g(e),o=t[0],r=t[1];Array.prototype.slice.call(e.querySelectorAll("[".concat(u,"='").concat(i,"']"))).forEach((function(e){var t=e.getAttribute(d),n=_(C(e),o);l(i,t,n)})),l(n,i,r)}}),[a,i,l]),p=React.useRef(!1),h=React.useCallback((function(){m.peek()?p.current=!0:c()}),[m,p,c]);r(m,(function(e){!e&&p.current&&c()})),y({parentItemId:n,itemId:i,ref:a,onResizeCallback:h,isDisabled:s});var f=o(React.useCallback((function(){s||c()}),[c,s]));return{measureAndUpdatePositions:c,scheduleUpdatingPositionsInTheNextRenderingFrame:f}},t.MeasuredItemsParentContext=React.createContext({itemId:"",measure:function(){}})}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=e.AuthoringTool.OpenAjaxPropertyNames,o={x:{computedName:n.AutoLayoutX,baseName:n.X},y:{computedName:n.AutoLayoutY,baseName:n.Y},width:{computedName:n.AutoLayoutWidth,baseName:n.Width},height:{computedName:n.AutoLayoutHeight,baseName:n.Height}},r=Core.Utility.debounce((function(){Core.Loader.ObjectFactory.instance.getSingleton(e.AuthoringTool.GlobalEventBroker.ShellEventBroker.singletonKey).publishEvent(e.AuthoringTool.GlobalEventBroker.EventBrokerId.Canvas_InfoUpdated,null)}),50,!0);function i(e){var t;return(null===(t=e.modelProperties.Visible)||void 0===t?void 0:t.getValue())&&!e.controlWidget.isAncestorHidden(e)}t.isControlAndAllParentsVisible=i,t.updateControlPositionProperties=function(e,t){var n,a,s,l,c,p;if(t){if(i(e)){for(var u in o){var d=t[u];if(void 0!==d){var h=o[u],C=h.computedName,g=h.baseName,m=e.modelProperties[C];null==m||m.setValue(d,!1,!1,!0),e.modelProperties[g].resetValue()}}r.call(null)}}else Core.Telemetry.Log.trackUIActivityEvent("ItemMeasurerUtils.updateControlPositionProperties.updatedMeasurementsNull",{controlContext:!!e,templateName:null===(n=null==e?void 0:e.controlWidget)||void 0===n?void 0:n.template.name,variantName:null===(a=null==e?void 0:e.controlWidget)||void 0===a?void 0:a.variantName,parentTemplateName:null===(l=null===(s=null==e?void 0:e.controlWidget)||void 0===s?void 0:s.parentControlWidget)||void 0===l?void 0:l.template.name,parentVariantName:null===(p=null===(c=null==e?void 0:e.controlWidget)||void 0===c?void 0:c.parentControlWidget)||void 0===p?void 0:p.variantName})},t.getContainerDataAttributes=function(t){var n,o=((n={})[e.Constants.ItemTypeDataAttribute]=e.Constants.ItemsContainerType,n);return t&&(o[e.Constants.RootContainerDataAttribute]=!0),o},t.getItemDataAttributes=function(t,n){var o;return(o={})[e.Constants.ParentItemIdDataAttribute]=t,o[e.Constants.ItemIdDataAttribute]=n,o},t.useSubscribeToControlPropertyChanges=function(e,t,n){var o=React.useRef(n);o.current=n,React.useEffect((function(){var n=[];return t.forEach((function(t){var r=e.properties[t];r&&n.push(r.subscribe((function(){o.current(t,r.peek())})))})),function(){n.forEach((function(e){return e.dispose()})),n=[]}}),[e,t,o])}}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=aphrodite.css,o=Core.UI.StyleHelpers.createParameterizedCachedStylesFactoryMethod,r=e.Constants,i=r.ItemIdDataAttribute,a=r.SingleControlType;t.ItemMeasurer=React.memo((function(e){var o,r,c=e.controlContext,p=e.children,u=s(null===(r=c.controlWidget)||void 0===r?void 0:r.isPcfControl),d=React.useContext(t.MeasuredItemsParentContext),h=React.useRef(null),C=c.instanceId,g=t.isControlAndAllParentsVisible(c);t.useSubscribeToControlPropertyChanges(c,l,d.measure);var m=React.useCallback((function(){d.measure()}),[d]),f=React.useCallback((function(e){t.PrintableControl.isPrintableControl(c)&&-1!==c._expandForPrintHeight&&(e.height=c._expandForPrintHeight),t.updateControlPositionProperties(c,e)}),[c]);t.useAutoMeasureItem({parentItemId:d.itemId,itemId:C,ref:h,onResizeCallback:m,isDisabled:!g,onFinishedMeasuring:f});var y=__assign(((o={})[i]=a,o),t.getItemDataAttributes(d.itemId,C));return React.createElement("div",__assign({ref:h,className:n(u.itemMeasurer)},y),p)})),t.ItemsContainerMeasurer=React.memo((function(e){var n=e.className,o=e.controlContext,r=e.controlInstance,i=e.children,a=e.isRootContainer,s=e.onRefChanged,l=e.style,p=React.useRef(),u=r.control.OpenAjax.controlName,d=o.instanceId,h=t.isControlAndAllParentsVisible(o),C=React.useContext(t.MeasuredItemsParentContext),g=p.current;React.useLayoutEffect((function(){s&&s(g)}),[s,g]);var m=t.useAutoMeasureItemsContainer({parentItemId:C.itemId,containerItemId:d,containerRef:p,isDisabled:!h}).scheduleUpdatingPositionsInTheNextRenderingFrame;React.useLayoutEffect((function(){m()}),[m,n,r.childIds.join("_")]),t.useSubscribeToControlPropertyChanges(o,c,m);var f=React.useMemo((function(){return{itemId:d,measure:m}}),[C,d]);return React.createElement(t.MeasuredItemsParentContext.Provider,{value:f},React.createElement("div",__assign({className:n,ref:p,"data-container-name":"".concat(u,"-container")},t.getContainerDataAttributes(a),t.getItemDataAttributes(C.itemId,d),{style:l}),i))}));var s=o((function(e){return{itemMeasurer:__assign({position:"absolute",top:0,left:0,right:0,bottom:0},e&&{display:"flex"})}})),l=["AlignInContainer","FillPortions","ZIndex","Visible"],c=__spreadArray(__spreadArray([],l,!0),["LayoutMode","LayoutDirection","LayoutAlignItems","LayoutJustifyContent","LayoutGap","LayoutOverflowX","LayoutOverflowY","LayoutWrap","PaddingTop","PaddingRight","PaddingBottom","PaddingLeft"],!1)}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=0,n=function(){function e(){this._requestedWindowMinIndex=null,this._requestedWindowMaxIndex=null,this._realizeFn=null,this._unrealizeFn=null,this._updateWindowFn=null,this._batchingThreshold=300,this._nextChunkFn=this._doNextChunkOfWork.bind(this),this._currentWindowMinIndex=0,this._currentWindowMaxIndex=-1,this._missingIndices=null,this._mgrId="_asyncRenderingMgr"+t++,this._isLoaded=!0,this._workingPromise=Promise.resolve()}return e.prototype.renderAsync=function(t,n,o,r,i,a){var s=this;this._requestedWindowMaxIndex===n&&this._requestedWindowMinIndex===t||this._workingPromise.then((function(){s._requestedWindowMinIndex=t,s._requestedWindowMaxIndex=n,null!==s._missingIndices&&(s._missingIndices=s._missingIndices.filter((function(e){return e>=t&&e<=n})),0===s._missingIndices.length&&(s._missingIndices=null)),s._realizeFn=o,s._lastIndexCallback=a,s._unrealizeFn=r;var l=null;s._updateWindowFn=function(){s._currentWindowMinIndex!==l&&(i(s._currentWindowMinIndex),l=s._currentWindowMinIndex)},s._pendingWork?s._pendingWork.updateDelay(1):(e._renderingStarted(s._mgrId),s._pendingWork=e._initiateAsyncCallback(s._nextChunkFn,1))}))},e.prototype._doNextChunkOfWork=function(){var t;this._pendingWork=null,this._workingPromise=new Promise((function(e){t=e}));var n=this._unrealizeFn,o=this._realizeFn,r=this._updateWindowFn,i=!1,a=!0,s=(new Date).valueOf();try{do{null!==this._currentWindowMinIndex&&null!==this._currentWindowMaxIndex?(this._currentWindowMinIndex>this._currentWindowMaxIndex&&(this._requestedWindowMaxIndex>this._currentWindowMinIndex?(this._currentWindowMinIndex=this._requestedWindowMinIndex,this._currentWindowMaxIndex=this._requestedWindowMinIndex-1):(this._currentWindowMaxIndex=this._requestedWindowMaxIndex,this._currentWindowMinIndex=this._requestedWindowMaxIndex+1)),this._requestedWindowMinIndex>this._currentWindowMinIndex?n(this._currentWindowMinIndex++):this._requestedWindowMaxIndex<this._currentWindowMaxIndex?n(this._currentWindowMaxIndex--):this._missingIndices?(this._missingIndices.length>0&&o(this._missingIndices.shift(),this._currentWindowMinIndex),0===this._missingIndices.length&&(this._missingIndices=null)):this._requestedWindowMaxIndex>this._currentWindowMaxIndex?o(++this._currentWindowMaxIndex,this._currentWindowMinIndex,this._currentWindowMaxIndex===this._requestedWindowMaxIndex?this._lastIndexCallback:null):this._requestedWindowMinIndex<this._currentWindowMinIndex?o(--this._currentWindowMinIndex,this._currentWindowMinIndex):a=!1,i=!0):a=!1}while(a&&(new Date).valueOf()-s<this._batchingThreshold);i&&r()}finally{a?this._pendingWork=e._initiateAsyncCallback(this._nextChunkFn,1):e._renderingCompleted(this._mgrId),t()}},e.prototype._resetInternal=function(){this._pendingWork&&(this._pendingWork.cancel(),this._pendingWork=null,e._renderingCompleted(this._mgrId)),this._requestedWindowMinIndex=null,this._requestedWindowMaxIndex=null,this._realizeFn=null,this._unrealizeFn=null,this._updateWindowFn=null},e.prototype.reset=function(e,t,n){void 0===e&&(e=0),void 0===t&&(t=-1),this._resetInternal(),this._currentWindowMinIndex=e,this._currentWindowMaxIndex=t,this._missingIndices=n||null},e.prototype.dispose=function(){this._resetInternal(),this._nextChunkFn=null,this._currentWindowMinIndex=null,this._currentWindowMaxIndex=null,this._lastIndexCallback=null,this._isLoaded=!1},e.waitForAsyncRendering=function(t){return e._asyncRenderingWaitingPromise.then((function(){return new Promise((function(e){return setImmediate(e.bind(e,t))}))}))},e._renderingStarted=function(t){e._asyncRenderingCompletedFn||(e._asyncRenderingWaitingPromise=new Promise((function(t){e._asyncRenderingCompletedFn=t}))),e._renderingInstances[t]=!0,e._renderingCount++},e._renderingCompleted=function(t){if(delete e._renderingInstances[t],e._renderingCount--,0===e._renderingCount){var n=e._asyncRenderingCompletedFn;e._asyncRenderingCompletedFn=null,n()}},e._initiateAsyncCallback=function(e,t){var n=!1,o=!1,r=null,i=!1,a=function(){n||o||(o=!0,e())},s=function(e){0===e?(i=!0,r=setImmediate(a)):(i=!1,r=setTimeout(a,e))};s(t);var l=function(){i?clearImmediate(r):clearTimeout(r),r=null};return{cancel:function(){l(),r=null,e=null,n=!0},updateDelay:function(e){l(),s(e)}}},e._renderingCount=0,e._renderingInstances={},e._asyncRenderingCompletedFn=null,__decorate([initializeOnLoad((function(){return Promise.resolve()}))],e,"_asyncRenderingWaitingPromise",void 0),e}();e.AsyncRenderingManager=n}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=function(){function n(){this._controlWidgets=[],this.nestedManagers=[],this._bindingContextRecycleBin=[],this.isLoaded=!0}return n.nextBindingContextId=function(){return"".concat(n._nextBindingContextId++)},n.getParentControlContext=function(e){var t=e.controlWidget.parentControlName,n=OpenAjax.widget.byId(t);if(!n)return null;var o=e.bindingContext;if(n.OpenAjax.isComponentDefinition&&o.componentInstance&&!(n=OpenAjax.widget.byId(o.componentInstance)))return null;var r=n.OpenAjax.getControlContext(o);if(!r){var i=o.parent;r=i?n.OpenAjax.getControlContext(i):null}return r},n.getParentManager=function(e){if(e){for(var o=OpenAjax.widget.byId(e);!n._isRootControl(o);){if(o.OpenAjax.contextManager)return o.OpenAjax.contextManager;o=OpenAjax.widget.byId(o.OpenAjax.parentControlName)}return t.GlobalContextManager.instance}return t.GlobalContextManager.instance},n.getOrCreateComponentContext=function(e,t,n,o){return e.componentBindingContexts.getOrCreateComponentContext(t,n,o)},n.forAllComponentBindingContexts=function(e){this._forAllComponentBindingContextsRecursive(t.GlobalContextManager.bindingContext,e)},n._forAllComponentBindingContextsRecursive=function(e,n){var o=this;n(e.componentBindingContexts),e.replicatedContexts&&HashTableUtility.forEach(e.replicatedContexts,(function(e){var r=e.manager.authoringAreaBindingContext;r&&r!==t.GlobalContextManager.bindingContext&&o._forAllComponentBindingContextsRecursive(r,n),HashTableUtility.forEach(e.bindingContextLookup,(function(e){o._forAllComponentBindingContextsRecursive(e,n)}))}))},n.forAllBindingContextsOfComponentInstances=function(e){this.forAllComponentBindingContexts((function(t){return t.forEach(e)}))},n._isRootControl=function(n){return e.Utility.isScreen(n.OpenAjax.template.name)||n instanceof t.AppInfo||e.Utility.isComponent(n.OpenAjax.template.className)||e.Utility.isTestControl(n.OpenAjax.template.className)},n.prototype.dehydrateBindingContext=function(e){var t={};return HashTableUtility.forEach(e.controlContexts,(function(n,o){t[o]={outputRow:e.outputRow[o],inputRow:e.inputRow[o]},n.controlWidget.suspendControlContext(n,t[o]),n._replicatedContext&&(t[o]._bindingContexts={},n._replicatedContext.dehydrateBindingContext(t[o]._bindingContexts))})),t},n.prototype.hydrateBindingContext=function(e,t){HashTableUtility.forEach(e.controlContexts,(function(n,o){e.outputRow[o]=t[o].outputRow,e.inputRow[o]=t[o].inputRow,n.controlWidget.resumeControlContext(n,t[o]),n._replicatedContext&&n._replicatedContext.hydrateBindingContext(t[o]._bindingContexts)}))},n.prototype.getControlWidget=function(){return null},n.prototype.forEachManagedDescendingBindingContext=function(e,t){},n.prototype.notifyBindingContextSelectionInteraction=function(e,t){},n.prototype.addSelectionChangedListener=function(e,t){},n.prototype.dispose=function(){this.emptyRecycleBin(),this.authoringAreaBindingContext&&(this.disposeBindingContext(this.authoringAreaBindingContext),this.authoringAreaBindingContext=null),this._controlWidgets=null,this.isLoaded=!1},n.prototype.addControl=function(e){this._addControlWidget(e.OpenAjax)},n.prototype._addControlWidget=function(e){this.emptyRecycleBin(),this._controlWidgets.push(e),this._addControlWidgetClassSpecific(e)},n.prototype._addControlWidgetClassSpecific=function(e){},n.prototype.addChildControl=function(e,t){if(e&&e.OpenAjax&&t){var n=e.OpenAjax.getCustomChildControlWidget(t);n&&this._addControlWidget(n)}},n.prototype.updateControlId=function(e,t){this._updateControlIdClassSpecific(e,t),this.emptyRecycleBin()},n.prototype._updateControlIdClassSpecific=function(e,t){},n.prototype.removeControl=function(e){e&&this.isLoaded&&this._removeControlWidget(e.OpenAjax)},n.prototype._removeControlWidget=function(e){this.emptyRecycleBin(),this._removeControlWidgetClassSpecific(e);var t=this._controlWidgets.indexOf(e);this._controlWidgets.splice(t,1),n._removeControlWidgetFromMap(e)},n.prototype._removeControlWidgetClassSpecific=function(e){},n.prototype.removeChildControl=function(e,t){if(e&&e.OpenAjax&&t){var n=e.OpenAjax.getCustomChildControlWidget(t);n&&this._removeControlWidget(n)}},n.prototype.addNestedManager=function(e){this.nestedManagers.push(e)},n.prototype.newBindingContext=function(e,o,r,i,a,s,l,c){var p=this;void 0===i&&(i=!1),void 0===l&&(l=!0);var u=!!s;if(u&&(null==e?void 0:e.id)===r)return null;var d={},h=o?{_src:o}:{};if(l&&this._bindingContextRecycleBin.length>0)return this._newRecycledBindingContext(e,o,d,h,r,i,a,s,c);var C={replicatedContexts:{},controlContexts:{},thisItem:o||{},inputRow:d,outputRow:h,parent:e,templateBindingContext:c,id:r,uniqueId:n.nextBindingContextId(),rcManager:this,isTemplate:!!i,isCached:!1,rootControlNames:a,componentBindingContexts:null,componentInstance:u?r:void 0,componentInstanceUniqueId:s};this._createComponentContexts(C);var g=a&&a.length>0?this._controlWidgetsForComponentInstance(C):this._controlWidgets;return g.forEach((function(e){var t=e.getId();d[t]={},h[t]={},C.controlContexts[e.getId()]=e.contextManagerInterface.newControlContext(C)})),function(){for(var e=0,o=p.nestedManagers.length;e<o;e++){var r=p.nestedManagers[e];n.isControlWidgetInBindingContextTree(r.getControlWidget(),C)&&t.ReplicatedContext.create(r,C)}}(),this._initializeControlContexts(C,g),C},n.prototype._controlWidgetsForComponentInstance=function(e){var o=t.GlobalContextManager.instance;return(this===o?this._controlWidgets:__spreadArray(__spreadArray([],this._controlWidgets,!0),o._controlWidgets,!0)).filter((function(t){return n.shouldHaveControlContext(e,t)}))},n.prototype._createComponentContexts=function(e){e.componentBindingContexts=new t.ComponentBindingContexts(this,e),e.runRuleFn=function(t,n){e.componentBindingContexts.tryRunRuleOnInstance(t,n,e),e.componentBindingContexts.runRuleFn(t,n)}},n.prototype.placeInRecycleBin=function(e){this._disposeNestedReplicatedContexts(e),this._bindingContextRecycleBin.push(e)},n.prototype._disposeNestedReplicatedContexts=function(e){for(var t in e.replicatedContexts){e.replicatedContexts[t].dispose()}},n.prototype.emptyRecycleBin=function(){this._bindingContextRecycleBin=[]},n.prototype.disposeBindingContext=function(t,o){void 0===o&&(o=!0),e.AuthoringTool.Runtime.cancelAsyncRuleExecutionsForBindingContext(t.id),t.componentInstance?this._disposeControlContextsForComponentBindingContext(t):this._disposeControlContextsForBindingContext(t),t.templateBindingContext=null,t.disposed=!0,o?this.placeInRecycleBin(t):this._disposeNestedReplicatedContexts(t),n._removeBindingContextFromMap(t)},n.prototype._disposeControlContextsForComponentBindingContext=function(e){var t=this;HashTableUtility.forEach(e.controlContexts,(function(n){t.removeControlFromBindingContext(e,n.controlWidget)}))},n.prototype._disposeControlContextsForBindingContext=function(e){for(var t=0,n=this._controlWidgets.length;t<n;t++){var o=this._controlWidgets[t],r=o.getControlContext(e);r.realized&&!o.controlHandlesRealized&&(r.realized=!1),o.contextManagerInterface.disposeControlContext(r)}},n.allocateControlContext=function(e,t){if(!(e&&e.inputRow&&e.outputRow&&e.controlContexts&&t))return null;var o=t.getId();if(!o)return null;if(!n.shouldHaveControlContext(e,t))return null;var r=t.contextManagerInterface;if(!r)return null;e.inputRow[o]={},e.outputRow[o]={};var i=r.newControlContext(e);return e.controlContexts[o]=i,i},n.initializeControlContext=function(e,t){if(e&&t&&(t.getId()&&n.shouldHaveControlContext(e,t))){var o=t.contextManagerInterface;if(o){var r=t.getControlContext(e);o.initControlContext(r),this._informParent(r,(function(e,t){e.onChildContextAdded instanceof Function&&e.onChildContextAdded(t,r)}))}}},n.prototype.renameControlInBindingContext=function(e,t,n){e.rootControlNames&&e.rootControlNames.indexOf(t)>-1&&(e.rootControlNames=e.rootControlNames.map((function(e){return e===t?n:e})));var o=e.controlContexts[t];o&&(delete e.controlContexts[t],e.controlContexts[n]=o,e.inputRow[n]=e.inputRow[t],delete e.inputRow[t],e.outputRow[n]=e.outputRow[t],void 0!==e.thisItem[t]?e.outputRow[t]=e.thisItem[t]:delete e.outputRow[t])},n.prototype.removeControlFromBindingContext=function(e,t){if(e&&t){var o=t.getId(),r=t.contextManagerInterface,i=t.getControlContext(e);i&&(n._informParent(i,(function(e,t){e.onChildContextRemoved instanceof Function&&e.onChildContextRemoved(t,i)})),i.initialized&&r.disposeControlContext(i),delete e.controlContexts[o],delete e.inputRow[o],void 0!==e.thisItem[o]?e.outputRow[o]=e.thisItem[o]:delete e.outputRow[o])}},n.prototype._parseRule=function(e){var t=null,n=null,o=e.lastIndexOf(".");return o>-1&&(t=this.getControlNameById(e.substring(0,o)),n=e.substring(o+1)),{controlName:t,propertyName:n}},n.prototype.getComponentTemplateInfoFromRule=function(t,n){var o,r,i={templateName:null,controlName:null,isComponent:!1},a=this._parseRule(t),s=a.controlName,l=a.propertyName;if(!s||!l)return i;var c=OpenAjax.widget.byId(s);if(!c)return i;if(e.Utility.isComponent(c.OpenAjax.template.className)){if(!c.OpenAjax.componentDefinitionName)return i;var p=c.OpenAjax.template.inputProperties.find((function(e){return e.displayName===l}));return!p||n&&!p.hidden?i:{templateName:c.OpenAjax.template.name,controlName:s,isComponent:!0}}var u=null===(r=null===(o=OpenAjax.widget.controlManager)||void 0===o?void 0:o.getControlInstanceById(c.OpenAjax.topParentOrSelfUniqueId))||void 0===r?void 0:r.control;return u&&e.Utility.isComponent(u.OpenAjax.template.className)?{templateName:u.OpenAjax.template.name,controlName:s,isComponent:!1}:i},n.prototype.getControlNameById=function(e){var t=OpenAjax.widget.controlManager;if(t&&t.getControlInstanceById){var n=t.getControlInstanceById(e);if(n)return n.name}return this._controlWidgets.reduce((function(t,n){return t||n.getCustomChildOrSelfControlNameByUniqueId(e)||null}),null)},n.prototype._newRecycledBindingContext=function(e,t,o,r,i,a,s,l,c){var p=this._bindingContextRecycleBin.shift();p.parent=e,p.thisItem=t||{},p.inputRow=o,p.outputRow=r,p.id=i,p.uniqueId=n.nextBindingContextId(),p.rootControlNames=s,p.componentInstanceUniqueId=l,p.templateBindingContext=c,delete p.disposed,p.recycleCount=(p.recycleCount||0)+1;for(var u=s&&s.length>0?this._controlWidgetsForComponentInstance(p):this._controlWidgets,d=0,h=u.length;d<h;d++){var C=u[d],g=C.getId();o[g]={},r[g]={};var m=C.getControlContext(p);C.contextManagerInterface.recycleControlContext(m,!!a)}return function(){for(var e in p.replicatedContexts){p.replicatedContexts[e].restore(p)}}(),this._initializeControlContexts(p),p},n.prototype._initializeControlContexts=function(e,t){(t=t||this._controlWidgets).forEach((function(t){var n=t.getControlContext(e);t.contextManagerInterface.initControlContext(n)}))},n.shouldHaveControlContext=function(e,t){var n=e.rootControlNames;if(!n||0===n.length)return!0;for(var o=t;o;){if(n.indexOf(o.controlName)>-1)return!0;var r=OpenAjax.widget.byId(o.parentControlName);o=r&&r.OpenAjax}return!1},n.isControlWidgetInBindingContextTree=function(e,t){if(n._useControlWidgetBindingContextMapFallback)return n._isControlWidgetInBindingContextTreeInternal(e,t);var o=e.uniqueId,r=t.uniqueId,i=n._controlWidgetBindingContextMap;if(i[o]){var a=i[o][r];if(void 0!==a)return a}else i[o]={};var s=n._isControlWidgetInBindingContextTreeInternal(e,t);return i[o][r]=s,s},n._isControlWidgetInBindingContextTreeInternal=function(e,t){var n,o,r=e.topParentOrSelfName,i=e.isChildOfComponentOrSelf(r);if(!i&&!t.componentInstance)return!0;if(i){if(t.componentInstance)return e.isChildOfComponentOrSelf(t.componentInstance)||-1!==(null!==(o=null===(n=t.rootControlNames)||void 0===n?void 0:n.indexOf(r))&&void 0!==o?o:-1);for(var a=OpenAjax.widget.byId(r).OpenAjax.getAuthoringControlContext().bindingContext;t;){if(t==a)return!0;t=t.parent}}return!1},n._removeControlWidgetFromMap=function(e){delete n._controlWidgetBindingContextMap[e.uniqueId]},n._removeBindingContextFromMap=function(e){var t=e.uniqueId,o=n._controlWidgetBindingContextMap;Object.keys(o).forEach((function(e){void 0!==o[e][t]&&delete o[e][t]}))},n.prototype.notifyAuthoringApplyConstants=function(t,n){var o=this.getComponentTemplateInfoFromRule(t,!0),r=o.templateName,i=o.controlName,a=o.isComponent;r&&e.Controls.ContextManager.forAllBindingContextsOfComponentInstances((function(e,t){OpenAjax.widget.byId(t).OpenAjax.template.name!==r||a&&t!==i||n(e)}))},n.isWithinComponentInstance=function(e){return!!n.findBindingContextOrAncestor(e,(function(e){return!!e.componentInstance}))},n.findBindingContextOrAncestor=function(e,t){for(;e&&!t(e);e=e.parent);return e},n._informParent=function(e,t){if(e.initialized){var o=n.getParentControlContext(e);if(o&&o.initialized){var r=o.controlWidget.control;r&&t(r,o)}}},n._controlWidgetBindingContextMap=HashTableUtility.create(),n._nextBindingContextId=0,n._useControlWidgetBindingContextMapFallback=Core.FallbackSwitch.isActivated("AppRuntime.ControlWidgetBindingContextMap"),n}();t.ContextManager=n}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){!function(n){var o=new Core.Lazy((function(){return Core.FallbackSwitch.isActivated("AppRuntime.TemplateSizeConstrainer")}));n.valueRangeConstrainer=function(t,n,o){return e.Data.DataValue.isBlankOrErrorValue(t)?null:!e.Data.DataValue.isBlankOrErrorValue(n)&&t<n?n:!e.Data.DataValue.isBlankOrErrorValue(o)&&t>o?o:t},n.templateWidthConstrainer=function(n){return e.Data.DataValue.isBlankOrErrorValue(n)?e.Constants.MinimumTemplateWidth:e.Controls.modelValueConstrainers.valueRangeConstrainer(n,e.Constants.MinimumTemplateWidth,o.value?t.AppInfo.screenWidth:null)},n.templateHeightConstrainer=function(n){return e.Data.DataValue.isBlankOrErrorValue(n)?e.Constants.MinimumTemplateHeight:e.Controls.modelValueConstrainers.valueRangeConstrainer(n,e.Constants.MinimumTemplateHeight,o.value?t.AppInfo.screenHeight:null)}}(t.modelValueConstrainers||(t.modelValueConstrainers={}))}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n,o,r=e.AuthoringTool.OpenAjaxPropertyNames,i=e.Constants.LayoutDirection;!function(e){e[e.noErrors=0]="noErrors",e[e.propertyErrors=1]="propertyErrors",e[e.recordErrors=2]="recordErrors",e[e.allErrors=3]="allErrors"}(o=t.ErrorCapability||(t.ErrorCapability={}));var a=((n={})[r.X]={layoutPropertyName:r.AutoLayoutX},n[r.Y]={layoutPropertyName:r.AutoLayoutY},n[r.Width]={layoutPropertyName:r.AutoLayoutWidth,primaryAxis:i.Horizontal},n[r.Height]={layoutPropertyName:r.AutoLayoutHeight,primaryAxis:i.Vertical},n),s=function(){function n(e,t,n){this.setValueInternalFunc=null,this._isConstant=!0,this._isSelectedProperty=!1,this._isUpdateProperty=!1,this._isSubjectToAutoLayout=!1,this._property=t,this.allowsPerCharacterFormatting=t.allowsPerCharacterFormatting,this.isDataProperty=n,this.propertyName=t.propertyName,this._propertyInvariantName=t.propertyInvariantName,this.isPrimaryInputProperty=t.isPrimaryInputProperty,this.isPrimaryBehaviorProperty=t.isPrimaryBehaviorProperty,this.isRecordingReadOnly=t.isRecordingReadOnly,this.canBeCompressed=t.canBeCompressed,this.isResettable=t.isResettable,this.errorCapability=t.errorCapability||o.noErrors,this._isSelectedProperty="IsSelected"===this._propertyInvariantName,this._isUpdateProperty="Update"===this._propertyInvariantName,this._isSubjectToAutoLayout=this._propertyInvariantName in a}return n.initializeStaticClassProperties=function(){if(n._isAuthoring=e.AuthoringTool.Runtime.isAuthoring,n._isSetValueTelemetryEnabled){var t=e.AuthoringTool.OpenAjaxPropertyNames;n._boundsPropertyMap={},n._boundsPropertyMap[t.X]=!0,n._boundsPropertyMap[t.Y]=!0,n._boundsPropertyMap[t.LayoutX]=!0,n._boundsPropertyMap[t.LayoutY]=!0,n._boundsPropertyMap[t.Width]=!0,n._boundsPropertyMap[t.Height]=!0,n._boundsPropertyMap[t.LayoutWidth]=!0,n._boundsPropertyMap[t.LayoutHeight]=!0,n._boundsPropertyMap[t.ZIndex]=!0,n._boundsPropertyMap[t.TemplateSize]=!0,n._boundsPropertyMap[t.AutoWidth]=!0,n._knownSetValueFalsePositivesMap={},n._knownSetValueFalsePositivesMap["label.Height"]=!0,n._knownSetValueFalsePositivesMap["htmlViewer.Height"]=!0,n._knownDynamicPropertiesMap={},n._knownDynamicPropertiesMap[t.Reset]=!0,n._knownDynamicPropertiesMap[t.PreserveAspectRatio]=!0,n._knownDynamicPropertiesMap[t.IsErrorMessage]=!0}},n.prototype.checkAndConstrainPropertyValue=function(e,n,o){return t.AppMagicControlPropertyUtils.enforceType(o,this.propertyType),o=this.modelValueConstrainerFn(o),null===(o=this._adjustModelValueForAutoLayout(e,n,o))&&null!==this._nullDefault&&(o=this._nullDefault),o},n.prototype.addPropertyMap=function(e){},n.prototype.modelValueConstrainerFn=function(e){return e},n.prototype._adjustModelValueForAutoLayout=function(e,t,n){var o=e.controlWidget,r=e.bindingContext,i=e.modelProperties;if(!this._isSubjectToAutoLayout||!o.isInAutoLayoutContainer(r))return n;var s=a[t];if(s){var l=s.layoutPropertyName,c=s.primaryAxis;if(!i[l])return Core.Telemetry.Log.trackUIActivityEvent("ControlPropertyBase._adjustModelValueForAutoLayout.modelPropertyUndefined",{isPcfControl:o.isPcfControl,layoutPropertyName:l}),n;var p=o.parentLayoutDirection(r);if(!c||c===p&&o.isPrimaryAxisGrow(r)||c!==p&&o.isCrossAxisStretch(r))return i[l].getValue()}return n},n.prototype.initAutoManipulation=function(n){Contracts.checkValue(n.propertyType),this.propertyType=n.isEnum?n.enumSuperType:n.propertyType.toString(),this.converterName=n.converterName,""!==n.modelValueConstrainerName?this.modelValueConstrainerFn=e.Controls.modelValueConstrainers[n.modelValueConstrainerName]:null===n.minimum&&null===n.maximum||(Contracts.checkNumberOrNull(n.minimum),Contracts.checkNumberOrNull(n.maximum),this.modelValueConstrainerFn=function(t){return e.Controls.modelValueConstrainers.valueRangeConstrainer(t,n.minimum,n.maximum)}),Contracts.checkFunction(this.modelValueConstrainerFn),this._nullDefault=""===n.nullDefault?null:t.AppMagicControlPropertyUtils.coerceToType(n.nullDefault,this.propertyType)},n.prototype.getInitialValue=function(e){return void 0===e&&(e=this.defaultInitialValue),null===(e=this.modelValueConstrainerFn(e))&&null!==this._nullDefault&&(e=this._nullDefault),e},n.prototype._isManagedNestedBoundsProperty=function(e,t){return!(!e.controlWidget.parentUniqueId||!n._boundsPropertyMap[t])&&(this._parent||(this._parent=e.controlWidget.controlManager.getControlInstance(e.controlWidget.parentUniqueId)),!!this._parent&&!!this._parent.control&&!!this._parent.control.managesChildrenLayout&&this._parent.control.managesChildrenLayout())},n.prototype._isResizableBoundsProperty=function(e,t){return n._boundsPropertyMap[t]&&(e.controlWidget.template.inputProperties.some((function(e){return"ResizerGrip"===e.propertyInvariantName}))||e.controlWidget.template.outputProperties.some((function(e){return"ResizerGrip"===e.propertyInvariantName})))},n.prototype._isKnownSetValueFalsePositive=function(e,t){return!!n._knownSetValueFalsePositivesMap[e+"."+t]||!!n._knownDynamicPropertiesMap[t]},n.modelPropertyComputedRead=function(){if(this.propertyObject.converterName){var t=e.Controls.converters[this.propertyObject.converterName];if(Contracts.checkObject(t),t.view&&"function"==typeof t.view)return t.view(this.modelObservable())}var n=this.modelObservable();return Contracts.checkDefined(n),n},n.modelPropertyComputedWrite=function(n){var o=n;if(this.propertyObject.converterName){var r=e.Controls.converters[this.propertyObject.converterName];Contracts.checkObject(r),r.model&&"function"==typeof r.model&&(o=r.model(n))}var i=t.AppMagicControlPropertyUtils.coerceToType(o,this.propertyObject.propertyType);this.propertyObject.setValue(this.controlContext,this.propertyInvariantName,i,!1)},n.prototype.attachTemplateControlContext=function(t,n,o){this._templateControlContext=o,this._attachedControlContext=t;var r=this.getValue(o,n),i=this.getValue(t,n);!this._isUpdateProperty&&e.Utility.deepCompare(i,r)||this.setValue(o,n,i,!1,this._isUpdateProperty,!1,!0)},n.prototype.detachTemplateControlContext=function(){this._templateControlContext=null,this._attachedControlContext=null},n.prototype.getVisibleValue=function(t,n){return e.Data.DataValue.errorValueToNull(this.getValue(t,n))},n.prototype.setValue=function(e,o,r,i,a,s,l){if(i=!!i,(a=!!a||t.ControlWidget.shouldSkipCompare(e,o))&&t.ControlWidget.registerSkippedCompare(e,o),s=!!s,n._isSetValueTelemetryEnabled&&!n._isAuthoring&&this._isConstant&&this.canBeCompressed&&!this._isManagedNestedBoundsProperty(e,o)&&n._telemetryErrorCounter<n._maxTelemetryErrorsToLog){var c=e.controlWidget.template.name;if(!this._isKnownSetValueFalsePositive(c,o)&&!this._isResizableBoundsProperty(e,o)){n._telemetryErrorCounter++;Core.Telemetry.Log.trackActivityEvent("ControlPropertyBase.setValue",{message:"With few exceptions, it is expected that control properties won't change in the published app except via code gen or unless it is marked canBeCompressed=false in the control OAM. Consider updating the OAM.",controlTemplateName:e.controlWidget.template.name,controlId:e.controlWidget.uniqueId,propertyInvariantName:o}),n.strictContractsEnabled}}var p=this.tryGetValue(e,o);if(r=this.checkAndConstrainPropertyValue(e,o,r),this._isLoaded&&(a||r!==p)&&(this.setValueInternalFunc(e,o,p,r,i,a,s,l),this._attachedControlContext===e)){var u=this.getValue(e,o),d=this.getValue(this._templateControlContext,this._propertyInvariantName);u===d||"number"==typeof u&&isNaN(u)&&"number"==typeof d&&isNaN(d)||this.setValue(this._templateControlContext,o,r,i,a,s,l)}return r},n._telemetryErrorCounter=0,n._maxTelemetryErrorsToLog=35,n._isTestMode=!1,__decorate([initializeOnLoad((function(){return Core.FeatureGates.controls.strictControlPropertyContracts}))],n,"strictContractsEnabled",void 0),__decorate([initializeOnLoad((function(){return Core.FeatureGates.controls.codeGenCanBeCompressed}))],n,"_isSetValueTelemetryEnabled",void 0),n}();t.ControlPropertyBase=s}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=function(n){function o(r,i,a,s,l,c){var p,u=n.call(this,i,a,c)||this;u.isSkipCompare=!1,u.isInput=s,u.isOutput=l,u._controlUniqueId=r,u._controlId=i;var d,h=!1,C=r+"."+a.propertyName,g=null,m=!1;t.ControlPropertyBase._isAuthoring&&(g=e.AuthoringTool.Runtime.tryGetCachedConstantValue(C));var f=e.AuthoringTool.Runtime._iVM;(Core.Utility.isObject(f)&&!t.ControlPropertyBase._isAuthoring&&(d=f[C],m=Core.Utility.isDefined(d),u._isConstant=m),g?(p=g,h=!0):m?(p=d,h=!0):(p=a.defaultValue,t.ControlPropertyBase._isAuthoring&&(p=e.context.documentViewModel.documentLayoutManager.getPropertyDefaultValueForFormFactor(a))),u.defaultInitialValue=t.AppMagicControlPropertyUtils.getDefaultInitialValue(a,p,h),u.initAutoManipulation(a),u._isLoaded=!0,h&&t.ControlPropertyBase._isAuthoring)&&e.context.documentViewModel.tryGetEntityByName(i).setPropertyValue(a.propertyInvariantName,u.defaultInitialValue,!0);return o._isTestMode=Core.Environment.isTestMode(),u}return __extends(o,n),o.prototype.updateControlId=function(e){this._controlId=e},o.prototype.initProperty=function(e,t,n){var o=e.controlWidget.template.supportResettableProperties&&this.isResettable;this.setValueInternalFunc=o?this.setModelResettableValueInternal:this.setModelValueInternal,n=this.getInitialValue(n),e.modelProperties[t]={getValue:this.getVisibleValue.bind(this,e,t),setValue:this.setValue.bind(this,e,t),resetValue:this.resetValue.bind(this,e,t),modelObservable:null};var r=this._getPropertyStore(e);Core.Utility.isNullOrUndefined(r[this._controlId][t])&&(r[this._controlId][t]={ruleValue:n,lastValue:n})},o.prototype.recycleProperty=function(e,t,n){n=this.getInitialValue(n),this._getPropertyStore(e)[this._controlId][t]={ruleValue:n,lastValue:n}},o.prototype.promotePropertyForView=function(t,n){var r=this._getPropertyStore(t)[this._controlId][n],i=t.modelProperties[n].modelObservable=ko.observable(e.Data.DataValue.errorValueToNull(r.lastValue));(t.properties[n]=ko.pureComputed({read:o.modelPropertyComputedRead,write:o.modelPropertyComputedWrite},{propertyObject:this,controlContext:t,propertyInvariantName:n,modelObservable:i})).propertyName=n},o.prototype.demotePropertyForView=function(e,t){e.modelProperties[t].modelObservable=null,e.properties[t].dispose(),delete e.properties[t]},o.prototype.tryGetValue=function(e,t){var n,o;return null!==(o=null===(n=this._tryGetPropValueInternal(e,t))||void 0===n?void 0:n.lastValue)&&void 0!==o?o:null},o.prototype.tryGetRuleValue=function(e,t){var n,o;return null!==(o=null===(n=this._tryGetPropValueInternal(e,t))||void 0===n?void 0:n.ruleValue)&&void 0!==o?o:null},o.prototype._tryGetPropValueInternal=function(e,t){var n=this._getPropertyStore(e);if(!n||!Core.Utility.isValue(n[this._controlId]))return null;var o=n[this._controlId][t];return Core.Utility.isValue(o)?o:null},o.prototype.getValue=function(t,n){var o,r,i,a;if(t.bindingContext.componentInstance){var s=null===(o=OpenAjax.widget.controlManager.getControlInstanceById(t.controlWidget.topParentOrSelfUniqueId))||void 0===o?void 0:o.control;if(s&&!e.Utility.isComponent(s.OpenAjax.template.className)){var l=OpenAjax.widget.byId(this._controlId);t=l&&l.OpenAjax&&l.OpenAjax.getControlContext(t.bindingContext.parent)||t}}return null!==(a=null===(i=null===(r=this._getPropertyStore(t)[this._controlId])||void 0===r?void 0:r[n])||void 0===i?void 0:i.lastValue)&&void 0!==a?a:null},o.prototype._getPropertyStore=function(e){return this.isOutput?e.bindingContext.outputRow:e.bindingContext.inputRow},o.prototype.setModelValueInternal=function(t,n,o,r,i,a,s,l){var c,p,u=e.Data.DataValue.isErrorValue(r)?null:r;this._handleBeforeChangeEvents(t,n,o,r,i,a,s),this._getPropertyStore(t)[this._controlId][this._propertyInvariantName]={ruleValue:r,lastValue:r},this._setModelProperty(t.modelProperties[this._propertyInvariantName],u),null===(p=null===(c=t.controlWidget)||void 0===c?void 0:c.runtimeCapabilityNotifyPropertyChanged)||void 0===p||p.call(c,t.controlWidget,n,r,t),i||t.controlWidget.handlePropertyValueChanged(t,n,o,u,s,l)},o.prototype._handleBeforeChangeEvents=function(t,n,o,r,i,a,s){i||t.controlWidget.handleBeforePropertyValueChanged(t,n,o,r,a);var l=e.Data.DataValue.isErrorValue(r)?null:r;e.Utility.isComponent(t.controlWidget.template.className)&&this._handleComponentPropertyChange(t,n,o,r,l,i,a,s)},o.prototype.setModelResettableValueInternal=function(t,n,o,r,i,a,s,l){var c,p,u=e.Data.DataValue.isErrorValue(r)?null:r;this._handleBeforeChangeEvents(t,n,o,r,i,a,s);var d=this._getPropertyStore(t);l?d[this._controlId][this._propertyInvariantName]={ruleValue:r,lastValue:r}:d[this._controlId][this._propertyInvariantName].lastValue=r,this._setModelProperty(t.modelProperties[this._propertyInvariantName],u),null===(p=null===(c=t.controlWidget)||void 0===c?void 0:c.runtimeCapabilityNotifyPropertyChanged)||void 0===p||p.call(c,t.controlWidget,n,r,t),i||t.controlWidget.handlePropertyValueChanged(t,n,o,u,s,l)},o.prototype.resetValue=function(e,t){var n=this._getPropertyStore(e)[this._controlId][t];this.setValue(e,t,n.ruleValue)},o.prototype._handleComponentPropertyChange=function(e,t,n,o,r,i,a,s){var l=e.bindingContext.componentInstance,c=e.controlWidget.componentDefinitionName;if(!l&&c&&c!==this._controlId){var p=e.bindingContext.componentBindingContexts.getOrCreateComponentContext(this._controlId,c,this._controlUniqueId);if(p){var u=e.controlWidget.getControlContext(p);if(u)(h=this._getPropertyStore(u))[this._controlId][this._propertyInvariantName]={ruleValue:o,lastValue:o},h[c]&&(h[c][this._propertyInvariantName]={ruleValue:o,lastValue:o})}}if(l){if(l!==e.controlWidget.controlName)return;var d=e.controlWidget.getControlContext(e.bindingContext.parent);if(!d)return;var h,C=this.tryGetValue(e,this._propertyInvariantName);if(l===this._controlId&&o!==C)i||d.controlWidget.handleBeforePropertyValueChanged(d,t,n,o,a),(h=this._getPropertyStore(d))[l][this._propertyInvariantName]={ruleValue:o,lastValue:o},this._setModelProperty(d.modelProperties[this._propertyInvariantName],r),i||d.controlWidget.handlePropertyValueChanged(d,t,n,r,s,!0)}},o.prototype._setModelProperty=function(e,t){e.modelObservable&&e.modelObservable(t)},o}(t.ControlPropertyBase);t.ControlProperty=n}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=function(n){function o(o,r){var i,a=n.call(this,"Global",o,r)||this;a._isInitialized=!1,a.setValueInternalFunc=a.setModelValueInternal;var s,l=!1,c=o.propertyName,p=e.AuthoringTool.Runtime._giVM;return Core.Utility.isObject(p)&&(s=p[c]),Core.Utility.isFunction(s)?(i=o.defaultValue,a._isConstant=!1,a._relevantControlContexts=new Map):Core.Utility.isDefined(s)?(i=s,l=!0):i=o.defaultValue,a.defaultInitialValue=t.AppMagicControlPropertyUtils.getDefaultInitialValue(o,i,l),a.initAutoManipulation(o),a._isLoaded=!0,a}return __extends(o,n),o.prototype.addPropertyMap=function(e){""!==e.converterName&&(this.converterName&&Contracts.check(this.converterName===e.converterName,"Control global property got multiple converters!"),this.converterName=e.converterName)},o.prototype.updateControlId=function(e){},o.prototype.initProperty=function(e,n,o){if(!this._isConstant){var r=this._getUniqueControlContextId(e);this._relevantControlContexts.has(r)?this._relevantControlContexts.get(r).propertyInvariantNames.push(n):this._relevantControlContexts.set(r,{controlContext:e,propertyInvariantNames:[n]})}e.modelProperties[n]=t.AppMagicControlPropertyUtils.getOrCreateGlobalModelProperty(this,this._propertyInvariantName,e,n),this._isInitialized||(o=this.getInitialValue(o),t.AppMagicControlPropertyUtils.setGlobalPropertyValue(this._propertyInvariantName,o),this._isInitialized=!0)},o.prototype.handleControlContextDisposed=function(e){if(!this._isConstant){var t=this._getUniqueControlContextId(e);this._relevantControlContexts.has(t)&&this._relevantControlContexts.delete(this._getUniqueControlContextId(e))}},o.prototype._getUniqueControlContextId=function(e){return e.bindingContext.id+"/"+e.controlWidget.uniqueId},o.prototype.recycleProperty=function(e,n,o){o=this.getInitialValue(o),t.AppMagicControlPropertyUtils.setGlobalPropertyValue(this._propertyInvariantName,o)},o.prototype.promotePropertyForView=function(e,n){e.properties[n]=t.AppMagicControlPropertyUtils.setGlobalProperty(this._propertyInvariantName,this)},o.prototype.demotePropertyForView=function(e,t){},o.prototype.tryGetValue=function(e,n){var o=t.AppMagicControlPropertyUtils.getGlobalPropertyValue(this._propertyInvariantName);return Core.Utility.isValue(o)?o:null},o.prototype.tryGetRuleValue=function(e,t){return this.tryGetValue(e,t)},o.prototype.getValue=function(e,n){return t.AppMagicControlPropertyUtils.getGlobalPropertyValue(this._propertyInvariantName)},o.prototype.resetValue=function(e,t){},o.modelPropertyComputedWrite=function(n){var o=n;if(this.propertyObject._converterName){var r=e.Controls.converters[this.propertyObject._converterName];"function"==typeof r.view&&(o=r.model(n))}var i=this.propertyObject._typeCoercerFn(o);this.propertyObject.setValue(this.controlContext,this.propertyInvariantName,i,!1),t.AppMagicControlPropertyUtils.setGlobalPropertyValue(this.propertyInvariantName,i)},o.prototype._callAllRelevantOnChangeHandlers=function(e,n,o,r,i,a){if(this._isConstant)i?e.controlWidget.handleBeforePropertyValueChanged(e,n,o,r,a):e.controlWidget.handlePropertyValueChanged(e,n,o,r,a,!0);else{var s=this._relevantControlContexts.size;if(this._relevantControlContexts.forEach((function(e){e.controlContext.initialized&&e.propertyInvariantNames.forEach((function(t){return i?e.controlContext.controlWidget.handleBeforePropertyValueChanged(e.controlContext,t,o,r,a):e.controlContext.controlWidget.handlePropertyValueChanged(e.controlContext,t,o,r,a,!0)}))})),this._relevantControlContexts.size>s&&t.ControlPropertyBase._telemetryErrorCounter<t.ControlPropertyBase._maxTelemetryErrorsToLog){t.ControlPropertyBase._telemetryErrorCounter++;Core.Telemetry.Log.trackActivityEvent("GlobalControlProperty._callAllRelevantOnChangeHandlers",{message:"control contexts were added to this._relevantControlContexts while triggering on change handlers for controls",controlTemplateName:e.controlWidget.template.name,controlId:e.controlWidget.uniqueId,propertyInvariantName:n,globalName:this._propertyInvariantName})}}},o.prototype.setModelValueInternal=function(n,o,r,i,a,s,l){var c,p;if(Contracts.checkDefined(i),this._isConstant&&t.ControlPropertyBase._telemetryErrorCounter<t.ControlPropertyBase._maxTelemetryErrorsToLog){t.ControlPropertyBase._telemetryErrorCounter++;var u="setModelValueInternal should never be called for constant global properties";Core.Telemetry.Log.trackActivityEvent("GlobalControlProperty.setModelValueInternal",{message:u,controlTemplateName:n.controlWidget.template.name,controlId:n.controlWidget.uniqueId,propertyInvariantName:o,globalName:this._propertyInvariantName,callstack:Contracts._sourceFromStacktrace()}),t.ControlPropertyBase.strictContractsEnabled&&Contracts.check(!1,u)}a||this._callAllRelevantOnChangeHandlers(n,o,r,i,!0,s),t.AppMagicControlPropertyUtils.setGlobalPropertyValue(this._propertyInvariantName,i);var d=t.AppMagicControlPropertyUtils.getOrCreateGlobalModelProperty(this,this._propertyInvariantName,n,o);e.Data.DataValue.isErrorValue(i)&&(i=null),d.modelObservable&&d.modelObservable(i),null===(p=null===(c=n.controlWidget)||void 0===c?void 0:c.runtimeCapabilityNotifyPropertyChanged)||void 0===p||p.call(c,n.controlWidget,o,i,n),a||this._callAllRelevantOnChangeHandlers(n,o,r,i,!1,!1)},o}(t.ControlPropertyBase);t.GlobalControlProperty=n}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=function(){function n(){}return n.getOrCreateGlobalModelProperty=function(e,t,o,r){return n._globalModelProperties||(n._globalModelProperties=Object.create(null,{})),n._globalModelProperties[t]||(n._globalModelProperties[t]={getValue:e.getVisibleValue.bind(e,o,r),setValue:e.setValue.bind(e,o,r),resetValue:e.resetValue.bind(e,o,r),modelObservable:null}),n._globalModelProperties[t]},n.setGlobalPropertyValue=function(e,t){n._globalPropertyStore||(n._globalPropertyStore=Object.create(null,{})),n._globalPropertyStore[e]=t},n.getGlobalPropertyValue=function(e){return n._globalPropertyStore||(n._globalPropertyStore=Object.create(null,{})),n._globalPropertyStore[e]},n.setGlobalProperty=function(o,r){if(n._globalProperties||(n._globalProperties={}),!n._globalProperties[o]){var i=n.getGlobalPropertyValue(o),a=n._globalModelProperties[o].modelObservable=ko.observable(e.Data.DataValue.errorValueToNull(i));n._globalProperties[o]=ko.pureComputed({read:t.GlobalControlProperty.modelPropertyComputedRead,write:t.GlobalControlProperty.modelPropertyComputedWrite},{propertyObject:r,propertyInvariantName:o,modelObservable:a})}return n._globalProperties[o]},n.getGlobalProperty=function(e){return n._globalControlPropertyMap[e]},n.getOrCreateGlobalProperty=function(e,o,r){var i;if(n._globalControlPropertyMap||(n._globalControlPropertyMap=Object.create(null,{})),n._globalControlPropertyMap[e])i=n._globalControlPropertyMap[e];else{var a=__assign({},o);a.propertyName=e,a.propertyInvariantName=e,i=new t.GlobalControlProperty(a,r),n._globalControlPropertyMap[e]=i}return i.addPropertyMap(o),i},n.getDefaultInitialValue=function(e,t,n){void 0===n&&(n=!1);var o=null;if(!n&&e.isExpr)return null;switch(e.isEnum?e.enumSuperType:e.propertyType.toString()){case"s":case"i":case"m":case"o":case"h":case"$":o="string"==typeof t&&t.length>=2&&'"'===t[0]&&'"'===t[t.length-1]?t.substring(1,t.length-1):t;break;case"n":o=""===t?0:parseFloat(t);break;case"c":case"T":o=""===t?0:parseFloat(t);break;case"D":case"d":o=""===t?null:parseFloat(t);break;case"b":o="true"===t.toLowerCase();break;case"![]":o=t&&"object"==typeof t?t:null;break;default:o=null}return o},n.coerceToType=function(t,n){switch(Contracts.checkNonEmpty(n),n){case"s":case"i":return Contracts.checkDValuePrimitiveType(t),e.Data.DataValue.isErrorValue(t)?t:null===t?"":"string"==typeof t?t:t.toString();case"n":case"c":if(Contracts.checkDValuePrimitiveType(t),e.Data.DataValue.isErrorValue(t))return t;if(null===t)return 0;switch(typeof t){case"number":return t;case"string":return parseFloat(t);case"boolean":return t?1:0;default:return Contracts.check(!1,"Unsupported type coercion: "+typeof t+" to number."),null}case"b":if(Contracts.checkDValuePrimitiveType(t),e.Data.DataValue.isErrorValue(t))return t;if(null===t)return!1;switch(typeof t){case"boolean":return t;case"number":return!!t;case"string":return"true"===t.toLowerCase();default:return Contracts.check(!1,"Unsupported type coercion: "+typeof t+" to boolean."),null}default:return Contracts.checkDefined(t),t}},n.enforceType=function(n,o){switch(Contracts.checkNonEmpty(o),o){case"s":case"i":t.ControlProperty._isTestMode?Contracts.checkDValueString(n):e.Data.ErrorValue.isGatedError(n)||Core.Utility.isStringOrNull(n)||Core.Log.warning("ControlProperty.typeEnforcer","assertDValueString failed");break;case"c":case"n":t.ControlProperty._isTestMode?Contracts.checkDValueNumber(n):e.Data.ErrorValue.isGatedError(n)||Core.Utility.isNumberOrNull(n)||Core.Log.warning("ControlProperty.typeEnforcer","assertDValueNumber failed");break;case"b":t.ControlProperty._isTestMode?Contracts.checkDValueBoolean(n):e.Data.ErrorValue.isGatedError(n)||Core.Utility.isBooleanOrNull(n)||Core.Log.warning("ControlProperty.typeEnforcer","assertDValueBoolean failed");break;default:t.ControlProperty._isTestMode?Contracts.checkDefined(n):Core.Utility.isDefined(n)||Core.Log.warning("ControlProperty.typeEnforcer","assertDefined failed")}},n.resetContext_TestOnly=function(){Core.Environment.isTestMode()&&(n._globalPropertyStore={},n._globalControlPropertyMap={},n._globalModelProperties={},n._globalProperties={})},n}();t.AppMagicControlPropertyUtils=n}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=e.Utility,o=Collections.Generic,r=e.Constants,i=function(){function i(e,t){t.replicatedContexts[e.managerId]=this,this._parentBindingContext=t,this._templateBindingContext=null,this._manager=e,this._observer=null,this._nestedReachabilityChanged=!1,this._isMissingReachabilityRuleReported=!1,this._missingReachabilityRuleReportedCount=0,this._initTablesAndLookups(),this._isLoaded=!0,this._replicatedBindingContextsUpdatedCallback=Core.Environment.getRuntimeCapabilityCallback("PushReplicatedContextChangedEvents")}return i.create=function(e,t){new i(e,t)._setOrCreateTemplateBindingContext()},i.prototype.isFirstItem=function(e){var t=e.id;return this._rowView&&this._rowView.length>0&&this._rowView[0]===t},Object.defineProperty(i.prototype,"bindingContextLookup",{get:function(){return this._bindingContextLookup},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"templateBindingContext",{get:function(){return this._templateBindingContext},enumerable:!1,configurable:!0}),i.prototype.hasFirstItem=function(){return this._rowView&&this._rowView.length>0},Object.defineProperty(i.prototype,"manager",{get:function(){return this._manager},enumerable:!1,configurable:!0}),i.prototype.setObserver=function(e){this._observer=e},i.prototype.hydrateBindingContext=function(e){this.forEachBindingContext((function(t){t.rcManager.hydrateBindingContext(t,e[t.id])}))},i.prototype.dehydrateBindingContext=function(e){this.forEachBindingContext((function(t){e[t.id]=t.rcManager.dehydrateBindingContext(t)}))},i.prototype.getBindingContextCount=function(){return this.hasFirstItem()?this._rowView.length:0},i.prototype.setNestedReachabilityChanged=function(){this._nestedReachabilityChanged=!0},i.prototype.getRecordIndex=function(t){for(var n="",o=this._inputTable.length,i=0;i<o;i++){var a=this._inputTable[i]._src?this._inputTable[i]._src:this._inputTable[i],s={};if(s[r.Runtime.idProperty]=!0,e.Utility.deepCompare(t,a,s)){n=this._getInternalRowId(this._inputTable,i);break}}return""===n?-1:this._comprehensiveRowView.indexOf(n)},i.prototype.getRecordIndexByPrimaryKey=function(e){return this._primaryKeyRowView.indexOf(e)},i.prototype.tryGetContextAt=function(e){var t=null,n=this._rowView[e];return n&&(t=this._bindingContextLookup[n]),t},i.prototype.bindingContextAt=function(t,n){var o=null,r=this._rowView[t];return null===r&&this._inputTable.length>0?(o=this._buildRowBindingContext(this._inputTable,t),this._manager.runBindingContextDataFlow(o)):null!==r&&(o=this._bindingContextLookup[r]),n&&null!==o&&!o.itemDataPromise&&(o.itemDataPromise=e.AuthoringTool.Runtime.waitForPendingDataRulesToExecuteAsync([o.id])),this._observer&&this._observer.bindingContextRequested(t,this._rowView.length),o},i.prototype.clearBindingContextSelection=function(){this._selectedBindingContexts&&(this._selectedBindingContexts.clear(),this.notifySelectedItemsChanged())},i.prototype.notifyBindingContextSelectionInteraction=function(t,n){var o=t.rcManager.getControlWidget();if(o){var r=o.getControlContext(t.parent);if(r&&r.viewState&&r.viewState.displayMode()!==e.Constants.DisplayMode.Edit)return}this._ensureSelectedBindingContexts();var i=!1;if(n?(this._selectedBindingContexts.toggle(t),i=!0):(this._selectedBindingContexts.count>1||!this._selectedBindingContexts.contains(t))&&(this._selectedBindingContexts.clear(),this._selectedBindingContexts.add(t),i=!0),i&&this.notifySelectedItemsChanged(),this._parentBindingContext.observedBindingContext){var a=this._manager.replicatedContextFor(this._parentBindingContext.observedBindingContext),s=this._comprehensiveRowView.indexOf(t.id),l=a.bindingContextAt(s);l&&a.notifyBindingContextSelectionInteraction(l,n)}},i.prototype.addSelectionChangedListener=function(e,t){this._selectedBindingContexts?this._selectedBindingContexts.subscribe(e,t):this._selectionListeners.push({bindingContext:e,listener:t})},i.prototype.removeSelectionChangedListener=function(e,t){this._selectedBindingContexts?this._selectedBindingContexts.unsubscribe(e,t):this._selectionListeners=this._selectionListeners.filter((function(e){return e.listener!==t}))},i.prototype.getOutputTable=function(){return this._ensureOutputTable(),this._getCurrentOutputTable()},i.prototype.getSelectedItemsTable=function(){return this._ensureSelectedItemsTable(),this._selectedItemsTable},i.prototype.getSelectedItem=function(){return this._ensureSelectedItem(),this._selectedItem},i.prototype.getSelectedItemIndex=function(){this._ensureSelectedBindingContexts();var e=this._selectedBindingContexts.items()[0];return e?this.getItemIndexByBindingContextId(e.id):-1},i.prototype.getItemIndexByBindingContextId=function(e){for(var t=0,n=this._rowView.length;t<n;t++){var o=this._rowView[t];if(o&&this._bindingContextLookup[o]&&this._bindingContextLookup[o].id===e)return t}return-1},i.prototype.getSelectedBindingContext=function(){this._ensureSelectedBindingContexts();var e=this._selectedBindingContexts.items()[0];return e?this._manager.authoringAreaBindingContext.observedBindingContext===e?this._manager.authoringAreaBindingContext:e:null},i.prototype.clearCache=function(){this._bindingContextCache={}},i.prototype.clearInputTable=function(){this._disposePreviousBindingContexts(),this._manager.authoringAreaBindingContext.parent===this._parentBindingContext&&(this._manager.authoringAreaBindingContext.thisItem={})},i.prototype.applyInputTable=function(e,t){this._isMissingReachabilityRuleReported=!1;var n=r.Runtime.idProperty;null!==this._inputTable&&void 0!==this._inputTable[n]&&this._inputTable[n]===e[n]&&this._inputTable.length&&e.length?this._applyInputTableWithDeltaInternal(e,t):this._applyInputTableInternal(e,t),this._inputTable=e,this._notifyInputTableChanged(),this.notifyOutputTableChanged(),this.notifySelectedItemsChanged()},i.prototype.forEachBindingContext=function(e){if(this._isLoaded){this._templateBindingContext!==this._manager.authoringAreaBindingContext&&e(this._templateBindingContext);for(var t=0,n=this._rowView.length;t<n;t++)null!==this._rowView[t]&&e(this._bindingContextLookup[this._rowView[t]]);for(var o in this._bindingContextCache)e(this._bindingContextCache[o])}else Core.Log.warningEx("ReplicatedContext.forEachBindingContext","Instance is disposed")},i.prototype.notifyOutputRowChanged=function(e){var t=this;if(!this._suppressNotify()&&this._blockRowChangedNotification!==e&&void 0===this._bindingContextCache[e]){var o=this._bindingContextLookup[e];o&&"function"==typeof this._manager.notifyOutputRowChangedFn&&n.executeOnceAsync((function(){return t._manager.notifyOutputRowChangedFn(t._parentBindingContext,e,o.outputRow)}),"".concat(this._manager.controlWidget.getId(),"__reUpdateOutputRow__").concat(this._parentBindingContext.id,"_row").concat(e),1,(function(){return t._isManagerAndParentBindingContextValid()&&!!t._bindingContextLookup[e]}))}},i.prototype.notifyOutputTableChanged=function(){var e=this;this._suppressNotify()||"function"==typeof this._manager.notifyOutputTableChangedFn&&n.executeOnceAsync((function(){return e._manager.notifyOutputTableChangedFn(e._parentBindingContext)}),"".concat(this._manager.controlWidget.getId(),"__rcUpdateOutputTable__").concat(this._parentBindingContext.id),2,(function(){return e._isManagerAndParentBindingContextValid()}))},i.prototype.notifySelectedItemsChanged=function(){var e=this;this._suppressNotify()||"function"==typeof this._manager.notifySelectedItemsChangedFn&&n.executeOnceAsync((function(){return e._manager.notifySelectedItemsChangedFn(e._parentBindingContext)}),"".concat(this._manager.controlWidget.getId(),"__rcUpdateSelectedItems__").concat(this._parentBindingContext.id),3,(function(){return e._isManagerAndParentBindingContextValid()}))},i.prototype.dispose=function(){this._disposePreviousBindingContexts(),this._disposeTemplateBindingContext(),this._isLoaded=!1,this._templateBindingContext=null,this._parentBindingContext=null,this._inputTable=null,this._selectionListeners=null,this._selectedBindingContexts=null,this._bindingContextLookup=null,this._bindingContextCache=null,this._selectedItemsTable=null,this._selectedItem=null,this._outputTable=null,this._comprehensiveRowView=null,this._primaryKeyRowView=null,this._rowView=null},i.prototype.restore=function(e){this._parentBindingContext=e,this._isMissingReachabilityRuleReported=!1,this._initTablesAndLookups(),this._isLoaded=!0,this._setOrCreateTemplateBindingContext()},i.prototype._notifyInputTableChanged=function(){var e;null===(e=this._replicatedBindingContextsUpdatedCallback)||void 0===e||e.call(this,this._manager.controlWidget,this._parentBindingContext,this._comprehensiveRowView)},i.prototype._isManagerAndParentBindingContextValid=function(){return this._isLoaded&&this._manager.isLoaded&&!this._parentBindingContext.disposed},i.prototype._getCurrentOutputTable=function(){for(var t=[],n=0;n<this._outputTable.length;++n){for(var o=this._outputTable[n],r=e.Data.DataRecord.create(),i=0,a=Object.keys(o);i<a.length;i++){var s=a[i];if(o.hasOwnProperty(s)){var l=o[s];if("_src"!==s){for(var c=e.Data.DataRecord.create(),p=0,u=Object.keys(l);p<u.length;p++){var d=u[p];l.hasOwnProperty(d)&&l[d]&&(c[d]=l[d].lastValue)}r[s]=c}else r[s]=l}}t[n]=r}return t},i.prototype._initTablesAndLookups=function(){this._inputTable=[],this._selectionListeners=[],this._bindingContextCache={},this._bindingContextLookup={},this._rowView=[],this._comprehensiveRowView=[],this._primaryKeyRowView=[],this._outputTable=[]},i.prototype._ensureOutputTable=function(){var e=[],t=[];if(this._populatePartialTables(e,t),this._manager.runOptimizedReplicatedDataFlow(this._parentBindingContext,e,t))this._nestedReachabilityChanged=!1;else{var n=performance.now();this._runDataFlowForOutputTable(),this._reportMissingReachabilityRule(performance.now()-n)}},i.prototype._reportMissingReachabilityRule=function(e){var t,n;if(!this._isMissingReachabilityRuleReported){this._isMissingReachabilityRuleReported=!0;if(!(this._missingReachabilityRuleReportedCount>=5)){var o;this._missingReachabilityRuleReportedCount++;var r=this._manager.controlWidget,i=r.uniqueId,a=r.isReplicable;if(a){var s=this._tryGetParentReplicatedContext();if(!(null==s?void 0:s.isFirstItem(this._parentBindingContext)))return;o=this._manager.parentManager.getControlWidget().uniqueId}var l={rowViewLen:null!==(n=null===(t=this._rowView)||void 0===t?void 0:t.length)&&void 0!==n?n:0,controlIsReplicated:a,controlUniqueId:i,parentUniqueId:o,duration:e,reportCount:this._missingReachabilityRuleReportedCount};5===this._missingReachabilityRuleReportedCount&&(l.extendedMessage="Reporting count has reached maximum of ".concat(5," and will now be paused.")),Core.Log.warningEx("ReplicatedContext._ensureOutputTable","Reachability rule is missing",{eventData:l})}}},i.prototype._tryGetParentReplicatedContext=function(){var e,t,n=this._manager.parentManager;return null!==(t=null===(e=n.replicatedContextFor)||void 0===e?void 0:e.call(n,this._parentBindingContext))&&void 0!==t?t:null},i.prototype._ensureSelectedItemsTable=function(){var e=this;this._ensureSelectedBindingContexts(!0);var t=this._rowView.filter((function(t,n){return 0===n?e._selectedBindingContexts.contains(e._manager.authoringAreaBindingContext):e._selectedBindingContexts.contains(e._bindingContextLookup[t])}));this._selectedItemsTable=t.map((function(t){return e._bindingContextLookup[t].outputRow}))},i.prototype._ensureSelectedItem=function(){this._ensureSelectedBindingContexts(!0);var e=this._selectedBindingContexts.items()[0];this._selectedItem=e?e.outputRow:null},i.prototype._ensureSelectedBindingContexts=function(e){var t=this;void 0===e&&(e=!1),this._selectedBindingContexts||(this._selectedBindingContexts=new o.ObservableSet,e&&this._selectedBindingContexts.add(this._manager.authoringAreaBindingContext),this._selectionListeners.forEach((function(e){t._selectedBindingContexts.subscribe(e.bindingContext,e.listener)})),this._selectionListeners=[])},i.prototype._runDataFlowForOutputTable=function(){for(var e=0,t=this._rowView.length;e<t;e++)if(null===this._rowView[e]){var n=this._buildRowBindingContext(this._inputTable,e);this._manager.runBindingContextDataFlow(n)}},i.prototype._populatePartialTables=function(e,t){for(var n=0,o=this._rowView.length;n<o;n++)null!==this._rowView[n]||null!==this._outputTable[n]&&!this._nestedReachabilityChanged||(e.push(this._inputTable[n]),t.push(this._outputTable[n]={}))},i.prototype._buildRowBindingContext=function(e,t){var n,o=i._disableReuseComprehensiveRowViewId.value?this._getInternalRowId(e,t):null!==(n=this._comprehensiveRowView[t])&&void 0!==n?n:this._getInternalRowId(e,t);this._blockRowChangedNotification=o;var r=this._bindingContextLookup[o]=this._manager.newBindingContext(this._parentBindingContext,e[t],o,!1,void 0,void 0,void 0,this._templateBindingContext);return this._outputTable[t]=r.outputRow,this._rowView[t]=o,this._blockRowChangedNotification=null,r},i.prototype._applyInputTableInternal=function(e,t){this.clearCache(),this._disposePreviousBindingContexts();var n=[];this.detachAuthoringAreaBindingContext();for(var o=0,r=e.length;o<r;o++){var a=this._getInternalRowId(e,o);this._comprehensiveRowView.push(a),this._primaryKeyRowView.push(this._getPrimaryKey(e,o,t)),this._outputTable.push(null),this._rowView.push(null),0===o&&n.push(this._buildRowBindingContext(e,o))}i._cancelAsyncRulesForAuthoringArea||this._manager.runBindingContextDataFlow(n),this.attachAuthoringAreaBindingContext(),i._cancelAsyncRulesForAuthoringArea&&this._manager.runBindingContextDataFlow(n)},i.prototype._applyInputTableWithDeltaInternal=function(e,t){var n=[],o=this._rowView[0];this._applyDelta(e),this._rowView=[],this._comprehensiveRowView=[],this._primaryKeyRowView=[],this._outputTable=[];for(var r=!1,a=0,s=e.length;a<s;a++){this._rowView.push(null),this._outputTable.push(null);var l=this._getInternalRowId(e,a);this._comprehensiveRowView.push(l),this._primaryKeyRowView.push(this._getPrimaryKey(e,a,t));var c=this._bindingContextLookup[l];(0===a||c)&&((r=0===a&&(!c||l!==o))&&i._cancelAsyncRulesForAuthoringArea&&this.detachAuthoringAreaBindingContext(),c?this._rowView[a]=l:(c=this._buildRowBindingContext(e,a),n.push(c)),this._outputTable[a]=c.outputRow)}i._cancelAsyncRulesForAuthoringArea?(r&&this.attachAuthoringAreaBindingContext(),this._manager.runBindingContextDataFlow(n)):(this.detachAuthoringAreaBindingContext(),this._manager.runBindingContextDataFlow(n),this.attachAuthoringAreaBindingContext())},i.prototype.attachAuthoringAreaBindingContext=function(){this._manager.authoringAreaBindingContext&&this._manager.authoringAreaBindingContext.parent===this._parentBindingContext&&this._manager.attachAuthoringAreaContext(this._rowView.length?this._bindingContextLookup[this._rowView[0]]:null)},i.prototype.detachAuthoringAreaBindingContext=function(){this._manager.authoringAreaBindingContext&&this._manager.authoringAreaBindingContext.parent===this._parentBindingContext&&this._manager.detachAuthoringAreaContext()},i.prototype._applyDelta=function(e){r.Runtime.idProperty;var t,n,o,i={};for(t=0,n=e.length;t<n;t++)i[this._getInternalRowId(e,t)]=e[t];var a=[];for(o in this._bindingContextLookup)i[o]?delete i[o]:a.push(o);for(t=0,n=a.length;t<n;t++)this._removeRow(a[t]);for(o in i)this._addRow(o)},i.prototype._refreshAsync=function(e){HashTableUtility.forEach(e.controlContexts,(function(e){for(var t in e._asyncRules){(0,e._asyncRules[t])()}}))},i.prototype._addRow=function(e){if(this._bindingContextCache[e]){var t=this._bindingContextCache[e];delete this._bindingContextCache[e],this._bindingContextLookup[e]=t,t.isCached=!1,this._refreshAsync(t)}},i.prototype._removeRow=function(e){var t=this._bindingContextLookup[e];delete this._bindingContextLookup[e],this._disposeBindingContext(t)},i.prototype._disposePreviousBindingContexts=function(){for(var e in this._bindingContextLookup){var t=this._bindingContextLookup[e];this._disposeBindingContext(t)}this._bindingContextLookup={},this._rowView=[],this._comprehensiveRowView=[],this._primaryKeyRowView=[],this._outputTable=[]},i.prototype._disposeBindingContext=function(e,t){var n;this._manager.disposeBindingContext(e,t),(null===(n=this._selectedBindingContexts)||void 0===n?void 0:n.contains(e))&&this._selectedBindingContexts.remove(e)},i.prototype._setOrCreateTemplateBindingContext=function(){this._parentBindingContext.isTemplate?this._templateBindingContext=this._manager.authoringAreaBindingContext:this._templateBindingContext=this._manager.newBindingContext(this._parentBindingContext,null,e.Constants.replicatedTemplateContextId,!1,void 0,void 0,!1)},i.prototype._disposeTemplateBindingContext=function(){this._templateBindingContext.id===e.Constants.replicatedTemplateContextId&&this._disposeBindingContext(this._templateBindingContext,!1)},i.prototype._getInternalRowId=function(t,n){var o=t[n];return e.Data.ErrorValue.isErrorValue(o)?this._parentBindingContext.id+"-"+this._manager.managerId+"._error."+o._errorValue_id_F84D7143755C4438:Core.Utility.isNullOrUndefined(o)?this._parentBindingContext.id+"-"+this._manager.managerId+"._null"+Core.Utility.generate128BitUUID():this._parentBindingContext.id+"-"+this._manager.managerId+"._"+o[r.Runtime.idProperty]},i.prototype._getPrimaryKey=function(t,n,o){if(!o)return null;var r=t[n];return!r||e.Data.ErrorValue.isErrorValue(r)?null:o(r)},i.prototype._suppressNotify=function(){return!t.ContextManager.shouldHaveControlContext(this._parentBindingContext,this._manager.controlWidget)},i._cancelAsyncRulesForAuthoringArea=!Core.FallbackSwitch.isActivated("AppRuntime.CancelAsyncRulesForAuthoringArea"),i._disableReuseComprehensiveRowViewId=new Core.Lazy((function(){return Core.FallbackSwitch.isActivated("AppRuntime.DisableReuseComprehensiveRowViewId")})),i}();t.ReplicatedContext=i}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=1,o=function(o){function r(r,i,a,s,l,c,p){var u=this;return(u=o.call(this)||this)._parentBindingContext=t.GlobalContextManager.bindingContext,u._parentManager=r,u._controlWidget=i,u._notifyOutputTableChangedFn=a,u._notifySelectedItemsChangedFn=s,u._notifyOutputRowChangedFn=l,u._runBindingContextDataFlowFn=c,u._runOptimizedReplicatedDataFlowFn=p,u.managerId="rcManager"+n++,u._parentManager.addNestedManager(u),u.authoringAreaBindingContext=u.newBindingContext(r.authoringAreaBindingContext,null,e.Constants.authoringAreaContextId,!0),u._initializeReplicatedContexts(),u}return __extends(r,o),Object.defineProperty(r.prototype,"controlWidget",{get:function(){return this._controlWidget},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"parentManager",{get:function(){return this._parentManager},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"notifyOutputTableChangedFn",{get:function(){return this._notifyOutputTableChangedFn},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"notifySelectedItemsChangedFn",{get:function(){return this._notifySelectedItemsChangedFn},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"notifyOutputRowChangedFn",{get:function(){return this._notifyOutputRowChangedFn},enumerable:!1,configurable:!0}),r.prototype.setNestedReachabilityChanged=function(){var e=this;this._parentManager.forEachManagedDescendingBindingContext(this._parentBindingContext,(function(t){return e._getReplicatedContext(t).setNestedReachabilityChanged()}))},r.prototype.runOptimizedReplicatedDataFlow=function(e,t,n){return!!this._runOptimizedReplicatedDataFlowFn&&this._runOptimizedReplicatedDataFlowFn(this._controlWidget.uniqueId,e,t,n)},r.prototype.replicatedContextFor=function(e){return this._getReplicatedContext(e)},r.prototype.getControlWidget=function(){return this._controlWidget},r.prototype.applyInputTable=function(e,t,n){this._getReplicatedContext(e).applyInputTable(t,n)},r.prototype.notifyOutputRowChanged=function(e,t){this._getReplicatedContext(e).notifyOutputRowChanged(t)},r.prototype.notifyOutputTableChanged=function(e){this._getReplicatedContext(e).notifyOutputTableChanged()},r.prototype.notifyBindingContextSelectionInteraction=function(e,t){this._getReplicatedContext(e.parent).notifyBindingContextSelectionInteraction(e,t)},r.prototype.addSelectionChangedListener=function(e,t){this._getReplicatedContext(e.parent).addSelectionChangedListener(e,t)},r.prototype.runBindingContextDataFlow=function(e){!this._runBindingContextDataFlowFn||e instanceof Array&&0===e.length||this._runBindingContextDataFlowFn(e instanceof Array?e:[e])},r.prototype.forEachManagedDescendingBindingContext=function(e,n){var o=this;function r(e){n(e),e.componentBindingContexts.forEach((function(e){return e.rcManager.forEachManagedDescendingBindingContext(e,r)}))}e.rcManager===this?r(e):e.rcManager===this._parentManager?(this.forEachChildBindingContext(e,r),e.componentBindingContexts.forEach((function(e){return o.forEachChildBindingContext(e,r)}))):this._parentManager!==t.GlobalContextManager.instance&&this._parentManager.forEachManagedDescendingBindingContext(e,(function(e){return o.forEachManagedDescendingBindingContext(e,r)}))},r.prototype.forEachChildBindingContext=function(e,n){t.ContextManager.isControlWidgetInBindingContextTree(this.controlWidget,e)&&null!==this.authoringAreaBindingContext&&(this.authoringAreaBindingContext.parent===e&&n(this.authoringAreaBindingContext),this._getReplicatedContext(e).forEachBindingContext(n))},r.prototype.forEachParentBindingContext=function(e){this._parentManager.forEachManagedDescendingBindingContext(this._parentBindingContext,e)},r.prototype.forEachManagedBindingContext=function(e){this.forEachManagedDescendingBindingContext(this._parentBindingContext,e)},r.prototype.dispose=function(){var e=this;if(this._parentManager.isLoaded&&this.forEachParentBindingContext((function(t){t.replicatedContexts[e.managerId]&&(e._getReplicatedContext(t).dispose(),delete t.replicatedContexts[e.managerId])})),o.prototype.dispose.call(this),this._controlWidget=null,this._notifyOutputTableChangedFn=null,this._parentManager){var t=this._parentManager.nestedManagers,n=t.indexOf(this);t.splice(n,1)}},r.prototype._addControlWidgetClassSpecific=function(e){var t=this;this.forEachParentBindingContext((function(n){if(t._addControlToParentBindingContext(n,e)&&(null!==t.authoringAreaBindingContext.observedBindingContext&&e.attachToObservedContext(t.authoringAreaBindingContext),e.parentControlName)){var o=OpenAjax.widget.byId(e.parentControlName),r=e.getControlContext(n);r&&o&&o.onChildContextAdded instanceof Function&&o.onChildContextAdded(o.OpenAjax.getAuthoringControlContext(),r)}}))},r.prototype._updateControlIdClassSpecific=function(e,t){var n=this;this.forEachParentBindingContext((function(o){n._renameControlInParentBindingContext(o,e,t)}))},r.prototype._removeControlWidgetClassSpecific=function(e){var t=this;this.forEachParentBindingContext((function(n){if(t._removeControlFromParentBindingContext(n,e),e.parentControlName){var o=OpenAjax.widget.byId(e.parentControlName),r=e.getControlContext(n);r&&o&&o.onChildContextRemoved instanceof Function&&o.onChildContextRemoved(o.OpenAjax.getAuthoringControlContext(),r)}}))},r.prototype.detachAuthoringAreaContext=function(){if(null!==this.authoringAreaBindingContext.observedBindingContext){for(var e=0,t=this._controlWidgets.length;e<t;e++){this._controlWidgets[e].detachFromObservedContext()}this.authoringAreaBindingContext.observedBindingContext=null}},r.prototype.attachAuthoringAreaContext=function(e){if(this.authoringAreaBindingContext.observedBindingContext=e,null!==e)for(var t=0,n=this._controlWidgets.length;t<n;t++){this._controlWidgets[t].attachToObservedContext(this.authoringAreaBindingContext)}else this.runBindingContextDataFlow(this.authoringAreaBindingContext)},r.prototype._addControlToParentBindingContext=function(e,n){return!!t.ContextManager.shouldHaveControlContext(e,n)&&(this.forEachChildBindingContext(e,(function(e){return t.ContextManager.allocateControlContext(e,n)})),this.forEachChildBindingContext(e,(function(e){return t.ContextManager.initializeControlContext(e,n)})),this.forEachChildBindingContext(e,(function(e){return e.componentBindingContexts.addControlWidget(n)})),e.isTemplate||this._notifyOutputTableChanged(e),!0)},r.prototype._renameControlInParentBindingContext=function(e,t,n){var o=this;this.forEachChildBindingContext(e,(function(e){o.renameControlInBindingContext(e,t,n),e.componentBindingContexts.updateControlId(t,n),e.componentBindingContexts.renameComponentBindingContext(t,n)})),e.isTemplate||this._notifyOutputTableChanged(e)},r.prototype._removeControlFromParentBindingContext=function(e,t){var n=this;this.forEachChildBindingContext(e,(function(e){n.removeControlFromBindingContext(e,t),e.componentBindingContexts.removeControlWidget(t),e.componentBindingContexts.disposeComponentBindingContext(t)})),e.isTemplate||this._notifyOutputTableChanged(e)},r.prototype._notifyOutputTableChanged=function(e){this._getReplicatedContext(e).notifyOutputTableChanged()},r.prototype._getReplicatedContext=function(e){return this._findParentBindingContextForReplicatedContextManager(e,this.managerId).replicatedContexts[this.managerId]},r.prototype._initializeReplicatedContexts=function(){var e=this;this.forEachParentBindingContext((function(n){t.ContextManager.isControlWidgetInBindingContextTree(e.controlWidget,n)&&t.ReplicatedContext.create(e,n)}))},r.prototype._findParentBindingContextForReplicatedContextManager=function(e,t,n){var o=this;void 0===n&&(n=[]);for(var r=null;e&&!r;){if(e.replicatedContexts[t])return e;HashTableUtility.forEach(e.replicatedContexts,(function(e){r||HashTableUtility.forEach(e.bindingContextLookup,(function(e){!r&&n.indexOf(e)<0&&(r=o._findParentBindingContextForReplicatedContextManager(e,t,__spreadArray(__spreadArray([],n,!0),[e],!1)))}))})),e=e.parent}return r},r.create=function(e,n,o,i,a,s){return new r(e.parentReplicatedContextManager||t.GlobalContextManager.instance,e,n,o,i,a,s)},r}(t.ContextManager);t.ReplicatedContextManager=o}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=function(e){function t(t){return e.call(this,t,"ViewCreationCanceledError")||this}return __extends(t,e),t}(Core.ErrorBase);t.ViewCreationCanceledError=n;var o=function(){function t(){this._pauseCount=0,this._screensViewPromises=new Map,this._screenViewPromisesDuringPause=[]}return Object.defineProperty(t.prototype,"isPaused",{get:function(){return this._pauseCount>0},enumerable:!1,configurable:!0}),t.prototype.getViewPromise=function(e){return this._getCompletableViewPromise(e).completablePromise.promise},t.prototype.handleScreenRemoved=function(e){if(e&&this._screensViewPromises.has(e)){var t=this._screensViewPromises.get(e);this._screensViewPromises.delete(e);var n=this._screenViewPromisesDuringPause.indexOf(t);n>-1&&this._screenViewPromisesDuringPause.splice(n,1)}},t.prototype.startRendering=function(e,t){if(void 0===t&&(t=!1),t&&(this._currentActiveScreen=e),this._pauseCount<=0){if((n=this._getCompletableViewPromise(e)).isCompleted)return;n.isCompleted=!0,n.completablePromise.complete()}else{this._screensViewPromises.has(e)&&this._screensViewPromises.get(e).isCompleted&&this._screensViewPromises.delete(e);var n=this._getCompletableViewPromise(e);this._screenViewPromisesDuringPause.push(n)}},t.prototype.pause=function(){var e=this;if(0===this._pauseCount){var t=[];this._screensViewPromises.forEach((function(e,n){e.isCompleted&&t.push(n)})),t.forEach((function(t){return e._screensViewPromises.delete(t)}))}this._pauseCount++},t.prototype.continue=function(){if(this._pauseCount--,this._pauseCount<=0&&this._screenViewPromisesDuringPause&&(this._screenViewPromisesDuringPause.forEach((function(e){e.isCompleted=!0,e.completablePromise.complete()})),this._screenViewPromisesDuringPause=[],Core.Utility.isNonEmptyString(this._currentActiveScreen))){var e=this._getCompletableViewPromise(this._currentActiveScreen);e.isCompleted||(e.isCompleted=!0,e.completablePromise.complete())}},t.prototype.reset=function(){this._pauseCount>0&&(this._pauseCount=1,this.continue())},t.prototype.cancelAll=function(e){void 0===e&&(e=""),this._screensViewPromises&&this._screensViewPromises.forEach((function(e){e.isCompleted=!0,e.completablePromise.cancel()})),this._screensViewPromises=new Map,this._screenViewPromisesDuringPause=[],this._pauseCount=0},t.prototype._getCompletableViewPromise=function(t){if(!this._screensViewPromises.has(t)){var n=Core.PromiseUtils.createCancellablePromise();n.promise.catch((function(t){if(!(t instanceof e.Controls.ViewCreationCanceledError||Core.Utility.isCanceledError(t)))throw t;Core.Log.verbose("View creation promise canceled: ".concat(t.message))})),this._screensViewPromises.set(t,{completablePromise:n,isCompleted:!1}),Core.Environment.isAuthoringTool()||n.complete()}return this._screensViewPromises.get(t)},__decorate([initializeOnLoad((function(){return Core.Loader.TypeKey.createFromClass(t)}))],t,"singletonKey",void 0),t}();t.ViewCreationPromiseFactory=o}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=function(){function n(e,t){this._contextManager=e,this._parentBindingContext=t,this._componentContexts=new Map}return Object.defineProperty(n.prototype,"componentBindingContexts",{get:function(){return this._componentContexts},enumerable:!1,configurable:!0}),n.prototype.lookup=function(e){return this._componentContexts.get(e)},Object.defineProperty(n.prototype,"size",{get:function(){return this._componentContexts.size},enumerable:!1,configurable:!0}),n.prototype.forEach=function(e){this._componentContexts.forEach((function(t,n){e(t,n)}))},n.prototype.addControlWidget=function(e){this._componentContexts.forEach((function(n,o){t.ContextManager.allocateControlContext(n,e),e.isChildOfComponentOrSelf(o)&&t.ContextManager.initializeControlContext(n,e)}))},n.prototype.createComponentBindingContext=function(t){if(e.Utility.isComponent(t.template.className)){var n=OpenAjax.widget.byId(t.topParentOrSelfName);n&&!e.Utility.isComponent(n.OpenAjax.template.className)&&this.getOrCreateComponentContext(t.controlName,t.componentDefinitionName,t.uniqueId)}},n.prototype.removeControlWidget=function(e){var t=this;this._componentContexts.forEach((function(n,o){t._contextManager.removeControlFromBindingContext(n,e)}))},n.prototype.disposeComponentBindingContext=function(e){var t=e.controlName,n=this._componentContexts.get(t);n&&(this._contextManager.disposeBindingContext(n,!1),this._componentContexts.delete(t))},n.prototype.updateControlId=function(e,t){var n=this,o=this._componentContexts.get(e);this.forEach((function(r){n._contextManager.renameControlInBindingContext(r,e,t),(null==o?void 0:o.id)===r.id&&(r.id=t,r.componentInstance=t)}))},n.prototype.renameComponentBindingContext=function(e,t){var n=this._componentContexts.get(e);n&&(n.id=t,n.componentInstance=t,this._componentContexts.set(t,n),this._componentContexts.delete(e))},n.prototype.getComponentContext=function(e){return this._componentContexts.get(e)},n.prototype.getOrCreateComponentContext=function(e,t,n){var o=this._componentContexts.get(e);return o||(o=this._createComponentContext(e,t,n),this._componentContexts.set(e,o)),o},n.prototype._createComponentContext=function(e,t,n){var o=[e,t],r=this._parentBindingContext.thisItem||{};return this._contextManager.newBindingContext(this._parentBindingContext,r,e,void 0,o,n,!1)},n.prototype.tryRunRuleOnInstance=function(e,t,n){var o=e.lastIndexOf(".");if(-1===o)return!1;var r=this._contextManager.getControlNameById(e.substring(0,o));if(!r)return!1;var i=OpenAjax.widget.byId(r);if(!i)return!1;var a=this.lookup(r);return!!(n=(null==a?void 0:a.componentInstance)?a:n)&&(t(i.OpenAjax.componentDefinitionUniqueId+e.substring(o),n),!0)},n.prototype.runRuleFn=function(e,t){if(!this.tryRunRuleOnInstance(e,t)){var n=this._contextManager.getComponentTemplateInfoFromRule(e,!1).templateName;n&&this.forEach((function(o,r){OpenAjax.widget.byId(r).OpenAjax.template.name===n&&t(e,o)}))}},n}();t.ComponentBindingContexts=n}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(AppMagic){var Controls;!function(Controls){var _a,_b,util=AppMagic.Utility,GlobalEventBroker=AppMagic.AuthoringTool.GlobalEventBroker,PropertyNames=AppMagic.AuthoringTool.OpenAjaxPropertyNames,ErrorLocation;!function(e){e[e.Root=0]="Root",e[e.Record=1]="Record",e[e.Property=2]="Property"}(ErrorLocation||(ErrorLocation={}));var LayoutProperties=[PropertyNames.LayoutX,PropertyNames.LayoutY,PropertyNames.LayoutWidth,PropertyNames.LayoutHeight],AutoLayoutPropertyNameMap=(_a={},_a[PropertyNames.AutoLayoutWidth]=PropertyNames.Width,_a[PropertyNames.AutoLayoutHeight]=PropertyNames.Height,_a[PropertyNames.AutoLayoutX]=PropertyNames.X,_a[PropertyNames.AutoLayoutY]=PropertyNames.Y,_a),DataflowBoundsMap=(_b={},_b[PropertyNames.X]={dataflowBoundsPropName:"userXValue",autolayoutPropName:PropertyNames.AutoLayoutX},_b[PropertyNames.Y]={dataflowBoundsPropName:"userYValue",autolayoutPropName:PropertyNames.AutoLayoutY},_b[PropertyNames.Width]={dataflowBoundsPropName:"userWidthValue",autolayoutPropName:PropertyNames.AutoLayoutWidth},_b[PropertyNames.Height]={dataflowBoundsPropName:"userHeightValue",autolayoutPropName:PropertyNames.AutoLayoutHeight},_b[PropertyNames.Order]={dataflowBoundsPropName:"userOrderValue",autolayoutPropName:PropertyNames.Order},_b),ControlMethodType;!function(e){e[e.Suspend=0]="Suspend",e[e.Resume=1]="Resume",e[e.ModeChange=2]="ModeChange",e[e.Load=3]="Load",e[e.Init=4]="Init",e[e.Dispose=5]="Dispose",e[e.PropertyChanged=6]="PropertyChanged"}(ControlMethodType||(ControlMethodType={}));var ControlWidget=function(){function ControlWidget(e,t,n,o,r,i,a,s,l,c,p,u){void 0===p&&(p=null),void 0===u&&(u=null);var d=this;this._tagsManager=null,this.sv=this.setPropertyValueInternal,this.scopl=this.setCustomOutputPropertyLambdaInternal,this.sl=this.setPropertyLambdaInternal,this.slnr=this.setPropertyLambdaNonReplicatedInternal,this.al=this.applyLambdaInternal,this.stv=this.setTaggedPropertyValueInternal,this.stl=this.setTaggedPropertyLambdaInternal,this.isAncestorDisabled=function(e){return d._doesAncestorSatisfyPredicate(e,(function(e){return Core.Utility.isFunction(e.properties.DisplayMode)&&e.properties.DisplayMode()===AppMagic.Constants.DisplayMode.Disabled}))},this.isAncestorReadonly=function(e){return d._doesAncestorSatisfyPredicate(e,(function(e){return Core.Utility.isFunction(e.properties.DisplayMode)&&e.properties.DisplayMode()===AppMagic.Constants.DisplayMode.View}))},this.isAncestorHidden=function(e){return d._doesAncestorSatisfyPredicate(e,(function(e){return e.modelProperties.Visible&&!e.modelProperties.Visible.getValue()}))},Contracts.checkNonEmpty(e),Contracts.checkValue(t),Contracts.checkValue(n),Contracts.checkValue(n.template),Contracts.checkNonEmpty(n.uniqueId),Contracts.checkStringOrUndefined(n.variantName),Contracts.checkValue(o),Contracts.checkFunction(r),Contracts.checkFunction(i),Contracts.checkFunction(a),Contracts.checkFunctionOrNull(s),Contracts.checkFunctionOrNull(l),Contracts.checkObservable(c),Core.PerformanceRecorder.instance.trackObject(this,"ControlWidget"),this._control=t,this._icontrol=n,this._icontrolParent=n?n.parent:null,this._template=n.template,this._isPcfControl="appmagic.controls.pcfcontrolproxy"===this._template.className.toLowerCase(),this._isComponent=AppMagic.Utility.isComponent(this._template.className),this._globals=n.globals,this._nestingLevel=-1,this._variantName=n.variantName||"",this._id=e,this._uniqueId=n.uniqueId,this._mode=ko.observable("view"),this._ctrlMgr=o,this._thisItemInputInvariantName=this._template.thisItemInputInvariantName,this._allowsPerCharacterFormatting=n.template.allowsPerCharacterFormatting,this._customChildrenMap=Object.create(null),this._metadataId=p,this._isCustomControl=!!p,this._allowsPerCharacterFormatting&&(this._tagsManager=t.getTagsManager),this._aggregatesChildUpdates=n.template.aggregatesChildUpdates,this._aggregatesChildUpdates&&(this._onBeforeGetUpdates=this._aggregateUpdates),this._submitsData=n.template.submitsData,this._screenActiveAware=n.template.screenActiveAware,Contracts.checkBoolean(this._screenActiveAware),this._onValueChangedFn=r,this._runOptimizedReplicatedDataFlowFn=i,this._onEventFn=a,this._entityPropertyChangedFn=s,this._updatePropertyRuleFn=l,this._activeScreenIndex=c,this._nestedViewContainerWidget=null,this._isLoaded=!0,this._isReplicable=n.isReplicable,Contracts.checkBoolean(this._isReplicable),this._isAuthorable=ControlWidget.isAuthoring&&n.template.authorableVisual,Contracts.checkBoolean(this._isAuthorable),this._initContextManagerInterface(),this._initControlProperties(),this._canLayoutControl=LayoutProperties.every((function(e){return d.hasProperty(e)}))||Object.keys(AutoLayoutPropertyNameMap).every((function(e){return d.hasProperty(e)})),this._createRenderManager(),this._propertyChangeNotifications=HashTableUtility.create(),this._viewCreationPromiseFactory=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Controls.ViewCreationPromiseFactory.singletonKey),Contracts.checkValue(this.viewCreationPromise),Core.Utility.isNullOrUndefined(ControlWidget._scheduleFireEvent)&&(ControlWidget._scheduleFireEvent=Core.Environment.getDeviceId()===Core.Environment.DeviceId.iOSDevice),this._isGalleryControl="galleryTemplate"===this._template.name,this._appModeSubscription=this._ctrlMgr.appModeObservable.subscribe((function(e){d._handleAppModeChanged(e)})),this._shellEventBroker=Core.Loader.ObjectFactory.instance.getSingleton(GlobalEventBroker.ShellEventBroker.singletonKey),this.runtimeCapabilityNotifyPropertyChanged=Core.Environment.getRuntimeCapabilityCallback("PushDataFlowEvents"),this._runtimeCapabilityNotifyInitialPropertyValues=Core.Environment.isRuntimeCapabilityEnabled("PushInitialPropertyValues"),this._runtimeCapabilityNotifyExecutionEvents=Core.Environment.getRuntimeCapabilityCallback("PushExecutionEvents"),this._runtimeCapabilityNotifySetFocusEvent=Core.Environment.getRuntimeCapabilityCallback("PushSetFocusEvent"),this._runtimeCapabilityNotifyControlInstanceCreated=Core.Environment.getRuntimeCapabilityCallback("PushControlInstanceCreatedEvents"),this._runtimeCapabilityNotifySelectControlEvent=Core.Environment.getRuntimeCapabilityCallback("SelectControl")}return Object.defineProperty(ControlWidget.prototype,"controlProperties",{get:function(){return this._controlPropertyMap},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"control",{get:function(){return this._control},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"controlManager",{get:function(){return this._ctrlMgr},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"controlName",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"parentControlName",{get:function(){var e=this._icontrolParent;return e?e.displayName:""},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"componentDefinitionName",{get:function(){return this._icontrol.componentDefinition?this._icontrol.componentDefinition.displayName:null},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"componentDefinitionUniqueId",{get:function(){return this._icontrol.componentDefinition?this._icontrol.componentDefinition.uniqueId:null},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"topParentOrSelfName",{get:function(){if(!this._icontrolParent)return this._icontrol.displayName;for(var e=null,t=this;t._icontrolParent;)e=t._icontrolParent,t=OpenAjax.widget.byId(e.displayName).OpenAjax;return e.displayName},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"topParentOrSelfUniqueId",{get:function(){for(var e=this._icontrol;e.parent;){var t=OpenAjax.widget.byId(e.parent.displayName);e=t?t.OpenAjax._icontrol:e.parent}return e.uniqueId},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"isLoaded",{get:function(){return this._isLoaded},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"contextManager",{get:function(){return this._contextManager},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"replicatedContextManager",{get:function(){return this._contextManager},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"parentReplicatedContextManager",{get:function(){return this._parentContextManager},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"isReplicable",{get:function(){return this._isReplicable},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"allowsPerCharacterFormatting",{get:function(){return this._allowsPerCharacterFormatting},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"aggregatesChildUpdates",{get:function(){return this._aggregatesChildUpdates},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"submitsData",{get:function(){return this._submitsData},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"tagsManager",{get:function(){return this._tagsManager},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"contextManagerInterface",{get:function(){return this._contextManagerInterface},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"globalControlContext",{get:function(){return Contracts.check(!this._isReplicable),this.getControlContext(Controls.GlobalContextManager.bindingContext)},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"index",{get:function(){return this._icontrol.index},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"topParentOrSelfIndex",{get:function(){return this._icontrol.topParentOrSelf.index},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"optimizeForDevices",{get:function(){return this._icontrol.optimizeForDevices},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"isCustomControl",{get:function(){return this._isCustomControl},enumerable:!1,configurable:!0}),ControlWidget.prototype.isEditable=function(e){return!this._isReplicable||this._authoringAreaControlContext===e},Object.defineProperty(ControlWidget.prototype,"template",{get:function(){return this._template},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"variantName",{get:function(){return this._variantName},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"uniqueId",{get:function(){return this._uniqueId},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"isPcfControl",{get:function(){return this._isPcfControl},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"isComponent",{get:function(){return this._isComponent},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"isComponentInstance",{get:function(){return this.isComponent&&!this.isComponentDefinition},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"isComponentDefinition",{get:function(){return Core.Utility.isUndefined(this._isComponentDefinition)&&(this._isComponentDefinition=this.isComponent&&null===this.componentDefinitionUniqueId),this._isComponentDefinition},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"controlHandlesRealized",{get:function(){if(Controls.ResolveControlComponent(this.template.className)===Controls.KnockoutControl)return!0;var e=this.control;return!!e&&Core.Utility.isFunction(e.handlesRealized)&&e.handlesRealized()},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"parentUniqueId",{get:function(){var e,t;return null!==(t=null===(e=this.parentControlWidget)||void 0===e?void 0:e.uniqueId)&&void 0!==t?t:"".concat(this.uniqueId,"_parent")},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"nestingLevel",{get:function(){if(-1!==this._nestingLevel)return this._nestingLevel;var e=this.parentControlWidget,t=0;return e&&(t=1+e.nestingLevel,this._nestingLevel=t),t},enumerable:!1,configurable:!0}),ControlWidget.prototype.getId=function(){return Contracts.checkValue(this._id),this._id},Object.defineProperty(ControlWidget.prototype,"reactRenderDataStore",{get:function(){return this._reactRenderDataStore},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"parentControlWidget",{get:function(){var e;return null===(e=OpenAjax.widget.byId(this.parentControlName))||void 0===e?void 0:e.OpenAjax},enumerable:!1,configurable:!0}),Object.defineProperty(ControlWidget.prototype,"metadataId",{get:function(){return this._metadataId},set:function(e){this._metadataId=e},enumerable:!1,configurable:!0}),ControlWidget.prototype.isInAutoLayoutContainer=function(e){return this._getParentPropertyValue(PropertyNames.LayoutMode,e)===AppMagic.Constants.LayoutMode.Auto},ControlWidget.prototype.parentLayoutDirection=function(e){return this._getParentPropertyValue(PropertyNames.LayoutDirection,e)},ControlWidget.prototype.isCrossAxisStretch=function(e){var t=this.getPropertyValue(PropertyNames.AlignInContainer,e);return t===AppMagic.Constants.AlignInContainer.Stretch||t===AppMagic.Constants.AlignInContainer.SetByContainer&&this._parentLayoutAlignItemsValue(e)===AppMagic.Constants.LayoutAlignItems.Stretch},ControlWidget.prototype._parentLayoutAlignItemsValue=function(e){return this._getParentPropertyValue(PropertyNames.LayoutAlignItems,e)},ControlWidget.prototype.isPrimaryAxisGrow=function(e){return this.getPropertyValue(PropertyNames.FillPortions,e)>0},ControlWidget.prototype._getParentPropertyValue=function(e,t){var n,o,r=this.getControlContext(t);return r&&(null===(o=null===(n=Controls.ContextManager.getParentControlContext(r))||void 0===n?void 0:n.modelProperties[e])||void 0===o?void 0:o.getValue())},ControlWidget.prototype.getAvailableSize=function(){},ControlWidget.prototype.getSize=function(){},ControlWidget.prototype.requestSizeChange=function(e){},Object.defineProperty(ControlWidget.prototype,"viewCreationPromise",{get:function(){var e=this;if(!this._icontrolParent)return this._viewCreationPromiseFactory.getViewPromise(this.uniqueId);if(!this._viewCreationPromise){var t=Core.PromiseUtils.createCompletablePromise();this._viewCreationPromise=t.promise,Core.PromiseUtils.preventCancel(this.parentControlWidget.viewCreationPromise).then((function(){t.complete(),Core.Tasks.schedule((function(){e._viewCreationPromise=null}),"ControlWidget.viewCreationPromise")})).catch(Core.Utility.noOpFn)}return this._viewCreationPromise},enumerable:!1,configurable:!0}),ControlWidget.prototype.getMode=function(){var e=this._mode();return Contracts.checkNonEmpty(e),Contracts.check("help"===e||"edit"===e||"view"===e),e},Object.defineProperty(ControlWidget.prototype,"mode",{get:function(){return this._mode},enumerable:!1,configurable:!0}),ControlWidget.prototype.suspendControlContext=function(e,t){this._callControlMethod(ControlMethodType.Suspend,e,t)},ControlWidget.prototype.resumeControlContext=function(e,t){this._callControlMethod(ControlMethodType.Resume,e,t)},ControlWidget.prototype.updateId=function(e){if(Contracts.checkNonEmpty(e),this._isLoaded){this._forEachProperty((function(t){return t.updateControlId(e)}));var t=this._id;this._id=e,this._parentContextManager.updateControlId(t,e)}else this._logUseAfterRemoveControl("updateId")},ControlWidget.prototype.setSelected=function(){var e=this._authoringVisual;e&&(e.selected=!0)},ControlWidget.prototype.beginUndoGroup=function(e,t){if(void 0===t&&(t=!1),ControlWidget.isAuthoring){var n=AppMagic.context.documentViewModel.undoManager;if(n){var o=Microsoft.AppMagic.Authoring.UndoGroupCategory.acceptsAttachments;n.hasOpenGroup&&(o=Microsoft.AppMagic.Authoring.UndoGroupCategory.attachable),n.createGroup(e,t?o:Microsoft.AppMagic.Authoring.UndoGroupCategory.normal),this._undoGroupCount=(this._undoGroupCount||0)+1,this._openUndoGroupName="".concat(this._undoGroupCount,"_").concat(e)}}},ControlWidget.prototype.endUndoGroup=function(e){if(ControlWidget.isAuthoring){var t=AppMagic.context.documentViewModel.undoManager;t&&(t.closeGroup(),this._openUndoGroupName="")}},ControlWidget.prototype.requestModeChange=function(e){if(Contracts.checkNonEmpty(e),Contracts.check("help"===e||"edit"===e||"view"===e),"help"!==e&&"edit"!==e&&"view"!==e)throw OpenAjax.widget.Error.BadParameters;var t={oldMode:this._mode(),newMode:e,renderedBy:"host"};this._mode(e);var n=this._authoringAreaControlContext;this._callControlMethod(ControlMethodType.ModeChange,t,n)},ControlWidget.prototype._doesAncestorSatisfyPredicate=function(e,t){Contracts.checkObject(e.bindingContext.rcManager);var n=Controls.ContextManager.getParentControlContext(e);return!!n&&(!!t(n)||n.controlWidget._doesAncestorSatisfyPredicate(n,t))},ControlWidget.prototype.addPropertyChangeCallback=function(e,t,n){void 0===n&&(n=!0);var o=this._propertyChangeNotifications[e];o||(o=[],this._propertyChangeNotifications[e]=o),o.push(t);var r=n?this.addParentPropertyChangeCallback(e,t,n):null;return{dispose:function(e,t,n,o){e&&e.dispose(),t._removePropertyChangeCallback(n,o)}.bind(null,r,this,e,t)}},ControlWidget.prototype._removePropertyChangeCallback=function(e,t){var n=this._propertyChangeNotifications[e];if(n){var o=n.indexOf(t);o>=0&&n.splice(o,1)}},ControlWidget.prototype.addParentPropertyChangeCallback=function(e,t,n){void 0===n&&(n=!0);var o=this.parentControlWidget;return o?o.addPropertyChangeCallback(e,t,n):{dispose:function(){}}},ControlWidget.prototype.addOnBeforeDisposeCallback=function(e,t){Contracts.checkArray(e._onBeforeDisposeCallbacks),-1===e._onBeforeDisposeCallbacks.indexOf(t)&&e._onBeforeDisposeCallbacks.push(t)},ControlWidget.prototype.removeOnBeforeDisposeCallback=function(e,t){Contracts.checkArray(e._onBeforeDisposeCallbacks);var n=e._onBeforeDisposeCallbacks.indexOf(t);-1!==n&&e._onBeforeDisposeCallbacks.splice(n,1)},ControlWidget.prototype.addCustomChildControlWidget=function(e,t){e&&t&&(this._customChildrenMap[e]=t)},ControlWidget.prototype.getCustomChildControlWidget=function(e){return this._customChildrenMap[e]},ControlWidget.prototype.getCustomChildControlWidgets=function(){return this._customChildrenMap},ControlWidget.prototype._removeCustomChildControlWidget=function(e){e&&delete this._customChildrenMap[e]},ControlWidget.prototype.getCustomChildOrSelfControlNameByUniqueId=function(e){if(this.uniqueId===e)return this.controlName;for(var t in this._customChildrenMap)if(Object.prototype.hasOwnProperty.call(this._customChildrenMap,t)){var n=this._customChildrenMap[t].getCustomChildOrSelfControlNameByUniqueId(e);if(n)return n}return null},ControlWidget.prototype.setCustomChildProperty=function(e,t,n,o){var r=this._customChildrenMap[e];r&&r.setPropertyValueInternal(t,n,o)},ControlWidget.prototype.notifyNestedReachabilityChangedInternal=function(){Contracts.checkObject(this.replicatedContextManager),this.replicatedContextManager.setNestedReachabilityChanged()},ControlWidget.prototype.initReplicatedContextManager=function(e,t,n){var o=this;Contracts.checkFunction(e),Contracts.checkFunction(t),Contracts.checkFunctionOrUndefined(n),Contracts.checkNullOrUndefined(this._contextManager),this._contextManager=Controls.ReplicatedContextManager.create(this,e,n,(function(e,n,r){Contracts.checkString(n),Contracts.checkObject(r),t(o.getControlContext(e),n,r)}),this._runBindingContextDataFlow.bind(this),this._runOptimizedReplicatedDataFlowFn)},ControlWidget.prototype.disposeReplicatedContextManager=function(){Contracts.checkObject(this._contextManager),this._contextManager.dispose(),this._contextManager=null},ControlWidget.prototype.initializeControl=function(e){var t=this;Core.PerformanceRecorder.instance.recordFunction("ControlWidget.initializeControl",(function(){if(t._parentContextManager=Controls.ContextManager.getParentManager(e),Contracts.checkObject(t._parentContextManager),t._template.viewContainer){var n=t._parentContextManager.getControlWidget();Contracts.checkObject(n),n._nestedViewContainerWidget=t}t._parentContextManager.authoringAreaBindingContext;t._callControlMethod(ControlMethodType.Load),t.isCustomControl?t._parentContextManager.addChildControl(t._control,t._metadataId):t._parentContextManager.addControl(t._control)}),this)},ControlWidget.prototype.removeControl=function(){var e;Contracts.checkObject(this._parentContextManager);for(var t=[],n=this.parentControlWidget;n;n=n.parentControlWidget)t.push({controlTemplateName:n.template.name,variantName:n.variantName,controlId:n.uniqueId});this._unloadedControlEventData={controlTemplateName:this.template.name,variantName:this.variantName,controlId:this.uniqueId,nestingLevel:this.nestingLevel,parentChain:t},this.isCustomControl?(Core.Utility.isFunction(this._control.onCustomChildRemoved)&&this._control.onCustomChildRemoved(this._metadataId,this.getAuthoringControlContext()),this._parentContextManager.removeChildControl(this._control,this.metadataId),null===(e=this.parentControlWidget)||void 0===e||e._removeCustomChildControlWidget(this.metadataId)):this._parentContextManager.removeControl(this._control),this._reactRenderDataStore&&(this._reactRenderDataStore.dispose(),this._reactRenderDataStore=null),this._control=null,this._icontrol=null,this._icontrolParent=null,this._isLoaded=!1,this._nestedViewContainerWidget=null,this._parentContextManager=null,this._authoringAreaControlContext=null,this._controlPropertyMap=null,this._defaultPropertyMap=null,this._customChildrenMap=null,this._appModeSubscription.dispose()},ControlWidget.prototype._logUseAfterRemoveControl=function(e){var t="ControlWidget.".concat(e," invoked after ControlWidget.removeControl");Core.Log.errorEx("ControlWidget._logUseAfterRemoveControl",{error:Core.Utility.throwInline(t),eventData:this._unloadedControlEventData})},ControlWidget.prototype.getPropertyValue=function(e,t){return void 0===t&&(t=null),this._getPropertyValueInternal(e,t).outValue},ControlWidget.prototype.tryGetPropertyValue=function(e,t){void 0===t&&(t=null);try{return this._getPropertyValueInternal(e,t)}catch(e){return{value:!1,outValue:null}}},ControlWidget.prototype._getPropertyValueInternal=function(e,t){if(Contracts.checkNonEmpty(e),!this._isLoaded)return this._logUseAfterRemoveControl("_getPropertyValueInternal"),{value:!1,outValue:null};t||(t=Controls.GlobalContextManager.bindingContext);var n=this._getPropertyValueControlContextHelper(t),o=this._controlPropertyMap[e];if(!o){if(!ControlWidget.isAuthoring||!AppMagic.Utility.isComponent(this.template.className))return{value:!1,outValue:null};for(;!n&&t.parent;)t=t.parent,n=this._getPropertyValueControlContextHelper(t);if(n){var r=this._template.tryGetProperty(e),i=r.value,a=r.property;if(!i)return this.removeCustomProperty(n,e),{value:!1,outValue:null};this.checkAndInitCustomProperty(n,a),o=this._controlPropertyMap[e],Contracts.checkValue(o,"Custom control property initialized but there's still no value in the controlPropertyMap")}}return Contracts.checkObject(o),this._getPropertyValueOnBeforeMethodCall(e,n),{value:!0,outValue:o.getValue(n,e)}},ControlWidget.prototype.getControlPropertyValues=function(){var e=Object.create(null);if(!this._isLoaded)return this._logUseAfterRemoveControl("getControlPropertyValues"),e;for(var t=Object.keys(this._controlPropertyMap),n=0,o=t.length;n<o;n++){var r=t[n];this._controlPropertyMap[r].isOutput&&(e[r]=this.getPropertyValue(r,null))}return e},ControlWidget.prototype.isChildOfComponentOrSelf=function(e){var t=OpenAjax.widget.byId(this.topParentOrSelfName),n=OpenAjax.widget.byId(e);return t&&n&&AppMagic.Utility.isComponent(t.OpenAjax.template.className)&&(t.OpenAjax.controlName===n.OpenAjax.componentDefinitionName||t.OpenAjax.controlName===e)},ControlWidget.prototype.attachToObservedContext=function(e){if(Contracts.checkObject(this._parentContextManager),this._isLoaded){var t=this.getControlContext(e);Contracts.checkObject(t),Contracts.check(t.isTemplate);var n=this.getControlContext(e.observedBindingContext);Contracts.checkObject(n),Contracts.check(!n.isTemplate);var o=null;this._forEachPropertyKVP((function(e,r){"Update"===r?o=e:e.attachTemplateControlContext(n,r,t)})),o&&o.attachTemplateControlContext(n,"Update",t)}else this._logUseAfterRemoveControl("attachToObservedContext")},ControlWidget.prototype.detachFromObservedContext=function(){Contracts.checkObject(this._parentContextManager),this._isLoaded?this._forEachProperty((function(e){return e.detachTemplateControlContext()})):this._logUseAfterRemoveControl("detachFromObservedContext")},ControlWidget.prototype.setCustomOutputPropertyLambdaInternal=function(e,t,n,o,r){if(Contracts.checkFunction(t),Contracts.checkNonEmpty(n),Contracts.checkBooleanOrUndefined(r),!(null==o?void 0:o.disposed)){var i=ControlWidget._getInstanceBindingContext(o,n);if(!i.disposed){var a=t(i);return this.setPropertyValueInternal(e,a,o,r)}}},ControlWidget._getInstanceBindingContext=function(e,t){var n,o;Contracts.checkNonEmpty(t),Core.Utility.isNullOrUndefined(e)&&(e=Controls.GlobalContextManager.bindingContext);var r=OpenAjax.widget.controlManager.getControlInstanceById(t);return null!==(o=null===(n=e.componentBindingContexts)||void 0===n?void 0:n.lookup(r.name))&&void 0!==o?o:e},ControlWidget.prototype.setPropertyLambdaInternal=function(e,t,n,o,r){var i=this;Contracts.checkNonEmpty(e),Contracts.checkFunction(n),Contracts.check(this._isReplicable),Contracts.checkObject(this._parentContextManager),this._isLoaded?this._forEachBindingContext(o,(function(t){i._canLayoutControl&&i._applyToControlContextIfApplicable(t,(function(o){i._setDataflowBoundPropertyValue(o,e,n(t))})),t.observedBindingContext||i._applyToControlContextIfApplicable(t,(function(o){delete o._asyncRules[e],r=!!r,i._notifyPropertySetWithThisItem(e,n)||i.setPropertyValueInternal(e,n(t),t,r)}))})):this._logUseAfterRemoveControl("setPropertyLambdaInternal")},ControlWidget.prototype.setPropertyLambdaNonReplicatedInternal=function(e,t,n,o,r){Contracts.checkNonEmpty(e),Contracts.checkFunction(n),Contracts.checkObject(this._parentContextManager),this._isLoaded?this._notifyPropertySetWithThisItem(e,n)||this.setPropertyValueInternal(e,n(o),o,r):this._logUseAfterRemoveControl("setPropertyLambdaNonReplicatedInternal")},ControlWidget.prototype._notifyPropertySetWithThisItem=function(e,t){if(!this._isLoaded)return this._logUseAfterRemoveControl("_notifyPropertySetWithThisItem"),!1;if(this._control.notifyPropertySetWithThisItem){var n=this._controlPropertyMap[e];if(n&&n._property&&n._property.shouldIncludeThisItemInFormula)return this._control.notifyPropertySetWithThisItem(this.uniqueId,e,t)}return!1},ControlWidget.prototype.setTaggedPropertyLambdaInternal=function(e,t,n,o,r,i){var a=this;Contracts.checkNonEmpty(e),Contracts.checkFunction(t),Contracts.checkArray(o),Contracts.checkArray(r),Contracts.check(this._isReplicable),Contracts.checkObject(this._parentContextManager),this._forEachBindingContext(n,(function(n){a._applyToControlContextIfApplicable(n,(function(i){delete i._asyncRules[e],a.setTaggedPropertyValueInternal(e,t(n),o,r,n)}))}))},ControlWidget.prototype.applyLambdaInternal=function(e,t,n){Contracts.checkFunction(e),Contracts.check(this._isReplicable),Contracts.checkObject(this._parentContextManager),this._forEachBindingContext(t,(function(t){t.observedBindingContext||e(t)}))},ControlWidget.prototype.notifyOutputPropertyValueChanged=function(e,t){Contracts.checkNonEmpty(e),Core.Utility.isNullOrUndefined(t)&&(t=Controls.GlobalContextManager.bindingContext),Contracts.check(t!==Controls.GlobalContextManager.bindingContext||!this._isReplicable),this._notifyOutputPropertyValueChangedInternal(e,t)},ControlWidget.prototype.setPropertyValue=function(e,t,n,o){if(Contracts.checkNonEmpty(e),Contracts.checkDefined(t),this._isLoaded){var r=this._controlPropertyMap[e];if(Contracts.checkObject(r),ControlWidget._isSetValueTelemetryEnabled&&!ControlWidget.isAuthoring&&r.canBeCompressed&&ControlWidget._mutablePropertyErrorCounter<ControlWidget._maxMutablePropertyErrorsToReport){ControlWidget._mutablePropertyErrorCounter++;Core.Telemetry.Log.trackActivityEvent("ControlWidget.setPropertyValue",{message:"It is expected that ControlWidget.setPropertyValue will not be called in the published app except for properties marked canBeCompressed=false in the OAM. Consider updating the OAM.",controlTemplateName:this.template.name,controlId:this.uniqueId,propertyInvariantName:e})}if(this._template.inputProperties.some((function(t){return t.propertyInvariantName===e})))throw new Error("Controls cannot set their own input properties.");return this.setPropertyValueInternal(e,t,n,o)}this._logUseAfterRemoveControl("setPropertyValue")},ControlWidget.prototype.setPropertyValueInternal=function(e,t,n,o,r){var i=this,a=!1;if(Contracts.checkNonEmpty(e),Contracts.checkBooleanOrUndefined(o),Contracts.checkBooleanOrUndefined(r),(!n||!n.disposed)&&this._isLoaded){Core.Utility.isUndefined(t)&&(t=null),Core.Utility.isNullOrUndefined(n)&&(n=Controls.GlobalContextManager.bindingContext),Contracts.check(n!==Controls.GlobalContextManager.bindingContext||!this._isReplicable);var s=this.getOrCreateControlContext(n);if(s){if(ControlWidget.isAuthoring&&AppMagic.Utility.isComponent(this.template.className)){var l=this._template.tryGetProperty(e),c=l.value,p=l.property;if(!c)return void this.removeCustomProperty(s,e);this.checkAndInitCustomProperty(s,p)}var u=this._controlPropertyMap[e];if(Contracts.checkObject(u),!(this._ctrlMgr.appModeObservable()===Controls.AppMode.Recording)||!u.isRecordingReadOnly){var d=!1;if(!u.allowsPerCharacterFormatting||Core.Utility.isBoolean(r)&&!r||(Contracts.checkValue(this._tagsManager),d=this.tagsManager.clearTagsForProperty(e)),AppMagic.Data.ErrorValue.isErrorHandlingFeatureEnabled()){var h=!0;if(AppMagic.Data.ErrorValue.isErrorValue(t))u.errorCapability===Controls.ErrorCapability.allErrors||(h=!1,AppMagic.AuthoringTool.Runtime.handlePotentialRuleError(t,this._icontrol.displayName,e),t=null);else if(Core.Utility.isArray(t)&&t.length>0){var C=this._validateErrorCapability(t,u.errorCapability);C&&(h=!1,t=null,this._raiseErrorFromFailedValidation(e,C.error))}h&&this._resetErrorsAfterSuccessfulValidation(e)}var g=u.tryGetValue(s,e),m=g&&Core.Utility.isFunction(g.getNextResultsAsync);if(o=m||o||d||u.isSkipCompare||ControlWidget.shouldSkipCompare(s,e),Contracts.checkBooleanOrUndefined(o),(o=!!o)&&ControlWidget.registerSkippedCompare(s,e),o||!AppMagic.Utility.deepCompare(g,t)?(a=!0,u.setValue(s,e,t,!s.initialized,o,!1,!0)):this.runtimeCapabilityNotifyPropertyChanged&&n!==Controls.GlobalContextManager.bindingContext&&this.runtimeCapabilityNotifyPropertyChanged(this,e,t,s),s.onTagsChangedFn&&s.initialized&&(d||u.isPrimaryInputProperty&&!ControlWidget.isFirstBindingContext(n)&&!s.isTemplate)&&(Contracts.checkFunction(s.onTagsChangedFn),s.onTagsChangedFn()),this._canLayoutControl&&this._setDataflowBoundPropertyValue(s,e),!ControlWidget.isAuthoring)if(s.bindingContext===Controls.GlobalContextManager.bindingContext){var f=OpenAjax.widget.byId(this.topParentOrSelfName);f&&AppMagic.Utility.isComponent(f.OpenAjax.template.className)&&Controls.ContextManager.forAllBindingContextsOfComponentInstances((function(n,a){if(i.isChildOfComponentOrSelf(a)){var s=n.controlContexts[i.controlName];s&&Core.Utility.isNullOrUndefined(u.tryGetValue(s,e))&&i.setPropertyValueInternal(e,t,n,o,r)}}))}return a}}}},ControlWidget.prototype._validateErrorCapability=function(e,t){if(t===Controls.ErrorCapability.allErrors)return null;if(AppMagic.Data.ErrorValue.isErrorValue(e))return{error:e,location:ErrorLocation.Root};if(t===Controls.ErrorCapability.recordErrors)return null;if(Core.Utility.isArray(e))for(var n=e,o=0;o<n.length;o++){var r=n[o];if(AppMagic.Data.ErrorValue.isErrorValue(r))return{error:r,location:ErrorLocation.Record};if(Core.Utility.isObject(r)&&t===Controls.ErrorCapability.noErrors)for(var i=Object.keys(r),a=0;a<i.length;a++){var s=r[i[a]];if(AppMagic.Data.ErrorValue.isErrorValue(s))return{error:s,location:ErrorLocation.Property}}}return null},ControlWidget.prototype._resetErrorsAfterSuccessfulValidation=function(e){var t=AppMagic.AuthoringTool.Runtime.createErrorContext(this._icontrol.displayName,e);AppMagic.AuthoringTool.Runtime.resetRuntimeError(t)},ControlWidget.prototype._raiseErrorFromFailedValidation=function(e,t){var n;if(t){var o=AppMagic.Data.ErrorValue.tryGetReportableRuntimeError(t),r=Core.Utility.isObject(o)&&o.errorMessage?Core.Utility.formatString(AppMagic.Strings.ControlCannotReceiveNestedErrorDetails,o.errorMessage):AppMagic.Strings.ControlCannotReceiveNestedError,i=null!==(n=null==o?void 0:o.errorContext)&&void 0!==n?n:null,a=AppMagic.AuthoringTool.Runtime.tryCreateGatedReportRuntimeError({errorContext:i,errorMessage:r,error:null==o?void 0:o.error,raiseToastNotification:o.raiseToastNotification,functionName:o.functionName}),s=AppMagic.Data.ErrorValue.createError(t.kind,t.severity,r,a,t.errorHttpResponse);AppMagic.AuthoringTool.Runtime.handlePotentialRuleErrorSync(s,this._icontrol.displayName,e)}},ControlWidget.prototype.setSkipCompare=function(e,t){var n=this.controlProperties[e];n&&(n.isSkipCompare=t)},ControlWidget.prototype.setTaggedPropertyValueInternal=function(invariantPropertyName,value,tags,tagValues,bindingContext){Contracts.checkNonEmpty(invariantPropertyName),Contracts.checkArray(tags),Contracts.checkArray(tagValues),Contracts.check(tags.length===tagValues.length),Contracts.checkValue(this._tagsManager);for(var tagsArray=[],tagValuesArray=[],i=0;i<tags.length;i++)tagsArray.push(JSON.parse(tags[i])),tagValuesArray.push(eval(tagValues[i]));this._tagsManager.updateTagsValuesForProperty(invariantPropertyName,tagsArray,tagValuesArray),this.setPropertyValueInternal(invariantPropertyName,value,bindingContext,!0,!1);var controlContext=this.getOrCreateControlContext(bindingContext);controlContext&&(Core.Utility.isFunction(controlContext.onTagsChangedFn)&&controlContext.onTagsChangedFn(),ControlWidget.isAuthoring&&this._authoringVisual.updateTaggedRuleScriptsAsync(invariantPropertyName))},ControlWidget.prototype.updateControlTreeAsync=function(e,t){return Core.Utility.isFunction(this._ctrlMgr.updateControlTreeAsync)?this._ctrlMgr.updateControlTreeAsync(this._id,e,t):Promise.resolve()},ControlWidget.prototype.updatePropertyValue=function(e,t,n,o){if(void 0===n&&(n=!1),void 0===o&&(o=!1),Contracts.checkNonEmpty(e),Contracts.checkValue(t),Contracts.checkBooleanOrUndefined(n),this._isLoaded){if((!(n=!!n)||this.getPropertyValue(e,this._authoringAreaControlContext.bindingContext)!==t)&&ControlWidget.isAuthoring&&this._updatePropertyRuleFn){var r=this._controlPropertyMap[e].propertyName;return this._updatePropertyRuleFn(this._id,r,t,o)}}else this._logUseAfterRemoveControl("updatePropertyValue")},ControlWidget.prototype.updateBoundsPropertyValue=function(e,t,n){void 0===n&&(n=!1),Contracts.checkNonEmpty(e),Contracts.checkNumber(t),Contracts.checkBoolean(n),Contracts.check(ControlWidget.isAuthoring),this._ctrlMgr.executeShellAction({id:"UpdateControlBounds",controlName:this._id,invariantPropertyName:e,propertyValue:t,onlyUpdateIfChanged:n})},ControlWidget.prototype.updateScrollX=function(e){this._authoringVisual.updateScrollX(e)},ControlWidget.prototype.updateScrollY=function(e){this._authoringVisual.updateScrollY(e)},ControlWidget.prototype.fireEvent=function(e,t,n){var o=this;Contracts.checkNonEmpty(e),Contracts.checkObjectOrUndefined(t),Core.Utility.isUndefined(t)&&(t=this.getControlContext(Controls.GlobalContextManager.bindingContext));var r=this.isCustomControl?"Child":e.charAt(0).toUpperCase()+e.slice(1),i=function(){var n="onBefore"+r;Core.Utility.isFunction(o._control[n])&&o._control[n].call(o._control,t),o._runtimeCapabilityNotifyExecutionEvents&&o._runtimeCapabilityNotifyExecutionEvents(o,e,"Before",t)},a=function(){var n="onAfter"+r;Core.Utility.isFunction(o._control[n])&&o._control[n].call(o._control,t),o._runtimeCapabilityNotifyExecutionEvents&&o._runtimeCapabilityNotifyExecutionEvents(o,e,"After",t)},s=function(){o._isLoaded&&(o._isReplicable&&t.isTemplate?o._runInAssociated0thContext(t,(function(t){o._onEventFn(o._uniqueId,e,i,a,t.bindingContext,n)})):o._onEventFn(o._uniqueId,e,i,a,t.bindingContext,n))};ControlWidget._scheduleFireEvent?Core.Tasks.schedule(s,"ControlWidget_fireEvent"):AppMagic.Utility.executeImmediatelyAsync(s)},ControlWidget.prototype.hasProperty=function(e){return this._isLoaded?e in this._controlPropertyMap:(this._logUseAfterRemoveControl("hasProperty"),!1)},ControlWidget.prototype.canLayoutControl=function(){return this._canLayoutControl},ControlWidget.prototype.getDataflowBounds=function(){var e=this.getAuthoringControlContext().dataflowBounds;return{x:e.userXValue,y:e.userYValue,width:e.userWidthValue,height:e.userHeightValue,order:e.userOrderValue}},ControlWidget.prototype._forEachProperty=function(e){for(var t in this._controlPropertyMap){var n=this._controlPropertyMap[t];Contracts.checkObject(n),e(n)}},ControlWidget.prototype._forEachPropertyKVP=function(e){for(var t in this._controlPropertyMap){var n=this._controlPropertyMap[t];Contracts.checkObject(n),e(n,t)}},ControlWidget.prototype.promotePropertiesForView=function(e){for(var t in this.controlProperties){if(!e.properties[t])this.controlProperties[t].promotePropertyForView(e,t)}},ControlWidget.prototype.demotePropertiesForView=function(e){for(var t in this.controlProperties){var n=this.controlProperties[t];Contracts.checkObject(n),e.properties[t]&&n.demotePropertyForView(e,t)}},ControlWidget.prototype.getAuthoringControlContext=function(){if(!this._parentContextManager)return null;var e=this._parentContextManager.authoringAreaBindingContext,t=this.getControlContext(e);return Contracts.checkObject(t),t},ControlWidget.getTextModeAuthoringContext=function(e){var t=e.OpenAjax.getAuthoringControlContext();if(t&&t.realized)return t;var n=e.OpenAjax.getFirstControlContext();return n&&n.realized?n:null},ControlWidget.isFirstBindingContext=function(e){var t=e.parent;if(!t)return!0;if(e.rcManager instanceof Controls.ReplicatedContextManager){var n=e.rcManager,o=t.replicatedContexts[n.managerId];return o&&o.isFirstItem(e)}return!1},ControlWidget.prototype.getFirstControlContext=function(){for(var e=this,t=[];e.parentReplicatedContextManager!==Controls.GlobalContextManager.instance;)t.push(e.parentReplicatedContextManager.managerId),e=e.parentControlWidget;for(var n=Controls.GlobalContextManager.bindingContext;t.length>0;){var o=t.pop(),r=n.replicatedContexts[o];if(!r)break;n=r.hasFirstItem()?r.bindingContextAt(0):r.manager.authoringAreaBindingContext}return n&&this.getControlContext(n)},ControlWidget.prototype.getOnSelectControlContext=function(e){return this._control.getOnSelectControlContext?this._control.getOnSelectControlContext(e):this.getControlContext(e)},ControlWidget.prototype.getControlContext=function(e){if(!(e&&e.inputRow&&e.outputRow&&e.controlContexts))return null;if(Controls.ContextManager.shouldHaveControlContext(e,this)){var t=this.getId();if(!t)return null;var n=e.controlContexts[t];return n}},ControlWidget.prototype.getOrCreateControlContext=function(e){var t=this.getControlContext(e);return t||(t=Controls.ContextManager.allocateControlContext(e,this))&&Controls.ContextManager.initializeControlContext(e,this),t},ControlWidget.nextControlContextId=function(){return"".concat(ControlWidget._nextControlContextId++)},ControlWidget.prototype._applyToControlContextIfApplicable=function(e,t){var n=this.getControlContext(e);n&&t(n)},ControlWidget.prototype.forEachChildAuthoringControlContext=function(e,t){var n=this.controlManager.controlInstancesFlatTree;n[this.uniqueId].childIds.forEach((function(e){var o=n[e],r=o.control,i=o.name,a=r.OpenAjax.parentReplicatedContextManager.authoringAreaBindingContext.controlContexts[i];t(a)}))},ControlWidget.prototype.reset=function(e){var t=this;if(Contracts.checkValue(e),this._template.supportResettableProperties&&this._resetControlInputOutputProperties(e),e.initialized&&this._callControlMethodByName("resetControl",e),e.controlWidget.isReplicable){var n=e.bindingContext.rcManager.authoringAreaBindingContext;n.observedBindingContext===e.bindingContext&&e.controlWidget._applyToControlContextIfApplicable(n,(function(e){e.initialized&&t._callControlMethodByName("resetControl",e)}))}},ControlWidget.prototype.interactWithControlAsync=function(e,t){if(Contracts.checkValue(e),e.initialized){if(this.isPcfControl){var n=void 0;for(var o in t)t.hasOwnProperty(o)&&(n=this.setPropertyValueInternal(o,t[o],e.bindingContext));return this.fireEvent("OnChange",e),Promise.resolve(n)}return Promise.resolve(this._callControlMethodByName("interactWithControl",e,t))}},ControlWidget.prototype.runInitialDataflow=function(e){var t=this;if(!e.skippedCompare)try{e.skippedCompare=HashTableUtility.create(),this.template.inputProperties.forEach((function(n){n.propertyCategory!==AppMagic.Constants.PropertyRuleCategory.behavior&&t._onValueChangedFn(t.uniqueId,n.propertyName,null,e)}))}finally{delete e.skippedCompare}},ControlWidget.prototype.setFocus=function(e){if(this.hasProperty("TabIndex")){var t=e.viewState;t&&t.displayMode()===AppMagic.Constants.DisplayMode.Disabled||(this._runtimeCapabilityNotifySetFocusEvent&&this._runtimeCapabilityNotifySetFocusEvent(this,e),Controls.AccessibilityHelper.setControlFocus(e))}},ControlWidget.prototype.select=function(e){e.behaviors.OnSelect(!0),this._runtimeCapabilityNotifySelectControlEvent&&this._runtimeCapabilityNotifySelectControlEvent(this,e)},ControlWidget.prototype._resetControlInputOutputProperties=function(e){for(var t in this.controlProperties){var n=this.controlProperties[t];n&&n.isInput&&n.isOutput&&n.resetValue(e,t)}},ControlWidget.prototype._initContextManagerInterface=function(){var e=this;Contracts.checkNullOrUndefined(this._contextManagerInterface),this._authoringAreaControlContext=null,this._contextManagerInterface={newControlContext:function(t){Contracts.checkBoolean(t.isTemplate);var n=e._createNewControlContextInternal(t);return n.isTemplate=t.isTemplate,e._initializeProperties(n),n.isTemplate&&(e._authoringAreaControlContext?e.isComponentInstance&&Contracts.checkStrictEqual(e._authoringAreaControlContext.bindingContext.parent,t):(Contracts.checkNull(e._authoringAreaControlContext),e._authoringAreaControlContext=n)),n},recycleControlContext:function(t,n){Contracts.checkBoolean(n),e._recycleProperties(t),t.isTemplate=n,t.isTemplate&&(Contracts.checkNull(e._authoringAreaControlContext),e._authoringAreaControlContext=t)},initControlContext:function(t){var n;if(t.instanceId=ControlWidget.nextControlContextId(),t.disposed&&delete t.disposed,e._canLayoutControl&&(t.dataflowBounds={userXValue:t.modelProperties.X.getValue(),userYValue:t.modelProperties.Y.getValue(),userWidthValue:t.modelProperties.Width.getValue(),userHeightValue:t.modelProperties.Height.getValue()}),e._screenActiveAware&&(t.isParentScreenActive=ko.pureComputed((function(){return e._control&&e._isParentScreenActive(t.bindingContext,e.topParentOrSelfIndex)}))),e._callControlMethod(ControlMethodType.Init,t),t.initialized=!0,null===(n=e._runtimeCapabilityNotifyControlInstanceCreated)||void 0===n||n.call(e,t),!t._windowResizeHandler){var o=e.isCustomControl?"onChildWindowResize":"onWindowResize";if(Core.Utility.isFunction(e._control[o])){var r=e.isCustomControl?Core.Utility.debounce(e._control.onChildWindowResize.bind(e._metadataId,e._control,t),10):Core.Utility.debounce(e._control.onWindowResize.bind(e._control,t),10);t._windowResizeHandler=r}}},disposeControlContext:function(t){for(Contracts.checkArray(t._onBeforeDisposeCallbacks);t._onBeforeDisposeCallbacks.length;){t._onBeforeDisposeCallbacks.pop()(t)}e._callControlMethod(ControlMethodType.Dispose,t),e.reactRenderDataStore&&e.reactRenderDataStore.disposeRenderManager(t),e.demotePropertiesForView(t),Core.Utility.isFunction(t.isParentScreenActive)&&(t.isParentScreenActive.dispose(),t.isParentScreenActive=null),t.disposed=!0,t.initialized=!1,e._notifyGlobalsOfDisposedControlContext(t)}},Contracts.checkObject(this.contextManagerInterface)},ControlWidget.prototype._notifyGlobalsOfDisposedControlContext=function(e){var t=this;!ControlWidget.isAuthoring&&this._globals&&Object.keys(this._globals).forEach((function(n){Controls.AppMagicControlPropertyUtils.getGlobalProperty(t._globals[n]).handleControlContextDisposed(e)}))},ControlWidget.prototype._getPropertyValueControlContextHelper=function(e){var t;if(e===Controls.GlobalContextManager.bindingContext&&this._isReplicable)t=this._authoringAreaControlContext;else for(t=this.getControlContext(e);!t;)e=e.parent,t=this.getControlContext(e);return t},ControlWidget.prototype._getPropertyValueOnBeforeMethodCall=function(e,t){var n=(this.isCustomControl?"onBeforeChildGet":"onBeforeGet")+e.charAt(0).toUpperCase()+e.slice(1),o={property:e,self:!0};this._callControlMethodByName(n,o,t)},ControlWidget.prototype._initializeBehavior=function(e,t){var n=this;Contracts.checkObject(e),util.createPrivateImmutable(t.behaviors,e.propertyInvariantName,(function(o){var r=t.bindingContext.componentBindingContexts.lookup(n.controlName);r&&(t=r.controlContexts[n.controlName]);var i=t.modelProperties.DisplayMode;if("OnSelect"===e.propertyInvariantName&&i&&i.getValue()===AppMagic.Constants.DisplayMode.Disabled)return!0;if("OnSelect"===e.propertyInvariantName&&!o){var a=t.controlWidget;n._shellEventBroker.publishEvent(GlobalEventBroker.EventBrokerId.TestStudio_OnSelectCalled,{bindingContextId:t.bindingContext.id,controlName:a.controlName,parentControlName:a.parentControlName,topParentOrSelfName:a.topParentOrSelfName,template:{className:a.template.className}}),Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.UserAction,"Select",{context:{entityName:a.controlName,propertyName:e.propertyInvariantName}})}return n._shouldFireEventOnBindingContext(t.bindingContext)&&n.fireEvent(e.propertyInvariantName,t),!0}))},ControlWidget.prototype._shouldFireEventOnBindingContext=function(e){if(!this.isReplicable)return!0;var t=e.rcManager,n=null==t?void 0:t.getControlWidget();if(!n)return!0;if(!Core.FallbackSwitch.isActivated("AppRuntime.ControlWidgetFireEventOnBindingContext")&&!this._shouldFireEventOnBindingContext(e.parent))return!1;var o=!!this.controlManager.getControlInstanceById(n.uniqueId).control.behaviorEventsOnAuthContext,r=t.authoringAreaBindingContext.observedBindingContext;return e.id!==AppMagic.Constants.replicatedTemplateContextId&&(!o&&e.id!==AppMagic.Constants.authoringAreaContextId||o&&r!==e)},ControlWidget.prototype._isSelectedProperty=function(e,t){return Contracts.checkObject(e),!!t.controlWidget._isGalleryControl&&e._isSelectedProperty},ControlWidget.prototype._isInputProperty=function(e){Contracts.checkValue(this._template);var t=Core.Utility.normalizeToArray(this._template.inputNames);return Contracts.checkArray(t),-1!==t.indexOf(e)},ControlWidget.prototype._initializeProperty=function(e,t,n){if(Contracts.checkNonEmpty(e),this._isLoaded){var o,r=this._controlPropertyMap[e];if(!t.isTemplate&&Core.Utility.isValue(n)&&r.isInput&&!this._isSelectedProperty(r,t)&&null!==(o=r.tryGetRuleValue(n,e)))if(o&&Core.Utility.isFunction(o.getNextResultsAsync)){var i="".concat(t.controlWidget.uniqueId,".").concat(e);Core.Tasks.schedule((function(){t.initialized&&AppMagic.AuthoringTool.Runtime.runDependentRules(t.bindingContext,i)}),"InitializePageableProperty"),r.initProperty(t,e)}else r.initProperty(t,e,o);else r.initProperty(t,e);this.runtimeCapabilityNotifyPropertyChanged&&(void 0===o&&this._runtimeCapabilityNotifyInitialPropertyValues&&(o=r.tryGetValue(t,e)),void 0!==o&&this.runtimeCapabilityNotifyPropertyChanged(this,e,o,t)),t.isTemplate&&this._entityPropertyChangedFn&&this._entityPropertyChangedFn(this._id,e,r.getValue(t,e))}else this._logUseAfterRemoveControl("_initializeProperty")},ControlWidget.prototype._recycleProperties=function(e){var t=this;if(this._isLoaded){var n=this._getTemplateControlContext(e.bindingContext);this._forEachPropertyKVP((function(o,r){var i;!e.isTemplate&&Core.Utility.isValue(n)&&o.isInput&&!t._isSelectedProperty(o,e)&&null!==(i=o.tryGetRuleValue(n,r))?o.recycleProperty(e,r,i):o.recycleProperty(e,r),void 0!==i&&t.runtimeCapabilityNotifyPropertyChanged&&t.runtimeCapabilityNotifyPropertyChanged(t,r,i,e)}))}else this._logUseAfterRemoveControl("_recycleProperties")},ControlWidget.prototype._initializeProperties=function(e){var t=this;Contracts.checkValue(this._template),util.createPrivateImmutable(e,"properties",{}),util.createPrivateImmutable(e,"behaviors",{});var n=this._getTemplateControlContext(e.bindingContext);this._template.dataProperties.map((function(o){return t._initializeProperty(o.propertyInvariantName,e,n)})),this._template.designProperties.map((function(o){return t._initializeProperty(o.propertyInvariantName,e,n)})),this._template.onDemandDataProperties.map((function(o){return t._initializeProperty(o.propertyInvariantName,e,n)})),this._template.constantDataProperties.map((function(o){return t._initializeProperty(o.propertyInvariantName,e,n)}));for(var o=this._template.behaviorProperties,r=0,i=o.length;r<i;r++)this._initializeBehavior(o[r],e)},ControlWidget.prototype._handleAppModeChanged=function(e){this._control.onAppModeChanged&&this._control.onAppModeChanged(e)},ControlWidget.prototype.handleBeforePropertyValueChanged=function(e,t,n,o,r){if(Contracts.checkNonEmpty(t,"ControlWidget.handleBeforePropertyValueChanged.propertyName"),Contracts.checkDefined(n,"ControlWidget.handleBeforePropertyValueChanged.oldValue"),Contracts.checkDefined(o,"ControlWidget.handleBeforePropertyValueChanged.value"),Contracts.checkDefined(r,"ControlWidget.handleBeforePropertyValueChanged.skipCompare"),this._isLoaded){var i={property:t,oldValue:AppMagic.Data.DataValue.errorValueToNull(n),newValue:AppMagic.Data.DataValue.errorValueToNull(o),self:!0,skipCompare:r},a=(this.isCustomControl?"onBeforeChildChange":"onBeforeChange")+t.charAt(0).toUpperCase()+t.slice(1);this._callControlMethodByName(a,i,e)}else this._logUseAfterRemoveControl("handleBeforePropertyValueChanged")},ControlWidget.prototype.handlePropertyValueChanged=function(e,t,n,o,r,i){if(Contracts.checkNonEmpty(t,"ControlWidget.handlePropertyValueChanged.propertyName"),this._isLoaded){if(t!==PropertyNames.Items||!ControlWidget._initialDataflowHasBeenProcessed(e,t)){var a=AppMagic.Data.DataValue.isErrorValue(o)?o:null,s=AppMagic.Data.DataValue.errorValueToNull(o),l={property:t,oldValue:AppMagic.Data.DataValue.errorValueToNull(n),newValue:s,self:r};this._callControlMethod(ControlMethodType.PropertyChanged,l,e);var c=(this.isCustomControl?"onChildChange":"onChange")+t.charAt(0).toUpperCase()+t.slice(1);this.isCustomControl?this._callControlMethodByName(c,s,e):this._callControlMethodByName(c,l,e);var p=this._controlPropertyMap[t];Contracts.checkObject(p,"ControlWidget.handlePropertyValueChanged.controlProperty");var u=p.getValue(e,t);if(a&&(u=a),this._notifyOutputPropertyValueChangedInternal(t,e.bindingContext||Controls.GlobalContextManager.bindingContext,u),this._propertyChangeNotifications[t])this._propertyChangeNotifications[t].slice().forEach((function(t){return t(u,e)}));if(this.isInAutoLayoutContainer(e.bindingContext)){var d=AutoLayoutPropertyNameMap[t];d&&this._setDataflowBoundPropertyValue(e,d)}this._isReplicable&&p.isDataProperty&&(e.bindingContext.isTemplate||this._parentContextManager.notifyOutputRowChanged(e.bindingContext.parent,e.bindingContext.id),this._parentContextManager.notifyOutputTableChanged(e.bindingContext.parent)),this._isReplicable&&e.isTemplate&&this._runInAssociated0thContext(e,(function(e){p.setValue(e,t,o,!1,!1,r,i)})),(e.isTemplate||e.bindingContext&&e.bindingContext.componentInstance)&&this._entityPropertyChangedFn&&this._entityPropertyChangedFn(this._id,t,AppMagic.Data.DataValue.errorValueToNull(o)),this._updatePropertyValueAndSetBounds(e,t,o,r)}}else this._logUseAfterRemoveControl("handlePropertyValueChanged")},ControlWidget.prototype.checkAndInitCustomProperty=function(e,t){var n=this;if(this._checkAndInitCustomProperty(e,t),e.bindingContext===Controls.GlobalContextManager.bindingContext)Controls.ContextManager.forAllBindingContextsOfComponentInstances((function(e,o){var r=OpenAjax.widget.byId(o);if(r.OpenAjax.template.name===n._template.name){var i=r.OpenAjax.getOrCreateControlContext(e);r.OpenAjax._checkAndInitCustomProperty(i,t);var a=r.OpenAjax.getOrCreateControlContext(e.parent);r.OpenAjax._checkAndInitCustomProperty(a,t)}}));else{var o=this.getOrCreateControlContext(Controls.GlobalContextManager.bindingContext);this._checkAndInitCustomProperty(o,t)}},ControlWidget.prototype.removeCustomProperty=function(e,t){var n=this;if(this._removeCustomProperty(e,t),e.bindingContext===Controls.GlobalContextManager.bindingContext)Controls.ContextManager.forAllBindingContextsOfComponentInstances((function(e,o){var r=OpenAjax.widget.byId(o);if(r.OpenAjax.template.name===n._template.name){var i=r.OpenAjax.getControlContext(e);r.OpenAjax._removeCustomProperty(i,t)}}));else{var o=this.getOrCreateControlContext(Controls.GlobalContextManager.bindingContext);this._removeCustomProperty(o,t)}},ControlWidget.prototype._updatePropertyValueAndSetBounds=function(e,t,n,o){if(ControlWidget.isAuthoring&&(n=AppMagic.Data.DataValue.errorValueToNull(n),e.isTemplate)){var r=this._authoringVisual;if(r)if(r.setPropertyValue(t,n),Core.Utility.isFunction(r.updateBounds)&&!AppMagic.Utility.isScreen(this.template.name)&&!this.isComponentDefinition)(t in this._defaultPropertyMap||t in AutoLayoutPropertyNameMap||!this.template.isThirdPartyPcfControl&&(t===PropertyNames.AutoHeight||LayoutProperties.indexOf(t)>=0))&&r.updateBounds(t,n,!1)}},ControlWidget.prototype._setDataflowBoundPropertyValue=function(e,t,n){var o,r;if(e.initialized&&!this.isCustomControl){var i=DataflowBoundsMap[t];if(i){var a=n;Core.Utility.isNullOrUndefined(a)&&this.isInAutoLayoutContainer(e.bindingContext)&&(a=null===(o=e.modelProperties[i.autolayoutPropName])||void 0===o?void 0:o.getValue()),Core.Utility.isNullOrUndefined(a)&&(a=null===(r=e.modelProperties[t])||void 0===r?void 0:r.getValue()),Core.Utility.isNullOrUndefined(a)||(e.dataflowBounds[i.dataflowBoundsPropName]=a)}}},ControlWidget.prototype._notifyOutputPropertyValueChangedInternal=function(e,t,n){Contracts.checkNonEmpty(e),Core.Utility.isUndefined(n)&&(n=null),this._template.hasOutputInvariant(e)&&this._onValueChangedFn(this.uniqueId,e,n,t)},ControlWidget.prototype._aggregateUpdates=function(e,t){Contracts.check(this._aggregatesChildUpdates);var n=AppMagic.Data.DataRecord.create();this._aggregateUpdatesFromChildren(this.globalControlContext,n),t.modelProperties.Updates.setValue(n,!0)},ControlWidget.prototype._aggregateUpdatesFromChildren=function(e,t){var n=e;if(this._containsDataFieldUpdate(e)){var o=e.modelProperties.DataField.getValue();Core.Utility.isNonEmptyNonWhitespaceString(o)&&(t[o]=e.modelProperties.Update.getValue())}else if(Core.Utility.isDefined(n._children))for(var r=0,i=n._children;r<i.length;r++){var a=i[r];this._aggregateUpdatesFromChildren(a.controlContext,t)}},ControlWidget.prototype._containsDataFieldUpdate=function(e){return Core.Utility.isValue(e.modelProperties)&&Core.Utility.isDefined(e.modelProperties.Update)&&Core.Utility.isDefined(e.modelProperties.DataField)},ControlWidget.prototype._runInAssociated0thContext=function(e,t){Contracts.check(e.isTemplate),Contracts.checkFunction(t),Contracts.check(this._isReplicable);var n=e.bindingContext.parent;Contracts.checkObject(this.parentReplicatedContextManager);var o=this.parentReplicatedContextManager.replicatedContextFor(n);if(Contracts.checkObject(o),this.parentReplicatedContextManager.isLoaded&&o.getBindingContextCount()>0){var r=o.bindingContextAt(0);if(!Core.Utility.isNullOrUndefined(r)){var i=this.getControlContext(r);Contracts.checkObject(i),t(i)}}},ControlWidget.prototype._isParentScreenActive=function(e,t){if(Contracts.checkValue(t),e.componentInstance){var n=OpenAjax.widget.byId(this.topParentOrSelfName);if(n&&AppMagic.Utility.isComponent(n.OpenAjax.template.className)){var o=OpenAjax.widget.byId(e.componentInstance);o&&(t=o.OpenAjax.topParentOrSelfIndex)}return this._activeScreenIndex()===t}return e===Controls.GlobalContextManager.bindingContext?this._activeScreenIndex()===t:this._isParentScreenActive(e.parent,t)},ControlWidget.prototype._createNewControlContextInternal=function(e){return{instanceId:null,isParentScreenActive:null,viewState:null,autoProperties:null,controlWidget:this,bindingContext:e,modelProperties:Object.create(null),properties:Object.create(null),behaviors:Object.create(null),container:null,realized:!1,initialized:!1,_asyncRules:{},_subscriptions:[],_windowResizeHandler:null,_onBeforeDisposeCallbacks:[]}},ControlWidget.prototype._runBindingContextDataFlow=function(e){Contracts.checkArray(e),this._thisItemInputInvariantName&&""!==this._thisItemInputInvariantName&&this._onValueChangedFn(this.uniqueId,this._thisItemInputInvariantName,null,e)},ControlWidget._contextQualifiedName=function(e,t){return Contracts.checkNonEmpty(t),"".concat(e.instanceId,"|").concat(t)},ControlWidget._getSkippedCompareMap=function(e){var t=Controls.ContextManager.findBindingContextOrAncestor(e.bindingContext,(function(e){return!!e.skippedCompare}));return null==t?void 0:t.skippedCompare},ControlWidget.registerSkippedCompare=function(e,t){Contracts.checkNonEmpty(t);var n=this._getSkippedCompareMap(e);n&&(n[this._contextQualifiedName(e,t)]=!0)},ControlWidget.shouldSkipCompare=function(e,t){Contracts.checkNonEmpty(t);var n=this._getSkippedCompareMap(e);return!!n&&!n[this._contextQualifiedName(e,t)]},ControlWidget._initialDataflowHasBeenProcessed=function(e,t){Contracts.checkNonEmpty(t);var n=this._getSkippedCompareMap(e);return null==n?void 0:n[this._contextQualifiedName(e,t)]},ControlWidget.prototype._initControlProperties=function(){var e=this;Core.PerformanceRecorder.instance.recordFunction("ControlWidget._initControlProperties",(function(){Contracts.checkValue(e._template),e._controlPropertyMap={},e._defaultPropertyMap={};var t=e._template;if(ControlWidget.isAuthoring)for(var n=t.defaultProperties,o=0,r=n.length;o<r;o++)e._defaultPropertyMap[n[o]]=null;for(o=0,r=(i=t.dataProperties).length;o<r;o++)e._setupProperty(!0,e,i[o]);for(o=0,r=(i=t.designProperties).length;o<r;o++)e._setupProperty(!1,e,i[o]);for(o=0,r=(i=t.onDemandDataProperties).length;o<r;o++)e._setupProperty(!1,e,i[o]);var i;for(o=0,r=(i=t.constantDataProperties).length;o<r;o++)e._setupProperty(!1,e,i[o])}),this)},ControlWidget.prototype._setupProperty=function(e,t,n){var o;Contracts.checkBoolean(e),Contracts.checkValue(n);var r=t._globals;r&&(o=r[n.propertyInvariantName]);var i=null;o&&(i=Controls.AppMagicControlPropertyUtils.getOrCreateGlobalProperty(o,n,e)),t._controlPropertyMap[n.propertyInvariantName]=null!==i?i:new Controls.ControlProperty(t.uniqueId,t._id,n,t._isInputProperty(n.propertyInvariantName),t._template.hasOutputInvariant(n.propertyInvariantName),e),n.propertyInvariantName in t._defaultPropertyMap&&(t._defaultPropertyMap[n.propertyInvariantName]=t._controlPropertyMap[n.propertyInvariantName])},ControlWidget.prototype._callControlMethod=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=this._getControlMethodName(e);o&&this._callControlMethodByName.apply(this,__spreadArray([o],t,!1))},ControlWidget.prototype._callControlMethodByName=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this._control&&e){this.isCustomControl&&(t||(t=[]),t.splice(0,0,this._metadataId));var o=this._control[e],r=this["_"+e];return Core.Utility.isFunction(o)&&Core.Utility.isValue(o)?o.apply(this._control,t):Core.Utility.isFunction(r)&&Core.Utility.isValue(r)?r.apply(this,t):void 0}},ControlWidget.prototype._getControlMethodName=function(e){var t=null;switch(e){case ControlMethodType.Suspend:t=this.isCustomControl?"suspendChildControlContext":"suspendControlContext";break;case ControlMethodType.Resume:t=this.isCustomControl?"resumeChildControlContext":"resumeControlContext";break;case ControlMethodType.ModeChange:t=this.isCustomControl?"onChildModeChanged":"onModeChanged";break;case ControlMethodType.Load:t=this.isCustomControl?"onChildLoad":"onLoad";break;case ControlMethodType.Init:t=this.isCustomControl?"initChildControlContext":"initControlContext";break;case ControlMethodType.Dispose:t=this.isCustomControl?"disposeChildControlContext":"disposeControlContext";break;case ControlMethodType.PropertyChanged:t=this.isCustomControl?"onChildPropertyChange":"onChange"}return t},ControlWidget.prototype._createRenderManager=function(){this._reactRenderDataStore=new AppMagic.Controls.ControlReactRenderDataStore(this._control,this._icontrol)},ControlWidget.prototype._forEachBindingContext=function(e,t){if(e instanceof Array)for(var n=0,o=e.length;n<o;n++)this._parentContextManager.forEachManagedDescendingBindingContext(e[n],t);else null===e&&(e=Controls.GlobalContextManager.bindingContext),this._parentContextManager.forEachManagedDescendingBindingContext(e,t)},ControlWidget.prototype.isPropertyChanged=function(e){return!this.hasProperty(e.propertyName)||this._controlPropertyMap[e.propertyName].propertyType!==e.propertyType.toString()},ControlWidget.prototype._checkAndInitCustomProperty=function(e,t){var n=t.propertyName;if(this.isPropertyChanged(t)&&(this._setupProperty(!0,this,t),delete e.modelProperties[n]),!e.modelProperties[n]){var o=this._getTemplateControlContext(e.bindingContext);this._initializeProperty(n,e,o),delete e.properties[n],this._controlPropertyMap[n].promotePropertyForView(e,n)}},ControlWidget.prototype._removeCustomProperty=function(e,t){delete e.properties[t],delete e.modelProperties[t],delete this._controlPropertyMap[t]},ControlWidget.prototype._getTemplateControlContext=function(e){var t,n;if(this._parentContextManager===Controls.GlobalContextManager.instance)return this._authoringAreaControlContext;var o=e.templateBindingContext;if(o&&(r=this.getControlContext(o)))return r;if(e.id===AppMagic.Constants.replicatedTemplateContextId){var r,i=e.rcManager.managerId,a=null===(n=null===(t=e.parent.templateBindingContext)||void 0===t?void 0:t.replicatedContexts[i])||void 0===n?void 0:n.templateBindingContext;if(a)if(r=this.getControlContext(a))return r;return this._authoringAreaControlContext}for(var s=e;s&&!s.componentInstance;)s=s.parent;if(s){var l=e.parent.replicatedContexts[this.parentReplicatedContextManager.managerId];if(l){var c=l.tryGetContextAt(0),p=c&&this.getControlContext(c);if(p)return p}}return this._authoringAreaControlContext},Object.defineProperty(ControlWidget.prototype,"_authoringVisual",{get:function(){return AppMagic.context.documentViewModel.tryGetEntityByName(this._id)},enumerable:!1,configurable:!0}),ControlWidget.prototype.changeCanvasDimensions=function(e,t,n){void 0===n&&(n=!0);var o=t===PropertyNames.Height?e:this.getPropertyValue(PropertyNames.Height),r=t===PropertyNames.Width?e:this.getPropertyValue(PropertyNames.Width);null!==r&&null!==o&&(r>=0&&o>=0&&Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.AuthoringTool.GlobalEventBroker.ShellEventBroker.singletonKey).publishEvent(AppMagic.AuthoringTool.GlobalEventBroker.EventBrokerId.Canvas_DimensionsChanged,{width:r,height:o,name:this.controlName,updateServerRule:n}))},ControlWidget._scheduleFireEvent=null,ControlWidget._nextControlContextId=0,ControlWidget._mutablePropertyErrorCounter=0,ControlWidget._maxMutablePropertyErrorsToReport=35,__decorate([initializeOnLoad((function(){return Core.FeatureGates.controls.codeGenCanBeCompressed}))],ControlWidget,"_isSetValueTelemetryEnabled",void 0),ControlWidget}();Controls.ControlWidget=ControlWidget}(Controls=AppMagic.Controls||(AppMagic.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){!function(t){t.encodeImageUrl={view:function(e){return Contracts.checkStringOrNull(e),null===e?e:(t=e,Contracts.checkString(t),e=t.replace(/([\r\n]|%$|%(?![0-9A-Fa-f][0-9A-F-a-f]))/g,"").trim(),encodeURI(decodeURI(e)));var t}},t.imagePositionConverter={view:function(e){Contracts.checkStringOrNull(e);var t={size:void 0,repeat:void 0,position:void 0,objectFit:void 0,objectPosition:void 0};if(null===e)return t;switch(e.toLowerCase()){case"fill":t={size:"cover",repeat:"no-repeat",position:"center",objectFit:"cover",objectPosition:"50% 50%"};break;case"stretch":t={size:"100% 100%",repeat:"no-repeat",position:"center",objectFit:"fill",objectPosition:"50% 50%"};break;case"tile":t={size:"auto auto",repeat:"repeat",position:"left top",objectFit:void 0,objectPosition:void 0};break;case"center":t={size:"auto",repeat:"no-repeat",position:"center",objectFit:"none",objectPosition:"50% 50%"};break;case"fit":default:t={size:"contain",repeat:"no-repeat",position:"center",objectFit:"contain",objectPosition:"50% 50%"}}return t}},t.argbConverter={view:function(e){if(Contracts.checkNumberOrNull(e),null===e)return null;var t=Core.Utility.Color.create(e);return Contracts.checkObject(t),t.toCss()}},t.fontConverter={view:function(e){if(Contracts.checkStringOrNull(e),null===e)return"'Open Sans', sans-serif";return e.match(/(^|,)\s*(sans-serif|serif|monospace)$/)?e:e+", 'Open Sans', sans-serif"}},t.ptConverter={view:function(t){return e.Controls.converters._appendUnit(t,"pt")},model:function(t){return e.Controls.converters._stripUnit(t,"pt")}},t.pxConverter={view:function(t){return e.Controls.converters._appendUnit(t,"px")},model:function(t){return e.Controls.converters._stripUnit(t,"px")}},t.pxHorizontalConverter={view:function(t){return e.Controls.converters._appendUnit(t,"px")},model:function(t){return e.Controls.converters._stripUnit(t,"px")}},t.pxVerticalConverter={view:function(t){return e.Controls.converters._appendUnit(t,"px")},model:function(t){return e.Controls.converters._stripUnit(t,"px")}},t.pxLogicalToNativeHorizontalConverter=function(e){return e},t.pxLogicalToNativeVerticalConverter=function(e){return e},t.strokeConverter={view:function(e){switch(Contracts.checkStringOrNull(e),null===e&&(e=""),e.toLowerCase()){case"dotted":return"2,2";case"dashed":return"5,2";case"solid":return"none";case"none":default:return""}},model:function(e){switch(Contracts.checkString(e),e.toLowerCase()){case"0,0":return"none";case"2,2":return"dotted";case"5,2":return"dashed";case"none":return"solid";default:return"none"}}},t.italicConverter={view:function(e){return Contracts.checkBooleanOrNull(e),e?"italic":"normal"}},t.overflowConverter={view:function(e){return Contracts.checkStringOrNull(e),null!==e&&(e=e.toLowerCase()),"scroll"===e?"auto":"hidden"}},t.borderStyleConverter={view:function(e){return Contracts.checkStringOrNull(e),null!==e&&(e=e.toLowerCase()),"solid"===e||"dotted"===e||"dashed"===e?e:"none"}},t._appendUnit=function(e,t){return Contracts.checkNumberOrNull(e,"converters._appendUnit.value"),Contracts.checkNonEmpty(t,"converters._appendUnit.unit"),null===e?null:e.toString()+t},t._stripUnit=function(e,t){return Contracts.checkStringOrNull(e),Contracts.checkNonEmpty(t),null===e?null:(Contracts.check(e.length>t.length),Contracts.check(e.substr(e.length-t.length,t.length)===t),parseInt(e.substr(0,e.length-t.length),10))}}(t.converters||(t.converters={}))}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=e.Controls.converters,o=function(){function o(e,t,n){this._controlComponent=null,this._controlContext=n,this._control=e,this._controlInfo=t,this._parentControlDisplayName=t.parent?t.parent.displayName:null,this._disposed=!1,this._mounted=!1,this._autoBorderRadius=this._controlInfo.template.autoBorderRadius,this._autoDropShadow=this._controlInfo.template.autoDropShadow,this._autoPointerViewState=this._controlInfo.template.autoPointerViewState,this._autoDisabledViewState=this._controlInfo.template.autoDisabledViewState,this._autoFocusedBorders=this._controlInfo.template.autoFocusedBorders,this._renderProps={key:null,name:null,container:null,control:null,templateHtml:null,left:null,top:null,width:null,height:null,zIndex:null,margin:null,marginFocused:null,autoBorders:null,autoDisabledViewState:null,autoPointerViewState:null,autoFill:null,borderStyle:null,borderWidth:null,borderWidthFocused:null,borderColor:null,borderColorFocused:null,borderTopLeftRadius:null,borderTopRightRadius:null,borderBottomLeftRadius:null,borderBottomRightRadius:null,paddingTop:null,paddingRight:null,paddingBottom:null,paddingLeft:null,backgroundColor:null,fill:null,color:null,visible:null,displayMode:null,contentLanguage:null,boxShadow:null,autoDropShadow:null},this._updateControlComponentState=this._updateControlComponentState.bind(this),this._initialize()}return o.prototype.dispose=function(){this._controlContext.viewState&&(this._controlContext.viewState.dispose(),this._controlContext.viewState=null),this._disposeSubscriptionsAndAutoProperties();var e=this._renderProps;for(var t in e)e.hasOwnProperty(t)&&delete e[t];this._renderProps=null,this._controlComponent=null,this._controlContext=null,this._controlInfo=null,this._parentControlReference=null,this._disposed=!0,this._mounted||(this._control=null)},o.prototype.componentDidMount=function(){if(Core.Utility.isFunction(this._control.onViewPositioningComplete)&&this._control.onViewPositioningComplete(this._controlContext),this._parentControlDisplayName){var e=OpenAjax.widget.byId(this._parentControlDisplayName);e&&Core.Utility.isFunction(e.onChildAdded)&&e.onChildAdded(this._control,this._controlContext,e.OpenAjax.getAuthoringControlContext())}this._mounted=!0},o.prototype.componentWillUnmount=function(){if(this._mounted=!1,this._parentControlDisplayName){var e=OpenAjax.widget.byId(this._parentControlDisplayName);e&&Core.Utility.isFunction(e.onChildRemoved)&&e.onChildRemoved(this._control,e.OpenAjax.getAuthoringControlContext())}this._disposed&&(this._control=null)},o.prototype.registerControlComponent=function(e){this._controlComponent&&this._controlComponent!==e&&this._disposeSubscriptionsAndAutoProperties(),this._controlComponent=e,this._initializeRenderProps()},o.prototype.unregisterControlComponent=function(e){this._controlComponent===e&&(this._disposeSubscriptionsAndAutoProperties(),this._controlComponent=null)},o.prototype.updateControlName=function(e){this._renderProps.name=e},o.prototype.updateViewState=function(e){if(!this.disposed){var t=Core.UI.VisualStateTrackerStates,n=this._controlContext;if(n.initialized){var o=n.viewState;if(!n.controlWidget.controlManager.enableUpdateViewStates())return o.hovering(!1),void o.pressed(!1);switch(e){case t.normal:case t.focused:case t.disabled:o.hovering(!1),o.pressed(!1);break;case t.hover:o.hovering(!0),o.pressed(!1);break;case t.pressed:o.hovering(!1),o.pressed(!0)}}}},Object.defineProperty(o.prototype,"disposed",{get:function(){return this._disposed},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"renderProps",{get:function(){return this._renderProps},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"viewState",{get:function(){return this._controlContext.viewState},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"_isNotComponentInstance",{get:function(){return!this._controlInfo.componentDefinition},enumerable:!1,configurable:!0}),o.prototype._initialize=function(){this._control.OpenAjax.promotePropertiesForView(this._controlContext),this._renderProps.control=this._control,this._renderProps.key=this._control.OpenAjax.uniqueId;var e=this._controlInfo.template;this._renderProps.templateHtml=e.content.replace(/__WID__/g,this._controlInfo.displayName),this._renderProps.autoPointerViewState=e.autoPointerViewState,this._renderProps.autoDisabledViewState=e.autoDisabledViewState,this._renderProps.autoFill=e.autoFill,this._renderProps.autoBorders=e.autoBorders,this._renderProps.autoDropShadow=e.autoDropShadow,(this._renderProps.autoPointerViewState||this._renderProps.autoDisabledViewState)&&(this._controlContext.viewState=new t.ViewState(this._controlContext,this._control.OpenAjax.isAncestorDisabled,this._control.OpenAjax.isAncestorReadonly))},o.prototype._initializeRenderProps=function(){this._initializingRenderProps=!0,this._initializeAutoProperties();var t=this._controlContext.modelProperties,n=this._useLayoutProperties(t);this._populateLayoutProperty(t,n,!0,"X","left"),this._populateLayoutProperty(t,n,!1,"Y","top"),this._populateZIndexProperty(t),this._populateLayoutProperty(t,n,!0,"Width","width"),this._populateLayoutProperty(t,n,!1,"Height","height"),t.Visible&&this._populatePropertyValue(t.Visible,"visible"),this._isNotComponentInstance&&t.DisplayMode&&this._populatePropertyValue(t.DisplayMode,"displayMode"),this._isNotComponentInstance&&this._renderProps.autoBorders&&this._populateBorderStyleAndWidth(t),this._renderProps.autoFill&&this._populateFill(t),this._isNotComponentInstance&&this._populateColor(t),this._isNotComponentInstance&&this._autoBorderRadius&&(this._populatePixelPropertyValue(t,"RadiusTopLeft","borderTopLeftRadius"),this._populatePixelPropertyValue(t,"RadiusTopRight","borderTopRightRadius"),this._populatePixelPropertyValue(t,"RadiusBottomLeft","borderBottomLeftRadius"),this._populatePixelPropertyValue(t,"RadiusBottomRight","borderBottomRightRadius")),this._controlInfo.template.id===e.Constants.Controls.TemplateIds.Container&&this._populateAutoLayoutProperties(t),this._autoDropShadow&&this._populatePropertyValue(t.DropShadow,"boxShadow",(function(t){return e.Constants.DropShadowStyles[t]})),this._populateAutoLayoutChildProperties(t),this._populatePaddingProperties(t),this._populateContentLanguage(t),this._initializingRenderProps=!1},o.prototype._disposeSubscriptionsAndAutoProperties=function(){this._disposeSubscriptions(),this._disposeAutoProperties()},o.prototype._disposeSubscriptions=function(){this._controlContext._subscriptions.forEach((function(e){e.dispose()})),this._controlContext._subscriptions=[]},o.prototype._updateControlComponentState=function(e){this._controlComponent&&!this._initializingRenderProps&&this._controlComponent.batchUpdateState(e)},o.prototype._disposeAutoProperties=function(){var e=this._controlContext.autoProperties;e&&(ko.isComputed(e.Fill)&&(e.Fill.dispose(),e.Fill=null),ko.isComputed(e.Color)&&(e.Color.dispose(),e.Color=null),this._controlContext.autoProperties=null)},o.prototype._initializeAutoProperties=function(){this._controlContext.autoProperties={},this._initializeAutoColorProperty("Fill","fill"),this._isNotComponentInstance&&this._initializeAutoColorProperty("Color","color")},o.prototype._initializeAutoColorProperty=function(t,n){var o=this,r=this._controlContext.properties,i=this._controlContext.viewState,a=this._controlContext.modelProperties;ko.isObservable(r[t])&&this._populateColorPropertyValue(a["".concat(t)],"".concat(n)),this._checkIfAutoPropertyExists(t)&&(this._populateColorPropertyValue(a["Disabled".concat(t)],"".concat(n,"Disabled")),this._populateColorPropertyValue(a["Pressed".concat(t)],"".concat(n,"Pressed")),this._populateColorPropertyValue(a["Hover".concat(t)],"".concat(n,"Hover")),this._controlContext.autoProperties[t]=ko.pureComputed((function(){if(o._controlContext.viewState.displayMode()===e.Constants.DisplayMode.View)return r[t]();if(o._autoDisabledViewState&&o._controlContext.viewState.displayMode()===e.Constants.DisplayMode.Disabled)return r["Disabled".concat(t)]();if(o._autoPointerViewState){if(i.pressed()&&ko.isObservable(r["Pressed".concat(t)]))return r["Pressed".concat(t)]();if(i.hovering()&&ko.isObservable(r["Hover".concat(t)]))return r["Hover".concat(t)]()}return r[t]()})))},o.prototype._checkIfAutoPropertyExists=function(e){var t=this._controlContext.properties;return ko.isObservable(t[e])&&(ko.isObservable(t["Disabled".concat(e)])&&this._autoDisabledViewState||ko.isObservable(t["Pressed".concat(e)])&&this._autoPointerViewState||ko.isObservable(t["Hover".concat(e)])&&this._autoPointerViewState)},o.prototype._subscribe=function(e,t){Contracts.checkFunction(t.context),Contracts.checkObject(t.positionArgs),this._controlContext._subscriptions.push(e.subscribe(t.context,t.positionArgs))},o.prototype._useLayoutProperties=function(e){return this._isNotComponentInstance&&this._isLayoutManagedByParentControl()&&!!(e&&e.LayoutX&&e.LayoutY&&e.LayoutWidth&&e.LayoutHeight)},o.prototype._populatePropertyValue=function(e,t,n){var r={context:o._updateValue,positionArgs:{property:e,valueConverter:n,reactPropertyName:t,updateStateFn:this._updateControlComponentState,renderProps:this._renderProps}};r.context.apply(r.positionArgs),this._subscribe(e.modelObservable,r)},o._updateValue=function(){var e,t=this.property.getValue();this.renderProps[this.reactPropertyName]=this.valueConverter?this.valueConverter(t):t,this.updateStateFn(((e={})[this.reactPropertyName]=this.renderProps[this.reactPropertyName],e))},o.prototype._populatePixelPropertyValue=function(e,t,o){e[t]&&this._populatePropertyValue(e[t],o,n.pxConverter.view)},o.prototype._populateColorPropertyValue=function(e,t){e&&this._populatePropertyValue(e,t,r)},o.prototype._populateLayoutProperty=function(e,t,n,o,r){var s=n?i:a,l=t?e["Layout".concat(o)]:e[o];l&&this._populatePropertyValue(l,r,s)},o.prototype._populatePaddingProperties=function(e){this._populatePixelPropertyValue(e,"PaddingTop","paddingTop"),this._populatePixelPropertyValue(e,"PaddingBottom","paddingBottom"),this._populatePixelPropertyValue(e,"PaddingLeft","paddingLeft"),this._populatePixelPropertyValue(e,"PaddingRight","paddingRight")},o.prototype._populateAutoLayoutProperties=function(e){var t=this;["LayoutMode","LayoutDirection","LayoutAlignItems","LayoutJustifyContent","LayoutGap","LayoutOverflowX","LayoutOverflowY","LayoutWrap"].forEach((function(n){var o=e[n];o&&t._populatePropertyValue(o,n)}))},o.prototype._populateAutoLayoutChildProperties=function(e){var t=this;["FillPortions","AlignInContainer","LayoutMinHeight","LayoutMaxHeight","LayoutMinWidth","LayoutMaxWidth"].forEach((function(n){var o=e[n];o&&t._populatePropertyValue(o,n)}))},o.prototype._populateZIndexProperty=function(e){var t=e.ZIndex;t&&this._populatePropertyValue(t,"zIndex")},o.prototype._populateContentLanguage=function(e){var t=e.ContentLanguage;t&&this._populatePropertyValue(t,"contentLanguage")},o.prototype._populateBorderStyleAndWidth=function(e){var t,n={properties:e,autoFocusedBorders:this._autoFocusedBorders,renderProps:this._renderProps,updateStateFn:this._updateControlComponentState},r={context:o._updateBorderWidth,positionArgs:n},i={context:o._updateBorderStyle,positionArgs:n};this._autoPointerViewState&&(Contracts.checkObservable(e.HoverBorderColor.modelObservable),Contracts.checkObservable(e.PressedBorderColor.modelObservable)),this._autoDisabledViewState&&Contracts.checkObservable(e.DisabledBorderColor.modelObservable),this._autoPointerViewState||this._autoDisabledViewState?(t={context:o._updateBorderColorWithAutoViewState,positionArgs:{controlContext:this._controlContext,autoDisabledViewState:this._autoDisabledViewState,autoPointerViewState:this._autoPointerViewState,renderProps:this._renderProps,updateStateFn:this._updateControlComponentState}},this._autoPointerViewState&&(this._subscribe(e.HoverBorderColor.modelObservable,t),this._subscribe(e.PressedBorderColor.modelObservable,t),this._subscribe(this._controlContext.viewState.hovering,t),this._subscribe(this._controlContext.viewState.pressed,t)),this._autoDisabledViewState&&(this._subscribe(e.DisabledBorderColor.modelObservable,t),this._subscribe(this._controlContext.viewState.displayMode,t))):t={context:o._updateBorderColorWithoutAutoViewState,positionArgs:{properties:e,renderProps:this._renderProps,updateStateFn:this._updateControlComponentState}},i.context.apply(i.positionArgs),t.context.apply(t.positionArgs),this._subscribe(e.BorderStyle.modelObservable,i),this._subscribe(e.BorderThickness.modelObservable,r),this._subscribe(e.DisplayMode.modelObservable,r),this._subscribe(e.BorderColor.modelObservable,t),this._autoFocusedBorders&&(this._subscribe(e.FocusedBorderColor.modelObservable,t),this._subscribe(e.FocusedBorderThickness.modelObservable,r))},o._updateBorderWidth=function(){var t=0,o=0;"none"!==n.borderStyleConverter.view(this.properties.BorderStyle.getValue())&&this.properties.DisplayMode.getValue()!==e.Constants.DisplayMode.View&&(t=this.properties.BorderThickness.getValue()||0,o=this.autoFocusedBorders?this.properties.FocusedBorderThickness.getValue()||0:t),this.renderProps.borderWidth=n.pxConverter.view(t),this.renderProps.margin=n.pxConverter.view(-t/2),this.renderProps.borderWidthFocused=this.renderProps.borderWidth,this.renderProps.marginFocused=this.renderProps.margin,this.autoFocusedBorders&&(this.renderProps.borderWidthFocused=n.pxConverter.view(o),this.renderProps.marginFocused=n.pxConverter.view(-o/2)),this.updateStateFn({borderWidth:this.renderProps.borderWidth,borderWidthFocused:this.renderProps.borderWidthFocused,margin:this.renderProps.margin,marginFocused:this.renderProps.marginFocused})},o._updateBorderStyle=function(){this.renderProps.borderStyle=n.borderStyleConverter.view(this.properties.BorderStyle.getValue()),this.updateStateFn({borderStyle:this.renderProps.borderStyle}),o._updateBorderWidth.apply(this)},o._updateBorderColorWithAutoViewState=function(){var t="",r="",i=this.controlContext.modelProperties;this.autoDisabledViewState&&this.controlContext.viewState.displayMode()===e.Constants.DisplayMode.Disabled&&(t=n.argbConverter.view(i.DisabledBorderColor.getValue())),this.autoPointerViewState&&!t&&(this.controlContext.viewState.pressed()||this.controlContext.viewState.hovering())&&(this.controlContext.viewState.pressed()&&(t=n.argbConverter.view(i.PressedBorderColor.getValue())),t||(t=n.argbConverter.view(i.HoverBorderColor.getValue())),t&&(r=t)),t||(t=n.argbConverter.view(i.BorderColor.getValue())),this.renderProps.borderColor=t||"rgba(0, 0, 0, 1)",this.renderProps.borderColorFocused=r||o._getFocusedBorderColor(i.FocusedBorderColor,t),this.updateStateFn({borderColor:this.renderProps.borderColor,borderColorFocused:this.renderProps.borderColorFocused})},o._updateBorderColorWithoutAutoViewState=function(){var e=this.properties,t=n.argbConverter.view(e.BorderColor.getValue())||"rgba(0, 0, 0, 1)";this.renderProps.borderColor=t,this.renderProps.borderColorFocused=o._getFocusedBorderColor(e.FocusedBorderColor,t),this.updateStateFn({borderColor:this.renderProps.borderColor,borderColorFocused:this.renderProps.borderColorFocused})},o._getFocusedBorderColor=function(e,t){return e&&n.argbConverter.view(e.getValue())||t},o.prototype._populateFill=function(e){var t;this._autoPointerViewState&&(Contracts.checkObservable(e.PressedFill.modelObservable),Contracts.checkObservable(e.HoverFill.modelObservable)),this._autoDisabledViewState&&Contracts.checkObservable(e.DisabledFill.modelObservable),this._autoPointerViewState||this._autoDisabledViewState?(t={context:o._updateFillColorWithAutoViewState,positionArgs:{controlContext:this._controlContext,autoDisabledViewState:this._autoDisabledViewState,autoPointerViewState:this._autoPointerViewState,renderProps:this._renderProps,updateStateFn:this._updateControlComponentState}},this._autoPointerViewState&&(this._subscribe(e.HoverFill.modelObservable,t),this._subscribe(e.PressedFill.modelObservable,t),this._subscribe(this._controlContext.viewState.pressed,t),this._subscribe(this._controlContext.viewState.hovering,t)),this._autoDisabledViewState&&(this._subscribe(e.DisabledFill.modelObservable,t),this._subscribe(this._controlContext.viewState.displayMode,t))):t={context:o._updateFillColorWithoutAutoViewState,positionArgs:{properties:e,renderProps:this._renderProps}},t.context.apply(t.positionArgs),this._subscribe(e.Fill.modelObservable,t)},o._updateFillColorWithAutoViewState=function(){var t="",o=this.controlContext.viewState,r=o.displayMode()===e.Constants.DisplayMode.View,i=this.controlContext.modelProperties;r&&(t=n.argbConverter.view(i.Fill.getValue())),this.autoDisabledViewState&&o.displayMode()===e.Constants.DisplayMode.Disabled&&(t=n.argbConverter.view(i.DisabledFill.getValue())),!this.autoPointerViewState||r||t||(o.pressed()?t=n.argbConverter.view(i.PressedFill.getValue()):o.hovering()&&(t=n.argbConverter.view(i.HoverFill.getValue()))),t||(t=n.argbConverter.view(i.Fill.getValue())),this.renderProps.fill=t||"rgba(0, 0, 0, 1)",this.updateStateFn({fill:this.renderProps.fill})},o._updateFillColorWithoutAutoViewState=function(){this.renderProps.fill=n.argbConverter.view(this.properties.Fill.getValue())||"rgba(0, 0, 0, 1)"},o.prototype._populateColor=function(e){var t;this._controlContext.modelProperties.Color&&(t={context:o._updateColor,positionArgs:{controlContext:this._controlContext,renderProps:this._renderProps,updateStateFn:this._updateControlComponentState}},this._renderProps.autoPointerViewState&&this._controlContext.viewState&&(this._controlContext.modelProperties.PressedColor&&(Contracts.checkObservable(e.PressedColor.modelObservable),this._subscribe(e.PressedColor.modelObservable,t),this._subscribe(this._controlContext.viewState.pressed,t)),this._controlContext.modelProperties.HoverColor&&(Contracts.checkObservable(e.HoverColor.modelObservable),this._subscribe(e.HoverColor.modelObservable,t),this._subscribe(this._controlContext.viewState.hovering,t))),this._renderProps.autoDisabledViewState&&this._controlContext.modelProperties.DisabledColor&&(Contracts.checkObservable(e.DisabledColor.modelObservable),this._subscribe(e.DisabledColor.modelObservable,t),this._subscribe(this._controlContext.viewState.displayMode,t)),t.context.apply(t.positionArgs),this._subscribe(e.Color.modelObservable,t))},o._updateColor=function(){var t="",o=this.controlContext.modelProperties;this.renderProps.autoDisabledViewState&&o.DisabledColor&&this.controlContext.viewState.displayMode()===e.Constants.DisplayMode.Disabled&&(t=n.argbConverter.view(o.DisabledColor.getValue())),!t&&this.renderProps.autoPointerViewState&&(o.PressedColor&&this.controlContext.viewState.pressed()?t=n.argbConverter.view(o.PressedColor.getValue()):o.HoverColor&&this.controlContext.viewState.hovering()&&(t=n.argbConverter.view(o.HoverColor.getValue()))),t||(t=n.argbConverter.view(o.Color.getValue())),this.renderProps.color=t||"rgba(0, 0, 0, 1)",this.updateStateFn({color:this.renderProps.color})},Object.defineProperty(o.prototype,"_parentControl",{get:function(){return null===this._parentControlReference&&(this._parentControlReference=OpenAjax.widget.byId(this._parentControlDisplayName)),this._parentControlReference},enumerable:!1,configurable:!0}),o.prototype._isLayoutManagedByParentControl=function(){return!!this._parentControl&&(Core.Utility.isFunction(this._parentControl.managesChildrenLayout)&&this._parentControl.managesChildrenLayout())},o}();function r(e){return n.argbConverter.view(e)||"rgba(0, 0, 0, 1)"}function i(e){return n.pxHorizontalConverter.view(e||0)}function a(e){return n.pxVerticalConverter.view(e||0)}t.ControlReactRenderManager=o}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=function(){function t(e,t){this._control=e,this._controlInfo=t,this._controlContextToRenderManagerMap=new Map}return t.prototype.getRenderManager=function(e){var t;return this._controlContextToRenderManagerMap.has(e)?t=this._controlContextToRenderManagerMap.get(e):(t=this._createRenderManager(this._control,this._controlInfo,e),this._controlContextToRenderManagerMap.set(e,t)),t.updateControlName(this._controlInfo.displayName),t},t.prototype.disposeRenderManager=function(e){this._controlContextToRenderManagerMap.has(e)&&(this._controlContextToRenderManagerMap.get(e).dispose(),this._controlContextToRenderManagerMap.delete(e))},t.prototype.dispose=function(){this._controlContextToRenderManagerMap.forEach((function(e){return e.dispose()})),this._controlContextToRenderManagerMap.clear()},t.prototype._createRenderManager=function(t,n,o){return new e.ControlReactRenderManager(this._control,this._controlInfo,o)},t}();e.ControlReactRenderDataStore=t}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=function(n){function o(){var e=n.call(this)||this;e.managerId="globalContextManager";var t=e.newBindingContext(null,null,"root",!0);return o._rootBindingContext=t,e.authoringAreaBindingContext=t,e._createComponentContexts(t),e}return __extends(o,n),o.prototype.getControlWidget=function(){return null},o.prototype.forEachManagedDescendingBindingContext=function(e,t){!function e(n){t(n),n.componentBindingContexts.forEach((function(t){return t.rcManager.forEachManagedDescendingBindingContext(t,e)}))}(e)},o.prototype.notifyBindingContextSelectionInteraction=function(e,t){return!1},o.prototype.addSelectionChangedListener=function(e,t){},o.prototype._addControlWidgetClassSpecific=function(e){t.ContextManager.allocateControlContext(o.bindingContext,e),t.ContextManager.initializeControlContext(o.bindingContext,e),this._isControlWidgetPartOfAnyComponent(e)&&t.ContextManager.forAllComponentBindingContexts((function(t){return t.addControlWidget(e)})),o.bindingContext.componentBindingContexts.createComponentBindingContext(e)},o.prototype._updateControlIdClassSpecific=function(e,n){this.renameControlInBindingContext(o.bindingContext,e,n),(this._isControlNamePartOfAnyComponent(e)||this._isControlNamePartOfAnyComponent(n))&&t.ContextManager.forAllComponentBindingContexts((function(t){return t.updateControlId(e,n)})),o.bindingContext.componentBindingContexts.renameComponentBindingContext(e,n)},o.prototype._removeControlWidgetClassSpecific=function(e){this.removeControlFromBindingContext(o.bindingContext,e),t.ContextManager.forAllComponentBindingContexts((function(t){return t.removeControlWidget(e)})),o.bindingContext.componentBindingContexts.disposeComponentBindingContext(e)},o.prototype._isControlNamePartOfAnyComponent=function(e){var t=OpenAjax.widget.byId(e);return t&&this._isControlWidgetPartOfAnyComponent(t.OpenAjax)},o.prototype._isControlWidgetPartOfAnyComponent=function(t){var n,o;if(e.Utility.isComponent(t.template.className))return!0;var r=t&&(null===(o=null===(n=OpenAjax.widget.controlManager)||void 0===n?void 0:n.getControlInstanceById(t.topParentOrSelfUniqueId))||void 0===o?void 0:o.control);return r&&e.Utility.isComponent(r.OpenAjax.template.className)},Object.defineProperty(o,"bindingContext",{get:function(){return this._rootBindingContext},enumerable:!1,configurable:!0}),Object.defineProperty(o,"instance",{get:function(){return this._globalInstance},enumerable:!1,configurable:!0}),o._globalInstance=new o,o}(t.ContextManager);t.GlobalContextManager=n}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=function(){function t(){}return t.init=function(n,o,r,i,a){var s=o(),l=ko.utils.unwrapObservable(s),c=s.subscribe((function(e){null===e&&(e=""),e!==l&&(l=e,t._onTextUpdated(n,l))}));t._onTextUpdated(n,l);var p=a.$root.controlWidget;if(p.allowsPerCharacterFormatting&&(i.onTagsChangedFn=function(){p.tagsManager.hasTags()&&(e.Services.hasHtml(n.textContent)||WinJS.Utilities.setInnerHTMLUnsafe(n,p.tagsManager.getHTMLForText(i,n.textContent)))}),p.tagsManager&&p.tagsManager.hasTags()){if(e.Services.hasHtml(n.textContent))return;WinJS.Utilities.setInnerHTMLUnsafe(n,p.tagsManager.getHTMLForText(i,n.textContent))}ko.utils.domNodeDisposal.addDisposeCallback(n,(function(){c.dispose(),i.onTagsChangedFn=null}))},t.getInlineElementRelativePosition=function(e){var t=e.parentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return{height:n.height,width:n.width,left:n.left-t.left,top:n.top-t.top}},t._onTextUpdated=function(e,t){null===t&&(t=""),e.innerText=t},t}();t.PublishedAppInlineEditText=n,Core.Environment.isAuthoringTool()||(ko.bindingHandlers.inlineEditText=n)}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=function(){function e(e,t,n,o){this._left=ko.observable(e),this._top=ko.observable(t),this._width=ko.observable(n),this._height=ko.observable(o)}return Object.defineProperty(e.prototype,"left",{get:function(){return this._left},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this._top},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),e.prototype.setBounds=function(e,t,n,o){this._left(e),this._top(t),this._width(n),this._height(o)},e}();e.ObservableRectangle=t}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){var t=function(){function e(){this._controlManager=null}return e.prototype.setControlManager=function(e){this._controlManager=e},Object.defineProperty(e.prototype,"controlManager",{get:function(){return this._controlManager},enumerable:!1,configurable:!0}),e.prototype.byId=function(e){if("string"!=typeof e)throw this.Error.BadParameters;if(null===this._controlManager)return null;var t=this._controlManager.getControl(e);return void 0!==t?t:null},Object.defineProperty(e.prototype,"Error",{get:function(){return{Inactive:"OpenAjax.widget.Error.Inactive",BadParameters:"OpenAjax.widget.Error.BadParameters"}},enumerable:!1,configurable:!0}),e}();e.Widget=t,e.widget=new t}(OpenAjax||(OpenAjax={})),function(e){!function(t){!function(n){var o=this,r="/openSource/modified/pcfplatformlibs/fluent_9_4_0.js",i=e.Runtime.App;n.loadRequirements=function(e,t){return __awaiter(o,void 0,void 0,(function(){var n,o,r,s,l,c,p,u,d,h;return __generator(this,(function(C){switch(C.label){case 0:if(n="PlatformLibrary.loadRequirements",!(o=null===(d=e.resource)||void 0===d?void 0:d.split("/"))||3!==o.length)return[3,11];if(r=o[0],s=o[1],l=o[2],!r)return Core.Log.warningEx(n,"Empty platform library name provided."),[2];if(!l)return Core.Log.warningEx(n,"Platform library ".concat(r," is using invalid version ").concat(s)),[2];switch(r.toLowerCase()){case"react":return[3,1];case"fluent":return[3,2]}return[3,10];case 1:return[3,11];case 2:return Core.FeatureGates.controls.enablePreloadPlatformLibrariesAndUberWrapper&&(c=i.getPlatformLibraryWindowAlias(i.PlatformLibrarySupportedVersions.fluentV9),"8.29.0"!==l&&(null===(h=window[c])||void 0===h?void 0:h.FluentProvider))?[2]:(p={requirementPlatform:Microsoft.AppMagic.Authoring.Publish.PlatformTarget.all,requirementType:Microsoft.AppMagic.Authoring.ControlRequirementType.javaScript,resource:"8.29.0"===l?"/openSource/modified/fluentui-react/8.29.0/fluentui-react.min.js":"/openSource/modified/pcfplatformlibs/fluent_".concat(l.replace(/\./g,"_"),".js"),shouldInclude:!0},Core.FeatureGates.controls.enablePreloadPlatformLibrariesAndUberWrapper?(u=a())?[4,u.loadRequirement(p)]:[3,4]:[3,7]);case 3:return C.sent(),[3,6];case 4:return[4,t(p)];case 5:C.sent(),C.label=6;case 6:return[3,9];case 7:return[4,t(p)];case 8:C.sent(),C.label=9;case 9:return[3,11];case 10:Core.Log.warningEx(n,"Platform library ".concat(r," is not supported.")),C.label=11;case 11:return[2]}}))}))},n.injectIntoDOM=function(t,n){return __awaiter(o,void 0,void 0,(function(){var o,s,l,c;return __generator(this,(function(p){switch(p.label){case 0:return o="PlatformLibrary.injectIntoDOM",Core.Utility.isEmpty(window[i.getPlatformLibraryWindowAlias(t)])?[3,1]:(Core.Log.warningEx(o,"Platform library ".concat(t," already injected into the DOM.")),[3,9]);case 1:switch(t){case i.PlatformLibrarySupportedVersions.fluentV9:return[3,2]}return[3,8];case 2:return s={requirementPlatform:Microsoft.AppMagic.Authoring.Publish.PlatformTarget.all,requirementType:Microsoft.AppMagic.Authoring.ControlRequirementType.javaScript,resource:r,shouldInclude:!0},(l=a())?[4,l.loadRequirement(s)]:[3,4];case 3:return p.sent(),[3,7];case 4:return Core.Log.warningEx(o,"Not able to get singleton of AppMagic.Controls.RequirementsManager."),[4,e.Controls.RequirementsManager.resolveResourcePathAsync(r)];case 5:return c=p.sent(),[4,Core.UI.Utility.DomHelper.injectScript(c,n)];case 6:p.sent(),p.label=7;case 7:return[3,9];case 8:Core.Log.warningEx(o,"Platform library ".concat(t," was not found for the injection into DOM.")),p.label=9;case 9:return[2]}}))}))};var a=function(){return Core.Loader.ObjectFactory.instance.getSingleton(t.RequirementsManager.singletonKey)}}(t.PlatformLibrary||(t.PlatformLibrary={}))}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=function(){function n(){this.retainPreloadRequirementsAfterEnsured_TestOnly=!1,this._injectionCache=HashTableUtility.create(),this._preloadRequirements=[]}return Object.defineProperty(n.prototype,"preloadRequirements",{set:function(e){this._preloadRequirements=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"preloadRequirementsLength_TestOnly",{get:function(){var e,t;return null!==(t=null===(e=this._preloadRequirements)||void 0===e?void 0:e.length)&&void 0!==t?t:0},enumerable:!1,configurable:!0}),n.prototype.ensurePreloadRequirements=function(){var e;(null===(e=this._preloadRequirements)||void 0===e?void 0:e.length)>0&&(this.ensureRequirements(this._preloadRequirements),this.retainPreloadRequirementsAfterEnsured_TestOnly||(this._preloadRequirements=[]))},n.prototype.ensureRequirements=function(e){return __awaiter(this,void 0,void 0,(function(){var n,o,r,i,a,s,l,c=this;return __generator(this,(function(p){switch(p.label){case 0:Contracts.checkValue(e),Array.isArray(e)?n=e.length:"object"==typeof e&&("number"==typeof e.length?n=e.length:"number"==typeof e.size&&(n=e.size)),Contracts.checkNumber(n,"The requirements parameter must contain a length or a size"),o=this._getUserLcidForLocalePageRequirements(e,n),r=[],i=[Promise.resolve()],a=function(n){var a;return __generator(this,(function(l){switch(l.label){case 0:return(a=e[n]).requirementType!==Microsoft.AppMagic.Authoring.ControlRequirementType.platformLibrary?[3,2]:[4,t.PlatformLibrary.loadRequirements(a,s.loadRequirement.bind(s))];case 1:return l.sent(),[3,3];case 2:s._shouldInclude(a,o)&&(a.requirementType===Microsoft.AppMagic.Authoring.ControlRequirementType.javaScript?Core.Environment.isWebAuthoring()?i.push(s.loadRequirement(a)):i[0]=i[0].then((function(){return c.loadRequirement(a)})):r.push(s.loadRequirement(a))),l.label=3;case 3:return[2]}}))},s=this,l=0,p.label=1;case 1:return l<n?[5,a(l)]:[3,4];case 2:p.sent(),p.label=3;case 3:return l++,[3,1];case 4:return[2,Core.PromiseUtils.joinIgnoreResultsAsync(__spreadArray(__spreadArray([],i,!0),r,!0))]}}))}))},n.prototype.loadRequirement=function(e){return __awaiter(this,void 0,void 0,(function(){var t,o,r;return __generator(this,(function(i){switch(i.label){case 0:return Contracts.checkValue(e),Contracts.checkValue(e.resource,"When calling loadRequirements, the 'req' parameter object must contain a resource element"),Contracts.checkNumber(e.requirementType,"When calling loadRequirements, the 'req' parameter object must contain a valid requirementType element"),Core.Environment.isRuntimeCapabilityEnabled("OffloadRequirements")?[2,Promise.resolve()]:[4,n.resolveResourcePathAsync(e.resource)];case 1:if(t=i.sent(),this._injectionCache[t])return[2,this._injectionCache[t]];switch(e.requirementType){case Microsoft.AppMagic.Authoring.ControlRequirementType.javaScript:o=function(){return Core.UI.Utility.DomHelper.injectScript(t)};break;case Microsoft.AppMagic.Authoring.ControlRequirementType.css:o=function(){return Core.UI.Utility.DomHelper.injectCss(t)};break;case Microsoft.AppMagic.Authoring.ControlRequirementType.markup:o=function(){return Core.UI.Utility.DomHelper.injectMarkup(t)};break;case Microsoft.AppMagic.Authoring.ControlRequirementType.localePage:o=function(){return Core.UI.Utility.DomHelper.injectPreloadFetch(t)};break;default:Contracts.check(!1,["Unknown requirement type '",e.requirementType,"' encountered."].join(""))}return o?(r=Core.Utility.performTaskWithRetries(o).catch((function(n){return Core.PromiseUtils.throwIfCanceled(n),Core.Log.errorEx("RequirementsManager.loadRequirement",{error:n,eventData:{requirementType:e.requirementType,resource:e.resource,resolvedResource:Core.Telemetry.Utility.scrubSensitiveDataSafe(t)}}),Promise.reject(n)})),this._injectionCache[t]=r,[2,r]):[2,Core.PromiseUtils.throwAsync(new Error("The requirementManager class was called incorrectly"))]}}))}))},n.resolveResourcePathAsync=function(t){return __awaiter(this,void 0,void 0,(function(){var n;return __generator(this,(function(o){return(n=e.Runtime.App.PublishedAppLoader.tryGetInstance())?n.resolveAppAssetPathWithCallback?[2,new Promise((function(e){n.resolveAppAssetPathWithCallback(t,e)}))]:[2,n.resolveAppAssetPath(t)]:"object"==typeof window&&null!==window&&window.ResourceLoader&&window.ResourceLoader.mapResourceUrl instanceof Function?[2,Core.Utility.getAbsoluteUri(t)]:[2,t]}))}))},n.prototype._shouldInclude=function(e,t){if(Contracts.checkValue(e),e.authoringOnly||!e.shouldInclude)return!1;if("number"==typeof e.requirementPlatform){if(WinJS.Utilities.hasWinRT)return 0!=(e.requirementPlatform&Microsoft.AppMagic.Authoring.Publish.PlatformTarget.winJS);var n=Microsoft.AppMagic.Authoring.Publish.PlatformTarget.player|Microsoft.AppMagic.Authoring.Publish.PlatformTarget.playerLocal|Microsoft.AppMagic.Authoring.Publish.PlatformTarget.web;return 0!=(e.requirementPlatform&n)}return e.requirementType!==Microsoft.AppMagic.Authoring.ControlRequirementType.localePage||this._getLocalePageRequirementLcid(e)===t},n.prototype._getUserLcidForLocalePageRequirements=function(e,t){Contracts.checkValue(e),Contracts.checkNumber(t);for(var n=Core.Globalization.LanguageValidation.validateAndGetLocalizedLanguage(Core.Globalization.currentCulture().language),o="".concat(Core.Globalization.lcidmap[n]),r=0;r<t;r++){var i=e[r];if(i.requirementType===Microsoft.AppMagic.Authoring.ControlRequirementType.localePage)if(this._getLocalePageRequirementLcid(i)===o)return o}return"1033"},n.prototype._getLocalePageRequirementLcid=function(e){var t;Contracts.checkValue(e),Contracts.checkStrictEqual(e.requirementType,Microsoft.AppMagic.Authoring.ControlRequirementType.localePage);var n=null===(t=e.resource)||void 0===t?void 0:t.split("?")[0].split(".'");return(null==n?void 0:n[n.length-2])||null},__decorate([initializeOnLoad((function(){return Core.Loader.TypeKey.createFromClass(n)}))],n,"singletonKey",void 0),n}();t.RequirementsManager=n}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=function(){function e(e,t){this._start=e,this._limit=t}return Object.defineProperty(e.prototype,"start",{get:function(){return this._start},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"limit",{get:function(){return this._limit},enumerable:!1,configurable:!0}),e}();e.SpanTag=t}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=function(){function n(){this._tags=[]}return n.prototype.hasTags=function(){return this._tags.length>0},Object.defineProperty(n.prototype,"getTags",{get:function(){return this._tags},enumerable:!1,configurable:!0}),n.prototype.addTag=function(n,o,r,i){var a=r.start,s=r.start+r.length,l=new t.SpanTag(a,s),c=this._tags.length,p=i?"script":"value",u={},d={};if(d[p]=o,u[n]=d,0!==c){var h=this._getOverlappingTagIndices(a,s),C=h.length;if(0!==C){for(var g=0,m=!1,f=0;f<C;f++){P=h[f]+g;var y=this._tags[P],_=y.tag.start,v=y.tag.limit;if(a===_&&s===v){this._tags[P].propertyNameMap[n]?this._tags[P].propertyNameMap[n][p]=o:this._tags[P].propertyNameMap[n]=e.Utility.clone(d,!0),m=!0;break}var b=e.Utility.clone(y.propertyNameMap,!0),x=e.Utility.clone(y.propertyNameMap,!0);if(x[n]=e.Utility.clone(d,!0),a<=_){if(!(s>=v)){this._tags[P].tag=new t.SpanTag(_,s),this._tags[P].propertyNameMap=x,this._tags.splice(P+1,0,{tag:new t.SpanTag(s,v),propertyNameMap:b}),a<_?s=_:m=!0;break}if(a<_&&(this._tags.splice(P,0,{tag:new t.SpanTag(a,_),propertyNameMap:e.Utility.clone(u,!0)}),g++,P++),this._tags[P].tag=new t.SpanTag(_,v),this._tags[P].propertyNameMap=x,s===v){m=!0;break}a=v}else{if(this._tags[P].tag=new t.SpanTag(_,a),!(s>v)){this._tags.splice(P+1,0,{tag:new t.SpanTag(a,s),propertyNameMap:x}),s<v&&this._tags.splice(P+2,0,{tag:new t.SpanTag(s,v),propertyNameMap:e.Utility.clone(b,!0)}),m=!0;break}this._tags.splice(P+1,0,{tag:new t.SpanTag(a,v),propertyNameMap:x}),g++,a=v}}if(!m){P=this._getinsertionIndex(a);this._tags.splice(P,0,{tag:new t.SpanTag(a,s),propertyNameMap:e.Utility.clone(u,!0)})}}else{var P=this._getinsertionIndex(a);this._tags.splice(P,0,{tag:l,propertyNameMap:u})}}else this._tags.push({tag:l,propertyNameMap:u})},n.prototype._getOverlappingTagIndices=function(e,t){var n=this._tags.length,o=[];if(n<=0)return o;for(var r=0;r<n;r++){var i=this._tags[r].tag,a=i.start,s=i.limit;if(t<=a)break;(e<=a&&t>=s||e>=a&&e<s||t>a&&t<=s)&&o.push(r)}return o},n.prototype._getinsertionIndex=function(e){for(var t=this._tags.length,n=0;n<t;n++)if(e<this._tags[n].tag.start)return n;return t},n.prototype._removeIfSameProperty=function(t,n){var o=n.length;if(0===o)return!1;for(var r={},i=0;i<o;i++){var a=Object.keys(this._tags[n[i]].propertyNameMap);1===a.length&&a[0]===t?r[n[i]]=!0:delete this._tags[n[i]].propertyNameMap[t]}return e.Utility.removeItemsFromArray(this._tags,r),!0},n.prototype.updateTagsValuesForProperty=function(n,o,r){for(var i=o.length,a=this._getTagIndicesForProperty(n),s={},l=0;l<i;l++)for(var c=o[l],p=0;p<a.length;p++){var u=this._tags[a[p]].tag;if(c.start===u.start&&c.limit===u.limit){this.addTag(n,r[l],new t.TextSelection(c.start,c.limit-c.start),!1),s[l]=!0,a.splice(p,1);break}}e.Utility.removeItemsFromArray(o,s),e.Utility.removeItemsFromArray(r,s),this._removeIfSameProperty(n,a);for(l=0;l<o.length;l++){c=o[l];this.addTag(n,r[l],new t.TextSelection(c.start,c.limit-c.start),!1)}},n.prototype.getTagsForProperty=function(e){for(var t=[],n=this._tags.length,o=0;o<n;o++){var r=this._tags[o];r.propertyNameMap[e]&&t.push(r)}return t},n.prototype.getSelectionTagValuesForProperty=function(e,t){var n=[],o=t.start,r=o+t.length,i=this._getOverlappingTagIndices(o,r),a=i.length,s=!0;if(0===a)return n;var l=this._tags[i[0]].tag,c=this._tags[i[a-1]].tag,p=this._tags[i[0]].propertyNameMap[e];if(l.start>o||c.limit<r)return n;if(!p)return n;n.push(p.value);for(var u=1;u<a;u++){var d=this._tags[i[u]].tag,h=d.start;if(r<=h)break;if(!(p=this._tags[i[u]].propertyNameMap[e])||h!==l.limit){s=!1;break}n.push(p.value),l=d}return s?n:[]},n.prototype._getTagIndicesForProperty=function(e){for(var t=[],n=this._tags.length,o=0;o<n;o++){this._tags[o].propertyNameMap[e]&&t.push(o)}return t},n.prototype.getTagsContextForDocument=function(e){for(var t=[],n=Object.keys(e),o=0,r=n.length;o<r;o++){for(var i=[],a=n[o],s=e[a],l=this._getTagIndicesForProperty(s),c=0,p=l.length;c<p;c++){var u=l[c],d={start:this._tags[u].tag.start,limit:this._tags[u].tag.limit},h=this._tags[u].propertyNameMap[s].script;h||(h=""),i.push(new Microsoft.AppMagic.Authoring.TaggedScriptContext(a,h,JSON.stringify(d)))}i.length>0&&t.push(i)}return t},n.prototype.clearTagsForProperty=function(e){return this._removeIfSameProperty(e,this._getTagIndicesForProperty(e))},n.prototype.getHTMLForText=function(t,n){var o=t.controlWidget,r=n.length,i=this._tags.length;if(0===r||0===i||r<this._tags[i-1].tag.limit)return this._replaceSpaceAndLineBreakWithHTMLTag(n);for(var a="",s=0,l=0;l<i;l++){var c=this._tags[l],p=c.tag,u=c.propertyNameMap;a+=this._replaceSpaceAndLineBreakWithHTMLTag(n.substring(s,p.start)),s=p.limit;for(var d=this._replaceSpaceAndLineBreakWithHTMLTag(n.substring(p.start,p.limit)),h=Object.keys(u),C="",g=0,m=h.length;g<m;g++){var f=h[g],y=o.controlProperties[f];if(u[f].value){var _=y.checkAndConstrainPropertyValue(t,f,u[f].value);switch(f){case"Font":C+=" font-family:"+e.Controls.converters.fontConverter.view(_)+";";break;case"Size":C+=" font-size:"+e.Controls.converters.ptConverter.view(_)+";";break;case"Color":C+=" color:"+e.Controls.converters.argbConverter.view(_)+";";break;case"FontWeight":C+=" font-weight:"+_+";";break;case"Fill":C+=" background-color:"+e.Controls.converters.argbConverter.view(_)+";";break;case"Strikethrough":_&&(d="<strike>"+d+"</strike>");break;case"Underline":_&&(d="<u>"+d+"</u>");break;case"Italic":C+=_?" font-style: italic;":" font-style: normal;"}}}""!==C&&(d='<span style="'+C+'">'+d+"</span>"),a+=d}return a+=this._replaceSpaceAndLineBreakWithHTMLTag(n.substring(this._tags[i-1].tag.limit,r))},n.prototype._replaceSpaceAndLineBreakWithHTMLTag=function(e){return e.replace(/ /g,"&nbsp;").replace(/\r?\n/g,"<br/>")},n.prototype.updateScriptFromDocument=function(e,n,o){var r=JSON.parse(e),i=this._getOverlappingTagIndices(r.start,r.limit),a=i.length;if(0===a)return this.addTag(n,o,new t.TextSelection(r.start,r.limit-r.start),!0),!0;var s=i[0];if(this._tags[s].tag.start!==r.start||this._tags[i[a-1]].tag.limit!==r.limit)return!1;for(var l=0;l<a;l++,s++){var c=i[l],p=this._tags[c].propertyNameMap[n];if(void 0===p||c!==s)return!1;p.script=o}return!0},n.prototype.removeTagsInRange=function(n,o){if(!(o<=0)){for(var r=this._tags.length,i=n+o,a=0,s={};a<r;a++){var l=(u=(p=this._tags[a]).tag).start,c=u.limit;if(i<=l)break;if(!(n>=c))if(n>l){if(i>=c){p.tag=new t.SpanTag(l,n);continue}if(i<c){p.tag=new t.SpanTag(l,c-o),a++;break}}else if(n<=l){if(i>=c){s[a]=!0;continue}if(i<c){p.tag=new t.SpanTag(i,c);break}}}for(;a<r;a++){var p,u=(p=this._tags[a]).tag;p.tag=new t.SpanTag(u.start-o,u.limit-o)}e.Utility.removeItemsFromArray(this._tags,s)}},n.prototype.updateTagsForRange=function(e,n){if(!(n<=0)){for(var o=this._tags.length,r=0;r<o;r++){var i=(l=(s=this._tags[r]).tag).start,a=l.limit;if(!(e>a)){if(e<=i)break;if(e>i&&e<=a){s.tag=new t.SpanTag(i,a+n),r++;break}}}for(;r<o;r++){var s,l=(s=this._tags[r]).tag;s.tag=new t.SpanTag(l.start+n,l.limit+n)}}},n}();t.SpanTagsManager=n}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=function(){function e(e,t){this._start=e,this._length=t}return Object.defineProperty(e.prototype,"start",{get:function(){return this._start},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:!1,configurable:!0}),e}();e.TextSelection=t}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n;!function(e){e.BorderInnerClassName="appmagic-border-inner",e.BorderFillClassName="appmagic-borderfill-container",e.HoverFillClassName="appmagic-hoverFill",e.PressedFillClassName="appmagic-pressedFill"}(n=t.ControlRenderConstants||(t.ControlRenderConstants={}));var o=function(){function t(t,n,o,r){var i=this;this.hovering=ko.observable(!1),this.pressed=ko.observable(!1),this.isAutoDisabled=ko.observable(!1),this.displayMode=ko.pureComputed((function(){var r=i.isAutoDisabled(),a=t.properties.DisplayMode();return n(t)||r||a===e.Constants.DisplayMode.Disabled?e.Constants.DisplayMode.Disabled:o(t)?e.Constants.DisplayMode.View:null!==a?a:e.Constants.DisplayMode.Edit})),this.pointerEventType=ko.observable(""),this._container=r}return t.prototype._onPointerDown=function(e){Contracts.checkObject(e),this.pointerEventType(e.type),this.pressed(!0)},t.prototype._onPointerUp=function(e){Contracts.checkObject(e),this.pointerEventType(e.type),this.pressed(!1)},t.prototype._onPointerOver=function(e){Contracts.checkObject(e),this.pointerEventType(e.type),"touch"!==e.pointerType&&this.hovering(!0)},t.prototype._onPointerOut=function(e){Contracts.checkObject(e),this.pointerEventType(e.type),"touch"!==e.pointerType&&this.hovering(!1),this.pressed(!1)},t.prototype._transitionEnd=function(e){this._container.parentElement&&this._container.parentElement.classList&&(this._container.parentElement.classList.remove(n.HoverFillClassName),this._container.parentElement.classList.remove(n.PressedFillClassName))},t.prototype.dispose=function(){this.hovering=null,this.pressed=null,this.displayMode.dispose(),this.displayMode=null,this.isAutoDisabled=null,this.pointerEventType=null,this._container=null},t}();t.ViewState=o}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=function(){function e(e,t,n,o,r,i){this.controlId=e,this.accessibilityId=t,this.parentControlId=n,this.parentAccessibilityId=o,this.x=r,this.y=i,this.preferYAxisTabIndex=!0}return e.prototype.dispose=function(){},e}();e.ControlAccessibilityBase=t;var n=function(e){function t(t,n,o,r,i,a,s,l){var c=e.call(this,t,n,o,r,i,a)||this;return c.tabIndex=s,c.zIndex=l,c.assignedTabIndex=-1,c}return __extends(t,e),Object.defineProperty(t.prototype,"tabIndex",{get:function(){return this._tabIndex},set:function(e){this._tabIndex=Math.max(-1,e)},enumerable:!1,configurable:!0}),t}(t);e.ControlAccessibilityItemBase=n;var o=function(e){function t(t,n,o,r,i,a,s,l,c){var p=e.call(this,t,n,o,r,i,a,l,c)||this;return p._elements=Array.isArray(s)?s:[s],p}return __extends(t,e),Object.defineProperty(t.prototype,"elements",{get:function(){return this._elements},set:function(e){this._elements=e},enumerable:!1,configurable:!0}),t.prototype.setFocus=function(){throw new Error("Not implemented.")},t.prototype.dispose=function(){this._elements=null,e.prototype.dispose.call(this)},t}(n);e.ControlAccessibilityItem=o;var r=function(e){function t(t,n,o,r,i,a,s,l,c,p){var u=e.call(this,t,n,o,r,i,a,s,l)||this;return u._tabIndexUpdateCallback=c,u._setFocusCallback=p,u}return __extends(t,e),Object.defineProperty(t.prototype,"tabIndexUpdateCallback",{get:function(){return this._tabIndexUpdateCallback},enumerable:!1,configurable:!0}),t.prototype.setFocus=function(){return!!this._setFocusCallback&&this._setFocusCallback()},t.prototype.dispose=function(){this._tabIndexUpdateCallback=null,e.prototype.dispose.call(this)},t}(n);e.ReactControlAccessibilityItem=r;var i=function(t){function n(e,n,o,r,i,a,s,l,c){var p,u,d,h=this;if(h=t.call(this,e,n,o,r,i,a)||this,l){var C=l.tabIndex,g=l.callback;h._tabIndex=0===C||C>0?C:-1,h._tabIndexUpdateCallback=g}return h.preferYAxisTabIndex=s,h._children=[],h._isResponsiveContainer=null!==(p=null==c?void 0:c.isResponsiveContainer)&&void 0!==p&&p,h.childTabPriority=null===(u=null==c?void 0:c.childTabPriority)||void 0===u||u,h.enableChildFocus=null===(d=null==c?void 0:c.enableChildFocus)||void 0===d||d,h}return __extends(n,t),Object.defineProperty(n.prototype,"tabIndexUpdateCallback",{get:function(){return this.isFocusable()?this._tabIndexUpdateCallback:Core.Utility.noOpFn},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tabIndex",{get:function(){if(this.isFocusable())return this._tabIndex;if(e.improvedTabStopBehaviorEnabled)return 0;var t=this.children;if(!t||0===t.length)return 0;var n=t.map((function(e){return e.tabIndex}));if(n.every((function(e){return e<0})))return-1;var o=n.filter((function(e){return e>0}));return 0===o.length?0:Math.min.apply(Math,o)},set:function(e){this.isFocusable()&&(this._tabIndex=e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isResponsiveContainer",{get:function(){return this._isResponsiveContainer},enumerable:!1,configurable:!0}),n.prototype.dispose=function(){this._children=null,this._tabIndexUpdateCallback=null,t.prototype.dispose.call(this)},n.prototype.isFocusable=function(){return!Core.Utility.isNullOrUndefined(this._tabIndex)&&!Core.Utility.isNullOrUndefined(this._tabIndexUpdateCallback)},n}(t);e.ControlAccessibilityContainer=i}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=["a","area","audio","button","embed","input","link","object","select","source","textarea","track","video"],o=function(){function o(){}return Object.defineProperty(o,"tabIndexesDisabled",{get:function(){return o._disableTabIndexes},enumerable:!1,configurable:!0}),o.setDisableTabIndexes=function(e){o._disableTabIndexes!==e&&(o._disableTabIndexes=e,Core.Tasks.schedule(o._assignTabIndexesAfterDisableChange,"AccessibilityManager.setDisableTabIndexes"))},o.registerItem=function(e){o._itemIdToItemMap.has(e.accessibilityId)||(o._addItem(e),o._itemIdToItemMap.set(e.accessibilityId,e),o._scheduleReorder())},o.unregisterItem=function(e){o._itemIdToItemMap.has(e.accessibilityId)&&(o._removeItem(e),e.assignedTabIndex=-1,i(e)&&e.elements.forEach((function(e){o._assignItemElementTabIndex(e,-1)})),o._itemIdToItemMap.delete(e.accessibilityId))},o.registerContainer=function(e){if(!o._containerMap.has(e.accessibilityId)){o._addItem(e),o._containerMap.set(e.accessibilityId,e);var t=o.managedElements.slice(0);o._checkElementsForMismatchedParent(t,e);var n=o._itemContainerMap.get(e.accessibilityId);if(n){var r=n.children.slice(0);o._checkElementsForMismatchedParent(r,e)}o._scheduleReorder()}},o.unregisterContainer=function(e){o._containerMap.has(e.accessibilityId)&&(e.children.slice(0).forEach(o._unregisterElement),o._removeItem(e),o._containerMap.delete(e.accessibilityId))},o.unregisterAll=function(){o.managedElements.slice(0).forEach(o._unregisterElement)},o.updateItemElement=function(e,t){o.updateItemElements(e,[t])},o.updateItemElements=function(e,t){t.length>e.elements.length||(e.elements.map((function(e,n){t[n].tabIndex=e.tabIndex,e.tabIndex=-1})),e.elements=t)},o.updateItemLocation=function(e,t,n){e.x=t,e.y=n,o._scheduleReorder()},o.updateItemTabIndex=function(e,t){e.tabIndex=0===t||t>0?t:-1,o._scheduleReorder()},o.updateItemZIndex=function(e,t){e.zIndex=t,o._scheduleReorder()},o.updateItemChildTabPriority=function(e,t){e.childTabPriority=t,o._scheduleReorder()},o.updateItemEnableChildFocus=function(e,t){e.enableChildFocus=t,o._scheduleReorder()},o.setControlFocus=function(e){var t=o._itemIdToItemMap.get(e);if(a(t)&&t.setFocus)return t.setFocus();if(i(t)){var n=t.elements[0];if(n)return n.focus(),n===document.activeElement}return!1},o.setControlFocusByControlId=function(e){var t=(o._controlIdToItemsMap.get(e)||[]).find((function(e){return o._itemIdToItemMap.has(e.accessibilityId)}));t&&o.setControlFocus(t.accessibilityId)},o.getTabIndexForControlByControlId=function(e){var t=o._controlIdToItemsMap.get(e);return(null==t?void 0:t.length)>0?o._determineFinalTabIndex(t[0].assignedTabIndex,t[0].assignedTabIndex):-1},o.getItemIdByControlId=function(e){var t=o._controlIdToItemsMap.get(e);return t&&t.length>0?t[0].accessibilityId:null},o.requestChangeMainContentVisibility=function(t){var n=document.querySelector(".".concat(e.Constants.CanvasControlCssClass));t?(--o._totalHideMainContentRequests,0===o._totalHideMainContentRequests&&n.removeAttribute("aria-hidden")):(++o._totalHideMainContentRequests,n.setAttribute("aria-hidden","true"))},o._assignTabIndexesAfterDisableChange=function(t){void 0===t&&(t=o.managedElements),o._reorderTabIndexCore(!0),Core.Loader.ObjectFactory.instance.getSingleton(e.AuthoringTool.GlobalEventBroker.ShellEventBroker.singletonKey).publishEvent(e.AuthoringTool.GlobalEventBroker.EventBrokerId.Canvas_InfoUpdated,null)},o._checkElementsForMismatchedParent=function(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];i.parentAccessibilityId===t.accessibilityId&&i!==t&&(o._removeItem(i),o._addItem(i))}},o._unregisterElement=function(e){r(e)?o.unregisterContainer(e):(i(e)||a(e))&&o.unregisterItem(e)},o._addItem=function(e){var t=o._containerMap.get(e.parentAccessibilityId)||o._containerMap.get(o._trimEnd(e.parentAccessibilityId))||o._containerMap.get(e.parentControlId)||null;null!==t?t.children.push(e):o.managedElements.push(e),o._itemContainerMap.set(e.accessibilityId,t),o._controlIdToItemsMap.has(e.controlId)||o._controlIdToItemsMap.set(e.controlId,[]),o._controlIdToItemsMap.get(e.controlId).push(e)},o._removeItem=function(e){var t=o._itemContainerMap.get(e.accessibilityId)||null;null!==t?(n=t.children.indexOf(e))>-1&&t.children.splice(n,1):(n=o.managedElements.indexOf(e))>-1&&o.managedElements.splice(n,1);o._itemContainerMap.delete(e.accessibilityId);var n,r=o._controlIdToItemsMap.get(e.controlId);r&&((n=r.indexOf(e))>-1&&r.splice(n,1),0===r.length&&o._controlIdToItemsMap.delete(e.controlId))},o.requestReorder=function(){o._scheduleReorder()},o._scheduleReorder=function(){o._updatePending||(o._updatePending=!0,Core.Tasks.schedule(o._processQueue,"AccessibilityManager.scheduleReorder"))},o._processQueue=function(){o._reorderTabIndexCore(),o._updatePending=!1},o._reorderTabIndexCore=function(e){return void 0===e&&(e=!1),t.improvedTabStopBehaviorEnabled?o._reorderTabIndexCoreNeo(e):o._reorderTabIndexCoreClassic(e)},o._reorderTabIndexCoreClassic=function(e,t,n,s){if(void 0===e&&(e=!1),void 0===t&&(t=o.managedElements),void 0===n&&(n={value:0}),void 0===s&&(s=!1),null==t?void 0:t.length){e||t.sort(s?o._responsiveChildSortFunction:o._itemSortFunction);for(var l=function(t){if(r(t)||a(t)){t.assignedTabIndex=++n.value;var s=o._determineFinalTabIndex(t.tabIndex,t.assignedTabIndex);o._tryCallTabindexUpdateFn(t,s),r(t)&&o._reorderTabIndexCoreClassic(e,t.children,n,t.isResponsiveContainer)}else i(t)&&(t.assignedTabIndex=n.value+1,t.elements.forEach((function(e){var r=++n.value,i=o._determineFinalTabIndex(t.tabIndex,r);o._assignItemElementTabIndex(e,i)})))},c=0,p=t;c<p.length;c++){l(p[c])}}},o._reorderTabIndexCoreNeo=function(e,t,n,r){var i,a;void 0===e&&(e=!1),void 0===t&&(t=o.managedElements),void 0===n&&(n={idx:o._getGlobalMaxTabIndex()}),void 0===r&&(r=!1),r?(i=t,a=o._responsiveChildSortFunction):(i=o._collectItemsToReorder(t),a=o._itemSortByPosition),i.length&&(e||(i=i.sort(a)),o._processNewOrder(e,i,n,r))},o._getGlobalMaxTabIndex=function(){var e=0;return o._controlIdToItemsMap.forEach((function(t){return t.forEach((function(t){return e=Math.max(t.tabIndex,e)}))})),e+1},o._collectItemsToReorder=function(e){return e.reduce((function(e,t){return r(t)&&o._includeSubtreeInCurrentContext(t)?e.concat(o._collectItemsToReorder(t.children)):e}),e)},o._includeSubtreeInCurrentContext=function(e){return!e.childTabPriority&&e.enableChildFocus&&!e.isResponsiveContainer},o._processNewOrder=function(e,t,n,s){for(var l=function(t){var l=t.tabIndex,p=e?t.assignedTabIndex:0===l?t.assignedTabIndex=n.idx++:l;if(r(t)||a(t)){var u=c._determineFinalTabIndex(p,p);o._tryCallTabindexUpdateFn(t,u),!r(t)||!s&&o._includeSubtreeInCurrentContext(t)||(t.enableChildFocus?o._reorderTabIndexCoreNeo(e,t.children,n,t.isResponsiveContainer):o._overrideSubtreeTabIndexes(t.children,-1))}else i(t)&&t.elements.forEach((function(e){var t=o._determineFinalTabIndex(p,p);o._assignItemElementTabIndex(e,t),p=n.idx++}))},c=this,p=0,u=t;p<u.length;p++){l(u[p])}},o._overrideSubtreeTabIndexes=function(e,t){for(var n=0,s=e;n<s.length;n++){var l=s[n];r(l)?(o._tryCallTabindexUpdateFn(l,t),o._overrideSubtreeTabIndexes(l.children,t)):a(l)?o._tryCallTabindexUpdateFn(l,t):i(l)&&l.elements.forEach((function(e){o._assignItemElementTabIndex(e,t)}))}},o._determineFinalTabIndex=function(e,t){return o._disableTabIndexes||e<0?-1:o._allowNonZeroTabIndexes?t:0},Object.defineProperty(o,"_allowNonZeroTabIndexes",{get:function(){return!Core.FeatureGates.controls.disableTabIndexManagement&&!t.zeroAllTabIndexesEnabled},enumerable:!1,configurable:!0}),o._tryCallTabindexUpdateFn=function(e,t){var n;if(e.tabIndexUpdateCallback)e.tabIndexUpdateCallback(t);else{var o=OpenAjax.widget.controlManager.getControlInstanceById(e.controlId);Core.Telemetry.Log.trackErrorEvent("_reorderTabIndexCore.tabIndexUpdateCallbackNull",{tabIndexUpdateCallbackType:String(e.tabIndexUpdateCallback),controlType:null==o?void 0:o.type,controlTemplateName:null==o?void 0:o.control.OpenAjax.template.name,parentTemplateName:null===(n=null==o?void 0:o.control.OpenAjax.parentControlWidget)||void 0===n?void 0:n.template.name})}},o._assignItemElementTabIndex=function(e,t){t>=0?e.tabIndex=t:n.indexOf(e.tagName.toLowerCase())>-1?e.tabIndex=-1:e.removeAttribute("tabIndex")},o._trimEnd=function(e,t){return void 0===t&&(t="_authoringArea"),-1!==e.indexOf(t,e.length-t.length)?e.slice(0,-t.length):e},o._itemSortFunction=function(e,t){var n=Math.max(0,e.tabIndex),r=Math.max(0,t.tabIndex);return n!==r?0===n?1:0===r?-1:n-r:o._itemSortByPosition(e,t)},o._itemSortByPosition=function(e,t){var n=o._getItemPosition(e),r=o._getItemPosition(t);return e.preferYAxisTabIndex&&t.preferYAxisTabIndex?n.y!==r.y?n.y-r.y:n.x-r.x:n.x!==r.x?n.x-r.x:n.y-r.y},o._responsiveChildSortFunction=function(e,t){return e.zIndex-t.zIndex},o._getItemPosition=function(e,t){void 0===t&&(t={}),t[e.accessibilityId]=!0;var n={x:e.x,y:e.y},r=o._itemContainerMap.get(e.accessibilityId);if(r)if(t[r.accessibilityId])Core.Log.errorEx("AccessibilityManager_getItemPosition","Invalid structure (cyclical reference) detected");else{var i=o._getItemPosition(r,t);n.x+=i.x,n.y+=i.y}return n},o.managedElements=[],o._updatePending=!1,o._disableTabIndexes=!1,o._totalHideMainContentRequests=0,__decorate([initializeOnLoad((function(){return new Map}))],o,"_controlIdToItemsMap",void 0),__decorate([initializeOnLoad((function(){return new Map}))],o,"_itemContainerMap",void 0),__decorate([initializeOnLoad((function(){return new Map}))],o,"_containerMap",void 0),__decorate([initializeOnLoad((function(){return new Map}))],o,"_itemIdToItemMap",void 0),o}();function r(e){return e instanceof t.ControlAccessibilityContainer}function i(e){return e instanceof t.ControlAccessibilityItem}function a(e){return e instanceof t.ReactControlAccessibilityItem}t.AccessibilityManager=o}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=e.AuthoringTool.OpenAjaxPropertyNames,o=function(){function o(){}return o.createAccessibilityContainer=function(e,o){var r=this._getInfo(e),i=null;if(e.modelProperties[n.TabIndex]&&o){var a=e.modelProperties[n.TabIndex].getValue();i={tabIndex:a=a>0||0===a?a:-1,callback:o}}return new t.ControlAccessibilityContainer(r.controlId,r.accessibilityId,r.parentControlId,r.parentAccessibilityId,r.x,r.y,!0,i,r.containerOptions)},o.createAccessibilityItem=function(e,r){var i=o._getInfo(e),a=e.modelProperties[n.TabIndex].getValue()||0,s=Array.isArray(r)?r:[r];return new t.ControlAccessibilityItem(i.controlId,i.accessibilityId,i.parentControlId,i.parentAccessibilityId,i.x,i.y,s,a,i.zIndex)},o.createReactAccessibilityItem=function(e,r,i){var a=o._getInfo(e),s=e.modelProperties[n.TabIndex].getValue()||0;return new t.ReactControlAccessibilityItem(a.controlId,a.accessibilityId,a.parentControlId,a.parentAccessibilityId,a.x,a.y,s,a.zIndex,r,i)},o.updateLocation=function(e,n){var r=o._getLocation(n);t.AccessibilityManager.updateItemLocation(e,r.x,r.y)},o.updateTabIndex=function(e,o){t.AccessibilityManager.updateItemTabIndex(e,o.modelProperties[n.TabIndex].getValue()||0)},o.updateZIndex=function(e,o){var r;t.AccessibilityManager.updateItemZIndex(e,null!==(r=o.modelProperties[n.ZIndex].getValue())&&void 0!==r?r:-1)},o.updateItemChildTabPriority=function(e,o){t.AccessibilityManager.updateItemChildTabPriority(e,o.modelProperties[n.ChildTabPriority].getValue())},o.updateItemEnableChildFocus=function(e,o){t.AccessibilityManager.updateItemEnableChildFocus(e,o.modelProperties[n.EnableChildFocus].getValue())},o.setControlFocus=function(e){var n=Date.now(),r=t.getSingleControlContainerElement(document.activeElement),i=function(){if(!e.initialized)return o._clearSetFocusInterval(),!1;if(t.getSingleControlContainerElement(document.activeElement)!==r)return o._clearSetFocusInterval(),!1;var i=o._getItemId(e),a=t.AccessibilityManager.setControlFocus(i);return(a||Date.now()>n+o.SET_FOCUS_POLL_TIMEOUT)&&o._clearSetFocusInterval(),a};o._clearSetFocusInterval(),i()||(o._setFocusIntervalId=window.setInterval(i,o.SET_FOCUS_POLL_INTERVAL))},o._clearSetFocusInterval=function(){o._setFocusIntervalId&&(window.clearInterval(o._setFocusIntervalId),o._setFocusIntervalId=0)},o.getAccessibilityId=function(e,n){var o=e,r=n.bindingContext;if(n.controlWidget.isReplicable){for(;null!=r;)o+="_".concat(r.id),r=r.parent;return o}if(r===t.GlobalContextManager.bindingContext)return o;for(;null!=r;)o+="_".concat(r.id),r=r.parent;return o},o.getParentAccessibilityId=function(e){var t=e.controlWidget.parentUniqueId,n=e.controlWidget.parentControlName,r=e.bindingContext.parent;return r&&r.controlContexts&&r.controlContexts[n]?o.getAccessibilityId(t,r.controlContexts[n]):t},o.initializeAccessibilityContainer=function(e,r,i){void 0===r&&(r=function(){}),void 0===i&&(i=!1);var a=[],s=ko.pureComputed((function(){var e,t;return"".concat(null===(e=this.X)||void 0===e?void 0:e.call(this),":").concat(null===(t=this.Y)||void 0===t?void 0:t.call(this))}),e.properties),l=e.properties,c=e._accessibilityContainer;return c&&(t.AccessibilityManager.unregisterContainer(c),e._accessibilityContainer.dispose(),e._accessibilityContainer=null),i?(e._accessibilityContainer=o.createAccessibilityContainer(e,r),a.push(l.TabIndex.subscribe((function(){e.realized&&e._accessibilityContainer&&o.updateTabIndex(e._accessibilityContainer,e)})))):e._accessibilityContainer=o.createAccessibilityContainer(e),a.push(s.subscribe((function(){e.realized&&e._accessibilityContainer&&o.updateLocation(e._accessibilityContainer,e)}))),l[n.ChildTabPriority]&&a.push(l[n.ChildTabPriority].subscribe((function(){e.realized&&e._accessibilityContainer&&o.updateItemChildTabPriority(e._accessibilityContainer,e)}))),l[n.EnableChildFocus]&&a.push(l[n.EnableChildFocus].subscribe((function(){e.realized&&e._accessibilityContainer&&o.updateItemEnableChildFocus(e._accessibilityContainer,e)}))),t.AccessibilityManager.registerContainer(e._accessibilityContainer),function(){a.forEach((function(e){return e.dispose()})),s.dispose(),e._accessibilityContainer&&(t.AccessibilityManager.unregisterContainer(e._accessibilityContainer),e._accessibilityContainer.dispose(),e._accessibilityContainer=null)}},o._getItemId=function(e){if(e.controlWidget.isReplicable&&e.bindingContext.rcManager.authoringAreaBindingContext.observedBindingContext===e.bindingContext){var t=e.bindingContext.rcManager.getControlWidget();e.controlWidget.controlManager.getControlInstanceById(t.uniqueId).control.behaviorEventsOnAuthContext&&(e=e.controlWidget.getAuthoringControlContext())}return o.getAccessibilityId(e.controlWidget.uniqueId,e)},o._getInfo=function(e){var t,r,i,a,s=e.controlWidget.uniqueId,l=e.bindingContext.componentInstance&&null!==(r=null===(t=OpenAjax.widget.byId(e.bindingContext.componentInstance))||void 0===t?void 0:t.OpenAjax.uniqueId)&&void 0!==r?r:e.controlWidget.parentUniqueId,c=o._getLocation(e);return{controlId:s,accessibilityId:o.getAccessibilityId(s,e),parentControlId:l,parentAccessibilityId:o.getAccessibilityId(l,e),x:c.x,y:c.y,containerOptions:o._getContainerOptions(e),zIndex:null===(a=null===(i=e.modelProperties)||void 0===i?void 0:i[n.ZIndex])||void 0===a?void 0:a.getValue()}},o._getContainerOptions=function(t){var o,r,i,a,s,l,c,p;return{isResponsiveContainer:(null===(r=null===(o=t.modelProperties)||void 0===o?void 0:o[n.LayoutMode])||void 0===r?void 0:r.getValue())===e.Constants.LayoutMode.Auto,childTabPriority:null===(s=null===(a=null===(i=t.modelProperties)||void 0===i?void 0:i[n.ChildTabPriority])||void 0===a?void 0:a.getValue())||void 0===s||s,enableChildFocus:null===(p=null===(c=null===(l=t.modelProperties)||void 0===l?void 0:l[n.EnableChildFocus])||void 0===c?void 0:c.getValue())||void 0===p||p}},o._getLocation=function(e){var t,o;return{x:null!==(t=e.modelProperties[n.X].getValue())&&void 0!==t?t:0,y:null!==(o=e.modelProperties[n.Y].getValue())&&void 0!==o?o:0}},o.SET_FOCUS_POLL_INTERVAL=100,o.SET_FOCUS_POLL_TIMEOUT=1e3,o._setFocusIntervalId=0,o}();t.AccessibilityHelper=o}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){e.IPcfDataConnectorServiceSingletonKey=Core.Loader.TypeKey.createForInterface("AppMagic.Controls.IPcfDataConnectorService")}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=function(n){function o(t){var o=n.call(this)||this;return o._pcfDataConnectorApis=HashTableUtility.create(),o._connectorRemoveOperations=new Map,o.trackAnonymous(t.subscribe([e.AuthoringTool.GlobalEventBroker.EventBrokerId.FileOperations_FileClosed],o._onAppFileClosed.bind(o))),o}return __extends(o,n),o.prototype.addDataConnectorsAsync=function(e){var t,n;return __awaiter(this,void 0,void 0,(function(){var o,r;return __generator(this,(function(i){switch(i.label){case 0:return!e||this._pcfDataConnectorApis[e.uniqueId]?(Core.Log.warningEx("PcfDataConnectorService.addDataConnectorsAsync","PCF data connectors could not be added."),[2]):(null===(n=null===(t=e.template)||void 0===t?void 0:t.dataConnectors)||void 0===n?void 0:n.length)>0?(o=this._pcfDataConnectorApis,r=e.uniqueId,[4,this._createConnectorsApiAsync(e)]):[3,2];case 1:o[r]=i.sent(),i.label=2;case 2:return[2]}}))}))},o.prototype.removeDataConnectors=function(e){e&&(this._pcfDataConnectorApis[e.uniqueId]&&delete this._pcfDataConnectorApis[e.uniqueId])},o.prototype.getConnectorsApi=function(e){return this._pcfDataConnectorApis[e]},o.prototype._createConnectorsApiAsync=function(e){return __awaiter(this,void 0,void 0,(function(){var t,n,o,r,i,a;return __generator(this,(function(s){switch(s.label){case 0:this._throwOnDuplicateConnectors(e),t={},n=function(n){var r;return __generator(this,(function(i){switch(i.label){case 0:return[4,o._createConnectorAsync(e,n.id)];case 1:return r=i.sent(),Object.defineProperty(t,n.name,{get:function(){return r.connectorApi},configurable:!0,enumerable:!0}),[2]}}))},o=this,r=0,i=e.template.dataConnectors,s.label=1;case 1:return r<i.length?(a=i[r],[5,n(a)]):[3,4];case 2:s.sent(),s.label=3;case 3:return r++,[3,1];case 4:return[2,t]}}))}))},o.prototype._createConnectorAsync=function(t,n){return __awaiter(this,void 0,void 0,(function(){var o,r,i,a,s,l,c,p,u,d;return __generator(this,(function(h){switch(h.label){case 0:o=null,Core.Log.verbose({operationName:"PcfDataConnectorService._createConnectorAsync.start",message:"Creating connector with api id ".concat(n," for control unique id ").concat(t.uniqueId)}),h.label=1;case 1:if(h.trys.push([1,8,,9]),r=null,t.pcfServiceDependencies){for(i=0;i<t.pcfServiceDependencies.length;i++)if(a=t.pcfServiceDependencies[i],Core.Log.verbose({operationName:"PcfDataConnectorService._createConnectorAsync.search",message:"Searching pcfServiceDependency ".concat(i," of ").concat(t.pcfServiceDependencies.length),eventData:{apiId:a.apiId,hasErrors:a.hasErrors,serviceNamespace:a.serviceNamespace}}),a.apiId.toLowerCase()===n.toLowerCase()&&(s=e.AuthoringTool.Runtime.tryGetImportedService(a.serviceNamespace))){r=s.serviceNamespace,Core.Log.verbose({operationName:"PcfDataConnectorService._createConnectorAsync.found",message:"Found matching service name ".concat(s.serviceNamespace)});break}r||Core.Log.verbose("PcfDataConnectorService._createConnectorAsync.noMatch","No matching service name found. In published apps this is probably an error.")}return l=Core.Loader.ObjectFactory.instance.getSingleton(Core.UrlHash.IUrlHashManagerSingletonKey),c=l.getParameterValue(Core.Utility.Constants.CanvasDesignerFlagsUrlParam).split(","),p=c.some((function(e){return e.toLowerCase()===Core.Utility.Constants.SkipAutoRefreshUrlParam.toLowerCase()})),e.AuthoringTool.Runtime.isAuthoring&&r&&!p?(Core.Log.verbose("PcfDataConnectorService._createConnectorAsync: Removing service from document: ".concat(r)),this._connectorRemoveOperations.has(r)?[4,this._connectorRemoveOperations.get(r)]:[3,3]):[3,6];case 2:return h.sent(),[3,5];case 3:return this._connectorRemoveOperations.set(r,this._removeServiceAsync(r)),[4,this._connectorRemoveOperations.get(r)];case 4:h.sent(),this._connectorRemoveOperations.delete(r),h.label=5;case 5:r=null,h.label=6;case 6:return u=!r,[4,(o=r?this._loadPcfDataConnector(n,r):this._importPcfDataConnector(n)).initializeAsync()];case 7:return h.sent(),u&&t.tryAddPcfServiceDependency(o.serviceNamespace),[3,9];case 8:return d=h.sent(),Core.Log.errorEx("PcfDataConnectorService._createConnectorAsync",{error:d}),[3,9];case 9:return[2,o]}}))}))},o.prototype._loadPcfDataConnector=function(n,o){var r=e.AuthoringTool.Runtime.tryGetImportedService(o);return r?new t.PcfDataConnector(n,r.serviceNamespace):null},o.prototype._throwOnDuplicateConnectors=function(e){for(var t,n,o={},r={},i=0,a=e.template.dataConnectors;i<a.length;i++){var s=a[i],l=null===(t=s.id)||void 0===t?void 0:t.toLowerCase(),c=null===(n=s.name)||void 0===n?void 0:n.toLowerCase();Contracts.checkString(l),Contracts.checkString(c),Contracts.checkUndefined(o[l]),Contracts.checkUndefined(r[c]),o[l]=!0,r[c]=!0}},o.prototype._importPcfDataConnector=function(e){throw new Error("Not implemented.")},o.prototype._removeServiceAsync=function(e){throw new Error("Not implemented.")},o.prototype._onAppFileClosed=function(){this._pcfDataConnectorApis=HashTableUtility.create(),this._connectorRemoveOperations.clear()},o}(Core.Disposable);t.PcfDataConnectorService=n}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=function(t){function n(e){var n=t.call(this)||this;return n._connectorApi=null,n.apiId=e,n}return __extends(n,t),Object.defineProperty(n.prototype,"connectorApi",{get:function(){return this._throwIfDisposed(),this._throwIfConnectorApiInvalid(),this._connectorApi},enumerable:!1,configurable:!0}),n.prototype.initializeAsync=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this._ensureImportedServiceAsync()];case 1:return e.sent(),this._defineConnectorApi(),[2]}}))}))},n.prototype._defineConnectorApi=function(){var e=this;if(!this._connectorApi){var t=this._tryGetImportedService(),n={},o=function(t){n[t]=function(n){return e._invokeActionAsync(t,n)}};for(var r in t.functions)o(r);this._connectorApi=n}},n.prototype._invokeActionAsync=function(t,n){return __awaiter(this,void 0,void 0,(function(){var o,r,i,a,s,l,c,p,u;return __generator(this,(function(d){switch(d.label){case 0:return this._throwIfDisposed(),[4,this._ensureImportedServiceAsync()];case 1:for(o=d.sent(),r=o.functions[t],i=HashTableUtility.create(),a=0,s=r.requiredParameters;a<s.length;a++){if(l=s[a],!n||!n.hasOwnProperty(l.name))throw new Error("Missing required argument ".concat(l.name));i[l.name]=new e.Services.PrimitiveDArgument(n[l.name])}for(c=0,p=r.optionalParameters;c<p.length;c++)u=p[c],i[u.name]=new e.Services.PrimitiveDArgument(n[u.name]);return[2,r.runAsync(i)]}}))}))},n.prototype._throwServiceNotImportedError=function(){throw new Error("The data connector ".concat(this.apiId," could not be added."))},n.prototype._throwIfDisposed=function(){if(this.isDisposed)throw new Error("Connector ".concat(this.apiId," is disposed."))},n}(Core.Disposable);t.PcfDataConnectorBase=n}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=function(t){function n(n,o){var r=t.call(this,n)||this;return r._serviceNamespace=null,r._runtime=null,r._serviceNamespace=o,r._runtime=e.AuthoringTool.Runtime,r}return __extends(n,t),Object.defineProperty(n.prototype,"serviceNamespace",{get:function(){return this._serviceNamespace},enumerable:!1,configurable:!0}),n.prototype._ensureImportedServiceAsync=function(){return __awaiter(this,void 0,void 0,(function(){var e;return __generator(this,(function(t){return(e=this._tryGetImportedService())||this._throwServiceNotImportedError(),[2,e]}))}))},n.prototype._tryGetImportedService=function(){return this._runtime.tryGetImportedService(this._serviceNamespace)},n.prototype._throwIfConnectorApiInvalid=function(){this._connectorApi||this._tryGetImportedService()||this._throwServiceNotImportedError()},n}(t.PcfDataConnectorBase);t.PcfDataConnector=n}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=Core.Loader.ObjectFactory;function o(){n.instance.register(e.Controls.ViewCreationPromiseFactory.singletonKey,[],(function(){return new e.Controls.ViewCreationPromiseFactory})),n.instance.register(e.Controls.RequirementsManager.singletonKey,[],(function(){return new e.Controls.RequirementsManager})),n.instance.register(e.Controls.IPcfDataConnectorServiceSingletonKey,[e.AuthoringTool.GlobalEventBroker.ShellEventBroker.singletonKey],(function(t){return new e.Controls.PcfDataConnectorService(t)}))}t.registerObjects=o,o()}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){e.AppLifecycleEvents=React.createContext({onFirstOrStartingScreenMounted:function(){},onFirstOrStartingScreenPainted:function(){},onFirstOrStartingScreenFullLoad:function(e,t){},onInteractionEvent:function(){}})}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){e.withAppLifecycleEvents=function(t){return function(n){function o(e){return n.call(this,e)||this}return __extends(o,n),o.prototype.render=function(){var n=this;return React.createElement(e.AppLifecycleEvents.Consumer,null,(function(e){return React.createElement(t,__assign({},n.props,{appLifecycleEvents:e}))}))},o}(React.Component)}}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=function(e){function t(t){var n=e.call(this,t)||this;return n._applyMethodOverrides(),n._controlContext=null,n}return __extends(t,e),Object.defineProperty(t.prototype,"controlContext",{get:function(){return this._controlContext},enumerable:!1,configurable:!0}),t.prototype._applyMethodOverrides=function(){var e=this.constructor.getDerivedStateFromProps;Core.Utility.isFunction(e)||(this._componentWillMountOriginal=n(this.componentWillMount),this.componentWillMount=this._componentWillMountOverride,this._componentWillReceivePropsOriginal=n(this.componentWillReceiveProps),this.componentWillReceiveProps=this._componentWillReceivePropsOverride,this._shouldComponentUpdateOriginal=n(this.shouldComponentUpdate,o),this.shouldComponentUpdate=this._shouldComponentUpdateOverride,this._componentWillUnmountOriginal=n(this.componentWillUnmount),this.componentWillUnmount=this._componentWillUnmountOverride)},t.prototype._componentWillMountOverride=function(){this._initComponentRegistration(),this._componentWillMountOriginal()},t.prototype._componentWillReceivePropsOverride=function(e,t){this._componentWillReceivePropsWasCalled=!0,this._updateComponentRegistration(e),this._componentWillReceivePropsOriginal(e,t)},t.prototype._shouldComponentUpdateOverride=function(e,t,n){return this._componentWillReceivePropsWasCalled?this._componentWillReceivePropsWasCalled=!1:this._updateComponentRegistration(e),this._shouldComponentUpdateOriginal(e,t,n)},t.prototype._componentWillUnmountOverride=function(){this._disposeComponentRegistration(),this._componentWillUnmountOriginal()},t.prototype._initComponentRegistration=function(){var e=this.props.controlContext;this._unwindComponentRegistrations(e),e.initialized?this._registerControlContext(e,this.props):Core.Log.warningEx("ContextAwareComponent._initComponentRegistration","Expected control context to be initialized")},t.prototype._updateComponentRegistration=function(e){var t=this.props.controlContext,n=e.controlContext;t===n&&n.instanceId===this._controlContextInstanceId||(this._isContextOwner(t)&&this._unwindComponentRegistrations(t),this._unwindComponentRegistrations(n),this._registerControlContext(n,e))},t.prototype._disposeComponentRegistration=function(){var e=this._controlContext;e&&this._isContextOwner(e)&&this._unwindComponentRegistrations(e)},t.prototype._registerControlContext=function(e,t){var n=this,o=function(){n._isContextOwner(e)&&n._unwindComponentRegistrations(e)};e.controlWidget.addOnBeforeDisposeCallback(e,o);var r=e._contextAwareComponents;r||(r=e._contextAwareComponents=[]),r.push({componentKey:this.contextOwnerName,component:this,onBeforeDisposeCallback:o}),this._controlContext=e,this._controlContextInstanceId=e.instanceId,this.controlContextDidMount(t)},t.prototype._unregisterControlContext=function(e,t){e.controlWidget.removeOnBeforeDisposeCallback(e,t.onBeforeDisposeCallback),this.controlContextWillUnmount(),this._controlContext=null},t.prototype._unwindComponentRegistrations=function(e){var t=this._getContextIndex(e);if(-1!==t){for(var n=e._contextAwareComponents,o=n.splice(t);o.length;){var r=o.pop();r.component._unregisterControlContext(e,r),r.component=null,r.onBeforeDisposeCallback=null}0===n.length&&delete e._contextAwareComponents}},t.prototype._getContextIndex=function(e){var t=e._contextAwareComponents;if(t){var n=this.contextOwnerName;return t.findIndex((function(e){return e.componentKey===n}))}return-1},t.prototype._getContextOwner=function(e){var t=this._getContextIndex(e);return-1!==t?e._contextAwareComponents[t].component:null},t.prototype._isContextOwner=function(e){return this._getContextOwner(e)===this},t}(React.Component);function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,o=e;n<o.length;n++){var r=o[n];if(Core.Utility.isFunction(r))return r}return Core.Utility.noOpFn}function o(){return!0}e.ContextAwareComponent=t}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=function(e){function t(t){var n=e.call(this,t)||this;return n._componentElement=null,n._mousetrapBindings=new Map,n._bindKeyboardShortcuts=n._bindKeyboardShortcuts.bind(n),n._unbindKeyboardShortcuts=n._unbindKeyboardShortcuts.bind(n),n}return __extends(t,e),t.prototype.componentDidMount=function(){this._attachMousetrap()},t.prototype.componentDidUpdate=function(){this._attachMousetrap()},t.prototype.componentWillUnmount=function(){this._detachMousetrap(),this._componentElement=null},t.prototype._attachMousetrap=function(){var e=this;this._componentElement&&!this._mousetrap&&(this._mousetrap=new Mousetrap(this._componentElement,!1),this._mousetrapBindings.forEach((function(t,n){e._mousetrap.bind(n,t)})))},t.prototype._detachMousetrap=function(){this._mousetrapBindings&&(this._unbindAllKeyboardShortcuts(),this._mousetrapBindings=null),this._mousetrap&&(this._mousetrap.destroy(),this._mousetrap=null)},t.prototype._bindKeyboardShortcuts=function(e,t){var n=this;e.forEach((function(e){n._mousetrapBindings.has(e)||n._mousetrapBindings.set(e,t)}))},t.prototype._unbindKeyboardShortcuts=function(e){var t=this;e.forEach((function(e){t._mousetrapBindings.has(e)&&(t._mousetrapBindings.delete(e),t._mousetrap.unbind(e))}))},t.prototype._unbindAllKeyboardShortcuts=function(){this._mousetrapBindings.forEach((function(e,t){Mousetrap.unbind(t)})),this._mousetrapBindings.clear()},t}(e.ContextAwareComponent);e.ControlContainerBase=t}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=e.AuthoringTool.OpenAjaxPropertyNames,o=function(){function t(){}return t.isPrintableControl=function(e){var t=e;return Core.Utility.isNumber(t._expandForPrintHeight)&&Core.Utility.isNumber(t._expandForPrintRestoreHeight)},t.prototype.initControlContext=function(e){e._expandForPrintHeight=-1,e._expandForPrintRestoreHeight=-1},t.prototype.onChangeHeight=function(e,t){return-1===t._expandForPrintHeight||e.newValue===t._expandForPrintHeight||(t.modelProperties.Height.setValue(t._expandForPrintHeight),!1)},t.prototype.childControlsCanExpandForPrint=function(){return!1},t.prototype.expandForPrintAsync=function(t){return __awaiter(this,void 0,void 0,(function(){var o,r,i;return __generator(this,(function(a){switch(a.label){case 0:return o=this.calculatePrintHeight(t),r=t.modelProperties.Height.getValue(),(i=o>r)&&(t._expandForPrintHeight=o,t._expandForPrintRestoreHeight=r,t.modelProperties[n.AutoLayoutHeight]&&t.modelProperties[n.AutoLayoutHeight].setValue(o),t.modelProperties.Height.setValue(o)),[4,this.onExpandForPrintAsync(t)];case 1:return a.sent(),[2,{restore:function(){i&&(t._expandForPrintHeight=-1,t.modelProperties[n.AutoLayoutHeight]&&t.modelProperties[n.AutoLayoutHeight].setValue(t._expandForPrintRestoreHeight),t.modelProperties.Height.setValue(t._expandForPrintRestoreHeight),t._expandForPrintRestoreHeight=-1,e.AuthoringTool.Runtime.runPropertyRuleForControl(t.bindingContext,t.controlWidget.uniqueId,n.Height))}}]}}))}))},t.prototype.calculatePrintHeight=function(e){return e.modelProperties.Height.getValue()},t.prototype.onExpandForPrintAsync=function(e){return Promise.resolve()},t.prototype.forEachPrintableChildControlContext=function(t,n){this.OpenAjax.forEachChildAuthoringControlContext(t,(function(t){!e.Controls.isVisualControl(t.controlWidget.template.className)||Core.Utility.isDefined(t.modelProperties.Visible)&&!t.modelProperties.Visible.getValue()||n(t)}))},t}();t.PrintableControl=o}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.registerReactComponent=function(e){this._component=e},Object.defineProperty(t.prototype,"isComponentValid",{get:function(){return!!this._component},enumerable:!1,configurable:!0}),t.prototype.beforeComponentRender=function(){},t.prototype.updateComponentState=function(e,t){var n;this.isComponentValid&&this._component.setState(((n={})[e]=t,n))},t.prototype.getInitialState=function(){return{}},t}(e.PrintableControl);e.BaseReactControlWidget=t}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n={position:"absolute",top:0,left:0,right:0,bottom:0},o=function(t){function o(e){var n=t.call(this,e)||this;return n._controlElementRef=React.createRef(),n._componentNeedsUpdate=!1,n._updateAutoHeight=!1,n}return __extends(o,t),Object.defineProperty(o.prototype,"contextOwnerName",{get:function(){return"KnockoutControl"},enumerable:!1,configurable:!0}),o.prototype.controlContextDidMount=function(t){var n=this,o=this.controlContext;Core.Utility.isFunction(t.control.updateAutoHeightOnParentVisible)&&(this._parentVisibilityListener=o.controlWidget.addParentPropertyChangeCallback(e.AuthoringTool.OpenAjaxPropertyNames.Visible,(function(e){e&&(n._updateAutoHeight=!0)}))),this._controlElementRef.current&&this._initView(t),this._componentNeedsUpdate=!0},o.prototype.controlContextWillUnmount=function(){this._parentVisibilityListener&&(this._parentVisibilityListener.dispose(),this._parentVisibilityListener=null),this._controlElementRef.current&&this._disposeView(this.props)},o.prototype.shouldComponentUpdate=function(){var e=this._componentNeedsUpdate;return this._componentNeedsUpdate=!1,this._updateAutoHeight||e},o.prototype.componentDidMount=function(){this.controlContext?this._initView(this.props):Core.Log.warningEx("KnockoutControl.componentDidMount","Expected control context when component did mount")},o.prototype.componentDidUpdate=function(e){var t=e.control,n=this.controlContext;this._updateAutoHeight&&Core.Utility.isFunction(t.updateAutoHeightOnParentVisible)&&n&&t.updateAutoHeightOnParentVisible(n),this._updateAutoHeight=!1},o.prototype._disposeView=function(e){var t=this._controlElementRef.current;ko.cleanNode(t);var n=this.controlContext;if(n.realized){var o=e.control;Core.Utility.isFunction(o.disposeView)&&o.disposeView(t,n),n.realized=!1,n.container=null}},o.prototype._initView=function(e){var t=e.control,n=e.templateHtml,o=this.controlContext,r=this._controlElementRef.current;ko.cleanNode(r),WinJS.Utilities.setInnerHTMLUnsafe(r,n),o.container=r,o.realized=!0,Core.Utility.isFunction(t.initView)&&t.initView(r,o)},o.prototype.render=function(){return React.createElement("div",{ref:this._controlElementRef,className:"react-knockout-control",style:n})},o}(t.ContextAwareComponent);t.KnockoutControl=o}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=function(e){function t(t){var n=e.call(this,t)||this;return n._handleOnFocus=n._handleOnFocus.bind(n),n._handleOnBlur=n._handleOnBlur.bind(n),n._highContrastModeListener=n._highContrastModeListener.bind(n),n._highContrastMediaQueryList=window.matchMedia("(-ms-high-contrast: active), (forced-colors: active)"),n.state={isFocused:!1,isHighContrastActive:n._highContrastMediaQueryList.matches},n}return __extends(t,e),t.prototype.render=function(){var e=this.state.isFocused,t=this.props,n=t.borderBottomLeftRadius,o=t.borderBottomRightRadius,r=t.borderColor,i=t.borderColorFocused,a=t.borderTopLeftRadius,s=t.borderTopRightRadius,l=t.borderStyle,c=t.borderWidth,p=t.borderWidthFocused,u=t.disabled,d=t.fill,h=t.margin,C=t.marginFocused,g={backgroundColor:d,borderStyle:l,borderWidth:e?p:c,borderColor:e?i:r,borderTopLeftRadius:a,borderTopRightRadius:s,borderBottomLeftRadius:n,borderBottomRightRadius:o,boxShadow:t.boxShadow,margin:e?C:h},m={margin:e?C:h};return this.state.isHighContrastActive&&(g.borderColor=u?"grayText":"canvasText"),React.createElement("div",{className:"appmagic-borderfill-container",style:g},React.createElement("div",{className:"appmagic-border-inner",style:m,onFocus:u?null:this._handleOnFocus,onBlur:u?null:this._handleOnBlur},this.props.children))},t.prototype.componentWillReceiveProps=function(e){e.disabled&&this.setState({isFocused:!1})},t.prototype.componentDidMount=function(){this._highContrastMediaQueryList.addEventListener&&this._highContrastMediaQueryList.addEventListener("change",this._highContrastModeListener)},t.prototype.componentWillUnmount=function(){this._highContrastMediaQueryList.removeEventListener&&this._highContrastMediaQueryList.removeEventListener("change",this._highContrastModeListener)},t.prototype._handleOnFocus=function(e){this.props.shouldAcceptFocus(e)&&this.setState({isFocused:!0})},t.prototype._handleOnBlur=function(e){this.setState({isFocused:!1})},t.prototype._highContrastModeListener=function(){var e=this._highContrastMediaQueryList.matches;this.state.isHighContrastActive!==e&&this.setState({isHighContrastActive:e})},t}(React.Component);e.ControlBorder=t}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=Core.UI.StyleHelpers.joinClasses,o=function(o){function r(e){var t=o.call(this,e)||this;return t._prevAutoLayoutProperties=null,t._componentInitialized=!1,t._handleNullRenderComponentRef=t._handleNullRenderComponentRef.bind(t),t._handleComponentElementRef=t._handleComponentElementRef.bind(t),t._overrideStyle=t._overrideStyle.bind(t),t.state={},t._syncState={},t._pendingState={},t}return __extends(r,o),r._getRenderManager=function(e){return e.reactRenderDataStore.getRenderManager(e.controlContext)},r._extractStateProps=function(e){return t.ExtractStateProps(e)},r._shouldControlBorderAcceptFocus=function(e){var t=r._findControlContainerElement(e.target),n=r._findControlContainerElement(e.currentTarget);return t&&t===n},r._findControlContainerElement=function(t){for(;t;){if(t.classList.contains(e.Constants.Controls.CanvasContentDivClassName))return t;t=t.parentElement}return null},r.prototype.batchUpdateState=function(e){var t=this,n=Object.keys(this._pendingState);if(Object.keys(e).forEach((function(n){return t._pendingState[n]=e[n]})),0===n.length){var o=this._renderManager;Core.UI.ControlsStateScheduler.schedule((function(){var e=t._renderManager;if(e&&!e.disposed&&o===e){var n=t._pendingState;t._pendingState={},Object.keys(n).some((function(e){return n[e]!==t._syncState[e]}))&&t._updateState(n)}}))}},Object.defineProperty(r.prototype,"contextOwnerName",{get:function(){return"SingleControlContainer"},enumerable:!1,configurable:!0}),r.prototype.controlContextDidMount=function(e){var t=this.controlContext;if(this._shouldRenderControl(t)){var n=r._getRenderManager(e),o=this._setRenderManagerAndExtractStateProps(n);this._updateState(o)}else this._initVisiblePropertySubscription();this._componentInitialized&&this._initControlContext(e)},r.prototype.controlContextWillUnmount=function(){this._disposeVisiblePropertySubscription(),this._disposeControlContext(),this._releaseRenderManager()},r.prototype.componentWillUnmount=function(){this._disposeComponentOrComponentElement(),o.prototype.componentWillUnmount.call(this)},r.prototype.shouldComponentUpdate=function(e){return this._shouldRenderControl(this.controlContext)&&!!this._renderManager},r.prototype.render=function(){var o=this.controlContext;if(!this._shouldRenderControl(o)||!this._renderManager)return null;var r=this.props.controlInstance;if(this._shouldRenderNullOutput(r))return React.createElement(t.NullRenderComponent,{ref:this._handleNullRenderComponentRef});var i=this.state,a=i.top,s=i.width,l=i.height,c=i.zIndex,p=i.visible,u=i.name,d={display:p?"":"none"},h=this._prevAutoLayoutProperties,C=this._processAndGetAutoLayoutProperties(h);this._prevAutoLayoutProperties=C;var g=C.isInAutoLayoutContainer;if(g){var m=C.parentDirection,f=C.parentAlignItems,y=C.flexGrow,_=C.alignSelf,v=C.minHeight,b=C.minWidth,x=_===e.Constants.AlignInContainer.Stretch||_===e.Constants.AlignInContainer.SetByContainer&&f===e.Constants.LayoutAlignItems.Stretch,P=y>0,A=m===e.Constants.LayoutDirection.Horizontal?["width","height","minWidth","minHeight",b,v]:["height","width","minHeight","minWidth",v,b],I=A[0],M=A[1],S=A[2],w=A[3],R=A[4],T=A[5];d=__assign(__assign({},d),{position:"relative",flexGrow:y,flexShrink:0,flexBasis:"auto",width:s,height:l,alignSelf:_===e.Constants.AlignInContainer.SetByContainer?void 0:_}),P&&(d[I]="auto",d[S]=R||void 0),x&&(d[M]="auto",d[w]=T||void 0),t.PrintableControl.isPrintableControl(o)&&-1!==o._expandForPrintHeight&&(d.height=l)}else{var O=this.state.left;d.position="absolute",d.top=a,"rtl"===this.props.textDirection?d.right=O:d.left=O,d.width=s,d.height=l,d.zIndex=c}var V=this.props.styleOverrides;return V&&(d=__assign(__assign({},d),V)),this._childStyleOverrides&&(d=__assign(__assign({},d),this._childStyleOverrides)),React.createElement("div",{ref:this._handleComponentElementRef,className:n("appmagic-content-control-name","appmagic-control-view",e.Constants.Controls.CanvasContentDivClassName,g&&"appmagic-auto-layout"),style:d,lang:this._contentLanguage,"data-control-id":r.id,"data-control-name":u},g?React.createElement(t.ItemMeasurer,{controlContext:o},this._renderControlComponent()):this._renderControlComponent())},Object.defineProperty(r.prototype,"_contentLanguage",{get:function(){return this.state.contentLanguage||void 0},enumerable:!1,configurable:!0}),r.prototype._updateState=function(e){var t=this;Object.keys(e).forEach((function(n){return t._syncState[n]=e[n]})),this.setState(e)},r.prototype._overrideStyle=function(e){this._childStyleOverrides=e,this.forceUpdate()},r.prototype._controlComponentHandlesRealized=function(e){var n=e.controlInstance;if(t.ResolveControlComponent(n.type)===t.KnockoutControl)return!0;var o=n.control;return Core.Utility.isFunction(o.handlesRealized)&&o.handlesRealized()},r.prototype._controlInstanceVisible=function(e){var t=e.modelProperties;return!t.Visible||t.Visible.getValue()},r.prototype._controlAncestorsVisible=function(e){return!e.controlWidget.isAncestorHidden(e)},r.prototype._shouldRenderControl=function(e){return!(!e||!e.initialized)&&(!t.isDelayControlRenderingEnabled||(!!this._renderManager||this._controlInstanceVisible(e)&&this._controlAncestorsVisible(e)))},r.prototype._shouldRenderNullOutput=function(e){return e.control&&Core.Utility.isFunction(e.control.shouldSkipViewRendering)&&e.control.shouldSkipViewRendering()},r.prototype._renderControlComponent=function(){var n=t.ResolveControlComponent(this.props.controlInstance.type),o=React.createElement(n,__assign({},this.props,{bindKeyboardShortcuts:this._bindKeyboardShortcuts,unbindKeyboardShortcuts:this._unbindKeyboardShortcuts},this.state,{overrideStyle:this._overrideStyle}));if(this.state.autoBorders||this.state.autoFill||this.state.autoDropShadow){var i=this.state.autoFill?this.state.fill:null,a=!!this.controlContext.viewState&&this.controlContext.viewState.displayMode()!==e.Constants.DisplayMode.Edit;return React.createElement(t.ControlBorder,__assign({},this.state,{fill:i,disabled:a,shouldAcceptFocus:r._shouldControlBorderAcceptFocus}),o)}return o},r.prototype._handleNullRenderComponentRef=function(e){e?this.controlContext?this._initComponent():Core.Log.warningEx("SingleControlContainer._handleNullRenderComponentRef","Expected control context when null render component mounted"):this._disposeComponent()},r.prototype._handleComponentElementRef=function(e){e?this.controlContext?this._initComponentElement(e):Core.Log.warningEx("SingleControlContainer._handleComponentElementRef","Expected control context when component element mounted"):this._disposeComponentElement()},r.prototype._initVisiblePropertySubscription=function(){var t=this;if(!this._visiblePropertySubscription){var n=this.controlContext;if(!n.modelProperties.Visible)return;this._visiblePropertySubscription=n.controlWidget.addPropertyChangeCallback(e.AuthoringTool.OpenAjaxPropertyNames.Visible,(function(e){if(e&&t._shouldRenderControl(n)){var o=r._useLegacyDelayControlRendering.value;o&&t._disposeVisiblePropertySubscription();var i=n.instanceId;t._renderManager||Core.UI.ControlsStateScheduler.schedule((function(){if(!t._renderManager&&(o?n.initialized:t._shouldRenderControl(n))&&n.instanceId===i){o||t._disposeVisiblePropertySubscription();var e=r._getRenderManager(t.props),a=t._setRenderManagerAndExtractStateProps(e);t._updateState(a)}}))}}))}},r.prototype._disposeVisiblePropertySubscription=function(){this._visiblePropertySubscription&&(this._visiblePropertySubscription.dispose(),this._visiblePropertySubscription=null)},r.prototype._setRenderManagerAndExtractStateProps=function(e){return this._renderManager=e,this._renderManager.registerControlComponent(this),r._extractStateProps(this._renderManager.renderProps)},r.prototype._releaseRenderManager=function(){this._renderManager&&this._renderManager.unregisterControlComponent(this)},r.prototype._initControlContext=function(e){var t=this.controlContext;t._windowResizeHandler&&Core.UI.addResizeHandler(t._windowResizeHandler),t.realized||this._controlComponentHandlesRealized(e)||(t.realized=!0)},r.prototype._disposeControlContext=function(){var e=this.controlContext;e.realized&&!this._controlComponentHandlesRealized(this.props)&&(e.realized=!1),e._windowResizeHandler&&Core.UI.removeResizeHandler(e._windowResizeHandler)},r.prototype._initComponent=function(){this._renderManager.componentDidMount(),this._initControlContext(this.props),this._componentInitialized=!0},r.prototype._disposeComponent=function(){this._renderManager&&(this._renderManager.componentWillUnmount(),this._renderManager=null),this._componentInitialized=!1},r.prototype._initComponentElement=function(e){this._componentElement=e,this._addPointerEventListeners(),this._attachMousetrap(),this._initComponent()},r.prototype._disposeComponentElement=function(){this._disposeComponent(),this._componentElement&&(this._detachMousetrap(),this._removePointerEventListeners(),this._componentElement=null)},r.prototype._disposeComponentOrComponentElement=function(){this._componentElement?this._disposeComponentElement():this._componentInitialized&&this._disposeComponent()},r.prototype._addPointerEventListeners=function(){this._renderManager.renderProps.autoPointerViewState&&(this._visualStateTracker=new Core.UI.VisualStateTracker({target:this._componentElement,stateChangedCallback:this._renderManager.updateViewState.bind(this._renderManager),useCssAfterSelector:!0}))},r.prototype._removePointerEventListeners=function(){this._visualStateTracker&&(this._visualStateTracker.dispose(),this._visualStateTracker=null)},r.prototype._processAndGetAutoLayoutProperties=function(e){var t,n,o,r,i,a={isInAutoLayoutContainer:this._isInAutoLayoutContainer};if(!a.isInAutoLayoutContainer)return a;var s=null!==(t=this.props.controlContext.properties)&&void 0!==t?t:{},l=this.props.controlInstance.control.OpenAjax.parentControlWidget;return a.parentDirection=l.getPropertyValue("LayoutDirection"),a.parentAlignItems=l.getPropertyValue("LayoutAlignItems"),a.flexGrow=null===(n=s.FillPortions)||void 0===n?void 0:n.call(s),a.minHeight=null===(o=s.LayoutMinHeight)||void 0===o?void 0:o.call(s),a.minWidth=null===(r=s.LayoutMinWidth)||void 0===r?void 0:r.call(s),a.alignSelf=null===(i=s.AlignInContainer)||void 0===i?void 0:i.call(s),a},Object.defineProperty(r.prototype,"_isInAutoLayoutContainer",{get:function(){return Core.Environment.isWebAuthoring()||void 0===this._cachedIsInAutoLayoutContainerValue?this._cachedIsInAutoLayoutContainerValue=this._getAutoLayoutValueFromParent():this._cachedIsInAutoLayoutContainerValue},enumerable:!1,configurable:!0}),r.prototype._getAutoLayoutValueFromParent=function(){var t,n,o=null===(t=this.props.controlInstance.control)||void 0===t?void 0:t.OpenAjax.parentControlWidget;return(null==o?void 0:o.template.className)===AppMagicUI.Constants.GroupContainerClassName&&(n=null==o?void 0:o.getPropertyValue("LayoutMode")),n===e.Constants.LayoutMode.Auto},r._useLegacyDelayControlRendering=new Core.Lazy((function(){return Core.FallbackSwitch.isActivated("AppRuntime.LegacyDelayControlRendering")})),r}(t.ControlContainerBase);t.SingleControlContainer=o}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=aphrodite.StyleSheet.create({container:{top:0,left:0,right:0,position:"absolute"},containerFullSize:{top:0,left:0,right:0,bottom:0}}),o=function(o){function r(e){var t=this;return(t=o.call(this,e)||this)._renderChildControl=t._renderChildControl.bind(t),t}return __extends(r,o),r.prototype.render=function(){var t=this.props.controlInstance,o=e.Constants.Controls.CanvasContentDivClassName;if(this.containerStyles){var r=aphrodite.StyleSheet.create({container:this.containerStyles});o+=" ".concat(aphrodite.css(r.container))}var i=this.containerClassNames;i&&(o+=" ".concat(i.join(" ")));var a=[n.container];this.shouldChildControlContainerBeFullWidth&&a.push(n.containerFullSize);var s=t.control.OpenAjax.controlName;return React.createElement("div",__assign({"data-container-name":"".concat(s,"-container"),className:o},this._getContainerDataAttributes(),{lang:this._contentLanguage}),React.createElement("div",{className:aphrodite.css(a)},this.getChildControls()))},Object.defineProperty(r.prototype,"containerStyles",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"shouldChildControlContainerBeFullWidth",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"containerClassNames",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"controlWidget",{get:function(){return this.props.controlInstance.control},enumerable:!1,configurable:!0}),r.prototype.getChildControls=function(e){var t=this;return void 0===e&&(e={}),this.props.controlInstance.childIds.map((function(n){return t._renderChildControl(t.props.getControl(n),e)}))},Object.defineProperty(r.prototype,"_contentLanguage",{get:function(){},enumerable:!1,configurable:!0}),r.prototype._getContainerDataAttributes=function(){var e=this.props.isRootContainer,n=void 0!==e&&e;return t.getContainerDataAttributes(n)},r.prototype._renderChildControl=function(e,n){void 0===n&&(n={});var o=this.props,r=o.getControl,i=o.bindingContext,a=o.textDirection;if(!e||t.isNonVisualControl(e.type))return null;var s=e.control,l=s.OpenAjax.reactRenderDataStore,c=s.OpenAjax.getControlContext(i);return React.createElement(t.SingleControlContainer,{key:s.OpenAjax.uniqueId,controlContext:c,controlInstance:e,getControl:r,textDirection:a,reactRenderDataStore:l,styleOverrides:n})},r}(React.Component);t.ControlsContainer=o}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){t.getSingleControlContainerElement=function(t){for(var n=t;null!==n;){if(n.classList.contains(e.Constants.Controls.CanvasContentDivClassName)&&n.hasAttribute(e.Constants.ControlIdDataAttribute))return"AppMagic.Controls.Screen"===OpenAjax.widget.controlManager.getControlInstanceById(n.getAttribute(e.Constants.ControlIdDataAttribute)).type?null:n;n=n.parentElement}return null}}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n,o=Core.Utility.Color,r=e.AuthoringTool.OpenAjaxPropertyNames;!function(e){e[e.Controls=0]="Controls",e[e.Data=1]="Data",e[e.None=2]="None"}(n=t.LoadingSpinnerEnum||(t.LoadingSpinnerEnum={})),function(e){e[e.Off=0]="Off",e[e.On=1]="On"}(t.OptimizeForDevicesEnum||(t.OptimizeForDevicesEnum={}));var i,a=function(o){function i(e){var t=o.call(this,e)||this;e.isActive&&t._startRenderTimeScenario();var n=e.controlInstance.control;return t.state=n.getInitialState(),t}return __extends(i,o),i.prototype.getChildControls=function(){var e=this.props,r=e.isAnimating,i=e.controlInstance,a=e.renderChildren,s=e.renderChildrenWhileLoading,l=this.state,c=l.loadingSpinner,p=l.loadingSpinnerColor,u=l.allChildrenAdded,d=l.isDataLoaded,h=c===n.Controls||c===n.Data,C=a&&(!h||s)?o.prototype.getChildControls.call(this):[];return h&&C.push(React.createElement(t.LoadingSpinner,{key:"".concat(i.id,"loadingSpinner"),color:p,zIndex:C.length+1,visible:r||!u||!d})),C},Object.defineProperty(i.prototype,"containerStyles",{get:function(){var e=this.state,t=e.fill,n=e.backgroundImage,o=e.imagePosition,r={backgroundColor:t,width:"100%",height:"100%"};return n&&(r.backgroundImage='url("'.concat(n,'"), linear-gradient(').concat(t," 0%, ").concat(t," 100%)"),r.backgroundPosition=o.position,r.backgroundRepeat=o.repeat,r.backgroundSize=o.size),r.display=this.props.isActive?"block":"none",r},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"shouldChildControlContainerBeFullWidth",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"containerClassNames",{get:function(){return this.props.isActive?["activeScreen"]:[]},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"_contentLanguage",{get:function(){return this.state.contentLanguage||void 0},enumerable:!1,configurable:!0}),i.prototype._getContainerDataAttributes=function(){var e=this.props.controlContext.controlWidget;return __assign(__assign({},o.prototype._getContainerDataAttributes.call(this)),{"data-control-id":e.uniqueId,"data-control-name":e.controlName})},i.prototype.componentDidMount=function(){var n;this._runOnceOnActiveRender(),this._recordRenderTime();var o=this.props,r=o.controlInstance,i=o.controlContext;(null===(n=e.DocumentLayout.getInstance())||void 0===n?void 0:n.layoutEngine.responsiveLayoutEnabled)&&i._windowResizeHandler&&Core.UI.addResizeHandler(i._windowResizeHandler);var a=r.control;a.registerReactComponent(this),i.isTemplate&&(i._accessibilityContainer=new t.ControlAccessibilityContainer(i.controlWidget.uniqueId,i.controlWidget.uniqueId,i.controlWidget.parentUniqueId,i.controlWidget.parentUniqueId,0,0,!0),t.AccessibilityManager.registerContainer(i._accessibilityContainer)),a.beforeComponentRender(),this._awaitForAllDataCalls()},i.prototype.componentDidUpdate=function(){this._runOnceOnActiveRender(),this._recordRenderTime(),this._awaitForAllDataCalls()},i.prototype.componentWillReceiveProps=function(e){!this.props.isActive&&e.isActive?(this.props.controlInstance.control.beforeComponentRender(),this._startRenderTimeScenario()):this.props.isActive&&!e.isActive&&this._cancelRenderTimeScenario("Screen is no longer active.")},i.prototype.componentWillUnmount=function(){var n=this.props,o=n.controlInstance,r=n.controlContext;this._dataLoadedPromise&&(this._dataLoadedPromise.cancel(),this._dataLoadedPromise=null),e.DocumentLayout.getInstance()&&e.DocumentLayout.getInstance().layoutEngine.responsiveLayoutEnabled&&this.props.controlContext._windowResizeHandler&&Core.UI.removeResizeHandler(this.props.controlContext._windowResizeHandler),o.control.registerReactComponent(null),r._accessibilityContainer&&(t.AccessibilityManager.unregisterContainer(r._accessibilityContainer),r._accessibilityContainer.dispose(),r._accessibilityContainer=null),this._cancelRenderTimeScenario("Screen is unmounting. Is this expected?")},i.prototype._getFriendlyControlTypeId=function(t){var n,o,r,i,a,s,l,c,p;return null===t?"null":e.Utility.isPcfControl(null===(r=null===(o=null===(n=t.control)||void 0===n?void 0:n.OpenAjax)||void 0===o?void 0:o.template)||void 0===r?void 0:r.className)&&!(null===(i=t.control.OpenAjax)||void 0===i?void 0:i.template.isThirdPartyPcfControl)?"".concat(t.type,"/").concat(null!==(a=t.control.OpenAjax.template.name)&&void 0!==a?a:"unknown"):e.Utility.isDataCardTemplate(null===(c=null===(l=null===(s=t.control)||void 0===s?void 0:s.OpenAjax)||void 0===l?void 0:l.template)||void 0===c?void 0:c.name)?"".concat(t.type,"/").concat(null!==(p=t.control.OpenAjax.variantName)&&void 0!==p?p:"unknown"):t.type},i.prototype._runOnceOnActiveRender=function(){if(this.props.isActive){var e=this.props.controlInstance.control;e.hasActiveRenderRunOnce||(e.setActiveRenderRunOnce(),this._notifyAppLifecycleScreenEvents(),this._setFirstRenderCompleted())}},i.prototype._notifyAppLifecycleScreenEvents=function(){var e=this.props,t=e.appLifecycleEvents,n=e.isFirstNavigate;t&&n&&(t.onFirstOrStartingScreenMounted(),Core.UI.Utility.execAfterPaint((function(){t.onFirstOrStartingScreenPainted()})))},i.prototype._setFirstRenderCompleted=function(){var e=this.props.controlInstance.control;e.hasFirstRenderCompleted||Core.UI.Utility.execAfterPaint((function(){e.OpenAjax.isLoaded&&!e.hasFirstRenderCompleted&&e.setFirstRenderCompleted()}))},i.prototype._recordRenderTime=function(){var e=this,t=this._renderScenarioGuid;if(t){this._renderScenarioGuid=null;var n=this._getCustomRenderScenarioData();Core.UI.Utility.execAfterPaint((function(){return e._endRenderTimeScenario(t,n)}))}},i.prototype._startRenderTimeScenario=function(){this._cancelRenderTimeScenario("A new render time scenario was started.");var e=this.props.controlInstance.control.OpenAjax.uniqueId;this._renderScenarioGuid=Core.Telemetry.Log.startScenario(Core.Telemetry.ScenarioName.ScreenControlRenderTime,{controlUniqueId:e})},i.prototype._endRenderTimeScenario=function(e,t){Core.Utility.isGuid(e)&&Core.Telemetry.Log.endScenario(e,{customScenarioData:t})},i.prototype._cancelRenderTimeScenario=function(e){Core.Utility.isGuid(this._renderScenarioGuid)&&(Core.Telemetry.Log.cancelScenario(this._renderScenarioGuid,{message:e}),this._renderScenarioGuid=null)},i.prototype._getCustomRenderScenarioData=function(){var e=this,t=this.props.controlInstance.control.OpenAjax,n=t.uniqueId,o=t.controlManager,r=o.controlInstancesFlatTree,i={},a=o.getAllChildControlIds(n);a.forEach((function(t){var n,o=r[t],a=e._getFriendlyControlTypeId(o);i[a]=(null!==(n=i[a])&&void 0!==n?n:0)+1}));var s={},l=o.getAllDescendantControlIds(n);return l.forEach((function(t){var n,o=r[t],i=e._getFriendlyControlTypeId(o);s[i]=(null!==(n=s[i])&&void 0!==n?n:0)+1})),{childrenCount:a.length,childrenCountTypes:i,descendantCount:l.length,descendantCountTypes:s}},i.prototype._awaitForAllDataCalls=function(){var t=this,o=this.props,i=o.bindingContext,a=o.controlInstance,s=this.state.loadingSpinner,l=a.control;if(!this._dataLoadedPromise&&l.shouldWaitForDataLoad&&s===n.Data&&!Core.FallbackSwitch.isActivated("Controls.ScreenLoadingSpinnerData")){var c=a.control,p=c.OpenAjax,u=p.controlManager,d=p.uniqueId;this._dataLoadedPromise=Core.PromiseUtils.createCancellablePromise(),this._dataLoadedPromise.promise.then((function(){l.shouldWaitForDataLoad=!1,t.setState({isDataLoaded:!0}),t._dataLoadedPromise=null}));var h=u.getAllDescendantControlIds(d);Promise.allSettled([e.AuthoringTool.Runtime.waitForPendingDataRulesToExecuteAsync([i.id],__spreadArray(__spreadArray([],h,!0),[d],!1)),e.AuthoringTool.Runtime.waitFirstAppInfoOnStartCompletedAsync(),c.waitForFirstRenderAsync().then((function(){return e.AuthoringTool.Runtime.waitOnBehaviorPromiseAsync("".concat(d,".").concat(r.OnVisible),i.id)}))]).then((function(){var e;null===(e=t._dataLoadedPromise)||void 0===e||e.complete()}))}},i}(t.ControlsContainer);t.ScreenControl=a,function(e){e.DefaultFill="rgba(255, 255, 255, 1)"}(i||(i={}));var s=Core.Utility.WhiteColor.clone(),l=function(i){function a(){var e=i.call(this)||this;return e.getAuthoringCanvasPlaceHolder=e.getAuthoringCanvasPlaceHolder.bind(e),e._currentChildCount=0,e._skipChildAndDescendentsConstraints=!1,e._shouldWaitForDataLoad=!0,e._hasActiveRenderRunOnce=!1,e._firstRenderPromise=Core.PromiseUtils.createCancellablePromise(),e}return __extends(a,i),a.prototype.childControlsCanExpandForPrint=function(){return!0},a.prototype.calculatePrintHeight=function(e){var t=0;return this.forEachPrintableChildControlContext(e,(function(e){var n=e.modelProperties.Y.getValue(),o=e.modelProperties.Height.getValue();t=Math.max(t,n+o)})),t},a.prototype.getInitialState=function(){return{fill:this._fill||"rgba(255, 255, 255, 1)",backgroundImage:this._backgroundImage||"",imagePosition:this._imagePosition||{size:"100% 100%",repeat:"no-repeat",position:"center"},loadingSpinner:this._loadingSpinner,loadingSpinnerColor:this._loadingSpinnerColor||s,allChildrenAdded:!1,contentLanguage:this._contentLanguage,isDataLoaded:!this._shouldWaitForDataLoad||this._loadingSpinner!==n.Data||Core.FallbackSwitch.isActivated("Controls.ScreenLoadingSpinnerData")}},a.prototype.onUnload=function(){this._firstRenderPromise&&(this._firstRenderPromise.cancel(),this._firstRenderPromise=null)},a.prototype.initControlContext=function(t){var n=this;if(i.prototype.initControlContext.call(this,t),e.Utility.createOrSetPrivate(t,"_currentMediaRef",null),t.modelProperties&&t.modelProperties.Fill){var o=t.modelProperties.Fill.getValue();this.onChangeFill({oldValue:null,newValue:o,self:!1,property:"Fill"});var r=t.modelProperties.BackgroundImage.getValue();this.onChangeBackgroundImage({oldValue:null,newValue:r,self:!1,property:"BackgroundImage"},t);var a=t.modelProperties.ImagePosition.getValue();this.onChangeImagePosition({oldValue:null,newValue:a,self:!1,property:"ImagePosition"});var s=t.modelProperties.LoadingSpinner.getValue();this.onChangeLoadingSpinner({oldValue:null,newValue:s,self:!1,property:"LoadingSpinner"});var l=t.modelProperties.LoadingSpinnerColor.getValue();this.onChangeLoadingSpinnerColor({oldValue:null,newValue:l,self:!1,property:"LoadingSpinnerColor"});var c=t.modelProperties.ContentLanguage.getValue();if(this.onChangeContentLanguage({oldValue:null,newValue:c,self:!1,property:"ContentLanguage"}),d()){var u=p();u&&(u.overflow="hidden")}t._screenActiveSubscription=t.isParentScreenActive.subscribe((function(e){return n._onNavigate(t,e)}),this),t.modelProperties.Name.setValue(t.controlWidget.getId())}},a.prototype.disposeControlContext=function(e){e._currentMediaRef&&(e._currentMediaRef.dispose(),e._currentMediaRef=null),e._screenActiveSubscription&&(e._screenActiveSubscription.dispose(),e._screenActiveSubscription=null)},a.prototype.onChangeFill=function(e){var t=null;null!==e.newValue&&(t=o.create(e.newValue).toCss());this._fill=t||"rgba(255, 255, 255, 1)",this.updateComponentState("fill",this._fill)},a.prototype.onChangeBackgroundImage=function(t,n){var o=this;e.Utility.createMediaReferenceAsync(t.newValue).then((function(e){n._currentMediaRef&&n._currentMediaRef.dispose();var t=e?e.url.toString():"";n._currentMediaRef=e,o._backgroundImage=t,o.updateComponentState("backgroundImage",o._backgroundImage)})).catch((function(){}))},a.prototype.onChangeImagePosition=function(t){var n=e.Controls.converters.imagePositionConverter.view(t.newValue);this._imagePosition=n,this.updateComponentState("imagePosition",this._imagePosition)},a.prototype.onChangeLoadingSpinner=function(e){this._loadingSpinner=e.newValue,this.updateComponentState("loadingSpinner",this._loadingSpinner)},a.prototype.onChangeLoadingSpinnerColor=function(e){var t=null;null!==e.newValue&&(t=o.create(e.newValue)),this._loadingSpinnerColor=t||s,this.updateComponentState("loadingSpinnerColor",this._loadingSpinnerColor)},a.prototype.onChangeContentLanguage=function(e){var t;this._contentLanguage=(null===(t=e.newValue)||void 0===t?void 0:t.toString())||"",this.updateComponentState("contentLanguage",this._contentLanguage)},a.prototype.onChangeWidth=function(e){if(null!==e.newValue){var t=e.newValue;t>=0&&t!==e.oldValue&&this._changeCanvasDimensions(t,r.Width),(d()||this._isResponsiveResizingInPreview())&&(t<=0&&Core.Telemetry.Log.trackUIActivityEvent("ScreenControl.onChangeWidth",{width:t}),this._updateCanvasHostWidth(t))}},a.prototype.onChangeHeight=function(e,t){if(null!==e.newValue&&i.prototype.onChangeHeight.call(this,e,t)){var n=e.newValue;n>=0&&n!==e.oldValue&&this._changeCanvasDimensions(n,r.Height),(d()||this._isResponsiveResizingInPreview())&&(n<=0&&Core.Telemetry.Log.trackUIActivityEvent("ScreenControl.onChangeHeight",{height:n}),this._updateCanvasHostHeight(n))}},a.prototype.skipChildConstraints=function(){return this._skipChildAndDescendentsConstraints},a.prototype.skipDescendentsConstraints=function(){return this._skipChildAndDescendentsConstraints},a.prototype._changeCanvasDimensions=function(e,t){var n=this._skipChildAndDescendentsConstraints;this._skipChildAndDescendentsConstraints=!0,this.OpenAjax.changeCanvasDimensions(e,t,!1),this._skipChildAndDescendentsConstraints=n},a.prototype.onChildAdded=function(e,n,o){this._currentChildCount++,this._evaluateAllChildrenAdded(),this._appMode!==t.AppMode.Publish&&this.OpenAjax.controlManager.executeShellAction({id:"UpdateAuthoringCanvasPlaceholder"})},a.prototype.onChildRemoved=function(e,n){this._currentChildCount--,this._evaluateAllChildrenAdded(),this._appMode!==t.AppMode.Publish&&this.OpenAjax.controlManager.executeShellAction({id:"UpdateAuthoringCanvasPlaceholder"})},a.prototype.beforeComponentRender=function(){this._evaluateAllChildrenAdded()},a.prototype.getAuthoringCanvasPlaceHolder=function(e,n){return t.doesControlHaveVisualChildren(this.OpenAjax)?null:this.OpenAjax.controlManager.shouldShowBlankScreenWatermark(e,n)?this.OpenAjax.controlManager.renderBlankScreenWatermark():this.OpenAjax.controlManager.renderAuthoringPlaceholder({controlId:this.OpenAjax.uniqueId,allowAddVisual:!0,allowConnectToData:!0})},Object.defineProperty(a.prototype,"hasActiveRenderRunOnce",{get:function(){return this._hasActiveRenderRunOnce},enumerable:!1,configurable:!0}),a.prototype.setActiveRenderRunOnce=function(){this._hasActiveRenderRunOnce=!0},Object.defineProperty(a.prototype,"hasFirstRenderCompleted",{get:function(){return!this._firstRenderPromise},enumerable:!1,configurable:!0}),a.prototype.setFirstRenderCompleted=function(){this._firstRenderPromise&&(this._firstRenderPromise.complete(),this._firstRenderPromise=null)},a.prototype.waitForFirstRenderAsync=function(){return this._firstRenderPromise?Core.PromiseUtils.preventCancel(this._firstRenderPromise.promise):Promise.resolve()},a.prototype._onNavigate=function(e,t){if(this._isActiveScreen=t,t&&(this._shouldWaitForDataLoad=!0,this._loadingSpinner!==n.Data||Core.FallbackSwitch.isActivated("Controls.ScreenLoadingSpinnerData")||this.updateComponentState("isDataLoaded",!1),d()||this._isResponsiveResizingInPreview())){var o=null==e?void 0:e.modelProperties;if(o){var r=o.Width.getValue(),i=o.Height.getValue();(r<=0||i<=0)&&Core.Telemetry.Log.trackUIActivityEvent("ScreenControl._onNavigate",{width:r,height:i}),Core.Utility.isDefined(r)&&this._updateCanvasHostWidth(r),Core.Utility.isDefined(i)&&this._updateCanvasHostHeight(i)}}},a.prototype._updateCanvasHostWidth=function(e){if(this._isActiveScreen)if(this._isResponsiveResizingInPreview()){var n=u();n&&(n.width="".concat(e,"px"))}else{var o=p();if(!o)return;var r=o.width,i=c(r),a=e*t.AppInfo.scaleFactor;o.width="".concat(a,"px"),(i<=0||a<=0)&&Core.Telemetry.Log.trackUIActivityEvent("ScreenControl._updateCanvasHostWidth",{scaleFactor:t.AppInfo.scaleFactor,unscaledWidth:e,scaledWidth:a,previousScaledWidth:i,width:o.width,previousWidth:r})}},a.prototype._updateCanvasHostHeight=function(e){if(this._isActiveScreen)if(this._isResponsiveResizingInPreview()){var n=u();n&&(n.height="".concat(e,"px"))}else{var o=p();if(!o)return;var r=o.height,i=c(r),a=e*t.AppInfo.scaleFactor;o.height="".concat(a,"px"),(i<=0||a<=0)&&Core.Telemetry.Log.trackUIActivityEvent("ScreenControl._updateCanvasHostHeight",{scaleFactor:t.AppInfo.scaleFactor,unscaledHeight:e,scaledHeight:a,previousScaledHeight:i,height:o.height,previousHeight:r})}},Object.defineProperty(a.prototype,"shouldWaitForDataLoad",{get:function(){return this._shouldWaitForDataLoad},set:function(e){this._shouldWaitForDataLoad=e},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"_appMode",{get:function(){return this.OpenAjax.controlManager.appModeObservable.peek()},enumerable:!1,configurable:!0}),a.prototype._isResponsiveResizingInPreview=function(){var n,o;return this._appMode===t.AppMode.Preview&&!1===(null===(o=null===(n=e.DocumentLayout.getInstance())||void 0===n?void 0:n.layoutEngine)||void 0===o?void 0:o.scaleToFit)},a.prototype._getVisualChildCount=function(){var e=this.OpenAjax,n=e.controlManager,o=e.uniqueId,r=n.controlInstancesFlatTree;return n.getAllChildControlIds(o).filter((function(e){var o=r[e];return o?t.isVisualControl(o.type):(n.reportMissingControlInstance(e,"ScreenControlWidget._getVisualChildCount"),!1)})).length},a.prototype._getVisibleChildCount=function(){var e=this.OpenAjax,n=e.controlManager,o=e.uniqueId,r=n.controlInstancesFlatTree;return n.getAllChildControlIds(o).filter((function(e){var o=r[e];if(!o)return n.reportMissingControlInstance(e,"ScreenControlWidget._getVisibleChildCount"),!1;if(t.isNonVisualControl(o.type))return!1;var i=o.control.OpenAjax.globalControlContext.modelProperties.Visible;return!i||i.getValue()})).length},a.prototype._evaluateAllChildrenAdded=function(){var t=e.Controls.isDelayControlRenderingEnabled?this._currentChildCount>=this._getVisibleChildCount():this._currentChildCount===this._getVisualChildCount();this.updateComponentState("allChildrenAdded",t)},a}(t.BaseReactControlWidget);function c(e){var t=/^\s*([+-]?(?:\d*[.])?\d+)px\s*$/.exec(e);return t?parseFloat(t[0]):void 0}function p(){if("undefined"==typeof document)return null;var e=document.getElementById("responsiveScalingCanvasHost");return null==e?void 0:e.style}function u(){if("undefined"==typeof document)return null;var e=document.querySelector("#content-host .animated-canvas-scaler");return null==e?void 0:e.style}function d(){return!Core.Environment.isAuthoringTool()&&e.DocumentLayout.getInstance()&&!e.DocumentLayout.getInstance().layoutEngine.scaleToFit}t.ScreenControlWidget=l,t.ScreenControlWithAppLifecycleEvents=e.Controls.withAppLifecycleEvents(e.Controls.ScreenControl),e.Controls.RegisterReactConvertedControl("AppMagic.Controls.Screen",e.Controls.ScreenControlWidget,t.ScreenControlWithAppLifecycleEvents,(function(){return!0}))}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n,o=Core.Utility.Color,r=e.AuthoringTool.OpenAjaxPropertyNames,i=function(n){function o(e){var t=n.call(this,e)||this,o=e.controlInstance;return t.state=o.control.getInitialState(),t}return __extends(o,n),o.prototype.getChildControls=function(){if(!this.props.renderChildren)return[];var e=this.props.controlInstance.control.OpenAjax.componentDefinitionUniqueId;if(e){var t=this.props.getControl(e);return t?t.childIds.map(this._renderChildControlInternal.bind(this)):[]}return this.props.controlInstance.childIds.map(this._renderChildControlInternal.bind(this))},o.prototype._renderChildControlInternal=function(e){var n=this.props,o=n.controlContext,r=n.getControl,i=n.controlInstance,a=n.textDirection,s=o&&o.bindingContext,l=r(e);if(!l||t.isNonVisualControl(l.type))return null;var c=l.control,p=c.OpenAjax.reactRenderDataStore,u=i.control.OpenAjax.componentDefinitionName,d=u?t.ContextManager.getOrCreateComponentContext(s||t.GlobalContextManager.bindingContext,i.name,u,i.id):t.GlobalContextManager.bindingContext,h=c.OpenAjax.getOrCreateControlContext(d);return React.createElement(t.SingleControlContainer,{bindingContext:d,key:c.OpenAjax.uniqueId,controlContext:h,controlInstance:l,getControl:r,textDirection:a,reactRenderDataStore:p})},Object.defineProperty(o.prototype,"containerStyles",{get:function(){var e={width:"100%",height:"100%",backgroundColor:this.state.fill};return e.display=this.props.isActive?"block":"none",e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"shouldChildControlContainerBeFullWidth",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"containerClassNames",{get:function(){return this.props.isActive?["activeComponent"]:[]},enumerable:!1,configurable:!0}),o.prototype.componentWillUnmount=function(){var t,n=this.props.controlInstance;e.DocumentLayout.getInstance()&&e.DocumentLayout.getInstance().layoutEngine.responsiveLayoutEnabled&&this.props.controlContext._windowResizeHandler&&Core.UI.removeResizeHandler(this.props.controlContext._windowResizeHandler),n.control.registerReactComponent(null),null===(t=this._accessibilityContainerDisposeFn)||void 0===t||t.call(this),this._accessibilityContainerDisposeFn=null},o.prototype.componentDidMount=function(){var n=this.props,o=n.controlInstance,r=n.controlContext;o.control.registerReactComponent(this),r.isTemplate&&(this._accessibilityContainerDisposeFn=t.AccessibilityHelper.initializeAccessibilityContainer(r)),e.DocumentLayout.getInstance()&&e.DocumentLayout.getInstance().layoutEngine.responsiveLayoutEnabled&&this.props.controlContext._windowResizeHandler&&Core.UI.addResizeHandler(this.props.controlContext._windowResizeHandler)},o.defaultProps={isActive:!0,renderChildren:!0},o}(t.ControlsContainer);t.ComponentControl=i,function(e){e.DefaultFill="rgba(255, 255, 255, 1)"}(n||(n={}));var a=function(n){function i(){var e=n.call(this)||this;return e.getAuthoringCanvasPlaceHolder=e.getAuthoringCanvasPlaceHolder.bind(e),e._skipChildAndDescendentsConstraints=!1,e}return __extends(i,n),i.prototype.getInitialState=function(){return{fill:this._fill||"rgba(255, 255, 255, 1)"}},i.prototype.initControlContext=function(t){if(n.prototype.initControlContext.call(this,t),e.Utility.createOrSetPrivate(t,"_currentMediaRef",null),t.modelProperties&&t.modelProperties.Fill){var o=t.modelProperties.Fill.getValue();this.onChangeFill({oldValue:null,newValue:o,self:!1,property:"Fill"})}},i.prototype.disposeControlContext=function(e){e._currentMediaRef&&e._currentMediaRef.dispose()},i.prototype.onChangeFill=function(e){var t=null;null!==e.newValue&&(t=o.create(e.newValue).toCss());this._fill=t||"rgba(255, 255, 255, 1)",this.updateComponentState("fill",this._fill)},i.prototype.onChangeHeight=function(e){if(null!==e.newValue&&!this.OpenAjax.componentDefinitionName){var t=e.newValue;t>=0&&t!==e.oldValue&&this.OpenAjax.changeCanvasDimensions(t,r.Height)}},i.prototype.onChangeWidth=function(e){if(null!==e.newValue&&!this.OpenAjax.componentDefinitionName){var t=e.newValue;t>=0&&t!==e.oldValue&&this.OpenAjax.changeCanvasDimensions(t,r.Width)}},i.prototype.onChange=function(e,t){if(e.newValue!==e.oldValue&&t.controlWidget.isComponentInstance){var n=t.controlWidget.template.inputProperties.find((function(t){return t.propertyInvariantName===e.property}));n&&n.isResettable&&this.resetControl(t)}},i.prototype.onChangeX=function(e,t){t.realized&&this._onChangeLocation(t)},i.prototype.onChangeY=function(e,t){t.realized&&this._onChangeLocation(t)},i.prototype._onChangeLocation=function(e){e._accessibilityContainer&&t.AccessibilityHelper.updateLocation(e._accessibilityContainer,e)},i.prototype.resetControl=function(e){this._getComponentInstanceControlContext(e).behaviors.OnReset()},i.prototype.onChildAdded=function(e,n,o){this.OpenAjax.controlManager.appModeObservable.peek()!==t.AppMode.Publish&&this.OpenAjax.controlManager.executeShellAction({id:"UpdateAuthoringCanvasPlaceholder"})},i.prototype.onChildRemoved=function(e,n){this.OpenAjax.controlManager.appModeObservable.peek()!==t.AppMode.Publish&&this.OpenAjax.controlManager.executeShellAction({id:"UpdateAuthoringCanvasPlaceholder"})},i.prototype.getAuthoringCanvasPlaceHolder=function(){return t.doesControlHaveVisualChildren(this.OpenAjax)?null:this.OpenAjax.controlManager.renderAuthoringPlaceholder({controlId:this.OpenAjax.uniqueId,allowAddVisual:!0,allowConnectToData:!0})},i.prototype.skipChildConstraints=function(){return this._skipChildAndDescendentsConstraints},i.prototype.skipDescendentsConstraints=function(){return this._skipChildAndDescendentsConstraints},i.prototype.setSkipChildAndDescendentsConstraints=function(e){this._skipChildAndDescendentsConstraints=this.OpenAjax.isComponentDefinition&&e},i.prototype._getComponentInstanceControlContext=function(e){var n=this.OpenAjax;if(e.controlWidget===n)return e;var o=e.controlWidget.getId(),r=e.controlWidget.componentDefinitionName,i=t.ContextManager.getOrCreateComponentContext(e.bindingContext,o,r,e.controlWidget.uniqueId);return e.controlWidget.getOrCreateControlContext(i)},i}(t.BaseReactControlWidget);t.ComponentControlWidget=a,e.Controls.RegisterReactConvertedControl("AppMagic.Controls.Component",e.Controls.ComponentControlWidget,e.Controls.ComponentControl,(function(){return!0}))}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=Core.UI.StyleHelpers.joinClasses,n=function(e){function n(t){var n=e.call(this,t)||this;return n._ref=React.createRef(),n}return __extends(n,e),n.prototype.render=function(){var e=this.props,n=e.color,o=e.zIndex,r=e.visible,i=this._getLoadingSpinnerStyles(),a=n.clone();a.a<.5?a.a=.7:a.a=Math.round(100*(-.8*(n.a-.5)+.7))/100;var s=r?i.visible:i.hidden,l=r?i.animationStart:i.animationStop;return React.createElement("div",{ref:this._ref,className:t(i.spinnerOverlay,s),style:{zIndex:o}},React.createElement("div",{className:t(i.spinnerCircle,l),style:{borderColor:a.toCss(),borderTopColor:n.toCss()}}))},n.prototype.hide=function(){this._setElementVisibility(!1)},n.prototype.show=function(){this._setElementVisibility(!0)},n.prototype._setElementVisibility=function(e){var n=this._ref.current;if(n){var o=this._getLoadingSpinnerStyles(),r=t(o.spinnerOverlay,e?o.visible:o.hidden);n.className!==r&&(n.className=r);var i=n.firstElementChild,a=t(o.spinnerCircle,e?o.animationStart:o.animationStop);i.className!==a&&(i.className=a)}},n.prototype._getLoadingSpinnerStyles=function(){return o({transitionDelay:this.props.transitionDelay,capturePointerEvents:this.props.capturePointerEvents})},n.defaultProps={transitionDelay:250,capturePointerEvents:!0},n}(React.PureComponent);e.LoadingSpinner=n;var o=Core.UI.StyleHelpers.createParameterizedCachedStylesFactoryMethod((function(e){var t=Math.round(e.transitionDelay)/1e3;return{spinnerOverlay:{position:"absolute",top:0,bottom:0,left:0,right:0,backgroundColor:"rgba(255, 255, 255, 0.1)",opacity:1},visible:{pointerEvents:e.capturePointerEvents?"auto":"none",transition:"opacity 0.1s linear",transitionDelay:"".concat(t,"s")},hidden:{pointerEvents:"none",opacity:0},spinnerCircle:{position:"absolute",top:"50%",left:"50%",marginTop:"-".concat(42,"px"),marginLeft:"-".concat(42,"px"),boxSizing:"border-box",borderRadius:"50%",width:"".concat(84,"px"),height:"".concat(84,"px"),borderWidth:"8px",borderStyle:"solid",animationDuration:"1.3s",animationIterationCount:"infinite",transition:"cubic-bezier(0.53, 0.21, 0.29, 0.67)"},animationStart:{animationName:[{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}]},animationStop:{animationName:"none"}}}))}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=e.AuthoringTool.Animation.ScreenTransitionType,o={controlContext:null,bindingContext:null,controlInstance:null,getControl:null,textDirection:"ltr"};t.ExtractStateProps=function(e){var t={};return Object.keys(e).forEach((function(n){null!==o[n]&&(t[n]=e[n])})),t};var r={position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:Core.UI.StyleConstants.ColorWhite,visibility:"visible"};var i=function(o){function i(e){var t=this,n=(t=o.call(this,e)||this).props.textDirectionObservable;return t._textDirectionSubscription=n.subscribe((function(e){t.setState({textDirection:e})})),t.state={currentScreenName:"",previousScreenName:"",animatingScreenName:"",currentRenderScreenNames:[],previousRenderScreenNames:[],transitionType:null,renderAnimatingScreenChildren:!0,unmountScreens:!1,textDirection:n.peek()},t._globalThemeChange=t._globalThemeChange.bind(t),t._renderAppScreen=t._renderAppScreen.bind(t),t._onScreenAnimationComplete=t._onScreenAnimationComplete.bind(t),t._screenTitle=React.createRef(),t._navigateToScreenCallback=Core.Environment.getRuntimeCapabilityCallback("NavigateToScreen"),t}return __extends(i,o),Object.defineProperty(i.prototype,"currentScreenName",{get:function(){return this.state.currentScreenName},enumerable:!1,configurable:!0}),i.prototype.unmountScreens=function(){this.state.unmountScreens||this.setState({unmountScreens:!0,currentRenderScreenNames:[],previousRenderScreenNames:[]})},i.prototype.mountScreens=function(){this.state.unmountScreens&&this.setState({unmountScreens:!1,currentRenderScreenNames:[this.state.currentScreenName]})},i.prototype.navigateToScreen=function(e,o){var r,i,a,s,l=this.state,c=l.currentScreenName,p=l.currentRenderScreenNames;if(!Core.Environment.isDefaultRenderMode()){var u=null===(r=this.props.getControl(c))||void 0===r?void 0:r.control;if(u){var d=this.props.getControl(e).control;(null!==(i=u.OpenAjax.optimizeForDevices)&&void 0!==i?i:t.OptimizeForDevicesEnum.Off)!==(null!==(a=d.OpenAjax.optimizeForDevices)&&void 0!==a?a:t.OptimizeForDevicesEnum.Off)&&(o=n.None)}}var h="";o&&(h=o!==n.Uncover&&o!==n.UncoverRight?e:c);var C=!o||o===n.None,g=this._getScreenNamesToRender(e,p);this.setState({previousScreenName:c,currentScreenName:e,animatingScreenName:h,currentRenderScreenNames:g,previousRenderScreenNames:p,transitionType:o,renderAnimatingScreenChildren:C}),null===(s=this._navigateToScreenCallback)||void 0===s||s.call(this,e,c,o)},i.prototype.refreshCurrentScreen=function(){this.forceUpdate()},i.prototype.componentWillUnmount=function(){this._textDirectionSubscription.dispose(),this._textDirectionSubscription=null},i.prototype.render=function(){var n=this.props.controlInstance;if(this._updateCanvasTextDirection(this.state.textDirection),this.state.unmountScreens)return null;var o=React.createElement("div",{className:e.Constants.CanvasControlCssClass,style:r},this._renderTitle(),n.childIds.map(this._renderAppScreen));return t.shouldInjectThemeWrapper()?React.createElement(t.ThemeWrapperHelper,{textDirection:this.state.textDirection,globalThemeChange:this._globalThemeChange},o):o},i.prototype._globalThemeChange=function(){this.forceUpdate()},i.prototype._updateCanvasTextDirection=function(t){var n=document.getElementById(e.Constants.PublishedCanvasId);n.getAttribute("dir")!==t&&n.setAttribute("dir",t)},i.prototype._renderTitle=function(){return React.createElement("div",{ref:this._screenTitle,className:"a11y",tabIndex:-1,"aria-label":this.state.currentScreenName},this.state.currentScreenName)},i.prototype._renderAppScreen=function(n){var o,r=this.props.getControl,i=this.state,a=i.textDirection,s=i.currentScreenName,l=i.previousScreenName,c=i.animatingScreenName,p=i.currentRenderScreenNames,u=i.previousRenderScreenNames,d=i.transitionType,h=i.renderAnimatingScreenChildren,C=r(n),g=C.name,m=-1!==p.indexOf(g),f=c!==g||h||-1!==u.indexOf(g);return o=C,(e.Utility.isScreen(o.control.OpenAjax.template.name)||o.control.OpenAjax.template.isComponent)&&React.createElement(t.AppScreen,{key:C.id,controlInstance:C,getControl:r,textDirection:a,activeScreenName:s,previousScreenName:l,animatingScreenName:c,transitionType:d,renderChildren:m,renderChildrenWhileLoading:f,onAnimationComplete:this._onScreenAnimationComplete})},i.prototype._onScreenAnimationComplete=function(){var e=this;this.setState({animatingScreenName:"",transitionType:n.Empty},(function(){e.setState({renderAnimatingScreenChildren:!0}),e._recoverFocusIfNeeded()}))},i.prototype._recoverFocusIfNeeded=function(){var e=this._screenTitle.current;e&&document.activeElement===document.body&&e.focus()},i.prototype._getScreenNamesToRender=function(t,n){var o=n.filter((function(e){return e!==t})),r=e.Controls.maxScreensToRender();return o.length>=r&&o.splice(0,o.length-r+1),o.push(t),o},i}(React.PureComponent),a=function(){function e(){this._canvasControlRef=React.createRef()}return Object.defineProperty(e.prototype,"canvasControlRef",{get:function(){return this._canvasControlRef},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentScreenName",{get:function(){return this._canvasControlRef.current?this._canvasControlRef.current.currentScreenName:""},enumerable:!1,configurable:!0}),e.prototype.navigateToScreen=function(e,t){if(this._canvasControlRef.current)return this._canvasControlRef.current.navigateToScreen(e,t)},e.prototype.unmountScreens=function(){var e;null===(e=this._canvasControlRef.current)||void 0===e||e.unmountScreens()},e.prototype.mountScreens=function(){var e;null===(e=this._canvasControlRef.current)||void 0===e||e.mountScreens()},e.prototype.refreshCurrentScreen=function(){var e;null===(e=this._canvasControlRef.current)||void 0===e||e.refreshCurrentScreen()},e}(),s=function(e){var n=e.appLifecycleEvents,o=e.canvasControlRef,r=e.controlInstance,a=e.getControl,s=e.textDirectionObservable,l=t.useMemoizedItemMeasurerContextForCanvas();return React.createElement(t.AppLifecycleEvents.Provider,{value:n},React.createElement(t.ItemMeasurerContext.Provider,{value:l},React.createElement(i,{ref:o,getControl:a,controlInstance:r,textDirectionObservable:s})))};t.initializePublishedCanvas=function(n,o){var r=n.textDirectionObservable,i=n.getControlInstance.bind(n),l=n.appRootInstance,c=new a,p=React.createElement(t.ErrorBoundary,null,React.createElement(s,{canvasControlRef:c.canvasControlRef,getControl:i,controlInstance:l,textDirectionObservable:r,appLifecycleEvents:o}));return ReactDOM.render(p,document.getElementById(e.Constants.PublishedCanvasId)),c}}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=e.AuthoringTool.Animation.ScreenTransitionType;var o=function(o){function r(e){var t=o.call(this,e)||this;return t._onScreenAnimationComplete=t._onScreenAnimationComplete.bind(t),t}return __extends(r,o),r.prototype.render=function(){var o=this.props,r=o.controlInstance,i=o.getControl,a=o.textDirection,s=o.activeScreenName,l=o.animatingScreenName,c=o.previousScreenName,p=o.transitionType,u=o.renderChildren,d=o.renderChildrenWhileLoading,h=r.control,C=h.OpenAjax;if(!Core.Environment.isDefaultRenderMode(!0)&&C.optimizeForDevices===t.OptimizeForDevicesEnum.On)return null;var g=C.controlName,m=g===s,f=m||!!p&&g===c,y=f&&!c,_=g===l?p:n.Empty,v=f;l&&g!==l&&(v=!1);var b=h.OpenAjax.globalControlContext,x=b.bindingContext;return React.createElement(t.ScreenAnimationWrapper,{isTopScreen:v,transitionType:_,onAnimationComplete:this._onScreenAnimationComplete},function(t){return e.Utility.isScreen(t.control.OpenAjax.template.name)}(r)?React.createElement(t.ScreenControlWithAppLifecycleEvents,{isRootContainer:!0,bindingContext:x,controlContext:b,getControl:i,controlInstance:r,textDirection:a,isActive:f,isFirstNavigate:y,renderChildren:u||f,renderChildrenWhileLoading:d,isAnimating:m&&!!p&&p!==n.None}):React.createElement(t.ComponentControl,{isRootContainer:!0,bindingContext:x,controlContext:b,getControl:i,controlInstance:r,textDirection:a,isActive:f,renderChildren:u||f}))},r.prototype._onScreenAnimationComplete=function(){(0,this.props.onAnimationComplete)()},r}(React.Component);t.AppScreen=o}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=e.Controls.PlatformLibrary,o=e.Runtime.App,r={position:"absolute",zIndex:90210,width:"1px",height:"1px"};t.shouldInjectThemeWrapper=function(){var t;return!Core.FallbackSwitch.isActivated("AppRuntime.RenderWithoutThemeWrapper")&&Core.FeatureGates.controls.enablePreloadPlatformLibrariesAndUberWrapper&&void 0!==o&&(void 0!==(null===(t=window[o.getPlatformLibraryWindowAlias(o.PlatformLibrarySupportedVersions.fluentV9)])||void 0===t?void 0:t.FluentProvider)||e.Controls.isFluentV9ThemeWrapperEnabled)},t.ThemeWrapperHelper=function(t){var i,a,s,l,c,p=React.useState(!1),u=p[0],d=p[1],h=React.useRef(null),C=React.useRef(null),g=React.useRef(null),m=React.useRef(e.Runtime.App.Theming.Themes.powerApps),f=window[o.getPlatformLibraryWindowAlias(o.PlatformLibrarySupportedVersions.fluentV9)];if(React.useEffect((function(){var n,o,r;if(C.current=Core.Loader.ObjectFactory.instance.getSingleton(e.Runtime.App.CurrentAppInstanceFunctionSingletonKey)(),C.current&&!g.current){g.current=C.current.modernAppThemeManager.appThemeEventSubscribe(t.globalThemeChange);var i=null!==(r=null===(o=null===(n=C.current.modernAppThemeManager)||void 0===n?void 0:n.getAppTheme())||void 0===o?void 0:o.appThemeName)&&void 0!==r?r:m.current;m.current!==i&&t.globalThemeChange()}return function(){g.current&&(g.current.dispose(),g.current=null)}}),[t.globalThemeChange]),React.useEffect((function(){!u&&e.Controls.isFluentV9ThemeWrapperEnabled&&function(){__awaiter(this,void 0,void 0,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:if((null==f?void 0:f.FluentProvider)||null!==h.current)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),h.current=n.injectIntoDOM(o.PlatformLibrarySupportedVersions.fluentV9,"PlatformLibraryFluentV9"),[4,h.current];case 2:return t.sent(),d(!0),[3,4];case 3:return e=t.sent(),Core.Log.errorEx("AppMagic.Controls.ThemeWrapperHelper","Not able to inject platform library: ".concat(e.message)),[3,4];case 4:return[3,8];case 5:return h.current?[4,h.current]:[3,7];case 6:t.sent(),t.label=7;case 7:d(!0),t.label=8;case 8:return[2]}}))}))}()}),[e.Controls.isFluentV9ThemeWrapperEnabled]),null==f?void 0:f.FluentProvider){m.current=null!==(c=null===(l=null===(s=null===(a=null===(i=C.current)||void 0===i?void 0:i.modernAppThemeManager)||void 0===a?void 0:a.getAppTheme)||void 0===s?void 0:s.call(a))||void 0===l?void 0:l.appThemeName)&&void 0!==c?c:e.Runtime.App.Theming.Themes.powerApps;var y=e.Runtime.App.Theming.getTheme(m.current),_=React.createElement(f.FluentProvider,{theme:y,dir:t.textDirection},t.children,React.createElement("div",{id:"__fluentv9popover__",style:r}));return(null==f?void 0:f.IdPrefixProvider)&&!Core.FallbackSwitch.isActivated("AppRuntime.RenderWithoutGlobalThemePrefix")?_=React.createElement(f.IdPrefixProvider,{value:"PAPrefix0ee7fe8d392a5a"},_):(null==f?void 0:f.IdPrefixProvider)||Core.Log.warningEx("AppMagic.Controls.ThemeWrapperHelper","Platform library is loaded, but does not have IdPrefixProvider."),_}if(f){var v=[];f.FluentProvider||v.push("Platform library is loaded, but does not have FluentProvider."),f.IdPrefixProvider||v.push("Platform library is loaded, but does not have IdPrefixProvider."),v.length&&Core.Log.warningEx("AppMagic.Controls.ThemeWrapperHelper",v.join(" "))}return React.createElement(React.Fragment,null,t.children)}}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=e.AuthoringTool.Animation;t.screenAnimationClassName="screen-animation";var o=function(e){function o(t){var n=e.call(this,t)||this;return n._validateProps(t),n._onAnimationEnd=n._onAnimationEnd.bind(n),n}return __extends(o,e),o.prototype.render=function(){var e=this.props,o=e.transitionType,r=(e.onAnimationComplete,{position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:e.isTopScreen?1:0}),i=n.getClassNameForScreenTransitionType(o);return React.createElement("div",{className:"".concat(t.screenAnimationClassName," ").concat(n.cssAnimationClassName," ").concat(i),style:r,onAnimationEnd:this._onAnimationEnd},this.props.children)},o.prototype._onAnimationEnd=function(e){e.target instanceof HTMLDivElement&&e.target.classList.contains(t.screenAnimationClassName)&&this.props.onAnimationComplete()},o.prototype._validateProps=function(e){},o}(React.Component);t.ScreenAnimationWrapper=o}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=function(t){function n(e){var n=t.call(this,e)||this;return n._isMounted=!1,n._controlContext=ko.observable(n.props.controlContext),n}return __extends(n,t),n.prototype.componentWillMount=function(){var e=this;this._renderComputed=ko.computed((function(){return this._render()}),this).extend({deferred:!0}),this._renderComputedSubscription=this._renderComputed.subscribe((function(){Core.Tasks.schedule((function(){var t=e._controlContext();e._isMounted&&n._isValidControlContext(t)&&e.setState({})}),"ObservableComponent._renderComputed")}))},n.prototype.componentDidMount=function(){this._isMounted=!0},n.prototype.shouldComponentUpdate=function(e){var t=e.controlContext;return n._isValidControlContext(t)},n.prototype.componentWillReceiveProps=function(e){this.props.controlContext!==e.controlContext&&this._controlContext(e.controlContext)},n.prototype.componentWillUnmount=function(){this._renderComputedSubscription.dispose(),this._renderComputedSubscription=null,this._renderComputed.dispose(),this._renderComputed=null,this._controlContext(null),this._isMounted=!1},n.prototype.render=function(){return this._render()},n.prototype._render=function(){var e=this._controlContext();return n._isValidControlContext(e)?this.renderCore():null},n._isValidControlContext=function(t){if((null==t?void 0:t.initialized)&&t.properties){var n=t.controlWidget.controlProperties,o=t.properties;if(Object.keys(o).some((function(t){return n[t]instanceof e.ControlProperty})))return!0;if(Object.keys(n).every((function(t){return n[t]instanceof e.GlobalControlProperty&&o[t]})))return!0}return!1},n}(React.Component);e.ObservableComponent=t}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=e.Utility,o=function(){function t(){}return Object.defineProperty(t.prototype,"_parentControlId",{get:function(){return this.OpenAjax?this.OpenAjax.getId():null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCanvasVerticalScrollbar",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCanvasHorizontalScrollbar",{get:function(){return!0},enumerable:!1,configurable:!0}),t._getControlId=function(e){var n=t._getControlWidget(e);return n?n.getId():null},t._getControlWidget=function(e){return e&&e.controlWidget?e.controlWidget:null},t._isNestedControl=function(e){return!!(e&&e.controlWidget&&e.controlWidget.template)&&e.controlWidget.template.supportsNestedControls},t._applyBindings=function(e,t){t&&e&&ko.applyBindings(e,t)},t.prototype.initView=function(o,r){this._controlContext=r;var i=this._getParentControlElement(o);e.AuthoringTool.Runtime.isAuthoring&&r.isTemplate&&this._initializeNestedCanvas(this._parentControlId,i,r,this.OpenAjax),r.viewModel?(n.createOrSetPrivate(r.viewModel,"handleClick",this._handleClick.bind(this,r)),t._applyBindings(r.viewModel,o)):(n.createOrSetPrivate(r,"handleClick",this._handleClick.bind(this,r)),t._applyBindings(r,o))},t.prototype.onCustomChildControlAdded=function(e,n,o){if(t._isNestedControl(n)){var r=n.container;this._initializeNestedCanvas(n.controlWidget.getId(),r,n,n.controlWidget),t._applyBindings(n,r)}},t.prototype.disposeView=function(e,t){},t.prototype.managesChildrenLayout=function(){return this.OpenAjax.template.managesNestedControlBounds},t.prototype._getParentControlElement=function(e){if(!e)return null;var t=e.getElementsByClassName(this._customControlName);return t&&1===t.length?t[0]:null},t.prototype._getParentProperty=function(e){return this.OpenAjax&&e?this.OpenAjax.getPropertyValue(e):null},t.prototype._setParentProperty=function(e,t){this.OpenAjax.setPropertyValue(e,t)},t.prototype._getChildControl=function(e){return this.OpenAjax.getCustomChildControlWidget(e)},t.prototype._updateControlTreeAsync=function(e,t){return this.OpenAjax.updateControlTreeAsync(e,t)},t.prototype._initializeNestedCanvas=function(e,t,n,o){var r=this;this._authoringCanvas||(this._authoringCanvas=o.controlManager.initializeNestedCanvas(e,0,t,n.properties.Width,n.properties.Height,{childCanvasId:1,replicateControls:!0,originOffsetX:ko.observable(0),originOffsetY:ko.observable(0),templateWidth:n.properties.Width,templateHeight:n.properties.Height,onCanvasResize:function(e,t,n,i){return r._resizeControl(o,e,t,n,i)},onCanvasXScroll:function(e){return r._scrollX(o,e)},onCanvasYScroll:function(e){return r._scrollY(o,e)},canvasScrollable:{y:this.hasCanvasVerticalScrollbar,x:this.hasCanvasHorizontalScrollbar}}))},t.prototype._resizeControl=function(e,t,n,o,r){this._updateBounds(e,t,n,o,r)},t.prototype._scrollX=function(e,t){var n=e.isCustomControl?e.metadataId:this._parentControlId;this._updateControlScrollX(n,-1*t)},t.prototype._scrollY=function(e,t){var n=e.isCustomControl?e.metadataId:this._parentControlId;this._updateControlScrollY(n,-1*t)},t.prototype._updateAuthoringBounds=function(e,t,n,o,r){var i=this.OpenAjax.getId()===e?this.OpenAjax:this.OpenAjax.getCustomChildControlWidget(e);this._updateBounds(i,o,r,t,n)},t.prototype._updateAuthoringScrollX=function(e,t){(this.OpenAjax.getId()===e?this.OpenAjax:this.OpenAjax.getCustomChildControlWidget(e)).updateScrollX(t)},t.prototype._updateAuthoringScrollY=function(e,t){(this.OpenAjax.getId()===e?this.OpenAjax:this.OpenAjax.getCustomChildControlWidget(e)).updateScrollY(t)},t.prototype._updateLayoutProperty=function(t,n,o){var r=this.OpenAjax.getId()===t?this.OpenAjax:this.OpenAjax.getCustomChildControlWidget(t);if(r){var i=r.getAuthoringControlContext();i&&(n===e.AuthoringTool.OpenAjaxPropertyNames.X?i.modelProperties.LayoutX.setValue(o,!1,!0):n===e.AuthoringTool.OpenAjaxPropertyNames.Y?i.modelProperties.LayoutY.setValue(o,!1,!0):n===e.AuthoringTool.OpenAjaxPropertyNames.Width?i.modelProperties.LayoutWidth.setValue(o,!1,!0):n===e.AuthoringTool.OpenAjaxPropertyNames.Height&&i.modelProperties.LayoutHeight.setValue(o,!1,!0))}},t.prototype._updateLayoutProperties=function(e,t,n,o,r){var i=(this.OpenAjax.getId()===e?this.OpenAjax:this.OpenAjax.getCustomChildControlWidget(e)).getAuthoringControlContext();i.modelProperties.LayoutX.setValue(o,!1,!0),i.modelProperties.LayoutY.setValue(r,!1,!0),i.modelProperties.LayoutWidth.setValue(t,!1,!0),i.modelProperties.LayoutHeight.setValue(n,!1,!0)},t.prototype._handleClick=function(e){return!(e&&e.behaviors&&"function"==typeof e.behaviors.OnSelect)},t.prototype._updateBounds=function(t,n,o,r,i){t.updateBoundsPropertyValue(e.AuthoringTool.OpenAjaxPropertyNames.Width,r,!0),t.updateBoundsPropertyValue(e.AuthoringTool.OpenAjaxPropertyNames.Height,i,!0),t.updateBoundsPropertyValue(e.AuthoringTool.OpenAjaxPropertyNames.X,n,!0),t.updateBoundsPropertyValue(e.AuthoringTool.OpenAjaxPropertyNames.Y,o,!0)},t}();t.CustomControl=o}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){e.withManagedAccessibility=function(e,t,n){return function(o){function r(e){var t=o.call(this,e)||this;return t._koSubscriptions=[],t._updateLocation=null,t.state={tabIndex:-1},t._onComputedTabIndex=t._onComputedTabIndex.bind(t),t}return __extends(r,o),r.prototype.componentWillMount=function(){var e=this,o=this.props.controlContext,r=o.properties;this._accessibilityItem=n.createReactAccessibilityItem(o,this._onComputedTabIndex),this._updateLocation=ko.pureComputed((function(){return"".concat(this.X(),":").concat(this.Y())}),r),this._koSubscriptions.push(this._updateLocation.subscribe((function(){o.initialized&&e._accessibilityItem&&n.updateLocation(e._accessibilityItem,o)}))),this._koSubscriptions.push(r.TabIndex.subscribe((function(){o.initialized&&e._accessibilityItem&&n.updateTabIndex(e._accessibilityItem,o)}))),this._koSubscriptions.push(r.ZIndex.subscribe((function(){o.initialized&&e._accessibilityItem&&n.updateZIndex(e._accessibilityItem,o)}))),t.registerItem(this._accessibilityItem)},r.prototype.componentWillUnmount=function(){this._koSubscriptions.forEach((function(e){e.dispose()})),this._koSubscriptions=[],this._updateLocation&&(this._updateLocation.dispose(),this._updateLocation=null),this._accessibilityItem&&(t.unregisterItem(this._accessibilityItem),this._accessibilityItem.dispose(),this._accessibilityItem=null)},r.prototype._onComputedTabIndex=function(e){this.props.controlContext.initialized?this.state.tabIndex!==e&&this.setState({tabIndex:e}):Core.Log.warningEx("ControlAccessibilityWrapper._onComputedTabIndex","Expected control context to be initialized")},r.prototype.render=function(){return React.createElement(e,__assign({},this.props,{tabIndex:this.state.tabIndex}))},r}(React.Component)}}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=function(t){function n(e){var n=t.call(this,e)||this;return n.state={tabIndex:-1},n._onComputedTabIndex=n._onComputedTabIndex.bind(n),n}return __extends(n,t),n.prototype.componentDidMount=function(){var t=this.props,n=t.controlContext,o=t.isFocusable;this._accessibilityContainerDisposeFn=e.AccessibilityHelper.initializeAccessibilityContainer(n,this._onComputedTabIndex,o)},n.prototype.componentWillUnmount=function(){var e;null===(e=this._accessibilityContainerDisposeFn)||void 0===e||e.call(this),this._accessibilityContainerDisposeFn=null},n.prototype._onComputedTabIndex=function(e){this.props.controlContext.initialized?this.state.tabIndex!==e&&this.setState({tabIndex:e}):Core.Log.warningEx("ContainerControlAccessibilityWrapper._onComputedTabIndex","Expected control context to be initialized")},n.prototype.render=function(){var e=this;if(!this.props.controlContext.initialized)return Core.Log.warningEx("ContainerControlAccessibilityWrapper.render","Expected control context to be initialized"),null;var t=o(),n=this.props.isFocusable?React.Children.map(this.props.children,(function(t){if(React.isValidElement(t))return React.cloneElement(t,{tabIndex:e.state.tabIndex})})):this.props.children;return React.createElement("div",{className:"".concat(aphrodite.css(t.container)," accessibility-container")},n)},n}(React.Component);e.ContainerControlAccessibilityWrapper=t;var n=null,o=function(){return n||(n=aphrodite.StyleSheet.create({container:{position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%"}})),n}}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){e.CreatePropsWrapper=function(t,n){return function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t._controlProps={},t}return __extends(o,e),o.prototype.componentWillMount=function(){e.prototype.componentWillMount.call(this),this.props.bindKeyboardShortcuts&&this.props.unbindKeyboardShortcuts&&Core.Utility.isFunction(this.props.bindKeyboardShortcuts)&&Core.Utility.isFunction(this.props.unbindKeyboardShortcuts)&&(this._controlProps.bindKeyboardShortcuts=this.props.bindKeyboardShortcuts,this._controlProps.unbindKeyboardShortcuts=this.props.unbindKeyboardShortcuts)},o.prototype.componentWillUnmount=function(){for(var t in this._controlProps)this._controlProps.hasOwnProperty(t)&&delete this._controlProps[t];this._controlProps=null,e.prototype.componentWillUnmount.call(this)},o.prototype.renderCore=function(){var e=this.props.controlContext,o=e.reactProps,r=e.extractFromParentProps;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];this._controlProps[i]=a()}for(var s=0,l=r;s<l.length;s++){var c=l[s];this.props.hasOwnProperty(c)&&(this._controlProps[c]=this.props[c])}var p=Core.Utility.isFunction(n)?n(this.props):null;return React.createElement(t,__assign({},this._controlProps,p))},o}(e.ObservableComponent)};var t=function(){function e(){}return e.mapNumericObservable=function(t,n){return function(){return e._mapObservable(t,n)}},e.mapStringObservable=function(t,n){return function(){return e._mapObservable(t,n)}},e.mapBooleanObservable=function(t,n){return function(){return e._mapObservable(t,n)}},e.mapPrimitiveObservables=function(t,n,o){return function(){var r={};return n.forEach((function(n){var i=n.split(".").pop();o&&(i="".concat(i.charAt(0).toLocaleLowerCase()).concat(i.substr(1)));var a=e._mapObservable(t,n);r[i]=a})),r}},e.mapComplexObservables=function(t,n,o){return function(){var r={};return n.forEach((function(n){var i=n.split(".").pop();o&&(i="".concat(i.charAt(0).toLocaleLowerCase()).concat(i.substr(1)));var a=e._mapObservable(t,n);r[i]=a})),r}},e.mapMultipleProperties=function(e,t,n,o){var r=this;return function(){var i=r.mapPrimitiveObservables(e,t,o)(),a=r.mapComplexObservables(e,n,o)();return Object.assign({},i,a)}},e._mapObservable=function(t,n){return e._constructProperty(t,n)()},e._constructProperty=function(e,t){for(var n=t.split("."),o=e,r=0;o&&r<n.length;r++)o=o[n[r]];return o},e}();e.ObservablePropertyMapper=t}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=aphrodite.css,n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.render=function(){var e=this.props,o=e.title,r=e.subTitle,i=e.subTitleClassName,a=e.src,s=e.onSubtitleClick,l=n._getStyles(),c=i?"".concat(i," ").concat(t(l.subTitle)):t(l.subTitle);return React.createElement("div",{className:t(l.container)},React.createElement("div",{className:t(l.innerContainer)},React.createElement("img",{draggable:!1,className:t(l.icon),src:a}),React.createElement("div",{className:t(l.title)},o),r?React.createElement("div",{className:c,onClick:s},r):null))},n.getContainerStyles=function(){return{overflow:"hidden",display:"flex",width:"100%",height:"100%"}},n.getInnerContainerStyles=function(){return{display:"flex",flex:"1 1 auto",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingLeft:"10px",paddingRight:"10px",fontSize:"16px",textAlign:"center",fontFamily:Core.UI.StyleConstants.baseFontFamily,fontWeight:"lighter"}},n.getTitleStyles=function(){return{flex:"0 0 auto",color:Core.UI.StyleConstants.ColorGrayDarkTertiary,marginTop:"8px"}},n.getIconStyles=function(){return{flex:"0 0 auto",width:"48px",height:"48px"}},n.getSubTitleStyles=function(){return{flex:"0 0 auto",color:Core.UI.StyleConstants.ColorBannerLink,marginTop:"8px",cursor:"pointer",":hover":{color:Core.UI.StyleConstants.MainHoverBackgroundColor}}},n._getStyles=function(){return n._styles||(n._styles=aphrodite.StyleSheet.create({container:n.getContainerStyles(),innerContainer:n.getInnerContainerStyles(),icon:n.getIconStyles(),title:n.getTitleStyles(),subTitle:n.getSubTitleStyles()})),n._styles},n}(React.Component);e.DataControlsDefaultPlaceHolder=n}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=Core.UI.StyleHelpers.createCachedStylesFactoryMethod,n=aphrodite.StyleSheet.create({scrollContainer:{height:"100%",width:"100%",position:"relative",WebkitOverflowScrolling:"touch",selectors:{"&:focus":{outline:"none"}}},scrollContent:{width:"100%",position:"relative"}}),o=aphrodite.css(n.scrollContent),r=function(e){function r(t){var n=e.call(this,t)||this;return n._handleScrollContainerRef=n._handleScrollContainerRef.bind(n),n._handleScroll=n._handleScroll.bind(n),n}return __extends(r,e),r.prototype.componentDidMount=function(){this._updateScrollOffsets(this.props,!1)},r.prototype.componentDidUpdate=function(e){var t=e.enableVirtualScrolling!==this.props.enableVirtualScrolling;(t||e.scrollTopOffset!==this.props.scrollTopOffset||e.scrollLeftOffset!==this.props.scrollLeftOffset)&&this._updateScrollOffsets(this.props,t)},r.prototype.render=function(){var e=Core.Environment.isMobileDevice(),r=t({scrollbar:{overflowX:this.props.horizontalScrollbar?e?"scroll":"auto":"hidden",overflowY:this.props.verticalScrollbar?e?"scroll":"auto":"hidden"}})();return React.createElement("div",{className:aphrodite.css(n.scrollContainer,r.scrollbar),onScroll:this._handleScroll,ref:this._handleScrollContainerRef,tabIndex:this.props.tabIndex<0?void 0:this.props.tabIndex},React.createElement("div",{className:o},React.createElement("div",{className:o},this.props.children)))},r.prototype._handleScrollContainerRef=function(e){e?(this._scrollContainer=e,this._scrollContentContainer=this._scrollContainer.firstElementChild,this._scrollContent=this._scrollContentContainer.firstElementChild):(this._scrollContainer=null,this._scrollContentContainer=null,this._scrollContent=null)},r.prototype._handleScroll=function(){var e=this._scrollContainer,t=this.props.onScroll;t&&e&&t(e.scrollTop,e.scrollLeft)},r.prototype._getScrollProps=function(e,t,n,o){var r=t,i="",a="",s="";if(this.props.enableVirtualScrolling)if(t<0)r=0,i="translate".concat(e,"(").concat(t,"px)");else if(t>0){var l=o(),c=n();c-t<l&&(r=Math.max(0,c-l),i="translate".concat(e,"(").concat(r-t,"px)"),s="hidden",a="".concat(this._scrollContent.scrollHeight,"px"))}return{contentContainerLength:a,contentContainerOverflow:s,contentTransform:i,containerScrollOffset:r}},r.prototype._updateScrollOffsets=function(e,t){var n=this._scrollContainer;if(n){var o=e.scrollTopOffset,r=e.scrollLeftOffset,i=e.shouldUpdateScrollOffset;if(t||!i||i(o,r)){var a=this._scrollContent,s=this._getScrollProps("Y",o,(function(){return a.scrollHeight}),(function(){return n.clientHeight})),l=this._getScrollProps("X",r,(function(){return a.scrollWidth}),(function(){return n.clientWidth}));if(t||e.enableVirtualScrolling){var c=this._scrollContentContainer.style;c.height!==s.contentContainerLength&&(c.height=s.contentContainerLength),c.width!==l.contentContainerLength&&(c.width=l.contentContainerLength);var p=e.verticalScrollbar?s.contentContainerOverflow:l.contentContainerOverflow;c.overflowY!==p&&(c.overflowY=p);var u=e.horizontalScrollbar?l.contentContainerOverflow:s.contentContainerOverflow;c.overflowX!==u&&(c.overflowX=u);var d=[s.contentTransform,l.contentTransform].join(" ").trim();a.style.transform!==d&&(a.style.transform=d)}n.scrollTop!==s.containerScrollOffset&&(n.scrollTop=s.containerScrollOffset),n.scrollLeft!==l.containerScrollOffset&&(n.scrollLeft=l.containerScrollOffset)}}},r.defaultProps={scrollTopOffset:0,scrollLeftOffset:0,onScroll:null,shouldUpdateScrollOffset:null,verticalScrollbar:!0,horizontalScrollbar:!1,enableVirtualScrolling:!1,tabIndex:-1},r}(React.Component);e.ScrollContainer=r}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){return null},t}(React.Component);e.NullRenderComponent=t}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=function(t){function n(e){var n=t.call(this,e)||this;return n.state={hasError:!1},n}return __extends(n,t),n.getDerivedStateFromError=function(){return{hasError:!0}},n.prototype.componentDidCatch=function(e,t){Core.Telemetry.Log.trackErrorEvent("ErrorBoundary.componentDidCatch",{error:e,stack:t.componentStack})},n.prototype.render=function(){return this.state.hasError?React.createElement("div",null,React.createElement("h1",null,e.Strings.ErrorBoundaryTitle),React.createElement("p",null,e.Strings.ErrorBoundaryMessage)):this.props.children},n}(React.Component);t.ErrorBoundary=n}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=function(){};e.AppTest=t}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=function(){};e.TestSuite=t}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=function(){};e.TestCase=t}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n;!function(e){e[e.ScaleToFit=0]="ScaleToFit",e[e.Window=1]="Window"}(n||(n={}));var o=function(){function o(){this._resizeHandlerSubscribed=!1,this._lastWindowSize={width:Number.MAX_VALUE,height:Number.MAX_VALUE},this._initialGlobalThemeWasLogged=!1,this._refreshDesignDimensions=this._refreshDesignDimensions.bind(this),this._onWindowResize=this._onWindowResize.bind(this),this._refreshPreviewSizeType=this._refreshPreviewSizeType.bind(this),this._setSelectedPreviewSize=this._setSelectedPreviewSize.bind(this),this._localDebouncedWindowResize=new Core.DebouncedMethod(this._onWindowResize,75),this._shellEventBroker=Core.Loader.ObjectFactory.instance.getSingleton(e.AuthoringTool.GlobalEventBroker.ShellEventBroker.singletonKey)}return Object.defineProperty(o,"windowWidth",{get:function(){return"undefined"==typeof window?0:Core.Environment.isCustomPage()?o.contentWidth:Core.Environment.getDeviceId()!==Core.Environment.DeviceId.iOSDevice||Core.FallbackSwitch.isActivated("AppRuntime.IOSAppWidthAndHeight")?Core.Environment.isRuntimeCapabilityEnabled("UseMinimalLayoutManager")?e.DocumentLayout.getInstance().width:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth:document.documentElement.clientWidth||document.body.clientWidth},enumerable:!1,configurable:!0}),Object.defineProperty(o,"windowHeight",{get:function(){return"undefined"==typeof window?0:Core.Environment.isCustomPage()?o.contentHeight:Core.Environment.getDeviceId()!==Core.Environment.DeviceId.iOSDevice||Core.FallbackSwitch.isActivated("AppRuntime.IOSAppWidthAndHeight")?Core.Environment.isRuntimeCapabilityEnabled("UseMinimalLayoutManager")?e.DocumentLayout.getInstance().height:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight:document.documentElement.clientHeight||document.body.clientHeight},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"previewToolbarHeight",{get:function(){return this._previewSizeType===n.Window?54:0},enumerable:!1,configurable:!0}),Object.defineProperty(o,"scaleFactor",{get:function(){return e.DocumentLayout.getCanvasScale(e.DocumentLayout.getInstance())},enumerable:!1,configurable:!0}),Object.defineProperty(o,"screenWidth",{get:function(){return o._getScreenPropValue("Width")||e.DocumentLayout.getInstance().initialWidth},enumerable:!1,configurable:!0}),Object.defineProperty(o,"screenHeight",{get:function(){return o._getScreenPropValue("Height")||e.DocumentLayout.getInstance().initialHeight},enumerable:!1,configurable:!0}),Object.defineProperty(o,"_publishedCanvasContainerElement",{get:function(){return o._lazyPublishedCanvasContainerElement.value},enumerable:!1,configurable:!0}),o._getScreenPropValue=function(e){var t=o._getCurrentScreen(),n=t&&t.OpenAjax;return n&&n.getPropertyValue(e)},o._getCurrentScreen=function(){var t=e.AuthoringTool.Runtime.getCurrentScreenName();if(!t)return null;var n=null;try{n=e.AuthoringTool.Runtime.getNamedControlByDisplayName(t)}catch(t){if(!(t instanceof e.Runtime.App.NamedObjectNotFoundError))throw t;return null}return n},Object.defineProperty(o,"contentWidth",{get:function(){return Core.Environment.isRuntimeCapabilityEnabled("UseMinimalLayoutManager")?e.DocumentLayout.getInstance().width:o._publishedCanvasContainerElement.parentElement.offsetWidth},enumerable:!1,configurable:!0}),Object.defineProperty(o,"contentHeight",{get:function(){return Core.Environment.isRuntimeCapabilityEnabled("UseMinimalLayoutManager")?e.DocumentLayout.getInstance().height:o._publishedCanvasContainerElement.parentElement.offsetHeight},enumerable:!1,configurable:!0}),o.prototype.onLoad=function(){this._screenChangeSubscription=e.AuthoringTool.Runtime.screenChangeEventSubscribe(this._onScreenChange.bind(this))},o.prototype.onUnload=function(){this._screenChangeSubscription.dispose(),this._exitMessageChangeSubscription&&this._exitMessageChangeSubscription.dispose(),this._showExitMessageChangeSubscription&&this._showExitMessageChangeSubscription.dispose(),this._backPropertyChangeSubscription&&this._backPropertyChangeSubscription.dispose(),this._localDebouncedWindowResize&&this._localDebouncedWindowResize.dispose()},o.prototype.initControlContext=function(t){var n=this;this.OpenAjax.controlManager.subscribeDocumentDimensionChange(this._refreshDesignDimensions),Core.Environment.isAuthoringTool()&&(this._appModeSubscription=this.OpenAjax.controlManager.appModeObservable.subscribe((function(){return n._refreshDesignDimensions()})),this._shellEventBroker.subscribe([e.AuthoringTool.GlobalEventBroker.EventBrokerId.PreviewModel_RefreshPreviewSize],this._refreshPreviewSizeType),this._shellEventBroker.subscribe([e.AuthoringTool.GlobalEventBroker.EventBrokerId.PreviewModel_SelectedSizeChange],this._setSelectedPreviewSize)),this._appInstance=Core.Loader.ObjectFactory.instance.getSingleton(e.Runtime.App.CurrentAppInstanceFunctionSingletonKey)(),this._refreshDesignDimensions();var o=["__PATestCaseId","__PATestId","__PATestSuiteId"],r=!1;if(!Core.Environment.isAuthoringTool())for(var i=0;i<o.length;i++)if(e.getLanguageRuntime().getEnvironmentValue(o[i])){r=!0;break}t.modelProperties.Testing.setValue(r),t.modelProperties.TestCaseId.setValue(null),t.modelProperties.TestSuiteId.setValue(null),t.modelProperties.StudioVersion.setValue(Core.Environment.Version.VERSION_NUMBER)},o.prototype.subscribeConfirmExitMessageChanged=function(t){this._exitMessageChangeSubscription=this.OpenAjax.addPropertyChangeCallback(e.Constants.confirmExitMessageAppControlPropertyName,t)},o.prototype.subscribeConfirmExitChanged=function(t){this._showExitMessageChangeSubscription=this.OpenAjax.addPropertyChangeCallback(e.Constants.confirmExitAppControlPropertyName,t)},o.prototype.subscribeBackPropertyChanged=function(t){this._backPropertyChangeSubscription=this.OpenAjax.addPropertyChangeCallback(e.Constants.backEnabledAppControlPropertyName,t)},Object.defineProperty(o.prototype,"confirmExitMessage",{get:function(){var t=this.OpenAjax.getPropertyValue(e.Constants.confirmExitMessageAppControlPropertyName);return t||e.Strings.AppControlConfirmExitDefaultMessage},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"confirmExit",{get:function(){var t=this.OpenAjax.getPropertyValue(e.Constants.confirmExitAppControlPropertyName);return t||!1},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"backEnabled",{get:function(){return!!this.OpenAjax.getPropertyValue(e.Constants.backEnabledAppControlPropertyName)},enumerable:!1,configurable:!0}),o.prototype.disposeControlContext=function(){this._resizeHandlerSubscribed&&Core.UI.removeResizeHandler(this._onWindowResize),this.OpenAjax.controlManager.unsubscribeDocumentDimensionChange(this._refreshDesignDimensions),Core.Environment.isAuthoringTool()&&(this._shellEventBroker.unsubscribe([e.AuthoringTool.GlobalEventBroker.EventBrokerId.PreviewModel_SelectedSizeChange],this._setSelectedPreviewSize),this._shellEventBroker.unsubscribe([e.AuthoringTool.GlobalEventBroker.EventBrokerId.PreviewModel_RefreshPreviewSize],this._refreshPreviewSizeType),this._appModeSubscription.dispose())},o.prototype._refreshPreviewSizeType=function(t,n){var r;this._previewSizeType=n,this._selectedPreviewSize&&!1===(null===(r=e.DocumentLayout.getInstance())||void 0===r?void 0:r.scaleToFit)?this._updateWidthAndHeight(this._selectedPreviewSize.viewportWidth/o.scaleFactor,this._selectedPreviewSize.viewportHeight/o.scaleFactor):this._refreshDesignDimensions(n)},o.prototype._setSelectedPreviewSize=function(t,r){var i;this._selectedPreviewSize=r,this._selectedPreviewSize&&!1===(null===(i=e.DocumentLayout.getInstance())||void 0===i?void 0:i.scaleToFit)?this._updateWidthAndHeight(this._selectedPreviewSize.viewportWidth/o.scaleFactor,this._selectedPreviewSize.viewportHeight/o.scaleFactor):this._refreshDesignDimensions(n.Window)},o.prototype._refreshDesignDimensions=function(o){var r,i,a,s,l=e.DocumentLayout.getInstance(),c=l.initialWidth,p=l.initialHeight;this.OpenAjax.setPropertyValue("DesignWidth",c),this.OpenAjax.setPropertyValue("DesignHeight",p);var u=Core.Environment.isAuthoringTool()&&this.OpenAjax.controlManager.appModeObservable.peek()!==t.AppMode.Preview;l.scaleToFit||u||o===n.ScaleToFit?(this._updateWidthAndHeight(c,p),this._resizeHandlerSubscribed&&(this._resizeHandlerSubscribed=!1,null===(i=(r=Core.UI).removeResizeHandler)||void 0===i||i.call(r,this._onWindowResize))):this._resizeHandlerSubscribed&&o!==n.Window||(this._resizeHandlerSubscribed=!0,null===(s=(a=Core.UI).addResizeHandler)||void 0===s||s.call(a,this._onWindowResize),this._onWindowResize())},o.prototype._onWindowResize=function(){this._localDebouncedWindowResize.cancel();var e=this._getScreenPixelAdjustment(),t=o.windowWidth/o.scaleFactor+e.width,n=(o.windowHeight-this.previewToolbarHeight)/o.scaleFactor+e.height,r=this._lastWindowSize,i=r.width,a=r.height;(t!==i||n!==a||t!==this.OpenAjax.getPropertyValue("Width")||n!==this.OpenAjax.getPropertyValue("Height")||Core.FallbackSwitch.isActivated("AppRuntime.DebounceWindowResizing"))&&(this._lastWindowSize={width:t,height:n},this._updateWidthAndHeight(t,n),this.OpenAjax.setPropertyValue("ActiveScreen",o._getCurrentScreen(),void 0,!0),this._needsCustomScreenPixelAdjustment()&&(t<i||n<a)&&this._localDebouncedWindowResize.method())},o.prototype._updateWidthAndHeight=function(t,n){var r=o.screenWidth,i=o.screenHeight,a=e.DocumentLayout.getInstance().layoutEngine;a.updatePlayerDimensions(t,n),a.updateLayoutDimensions(r,i),this.OpenAjax.setPropertyValue("Width",t),this.OpenAjax.setPropertyValue("Height",n)},o.prototype._onScreenChange=function(){this.OpenAjax.setPropertyValue("ActiveScreen",o._getCurrentScreen());var t=e.DocumentLayout.getInstance().layoutEngine,n=t.width,r=t.height,i=o.screenWidth,a=o.screenHeight;n===i&&r===a||t.updateLayoutDimensions(i,a),this._updateModernTheme()},o.prototype.onChangeTheme=function(){this._updateModernTheme()},o.prototype._updateModernTheme=function(){try{var t=this.OpenAjax.getPropertyValue(e.AuthoringTool.OpenAjaxPropertyNames.Theme),n=!t&&!this._initialGlobalThemeWasLogged,o=t?t.Name:e.Runtime.App.Theming.Themes.powerApps;this._lastSelectedGlobalTheme!==o&&(this._initialGlobalThemeWasLogged||(Core.Telemetry.Log.trackActivityEvent("GlobalThemeInit",{selectedTheme:e.Runtime.App.Theming.isOOBTheme(o)?o:"Custom theme",method:"AppInfo._updateModernTheme"}),this._initialGlobalThemeWasLogged=!0),this._appInstance.modernAppThemeManager.updateAppTheme({appThemeName:o,isFirstTimeThemeInit:n}),this._lastSelectedGlobalTheme=o)}catch(e){Core.Log.verbose({operationName:"AppInfo._updateModernTheme",eventData:e})}},o.prototype._needsCustomScreenPixelAdjustment=function(){var t;return!Core.FallbackSwitch.isActivated("AppRuntime.DebounceWindowResizing")&&("undefined"!=typeof window&&!(Core.Environment.isMobileDevice()||Core.Environment.isRuntimeCapabilityEnabled("UseMinimalLayoutManager")||(null===(t=e.DocumentLayout.getInstance())||void 0===t?void 0:t.scaleToFit)||!o._publishedCanvasContainerElement))},o.prototype._getScreenPixelAdjustment=function(){if(!this._needsCustomScreenPixelAdjustment())return Core.Environment.isMobileDevice()?{height:0,width:0}:{height:-1,width:-1};var e=o._publishedCanvasContainerElement;return{height:e.clientHeight-e.offsetHeight-1,width:e.clientWidth-e.offsetWidth-1}},o._lazyPublishedCanvasContainerElement=new Core.Lazy((function(){return document.getElementById("publishedCanvasContainer")})),o}();t.AppInfo=o}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=function(){};e.Conditional=t}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){var t=function(){function e(){}return e.trackActivityEvent=function(e,t,n,o){if(void 0===n&&(n=null),void 0===o&&(o=!0),(o||!this._isAuthoring)&&this.isEventTrackable(t))return Core.Telemetry.Log.trackControlsActivityEvent(e,Object.assign({},n,this._createControlEventData(t)))},e.isEventTrackable=function(e){return e.isTemplate},e._createControlEventData=function(e){var t=e.controlWidget;return{isAuthoring:this._isAuthoring,templateName:t.template.name,templateClassName:t.template.className,uniqueId:t.uniqueId,variantName:t.variantName}},e._isAuthoring=Core.Environment.isAuthoringTool(),e}();e.TelemetryHelper=t}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){var n=Core.UI.Components.ResizerDirection,o=Core.UI.Components.DraggableItem,r=Core.UI.Components.ResizerGrip,i=Core.UI.Components.ResizerGripType,a=aphrodite.css,s=aphrodite.StyleSheet,l=Core.Environment.isAuthoringTool(),c=function(t){function c(e){var n=t.call(this,e)||this;if(n.state={resizeInfo:{initialBounds:{left:null,top:null,width:null,height:null},finalBounds:{left:null,top:null,width:null,height:null},hostScale:1},appMode:n.props.controlContext.controlWidget.controlManager.appModeObservable(),interactionMode:!1},n._resizeStartHandler=n._resizeStartHandler.bind(n),n._resizeHandler=n._resizeHandler.bind(n),l){var o=n.props.controlContext.controlWidget.controlManager.appModeObservable;o&&(n._appModeSubscription=o.subscribe((function(e){n.setState({appMode:e})})));var r=n.props.controlContext.controlWidget.controlManager.authoringInteractionModeObservable;r&&(n._interactionModeSubscription=r.subscribe((function(e){n.setState({interactionMode:e})})))}return n}return __extends(c,t),c.prototype.shouldComponentUpdate=function(t,n){return!l||n.appMode===e.Controls.AppMode.Preview||n.interactionMode},c.prototype.render=function(){var e=this.props.controlContext,t=s.create({default:{pointerEvents:"none"}}),n=e.properties.ResizerGrip&&e.properties.ResizerGrip();return n?React.createElement("div",{className:"resizable-container ".concat(a(t.default))},this._createResizableGrips(n)):null},c.prototype.componentWillUnmount=function(){this._appModeSubscription&&this._appModeSubscription.dispose(),this._interactionModeSubscription&&this._interactionModeSubscription.dispose()},c.prototype._createResizableGrips=function(e){var t=this,n=null;e&&(n=e.split(",").map((function(e){return t._createResizerGrip(e)})));return n},c.prototype._resizeStartHandler=function(){var e=this.state.resizeInfo.initialBounds,t=this.props.controlContext;return e.left=t.modelProperties.X.getValue(),e.top=t.modelProperties.Y.getValue(),e.width=t.modelProperties.Width.getValue(),e.height=t.modelProperties.Height.getValue(),this.state.resizeInfo.hostScale=t.controlWidget.controlManager.hostScale,!0},c.prototype._resizeHandler=function(e,t,o){var r=this.state.resizeInfo,i=this.props.controlContext.properties,a=t/r.hostScale,s=o/r.hostScale;switch(e){case n.E:i.Width(r.initialBounds.width+a);break;case n.S:i.Height(r.initialBounds.height+s);break;case n.W:r.initialBounds.width-a>=0&&(i.X(r.initialBounds.left+a),i.Width(r.initialBounds.width-a));break;case n.N:r.initialBounds.height-s>=0&&(i.Y(r.initialBounds.top+s),i.Height(r.initialBounds.height-s));break;case n.SE:this._resizeHandler(n.S,t,o),this._resizeHandler(n.E,t,o);break;case n.SW:this._resizeHandler(n.S,t,o),this._resizeHandler(n.W,t,o);break;case n.NE:this._resizeHandler(n.N,t,o),this._resizeHandler(n.E,t,o);break;case n.NW:this._resizeHandler(n.N,t,o),this._resizeHandler(n.W,t,o)}},c.prototype._createResizerGrip=function(e){var t="resizer-".concat(e,"-").concat(this.props.controlContext.controlWidget.uniqueId);return React.createElement(o,{key:t,id:e,onDragStart:this._resizeStartHandler,onDrag:this._resizeHandler},React.createElement(r,{direction:e,gripType:i.Bar}))},c}(React.Component);t.RuntimeControlResizersContainer=c}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){!function(e){!function(e){e.Assert="Assert",e.Select="Select",e.SetProperty="SetProperty"}(e.Operation||(e.Operation={})),e.traceUserAction=function(e,t,n,o){var r={context:{entityName:t.controlName,propertyName:n},value:o};Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.UserAction,e,r)}}(e.Diagnostics||(e.Diagnostics={}))}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){e.isControlCustomizableComponent=function(e){var t,n,o,r="string"==typeof e?null===(t=OpenAjax.widget.byId(e))||void 0===t?void 0:t.OpenAjax:e;return r?(null===(n=r.template)||void 0===n?void 0:n.componentAllowCustomization)||!(null===(o=r.template)||void 0===o?void 0:o.sourceLibraryDependency):(Core.Environment.isTestMode()||Core.Telemetry.Log.trackErrorEvent("isControlCustomizableComponent.widgetNull",{argumentType:typeof e}),!0)}}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={}));
//# sourceMappingURL=AppMagic.Controls.js.map
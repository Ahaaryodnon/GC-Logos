/*! For license information please see Core.ClientInfra.js.LICENSE.txt */
(function(){return this?this:window}())["@pa-client/core-clientinfra"]=function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=5)}([function(e,t,i){"use strict";i.r(t),i.d(t,"MediaService",(function(){return r}));var r=function(){function e(){this._maxFileSize=1e7,this._success=1,this._emptyInput=2,this._canceled=3}return e.prototype.takePictureAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e,t,i;return __generator(this,(function(r){switch(r.label){case 0:if(!Core.Environment.isReactNativeApp())throw new Error(AppMagic.Strings.TakePictureNotAvailableOnCurrentPlatform);if(!AppMagic.Common.FilePicker.instance.isFilePickerV2Available())throw new Error(AppMagic.Strings.TakePictureUnknownError);return[4,AppMagic.Common.FilePicker.instance.pickFileV2Async(this._maxFileSize)];case 1:if((e=r.sent()).status===this._canceled||e.status===this._emptyInput)return[2,null];if(e.status!==this._success)throw new Error(Core.Utility.formatString(AppMagic.Strings.TakePictureBadStatusCode,e.status));if(!(t=e.response)||!t.source)throw new Error(AppMagic.Strings.TakePictureBadBinarySource);if(!Core.Utility.startsWith(t.mimeType,"image/"))throw new Error(AppMagic.Strings.TakePictureNotAnImage);if(t.source.sourceType===Core.BinarySourceType.Invalid)throw t.source.reason===Core.InvalidBinarySourceReason.FileTooBig?new Error(AppMagic.Strings.TakePictureFileTooLarge):new Error(Core.Utility.formatString(AppMagic.Strings.TakePictureBadStatusCode,t.source.reason));if(!(i=t.source)||!i.relativeUrl)throw new Error(AppMagic.Strings.TakePictureCouldNotGetFileUrl);return[4,AppMagic.Utility.getMediaAsBase64WithContentTypeAsync(i.relativeUrl)];case 2:return[2,{fileContent:r.sent().base64,fileName:decodeURIComponent(i.relativeUrl.split("/").pop()),fileSize:e.response.size,mimeType:e.response.mimeType}]}}))}))},e.prototype.pickFile=function(e){var t,i,r=this,n=null!==(t=null==e?void 0:e.allowMultipleFiles)&&void 0!==t&&t,o=(null==e?void 0:e.maximumAllowedFileSize)&&e.maximumAllowedFileSize>0?e.maximumAllowedFileSize:this._maxFileSize,s=null!==(i=null==e?void 0:e.accept)&&void 0!==i?i:"*";return this._pickFileAsync(n,o,s).then((function(e){return document.body.removeChild(r._fileInput),Promise.resolve(e)}),(function(e){return document.body.removeChild(r._fileInput),Promise.reject(e)}))},e.prototype._pickFileAsync=function(e,t,i){var r=this;return new Promise((function(n,o){r._fileInput=document.createElement("input"),r._fileInput.type="file",r._fileInput.id="filepickerid",r._fileInput.style.display="none",r._fileInput.multiple=e,r._fileInput.accept=i,r._fileInput.onchange=function(e){var i=e.target.files;r._checkFileSizeAsync(i,t).then((function(){for(var e=[],t=0,r=function(r){var s=new FileReader;s.onload=function(){var o=s.result,a=o.substring(o.indexOf(",")+1),c={fileName:i[r].name,mimeType:i[r].type,fileContent:a,fileSize:Math.ceil(.75*a.length)};e.push(c),++t===i.length&&n(e)},s.onerror=function(){o({errorCode:"PlatformErrorCodes.FilePickerErrorUnableToOpenFile"})},s.readAsDataURL(i[r])},s=0;s<i.length;s++)r(s)})).catch((function(e){o(e)}))},document.body.appendChild(r._fileInput),r._fileInput.click()}))},e.prototype._checkFileSizeAsync=function(e,t){for(var i=0;i<e.length;i++){if(e[i].size>t)return Promise.reject({errorCode:"PlatformErrorCodes.FilePickerErrorFileSizeBreached",param:t});if(0===e[i].size)return Promise.reject({errorCode:"PlatformErrorCodes.FilePickerErrorFileSizeCannotBeZero"})}return Promise.resolve(!0)},e.prototype.getBarcodeValueAsync=function(e){var t=this;return this.isGetBarcodeValueOperationAvailable()?(e||(e={preferFrontCamera:!1,showFlipCameraButton:!0,showTorchButton:!0,torchOn:!1,prompt:"",resultDisplayDuration:500,disableAnimations:!0,disableSuccessBeep:!1}),new Promise((function(i,r){t.getBarcodePlugin().scan((function(e){i(e)}),(function(e){r(e)}),e)})).then((function(e){return e.cancelled?"":e.text})).catch((function(e){throw new Error(e)}))):Promise.reject({errorCode:"PlatformErrorCodes.OperationIsNotSupportedOnThisDevice"})},e.prototype.invokeARViewAsync=function(e){return this.isInvokeARViewAsyncAvailable()?this.getARViewerPlugin().invokeARView(e):Promise.resolve("")},e.prototype.isInvokeARViewAsyncAvailable=function(){return null!=this.getARViewerPlugin()},e.prototype.getARViewerPlugin=function(){try{return Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.AugmentedReality.IARViewerPluginSingletonKey)}catch(e){return null}},e.prototype.isGetBarcodeValueOperationAvailable=function(){return!!(window.cordova&&cordova.plugins&&cordova.plugins.barcodeScanner)},e.prototype.getBarcodePlugin=function(){return this.isGetBarcodeValueOperationAvailable()?cordova.plugins.barcodeScanner:null},e}()},function(e,t,i){"use strict";i.r(t),i.d(t,"LocationService",(function(){return r}));var r=function(){function e(e){this._service=e||navigator.geolocation}return e.prototype._getLocationService=function(){return this._service},e.prototype.getCurrentPositionAsync=function(){var e=this;return Core.Utility.isFunction(this._getLocationService().getCurrentPosition)?new Promise((function(t,i){e._getLocationService().getCurrentPosition((function(e){t(e)}),(function(e){i(e)}))})):Promise.resolve(null)},e}()},function(e,t,i){"use strict";i.r(t);var r=function(e){function t(){var t=e.call(this)||this;return t._timerId=0,t._configured=!1,t._onIntervalStart=Core.Utility.noOpFn,t._onIntervalEnd=Core.Utility.noOpFn,t._onUpdateElapsed=Core.Utility.noOpFn,t._repeat=!1,t._interval=0,t._elapsed=0,t._active=!1,t._timestampAtLastProcessed=0,t._processSubInterval=t._processSubInterval.bind(t),t}return __extends(t,e),Object.defineProperty(t.prototype,"isActive",{get:function(){return this._active},enumerable:!1,configurable:!0}),t.prototype.stop=function(e){this._stopInternal(),e&&(this._elapsed=0),this._onUpdateElapsed(this._elapsed)},t.prototype.start=function(){this._stopInternal(),this._elapsed>=this._interval&&(this._elapsed=0),this._timestampAtLastProcessed=Date.now(),this._timerId=setInterval(this._processSubInterval,t.SUB_INTERVAL_RESOLUTION),this._active=!0,this._onIntervalStart()},t.prototype.configure=function(e,i,r,n,o){this._configured||(this._onIntervalStart=e,this._onIntervalEnd=i,this._onUpdateElapsed=r,this._repeat=n,this._interval=Core.Utility.clamp(o,t.SUB_INTERVAL_RESOLUTION,t.MAX_INTERVAL),this._configured=!0),this._onUpdateElapsed(this._elapsed)},t.prototype.updateInterval=function(e){this._interval=Core.Utility.clamp(e,t.SUB_INTERVAL_RESOLUTION,t.MAX_INTERVAL),this._checkEndIntervalCondition()},t.prototype.updateRepeat=function(e){this._repeat=e},t.prototype.dispose=function(){this._stopInternal(),this._onIntervalStart=null,this._onIntervalEnd=null,this._onUpdateElapsed=null,e.prototype.dispose.call(this)},t.prototype._stopInternal=function(){this._timerId&&(clearInterval(this._timerId),this._timerId=null),this._active=!1},t.prototype._processSubInterval=function(){var e=Date.now(),t=e-this._timestampAtLastProcessed;this._timestampAtLastProcessed=e,this._active&&(this._elapsed+=t),this._onUpdateElapsed(this._elapsed),this._checkEndIntervalCondition()},t.prototype._checkEndIntervalCondition=function(){this._elapsed>=this._interval&&(this._onIntervalEnd(),this._repeat?(this._elapsed=0,this._onIntervalStart()):this.stop())},t.SUB_INTERVAL_RESOLUTION=50,t.MAX_INTERVAL=864e5,t}(Core.Disposable);i.d(t,"TimerService",(function(){return n}));var n=function(){function e(){this._timers=new Map}return e.prototype.createTimer=function(e,t){this._timers.has(e)&&this.deleteTimer(e);var i=new r;this._timers.set(e,i),t&&this.configureTimer(e,t)},e.prototype.configureTimer=function(e,t){this._timers.has(e)&&this._timers.get(e).configure(t.onIntervalStart,t.onIntervalEnd,t.onUpdateElapsed,t.repeat,t.interval)},e.prototype.startTimer=function(e){this._timers.has(e)&&this._timers.get(e).start()},e.prototype.stopTimer=function(e,t){this._timers.has(e)&&this._timers.get(e).stop(t)},e.prototype.deleteTimer=function(e){this._timers.has(e)&&(this._timers.get(e).dispose(),this._timers.delete(e))},e.prototype.updateTimerInterval=function(e,t){this._timers.has(e)&&this._timers.get(e).updateInterval(t)},e.prototype.updateTimerRepeat=function(e,t){this._timers.has(e)&&this._timers.get(e).updateRepeat(t)},e.prototype.isTimerActive=function(e){return!!this._timers.has(e)&&this._timers.get(e).isActive},e}()},function(e,t,i){"use strict";i.r(t),i.d(t,"SendMessageService",(function(){return r}));var r=function(){function e(){}return e.prototype.isGetMessageReceiverAvailable=function(){return null!==this.getSendMessagePlugin()},e.prototype.getMessageReceiver=function(e,t){if(this.isGetMessageReceiverAvailable())return this.getSendMessagePlugin().getMessageReceiverAsync(e,t);throw new Error("getMessageReceiver operation is not supported on this device.")},e.prototype.getSendMessagePlugin=function(){try{return Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.Messaging.ISendMessagePluginSingletonKey)}catch(e){return null}},e}()},function(e,t,i){"use strict";i.r(t),i.d(t,"ClientInfraServices",(function(){return a}));var r=i(0),n=i(2),o=i(1),s=i(3),a=function(){function e(){}return e.getTimerService=function(){return e._timerService||(e._timerService=new n.TimerService),e._timerService},e.getMediaService=function(){return e._mediaService||(e._mediaService=new r.MediaService),e._mediaService},e.getLocationService=function(){if(!e._locationService){var t=Core.Environment.isTeamsMobile()?new AppMagic.DynamicDataSource.CordovaLocationProfile:null;e._locationService=new o.LocationService(t)}return e._locationService},e.getSendMessageService=function(){return e._sendMessageService||(e._sendMessageService=new s.SendMessageService),e._sendMessageService},e._timerService=null,e._mediaService=null,e._locationService=null,e._sendMessageService=null,e}()},function(e,t,i){i(7),e.exports=i(6)},function(e,t,i){"use strict";i.r(t);var r=i(4);i.d(t,"ClientInfraServices",(function(){return r.ClientInfraServices}));var n=i(1);i.d(t,"IGeolocationPlugin",(function(){return n.IGeolocationPlugin})),i.d(t,"ILocationService",(function(){return n.ILocationService})),i.d(t,"LocationService",(function(){return n.LocationService}));var o=i(0);i.d(t,"IBarcodeScanResult",(function(){return o.IBarcodeScanResult})),i.d(t,"IBarcodeScannerOptions",(function(){return o.IBarcodeScannerOptions})),i.d(t,"IBarcodeScannerPlugin",(function(){return o.IBarcodeScannerPlugin})),i.d(t,"IMediaService",(function(){return o.IMediaService})),i.d(t,"IPickFileOptions",(function(){return o.IPickFileOptions})),i.d(t,"MediaService",(function(){return o.MediaService}));var s=i(3);i.d(t,"SendMessageService",(function(){return s.SendMessageService}));var a=i(2);i.d(t,"ITimerParams",(function(){return a.ITimerParams})),i.d(t,"ITimerService",(function(){return a.ITimerService}))},function(e,t,i){"use strict";i.r(t);var r=i(4);Core.exportToNamespace(["AppMagic","PowerApps"],r);var n=i(1);Core.exportToNamespace(["AppMagic","PowerApps"],n);var o=i(0);Core.exportToNamespace(["AppMagic","PowerApps"],o);var s=i(3);Core.exportToNamespace(["AppMagic","PowerApps"],s);var a=i(2);Core.exportToNamespace(["AppMagic","PowerApps"],a)}]);
//# sourceMappingURL=D:/a/_work/1/s/obj/Assets/js/Core.ClientInfra/Core.ClientInfra.js.map
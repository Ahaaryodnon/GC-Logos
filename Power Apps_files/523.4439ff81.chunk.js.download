/*! For license information please see 523.4439ff81.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[523],{22435:function(e,t,n){"use strict";n.d(t,"a",(function(){return ae}));var a=n(10926),o=n.n(a),l=n(11860),i=n(12139),r=n(12146),u=n(11465),s=n(22436),c=n(11623),d=n(11625),m=n(12685),v=n(12687),b=n(11712),p=n(11823),g=n(11824),f=n(21879),h=n(22437),O=n(13586),y=n(12088),j=n(11940),C=n(11942),R=n(11932),N=n(11934),M=n(21622),P=n(11021),E=n(14145),S=n(12258),T=n.n(S),w=n(22438),I=n.n(w),D=n(21618),k=n(12671),F=n(22445),L=n(22504),A=n(11698),x=n(22521),U=n(22522),W=n(22523),z=n(21910),B=n(22536),q=n(22541),V=n(11885),H=n(22446),G=n(22542),Q=n(19333),_=n(22505),J=n(22534),K=n(22543),X=n(13737),Y=n(14239),$=n(14837),Z=n(19450);function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ae=Object(u.s)("PowerappsPortalColumns")(Object(d.a)(e=>{var t,n,s,d,S,w,ee,ne,ae,oe,le,ie,re,ue,se,ce,de,me,ve,{t:be,styles:pe,theme:ge,panelDetails:fe}=e,{isCreateMode:he,onPanelDismiss:Oe,isParentLoading:ye,showPanel:je,isDisabled:Ce,solutionId:Re,tableId:Ne,tableName:Me,columnId:Pe,attributeProps:Ee,isTableDesignerContext:Se,errorOnPreloadColumnFromTableDesigner:Te,shouldSkipApiAndUseDevEnvironmentDefaults:we,isSolutionFirst:Ie}=fe,{environmentClient:De}=Object(O.e)(),ke=Object(X.e)({isSolutionFirst:!!Ie}),[Fe,Le]=Object(a.useState)(!1),[Ae,xe]=Object(a.useState)(!0),[Ue,We]=Object(a.useState)(!0),[ze,Be]=Object(a.useState)(!1),[qe,Ve]=o.a.useState(!1),[He,Ge]=o.a.useState(!1),[Qe,_e]=Object(a.useState)(!1),[Je,Ke]=Object(a.useState)(!1),[Xe,Ye]=Object(a.useState)(!1),[$e,Ze]=Object(a.useState)(!1),[et,tt]=Object(a.useState)(0),[nt,at]=Object(a.useState)(!1),[ot,lt]=Object(a.useState)(!1),[it,rt]=Object(a.useState)(!1),[ut,st]=Object(a.useState)(""),[ct,dt]=Object(a.useState)(""),[mt,vt]=Object(a.useState)(void 0),[bt,pt]=Object(a.useState)(Object(L.f)()),[gt,ft]=Object(a.useState)(void 0),ht=Object(a.useRef)(),{enableColumnLevelSecurity:Ot}=Object(Z.e)(),{formulaColumn:yt}=Object(Z.f)();Object(a.useEffect)(()=>{ht.current=Object(P.X)(y.a,M.j.LoadingPanel)},[]);var{isCDSLiteUX:jt,crmInstanceUrl:Ct,locale:Rt,solution:Nt,solutionUniqueName:Mt,column:Pt,table:Et}=Object(K.a)({t:be,isCreateMode:he,refetchColumn:Xe,solutionId:Re,tableId:Ne,tableName:Me,columnId:Pe,attributeProps:Ee,isStageData:!1},!!we),{data:St}=Object($.m)({attributeLogicalName:null===(t=bt.schemaName)||void 0===t?void 0:t.toLowerCase(),entityName:null!==(n=null==Et||null===(s=Et.table)||void 0===s?void 0:s.logicalName)&&void 0!==n?n:""},!!Ot),Tt=null==Pt||null===(d=Pt.column)||void 0===d?void 0:d.attributeType,wt=!(he||(Tt!==V.d.Lookup||null!=Ee&&Ee.oneToManyRelationshipName)&&(Tt!==V.d.Customer||null!=Ee&&Ee.accountRelationshipName&&null!=Ee&&Ee.contactRelationshipName)),It=he||!wt,Dt=!((Tt!==V.d.Lookup||null!=bt&&bt.oneToManyRelationshipName)&&(Tt!==V.d.Customer||null!=bt&&bt.accountRelationshipName&&null!=bt&&bt.contactRelationshipName)),kt=Object(G.a)({tableId:Ne,solutionId:Re,defaultErrorMessage:be("Common.Request.Failed"),skip:It,refetchQuery:!It&&Dt}),{updateColumn:Ft,columnUpdated:Lt,errorMessage:At,loading:xt}=Object(z.f)(y.a,be("Common.Request.Failed")),{createColumn:Ut,columnCreated:Wt,errorMessage:zt,loading:Bt}=Object(z.a)(y.a,be("Common.Request.Failed")),qt=!(he&&Wt&&!Bt&&!zt&&nt&&bt.schemaName),Vt="".concat(ct).concat(null===(S=bt.schemaName)||void 0===S?void 0:S.toLowerCase()),Ht=Object(h.b)({tableId:Ne,columnLogicalName:Vt,skip:qt,refetchQuery:$e,defaultErrorMessage:be("Common.Request.Failed")}),Gt=Object(q.a)({defaultErrorMessage:be("Common.Request.Failed"),solutionId:null==Nt?void 0:Nt.solutionId,tableLogicalName:(null==Et||null===(w=Et.table)||void 0===w?void 0:w.logicalName)||Me,skip:!(null!=Nt&&Nt.solutionId)||qt,refetchQuery:$e}),{loading:Qt,fetching:_t,errorMessage:Jt,columns:Kt}=Object(z.e)(Ne||"",y.a,be("Common.Request.Failed"),!he&&!(null==Pt||null===(ee=Pt.column)||void 0===ee||!ee.id)&&!!bt.isPossiblyRelatedToRollupOrCalculatedColumn,Xe),{createRelationship:Xt,isRelationshipCreated:Yt,errorMessage:$t,isLoading:Zt}=Object(B.a)(y.a,be("Common.Request.Failed")),{createRelationship:en,isRelationshipCreated:tn,errorMessage:nn,isLoading:an}=Object(B.b)(y.a,be("Common.Request.Failed")),on=!((Wt||Lt||Yt||tn)&&Se),ln=Object(h.c)({tableLogicalName:(null==Et||null===(ne=Et.table)||void 0===ne?void 0:ne.logicalName)||(null==Me?void 0:Me.toLowerCase()),columnLogicalName:Lt?bt.logicalName:Vt,skip:on,refetchQuery:$e,defaultErrorMessage:be("Common.Request.Failed")}),{createAttributeMaskingRule:rn,loading:un,errorMessage:sn}=Object($.k)(),{deleteAttributeMaskingRule:cn,loading:dn,errorMessage:mn}=Object($.l)(),{updateAttributeMaskingRule:vn,loading:bn,errorMessage:pn}=Object($.s)();o.a.useEffect(()=>{null!=ln&&ln.loading||null!=ln&&ln.errorMessage||null==ln||!ln.column?ft(void 0):ft(null==ln?void 0:ln.column)},[null==ln?void 0:ln.loading,null==ln?void 0:ln.errorMessage,null==ln?void 0:ln.column]);var gn=o.a.useMemo(()=>Object(c.a)()(pe,{theme:ge}),[pe,ge]);Object(a.useEffect)(()=>{if(null==Nt||!Nt.loading){var e=Object(D.b)(null==Nt?void 0:Nt.customizationPrefix);dt(e)}},[null==Nt?void 0:Nt.customizationPrefix,null==Nt?void 0:Nt.loading]),Object(a.useEffect)(()=>{var e,t,n,a,o,l,i=Fe,r=!je||ye||!De||!Nt||!(null==Nt||!Nt.loading)||!Et||!(null==Et||!Et.loading)||!he&&(!(null==Pt||!Pt.loading)||!Pt)||Bt||Zt||an||xt||(null==Ht?void 0:Ht.loading)||(null==Gt?void 0:Gt.loading)||(null==kt?void 0:kt.loading)||Qt||_t||i||un||bn||dn;r||i||(null===(e=ht.current)||void 0===e||e.complete({isCreateMode:he,solutionId:null==Nt?void 0:Nt.solutionId,currentTableId:null==Et||null===(t=Et.table)||void 0===t?void 0:t.id,columnIdFromGetById:null==Pt||null===(n=Pt.column)||void 0===n?void 0:n.id,columnIdFromGetLogicalName:null==Ht||null===(a=Ht.column)||void 0===a?void 0:a.id,columnId:(null==Pt||null===(o=Pt.column)||void 0===o?void 0:o.id)||(null==Ht||null===(l=Ht.column)||void 0===l?void 0:l.id)}),ht.current=void 0);xe(r),We(i)},[je,ye,De,Nt,null==Nt?void 0:Nt.loading,Et,null==Et?void 0:Et.loading,he,Fe,Pt,null==Pt?void 0:Pt.loading,xt,Bt,Zt,an,null==Ht?void 0:Ht.loading,null==Gt?void 0:Gt.loading,null==kt?void 0:kt.loading,Qt,_t,null==Ht||null===(ae=Ht.column)||void 0===ae?void 0:ae.id,un,bn,dn]),Object(a.useEffect)(()=>{var e=!(null!=Nt&&Nt.loading)&&(null==Nt?void 0:Nt.errorMessage)||!(null!=Pt&&Pt.loading)&&(null==Pt?void 0:Pt.errorMessage)||!xt&&At||!Bt&&zt||!Zt&&$t||!an&&nn||(null==kt?void 0:kt.errorMessage)||Jt||Se&&Te||!un&&sn||!dn&&mn||!bn&&pn;if(e){var t,n=bt.isFormula?M.j.FormulaColumnError:M.j.ColumnError;st(e),Ye(!1),Le(!1),null===(t=ht.current)||void 0===t||t.failure(e),ht.current=void 0,Object(P.U)(y.a,{eventName:n,eventData:{error:e,isTableDesignerContext:Se,errorOnPreloadColumnFromTableDesigner:Te}},{message:e},P.j.PowerappsPortal)}else st("")},[null==Nt?void 0:Nt.errorMessage,null==Nt?void 0:Nt.loading,null==Pt?void 0:Pt.errorMessage,null==Pt?void 0:Pt.loading,At,zt,$t,nn,xt,Bt,Zt,an,null==kt?void 0:kt.errorMessage,Jt,Te,Se,bt.isFormula,un,sn,dn,mn,bn,pn]),Object(a.useEffect)(()=>{if((null==Pt||!Pt.loading)&&null!=Pt&&Pt.column&&(null==Pt||!Pt.errorMessage)&&!he&&Pe){var e,t=Object(L.g)(be,null==Pt?void 0:Pt.column,null==Ee?void 0:Ee.accountRelationshipName,null==Ee?void 0:Ee.contactRelationshipName,null==Ee?void 0:Ee.oneToManyRelationshipName,St,!!Ot);pt(t),vt(t),Object(P.W)(y.a,{eventName:M.j.GetColumnFormValues,eventData:{columnIdProp:Pe,columnId:null==Pt||null===(e=Pt.column)||void 0===e?void 0:e.id,column:I()(t,M.r),accountRelationshipLogicalName:null==Ee?void 0:Ee.accountRelationshipName,contactRelationshipLogicalName:null==Ee?void 0:Ee.contactRelationshipName,oneToManyRelationshipLogicalName:null==Ee?void 0:Ee.oneToManyRelationshipName}})}},[be,Pe,he,null==Pt?void 0:Pt.column,null==Pt?void 0:Pt.errorMessage,null==Pt?void 0:Pt.loading,null==Ee?void 0:Ee.accountRelationshipName,null==Ee?void 0:Ee.contactRelationshipName,null==Ee?void 0:Ee.oneToManyRelationshipName,St,Ot]),Object(a.useEffect)(()=>{var e=null==Et?void 0:Et.table,t=null==e?void 0:e.id,n=null==Pt?void 0:Pt.column;if((null==Et||!Et.loading)&&t&&(null==Pt||!Pt.loading)){var a=!(null==Nt||!Nt.solutionIsManaged),o=!(null==Nt||!Nt.solutionIsPatched),l=!(null==e||!e.isManaged),i=!(null==e||!e.isCustomizable),r=!(null==e||!e.canCreateAttributes),u=!(null==n||!n.isManaged),s=!!u;Object(P.W)(y.a,{eventName:M.j.SolutionAndTableDetails,eventData:{isCreateMode:he,currentTableId:t,isSolutionManaged:a,isSolutionPatched:o,isTableManaged:l,isTableCustomizable:i,canCreateAttributes:r,isColumnManaged:u,isColumnCustomizable:s}}),rt(he?!Object(E.b)(a,o,l,i,r)||Object(J.e)(null==e?void 0:e.entityType,null==e?void 0:e.dataProviderId):!Object(E.c)(a,o,l,i,u,s))}},[null==Nt?void 0:Nt.solutionIsManaged,null==Nt?void 0:Nt.solutionIsPatched,he,null==Et?void 0:Et.loading,null==Et?void 0:Et.table,null==Et||null===(oe=Et.table)||void 0===oe?void 0:oe.id,null==Pt?void 0:Pt.loading,null==Pt||null===(le=Pt.column)||void 0===le?void 0:le.id,null==Pt?void 0:Pt.column]),Object(a.useEffect)(()=>{var e,t,n,a=null==kt?void 0:kt.relationships,o=null==Pt||null===(e=Pt.column)||void 0===e?void 0:e.logicalName,l=null==Et||null===(t=Et.table)||void 0===t?void 0:t.logicalName;if(wt&&(null==kt||!kt.loading)&&(null==kt||!kt.errorMessage)&&null!=a&&a.length&&o&&l)if((null==Pt||null===(n=Pt.column)||void 0===n?void 0:n.attributeType)===V.d.Lookup){var i,r=null==a||null===(i=a.find(e=>e.referencedAttribute===o&&e.referencedEntity===l||e.referencingAttribute===o&&e.referencingEntity===l))||void 0===i?void 0:i.schemaName;pt(e=>te(te({},e),{},{oneToManyRelationshipName:r}))}else{var u,s,c=null==a||null===(u=a.find(e=>e.referencingAttribute===o&&e.referencedEntity===Q.a))||void 0===u?void 0:u.schemaName,d=null==a||null===(s=a.find(e=>e.referencingAttribute===o&&e.referencedEntity===Q.b))||void 0===s?void 0:s.schemaName;pt(e=>te(te({},e),{},{accountRelationshipName:c,contactRelationshipName:d}))}},[wt,null==kt?void 0:kt.errorMessage,null==kt?void 0:kt.loading,null==kt?void 0:kt.relationships,null==Pt||null===(ie=Pt.column)||void 0===ie?void 0:ie.logicalName,null==Pt||null===(re=Pt.column)||void 0===re?void 0:re.attributeType,null==Et||null===(ue=Et.table)||void 0===ue?void 0:ue.logicalName]),Object(a.useEffect)(()=>{if(!he&&bt.isPossiblyRelatedToRollupOrCalculatedColumn&&!Qt&&!_t&&Kt){var e,t=null==Kt||null===(e=Kt.filter(e=>e.sourceType===V.z.Rollup))||void 0===e?void 0:e.map(e=>e.logicalName),n=bt.logicalName,a=null==n?void 0:n.substring(0,null==n?void 0:n.lastIndexOf("_"));lt(!(null==t||!t.find(e=>e.toLowerCase()===a)))}},[he,Qt,bt.isPossiblyRelatedToRollupOrCalculatedColumn,Kt,_t,bt.logicalName]);var fn=o.a.useCallback((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Le(!1),Ye(!1),Ze(!1),at(!1),tt(0),lt(!1),Oe&&Oe(e,Se?{columnForTableDesignerContext:gt}:{columnForDefaultContext:bt}),Object(P.W)(y.a,{eventName:M.j.DismissPanel,eventData:{wasDataUpdated:e,isTableDesignerContext:Se,isCreateMode:he}})}),[Oe,bt,he,Se,gt]),hn=o.a.useCallback(()=>{var e=["primaryColumnSchemaNameWithPrefix","wasSchemaNameManuallyUpdated","wasRelationshipSchemaNameManuallyUpdated","isFormValid","isParentTableVirtual","oneToManyRelationshipName","accountRelationshipName","contactRelationshipName"],t=I()(bt,e),n=I()(Object(L.f)(),e),a=mt?I()(mt,e):t;return!he&&!T()(t,a)||he&&!T()(t,n)},[mt,bt,he]),On=Object(a.useCallback)(()=>{var e,t=null==bt?void 0:bt.attributeMaskingRule,n=null==Et||null===(e=Et.table)||void 0===e?void 0:e.logicalName;if(t&&n)if(t.maskingRuleId){var{attributeMaskingRuleId:a,maskingRuleId:o}=t,l={attributeLogicalName:bt.schemaName.toLowerCase(),entityName:n,maskingRuleId:null!=o?o:"",uniqueName:bt.schemaName};a?vn(te({attributeMaskingRuleId:a},l)):rn(l)}else{var i,r;cn({attributeMaskingRuleId:null!==(i=null==bt||null===(r=bt.attributeMaskingRule)||void 0===r?void 0:r.attributeMaskingRuleId)&&void 0!==i?i:""})}},[rn,cn,null==bt?void 0:bt.attributeMaskingRule,bt.schemaName,null==Et||null===(se=Et.table)||void 0===se?void 0:se.logicalName,vn]),yn=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=e||Lt;if(!t&&hn())Ve(!0);else if(nt){var n,a,o,l,i,r=he?(null==Ht||null===(n=Ht.column)||void 0===n?void 0:n.id)||(null==Gt||null===(a=Gt.tableRelatedRecords)||void 0===a||null===(o=a.find(e=>{var t;return(null===(t=e.schemaName)||void 0===t?void 0:t.toLowerCase())===(null==Vt?void 0:Vt.toLowerCase())}))||void 0===o?void 0:o.id):null==Pt||null===(l=Pt.column)||void 0===l?void 0:l.id,u=(null==Nt?void 0:Nt.solutionId)||Re||"",s=(null==Et||null===(i=Et.table)||void 0===i?void 0:i.id)||Ne||"";if(r&&u&&Ct&&s){var c=bt.behavior===V.z.Calculated?Object(f.b)(Ct,u,s,r):Object(f.c)(Ct,u,s,r);Object(P.W)(y.a,{eventName:M.j.OpenExternalUri,eventData:{columnCreatedId:r,currentTableId:s,solutionId:u,externalUri:c}}),window.open(c,"_blank","innerWidth=800,innerHeight=510"),at(!1)}r||null!=Ht&&Ht.loading||null!=Gt&&Gt.loading||!(null!=Ht&&Ht.errorMessage||null!=Gt&&Gt.errorMessage)||(et<3?(Ze(!0),tt(et+1)):at(!1),Object(P.W)(y.a,{eventName:M.j.RetryToOpenExternalUri,eventData:{columnByLogicalNameErrorMessage:null==Ht?void 0:Ht.errorMessage,allTableRelatedRecordsErrorMessage:null==Gt?void 0:Gt.errorMessage,currentTableId:s,solutionId:Re,retryRefetchColumnByLogicalName:et}}))}else Le(!1),Ye(!1),Ze(!1),fn(t),at(!1),tt(0)};Object(a.useEffect)(()=>{(Wt||Yt||tn)&&(Se?gt&&yn(!0):yn(!0))},[Wt,Yt,tn,yn,Se,gt]),Object(a.useEffect)(()=>{Se?Lt&&gt&&yn(!0):!he&&Fe&&Lt&&(Xe?!Xe||null!=Pt&&Pt.loading||null==Pt||!Pt.column||yn(!0):Ye(!0))},[he,Fe,Lt,Xe,yn,null==Pt?void 0:Pt.loading,null==Pt?void 0:Pt.column,Se,gt]),Object(a.useEffect)(()=>{var{disabledColumn:e,disabledColumnWithAdditionalSettings:t,disableColumnWithNoRename:n}=Object(L.b)(null==Nt?void 0:Nt.solutionIsManaged,null==Nt?void 0:Nt.solutionIsPatched,bt.isManaged,bt.isCustomizable,bt.canModifyAdditionalSettings,bt.isRenameable);Be(e),_e(t),Ke(n)},[Nt,bt.isManaged,bt.isCustomizable,bt.canModifyAdditionalSettings,bt.isRenameable]),Object(a.useEffect)(()=>{var e,t,n=bt.attributeMaskingRule,a=null==Et||null===(e=Et.table)||void 0===e?void 0:e.logicalName;!(Ot&&n&&bt.isSecured&&a)||(Wt?rn({attributeLogicalName:Vt,entityName:a,maskingRuleId:null!==(t=n.maskingRuleId)&&void 0!==t?t:"",uniqueName:ct+bt.schemaName}):Lt&&On())},[Wt,Vt,ct,Lt,rn,Ot,bt.attributeMaskingRule,bt.isSecured,bt.schemaName,On,null==Et||null===(ce=Et.table)||void 0===ce?void 0:ce.logicalName]);var jn=o.a.useCallback((e,t,n)=>o.a.createElement(o.a.Fragment,null,o.a.createElement(i.a,{className:gn.mainContentArea,horizontal:!0,horizontalAlign:"space-between"},o.a.createElement(i.a,{horizontal:!0,horizontalAlign:"center"},o.a.createElement("h1",{id:n,className:gn.headerTitle},fe.header)),o.a.createElement(i.a,{className:gn.headerCloseButton},o.a.createElement(k.a,{content:be("Common.Close")},o.a.createElement(b.a,{ariaLabel:be("Common.Close"),iconProps:{iconName:"Cancel"},id:"ColumFormPanel_CloseButton",onClick:()=>yn(),className:gn.headerCloseButtonLabel})))),o.a.createElement(r.a,{className:gn.subHeaderContent},o.a.createElement("p",{className:gn.description},fe.description,o.a.createElement(l.a,{href:f.a.aboutColumns,target:"_blank"},be("Common.LearnMore")))),o.a.createElement(r.a,null,ut&&!Ae&&o.a.createElement(R.a,{className:gn.errorMessageBar,messageBarType:N.a.error,onDismiss:()=>st(""),dismissButtonAriaLabel:be("Common.Close")},ut))),[ut,Ae,yn,fe.description,fe.header,be,gn]),Cn=o.a.useCallback(()=>{var e,t,n,a=null==Et||null===(e=Et.table)||void 0===e?void 0:e.isVirtualTable,o=null==Et||null===(t=Et.table)||void 0===t?void 0:t.schemaName,l=Me||o,i=null==Et||null===(n=Et.table)||void 0===n?void 0:n.logicalName;if(Le(!0),he){var r,s;if(bt.type===V.d.Customer){var c=Object(L.e)(bt,ct,he,a,null==Et?void 0:Et.table);r={relationshipInput:c,solutionUniqueName:Mt,localeId:0!==Rt?Rt:1033},s={lookupColumn:I()(null==c?void 0:c.lookupColumn,M.q),accountRelationship:I()(null==c?void 0:c.accountRelationship,["schemaName"]),contactRelationship:I()(null==c?void 0:c.contactRelationship,["schemaName"]),isVirtualTable:a,columnPrefix:ct},Xt(r)}else if(bt.type===V.d.Lookup){var d=Object(L.d)(bt,ct,he,a,null==Et?void 0:Et.table);s={lookupColumn:I()(null==d?void 0:d.lookupColumn,M.q),oneToManyRelationship:I()(null==d?void 0:d.oneToManyRelationship,["schemaName"]),isVirtualTable:a,columnPrefix:ct},en(r={relationshipInput:d,solutionUniqueName:Mt,localeId:0!==Rt?Rt:1033,isPreferredSolutionFeatureEnabled:ke})}else{var m=Object(L.c)(bt,ct,a);s=I()(m,M.q),r={tableId:Ne||"",tableName:l,column:m,solutionUniqueName:Mt,localeId:0!==Rt?Rt:1033,localeString:Object(u.h)(),isPreferredSolutionFeatureEnabled:ke,isFormulaOptionSetEnabled:null==yt?void 0:yt.enableOptionSet},Ut(r),Object(H.c)(bt.behavior)&&at(!0)}Object(P.W)(y.a,{eventName:M.j.CreateColumn,eventData:{tableId:Ne,currentTableLogicalName:i,columnType:bt.type,columnOrRelationshipDetailsToLog:s,solutionUniqueName:Mt,localeId:0!==Rt?Rt:1033}})}else{var v={tableId:Ne||"",tableName:l,column:Object(L.i)(bt,Pe||"",a),solutionUniqueName:Mt,localeId:0!==Rt?Rt:1033,localeString:Object(u.h)(),isPreferredSolutionFeatureEnabled:ke};Object(P.W)(y.a,{eventName:M.j.UpdateColumn,eventData:{tableId:Ne,currentTableLogicalName:i,columToBeUpdated:I()(null==v?void 0:v.column,M.q),columnId:Pe,isVirtualTable:a}}),Ft(v)}},[Pe,Mt,Rt,ct,Ne,Me,null==Et?void 0:Et.table,null==Et||null===(de=Et.table)||void 0===de?void 0:de.entityType,null==Et||null===(me=Et.table)||void 0===me?void 0:me.logicalName,null==Et||null===(ve=Et.table)||void 0===ve?void 0:ve.schemaName,bt,he,Le,ke,Ut,Xt,en,Ft]),Rn=o.a.useCallback(()=>{he?(Cn(),Object(P.W)(y.a,{eventName:M.j.CreateCalculatedAndRollupColumn,eventData:{behavior:bt.behavior}})):hn()?(Ge(!0),Object(P.W)(y.a,{eventName:M.j.UpdateCalculatedAndRollupColumn,eventData:{behavior:bt.behavior,hasUserEditForm:hn}})):(Cn(),at(!0))},[he,Cn,hn,bt.behavior]),Nn=o.a.useMemo(()=>it||ot||!he&&!(null!=Pt&&Pt.column)&&!(null==Pt||!Pt.errorMessage)||!he&&Object(_.a)(bt.schemaName,bt.type),[it,ot,he,null==Pt?void 0:Pt.column,null==Pt?void 0:Pt.errorMessage,bt.schemaName,bt.type]),Mn=Ce||Nn||!(null==Nt||!Nt.errorMessage)||Ae||Fe||ze||Object(L.k)(he,bt),Pn=o.a.useCallback(()=>o.a.createElement(i.a,{horizontal:!0,horizontalAlign:"start"},o.a.createElement(p.a,{disabled:Mn||!he&&!hn(),text:be("Common.Save"),id:"ColumFormPanel_Save",className:gn.primaryButton,onClick:Cn}),o.a.createElement(g.a,{text:be("Common.Cancel"),id:"ColumFormPanel_Cancel",disabled:Fe,onClick:()=>yn()})),[Fe,be,yn,Mn,Cn,he,hn,gn.primaryButton]),En=o.a.useCallback(()=>Fe?void 0:yn(),[Fe,yn]),Sn=o.a.useMemo(()=>o.a.createElement(x.a,{onPanelDismiss:()=>fn(!1),openDialog:qe,setOpenDiscardDialog:Ve}),[fn,Ve,qe]),Tn=o.a.useMemo(()=>o.a.createElement(U.a,{onPanelAction:()=>{Cn(),at(!0)},openDialog:He,setOpenDialog:Ge,behavior:bt.behavior}),[Cn,at,Ge,He,bt.behavior]),wn={propertiesSectionDetails:{isCreateMode:he,isCDSLiteUX:jt,formFields:bt,setFormFields:pt,disableEntityWithNoCustomization:ze,disableEntityWithNoRenameOption:Je,disabledEntityWithNoModifyOption:Qe,solutionId:null==Nt?void 0:Nt.solutionId,columnName:bt.logicalName,createOrUpdateCalculatedAndRollupColumn:Rn,disableCalculatedAndRollupOption:Mn,disableActionOnColumn:Nn,solutionPublisherCustomizationOptionValuePrefix:null==Nt?void 0:Nt.publisherCustomizationOptionValuePrefix,parentTable:null==Et?void 0:Et.table,isSimpleCreateOrUpdateColumn:!1,isSolutionFirst:Ie}},In={advancedOptionsSectionDetails:{isCreateMode:he,isCDSLiteUX:jt,table:Et,formFields:bt,setFormFields:pt,disabledEntityWithNoModifyOption:Qe,disableEntityWithNoRenameOption:Je,disableActionOnColumn:Nn,columnPrefix:ct,isSimpleCreateOrUpdateColumn:!1}};return o.a.createElement(o.a.Fragment,null,Sn,Tn,o.a.createElement(m.a,{role:"presentation",key:fe.panelKey||"panelColumnTableFormKey",type:v.a.medium,isFooterAtBottom:!0,hasCloseButton:!1,className:gn.panel,isOpen:fe.showPanel,onDismiss:()=>En(),isBlocking:!He,isLightDismiss:!Fe,onOuterClick:()=>En(),onLightDismissClick:()=>En(),onRenderFooterContent:Pn,headerText:"columnPanel",onRenderHeader:jn,styles:Y.a},o.a.createElement(i.a,{className:gn.mainContentArea},o.a.createElement(r.a,{className:gn.mainContent},Ae&&o.a.createElement(A.a,{styles:{root:{backgroundColor:null==ge?void 0:ge.palette.white,opacity:.9}}},o.a.createElement(j.a,{size:C.a.large,label:be(Ue?"Common.Saving":"Common.Loading"),ariaLabel:be("Common.Loading"),ariaLive:"assertive",labelPosition:"right"})),!Ae&&o.a.createElement(o.a.Fragment,null,o.a.createElement(F.a,wn),o.a.createElement(W.a,In))))))},s.a))},22436:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(21631),o=e=>{var t=null==e?void 0:e.theme,n=null==t?void 0:t.palette;return{panel:{selectors:{".ms-Panel-commands":{marginTop:a.c},".ms-Panel-header":{paddingLeft:a.c,paddingRight:a.c},".ms-Panel-content":{paddingLeft:a.c,paddingRight:a.c,paddingBottom:a.c,marginBottom:11},".ms-Link":{fontSize:16,lineHeight:22,textDecoration:"underline",color:null==n?void 0:n.themeSecondary,selectors:{"&:hover":{color:null==n?void 0:n.themeSecondary},"&:active":{color:null==n?void 0:n.themeSecondary}}},".ms-Overlay .ms-Spinner":{position:"relative",top:"50%",transform:"translateY(-50%)"},".ms-Checkbox.is-disabled, .ms-TextField.is-disabled":{color:(null==n?void 0:n.neutralTertiary)||"#A19F9D"},".ms-Panel-footerInner":{paddingLeft:a.c},label:{lineHeight:20,alignItems:"flex-start"},".ms-TextField, .ms-Dropdown":{maxWidth:308}}},headerTitle:{fontSize:20,fontWeight:600,color:(null==n?void 0:n.neutralPrimary)||"#323130",lineHeight:28,overflowWrap:"break-word",wordBreak:"break-word",hyphens:"auto",marginLeft:a.c},headerCloseButton:{marginRight:a.c},headerCloseButtonLabel:{color:(null==n?void 0:n.neutralSecondary)||"#605E5C"},subHeaderContent:{marginLeft:a.c,marginBottom:4},mainContentArea:{fontSize:16,color:(null==n?void 0:n.neutralPrimary)||"#323130",selectors:{".ms-TooltipHost":{paddingLeft:5}}},mainContent:{marginTop:18},description:{fontSize:16,lineHeight:22,color:(null==n?void 0:n.neutralSecondary)||"#605E5C"},errorMessageBar:{marginBottom:4},primaryButton:{marginRight:8}}}},22521:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(21615),o=n(10926);function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var i=e=>o.createElement(a.a,l({},e,{translationFile:"PowerappsPortalColumns",titleAriaId:"columnFormClosePanelDialogTitle"}))},22522:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(11624),o=n(11629),l=n(11708),i=n(11823),r=n(11824),u=n(11466),s=n(10926),c=n(11885),d=e=>{var{onPanelAction:t,openDialog:n,setOpenDialog:d,behavior:m}=e,{t:v}=Object(u.g)("PowerappsPortalColumns"),b={main:{maxWidth:450}},p=s.useMemo(()=>({titleAriaId:"columnFormCalculatedAndRollupDialogTitle",isBlocking:!1,styles:b}),[]);return s.createElement(a.a,{hidden:!(n&&(m===c.z.Calculated||m===c.z.Rollup)),onDismiss:()=>d(!1),dialogContentProps:{type:o.a.normal,title:v("Column.FormMessage.PendingChanges"),subText:m===c.z.Calculated?v("Column.FormMessage.PendingChangesCalculated"):v("Column.FormMessage.PendingChangesRollup"),closeButtonAriaLabel:v("Common.Close")},modalProps:p},s.createElement(l.a,null,s.createElement(i.a,{onClick:()=>{d(!1),t()},text:v("Common.Save")}),s.createElement(r.a,{onClick:()=>d(!1),text:v("Common.Cancel")})))}},22536:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return f}));var a=n(10926),o=n(11021),l=n(13556),i=n(13770),r=n(12313),u=n(13771),s=n(22537),c=n(22539),d=n(22540);function m(e,t,n,a,o,l,i){try{var r=e[l](i),u=r.value}catch(s){return void n(s)}r.done?t(u):Promise.resolve(u).then(a,o)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(a,o){var l=e.apply(t,n);function i(e){m(l,a,o,i,r,"next",e)}function r(e){m(l,a,o,i,r,"throw",e)}i(void 0)}))}}function b(e,t){var n=l.g.createCustomerRelationship,r=Object(a.useRef)(),[s,c]=Object(a.useState)(""),{mutate:m,isLoading:v,data:b}=Object(u.a)(d.a,{mutationKey:["powerapps-ui-common","createCustomerRelationship"],onSuccess:()=>{var e;null===(e=r.current)||void 0===e||e.complete(),c("")},onError:e=>{var n,a=Object(i.c)(e,t);c(a),null===(n=r.current)||void 0===n||n.failure(e)}});return Object(a.useEffect)(()=>{v&&(r.current=Object(l.j)(e,n,l.d.DataExperience,l.e.DataFetchHooks,o.j.PowerappsPortal,o.f.Medium))},[v,n,e]),{createRelationship:m,isLoading:v,errorMessage:s,isRelationshipCreated:!(null==b||!b.createCustomerRelationship)}}function p(e,t){var n=l.g.createOneToManyRelationship,r=Object(a.useRef)(),[c,d]=Object(a.useState)(""),{mutate:m,isLoading:v,data:b}=Object(u.a)(s.a,{mutationKey:["powerapps-ui-common","createOneToManyRelationship"],onSuccess:()=>{var e;r&&(null===(e=r.current)||void 0===e||e.complete());d("")},onError:e=>{var n=Object(i.c)(e,t);d(n),r.current&&(g(e)?r.current.completeWithError(e):r.current.failure(e))}});return Object(a.useEffect)(()=>{v&&(r.current=Object(l.j)(e,n,l.d.DataExperience,l.e.DataFetchHooks,o.j.PowerappsPortal,o.f.Medium))},[v,n,e]),{createRelationship:m,isLoading:v,errorMessage:c,isRelationshipCreated:!(null==b||!b.createOneToManyRelationship)}}var g=e=>{var t=Object(i.b)(e),n=Object(i.a)(e);return 400===t&&("0x80044363"===n||"0x80072551"===n||"0x80047003"===n||"0x80047013"===n)};function f(e,t,n,u){var s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],d=arguments.length>5?arguments[5]:void 0,m=l.g.getRelatedManyToOneRelationshipsForTable,b=Object(a.useRef)(),[p,g]=Object(a.useState)(""),[f,h]=Object(a.useState)([]),{isInitialLoading:O,refetch:y,isFetching:j}=Object(r.a)(["powerapps-ui-common","GetRelatedManyToOneRelationshipsForTable",t,e],v((function*(){return Object(c.a)(e)})),{onSuccess:t=>{h(null==t?void 0:t.manyToOneRelationships),b.current&&(b.current.complete({tableId:e,relationshipsLoaded:null==t?void 0:t.manyToOneRelationships}),b.current=void 0),g("")},onError:e=>{var t=Object(i.c)(e,u);g(t),b.current&&(b.current.failure(e),b.current=void 0)},enabled:s});return Object(a.useEffect)(()=>{d&&y&&s&&y()},[d,s,y]),Object(a.useEffect)(()=>{(O||j)&&(b.current=Object(l.j)(n,m,l.d.DataExperience,l.e.DataFetchHooks,o.j.PowerappsPortal,o.f.Medium))},[j,O,m,n]),{relationships:f,fetching:j,loading:O,errorMessage:p}}},22537:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(22538),o=n(11868),l=n(13791),i=n(13768);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t,n,a,o,l,i){try{var r=e[l](i),u=r.value}catch(s){return void n(s)}r.done?t(u):Promise.resolve(u).then(a,o)}var d=function(){var e,t=(e=function*(e){var t,{isPreferredSolutionFeatureEnabled:n,localeId:r=1033,solutionUniqueName:s="",relationshipInput:c}=e,d=u(u({},Object(i.e)()),n?{}:{"MSCRM.SolutionUniqueName":s}),m=Object(a.b)(c,r),v={headers:d,method:"post",data:JSON.stringify(m)},b=yield Object(o.f)("".concat(l.b,"RelationshipDefinitions"),v);if(204!==(null==b?void 0:b.status)&&200!==(null==b?void 0:b.status))throw new Error(null==b||null===(t=b.data)||void 0===t?void 0:t.errorMessage);return{createOneToManyRelationship:!0}},function(){var t=this,n=arguments;return new Promise((function(a,o){var l=e.apply(t,n);function i(e){c(l,a,o,i,r,"next",e)}function r(e){c(l,a,o,i,r,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}()},22538:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return b}));var a=n(21936),o=n(11885),l=n(19333),i=n(13752),r=n.n(i);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){var n,l=null==e?void 0:e.oneToManyRelationship,i=null==l?void 0:l.cascadeConfiguration;return s(s({SchemaName:(null==l?void 0:l.schemaName)||"",ReferencedEntity:(null==l?void 0:l.referencedEntity)||"",ReferencingEntity:(null==l?void 0:l.referencingEntity)||"",Lookup:Object(a.a)(null==e?void 0:e.lookupColumn,t,!0),RelationshipType:o.t.OneToManyRelationship,IsCustomRelationship:!0,IsValidForAdvancedFind:null==e||null===(n=e.lookupColumn)||void 0===n?void 0:n.isValidForAdvancedFind},i?{CascadeConfiguration:{Assign:i.assign,Delete:i.delete,Merge:i.merge,Reparent:i.reparent,Share:i.share,Unshare:i.unshare,RollupView:i.rollupView,Archive:i.archive}}:{}),{},{"@odata.type":"Microsoft.Dynamics.CRM.OneToManyRelationshipMetadata"})}var m=s(s({},{id:"MetadataId",schemaName:"SchemaName",relationshipType:e=>e.EntityRelationshipType?e.EntityRelationshipType:e.RelationshipType}),{},{referencingAttribute:"ReferencingAttribute",referencedAttribute:"ReferencedAttribute",referencedEntity:"ReferencedEntity",referencingEntity:"ReferencingEntity"});function v(e){return r()(m,e)}function b(e,t,n){var o=null==e?void 0:e.accountRelationship,i={SchemaName:(null==o?void 0:o.schemaName)||"",ReferencedEntity:(null==o?void 0:o.referencedEntity)||l.a,ReferencingEntity:(null==o?void 0:o.referencingEntity)||""},r=null==e?void 0:e.contactRelationship;return s({OneToManyRelationships:[i,{SchemaName:(null==r?void 0:r.schemaName)||"",ReferencedEntity:(null==r?void 0:r.referencedEntity)||l.b,ReferencingEntity:(null==r?void 0:r.referencingEntity)||""}],Lookup:Object(a.a)(null==e?void 0:e.lookupColumn,n)},t?{SolutionUniqueName:t}:{})}},22539:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(13768),o=n(11868),l=n(22507),i=n(22538);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t,n,a,o,l,i){try{var r=e[l](i),u=r.value}catch(s){return void n(s)}r.done?t(u):Promise.resolve(u).then(a,o)}var d=function(){var e,t=(e=function*(e){var t,n,r={headers:u(u({},Object(a.e)()),{},{Consistency:"Strong"}),method:"get"},s=yield Object(o.f)("".concat(Object(l.a)(e),"?$expand=ManyToOneRelationships&api-version=9.1"),r);return{manyToOneRelationships:(null==s||null===(t=s.data)||void 0===t||null===(n=t.ManyToOneRelationships)||void 0===n?void 0:n.map(e=>Object(i.c)(e)))||[]}},function(){var t=this,n=arguments;return new Promise((function(a,o){var l=e.apply(t,n);function i(e){c(l,a,o,i,r,"next",e)}function r(e){c(l,a,o,i,r,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}()},22540:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(11868),o=n(13791),l=n(13768),i=n(22538);function r(e,t,n,a,o,l,i){try{var r=e[l](i),u=r.value}catch(s){return void n(s)}r.done?t(u):Promise.resolve(u).then(a,o)}var u=function(){var e,t=(e=function*(e){var t,{localeId:n=1033,solutionUniqueName:r="",relationshipInput:u}=e,s=Object(i.a)(u,r,n),c={headers:Object(l.e)(),method:"post",data:JSON.stringify(s)},d=yield Object(a.f)("".concat(o.b,"CreateCustomerRelationships"),c);if(204!==(null==d?void 0:d.status)&&200!==(null==d?void 0:d.status))throw new Error(null==d||null===(t=d.data)||void 0===t?void 0:t.errorMessage);return{createCustomerRelationship:!0}},function(){var t=this,n=arguments;return new Promise((function(a,o){var l=e.apply(t,n);function i(e){r(l,a,o,i,u,"next",e)}function u(e){r(l,a,o,i,u,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}()},22541:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(10926),o=n(11021),l=n(12088),i=n(21622),r=n(22507),u=n(12219),s=e=>{var{defaultErrorMessage:t,solutionId:n,tableLogicalName:s,refetchQuery:c,skip:d}=e,{hasDataverse:m}=Object(u.W)(),[v,b]=Object(a.useState)(void 0),{tableRelatedRecords:p,loading:g,fetching:f,errorMessage:h}=Object(r.f)(n||"",s||"",l.a,t,!n||!s||d,c);return Object(a.useEffect)(()=>{m?(Object(o.W)(l.a,{eventName:i.h.GetTableRelatedRecords,eventData:{loading:g,fetching:f,errorMessage:h,solutionId:n,tables:null==p?void 0:p.length}}),b({loading:g,fetching:f,errorMessage:h,tableRelatedRecords:p})):(Object(o.U)(l.a,{eventName:i.h.GetTableRelatedRecords,eventData:{error:"There was no database in current environment"}}),b({loading:!1,fetching:!1,errorMessage:t,tableRelatedRecords:p}))},[m,p,g,f,h,n,s]),v}},22542:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(10926),o=n(11021),l=n(12088),i=n(21622),r=n(22536),u=n(12219),s=e=>{var{defaultErrorMessage:t,tableId:n,solutionId:s,refetchQuery:c,skip:d}=e,{currentEnvironment:m}=Object(u.W)(),v=Object(u.v)(m),[b,p]=Object(a.useState)(void 0),g=!(!(v&&n&&s)||d),{relationships:f,loading:h,fetching:O,errorMessage:y}=Object(r.c)(n||"",s||"",l.a,t,g,c);return Object(a.useEffect)(()=>{v?(Object(o.W)(l.a,{eventName:i.g.GetRelatedManyToOneRelationshipsForCurrentTable,eventData:{loading:h,fetching:O,errorMessage:y,tableId:n,solutionId:s}}),p({loading:h,fetching:O,errorMessage:y,relationships:f})):m&&!v&&(Object(o.U)(l.a,{eventName:i.g.GetRelatedManyToOneRelationshipsForCurrentTable,eventData:{tableId:n,solutionId:s,error:"There was no database in current environment ".concat(null==m?void 0:m.id)}}),p({loading:!1,fetching:!1,errorMessage:t,relationships:f}))},[m,n,h,O,y,f,v,t,s]),b}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/523.4439ff81.chunk.js.map
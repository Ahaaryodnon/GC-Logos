/*! For license information please see 137.8290a659.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[137],{14908:function(e,n,t){"use strict";t.d(n,"a",(function(){return h})),t.d(n,"c",(function(){return O})),t.d(n,"e",(function(){return j})),t.d(n,"b",(function(){return g})),t.d(n,"d",(function(){return P}));var r=t(14132),o=t(11021),i=t(12313),a=t(14766),l=t(13556),c=t(14909),u=t(13769),s=t(10926),d=t(14915);function p(e,n,t,r,o,i,a){try{var l=e[i](a),c=l.value}catch(u){return void t(u)}l.done?n(c):Promise.resolve(c).then(r,o)}function v(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){p(i,r,o,a,l,"next",e)}function l(e){p(i,r,o,a,l,"throw",e)}a(void 0)}))}}function f(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function m(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?f(Object(t),!0).forEach((function(n){y(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):f(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function y(e,n,t){return(n=function(e){var n=function(e,n){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var b=Object(l.h)(l.d.ConnectionExperience,l.e.DataFetchHooks),h=e=>e===r.c.AAD||e===r.c.WindowsAuth,O=e=>{var n,t,r,{connection:s,isV2:d=!1,options:p,telemetryScope:f,needsServerConnectionCheck:y=!0}=e,O=!(y&&h(null==s||null===(n=s.connectionParameter)||void 0===n?void 0:n.name)||!s||void 0!==(null==p?void 0:p.enabled)&&(null==p||!p.enabled)),j=l.g.apiHubDatasetsReactQuery,g=Object(u.a)({eventScope:f,scenarioName:j,eventData:{connection:s,isV2:d},team:o.j.PowerappsPortal,teamPriority:o.f.Medium,enabled:O}),{data:P,error:U,isInitialLoading:N,isError:w,refetch:E}=Object(i.a)(m(m({},p),{},{enabled:O,queryKey:["connection-datasets",s],queryFn:(t=v((function*(){return Object(c.a)(null==s?void 0:s.name,d,null==s?void 0:s.primaryRuntimeUrl)})),function(){return t.apply(this,arguments)}),onSuccess(e){var n;null==g||g.complete(m({connectionName:null==s?void 0:s.name,primaryRuntimeUrl:null==s?void 0:s.primaryRuntimeUrl,datasetsLength:e.length},b)),null==p||null===(n=p.onSuccess)||void 0===n||n.call(p,e)},onError:e=>{var n,t=Object(a.b)(e);null==g||g.failure(m(m({},t),b)),null==p||null===(n=p.onError)||void 0===n||n.call(p,t)}}));return{data:P,error:U,isInitialLoading:N,isError:w,refetch:(r=v((function*(){yield E()})),function(){return r.apply(this,arguments)})}},j=e=>{var n,t,{datasetUrl:r,connection:d,isV2:p=!1,fetchAllTables:f=!1,options:y,telemetryScope:h}=e,O=!(!r||!d||void 0!==(null==y?void 0:y.enabled)&&(null==y||!y.enabled)),j=l.g.apiHubTablesReactQuery,g=Object(u.a)({eventScope:h,scenarioName:j,eventData:{datasetUrl:r,connection:d,isV2:p,fetchAllTables:f},team:o.j.PowerappsPortal,teamPriority:o.f.Medium,enabled:O}),[P,U]=Object(s.useState)(!1),{data:N,error:w,isInitialLoading:E,isError:S,refetch:R}=Object(i.a)(m(m({},y),{},{enabled:O,queryKey:["connection-dataset-tables",d,r,f],queryFn:(n=v((function*(){return Object(c.c)(null==d?void 0:d.name,p,null==d?void 0:d.primaryRuntimeUrl,r,f)})),function(){return n.apply(this,arguments)}),onSuccess(e){var n;null==g||g.complete(m({connectionName:null==d?void 0:d.name,primaryRuntimeUrl:null==d?void 0:d.primaryRuntimeUrl,datasetUrl:r,fetchAllTables:f,tablesLength:null==e?void 0:e.length},b)),null==y||null===(n=y.onSuccess)||void 0===n||n.call(y,e)},onError:e=>{var n,t,r=Object(a.b)(e);401===(null==r||null===(n=r.response)||void 0===n?void 0:n.status)&&U(!0),null==g||g.failure(m(m({},r),b)),null==y||null===(t=y.onError)||void 0===t||t.call(y,r)}}));return{data:N,error:w,isInitialLoading:E,isError:S,refetch:(t=v((function*(){yield R()})),function(){return t.apply(this,arguments)}),hasConnectionMismatch:P}},g=e=>{var n,t,r,{isV2:o,connection:i,serverName:a,databaseName:l,telemetryScope:c}=e,u=O({connection:i,isV2:o,telemetryScope:c}),s=h(null==i||null===(n=i.connectionParameter)||void 0===n?void 0:n.name)?(e=>{var{serverName:n,databaseName:t}=e;return n&&t?"".concat(encodeURIComponent(n),",").concat(encodeURIComponent(t)):void 0})({connection:i,databaseName:l,serverName:a}):null===(t=u.data)||void 0===t||null===(r=t[0])||void 0===r?void 0:r.id,p=j({datasetUrl:s,connection:i,isV2:o,telemetryScope:c}),f=function(){var e=v((function*(){yield u.refetch(),yield p.refetch()}));return function(){return e.apply(this,arguments)}}(),m=u.error||p.error,y=Object(d.a)(m);return{refetch:f,datasetUrl:s,tables:p.data,isError:u.isError||p.isError,isInitialLoading:u.isInitialLoading||p.isInitialLoading,errorMessage:y}},P=e=>{var n,{connection:t,datasetUrl:r,tableName:s,options:d,telemetryScope:p}=e,{name:f,primaryRuntimeUrl:y}=t,h=!!(f&&y&&r&&s&&(void 0===(null==d?void 0:d.enabled)||null!=d&&d.enabled)),O=l.g.apiHubTableDetailsReactQuery,j=Object(u.a)({eventScope:p,scenarioName:O,eventData:{connection:t,datasetUrl:r,tableName:s},team:o.j.PowerappsPortal,teamPriority:o.f.Medium,enabled:h}),{data:g}=Object(i.a)(m(m({},d),{},{enabled:h,queryKey:[y,f,r,s,"connection-tableDetails"],queryFn:(n=v((function*(){return Object(c.b)(f,y,r,s)})),function(){return n.apply(this,arguments)}),onSuccess(e){var n;null==j||j.complete(m({connection:t,datasetUrl:r,tableName:s,tableDisplayName:e.displayName},b)),null==d||null===(n=d.onSuccess)||void 0===n||n.call(d,e)},onError:e=>{var n,t=Object(a.b)(e);null==j||j.failure(m(m({},t),b)),null==d||null===(n=d.onError)||void 0===n||n.call(d,t)}}));return{data:g}}},14909:function(e,n,t){"use strict";t.d(n,"a",(function(){return v})),t.d(n,"c",(function(){return m})),t.d(n,"b",(function(){return b}));var r=t(11868),o=t(14910),i=t(14911),a=t(14912),l=t(14913);function c(e,n,t,r,o,i,a){try{var l=e[i](a),c=l.value}catch(u){return void t(u)}l.done?n(c):Promise.resolve(c).then(r,o)}function u(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){c(i,r,o,a,l,"next",e)}function l(e){c(i,r,o,a,l,"throw",e)}a(void 0)}))}}var s=(e,n,t,r)=>"".concat(d(e,t),"/").concat(encodeURIComponent(n),"/").concat(r?"alltables":"tables"),d=(e,n)=>"https://".concat(o.a.connectors,"/").concat(e).concat(n?"/v2/":"/","datasets"),p=(e,n,t)=>"https://".concat(o.a.connectors,"/").concat(e,"/$metadata.json/datasets/").concat(encodeURIComponent(encodeURIComponent(n)),"/tables/").concat(encodeURIComponent(t));function v(e,n,t){return f.apply(this,arguments)}function f(){return(f=u((function*(e,n,t){var o,a,l=d(e,n),c=yield r.f.get(l,{headers:{primaryRuntimeUrl:t}});return null==c||null===(o=c.data)||void 0===o||null===(a=o.value)||void 0===a?void 0:a.map(i.a)}))).apply(this,arguments)}function m(e,n,t,r,o){return y.apply(this,arguments)}function y(){return(y=u((function*(e,n,t,o,i){var l,c,u=s(e,o,n,i),d=yield r.f.get(u,{headers:{primaryRuntimeUrl:t}});return null==d||null===(l=d.data)||void 0===l||null===(c=l.value)||void 0===c?void 0:c.map(a.a)}))).apply(this,arguments)}function b(e,n,t,r){return h.apply(this,arguments)}function h(){return(h=u((function*(e,n,t,o){var i,a=p(e,t,o),c=yield r.f.get(a,{headers:{primaryRuntimeUrl:n}});return null==c||null===(i=c.data)||void 0===i?void 0:i.map(l.a)}))).apply(this,arguments)}},14911:function(e,n,t){"use strict";function r(e){return{id:e?e.Name:"",displayName:e?e.DisplayName:""}}t.d(n,"a",(function(){return r}))},14912:function(e,n,t){"use strict";function r(e){return{id:e?e.Name:"",displayName:e?e.DisplayName:"",type:e?e.Type:""}}t.d(n,"a",(function(){return r}))},14913:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(14914);function o(e){var n,t,o,i,a,l=(null==e||null===(n=e.schema)||void 0===n||null===(t=n.items)||void 0===t?void 0:t.properties)||{},c=Object.keys(l).map(e=>({id:e,dataType:l[e].type,visibility:l[e]["x-ms-visibility"]||""})),u=(null==e||null===(o=e.schema)||void 0===o||null===(i=o.items)||void 0===i||null===(a=i["x-ms-displayFormat"])||void 0===a?void 0:a.propertiesDisplayOrder)||[];return{displayName:e?e.name:"",authorLookupEndpointUri:Object(r.a)(e)||"",editorLookupEndpointUri:Object(r.b)(e)||"",schema:{items:c},propertiesDisplayOrder:u}}},14914:function(e,n,t){"use strict";function r(e){var n=function(e){var n=function(e){var n=i(e);return n&&n.Author}(e);return n&&n.lookupEndpoint}(e);return n&&n.path}function o(e){var n=function(e){var n=function(e){var n=i(e);return n&&n.Editor}(e);return n&&n.lookupEndpoint}(e);return n&&n.path}function i(e){return e&&e.referencedEntities}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return o}))},14915:function(e,n,t){"use strict";var r=t(14441);t.d(n,"a",(function(){return r.f}))}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/137.8290a659.chunk.js.map
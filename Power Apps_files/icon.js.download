/*! For license information please see Icon.js.LICENSE.txt */
(function(){return this?this:window}())["@pa-client/icon"]=function(e){var t={};function i(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1)}([function(e,t,i){"use strict";i.r(t),i.d(t,"Icon",(function(){return o}));var o=function(){function e(){}return e.getSvgSpriteUrl=function(){var t=e._svgSpriteRelativePath,i=AppMagic.Runtime.App.PublishedAppLoader.tryGetInstance();return i?i.resolveAppAssetPath(t):Core.Utility.getAbsoluteUri(t)},e._insertSvgSpriteIfNotPresent=function(){if(!e._svgSpriteElement&&!Core.Environment.isAuthoringTool()){var t=e._svgSpriteHtmlId;if(e._svgSpriteElement=document.getElementById(t),!e._svgSpriteElement){var i=e.getSvgSpriteUrl(),o=document.createElement("div");o.id=t,o.setAttribute("data-bind","InlineSVG: spriteUri"),o.style.display="none",document.body.appendChild(o),ko.applyBindings({spriteUri:i},o),e._svgSpriteElement=o}}},e._isSvgSpriteLoaded=function(){if(e._svgSpriteLoaded||Core.Environment.isAuthoringTool())e._svgSpriteLoaded=!0;else{var t=e._svgSpriteElement;e._svgSpriteLoaded=!(!t||!t.querySelector("svg"))}return e._svgSpriteLoaded},e.prototype.onLoad=function(){e._insertSvgSpriteIfNotPresent()},e.prototype.initControlContext=function(e){var t=this;e.svgContainerDiv=null,e._accessibilityItem=null,e._isLoaded=!0,e._highContrastModeListener=function(){return t._updateSvgFill(e)}},e.prototype.initView=function(t,i){var o=this;if(Contracts.checkValue(t),i._scheduledUpdate=null,i.svgElement=null,i.handleClick=this.handleClick.bind(this,i),i.shortcutProvider=new AppMagic.Controls.ControlShortcutProvider(i.handleClick),!e._isSvgSpriteLoaded()){var n=e._svgSpriteElement;i._compositeSvgLoadedFn=function(){o._changeIcon(i,i.properties.Icon()),n.removeEventListener("iconControlLoaded",i._compositeSvgLoadedFn),i._compositeSvgLoadedFn=null},n.addEventListener("iconControlLoaded",i._compositeSvgLoadedFn)}i.iconRotationComputed=ko.computed((function(){var e=i.properties.Rotation()||0;return"rotate(".concat(e,"deg)")})),ko.applyBindings(i,t),i.svgContainerDiv=t.getElementsByClassName("icon-svg-container")[0],i.svgContainerDiv.style.pointerEvents="none",i.svgElement=t.getElementsByTagName("svg")[0],i.svgElement&&this._applyAllProperties(i),i._highContrastMediaQueryList=window.matchMedia("(-ms-high-contrast: active)"),i._highContrastMediaQueryList.addListener(i._highContrastModeListener),this._setTabbability(i,i.viewState.displayMode()===AppMagic.Constants.DisplayMode.Edit),i._viewStateDisplayModeSubscription=i.viewState.displayMode.subscribe((function(e){o._setTabbability(i,e===AppMagic.Constants.DisplayMode.Edit)})),i.viewState.isAutoDisabled(!1),this._changeIcon(i,i.properties.Icon())},e.prototype.disposeView=function(t,i){i._highContrastMediaQueryList&&(i._highContrastMediaQueryList.removeListener(i._highContrastModeListener),i._highContrastMediaQueryList=null),i.handleClick&&(i.handleClick=null),i.shortcutProvider&&(i.shortcutProvider.dispose(),i.shortcutProvider=null),this._disposeAccessibilityItem(i),i.autoColorSubscription&&(i.autoColorSubscription.dispose(),i.autoColorSubscription=null),i.iconRotationComputed&&(i.iconRotationComputed.dispose(),i.iconRotationComputed=null),i._viewStateDisplayModeSubscription&&(i._viewStateDisplayModeSubscription.dispose(),i._viewStateDisplayModeSubscription=null),i._compositeSvgLoadedFn&&e._svgSpriteElement&&e._svgSpriteElement.removeEventListener("iconControlLoaded",i._compositeSvgLoadedFn),i._scheduledUpdate&&(Core.Tasks.cancel(i._scheduledUpdate),i._scheduledUpdate=null),i._loadCustomIconPromise&&(Core.PromiseUtils.abortPromise(i._loadCustomIconPromise,i._loadCustomIconPromiseAbortController),i._loadCustomIconPromise=null,i._loadCustomIconPromiseAbortController=null),i._compositeSvgLoadedFn=null,i.svgContainerDiv=null,i.svgElement=null},e.prototype.disposeControlContext=function(e){e._isLoaded=!1,e._highContrastModeListener=null},e.prototype.onChangeTooltip=function(e,t){t.realized&&this._updateSvgTitle(t)},e.prototype.onChangeTabIndex=function(e,t){t.realized&&t._accessibilityItem&&AppMagic.Controls.AccessibilityHelper.updateTabIndex(t._accessibilityItem,t)},e.prototype.onChangeZIndex=function(e,t){t.realized&&t._accessibilityItem&&AppMagic.Controls.AccessibilityHelper.updateZIndex(t._accessibilityItem,t)},e.prototype.onChangeX=function(e,t){t.realized&&this._onChangeLocation(t)},e.prototype.onChangeY=function(e,t){t.realized&&this._onChangeLocation(t)},e.prototype._onChangeLocation=function(e){!e.realized&&e._accessibilityItem&&AppMagic.Controls.AccessibilityHelper.updateLocation(e._accessibilityItem,e)},e.prototype.onChangeWidth=function(e,t){t.realized&&this._updateWidth(t)},e.prototype.onChangeLayoutWidth=function(e,t){t.realized&&this._updateWidth(t)},e.prototype.onChangePaddingLeft=function(e,t){t.realized&&this._updateWidth(t)},e.prototype.onChangePaddingRight=function(e,t){t.realized&&this._updateWidth(t)},e.prototype.onChangeHeight=function(e,t){t.realized&&this._updateHeight(t)},e.prototype.onChangeLayoutHeight=function(e,t){t.realized&&this._updateHeight(t)},e.prototype.onChangePaddingTop=function(e,t){t.realized&&this._updateHeight(t)},e.prototype.onChangePaddingBottom=function(e,t){t.realized&&this._updateHeight(t)},e.prototype.onChangeIcon=function(e,t){t.realized&&this._changeIcon(t,e.newValue)},e.prototype.onBeforeOnSelect=function(e){e.initialized&&e.realized&&e.viewState.isAutoDisabled(e.properties.AutoDisableOnSelect())},e.prototype.onAfterOnSelect=function(e){e.initialized&&e.realized&&e.viewState.isAutoDisabled(!1)},e.prototype.handleClick=function(e){return!(!e.initialized||!e.realized)&&(Core.Utility.isFunction(e.viewState.displayMode)&&e.viewState.displayMode()===AppMagic.Constants.DisplayMode.Edit&&e.behaviors.OnSelect(),!1)},e.prototype._changeIcon=function(e,t){var i=this;null!==e._scheduledUpdate&&(Core.Tasks.cancel(e._scheduledUpdate),e._scheduledUpdate=null),e._loadCustomIconPromise&&(Core.PromiseUtils.abortPromise(e._loadCustomIconPromise,e._loadCustomIconPromiseAbortController),e._loadCustomIconPromise=void 0,e._loadCustomIconPromiseAbortController=void 0),e._scheduledUpdate=Core.Tasks.schedule((function(){var o=null;if(t&&0===t.indexOf(AppMagic.Constants.IconControlBuiltInValuePrefix)){var n=t.replace(AppMagic.Constants.IconControlBuiltInValuePrefix,"");o="Basel_".concat(n)}else if(Core.FeatureGates.authoring.enableCustomIcons){var r="".concat(AppMagic.AppResourceUri.Scheme,"://").concat(AppMagic.AppResourceUri.Hosts.Resources,"/");if(0===(null==t?void 0:t.indexOf(r))){n=t.replace(r,"");var a="Custom_".concat(n,".svg"),s=new AbortController;return e._loadCustomIconPromiseAbortController=s,e._loadCustomIconPromise=AppMagic.Utility.loadSvgMediaAsIconAsync(t,a,s),void e._loadCustomIconPromise.then((function(){var t;(null===(t=null==s?void 0:s.signal)||void 0===t?void 0:t.aborted)||(i._updateChildrenWithXlinkHref(e,a),e._scheduledUpdate=null)}))}}i._updateChildrenWithXlinkHref(e,o),e._scheduledUpdate=null}),"Icon._changeIcon")},e.prototype._updateChildrenWithXlinkHref=function(e,t){if(e.realized&&e.svgContainerDiv){var i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");var o=document.getElementById(t);o&&o instanceof SVGSymbolElement&&(i.setAttribute("viewBox",o.getAttribute("viewBox")),i.setAttribute("data-appmagic-icon-name",t),Array.prototype.forEach.call(o.childNodes,(function(e){i.appendChild(e.cloneNode(!0))}))),this._replaceChild(e.svgContainerDiv,i),this._svgIsLoaded(e)}},e.prototype._replaceChild=function(e,t){WinJS.Utilities.setInnerHTMLUnsafe(e,""),e.appendChild(t)},e.prototype._svgIsLoaded=function(e){if(e.initialized&&e.realized){var t=e.svgContainerDiv.getElementsByTagName("svg");e.svgElement=t[0],this._applyAllProperties(e)}},e.prototype._applyAllProperties=function(e){e.realized&&(this._updateWidth(e),this._updateHeight(e),this._updateSvgFill(e),this._updateSvgTitle(e),this._updateSvgDisplay(e),e.autoColorSubscription&&(e.autoColorSubscription.dispose(),e.autoColorSubscription=null),e.autoColorSubscription=e.autoProperties.Color.subscribe(this._updateSvgFill.bind(this,e)))},e.prototype._updateSvgFill=function(e){var t=this._computeFillColor(e);if(e.svgElement&&e.svgElement.setAttribute("fill",t),e.svgElement&&Core.FeatureGates.authoring.enableOfficeMediaBrowser&&!Core.FallbackSwitch.isActivated("OfficeMediaBrowser.FallbackSwitch")&&Core.FeatureGates.authoring.enableCustomIcons){var i=e.svgElement.querySelectorAll(".MsftOfcThm_Accent4_Fill_v2");Array.prototype.forEach.call(i,(function(e){e.setAttribute("style","fill:".concat(t))}))}},e.prototype._computeFillColor=function(e){var t=e.autoProperties.Color();if(window.matchMedia("(forced-colors: active)").matches){var i=e.viewState.displayMode()===AppMagic.Constants.DisplayMode.Disabled,o=e.properties.TabIndex()>=0&&e.viewState.displayMode()===AppMagic.Constants.DisplayMode.Edit;t=i?"GrayText":o?"ButtonText":"CanvasText"}return t},e.prototype._updateWidth=function(e){var t=e.modelProperties,i=t.Width.getValue()-t.PaddingLeft.getValue()-t.PaddingRight.getValue();i=Math.max(i,0),this._updateAttribute(e,AppMagic.Controls.converters.pxHorizontalConverter.view(i),"width")},e.prototype._updateHeight=function(e){var t=e.modelProperties,i=t.Height.getValue()-t.PaddingTop.getValue()-t.PaddingBottom.getValue();i=Math.max(i,0),this._updateAttribute(e,AppMagic.Controls.converters.pxVerticalConverter.view(i),"height")},e.prototype._updateSvgTitle=function(e){if(e.svgElement){var t=e.svgElement,i=e.modelProperties.Tooltip.getValue(),o=t.getElementsByTagNameNS(AppMagic.Constants.Namespaces.svg,"title")[0];if(o)o.textContent=i;else{var n=document.createElementNS(AppMagic.Constants.Namespaces.svg,"title");n.textContent=i,t.insertBefore(n,t.firstChild)}}},e.prototype._updateSvgDisplay=function(e){e.svgElement.style.display="block"},e.prototype._updateAttribute=function(e,t,i){var o=e.svgElement;o&&o.setAttribute(i,t)},e.prototype._setTabbability=function(e,t){var i=e.container.querySelector(".powerapps-icon");t?e._accessibilityItem||(e._accessibilityItem=AppMagic.Controls.AccessibilityHelper.createAccessibilityItem(e,i),AppMagic.Controls.AccessibilityManager.registerItem(e._accessibilityItem)):(this._disposeAccessibilityItem(e),i.removeAttribute("tabindex"))},e.prototype._disposeAccessibilityItem=function(e){e._accessibilityItem&&(AppMagic.Controls.AccessibilityManager.unregisterItem(e._accessibilityItem),e._accessibilityItem.dispose(),e._accessibilityItem=null)},e._svgSpriteElement=null,e._svgSpriteHtmlId="powerapps-icon-control-sprite",e._svgSpriteLoaded=!1,e._svgSpriteRelativePath="ctrllib/icon/images/ctrllib-symbols.svg",e}()},function(e,t,i){i(3),e.exports=i(2)},function(e,t,i){"use strict";i.r(t);var o=i(0);i.d(t,"IIconControlContext",(function(){return o.IIconControlContext})),i.d(t,"Icon",(function(){return o.Icon}))},function(e,t,i){"use strict";i.r(t);var o=i(0);Core.exportToNamespace(["AppMagic","Controls"],o)}]);
//# sourceMappingURL=D:/a/_work/1/s/obj/Assets/js/Icon/Icon.js.map
/*! For license information please see AppMagic.Runtime.App.js.LICENSE.txt */
(function(){return this?this:window}())["@pa-client/appmagic-runtime-app"]=function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=221)}([function(e,t){!function(){e.exports=function(){return this?this:window}()["@pa-client/core"]}()},function(e,t){!function(){e.exports=function(){return this?this:window}()["@pa-client/core-data"]}()},function(e,t,r){"use strict";r.r(t),r.d(t,"FilterOperator",(function(){return n})),r.d(t,"Filter",(function(){return o}));var n,a=r(9);!function(e){e[e.Equals=0]="Equals",e[e.NotEquals=1]="NotEquals",e[e.GreaterThan=2]="GreaterThan",e[e.GreaterThanOrEqual=3]="GreaterThanOrEqual",e[e.LessThan=4]="LessThan",e[e.LessThanOrEqual=5]="LessThanOrEqual",e[e.Add=6]="Add",e[e.Sub=7]="Sub",e[e.Mul=8]="Mul",e[e.Div=9]="Div",e[e.And=10]="And",e[e.Or=11]="Or",e[e.Not=12]="Not",e[e.None=13]="None"}(n||(n={}));var o=function(e){function t(t,r,n){var o=e.call(this,a.OperandKind.Filter)||this;return o._filterOperator=t,o._firstOperand=r,o._secondOperand=n,o}return __extends(t,e),Object.defineProperty(t.prototype,"operator",{get:function(){return this._filterOperator},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"firstOperand",{get:function(){return this._firstOperand},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"secondOperand",{get:function(){return this._secondOperand},enumerable:!1,configurable:!0}),t}(a.Operand)},function(e,t,r){"use strict";r.r(t),r.d(t,"FunctionKind",(function(){return n})),r.d(t,"FunctionOperand",(function(){return o}));var n,a=r(9);!function(e){e[e.Max=0]="Max",e[e.Min=1]="Min",e[e.Sum=2]="Sum",e[e.Count=3]="Count",e[e.CountDistinct=4]="CountDistinct",e[e.Add=5]="Add",e[e.Sub=6]="Sub",e[e.Concatenate=7]="Concatenate",e[e.ToLower=8]="ToLower",e[e.ToUpper=9]="ToUpper",e[e.Len=10]="Len",e[e.Trim=11]="Trim",e[e.Contains=12]="Contains",e[e.IndexOf=13]="IndexOf",e[e.SubStringOf=14]="SubStringOf",e[e.Year=15]="Year",e[e.Month=16]="Month",e[e.Day=17]="Day",e[e.Hour=18]="Hour",e[e.Minute=19]="Minute",e[e.Second=20]="Second",e[e.Date=21]="Date",e[e.Average=22]="Average",e[e.StartsWith=23]="StartsWith",e[e.EndsWith=24]="EndsWith",e[e.CdsIn=25]="CdsIn",e[e.ContainsValues=26]="ContainsValues"}(n||(n={}));var o=function(e){function t(t,r){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var i=e.call(this,a.OperandKind.Function)||this;return i._checkFunctionArguments(t,n),i._functionKind=t,i._functionArguments=n,i._checkReturnType(t,r),i._returnType=r,i}return __extends(t,e),t.prototype._checkFunctionArguments=function(e,t){switch(e){case n.Count:case n.CountDistinct:case n.Max:case n.Min:case n.Sum:case n.Average:case n.ToLower:case n.ToUpper:case n.Len:case n.Trim:break;case n.Concatenate:case n.Contains:case n.IndexOf:case n.SubStringOf:break;case n.StartsWith:case n.EndsWith:case n.CdsIn:case n.ContainsValues:}},t.prototype._checkReturnType=function(e,t){switch(e){case n.Average:case n.Max:case n.Min:case n.Sum:return;case n.Count:case n.CountDistinct:case n.IndexOf:case n.Len:case n.Year:case n.Month:case n.Day:case n.Hour:case n.Minute:case n.Second:case n.Add:case n.Sub:return;case n.Concatenate:case n.ToLower:case n.ToUpper:case n.Trim:return;case n.Contains:case n.SubStringOf:case n.StartsWith:case n.EndsWith:case n.CdsIn:case n.ContainsValues:case n.Date:default:return}},Object.defineProperty(t.prototype,"functionKind",{get:function(){return this._functionKind},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"functionArguments",{get:function(){return this._functionArguments},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"returnType",{get:function(){return this._returnType},enumerable:!1,configurable:!0}),t}(a.Operand)},function(e,t,r){"use strict";var n,a,o;r.r(t),r.d(t,"DataSourceKind",(function(){return n})),r.d(t,"DataRuntimeEvent",(function(){return a})),r.d(t,"PcfTypes",(function(){return o})),function(e){e[e.Collection=0]="Collection",e[e.StaticDataSource=1]="StaticDataSource",e[e.DynamicDataSource=2]="DynamicDataSource",e[e.ConnectedDataSource=3]="ConnectedDataSource",e[e.CdsNativeDataSource=4]="CdsNativeDataSource",e[e.WebResource=5]="WebResource"}(n||(n={})),function(e){e.resetRuntimeError="resetRuntimeerror",e.setRuntimeError="setRuntimeError"}(a||(a={})),function(e){e.TwoOptions="TwoOptions",e.OptionSet="OptionSet",e.MultiSelectOptionSet="multiselectpicklist",e.Decimal="Decimal",e.Currency="Currency",e.DateAndTimeDateOnly="DateAndTime.DateOnly",e.DateAndTime="DateAndTime.DateAndTime",e.SingleLineUrl="SingleLine.URL",e.SingleLineText="SingleLine.Text",e.Image="image",e.File="file",e.LookupSimple="Lookup.Simple",e.Object="Object"}(o||(o={}))},function(e,t,r){"use strict";r.r(t),r.d(t,"EventTracker",(function(){return o})),r.d(t,"arrayBulkRemove",(function(){return i})),r.d(t,"createMediaReferenceAsync",(function(){return c})),r.d(t,"getMediaAsBinaryAsync",(function(){return u})),r.d(t,"getMediaAsArrayBufferWithContentTypeAsync",(function(){return l})),r.d(t,"getMediaAsBase64WithContentTypeAsync",(function(){return d})),r.d(t,"getMediaAsBlobAsync",(function(){return p})),r.d(t,"getBinaryAsBlobAsync",(function(){return f})),r.d(t,"formatUrlStringForCss",(function(){return y})),r.d(t,"resolveWebViewControlPath",(function(){return g})),r.d(t,"getManagedBinaryMediaUrlsInData",(function(){return v})),r.d(t,"isManagedMediaUrl",(function(){return b})),r.d(t,"getMediaUrlsInData",(function(){return _})),r.d(t,"isSessionStorageUrl",(function(){return C})),r.d(t,"getSessionStorageMediaUrlsInData",(function(){return A})),r.d(t,"getMediaInDataForExportAsync",(function(){return S})),r.d(t,"getAppPreviewFlag",(function(){return D})),r.d(t,"addRefBlobs",(function(){return O})),r.d(t,"releaseBlobs",(function(){return T})),r.d(t,"cloneAndFlattenOpenAjax",(function(){return w})),r.d(t,"hasOpenAjax",(function(){return M})),r.d(t,"loadSvgMediaAsIconAsync",(function(){return P})),r.d(t,"localFileCache",(function(){return x})),r.d(t,"blobManager",(function(){return j}));var n=r(1),a=r(82),o=Core.EventTracker;function i(e,t){if(0!==t.length)if(t.length!==e.length){for(var r=0,n=0,a=t[n],o=0,i=e.length;o<i;++o)o===a?a=++n===t.length?-1:t[n]:(o!==r&&(e[r]=e[o]),++r);r!==e.length&&(e.length=r)}else e.length=0}function s(e){var t=AppMagic.Runtime.App.PublishedAppLoader.tryGetInstance();return e&&t&&(e=t.resolveAppAssetPath(e)),e}function c(e,t){var r;return(null===(r=null==t?void 0:t.signal)||void 0===r?void 0:r.aborted)?Promise.reject(Core.PromiseUtils.createCanceledError()):(e=s(e),Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.CurrentAppInstanceFunctionSingletonKey)().mediaRuntime.createMediaReferenceAsync(e,t))}function u(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){switch(r.label){case 0:return t||(t=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.CurrentAppInstanceFunctionSingletonKey)().mediaRuntime),[4,t.getMediaAsBinaryAsync(e)];case 1:return[2,r.sent()]}}))}))}function l(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,a;return __generator(this,(function(o){switch(o.label){case 0:return[4,u(e,t)];case 1:return(n=o.sent())?(r||(r=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.AppPABinaryResolverSingletonKey)),[4,r.getAsArrayBufferAsync(n)]):[2,null];case 2:return a=o.sent(),[2,{contentType:n.contentType,arrayBuffer:a}]}}))}))}function d(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,a;return __generator(this,(function(o){switch(o.label){case 0:return[4,u(e,t)];case 1:return(n=o.sent())?(r||(r=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.AppPABinaryResolverSingletonKey)),[4,r.getAsBase64StringAsync(n)]):[2,null];case 2:return a=o.sent(),[2,{contentType:n.contentType,base64:a}]}}))}))}function p(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n;return __generator(this,(function(a){switch(a.label){case 0:return[4,u(e,t)];case 1:return(n=a.sent())?[4,f(n,r)]:[2,null];case 2:return[2,a.sent()]}}))}))}function f(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){switch(r.label){case 0:return t||(t=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.AppPABinaryResolverSingletonKey)),[4,t.getAsBlobAsync(e)];case 1:return[2,r.sent()]}}))}))}function y(e){return'url("'+(e||"")+'")'}function g(e){return 0===window.location.href.toLowerCase().indexOf("ms-appx")?"ms-appx-web://"+window.location.hostname+window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/"))+"/"+e:e=s(e)}function h(e,t){var r=HashTableUtility.create(),a=function(e){if(e&&!AppMagic.Utility.isOpenAjaxControl(e)&&!Object(n.isBlankOrErrorValue)(e))if("string"==typeof e)t(e)&&(r[e]=null);else if(Object(n.AppMagicDataDataValue_isDataTable)(e))for(var o=0,i=e.length;o<i;o++)a(e[o]);else if(Object(n.AppMagicDataDataValue_isDataRecord)(e)){var s=Object.keys(e);for(o=0,i=s.length;o<i;o++)a(e[s[o]])}};return a(e),Object.keys(r)}function m(e){return a.BlobManager.isBlobManagerItemUri(e)}function v(e){return h(e,m)}function b(e){if(e&&"string"==typeof e){var t=Core.Url.tryParse(e);if(t&&t.scheme.toLowerCase()===n.Scheme)switch(t.getSegment(n.SegmentIndexes.ConnectedDataSourceResourceType)){case n.ConnectedDataSourceResourceType.Attachment:case n.ConnectedDataSourceResourceType.FileOrImageUrl:case n.ConnectedDataSourceResourceType.InlineBlob:case n.ConnectedDataSourceResourceType.ReferencedBlob:return!0}return m(e)}return!1}function _(e){return h(e,b)}function C(e){return!(!e||"string"!=typeof e||!e.startsWith("/SessionStorage/"))}function A(e){return h(e,C)}function S(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,a,o,i=this;return __generator(this,(function(s){switch(s.label){case 0:return n=v(e),a=HashTableUtility.create(),o=n.map((function(e){return __awaiter(i,void 0,void 0,(function(){var n,o;return __generator(this,(function(i){switch(i.label){case 0:n=null,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,l(e,t,r)];case 2:return(o=i.sent())&&(n={contentType:o.contentType,arrayBuffer:o.arrayBuffer}),[3,4];case 3:return i.sent(),[3,4];case 4:return a[e]=n,[2]}}))}))})),[4,Core.PromiseUtils.join(o)];case 1:return s.sent(),[2,a]}}))}))}function D(e){return Core.Utility.isDefined(AppMagic.Initialization)&&Core.Utility.isDefined(AppMagic.Initialization.appPreviewFlags)&&e in AppMagic.Initialization.appPreviewFlags&&!0===AppMagic.Initialization.appPreviewFlags[e.toLowerCase()]}function O(e){var t=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.IBlobManagerSingletonKey),r=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.CurrentAppInstanceFunctionSingletonKey)();if(r){var n=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.ILocalFileCacheSingletonKey);E(e,t,r.mediaRuntime,n)}else E(e,t)}function E(e,t,r,n){var a,o,i;if("string"==typeof e){if(!t.addRef(e)&&r&&n&&n.count){var s=r.tryNormalizeMediaUri(e);if(s){var c=n.tryGetEntry(s.toString());c&&t.addRef(c)}}}else if(e instanceof Array)for(a=0,o=e.length;a<o;a++)E(e[a],t,r,n);else if(null!==e&&"object"==typeof e&&!AppMagic.Utility.isOpenAjaxControl(e))for(a=0,o=(i=Object.keys(e)).length;a<o;a++)E(e[i[a]],t,r,n)}function T(e){var t=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.IBlobManagerSingletonKey),r=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.CurrentAppInstanceFunctionSingletonKey)();if(r){var n=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.ILocalFileCacheSingletonKey);R(e,t,r.mediaRuntime,n)}else R(e,t)}function R(e,t,r,n){var a,o,i;if("string"==typeof e){if(!t.release(e)&&r&&n&&n.count){var s=r.tryNormalizeMediaUri(e);s&&n.removeUrlEntry(s.toString())}}else if(e instanceof Array)for(a=0,o=e.length;a<o;a++)R(e[a],t,r,n);else if(null!==e&&"object"==typeof e&&!AppMagic.Utility.isOpenAjaxControl(e))for(a=0,o=(i=Object.keys(e)).length;a<o;a++)R(e[i[a]],t,r,n)}function w(e){var t=Object(n.clone)(e,!0,!0);return function e(t){if(null===t)return;if(t instanceof Array)for(var r=0;r<t.length;r++)e(t[r]);else if("object"==typeof t){var n=Object.keys(t);for(r=0;r<n.length;r++){var a=n[r];AppMagic.Utility.isOpenAjaxControl(t[a])?t[a]=F(t[a]):("object"==typeof t[a]||t[a]instanceof Array)&&e(t[a])}}}(t),t}function M(e){if(null===e)return!1;if(e instanceof Array)for(var t=0;t<e.length;t++)return M(e[t]);else if("object"==typeof e){var r=Object.keys(e);for(t=0;t<r.length;t++){var n=r[t];if(AppMagic.Utility.isOpenAjaxControl(e[n]))return!0;if("object"==typeof e[n]||e[n]instanceof Array)return M(e[n])}}return!1}function P(e,t,r){var n;return __awaiter(this,void 0,Promise,(function(){var a,o,i;return __generator(this,(function(s){switch(s.label){case 0:return(null===(n=null==r?void 0:r.signal)||void 0===n?void 0:n.aborted)?[2,Promise.reject(Core.PromiseUtils.createCanceledError())]:(a=Core.PromiseUtils.createCompletablePromise(),Core.FeatureGates.authoring.enableCustomIcons?document.getElementById(t)?(a.complete(),[2,a.promise]):[4,p(e)]:(a.complete(),[2,a.promise]));case 1:return o=s.sent(),(i=new FileReader).onload=function(e){var r,n,o;try{var i=e.target.result.toString(),s=null===(r=(new DOMParser).parseFromString(i,"text/xml").getElementsByTagName("svg"))||void 0===r?void 0:r[0];if(s){var c=document.createElementNS("http://www.w3.org/2000/svg","symbol");Array.prototype.forEach.call(s.childNodes,(function(e){c.appendChild(e.cloneNode(!0))})),c.setAttribute("viewBox",s.getAttribute("viewBox")),c.setAttribute("id",t),null===(o=null===(n=document.getElementsByTagName("ctrllib-image-symbols"))||void 0===n?void 0:n[0].firstChild)||void 0===o||o.appendChild(c)}else Core.Telemetry.Log.trackActivityEvent("loadSvgMediaAsIconAsync",{message:"Icon symbol element is not found, unable to load",iconName:t})}catch(e){Core.Telemetry.Log.trackErrorEvent("loadSvgMediaAsIconAsync",{message:"Unable to load icon symbol",iconName:t,error:e})}a.complete()},i.onerror=function(){return a.error("Error reading SVG file")},i.readAsText(o),[2,a.promise]}}))}))}function F(e){var t=e.OpenAjax.getControlPropertyValues();return AppMagic.Data.DataFlow.mergeExpando(t)}var N=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.ILocalFileCacheSingletonKey),I=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.IBlobManagerSingletonKey),x=N,j=I},function(e,t,r){"use strict";r.r(t),r.d(t,"FunctionKind",(function(){return n})),r.d(t,"getSortQueryOptions",(function(){return A})),r.d(t,"appendQueryOptionsAsync",(function(){return S})),r.d(t,"appendQueryOptions",(function(){return D})),r.d(t,"mergeQueryOptions",(function(){return O})),r.d(t,"mergeQueryOptionsAsync",(function(){return E})),r.d(t,"getFilterQueryOptions",(function(){return T})),r.d(t,"getFilterQueryOptionsAsync",(function(){return R})),r.d(t,"addSelectQueryOptions",(function(){return w})),r.d(t,"getTopQueryOptions",(function(){return M})),r.d(t,"mergeExpandArrays",(function(){return P})),r.d(t,"createPropertyOperand",(function(){return F})),r.d(t,"createValueOperand",(function(){return N})),r.d(t,"createValueOperandAsync",(function(){return I})),r.d(t,"formatTableValueOperand",(function(){return x})),r.d(t,"formatTableValueOperandAsync",(function(){return j})),r.d(t,"getPolyValue",(function(){return L})),r.d(t,"getRecordValue",(function(){return U})),r.d(t,"createIsBlankFilterOperand",(function(){return k})),r.d(t,"createNullOperand",(function(){return V})),r.d(t,"createNoneFilterOperand",(function(){return B})),r.d(t,"createBooleanFilterOperand",(function(){return Q})),r.d(t,"createBooleanFilterOperandAsync",(function(){return K})),r.d(t,"createBinaryBooleanFilterOperand",(function(){return G})),r.d(t,"createAggregateFunctionOperand",(function(){return H})),r.d(t,"createCountFunctionOperand",(function(){return z})),r.d(t,"createFilterOperand",(function(){return W})),r.d(t,"createFilterOperandAsync",(function(){return Z})),r.d(t,"createTextMatchOperand",(function(){return Y})),r.d(t,"createTextMatchOperandAsync",(function(){return ee})),r.d(t,"createFunctionOperand",(function(){return te})),r.d(t,"createFunctionOperandAsync",(function(){return re})),r.d(t,"createSearchFunctionOperand",(function(){return ne})),r.d(t,"createSearchFunctionOperandAsync",(function(){return ae})),r.d(t,"appendExpandToParent",(function(){return oe})),r.d(t,"addExpandAndSelectOption",(function(){return ie})),r.d(t,"expandQueryOptions",(function(){return se})),r.d(t,"createNavigationPropertyQueryOptions",(function(){return ue})),r.d(t,"getEntityItemIdFromThisItem",(function(){return le})),r.d(t,"createSearchQueryOptions",(function(){return de})),r.d(t,"createSearchOperand",(function(){return pe})),r.d(t,"createSearchOperandAsync",(function(){return fe})),r.d(t,"queryTableAsync",(function(){return ye})),r.d(t,"getNavigatedQueriedTableAsync",(function(){return ge})),r.d(t,"queryScalarAsync",(function(){return he})),r.d(t,"getScalarQueryOptions",(function(){return me}));var n,a=r(0),o=r(1),i=r(95),s=r(11),c=r(44),u=r(85),l=r(25),d=r(2),p=r(3),f=r(9),y=r(31),g=r(22),h=r(67),m=r(28),v=r(76),b=r(36),_=AppMagic.Schema,C=AppMagic.ConnectionHub;function A(e){var t=new g.TableQueryOptions;return t.sorts=[],Object.keys(e).forEach((function(r){var n=r,a=e[r],o=!0;"string"==typeof a&&"descending"===a.toLocaleLowerCase()&&(o=!1),t.sorts.push(new h.Sort(new y.PropertyOperand(n),o))})),t}function S(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n;return __generator(this,(function(a){switch(a.label){case 0:return[4,e];case 1:return r=a.sent(),[4,t];case 2:return n=a.sent(),[2,D(r,n)]}}))}))}function D(e,t){return e?O(e.queryOptions,t):null}function O(e,t){if(!e)return t;if(!t)return e;var r=function(e){var t=new g.TableQueryOptions;return t.filter=e.filter,e.sorts&&(t.sorts=e.sorts.slice()),e.func&&(t.func=e.func),e.selects&&(t.selects=e.selects.slice()),e.expands&&(t.expands=e.expands.slice()),e.top&&(t.top=e.top),t}(e);return function(e,t){t.sorts&&(e.sorts||(e.sorts=[]),t.sorts.forEach((function(t){e.sorts.push(t)})))}(r,t),function(e,t){if(e.filter&&t.filter){var r=new d.Filter(d.FilterOperator.And,t.filter,e.filter);e.filter=r}else t.filter&&(e.filter=t.filter)}(r,t),function(e,t){t.func&&(e.func=t.func)}(r,t),function(e,t){if(!t.selects)return e;e.selects||(e.selects=[]);t.selects.forEach((function(t){e.selects.indexOf(t)<0&&e.selects.push(t)}))}(r,t),function(e,t){if(!t.expands)return e;e.expands=P(t.expands,e.expands)}(r,t),function(e,t){Object(a.isNumber)(t.top)&&(e.top=t.top)}(r,t),r}function E(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n;return __generator(this,(function(a){switch(a.label){case 0:return r=void 0,n=void 0,e?[4,e]:[3,2];case 1:r=a.sent(),a.label=2;case 2:return t?[4,t]:[3,4];case 3:n=a.sent(),a.label=4;case 4:return[2,O(r,n)]}}))}))}function T(e){var t=new g.TableQueryOptions;return t.filter=e,t}function R(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,e];case 1:return[2,T(t.sent())]}}))}))}function w(e,t){return t&&null!=t?(e.selects||(e.selects=[]),t.forEach((function(t){e.selects.indexOf(t)<0&&e.selects.push(t)})),e):e}function M(e){var t=new g.TableQueryOptions;return t.top=e,t}function P(e,t){if(!e)return t;if(!t)return e;var r=[];return e.forEach((function(e){var n=t.filter((function(t){return t.propertyName===e.propertyName}));0!==n.length?r.push(function(e,t){var r=new l.Expand(e.propertyName);return function(e,t){if(!e)return t;if(!t)return e;var r=e.slice();return t.forEach((function(e){r.indexOf(e)<0&&r.push(e)})),r}(e.selects,t.selects).forEach((function(e){return r.selects.push(e)})),P(e.expands,t.expands).forEach((function(e){return r.expands.push(e)})),r}(e,n[0])):r.push(e)})),t.forEach((function(t){0!==e.filter((function(e){return e.propertyName===t.propertyName})).length||r.push(t)})),r}function F(e){return new y.PropertyOperand(e)}function N(e,t){return null===e?V():("!"===t.charAt(0)?(e=U(e),t="s"):"P"===t?(e=L(e),t="s"):"*"===t.charAt(0)&&(t="*"),new m.ValueOperand(e,t))}function I(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){switch(r.label){case 0:return null===e?[2,V()]:[4,e];case 1:return[2,N(r.sent(),t)]}}))}))}function x(e,t){var r=[],n=null==e?void 0:e.value;if((null==n?void 0:n.length)>0)for(var a=Object.keys(n[0])[0],o=0;o<n.length;o++){var i=n[o][a];void 0!==i&&r.push(N(i,t))}return r}function j(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){switch(r.label){case 0:return null===e?[2,Promise.resolve([])]:[4,e];case 1:return[2,x(r.sent(),t)]}}))}))}function L(e){return Object(a.Contracts_check)(Object(o.isPolymorphicLookup)(e),"Couldn't get polymorphic value."),Object(o.getPolymorphicValue)(e)}function U(e){return Object(a.Contracts_check)(Object(o.AppMagicDataDataEntityRecord_isDataEntityRecord)(e),"Record needs to be a DataEntityRecord for comparison."),Object(o.getCanonicalId)(e)}function k(e,t){var r=W(d.FilterOperator.Equals,e,V());if(0===t)return r;var n=W(d.FilterOperator.Equals,e,N("","s"));return W(d.FilterOperator.Or,r,n)}function V(){return new m.ValueOperand(null,null)}function B(e){var t=J(e);return new d.Filter(d.FilterOperator.None,t)}function Q(e,t,r){if(e.operandKind!==f.OperandKind.Property)return B(e);var n=q(t,r);return new d.Filter(d.FilterOperator.Equals,e,n)}function K(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n;return __generator(this,(function(a){switch(a.label){case 0:return[4,t];case 1:return n=a.sent(),[2,Q(e,n,r)]}}))}))}function q(e,t){var r=new m.ValueOperand(e,"b"),n=Object(s.getAppDataSource)(t);n instanceof i.CdpDataSource&&(n.connector.connectionApiId===C.Constants.ApiIds.SharepointOnline&&(r=new m.ValueOperand(e?"1":"0","n")));return r}function G(e,t){if(void 0===e.firstOperand||void 0===e.secondOperand)return e;var r=e.firstOperand,n=e.secondOperand;e.firstOperand.operandKind!==f.OperandKind.Property&&(r=e.secondOperand,n=e.firstOperand);var a=$(n);return a.result?(n=q(a.operandValue,t),new d.Filter(e.operator,r,n)):e}function H(e,t,r){return te(e,t,r)}function z(){return te(n.Count,_.TypeNumber,N(!0,"b"))}function J(e){return null===e?V():e}function W(e,t,r){return function(e,t,r){if(!r)return new d.Filter(e,t,r);var n=$(t),a=$(r),o=n.result?n.operandValue:t,i=a.result?a.operandValue:r;if(e===d.FilterOperator.And&&!1===o)return X(t)?t:new d.Filter(d.FilterOperator.None,t);if(e===d.FilterOperator.And&&!1===i)return X(r)?r:new d.Filter(d.FilterOperator.None,r);if(e===d.FilterOperator.And&&!0===o)return X(r)?r:new d.Filter(d.FilterOperator.None,r);if(e===d.FilterOperator.And&&!0===i)return X(t)?t:new d.Filter(d.FilterOperator.None,t);if(e===d.FilterOperator.Or&&!1===o)return X(r)?r:new d.Filter(d.FilterOperator.None,r);if(e===d.FilterOperator.Or&&!1===i)return X(t)?t:new d.Filter(d.FilterOperator.None,t);if(e===d.FilterOperator.Or&&!0===o)return X(t)?t:new d.Filter(d.FilterOperator.None,t);if(e===d.FilterOperator.Or&&!0===i)return X(r)?r:new d.Filter(d.FilterOperator.None,r);return new d.Filter(e,t,r)}(e,J(t),J(r))}function Z(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,a;return __generator(this,(function(o){switch(o.label){case 0:return[4,t];case 1:return n=o.sent(),[4,r];case 2:return a=o.sent(),[2,W(e,n,a)]}}))}))}function X(e){return e instanceof d.Filter&&e.operator===d.FilterOperator.None}function $(e){if(e.operandKind!==f.OperandKind.Value&&e.operandKind!==f.OperandKind.Constant&&e.operandKind!==f.OperandKind.Filter)return{result:!1};var t;if(e.operandKind===f.OperandKind.Value){var r=e;if("b"!==r.dType)return{result:!1};t=r.value}else if(e.operandKind===f.OperandKind.Constant){var n=e;if("b"!==n.type)return{result:!1};t=n.value}else{var a=e;if(a.operator!==d.FilterOperator.None)return{result:!1};var o=$(a.firstOperand);if(!o.result)return{result:!1};t=o.operandValue}return{result:!0===t||!1===t,operandValue:t}}function Y(e){var t=e.functionArguments[1].value;return W(d.FilterOperator.None,null===t||"string"!=typeof t?N(!1,"b"):""===t?N(!0,"b"):e)}function ee(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,e];case 1:return[2,Y(t.sent())]}}))}))}function te(e,t){for(var r=[],a=2;a<arguments.length;a++)r[a-2]=arguments[a];var o,i=[];switch(r.forEach((function(e){var t=J(e);i.push(t)})),e){case n.Year:o=p.FunctionKind.Year;break;case n.Month:o=p.FunctionKind.Month;break;case n.Day:o=p.FunctionKind.Day;break;case n.Hour:o=p.FunctionKind.Hour;break;case n.Minute:o=p.FunctionKind.Minute;break;case n.Second:o=p.FunctionKind.Second;break;case n.ToLower:o=p.FunctionKind.ToLower;break;case n.ToUpper:o=p.FunctionKind.ToUpper;break;case n.Trim:o=p.FunctionKind.Trim;break;case n.Date:o=p.FunctionKind.Date;break;case n.Len:o=p.FunctionKind.Len;break;case n.Add:o=p.FunctionKind.Add;break;case n.Sub:o=p.FunctionKind.Sub;break;case n.Count:o=p.FunctionKind.Count;break;case n.CountDistinct:o=p.FunctionKind.CountDistinct;break;case n.Sum:o=p.FunctionKind.Sum;break;case n.Min:o=p.FunctionKind.Min;break;case n.Max:o=p.FunctionKind.Max;break;case n.Average:o=p.FunctionKind.Average;break;case n.StartsWith:o=p.FunctionKind.StartsWith;break;case n.EndsWith:o=p.FunctionKind.EndsWith;break;default:return null}return new(p.FunctionOperand.bind.apply(p.FunctionOperand,__spreadArray([void 0,o,t],i,!1)))}function re(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return __awaiter(this,void 0,Promise,(function(){var n,a,o,i;return __generator(this,(function(s){switch(s.label){case 0:n=[],a=0,s.label=1;case 1:return a<r.length?(o=n,i=a,[4,r[a]]):[3,4];case 2:o[i]=s.sent(),s.label=3;case 3:return a++,[3,1];case 4:return[2,te.apply(void 0,__spreadArray([e,t],n,!1))]}}))}))}function ne(e,t,r){var a,o=J(t);switch(e){case n.Contains:return new p.FunctionOperand(p.FunctionKind.Contains,_.TypeBoolean,r,o);case n.CdsIn:return new p.FunctionOperand(p.FunctionKind.CdsIn,_.TypeBoolean,r,o);case n.ContainsValues:return new p.FunctionOperand(p.FunctionKind.ContainsValues,_.TypeBoolean,r,o);case n.IndexOf:return a=new p.FunctionOperand(p.FunctionKind.IndexOf,_.TypeNumber,r,o),new d.Filter(d.FilterOperator.GreaterThan,a,new m.ValueOperand(-1,"n"));case n.SubStringOf:return a=new p.FunctionOperand(p.FunctionKind.SubStringOf,_.TypeBoolean,r,o),new d.Filter(d.FilterOperator.Equals,a,new m.ValueOperand(!0,"b"));default:return N(!0,"b")}}function ae(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,a;return __generator(this,(function(o){switch(o.label){case 0:return[4,r];case 1:return n=o.sent(),null===t?[2,ne(e,null,n)]:[4,t];case 2:return a=o.sent(),[2,ne(e,a,n)]}}))}))}function oe(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.forEach((function(t){return e.expands.push(t)})),e}function ie(e,t){if(!e)return null;var r=e.parentExpand;return r.expands.push(t),r.selects.push(t.propertyName),ce(e.dataSource,t,e.queryOptions)}function se(e,t,r,n){if(!e||!e.dataSource)return null;var a=new g.TableQueryOptions;return e instanceof v.QueryableDataSource&&e.queryTableAsync(a),a.expands=[t],r&&(a.selects=r),n&&(a.collapsePath=n),e instanceof u.QueriedTable||e instanceof b.ExpandQueriedTable?ce(e.dataSource,t,D(e,a)):ce(e.dataSource,t,a)}function ce(e,t,r){return new b.ExpandQueriedTable(e,t,r)}function ue(e){return null}function le(e,t,r){return t+"("+e[r+"_Id"]+")/"+r}function de(e,t){return T(pe(N(e,"s"),t))}function pe(e,t){var r,n,a,o,i=0;return Object.keys(t).forEach((function(s){switch(r=F(s),n=t[s],a=ne(n,e,r),i){case 0:o=new d.Filter(d.FilterOperator.None,a);break;case 1:o=new d.Filter(d.FilterOperator.Or,a,o.firstOperand);break;default:o=new d.Filter(d.FilterOperator.Or,a,o)}i++})),o}function fe(e,t){return __awaiter(this,void 0,Promise,(function(){var r;return __generator(this,(function(n){switch(n.label){case 0:return r=null,null===e?[3,2]:[4,e];case 1:r=n.sent(),n.label=2;case 2:return[2,pe(r,t)]}}))}))}function ye(e,t){return __awaiter(this,void 0,Promise,(function(){var r;return __generator(this,(function(n){switch(n.label){case 0:return e&&t&&(e instanceof c.NavigatedQueriedTable||e.dataSource)?[4,t]:[2,Promise.resolve(null)];case 1:return r=n.sent(),e instanceof v.QueryableDataSource||e instanceof c.NavigatedQueriedTable?[2,e.queryTableAsync(r)]:[2,e.dataSource.queryTableAsync(r)]}}))}))}function ge(e,t,r,n){return e&&t&&Object(o.AppMagicDataDataEntityRecord_isValid)(t)&&!Object(a.HashTableUtility_isEmpty)(t)&&r&&e.dataSource?e.dataSource.getNavigatedQueriedTableAsync(t,r,n):Promise.resolve(null)}function he(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n;return __generator(this,(function(a){switch(a.label){case 0:return e&&t?[4,e]:[2,Promise.resolve(null)];case 1:return r=a.sent(),[4,t];case 2:return n=a.sent(),[2,r.dataSource.queryScalarAsync(n)]}}))}))}function me(e,t){var r=new g.ScalarQueryOptions(t);return r.func=e,r}!function(e){e[e.UnSupported=-1]="UnSupported",e[e.Contains=0]="Contains",e[e.IndexOf=1]="IndexOf",e[e.SubStringOf=2]="SubStringOf",e[e.Year=3]="Year",e[e.Month=4]="Month",e[e.Day=5]="Day",e[e.Hour=6]="Hour",e[e.Minute=7]="Minute",e[e.Second=8]="Second",e[e.ToLower=9]="ToLower",e[e.ToUpper=10]="ToUpper",e[e.Trim=11]="Trim",e[e.Date=12]="Date",e[e.Len=13]="Len",e[e.Sum=14]="Sum",e[e.Min=15]="Min",e[e.Max=16]="Max",e[e.Average=17]="Average",e[e.Count=18]="Count",e[e.Add=19]="Add",e[e.Sub=20]="Sub",e[e.StartsWith=21]="StartsWith",e[e.EndsWith=22]="EndsWith",e[e.CountDistinct=23]="CountDistinct",e[e.CdsIn=24]="CdsIn",e[e.ContainsValues=25]="ContainsValues"}(n||(n={})),globalScopeObject._qd0=A,globalScopeObject._qd1=W,globalScopeObject._qd2=F,globalScopeObject._qd3=N,globalScopeObject._qd4=T,globalScopeObject._qd5=D,globalScopeObject._qd6=ye,globalScopeObject._qd7=pe,globalScopeObject._qd8=de,globalScopeObject._qd9=k,globalScopeObject._qd10=B,globalScopeObject._qd12=V,globalScopeObject._qd13=H,globalScopeObject._qd14=he,globalScopeObject._qd15=me,globalScopeObject._qd16=z,globalScopeObject._qd17=te,globalScopeObject._qd18=Y,globalScopeObject._qd19=se,globalScopeObject._qd20=le,globalScopeObject._qd21=ue,globalScopeObject._qd22=oe,globalScopeObject._qd23=ie,globalScopeObject._qd24=ge,globalScopeObject._qd25=w,globalScopeObject._qd26=x,globalScopeObject._qd27=Q,globalScopeObject._qd28=M,globalScopeObject._qd29=O,globalScopeObject._qd30=E,globalScopeObject._qd31=R,globalScopeObject._qd32=I,globalScopeObject._qd33=Z,globalScopeObject._qd34=S,globalScopeObject._qd35=G,globalScopeObject._qd36=j,globalScopeObject._qd37=ne,globalScopeObject._qd38=ae,globalScopeObject._qd39=fe,globalScopeObject._qd40=K,globalScopeObject._qd41=ee,globalScopeObject._qd42=re},function(e,t,r){"use strict";r.r(t),r.d(t,"assetsFolderName",(function(){return n})),r.d(t,"attrName",(function(){return a})),r.d(t,"attrType",(function(){return o})),r.d(t,"dataFileName",(function(){return i})),r.d(t,"entityMetadataFileName",(function(){return s})),r.d(t,"headerFileName",(function(){return c})),r.d(t,"errorFileName",(function(){return u})),r.d(t,"invariantNameKey",(function(){return l})),r.d(t,"schemaFileName",(function(){return d})),r.d(t,"tagApplicationData",(function(){return p})),r.d(t,"tagData",(function(){return f})),r.d(t,"tagTable",(function(){return y})),r.d(t,"tagRow",(function(){return g})),r.d(t,"tagCell",(function(){return h})),r.d(t,"tagRecord",(function(){return m})),r.d(t,"tagEntityMetadata",(function(){return v})),r.d(t,"assetsFolder",(function(){return b})),r.d(t,"assetsListFileName",(function(){return _})),r.d(t,"msImpexAppDataScheme",(function(){return C})),r.d(t,"xmlFileName",(function(){return A}));var n="Assets/",a="ss:Name",o="ss:Type",i="data.json",s="entityMetadata.json",c="header.json",u="error.json",l="invariantName",d="schema.json",p="ApplicationData",f="Data",y="Table",g="Row",h="Cell",m="Record",v="EntityMetadata",b="Assets",_="AssetsList.json",C="ms-appdata:///temp/{0}/Assets/",A="data.xml"},function(e,t,r){"use strict";r.r(t),r.d(t,"SourceType",(function(){return n})),r.d(t,"CdpQueryDefinition",(function(){return o}));var n,a=r(73);!function(e){e.AttachmentQueryDefinition="attachmentQueryDefinition",e.LookupQueryDefinition="lookupQueryDefinition",e.CdpPolymorphicQueryDefinition="CdpPolymorphicQueryDefinition",e.CdsOptionSetQueryDefinition="cdsOptionSetQueryDefinition",e.CdsPolymorphicQueryDefinition="CdsPolymorphicQueryDefinition",e.CdsViewsQueryDefinition="cdsViewsQueryDefinition",e.CdpNavigatedColumnArrayQueryDefinition="cdpNavigatedColumnArrayQueryDefinition",e.CdsNavigatedColumnArrayQueryDefinition="cdsNavigatedColumnArrayQueryDefinition",e.TabularQueryDefinition="tabularQueryDefinition",e.CdsQueryDefinition="cdsQueryDefinition",e.CdpQueryDefinition="cdpQueryDefinition",e.ActionQueryDefinition="actionQueryDefinition",e.CdsUserPrivilegeForEntityDefinition="cdsUserPrivilegeForEntityDefinition",e.CdsUserPrivilegeForRecordDefinition="cdsUserPrivilegeForRecordDefinition",e.CdsEntityDefinition="cdsEntityDefinition"}(n||(n={}));var o=function(){function e(e,t,r,n,o){var i=this;this.dataSourceName=t,this._connectorTypeName=r,this.queryStringBuilder=n,this.queryOptions=o,this._responseParams=new Core.Lazy((function(){return Object(a.createGetRowsResponse)(e,t,r.serverTableName,o)})),this._requestParamsPromise=new Core.Lazy((function(){return i.queryStringBuilder.getStringParametersAsync(o)}))}return Object.defineProperty(e.prototype,"tableName",{get:function(){return this._connectorTypeName.tableName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sourceType",{get:function(){return n.CdpQueryDefinition},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"queryParamsPromise",{get:function(){return this._requestParamsPromise.value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"responseParams",{get:function(){return this._responseParams.value},enumerable:!1,configurable:!0}),e}()},function(e,t,r){"use strict";var n;r.r(t),r.d(t,"OperandKind",(function(){return n})),r.d(t,"Operand",(function(){return a})),function(e){e[e.Function=0]="Function",e[e.Property=1]="Property",e[e.Value=2]="Value",e[e.Constant=3]="Constant",e[e.Filter=4]="Filter"}(n||(n={}));var a=function(){function e(e){this._operandKind=e}return Object.defineProperty(e.prototype,"operandKind",{get:function(){return this._operandKind},enumerable:!1,configurable:!0}),e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"dispose",(function(){return u})),r.d(t,"tryConvertConnectedDataErrorKindToErrorKind",(function(){return l})),r.d(t,"fromConnectorError",(function(){return d})),r.d(t,"rowExists",(function(){return p})),r.d(t,"rowNotFound",(function(){return f})),r.d(t,"columnValueInvalid",(function(){return y})),r.d(t,"columnReadOnly",(function(){return g})),r.d(t,"columnInvalidForUpdate",(function(){return h})),r.d(t,"columnGenerated",(function(){return m})),r.d(t,"formatDataSourceError",(function(){return v})),r.d(t,"createPermissionDenied",(function(){return b})),r.d(t,"createCustomError",(function(){return _})),r.d(t,"editPermissionDenied",(function(){return C})),r.d(t,"deletePermissionDenied",(function(){return A}));var n=r(0),a=r(74),o=r(13),i=r(5),s=AppMagic.Data.ErrorKind;AppMagic.Data.DataRecord;function c(e,t,r,n,o){return void 0===o&&(o=null),{Record:Object(a.clone)(e||null),Column:t,Message:r,Error:n,ServerMessage:o}}function u(e){null!==e.Record&&Object(i.releaseBlobs)(e.Record)}function l(e){switch(e){case o.ConnectedDataErrorKind.ETagMismatch:case o.ConnectedDataErrorKind.ItemExists:return s.Conflict;case o.ConnectedDataErrorKind.ItemNotFound:return s.NotFound;case o.ConnectedDataErrorKind.InvalidRequest:return s.ConstraintViolated;case o.ConnectedDataErrorKind.ComponentDisposed:return s.Unknown;default:return null}}function d(e,t,r){var n=l(e.errorKind);return n?c(r,null,e.message,n,e.serverErrorMessage):e.errorKind===o.ConnectedDataErrorKind.UnauthorizedRequest?c(r,null,e.message,t,e.serverErrorMessage):c(r,null,e.message,s.Network,e.serverErrorMessage)}function p(e){return c(e,null,AppMagic.Strings.ConnectedDataItemExists,s.Conflict)}function f(){return c(null,null,AppMagic.Strings.ConnectedDataRowNotFound,s.NotFound)}function y(e,t,r,n){return c(e,t,r,n)}function g(e,t){return c(e,t,AppMagic.Strings.ConnectedDataReadOnlyColumn,s.ReadOnlyValue)}function h(e,t){return c(e,t,Object(n.CoreUtility_formatString)(AppMagic.Strings.ConnectedDataIsInvalidForUpdate,t),s.ConstraintViolated)}function m(e,t){return c(e,t,AppMagic.Strings.ConnectedDataGeneratedColumn,s.GeneratedValue)}function v(e){switch(e.Error){case s.MissingRequired:case s.ReadOnlyValue:case s.GeneratedValue:if(e.Column)return e.Column+": "+e.Message}return Object(n.isNonEmptyString)(e.ServerMessage)?Object(n.CoreUtility_formatString)(AppMagic.Strings.ErrorWithServerMessage,e.Message,e.ServerMessage):e.Message}function b(){return c(null,null,AppMagic.Strings.ConnectedDataCreateRowPermissionDenied,s.CreatePermission)}function _(e,t,r,n){return c(e,t,r,n)}function C(e){return c(e,null,AppMagic.Strings.ConnectedDataPatchRowPermissionDenied,s.EditPermission)}function A(e){return c(e,null,AppMagic.Strings.ConnectedDataDeleteRowPermissionDenied,s.DeletePermission)}},function(e,t,r){"use strict";r.r(t),r.d(t,"isPrivatePropertyName",(function(){return s})),r.d(t,"isValidData",(function(){return c})),r.d(t,"isValid",(function(){return u})),r.d(t,"hasMetadata",(function(){return l})),r.d(t,"getAppDataSource",(function(){return d})),r.d(t,"tryGetAppDataSource",(function(){return p})),r.d(t,"getDataSourceKind",(function(){return f})),r.d(t,"setAppDataSource",(function(){return y})),r.d(t,"setMeta",(function(){return g})),r.d(t,"setDynamicDataSourceName",(function(){return h})),r.d(t,"removeMetadataProperties",(function(){return m})),r.d(t,"getDataSourceName",(function(){return v})),r.d(t,"renameDataSource",(function(){return b})),r.d(t,"getDataSourcePluginType",(function(){return _})),r.d(t,"isDataSourceRefreshable",(function(){return C})),r.d(t,"isDataSourceRenameable",(function(){return A})),r.d(t,"isDataSourceMutable",(function(){return S}));var n=r(0),a=r(36),o=r(4);var i="_AppDataSource_14BAD897C9494B419D017C43327692D9";function s(e){return e===i||"_dynamicDataSource"===e||"_meta"===e}function c(e){return Object(n.isArray)(e)||Object(n.isObject)(e)}function u(e){if(!c(e))return!1;var t=e,r=t._AppDataSource_14BAD897C9494B419D017C43327692D9;if(Object(n.isDefined)(r))return Object(n.isObject)(r)&&Object(n.isUndefined)(t._meta)&&Object(n.isUndefined)(t._dynamicDataSource);var a=t._meta;if(Object(n.isDefined)(a))return function(e){return Object(n.isJsonObject)(e)&&Object(n.isNonEmptyString)(e.name)&&Object(n.isNonEmptyString)(e.pluginType)}(a)&&Object(n.isUndefined)(t._dynamicDataSource);var o=t._dynamicDataSource;return!Object(n.isDefined)(o)||Object(n.isNonEmptyString)(o)}function l(e){var t=e;return Object(n.isDefined)(t._AppDataSource_14BAD897C9494B419D017C43327692D9)||Object(n.isDefined)(t._dynamicDataSource)||Object(n.isDefined)(t._meta)}function d(e){return e instanceof a.ExpandQueriedTable?e.dataSource||e._AppDataSource_14BAD897C9494B419D017C43327692D9||null:e._AppDataSource_14BAD897C9494B419D017C43327692D9||null}function p(e){return u(e)?d(e):null}function f(e){var t=d(e);if(null!==t)return t.kind;var r=e,n=r._meta;return n?n.pluginType===AppMagic.Constants.DataConnections.Types.Excel?o.DataSourceKind.StaticDataSource:null:r._dynamicDataSource?o.DataSourceKind.DynamicDataSource:null}function y(e,t){Object(n.createPrivate)(e,i,t)}function g(e,t){Object(n.createPrivate)(e,"_meta",t)}function h(e,t){Object(n.createPrivate)(e,"_dynamicDataSource",t)}function m(e){delete e[i],delete e._dynamicDataSource,delete e._meta}function v(e){var t,r=d(e);if(null!==r){var n=r.name;return r.kind==o.DataSourceKind.Collection&&(null!==(t=r.collectionDefName)&&void 0!==t)?t:n}var a=f(e);if(null===a)return null;switch(a){case o.DataSourceKind.DynamicDataSource:return e._dynamicDataSource;case o.DataSourceKind.StaticDataSource:return e._meta.name}}function b(e,t){switch(f(e)){case o.DataSourceKind.DynamicDataSource:break;case o.DataSourceKind.StaticDataSource:var r=e;r._meta={name:t,pluginType:r._meta.pluginType}}}function _(e){var t=d(e);if(null!==t)return t.pluginType;var r=e._meta;return r?r.pluginType:null}function C(e){var t=d(e);return null!==t&&t.isRefreshable}function A(e){var t=d(e);if(null!==t)return t.isRenameable;var r=f(e);return null!==r&&r!==o.DataSourceKind.DynamicDataSource}function S(e){var t=d(e);return null!==t?t.canUserEditAsync:f(e)!==o.DataSourceKind.StaticDataSource}},function(e,t,r){"use strict";r.r(t),r.d(t,"DisplayName",(function(){return n})),r.d(t,"Required",(function(){return a})),r.d(t,"MaxLength",(function(){return o})),r.d(t,"MinLength",(function(){return i})),r.d(t,"MaxValue",(function(){return s})),r.d(t,"MinValue",(function(){return c})),r.d(t,"AllowedValues",(function(){return u})),r.d(t,"EditPermission",(function(){return l})),r.d(t,"ReadPermission",(function(){return d})),r.d(t,"CreatePermission",(function(){return p})),r.d(t,"DeletePermission",(function(){return f}));var n="displayname",a="required",o="maxlength",i="minlength",s="maxvalue",c="minvalue",u="allowedvalues",l="editpermission",d="readpermission",p="createpermission",f="deletepermission"},function(e,t,r){"use strict";r.r(t),r.d(t,"ConnectedDataErrorKind",(function(){return n})),r.d(t,"TabularDataError",(function(){return i})),r.d(t,"ComponentDataError",(function(){return s})),r.d(t,"tryConvertErrorToErrorValue",(function(){return c}));var n,a=r(35),o=r(10);!function(e){e[e.InvalidDataEntityRecord=0]="InvalidDataEntityRecord",e[e.ServerError=1]="ServerError",e[e.UnauthorizedRequest=2]="UnauthorizedRequest",e[e.InvalidRequest=3]="InvalidRequest",e[e.ItemExists=4]="ItemExists",e[e.ItemNotFound=5]="ItemNotFound",e[e.ItemNotModified=6]="ItemNotModified",e[e.ETagMismatch=7]="ETagMismatch",e[e.ResourceLocked=8]="ResourceLocked",e[e.UnknownError=9]="UnknownError",e[e.InvalidResult=10]="InvalidResult",e[e.NotDisambiguated=11]="NotDisambiguated",e[e.ComponentDisposed=12]="ComponentDisposed",e[e.InvalidServerResponse=13]="InvalidServerResponse",e[e.ForbiddenRequest=14]="ForbiddenRequest",e[e.NotConfigured=15]="NotConfigured",e[e.ClientNotSupported=16]="ClientNotSupported",e[e.ClientUpgradeNeeded=17]="ClientUpgradeNeeded",e[e.RequestIncomplete=18]="RequestIncomplete"}(n||(n={}));var i=function(e){function t(t){var r=this;return(r=e.call(this,t)||this)._errorKind=t.errorKind,r}return __extends(t,e),Object.defineProperty(t.prototype,"errorKind",{get:function(){return this._errorKind},enumerable:!1,configurable:!0}),t.prototype.getTelemetryData=function(){var e={errorKind:n[this._errorKind],serverErrorMessage:this.serverErrorMessage};return this.serverError&&AppMagic.Services.errorHasHttpResponse(this.serverError)&&(e.responseStatus=this.serverError.response.status),e},t}(a.AppDataSourceError),s=function(){function e(e){this._errorValue=e}return Object.defineProperty(e.prototype,"errorValue",{get:function(){return this._errorValue},enumerable:!1,configurable:!0}),e}();function c(e,t,r,n,a){var s,c,u;if(!(t instanceof i))return null;var l=Object(o.tryConvertConnectedDataErrorKindToErrorKind)(t.errorKind),d=null!==(s=null!=l?l:a)&&void 0!==s?s:AppMagic.Data.ErrorKind.Unknown,p=t.serverError,f=Core.Utility.formatString(r,null!==(u=null!==(c=t.serverErrorMessage)&&void 0!==c?c:t.message)&&void 0!==u?u:""),y={errorContext:e,errorMessage:f,raiseToastNotification:!1,wasReported:!1,error:t,functionName:n},g=null==p?void 0:p.response;return AppMagic.Services.SendHttpResponse.isValid(g)?AppMagic.Data.ErrorValue.createError(d,AppMagic.Data.ErrorSeverity.Severe,f,y,g):AppMagic.Data.ErrorValue.createError(d,AppMagic.Data.ErrorSeverity.Severe,f,y)}},function(e,t,r){"use strict";r.r(t),r.d(t,"create",(function(){return a})),r.d(t,"dispose",(function(){return o})),r.d(t,"add",(function(){return i}));r(0);var n=r(10);function a(){return AppMagic.Data.DataTable.createTyped()}function o(e){for(var t=0,r=e.length;t<r;++t)Object(n.dispose)(e[t])}function i(e,t){return null===e?[t]:(e.push(t),e)}},function(e,t,r){"use strict";r.r(t);var n=r(1),a=r(0),o=r(60),i=r(120),s=r(32),c=r(25),u=r(2),l=r(31),d=r(8),p=r(28),f=AppMagic.Data.DataValue.isErrorValue,y=function(){function e(e){this._languageRuntime=e}return e.prototype._isKnownType=function(e){return"Record"===e.Type.Name||this._isSimpleType(e)},e.prototype._isSimpleType=function(e){return["Number","Text","Boolean","Guid"].indexOf(e.Type.Name)>-1},e.prototype.setCustomPageInputs=function(e){var t,r=this;if(!e||!Object(a.isObject)(e))return this._customPageInputsError(AppMagic.Strings.InputIsNotAnObject);var n=Object.keys(e);if(!(null===(t=AppMagic.CustomPages)||void 0===t?void 0:t.parameterSchema)&&n.length>0)return this._customPageInputsError(AppMagic.Strings.CustomPageHasNoInputs);for(var o=JSON.parse(AppMagic.CustomPages.parameterSchema),i=o.Parameters,s=Object(a.HashTableUtility_create)(),c=0,u=n;c<u.length;c++){var l=u[c],d=e[l];if(!i[l])return this._customPageInputsError(Object(a.CoreUtility_formatString)(AppMagic.Strings.UnsupportedInputParameter,l));var p=this._validateParameter(l,d,"",i[l].Schema,s);if(p)return this._customPageInputsError(p)}for(var f=0,y=Object.keys(i).filter((function(e){return i[e].Required}));f<y.length;f++){l=y[f];if(!e[l])return this._customPageInputsError(Object(a.CoreUtility_formatString)(AppMagic.Strings.RequiredParameterNotSpecified,l))}var g=Object(a.HashTableUtility_create)();return n.forEach((function(t){switch(i[t].Schema.Type.Name){case"Boolean":case"Guid":case"Number":case"Text":g[t]=e[t];break;default:r._isDataverseEntity(e[t])&&(g[t]={},g[t].etn=e[t].entityName,g[t].id=e[t].recordId)}})),this._fetchEntitiesAndSetInputs(e,o),{url:g,success:!0,errorMessage:null}},e.prototype._fetchEntitiesAndSetInputs=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,o,i=this;return __generator(this,(function(s){switch(s.label){case 0:r="CustomPageInputsProcessor-fetchDataAndSetInputs",s.label=1;case 1:return s.trys.push([1,3,4,5]),a.PerformanceRecorder.instance.startPerfMarker(r),n={},this._fetchEntities(e,this._paramToFields(t.Parameters),n),[4,this._replaceEntityContent(e,this._paramToFields(t.Parameters),n)];case 2:return s.sent(),Object.keys(e).forEach((function(t){i._languageRuntime.setScopeVariableValue("1",t,e[t],i._languageRuntime.getGlobalBindingContext())})),[3,5];case 3:return o=s.sent(),this._showDialog(AppMagic.Strings.PageInputsUnexpectedError),a.Log.trackErrorEvent("CustomPageInputsProcessor.UnexpectedError",o),[3,5];case 4:return a.PerformanceRecorder.instance.endPerfMarker(r),[7];case 5:return[2]}}))}))},e.prototype._typeMismatchMessage=function(e,t,r,n){return Object(a.CoreUtility_formatString)(AppMagic.Strings.TypeErrorForParameter,e+t,r,n)},e.prototype._paramToFields=function(e){var t=Object(a.HashTableUtility_create)();return Object.keys(e).forEach((function(r){t[r]=e[r].Schema})),t},e.prototype._validateParameter=function(e,t,r,n,o){if(f(t))return Object(a.CoreUtility_formatString)(AppMagic.Strings.InvalidCustomPageInputParameterValue,e+r);switch(n.Type.Name){case"Boolean":if("boolean"!=typeof t)return this._typeMismatchMessage(e,r,"Boolean",typeof t);break;case"Number":if("number"!=typeof t)return this._typeMismatchMessage(e,r,"Number",typeof t);break;case"Text":if("string"!=typeof t)return this._typeMismatchMessage(e,r,"String",typeof t);break;case"Guid":if("string"!=typeof t)return this._typeMismatchMessage(e,r,"Guid",typeof t);if(!Object(a.isGuid)(t))return Object(a.CoreUtility_formatString)(AppMagic.Strings.TypeErrorParameterIncorrectGuidFormat,e+r);break;case"Record":if(!n.Type.IsTable)return Object(a.isObject)(t)?this._validateRecordType(e,t,r,n,o):this._typeMismatchMessage(e,r,"object",typeof t);if(!Object(a.isArray)(t))return this._typeMismatchMessage(e,r,"Array",typeof t);for(var i=0;i<t.length;i++){if(s=this._validateRecordType(e,t[i],r+"["+i+"]",n,o))return s}break;default:if(this._isKnownType(n))break;if(!n.Type.IsTable)return this._validateDataverseRecordType(e,t,r,n,o);if(!Object(a.isArray)(t))return this._typeMismatchMessage(e,r,"Array",typeof t);for(i=0;i<t.length;i++){var s;if(s=this._validateDataverseRecordType(e,t[i],r+"["+i+"]",n,o))return s}}return""},e.prototype._validateDataverseRecordType=function(e,t,r,n,o){return null===t?"":Object(a.isObject)(t)?this._isDataverseEntity(t)?t.entityName&&t.entityName!==n.Type.Name?Object(a.CoreUtility_formatString)(AppMagic.Strings.IncorrectEntityRecordType,e+r,n.Type.Name,t.entityName):Object(a.isGuid)(t.recordId)?"":Object(a.CoreUtility_formatString)(AppMagic.Strings.TypeErrorParameterIncorrectGuidFormat,e+r+".recordId"):Object(a.CoreUtility_formatString)(AppMagic.Strings.InvalidEntityRecordFormat,e+r):this._typeMismatchMessage(e,r,"object",typeof t)},e.prototype._validateRecordType=function(e,t,r,n,o){for(var i=Object.keys(t),s=0;s<i.length;s++){var c=i[s],u=t[c];if(!n.Fields[c])return Object(a.CoreUtility_formatString)(AppMagic.Strings.UnsupportedInputRecordParameterField,e+r+"."+c);var l=this._validateParameter(e,u,r+"."+c,n.Fields[c],o);if(l)return l}return""},e.prototype._makeEntityKey=function(e){return e.recordId+"_"+e.entityName},e.prototype._isDataverseEntity=function(e){return Object(a.isObject)(e)&&e.recordId},e.prototype._getDataverseDataSourceByTableLogicalName=function(e){for(var t,r=AppMagic.AuthoringTool.Runtime.currentApp.dataSources.getDataSourceNames(),n=null,a=0;a<r.length;a++){var o=AppMagic.AuthoringTool.Runtime.currentApp.dataSources.tryGetDataSource(r[a]);if(o&&"default.cds"===(null===(t=o.dataset)||void 0===t?void 0:t.name)&&o.logicalName===e){n=o;break}}return n},e.prototype._fetchEntity=function(e,t){if(this._isDataverseEntity(e)){var r=this._makeEntityKey(e);if(!t[r]){var n=this._getDataverseDataSourceByTableLogicalName(e.entityName),o=n.tryGetTableMetadata(),i=JSON.parse(AppMagic.CustomPages.parameterSchemaQueryOptions)[e.entityName],s=Object.keys(i.Expands||Object(a.HashTableUtility_create)()).map((function(e){return new(c.Expand.bind.apply(c.Expand,__spreadArray([void 0,e],i.Expands[e].Selects,!1)))}));({})[o.primaryKeyColumn]=e.recordId;var f={sourceType:d.SourceType.CdsQueryDefinition,dataSourceName:n.name,queryStringBuilder:void 0,tableLogicalName:void 0,tableName:o.entitySetName,queryOptions:{selects:i.Selects||[],expands:s,filter:new u.Filter(u.FilterOperator.Equals,new l.PropertyOperand(o.primaryKeyColumn),new p.ValueOperand(e.recordId,"g")),format:void 0,func:void 0,sorts:void 0}};t[r]=n.connector.getRowsAsync(f)}}},e.prototype._fetchEntities=function(e,t,r){for(var n=0,a=Object.keys(e);n<a.length;n++){var o=a[n];if(!this._isSimpleType(t[o]))if("Record"===t[o].Type.Name)if(t[o].Type.IsTable)for(var i=0,s=e[o];i<s.length;i++){var c=s[i];this._fetchEntities(c,t[o].Fields,r)}else this._fetchEntities(e[o],t[o].Fields,r);else if(t[o].Type.IsTable)for(var u=0,l=e[o];u<l.length;u++){var d=l[u];this._fetchEntity(d,r)}else{var p=e[o];this._fetchEntity(p,r)}}},e.prototype._replaceEntityContent=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,a,o,i,s,c,u,l,d,p,f,y,g,h,m;return __generator(this,(function(v){switch(v.label){case 0:n=Object.keys(e),a=0,o=n,v.label=1;case 1:if(!(a<o.length))return[3,10];if(i=o[a],this._isSimpleType(t[i]))return[3,9];if("Record"!==t[i].Type.Name)return[3,2];if(t[i].Type.IsTable)for(s=e[i],c=0,u=s;c<u.length;c++)l=u[c],this._replaceEntityContent(l,t[i].Fields,r);else this._replaceEntityContent(e[i],t[i].Fields,r);return[3,9];case 2:if(!t[i].Type.IsTable)return[3,7];d=e[i],p=0,v.label=3;case 3:return p<d.length?(f=d,y=p,[4,r[this._makeEntityKey(d[p])]]):[3,6];case 4:f[y]=v.sent().results[0],v.label=5;case 5:return p++,[3,3];case 6:return[3,9];case 7:return g=e[i],this._isDataverseEntity(g)?(h=e,m=i,[4,r[this._makeEntityKey(g)]]):[3,9];case 8:h[m]=v.sent().results[0],v.label=9;case 9:return a++,[3,1];case 10:return[2]}}))}))},e.prototype._customPageInputsError=function(e){return this._showDialog(Object(a.CoreUtility_formatString)(AppMagic.Strings.CustomPageInputsError,e)),a.Log.trackActivityEvent("CustomPageInputsProcessor.UserError",{message:e}),{errorMessage:e,success:!1,url:null}},e.prototype._showDialog=function(e){var t=AppMagic.AuthoringTool.Runtime.currentApp.hostCommandDispatcher.tryGetOpenErrorDialogDispatcher();null==t||t.openErrorDialog(e)},e}();r.d(t,"EntityScope",(function(){return v})),r.d(t,"getLanguageRuntime",(function(){return b})),r.d(t,"testOnlyResetLanguageRuntime",(function(){return _})),r.d(t,"LanguageRuntime",(function(){return C}));var g,h=AppMagic.Constants.Runtime,m=!a.FallbackSwitch.isActivated("AppRuntime.ShortCircuitEqualPrimitives"),v=function(){function e(){}return Object.defineProperty(e,"GlobalScopeId",{get:function(){return"0"},enumerable:!1,configurable:!0}),e}();function b(){return g||(g=new C(AppMagic.AuthoringTool.Runtime)),g}function _(){g=null}var C=function(){function e(e){this._environment=Object(a.HashTableUtility_create)(),this._nextId=1,this._lastErrorTimestamps={},this._runtimeBase=e,this._aliases=Object(a.HashTableUtility_create)(),this._scopeVariables=new Map,this._scopeCollections=new Map;var t=Object(a.isWebAuthoring)()?"CanvasStudio":"PublishedApp";a.MessagingLibraryClient.registerCommandHandler(t,new i.GetVariablesCommandHandler(this)),this._inspectCommandHandler=new s.InspectCommandHandler(this),a.MessagingLibraryClient.registerCommandHandler(t,this._inspectCommandHandler)}return Object.defineProperty(e.prototype,"dataRuntime",{get:function(){return this._runtimeBase},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._environment=Object(a.HashTableUtility_create)(),this._aliases=Object(a.HashTableUtility_create)(),this._scopeVariables=new Map,this._scopeCollections=new Map},e.prototype.onSuspend=function(e){e.environment=this._environment,e.nextId=this._nextId,e.aliases=this._aliases},e.prototype.onResumeFromTerminate=function(e){this._environment=e.environment,this._nextId=e.nextId,this._aliases=e.aliases},e.prototype.getAliasValue=function(e,t){var r,n=this._aliases[e];return null!==(r=null==n?void 0:n[t])&&void 0!==r?r:null},e.prototype.getAliasValues=function(e){var t=this._aliases[e];return Object(a.HashTableUtility_create)(t)},e.prototype.onDataSourceChanged=function(e){Core.Diagnostics.isEnabled()&&this._inspectCommandHandler.onDataSourceChanged(e)},e.prototype.onVariableMetadataChanged=function(e,t,r,n){Core.Diagnostics.isEnabled()&&this._inspectCommandHandler.onVariableMetaChanged(e,t,r,n)},e.prototype.setAliasValue=function(e,t,r){var n=this,o=!1,i=this._aliases[e];i||(i=Object(a.HashTableUtility_create)(),this._aliases[e]=i,o=!0);var c=i[t];if(c===r&&(null===r||"object"!=typeof r)&&m)return!1;if(i[t]=r,Core.Diagnostics.isEnabled()){if(null==c){if(o){var u=OpenAjax.widget.controlManager.controlInstancesFlatTree[e].name;this._inspectCommandHandler.onVariableMetaChanged(s.VariableType.Context,[u],"added")}this._runtimeBase.getVariableDisplayType(e,t).then((function(a){var o=null!=a?a:typeof r;n._inspectCommandHandler.onVariableMetaChanged(s.VariableType.Context,[e,t],"added",o)}))}this._inspectCommandHandler.onContextVariableValueChange(e,t,r)}return!0},e.prototype.setAliasValues=function(e,t){var r,n,a=[],o=Object.keys(t);for(r=0,n=o.length;r<n;r++){var i=o[r];if(this.setAliasValue(e,i,t[i])){var s=e+"."+i;a.push(s)}}for(r=0,n=a.length;r<n;r++)this.onDataSourceChanged(a[r])},e.prototype.getContextVariableValue=function(e,t){var r,n;try{n=this._runtimeBase.getNamedControlByDisplayName(e)}catch(e){return}var a=null===(r=null==n?void 0:n.OpenAjax)||void 0===r?void 0:r.uniqueId;if(a)return this.getAliasValues(a)[t]},e.prototype.getContextVariables=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,n,o;return __generator(this,(function(i){switch(i.label){case 0:return t=function(t){return!e||e.indexOf(t)>-1},n=a.HashTableUtility_filter,[4,this._runtimeBase.getVariablesAndDisplayTypes()];case 1:return r=n.apply(void 0,[i.sent(),function(e,r){return r!==h.appInfoControlName&&t(r)}]),Object.keys(r).length>0?[2,r]:(o=Object(a.HashTableUtility_create)(),Object(a.HashTableUtility_forEach)(this._aliases,(function(e,r){var n=OpenAjax.widget.controlManager.controlInstancesFlatTree[r].name;t(n)&&(o[n]=Object(a.HashTableUtility_map)(e,(function(e){return typeof e})))})),[2,o])}}))}))},e.prototype.resetAliasValues=function(e){delete this._aliases[e]},e.prototype.removeScopeVariableValues=function(e){delete this._scopeVariables[e];if(Core.Diagnostics.isEnabled()&&e.startsWith("1.")){var t=e.substr("1.".length);this._inspectCommandHandler.onVariableMetaChanged(s.VariableType.Global,[t],"removed")}},e.prototype.removeScopeCollectionValues=function(e,t){delete this._scopeCollections[e]},e.prototype.getGlobalVariableValue=function(e){if(this._scopeVariables[this.getScopedEntityFullName("1",e)])return this.getScopeVariableValue("1",e,this._runtimeBase.getGlobalBindingContext())},e.prototype.getGlobalVariables=function(){return __awaiter(this,void 0,Promise,(function(){var e,t,r=this;return __generator(this,(function(n){switch(n.label){case 0:return[4,this._runtimeBase.getVariablesAndDisplayTypes()];case 1:return(e=n.sent())[h.appInfoControlName]?[2,e[h.appInfoControlName]]:(t=Object(a.HashTableUtility_create)(),"1.",Object.keys(this._scopeVariables).filter((function(e){return e.startsWith("1.")})).forEach((function(e){var n=r._getScopedEntityState("1",r._runtimeBase.getGlobalBindingContext()),a=r._scopeVariables[e][n],o=e.substr("1.".length);t[o]=typeof a})),[2,t])}}))}))},e.prototype.getScopeVariableValue=function(e,t,r){var n;r=this._getProperBindingContextForScopedEntity(e,"1",r);var a=this._scopeVariables[this.getScopedEntityFullName(e,t)];return null!==(n=null==a?void 0:a[this._getScopedEntityState(e,r)])&&void 0!==n?n:null},e.prototype.getOrCreateScopeCollectionValue=function(e,t,r){var n,a=this.getScopeCollectionValue(e,t,r);if(!a){if(e==v.GlobalScopeId)return this._runtimeBase.addCollection(t,e).data;var o=null!==(n=(r=this._getProperBindingContextForScopedEntity(e,v.GlobalScopeId,r)).componentInstanceUniqueId)&&void 0!==n?n:e,i=this._runtimeBase.addCollection(t,o);return this.setScopeCollectionValueToExistingScope(e,t,i,o),i.data}return a.data},e.prototype.getScopeCollectionValue=function(e,t,r){var n,a=this._getProperBindingContextForScopedEntity(e,v.GlobalScopeId,r),o=this._scopeCollections[this.getScopedEntityFullName(e,t)];return null!==(n=null==o?void 0:o[this._getScopedEntityState(e,a)])&&void 0!==n?n:null},e.prototype.getScopeCollectionInstanceValue=function(e,t,r){var n,a=this._scopeCollections[this.getScopedEntityFullName(e,r)];return null!==(n=null==a?void 0:a[t])&&void 0!==n?n:null},e.prototype.tryGetScopeCollectionData=function(e,t,r){var n=this.getScopeCollectionInstanceValue(e,t,r);return null==n?void 0:n.data},e.prototype.getAllCollectionInstancesForGivenCollection=function(e){return this._scopeCollections[e]?Object.keys(this._scopeCollections[e]):null},e.prototype.setScopeCollectionValueToExistingScope=function(e,t,r,n){var a=this.getScopedEntityFullName(e,t),o=n;this._scopeCollections[a]||this._runtimeBase.addCollection(t,e),this._scopeCollections[a][o]=r},e.prototype.setScopeCollectionValue=function(e,t,r,n){n=this._getProperBindingContextForScopedEntity(e,v.GlobalScopeId,n);var o=this.getScopedEntityFullName(e,t),i=this._getScopedEntityState(e,n);Object(a.isString)(i)&&(this._scopeCollections[o]||(this._scopeCollections[o]=new Map),this._scopeCollections[o][i]=r,this._runtimeBase._onEntityDataChanged(o,n))},e.prototype.setScopeVariableValue=function(e,t,r,n){var o=this;n=this._getProperBindingContextForScopedEntity(e,"1",n);var i=this._getScopedEntityState(e,n);if(Object(a.isString)(i)){var c=this.getScopedEntityFullName(e,t);this._scopeVariables[c]||(this._scopeVariables[c]=new Map);var u=this._scopeVariables[c][i];(u!==r||null!==r&&"object"==typeof r||!m)&&(this._scopeVariables[c][i]=r,Core.Diagnostics.isEnabled()&&"1"===e&&(this._inspectCommandHandler.onVariableValueChange(s.VariableType.Global,t,r),void 0===u&&this._runtimeBase.getVariableDisplayType("1",t).then((function(e){var n=null!=e?e:typeof r;o._inspectCommandHandler.onVariableMetaChanged(s.VariableType.Global,[t],"added",n)}))),this._runtimeBase._onEntityDataChanged(this.getScopedEntityFullName(e,t),n))}},e.prototype._getProperBindingContextForScopedEntity=function(e,t,r){for(e===t&&(r=this._runtimeBase.globalBindingContext);r&&!r.componentInstance;)r=r.parent;return r&&r.componentInstance?r:this._runtimeBase.getGlobalBindingContext()},e.prototype.getScopedEntityFullName=function(e,t){return e+"."+t},e.prototype.getVariableValuesJson=function(){var e=this,t={};Object.keys(this._aliases).forEach((function(r){var n=OpenAjax.widget.controlManager.controlInstancesFlatTree[r].name;t[n]=e._aliases[r]}));var r=[],n=this._runtimeBase.currentApp;return n.dataSources.getDataSourceNames().forEach((function(t){var a,i=n.dataSources.tryGetDataSource(t);if(i){var s=e.getScopedEntityFullName(v.GlobalScopeId,i.collectionDefName);o.CollectionDataSource.isCollectionDataSource(i)&&i.name===s&&r.push(((a={})[i.collectionDefName]=i.data,a))}})),JSON.stringify({scopeVariables:this._scopeVariables,alias:t,collections:r})},e.prototype._getScopedEntityState=function(e,t){return Object(a.Contracts_check)(null===t||t===this._runtimeBase.getGlobalBindingContext()||void 0!==t.componentInstance,"Only accept globalBindingContext or componentInstance bindingContext"),(null==t?void 0:t.componentInstance)?t.componentInstanceUniqueId:e},e.prototype.generateId=function(){return this._nextId++},e.prototype.assignRowID=function(e,t){void 0===e&&(e=null),e&&(Object(n.AppMagicDataErrorValue_isErrorValue)(e)||(t=null!=t?t:this.generateId(),e[h.idProperty]&&Object(a.AppMagicUtility_createOrSetPrivate)(e,h.oldIdProperty,e[h.idProperty]),Object(a.AppMagicUtility_createOrSetPrivate)(e,h.idProperty,t)))},e.prototype.makeColumn=function(e,t,r){r=null!=r?r:"Value";var n=[],o=e.length;if(o<1)return n;for(var i={},s=0;s<o;s++){for(var c={},u=e[s],l=this._hashValue(u);i[l];)l=this.generateId();i[l]=!0,c[r]=u,this.assignRowID(c,l),n.push(c)}return 0===t&&(t=this.generateId()),Object(a.AppMagicUtility_createOrSetPrivate)(n,h.idProperty,t),n},e.prototype.assignTableID=function(e){if(!Object(n.AppMagicDataErrorValue_isErrorValue)(e)&&(null!==e&&Object(a.isUndefined)(e[h.idProperty])))if(Object(a.AppMagicUtility_createOrSetPrivate)(e,h.idProperty,this.generateId()),Core.Environment.isRuntimeCapabilityEnabled("UseStaticRowIDs"))for(var t=0,r=e;t<r.length;t++){var o=r[t];o&&!o[h.idProperty]&&this.assignRowID(o)}else if(e.length)for(var i=0,s=e.length;i<s;i++)this.assignRowID(e[i])},e.prototype._hashValue=function(e){if(null===e)return 0;switch(typeof e){case"number":return 1+2*e;case"string":return 1|this._hashStr(e)<<1;case"boolean":return e?3:1}return this.generateId()<<1},e.prototype._hashStr=function(e){var t=e.length,r=t;if(0===t)return r;for(var n=0;n<t;n++)r=(r<<5|r>>>27)^e.charCodeAt(n);return r},e.prototype.cloneAndUpdateErrorContext=function(e,t,r,n){var a=Object.assign({},e);return a.nodeId=t,a.abortSignal=e.abortSignal,r&&(a.diagnosticContext?a.diagnosticContext=Object.assign({},a.diagnosticContext,r):a.diagnosticContext=r),void 0!==n&&(a.silentErrors=n),a},e.prototype.createReportableError=function(e,t,r,n,a,o){return{errorContext:e,errorMessage:t,raiseToastNotification:r,wasReported:n,error:a,functionName:o}},e.prototype.raiseRuntimeErrorToast=function(e,t,r){void 0===r&&(r=null),t&&Core.UI.Toast.ToastHandler.suspendOnClickToast({type:Core.UI.Toast.ToastType.error,message:e+(r?" ##LINK0## ".concat(AppMagic.Strings.LinkTitle_LocationTrackingLearnMore," ##/LINK0##"):""),timeout:3e4,clickHandler:r})},e.prototype.raiseRuntimeErrorToastErrorHandlingEnabled=function(e,t,r){if(void 0===r&&(r=null),e){var n="".concat(e.entityName,"$").concat(e.propertyName,"$").concat(t),a=!0,o=Date.now();this._lastErrorTimestamps[n]&&o-this._lastErrorTimestamps[n]<1e4&&(a=!1),this._lastErrorTimestamps[n]=o,this._clearLastErrorTimestampsPriorTo(o-1e4),a&&Core.UI.Toast.ToastHandler.suspendOnClickToast({type:Core.UI.Toast.ToastType.error,message:t+(r?" ##LINK0## ".concat(AppMagic.Strings.LinkTitle_LocationTrackingLearnMore," ##/LINK0##"):""),timeout:3e4,clickHandler:r})}},e.prototype._clearLastErrorTimestampsPriorTo=function(e){for(var t=0,r=Object.keys(this._lastErrorTimestamps);t<r.length;t++){var n=r[t];this._lastErrorTimestamps[n]<e&&delete this._lastErrorTimestamps[n]}},e.prototype.setEnvironmentValue=function(e,t){this._environment[e]=t},e.prototype.getEnvironmentValue=function(e){var t;return null!==(t=this._environment[e])&&void 0!==t?t:null},e.prototype.getPropertyValue=function(e,t,r){var o;if(Object(a.isNullOrUndefined)(e))return null;if(Object(n.AppMagicDataErrorValue_isErrorValue)(e))return e;if(Object(a.isOpenAjaxControl)(e))return e.OpenAjax.getPropertyValue(t,r);if(e.hasOwnProperty(t)){var i=e[t];return null!==(o=this._getFieldValueOrControlPropertyLastValue(i))&&void 0!==o?o:null}if(e.uniqueId&&e.name&&e.topParentOrSelf)try{var s=AppMagic.AuthoringTool.Runtime.getNamedControl(e.uniqueId,r);if(s)return s.OpenAjax.getPropertyValue(t,r)}catch(e){}return null},e.prototype._getFieldValueOrControlPropertyLastValue=function(e){return Object(a.isDefined)(null==e?void 0:e.lastValue)&&Object(a.isDefined)(e.ruleValue)&&2===Object.keys(e).length?e.lastValue:e},e.prototype.getFieldValue=function(e,t){var r;return Object(a.isNullOrUndefined)(e)||Object(a.isOpenAjaxControl)(e)?null:Object(n.AppMagicDataErrorValue_isErrorValue)(e)?e:null!==(r=this._getFieldValueOrControlPropertyLastValue(e[t]))&&void 0!==r?r:null},e.prototype.collectErrors=function(e,t){for(var r=null,a=[],o=0;o<e.length;o++){var i=e[o];Object(n.AppMagicDataErrorValue_isErrorValue)(i)&&(null===r?void 0!==(r=i).nextErrors&&(a=i.nextErrors.concat()):(a.push(Object(n.withoutNextErrors)(i)),void 0!==i.nextErrors&&a.push.apply(a,i.nextErrors.map(n.withoutNextErrors))))}if(null!==r){var s=Object(n.copyError)(r);return s.nextErrors=a,s}return void 0===t?e[e.length-1]:t},e.prototype.applyNameMap=function(e,t,r,n,a){return void 0===n&&(n=!1),void 0===a&&(a=!1),AppMagic.Data.DataFlow.applyNameMap(e,t,r,n,a)},e.prototype.mergeExpando=function(e){return AppMagic.Data.DataFlow.mergeExpando(e)},e.prototype.mergeExpandoRecord=function(e){return AppMagic.Data.DataFlow.mergeExpandoRecord(e)},e.prototype.getThisItem=function(e,t){return t>0&&(e=this._getAncestorBindingContext(e,t)),this.mergeExpandoRecord({_src:e.thisItem})},e.prototype._getAncestorBindingContext=function(e,t){for(;Object(a.isObject)(e)&&t>0;t--)e=e.parent;return e},e.prototype.coerceTable=function(e,t){if(null===e||Object(n.AppMagicDataErrorValue_isErrorValue)(e))return e;for(var r=[],o=0,i=e.length;o<i;o++)r.push(this.coerceRecord(e[o],t));return Object(a.CoreUtility_copyIdAndMetadata)(e,r),AppMagic.Data.DataFlow.copyNameMap(e,r),r},e.prototype.coerceRecord=function(e,t){if(null===e||Object(n.AppMagicDataErrorValue_isErrorValue)(e))return e;for(var r=Object(n.clone)(e,!0,!0),o=Object.keys(t),i=o.length,s=0;s<i;s++){var c=o[s],u=r[c];Object(a.isDefined)(u)&&(r[c]=t[c](u))}return Object(a.CoreUtility_copyIdAndMetadata)(e,r),r},e.prototype.coerceTableAsync=function(e,t){var r=this;return null===e||Object(n.AppMagicDataErrorValue_isErrorValue)(e)?Promise.resolve(e):Object(a.PromiseUtility_join)(e.map((function(e){return r.coerceRecordAsync(e,t)}),this)).then((function(t){return Object(a.CoreUtility_copyIdAndMetadata)(e,t),AppMagic.Data.DataFlow.copyNameMap(e,t),t}))},e.prototype.coerceRecordAsync=function(e,t){if(null===e||Object(n.AppMagicDataErrorValue_isErrorValue)(e))return Promise.resolve(e);var r=Object.keys(t).length,o=[];return Object(a.HashTableUtility_forEach)(t,(function(t,r){Object(a.isUndefined)(e[r])||o.push(Promise.resolve(t(e[r])).then((function(e){return{newValue:e,key:r}})))})),Object(a.PromiseUtility_join)(o).then((function(t){for(var o=Object(n.clone)(e,!0,!0),i=0;i<r;i++)o[t[i].key]=t[i].newValue;return Object(a.CoreUtility_copyIdAndMetadata)(e,o),o}))},e.prototype.setCustomPageInputs=function(e){return new y(this).setCustomPageInputs(e)},e.prototype.getGlobalBindingContext=function(){return this._runtimeBase.globalBindingContext},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"getCacheableQueryKey",(function(){return o})),r.d(t,"CacheableQuery",(function(){return i})),r.d(t,"TabularCachableQuery",(function(){return s})),r.d(t,"AttachmentCacheableQuery",(function(){return c})),r.d(t,"LookupCacheableQuery",(function(){return u})),r.d(t,"CdpPolymorphicCacheableQuery",(function(){return l})),r.d(t,"CdsPolymorphicCacheableQuery",(function(){return d})),r.d(t,"CdsOptionSetCacheableQuery",(function(){return p})),r.d(t,"CdsViewsCacheableQuery",(function(){return f})),r.d(t,"NavigatedArrayCacheableQuery",(function(){return y})),r.d(t,"CdsUserPrivilegeForEntityQuery",(function(){return g})),r.d(t,"CdsUserPrivilegeForRecordQuery",(function(){return h})),r.d(t,"CdsLocalizedDisplayNameQuery",(function(){return m}));r(0);var n=r(2),a=r(9);function o(e,t,r){return e+t+r}var i=function(){function e(e,t){void 0===t&&(t=!1),this._query=e,this._usePermanentCache=t}return Object.defineProperty(e.prototype,"queryDefinition",{get:function(){return this._query},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cachePermanently",{get:function(){return this._usePermanentCache},enumerable:!1,configurable:!0}),e}(),s=function(e){function t(t,r){var n=e.call(this,t)||this;return n._context=r,n._queryStringBuilder=t.queryStringBuilder,n}return __extends(t,e),t.prototype.getKeyAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e,t,r;return __generator(this,(function(o){switch(o.label){case 0:return"cdsQueryDefinition"!==this._query.sourceType||void 0===this._query.queryOptions.filter||this._query.queryOptions.filter.firstOperand.operandKind!==a.OperandKind.Value||this._query.queryOptions.filter.operator!==n.FilterOperator.Equals&&this._query.queryOptions.filter.operator!==n.FilterOperator.NotEquals||(this._query.queryOptions.filter,e=new n.Filter(this._query.queryOptions.filter.operator,this._query.queryOptions.filter.secondOperand,this._query.queryOptions.filter.firstOperand),this._query.queryOptions.filter=e),t="".concat(this._query.dataSourceName,"_").concat(this._query.tableName),this._query.queryOptions?[4,this._queryStringBuilder.convertToStringAsync(this._query.queryOptions,this._context)]:[3,2];case 1:(r=o.sent())&&(t+="_"+r),o.label=2;case 2:return[2,t]}}))}))},t}(i),c=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.getKeyAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,"".concat(this._query.dataSourceName,"_").concat(this._query.tableName,"_").concat(this._query.columnName,"_").concat(this._query.itemKey)]}))}))},t}(i),u=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.getKeyAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,"".concat(this._query.dataSourceName,"_").concat(this._query.tableName,"_").concat(this._query.columnName,"_").concat(this._query.searchText)]}))}))},t}(i),l=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.getKeyAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,"".concat(this._query.dataSourceName,"_").concat(this._query.tableName,"_").concat(this._query.columnName,"_").concat(this._query.key)]}))}))},t}(i),d=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.getKeyAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,"".concat(this._query.dataSourceName,"_").concat(this._query.tableName,"_").concat(this._query.columnName,"_").concat(this._query.key)]}))}))},t}(i),p=function(e){function t(t){return e.call(this,t,!0)||this}return __extends(t,e),t.prototype.getKeyAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,"".concat(this._query.dataSourceName,"_").concat(this._query.tableName,"_").concat(this._query.columnName,"_").concat(this._query.sourceType)]}))}))},t}(i),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.getKeyAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,"".concat(this._query.dataSourceName,"_").concat(this._query.tableName,"_").concat(this._query.sourceType)]}))}))},t}(i),y=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),Object.defineProperty(t.prototype,"responseParams",{get:function(){return this._query.responseParams},enumerable:!1,configurable:!0}),t.prototype.getKeyAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,"".concat(this._query.dataSourceName,"_").concat(this._query.tableName,"_").concat(this._query.columnName,"_").concat(this._query.itemKey,"_").concat(this._query.requestUrl)]}))}))},t}(i),g=function(e){function t(t){return e.call(this,t,!0)||this}return __extends(t,e),t.prototype.getKeyAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,"".concat(this._query.dataSourceName,"_").concat(this._query.tableName,"_").concat(this._query.privilegeName,"_").concat(this._query.sourceType)]}))}))},t}(i),h=function(e){function t(t){return e.call(this,t,!0)||this}return __extends(t,e),t.prototype.getKeyAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,"".concat(this._query.dataSourceName,"_").concat(this._query.tableName,"_").concat(this._query.recordId,"_").concat(this._query.sourceType)]}))}))},t}(i),m=function(e){function t(t){return e.call(this,t,!0)||this}return __extends(t,e),t.prototype.getKeyAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,"".concat(this._query.dataSourceName,"_").concat(this._query.tableName,"_").concat(this._query.columnNames.slice().sort().join(":"),"_").concat(this._query.sourceType)]}))}))},t}(i)},function(e,t,r){"use strict";r.r(t),r.d(t,"FileDataProcessor",(function(){return u}));var n=r(1),a=r(7),o=r(27),i=r(52),s=r(5),c=r(0),u=function(){function e(){}return e.createFolderAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r;return __generator(this,(function(n){switch(n.label){case 0:return r=null,t?[3,2]:[4,Core.IO.FileSystem.getUserDataFolderAsync(!0)];case 1:return r=n.sent(),[3,3];case 2:r=t,n.label=3;case 3:return[2,r.createFolderAsync(e,Core.IO.CreationCollisionOption.OverwriteIfExists)]}}))}))},e.loadFolderAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r;return __generator(this,(function(n){switch(n.label){case 0:return r=null,t?[3,2]:[4,Core.IO.FileSystem.getUserDataFolderAsync(!0)];case 1:return r=n.sent(),[3,3];case 2:r=t,n.label=3;case 3:return[4,r.folderExistsAsync(e)];case 4:if(!n.sent())throw new AppMagic.Runtime.App.NonExistentFileFlagError;return[2,r.getFolderAsync(e)]}}))}))},e.deleteFolderAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){switch(r.label){case 0:return[4,e.folderExistsAsync(t)];case 1:return r.sent()?[4,e.getFolderAsync(t)]:[3,4];case 2:return[4,r.sent().deleteAsync()];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))},e.getChunkRecords=function(t){if(t.length>0){if(t.length>e.MinimumRecordsForChunk){var r=Math.floor(Math.random()*t.length),n=0;do{n=Math.floor(Math.random()*t.length)}while(r===n);var a=0;do{a=Math.floor(Math.random()*t.length)}while(r===a||n===a);var o=Math.max(this.getJSonUnreferenceStringLength(t[r]),this.getJSonUnreferenceStringLength(t[n]),this.getJSonUnreferenceStringLength(t[a]));return Math.ceil(e.MaxChunkLimit/o)}return Math.ceil(e.MaxChunkLimit/this.getJSonUnreferenceStringLength(t[0]))}return 0},e.saveDataFileAsync=function(e,t,r){return t.createFileAsync(r,Core.IO.CreationCollisionOption.OverwriteIfExists).then((function(t){return t.writeTextAsync(JSON.stringify(e))}))},e.saveChunkDataFileAsync=function(t,r,n){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(a){switch(a.label){case 0:return Object(o.updateEnumerable)(t,!0),[4,e.saveDataFileAsync(t,r,n)];case 1:return a.sent(),Object(o.updateEnumerable)(t,!1),[2,!0]}}))}))},e.saveArrayBufferFileAsync=function(e,t,r){return t.createFileAsync(r).then((function(t){return t.writeArrayBufferAsync(e)}))},e.saveBlobFileAsync=function(e,t,r){return t.createFileAsync(r).then((function(t){return t.writeBlobAsync(e)}))},e.doesErrorFileExist=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,e.fileExistsAsync(a.errorFileName)];case 1:return[2,t.sent()]}}))}))},e.loadDataFileAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){switch(r.label){case 0:return[4,e.fileExistsAsync(t)];case 1:if(!r.sent())throw new AppMagic.Runtime.App.NonExistentFileFlagError;return Core.FeatureGates.services.loadDataUsingArrayBuffer?[2,e.getFileAsync(t).then((function(e){return e.readArrayBufferAsync()})).then((function(e){var t=(new TextDecoder).decode(e);return JSON.parse(t)}))]:[2,e.getFileAsync(t).then((function(e){return e.readTextAsync()})).then((function(e){return JSON.parse(e)}))]}}))}))},e.loadChunkDataFileAsync=function(t,r,n){return __awaiter(this,void 0,Promise,(function(){var n;return __generator(this,(function(a){switch(a.label){case 0:return[4,e.loadDataFileAsync(t,r)];case 1:return(n=a.sent())&&Object(o.updateEnumerable)(n,!1),[2,n]}}))}))},e.deleteFileAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){switch(r.label){case 0:return[4,e.fileExistsAsync(t)];case 1:return r.sent()?[4,e.getFileAsync(t)]:[3,4];case 2:return[4,r.sent().deleteAsync()];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))},e.renameDataFileAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n;return __generator(this,(function(a){switch(a.label){case 0:return[4,e.fileExistsAsync(t)];case 1:return a.sent()?[4,e.getFileAsync(t)]:[3,5];case 2:return n=a.sent(),[4,e.createFileAsync(r,Core.IO.CreationCollisionOption.OverwriteIfExists)];case 3:return a.sent(),[4,n.renameFileAsync(r)];case 4:a.sent(),a.label=5;case 5:return[2]}}))}))},e.loadArrayBufferFileAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){switch(r.label){case 0:return[4,e.fileExistsAsync(t)];case 1:if(!r.sent())throw new AppMagic.Runtime.App.NonExistentFileFlagError;return[2,e.getFileAsync(t).then((function(e){return e.readArrayBufferAsync()}))]}}))}))},e.loadBlobFromFileAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){switch(r.label){case 0:return[4,e.fileExistsAsync(t)];case 1:if(!r.sent())throw new AppMagic.Runtime.App.NonExistentFileFlagError;return[2,e.getFileAsync(t).then((function(e){return e.readBlobAsync()}))]}}))}))},e.getMediaFileInfo=function(e){var t={mediaUri:null,mimeType:null},r=new Core.Url(e).getSegment(-1),n=r.substring(r.lastIndexOf("."));return t.mediaUri=Core.Url.decode(r.substring(0,r.lastIndexOf("."))),t.mimeType=Core.MimeTypes.tryGetMimeType(n.toLowerCase()),Core.Utility.isAbsoluteUrlString(t.mediaUri)?t:(Core.Log.error("FileDataProcessor.LoadAndRegisterBlobsData:",new Error("Media url '".concat(t.mediaUri,"' is not an appres uri instance."))),{mediaUri:null,mimeType:null})},e.isExpandedSaveDataSupportedAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e,t;return __generator(this,(function(r){switch(r.label){case 0:return[4,Core.Utility.cordovaExecAsync("SienaFilePickerPlugin","isResourceManagedFilePickerAvailable",[])];case 1:return e=r.sent(),t=Object(s.getAppPreviewFlag)("expandedsavedatasupport"),[2,e&&t]}}))}))},e.loadAndRegisterArrayBufferData=function(t,r){var n=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.CurrentAppInstanceFunctionSingletonKey)().mediaRuntime,a=e.getMediaFileInfo(t);(Core.Utility.isEmptyString(a.mediaUri)||Core.Utility.isEmptyString(a.mimeType))&&Core.Log.error("FileDataProcessor.loadAndRegisterArrayBufferData:",new Error("Invalid mediafile ".concat(t,", mediaUri is ").concat(a.mediaUri,", mimeType is ").concat(a.mimeType)));var o=Core.PABinary.createFromArrayBuffer(r,a.mimeType);n.registerDataBinaryWithRef(o,a.mediaUri)},e.loadAndRegisterBlobsData=function(t,r){var n=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.CurrentAppInstanceFunctionSingletonKey)().mediaRuntime,a=e.getMediaFileInfo(t);(Core.Utility.isEmptyString(a.mediaUri)||Core.Utility.isEmptyString(a.mimeType))&&Core.Log.error("FileDataProcessor.loadAndRegisterArrayBufferData:",new Error("Invalid mediafile ".concat(t,", mediaUri is ").concat(a.mediaUri,", mimeType is ").concat(a.mimeType)));var o=Core.PABinary.createFromBlob(r,a.mimeType);n.registerDataBinaryWithRef(o,a.mediaUri)},e.loadSessionStorageDataAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r;return __generator(this,(function(n){switch(n.label){case 0:n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Core.Utility.cordovaExecAsync("ResourceManagerPlugin","cloneResourceToSessionStore",[e,t])];case 2:return n.sent(),[3,4];case 3:return r=n.sent(),Core.Telemetry.Log.trackActivityEvent("FileDataProcessor.loadSessionStorageDataAsync",{message:"Failed to load session storage Uri '".concat(e,"'"),sessionStorageUrl:e,error:r.message}),[3,4];case 4:return[2]}}))}))},e.SaveMediaAssetsAsync=function(t,r,n,o){return void 0===o&&(o=!1),__awaiter(this,void 0,Promise,(function(){var i,s,c,u,l;return __generator(this,(function(d){switch(d.label){case 0:i={noOfMediaAssetsToBeProcessed:0,noOfMediaAssetsCreated:0,noOfMediaAssetsDeleted:0,noOfMediaAssetsFailedDeletion:0,noOfMediaAssetsSkipped:0,noOfMediaAssetsFailedCreation:0,assetFolder:void 0,assetFileList:[],origAssetFolder:void 0,origAssetFileList:[]},d.label=1;case 1:return d.trys.push([1,5,,6]),o?(s=i,[4,e.loadFolderAsync(a.assetsFolder,r)]):[3,4];case 2:return s.origAssetFolder=d.sent(),c=i,[4,e.loadDataFileAsync(i.origAssetFolder,a.assetsListFileName)];case 3:c.origAssetFileList=d.sent(),i.assetFolder=i.origAssetFolder,d.label=4;case 4:return[3,6];case 5:return d.sent(),Core.Telemetry.Log.trackActivityEvent("FileDataProcessor.SaveMediaAssetsAsync",{message:"Loading original asset list failed.",folderName:r.name}),[3,6];case 6:return[4,e.saveSessionStorageAssetsAsync(t,r,i)];case 7:return d.sent(),[4,e.isExpandedSaveDataSupportedAsync()];case 8:return d.sent()?[4,e.saveAppDataAssetsAsync(t,n,r,i)]:[3,10];case 9:return d.sent(),[3,12];case 10:return[4,e.saveManagedBlobAssetsAsync(t,n,r,i)];case 11:d.sent(),d.label=12;case 12:return i.origAssetFileList.length>0||i.assetFileList.length>0?(u=new Set(__spreadArray(__spreadArray([],i.assetFileList,!0),i.origAssetFileList,!0).map((function(e){return e.filename}))),l=Array.from(u,(function(e){return{filename:e}})),[4,e.saveDataFileAsync(l,i.assetFolder,a.assetsListFileName)]):[3,14];case 13:d.sent(),d.label=14;case 14:return Core.Telemetry.Log.trackActivityEvent("FileDataProcessor.SaveMediaAssetsAsync",{message:"SaveMediaAssetsAsync completed.",assetFileListCount:i.noOfMediaAssetsCreated+i.origAssetFileList.length,noOfMediaAssetsToBeProcessed:i.noOfMediaAssetsToBeProcessed,noOfMediaAssetsCreated:i.noOfMediaAssetsCreated,noOfMediaAssetsSkipped:i.noOfMediaAssetsSkipped,noOfMediaAssetsFailed:i.noOfMediaAssetsFailedCreation,folderName:r.name}),[2,i]}}))}))},e.updateAssetListAsync=function(t,r){return __awaiter(this,void 0,void 0,(function(){var n,o,i,s,c;return __generator(this,(function(u){switch(u.label){case 0:return t.origAssetFileList&&t.origAssetFileList.length>0?t.assetFileList.length>0?[4,e.saveDataFileAsync(t.assetFileList,t.assetFolder,a.assetsListFileName)]:[3,2]:[3,7];case 1:u.sent(),u.label=2;case 2:n=!1,o=function(o){var i;return __generator(this,(function(s){switch(s.label){case 0:if(t.assetFileList.some((function(e){return e.filename===o.filename})))return[3,6];i=o.filename.split("/"),s.label=1;case 1:return s.trys.push([1,3,,6]),[4,e.deleteFileAsync(t.assetFolder,i[i.length-1])];case 2:return s.sent(),t.noOfMediaAssetsDeleted++,[3,6];case 3:return s.sent(),Core.Telemetry.Log.trackActivityEvent("FileDataProcessor.SaveMediaAssetsAsync",{message:"Deleting old unnecessary file failed."}),n?[3,5]:[4,e.saveDataFileAsync("{}",r,a.errorFileName)];case 4:s.sent(),n=!0,s.label=5;case 5:return t.noOfMediaAssetsFailedDeletion++,[3,6];case 6:return[2]}}))},i=0,s=t.origAssetFileList,u.label=3;case 3:return i<s.length?(c=s[i],[5,o(c)]):[3,6];case 4:u.sent(),u.label=5;case 5:return i++,[3,3];case 6:Core.Telemetry.Log.trackActivityEvent("FileDataProcessor.updateAssetListAsync",{message:"updateAssetListAsync completed.",assetFileListCount:t.assetFileList.length,noOfMediaAssetsDeleted:t.noOfMediaAssetsDeleted,noOfMediaAssetsFailedDeletion:t.noOfMediaAssetsFailedDeletion,folderName:r.name}),u.label=7;case 7:return[2]}}))}))},e.saveManagedBlobAssetsAsync=function(t,r,n,o){return __awaiter(this,void 0,void 0,(function(){var c,u,l,d,p,f;return __generator(this,(function(y){switch(y.label){case 0:return(c=Object(s.getManagedBinaryMediaUrlsInData)(t)).length>0?(o.noOfMediaAssetsToBeProcessed+=c.length,o.assetFolder?[3,2]:(u=o,[4,e.createFolderAsync(a.assetsFolder,n)])):[3,6];case 1:u.assetFolder=y.sent(),y.label=2;case 2:l=function(t){var n,a,c;return __generator(this,(function(u){switch(u.label){case 0:return u.trys.push([0,5,,6]),[4,Object(s.getMediaAsBinaryAsync)(t,r)];case 1:return(a=u.sent())?(n=i.ZipPacker.generateMediaPath(t,{contentType:a.contentType,arrayBuffer:null},!0),o.origAssetFileList&&o.origAssetFileList.length>0&&o.origAssetFileList.some((function(e){return e.filename===n}))?(o.assetFileList.push({filename:n}),o.noOfMediaAssetsSkipped++,[2,"continue"]):[4,Object(s.getMediaAsArrayBufferWithContentTypeAsync)(t,r)]):[3,4];case 2:return(c=u.sent())?[4,e.saveArrayBufferFileAsync(c.arrayBuffer,o.assetFolder,n)]:[3,4];case 3:u.sent(),o.assetFileList.push({filename:n}),o.noOfMediaAssetsCreated++,u.label=4;case 4:return[3,6];case 5:return u.sent(),Core.Telemetry.Log.trackActivityEvent("FileDataProcessor.SaveMediaAssetsAsync",{message:"Failed to save Media Uri '".concat(t,"'"),mediaUri:t}),o.noOfMediaAssetsFailedCreation++,[3,6];case 6:return[2]}}))},d=0,p=c,y.label=3;case 3:return d<p.length?(f=p[d],[5,l(f)]):[3,6];case 4:y.sent(),y.label=5;case 5:return d++,[3,3];case 6:return[2]}}))}))},e.saveSessionStorageAssetsAsync=function(t,r,n){return __awaiter(this,void 0,void 0,(function(){var o,i,c,u,l,d,p;return __generator(this,(function(f){switch(f.label){case 0:return(o=Object(s.getSessionStorageMediaUrlsInData)(t)).length>0&&!n.assetFolder?(i=n,(c=n.assetFolder)?[3,2]:[4,e.createFolderAsync(a.assetsFolder,r)]):[3,3];case 1:c=f.sent(),f.label=2;case 2:i.assetFolder=c,f.label=3;case 3:if(!(o.length>0))return[3,7];n.noOfMediaAssetsToBeProcessed+=o.length,u=function(e){var t;return __generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),n.origAssetFileList&&n.origAssetFileList.length>0&&n.origAssetFileList.some((function(t){return t.filename===e}))?(n.assetFileList.push({filename:e}),n.noOfMediaAssetsSkipped++,[2,"continue"]):[4,Core.Utility.cordovaExecAsync("ResourceManagerPlugin","cloneResourceToCollectionStore",[e,n.assetFolder.fullPath])];case 1:return r.sent(),n.assetFileList.push({filename:e}),n.noOfMediaAssetsCreated++,[3,3];case 2:return t=r.sent(),Core.Telemetry.Log.trackActivityEvent("FileDataProcessor.SaveMediaAssetsAsync",{message:"Failed to save session storage Uri '".concat(e,"'"),sessionStorageUrl:e,error:t.message}),n.noOfMediaAssetsFailedCreation++,[3,3];case 3:return[2]}}))},l=0,d=o,f.label=4;case 4:return l<d.length?(p=d[l],[5,u(p)]):[3,7];case 5:f.sent(),f.label=6;case 6:return l++,[3,4];case 7:return[2]}}))}))},e.saveAppDataAssetsAsync=function(t,r,n,o){var u;return __awaiter(this,void 0,Promise,(function(){var l,d,p,f,y,g,h;return __generator(this,(function(m){switch(m.label){case 0:return 0===(l=Object(s.getMediaUrlsInData)(t)).length?[2]:o.assetFolder?[3,2]:(d=o,[4,e.createFolderAsync(a.assetsFolder,n)]);case 1:d.assetFolder=m.sent(),m.label=2;case 2:p=HashTableUtility.create(),o.noOfMediaAssetsToBeProcessed+=Object.keys(l).length,f=function(t){var a,l,d,f,y;return __generator(this,(function(g){switch(g.label){case 0:g.trys.push([0,8,,9]),a=void 0,g.label=1;case 1:return g.trys.push([1,3,,4]),[4,Object(s.getMediaAsBinaryAsync)(t,r)];case 2:return a=g.sent(),[3,4];case 3:return l=g.sent(),Core.Telemetry.Log.trackActivityEvent("FileDataProcessor.saveAppDataAssetsAsync",{message:"Skipping media: failed to resolve media uri to PABinary '".concat(t,"'"),error:l.message,folderName:n.name}),[3,4];case 4:return a?[3,6]:[4,new Promise((function(e){return Object(c.executeImmediatelyAsync)((function(){return e()}))}))];case 5:return g.sent(),o.noOfMediaAssetsSkipped++,[2,"continue"];case 6:return d=null===(u=a.source)||void 0===u?void 0:u.relativeUrl,f="",f=d&&Object(s.isSessionStorageUrl)(d)?d:i.ZipPacker.generateSessionStorageMediaPath(t,{contentType:a.contentType,arrayBuffer:null}),o.origAssetFileList&&o.origAssetFileList.length>0&&o.origAssetFileList.some((function(e){return e.filename===f}))?(o.assetFileList.push({filename:f}),o.noOfMediaAssetsSkipped++,p[t]=f,[2,"continue"]):[4,e.saveMediaAssetAsync(a,o.assetFolder,f)];case 7:return g.sent(),o.assetFileList.push({filename:f}),o.noOfMediaAssetsCreated++,p[t]=f,[3,9];case 8:return y=g.sent(),Core.Telemetry.Log.trackActivityEvent("FileDataProcessor.saveAppDataAssetsAsync",{message:"Failed to save Media Uri '".concat(t,"'"),mediaUri:t,error:y.message,folderName:n.name}),o.noOfMediaAssetsFailedCreation++,[3,9];case 9:return[2]}}))},y=0,g=l,m.label=3;case 3:return y<g.length?(h=g[y],[5,f(h)]):[3,6];case 4:m.sent(),m.label=5;case 5:return y++,[3,3];case 6:return Object.keys(p).length>0&&e.substituteValuesInData(t,p),[2]}}))}))},e.saveMediaAssetAsync=function(t,r,n){var a;return __awaiter(this,void 0,Promise,(function(){var o,i,c;return __generator(this,(function(u){switch(u.label){case 0:return o=n.substring(16),(i=null===(a=t.source)||void 0===a?void 0:a.relativeUrl)&&Object(s.isSessionStorageUrl)(i)?[4,Core.Utility.cordovaExecAsync("ResourceManagerPlugin","cloneResourceToCollectionStore",[i,r.fullPath])]:[3,2];case 1:return u.sent(),[3,6];case 2:return[4,Object(s.getBinaryAsBlobAsync)(t)];case 3:return c=u.sent(),[4,e.saveBlobFileAsync(c,r,o)];case 4:return u.sent(),[4,Core.Utility.cordovaExecAsync("ResourceManagerPlugin","cloneResourceToSessionStore",[n,r.fullPath])];case 5:u.sent(),u.label=6;case 6:return[2]}}))}))},e.substituteValuesInData=function(t,r){if(t&&!AppMagic.Utility.isOpenAjaxControl(t)&&!Object(n.isBlankOrErrorValue)(t))if(Object(n.AppMagicDataDataValue_isDataTable)(t))for(var a=0,o=t.length;a<o;a++)e.substituteValuesInData(t[a],r);else if(Object(n.AppMagicDataDataValue_isDataRecord)(t)){var i=Object.keys(t);for(a=0,o=i.length;a<o;a++){var s=t[i[a]];"string"==typeof s&&r[s]?t[i[a]]=r[s]:e.substituteValuesInData(s,r)}}},e.getJSonUnreferenceStringLength=function(e){if(Object(s.hasOpenAjax)(e)){var t=Object(s.cloneAndFlattenOpenAjax)(e);return this.getJSonStringLength(JSON.stringify(t))}return this.getJSonStringLength(JSON.stringify(e))},e.getJSonStringLength=function(e){for(var t=e.length,r=e.length-1;r>=0;r--){var n=e.charCodeAt(r);n>127&&n<=2047?t++:n>2047&&n<=65535&&(t+=2),n>=56320&&n<=57343&&r--}return t},e.renameSaveDataFolderAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){switch(r.label){case 0:return[4,Core.IO.FileSystem.getUserDataFolderAsync(!0)];case 1:return[4,r.sent().createFolderAsync(t,Core.IO.CreationCollisionOption.OverwriteIfExists)];case 2:return r.sent(),[4,e.renameFolder(t)];case 3:return[2,r.sent()]}}))}))},e.MaxChunkLimit=5242880,e.MinimumRecordsForChunk=10,e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ReadOnlyConnectedDataConnector",(function(){return a})),r.d(t,"ReadOnlyAttachmentConnector",(function(){return o})),r.d(t,"ReadOnlyLookupConnector",(function(){return i})),r.d(t,"ReadOnlyCdsNativeOptionSetConnector",(function(){return s})),r.d(t,"ReadOnlyCdsNativeViewsConnector",(function(){return c})),r.d(t,"ReadOnlyNavigationPagingConnector",(function(){return u})),r.d(t,"ReadOnlyCdsNativeNavigatedRowRetrieverConnector",(function(){return l})),r.d(t,"ReadOnlyCdsNativePolymorphicLookupConnector",(function(){return d})),r.d(t,"ReadOnlyCdpPolymorphicLookupConnector",(function(){return p})),r.d(t,"ReadOnlyUserEntityPrivilegeConnector",(function(){return f})),r.d(t,"ReadOnlyUserRecordPrivilegeConnector",(function(){return y})),r.d(t,"ReadOnlyLocalizedDisplayNameConnector",(function(){return g}));var n=r(8),a=function(){function e(e){this._connector=e}return Object.defineProperty(e.prototype,"isClientPageable",{get:function(){return this._connector.metadata.isClientPagable},enumerable:!1,configurable:!0}),e.prototype.getRowsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(n){switch(n.label){case 0:if("tabularQueryDefinition"!==e.sourceType&&"cdpQueryDefinition"!==e.sourceType&&"cdsQueryDefinition"!==e.sourceType)throw new Core.InvalidOperationError("Query definition needs to be type of {tabular|cdp|cds}QueryDefinition.");return[4,this._connector.getRowsAsync(e,{maxRowCount:null==r?void 0:r.maxRowCount,skip:null==r?void 0:r.skip,errorContext:t,forceDataLimit:null==r?void 0:r.forceDataLimit})];case 1:return[2,n.sent()]}}))}))},e.prototype.getMoreRowsAsync=function(e,t,r,n){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(a){switch(a.label){case 0:return[4,this._connector.getMoreRowsAsync(e,t,r,n)];case 1:return[2,a.sent()]}}))}))},e.prototype.getResultCountAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){switch(r.label){case 0:return[4,this._connector.getResultCountAsync(e.queryOptions,t)];case 1:return[2,r.sent()]}}))}))},e}(),o=function(){function e(e){this._connector=e}return Object.defineProperty(e.prototype,"isClientPageable",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.getRowsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){switch(r.label){case 0:if(e.sourceType!==n.SourceType.AttachmentQueryDefinition)throw new Core.InvalidOperationError("QueryDefinition need to be type of attachment queryDefinition.");return[4,this._connector.getAttachmentsAsync(e.columnName,e.itemKey,t)];case 1:return[2,{results:r.sent(),leftovers:[]}]}}))}))},e.prototype.getMoreRowsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,{results:[]}]}))}))},e.prototype.getResultCountAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,-1]}))}))},e}(),i=function(){function e(e){this._connector=e}return Object.defineProperty(e.prototype,"isClientPageable",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.getRowsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(n){switch(n.label){case 0:if("lookupQueryDefinition"!==e.sourceType)throw new Core.InvalidOperationError("QueryDefinition need to be type of lookup QueryDefinition.");return[4,this._connector.getLookupResultsAsync(e.serviceFunctionName,e.searchText,null==r?void 0:r.maxRowCount,t)];case 1:return[2,n.sent()]}}))}))},e.prototype.getMoreRowsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,{results:[]}]}))}))},e.prototype.getResultCountAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,-1]}))}))},e}(),s=function(){function e(e){this._connector=e}return Object.defineProperty(e.prototype,"isClientPageable",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.getRowsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){if("cdsOptionSetQueryDefinition"!==e.sourceType)throw new Core.InvalidOperationError("QueryDefinition need to be type of CdsOptionSetQueryDefinition.");return[2,this._connector.getOptionSetItemsAsync(e.columnName,t)]}))}))},e.prototype.getMoreRowsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,{results:[]}]}))}))},e.prototype.getResultCountAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,-1]}))}))},e}(),c=function(){function e(e){this._connector=e}return Object.defineProperty(e.prototype,"isClientPageable",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.getRowsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){if("cdsViewsQueryDefinition"!==e.sourceType)throw new Core.InvalidOperationError("QueryDefinition need to be type of CdsViewsQueryDefinition.");return[2,this._connector.getViewsAsync(e.tableName,t)]}))}))},e.prototype.getMoreRowsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,{results:[]}]}))}))},e.prototype.getResultCountAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,-1]}))}))},e}(),u=function(){function e(e,t){this._connector=e,this._firstPageResponse=t}return Object.defineProperty(e.prototype,"isClientPageable",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.getRowsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(n){switch(n.label){case 0:if("cdpNavigatedColumnArrayQueryDefinition"!==e.sourceType&&"cdsNavigatedColumnArrayQueryDefinition"!==e.sourceType)throw new Core.InvalidOperationError("QueryDefinition need to be type of navigatedColumnArray QueryDefinition.");return[4,this._connector.getMoreRowsAsync(this._firstPageResponse,e,null==r?void 0:r.maxRowCount,t)];case 1:return[2,n.sent()]}}))}))},e.prototype.getMoreRowsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(n){switch(n.label){case 0:return[4,this._connector.getMoreRowsAsync(e,t,r)];case 1:return[2,n.sent()]}}))}))},e.prototype.getResultCountAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,-1]}))}))},e}(),l=function(){function e(e,t){this._baseConnector=e,this._targetConnector=t}return Object.defineProperty(e.prototype,"isClientPageable",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.getRowsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){if(e.sourceType!==n.SourceType.CdsNavigatedColumnArrayQueryDefinition)throw new Core.InvalidOperationError("QueryDefinition need to be type of CdsNavigationColumnArrayQueryDefinition.");return[2,this._baseConnector.getNavigatedRowInTableRowAsync(this._targetConnector,e.itemKey,e.columnName,{queryOptions:e.queryOptions,maxPageSize:null==r?void 0:r.maxRowCount})]}))}))},e.prototype.getMoreRowsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(n){return[2,this._baseConnector.getMoreRowsAsync(e,t,r)]}))}))},e.prototype.getResultCountAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,-1]}))}))},e}(),d=function(){function e(e){this._baseConnector=e}return Object.defineProperty(e.prototype,"isClientPageable",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.getRowsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var r,a;return __generator(this,(function(o){switch(o.label){case 0:if(e.sourceType!==n.SourceType.CdsPolymorphicQueryDefinition)throw new Core.InvalidOperationError("QueryDefinition need to be type of CdsPolymorphicLookupQueryDefinition.");return(r={})[e.columnName]=e.key,[4,this._baseConnector.getRowAsync(r,t)];case 1:return a=o.sent(),[2,{results:[a]}]}}))}))},e.prototype.getMoreRowsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,{results:[]}]}))}))},e.prototype.getResultCountAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,-1]}))}))},e}(),p=function(){function e(e){this._baseConnector=e}return Object.defineProperty(e.prototype,"isClientPageable",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.getRowsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var r,a;return __generator(this,(function(o){switch(o.label){case 0:if(e.sourceType!==n.SourceType.CdpPolymorphicQueryDefinition)throw new Core.InvalidOperationError("QueryDefinition need to be type of CdpPolymorphicLookupQueryDefinition.");return(r={})[e.columnName]=e.key,[4,this._baseConnector.getRowAsync(r,t)];case 1:return a=o.sent(),[2,{results:[a]}]}}))}))},e.prototype.getMoreRowsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,{results:[]}]}))}))},e.prototype.getResultCountAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,-1]}))}))},e}(),f=function(){function e(e){this._connector=e}return Object.defineProperty(e.prototype,"isClientPageable",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.getRowsAsync=function(e,t,r){return this._connector.getUserPrivilegeForEntityAsync(e.privilegeName)},e.prototype.getMoreRowsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,{results:[]}]}))}))},e.prototype.getResultCountAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,-1]}))}))},e}(),y=function(){function e(e){this._connector=e}return Object.defineProperty(e.prototype,"isClientPageable",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.getRowsAsync=function(e,t,r){return this._connector.getUserPrivilegeForRecordAsync(e.recordId)},e.prototype.getMoreRowsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,{results:[]}]}))}))},e.prototype.getResultCountAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,-1]}))}))},e}(),g=function(){function e(e){this._connector=e}return Object.defineProperty(e.prototype,"isClientPageable",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.getRowsAsync=function(e,t,r){return this._connector.getLocalizedDisplayNamesAsync(e.tableName,e.columnNames)},e.prototype.getMoreRowsAsync=function(e,t,r){return Promise.resolve({results:[]})},e.prototype.getResultCountAsync=function(e,t){return Promise.resolve(-1)},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"create",(function(){return n})),r.d(t,"createErrors",(function(){return a})),r.d(t,"createSingleError",(function(){return o}));r(0),AppMagic.Data.DataRecord;function n(e,t,r){return t?{serverRow:e,errors:t,errorHttpResponse:r}:{serverRow:e}}function a(e,t){return{errors:e,errorHttpResponse:t}}function o(e,t){return a([e],t)}},function(e,t,r){},function(e,t,r){"use strict";r.r(t),r.d(t,"BadInput",(function(){return n})),r.d(t,"ModelNotFound",(function(){return a})),r.d(t,"GenericError",(function(){return o})),r.d(t,"PrivilegeError",(function(){return i})),r.d(t,"ModelNotShared",(function(){return s})),r.d(t,"NoRoleAssignedError",(function(){return c})),r.d(t,"ModelInvalid",(function(){return u}));var n=1,a=2,o=3,i=4,s=5,c=6,u=7},function(e,t,r){"use strict";r.r(t),r.d(t,"QueryOptions",(function(){return n})),r.d(t,"RecordQueryOptions",(function(){return a})),r.d(t,"TableQueryOptions",(function(){return o})),r.d(t,"ScalarQueryOptions",(function(){return i}));var n=function(){return function(){}}(),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n),i=function(e){function t(t){var r=e.call(this)||this;return r._expectedDType=t,r}return __extends(t,e),Object.defineProperty(t.prototype,"expectedDType",{get:function(){return this._expectedDType},enumerable:!1,configurable:!0}),t}(n)},function(e,t,r){"use strict";r.r(t),r.d(t,"safeCast",(function(){return o})),r.d(t,"isValid",(function(){return i})),r.d(t,"setLastGetRowsResponse",(function(){return s})),r.d(t,"tryGetLastGetRowsResponse",(function(){return c}));var n=r(0),a=r(11);function o(e){return i(e)?e:null}function i(e){return Object(n.isArray)(e)&&Object(a.isValid)(e)}function s(e,t){Object(n.CoreUtility_createOrSetPrivate)(e,"_lastGetRowsResponse_C27BE3E3526A4E55B3A6CE7AA6DBEC7C",t)}function c(e){return e._lastGetRowsResponse_C27BE3E3526A4E55B3A6CE7AA6DBEC7C||null}},function(e,t,r){"use strict";r.r(t),r.d(t,"reportConnectedDataReadOperationErrors",(function(){return i})),r.d(t,"isConnectedDataSource",(function(){return s})),r.d(t,"isCdsDataSource",(function(){return c})),r.d(t,"isTabularDataSource",(function(){return u})),r.d(t,"getNetworkErrorMessageFromResponse",(function(){return l}));var n=r(66),a=r(4),o=r(13);function i(e,t,r){if(void 0===t&&(t=null),e instanceof n.ConnectedDataQueryStringBuilderError)throw e;AppMagic.Data.ErrorValue.isErrorHandlingFeatureEnabled()||(e instanceof o.TabularDataError?e.errorKind!==o.ConnectedDataErrorKind.ComponentDisposed&&(e.serverErrorMessage&&e.serverErrorMessage!==e.message?r.reportRuntimeError(t,Core.Utility.formatString(AppMagic.Strings.ErrorWithServerMessage,e.message,e.serverErrorMessage),e.serverError):r.reportRuntimeError(t,e.message,e.serverError)):r.reportRuntimeError(t,e.message,e))}function s(e){return e&&e.kind===a.DataSourceKind.ConnectedDataSource}function c(e){return e&&e.kind===a.DataSourceKind.CdsNativeDataSource}function u(e){return e&&e.kind===a.DataSourceKind.CdsNativeDataSource||e.kind===a.DataSourceKind.ConnectedDataSource}function l(e){try{var t=JSON.parse(null==e?void 0:e.responseText);if(Core.Utility.isNonEmptyString(null==t?void 0:t.message)){var r=function(e){var t=e.replace(/<\/?[^>]+(>|$)/g,"");return(t=t.replace(/\r/g,"")).replace(/\n/g," ")}(t.message);return Core.Utility.formatString(AppMagic.Strings.NetworkErrorDetails,r)}}catch(e){}return AppMagic.Strings.NetworkError}},function(e,t,r){"use strict";r.r(t),r.d(t,"Expand",(function(){return a}));var n=r(0),a=function(){function e(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._propertyName=e,this._expands=[],this._selects=t||[]}return Object.defineProperty(e.prototype,"expands",{get:function(){return this._expands},set:function(e){this._expands=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selects",{get:function(){return this._selects},set:function(e){this._selects=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"propertyName",{get:function(){return this._propertyName},enumerable:!1,configurable:!0}),e.toExpandsHashTable=function(e){var t=Object(n.HashTableUtility_create)();return e?(e.forEach((function(e){return t[e.propertyName]=e})),t):t},e.toSelectsHashTable=function(e){var t=Object(n.HashTableUtility_create)();return e?(e.forEach((function(e){return t[e]=!0})),t):t},e.prototype.resetSelects=function(e){void 0===e&&(e=null),this._selects=e?[e]:[]},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ODATA_MAX_RESULTS",(function(){return l})),r.d(t,"shouldHandleNavigationQueriedTable",(function(){return d})),r.d(t,"convertToDataSetMetadata",(function(){return p})),r.d(t,"tryGetPrimaryColumnName",(function(){return f})),r.d(t,"getAttributeMetadataAsync",(function(){return y})),r.d(t,"schemaToPcfType",(function(){return b})),r.d(t,"pcfToSchemaType",(function(){return _})),r.d(t,"getIPcfQueryResult",(function(){return C})),r.d(t,"getPrimaryKeyFromTable",(function(){return S})),r.d(t,"getRecordFromDatasource",(function(){return D})),r.d(t,"getRecordId",(function(){return O}));var n=r(0),a=r(64),o=r(77),i=r(4),s=AppMagic.Data.ColumnKind,c=AppMagic.Schema,u=AppMagic.Data.DataEntityRecord,l=500;function d(e){return!Core.FallbackSwitch.isActivated("Controls.DisablePcfNavigationPropSupport")&&!!e.isNavigatedQueriedTable}function p(e,t){return __awaiter(this,void 0,Promise,(function(){var r,a,o,i,s,c,u=this;return __generator(this,(function(l){switch(l.label){case 0:return e?(r=e.tryGetTableMetadata(),a=[],o={},i={},(s=r&&r.columns)?(c=t?s.filter((function(e){return-1!==t.indexOf(e.name)})):s,[4,Object(n.PromiseUtility_join)(c.map((function(t,r){return __awaiter(u,void 0,void 0,(function(){var n,s;return __generator(this,(function(c){switch(c.label){case 0:return a[r]=t.name,n=o,s=a[r],[4,y(e,t)];case 1:return n[s]=c.sent(),function(e,t,r){if(!T(t)||!AppMagic.Data.TabularDataUtilities.isCdsDataSource(r))return;var n=t.targetTableName;if(!n||e.hasOwnProperty(n))return;var a=r.dataset.tryGetCdsDataSourceByLogicalName(n),o=null==a?void 0:a.tryGetTableMetadata();if(!o)return;e[n]={displayName:o.displayName,logicalName:o.name,attributeNames:null,metadata:null,description:null,entityPluralName:o.entitySetName,primaryIdAttribute:o.primaryKeyColumn,primaryImageAttribute:null,primaryNameAttribute:o.primaryNameColumn,privilegesByType:null}}(i,t,e),[2]}}))}))})))]):[3,2]):[2,null];case 1:l.sent(),l.label=2;case 2:return[2,{primaryEntityMetadata:{displayName:r.displayName,logicalName:r.name,attributeNames:a,metadata:o,description:null,entityPluralName:null,primaryIdAttribute:f(s),primaryImageAttribute:null,primaryNameAttribute:null,privilegesByType:null},relatedEntityMetadata:Object.keys(i).length?i:null}]}}))}))}function f(e){if(e&&e.length>0){var t=e.filter((function(e){return e.isPrimaryKey}));if(t.length>0)return t[0].name}return null}function y(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){switch(t.kind){case s.Primitive:return[2,g(t)];case s.Object:return[2,h(t,e)];default:return[2,v(t)]}return[2]}))}))}function g(e){var t=v(e);switch(e.getSchema().type){case c.TypeNumber:var r=t;return r.MaxValue=e.constraints.max,r.MinValue=e.constraints.min,r.ImeMode=null,r;case c.TypeString:var n=t;return n.MaxLength=e.constraints.maxLength,n.ImeMode=null,n.Format=null,n;case c.TypeDate:case c.TypeTime:case c.TypeDateTime:case c.TypeDateTimeNoTimeZone:var a=t;return a.Behavior=null,a.Format=null,a.ImeMode=null,a;default:return t}}function h(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,a,o,i,s,c;return __generator(this,(function(u){switch(u.label){case 0:if(r=v(e),!e.isOptionSet)return[3,6];switch(n=e.optionSetType,n){case AppMagic.Data.OptionSetTypes.BooleanOptionSet:return[3,1]}return[3,3];case 1:return(a=r).DefaultValue=e.defaultValue,[4,t.getChoicesAsync(null,e.name,null)];case 2:return o=(o=u.sent())||e.optionSetValues,a.Options=m(o),[2,a];case 3:return(i=r).DefaultValue=e.defaultValue,[4,t.getChoicesAsync(null,e.name,null)];case 4:return s=(s=u.sent())||e.optionSetValues,i.Options=m(s),[2,i];case 5:return[3,7];case 6:return T(e)?((c=r).Targets=[e.targetTableName],c.ReferencingFieldName=e.referencingFieldName,[2,c]):[2,r];case 7:return[2]}}))}))}function m(e){for(var t=[],r=0;r<e.length;r++)t.push({Value:Object(n.isNumber)(e[r].Value.Id)?e[r].Value.Id:e[r].Value.Id?1:0,Label:e[r].Value.Value,Color:e[r].Value.Color});return t}function v(e){return{LogicalName:e.name,DisplayName:e.extendedMetadata.displayName,IsEditable:!e.isReadOnly,Type:b(e),RequiredLevel:null,Description:null,IsSecured:null,SourceType:null,IsReadable:null}}function b(e){if(e)switch(e.getSchema().type){case c.TypeBoolean:return i.PcfTypes.TwoOptions;case c.TypeCurrency:return i.PcfTypes.Currency;case c.TypeDate:return i.PcfTypes.DateAndTimeDateOnly;case c.TypeTime:case c.TypeDateTime:case c.TypeDateTimeNoTimeZone:return i.PcfTypes.DateAndTime;case c.TypeHyperlink:return i.PcfTypes.SingleLineUrl;case c.TypeImage:case c.TypePenImage:case c.TypeLargeImage:return i.PcfTypes.Image;case c.TypeNumber:return i.PcfTypes.Decimal;case c.TypeOptionSet:switch(e.optionSetType){case AppMagic.Data.OptionSetTypes.BooleanOptionSet:return i.PcfTypes.TwoOptions;case AppMagic.Data.OptionSetTypes.MultiSelectOptionSet:return i.PcfTypes.MultiSelectOptionSet}return i.PcfTypes.OptionSet;case c.TypeString:case c.TypeColor:case c.TypeMedia:case c.TypeError:case c.TypeUnknown:case c.TypeGuid:case c.TypeOptionSetValue:case c.TypePolymorphic:case c.TypeViewValue:return i.PcfTypes.SingleLineText;case c.TypeAttachment:case c.TypeBlob:return e.isImageColumn?i.PcfTypes.Image:i.PcfTypes.File;case c.TypeEntity:return i.PcfTypes.LookupSimple;case c.TypeObjNull:default:return null}else n.Log.trackErrorEvent("CanvasDataProviderHelper_schemaToPcfType",{name:"InvalidValueError",message:"Null column sent for a conversion"})}function _(e){switch(e){case i.PcfTypes.SingleLineText:return c.TypeString;case i.PcfTypes.Decimal:return c.TypeNumber;case i.PcfTypes.DateAndTimeDateOnly:return c.TypeDate;case i.PcfTypes.DateAndTime:return c.TypeDateTime;default:return c.TypeUnknown}}function C(e,t,r,a,o,s,c){var u,d,p,f,y,g,h,m,v;return __awaiter(this,void 0,Promise,(function(){var b,_,C,S,D,O,T,R,w,M,P,F,N,I,x,j;return __generator(this,(function(L){switch(L.label){case 0:return e?(b=null!==(d=null===(u=null==t?void 0:t.pagingDetails)||void 0===u?void 0:u.firstPageNumber)&&void 0!==d?d:1,_=null!==(f=null===(p=null==t?void 0:t.pagingDetails)||void 0===p?void 0:p.lastPageNumber)&&void 0!==f?f:1,C=null!==(g=null===(y=null==t?void 0:t.pagingDetails)||void 0===y?void 0:y.pageSize)&&void 0!==g?g:l,S=_*C,D=null===(h=null==e?void 0:e.dataSource)||void 0===h?void 0:h.kind,O=D&&D!==i.DataSourceKind.CdsNativeDataSource&&!n.FallbackSwitch.isActivated("Controls.DisablePcfCdpMoreRecordDetermination"),[4,E(e,r,o,S,c,O)]):[2,{queryId:null,records:null,hasNextPage:null,sortedRecordIds:null,totalRecordCount:null}];case 1:if(T=L.sent(),AppMagic.Data.DataValue.isErrorValue(T))throw R=AppMagic.Data.ErrorValue.tryGetReportableRuntimeError(T),{errorMessage:null==R?void 0:R.errorMessage,errorCode:null===(m=null==T?void 0:T.errorHttpResponse)||void 0===m?void 0:m.status};return T||(T=[],n.Log.trackWarningEvent("CanvasDataProviderHelper_getIPcfQueryResult",{name:"NullRecordResult",message:"Unexpected null data records returned"})),w=T.length,F=!0,N={dataSourceType:"UNKNOWN",hadMoreResultsThanMax:!1},O?(w>=S&&w%l==1?(M=-1,T.splice(--w)):M=w,P=w,F=!1,N.dataSourceType="CDP"):n.FallbackSwitch.isActivated("Controls.DisablePcfCdsServerRecordCountV2")||null===T.serverRowCount||isNaN(T.serverRowCount)?(F=!1,M=w):(N.dataSourceType="CDS",!0===T.serverRowLimitExceeded?(M=-1,N.hadMoreResultsThanMax=!0):M=T.serverRowCount),n.Log.trackActivityEvent("CanvasDataProviderHelper_getIPcfQueryResult",__assign({name:"DeterminedRowCount"},N)),x={dataSourceType:"UNKNOWN",hadNextPage:!1},O?(I=w>S||-1===M,x.dataSourceType="CDP"):F?(I=(-1===M?5e3:M)>S,x.dataSourceType="CDS"):I=w>0&&w%l==0||w>S,x.hadNextPage=I,n.Log.trackActivityEvent("CanvasDataProviderHelper_getIPcfQueryResult",__assign({name:"HasNextPage"},x)),[4,A(e,T,a,C,b,_,s)];case 2:return j=L.sent(),[2,{queryId:null==t?void 0:t.queryId,records:j.records,hasNextPage:I,sortedRecordIds:j.sortedRecordIds,totalRecordCount:(null===(v=null==t?void 0:t.pagingDetails)||void 0===v?void 0:v.retrieveTotalRecordCount)?M:null,cdpTotalRowCount:P}]}}))}))}function A(e,t,r,n,i,s,c){var l,d;return __awaiter(this,void 0,Promise,(function(){var p,f,y,g,h,m,v,b,_,C,A;return __generator(this,(function(S){switch(S.label){case 0:return p={},f=[],y=Object(a.pageDataRecords)(t,n,i,s),h="",function(e){return"CdsConnector"===(null==e?void 0:e.connectorType)}(m=null===(l=(g=e).dataSource)||void 0===l?void 0:l.connector)?[4,m.getBaseUrlAsync()]:[3,2];case 1:h=S.sent(),S.label=2;case 2:for(v=0;v<(null==y?void 0:y.length);v++)b=y[v],_=(null===(d=g.dataSource)||void 0===d?void 0:d.tryGetPrimaryKey(b))||(b[AppMagic.Constants.Runtime.idProperty]||b[u.entityMetadataPropertyName]||v+n*(i-1)).toString(),C=_,_&&_.startsWith('"')&&_.endsWith('"')&&(C=_.slice(1,-1)),A=new o.DataSetEntityRecord(g.dataSource,b,r,h,c,C),f.push(C),p[C]=A;return[2,{records:p,sortedRecordIds:f}]}}))}))}function S(e){var t,r,n=null===(r=null===(t=null==e?void 0:e.dataSource)||void 0===t?void 0:t.tryGetTableMetadata)||void 0===r?void 0:r.call(t);return f(null==n?void 0:n.columns)}function D(e,t){return e&&(e.find&&e.find((function(e){return e[AppMagic.Constants.Runtime.idProperty]===t||e[AppMagic.Data.DataEntityRecord.entityMetadataPropertyName]===t}))||e[t])||null}function O(e,t){var r=S(t),n=AppMagic.Constants.Runtime.idProperty,a=AppMagic.Data.DataEntityRecord.entityMetadataPropertyName;return(e[r]||e[n]||e[a]||"").toString()}function E(e,t,r,a,o,i){var s,c,u;return __awaiter(this,void 0,Promise,(function(){var p,f,y,g,h,m;return __generator(this,(function(v){switch(v.label){case 0:return(p=e).dataSource?(null===(s=p.dataSource)||void 0===s?void 0:s.isLoaded)?t?(f=Math.ceil(a/l)*l+(i?1:0),y=void 0,d(p)?[4,p.dataSource.getNavigatedQueriedTableAsync(p.record,p.columnName,t)]:[3,2]):[3,6]:[2,[]]:[3,8];case 1:return g=v.sent(),AppMagic.Data.DataValue.isBlankOrErrorValue(g)?[2,g]:(y=g,[3,4]);case 2:return[4,p.dataSource.queryTableAsync(t)];case 3:y=v.sent(),v.label=4;case 4:return[4,y.getNextResultsAsync(null,f,r)];case 5:return[2,v.sent()];case 6:return[2,(null===(c=p.dataSource)||void 0===c?void 0:c.isLoaded)?null===(u=p.dataSource)||void 0===u?void 0:u.data:[]];case 7:return[3,9];case 8:h=e;try{n.FeatureGates_controls.enableLocalPcfFiltering&&(m=AppMagic.Data.ConnectedDataDeserialization.createClientDataProcessingService(),h=m.getFilteredResult(e,t),h=m.getSortedResult(h,t,o))}catch(e){n.CoreLog.errorEx("CanvasDataProviderHelper.getDataRecordsAsync",e)}finally{return[2,h]}v.label=9;case 9:return[2]}}))}))}function T(e){return e.isNavigation}},function(e,t,r){"use strict";r.r(t),r.d(t,"processData",(function(){return i})),r.d(t,"updateEnumerable",(function(){return u})),r.d(t,"parseReplacer",(function(){return p})),r.d(t,"stringfyReplacer",(function(){return f}));var n=r(1),a=r(7),o=(r(23),AppMagic.Data.DataEntityRecordSerialization.LogReporter);function i(e,t){return t||Core.Log.error("ZipPacker.loadZip","Unable to find ".concat(a.entityMetadataFileName," in zip. No records will be converted to a DataEntityRecord instance.")),c(e,t||null,new o)}function s(e,t,r){if(Object(n.AppMagicDataDataRecord_isDataRecord)(e)){if(t&&t.metadata){var a=Object(n.tryDeserializeDataEntityMetadata)(t.metadata,r);a&&Object(n.makeEntityRecord)(e,a)}!function(e,t,r){if(!e)return;HashTableUtility.map(e,(function(e,n){s(e,t?t[n]:null,r)}))}(e,t?t.data:null,r)}else Object(n.AppMagicDataDataTable_isDataTable)(e)&&c(e,t?t.data:null,r)}function c(e,t,r){e&&e.map((function(e,n){s(e,t?t[n]:null,r)}))}function u(e,t){l(e,t)}function l(e,t){e&&e.map((function(e){d(e,t)}))}function d(e,t){Object(n.AppMagicDataDataEntityRecord_isDataEntityRecord)(e)&&Object.defineProperty(e,n.entityMetadataPropertyName,{configurable:!0,enumerable:t,writable:!1}),Object(n.AppMagicDataDataRecord_isDataRecord)(e)?function(e,t){if(!e)return;HashTableUtility.forEach(e,(function(e,r){d(e,t)}))}(e,t):Object(n.AppMagicDataDataTable_isDataTable)(e)&&l(e,t)}function p(e,t,r){if(e!==n.entityMetadataPropertyName)return t;var a=t,o=Object(n.tryDeserializeDataEntityMetadata)(a,r);return Object.freeze(o)}function f(e,t){return e!==n.entityMetadataPropertyName?t:Object(n.getSerializeableDataEntityMetadata)(t)}},function(e,t,r){"use strict";r.r(t),r.d(t,"ValueOperand",(function(){return a}));var n=r(9),a=function(e){function t(t,r){var a=e.call(this,n.OperandKind.Value)||this;return a._value=t,a._dType=r,a}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dType",{get:function(){return this._dType},enumerable:!1,configurable:!0}),__decorate([initializeOnLoad((function(){return[AppMagic.Schema.TypeBoolean,AppMagic.Schema.TypeString,AppMagic.Schema.TypeNumber,AppMagic.Schema.TypeDateTime,AppMagic.Schema.TypeDateTimeNoTimeZone,AppMagic.Schema.TypeHyperlink,AppMagic.Schema.TypeCurrency,AppMagic.Schema.TypeDate,AppMagic.Schema.TypeGuid,AppMagic.Schema.TypeOptionSetValue,AppMagic.Schema.TypeViewValue,AppMagic.Schema.TypeArray,AppMagic.Schema.TypeTable]}))],t,"SupportedDTypes",void 0),t}(n.Operand)},function(e,t,r){"use strict";r.r(t),r.d(t,"safeCast",(function(){return s})),r.d(t,"isValidServiceAttachment",(function(){return c})),r.d(t,"isValidStagedAttachment",(function(){return u})),r.d(t,"isValidAttachment",(function(){return l})),r.d(t,"copyAttachmentTable",(function(){return d})),r.d(t,"createStagedAttachmentRecord",(function(){return p})),r.d(t,"addToAttachmentTable",(function(){return f})),r.d(t,"getStagedAttachments",(function(){return y})),r.d(t,"getDeletedAttachments",(function(){return g})),r.d(t,"isAttachmentTable",(function(){return h})),r.d(t,"deleteAttachment",(function(){return m})),r.d(t,"undoDeleteAttachment",(function(){return v}));var n=r(0),a=AppMagic.Data.DataRecord,o=AppMagic.Data.DataEntityRecord,i=AppMagic.Data.DataTable;function s(e){return l(e)?e:null}function c(e){return l(e)&&o.isDataEntityRecord(e)&&Object(n.isAbsoluteUrlStringOrUndefined)(e.AbsoluteUri)}function u(e){return l(e)&&Object(n.isUndefined)(e.AbsoluteUri)&&!o.isDataEntityRecord(e)}function l(e){return a.isDataRecord(e)&&Object(n.isNonEmptyString)(e.DisplayName)&&Object(n.isNonEmptyStringOrUndefined)(e.Value)&&Object(n.isNonEmptyStringOrUndefined)(e.AbsoluteUri)&&Object(n.isNonEmptyString)(e.Id)}function d(e){var t=e.slice();return e._removedAttachments_EB6CA4531CFA4C09B7390CB79663E8A8&&(t._removedAttachments_EB6CA4531CFA4C09B7390CB79663E8A8=e._removedAttachments_EB6CA4531CFA4C09B7390CB79663E8A8.slice()),t}function p(e,t){return{Value:t,DisplayName:e,Id:Object(n.generate128BitUUID)()}}function f(e,t){t.some((function(t){return t.Id===e.Id}))||t.push(e)}function y(e){return e.filter((function(e){return!c(e)}))}function g(e){return e._removedAttachments_EB6CA4531CFA4C09B7390CB79663E8A8?e._removedAttachments_EB6CA4531CFA4C09B7390CB79663E8A8:[]}function h(e){return i.isDataTable(e)}function m(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r].Id===t){var a=e.splice(r,1)[0];return!o.isDataEntityRecord(a)||(e._removedAttachments_EB6CA4531CFA4C09B7390CB79663E8A8||(e._removedAttachments_EB6CA4531CFA4C09B7390CB79663E8A8=[]),e._removedAttachments_EB6CA4531CFA4C09B7390CB79663E8A8.push(a),!0)}return!1}function v(e,t){for(var r=0,n=e._removedAttachments_EB6CA4531CFA4C09B7390CB79663E8A8.length;r<n;r++)if(e._removedAttachments_EB6CA4531CFA4C09B7390CB79663E8A8[r].Id===t){var a=e._removedAttachments_EB6CA4531CFA4C09B7390CB79663E8A8.splice(r,1)[0];return o.isDataEntityRecord(a)&&e.push(a),!0}return!1}},function(e,t,r){"use strict";r.r(t),r.d(t,"ImportCorruptedZipError",(function(){return n})),r.d(t,"ImportInvalidXMLError",(function(){return a})),r.d(t,"ImportInvalidJSONError",(function(){return o})),r.d(t,"ImportNoSchemaError",(function(){return i})),r.d(t,"ImportXMLNotFoundError",(function(){return s})),r.d(t,"ImportUnknownError",(function(){return c})),r.d(t,"ImportJsonNotFoundError",(function(){return u})),r.d(t,"ExportUpdateError",(function(){return l})),r.d(t,"ExportNullDataError",(function(){return d})),r.d(t,"ExportUnknownError",(function(){return p}));var n="ImportCorruptedZipError",a="ImportInvalidXMLError",o="ImportInvalidJSONError",i="ImportNoSchemaError",s="ImportXMLNotFoundError",c="ImportUnkownError",u="ImportJsonNotFoundError",l="ExportUpdateError",d="ExportNullDataError",p="ExportUnknownError"},function(e,t,r){"use strict";r.r(t),r.d(t,"PropertyOperand",(function(){return a}));var n=r(9),a=function(e){function t(t){var r=e.call(this,n.OperandKind.Property)||this;return r._propertyName=t,r}return __extends(t,e),Object.defineProperty(t.prototype,"propertyName",{get:function(){return this._propertyName},enumerable:!1,configurable:!0}),t}(n.Operand)},function(e,t,r){"use strict";r.r(t),r.d(t,"VariableType",(function(){return n})),r.d(t,"VariableMetadataAction",(function(){return a})),r.d(t,"InspectSubscriptionDictionary",(function(){return i})),r.d(t,"InspectCommandHandler",(function(){return s}));var n,a,o=r(0);!function(e){e[e.Global=0]="Global",e[e.Context=1]="Context",e[e.Collection=2]="Collection"}(n||(n={})),function(e){e.Added="added",e.Removed="removed"}(a||(a={}));var i=function(){function e(){this._valueSubscriptions=Object(o.HashTableUtility_create)(),this._metaSubscriptions=Object(o.HashTableUtility_create)(),this._subscriptionIdIndexes=Object(o.HashTableUtility_create)()}return e.prototype.getItems=function(e,t){var r;return null!==(r=this._getSubscriptions(e)[t])&&void 0!==r?r:[]},e.prototype.addItem=function(e,t,r){var n=this._getSubscriptions(e),a=n[t];a?a.push(r):n[t]=[r],this._subscriptionIdIndexes[r.id]={type:e,key:t}},e.prototype.deleteItem=function(e){if(!this._subscriptionIdIndexes[e])return!1;var t=this._subscriptionIdIndexes[e],r=t.type,n=t.key;delete this._subscriptionIdIndexes[e];var a=this._getSubscriptions(r),o=a[n];if(!o)return!1;var i=o.findIndex((function(t){return t.id===e}));return-1!==i&&(o.splice(i,1),0===o.length&&delete a[n],!0)},e.prototype._getSubscriptions=function(e){return"value"===e?this._valueSubscriptions:this._metaSubscriptions},e}(),s=function(){function e(e){this._runtime=e,this._subscriptionId=1,this._subscriptions=new i}return Object.defineProperty(e.prototype,"command",{get:function(){return"Inspect"},enumerable:!1,configurable:!0}),e.prototype.execute=function(e,t){var r,n=this;try{r=JSON.parse(e)}catch(e){return void t(JSON.stringify(Object(o.getJsonRpcError)(null,o.JsonRpcErrorCode.ParseError,"Parse error")))}if(Array.isArray(r)){if(0===r.length)return void t(JSON.stringify(Object(o.getJsonRpcError)(null,o.JsonRpcErrorCode.InvalidRequest,"Invalid request")));Object(o.PromiseUtility_join)(r.map((function(e){return n._process(e,t)}))).then((function(e){return t(JSON.stringify(e))}))}else this._process(r,t).then((function(e){return t(JSON.stringify(e))}))},e.prototype.onVariableValueChange=function(e,t,r){var a="/variables/".concat(n[e].toLowerCase(),"/").concat(this._encodeVariableName(t));this._subscriptions.getItems("value",a).forEach((function(e){e.callback({value:r})}))},e.prototype.onContextVariableValueChange=function(e,t,r){this.onVariableValueChange(n.Context,"".concat(e,".").concat(t),r)},e.prototype.onVariableMetaChanged=function(e,t,r,a){var o="/variables/".concat(n[e].toLowerCase()),i=t[0];t.length>1&&(o=o.concat("/".concat(i)),i=t[1]);var s=this._subscriptions.getItems("meta",o),c={name:i,changeType:r};a&&(c.type=a),s.forEach((function(e){return e.callback(c)}))},e.prototype.onDataSourceChanged=function(e){var t=this._runtime.dataRuntime.getCollectionDataSource(e);t&&this.onVariableValueChange(n.Collection,e,t)},e.prototype._process=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){switch(r.label){case 0:if(!Object(o.isJsonRpcRequestValid)(e))return[2,Object(o.getJsonRpcError)(null,o.JsonRpcErrorCode.InvalidRequest,"Invalid request")];switch(e.method){case"subscribe":return[3,1];case"get":return[3,2];case"unsubscribe":return[3,4]}return[3,5];case 1:return[2,this._handleSubscribe(e.id,e.params,t)];case 2:return[4,this._handleGet(e.id,e.params)];case 3:return[2,r.sent()];case 4:return[2,this._handleUnsubscribe(e.id,e.params)];case 5:return[2,Object(o.getJsonRpcError)(e.id,o.JsonRpcErrorCode.ServerErrorNotImplemented,"Not implemented")]}}))}))},e.prototype._handleSubscribe=function(e,t,r){if(!t||"string"!=typeof(null==t?void 0:t.path)||"string"!=typeof(null==t?void 0:t.type))return Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"Invalid request");var n=this._splitParamsPath(t.path),a=n[0],i=n[1],s=n[2],c=n.slice(3);if(""!==a||"variables"!==i)return Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"Invalid path");switch(s){case"global":return this._handleSubscribeGlobalVar(e,c,t.type,r);case"context":return this._handleSubscribeContextVar(e,c,t.type,r);case"collection":return this._handleSubscribeCollectionVar(e,c,t.type,r)}return Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.ServerErrorNotImplemented,"Not implemented")},e.prototype._handleSubscribeGlobalVar=function(e,t,r,n){var a=t[0];if("meta"===r){var i=this._subscriptionId++,s={id:i,callback:function(e){n(JSON.stringify(Object(o.getJsonRpcNotification)("notify",{data:e,subscriptionId:i})))}};return this._subscriptions.addItem(r,"/variables/global",s),Object(o.getJsonRpcResult)(e,{subscriptionId:i})}if("value"===r){if(!a)return Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"Invalid variableName");if(void 0===this._runtime.getGlobalVariableValue(a))return Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"variableName doesn't exist");var c=this._subscriptionId++;s={id:c,callback:function(e){n(JSON.stringify(Object(o.getJsonRpcNotification)("notify",{data:e,subscriptionId:c})))}};return this._subscriptions.addItem(r,"/variables/global/".concat(this._encodeVariableName(a)),s),Object(o.getJsonRpcResult)(e,{subscriptionId:c})}return Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"Invalid type")},e.prototype._handleSubscribeContextVar=function(e,t,r,n){var a,i,s=t[0],c=t[1];if("meta"===r){var u="/variables/context";if(s){if(!(f=null===(a=null==(p=this._getNamedControlByDisplayName(s))?void 0:p.OpenAjax)||void 0===a?void 0:a.uniqueId))return Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"contextName doesn't exist");u="/variables/context/".concat(f)}var l=this._subscriptionId++,d={id:l,callback:function(e){n(JSON.stringify(Object(o.getJsonRpcNotification)("notify",{data:e,subscriptionId:l})))}};return this._subscriptions.addItem(r,u,d),Object(o.getJsonRpcResult)(e,{subscriptionId:l})}if("value"===r){if(!s)return Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"Invalid contextName");if(!c)return Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"Invalid variableName");var p,f;if(!(f=null===(i=null==(p=this._getNamedControlByDisplayName(s))?void 0:p.OpenAjax)||void 0===i?void 0:i.uniqueId))return Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"contextName doesn't exist");if(void 0===this._runtime.getAliasValues(f)[c])return Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"variableName doesn't exist");var y=this._subscriptionId++;d={id:y,callback:function(e){n(JSON.stringify(Object(o.getJsonRpcNotification)("notify",{data:e,subscriptionId:y})))}};return this._subscriptions.addItem(r,"/variables/context/".concat(f,".").concat(this._encodeVariableName(c)),d),Object(o.getJsonRpcResult)(e,{subscriptionId:y})}return Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"Invalid type")},e.prototype._handleSubscribeCollectionVar=function(e,t,r,n){var a=t[0];if("meta"===r){var i=this._subscriptionId++,s={id:i,callback:function(e){n(JSON.stringify(Object(o.getJsonRpcNotification)("notify",{data:e,subscriptionId:i})))}};return this._subscriptions.addItem(r,"/variables/collection",s),Object(o.getJsonRpcResult)(e,{subscriptionId:i})}if("value"===r){if(!a)return Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"Invalid variableName");if(!this._runtime.dataRuntime.getCollectionDataSource(a))return Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"variableName doesn't exist");var c=this._subscriptionId++;s={id:c,callback:function(e){n(JSON.stringify(Object(o.getJsonRpcNotification)("notify",{data:e,subscriptionId:c})))}};return this._subscriptions.addItem(r,"/variables/collection/".concat(this._encodeVariableName(a)),s),Object(o.getJsonRpcResult)(e,{subscriptionId:c})}return Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"Invalid type")},e.prototype._handleUnsubscribe=function(e,t){if(!t||"number"!=typeof(null==t?void 0:t.subscriptionId))return Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"Invalid request");var r=t.subscriptionId;return this._subscriptions.deleteItem(r)?Object(o.getJsonRpcResult)(e,1):Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"Invalid subscriptionId")},e.prototype._handleGet=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,a,i,s;return __generator(this,(function(c){switch(c.label){case 0:if(!t||"string"!=typeof(null==t?void 0:t.path)||"string"!=typeof(null==t?void 0:t.type))return[2,Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"Invalid request")];if(r=this._splitParamsPath(t.path),n=r[0],a=r[1],i=r[2],s=r.slice(3),""!==n||"variables"!==a)return[2,Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"Invalid path")];switch(i){case"global":return[3,1];case"context":return[3,3];case"collection":return[3,5]}return[3,6];case 1:return[4,this._handleGetGlobalVar(e,s,t.type)];case 2:return[2,c.sent()];case 3:return[4,this._handleGetContextVar(e,s,t.type)];case 4:return[2,c.sent()];case 5:return[2,this._handleGetCollectionVar(e,s,t.type)];case 6:return[3,7];case 7:return[2,Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.ServerErrorNotImplemented,"Not implemented")]}}))}))},e.prototype._handleGetGlobalVar=function(e,t,r){var n=t[0];return __awaiter(this,void 0,Promise,(function(){var t,a,i;return __generator(this,(function(s){switch(s.label){case 0:return"meta"!==r?[3,2]:(a=o.HashTableUtility_mapToArray,[4,this._runtime.getGlobalVariables()]);case 1:return t=a.apply(void 0,[s.sent(),function(e,t){return{name:t,type:e}}]),[2,Object(o.getJsonRpcResult)(e,{data:{name:"global",type:"globalVariableRoot",children:t}})];case 2:return"value"===r?n?void 0===(i=this._runtime.getGlobalVariableValue(n))?[2,Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"variableName doesn't exist")]:[2,Object(o.getJsonRpcResult)(e,{data:i})]:[2,Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"Invalid variableName")]:[2,Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"Invalid type")]}}))}))},e.prototype._handleGetContextVar=function(e,t,r){var n=t[0],a=t[1];return __awaiter(this,void 0,Promise,(function(){var t,i,s,c;return __generator(this,(function(u){switch(u.label){case 0:return"meta"!==r?[3,4]:(t=function(e,t){return{name:e,children:t?Object(o.HashTableUtility_mapToArray)(t,(function(e,t){return{name:t,type:e}})):[]}},n?this._getNamedControlByDisplayName(n)?[4,this._runtime.getContextVariables([n])]:[2,Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"contextName doesn't exist")]:[3,2]);case 1:return i=u.sent(),[2,Object(o.getJsonRpcResult)(e,{data:t(n,i[n])})];case 2:return[4,this._runtime.getContextVariables()];case 3:return s=u.sent(),[2,Object(o.getJsonRpcResult)(e,{data:{name:"context",type:"contextVariableRoot",children:Object(o.HashTableUtility_mapToArray)(s,(function(e,r){return t(r,e)}))}})];case 4:return"value"===r?n?a?void 0===(c=this._runtime.getContextVariableValue(n,a))?[2,Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"variableName doesn't exist")]:[2,Object(o.getJsonRpcResult)(e,{data:c})]:[2,Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"Invalid variableName")]:[2,Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"Invalid contextName")]:[2,Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"Invalid type")]}}))}))},e.prototype._handleGetCollectionVar=function(e,t,r){var n=t[0];if("meta"===r){var a=this._runtime.dataRuntime.currentApp.dataSources.getCollectionDataSourceNames().map((function(e){return{name:e,type:"table"}}));return Object(o.getJsonRpcResult)(e,{data:{name:"collection",type:"collectionVariableRoot",children:a}})}if("value"===r){if(!n)return Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"Invalid contextName");var i=this._runtime.dataRuntime.getCollectionDataSource(n);return i?Object(o.getJsonRpcResult)(e,{data:i}):Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"variableName doesn't exist")}return Object(o.getJsonRpcError)(e,o.JsonRpcErrorCode.InvalidRequest,"Invalid type")},e.prototype._splitParamsPath=function(e){var t=e.split("/",3),r=t[0],n=t[1],a=t[2],o=e.substr("".concat(r,"/").concat(n,"/").concat(a,"/").length).split("/").reduce((function(e,t,r,n){var a;return e.push((null===(a=n[r-1])||void 0===a?void 0:a.endsWith("\\"))?"".concat(e.pop(),"/").concat(t):t),e}),[]).map(this._decodeVariableName);return __spreadArray([r,n,a],o,!0)},e.prototype._encodeVariableName=function(e){var t={"\\":"\\\\","/":"\\/"};return e.replace(/\\|\//g,(function(e){return t[e]}))},e.prototype._decodeVariableName=function(e){var t={"\\\\":"\\","\\/":"/"};return e.replace(/\\\\|\\\//g,(function(e){return t[e]}))},e.prototype._getNamedControlByDisplayName=function(e){try{return this._runtime.dataRuntime.getNamedControlByDisplayName(e)}catch(e){return}},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"isValidFileDataRecord",(function(){return o})),r.d(t,"isFileDataRecord",(function(){return i})),r.d(t,"isValidImageDataRecord",(function(){return s})),r.d(t,"isImageDataRecord",(function(){return c}));var n=r(0),a=AppMagic.Data.DataRecord;function o(e){return a.isValid(e)&&Object(n.isStringOrNull)(e.FileName)&&Object(n.isNonEmptyString)(e.Value)}function i(e){return o(e)}function s(e){return a.isValid(e)&&Object(n.isStringOrNullOrUndefined)(e.Full)&&Object(n.isNonEmptyString)(e.Value)}function c(e){return s(e)}},function(e,t,r){"use strict";r.r(t),r.d(t,"updateDValueRows",(function(){return s})),r.d(t,"getAsyncFunctions",(function(){return c})),r.d(t,"getFunctions",(function(){return u})),r.d(t,"getDelegatedFunctions",(function(){return l})),r.d(t,"getProjectionAsync",(function(){return p})),r.d(t,"updateRowIfAsync",(function(){return f}));var n=r(0),a=r(1),o=(r(23),r(5)),i=r(106);AppMagic.Data;function s(e,t,r,i,s){for(var c=Object(a.AppMagicDataErrorValue_isErrorValue)(t)?t:null,u=!1,l=0,d=e.length;l<d;++l){var p=e[l];if(Object(a.AppMagicDataErrorValue_isErrorValue)(p)){if(p._errorValue_id_F84D7143755C4438!==(null==c?void 0:c._errorValue_id_F84D7143755C4438))continue}else{if(c)continue;if(!Object(n.deepCompare)(p,t))continue}var f=Object(a.clone)(r,!0,!0);if(null!==f&&(Object(o.addRefBlobs)(f),s.assignRowID(f)),e[l]=f,Object(a.isBlankOrErrorValue)(p)||Object(o.releaseBlobs)(p),u=!0,!i)break}return u}function c(e){return d(e)}function u(e){return d(e)}function l(e){for(var t=[],r=0,n=e.length;r<n;r+=2){var a=e[r],o=e[r+1];if(null===a||null===o)return null;t.push({queryOptions:a,itemFunction:o})}return t}function d(e){for(var t=[],r=0,n=e.length;r<n;r+=2){var a=e[r],o=e[r+1];if(null===a||null===o)return null;t.push({predicate:a,itemFunction:o})}return t}function p(e,t){for(var r=Promise.resolve(null),n=0,a=t.length;n<a;++n)r=r.then(g.bind(this,e,t[n]));return r.then(null,y)}function f(e,t,r,n){var s=e[t],c=null,u=!1;return p(s,r).then((function(e){return null===e?null:e(c=Object(a.clone)(s,!0,!0))})).then((function(e){if(null!==e)if(Object(a.AppMagicDataErrorValue_isErrorValue)(e))u=e;else{var t=Object(i.mergeRecord)(s,e,n);u=!0,Object(o.addRefBlobs)(t),Object(o.releaseBlobs)(c)}})).then((function(){return u}),(function(){return u}))}function y(){return function(){return Object(a.createGatedError)(a.ErrorKind.Unknown,a.ErrorSeverity.Severe)}}function g(e,t,r){return r?Promise.resolve(r):Promise.resolve(t.predicate(e)).then((function(e){return!0===e?t.itemFunction:Object(a.AppMagicDataErrorValue_isErrorValue)(e)?function(){return e}:null})).catch(y)}},function(e,t,r){"use strict";r.r(t),r.d(t,"AppDataSourceError",(function(){return a}));var n=r(0),a=function(e){function t(t){var r=this;return(r=e.call(this,t.message,t.name||"AppMagic.Data.AppDataSourceError")||this)._serverErrorMessage=t.serverErrorMessage||null,r._serverError=t.serverError||null,r._errorClassification=t.errorClassification||null,r._isExpectedError=t.isExpectedError||null,r}return __extends(t,e),t.formatDataSourceError=function(e){return e.serverErrorMessage?Object(n.CoreUtility_formatString)(AppMagic.Strings.ErrorWithServerMessage,e.message,e.serverErrorMessage):e.message},Object.defineProperty(t.prototype,"serverErrorMessage",{get:function(){return this._serverErrorMessage},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serverError",{get:function(){return this._serverError},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"errorClassification",{get:function(){return this._errorClassification},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isExpectedError",{get:function(){return this._isExpectedError},enumerable:!1,configurable:!0}),t}(n.ApplicationError)},function(e,t,r){"use strict";r.r(t),r.d(t,"ExpandQueriedTable",(function(){return c})),r.d(t,"getFirstRowAsync",(function(){return u})),r.d(t,"getAttachmentsAsync",(function(){return l})),r.d(t,"cloneAsync",(function(){return d})),r.d(t,"getNextResultsAsync",(function(){return p})),r.d(t,"getAggregateResultAsync",(function(){return f})),r.d(t,"getCurrentTimeZoneOffsetAsOdataDuration",(function(){return y})),r.d(t,"getResultCountAsync",(function(){return g}));var n=r(0),a=r(1),o=r(4),i=(r(23),r(65)),s=AppMagic.Data,c=function(){function e(e,t,r){this._dataSource=e,this._parentExpand=t,this._queryOptions=r}return Object.defineProperty(e.prototype,"parentExpand",{get:function(){return this._parentExpand},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"queryOptions",{get:function(){return this._queryOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._dataSource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataSourceName",{get:function(){return this._dataSource.name},enumerable:!1,configurable:!0}),e.prototype.getPrimaryKey=function(e){return this._dataSource.getPrimaryKey(e)},e.prototype.tryGetPrimaryKey=function(e){return this._dataSource.tryGetPrimaryKey(e)},e.prototype.cloneAsync=function(){return Promise.resolve(new e(this._dataSource,this._parentExpand,this._queryOptions))},e.prototype.getResultCountAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return this._queryTable?[3,2]:(t=this,[4,this._dataSource.queryTableAsync(this._queryOptions)]);case 1:t._queryTable=r.sent(),r.label=2;case 2:return[2,this._queryTable.getResultCountAsync(e)]}}))}))},e.prototype.getNextResultsAsync=function(e,t,r,n){return __awaiter(this,void 0,Promise,(function(){var a;return __generator(this,(function(o){switch(o.label){case 0:return this._queryTable?[3,2]:(a=this,[4,this._dataSource.queryTableAsync(this._queryOptions)]);case 1:a._queryTable=o.sent(),o.label=2;case 2:return[2,this._queryTable.getNextResultsAsync(e,t,r,n)]}}))}))},e.prototype.getQueryKeyAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return this._queryTable?[3,2]:(e=this,[4,this._dataSource.queryTableAsync(this._queryOptions)]);case 1:e._queryTable=t.sent(),t.label=2;case 2:return[2,this._queryTable.getQueryKeyAsync()]}}))}))},e}();function u(e,t,r,o){return void 0===o&&(o=n.identityFn),__awaiter(this,void 0,Promise,(function(){var n,i,s,c;return __generator(this,(function(u){switch(u.label){case 0:if(!e)return[2,Promise.resolve(Object(a.createGatedError)(a.ErrorKind.InvalidFunctionUsage,a.ErrorSeverity.Severe))];n=function(){return null},u.label=1;case 1:return u.trys.push([1,3,,4]),[4,e.getQueryKeyAsync()];case 2:return i=u.sent(),AppMagic.AuthoringTool.Runtime.currentApp.dataManager.cacheDataChangeManager.register(i,t.entityName+"."+t.propertyName,r),[3,4];case 3:return(s=u.sent())("ExpandQueriedTable.getFirstRowAsync",s,"getQueryKeyAsync failed"),[2,Promise.reject(s)];case 4:return[4,e.getNextResultsAsync(t,1,!0)];case 5:return(c=u.sent())?Object(a.AppMagicDataErrorValue_isErrorValue)(c)?[2,c]:c.length>0?[2,Promise.resolve().then((function(){return o(c[0])})).catch(n)]:[2,null]:[2,null]}}))}))}function l(e,t){if(void 0===t&&(t=null),Object(a.isBlankOrErrorValue)(e))return Promise.resolve(e);var r=Core.Url.tryParse(e);if(!r)return Promise.resolve(null);var n=r.getSegment(a.SegmentIndexes.DataSourceName),i=AppMagic.AuthoringTool.Runtime.currentApp.dataSources.tryGetDataSource(n);if(null===i||i.kind!==o.DataSourceKind.ConnectedDataSource&&i.kind!==o.DataSourceKind.CdsNativeDataSource)return Promise.resolve(Object(a.createGatedError)(a.ErrorKind.Internal,a.ErrorSeverity.Severe,AppMagic.Strings.InvalidDataSourceForFunction,AppMagic.AuthoringTool.Runtime.tryCreateGatedReportRuntimeError({errorContext:t,errorMessage:AppMagic.Strings.InvalidDataSourceForFunction,functionName:null})));var s=r.getSegment(a.SegmentIndexes.ConnectedDataSourceTableName),c=r.getSegment(a.SegmentIndexes.ConnectedDataSourceTableInternalRowId),u=r.getSegment(a.SegmentIndexes.ConnectedDataSourcePropertyName);return i.getAttachmentsAsync(s,c,u,t)}function d(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){return null===e?(n.CoreLog.error("DelegableFunctionUtils.cloneAsync","queryTable is not expected to be null."),[2,Object(a.createGatedError)(s.ErrorKind.Internal,s.ErrorSeverity.Severe)]):[2,e.cloneAsync()]}))}))}function p(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,o,i;return __generator(this,(function(s){switch(s.label){case 0:if(null===e)return[2,Object(a.createGatedError)(a.ErrorKind.Internal,a.ErrorSeverity.Severe)];n=e,s.label=1;case 1:return s.trys.push([1,4,,5]),"function"!=typeof n.getQueryKeyAsync?[3,3]:[4,n.getQueryKeyAsync()];case 2:o=s.sent(),t&&AppMagic.AuthoringTool.Runtime.currentApp.dataManager.cacheDataChangeManager.register(o,t.entityName+"."+t.propertyName,r),s.label=3;case 3:return[2,e.getNextResultsAsync(t,null,!1)];case 4:if((i=s.sent())instanceof AppMagic.Services.ConnectedDataQueryStringBuilderError)return[2,i.errValue];throw i;case 5:return[2]}}))}))}function f(e,t){return e?e.getResultAsync(t):Promise.resolve(Object(a.createGatedError)(a.ErrorKind.Internal,a.ErrorSeverity.Severe))}function y(){var e=(new Date).getTimezoneOffset(),t=Math.abs(e),r=(e<0?"+":"-")+"PT"+Math.floor(t/60)+"H"+t%60+"M";return new i.ConstantOperand(r,i.OdataConstantType.Duration)}function g(e,t){return e?e.getResultAsync(t):Promise.resolve(Object(a.createGatedError)(a.ErrorKind.Internal,a.ErrorSeverity.Severe))}globalScopeObject._df1=u,globalScopeObject._df2=g,globalScopeObject._df3=p,globalScopeObject._df4=f,globalScopeObject._df5=y,globalScopeObject._df6=l,globalScopeObject._df7=d},function(e,t,r){"use strict";r.r(t),r.d(t,"TabularDataSource",(function(){return V}));var n,a,o=r(38),i=r(2),s=r(34),c=r(5),u=r(72),l=r(35),d=r(29),p=r(10),f=r(14),y=r(4),g=r(74),h=r(23),m=r(33),v=r(91),b=r(19),_=r(108),C=r(85),A=r(16),S=r(8),D=r(22),O=r(18),E=r(13),T=r(24),R=AppMagic.Data.ErrorValue,w=AppMagic.Data.ErrorKind,M=AppMagic.Data.ErrorSeverity,P=AppMagic.Data.DataRecord,F=AppMagic.Data.DataEntityRecord,N=AppMagic.Data.DataTable,I=AppMagic.Data.TableMetadata,x=AppMagic.Data,j=AppMagic.Services,L=AppMagic.AppResourceUri,U=AppMagic.Common,k=Core.Diagnostics.MonitorLogLevel;!function(e){e[e.Create=0]="Create",e[e.Delete=1]="Delete",e[e.Patch=2]="Patch",e[e.Replace=3]="Replace",e[e.Refresh=4]="Refresh",e[e.Lookup=5]="Lookup"}(n||(n={})),function(e){e[e.NotModified=0]="NotModified",e[e.Changed=1]="Changed",e[e.Deleted=2]="Deleted",e[e.Cancelled=3]="Cancelled",e[e.NetworkError=4]="NetworkError"}(a||(a={}));var V=function(e){function t(r,n,a,o,i,s,c,u,l){var d=e.call(this,r,n,a,s)||this;return d._primaryTable=i,d._errors=HashTableUtility.create(),d._missingKeyErrors=null,d._fullErrorTable=null,d._refreshDataJob=null,d._loadingInitialDataJob=null,d._maxGetRowsCount=u,d._isDataLoaded=!1,d._memStorage=new v.MemoryStorage,d._primaryConnector=o,d._queryDataProvider=c,d._logEtagDifference=!0,d._lazyReadOnlyPrimaryConnector=new Core.Lazy((function(){return new O.ReadOnlyConnectedDataConnector(d._primaryConnector)})),d._lazyDefaultQueryOption=new Core.Lazy((function(){if(d.primaryTable.capabilities.isSelectable&&l){var e=new D.TableQueryOptions;return 0===l.length?(e.skipCall=!0,e):(e.selects=l,t._ensureKeysAreSelected(d.primaryTable,e),e)}})),d._lazyReadOnlyPrimaryAttachmentConnector=new Core.Lazy((function(){return new O.ReadOnlyAttachmentConnector(d._primaryConnector)})),d}return __extends(t,e),t._ensureKeysAreSelected=function(e,t){var r=e.tempKeyColumn?e.tempKeyColumn.name:"";e.keyColumns.forEach((function(e){e.name===r||t.selects.some((function(t){return t===e.name}))||t.selects.push(e.name)}))},t._cloneColumn=function(e,t,r){var n=e.name,a=t[n];Core.Utility.isNullOrUndefined(a)||(r[n]=AppMagic.Utility.clone(a,!0,!0))},Object.defineProperty(t.prototype,"primaryTable",{get:function(){return this._primaryTable.value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDataLoaded",{get:function(){return this._isDataLoaded},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canUserReadAsync",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canUserEditAsync",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canUserCreateAsync",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canUserDeleteAsync",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDelegable",{get:function(){return this.primaryTable.capabilities.isDelegable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPagable",{get:function(){return this.primaryTable.capabilities.isPagable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRefreshable",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connector",{get:function(){return this._primaryConnector},enumerable:!1,configurable:!0}),t.prototype.maxGetRowsCount=function(){return this._maxGetRowsCount},t.prototype.setMaxGetRowsCount=function(e){return this._maxGetRowsCount=e,!0},Object.defineProperty(t.prototype,"_dataTableInternal",{get:function(){return this.isLoaded||Core.Log.verbose("TabularDataSource[{0}]: tried to access data on unloaded datasource.",this.name),this.dataTableInternal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_byPassLocalCacheValidation",{get:function(){return this.isDelegable||this.isPagable},enumerable:!1,configurable:!0}),t.prototype.waitForLoadingInitialDataAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this._loadingInitialDataJob?[4,this._loadingInitialDataJob.waitAsync()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.waitForRefreshDataJobAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this._refreshDataJob?[4,this._refreshDataJob.waitAsync()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype._handleGetChoicesError=function(e,t){Core.PromiseUtils.throwIfCanceled(e),Object(T.reportConnectedDataReadOperationErrors)(e,t,this.dataRuntime),Core.Log.errorEx("TabularDataSource.getChoicesAsync",e.message,{error:e});var r=Object(E.tryConvertErrorToErrorValue)(t,e,AppMagic.Strings.NetworkErrorDetails,"Choices");return r||x.ErrorValue.createGatedError(x.ErrorKind.Unknown,x.ErrorSeverity.Severe)},t.prototype._isValid=function(){switch(this.stage){case Core.LifeCycleStage.Constructed:case Core.LifeCycleStage.Initialized:case Core.LifeCycleStage.Loaded:}return!0},t.prototype._addDefaultProjectionToOptions=function(e){var r=this._lazyDefaultQueryOption.value;return r?e?r.skipCall?(e.skipCall=!0,e):e.selects?(t._ensureKeysAreSelected(this.primaryTable,e),e):(e.selects=r.selects,e):r:e},t.prototype.queryTableAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,n=this;return __generator(this,(function(a){switch(a.label){case 0:return e=this._addDefaultProjectionToOptions(e),[4,this._createTabularCachableQueryAsync(e)];case 1:return t=a.sent(),r=[t],Core.FallbackSwitch.isActivated("AppConnectivity.splitCallsIfExpandsMoreThanLimit")?[3,3]:[4,this.trySplitExpandsQueryOptionsAsync(t)];case 2:r=a.sent(),a.label=3;case 3:return[2,new C.QueriedTable(this._lazyReadOnlyPrimaryConnector,this,this.dataRuntime,this._queryDataProvider,r,(function(e){return n._processQueriedRecord(e)}))]}}))}))},t.prototype.trySplitExpandsQueryOptionsAsync=function(e){var t,r;return __awaiter(this,void 0,Promise,(function(){var n,a,o,i,s,c,u,l,d,p;return __generator(this,(function(f){switch(f.label){case 0:n=[e],f.label=1;case 1:return f.trys.push([1,6,7,8]),o=this.name,[4,e.getKeyAsync()];case 2:return a=o+f.sent(),this._queryDataProvider.getSplitExpandsForQuery(a)?(i=null===(t=e.queryDefinition)||void 0===t?void 0:t.queryOptions,s=__assign({},i),c=null===(r=null==i?void 0:i.expands)||void 0===r?void 0:r.length,u=c?Math.floor(c/2):0,i.expands=s.expands.splice(0,u),i=this._addDefaultProjectionToOptions(i),s=this._addDefaultProjectionToOptions(s),[4,this._createTabularCachableQueryAsync(i)]):[3,5];case 3:return l=f.sent(),[4,this._createTabularCachableQueryAsync(s)];case 4:d=f.sent(),n=[l,d],Core.Telemetry.Log.trackActivityEvent("TabularDataSource.trySplitExpandsQueryOptionsAsync",{message:"splitting expands query options",expandsCount:c,datasourceName:this.name}),Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.Function,"Value",{expandsCount:c,datasourceName:this.name,info:AppMagic.Strings.ExpandsLimitSplitQueryOptions},Core.Diagnostics.MonitorLogLevel.Info),f.label=5;case 5:return[3,8];case 6:return p=f.sent(),this._logError("TabularDataSource.trySplitExpandsQueryOptionsAsync",p),[3,8];case 7:return[2,n];case 8:return[2]}}))}))},t.prototype.queryScalarAsync=function(e){return Promise.resolve(new _.QueriedScalar(this.connector,this.dataRuntime,e))},t.prototype.tryGetTableMetadata=function(){return this.primaryTable},t.prototype._processQueriedRecord=function(e){var t=this.primaryTable.getPrimaryKey(e),r=this._memStorage.getEntry(t),n=this._dataTableInternal;if(n)return null===r?(this._memStorage.add(t,e),void n.push(this._serverRowToClientRow(e))):void(this._areRecordsEqual(r.value,e,t)||(r.value=e,this.isDelegable||Object(c.releaseBlobs)(n[r.index]),n[r.index]=this._serverRowToClientRow(e)))},t.prototype._areRecordsEqual=function(e,t,r){var n=AppMagic.Utility.deepCompare(e,t);if(n&&x.DataEntityRecord.isDataEntityRecord(e)&&x.DataEntityRecord.isDataEntityRecord(t)){var a=x.DataEntityRecord.tryGetETag(e),o=x.DataEntityRecord.tryGetETag(t);if(a&&o){var i=a===o;n=n&&i,!i&&this._logEtagDifference&&(Core.Telemetry.Log.trackActivityEvent("TabularDataSource._areRecordsEqual",{message:"Records are equal except for their etags value. Only the first occurrence of this kind of event will be logged for this datasoruce.",etagFirst:a,etagSecond:o,itemId:Core.Telemetry.Utility.scrubSensitiveDataSafe(r),datasourceName:this.name}),this._logEtagDifference=!1)}}return n},t.prototype.refreshAsync=function(t,r){var n=this;if(void 0===t&&(t=null),void 0===r&&(r=!1),!this.isDataAvailable){try{throw new Error("Refresh is called when datasource is in stage: ".concat(Core.LifeCycleStage[this.stage],"."))}catch(e){this._logError("TabularDataSource.refreshAsync",e)}if(this.stage===Core.LifeCycleStage.Disposed)return Promise.resolve(!1)}return this._loadingInitialDataJob?(this._logVerbose("TabularDataSource.refreshAsync","loading initial data is in progress. Skipping refresh."),this._loadingInitialDataJob.waitAsync().then((function(){return!0}),(function(){return!1}))):this._refreshDataJob?(this._logVerbose("TabularDataSource.refreshAsync","a refresh job is already in progress. Using that job."),this._refreshDataJob.waitAsync()):(this._logVerbose("TabularDataSource.refreshAsync","Starting a new refresh job."),this._refreshDataJob=new Core.AsyncOperation("TabularDataSource._refreshDataJob",(function(){var a=n._refreshCoreAsync(t).then((function(){if(!r)return e.prototype._onDataChangedAsync.call(n)})).then((function(){return r||n._onDataChanged(),!0}),(function(e){return Core.Utility.isCanceledError(e)||(n._logError("TabularDataSource.refreshAsync",e,"Exception in _refreshCoreAsync"),Object(T.reportConnectedDataReadOperationErrors)(e,t,n.dataRuntime)),!1}));return Core.PromiseUtils.wrapWithFinally(a,(function(){n._refreshDataJob=null}))}),{startOnWait:!0}),this._refreshDataJob.waitAsync().catch((function(e){return n._logError("TabularDataSource.refreshAsync",e,"Exception in _refreshDataJob"),!1})))},t.prototype.cleanInternalDataSource=function(e){var t=this._memStorage.getAll().map((function(e){return e.index}));if(this._clearMissingKeyErrors(),e&&e.length>0)for(var r=0,n=e.length;r<n;++r){var a=e[r],o=this.primaryTable.getPrimaryKey(a),i=this._memStorage.getEntry(o);null!==i?(t[i.index]=-1,AppMagic.Utility.deepCompare(i.value,a)||(i.value=a,this.isDelegable||Object(c.releaseBlobs)(this._dataTableInternal[i.index]),this._dataTableInternal[i.index]=this._serverRowToClientRow(a))):(this._memStorage.add(o,a),this._dataTableInternal.push(this._serverRowToClientRow(a)))}(t=t.filter((function(e){return e>=0}))).length>0&&this._deleteRowsInDataSourceByIndex(t),this._isDataLoaded=!0},t.prototype.refreshCoreCommonAsync=function(e,t){var r=this,n=this.dataRuntime.startAsyncDataAction(),a=this.connector.getRowsAsync(e,{maxRowCount:this._maxGetRowsCount,errorContext:t}).then((function(e){var t=e.results;Core.Utility.isNullOrUndefined(r._dataTableInternal)||(Object(h.setLastGetRowsResponse)(r._dataTableInternal,e),Core.Log.verbose("TabularDataSource[{0}]: _refreshCoreAsync - received {1} row(s)",r.name,t.length),r.cleanInternalDataSource(t))})).catch((function(e){if(Core.PromiseUtils.throwIfCanceled(e),e instanceof l.AppDataSourceError)throw e;throw r._logError("TabularDataSource._refreshCoreAsync",e,"Error not an instance of AppDataSourceError. Throwing a new error for dataflow."),new l.AppDataSourceError({message:AppMagic.Strings.ConnectedDataUnknownError})}));return Core.PromiseUtils.wrapWithFinally(a,(function(){return r.dataRuntime.endAsyncDataAction(n)}))},t.prototype.collectAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,a,o,i,s,c,u,l,d,p,f,g,h,m=this;return __generator(this,(function(v){for(Core.Log.verbose("TabularDataSource[{0}]: collectAsync",this.name),r=this.dataRuntime.startAsyncDataAction(),n=[],a=new Core.PromiseUtils.PromiseQueue("collectAsync"),o=[],p=0,f=t.length;p<f;++p)if(g=t[p],!Core.Utility.isNullOrUndefined(g))if(P.isValid(g))o.push(g);else for(s=0,c=(i=g).length;s<c;++s)u=i[s],P.isValid(u)&&o.push(u);for(this.kind===y.DataSourceKind.CdsNativeDataSource&&Core.FeatureGates.services.enableOdataBatch&&(d="batch_".concat(Core.Utility.generate128BitUUID()),l={batchId:d,totalRequests:o.length}),p=0,f=o.length;p<f;++p)g=o[p],l?n.push(this._createRowCoreAsync(g,null,l)):n.push(a.pushJob(this._createRowCoreAsync.bind(this,g,null)));return Core.Log.verbose("TabularDataSource[{0}]: collectAsync - attempting to add {1} row(s)",this.name,n.length),h=Core.PromiseUtils.join(n).then((function(t){return __awaiter(m,void 0,void 0,(function(){var r,n;return __generator(this,(function(a){switch(a.label){case 0:return(r=this._processCollectRowResult(e,t)).changed?[4,this._processOnDataChangeAsync()]:[3,2];case 1:a.sent(),a.label=2;case 2:return AppMagic.Data.ErrorValue.isErrorHandlingFeatureEnabled()&&(null===(n=r.resultErrors)||void 0===n?void 0:n.length)?[2,AppMagic.Data.ErrorValue.normalizeErrors(r.resultErrors)]:[2,this.dataTableInternal]}}))}))})),[2,Core.PromiseUtils.wrapWithFinally(h,(function(){return m.dataRuntime.endAsyncDataAction(r)}))]}))}))},t.prototype._processCollectRowResult=function(e,t){for(var r=null,n=[],a=this._clearMissingKeyErrors()||t.length>0,o=0,i=t.length;o<i;++o){var s=t[o];if(R.isErrorValue(s))n.push(s);else if(s.serverRow&&!AppMagic.Data.DataValue.isErrorValue(s.serverRow))this._addRowToDataSource(s.serverRow);else if(null===r&&(r=N.createTyped()),r.push.apply(r,s.errors),AppMagic.Data.ErrorValue.isErrorHandlingFeatureEnabled()){var c=this._tryCreateErrorFromDataOperationResult(e,"Collect",s,AppMagic.Strings.NetworkErrorCollect);c&&n.push(c)}}return Core.Log.verbose("TabularDataSource[{0}]: collectAsync - {1}/{2} row(s) added successfully",this.name,t.length-(r?r.length:0),t.length),this._setMissingKeyErrors(r),{changed:a,resultErrors:n}},t.prototype._tryCreateErrorFromDataOperationResult=function(e,t,r,n){var a;if(null===(a=r.errors)||void 0===a?void 0:a.length){var o=r.errors[0],i=Core.Utility.formatString(n,o.Message||""),s=AppMagic.AuthoringTool.Runtime.tryCreateGatedReportRuntimeError({errorContext:e,errorMessage:i,skipDisplayRuntimeError:!0,functionName:t});return AppMagic.Data.ErrorValue.createError(o.Error,AppMagic.Data.ErrorSeverity.Severe,i,s,r.errorHttpResponse)}return null},t.prototype._createRowAsync=function(e,t){return void 0===t&&(t=null),__awaiter(this,void 0,Promise,(function(){var r,n,a,o;return __generator(this,(function(i){switch(i.label){case 0:r=this.dataRuntime.startAsyncDataAction(),i.label=1;case 1:return i.trys.push([1,,6,7]),[4,this._createRowCoreAsync(e,t)];case 2:return n=i.sent(),R.isErrorValue(n)?[2,n]:(a=n.serverRow,R.isGatedErrorOrUndefined(a)?[3,4]:(Core.Log.verbose("TabularDataSource[{0}]: _createRowAsync - row created",this.name),o=this._addRowToDataSource(a),this._clearMissingKeyErrors(),[4,this._processOnDataChangeAsync()]));case 3:return i.sent(),[2,Object(b.create)(o)];case 4:return Core.Log.verbose("TabularDataSource[{0}]: _createRowAsync - create request had errors",this.name),this._setMissingKeyErrors(n.errors),[4,this._processOnDataChangeAsync()];case 5:return i.sent(),[2,Object(b.create)(null,n.errors,n.errorHttpResponse)];case 6:return this.dataRuntime.endAsyncDataAction(r),[7];case 7:return[2]}}))}))},t.prototype._createRowCoreAsync=function(e,t,r){var n;return void 0===t&&(t=null),__awaiter(this,void 0,Promise,(function(){var a,o,i,s,c,u,l,d;return __generator(this,(function(y){switch(y.label){case 0:a={attachmentUpdates:[],fileUpdates:[],errors:null,hasServerGeneratedKeys:!1},o=this.primaryTable.columns,i=0,s=o.length,y.label=1;case 1:return i<s?(c=o[i],[4,this._processColumnForCreateAsync(e,c,a)]):[3,4];case 2:if(u=y.sent(),R.isErrorValue(u))return[2,u];y.label=3;case 3:return++i,[3,1];case 4:if(!a.hasServerGeneratedKeys&&this.primaryTable.hasValidPrimaryKey(e)&&this._doesRowExist(e)&&(this._logWarning("TabularDataSource._createRowCoreAsync","Attempted to create an existing row."),a.errors=Object(f.add)(a.errors,Object(p.rowExists)())),null!==a.errors)return[2,Promise.resolve(Object(b.createErrors)(a.errors))];y.label=5;case 5:return y.trys.push([5,7,,8]),[4,this.submitCreateRow(e,a,t,r)];case 6:return[2,y.sent()];case 7:return l=y.sent(),Core.PromiseUtils.throwIfCanceled(l),this._logError("TabularDataSource._createRowCoreAsync",l),d=Object(p.fromConnectorError)(l,w.CreatePermission),[2,Object(b.createSingleError)(d,null===(n=l.serverError)||void 0===n?void 0:n.response)];case 8:return[2]}}))}))},t.prototype.submitCreateRow=function(e,t,r,n){return __awaiter(this,void 0,Promise,(function(){var a,o,i;return __generator(this,(function(s){switch(s.label){case 0:return[4,this.connector.createRowAsync(e,r,n)];case 1:return a=s.sent(),o=Object(b.create)(a),[4,this._processAttachmentsAsync(t.attachmentUpdates,a,o,r)];case 2:return i=s.sent(),[2,this._processFilesAsync(t.fileUpdates,a,i,r)]}}))}))},t.prototype._isFileColumn=function(e){return e.isFileColumn||e.isImageColumn},t.prototype._processColumnForCreateAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,a,o,i;return __generator(this,(function(s){switch(s.label){case 0:return n=t.name,a=e[n],t.creation===AppMagic.Data.CreationKind.ServerGenerated?(t.isPrimaryKey&&(r.hasServerGeneratedKeys=!0),Core.Utility.isValue(a)&&(this._logWarning("TabularDataSource._processColumnForCreateAsync","Server generated column should not have a value."),o=Object(p.columnGenerated)(null,n),r.errors=Object(f.add)(r.errors,o)),[2,null]):(i=t.constraints.validateForCreate(a,n),R.isErrorValue(i)?[2,i]:null!==i||!t.isFileColumn&&!t.isImageColumn?[3,2]:[4,this._validateFileAsync(t,a)]);case 1:i=s.sent(),s.label=2;case 2:if(null!==i)return r.errors=this._processCreateValidationResult(i[0],r.errors,n),[2,null];if(Core.Utility.isNullOrUndefined(a))return delete e[n],[2,null];if(t.isPolymorphic){if(delete e[n],!this._tryBindPolymorphic(null,e,t,a,r.errors))return[2,null]}else if(t.isNavigation&&!this._tryBindNavigation(e,a,n,r.errors))return[2,null];return this._postProcessEditColumn(e,n,t),t.isAttachmentColumn?this._tryCreateListOfAttachmentsToUpdate(e,t,r.attachmentUpdates):this._isFileColumn(t)&&this._tryCreateListOfFilesToUpdate(e,t,r.fileUpdates),[2,null]}}))}))},t.prototype._tryCreateListOfFilesToUpdate=function(e,r,n){var a=e[r.name];return t._skipCreateForFileImageColumn(a,r)?(delete e[r.name],!1):(n.push({columnName:r.name,file:a}),delete e[r.name],!0)},t._skipCreateForFileImageColumn=function(e,r){return!!(!e||r.isFileColumn&&!t.isFileChanged(r.name,null,e)||r.isImageColumn&&!t.isImageChanged(r.name,null,e))},t.prototype._tryCreateListOfAttachmentsToUpdate=function(e,t,r){var n=e[t.name];if(!n)return delete e[t.name],!1;if(!Object(d.isAttachmentTable)(n)){delete e[t.name];var a="string"==typeof n?n:JSON.stringify(n);return this._logError("TabularDataSource._tryCreateListOfAttachmentsToUpdate",Core.Utility.throwInline(new Error("Attachment column has an invalid value: ".concat(a)))),!1}var o=Object(d.getStagedAttachments)(n);return o.length>0&&r.push({columnName:t.name,newItems:o,removedItems:[]}),delete e[t.name],!0},t.prototype._processCreateValidationResult=function(e,t,r){this._logWarning("TabularDataSource._processCreateValidationResult","Row failed client validation.");var n=Object(p.columnValueInvalid)(null,r,e.message,e.error);return Object(f.add)(t,n)},t.prototype._processOnDataChangeAsync=function(){return this._onDataChanged(),this._onDataChangedAsync()},t.prototype.updateAsync=function(e,t,r,n){return void 0===r&&(r=null),__awaiter(this,void 0,Promise,(function(){var n,a,o,i,s,c,u,l,d,f,y;return __generator(this,(function(h){switch(h.label){case 0:return Core.Log.verbose("TabularDataSource[{0}]: updateAsync",this.name),this.primaryTable.hasValidPrimaryKey(e)?[3,2]:(Core.Log.verbose("TabularDataSource[{0}]: updateAsync - invalid key",this.name),this._setMissingKeyError(Object(p.rowNotFound)()),[4,this._processOnDataChangeAsync()]);case 1:return h.sent(),[2,this._dataTableInternal];case 2:if(n=this.primaryTable.getPrimaryKey(e),null!==(a=this._memStorage.getEntry(n)))return[3,11];if(!this._byPassLocalCacheValidation)return[3,9];if(o=this.primaryTable.columns,i=this._validateServerRow(o,t,e),R.isErrorValue(i))return[2,i];if(null!==i)return[2,this._dataTableInternal];s=Object(g.clone)(t),h.label=3;case 3:return h.trys.push([3,5,6,8]),[4,this.connector.replaceRowAsync(e,s,r)];case 4:return h.sent(),[3,8];case 5:return c=h.sent(),R.isErrorHandlingFeatureEnabled()&&(y=Object(E.tryConvertErrorToErrorValue)(r,c,AppMagic.Strings.NetworkErrorRemove,"Update",w.Network))?[2,y]:(this._logError("TabularDataSource.updateAsync",c,"Suppressing error."),[3,8]);case 6:return[4,this._processOnDataChangeAsync()];case 7:return h.sent(),[7];case 8:return[2,this._dataTableInternal];case 9:return Core.Log.verbose("TabularDataSource[{0}]: updateAsync - row not found",this.name),u=Object(p.rowNotFound)(),this._setMissingKeyError(u),[4,this._processOnDataChangeAsync()];case 10:return h.sent(),R.isErrorHandlingFeatureEnabled()?(l=u.Message,d={errorContext:r,errorMessage:l,raiseToastNotification:!1,wasReported:!1,functionName:"Update"},[2,y=R.createError(u.Error,M.Severe,l,d)]):[2,this._dataTableInternal];case 11:return null===t?(Core.Log.verbose("TabularDataSource[{0}]: updateAsync - new row not provided",this.name),[2,this._dataTableInternal]):[4,this._updateRowAsync(a,e,t,r)];case 12:if(f=h.sent(),R.isErrorValue(f))return[2,f];if(R.isErrorHandlingFeatureEnabled()){if(y=this._tryCreateErrorFromDataOperationResult(r,"Update",f,AppMagic.Strings.NetworkErrorUpdate))return[2,y]}else this._reportAnyRuntimeErrors(f,r);return[2,this._dataTableInternal]}}))}))},t.prototype._updateRowAsync=function(e,t,r,n){return void 0===n&&(n=null),__awaiter(this,void 0,Promise,(function(){var t,a,o,i,s;return __generator(this,(function(c){switch(c.label){case 0:t=this.dataRuntime.startAsyncDataAction(),c.label=1;case 1:return c.trys.push([1,,10,11]),[4,this._updateRowCoreAsync(e,r,n)];case 2:return a=c.sent(),R.isErrorValue(a)?[2,a]:(o=this._clearMissingKeyErrors(),null!==a?[3,5]:(Core.Log.verbose("TabularDataSource[{0}]: _updateRowAsync - row not changed",this.name),this._clearErrorsForKey(e.key)||o?[4,this._processOnDataChangeAsync()]:[3,4]));case 3:c.sent(),c.label=4;case 4:return[2,Object(b.create)(this._dataTableInternal[e.index])];case 5:return(i=a.serverRow)?(Core.Log.verbose("TabularDataSource[{0}]: _updateRowAsync - row updated",this.name),s=this._updateRowInDataSource(e,i),[4,this._processOnDataChangeAsync()]):[3,7];case 6:return c.sent(),[2,Object(b.create)(s)];case 7:return Core.Log.verbose("TabularDataSource[{0}]: _updateRowAsync - patch request had errors",this.name),this._setErrorsForKey(e.key,a.errors),[4,this._processOnDataChangeAsync()];case 8:return c.sent(),[2,Object(b.create)(this._dataTableInternal[e.index],a.errors,a.errorHttpResponse)];case 9:return[3,11];case 10:return this.dataRuntime.endAsyncDataAction(t),[7];case 11:return[2]}}))}))},t.prototype._updateRowCoreAsync=function(e,t,r){return void 0===r&&(r=null),__awaiter(this,void 0,Promise,(function(){var n,a,o,i=this;return __generator(this,(function(s){return n=this.primaryTable.columns,a=this._validateServerRow(n,t,e.value),R.isErrorValue(a)?[2,a]:null!==a?[2,Promise.resolve(Object(b.createErrors)(a))]:(o=Object(g.clone)(t),[2,this.connector.replaceRowAsync(e.value,o,r).then(b.create,(function(t){Core.PromiseUtils.throwIfCanceled(t),i._logError("TabularDataSource._updateRowCoreAsync",t);var r=Object(p.fromConnectorError)(t,w.EditPermission,i._dataTableInternal[e.index]);return Object(b.createSingleError)(r,j.errorHasHttpResponse(t.serverError)?t.serverError.response:null)}))])}))}))},t.prototype.getAttachmentsAsync=function(e,t,r,n){return __awaiter(this,void 0,Promise,(function(){var a,o;return __generator(this,(function(i){switch(i.label){case 0:if(!this._tryGetConnectorForTable(e))return[2,null];a=this.dataRuntime.startAsyncDataAction(),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this._queryDataProvider.getDataAsync(this._lazyReadOnlyPrimaryAttachmentConnector.value,this.name,new A.AttachmentCacheableQuery({sourceType:S.SourceType.AttachmentQueryDefinition,dataSourceName:this.name,tableName:e,columnName:r,itemKey:t}),n)];case 2:return[2,i.sent().results];case 3:if(o=i.sent(),Core.PromiseUtils.throwIfCanceled(o),Core.Log.error("TabularDataSource.getAttachmentsAsync",o,"Exception in IQueryDataProvider.getDataAsync"),o instanceof E.TabularDataError)return Object(T.reportConnectedDataReadOperationErrors)(o,n,this.dataRuntime),[2,x.ErrorValue.createGatedError(x.ErrorKind.Unknown,x.ErrorSeverity.Moderate)];throw o;case 4:return this.dataRuntime.endAsyncDataAction(a),[7];case 5:return[2]}}))}))},t.prototype.downloadMediaResourceAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,n,a,o,i,s,c,u;return __generator(this,(function(l){switch(l.label){case 0:if("table"!==(e=L.BackCompat.upgradeBlobUriIfApplicable(e,this.connector.metadata.name)).getSegment(L.SegmentIndexes.ConnectedDataSourceTable)||"rows"!==e.getSegment(L.SegmentIndexes.ConnectedDataSourceTableRows))throw new U.Media.MediaResourceError;if(!(t=e.getSegment(L.SegmentIndexes.ConnectedDataSourceTableName)))throw new U.Media.MediaResourceError("Invalid uri. Table name segment missing or not specified.");if(!(r=this._tryGetConnectorForTable(t)))throw new U.Media.MediaResourceError("Invalid uri. Table doesn't exist: "+t);if((n=e.getSegment(L.SegmentIndexes.ConnectedDataSourceResourceType))!==L.ConnectedDataSourceResourceType.InlineBlob)return[3,2];if(!(a=e.getSegment(L.SegmentIndexes.ConnectedDataSourceTableInternalRowId)))throw new U.Media.MediaResourceError("Invalid uri. Row key segment missing or not specified.");if(c=e.getSegment(L.SegmentIndexes.ConnectedDataSourceInlineBlobColumnName),!(o=c?r.metadata.tryGetColumn(c):null))throw new U.Media.MediaResourceError("Invalid uri. Column doesn't exist: "+c);if(!o.isBlob||o.containsReferencedBlobs())throw new U.Media.MediaResourceError("Invalid uri. Column is not an inline blob column: "+c);return[4,r.downloadInlineBlobAsync(I.parsePrimaryKey(a,r.metadata.keyColumns),c)];case 1:return[2,l.sent()];case 2:if(n!==L.ConnectedDataSourceResourceType.ReferencedBlob)return[3,4];if(!(i=Core.Url.tryParse(e.getSegment(L.SegmentIndexes.ConnectedDataSourceReferenceBlobUrl)))||!i.isAbsolute)throw new U.Media.MediaResourceError("Invalid uri. Relative blob download url is not an absolute url.");return[4,r.downloadReferencedBlobAsync(i)];case 3:return[2,l.sent()];case 4:if(n!==L.ConnectedDataSourceResourceType.Attachment)return[3,6];if(!(i=Core.Url.tryParse(e.getSegment(L.SegmentIndexes.ConnectedDataSourceReferenceBlobUrl)))||!i.isAbsolute)throw new U.Media.MediaResourceError("Invalid uri. Relative blob download url is not an absolute url.");return[4,r.downloadAttachmentAsync(i)];case 5:return[2,l.sent()];case 6:if(n!==L.ConnectedDataSourceResourceType.FileOrImageUrl)return[3,8];if(i=Core.Url.tryParse(e.getSegment(L.SegmentIndexes.ConnectedDataSourceFileImageUrl)),s=e.getSegment(L.SegmentIndexes.ConnectedDataSourceTableInternalRowId),c=e.getSegment(L.SegmentIndexes.ColumnName),u=e.getSegment(L.SegmentIndexes.ResourceId),!i||!i.isAbsolute)throw new U.Media.MediaResourceError("Invalid uri. Relative blob download url is not an absolute url.");return[4,r.downloadFileAsync(c,s,u,i)];case 7:return[2,l.sent()];case 8:throw new U.Media.MediaResourceError("Invalid uri. resource type segment is invalid: "+n)}}))}))},t.prototype.patchAsync=function(e,t,r){var a,o,i,s,c,u;return void 0===r&&(r=null),__awaiter(this,void 0,Promise,(function(){var l,d,f,y,g,h,m,v;return __generator(this,(function(b){switch(b.label){case 0:return Core.Log.verbose("TabularDataSource[{0}]: patchAsync",this.name),(l=this._getPatchOperationKind(e,t))!==n.Create?[3,2]:(Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.DataOperation,"patchCreateRow",{context:r,operationKind:n[l],newRecord:t,entityName:null!==(a=null==r?void 0:r.entityName)&&void 0!==a?a:null,propertyName:null!==(o=null==r?void 0:r.propertyName)&&void 0!==o?o:null,info:AppMagic.Strings.PatchOperationRequestPayloadInfoText},Core.Diagnostics.MonitorLogLevel.Trace),[4,this._createRowAsync(t,r)]);case 1:return d=b.sent(),R.isErrorValue(d)?[2,d]:(AppMagic.Data.ErrorValue.isErrorHandlingFeatureEnabled()||this._reportAnyRuntimeErrors(d,r),(null===(i=d.errors)||void 0===i?void 0:i.length)?(m=d.errors[0].Message?Core.Utility.formatString(AppMagic.Strings.NetworkErrorPatch,d.errors[0].Message):AppMagic.Strings.NetworkError,v=AppMagic.AuthoringTool.Runtime.tryCreateGatedReportRuntimeError({errorContext:r,errorMessage:m,skipDisplayRuntimeError:!0,functionName:"Patch"}),[2,R.createGatedError(d.errors[0].Error,M.Severe,m,v,d.errorHttpResponse)]):[2,d.serverRow]);case 2:return f=this.primaryTable.getPrimaryKey(e),y=this._memStorage.getEntry(f),Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.DataOperation,"patchExistingRow",{context:r,operationKind:n[l],baseRecord:y?y.value:e,changeRecords:t,entityName:null!==(s=null==r?void 0:r.entityName)&&void 0!==s?s:null,propertyName:null!==(c=null==r?void 0:r.propertyName)&&void 0!==c?c:null,info:AppMagic.Strings.PatchOperationRequestPayloadInfoText},Core.Diagnostics.MonitorLogLevel.Trace),null!==y||this._byPassLocalCacheValidation?[3,4]:(this._logWarning("TabularDataSource.patchAsync","Attempt to patch row not found in data source."),this._setMissingKeyError(Object(p.rowNotFound)()),[4,this._processOnDataChangeAsync()]);case 3:return b.sent(),[2,x.ErrorValue.createGatedError(x.ErrorKind.NotFound,x.ErrorSeverity.Severe)];case 4:return g=y?y.value:e,[4,this._patchRowAsync(g,t,y,r)];case 5:return h=b.sent(),R.isErrorValue(h)?[2,h]:(AppMagic.Data.ErrorValue.isErrorHandlingFeatureEnabled()||this._reportAnyRuntimeErrors(h,r),(null===(u=h.errors)||void 0===u?void 0:u.length)?(m=h.errors[0].Message?Core.Utility.formatString(AppMagic.Strings.NetworkErrorPatch,h.errors[0].Message):AppMagic.Strings.NetworkError,v=AppMagic.AuthoringTool.Runtime.tryCreateGatedReportRuntimeError({errorContext:r,errorMessage:m,skipDisplayRuntimeError:!0,functionName:"Patch"}),[2,R.createGatedError(h.errors[0].Error,M.Severe,m,v,h.errorHttpResponse)]):[2,h.serverRow])}}))}))},t.prototype._patchRowAsync=function(e,t,r,n){return void 0===n&&(n=null),__awaiter(this,void 0,Promise,(function(){var a,o,i,s,c,u,l,d,f,y,g;return __generator(this,(function(h){switch(h.label){case 0:a=this.dataRuntime.startAsyncDataAction(),h.label=1;case 1:return h.trys.push([1,15,16,17]),[4,this._patchRowCoreAsync(e,t,n)];case 2:return o=h.sent(),R.isErrorValue(o)?[2,o]:(i=this._clearMissingKeyErrors(),o?[3,8]:(Core.Log.verbose("TabularDataSource[{0}]: _patchRowAsync - row not changed",this.name),r?(c=r.value,[3,5]):[3,3]));case 3:return[4,this.connector.getRowAsync(e,n)];case 4:c=h.sent(),h.label=5;case 5:return s=c,!!r&&this._clearErrorsForKey(r.key)||i?[4,this._processOnDataChangeAsync()]:[3,7];case 6:h.sent(),h.label=7;case 7:return[2,Object(b.create)(s)];case 8:return u=o.serverRow,R.isGatedErrorOrUndefined(u)?[3,10]:(Core.Log.verbose("TabularDataSource[{0}]: _patchRowAsync - row patched",this.name),l=void 0,l=u?r?this._updateRowInDataSource(r,u):u:r?r.value:e,[4,this._processOnDataChangeAsync()]);case 9:return h.sent(),[2,Object(b.create)(l)];case 10:return Core.Log.verbose("TabularDataSource[{0}]: _patchRowAsync - patch request had errors",this.name),r&&this._setErrorsForKey(r.key,o.errors),[4,this._processOnDataChangeAsync()];case 11:return h.sent(),r?(f=this._dataTableInternal[r.index],[3,14]):[3,12];case 12:return[4,this.connector.getRowAsync(e,n)];case 13:f=h.sent(),h.label=14;case 14:return d=f,[2,Object(b.create)(d,o.errors,o.errorHttpResponse)];case 15:if(y=h.sent(),Core.PromiseUtils.throwIfCanceled(y),y instanceof E.TabularDataError)return g=Object(p.fromConnectorError)(y,w.ReadPermission,e),[2,Object(b.createSingleError)(g,j.errorHasHttpResponse(y.serverError)?y.serverError.response:null)];throw y;case 16:return this.dataRuntime.endAsyncDataAction(a),[7];case 17:return[2]}}))}))},t._isDataUnchangedForColumn=function(e,t,r){return!x.ErrorValue.isGatedErrorOrUndefined(e[t])&&AppMagic.Utility.deepCompare(e[t],r)},t._skipInavlidAttachmentColumnUpdate=function(e,t){return e&&e.isAttachmentColumn&&!Object(d.isAttachmentTable)(t)},t._skipColumnForPatch=function(e,r,n){return!!(Core.Utility.isUndefined(r)||null===r&&null===n[e.name]||!e.isNavigation&&(null===r&&!x.ErrorValue.isErrorHandlingFeatureEnabled()||t._isDataUnchangedForColumn(n,e.name,r)||t._skipInavlidAttachmentColumnUpdate(e,r)))},t.prototype._patchRowCoreAsync=function(e,r,n,a){return void 0===n&&(n=null),__awaiter(this,void 0,Promise,(function(){var o,i,s,c,u,l,y,g,h,m,v,_,C,A,S,D=this;return __generator(this,(function(O){switch(O.label){case 0:o=P.create(),i=null,s=!1,c=this.primaryTable.columns,u=[],l=[],y=0,g=c.length,O.label=1;case 1:return y<g?(h=c[y],m=h.name,v=r[m],t._skipColumnForPatch(h,v,e)?[3,9]:h.isReadOnly?(this._logWarning("TabularDataSource._patchRowCoreAsync","Row attempted to modify readonly column."),S=Object(p.columnReadOnly)(e,m),i=Object(f.add)(i,S),[3,9]):h.isInvalidForUpdate?(this._logWarning("TabularDataSource._patchRowCoreAsync","Column is not valid for update"),S=Object(p.columnInvalidForUpdate)(e,m),i=Object(f.add)(i,S),[3,9]):(_=h.constraints.validate(v,m),R.isErrorValue(_)?[2,_]:null!==_?(this._logWarning("TabularDataSource._patchRowCoreAsync","Row failed client validation."),S=Object(p.columnValueInvalid)(e,m,_[0].message,_[0].error),i=Object(f.add)(i,S),[3,9]):h.isPolymorphic?this._tryBindPolymorphic(e,o,h,v,i)?(s=!0,[3,9]):[3,9]:[3,2])):[3,10];case 2:return h.isNavigation?v&&e[m]&&F.getCanonicalId(e[m])===F.getCanonicalId(v)?[3,9]:this._tryBindNavigation(o,v,m,i)?(s=!0,[3,9]):[3,9]:[3,3];case 3:return h.isAttachmentColumn?Object(d.isAttachmentTable)(v)?(C=Object(d.getDeletedAttachments)(v),((A=Object(d.getStagedAttachments)(v)).length>0||C.length>0)&&(u.push({columnName:h.name,newItems:A,removedItems:C}),s=!0),[3,9]):[3,9]:[3,4];case 4:return h.isFileColumn||h.isImageColumn?!r.hasOwnProperty(h.name)||v?[3,5]:(l.push({columnName:m,file:v}),s=!0,[3,7]):[3,8];case 5:return h.isFileColumn&&t.isFileChanged(m,e,v)||h.isImageColumn&&t.isImageChanged(m,e,v)?[4,this._validateFileAsync(h,v)]:[3,7];case 6:if(null!==(_=O.sent()))return this._logWarning("TabularDataSource._patchRowCoreAsync","Row failed client validation."),S=Object(p.columnValueInvalid)(e,m,_[0].message,_[0].error),i=Object(f.add)(i,S),[3,9];l.push({columnName:m,file:v}),s=!0,O.label=7;case 7:return delete r[m],[3,9];case 8:null===i&&(o[m]=v,this._postProcessEditColumn(o,m,h),s=!0),O.label=9;case 9:return++y,[3,1];case 10:return null!==i?[2,Promise.resolve(Object(b.createErrors)(i))]:s?[2,this._processPatchRequest(e,o,n,a).then((function(t){return D._processAttachmentsAsync(u,e,t,n).then((function(t){return D._processFilesAsync(l,e,t,n)}))})).catch((function(e){return Core.PromiseUtils.throwIfCanceled(e),D._logError("_patchRowCoreAsync",e),Object(b.createSingleError)(e)}))]:(this._logWarning("TabularDataSource._patchRowCoreAsync","No changes detected."),[2,Promise.resolve(null)])}}))}))},t.isFileChanged=function(e,t,r){var n="",a="";r instanceof Array?r.length>0&&(a=r[0].DisplayName,n=r[0].Value):Object(m.isFileDataRecord)(r)&&(a=r.FileName,n=r.Value);var o=t&&t[e];return!(!Object(m.isFileDataRecord)(o)||a===o.FileName&&n===o.Value)||!(o||!n)},t.isImageChanged=function(e,t,r){var n="";"string"==typeof r?n=r:Object(m.isImageDataRecord)(r)&&(n=r.Value||r.Full);var a=t&&t[e];return!(!Object(m.isImageDataRecord)(a)||n===a.Value||n===a.Full)||!(a||!n)},t.prototype._processPatchRequest=function(e,t,r,n){return void 0===r&&(r=null),__awaiter(this,void 0,Promise,(function(){var a,o;return __generator(this,(function(i){switch(i.label){case 0:if(HashTableUtility.isEmpty(t))return[2,Object(b.create)(e)];i.label=1;case 1:return i.trys.push([1,3,,4]),a=b.create,[4,this.connector.patchRowAsync(e,t,r,n)];case 2:return[2,a.apply(void 0,[i.sent()])];case 3:return o=i.sent(),[2,this._handlePatchServiceErrors(o,e,"TabularDataSource._processPatchRequest")];case 4:return[2]}}))}))},t.prototype._validateFileAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r;return __generator(this,(function(n){switch(n.label){case 0:return t?(r="","string"==typeof t?r=t:t instanceof Array?t.length>0&&(r=t[0].Value):(Object(m.isFileDataRecord)(t)||Object(m.isImageDataRecord)(t))&&(r=t.Value),r?[4,this.connector.validateFileAsync(r,e)]:[3,2]):[3,2];case 1:return[2,n.sent()];case 2:return[2,null]}}))}))},t.prototype._processFilesAsync=function(e,t,r,n){return void 0===n&&(n=null),__awaiter(this,void 0,Promise,(function(){var a;return __generator(this,(function(o){switch(o.label){case 0:return 0===e.length?[2,r]:[4,this._processFileUpdateRequestAsync(e,t,n)];case 1:return a=o.sent(),[4,this._handleProccesAttachmentUpdateOperationResultAsync(r,a,n)];case 2:return[2,o.sent()]}}))}))},t.prototype._processAttachmentsAsync=function(e,t,r,n){return void 0===n&&(n=null),__awaiter(this,void 0,Promise,(function(){var a;return __generator(this,(function(o){switch(o.label){case 0:return 0===e.length?[2,r]:[4,this._processAttachmentsUpdateRequestAsync(e,t,n)];case 1:return a=o.sent(),[4,this._handleProccesAttachmentUpdateOperationResultAsync(r,a,n)];case 2:return[2,o.sent()]}}))}))},t.prototype._handleProccesAttachmentUpdateOperationResultAsync=function(e,t,r){return void 0===r&&(r=null),__awaiter(this,void 0,Promise,(function(){var n;return __generator(this,(function(a){switch(a.label){case 0:return t.errors?(e.errors||(e.errors=[]),t.errors.forEach((function(t){e.errors.push(t)})),[3,3]):[3,1];case 1:return[4,this.connector.getRowAsync(e.serverRow,r)];case 2:n=a.sent(),e.serverRow=n,a.label=3;case 3:return[2,e]}}))}))},t.prototype._handlePatchServiceErrors=function(e,t,r){Core.PromiseUtils.throwIfCanceled(e),this._logError(r,e);var n=Object(p.fromConnectorError)(e,w.EditPermission,t);return Object(b.createSingleError)(n,j.errorHasHttpResponse(e.serverError)?e.serverError.response:null)},t.prototype._processDeleteAttachmentAsync=function(e,t,r,n){return void 0===n&&(n=null),__awaiter(this,void 0,Promise,(function(){var a;return __generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.connector.deleteAttachmentAsync(e,t,r,n)];case 1:return o.sent(),[2,null];case 2:return a=o.sent(),[2,this._handlePatchServiceErrors(a,e,"ConnectedDataConnector._processDeleteAttachment")];case 3:return[2]}}))}))},t.prototype._processCreateAttachmentAsync=function(e,t,r,n,a){return void 0===a&&(a=null),__awaiter(this,void 0,Promise,(function(){var o;return __generator(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.connector.createAttachmentAsync(e,r,t,n,a)];case 1:return i.sent(),[2,null];case 2:return o=i.sent(),[2,this._handlePatchServiceErrors(o,e,"ConnectedDataConnector._processCreateAttachment")];case 3:return[2]}}))}))},t.prototype._processAttachmentsUpdateRequestAsync=function(e,t,r){return void 0===r&&(r=null),__awaiter(this,void 0,Promise,(function(){var n,a,o,i=this;return __generator(this,(function(s){switch(s.label){case 0:return n=new Core.PromiseUtils.PromiseQueue("_processAttachmentsUpdateRequest"),a=[],e.forEach((function(e){e.removedItems.forEach((function(o){a.push(n.pushJob((function(){return i._processDeleteAttachmentAsync(t,e.columnName,o.Id,r)})))})),e.newItems.forEach((function(o){a.push(n.pushJob((function(){return i._processCreateAttachmentAsync(t,e.columnName,o.Value,o.DisplayName,r)})))}))})),[4,Core.PromiseUtils.join(a)];case 1:return s.sent().forEach((function(e){e&&e.errors&&(o||(o=[]),o.splice.apply(o,__spreadArray([o.length-1,0],e.errors,!1)))})),[2,Object(b.create)(t,o)]}}))}))},t.prototype._processCreateFileAsync=function(e,t,r,n,a){return void 0===a&&(a=null),__awaiter(this,void 0,Promise,(function(){var o;return __generator(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.connector.createFileAsync(e,r,t,n,a)];case 1:return i.sent(),[2,null];case 2:return o=i.sent(),[2,this._handlePatchServiceErrors(o,e,"ConnectedDataConnector._processCreateFile")];case 3:return[2]}}))}))},t.prototype._processDeleteFileAsync=function(e,t,r){return void 0===r&&(r=null),__awaiter(this,void 0,Promise,(function(){var n;return __generator(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.connector.deleteFileAsync(e,t,r)];case 1:return a.sent(),[2,null];case 2:return n=a.sent(),[2,this._handlePatchServiceErrors(n,e,"ConnectedDataConnector._processDeleteFile")];case 3:return[2]}}))}))},t.prototype._processFileUpdateRequestAsync=function(e,t,r){return void 0===r&&(r=null),__awaiter(this,void 0,Promise,(function(){var n,a,o,i=this;return __generator(this,(function(s){switch(s.label){case 0:return n=new Core.PromiseUtils.PromiseQueue("_processFileUpdateRequest"),a=[],e.forEach((function(e){var o="",s="";"string"==typeof e.file?o=e.file:e.file instanceof Array?e.file.length>0&&(s=e.file[0].DisplayName,o=e.file[0].Value):Object(m.isFileDataRecord)(e.file)?(s=e.file.FileName,o=e.file.Value):Object(m.isImageDataRecord)(e.file)&&(o=e.file.Value),a.push(n.pushJob((function(){return o?i._processCreateFileAsync(t,e.columnName,o,s,r):i._processDeleteFileAsync(t,e.columnName,r)})))})),[4,Core.PromiseUtils.join(a)];case 1:return s.sent().forEach((function(e){e&&e.errors&&(o||(o=[]),o.splice.apply(o,__spreadArray([o.length-1,0],e.errors,!1)))})),[2,Object(b.create)(t,o)]}}))}))},t.prototype.removeAllDelegatedAsync=function(e,t){return void 0===t&&(t=null),__awaiter(this,void 0,Promise,(function(){var r,n;return __generator(this,(function(a){r=this.dataRuntime.startAsyncDataAction(),n="TabularDataSource.removeAllDelegatedAsync","RemoveAll",Core.Log.verbose("TabularDataSource[{0}]: removeAllDelegatedAsync",this.name);try{if(!this._byPassLocalCacheValidation)return Core.Log.errorEx(n,"removeAllDelegatedAsync should not be called on non-delegated data sources"),this._asyncRemoveRowsPresentInQueriedTable(e,n,"RemoveAll",t),[2,this.queryTableAsync()]}catch(e){this._logError(n,e),Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.Runtime,AppMagic.Strings.UnhandledRuntimeError,e,k.Error)}finally{this.dataRuntime.endAsyncDataAction(r)}return[2]}))}))},t.prototype.removeAsync=function(e,t,r){return void 0===t&&(t=null),__awaiter(this,void 0,Promise,(function(){var r,n,a,o,i,s,c,u,l;return __generator(this,(function(d){switch(d.label){case 0:if(Core.Log.verbose("TabularDataSource[{0}]: removeAsync",this.name),r=null,n=[],a=[],this._byPassLocalCacheValidation)return[2,this._removeDelegatedAsync(e,t)];for(o=e.length;--o>=0;)i=e[o],this.primaryTable.hasValidPrimaryKey(i)?(s=this.primaryTable.getPrimaryKey(i),null===(c=this._memStorage.getEntry(s))?(r=Object(f.add)(r,Object(p.rowNotFound)()),R.isErrorHandlingFeatureEnabled()&&a.push(this._createDataRowNotFoundError(t,"Remove"))):n.push(c.index)):(r=Object(f.add)(r,Object(p.rowNotFound)()),R.isErrorHandlingFeatureEnabled()&&a.push(this._createDataRowNotFoundError(t,"Remove")));return Core.Log.verbose("TabularDataSource[{0}]: removeAsync - attempting to remove {1} row(s). {2} requested row(s) not found",this.name,e.length,r?r.length:0),a.length>0?(u=AppMagic.Data.ErrorValue.normalizeErrors(a),this._setMissingKeyErrors(r),[4,this._processOnDataChangeAsync()]):[3,2];case 1:return d.sent(),[2,u];case 2:if(n.length>0){l=this.dataRuntime.startAsyncDataAction();try{return[2,this._removeCoreAsync(n,t,r)]}finally{this.dataRuntime.endAsyncDataAction(l)}}return this._setMissingKeyErrors(r)&&0===n.length?[4,this._processOnDataChangeAsync()]:[3,4];case 3:d.sent(),d.label=4;case 4:return[2,this.dataTableInternal]}}))}))},t.prototype._createDataRowNotFoundError=function(e,t){var r=AppMagic.Strings.ConnectedDataRowNotFound,n=AppMagic.AuthoringTool.Runtime.tryCreateGatedReportRuntimeError({errorContext:e,errorMessage:r,skipDisplayRuntimeError:!0,functionName:t});return R.createError(w.NotFound,M.Severe,r,n)},t.prototype._removeDelegatedAsync=function(e,t){return void 0===t&&(t=null),__awaiter(this,void 0,Promise,(function(){var r,n,a;return __generator(this,(function(o){switch(o.label){case 0:return[4,this._removeDelegatedAsyncInternal(e,t)];case 1:return r=o.sent(),AppMagic.Data.ErrorValue.isErrorHandlingFeatureEnabled()&&(n=r.filter((function(e){return R.isErrorValue(e)})),a=AppMagic.Data.ErrorValue.normalizeErrors(n))?[2,a]:[2,this.dataTableInternal]}}))}))},t.prototype._removeDelegatedAsyncInternal=function(e,t){return void 0===t&&(t=null),__awaiter(this,void 0,Promise,(function(){var r,n,a,o,i,s,c,u,l,d,g=this;return __generator(this,(function(h){for(r=null,n=[],a=this.dataRuntime.startAsyncDataAction(),u=e.length;--u>=0;)o=e[u],this.primaryTable.hasValidPrimaryKey(o)?n.push(o):r=Object(f.add)(r,Object(p.rowNotFound)());for(i=[],this.kind===y.DataSourceKind.CdsNativeDataSource&&Core.FeatureGates.services.enableOdataBatch&&(c="batch_".concat(Core.Utility.generate128BitUUID()),s={batchId:c,totalRequests:n.length}),u=0,l=n.length;u<l;++u)i.push(this._deleteRowAsync(n[u],t,s));return d=Core.PromiseUtils.join(i).then((function(e){return __awaiter(g,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:return e.some((function(e){return!R.isErrorValue(e)&&e}))||this._setMissingKeyErrors(r)?[4,this._processOnDataChangeAsync()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2,e]}}))}))})),[2,Core.PromiseUtils.wrapWithFinally(d,(function(){return g.dataRuntime.endAsyncDataAction(a)}))]}))}))},t.prototype._deleteRowAsync=function(e,t,r){return void 0===t&&(t=null),__awaiter(this,void 0,Promise,(function(){var n=this;return __generator(this,(function(a){return[2,this.connector.deleteRowAsync(e,t,r).then((function(){var t=n.primaryTable.getPrimaryKey(e);return n._memStorage.getEntry(t)&&n._deleteRowInDataSource(t),!0})).catch((function(e){if(Core.PromiseUtils.throwIfCanceled(e),AppMagic.Data.ErrorValue.isErrorHandlingFeatureEnabled()){var r=Object(E.tryConvertErrorToErrorValue)(t,e,AppMagic.Strings.NetworkErrorRemove,"Remove",w.DeletePermission);if(r)return r}return n._logError("TabularDataSource._deleteRowAsync",e,"Suppressing error while deleting a row."),!1}))]}))}))},t.prototype._removeCoreAsync=function(e,t,r){return void 0===r&&(r=null),__awaiter(this,void 0,Promise,(function(){var n,a,o,i,s,c,u,l,d=this;return __generator(this,(function(p){for(n=this._memStorage.getAll(),a=[],o=new Core.PromiseUtils.PromiseQueue("_removeCoreAsync"),this.kind===y.DataSourceKind.CdsNativeDataSource&&Core.FeatureGates.services.enableOdataBatch&&(s="batch_".concat(Core.Utility.generate128BitUUID()),i={batchId:s,totalRequests:e.length}),c=Core.PromiseUtils.createAbortController(null==t?void 0:t.abortSignal),u=0,l=e.length;u<l;++u)i?a.push(this._removeServerRowAsync(n[e[u]],t,i)):a.push(o.pushJob(this._removeServerRowAsync.bind(this,n[e[u]],t),c));return Core.Log.verbose("TabularDataSource[{0}]: _removeCoreAsync - attempting to remove {1} row(s)",this.name,a.length),[2,Core.PromiseUtils.join(a).then((function(e){return __awaiter(d,void 0,void 0,(function(){var n,a,o,i,s,c,u,l,d,p,f,y,g,h,m,v;return __generator(this,(function(b){switch(b.label){case 0:for(n=this._setMissingKeyErrors(r)||e.length>0,a=!1,o=[],i=[],s=this._memStorage.getAll(),c=0,u=e.length;c<u;++c)null!==(l=e[c])&&(l.error?(d=s[l.index],this._setErrorsForKey(d.key,[l.error]),AppMagic.Data.ErrorValue.isErrorHandlingFeatureEnabled()?(p=Core.Utility.formatString(AppMagic.Strings.NetworkErrorRemove,(null===(m=l.error)||void 0===m?void 0:m.ServerMessage)||(null===(v=l.error)||void 0===v?void 0:v.Message)),f=AppMagic.AuthoringTool.Runtime.tryCreateGatedReportRuntimeError({errorContext:t,errorMessage:p,skipDisplayRuntimeError:!0,functionName:"Remove"}),y=AppMagic.Data.ErrorValue.createError(l.error.Error,M.Severe,p,f,l.serverResponse),i.push(y)):(a||this._reportAnyRemoveRuntimeErrors(l,t),a=!0)):o.push(l.index));return i.length>0?Core.Log.verbose("TabularDataSource[{0}]: _removeCoreAsync - {1} errors, {2} row(s) removed successfully",this.name,i.length,o.length):Core.Log.verbose("TabularDataSource[{0}]: _removeCoreAsync - {1} row(s) removed successfully",this.name,o.length),0!==o.length?[3,3]:n?[4,this._processOnDataChangeAsync()]:[3,2];case 1:b.sent(),b.label=2;case 2:return(g=AppMagic.Data.ErrorValue.normalizeErrors(i))?[2,g]:[2,this.dataTableInternal];case 3:return this._deleteRowsInDataSourceByIndex(o.sort((function(e,t){return e-t}))),[4,this._processOnDataChangeAsync()];case 4:return b.sent(),(h=AppMagic.Data.ErrorValue.normalizeErrors(i))?[2,h]:[2,this.dataTableInternal]}}))}))}))]}))}))},t.prototype.removeIfAsync=function(e,t){var r=this;void 0===t&&(t=null),Core.Log.verbose("TabularDataSource[{0}]: removeIfAsync",this.name);var n=this.dataRuntime.startAsyncDataAction(),a=Object(o.getIndicesAsync)(this._dataTableInternal,e).then((function(e){if(R.isErrorValue(e))return e;for(var n=[],a=0;a<e.length;a++)e[a]&&n.push(a);return r._removeCoreAsync(n,t)}));return Core.PromiseUtils.wrapWithFinally(a,(function(){return r.dataRuntime.endAsyncDataAction(n)}))},t.prototype.removeIfDelegatedAsync=function(e,r){return void 0===r&&(r=null),__awaiter(this,void 0,Promise,(function(){var n,a,o,s,c,u,l,d,p,f,y;return __generator(this,(function(g){switch(g.label){case 0:n="TabularDataSource.removeIfDelegatedAsync",a="RemoveIf",Core.Log.verbose("TabularDataSource[{0}]: removeIfDelegatedAsync",this.name),o=this.dataRuntime.startAsyncDataAction(),(s=new D.TableQueryOptions).selects=[],t._ensureKeysAreSelected(this.primaryTable,s),g.label=1;case 1:return g.trys.push([1,5,6,7]),[4,Promise.all(e)];case 2:for(c=g.sent(),u=0,l=c;u<l.length;u++)d=l[u],s.filter?s.filter=new i.Filter(i.FilterOperator.And,s.filter,d.filter):s.filter=d.filter;return[4,this.queryTableAsync(s)];case 3:return p=g.sent(),[4,this._asyncRemoveRowsPresentInQueriedTable(p,n,a,r)];case 4:return f=g.sent(),AppMagic.Data.ErrorValue.isErrorValue(f)?[2,f]:[2,this.queryTableAsync()];case 5:return y=g.sent(),this._logError(n,y,"Exception thrown"),Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.Runtime,AppMagic.Strings.UnhandledRuntimeError,y,k.Error),[3,7];case 6:return this.dataRuntime.endAsyncDataAction(o),[7];case 7:return[2]}}))}))},t.prototype._asyncRemoveRowsPresentInQueriedTable=function(e,t,r,n){return void 0===n&&(n=null),__awaiter(this,void 0,Promise,(function(){var a,o,i,s,c,u,l,d,p,f,y,g,h;return __generator(this,(function(m){switch(m.label){case 0:return AppMagic.Data.ErrorValue.isErrorValue(e)?(this._logErrorValue(t,e,"Error in queryTableAsync"),[2,e]):(a=0,o=0,i=Math.max(this.isDataAvailable?this._dataTableInternal.length:0,100,this.maxGetRowsCount()),[4,e.getNextResultsAsync(n,i,!0,!1)]);case 1:return s=m.sent(),AppMagic.Data.ErrorValue.isErrorValue(s)?(this._logErrorValue(t,s,"Error from getNextResultsAsync"),[2,s]):s?(s.length>=i&&(c=Core.Utility.formatString(AppMagic.Strings.FunctionPartiallyDelegated,s.length),this._logWarning(t,c),Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.Delegation,r,{context:n,info:c,helpUrl:AppMagic.Strings.DelegationHelpURL,issue:Core.Utility.formatString(AppMagic.Strings.FunctionNotDelegatedQueryRowCountExceededDetail,this.maxGetRowsCount())},Core.Diagnostics.MonitorLogLevel.Warning)),u=[],s.length>0?[4,this._removeDelegatedAsyncInternal(s,n)]:[3,3]):(c="Unable to retrieve rows",this._logError(t,new Error(c)),[2,this.queryTableAsync()]);case 2:if(l=m.sent(),AppMagic.Data.ErrorValue.isErrorValue(l))return this._logErrorValue(t,l,"Error from _removeDelegatedAsyncInternal"),[2,l];for(d=0,p=l;d<p.length;d++)!0===(f=p[d])?o++:(a++,AppMagic.Data.ErrorValue.isErrorHandlingFeatureEnabled()&&u.push(f));m.label=3;case 3:return y=Core.Utility.formatString(AppMagic.Strings.RemoveIfCounts,o,a),Core.Telemetry.Log.trackActivityEvent(t,{message:y,removedCount:o,errorCount:a}),g=this._createDiagnosticsContext(n,r),Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.Delegation,r,{context:g,info:y,removedCount:o,errorCount:a},a>0?k.Warning:k.Info),((h=AppMagic.Data.ErrorValue.normalizeErrors(u))||a>0)&&(this._logErrorValue(t,h,"errors executing changes"),Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.Runtime,AppMagic.Strings.UnhandledRuntimeError,h,k.Error),AppMagic.Data.ErrorValue.isErrorHandlingFeatureEnabled())?[2,h]:[2]}}))}))},t.prototype._removeServerRowAsync=function(e,t,r){var n;return void 0===t&&(t=null),__awaiter(this,void 0,Promise,(function(){var a=this;return __generator(this,(function(o){return(null===(n=null==t?void 0:t.abortSignal)||void 0===n?void 0:n.aborted)?[2,null]:[2,this.connector.deleteRowAsync(e.value,t,r).then((function(){return function(e){return{index:e}}(e.index)}),(function(t){if(Core.Utility.isCanceledError(t))return null;a._logError("TabularDataSource._removeServerRowAsync",t);var r=Object(p.fromConnectorError)(t,w.DeletePermission,a._dataTableInternal[e.index]);return function(e,t,r){return{index:e,error:t,serverResponse:r}}(e.index,r)}))]}))}))},t.prototype.revertAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,o,i,s,c,u,l,d,p,f,y,g=this;return __generator(this,(function(h){switch(h.label){case 0:return null!==t?[3,3]:(Core.Log.verbose("TabularDataSource[{0}]: revertAsync(ec, null)",this.name),this._clearMissingKeyErrors()?[4,this._processOnDataChangeAsync()]:[3,2]);case 1:h.sent(),h.label=2;case 2:return[2,this._dataTableInternal];case 3:if(r=this.dataRuntime.startAsyncDataAction(),!P.isValid(t))return[3,7];h.label=4;case 4:return h.trys.push([4,,6,7]),[4,this._revertRowAsync(e,t)];case 5:return[2,h.sent()];case 6:return this.dataRuntime.endAsyncDataAction(r),[7];case 7:if(n=t,o=!1,i=new Core.PromiseUtils.PromiseQueue("revertAsync"),Core.Utility.isUndefined(n))Core.Log.verbose("TabularDataSource[{0}]: revertAsync(ec, CDS)",this.name),s=Object.keys(this._errors).map((function(t){return i.pushJob((function(){return g._refreshRowAsync(e,g._memStorage.getEntry(t))}))})),o=!0;else{for(Core.Log.verbose("TabularDataSource[{0}]: revertAsync(ec, table)",this.name),c=HashTableUtility.create(),u=0,l=n.length;u<l;++u)d=n[u],P.isValid(d)?this.primaryTable.hasValidPrimaryKey(d)&&(p=this.primaryTable.getPrimaryKey(d),null!==(f=this._memStorage.getEntry(p))&&(c[p]=f)):o=!0;s=HashTableUtility.mapToArray(c,(function(t){return i.pushJob((function(){return g._refreshRowAsync(e,t)}))}))}return Core.Log.verbose("TabularDataSource[{0}]: revertAsync - reverting {1} change(s)",this.name,s.length),y=Core.PromiseUtils.join(s).then((function(e){return __awaiter(g,void 0,void 0,(function(){var t,r,n,i,s,c,u,l;return __generator(this,(function(d){switch(d.label){case 0:for(t=o&&this._clearMissingKeyErrors(),r=0,n=0,i=0,s=0,c=0,u=e.length;c<u;++c)switch((l=e[c]).kind){case a.Changed:this._patchRowInDataSource(this._memStorage.getEntry(l.key),l.serverRow),t=!0,++r;break;case a.Deleted:this._deleteRowInDataSource(l.key),t=!0,++n;break;case a.NotModified:this._clearErrorsForKey(l.key)&&(t=!0),++i;break;default:++s}return Core.Log.verbose("TabularDataSource[{0}]: revertAsync - {1} changed, {2} deleted, {3} not modified, {4} cancelled.",this.name,r,n,i,s),t?[4,this._processOnDataChangeAsync()]:[3,2];case 1:d.sent(),d.label=2;case 2:return[2,this._dataTableInternal]}}))}))})),[2,Core.PromiseUtils.wrapWithFinally(y,(function(){return g.dataRuntime.endAsyncDataAction(r)}))]}}))}))},t.prototype._revertRowAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,o,i,s;return __generator(this,(function(c){switch(c.label){case 0:return Core.Log.verbose("TabularDataSource[{0}]: _revertRowAsync",this.name),this.primaryTable.hasValidPrimaryKey(t)?(r=this.primaryTable.getPrimaryKey(t),null===(n=this._memStorage.getEntry(r))?(Core.Log.verbose("TabularDataSource[{0}]: _revertRowAsync - key not found",this.name),[2,Promise.resolve(x.ErrorValue.createGatedError(x.ErrorKind.NotFound,x.ErrorSeverity.Severe))]):[4,this._refreshRowAsync(e,n)]):(Core.Log.verbose("TabularDataSource[{0}]: _revertRowAsync - invalid primary key",this.name),[2,Promise.resolve(x.ErrorValue.createGatedError(x.ErrorKind.ConstraintViolated,x.ErrorSeverity.Severe))]);case 1:switch(o=c.sent(),Core.Log.verbose("TabularDataSource[{0}]: _revertRowAsync - refresh result {1}",this.name,o.kind),i=!1,o.kind){case a.Changed:s=this._patchRowInDataSource(n,o.serverRow),i=!0;break;case a.Deleted:this._deleteRowInDataSource(n.key),s=null,i=!0;break;case a.NotModified:s=this._dataTableInternal[n.index],i=this._clearErrorsForKey(r);break;default:throw Core.PromiseUtils.createCanceledError()}return i?[4,this._processOnDataChangeAsync()]:[3,3];case 2:c.sent(),c.label=3;case 3:return[2,s]}}))}))},t.prototype.updateIfAsync=function(e,t){return void 0===t&&(t=null),__awaiter(this,void 0,Promise,(function(){var r,n,a,o,i,s,c,u=this;return __generator(this,(function(l){for(Core.Log.verbose("TabularDataSource[{0}]: updateIfAsync",this.name),r=this.dataRuntime.startAsyncDataAction(),n=[],a=new Core.PromiseUtils.PromiseQueue("updateIfAsync"),o=this._memStorage.getAll(),i=0,s=this._dataTableInternal.length;i<s;++i)n.push(a.pushJob(this._updateRowIfAsync.bind(this,o[i],this._dataTableInternal[i],e)));return c=Core.PromiseUtils.join(n).then((function(e){return __awaiter(u,void 0,void 0,(function(){var r,n,a,i,s,c,u,l,d,p,f,y;return __generator(this,(function(g){switch(g.label){case 0:for(r=0,n=0,a=0,i=this._clearMissingKeyErrors(),s=[],c=0,u=e.length;c<u;++c)null!==(l=e[c])?R.isErrorValue(l)?s.push(l):(d=o[c],(p=l.serverRow)&&!R.isErrorValue(p)?(++n,this._updateRowInDataSource(d,p)):(++r,this._setErrorsForKey(d.key,l.errors),R.isErrorHandlingFeatureEnabled()?R.isErrorValue(p)?s.push(p):(f=this._tryCreateErrorFromDataOperationResult(t,"UpdateIf",l,AppMagic.Strings.NetworkErrorUpdateIf))&&s.push(f):1===r&&this._reportAnyRuntimeErrors(l,t)),i=!0):++a;return Core.Log.verbose("TabularDataSource[{0}]: updateIfAsync - {0} updated, {1} unchanged, {2} error(s)",this.name,n,a,r),i?[4,this._processOnDataChangeAsync()]:[3,2];case 1:g.sent(),g.label=2;case 2:return(y=AppMagic.Data.ErrorValue.normalizeErrors(s))?[2,y]:[2,this._dataTableInternal]}}))}))})),[2,Core.PromiseUtils.wrapWithFinally(c,(function(){return u.dataRuntime.endAsyncDataAction(r)}))]}))}))},t.prototype.updateIfDelegatedAsync=function(e,t,r){var n;return void 0===r&&(r=null),__awaiter(this,void 0,Promise,(function(){var a,o,s,c,u,l,d,p,f,y,g,h,m,v,b,_,C,A,S,O,E,T,w,M,P,F,N,I,j,L,U,V,B;return __generator(this,(function(Q){switch(Q.label){case 0:a="TabularDataSource.updateIfDelegatedAsync",o="UpdateIf",Core.Log.verbose("".concat(a," (").concat(this.name,")")),s=this.dataRuntime.startAsyncDataAction(),c=Math.max(this.isDataAvailable?this._dataTableInternal.length:0,100,this.maxGetRowsCount()),u=null,l=0,d=0,p=[],Q.label=1;case 1:return Q.trys.push([1,15,16,17]),[4,Promise.all(t.map((function(e){return e.queryOptions})))];case 2:f=Q.sent(),y=0,Q.label=3;case 3:return y<t.length?(g=t[y].itemFunction,h=f[y],m=h.filter,v=new D.TableQueryOptions,u?(v.filter=new i.Filter(i.FilterOperator.And,m,u),u=new i.Filter(i.FilterOperator.And,u,new i.Filter(i.FilterOperator.Not,m))):(u=new i.Filter(i.FilterOperator.Not,m),v.filter=m),b=v,function(e){return!!e.queryOptions||!!e.options}(e)&&(_=null!==(n=e.options)&&void 0!==n?n:e.queryOptions,b.selects=_.selects,b.expands=_.expands),[4,this.queryTableAsync(b)]):[3,12];case 4:return C=Q.sent(),AppMagic.Data.ErrorValue.isErrorValue(C)?(this._logErrorValue(a,C,"Error in queryTableAsync"),[2,C]):[4,C.getNextResultsAsync(r,c,!0,!1)];case 5:if(A=Q.sent(),AppMagic.Data.ErrorValue.isErrorValue(A))return this._logErrorValue(a,A,"Error from getNextResultsAsync"),[2,A];if(!A)return S="Unable to retrieve rows",this._logError(a,null,S),[2,this.queryTableAsync()];A.length>=c&&(S=Core.Utility.formatString(AppMagic.Strings.FunctionPartiallyDelegated,A.length),this._logWarning(a,S),Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.Delegation,o,{context:r,info:S,helpUrl:AppMagic.Strings.DelegationHelpURL,issue:Core.Utility.formatString(AppMagic.Strings.FunctionNotDelegatedQueryRowCountExceededDetail,this.maxGetRowsCount())},Core.Diagnostics.MonitorLogLevel.Warning)),O=[],E=[],T=0,w=A,Q.label=6;case 6:return T<w.length?(M=w[T],[4,this._runProjectionAsync(M,g)]):[3,9];case 7:if(P=Q.sent(),x.ErrorValue.isErrorValue(P))return this._logError(a,P,"Error running projection"),Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.Runtime,AppMagic.Strings.UnhandledRuntimeError,P,k.Error),[3,9];O.push(M),E.push(P),Q.label=8;case 8:return T++,[3,6];case 9:return E.length>0?[4,this.batchUpdateAsync(O,E,r)]:[3,11];case 10:for(F=Q.sent(),N=0,I=F;N<I.length;N++)j=I[N],R.isErrorValue(j)?(++l,p.push(j)):++d;Q.label=11;case 11:return y++,[3,3];case 12:return d>0?[4,this._processOnDataChangeAsync()]:[3,14];case 13:Q.sent(),Q.label=14;case 14:return L=Core.Utility.formatString(AppMagic.Strings.UpdateIfCounts,d,l),Core.Telemetry.Log.trackActivityEvent(a,{message:L,updatedCount:d,errorCount:l}),U=this._createDiagnosticsContext(r,o),Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.Delegation,o,{context:U,info:L,updatedCount:d,errorCount:l},l>0?k.Warning:k.Info),(V=AppMagic.Data.ErrorValue.normalizeErrors(p))&&(this._logWarningValue(a,"errors executing changes",V),Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.Runtime,AppMagic.Strings.UnhandledRuntimeError,V,k.Error),AppMagic.Data.ErrorValue.isErrorHandlingFeatureEnabled())?[2,V]:[2,this.queryTableAsync()];case 15:return B=Q.sent(),this._logError(a,B,"Exception thrown"),Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.Runtime,AppMagic.Strings.UnhandledRuntimeError,B,k.Error),[3,17];case 16:return this.dataRuntime.endAsyncDataAction(s),[7];case 17:return[2]}}))}))},t.prototype.batchUpdateAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,a,o,i,s,c,u,l,d,p,f,g;return __generator(this,(function(h){switch(h.label){case 0:for(n=[],this.kind===y.DataSourceKind.CdsNativeDataSource&&Core.FeatureGates.services.enableOdataBatch&&(o="batch_".concat(Core.Utility.generate128BitUUID()),a={batchId:o,totalRequests:e.length}),i=0,s=e.length;i<s;++i)c=AppMagic.Utility.clone(t[i],!0,!0),n.push(this._patchRowCoreAsync(e[i],c,r,a));return[4,Core.PromiseUtils.join(n)];case 1:for(u=h.sent(),l=[],d=0,p=u;d<p.length;d++)(f=p[d])&&(R.isErrorValue(f)?l.push(f):AppMagic.Data.ErrorValue.isErrorHandlingFeatureEnabled()&&(g=this._tryCreateErrorFromDataOperationResult(r,"Update",f,AppMagic.Strings.NetworkErrorUpdate))?l.push(g):l.push(f.serverRow));return[2,l]}}))}))},t.prototype._createDiagnosticsContext=function(e,t){return Core.Diagnostics.createErrorContext({protocol:this.protocol,operation:t,dataSource:this.monitorName},e)},t.prototype.relateAsync=function(e,t,r,n){return void 0===e&&(e=null),__awaiter(this,void 0,Promise,(function(){var a,o,i;return __generator(this,(function(s){switch(s.label){case 0:a=!1,s.label=1;case 1:return s.trys.push([1,3,,4]),(o=this._getRelateUnrelateInfo(t,r)).targetOdataId?[4,this.connector.relateAsync(o.parentEntityKey,n,o.targetOdataId,e)]:[2,x.ErrorValue.createGatedError(x.ErrorKind.InvalidFunctionUsage,x.ErrorSeverity.Moderate,AppMagic.Strings.ConnectedDataNavigationNotDataEntityRecord,AppMagic.AuthoringTool.Runtime.tryCreateGatedReportRuntimeError({errorContext:e,errorMessage:AppMagic.Strings.ConnectedDataNavigationNotDataEntityRecord,functionName:"Relate"}))];case 2:return a=s.sent(),[3,4];case 3:return i=s.sent(),[2,this._reportRelateUnrelateError(e,i,!0)];case 4:return[4,this._processOnDataChangeAsync()];case 5:return s.sent(),[2,a]}}))}))},t.prototype.unrelateAsync=function(e,t,r,n){return void 0===e&&(e=null),__awaiter(this,void 0,Promise,(function(){var a,o,i;return __generator(this,(function(s){switch(s.label){case 0:a=!1,s.label=1;case 1:if(s.trys.push([1,3,,4]),!(o=this._getRelateUnrelateInfo(t,r)).targetEntityKey)throw new Error("Could not parse serialized targetEntityKey. It may be corrupted. targetOdataId: '".concat(o.targetOdataId,"'"));return[4,this.connector.unrelateAsync(o.parentEntityKey,n,o.targetEntityKey,e)];case 2:return a=s.sent(),[3,4];case 3:return i=s.sent(),[2,this._reportRelateUnrelateError(e,i,!1)];case 4:return[4,this._processOnDataChangeAsync()];case 5:return s.sent(),[2,a]}}))}))},t.prototype._reportRelateUnrelateError=function(e,t,r){if(void 0===e&&(e=null),r?this._logError("TabularDataSource.relateAsync",t,"Exception in relateAsync"):this._logError("TabularDataSource.unrelateAsync",t,"Exception in unrelateAsync"),t instanceof l.AppDataSourceError){if(AppMagic.Data.ErrorValue.isErrorHandlingFeatureEnabled()){var n=Object(E.tryConvertErrorToErrorValue)(e,t,r?AppMagic.Strings.NetworkErrorRelate:AppMagic.Strings.NetworkErrorUnrelate,r?"Relate":"Unrelate",AppMagic.Data.ErrorKind.Network);if(n)return n}return Object(T.reportConnectedDataReadOperationErrors)(t,e,this.dataRuntime),x.ErrorValue.createGatedError(x.ErrorKind.Unknown,M.Moderate)}return x.ErrorValue.createGatedError(w.Unknown,M.Severe,Core.PromiseUtils.formatErrorMessage(t),AppMagic.AuthoringTool.Runtime.tryCreateGatedReportRuntimeError({errorContext:e,errorMessage:AppMagic.Strings.ConnectedDataUnknownError,functionName:r?"Relate":"Unrelate"}))},t.prototype._updateRowIfAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,a;return __generator(this,(function(o){switch(o.label){case 0:o.label=1;case 1:return o.trys.push([1,5,,6]),[4,Object(s.getProjectionAsync)(t,r)];case 2:return(n=o.sent())?[4,this._runProjectionAsync(t,n)]:[2,null];case 3:return a=o.sent(),[4,this._sendUpdateAsync(e,t,a)];case 4:return[2,o.sent()];case 5:return o.sent(),[2,null];case 6:return[2]}}))}))},t.prototype._runProjectionAsync=function(e,t){if(null===t)return Promise.resolve(R.createGatedError(x.ErrorKind.Internal,x.ErrorSeverity.Severe));if(R.isErrorValue(t))return Promise.resolve(t);var r=AppMagic.Utility.clone(e,!0,!0);try{return Promise.resolve(t(r))}catch(e){return this._logError("TabularDataSource._runProjectionAsync",e,"projection function threw an exception."),Promise.resolve(x.ErrorValue.createGatedError(x.ErrorKind.Unknown,x.ErrorSeverity.Severe))}},t.prototype._sendUpdateAsync=function(e,t,r){return null===r||R.isErrorValue(r)?Promise.resolve(r):this._patchRowCoreAsync(e.value,r)},t.prototype._reportDataSourceLoadErrorMessage=function(t){t instanceof E.TabularDataError&&t.errorKind===E.ConnectedDataErrorKind.ComponentDisposed||e.prototype._reportDataSourceLoadErrorMessage.call(this,t)},t.prototype.errors=function(e){if(Core.Utility.isUndefined(e))return this._getFullErrorTable();if(null===e)return null===this._missingKeyErrors&&(this._missingKeyErrors=N.createTyped(),this.dataRuntime.assignTableID(this._missingKeyErrors)),this._missingKeyErrors;if(!this.primaryTable.hasValidPrimaryKey(e))return this._missingKeyErrors||Object(f.create)();var t=this.primaryTable.getPrimaryKey(e);return this._errors[t]||Object(f.create)()},t.prototype._loadingInitialDataAsync=function(){var e=this;return this.primaryTable.capabilities.isPagable?(this._logVerbose("TabularDataSource._loadingInitialDataAsync","Not loading initial cached data for pagable data source."),this._onDataLoaded(),Promise.resolve()):(this._logVerbose("TabularDataSource._loadingInitialDataAsync","Loading initial cached data."),this._loadingInitialDataJob=new Core.AsyncOperation("TabularDataSource._loadingInitialDataJob",(function(){return e._refreshCoreAsync().then((function(){e._loadingInitialDataJob=null,e._onDataLoaded()}),(function(t){Core.PromiseUtils.throwIfCanceled(t),e._logError("TabularDataSource._loadingInitialDataJob",t),e._loadingInitialDataJob=null,t instanceof E.TabularDataError&&t.errorKind===E.ConnectedDataErrorKind.InvalidRequest?AppMagic.AuthoringTool.Runtime.reportRuntimeError(null,t.serverErrorMessage,t,!0):e._reportDataSourceLoadErrorMessage(t)}))})),this._loadingInitialDataJob.start(),Promise.resolve())},t.prototype._onDataChanged=function(){this._queryDataProvider.clearQueriesForEntity(this.name),e.prototype._onDataChanged.call(this)},t.prototype._doesRowExist=function(e){var t=this.primaryTable.getPrimaryKey(e);return this._memStorage.contains(t)},t.prototype._serverRowToClientRow=function(e){for(var r=e,n=F.makeEntityRecordSameAsOther(P.create(),r),a=this.primaryTable.columns,o=0,i=a.length;o<i;++o)t._cloneColumn(a[o],r,n);return this.dataRuntime.assignRowID(n),n},t.prototype._refreshRowAsync=function(e,t){return this.connector.getRowAsync(t.value).then((function(e){return function(e,t){return{key:e,serverRow:t,kind:a.Changed}}(t.key,e)}),(function(r){if(Core.Utility.isCanceledError(r))return function(){return{kind:a.Cancelled}}();switch(r.errorKind){case E.ConnectedDataErrorKind.ItemNotModified:return function(e){return{key:e,kind:a.NotModified}}(t.key);case E.ConnectedDataErrorKind.ItemNotFound:return function(e){return{key:e,kind:a.Deleted}}(t.key);default:return function(e,t,r){var n=Object(E.tryConvertErrorToErrorValue)(e,r,AppMagic.Strings.NetworkErrorRefresh,"Refresh");return{kind:a.NetworkError,key:t,errorValue:n}}(e,t.key,r)}}))},t.prototype._getPatchOperationKind=function(e,t){for(var r=this.primaryTable.keyColumns,a=0,o=r.length;a<o;++a){var i=r[a].name,s=e[i];if(Core.Utility.isNullOrUndefined(s))return n.Create;var c=t[i];Core.Utility.isNullOrUndefined(c)}return n.Patch},t.prototype._addRowToDataSource=function(e){var t=this.primaryTable.getPrimaryKey(e);this._memStorage.add(t,e);var r=this._serverRowToClientRow(e);return this._dataTableInternal.push(r),r},t.prototype._patchRowInDataSource=function(e,t){e.value=t;var r=this._serverRowToClientRow(t);return this._clearErrorsForKey(e.key),this.isDelegable||Object(c.releaseBlobs)(this._dataTableInternal[e.index]),this._dataTableInternal[e.index]=r,r},t.prototype._replaceRowInDataSource=function(e,t){var r=this.primaryTable.getPrimaryKey(t),n=this._memStorage.replace(e.key,r,t),a=this._serverRowToClientRow(t);return this._clearErrorsForKey(e.key),this.isDelegable||Object(c.releaseBlobs)(this._dataTableInternal[e.index]),this._dataTableInternal[n.index]=a,a},t.prototype._updateRowInDataSource=function(e,t){var r=this.primaryTable.getPrimaryKey(t);return e.key===r?this._patchRowInDataSource(e,t):this._replaceRowInDataSource(e,t)},t.prototype._deleteRowInDataSource=function(e){var t=this._memStorage.remove(e);this.isDelegable||Object(c.releaseBlobs)(this._dataTableInternal[t.index]),this._clearErrorsForKey(e),this._dataTableInternal.splice(t.index,1)},t.prototype._deleteRowsInDataSourceByIndex=function(e){for(var t=this._dataTableInternal,r=this._memStorage.getAll(),n=0,a=e.length;n<a;++n){var o=e[n],i=r[o];this._clearErrorsForKey(i.key),this.isDelegable||Object(c.releaseBlobs)(t[o])}Object(c.arrayBulkRemove)(t,e),this._memStorage.bulkRemoveByIndex(e)},t.prototype._setErrorsForKey=function(e,t){var r=this._errors[e];r&&Object(f.dispose)(r),this._errors[e]=t,this._fullErrorTable=null},t.prototype._clearErrorsForKey=function(e){var t=this._errors[e];return!!t&&(Object(f.dispose)(t),delete this._errors[e],this._fullErrorTable=null,!0)},t.prototype._setMissingKeyError=function(e){this._clearMissingKeyErrors(),this._missingKeyErrors=N.createTyped(),this._missingKeyErrors.push(e),this.dataRuntime.assignTableID(this._missingKeyErrors),this._fullErrorTable=null},t.prototype._setMissingKeyErrors=function(e){var t=this._clearMissingKeyErrors();return e&&e.length>0&&(this._missingKeyErrors=e,this.dataRuntime.assignTableID(this._missingKeyErrors),this._fullErrorTable=null,t=!0),t},t.prototype._clearMissingKeyErrors=function(){return null!==this._missingKeyErrors&&0!==this._missingKeyErrors.length&&(Object(f.dispose)(this._missingKeyErrors),this._missingKeyErrors=null,this._fullErrorTable=null,!0)},t.prototype._getFullErrorTable=function(){if(null!==this._fullErrorTable)return this._fullErrorTable;this._fullErrorTable=N.createTyped(),this.dataRuntime.assignTableID(this._fullErrorTable);var e=HashTableUtility.getValues(this._errors);return null!==this._missingKeyErrors&&e.push(this._missingKeyErrors),this._fullErrorTable=this._fullErrorTable.concat.apply(this._fullErrorTable,e),this._fullErrorTable},t.prototype._validateServerRow=function(e,t,r){for(var n=null,a=0,o=e.length;a<o;++a){var i=e[a],s=i.name,c=t[s];if(i.creation===AppMagic.Data.CreationKind.ServerGenerated&&Core.Utility.isValue(c)){this._logWarning("TabularDataSource._validateServerRow","Server generated column should not have a value.");var u=Object(p.columnGenerated)(r,s);n=Object(f.add)(n,u)}else if(i.isInvalidForUpdate&&Core.Utility.isValue(c)){if(Core.Utility.isValue(c)){this._logWarning("TabularDataSource._validateServerRow","Column is not valid for update.");u=Object(p.columnInvalidForUpdate)(null,s);n=Object(f.add)(n,u)}}else{var l=i.constraints.validate(c,s);if(R.isErrorValue(l))return l;if(null!==l){this._logWarning("TabularDataSource._validateServerRow","Row failed client validation.");u=Object(p.columnValueInvalid)(r,s,l[0].message,l[0].error);n=Object(f.add)(n,u)}}}return n},t.prototype._disposing=function(){Core.Telemetry.Log.trackActivityEvent("TabularDataSource[{0}]._disposing.",{datasourceName:this.name}),null!==this._missingKeyErrors&&Object(f.dispose)(this._missingKeyErrors),null!==this._refreshDataJob&&this._refreshDataJob.dispose(),null!==this._loadingInitialDataJob&&this._loadingInitialDataJob.dispose(),this._queryDataProvider.clearQueriesForEntity(this.name,!0),HashTableUtility.forEach(this._errors,f.dispose),this.connector.dispose(),e.prototype._disposing.call(this)},t.prototype._reportAnyRuntimeErrors=function(e,t){var r=e.errors;if(r&&r.length>0){var n=Object(p.formatDataSourceError)(r[0]);this.dataRuntime.reportRuntimeError(t,n)}},t.prototype._reportAnyRemoveRuntimeErrors=function(e,t){if(e.error){var r=Object(p.formatDataSourceError)(e.error);this.dataRuntime.reportRuntimeError(t,r)}},t.prototype._logErrorValue=function(e,t,r){void 0===r&&(r=null);var n=this._tryExtractError(t);this._logError(e,null==n?void 0:n.error,r)},t.prototype._tryExtractError=function(e){var t,r=AppMagic.Data.ErrorValue.tryGetReportableRuntimeError(e);if((null==r?void 0:r.error)||(null==r?void 0:r.errorMessage))return{error:null!==(t=r.error)&&void 0!==t?t:new Error(r.errorMessage)}},t.prototype._logError=function(e,t,r){if(void 0===r&&(r=null),r="[".concat(this.name,"] ").concat(r||""),t){var n=Core.Telemetry.Utility.scrubSensitiveDataFromError(t,["serverErrorMessage"]);Core.Log.errorEx(e,r,{error:n,eventData:{isFatal:Core.Utility.isValue(t.isExpectedError)?!t.isExpectedError:null}})}else Core.Log.errorEx(e,r)},t.prototype._logWarning=function(e,t){t="[".concat(this.name,"] ").concat(t),Core.Log.warning(e,t)},t.prototype._logWarningValue=function(e,t,r){t="[".concat(this.name,"] ").concat(t);var n=this._tryExtractError(r);Core.Log.warningEx(e,t,n)},t.prototype._logVerbose=function(e,t){Core.Log.verbose("{0}: [{1}] {2}",e,this.name,t)},t}(u.AppDataSource)},function(e,t,r){"use strict";r.r(t),r.d(t,"getPredicates",(function(){return i})),r.d(t,"getConditions",(function(){return s})),r.d(t,"getIndices",(function(){return c})),r.d(t,"getIndicesAsync",(function(){return u})),r.d(t,"removeIndices",(function(){return l})),r.d(t,"removeRows",(function(){return d})),r.d(t,"removeDValueRows",(function(){return p}));var n=r(0),a=r(1),o=(r(23),r(5));function i(e){for(var t=[],r=0,n=e.length;r<n;r++){var a=e[r];if(null===a)return null;t.push(a)}return t}function s(e){for(var t=[],r=0,n=e.length;r<n;r++){var a=e[r];if(null===a)return null;t.push(a)}return t}function c(e,t){for(var r=[],n=t.length,o=e.length;--o>=0;){for(var i=e[o],s=!0,c=0;c<n;++c){var u=(0,t[c])(i);if(Object(a.AppMagicDataErrorValue_isErrorValue)(u))return u;if(!u){s=!1;break}}s&&(r[o]=!0)}return r}function u(e,t){return __awaiter(this,void 0,Promise,(function(){var r,o,i,s,c;return __generator(this,(function(u){switch(u.label){case 0:return[4,Object(n.PromiseUtility_join)(e.map((function(e){return function(e,t){for(var r=Promise.resolve(!0),n=0,a=t.length;n<a;++n)r=r.then(y.bind(this,e,t[n]));return r.then(null,f)}(e,t)})))];case 1:for(r=u.sent(),o=[],i=0,s=r;i<s.length;i++){if(c=s[i],Object(a.AppMagicDataErrorValue_isErrorValue)(c))return[2,c];o.push(c)}return[2,o]}}))}))}function l(e,t){if(0===t.length)return!1;for(var r=0,n=0;n<e.length;n++)!0===t[n]?Object(o.releaseBlobs)(e[n]):e[r++]=e[n];return e.splice(r,e.length-r),!0}function d(e,t,r){return r?function(e,t){for(var r=!1,a=t.length,i=e.length;--i>=0;)for(var s=e[i],c=0;c<a;++c){var u=t[c];if(Object(n.deepCompare)(s,u)){Object(o.releaseBlobs)(s),e.splice(i,1),r=!0;break}}return r}(e,t):function(e,t){for(var r=!1,a=e.length,i=0,s=t.length;i<s;++i)for(var c=t[i],u=0;u<a;++u){var l=e[u];if(Object(n.deepCompare)(l,c)){Object(o.releaseBlobs)(l),e.splice(u,1),r=!0;break}}return r}(e,t)}function p(e,t,r){var i=t.reduce((function(t,i){var s=t[0],c=t[1],u=t[2];return Object(a.AppMagicDataErrorValue_isErrorValue)(i)?!function(e,t,r){for(var n=[],o=0;o<e.length;o++){var i=e[o];if(Object(a.AppMagicDataErrorValue_isErrorValue)(i)&&i._errorValue_id_F84D7143755C4438===t._errorValue_id_F84D7143755C4438&&(n.push(o),!r))break}if(0===n.length)return!1;for(;n.length>0;)e.splice(n.pop(),1);return!0}(e,i,r)?c.push(i):s.push(i):!function(e,t,r){for(var i=[],s=0;s<e.length;s++){var c=e[s];if(!Object(a.AppMagicDataErrorValue_isErrorValue)(c)&&Object(n.deepCompare)(c,t)&&(i.push(s),!r))break}if(0===i.length)return!1;for(;i.length>0;){var u=i.pop();Object(o.releaseBlobs)(e[u]),e.splice(u,1)}return!0}(e,i,r)?Object(a.isBlankValue)(i)||u.push(i):s.push(i),[s,c,u]}),[[],[],[]]);return{removedRows:i[0],invalidErrorRows:i[1],invalidRecords:i[2]}}function f(){var e,t=Object(n.CoreUtility_formatString)(AppMagic.Strings.InvalidFunctionUsage_InternalErrorGeneric,"RemoveIf");return null!==(e=Object(a.createGatedError)(a.ErrorKind.Unknown,a.ErrorSeverity.Severe,t,AppMagic.AuthoringTool.Runtime.tryCreateGatedReportRuntimeError({errorContext:null,errorMessage:t,skipDisplayRuntimeError:!0,functionName:"RemoveIf"})))&&void 0!==e&&e}function y(e,t,r){return!0!==r?Promise.resolve(r):Promise.resolve(t(e))}},function(e,t,r){"use strict";r.r(t),r.d(t,"CdsDataSource",(function(){return S}));var n=r(0),a=r(90),o=r(57),i=r(10),s=r(14),c=r(4),u=r(44),l=r(16),d=r(8),p=r(22),f=r(18),y=r(37),g=AppMagic.Data,h=AppMagic.Data.ConnectedDataConstants,m=AppMagic.Data.ErrorKind,v=AppMagic.Data.ErrorSeverity,b=(AppMagic.Data.DataRecord,AppMagic.Data.DataEntityRecord),_=AppMagic.Data.DataTable,C=AppMagic.Data.PolymorphicLookup,A=AppMagic.Data.KeyKind,S=function(e){function t(t,r,n,a,o,i,s,u,l,d,p,f,y){var g=e.call(this,t,n,c.DataSourceKind.CdsNativeDataSource,o,i,s,u,p,y)||this;return g._logicalName=r,g._entitySetName=a,g._dataset=l,g._isHidden=d,g._cdsMetadataProvider=f,null===d&&(g._isHidden=!1),g._setData(_.create()),g}return __extends(t,e),Object.defineProperty(t.prototype,"_tryGetPrivilegeMetadata",{get:function(){var e=this.primaryTable;return null==e?void 0:e.privileges},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"logicalName",{get:function(){return this._logicalName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"requiresAsync",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entitySetName",{get:function(){return this._entitySetName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isHidden",{get:function(){return this._isHidden},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serviceTType",{get:function(){return this.dataset.typesManager.getType(h.TypesManagerPrefix,this.primaryTable.logicalName)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDelegable",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPagable",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connector",{get:function(){return this._primaryConnector},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataset",{get:function(){return this._dataset},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"protocol",{get:function(){return"cds"},enumerable:!1,configurable:!0}),t.prototype.getNavigatedQueriedTableAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var o,i,s,c,y,h,_,C,A,S,D,O,E;return __generator(this,(function(T){switch(T.label){case 0:T.label=1;case 1:return T.trys.push([1,4,,5]),o=b.getTableName(e),i=b.getCanonicalId(e),s=this._dataset.tryGetCdsDataSourceByLogicalName(o),Object(n.checkObject)(s,"Data source for base table name '".concat(o,"' should exist in dataset ").concat(this._dataset.name,".")),c=s.tryGetTableMetadata(),y=c.navigationColumns[t],Object(n.checkDefined)(y,"Expected column '".concat(t,"' to be a navigation column in table '").concat(o,"'.")),h=this._dataset.tryGetCdsDataSourceByLogicalName(y.targetTableName),Object(n.checkObject)(h,"Document should have already imported data source for column ".concat(t,".")),_=h.connector,r||(r=new p.TableQueryOptions),[4,this._preProcessOptionsAsync(h,r)];case 2:return T.sent(),(C=new n.UrlBuilder).appendPath("".concat(s.entitySetName,"(").concat(s.connector.metadata.getPrimaryKey(e),")")),C.appendPath("".concat(t)),[4,_.queryStringBuilder.getStringParametersAsync(r)];case 3:return A=T.sent(),C.setQueryParams(A),S={sourceType:d.SourceType.CdsNavigatedColumnArrayQueryDefinition,dataSourceName:s.name,tableName:h.entitySetName,columnName:t,itemKey:i,requestUrl:C.doneToString(),responseParams:Object(a.createGetRowsResponse)(this._dataset.typesManager,s.name,h.logicalName),queryOptions:r,tableLogicalName:h.logicalName},D=new l.NavigatedArrayCacheableQuery(S),O=new f.ReadOnlyCdsNativeNavigatedRowRetrieverConnector(s.connector,h.connector),[2,new u.CdsNavigatedQueriedTable(this,_,this.dataRuntime,this._queryDataProvider,D,O,e,t)];case 4:return E=T.sent(),this._logError("CdsDataSource.getNavigatedQueriedTableAsync",E),[2,g.ErrorValue.createGatedError(m.Unknown,v.Severe,Object(n.formatErrorMessage)(E))];case 5:return[2]}}))}))},t.prototype.getPrimaryKey=function(e){return this.connector.metadata.getPrimaryKey(e)},t.prototype.tryGetPrimaryKey=function(e){return this.connector.metadata.tryGetPrimaryKey(e)},t.prototype.getDefaultRecord=function(){var t=e.prototype.getDefaultRecord.call(this);return g.DataEntityRecord.makeUncommittedEntityRecord(t,this.connector.entityType,this.primaryTable.name,"cdsNative")},t.prototype._refreshCoreAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){try{this.cleanInternalDataSource()}catch(e){this._logError("CdsDataSource._refreshCoreAsync",e,"Error when cleaning up tabular cache.")}return[2]}))}))},t.prototype.tryGetTableMetadata=function(){return this.primaryTable},t.prototype._tryGetConnectorForTable=function(e){return this._primaryConnector},Object.defineProperty(t.prototype,"canUserEditAsync",{get:function(){var e;return this.getUserPrivilegeForEntityAsync(null===(e=this._tryGetPrivilegeMetadata)||void 0===e?void 0:e.Write)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canUserCreateAsync",{get:function(){var e;return this.getUserPrivilegeForEntityAsync(null===(e=this._tryGetPrivilegeMetadata)||void 0===e?void 0:e.Create)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canUserDeleteAsync",{get:function(){var e;return this.getUserPrivilegeForEntityAsync(null===(e=this._tryGetPrivilegeMetadata)||void 0===e?void 0:e.Delete)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canUserReadAsync",{get:function(){var e;return this.getUserPrivilegeForEntityAsync(null===(e=this._tryGetPrivilegeMetadata)||void 0===e?void 0:e.Read)},enumerable:!1,configurable:!0}),t.prototype.getChoicesAsync=function(e,t,r){var a;return void 0===r&&(r=null),__awaiter(this,void 0,Promise,(function(){var o,i,s,c,u,l,d;return __generator(this,(function(p){switch(p.label){case 0:if(!(o=this.primaryTable.tryGetColumn(t))||!this.IsOptionSetColumn(o)&&!o.isNavigation)return i=AppMagic.Strings.ErrUnknownErrorGettingChoices,s=AppMagic.AuthoringTool.Runtime.tryCreateGatedReportRuntimeError({errorContext:e,errorMessage:i,skipDisplayRuntimeError:!0,functionName:"Choices"}),g.ErrorValue.isErrorHandlingFeatureEnabled()||this.dataRuntime.reportRuntimeError(e,i),this._logError("CdsDataSource.getChoicesAsync",Object(n.throwInline)(new Error("The column does not exist or it is not optionSet or navigation: ".concat(t,".")))),[2,g.ErrorValue.createGatedError(g.ErrorKind.InvalidFunctionUsage,g.ErrorSeverity.Severe,i,s)];c=this.dataRuntime.startAsyncDataAction(),p.label=1;case 1:return p.trys.push([1,6,7,8]),u=void 0,this.IsOptionSetColumn(o)?[4,this._getOptionSetChoicesAsync(o,e)]:[3,3];case 2:return u=p.sent(),n.FeatureGates_controls.allowSearchInComboBoxChoicesOptionSet&&r?(l=[],null===(a=u.results)||void 0===a||a.forEach((function(e){var t,n=null===(t=e.Value.Value)||void 0===t?void 0:t.toLowerCase();(null==n?void 0:n.includes(r.toLowerCase()))&&l.push(e)})),[2,l]):[2,u.results];case 3:return o.isNavigation?[4,this._getNavigationChoicesAsync(e,o)]:[3,5];case 4:return[2,p.sent()];case 5:return[3,8];case 6:return d=p.sent(),[2,this._handleGetChoicesError(d,e)];case 7:return this.dataRuntime.endAsyncDataAction(c),[7];case 8:return n.CoreLog.errorEx("CdsDataSource.getChoicesAsync",{message:"Type of column is not valid for choices function. Column Name: ".concat(o,".")}),[2,null]}}))}))},t.prototype._getOptionSetChoicesAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){switch(r.label){case 0:r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this._cdsMetadataProvider.getOptionSetChoicesAsync(e.name,this.connector.metadata.name,t)];case 2:return[2,r.sent()];case 3:return r.sent(),n.CoreLog.warning("CdsDataSource._getOptionSetChoicesAsync","Fallback to get optionset from column metadata."),[2,{results:e.optionSetValues}];case 4:return[2]}}))}))},t.prototype._getNavigationChoicesAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,a,o;return __generator(this,(function(i){switch(i.label){case 0:return(r=this._dataset.tryGetCdsDataSourceByLogicalName(t.targetTableName))?[4,r.queryTableAsync()]:(a=AppMagic.Strings.ErrUnknownErrorGettingChoices,g.ErrorValue.isErrorHandlingFeatureEnabled()||this.dataRuntime.reportRuntimeError(e,a),this._logError("CdsDataSource._getNavigationChoices",Object(n.throwInline)(new Error("The data source does not exist for navigation table: ".concat(t.targetTableName,".")))),o={errorContext:e,errorMessage:a,raiseToastNotification:!1,wasReported:!1,functionName:null},[2,g.ErrorValue.createGatedError(g.ErrorKind.InvalidFunctionUsage,g.ErrorSeverity.Severe,a,o)]);case 1:return[2,i.sent().getNextResultsAsync(e,this.maxGetRowsCount(),!1)]}}))}))},t.prototype._preProcessOptionsAsync=function(e,r){return __awaiter(this,void 0,Promise,(function(){var n,a,i,s=this;return __generator(this,(function(c){switch(c.label){case 0:return n=e.primaryTable,a=!1,r.filter?(i=Object(o.getCdsViewIdFromFilterQuery)(r.filter))?n.viewSet.viewsNotSupportingBinary?[3,2]:[4,this.getViewChoicesAsync(null)]:[3,3]:[3,3];case 1:c.sent(),c.label=2;case 2:a=n.viewSet.viewsNotSupportingBinary&&!!n.viewSet.viewsNotSupportingBinary[i],c.label=3;case 3:return i&&(r.selects=t._processSelectsForView(this._dataset,e.logicalName,r.selects,a),r.expands&&r.expands.length>0&&r.expands.forEach((function(r){var n=e.primaryTable.columns.find((function(e){return e.name===r.propertyName}));n&&(r.selects=t._processSelectsForView(s._dataset,n.targetTableName,r.selects,a))}))),[2]}}))}))},t._processSelectsForView=function(e,t,r,a){if(r&&r.length>0&&a){var o=e.tryGetCdsDataSourceByLogicalName(t);if(o){var i=Object(n.HashTableUtility_create)();r.forEach((function(e){return i[e]=e})),o.primaryTable.columns.forEach((function(e){(e.isBlob||e.isImageColumn)&&delete i[e.name]})),r=Object(n.HashTableUtility_getValues)(i)}}return r&&0!==r.length?r:["*"]},t.prototype._createTabularCachableQueryAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var r,n;return __generator(this,(function(a){switch(a.label){case 0:return[4,this.connector.getConnectorTypeNameAsync()];case 1:return r=a.sent().tableName,e=null!=e?e:new p.TableQueryOptions,[4,this._preProcessOptionsAsync(this,e)];case 2:return a.sent(),n={dataSourceName:this.name,queryOptions:e,tableLogicalName:this.connector.metadata.name,sourceType:d.SourceType.CdsQueryDefinition,tableName:r,queryStringBuilder:this._primaryConnector.queryStringBuilder},[2,new l.TabularCachableQuery(n,{maxQueryStringLength:t._maxAllowedUrlSize})]}}))}))},t.prototype._postProcessEditColumn=function(e,t,r){},t.prototype._tryBindNavigation=function(e,t,r,n){if(null===t)return e[r]=null,!0;if(g.DataEntityRecord.isODataEntityRecordPointer(t))return e[r]=t,!0;if(!g.DataEntityRecord.tryGetEntitySetName(t)){var a="Data entity record for column ".concat(r," should have entitySetName value set.");this._logWarning("CdsDataSource._tryBindNavigation",a);var o=Object(i.columnValueInvalid)(e,r,a,m.Validation);return Object(s.add)(n,o),!1}return e[r]=t,!0},t.prototype._getRelateUnrelateInfo=function(e,t){var r=g.DataEntityRecord.getCanonicalId(e);if(!r)throw new Error("Could not parse serialized parentEntityKey. It may be corrupted. parentDataSource: '".concat(g.DataEntityRecord.getDataSourceName(e),"'"));var n=g.DataEntityRecord.getCanonicalId(t),a=g.DataEntityRecord.tryGetEntitySetName(t),o=null;return a?o="".concat(a,"(").concat(n,")"):this._logWarning("CdsDataSource._getRelateUnrelateInfo","Target data entity record with id ".concat(n," should have entitySetName value set.")),{parentEntityKey:r,targetEntityKey:n,targetOdataId:o}},t.prototype.getViewChoicesAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,a,o,i,s,c;return __generator(this,(function(u){switch(u.label){case 0:t=this.dataRuntime.startAsyncDataAction(),u.label=1;case 1:return u.trys.push([1,3,4,5]),[4,this._cdsMetadataProvider.getViewChoicesAsync(this.name,this.logicalName,e)];case 2:return r=u.sent(),(a=r.results)&&(o=Object(n.HashTableUtility_create)(),i=[],a.forEach((function(e){i.push({id:e.Value.Id,name:e.Value.Value}),e.Value.DoesNotSupportBinary&&(o[e.Value.Id]=e.Value.Value)})),(s=this.primaryTable).viewSet.views=i,s.viewSet.viewsNotSupportingBinary=o),[2,a];case 3:return c=u.sent(),[2,this._handleGetChoicesError(c,e)];case 4:return this.dataRuntime.endAsyncDataAction(t),[7];case 5:return[2]}}))}))},t.prototype.getPolymorphicLookupAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,a,o;return __generator(this,(function(i){switch(i.label){case 0:return null===(r=C.getPolymorphicValue(t))?[2,g.ErrorValue.createGatedError(g.ErrorKind.InvalidFunctionUsage,g.ErrorSeverity.Moderate,AppMagic.Strings.InvalidCast,AppMagic.AuthoringTool.Runtime.tryCreateGatedReportRuntimeError({errorContext:e,errorMessage:AppMagic.Strings.InvalidCast,functionName:null}))]:(n=null,this.primaryTable.keyColumns.forEach((function(e){if(e.keyKind===A.Primary){var t=e.name;n=t}})),null===n?[3,2]:(a=new l.CdsPolymorphicCacheableQuery({sourceType:d.SourceType.CdsPolymorphicQueryDefinition,dataSourceName:this.name,tableName:this.primaryTable.name,columnName:n,key:r}),[4,this._queryDataProvider.getDataAsync(new f.ReadOnlyCdsNativePolymorphicLookupConnector(this.connector),this.name,a,e,1,0)]));case 1:if((o=i.sent()).results&&1===o.results.length)return[2,o.results[0]];i.label=2;case 2:return[2,g.ErrorValue.createGatedError(g.ErrorKind.InvalidFunctionUsage,g.ErrorSeverity.Moderate,AppMagic.Strings.InvalidCast,AppMagic.AuthoringTool.Runtime.tryCreateGatedReportRuntimeError({errorContext:e,errorMessage:AppMagic.Strings.InvalidCast,functionName:null}))]}}))}))},t.prototype._tryBindPolymorphic=function(e,t,r,a,o){if(null===a)return null!==e&&(t[r.name]=null,!0);if(!b.isDataEntityRecord(a)){if(C.isODataPointer(a))return t[r.name]=a,!0;var c="Data entity record for column ".concat(r.name," should be valid.");this._logWarning("CdsDataSource._tryBindPolymorphic",c);var u=Object(i.columnValueInvalid)(t,r.name,c,m.Validation);return Object(s.add)(o,u),!1}var l=b.getTableName(a),d=g.DataEntityRecord.getCanonicalId(a);if(Object(n.isNotNull)(e)&&Object(n.isNotNull)(e[r.name])){var p=e[r.name];if(l===(null==p?void 0:p.Type)&&d===(null==p?void 0:p.Value))return!1}var f=r.tryGetNavPropertyName(l);if(!f){c="Data entity record for column ".concat(r.name," should have targetNavigationPropertyNames value set.");this._logWarning("CdsDataSource._tryBindPolymorphic",c);u=Object(i.columnValueInvalid)(t,r.name,c,m.Validation);return Object(s.add)(o,u),!1}var y=b.tryGetEntitySetName(a);if(!y){c="Data entity record for column ".concat(r.name," should have entitySetName value set.");this._logWarning("CdsDataSource._tryBindPolymorphic",c);u=Object(i.columnValueInvalid)(t,r.name,c,m.Validation);return Object(s.add)(o,u),!1}var h={Type:l,Value:d,NavigationPropertyName:f,EntitySetName:y};return t[r.name]=h,!0},t.prototype.IsOptionSetColumn=function(e){return!0===e.isOptionSet},t.prototype._disposing=function(){n.Log.trackActivityEvent("CdsDataSource[{0}]._disposing.",{datasourceName:this.name}),this._cdsMetadataProvider.dispose(),this._cdsMetadataProvider=null,e.prototype._disposing.call(this)},t.prototype.getUserPrivilegeForEntityAsync=function(e){var t;return __awaiter(this,void 0,Promise,(function(){var r,n,a,o,i;return __generator(this,(function(s){switch(s.label){case 0:r=!0,n="CdsDataSource.getUserPrivilegeForEntityAsync",s.label=1;case 1:return s.trys.push([1,3,,4]),(a=this.connector.metadata.name)&&e?[4,this._cdsMetadataProvider.getUserPrivilegeForEntityAsync(a,e,0)]:("Invalid arguments in datasourceInfo function",this._logWarning(n,"Invalid arguments in datasourceInfo function"),[2,!0]);case 2:return o=s.sent(),r=!!(null===(t=null==o?void 0:o.results[0])||void 0===t?void 0:t.value),[3,4];case 3:return i=s.sent(),this._logWarning(n,"Error retrieving User Entity privilege ".concat(e," for the current user")+i),[3,4];case 4:return[2,r]}}))}))},t.prototype.getUserPrivilegeForRecordAsync=function(e,t){var r;return __awaiter(this,void 0,Promise,(function(){var n,a,o;return __generator(this,(function(i){switch(i.label){case 0:n="CdsDataSource.getUserPrivilegeForRecordAsync",a=!0,i.label=1;case 1:return i.trys.push([1,3,,4]),e&&t?[4,this._cdsMetadataProvider.getUserPrivilegeForRecordAsync(this.connector.metadata.name,e,t)]:("Invalid arguments in RecordInfo function",this._logWarning(n,"Invalid arguments in RecordInfo function"),[2,!0]);case 2:return o=i.sent(),a=!!(null===(r=null==o?void 0:o.results[0])||void 0===r?void 0:r.value),[3,4];case 3:return i.sent(),this._logWarning(n,"Error retrieving Record privilege ".concat(e," for the current user")),[3,4];case 4:return[2,a]}}))}))},t.prototype.getLocalizedDisplayNamesAsync=function(e,t){var r;return __awaiter(this,void 0,Promise,(function(){var n,a,o,i;return __generator(this,(function(s){switch(s.label){case 0:n="CdsDataSource.getLocalizedDisplayNamesAsync",a={},s.label=1;case 1:return s.trys.push([1,3,,4]),e&&t?[4,this._cdsMetadataProvider.getLocalizedDisplayNamesAsync(e,t)]:(i="Invalid arguments in DataSourceInfo function",this._logWarning(n,i),[2,{}]);case 2:return o=s.sent(),a=(null===(r=null==o?void 0:o.results[0])||void 0===r?void 0:r.value)||{},[3,4];case 3:return s.sent(),i="Unable to retrieve the localized label for columns ".concat(t.toString()," and entity ").concat(e),this._logWarning(n,i),[2,{}];case 4:return[2,a]}}))}))},t.prototype.retrieveAllColumnLocalizationInformationAsync=function(e){var t,r,n;return __awaiter(this,void 0,Promise,(function(){var a,o,i,s,c,u,l,d,p,f,y,g,h,m;return __generator(this,(function(v){switch(v.label){case 0:for(h in e);if(this._cdsMetadataProvider instanceof AppMagic.Data.NativeCdsMetadataProvider)return[2,{}];a="CdsDataSource.retrieveAllColumnLocalizationInformationAsync",o={},i=Core.Globalization.currentCulture().currentLocaleName,v.label=1;case 1:for(c in v.trys.push([1,6,,7]),o[i]={},s=[],e)s.push(c);u=0,v.label=2;case 2:return u<s.length?(h=s[u],o[i][h]={},[4,this._cdsMetadataProvider.getLocalizedDisplayNamesAsync(h,e[h])]):[3,5];case 3:for(l=v.sent(),d=0,p=e[h];d<p.length;d++)f=p[d],o[i][h][f]=(null===(r=null===(t=null==l?void 0:l.results[0])||void 0===t?void 0:t.value)||void 0===r?void 0:r[f])||"";v.label=4;case 4:return u++,[3,2];case 5:return[3,7];case 6:for(h in v.sent(),y=null===(n=Object.keys(e))||void 0===n?void 0:n.toString(),g=[],e)g.push(e[h]);return m="Unable to retrieve localization info for all columns required: ".concat(g.toString()," for entities ").concat(y," and language ").concat(i),this._logWarning(a,m),[2,{}];case 7:return[2,o]}}))}))},t._maxAllowedUrlSize=8192,t}(y.TabularDataSource)},function(e,t,r){"use strict";function n(e,t,r,n,a,o){void 0===o&&(o=null);var i=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.CurrentAppInstanceFunctionSingletonKey)().userDefinedFunctions.getOrCreateNamespace(e),s=i.getFunction(t,!1);if(s&&!n||(s=i.addOrReplace(t,r)),a){var c=p(o,0);return s.execute(c,o)}return null}function a(e,t){var r=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.CurrentAppInstanceFunctionSingletonKey)().userDefinedFunctions.getNamespace(e,!1);if(r){var n=r.getFunction(t,!1);n&&(n.dispose(),r.deleteFunction(t))}}function o(e){var t=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.CurrentAppInstanceFunctionSingletonKey)(),r=t.userDefinedFunctions.getNamespace(e,!1);r&&(r.dispose(),t.userDefinedFunctions.deleteNamespace(e))}function i(e,t,r){var n=s(e,t);if(!n)return null;var a=p(r,0);return n.execute(a,r)}function s(e,t){var r=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.CurrentAppInstanceFunctionSingletonKey)().userDefinedFunctions.getNamespace(e,!1);if(!r)return null;var n=r.getFunction(t,!1);return n||null}function c(e,t){return!!s(e,t)}function u(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(n){return[2,i(e,t,r)]}))}))}function l(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{numberOfArguments:e.length,arguments:e}}function d(e){return e.OpenAjax.uniqueId}function p(e,t){return null==e?null:e.arguments[t]}r.r(t),r.d(t,"registerFunction",(function(){return n})),r.d(t,"unRegisterFunction",(function(){return a})),r.d(t,"unRegisterNamespace",(function(){return o})),r.d(t,"executeFunction",(function(){return i})),r.d(t,"doesFunctionExist",(function(){return c})),r.d(t,"executeFunctionAsync",(function(){return u})),r.d(t,"getFunctionArgs",(function(){return l})),r.d(t,"getFunctionNamespace",(function(){return d})),r.d(t,"getArgValue",(function(){return p})),globalScopeObject._duf0=n,globalScopeObject._duf1=i,globalScopeObject._duf2=l,globalScopeObject._duf3=d,globalScopeObject._duf4=p,globalScopeObject._duf5=u},function(e,t,r){"use strict";r.r(t),r.d(t,"tryGetPrimaryKeyFn",(function(){return c})),r.d(t,"isDataSourceReadOnly",(function(){return u})),r.d(t,"isSameDataSource",(function(){return l})),r.d(t,"isSameRecord",(function(){return d})),r.d(t,"mergeRecords",(function(){return p})),r.d(t,"expandsLimitErrorCode",(function(){return f})),r.d(t,"getShallowChanges",(function(){return y}));var n=r(37),a=AppMagic.Utility.deepCompare,o=Core.Utility.isNullOrUndefined,i=AppMagic.Data.DataFlow.isQueriedTable;function s(){return Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.CurrentAppInstanceFunctionSingletonKey)()}function c(e){if(i(e)&&Core.Utility.isFunction(e.tryGetPrimaryKey))return e.tryGetPrimaryKey.bind(e);var t=AppMagic.Data.DataSourceValue.tryGetAppDataSource(e);return t&&Core.Utility.isFunction(t.tryGetPrimaryKey)?t.tryGetPrimaryKey.bind(t):null}function u(e,t){if(void 0===t&&(t=s()),!AppMagic.Data.DataEntityRecord.isDataEntityRecord(e))return!1;var r=AppMagic.Data.DataEntityRecord.getDataSourceName(e),a=t.dataSources.tryGetDataSource(r);if(!a)throw new Core.InvalidOperationError("DataSource is removed.");if(!(a instanceof n.TabularDataSource))throw new Core.ApplicationError("DataSource is not tabular.");return a.connector.metadata.isReadonly}function l(e,t){if(e===t)return!0;if(o(e)||o(t))return!1;if(i(e)&&i(t))return e.dataSourceName===t.dataSourceName;if(!i(e)&&!i(t)){var r=AppMagic.Data.DataSourceValue.tryGetAppDataSource(e),n=AppMagic.Data.DataSourceValue.tryGetAppDataSource(t);if(r&&n)return r===n}var a=Core.Utility.Constants.IdProperty;return Core.Utility.isDefined(e[a])&&e[a]===t[a]}function d(e,t,r,n,i){var c,l,d,p;if(void 0===i&&(i=s()),e===t)return!0;if(o(e)||o(t))return!1;var f=AppMagic.Data.DataEntityRecord.isDataEntityRecord(e),y=AppMagic.Data.DataEntityRecord.isDataEntityRecord(t);if(f&&y)try{if(!i||!u(e,i)||!u(t,i))return AppMagic.Data.DataEntityRecord.isSameEntityRecord(e,t)}catch(e){if(e instanceof Core.InvalidOperationError)return!1;throw e}else if(!f&&!y){var g=e[AppMagic.Constants.Runtime.idProperty],h=t[AppMagic.Constants.Runtime.idProperty];if(!o(g)&&!o(h))return g===h}var m=null!==(c=e.Value)&&void 0!==c?c:null,v=null!==(l=t.Value)&&void 0!==l?l:null;if(m&&v&&m===v)return!0;var b=null!==(d=e._src)&&void 0!==d?d:e,_=null!==(p=t._src)&&void 0!==p?p:t;if(a(b,_))return!0;var C=r();return!(!C.length||!C.every((function(r){return a(n(r,e),n(r,t))})))}function p(e,t){for(var r=0,n=Object.keys(t);r<n.length;r++){var a=n[r];t[a]instanceof Object&&a in e&&Object.assign(t[a],p(e[a],t[a]))}return Object.assign(e||{},t),e}var f="0x8004430d";function y(e,t){var r={},n=[];return Object.keys(e).forEach((function(a){n.push(a),t.hasOwnProperty(a)&&e[a]===t[a]||(r[a]=e[a])})),Object.keys(t).filter((function(e){return-1===n.indexOf(e)})).forEach((function(e){r[e]=t[e]})),r}},function(e,t,r){"use strict";r.r(t),r.d(t,"CreateCdsQueryStringBuilder",(function(){return _})),r.d(t,"CreateCdpQueryStringBuilder",(function(){return C}));var n=r(0),a=r(57),o=r(66),i=r(50),s=(r(55),r(65)),c=r(2),u=r(61),l=r(3),d=r(9),p=(r(56),AppMagic.Schema),f=AppMagic.Data,y=AppMagic.Services.TypeSystem,g=AppMagic.Services.ODataConstants,h=AppMagic.Services,m=g.QueryOption.FilterOperators,v=g.QueryOption.OrderByDirections,b=g.QueryOption.ODataMetadataValues;function _(){return new O}function C(e){switch(e){case AppMagic.Services.SupportedOdataVersion.OData4:return new D;case AppMagic.Services.SupportedOdataVersion.OData3:return new S;default:return new D}}var A="formatStringWithDoubleQuotesAndEscape",S=function(){function e(){var e=this;this._operatorsToResolvers={},this._operatorsToOperatorText={},this._valueFormatters={},this._odataConstantValueFormatters={},this._treatCountAsAggregate=!1,this._overrideValueFormatters={},this.compoundFilterAsync=function(t){return __awaiter(e,void 0,Promise,(function(){var e,r,n,a,o,i;return __generator(this,(function(s){switch(s.label){case 0:return e=this._operatorsToOperatorText[t.operator],t.firstOperand.operandKind!==d.OperandKind.Filter?[3,2]:[4,this.generateFilterQueryStringAsync(t.firstOperand)];case 1:return n=s.sent(),[3,4];case 2:return[4,this.formatOperandAsync(t.firstOperand)];case 3:n=s.sent(),s.label=4;case 4:return r=n,t.secondOperand.operandKind!==d.OperandKind.Filter?[3,6]:[4,this.generateFilterQueryStringAsync(t.secondOperand)];case 5:return o=s.sent(),[3,8];case 6:return[4,this.formatOperandAsync(t.secondOperand)];case 7:o=s.sent(),s.label=8;case 8:return a=o,i="",r&&(i+="(".concat(r,")")),i&&a&&(i+="".concat(e)),a&&(i+="(".concat(a,")")),[2,i]}}))}))},this.unaryFilterAsync=function(t){return __awaiter(e,void 0,Promise,(function(){var e,r,n,a,o;return __generator(this,(function(i){switch(i.label){case 0:return(e=this._operatorsToOperatorText[t.operator])!==m.Negate?[3,2]:(n=(r="".concat(e)).concat,[4,this.formatOperandAsync(t.firstOperand)]);case 1:return[2,n.apply(r,[i.sent()])];case 2:return o=(a="".concat(e," ")).concat,[4,this.formatOperandAsync(t.firstOperand)];case 3:return[2,o.apply(a,[i.sent()])]}}))}))},this.noOperatorFilterAsync=function(t){return __awaiter(e,void 0,Promise,(function(){var e;return __generator(this,(function(r){switch(r.label){case 0:return[4,this.formatOperandAsync(t.firstOperand)];case 1:return[2,(e=r.sent())===h.ODataConstants.NullValue?"":"".concat(e)]}}))}))},this.binaryFilterAsync=function(t){return __awaiter(e,void 0,Promise,(function(){var e,r,n,a;return __generator(this,(function(o){switch(o.label){case 0:return e=this._operatorsToOperatorText[t.operator],n="".concat,[4,this.formatOperandAsync(t.firstOperand)];case 1:return a=(r=n.apply("",[o.sent()," "]).concat(e," ")).concat,[4,this.formatOperandAsync(t.secondOperand)];case 2:return[2,a.apply(r,[o.sent()])]}}))}))},this.registerOperator(c.FilterOperator.And,this.compoundFilterAsync,m.And),this.registerOperator(c.FilterOperator.Or,this.compoundFilterAsync,m.Or),this.registerOperator(c.FilterOperator.Not,this.unaryFilterAsync,m.Not),this.registerOperator(c.FilterOperator.None,this.noOperatorFilterAsync,""),this.registerOperator(c.FilterOperator.GreaterThan,this.binaryFilterAsync,m.GreaterThan),this.registerOperator(c.FilterOperator.GreaterThanOrEqual,this.binaryFilterAsync,m.GreaterThanOrEqual),this.registerOperator(c.FilterOperator.LessThan,this.binaryFilterAsync,m.LessThan),this.registerOperator(c.FilterOperator.LessThanOrEqual,this.binaryFilterAsync,m.LessThanOrEqual),this.registerOperator(c.FilterOperator.Equals,this.binaryFilterAsync,m.Equals),this.registerOperator(c.FilterOperator.NotEquals,this.binaryFilterAsync,m.NotEquals),this.registerOperator(c.FilterOperator.Sub,this.unaryFilterAsync,m.Negate),this.registerOperator(c.FilterOperator.Add,this.binaryFilterAsync,m.Add),this.registerOperator(c.FilterOperator.Mul,this.binaryFilterAsync,m.Mul),this.registerOperator(c.FilterOperator.Div,this.binaryFilterAsync,m.Div),this.registerValueFormatter(p.TypeBoolean),this.registerValueFormatter(p.TypeString,(function(e){return"'".concat(function(e){return e.replace(/\'/g,"''")}(e),"'")})),this.registerValueFormatter(p.TypeNumber),this.registerValueFormatter(p.TypeGuid),this.registerValueFormatter(p.TypeDateTime,this.dateTimeValueFormatter),this.registerValueFormatter(p.TypeDateTimeNoTimeZone,this.dateTimeNoTimeZoneValueFormatter),this.registerValueFormatter(p.TypeDate,this.dateValueFormatter),this.registerValueFormatter(p.TypeHyperlink),this.registerValueFormatter(p.TypeCurrency),this.registerValueFormatter(p.TypeOptionSetValue,this.optionSetValueFormatter),this.registerValueFormatter(p.TypeViewValue,this.viewValueFormatter),this.registerOdataConstantValueFormatter(s.OdataConstantType.Duration,(function(e){return"duration'".concat(e,"'")})),this.registerValueFormatter(p.TypeTable,this.tableValueFormatter.bind(this)),this.registerOverrideValueFormatter(A,(function(e){return JSON.stringify(e)})),this._functionQueryStringBuilder=new i.CDPFunctionQueryStringBuilder(this)}return e.prototype.formatScalarAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,a;return __generator(this,(function(o){switch(o.label){case 0:return!e.dType||Object(n.isNullOrUndefined)(e.value)?[2,g.NullValue]:(r=t?this._overrideValueFormatters[t]:this._valueFormatters[e.dType],a=r,[4,e.value]);case 1:return[2,a.apply(void 0,[o.sent()])]}}))}))},e.prototype.formatProperty=function(e){return e.propertyName},e.prototype.formatConstantAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r;return __generator(this,(function(n){switch(n.label){case 0:return t=this._odataConstantValueFormatters[e.type],r=t,[4,e.value];case 1:return[2,r.apply(void 0,[n.sent()])]}}))}))},e.prototype.generateFilterQueryStringAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){return e.firstOperand&&e.firstOperand.operandKind===d.OperandKind.Value&&e.firstOperand.dType===p.TypeViewValue?[2,""]:[2,(0,this._operatorsToResolvers[e.operator])(e)]}))}))},e.prototype.formatOperandAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,a;return __generator(this,(function(i){switch(i.label){case 0:switch(e.operandKind){case d.OperandKind.Property:return[3,1];case d.OperandKind.Value:return[3,2];case d.OperandKind.Constant:return[3,3];case d.OperandKind.Function:return[3,4];case d.OperandKind.Filter:return[3,5]}return[3,7];case 1:return[2,this.formatProperty(e)];case 2:if(r=e,AppMagic.Data.ErrorValue.isErrorHandlingFeatureEnabled()&&f.ErrorValue.isErrorValue(r.value))throw new o.ConnectedDataQueryStringBuilderError(r.value);return[2,this.formatScalarAsync(r,t)];case 3:return[2,this.formatConstantAsync(e)];case 4:return[2,this._functionQueryStringBuilder.formatFunctionTypeAsync(e)];case 5:return[4,this.generateFilterQueryStringAsync(e)];case 6:return a=i.sent(),[2,Object(n.isEmptyString)(a)?a:"(".concat(a,")")];case 7:i.label=8;case 8:return[2,""]}}))}))},e.prototype.getStringParametersAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){switch(r.label){case 0:return[4,this.getStringParametersInContextAsync(e,t)];case 1:return[2,r.sent().params]}}))}))},e.prototype.getQueryStringLengthParams=function(e){var t=new n.UrlBuilder;return t.setQueryParams(e),{size:t.toString().length,urlBuilder:t}},e.prototype.getStringParametersInContextAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,a;return __generator(this,(function(o){switch(o.label){case 0:return[4,this.getStringParametersCoreAsync(e)];case 1:return r=o.sent(),(n=this.getQueryStringLengthParams(r)).size>(null==t?void 0:t.maxQueryStringLength)?(function(e,t){void 0===t&&(t=null);e&&(e.selects=t?[t]:[],e.expands&&e.expands.forEach((function(e){return function e(t,r){void 0===r&&(r=null);t&&(t.resetSelects(r),t.expands.forEach((function(t){return e(t,r)})))}(e,t)})))}(e,r[g.QueryOption.CdsView]?"*":null),[4,this.getStringParametersCoreAsync(e)]):[3,4];case 2:return r=o.sent(),a=this.getQueryStringLengthParams,[4,this.getStringParametersCoreAsync(e)];case 3:n=a.apply(this,[o.sent()]),o.label=4;case 4:return[2,{params:r,urlBuilder:n.urlBuilder}]}}))}))},e.prototype.generateFunctionQueryStringAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){return[2,this._functionQueryStringBuilder.formatFunctionTypeAsync(e)]}))}))},e.prototype.generateCountQueryParamAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){return[2,this._functionQueryStringBuilder.formatCountAsync(e)]}))}))},e.prototype.getStringParametersWithoutAggregateAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,a,o,i;return __generator(this,(function(s){switch(s.label){case 0:return[4,this.getNormalizedFilterQueryAsync(e.filter)];case 1:return(r=s.sent())&&(t[g.QueryOption.Filter]=r),e.sorts&&(t[g.QueryOption.OrderBy]=this.generateSortQueryString(e.sorts)),e.func&&e.func.functionKind!==l.FunctionKind.Count?(n=t,a=g.QueryOption.Apply,[4,this.generateFunctionQueryStringAsync(e.func)]):[3,3];case 2:n[a]=s.sent(),s.label=3;case 3:return e.func&&e.func.functionKind===l.FunctionKind.Count?(o=t,i=g.QueryOption.Count,[4,this.generateCountQueryParamAsync(e.func)]):[3,5];case 4:o[i]=s.sent()?"true":"false",s.label=5;case 5:return e.expands&&e.expands.length>0&&(t[g.QueryOption.Expand]=T(e.expands)),e.selects&&e.selects.length>0&&(t[g.QueryOption.Select]=R(e.selects)),e.format&&(t[g.QueryOption.Format]=function(e,t){void 0===t&&(t=!1);var r,n=t?"".concat(g.QueryOption.Format,"="):"";switch(e.odataMetadata){case u.ODataMetadataEnum.None:r=b.None;break;case u.ODataMetadataEnum.Minimal:r=b.Minimal;break;case u.ODataMetadataEnum.Full:r=b.Full;break;default:var a=e.odataMetadata;throw new Error("Should not reach this. Received ".concat(a," value in generateFormatQueryString"))}return"".concat(n).concat(AppMagic.Services.HttpConstants.MediaType.ApplicationJson,";odata.metadata=").concat(r)}(e.format)),e.top&&(t[g.QueryOption.Top]="".concat(e.top)),[2,E(e,t)]}}))}))},e.prototype.isAggregateFunction=function(e){return e&&(this._treatCountAsAggregate||e.functionKind!==l.FunctionKind.Count)},e.prototype.processAggregateFunctionAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r;return __generator(this,(function(n){switch(n.label){case 0:return[4,this.generateFunctionQueryStringAsync(e)];case 1:return r=n.sent(),t?[2,"filter(".concat(t,")/").concat(r)]:[2,r]}}))}))},e.prototype.getStringParametersWithAggregatesAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,a;return __generator(this,(function(o){switch(o.label){case 0:return[4,this.getNormalizedFilterQueryAsync(e.filter)];case 1:return r=o.sent(),n=t,a=g.QueryOption.Apply,[4,this.processAggregateFunctionAsync(e.func,r)];case 2:return n[a]=o.sent(),[2,t]}}))}))},e.prototype.getStringParametersCoreAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){return t=Object(n.HashTableUtility_create)(),e?this.isAggregateFunction(e.func)?[2,this.getStringParametersWithAggregatesAsync(e,t)]:[2,this.getStringParametersWithoutAggregateAsync(e,t)]:[2,t]}))}))},e.prototype.convertToStringAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){switch(r.label){case 0:return[4,this.getStringParametersInContextAsync(e,t)];case 1:return[2,r.sent().urlBuilder.toString()]}}))}))},e.prototype.registerOperator=function(e,t,r){this._operatorsToResolvers[e]=t,this._operatorsToOperatorText[e]=r},e.prototype.registerValueFormatter=function(e,t){void 0===t&&(t=function(e){return e.toString()}),this._valueFormatters[e]=t},e.prototype.registerOdataConstantValueFormatter=function(e,t){void 0===t&&(t=function(e){return e.toString()}),this._odataConstantValueFormatters[e]=t},e.prototype.registerOverrideValueFormatter=function(e,t){void 0===t&&(t=function(e){return e.toString()}),this._overrideValueFormatters[e]=t},e.prototype.getNormalizedFilterQueryAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return e?[4,this.generateFilterQueryStringAsync(e)]:[2,""];case 1:return[2,"true"===(t=r.sent())?"":t]}}))}))},e.prototype.dateTimeValueFormatter=function(e){return null===e?"null":"datetime'".concat(y.DateTimeUtility.convertDateTimeStringFromDValue(y.DateTimeBehavior.UserLocal,e),"'")},e.prototype.dateTimeNoTimeZoneValueFormatter=function(e){return null===e?"null":"datetime'".concat(y.DateTimeUtility.convertDateTimeStringFromDValue(y.DateTimeBehavior.NoTimeZone,e),"'")},e.prototype.dateValueFormatter=function(e){return null===e?"null":"'".concat(y.DateTimeUtility.convertDateStringFromDValue(e),"'")},e.prototype.optionSetValueFormatter=function(e){return e.Id.toString()},e.prototype.viewValueFormatter=function(e){return e.Id},e.prototype.tableValueFormatter=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,a,o=this;return __generator(this,(function(i){switch(i.label){case 0:return e&&0!==e.length?(t=[],r=Promise.resolve(),a=new n.PromiseQueue("tableValueFormatter"),e.forEach((function(e){r=a.pushJob((function(){return __awaiter(o,void 0,void 0,(function(){var r,n;return __generator(this,(function(a){switch(a.label){case 0:return[4,this.formatOperandAsync(e,this.getOverrideValueFormatterName(e,!0))];case 1:return(r=a.sent())&&"null"!==r&&(n=e.dType===p.TypeString?r:"'".concat(r,"'"),-1===t.indexOf(n)&&t.push(n)),[2]}}))}))}))})),[4,r]):[2,"['']"];case 1:return i.sent(),[2,t.length>0?"[".concat(t.toString(),"]"):"['']"]}}))}))},e.prototype.getOverrideValueFormatterName=function(e,t){return""},e.prototype.generateSortQueryString=function(e){if(this.skipDuplicateSortProperties){var t=Object(n.HashTableUtility_create)();return e.forEach((function(e){t[e.onProperty.propertyName]=e})),Object(n.HashTableUtility_mapToArray)(t,(function(e,t){return"".concat(t," ").concat(e.sortAscending?v.Ascending:v.Descending)})).join(",")}return e.map((function(e){return"".concat(e.onProperty.propertyName," ").concat(e.sortAscending?v.Ascending:v.Descending)})).join(",")},Object.defineProperty(e.prototype,"skipDuplicateSortProperties",{get:function(){return!1},enumerable:!1,configurable:!0}),e}(),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.dateTimeValueFormatter=function(e){return null===e?"null":y.DateTimeUtility.convertDateTimeStringFromDValue(y.DateTimeBehavior.UserLocal,e)},t.prototype.dateTimeNoTimeZoneValueFormatter=function(e){return null===e?"null":"'".concat(y.DateTimeUtility.convertDateTimeStringFromDValue(y.DateTimeBehavior.NoTimeZone,e),"'")},t.prototype.dateValueFormatter=function(e){return null===e?"null":y.DateTimeUtility.convertDateStringFromDValue(e)},t}(S),O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._treatCountAsAggregate=!0,t}return __extends(t,e),t.prototype.getStringParametersInContextAsync=function(r,a){var o=a;return!Object(n.isReactNativePlayer)()&&n.FeatureGates_services.enableOdataBatch&&((o=__assign({},a)).maxQueryStringLength=t._maxBatchUrlSize),e.prototype.getStringParametersInContextAsync.call(this,r,o)},t.prototype.generateFunctionQueryStringAsync=function(t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){return[2,t.functionKind===l.FunctionKind.Count?Object(i.formatAggregateCount)(t):e.prototype.generateFunctionQueryStringAsync.call(this,t)]}))}))},t.prototype.getOverrideValueFormatterName=function(e,t){return e.dType===p.TypeString&&t&&!n.FallbackSwitch.isActivated("AppConnectivity.OverrideValueFormatter")?A:""},Object.defineProperty(t.prototype,"skipDuplicateSortProperties",{get:function(){return!n.FallbackSwitch.isActivated("AppConnectivity.SkipDuplicateSort")},enumerable:!1,configurable:!0}),t._maxBatchUrlSize=32768,t}(D);function E(e,t){var r=Object(a.getCdsViewIdFromFilterQuery)(e.filter);return r&&(t[g.QueryOption.CdsView]=r),t}function T(e,t){if(void 0===t&&(t=!1),0===e.length)return"";var r=t?"".concat(g.QueryOption.Expand,"="):"";return"".concat(r).concat(e.map((function(e){return"".concat(e.propertyName).concat(function(e){var t="";return e.expands&&0!==e.expands.length&&(t+="".concat(T(e.expands,!0))),e.selects&&0!==e.selects.length&&(t&&(t+=";"),t+="".concat(R(e.selects,!0))),t&&(t="(".concat(t,")")),t}(e))})).join(","))}function R(e,t){void 0===t&&(t=!1);var r=t?"".concat(g.QueryOption.Select,"="):"";return"".concat(r).concat(e.join(","))}},function(e,t,r){"use strict";r.r(t),r.d(t,"invokeGlobalOperationAsync",(function(){return P})),r.d(t,"invokeCopilotActionAsync",(function(){return F})),r.d(t,"predictAsync",(function(){return N})),r.d(t,"getPredictionSchemaAsync",(function(){return I})),r.d(t,"invokeAiModelActionAsync",(function(){return x})),r.d(t,"getPreTrainedModelIdAsync",(function(){return j})),r.d(t,"getLabelsForObjectDetectionModelAsync",(function(){return L})),r.d(t,"cleanUpModelName",(function(){return k})),r.d(t,"getModelsAsync",(function(){return V})),r.d(t,"_getModelsWithActiveRunConfigIdQueryDefinition",(function(){return J}));var n=r(1),a=(r(39),r(84),r(58)),o=r(42),i=r(25),s=r(2),c=r(61),u=r(31),l=r(8),d=r(22),p=r(67),f=r(28),y=r(21),g=AppMagic.Services.IntelligenceConstants,h=AppMagic.Services.HttpConstants,m=AppMagic.Schema,v=new Core.Lazy((function(){return new u.PropertyOperand(g.ModelIdFieldName)})),b=new Core.Lazy((function(){return new u.PropertyOperand(g.ActiveRunConfigIdFieldName)})),_=new Core.Lazy((function(){return new s.Filter(s.FilterOperator.Equals,new u.PropertyOperand(g.AiConfigurationsStatusCode),new f.ValueOperand(g.AiConfigurationStatusPublished,m.TypeNumber))})),C=new Core.Lazy((function(){return new s.Filter(s.FilterOperator.Equals,new u.PropertyOperand(g.AiConfigurationsTypeFieldName),new f.ValueOperand(g.AiConfigurationsRunType,m.TypeNumber))})),A=new Core.Lazy((function(){return new u.PropertyOperand(g.AiConfigurationsModelIdFieldName)})),S=new Core.Lazy((function(){return new u.PropertyOperand(g.AiConfigurationsModifiedOnFieldName)})),D=new Core.Lazy((function(){return new i.Expand(g.AiConfigurationsParentConfigurationExpandName,g.AiConfigurationsIdFieldName)})),O=new Core.Lazy((function(){return new u.PropertyOperand(g.AiConfigurationsIdFieldName)})),E=new Core.Lazy((function(){return new i.Expand(g.AiConfigurationsLabelExpandName,g.AiLabelsIdFieldName,g.AiLabelsStringFieldName)})),T=new Core.Lazy((function(){return new u.PropertyOperand("".concat(g.ModelTemplateRelationship,"/").concat(g.TemplateName))})),R=new Core.Lazy((function(){return new s.Filter(s.FilterOperator.Equals,new u.PropertyOperand(g.StateCodeName),new f.ValueOperand(1,m.TypeNumber))})),w=new Core.Lazy((function(){return new s.Filter(s.FilterOperator.Equals,new u.PropertyOperand(g.StatusCodeName),new f.ValueOperand(1,m.TypeNumber))})),M={RetrieveOrganizationInfo:n.RetrieveOrganizationInfoResponse.safeCast};function P(e,t){return __awaiter(this,void 0,Promise,(function(){var e,r,n,a;return __generator(this,(function(o){switch(o.label){case 0:o.label=1;case 1:return o.trys.push([1,3,,4]),[4,K()];case 2:return e=o.sent(),[3,4];case 3:return[2,G(o.sent().message)];case 4:return(r=e.functions[t.operationName])?((a=M[t.operationName])||(Core.Log.warningEx("IntelligenceClient.invokeGlobalOperationAsync","No safeCast validation found for function '".concat(t.operationName,"'. Payload validation will be skipped.")),a=function(e){return e}),[2,B(r,a)]):(n="Function '".concat(t.operationName,"' is not supported."),Core.Log.errorEx("IntelligenceClient.invokeGlobalOperationAsync",n),[2,G(n)])}}))}))}function F(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,a;return __generator(this,(function(o){switch(o.label){case 0:return[4,q(g.AiModelsDataSourceName)];case 1:return r=o.sent(),n=t.headers,a=t.body,[4,r.unsafeInvokeCopilotActionAsync(e,n,a)];case 2:return[2,o.sent().response]}}))}))}function N(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n;return __generator(this,(function(a){switch(a.label){case 0:a.label=1;case 1:return a.trys.push([1,3,,4]),[4,q(g.AiModelsDataSourceName)];case 2:return r=a.sent(),[3,4];case 3:return[2,G(a.sent().message)];case 4:return n={tableName:g.AiModelsEntitySetName,namespace:g.Namespace,action:g.InferActionName,entityId:e,payload:t,dataSourceName:r.dataSourceName,sourceType:l.SourceType.ActionQueryDefinition},[2,Q(r,n)]}}))}))}function I(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n;return __generator(this,(function(a){switch(a.label){case 0:a.label=1;case 1:return a.trys.push([1,3,,4]),[4,q(g.AiModelsDataSourceName)];case 2:return r=a.sent(),[3,4];case 3:return[2,G(a.sent().message)];case 4:return n={tableName:g.AiModelsEntitySetName,namespace:g.Namespace,action:g.GetSchemaActionName,entityId:e,payload:t,dataSourceName:r.dataSourceName,sourceType:l.SourceType.ActionQueryDefinition},[2,Q(r,n)]}}))}))}function x(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,a;return __generator(this,(function(o){switch(o.label){case 0:t.payload,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,q(g.AiModelsDataSourceName)];case 2:return r=o.sent(),[3,4];case 3:return[2,G(o.sent().message)];case 4:return(n=new d.TableQueryOptions).format={odataMetadata:c.ODataMetadataEnum.None},a={tableName:g.AiModelsEntitySetName,namespace:g.Namespace,action:t.operationName,entityId:e,payload:t.payload?JSON.stringify(t.payload.request):"",dataSourceName:r.dataSourceName,sourceType:l.SourceType.ActionQueryDefinition,queryOptions:n},[2,Q(r,a)]}}))}))}function j(e){return __awaiter(this,void 0,Promise,(function(){var t,r,n,a;return __generator(this,(function(i){switch(i.label){case 0:i.label=1;case 1:return i.trys.push([1,3,,4]),[4,q(g.AiModelsDataSourceName)];case 2:return t=i.sent(),[3,4];case 3:return[2,G(i.sent().message)];case 4:r={tableName:g.AiModelsEntitySetName,tableLogicalName:t.metadata.name,dataSourceName:t.dataSourceName,queryOptions:{filter:z(e),expands:void 0,sorts:void 0,selects:[g.ModelIdFieldName],func:void 0,format:void 0,top:1},sourceType:l.SourceType.CdsQueryDefinition,queryStringBuilder:Object(o.CreateCdsQueryStringBuilder)()},n=null,i.label=5;case 5:return i.trys.push([5,7,,8]),[4,t.getRowsAsync(r,{maxRowCount:1})];case 6:return n=i.sent(),[3,8];case 7:return a=i.sent(),Core.Log.errorEx("IntelligenceClient.getPreTrainedModelIdAsync",{error:a}),[2,{success:!1,body:a,error:H(a)}];case 8:return n.results.length<1?(Core.Log.errorEx("IntelligenceClient.getPreTrainedModelProjectIdAsync","Error: no project found for template name: ".concat(e)),[2,{success:!1,error:y.ModelNotFound}]):[2,{success:!0,body:n.results[0][g.ModelIdFieldName]}]}}))}))}function L(e){return __awaiter(this,void 0,Promise,(function(){var t,r,n,a,i,c,u,d,h,v,b,O;return __generator(this,(function(E){switch(E.label){case 0:E.label=1;case 1:return E.trys.push([1,3,,4]),[4,q(g.AiConfigurationsDataSourceName)];case 2:return t=E.sent(),[3,4];case 3:return[2,G(E.sent().message)];case 4:r=function(e,t){return{tableName:g.AiConfigurationsEntitySetName,tableLogicalName:t.metadata.name,dataSourceName:t.dataSourceName,queryOptions:{filter:new s.Filter(s.FilterOperator.And,new s.Filter(s.FilterOperator.And,new s.Filter(s.FilterOperator.Equals,A.value,new f.ValueOperand(e,m.TypeString)),_.value),C.value),expands:[D.value],sorts:[new p.Sort(S.value,!1)],selects:[g.AiConfigurationsParentConfigurationExpandName,g.AiConfigurationsCustomConfigurationFieldName],func:void 0,format:void 0},sourceType:l.SourceType.CdsQueryDefinition,queryStringBuilder:Object(o.CreateCdsQueryStringBuilder)()}}(e,t),n=null,E.label=5;case 5:return E.trys.push([5,7,,8]),[4,t.getRowsAsync(r)];case 6:return n=E.sent(),[3,8];case 7:return a=E.sent(),Core.Log.errorEx("IntelligenceClient.getLabelsForObjectDetectionModelAsync",{error:a}),[2,{success:!1,body:a,error:H(a)}];case 8:if(n.results.length<1)return Core.Log.errorEx("IntelligenceClient.getLabelsForObjectDetectionModelAsync","Error: no training configuration found for model: ".concat(e)),[2,{success:!1,error:y.ModelNotFound}];if(1===n.results.length)return[2,U(t,n.results[0],e)];E.label=9;case 9:return E.trys.push([9,11,,12]),[4,q(g.AiModelsDataSourceName)];case 10:return i=E.sent(),[3,12];case 11:return[2,G(E.sent().message)];case 12:c=0,u=n.results,E.label=13;case 13:if(!(c<u.length))return[3,19];d=u[c],h=d[g.AiConfigurationsIdFieldName],v=J(e,h,i),b=null,E.label=14;case 14:return E.trys.push([14,16,,17]),[4,i.getRowsAsync(v)];case 15:return b=E.sent(),[3,17];case 16:return O=E.sent(),Core.Log.errorEx("IntelligenceClient.getLabelsForObjectDetectionModelAsync",{error:O}),[2,{success:!1,body:O,error:H(O)}];case 17:return 0===b.results.length?[3,18]:[2,U(t,d,e)];case 18:return c++,[3,13];case 19:return[2,U(t,n.results[0],e)]}}))}))}function U(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,a,o;return __generator(this,(function(i){return(n=function(e){var t,r=e;if(!Core.Utility.isNonEmptyString(r))return null;try{t=JSON.parse(r)}catch(e){return Core.Log.errorEx("IntelligenceClient.getLabelsForObjectDetectionModelAsync",{error:e}),null}return function(e){if(!e)return null;if(e.labels){if(!Core.Utility.isArray(e.labels))return null;if(e.labels.length<1)return null;for(var t=0,r=e.labels;t<r.length;t++){var n=r[t];if(!(Core.Utility.isNonEmptyString(n.id)&&Core.Utility.isNonEmptyString(n.displayName)&&Core.Utility.isStringOrNullOrUndefined(n.sourceRecordId)))return null}}return e}(t)}(t[g.AiConfigurationsCustomConfigurationFieldName]))?n.labels?[2,{success:!0,body:n.labels.map((function(e){return{id:e.id,displayName:e.displayName}}))}]:(Core.Log.warningEx("IntelligenceClient.getLabelsForObjectDetectionModelAsync","Warning: no labels in custom configuration found for model: ".concat(r)),(a=t[g.AiConfigurationsParentConfigurationExpandName])&&(o=a[g.AiConfigurationsIdFieldName])?[2,W(o,e)]:(Core.Log.errorEx("IntelligenceClient.getLabelsForObjectDetectionModelAsync","Error: no training configuration found for model: ".concat(r)),[2,{success:!1,error:y.ModelNotFound}])):(Core.Log.errorEx("IntelligenceClient.getLabelsForObjectDetectionModelAsync","Error: Invalid custom configuration for model:  ".concat(r)),[2,{success:!1,error:y.ModelInvalid}])}))}))}function k(e){return e.replace(/\"/g,"")}function V(e){return __awaiter(this,void 0,Promise,(function(){var t,r,n,a;return __generator(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,q(g.AiModelsDataSourceName)];case 1:return t=i.sent(),[3,3];case 2:return r=i.sent(),Core.Log.errorEx("IntelligenceClient.getModelsAsync",{error:r}),[2,[]];case 3:n={tableName:g.AiModelsEntitySetName,tableLogicalName:t.metadata.name,dataSourceName:t.dataSourceName,queryOptions:{filter:z(e),expands:void 0,sorts:void 0,selects:[g.ModelIdFieldName,g.ModelNameFieldName],func:void 0,format:void 0},sourceType:l.SourceType.CdsQueryDefinition,queryStringBuilder:Object(o.CreateCdsQueryStringBuilder)()},i.label=4;case 4:return i.trys.push([4,6,,7]),[4,t.getRowsAsync(n)];case 5:return[2,i.sent().results.map((function(t){return{modelId:t[g.ModelIdFieldName],name:k(t[g.ModelNameFieldName]),template:e}}))];case 6:return a=i.sent(),Core.Log.errorEx("IntelligenceClient.getModelsAsync",{error:a}),[3,7];case 7:return[2,[]]}}))}))}function B(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,o,i;return __generator(this,(function(s){switch(s.label){case 0:s.label=1;case 1:return s.trys.push([1,3,,4]),[4,e.runAsync(HashTableUtility.create())];case 2:return r=s.sent(),(n=t(r))?[2,{success:!0,body:n}]:[2,{success:!1,error:y.GenericError,body:new Error("Payload validation failed")}];case 3:return o=s.sent(),i=Object(a.tryGetCDSErrorFromError)(o),[2,{success:!1,error:y.GenericError,body:i||o}];case 4:return[2]}}))}))}function Q(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n;return __generator(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,e.unsafeInvokeActionAsync(t)];case 1:return[2,{success:!0,body:a.sent().response}];case 2:switch(r=a.sent(),n=void 0,r.response.status){case h.HttpStatusCode.NotFound:n=y.ModelNotFound;break;case h.HttpStatusCode.Forbidden:n=H(r);break;default:n=r.response.status>=400&&r.response.status<500?y.BadInput:y.GenericError}return[2,{success:!1,error:n,body:{response:r.message}}];case 3:return[2]}}))}))}function K(){return __awaiter(this,void 0,Promise,(function(){var e,t,r,n;return __generator(this,(function(a){switch(a.label){case 0:return[4,(e=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.CurrentAppInstanceFunctionSingletonKey)()).dataSources.tryGetDatasourceAsync(g.AiModelsDataSourceName)];case 1:return(t=a.sent())||Core.Log.errorEx("IntelligenceClient._getCdsFunctionAsync","Error while retrieving connector, no datasource named ".concat(g.AiModelsDataSourceName," was created")),(r=e.dataSources.tryGetCdsDataset(t.datasetName))||Core.Log.errorEx("IntelligenceClient._getCdsFunctionAsync","Error while retrieving dataset, no dataset named ".concat(t.datasetName," was created")),(n=r.datasetActions)||Core.Log.errorEx("IntelligenceClient._getCdsFunctionAsync","Error while retrieving serviceRuntime from dataset"),[2,n]}}))}))}function q(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return[4,Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.CurrentAppInstanceFunctionSingletonKey)().dataSources.tryGetDatasourceAsync(e)];case 1:return(t=r.sent())||Core.Log.errorEx("IntelligenceClient._getCdsConnector","Error while retrieving connector, no datasource named ".concat(e," was created")),[2,t.connector]}}))}))}function G(e){return{success:!1,error:y.GenericError,body:e}}function H(e){switch(function(e){var t=Object(a.tryGetCDSErrorFromError)(e);return t?t.error.code:null}(e)){case"0x80040220":return y.PrivilegeError;case"0x80048306":return y.ModelNotShared;case"0x80042f09":return y.NoRoleAssignedError;default:return y.GenericError}}function z(e){return new s.Filter(s.FilterOperator.And,new s.Filter(s.FilterOperator.And,new s.Filter(s.FilterOperator.Equals,T.value,new f.ValueOperand(e,m.TypeString)),R.value),w.value)}function J(e,t,r){return{tableName:g.AiModelsEntitySetName,tableLogicalName:r.metadata.name,dataSourceName:r.dataSourceName,queryOptions:{filter:new s.Filter(s.FilterOperator.And,new s.Filter(s.FilterOperator.Equals,v.value,new f.ValueOperand(e,m.TypeString)),new s.Filter(s.FilterOperator.Equals,b.value,new f.ValueOperand(t,m.TypeString))),expands:void 0,sorts:void 0,selects:[g.ModelIdFieldName],func:void 0,format:void 0},sourceType:l.SourceType.CdsQueryDefinition,queryStringBuilder:Object(o.CreateCdsQueryStringBuilder)()}}function W(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,a,i;return __generator(this,(function(c){switch(c.label){case 0:r=function(e,t){return{tableName:g.AiConfigurationsEntitySetName,tableLogicalName:t.metadata.name,dataSourceName:t.dataSourceName,queryOptions:{filter:new s.Filter(s.FilterOperator.Equals,O.value,new f.ValueOperand(e,m.TypeString)),expands:[E.value],sorts:void 0,selects:[g.AiConfigurationsLabelExpandName,g.AiConfigurationsModelIdFieldName],func:void 0,format:void 0},sourceType:l.SourceType.CdsQueryDefinition,queryStringBuilder:Object(o.CreateCdsQueryStringBuilder)()}}(e,t),n=null,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,t.getRowsAsync(r)];case 2:return n=c.sent(),[3,4];case 3:return a=c.sent(),Core.Log.errorEx("IntelligenceClient.getLabelsForObjectDetectionModelAsync",{error:a}),[2,{success:!1,error:y.GenericError,body:a.message}];case 4:return n.results.length<1||(!(i=n.results[0][g.AiConfigurationsLabelExpandName])||i.length<1)?(Core.Log.errorEx("IntelligenceClient.getLabelsForObjectDetectionModelAsync","Error: no labels found for configuration: ".concat(e)),[2,{success:!1,error:y.ModelNotFound}]):[2,{success:!0,body:i.map((function(e){return{id:e[g.AiLabelsIdFieldName],displayName:e[g.AiLabelsStringFieldName]}}))}]}}))}))}},function(e,t,r){"use strict";r.r(t),r.d(t,"NavigatedQueriedTable",(function(){return i})),r.d(t,"CdpNavigatedQueriedTable",(function(){return s})),r.d(t,"CdsNavigatedQueriedTable",(function(){return c}));var n=r(0),a=r(39),o=(r(23),r(18)),i=function(){function e(e,t,r,n,a,o,i){this._record=o,this._columnName=i,this.isNavigatedQueriedTable=!0,this._dataSource=e,this._connector=t,this._dataRuntime=r,this._queryDataProvider=n,this._cacheableQuery=a,this._currentSkip=0,this._wasFirstPageShown=!1}return Object.defineProperty(e.prototype,"queryOptions",{get:function(){return this._cacheableQuery.queryDefinition.queryOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._dataSource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataSourceName",{get:function(){return this._connector.dataSourceName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentSkip",{get:function(){return this._currentSkip},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"record",{get:function(){return this._record},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnName",{get:function(){return this._columnName},enumerable:!1,configurable:!0}),e.prototype.getPrimaryKey=function(e){return this._connector.metadata.getPrimaryKey(e)},e.prototype.tryGetPrimaryKey=function(e){return this._connector.metadata.tryGetPrimaryKey(e)},e.prototype.getQueryKeyAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return e=this._connector.dataSourceName,[4,this._cacheableQuery.getKeyAsync()];case 1:return[2,e+t.sent()]}}))}))},Object.defineProperty(e.prototype,"previousGetRowsResponse",{get:function(){return this._previousGetRowsResponse},enumerable:!1,configurable:!0}),e.prototype.queryTableAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){throw new n.NotImplementedError("NavigatedQueriedTable.queryTableAsync")}))}))},e.prototype.getNextResultsAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var r,a,i,s,c,u=this;return __generator(this,(function(l){switch(l.label){case 0:r=this._dataRuntime.startAsyncDataAction(),l.label=1;case 1:return l.trys.push([1,7,8,9]),a=void 0,this._wasFirstPageShown?[3,3]:(this._wasFirstPageShown=!0,[4,this.getFirstResponse()]);case 2:return i=l.sent(),this._previousGetRowsResponse=i,a=i.results,null==i.serverRowCount||isNaN(i.serverRowCount)||(a.serverRowCount=i.serverRowCount),null!=i.serverRowLimitExceeded&&"boolean"==typeof i.serverRowLimitExceeded&&(a.serverRowLimitExceeded=i.serverRowLimitExceeded),this._readOnlyConnector||(this._readOnlyConnector=new n.Lazy((function(){return new o.ReadOnlyNavigationPagingConnector(u._connector,i)}))),[3,6];case 3:return this._previousGetRowsResponse.nextLink?[3,4]:(a=[],[3,6]);case 4:return[4,this._queryDataProvider.getDataAsync(this._readOnlyConnector.value,this._dataSource.name,this._cacheableQuery,e,t||void 0,this._currentSkip)];case 5:s=l.sent(),this._previousGetRowsResponse=s,this._currentSkip+=s.results.length,a=s.results,null==s.serverRowCount||isNaN(s.serverRowCount)||(a.serverRowCount=s.serverRowCount),null!=s.serverRowLimitExceeded&&"boolean"==typeof s.serverRowLimitExceeded&&(a.serverRowLimitExceeded=s.serverRowLimitExceeded),l.label=6;case 6:return this._dataRuntime.assignTableID(a),[2,a];case 7:throw c=l.sent(),Object(n.throwIfCanceled)(c),c("NavigatedQueriedTable.getNextResultsAsync",c),c;case 8:return this._dataRuntime.endAsyncDataAction(r),[7];case 9:return[2]}}))}))},e.prototype.getResultCountAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){t=this._dataRuntime.startAsyncDataAction();try{this._connector.getResultCountAsync(this.queryOptions,e)}catch(t){return Object(n.throwIfCanceled)(t),AppMagic.Data.TabularDataUtilities.reportConnectedDataReadOperationErrors(t,e,this._dataRuntime),n.CoreLog.errorEx("QueriedTable.getResultCountAsync",{error:t}),[2,null]}finally{this._dataRuntime.endAsyncDataAction(t)}return[2]}))}))},e}(),s=function(e){function t(t,r,a,i,s,c,u,l){var d=e.call(this,t,r,a,i,s,u,l)||this;return d._previousGetRowsResponse=c,d._wasFirstPageShown=0===c.results.length,d._wasFirstPageShown&&(d._readOnlyConnector=new n.Lazy((function(){return new o.ReadOnlyNavigationPagingConnector(r,c)}))),d}return __extends(t,e),t.prototype.getFirstResponse=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,this._previousGetRowsResponse]}))}))},t}(i),c=function(e){function t(t,r,n,a,o,i,s,c){var u=e.call(this,t,r,n,a,o,s,c)||this;return u._rowRetrieverConnector=i,u}return __extends(t,e),t.prototype.getFirstResponse=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,this._queryDataProvider.getDataAsync(this._rowRetrieverConnector,this._dataSource.name,this._cacheableQuery,null,this._dataSource.maxGetRowsCount())]}))}))},t.prototype.queryTableAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){try{if(!(this._dataSource instanceof a.CdsDataSource))throw AppMagic.Strings.InvalidDataSourceForFunction;return this.queryOptions&&(e=AppMagic.Functions.mergeQueryOptions(this.queryOptions,e)),[2,this._dataSource.getNavigatedQueriedTableAsync(this._record,this._columnName,e)]}catch(e){return n.CoreLog.errorEx("CdsNavigatedQueriedTable.queryTableAsync",e),[2,AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.Unknown,AppMagic.Data.ErrorSeverity.Severe,Object(n.formatErrorMessage)(e))]}return[2]}))}))},t}(i)},function(e,t,r){"use strict";function n(e){return Core.Utility.isObject(e)&&Core.Utility.isObject(e.url)&&Core.Utility.isFunction(e.dispose)}function a(e){return{url:e,dispose:Core.Utility.noOpFn}}r.r(t),r.d(t,"isValid",(function(){return n})),r.d(t,"createPassThrough",(function(){return a}))},function(e,t,r){"use strict";r.r(t),r.d(t,"ScopeTracker",(function(){return a})),r.d(t,"PrimitiveScopeTracker",(function(){return o})),r.d(t,"CompositeScopeTracker",(function(){return i})),r.d(t,"DataScopeTracker",(function(){return s}));var n,a=function(){function e(e){this._id=e,this._isDisposed=!1,this._startEvent=new EventObject,this._endEvent=new EventObject}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),e.prototype.registerEndScopeListener=function(e){this._endEvent.addListener(e)},e.prototype._triggerStartScopeEvent=function(e){Core.Telemetry.PerfMarker.startMarker("Scope-Trigger-".concat(this.id)),this._startEvent.dispatch({id:this.id,data:e})},e.prototype._triggerEndScopeEvent=function(e){Core.Telemetry.PerfMarker.endMarker("Scope-Trigger-".concat(this.id)),this._endEvent.dispatch({id:this.id,data:e})},e.prototype.dispose=function(){this._isDisposed||(this._startEvent.dispose(),this._endEvent.dispose(),this._isDisposed=!0)},e}(),o=function(e){function t(t){var r=e.call(this,t)||this;return r._promisesCounter=HashTableUtility.create(),r}return __extends(t,e),t.prototype.registerStartScopeListener=function(e){var t=!this._startEvent.hasListener(e);t&&this._startEvent.addListener(e),!HashTableUtility.isEmpty(this._promisesCounter)&&t&&e({id:this.id})},t.prototype.trackPromise=function(e,t){var r=this;HashTableUtility.isEmpty(this._promisesCounter)&&this.triggerStartScopeEvent(),this._promisesCounter[e]=void 0===this._promisesCounter[e]?1:++this._promisesCounter[e],Core.PromiseUtils.wrapWithFinally(Core.PromiseUtils.timeout(0).then((function(){return t})),(function(){--r._promisesCounter[e],0===r._promisesCounter[e]&&delete r._promisesCounter[e],HashTableUtility.isEmpty(r._promisesCounter)&&r.triggerEndScopeEvent()}))},t.prototype.endScope=function(){},t.prototype.triggerStartScopeEvent=function(){this._triggerStartScopeEvent(null)},t.prototype.triggerEndScopeEvent=function(){this._triggerEndScopeEvent(null)},t}(a),i=function(e){function t(t){var r=e.call(this,t)||this;return r._inProgressScope=HashTableUtility.create(),r._scopes=HashTableUtility.create(),r._boundTriggerEnd=r._triggerEndProgress.bind(r),r._boundTriggerStart=r._triggerStartProgress.bind(r),r._isActive=!1,r._startEventAction=r._startEventCompositeTrackerAction.bind(r),r._endEventAction=r._endEventCompositeTrackerAction.bind(r),r}return __extends(t,e),Object.defineProperty(t.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),t.prototype.registerStartScopeListener=function(e){var t=!this._startEvent.hasListener(e);t&&this._startEvent.addListener(e),!HashTableUtility.isEmpty(this._inProgressScope)&&t&&e({id:this.id})},t.prototype._triggerStartProgress=function(e){HashTableUtility.isEmpty(this._inProgressScope)&&this._isActive&&this._startEventAction(),this._inProgressScope[e.id]=!0},t.prototype._triggerEndProgress=function(e){delete this._inProgressScope[e.id],delete this._scopes[e.id],HashTableUtility.isEmpty(this._inProgressScope)&&this._isActive&&(this._isActive=!1,this._endEventAction())},t.prototype.activateScope=function(e){return this._isActive=!0,this._scopes[e]||(this._scopes[e]=new o(e),this._scopes[e].registerStartScopeListener(this._boundTriggerStart),this._scopes[e].registerEndScopeListener(this._boundTriggerEnd)),this._scopes[e]},t.prototype.cancelActiveScopes=function(){this._isActive=!1,this._inProgressScope=HashTableUtility.create(),this._scopes=HashTableUtility.create()},t.prototype.tryGetScope=function(e){return this._scopes[e]||null},t.prototype.dispose=function(){this._boundTriggerEnd=null,this._boundTriggerStart=null,e.prototype.dispose.call(this)},t.prototype.endScope=function(){HashTableUtility.forEach(this._scopes,(function(e){e.endScope()}))},Object.defineProperty(t.prototype,"startEventAction",{set:function(e){this._startEventAction=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"endEventAction",{set:function(e){this._endEventAction=e},enumerable:!1,configurable:!0}),t.prototype._startEventCompositeTrackerAction=function(){this._triggerStartScopeEvent(null)},t.prototype._endEventCompositeTrackerAction=function(){this._triggerEndScopeEvent(null)},t}(a);!function(e){e[e.Inactive=1]="Inactive",e[e.Active=2]="Active",e[e.StartTriggered=3]="StartTriggered",e[e.EndTriggered=4]="EndTriggered"}(n||(n={}));var s=function(e){function t(t){var r=e.call(this,t)||this;return r._cancelledEvent=new EventObject,r._state=n.Inactive,r._data=null,r.startEventAction=r._startEventDataTrackerAction.bind(r),r.endEventAction=r._endEventDataTrackerAction.bind(r),r}return __extends(t,e),t.prototype.setData=function(e){this._data?e!==this._data&&(this._cancelScopeIfNeeded(),this._data=e,this._state=n.Inactive):this._data=e},t.prototype.registerCancelScopeListener=function(e){!this._cancelledEvent.hasListener(e)&&this._cancelledEvent.addListener(e)},t.prototype.activateScope=function(t){return this._state!==n.StartTriggered&&(this._state=n.Active),e.prototype.activateScope.call(this,t)},t.prototype._startEventDataTrackerAction=function(){this._state=n.StartTriggered,this._triggerStartScopeEvent(this._data)},t.prototype._endEventDataTrackerAction=function(){this._state=n.EndTriggered,this._triggerEndScopeEvent(this._data)},t.prototype._cancelScopeIfNeeded=function(){this._state===n.StartTriggered&&(this.cancelActiveScopes(),this._cancelledEvent.dispatch({id:this.id,data:this._data}))},t.prototype.dispose=function(){this._cancelScopeIfNeeded(),this._cancelledEvent=null,e.prototype.dispose.call(this)},t}(i)},function(e,t,r){},function(e,t,r){"use strict";r.r(t),r.d(t,"OrganizationSettingEntityName",(function(){return o})),r.d(t,"OrganizationSettingLogicalName",(function(){return i})),r.d(t,"OrganizationDataSourceName",(function(){return s})),r.d(t,"clearCache",(function(){return d})),r.d(t,"isGeospatialControl",(function(){return p})),r.d(t,"isGeospatialAzureMapsIntegrationEnabled",(function(){return f})),r.d(t,"checkIfOrganizationCdsDataSourceExists",(function(){return y})),r.d(t,"getGeospatialOrgSettingThroughCdsConnector",(function(){return g})),r.d(t,"tryGetIsGeospatialAzureMapsIntegrationEnabledResponse",(function(){return m}));r(39);var n=r(42),a=r(8),o="organizations",i="organization",s="Organizations",c=o+"?$select=isgeospatialazuremapsintegrationenabled",u=["http://microsoft.com/appmagic/powercontrol/Map","http://microsoft.com/appmagic/powercontrol/AddressInput","http://microsoft.com/appmagic/powercontrol/msft_Microsoft.Map","http://microsoft.com/appmagic/powercontrol/msft_Microsoft.AddressInput"],l={};function d(){l={}}function p(e){Contracts.checkString(e,"isGeospatialControl.controlName");for(var t=0,r=u;t<r.length;t++){var n=r[t];if(e.startsWith(n))return!0}return!1}function f(){var e;return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,g()];case 1:return[2,null!==(e=r.sent())&&void 0!==e&&e];case 2:return t=r.sent(),Core.Log.errorEx("GeospatialDataService.isGeospatialAzureMapsIntegrationEnabled",{error:t}),[2,!1];case 3:return[2]}}))}))}function y(){return __awaiter(this,void 0,Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,h()];case 1:return[2,!!t.sent()];case 2:return e=t.sent(),Core.Log.errorEx("GeospatialDataService.checkIfOrganizationCdsDataSourceExists",{error:e}),[2,!1];case 3:return[2]}}))}))}function g(){return __awaiter(this,void 0,Promise,(function(){var e,t,r,i,s,c;return __generator(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,h()];case 1:return e=u.sent(),[3,3];case 2:return t=u.sent(),Core.Log.errorEx("GeospatialDataService.getGeospatialOrgSettingThroughCdsConnector error getting CDS connector",{error:t}),[2,null];case 3:if(!e)return[2,null];r={tableName:o,tableLogicalName:e.metadata.name,dataSourceName:e.dataSourceName,queryOptions:{filter:void 0,expands:void 0,sorts:void 0,selects:["isgeospatialazuremapsintegrationenabled"],func:void 0,format:void 0,top:1},sourceType:a.SourceType.CdsQueryDefinition,queryStringBuilder:Object(n.CreateCdsQueryStringBuilder)()},i=null,u.label=4;case 4:return u.trys.push([4,6,,7]),[4,e.getRowsAsync(r,{maxRowCount:1})];case 5:return i=u.sent(),[3,7];case 6:return s=u.sent(),Core.Log.errorEx("GeospatialDataService.getGeospatialOrgSettingThroughConnector",{error:s}),[2,null];case 7:return i.results.length<1?(Core.Log.errorEx("GeospatialDataService.getGeospatialOrgSettingThroughConnector","Error: no organization records found"),[2,null]):void 0===(c=i.results[0].isgeospatialazuremapsintegrationenabled)?(Core.Log.warning("GeospatialDataService.getGeospatialOrgSettingThroughCdsConnector","Organization settings does not have isgeospatialazuremapsintegrationenabled"),[2,!1]):[2,c.Id]}}))}))}function h(){return __awaiter(this,void 0,Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return[4,Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.CurrentAppInstanceFunctionSingletonKey)().dataSources.tryGetDatasourceAsync(s)];case 1:return(e=t.sent())?[2,e.connector]:(Core.Log.errorEx("GeospatialDataService._getCdsConnector","Error while retrieving connector, no datasource was created"),[2,null])}}))}))}function m(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,a;return __generator(this,(function(o){switch(o.label){case 0:return l[e]?[4,l[e]]:[3,2];case 1:if(null!==(n=o.sent()))return[2,n];o.label=2;case 2:return a=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,a,o,i;return __generator(this,(function(s){switch(s.label){case 0:n=function(e,t,r,n){var a=new Core.UrlTemplate("{resourceUrl}/api/data/{webApiVersion}/{endpoint}"),o=decodeURIComponent(a.expandUrlString({resourceUrl:t,webApiVersion:e,endpoint:r})),i=HashTableUtility.create();return i["Content-Type"]="application/json",{url:o,method:n,headers:i}}(t,e,c,AppMagic.Services.HttpConstants.Method.GET),AppMagic.Runtime.Client.addAuthorizationOptions(n.headers,{resource:e,isDynamicResource:!0}),AppMagic.Services.appendCustomHeadersOptions(n,{optInMSHeaders:!0}),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,r.sendHttpJsonResponseAsync(n)];case 2:return(a=s.sent())?!(o=function(e){return function(e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Core.Utility.isArray(e.value)&&e.value.every((function(e){return void 0===e||null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&(!e.isgeospatialazuremapsintegrationenabled||"boolean"==typeof e.isgeospatialazuremapsintegrationenabled)}))}(e)?e:null}(a))||!o.value||o.value.length<=0?(Core.Log.warning("GeospatialDataService.tryGetIsGeospatialAzureMapsIntegrationEnabledResponseInternal","Couldn't parse response"),[2,null]):void 0===o.value[0].isgeospatialazuremapsintegrationenabled?(Core.Log.warning("GeospatialDataService.tryGetIsGeospatialAzureMapsIntegrationEnabledResponseInternal","Organization settings does not have isgeospatialazuremapsintegrationenabled"),[2,!1]):[2,o.value[0].isgeospatialazuremapsintegrationenabled]:(Core.Log.warning("GeospatialDataService.tryGetIsGeospatialAzureMapsIntegrationEnabledResponseInternal","Invalid response from CDS web api"),[2,null]);case 3:return i=s.sent(),Core.Log.warning("GeospatialDataService.tryGetIsGeospatialAzureMapsIntegrationEnabledResponseInternal",i),[2,null];case 4:return[2]}}))}))}(e,t,r),l[e]=a,[2,a]}}))}))}},function(e,t,r){"use strict";r.r(t),r.d(t,"ValidationError",(function(){return n})),r.d(t,"GetValidator",(function(){return s}));r(0);var n,a=r(4);function o(e){return"number"!=typeof e||isNaN(e)||e===1/0||e===-1/0||Math.floor(e)!==e?n.NotANumber:null}function i(e,t){switch(t.Type){case a.PcfTypes.Decimal:return function(e){return"number"==typeof e?e:"string"==typeof e&&""!==e&&e.indexOf(" ")<0?Number(e):null}(e);default:return e}}!function(e){e[e.RequiredValueNotProvided=0]="RequiredValueNotProvided",e[e.MaxLengthExceeded=1]="MaxLengthExceeded",e[e.EmailAddressInvalid=2]="EmailAddressInvalid",e[e.NotAnInteger=3]="NotAnInteger",e[e.LessThanMinValue=4]="LessThanMinValue",e[e.GreaterThanMaxValue=5]="GreaterThanMaxValue",e[e.InvalidDate=6]="InvalidDate",e[e.NotANumber=7]="NotANumber",e[e.InvalidTypeForField=8]="InvalidTypeForField"}(n||(n={}));var s=function(e){var t=function(e){var t={dataType:null==e?void 0:e.Type,required:1===(null==e?void 0:e.RequiredLevel)};return t.maxValue=null==e?void 0:e.MaxValue,t.minValue=null==e?void 0:e.MinValue,t.maxLength=null==e?void 0:e.MaxLength,t}(e),r=[];switch(t.dataType){case a.PcfTypes.Decimal:r.push(o)}return(t.maxValue||t.minValue)&&r.push(function(e,t){return function(r){return void 0!==e&&r<e?n.LessThanMinValue:void 0!==t&&r>t?n.GreaterThanMaxValue:null}}(t.minValue,t.maxValue)),t.maxLength&&r.push(function(e){return function(t){return t&&t.length>e?n.MaxLengthExceeded:null}}(t.maxLength)),function(a){var o={validationError:null,validationErrorString:null};if(""===a||null===a)t.required?o.validationError=n.RequiredValueNotProvided:o.parsedValue=a;else{var s=i(a,e);null===s?o.validationError=n.InvalidTypeForField:(o.parsedValue=s,o.validationError=function(e){return function(t){for(var r=0,n=e;r<n.length;r++){var a=(0,n[r])(t);if(null!==a)return a}return null}}(r)(s))}return o}}},function(e,t,r){"use strict";r.r(t),r.d(t,"CDPFunctionQueryStringBuilder",(function(){return o})),r.d(t,"formatAggregateCount",(function(){return i})),r.d(t,"isUnfilteredCountFunction",(function(){return s})),r.d(t,"formatCdsUnfilteredCount",(function(){return c})),r.d(t,"isCountFunction",(function(){return u}));var n=r(0),a=r(3),o=(r(9),a.FunctionKind.Contains,a.FunctionKind.Add,a.FunctionKind.Sub,a.FunctionKind.IndexOf,a.FunctionKind.SubStringOf,a.FunctionKind.Year,a.FunctionKind.Month,a.FunctionKind.Day,a.FunctionKind.Hour,a.FunctionKind.Minute,a.FunctionKind.Second,a.FunctionKind.ToLower,a.FunctionKind.ToUpper,a.FunctionKind.Trim,a.FunctionKind.Len,a.FunctionKind.Date,a.FunctionKind.Sum,a.FunctionKind.Min,a.FunctionKind.Max,a.FunctionKind.Average,a.FunctionKind.Count,a.FunctionKind.StartsWith,a.FunctionKind.EndsWith,a.FunctionKind.CountDistinct,a.FunctionKind.CdsIn,a.FunctionKind.ContainsValues,function(){function e(e){this._queryStringBuilder=e}return e.prototype.formatFunctionTypeAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(e.functionKind){case a.FunctionKind.Add:return[2,this.formatAddAsync(e)];case a.FunctionKind.Sub:return[2,this.formatSubAsync(e)];case a.FunctionKind.SubStringOf:return[2,this.formatSubstringOfAsync(e)];case a.FunctionKind.IndexOf:return[2,this.formatIndexOfAsync(e)];case a.FunctionKind.Contains:return[2,this.formatContainsAsync(e)];case a.FunctionKind.CdsIn:return[2,this.formatCdsInAsync(e)];case a.FunctionKind.ContainsValues:return[2,this.formatCdsContainsValueAsync(e)];case a.FunctionKind.Year:case a.FunctionKind.Month:case a.FunctionKind.Day:case a.FunctionKind.Hour:case a.FunctionKind.Minute:case a.FunctionKind.Second:case a.FunctionKind.Date:return[2,this.formatExtractDateTimeFunctionsAsync(e)];case a.FunctionKind.ToLower:case a.FunctionKind.ToUpper:case a.FunctionKind.Trim:case a.FunctionKind.Len:return[2,this.formatOneArgStringFunctionsAsync(e)];case a.FunctionKind.Sum:case a.FunctionKind.Min:case a.FunctionKind.Max:case a.FunctionKind.Average:case a.FunctionKind.CountDistinct:return[2,this.formatAggregateFunctions(e)];case a.FunctionKind.Count:break;case a.FunctionKind.StartsWith:case a.FunctionKind.EndsWith:return[2,this.formatTwoArgStringFunctionsAsync(e)]}return[2,""]}))}))},e.prototype.formatCountAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this._queryStringBuilder.formatOperandAsync(e.functionArguments[0])];case 1:return[2,"true"===t.sent()]}}))}))},e.prototype.formatAddAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,n,a,o;return __generator(this,(function(i){switch(i.label){case 0:return t=e.functionArguments,n="".concat,[4,this._queryStringBuilder.formatOperandAsync(t[0])];case 1:return r=n.apply("",[i.sent()]),o="".concat,[4,this._queryStringBuilder.formatOperandAsync(t[1])];case 2:return a=o.apply("",[i.sent()]),[2,"".concat(r," add ").concat(a)]}}))}))},e.prototype.formatSubAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,n,a,o;return __generator(this,(function(i){switch(i.label){case 0:return t=e.functionArguments,n="".concat,[4,this._queryStringBuilder.formatOperandAsync(t[0])];case 1:return r=n.apply("",[i.sent()]),o="".concat,[4,this._queryStringBuilder.formatOperandAsync(t[1])];case 2:return a=o.apply("",[i.sent()]),[2,"".concat(r," sub ").concat(a)]}}))}))},e.prototype.formatAggregateFunctions=function(e){var t="";switch(e.functionKind){case a.FunctionKind.Sum:t="sum";break;case a.FunctionKind.Min:t="min";break;case a.FunctionKind.Max:t="max";break;case a.FunctionKind.Average:t="average";break;case a.FunctionKind.CountDistinct:t="countdistinct"}return this.formatAggregateFunction(t,e.functionArguments)},e.prototype.formatAggregateFunction=function(e,t){var r=t[0];return"aggregate(".concat(this.formatProperty(r)," with ").concat(e," as result)")},e.prototype.formatProperty=function(e){return e.propertyName},e.prototype.formatOneArgStringFunctionsAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){switch(t="",e.functionKind){case a.FunctionKind.ToLower:t="tolower";break;case a.FunctionKind.ToUpper:t="toupper";break;case a.FunctionKind.Trim:t="trim";break;case a.FunctionKind.Len:t="length"}return[2,this.formatFunctionAsync(t,e.functionArguments)]}))}))},e.prototype.formatTwoArgStringFunctionsAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){switch(t="",e.functionKind){case a.FunctionKind.StartsWith:t="startswith";break;case a.FunctionKind.EndsWith:t="endswith"}return[2,this.formatFunctionAsync(t,e.functionArguments)]}))}))},e.prototype.formatExtractDateTimeFunctionsAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){switch(t="",e.functionKind){case a.FunctionKind.Year:t="year";break;case a.FunctionKind.Month:t="month";break;case a.FunctionKind.Day:t="day";break;case a.FunctionKind.Hour:t="hour";break;case a.FunctionKind.Minute:t="minute";break;case a.FunctionKind.Second:t="second";break;case a.FunctionKind.Date:t="date"}return[2,this.formatFunctionAsync(t,e.functionArguments)]}))}))},e.prototype.formatSubstringOfAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){return[2,this.formatFunctionAsync("substringof",e.functionArguments)]}))}))},e.prototype.formatIndexOfAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){return[2,this.formatFunctionAsync("indexof",e.functionArguments)]}))}))},e.prototype.formatContainsAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){return[2,this.formatFunctionAsync("contains",e.functionArguments)]}))}))},e.prototype.formatFunctionAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,a,o,i;return __generator(this,(function(s){switch(s.label){case 0:r=0,n="".concat(e,"("),s.label=1;case 1:return r<t.length?(a=t[r],o=n,i="".concat,[4,this._queryStringBuilder.formatOperandAsync(a)]):[3,3];case 2:return n=o+i.apply("",[s.sent()]),++r!==t.length&&(n+=","),[3,1];case 3:return[2,n+=")"]}}))}))},e.prototype.formatCdsInAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,n,a,o,i,s,c,u,l,d;return __generator(this,(function(p){switch(p.label){case 0:return t=e.functionArguments,[4,this._queryStringBuilder.formatOperandAsync(t[0])];case 1:if(r=p.sent(),n=t[1],-1===r.indexOf("/")||n.dType!==AppMagic.Schema.TypeTable)return[3,6];if(AppMagic.Data.ErrorValue.isErrorHandlingFeatureEnabled()&&AppMagic.Data.ErrorValue.isErrorValue(n.value))throw new AppMagic.Services.ConnectedDataQueryStringBuilderError(n.value);if(a=n.value,o=0,i="",!(a.length>0))return[3,5];i="(",p.label=2;case 2:return o<a.length?(s=a[o],c=i,l=(u="".concat(r," eq ")).concat,[4,this._queryStringBuilder.formatOperandAsync(s)]):[3,4];case 3:return i=c+l.apply(u,[p.sent()]),++o!==a.length&&(i+=" or "),[3,2];case 4:i+=")",p.label=5;case 5:return[2,""===i||"()"===i?"null":i];case 6:return[4,this._queryStringBuilder.formatOperandAsync(n)];case 7:return d=p.sent(),[2,"Microsoft.Dynamics.CRM.In(PropertyName='".concat(r,"',PropertyValues=").concat(d,")")]}}))}))},e.prototype.formatCdsContainsValueAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,a,o,i;return __generator(this,(function(s){switch(s.label){case 0:return t=e.functionArguments,[4,this._queryStringBuilder.formatOperandAsync(t[0])];case 1:return r=s.sent(),a=t[1].value,Object(n.isEmptyArrayOrNullOrUndefined)(a)?(i="['-1']",[3,4]):[3,2];case 2:return[4,this._queryStringBuilder.formatOperandAsync(t[1])];case 3:i=s.sent(),s.label=4;case 4:return o=i,[2,"Microsoft.Dynamics.CRM.ContainValues(PropertyName='".concat(r,"',PropertyValues=").concat(o,")")]}}))}))},e}());function i(e){return"aggregate($count as result)"}function s(e){var t;return!((null===(t=null==e?void 0:e.func)||void 0===t?void 0:t.functionKind)!==a.FunctionKind.Count||(null==e?void 0:e.filter))}function c(e){return'RetrieveTotalRecordCount(EntityNames=["'.concat(e,'"])')}function u(e){var t;return(null===(t=null==e?void 0:e.func)||void 0===t?void 0:t.functionKind)===a.FunctionKind.Count}},function(e,t,r){"use strict";r.r(t),r.d(t,"getAsBlobViaNativeXhrAsync",(function(){return a})),r.d(t,"getContentDetailsViaNativeXhrAsync",(function(){return o})),r.d(t,"getAsBinaryViaHttpClientAsync",(function(){return s}));var n=AppMagic.Services;function a(e){var t;return __awaiter(this,void 0,Promise,(function(){var r;return __generator(this,(function(a){switch(a.label){case 0:return[4,i({type:n.HttpConstants.Method.GET,url:e.toString(),headers:null,data:null,responseType:n.ResponseTypes.Blob},e,0)];case 1:return r=a.sent(),[2,null!==(t=null==r?void 0:r.response)&&void 0!==t?t:null]}}))}))}function o(e){return __awaiter(this,void 0,Promise,(function(){var t,r,a;return __generator(this,(function(o){switch(o.label){case 0:return[4,i({type:n.HttpConstants.Method.HEAD,url:e.toString(),headers:null,data:null},e,0)];case 1:return(t=o.sent())?(r=t.getResponseHeader(n.HttpConstants.HeaderName.ContentLength),a=t.getResponseHeader(n.HttpConstants.HeaderName.ContentType),[2,{length:r?parseInt(r):void 0,type:a||void 0}]):[2,{}]}}))}))}function i(e,t,r){return __awaiter(this,void 0,void 0,(function(){var a,o,s;return __generator(this,(function(c){switch(c.label){case 0:return c.trys.push([0,4,,6]),[4,AppMagic.Services.xhr(e)];case 1:return s=c.sent(),a=e.type!==n.HttpConstants.Method.HEAD,206===s.status&&r<1?(e.headers={Range:"bytes=0-"},[4,i(e,t,++r)]):[3,3];case 2:return[2,c.sent()];case 3:if(0===s.status)throw new Core.ApplicationError("xhr call failed.");if(a&&s.responseType!==n.ResponseTypes.Blob)throw new Core.ApplicationError("Invalid response type. Expected blob but got "+s.responseType);if(void 0===s.response||null===s.response)return[2,null];if(a&&!Core.Utility.isBlob(s.response))throw new Core.ApplicationError("xhr returned response type of blob, but the response is not of type Blob.");return[2,s];case 4:if(o=c.sent(),Core.PromiseUtils.throwIfCanceled(o),t.scheme===Core.UrlScheme.Blob)throw new Core.SendHttpError("Invalid blob uri.",{requestUrl:t.toString()});return n.XmlHttpRequest.isValid(o)&&(s=o).status===n.HttpConstants.HttpStatusCode.NotFound||o.number===n.ServiceUtility.WindowsErrorNumber.CannotLocateResource?[2,null]:[4,n.ServiceUtility.createNormalizedErrorFromWinJSXhrErrorAsync(o,t.toString())];case 5:throw c.sent();case 6:return[2]}}))}))}function s(e,t){return __awaiter(this,void 0,Promise,(function(){var r;return __generator(this,(function(a){switch(a.label){case 0:a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.sendHttpPABinaryResponseAsync({method:n.HttpConstants.Method.GET,url:e.toString()})];case 2:return[2,a.sent()];case 3:if(r=a.sent(),Core.PromiseUtils.throwIfCanceled(r),r instanceof Core.SendHttpErrorWithResponse&&r.response.status===n.HttpConstants.HttpStatusCode.NotFound)return[2,null];throw r;case 4:return[2]}}))}))}},function(e,t,r){"use strict";r.r(t),r.d(t,"ZipPacker",(function(){return u}));var n=r(121),a=r(7),o=r(30),i=r(27),s=r(0),c=AppMagic.Data.DataEntityRecordSerialization.LogReporter,u=function(){function e(){}return e.generateMediaPath=function(e,t,r){var n=t.contentType,o=Core.Url.encode(e),i=Core.MimeTypes.tryGetFileExtension(n.toLowerCase());if(!i){var s="contentType '"+n+"' does not have a known file extension in Core.MimeTypes.";Core.Log.warningEx("ZipPacker.generateMediaPath",s)}return(r?"":a.assetsFolderName)+o+i},e.generateSessionStorageMediaPath=function(e,t){var r,n=t.contentType,a=null!==(r=Core.MimeTypes.tryGetFileExtension(n.toLowerCase()))&&void 0!==r?r:"";if(""===a){var o="contentType '"+n+"' does not have a known file extension in Core.MimeTypes.";Core.Log.warningEx("ZipPacker.generateMediaPath",o)}return"/SessionStorage/"+Core.Url.encode(Object(s.SHA256Hash)(e))+a},e.createZipAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,n,o,s=this;return __generator(this,(function(c){switch(c.label){case 0:return[4,Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.JSZipLoaderSingletonKey).loadingPromise()];case 1:return c.sent(),t=e.mediaInfoTable,r=new JSZip,Object(i.updateEnumerable)(e.data,!0),r.file(a.dataFileName,JSON.stringify(e.data,i.stringfyReplacer)),Object(i.updateEnumerable)(e.data,!1),r.file(a.schemaFileName,JSON.stringify({tableSchema:e.schema})),r.file(a.headerFileName,JSON.stringify({docVersion:e.docVersion,minLoadVersion:e.docVersion})),HashTableUtility.forEach(t,(function(e,t){if(e){var n=s.generateMediaPath(t,e);r.file(n,e.arrayBuffer)}})),n=r.generate({type:"arraybuffer"}),o=n.byteLength,Core.Telemetry.Log.trackActivityEvent("ZipPacker.createZipAsync",{message:"Created zip of size '".concat(o,"' bytes."),sizeInBytes:o}),[2,{arrayBuffer:n}]}}))}))},e.loadZipAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return Core.Telemetry.Log.trackActivityEvent("ZipPacker.loadZipAsync ",{message:"Loading zip of size '".concat(e.byteLength,"' bytes."),sizeInBytes:e.byteLength}),[4,Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.JSZipLoaderSingletonKey).loadingPromise()];case 1:return t.sent(),[2,this._loadZip(e)]}}))}))},e._loadZip=function(e){var t,r,n,s,u=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.CurrentAppInstanceFunctionSingletonKey)().mediaRuntime;try{t=new JSZip(e)}catch(e){throw new Error(o.ImportCorruptedZipError)}if(t.file(a.xmlFileName))return this._loadZipLegacy(t);for(var l=new c,d=function(e,t){return Object(i.parseReplacer)(e,t,l)},p=0,f=Object.keys(t.files);p<f.length;p++){var y=f[p];try{var g=void 0;switch(y){case a.dataFileName:g=t.file(y),r=JSON.parse(g.asText(),d);break;case a.entityMetadataFileName:Core.Telemetry.Log.trackActivityEvent("ZipPacker.loadZipAsync ",{message:"loadZip: Entity Metadata file still exists -- using old load algorithm"}),g=t.file(y),n=Core.Utility.tryParseJson(g.asText());break;case a.schemaFileName:g=t.file(y),s=JSON.parse(g.asText()).tableSchema;break;case a.headerFileName:case a.assetsFolderName:break;default:if(0!==y.indexOf(a.assetsFolderName)||y.indexOf("../")>=0)throw new Error("Unrecognized file '".concat(y,"'"));g=t.file(y);var h=new Core.Url(g.name).getSegment(-1),m=h.substring(h.lastIndexOf(".")),v=Core.Url.decode(h.substring(0,h.lastIndexOf("."))),b=Core.MimeTypes.tryGetMimeType(m.toLowerCase());if(!Core.Utility.isAbsoluteUrlString(v)){Core.Log.error("ZipPacker._loadZip",new Error("Media url '".concat(v,"' is not an appres uri instance.")));continue}var _=Core.PABinary.createFromArrayBuffer(g.asArrayBuffer(),b);u.registerDataBinaryWithRef(_,v)}}catch(e){Core.Log.error("ZipPacker._loadZip",e,"Unable to load file ".concat(y,"."))}}if(l.flushErrors(),!r)throw new Error(o.ImportJsonNotFoundError);return s||(Core.Telemetry.Log.trackActivityEvent("ZipPacker.loadZipAsync ",{message:"Unable to find schema. Using empty schema '*[]' instead"}),s="*[]"),n||Object(i.updateEnumerable)(r,!1),{data:r,schema:s}},e._loadZipLegacy=function(e){Core.Telemetry.Log.trackActivityEvent("ZipPacker._loadZipLegacy",{message:"Using legacy loadZip."});var t,r=e.file(a.schemaFileName);if(Core.Utility.isNullOrUndefined(r))throw new Error(o.ImportNoSchemaError);try{t=JSON.parse(r.asText())}catch(e){throw new Error(o.ImportInvalidJSONError)}var i=e.file(a.xmlFileName);if(Core.Utility.isUndefined(i))throw new Error(o.ImportXMLNotFoundError);for(var s=i.asText(),c=HashTableUtility.create(),u=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.CurrentAppInstanceFunctionSingletonKey)(),l=0,d=Object.keys(e.files);l<d.length;l++){var p=d[l],f=e.file(p);if(Core.Utility.isValue(f)){if(Core.Utility.isUndefined(f.options)||Core.Utility.isUndefined(f.name))throw new Error(o.ImportUnknownError);if(f.options.dir||f.name===a.xmlFileName||f.name===a.schemaFileName||f.name===a.headerFileName)continue;if(!Core.Utility.isFunction(f.asArrayBuffer))throw new Error(o.ImportUnknownError);if(0!==p.indexOf(a.assetsFolderName)||p.indexOf("../")>=0)continue;var y=f.asArrayBuffer(),g="ms-appdata:///temp/{0}/"+p,h=new Core.Url(f.name).getSegment(-1),m=h.substring(h.lastIndexOf(".")),v=Core.MimeTypes.tryGetMimeType(m.toLowerCase()),b=new Blob([y],{type:v||""}),_=u.mediaRuntime.registerDataBlobAndAddRef(b);c[g]=_.toString()}}try{var C=new n.Beta3XmlParsingStrategy(c),A={xml:s,schema:t};return C.parse(A)}catch(e){throw new Error(o.ImportInvalidXMLError)}},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"NamedObjectNotFoundError",(function(){return n}));var n=function(e){function t(t){var r=e.call(this,function(e){return"The named object '".concat(e,"' could not be found in the runtime.")}(t),"AppMagic.Runtime.App.NamedObjectNotFoundError")||this;return r.namedObjectName=t,r}return __extends(t,e),t}(Core.ErrorBase)},function(e,t,r){},function(e,t,r){"use strict";r.r(t),r.d(t,"safeCast",(function(){return i})),r.d(t,"isValidOptionSetData",(function(){return s})),r.d(t,"isValidOptionSetTable",(function(){return c})),r.d(t,"isOptionSetTable",(function(){return u})),r.d(t,"tryGetOptionSetData",(function(){return l}));var n=r(0),a=r(96),o=AppMagic.Data.DataTable;function i(e){return s(e)?e:null}function s(e){return Object(n.isNumber)(e.Id)||Object(n.isBoolean)(e.Id)&&Object(n.isNonEmptyStringOrNull)(e.Value)}function c(e){if(!o.isDataTable(e))return!1;var t=Object(n.HashTableUtility_create)();return!e.some((function(e){var r=!1,o=Object(a.safeCast)(e);if(null!==o&&o.Value){var i=o.Value.Id.toString();Object(n.tryGetValueIgnoreCase)(t,i)||(t[i]=!0,r=!0)}return!r}))}function u(e){return o.isDataTable(e)}function l(e,t){var r=function(e){return c(e)?e:null}(e);if(null===r)return null;var n=r.filter((function(e){var r=e.Value;return typeof r.Id==typeof t&&r.Id===t}));return 0===n.length?null:i(n[0].Value)}},function(e,t,r){"use strict";r.r(t),r.d(t,"safeCast",(function(){return o})),r.d(t,"isValidViewData",(function(){return i})),r.d(t,"isValidViewTable",(function(){return s})),r.d(t,"isViewTable",(function(){return c})),r.d(t,"tryGetViewData",(function(){return u}));var n=r(97),a=AppMagic.Data.DataTable;function o(e){return i(e)?e:null}function i(e){return Core.Utility.isGuid(e.Id)&&Core.Utility.isNonEmptyStringOrNull(e.Value)}function s(e){if(!a.isDataTable(e))return!1;var t=HashTableUtility.create();return!e.some((function(e){var r=!1,a=Object(n.safeCast)(e);if(null!==a&&a.Value){var o=a.Value.Id.toString();HashTableUtility.tryGetValueIgnoreCase(t,o)||(t[o]=!0,r=!0)}return!r}))}function c(e){return a.isDataTable(e)}function u(e,t){var r=function(e){return s(e)?e:null}(e);if(null===r)return null;var n=r.filter((function(e){return e.Value.Id===t}));return 0===n.length?null:o(n[0].Value)}},function(e,t,r){"use strict";r.r(t),r.d(t,"getCdsViewIdFromFilterQuery",(function(){return s})),r.d(t,"isValidFilterQuery",(function(){return c}));r(0);var n=r(2),a=r(3),o=r(9),i=AppMagic.Schema;function s(e){if(e){var t;if(e.firstOperand&&e.firstOperand.operandKind===o.OperandKind.Filter)if(t=s(e.firstOperand))return t;if(e.firstOperand&&e.firstOperand.operandKind===o.OperandKind.Value){var r=e.firstOperand;if(r.dType===i.TypeViewValue)return r.value.Id}if(e.secondOperand&&e.secondOperand.operandKind===o.OperandKind.Filter)if(t=s(e.secondOperand))return t;if(e.secondOperand&&e.secondOperand.operandKind===o.OperandKind.Value){var n=e.secondOperand;if(n.dType===i.TypeViewValue)return n.value.Id}}}function c(e){return!e||!(e.firstOperand&&e.firstOperand.operandKind===o.OperandKind.Filter&&!c(e.firstOperand))&&(!(!l(e.firstOperand,e.operator)||!u(e.firstOperand))&&(!(e.secondOperand&&e.secondOperand.operandKind===o.OperandKind.Filter&&!c(e.secondOperand))&&!(!l(e.secondOperand,e.operator)||!u(e.secondOperand))))}function u(e){if(e&&e.operandKind===o.OperandKind.Function){var t=e;if(t.functionKind===a.FunctionKind.Contains){var r=t.functionArguments[1],n=t.functionArguments[2];if(void 0!==r&&null===r.value||void 0!==n&&null===n.value)return!1}}return!0}function l(e,t){if(e&&e.operandKind===o.OperandKind.Value&&(t===n.FilterOperator.GreaterThanOrEqual||t===n.FilterOperator.GreaterThan||t===n.FilterOperator.LessThanOrEqual||t===n.FilterOperator.LessThan)&&null===e.value)return!1;return!0}},function(e,t,r){"use strict";r.r(t),r.d(t,"safeCast",(function(){return i})),r.d(t,"isValid",(function(){return s})),r.d(t,"tryGetCDSErrorFromError",(function(){return c}));var n=r(0),a=r(35),o=r(86);function i(e){return s(e)?e:function(e){return Object(o.isValid)(e)?{error:e}:null}(e)}function s(e){return e&&Object(o.isValid)(e.error)}function c(e){var t,r=null;if(e&&AppMagic.Services.errorHasHttpResponse(e)?r=e.response.response:e instanceof a.AppDataSourceError&&e.serverError&&AppMagic.Services.errorHasHttpResponse(e.serverError)&&(r=e.serverError.response.response),!r)return n.CoreLog.warningEx("CdsErrorResponse._tryGetCDSErrorCodeFromError","Unexpected error type, null or empty http error response",{error:e}),null;if("string"==typeof r)try{t=JSON.parse(r)}catch(e){return n.CoreLog.warningEx("CdsErrorResponse._tryGetCDSErrorCodeFromError","Failed to parse CDS http error response, wrong JSON string",{error:e}),null}else t=r;var o=i(t);return o||(n.CoreLog.errorEx("IntelligenceClient._tryGetCDSErrorCodeFromError","Invalid CDS error response"),null)}},function(e,t,r){"use strict";var n;r.d(t,"b",(function(){return n})),function(e){e.Connected="connected",e.ConnectedWithWarning="connectedwithwarning",e.ConnectedPendingUpsync="connectedpendingupsync",e.ConnectedError="connectederror",e.ConnectedRefresh="connectedrefresh",e.NotConnected="notconnected",e.NotConnectedWithWarning="notconnectedwithwarning",e.NotConnectedPendingUpsync="notconnectedpendingupsync",e.NotConnectedSyncError="notconnectedsyncerror"}(n||(n={}))},function(e,t,r){"use strict";r.r(t),r.d(t,"CollectionDataSource",(function(){return i}));r(0);var n=r(72),a=r(4),o=(r(23),AppMagic.Data.DataTable),i=function(e){function t(t,r,n){var o=e.call(this,t,"CollectionDataset_"+t,a.DataSourceKind.Collection,r)||this;return o._collectionDefName=n,o}return __extends(t,e),t.isCollectionDataSource=function(e){return e.kind===a.DataSourceKind.Collection},Object.defineProperty(t.prototype,"collectionDefName",{get:function(){return this._collectionDefName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"monitorName",{get:function(){return this.collectionDefName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canClear",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canUserEditAsync",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canUserCreateAsync",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canUserDeleteAsync",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportsSingleRecordPatch",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shouldEnforceRowSchemaOnPatch",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.dataTableInternal},enumerable:!1,configurable:!0}),t.prototype._setData=function(t){e.prototype._setData.call(this,t)},t.prototype._loadingInitialDataAsync=function(){var e=o.create();return this._setData(e),Promise.resolve()},t.prototype._getDataSourceName=function(){return this._collectionDefName},t}(n.AppDataSource)},function(e,t,r){"use strict";var n;r.r(t),r.d(t,"ODataMetadataEnum",(function(){return n})),r.d(t,"Format",(function(){return a})),function(e){e[e.None=0]="None",e[e.Minimal=1]="Minimal",e[e.Full=2]="Full"}(n||(n={}));var a=function(){return function(e){this.odataMetadata=e}}()},function(e,t,r){"use strict";r.r(t),r.d(t,"DataExpirationDefaultTimeoutInMS",(function(){return u})),r.d(t,"LongLivingDataExpirationTimeoutInMS",(function(){return l})),r.d(t,"CacheBehaviorFlags",(function(){return a})),r.d(t,"CachedQueryDataProvider",(function(){return p}));var n,a,o=r(0),i=r(5),s=r(109),c=r(110),u=(r(23),3e4),l=6e4;!function(e){e[e.Hit=0]="Hit",e[e.CompleteMiss=1]="CompleteMiss",e[e.HitExpiredData=2]="HitExpiredData",e[e.PartialMiss=3]="PartialMiss",e[e.InvalidUsage=4]="InvalidUsage"}(n||(n={})),function(e){e[e.None=0]="None",e[e.LongLivingCache=1]="LongLivingCache"}(a||(a={}));var d=function(e){function t(){return e.call(this,"Item in cache already evicted")||this}return __extends(t,e),t}(o.ApplicationError),p=function(e){function t(t,r,n){void 0===r&&(r=u),void 0===n&&(n=20);var i=this;return(i=e.call(this)||this)._dataExpirationTimeout=r,i._maxCachedQueryCount=n,i._cachedQueries=Object(o.HashTableUtility_create)(),i._dataSourceNameToQuery=Object(o.HashTableUtility_create)(),i._dataSourceNameToLastClearTime=Object(o.HashTableUtility_create)(),i._isDisposed=!1,i._cachedQueryCount=0,i._flags=a.None,i._dataChangedProvider=t,i._requestByQueryOptionKey=Object(o.HashTableUtility_create)(),i}return __extends(t,e),Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),t._logTelemetry=function(e,t){e.lookupStatus!==n[n.InvalidUsage]?o.Log.trackActivityEvent(t,{message:JSON.stringify(e)}):o.CoreLog.error(t,new Error(JSON.stringify(e)))},t.prototype._isConnectorClientPagable=function(e){return e.isClientPageable},t.prototype.setSplitExpandsForQuery=function(e){this._cachedQueries[e]&&(this._cachedQueries[e].splitExpandsQuery=!0)},t.prototype.getSplitExpandsForQuery=function(e){var t;return null===(t=this._cachedQueries[e])||void 0===t?void 0:t.splitExpandsQuery},t.prototype.setFlags=function(e){o.Log.trackActivityEvent("CachedQueryDataProvider.setFlags",{flags:e}),this._flags=e},t.prototype.setDataExpirationTimeout=function(e){o.Log.trackActivityEvent("CachedQueryDataProvider.setDataExpirationTimeout",{timeout:e}),this._dataExpirationTimeout=e},t.prototype.clearQueriesForEntity=function(e,r){var n=this;void 0===r&&(r=!1),t._logTelemetry({dataSourceName:e},"CachedQueryDataProvider.ClearQueriesForEntityAsync"),this._dataSourceNameToLastClearTime[e]=(new Date).getTime();var a=this._dataSourceNameToQuery[e];if(a){var o=!1;if(a.forEach((function(e){var t,a=null===(t=n._cachedQueries[e].cachedQuery)||void 0===t?void 0:t.cachePermanently;o=o||a,!r&&a||n._removeQueryFromMemory(e)})),r||!o)delete this._dataSourceNameToQuery[e],delete this._dataSourceNameToLastClearTime[e];else{var i=this._dataSourceNameToQuery[e];i=i.filter((function(e){var t,r;return null===(r=null===(t=n._cachedQueries[e])||void 0===t?void 0:t.cachedQuery)||void 0===r?void 0:r.cachePermanently}))}}},t.prototype.getDataAsync=function(e,t,r,n,a,o,i){return void 0===n&&(n=null),void 0===o&&(o=0),__awaiter(this,void 0,Promise,(function(){var s,c=this;return __generator(this,(function(u){switch(u.label){case 0:return[4,this._generateCachedQueryAsync(t,r)];case 1:return s=u.sent(),[4,this._getOrCreateCacheItem(s).promiseQueue.pushJob((function(){return c._getDataAsync(s,e,t,r,n,!1,a,o,i)}))];case 2:return[2,u.sent()]}}))}))},t.prototype.addDataToCacheAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var a,i,s,c;return __generator(this,(function(u){switch(u.label){case 0:return[4,this._generateCachedQueryAsync(e,t)];case 1:return a=u.sent(),i=a.id,this._getOrCreateCacheItem(a),(s=this._checkQueryStatus(i,e,0))===n.CompleteMiss||s===n.HitExpiredData?(c=this._requestByQueryOptionKey[i])&&!c.completed?(o.Log.trackActivityEvent("CachedQueryDataProvider.addDataToCacheAsync.complete",{id:i}),c.complete(r)):(o.Log.trackActivityEvent("CachedQueryDataProvider.addDataToCacheAsync._addToInMemoryCache",{id:i}),this._addToInMemoryCache(a,r)):o.Log.trackActivityEvent("CachedQueryDataProvider.addDataToCacheAsync.noAction",{id:i}),[2]}}))}))},t.prototype._generateCachedQueryAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r;return __generator(this,(function(n){switch(n.label){case 0:return[4,t.getKeyAsync()];case 1:return r=n.sent(),[2,{dataSourceName:e,id:e+r,queryDefinition:t.queryDefinition,cachePermanently:t.cachePermanently,queryStartTime:(new Date).getTime()}]}}))}))},t.prototype._getDataAsync=function(e,t,r,a,i,s,c,u,l){return void 0===u&&(u=0),__awaiter(this,void 0,Promise,(function(){var p,f;return __generator(this,(function(y){switch(y.label){case 0:switch(p=this._checkQueryStatus(e.id,r,u,c),p){case n.HitExpiredData:return[3,1];case n.CompleteMiss:return[3,2];case n.Hit:return[3,3];case n.PartialMiss:return[3,4]}return[3,7];case 1:return[2,this._getDataForExpiredCacheAsync(t,e,c,u,a,i,l)];case 2:return[2,this._getDataFromConnectorForNewQueryAndAddToCacheAsync(t,e,c,u,a,i,l)];case 3:return[2,Promise.resolve(this._getDataFromCache(e.id,c,u))];case 4:return y.trys.push([4,6,,7]),[4,this._getDataPartFromCacheAndConnectorAsync(t,e.id,c,u,a,i)];case 5:return[2,y.sent()];case 6:if((f=y.sent())instanceof d&&!s)return o.Log.trackActivityEvent("CahcedQueryDataProvider._getDataPartFromCacheAndCoonnectorAsync",{datasourceName:a.queryDefinition.dataSourceName}),[2,this._getDataAsync(e,t,r,a,i,!0,c,u)];throw f;case 7:throw new Error("Unsupported usage of the query cache. Pages requested should be sequential.")}}))}))},t.prototype._getDataForExpiredCacheAsync=function(e,t,r,n,a,i,s){return __awaiter(this,void 0,Promise,(function(){var c=this;return __generator(this,(function(u){return this._useLongLivingCache()?(o.CoreLog.verbose("[LongLivingCache] {0}: HitExpiredData",t.id),this._cachedQueries[t.id].pendingDownload||(this._cachedQueries[t.id].pendingDownload=!0,o.CoreLog.verbose("[LongLivingCache] {0}: Start downloading",t.id),o.Log.trackActivityEvent("CachedQueryDataProvider._getDataForExpiredCacheAsync",{id:Object(o.scrubSensitiveDataSafe)(t.id),message:"StartDownload"}),this._getDataFromConnectorForNewQueryAndAddToCacheAsync(e,t,r,n,a,i,s).then((function(){return c._onDataDownloaded(!0,t.id)}),(function(){return c._onDataDownloaded(!1,t.id)}))),[2,this._getDataFromCache(t.id,r,n)]):[2,this._getDataFromConnectorForNewQueryAndAddToCacheAsync(e,t,r,n,a,i,s)]}))}))},t.prototype._onDataDownloaded=function(e,t){if(o.CoreLog.verbose("[LongLivingCache] {0}: onDataDownloaded succeed: {1}",t,e),o.Log.trackActivityEvent("CachedQueryDataProvider._onDataDownloaded",{id:Object(o.scrubSensitiveDataSafe)(t),succeed:e}),this._cachedQueries[t].pendingDownload=!1,e)if(this._dataChangedProvider){var r=o.Log.startScenario(o.ScenarioName.CachedQueryDataProviderNotify,{id:Object(o.scrubSensitiveDataSafe)(t)});o.CoreLog.verbose("[LongLivingCache] {0}: notify starts",t),this._dataChangedProvider.notifyDataChanged(t),o.CoreLog.verbose("[LongLivingCache] {0}: notify completes",t),o.Log.endScenario(r)}else o.Log.trackActivityEvent("CachedQueryDataProvider._onDataDownloaded",{id:Object(o.scrubSensitiveDataSafe)(t),message:"Not notify"});else delete this._cachedQueries[t].cachedQueryData},t.prototype._checkQueryStatus=function(e,t,r,a){var o,i=this._cachedQueries[e].cachedQueryData;if(!i)return n.CompleteMiss;if(!(null===(o=this._cachedQueries[e].cachedQuery)||void 0===o?void 0:o.cachePermanently)){if(i.isExpired)return n.HitExpiredData;if(this._cachedQueries[e].cachedQuery.queryStartTime<this._dataSourceNameToLastClearTime[t])return n.HitExpiredData}var s=i.data.length;return void 0===a||s>=r+a||!i.hasMoreData?n.Hit:r<=s&&s<r+a?n.PartialMiss:n.InvalidUsage},t.prototype._getOrCreateCacheItem=function(e){return this._cachedQueries[e.id]||(!e.cachePermanently&&this._cachedQueryCount>=this._maxCachedQueryCount&&this._tryRemoveMostStaleQuery(),this._cachedQueries[e.id]={promiseQueue:new o.PromiseQueue("CachedQueryDataProvider_getOrCreateCacheItem".concat(e.id)),cachedQuery:{dataSourceName:e.dataSourceName,id:e.id,queryDefinition:e.queryDefinition,cachePermanently:e.cachePermanently,queryStartTime:(new Date).getTime()},pendingDownload:!1},e.cachePermanently||++this._cachedQueryCount),this._cachedQueries[e.id]},t.prototype._tryRemoveMostStaleQuery=function(){var e=Object(o.HashTableUtility_getValues)(this._cachedQueries).reduce((function(e,t){var r=(new Date).getTime();return(e.cachedQueryData?e.cachedQueryData.createdTime:r)<(t.cachedQueryData?t.cachedQueryData.createdTime:r)?e:t}));0===e.promiseQueue.getJobsCount()?(this._removeQueryFromEntityNameMap(e.cachedQuery),this._removeQueryFromMemory(e.cachedQuery.id)):o.CoreLog.verbose("Skipped removing the most stale query as there are still service calls underway.")},t.prototype._removeQueryFromMemory=function(e){delete this._cachedQueries[e].cachedQueryData,--this._cachedQueryCount},t.prototype._getDataFromConnectorForNewQueryAndAddToCacheAsync=function(e,t,r,n,a,o,i){return __awaiter(this,void 0,Promise,(function(){var s,u,l,d=this;return __generator(this,(function(p){switch(p.label){case 0:return this._requestByQueryOptionKey[t.id]?this._requestByQueryOptionKey[t.id].resetIfCompleted():this._requestByQueryOptionKey[t.id]=new c.CachedQueryDataRequest,this._cachedQueries[t.id].cachedQuery.queryStartTime=(new Date).getTime(),u=(u=void 0===r?e.getRowsAsync(a.queryDefinition,o):e.getRowsAsync(a.queryDefinition,o,{maxRowCount:r+n,skip:0,forceDataLimit:i})).then((function(n){return n.results.length<r&&n.nextLink?d._getMoreRowsFromConnectorAsync(e,t.queryDefinition,n.nextLink,r-n.results.length,n):n})),[4,this._requestByQueryOptionKey[t.id].completeOnPromiseDone(u)];case 1:return s=p.sent(),this._addToInMemoryCache(t,s),l=this._getDataFromCache(t.id,r,n),this._updateCachedQueryDataState(l,r,t.id),[2,l]}}))}))},t.prototype._getDataPartFromCacheAndConnectorAsync=function(e,t,r,n,a,o){return __awaiter(this,void 0,Promise,(function(){var i,s,c;return __generator(this,(function(u){switch(u.label){case 0:return i=this._getDataFromCache(t,r,n),s=this._cachedQueries[t].cachedQueryData,c=i.results.length,[4,this._getMoreDataFromConnectorAndAddToCacheAsync(e,s,t,r-c,n+c,a,o)];case 1:return u.sent(),[2,this._getDataFromCache(t,r,n)]}}))}))},t.prototype._getMoreDataFromConnectorAndAddToCacheAsync=function(e,t,r,n,a,i,s){return __awaiter(this,void 0,Promise,(function(){var c,u;return __generator(this,(function(l){switch(l.label){case 0:return this._isConnectorClientPagable(e)?[4,e.getRowsAsync(i.queryDefinition,s,{maxRowCount:n,skip:a})]:[3,2];case 1:return c=l.sent(),[3,7];case 2:return Object(o.isString)(t.nextLink)?[4,this._getMoreRowsFromConnectorAsync(e,t.queryDefinition,t.nextLink,n)]:[3,4];case 3:return c=l.sent(),[3,7];case 4:return 0!==a?[3,6]:[4,e.getRowsAsync(i.queryDefinition,s,{maxRowCount:n,skip:a})];case 5:return c=l.sent(),[3,7];case 6:c={results:[]},l.label=7;case 7:return this._update(r,c),u=this._getDataFromCache(r,n,a),this._updateCachedQueryDataState(u,n,r),[2]}}))}))},t.prototype._getDataFromCache=function(e,t,r){return this._cachedQueries[e].cachedQueryData.getData(t,r)},t.prototype._addToInMemoryCache=function(e,t){var r,n,a=t.leftovers?t.results.concat(t.leftovers):t.results,o=new s.CachedQueryData(this._dataExpirationTimeout,a,e.queryDefinition,t.nextLink,t.serverRowCount,t.serverRowLimitExceeded);(null===(n=null===(r=this._cachedQueries[e.id])||void 0===r?void 0:r.cachedQueryData)||void 0===n?void 0:n.data)&&Object(i.releaseBlobs)(this._cachedQueries[e.id].cachedQueryData.data),this._cachedQueries[e.id].cachedQueryData=o,this._addQueryToEntityNameMap(e)},t.prototype._addQueryToEntityNameMap=function(e){var t=this._dataSourceNameToQuery[e.dataSourceName];t?t.indexOf(e.id)<0&&t.push(e.id):this._dataSourceNameToQuery[e.dataSourceName]=[e.id]},t.prototype._removeQueryFromEntityNameMap=function(e){var t=this._dataSourceNameToQuery[e.dataSourceName];if(t){var r=t.indexOf(e.id);r>-1&&t.splice(r,1)}},t.prototype._update=function(e,t){var r=this._cachedQueries[e].cachedQueryData;if(!r)throw new d;r.updateData(t)},t.prototype._updateCachedQueryDataState=function(e,t,r){var n=this._cachedQueries[r].cachedQueryData;n&&(void 0===t||e.results.length<t)&&(n.hasMoreData=!1)},t.prototype._getMoreRowsFromConnectorAsync=function(e,t,r,n,a){return __awaiter(this,void 0,Promise,(function(){var o,i,s,c;return __generator(this,(function(u){switch(u.label){case 0:i=o=a||{nextLink:r,results:[]},u.label=1;case 1:u.trys.push([1,6,,7]),u.label=2;case 2:return[4,e.getMoreRowsAsync(i,t,n)];case 3:i=u.sent(),(c=o.results).push.apply(c,i.results),n-=i.results.length,u.label=4;case 4:if(i.nextLink&&n>0)return[3,2];u.label=5;case 5:return[3,7];case 6:return(s=u.sent())("CachedQueryDataProvider._getMoreRowsFromConnectorAsync",s,"getMoreRowsAsync call failed to get more rows for nextLink: ".concat(i.nextLink,".'")),[3,7];case 7:return o.nextLink=i.nextLink,i.leftovers&&(o.leftovers=i.leftovers),[2,o]}}))}))},t.prototype._useLongLivingCache=function(){return 0!=(this._flags&a.LongLivingCache)},t.prototype.dispose=function(){e.prototype.dispose.call(this),Object(o.HashTableUtility_forEach)(this._cachedQueries,(function(e){e.promiseQueue.cancelAll(),e.promiseQueue=null})),this._isDisposed=!0},t}(o.Disposable)},function(e,t,r){"use strict";r.r(t),r.d(t,"IAppRuntimeSingletonKey",(function(){return a})),r.d(t,"IAppRuntimeGetterFunctionSingletonKey",(function(){return o}));var n=r(0),a=Object(n.createForInterface)("AppMagic.IAppRuntime"),o=Object(n.createForInterface)("AppMagic.IAppRuntimeGetterFunction")},function(e,t,r){"use strict";r.r(t),r.d(t,"mergeQueryOptions",(function(){return l})),r.d(t,"pageDataRecords",(function(){return d})),r.d(t,"convertPcfToQueryFilter",(function(){return p}));r(0);var n=r(6),a=r(2),o=r(31),i=r(22),s=r(67),c=r(26),u=AppMagic.Schema;function l(e,t,r,n){var c=e;return r&&(e||t)?(c=e?Object.assign({},e):new i.TableQueryOptions,t&&(function(e,t){var r;(null===(r=t.columns)||void 0===r?void 0:r.length)>0&&t.columns.map((function(t){var r=t.name;e.selects?e.selects.push(r):e.selects=[r]}))}(c,t),function(e,t){var r;if((null===(r=t.sortDetails)||void 0===r?void 0:r.length)>0){var n=[];t.sortDetails.forEach((function(e){var t=new s.Sort(new o.PropertyOperand(e.name),!e.sortDirection);n.push(t)})),e.sorts=n}}(c,t),function(e,t,r,n){var o;if(t.filters){var i=null===(o=null==r?void 0:r.dataSource)||void 0===o?void 0:o.tryGetTableMetadata(),s=p(null==t?void 0:t.filters,i,n);if(s)if(e.filter){var c=e.filter,u=s;e.filter=new a.Filter(a.FilterOperator.And,c,u)}else e.filter=s}}(c,t,r,n)),c):c}function d(e,t,r,n){var a,o=null!==(a=__spreadArray([],e,!0))&&void 0!==a?a:[],i=e.length%t==0?e.length/t:Math.floor(e.length/t)+1;if(r=r>(n=n>i?i:n)?n:r,i<=1)return o;var s=n*t>o.length?o.length:n*t;return o=o.slice((r-1)*t,s)}function p(e,t,r){var o=[];if(null==e?void 0:e.conditions)for(var i=e.conditions,s=!1,l=void 0,d=function(e){if(t){var i=t.columns.filter((function(t){return t.name===e.attributeName}));s=0!==i.length&&"OptionSet"===i[0].getSchema().type,l=function(e,t){var r=(null==t?void 0:t.columns)||[],n=e?r.filter((function(t){return e===t.name})):null;if((null==n?void 0:n.length)>0)return n[0].getSchema().type===u.TypeOptionSet?u.TypeOptionSetValue:n[0].getSchema().type;return u.TypeUnknown}(e.attributeName,t)}else if(l=u.TypeUnknown,r){i=r.filter((function(t){return t.name===e.attributeName}));l=0!==i.length?Object(c.pcfToSchemaType)(i[0].dataType):u.TypeUnknown}!function(e){if(-1!==[49,6,54,56,8,55,57,87,13,12,88,7].indexOf(e))return!0;return!1}(e.conditionOperator)?o.push(function(e,t,r){void 0===r&&(r=!1);var o=Object(n.createValueOperand)(g(e,r),t),i=Object(n.createPropertyOperand)(e.attributeName),s=a.FilterOperator.None;switch(e.conditionOperator){case-1:s=AppMagic.Data.Query.FilterOperator.None;break;case 0:s=AppMagic.Data.Query.FilterOperator.Equals;break;case 1:s=AppMagic.Data.Query.FilterOperator.NotEquals;break;case 2:case 75:s=AppMagic.Data.Query.FilterOperator.GreaterThan;break;case 4:case 78:case 77:s=AppMagic.Data.Query.FilterOperator.GreaterThanOrEqual;break;case 3:case 76:s=AppMagic.Data.Query.FilterOperator.LessThan;break;case 5:case 79:s=AppMagic.Data.Query.FilterOperator.LessThanOrEqual;break;case 25:var c=y(e,t),u=y(e,t,1);if(c&&u){var l=Object(n.createFilterOperand)(a.FilterOperator.GreaterThanOrEqual,i,c),d=Object(n.createFilterOperand)(a.FilterOperator.LessThan,i,u);return Object(n.createFilterOperand)(a.FilterOperator.And,l,d)}break;case 26:var p=y(e,t,1);p&&(o=p,s=a.FilterOperator.LessThan);break;case 27:var f=y(e,t);f&&(o=f,s=a.FilterOperator.GreaterThanOrEqual);break;default:s=AppMagic.Data.Query.FilterOperator.None}return Object(n.createFilterOperand)(s,i,o)}(e,l,s)):o.push(function(e,t,r){void 0===r&&(r=!1);var o,i,s=Object(n.createValueOperand)(g(e,r),t),c=Object(n.createPropertyOperand)(e.attributeName),l=Object(n.createNullOperand)(),d=a.FilterOperator.And;switch(e.conditionOperator){case 49:case 6:d=a.FilterOperator.None,o=n.FunctionKind.Contains,i=Object(n.createSearchFunctionOperand)(o,s,c);break;case 7:d=a.FilterOperator.Not,o=n.FunctionKind.Contains,i=Object(n.createSearchFunctionOperand)(o,s,c);break;case 54:d=a.FilterOperator.None,o=n.FunctionKind.StartsWith,i=Object(n.createTextMatchOperand)(Object(n.createFunctionOperand)(o,u.TypeBoolean,c,s));break;case 56:d=a.FilterOperator.None,o=n.FunctionKind.EndsWith,i=Object(n.createTextMatchOperand)(Object(n.createFunctionOperand)(o,u.TypeBoolean,c,s));break;case 55:d=a.FilterOperator.Not,o=n.FunctionKind.StartsWith,i=Object(n.createTextMatchOperand)(Object(n.createFunctionOperand)(o,u.TypeBoolean,c,s));break;case 57:d=a.FilterOperator.Not,o=n.FunctionKind.EndsWith,i=Object(n.createTextMatchOperand)(Object(n.createFunctionOperand)(o,u.TypeBoolean,c,s));break;case 8:o=n.FunctionKind.CdsIn,i=Object(n.createSearchFunctionOperand)(o,s,c);break;case 13:case 87:var p=Object(n.createFilterOperand)(a.FilterOperator.NotEquals,c,Object(n.createNullOperand)());if(t!==u.TypeString)return p;var f=Object(n.createFilterOperand)(a.FilterOperator.NotEquals,c,Object(n.createValueOperand)("","s"));return Object(n.createFilterOperand)(a.FilterOperator.And,p,f);case 12:case 88:return Object(n.createIsBlankFilterOperand)(c,t===u.TypeString?1:0);default:return null}return Object(n.createFilterOperand)(d,i,l)}(e,l,s))},h=0,m=i;h<m.length;h++){d(m[h])}if(null==e?void 0:e.filters)for(var v=0,b=e.filters;v<b.length;v++){var _=b[v];o.push(p(_,t,r))}for(;o.length>1;){var C=o.shift(),A=o.shift(),S=new a.Filter(f(e.filterOperator),C,A);o.push(S)}return o[0]}function f(e){switch(e){case 0:return a.FilterOperator.And;case 1:return a.FilterOperator.Or;default:return null}}function y(e,t,r){var a=e.value,o=new Date(a);if(isNaN(o.getTime()))return null;r&&o.setDate(o.getDate()+r);var i=o.toISOString().split("T")[0];return Object(n.createValueOperand)(i,t)}function g(e,t){var r;return void 0===t&&(t=!1),t?{Id:"1"===(null===(r=e.value)||void 0===r?void 0:r.toString()),Value:""}:e.value}},function(e,t,r){"use strict";r.r(t),r.d(t,"OdataConstantType",(function(){return a})),r.d(t,"ConstantOperand",(function(){return o}));r(0);var n=r(9),a=function(){function e(){}return Object.defineProperty(e,"Duration",{get:function(){return"duration"},enumerable:!1,configurable:!0}),e}(),o=function(e){function t(t,r){var a=e.call(this,n.OperandKind.Constant)||this;return a._value=t,a._type=r,a}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),t.SupportedOdataConstantTypes=[a.Duration],t}(n.Operand)},function(e,t,r){"use strict";r.r(t),r.d(t,"ConnectedDataQueryStringBuilderError",(function(){return a}));var n=r(0),a=function(e){function t(t){var r=this,a="ConnectedDataQueryStringBuilderError";t&&t.kind&&(a+=" Kind:".concat(t.kind)),t&&t.severity&&(a+=" Severity:".concat(t.severity));var o=AppMagic.Data.ErrorValue.tryGetDebugMessage(t);return Object(n.isNonEmptyNonWhitespaceString)(o)&&(a+=" "+o),(r=e.call(this,a)||this)._errValue=t,r}return __extends(t,e),Object.defineProperty(t.prototype,"errValue",{get:function(){return this._errValue},enumerable:!1,configurable:!0}),t}(n.ApplicationError)},function(e,t,r){"use strict";r.r(t),r.d(t,"Sort",(function(){return n}));var n=function(){function e(e,t){this._onProperty=e,this._sortAscending=t}return Object.defineProperty(e.prototype,"onProperty",{get:function(){return this._onProperty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sortAscending",{get:function(){return this._sortAscending},enumerable:!1,configurable:!0}),e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"EditPermission",(function(){return n})),r.d(t,"ReadPermission",(function(){return a})),r.d(t,"DeletePermission",(function(){return o})),r.d(t,"WriteAccess",(function(){return i})),r.d(t,"ReadAccess",(function(){return s})),r.d(t,"DeleteAccess",(function(){return c})),r.d(t,"AccessList",(function(){return u})),r.d(t,"RecordInfoEnumMap",(function(){return l}));var n="editpermission",a="readpermission",o="deletepermission",i="WriteAccess",s="ReadAccess",c="DeleteAccess",u=[s,i,c],l={editpermission:i,readpermission:s,deletepermission:c}},function(e,t,r){"use strict";r.r(t),r.d(t,"create",(function(){return n}));r(0);function n(e,t,r,n,a){return{Connected:e,Metered:t,Sync:r,LastSyncMessage:n,LastSyncDate:a}}},function(e,t,r){"use strict";r.r(t),r.d(t,"create",(function(){return n}));r(0);function n(e,t,r){return{X:e,Y:t,Z:r}}},function(e,t,r){},function(e,t,r){"use strict";r.r(t),r.d(t,"AppDataSource",(function(){return h}));var n=r(0),a=r(105),o=r(38),i=r(34),s=r(5),c=r(14),u=r(11),l=r(4),d=r(23),p=AppMagic.Runtime.App,f=AppMagic.Data.ErrorValue,y=AppMagic.Data.ErrorKind,g=AppMagic.Data.ErrorSeverity,h=function(e){function t(t,r,a,o){var i=e.call(this,t)||this;return i._dataChangedEvent=new n.EventObject,i._dataLoadedEvent=new n.OneTimeEvent("AppDataSource.dataLoaded"),i._kind=a,i._data=null,i._datasetName=r,i._dataRuntime=o,i._dataChangePending=!1,i}return __extends(t,e),Object.defineProperty(t,"DataNotAvailableContractMessage",{get:function(){return"This member shouldn't be called unless this instance has been loaded. Also, verify this instance has not been disposed."},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"kind",{get:function(){return this._kind},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"datasetName",{get:function(){return this._datasetName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pluginType",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataRuntime",{get:function(){return this._dataRuntime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRefreshable",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportsSingleRecordPatch",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shouldEnforceRowSchemaOnPatch",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"requiresAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"protocol",{get:function(){return"local"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"monitorName",{get:function(){return this.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canClear",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canUserEditAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canUserCreateAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canUserDeleteAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canUserReadAsync",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDelegable",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPagable",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDataAvailable",{get:function(){return this.stage>=n.LifeCycleStage.Loaded&&this.stage<n.LifeCycleStage.Disposed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataInternal",{get:function(){return this._data},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataTableInternal",{get:function(){return this._data},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.dataInternal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataChanged",{get:function(){return this._dataChangedEvent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataLoaded",{get:function(){return this._dataLoadedEvent},enumerable:!1,configurable:!0}),t.prototype.queryTableAsync=function(e){return Promise.resolve(f.createGatedError(y.Conflict,g.Severe))},t.prototype.queryRecordAsync=function(e){return Promise.resolve(f.createGatedError(y.Conflict,g.Severe))},t.prototype.queryScalarAsync=function(e){return Promise.resolve(f.createGatedError(y.Conflict,g.Severe))},t.prototype.tryGetTableMetadata=function(){return null},t.prototype.rowState=function(e){return AppMagic.Data.State.NoChange},t.prototype.pending=function(e,t){return AppMagic.Data.DataTable.create()},t.prototype.refreshAsync=function(e){return Promise.resolve(!1)},t.prototype.collectAsync=function(e,t){return Object(a.collectItems)(this.dataTableInternal,t,this.dataRuntime)&&this._onDataChanged(),Promise.resolve(this.dataTableInternal)},t.prototype.removeAsync=function(e,t,r){return Object(o.removeRows)(this.dataTableInternal,e,r)&&this._onDataChanged(),Promise.resolve(this.dataTableInternal)},t.prototype.removeIfAsync=function(e,t){var r=this;return Object(o.getIndicesAsync)(this.dataTableInternal,e).then((function(e){return AppMagic.Data.ErrorValue.isErrorValue(e)?e:(Object(o.removeIndices)(r.dataTableInternal,e)&&r._onDataChanged(),r.dataTableInternal)}))},t.prototype.removeIfDelegatedAsync=function(e,t){return Promise.resolve(f.createGatedError(y.Conflict,g.Severe))},t.prototype.updateAsync=function(e,t,r,n){return Object(i.updateDValueRows)(this.dataTableInternal,e,t,n,this._dataRuntime)&&this._onDataChanged(),Promise.resolve(this.dataTableInternal)},t.prototype.updateIfAsync=function(e,t){var r=this,a=this.dataTableInternal.map((function(t,n){return Object(i.updateRowIfAsync)(r.dataTableInternal,n,e,r.dataRuntime)}));return Object(n.PromiseUtility_join)(a).then((function(e){if(e.some((function(e){return e}))&&r._onDataChanged(),AppMagic.Data.ErrorValue.isErrorHandlingFeatureEnabled()){var t=e.filter((function(e){return AppMagic.Data.ErrorValue.isErrorValue(e)})),n=AppMagic.Data.ErrorValue.normalizeErrors(t);if(n)return n}return r.dataTableInternal}),(function(e){return Object(n.isCanceledError)(e)||n.Log.trackErrorEvent("PowerAppsClient.Functions.InternalError",{type:"PromiseRejection",functionName:"UpdateIf",reason:e}),AppMagic.Data.ErrorValue.createGatedError(AppMagic.Data.ErrorKind.Unknown,AppMagic.Data.ErrorSeverity.Severe)}))},t.prototype.updateIfDelegatedAsync=function(e,t,r){return void 0===r&&(r=null),Promise.resolve(f.createGatedError(y.Conflict,g.Severe))},t.prototype.patchAsync=function(e,t,r){var a=null,o=this.dataTableInternal,i=o.length,c=Object.keys(e),u=c.length,l=Object.keys(t);if(u>0)for(var d=0;d<i;d++){var p=o[d];if(null!==p){for(var f=!0,y=0;y<u;y++){var g=c[y],h=p[g];if(!Object(n.isUndefined)(h)&&!Object(n.deepCompare)(h,e[g])){f=!1;break}}if(f){for(var m=0,v=l.length;m<v;m++){var b=l[m],_=p[b];if(!this.shouldEnforceRowSchemaOnPatch||Object(n.isDefined)(_)){Object(s.releaseBlobs)(_);var C=AppMagic.Utility.clone(t[b],!0,!0);Object(s.addRefBlobs)(C),p[b]=C}}this.dataRuntime.assignRowID(p),a=p;break}}}return null===a&&(a=AppMagic.Utility.clone(t,!0,!0),Object(s.addRefBlobs)(a),this.dataRuntime.assignRowID(a),o.push(a)),this._onDataChanged(),Promise.resolve(a)},t.prototype.revertAsync=function(e,t){var r=this.dataTableInternal;if(Object(n.isNullOrUndefined)(t))return Promise.resolve(r);var a,o=Object(d.safeCast)(t),i=!0;null===o&&(i=!1,(o=AppMagic.Data.DataTable.create()).push(t));for(var s=0,c=o.length;s<c;s++){var u=o[s];if(null!==u){a=null;for(var l=0,p=r.length;l<p;l++){var f=r[l];if(null!==f&&Object(n.deepCompare)(f,u)){a=f;break}}if(null===a){var h=AppMagic.Strings.ConnectedDataRowNotFound,m={errorContext:e,errorMessage:h,raiseToastNotification:!1,wasReported:!1,functionName:"Revert"};return Promise.resolve(AppMagic.Data.ErrorValue.createGatedError(y.NotFound,g.Severe,h,m))}}}return i?Promise.resolve(r):Promise.resolve(a)},t.prototype.errors=function(e){return Object(c.create)()},t.prototype.downloadMediaResourceAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){throw new AppMagic.Common.Media.MediaResourceError("Media resources are not supported by this datasource kind: "+l.DataSourceKind[this.kind])}))}))},t.prototype.tryCreateLookupColumnReference=function(e,t){return this.dataRuntime.reportRuntimeError(t,AppMagic.Strings.LookupFunctionNotSupported),null},t.prototype._loadingAsync=function(){var t=this;return e.prototype._loadingAsync.call(this).then((function(){return t._loadingInitialDataAsync()}))},t.prototype._reportDataSourceLoadErrorMessage=function(e){var t;t=e.serverErrorMessage?Object(n.CoreUtility_formatString)(AppMagic.Strings.FailedToLoadDataSourceWithServerError,this.name,e.message,e.serverErrorMessage):Object(n.CoreUtility_formatString)(AppMagic.Strings.FailedToLoadDataSource,this.name,e.message),this.dataRuntime.reportRuntimeError(null,t,e.serverError)},t.prototype.getDefaultRecord=function(){var e=this.tryGetTableMetadata();return null===e?AppMagic.Data.DataRecord.create():e.getDefaultRow()},t.prototype._onLoaded=function(){e.prototype._onLoaded.call(this),this._dataChangePending&&this._dataChangedEvent.dispatch({name:this._getDataSourceName()})},t.prototype._unloading=function(){e.prototype._unloading.call(this),null!==this._data&&(this._disposeData(this._data),this._data=null)},t.prototype._setData=function(e){null!==this._data&&this._disposeData(this._data),AppMagic.Data.DataValue.isDataTable(e)&&this.dataRuntime.assignTableID(e),Object(u.setAppDataSource)(e,this),this._data=e},t.prototype._getDataSourceName=function(){return this.name},t.prototype._onDataChanged=function(){n.CoreLog.verbose("AppDataSource[{0}]: data changed",this.name),this.isLoaded?this._dataChangedEvent.dispatch({name:this._getDataSourceName()}):this._dataChangePending=!0},t.prototype.registerGlobalAsyncTaskExecuter=function(e){this._globalAsyncTaskExecuter=e},t.prototype._onDataChangedAsync=function(){if(n.CoreLog.verbose("AppDataSource[{0}]: data changed async",this.name),this._globalAsyncTaskExecuter)return this._globalAsyncTaskExecuter.executeTasksAsync()},t.prototype._onDataLoaded=function(){n.CoreLog.verbose("AppDataSource[{0}]: data changed",this.name),this._dataLoadedEvent.dispatch({name:this.name})},t.prototype._disposeData=function(e){n.Log.trackActivityEvent("AppDataSource._disposeData",{isDataNull:!!e,dataSize:Object(n.isArray)(e)?e.length:-1}),Object(s.releaseBlobs)(e);var t=Object(d.safeCast)(e);null!==t&&(t.length=0),Object(u.removeMetadataProperties)(e)},t}(p.AppComponent)},function(e,t,r){"use strict";r.r(t),r.d(t,"createGetRowsResponse",(function(){return g})),r.d(t,"createResponseItemType",(function(){return h}));var n=r(0),a=r(25),o=r(75),i=AppMagic.Data,s=AppMagic.Services.Rest,c=AppMagic.Services.TypeSystem,u=AppMagic.Services.CdpConstants,l=AppMagic.Services.ODataConstants,d=AppMagic.Schema,p=i.ConnectedDataConstants.TypesManagerPrefix,f=new s.JsonResponseParam("/@odata.count",new c.InlinedTTypeRef(new c.JsonNumberTType(d.TypeNumber,c.NumericXsdType.Int))),y=new s.JsonResponseParam("/@odata.nextLink",new c.InlinedTTypeRef(new c.JsonStringTType));function g(e,t,r,a){var o=Object(n.HashTableUtility_create)();return o.items=new s.JsonResponseParam("/value",new c.InlinedTTypeRef(new c.JsonArrayTType(h(e,t,r,a)))),o.nextLink=y,o.resultCount=f,o}function h(e,t,r,o){var i=e.getType(p,r);if(Object(n.checkObject)(i,"We must have metadata for entity '".concat(r,"' that is referenced in query option. (Data Source: '").concat(t,"')")),!o)return new c.InlinedTTypeRef(i);var s={dataSourceName:t,expandedProperties:Object(n.HashTableUtility_create)()};return new c.InlinedTTypeRef(m(e,i,a.Expand.toExpandsHashTable(o.expands),a.Expand.toSelectsHashTable(o.selects),s))}function m(e,t,r,i,s){var d=Object(n.HashTableUtility_create)(),f=Object(n.HashTableUtility_isEmpty)(i);return Object(n.HashTableUtility_forEach)(t.properties,(function(t,y){if(y===u.CdpNavigationRefIdKey||y===l.MetadataPropertyName.ETag||y===l.MetadataPropertyName.Id||y.indexOf(u.MetadataPropertyNames.NextLink)>=0)d[y]=t;else if(f||i[y]){var g=r[y];if(g){var h=t.ttypeRef.getType();try{var v=void 0;v=h.isArray?function(e,t,r,a,o){var i=e.getType(p,t);return Object(n.checkObject)(i,"We must have metadata for entity '".concat(t,"' that is referenced in query option. (Data Source: '").concat(o.dataSourceName,"')")),new c.JsonArrayTType(new c.InlinedTTypeRef(m(e,i,r,a,o)))}(e,h.targetTableName,a.Expand.toExpandsHashTable(g.expands),a.Expand.toSelectsHashTable(g.selects),s):function(e,t,r,a,o){var i=e.getType(p,t);return Object(n.checkObject)(i,"We must have metadata for entity '".concat(t,"' that is referenced in query option. (Data Source: '").concat(o.dataSourceName,"')")),m(e,i,r,a,o)}(e,h.targetTableName,a.Expand.toExpandsHashTable(g.expands),a.Expand.toSelectsHashTable(g.selects),s),d[y]={ttypeRef:new c.InlinedTTypeRef(v),displayIdx:t.displayIdx}}catch(e){if(!(e instanceof o.RuntimeTypeError))throw e;d[y]=t}}else d[y]=t}})),new c.JsonObjectTType(d)}},function(e,t,r){"use strict";r.r(t),r.d(t,"clone",(function(){return a}));r(0);var n=r(5);AppMagic.Data.DataRecord;function a(e){return null!==e&&(e=AppMagic.Utility.clone(e,!0,!0),Object(n.addRefBlobs)(e)),e}},function(e,t,r){"use strict";r.r(t),r.d(t,"RuntimeTypeError",(function(){return n}));var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(Core.ApplicationError)},function(e,t,r){"use strict";r.r(t),r.d(t,"QueryableDataSource",(function(){return n}));var n=function(){function e(e,t){var r=this;this._className="queryableDataSource",this._dataSource=e,this._queryTable=new Core.AsyncLazy("QueryableDataSource._queryTable",(function(){return r._dataSource.queryTableAsync(t)})),this._options=t}return Object.defineProperty(e.prototype,"_AppDataSource_14BAD897C9494B419D017C43327692D9",{get:function(){return this._dataSource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},enumerable:!1,configurable:!0}),e.prototype.queryTableAsync=function(e){return this._options&&this._options.selects&&(e=this._mergeSelects(e)),this._dataSource.queryTableAsync(e)},e.prototype.cloneAsync=function(){return Promise.resolve(new e(this._dataSource,this._options))},e.prototype._mergeSelects=function(e){if(this._options&&this._options.selects)if(e){e.selects||(e.selects=[]);var t=HashTableUtility.create();e.selects.forEach((function(e){t[e]=!0})),this._options.selects.forEach((function(r){t[r]||e.selects.push(r)}))}else e=this._options;return e},e.prototype.queryRecordAsync=function(e){return this._dataSource.queryRecordAsync(e)},e.prototype.queryScalarAsync=function(e){return this._dataSource.queryScalarAsync(e)},Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._dataSource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataSourceName",{get:function(){return this._dataSource.name},enumerable:!1,configurable:!0}),e.prototype.getPrimaryKey=function(e){return this._dataSource.getPrimaryKey(e)},e.prototype.tryGetPrimaryKey=function(e){return this._dataSource.tryGetPrimaryKey(e)},e.prototype.getNextResultsAsync=function(e,t,r){return this._queryTable.valueAsync().then((function(n){return n.getNextResultsAsync(e,t,r)}))},e.prototype.getResultCountAsync=function(e){return this._queryTable.valueAsync().then((function(t){return t.getResultCountAsync(e)}))},e.prototype.getQueryKeyAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this._queryTable.valueAsync()];case 1:return[2,e.sent().getQueryKeyAsync()]}}))}))},Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"DataSetEntityRecord",(function(){return u}));var n=r(0),a=r(49),o=r(4),i=r(41),s=AppMagic.Data,c=AppMagic.Services.ODataConstants.MetadataPropertyName.Type,u=function(){function e(e,t,r,n,a,o,i){var s;this.datasource=e,this.record=t,this._connectorBaseUrl=n,this._isDirty=!1,this.invalidColumns={},this.currentRecordState=Object.assign({},t),this._aliasMap=a||{},this._recordId=o,this._isNewRecord=i,this.attributeMetadata=null===(s=null==r?void 0:r.primaryEntityMetadata)||void 0===s?void 0:s.metadata,this.relatedEntityMetadata=null==r?void 0:r.relatedEntityMetadata}return e.prototype.getTypeNameFromColumnName=function(e){return this.attributeMetadata&&e in this.attributeMetadata?this.attributeMetadata[e].Type:""},e.prototype.isColumnInvalid=function(e){return void 0!==this.invalidColumns[e]},e.prototype.isColumnSet=function(e){return void 0!==this.currentRecordState[e]},e.prototype.getRecordId=function(){if(this.datasource){var e=this.datasource.tryGetPrimaryKey(this.record);return this._isNewRecord&&!e?this._recordId:e&&e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e||this._recordId}return this._recordId},e.prototype.getNamedReference=function(){var e,t,r=null===(e=this.datasource)||void 0===e?void 0:e.name;return"default.cds"===(null===(t=this.datasource)||void 0===t?void 0:t.datasetName)&&(r=this.datasource.logicalName),{etn:r,id:{guid:this.getRecordId()},name:null}},e.prototype.getRelatedColumnNamedReference=function(e,t){var r,n,a;if(!t)return null;var o=((null===(n=null===(r=this.attributeMetadata)||void 0===r?void 0:r[e])||void 0===n?void 0:n.Targets)||[])[0],i=(null===(a=this.relatedEntityMetadata)||void 0===a?void 0:a[o])||{},s=i.primaryNameAttribute,c=t[i.primaryIdAttribute],u=t[s];if((!o||!c)&&AppMagic.Data.DataEntityRecord.isDataEntityRecord(t)&&(o=null!=o?o:AppMagic.Data.DataEntityRecord.getTableName(t),c=null!=c?c:AppMagic.Data.DataEntityRecord.getCanonicalId(t),!u&&2===Object.keys(t).length)){var l=Object.keys(t),d=l[0],p=l[1];u=t[d]===c?t[p]:t[d]}return o&&c?{etn:o,id:{guid:c},name:u}:null},e.prototype.getLookupValue=function(e,t){var r;if(!n.FallbackSwitch.isActivated("PCF.CanvasCdpLookupV2Fallback")&&t&&c in t)switch(t[c]){case"#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference":return t.Value;case"#Microsoft.Azure.Connectors.SharePoint.SPListExpandedUser":return t.DisplayName}return null!==(r=this.getRelatedColumnNamedReference(e,t))&&void 0!==r?r:t},e.prototype.getValue=function(e){var t,r=this._aliasMap[e]||e;if(this.isColumnInvalid(r))return this.invalidColumns[r].value;if(!this.isColumnSet(r))return null;var a=this.currentRecordState[r],i=this.getTypeNameFromColumnName(r);switch(i){case o.PcfTypes.SingleLineText:case o.PcfTypes.SingleLineUrl:case o.PcfTypes.Currency:case o.PcfTypes.Decimal:return a;case o.PcfTypes.TwoOptions:return!n.FallbackSwitch.isActivated("Controls.NullableTwoOption")&&null===a?null:l(a)?!!a.Id:!!a;case o.PcfTypes.OptionSet:return null!==(t=null==a?void 0:a.Id)&&void 0!==t?t:null;case o.PcfTypes.MultiSelectOptionSet:return d(a)?a.map((function(e){return e.Value.Id})):null;case o.PcfTypes.DateAndTime:case o.PcfTypes.DateAndTimeDateOnly:return new Date(a);case o.PcfTypes.LookupSimple:return this.getLookupValue(r,a);case o.PcfTypes.Image:case o.PcfTypes.File:return this._getFileImageObject(r,i);case o.PcfTypes.Object:return a;default:if(l(a))return a.Id;var s=this.getRelatedColumnNamedReference(r,a);return null!=s?s:a}},e.prototype._getFileImageObject=function(e,t){var r=this.currentRecordState[e],n=null,a=null,i=0;f(r)&&(n=r.Value)&&(a=AppMagic.Utility.blobManager.contains(n)?AppMagic.Utility.blobManager.getBinary(n):null,i=AppMagic.Utility.blobManager.getRefCount(n));var s=this._connectorBaseUrl,c="",u=0,l="",d=this.currentRecordState[e];p(d)&&(c=d.fileName,u=d.fileSize,l=d.mimeType);var h=this.currentRecordState[e];if(y(h)&&(c=h.FileName),n&&a&&i>0&&(u=a.size,l=a.mimeType),n&&t===o.PcfTypes.Image){var m="",v=null==a?void 0:a.source;return g(v)&&(m=v.base64),this._handleImage(n,e,s,"",c,u,l,m)}return this._handleFile(n,e,s,"",c,u,l)},e.prototype._handleImage=function(t,r,a,o,i,s,c,u){var l,d,y="",g=this.currentRecordState[r];if(f(g)&&!p(this.currentRecordState[r])&&t&&a){var h=null===(d=null===(l=new n.Core_Url(g.Full))||void 0===l?void 0:l.getSegment(AppMagic.AppResourceUri.SegmentIndexes.ConnectedDataSourceTableName))||void 0===d?void 0:d.toLowerCase();"".concat(h,"(").concat(this.getRecordId(),")/").concat(r,"$value");var m=this.getRecordId();y=e._generateThumbnailUrl(h,r,a,m)}return{fileName:i,fileSize:s,mimeType:c,fileContent:u,fileUrl:"",thumbnailUrl:y}},e._generateThumbnailUrl=function(e,t,r,a){var o=new n.Core_Url(r).origin(),i=new n.UrlTemplate("{domainUrl}/Image/download.aspx?Entity={entityName}&Attribute={columnName}&Id={recordId}");return decodeURIComponent(i.expandUrlString({domainUrl:o,entityName:e,columnName:t,recordId:a}))},e.prototype._handleFile=function(e,t,r,a,o,i,s){var c;if(!p(this.currentRecordState[t])){var u=this.currentRecordState["".concat(t).concat("_cachedFile")];if(e&&r){var l=new n.Core_Url(e),d=null==l?void 0:l.getSegment(AppMagic.AppResourceUri.SegmentIndexes.ResourceName).toLowerCase();a="".concat(r,"/").concat(d,"(").concat(this.getRecordId(),")/").concat(t,"/$value"),this._loadFileWhenNoCacheExist(u,l,t)}u&&function(e){var t=e;return void 0!==(null==t?void 0:t.size)&&(void 0!==(null==t?void 0:t.mimeType)||void 0!==(null==t?void 0:t.contentType))}(u)&&(i=null==u?void 0:u.size,s=null!==(c=null==u?void 0:u.mimeType)&&void 0!==c?c:null==u?void 0:u.contentType)}return{fileName:o,fileSize:i,mimeType:s,fileContent:"",fileUrl:a}},e.prototype._loadFileWhenNoCacheExist=function(e,t,r){return __awaiter(this,void 0,void 0,(function(){var n,a;return __generator(this,(function(o){switch(o.label){case 0:return e?[2]:[4,this.datasource.downloadMediaResourceAsync(t)];case 1:return n=o.sent(),a=AppMagic.Utility.blobManager.getBinary(n),this.currentRecordState["".concat(r).concat("_cachedFile")]={contentType:null==a?void 0:a.contentType,mimeType:null==a?void 0:a.mimeType,size:null==a?void 0:a.size},[2]}}))}))},e.prototype.getFormattedValue=function(e){var t,r,a,i,s,c,u=this._aliasMap[e]||e;if(this.isColumnInvalid(u))return null===(r=null===(t=this.invalidColumns[u])||void 0===t?void 0:t.value)||void 0===r?void 0:r.toString();if(!this.isColumnSet(u))return null;if(!this.currentRecordState.hasOwnProperty(u))return"";switch(this.getTypeNameFromColumnName(u)){case o.PcfTypes.TwoOptions:if(!n.FallbackSwitch.isActivated("Controls.NullableTwoOption")&&null===this.currentRecordState[u])return null;var h=this.currentRecordState[u];return l(h)?h.Value:this.getValue(u)?"True":"False";case o.PcfTypes.OptionSet:return null!==(i=null===(a=this.currentRecordState[u])||void 0===a?void 0:a.Value)&&void 0!==i?i:null;case o.PcfTypes.MultiSelectOptionSet:var m=this.currentRecordState[u];return d(m)?m.map((function(e){return e.Value.Value})).join("; "):null;case o.PcfTypes.Decimal:return c=null===(s=this.currentRecordState[u])||void 0===s?void 0:s.toString(),Object(n.isNullOrUndefined)(c)?"":c;case o.PcfTypes.DateAndTime:var v=this.getValue(u);return(null==v?void 0:v.toLocaleDateString())+" "+(null==v?void 0:v.toLocaleTimeString());case o.PcfTypes.DateAndTimeDateOnly:var b=this.getValue(u);return null==b?void 0:b.toLocaleDateString();case o.PcfTypes.LookupSimple:var _=this.getLookupValue(u,this.currentRecordState[u]);return _?"string"==typeof _?_:_.name:JSON.stringify(this.getValue(u));case o.PcfTypes.SingleLineText:case o.PcfTypes.SingleLineUrl:case o.PcfTypes.Currency:case o.PcfTypes.Object:return this.currentRecordState[u];case o.PcfTypes.Image:var C=void 0,A=this.currentRecordState[u];if(f(A)){var S=null==A?void 0:A.Value;C=AppMagic.Utility.blobManager.contains(S)?AppMagic.Utility.blobManager.getBinary(S):null}var D=null==C?void 0:C.source;return g(D)?D.base64:"";case o.PcfTypes.File:var O=this.currentRecordState[u];if(p(O)&&0!==(null==O?void 0:O.fileName.length))return null==O?void 0:O.fileName;var E=this.currentRecordState[u];return y(E)?null==E?void 0:E.FileName:"";default:var T=this.currentRecordState[u];if("string"==typeof T)return T;if(l(T))return T.Value;var R=this.getRelatedColumnNamedReference(u,T);return R?R.name:Object(n.isNullOrUndefined)(T)?T:JSON.stringify(T)}},e.prototype.getColumnInfo=function(e){return Promise.resolve({error:!1,type:null,errorMessage:null,security:{editable:!0,readable:!0,secured:!0}})},e.prototype.isDirty=function(){return this._isDirty},e.prototype.setValue=function(e,t){var r={validatedValue:t,errorMessage:"",isValid:!0};if(this.attributeMetadata){var i=this.getTypeNameFromColumnName(e);i!==o.PcfTypes.Image&&i!==o.PcfTypes.File||!t.fileUrl?n.Log.trackErrorEvent("DataSetEntityRecord_setValue",{name:"InvalidValueError",message:"File/image does not have fileUrl attribute"}):(t=JSON.parse(JSON.stringify(t)),i===o.PcfTypes.File&&delete this.currentRecordState["".concat(e).concat("_cachedFile")]);var s=Object(a.GetValidator)(this.attributeMetadata[e])(t);r.isValid=null===s.validationError,r.validatedValue=s.parsedValue,s.validationErrorString&&(r.errorMessage=s.validationErrorString)}if(r.isValid)return void 0!==this.invalidColumns[e]&&delete this.invalidColumns[e],this.currentRecordState[e]=r.validatedValue,this._isDirty=!0,Promise.resolve();var c=r.errorMessage?r.errorMessage:"";this.invalidColumns[e]={message:c,value:t};var u={name:"InvalidValueError",message:c};return n.Log.trackErrorEvent("DataSetEntityRecord_setValue",u),Promise.reject(u)},e.prototype.isValid=function(){return 0===Object.keys(this.invalidColumns).length},e.prototype.save=function(){return __awaiter(this,void 0,Promise,(function(){var e,t,r,a=this;return __generator(this,(function(i){switch(i.label){case 0:return this.isValid()?this._isDirty&&this.currentRecordState?(t=Object.keys(this.getChanges()))&&this.attributeMetadata?[4,Object(n.PromiseUtility_join)(t.map((function(e){return __awaiter(a,void 0,void 0,(function(){var t,r,a,i;return __generator(this,(function(s){switch(s.label){case 0:return this.getTypeNameFromColumnName(e)!==o.PcfTypes.Image&&this.getTypeNameFromColumnName(e)!==o.PcfTypes.File?[3,4]:p(t=this.currentRecordState[e])?[4,fetch(null==t?void 0:t.fileUrl)]:[3,3];case 1:return[4,null==(r=s.sent())?void 0:r.blob()];case 2:a=s.sent(),i=AppMagic.Utility.blobManager.addBinary(n.PABinary.createFromBlob(a)),this.currentRecordState[e].Value=i,this.getTypeNameFromColumnName(e)===o.PcfTypes.Image&&(this.currentRecordState[e].Full=i),s.label=3;case 3:this.getTypeNameFromColumnName(e)===o.PcfTypes.File&&p(t)&&(this.currentRecordState[e].FileName=null==t?void 0:t.fileName),s.label=4;case 4:return[2]}}))}))})))]:[3,2]:[3,4]:(e={name:"InvalidValueError",message:"Cannot save because columns contain invalid value"},n.Log.trackErrorEvent("DataSetEntityRecord_save",e),[2,Promise.reject(e)]);case 1:i.sent(),i.label=2;case 2:return[4,this.datasource.patchAsync(this.record,this.currentRecordState)];case 3:if(r=i.sent(),s.ErrorValue.isErrorValue(r))return n.Log.trackErrorEvent("DataSetEntityRecord_save",r),[2,Promise.reject(r)];this.record=r,this.currentRecordState=Object.assign({},r),this._isNewRecord&&this._recordId!==this.getRecordId()&&(this._recordId=this.getRecordId(),this._isNewRecord=!1),this._isDirty=!1,i.label=4;case 4:return n.Log.trackActivityEvent("DataSetEntityRecord_save",{message:"save successful"}),[2,this]}}))}))},e.prototype.getRecord=function(){return this.record},e.prototype.getChanges=function(){try{return Object(i.getShallowChanges)(this.currentRecordState,this.record)}catch(e){return n.CoreLog.errorEx("AppMagicData.DatasetEntityRecord.getChanges",{error:e}),{}}},e}();function l(e){return e&&"object"==typeof e&&e.hasOwnProperty("Id")&&e.hasOwnProperty("Value")}function d(e){if(e&&Array.isArray(e)){for(var t=0,r=e;t<r.length;t++){var n=r[t];if(!n.hasOwnProperty("Value")||!l(n.Value))return!1}return!0}return!1}function p(e){var t=e;return void 0!==(null==t?void 0:t.fileName)&&(void 0!==(null==t?void 0:t.fileSize)||void 0!==(null==t?void 0:t.mimeType)||void 0!==(null==t?void 0:t.fileUrl))}function f(e){return void 0!==(null==e?void 0:e.Value)}function y(e){var t=e;return void 0!==(null==t?void 0:t.FileName)&&void 0!==(null==t?void 0:t.Value)}function g(e){return void 0!==(null==e?void 0:e.base64)}},function(e,t,r){"use strict";r.r(t),r.d(t,"create",(function(){return n}));r(0);function n(e){return{Heading:e}}},function(e,t,r){"use strict";r.r(t),r.d(t,"RuntimeBase",(function(){return w}));var n=r(1),a=r(220),o=r(88),i=r(52),s=r(40),c=r(53),u=r(107),l=(r(95),r(39),r(60)),d=r(11),p=r(87),f=r(4),y=(r(23),r(116)),g=r(76),h=r(119),m=r(32),v=r(15),b=r(123),_=r(89),C=r(5),A=r(0),S=AppMagic.Constants.Runtime,D=Core.Diagnostics.MonitorLogLevel,O=Core.Telemetry.AppInsightsSeverityLevel,E=AppMagic.Runtime,T=AppMagic.Data,R=AppMagic.Services,w=function(){function e(e){this._currentAppHost=null,this._activeScreenIndex=null,this._ongoingAsyncDataActions=0,this._reachabilitySuffix=S.reachabilitySuffix,this._globalBindingContext=null,this._appDataSourceOnLoadEventManager=null,this._defaultBindingContextId="_bindingContext_4a104b4c347040e78eaefcd77a7f151e",this._globalBindingContext=e,this._currentAppHost=null,this._data=HashTableUtility.create(),this._rules=HashTableUtility.create(),this._propertyRules=HashTableUtility.create(),this._namedFormulaCache=HashTableUtility.create(),this._behaviorPromiseQueues=HashTableUtility.create(),this._dataRulePromises=HashTableUtility.create(),this._dataTemplates=HashTableUtility.create(),this._processedCrossScreenDependentRules=HashTableUtility.create(),this._controlCreationPromises=HashTableUtility.create(),this._asyncRuleErrors=new Set,this._documentId="",this._navigationStack=[],this._firstOnStartPromise=Core.PromiseUtils.createCompletablePromise(),this._urlMapping=HashTableUtility.create(),this._delayedDataFlowScreenIdToPropertiesMap=HashTableUtility.create(),this._delayedDataFlowPropertyToFunctionMap=HashTableUtility.create(),this._progressIndicatorViewModel=Core.Loader.ObjectFactory.instance.getSingleton(Core.UI.Components.NotificationHostViewModel.singletonKey),this._appPreviewFlagSetEvent=new EventObject,this._lastRuleExecutionTime=0,this._pendingPromisesCount=0,this._runPropertyRuleInternal=this._runPropertyRuleInternal.bind(this),this._populateUrlMap()}return Object.defineProperty(e.prototype,"activeScreenIndex",{get:function(){return this._activeScreenIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"progressIndicatorViewModel",{get:function(){return this._progressIndicatorViewModel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"documentId",{get:function(){return this._documentId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalBindingContext",{get:function(){return this._globalBindingContext},enumerable:!1,configurable:!0}),e.prototype.waitFirstAppInfoOnStartCompletedAsync=function(){return Core.PromiseUtils.preventCancel(this._firstOnStartPromise.promise)},Object.defineProperty(e.prototype,"appPreviewFlagSetEvent",{get:function(){return this._appPreviewFlagSetEvent},enumerable:!1,configurable:!0}),e.prototype.startApp=function(e){Core.Log.verbose("runtimebase.startApp"),this._currentAppHost=e,this._initializeApp()},e.prototype.tryGetRuleById=function(e){return this._rules[e]||null},e.prototype._initializeApp=function(){this._currentAppHost.initialize(),AppMagic.Initialization&&AppMagic.Initialization.appCreationSource&&this._currentAppHost.appInstance.initializeAppCreationSource(AppMagic.Initialization.appCreationSource),this._currentAppHost.appInstance.initialize(),this._appDataSourceOnLoadEventManager=new u.AppDataSourceOnDataLoadEventManager(this),this.currentApp.appDataChanged.addListener(this._onAppDataChanged,this),this.currentApp.dataManager.cacheDataChangeManager.onDataChanged.addListener(this._onConnectedDataSourceDataChanged.bind(this))},e.prototype.stopApp=function(){Core.Log.verbose("runtimebase.stopApp"),this._unloadingApp(),this._disposingApp()},e.prototype._unloadingApp=function(){var e=this._currentAppHost.appInstance;e.isLoaded&&e.unload();var t=this._currentAppHost;t.isLoaded&&t.unload()},e.prototype._disposingApp=function(){this._appDataSourceOnLoadEventManager.dispose(),this._appDataSourceOnLoadEventManager=null,this.currentApp.appDataChanged.removeListener(this._onAppDataChanged),this._currentAppHost.appInstance.dispose(),this._currentAppHost.dispose(),this._currentAppHost=null,this._data=HashTableUtility.create(),this._rules=HashTableUtility.create(),this._propertyRules=HashTableUtility.create(),this._delayedDataFlowScreenIdToPropertiesMap=HashTableUtility.create(),this._delayedDataFlowPropertyToFunctionMap=HashTableUtility.create(),this._processedCrossScreenDependentRules=HashTableUtility.create(),this._controlCreationPromises=HashTableUtility.create(),this._asyncRuleErrors=new Set,this._documentId="",this._navigationStack=[],this._firstOnStartPromise=Core.PromiseUtils.createCompletablePromise(),C.blobManager.releaseAll(),C.localFileCache.clear(),Object(v.getLanguageRuntime)().dispose()},e.prototype._scheduleDelayDataFlow=function(e,t,r,n){for(var a=this,o=function(o,s){var c=t[o];if(i._delayedDataFlowScreenIdToPropertiesMap[c]||(i._delayedDataFlowScreenIdToPropertiesMap[c]=HashTableUtility.create()),n instanceof Array)n.forEach((function(t){var n=e+(t?"_"+t.id:"");a._delayedDataFlowScreenIdToPropertiesMap[c][n]=n,a._delayedDataFlowPropertyToFunctionMap[n]=r.bind(a,t)}));else{var u=e+(n?"_"+n.id:"");i._delayedDataFlowScreenIdToPropertiesMap[c][u]=u,i._delayedDataFlowPropertyToFunctionMap[u]=r.bind(i,n)}},i=this,s=0,c=t.length;s<c;s++)o(s)},e.prototype.pushToNavigationStack=function(e,t){this._navigationStack.push({targetName:e,screenTransition:t})},e.prototype.clearNavigationStack=function(){var e=this._navigationStack.length>0;return this._navigationStack.length=0,e},e.prototype.runOptimizedReplicatedDataFlow=function(e,t,r,n){var a=e+this._reachabilitySuffix;return!!Core.Utility.isFunction(this._rules[a])&&this._rules[a](r,n,t)},e.prototype.tryGetBackNavigationScreen=function(e){return this._getBackNavigationScreen(e,!0)},e.prototype.peekBackNavigationScreen=function(e){return this._getBackNavigationScreen(e,!1)},e.prototype._getBackNavigationScreen=function(e,t){for(var r=this._navigationStack.length-1;r>=0;r--){var n=this._navigationStack[r];if(t&&this._navigationStack.pop(),n.targetName!==e&&this.containsScreenByName(n.targetName))return n}return null},e.prototype._scheduleAsyncRule=function(e,t,r,n){var a=this;if(this._dataRulePromises){this._dataRulePromises[t]||(this._dataRulePromises[t]=HashTableUtility.create());var o,i=this._dataRulePromises[t],s=new AbortController,c=!1,u=function(){return __awaiter(a,void 0,void 0,(function(){var e;return __generator(this,(function(a){switch(a.label){case 0:return a.trys.push([0,4,5,6]),this._pendingPromisesCount++,this._lastRuleExecutionTime=Date.now(),o=n(s.signal),Core.FallbackSwitch.isActivated("RuntimeBase.DisableAsyncRuleExecutionHack")?[3,2]:[4,globalScopeObject.NativePromise.resolve()];case 1:a.sent(),a.label=2;case 2:return Core.PromiseUtils.throwIfAborted(s.signal),[4,o];case 3:return a.sent(),[3,6];case 4:return e=a.sent(),Core.Utility.isCanceledError(e)||this._asyncRuleErrors.has(t)||(this._asyncRuleErrors.add(t),Core.Log.errorEx("RuntimeBase._scheduleAsyncRule",{error:e})),[3,6];case 5:return c||delete i[r],this._pendingPromisesCount--,this._lastRuleExecutionTime=Date.now(),[7];case 6:return[2]}}))}))}();i[r]={promise:u,cancel:function(){c=!0,delete i[r],Core.PromiseUtils.isPromise(o)&&Core.PromiseUtils.abortPromise(o,s)}},this.currentApp.scopeMonitor.trackPromise(e,t,u)}},e.prototype._cancelAsyncRuleExecution=function(e,t){var r,n,a;null===(a=null===(n=null===(r=this._dataRulePromises)||void 0===r?void 0:r[e])||void 0===n?void 0:n[t])||void 0===a||a.cancel()},e.prototype.cancelAsyncRuleExecutionsForBindingContext=function(e){this._dataRulePromises&&HashTableUtility.forEach(this._dataRulePromises,(function(t){var r;null===(r=t[e])||void 0===r||r.cancel()}))},e.prototype.getPendingDataRuleCount=function(e,t){var r=this._dataRulePromises;if(!r)return 0;var n=Object.keys(r);t&&(n=n.filter((function(e){return-1!==t.indexOf(e.split(".")[0])})));var a=0;return n.forEach((function(t){(null!=e?e:Object.keys(r[t])).forEach((function(e){r[t][e]&&++a}))})),a},e.prototype.waitForPendingDataRulesToExecuteAsync=function(e,t){var r=this._dataRulePromises;if(!r)return Promise.resolve();var n=Object.keys(r);t&&(n=n.filter((function(e){return-1!==t.indexOf(e.split(".")[0])})));var a=[];return n.forEach((function(t){(null!=e?e:Object.keys(r[t])).forEach((function(e){var n,o=null===(n=r[t][e])||void 0===n?void 0:n.promise;o&&a.push(o)}))})),Promise.allSettled(a).then(Core.Utility.noOpFn)},e.prototype.execAsynchronousRule=function(e,t,r,n,a){if(Core.Utility.isArray(n))for(var o=0;o<n.length;o++)this.execAsynchronousRule(e,t,r,n[o],a);else{var i="".concat(e,".").concat(t),s=n.rcManager.authoringAreaBindingContext;if(n===(null==s?void 0:s.observedBindingContext)&&this._cancelAsyncRuleExecution(i,s.id),!a){this._cancelAsyncRuleExecution(i,n.id);var c=n.controlContexts[e];Core.Utility.isDefined(c)&&(c._asyncRules[t]=this._scheduleAsyncRule.bind(this,e,i,n.id,r))}n.isCached||a?a&&r():this._scheduleAsyncRule(e,i,n.id,r)}},e.prototype.onValueChanged=function(e,t,r,n){var a,o=this;if(Core.Utility.isArray(n))n.forEach((function(n){return o.onValueChanged(e,t,r,n)}));else{n=null!=n?n:null;var i="".concat(e,".").concat(t),s=this._rules[i];Core.Utility.isFunction(s)&&s(n),null===(a=null==n?void 0:n.runRuleFn)||void 0===a||a.call(n,i,(function(e,t){var r=o._rules[e];Core.Utility.isFunction(r)&&r(t)}))}},e.prototype.retrieveOrComputeNamedFormulaValue=function(e){var t="".concat(S.namedFormulaGuid,".").concat(e),r=this._propertyRules[t];return void 0===this._namedFormulaCache[t]&&Core.Utility.isFunction(r)&&r(this._globalBindingContext),this._namedFormulaCache[t]},e.prototype.retrieveOrComputeNamedFormulaValueAsync=function(e){var t,r,n;return __awaiter(this,void 0,Promise,(function(){var a,o,i,s;return __generator(this,(function(c){switch(c.label){case 0:return a="".concat(S.namedFormulaGuid,".").concat(e),o=this._propertyRules[a],void 0===this._namedFormulaCache[a]&&Core.Utility.isFunction(o)&&this._dataRulePromises?(i="".concat(S.appInfoUniqueId,".").concat(e),(null===(t=this._dataRulePromises[i])||void 0===t?void 0:t[this.globalBindingContext.id])||o(this._globalBindingContext),(s=null===(r=this._dataRulePromises[i])||void 0===r?void 0:r[this.globalBindingContext.id])?[4,s.promise]:[3,2]):[3,2];case 1:c.sent(),c.label=2;case 2:return[2,null!==(n=this._namedFormulaCache[a])&&void 0!==n?n:null]}}))}))},e.prototype.setNamedFormulaValue=function(e,t,r){var n="".concat(S.namedFormulaGuid,".").concat(e),a=null!=t?t:null,o=this._namedFormulaCache[n]!==a;o||"object"!=typeof a||(o=null!==a),o&&(this._namedFormulaCache[n]=a,this.onValueChanged(S.namedFormulaGuid,e,a,r))},e.prototype.registerUserDefinedFunction=function(e,t,r,n){var a=E.App.Functions.registerFunction(t,r,n,!0,!1),o="".concat(S.userDefinedFunctionGuid,".").concat(r),i=this._rules[o];return Core.Utility.isFunction(i)&&i(e),a},e.prototype.runCrossScreenDependentRules=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0,a=t.length;n<a;n++){var o=e.id,i=t[n];if(this._processedCrossScreenDependentRules[i]){if(this._processedCrossScreenDependentRules[i][o])continue}else this._processedCrossScreenDependentRules[i]=HashTableUtility.create();this._processedCrossScreenDependentRules[i][o]=!1,this._runPropertyRule(i,e)}},e.prototype.runDependentRules=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0,a=t.length;n<a;n++)this._runPropertyRule(t[n],e)},e.prototype.runPropertyRuleForControl=function(e,t,r){var n="".concat(t,".").concat(r);this._runPropertyRule(n,e)},e.prototype.runScreenOnVisibleRule=function(e){var t=this,r=OpenAjax.widget.controlManager.getControl(e),n=this._rules["".concat(r.OpenAjax.uniqueId,".OnVisible")];if(n){this._pendingPromisesCount++,this._lastRuleExecutionTime=Date.now();var a=function(e){return t._lastRuleExecutionTime=Date.now(),t._pendingPromisesCount--,e};return Promise.resolve(n(this._globalBindingContext)).then(a,a)}return Promise.resolve()},e.prototype.runAppInfoOnStartRule=function(e){var t=this,r=Promise.resolve();if(!e){var n=OpenAjax.widget.controlManager.getControl(S.appInfoControlName);if(!n||!n.OpenAjax)return this._firstOnStartPromise.complete(),r;var a=this._rules["".concat(n.OpenAjax.uniqueId,".").concat(S.onStartRuleName)];if(a){this._pendingPromisesCount++,this._lastRuleExecutionTime=Date.now();var o=function(e){return t._pendingPromisesCount--,t._lastRuleExecutionTime=Date.now(),e};(r=Promise.resolve(a(this._globalBindingContext)).then(o,o)).then((function(){t._firstOnStartPromise.complete()}))}else this._firstOnStartPromise.complete()}return r},e.prototype.executeRuleAsync=function(e,t,r){return r(this._rules["".concat(e,".").concat(t)]||null)},e.prototype.runOnDemandDataRuleAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n;return __generator(this,(function(a){return(r=OpenAjax.widget.controlManager.getControl(e))&&(n=this._rules["".concat(r.OpenAjax.uniqueId,".").concat(t)])?[2,Promise.resolve(n(this._globalBindingContext))]:[2,Promise.resolve()]}))}))},e.prototype.getConfirmExitValuesAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,Core.PromiseUtils.join([this.runOnDemandDataRuleAsync(S.appInfoControlName,S.confirmExitRuleName),this.runOnDemandDataRuleAsync(S.appInfoControlName,S.confirmExitMessageRuleName)]).then((function(){var e=OpenAjax.widget.controlManager.getControl(S.appInfoControlName);return{confirmExit:e.getPropertyValue(S.confirmExitRuleName),confirmExitMessage:e.getPropertyValue(S.confirmExitMessageRuleName)}}),(function(){return{confirmExit:!1,confirmExitMessage:""}}))]}))}))},e.prototype.tryNavigateToStartScreenAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,a,o,i;return __generator(this,(function(s){switch(s.label){case 0:r=Core.Telemetry.Log.startScenario(Core.Telemetry.ScenarioName.RunAppStartScreenRule),s.label=1;case 1:return s.trys.push([1,6,,7]),n=Core.Utility.generateNonDashedUUID(),Core.PerformanceTracker.enterScope(n),[4,this.getStartScreenValueAsync()];case 2:return(null==(a=s.sent())?void 0:a.name)&&(null==a?void 0:a.uniqueId)?[4,this.ensureControlsLoadedAsync([a.uniqueId],!0)]:[3,4];case 3:return s.sent(),this.navigateTo(null,a.name,"",e,t),o=Core.PerformanceTracker.exitScopeAndGetRunTime(n),Core.Telemetry.Log.endScenario(r,{message:"StartScreenUsed: true"}),Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.Scenario,"App.StartScreen",{info:Core.Utility.formatString(AppMagic.Strings.StartScreenUsedMessage,a.name),duration:o}),[2,!0];case 4:return Core.PerformanceTracker.exitScope(n),Core.Telemetry.Log.endScenario(r,{message:"StartScreenUsed: false"}),[2,!1];case 5:return[3,7];case 6:return i=s.sent(),Core.Telemetry.Log.failScenario(r,{error:i}),[2,!1];case 7:return[2]}}))}))},e.prototype.getStartScreenValueAsync=function(){return this.runOnDemandDataRuleAsync(S.appInfoControlName,S.startScreenRuleName)},e.prototype.handlePotentialRuleError=function(e,t,r){var n=this;return Promise.resolve(e).then((function(e){return n.handlePotentialRuleErrorSync(e,t,r)}))},e.prototype.handlePotentialRuleErrorSync=function(e,t,r){if(Object(n.isErrorHandlingFeatureEnabled)()&&Object(n.AppMagicDataDataValue_isErrorValue)(e)){var a=OpenAjax.widget.controlManager.getControl(S.appInfoControlName);if(a&&a.OpenAjax){var o=this._rules["".concat(a.OpenAjax.uniqueId,".").concat(S.onErrorRuleName)];o?this._handleSingleError(e,o,t,r):this._reportError(e,t,r)}}},e.prototype._handleSingleError=function(e,t,r,a){var o=this,i=t(this._globalBindingContext,Object(n.extractErrorScope)(e,r,a));Promise.resolve(i).then((function(e){o._reportError(e,r,a)}))},e.prototype._reportError=function(e,t,r){var a;if(Object(n.AppMagicDataErrorValue_isGatedError)(e)&&Core.Utility.isObject(a=T.ErrorValue.tryGetReportableRuntimeError(e))&&a.errorMessage&&!a.wasReported){var o={errors:Object(n.extractErrorScope)(e,t,r).AllErrors,info:a.errorMessage,context:{entityName:t,propertyName:r}};Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.Runtime,AppMagic.Strings.UnhandledRuntimeError,o,D.Error),AppMagic.Utility.getAppPreviewFlag("appinsightserrortracing")&&this.currentApp.userLogger.trackTrace(AppMagic.Strings.UnhandledRuntimeError,O.Error,o);var i=a.errorContext;i?i.entityName===t&&i.propertyName===r||(i={entityName:t,propertyName:r,diagnosticContext:i.diagnosticContext,id:Object(v.getLanguageRuntime)().generateId(),nodeId:null}):i={entityName:t,propertyName:r,id:Object(v.getLanguageRuntime)().generateId(),nodeId:null};var s=this.getRaiseToastNotification(a.errorContext,a.raiseToastNotification),c=!A.FallbackSwitch.isActivated("AppConnectivity.ShowLearnMoreLinkInErrorToast")?this._getClickHandler(a):null;this.displayRuntimeError(i,a.errorMessage,s,c)}},e.prototype.resetRuntimeError=function(e){void 0===e&&(e=null)},e.prototype.onAliasesChanged=function(e,t){for(var r=0,n=t.length;r<n;r++)this.onDataSourceChanged("".concat(e,".").concat(t[r]))},e.prototype._populateUrlMap=function(){this._urlMapping.InvokerConnectionOverrideFailed="https://go.microsoft.com/fwlink/?linkid=2259748",this._urlMapping.WorkflowTriggerIsNotEnabled="https://go.microsoft.com/fwlink/?linkid=2259748",this._urlMapping.MissingConnectionReference="https://go.microsoft.com/fwlink/?linkid=2259748",this._urlMapping["0x80040265"]="https://go.microsoft.com/fwlink/?linkid=2259748",this._urlMapping.NotAllowedConnectionReference="https://go.microsoft.com/fwlink/?linkid=2259748",this._urlMapping["0x80072560"]="https://go.microsoft.com/fwlink/?linkid=2259748",this._urlMapping.ConnectionAuthorizationFailed="https://go.microsoft.com/fwlink/?linkid=2259748"},e.prototype._getClickHandler=function(e){var t,r=void 0,n=null==e?void 0:e.error,a=Object(A.tryParseJson)(null!==(t=null==n?void 0:n.message)&&void 0!==t?t:"");if(a){var o=this._urlMapping[null==a?void 0:a.code];o&&(r=function(){window.open(o)})}return r},e.prototype._onAppDataChanged=function(e){this.onDataSourceChanged(e.sourceFullName)},e.prototype.onDataSourceChanged=function(e,t){this._onEntityDataChanged(e,null!=t?t:this._globalBindingContext),Object(v.getLanguageRuntime)().onDataSourceChanged(e)},e.prototype._onEntityDataChanged=function(e,t){var r=this._rules[e];Core.Utility.isFunction(r)&&r(t)},e.prototype.onAppDataSourceChanged=function(e){this.onDataSourceChanged(e.name)},e.prototype._onConnectedDataSourceDataChanged=function(e){this.currentApp.dataManager.cacheDataChangeManager.runRuleFn(e.queryKey,this._runRuleFn.bind(this))},e.prototype._runRuleFn=function(e,t){t=null!=t?t:this._globalBindingContext,this._runPropertyRule(e,t)},e.prototype._waitForControlCreationAndRunPropertyRule=function(e,t){var r=this,n=t.id;if(this._controlCreationPromises[e]){if(this._controlCreationPromises[e][n])return}else this._controlCreationPromises[e]=HashTableUtility.create();var a=AppMagic.Utility.getUniqueIdFromQualifiedPropertyName(e);this._controlCreationPromises[e][n]=OpenAjax.widget.controlManager.waitForControlCreationAsync(a).then((function(){delete r._controlCreationPromises[e][n],r._runPropertyRule(e,t)}))},e.prototype._isNamedFormulaOrUserDefinedFunction=function(e){return e.startsWith(S.namedFormulaGuid)||e.startsWith(S.userDefinedFunctionGuid)},e.prototype._runPropertyRule=function(e,t){var r=OpenAjax.widget.controlManager;this._isNamedFormulaOrUserDefinedFunction(e)||AppMagic.Utility.isPropertyRuleReadyToRun(e,r.checkIfControlIsAddedToControlManager)?(this._runPropertyRuleInternal(e,t),t&&t.runRuleFn&&t.runRuleFn(e,this._runPropertyRuleInternal)):this._waitForControlCreationAndRunPropertyRule(e,t)},e.prototype._runPropertyRuleInternal=function(e,t){var r=this._propertyRules[e];if((!e.startsWith(S.namedFormulaGuid)||void 0!==this._namedFormulaCache[e])&&(e.startsWith(S.userDefinedFunctionGuid)&&Core.Utility.isFunction(this._rules[e])&&(r=this._rules[e]),r)){var n=this._processedCrossScreenDependentRules[e];n&&!1===n[t.id]&&(n[t.id]=!0),r(t)}},e.prototype.setOnDataLoadEventControlPromise=function(e){this._appDataSourceOnLoadEventManager.setControlPromise(e)},e.prototype.onAppDataSourceLoad=function(e){this._appDataSourceOnLoadEventManager.onDataLoaded(e.name)},e.prototype.lastRuleExecutionTime=function(){return this._pendingPromisesCount>0?Date.now():this._lastRuleExecutionTime},e.prototype.onEvent=function(e,t,r,a,o,i){void 0===o&&(o=null);var s="".concat(e,".").concat(t),c=this._rules[s];if(Object(n.isErrorHandlingFeatureEnabled)()){var u=this.tryGetControlNameById(e);u&&this.resetRuntimeError(this.createErrorContext(u,t))}if(r=r||Core.Utility.noOpFn,a=a||Core.Utility.noOpFn,!Core.Utility.isFunction(c))return r(),void a();if(this._behaviorPromiseQueues[s]){var l=o?o.id:this._defaultBindingContextId,d=this._behaviorPromiseQueues[s],p=d[l],f=Core.Utility.isUndefined(p);f&&(p=new Core.PromiseUtils.PromiseQueue("RuntimeBase.onEvent"),d[l]=p,r());var y=function(e,t){return e===this._documentId&&t(),this._lastRuleExecutionTime=Date.now(),this._pendingPromisesCount--,null}.bind(this,this._documentId,a);p.pushJob(function(n){return Promise.resolve().then(function(r,a){if(this._pendingPromisesCount++,r!==this._documentId)return null;a();var i=n(o);return this.handlePotentialRuleError(i,this.tryGetControlNameById(e),t),i}.bind(this,this._documentId,f?Core.Utility.noOpFn:r)).then(y,y)}.bind(this,c))}else{r();try{this.handlePotentialRuleErrorSync(c(o,i),this.tryGetControlNameById(e),t)}finally{this._lastRuleExecutionTime=Date.now(),a()}}},e.prototype.createErrorContextByUniqueId=function(e,t,r,n){return null},e.prototype.createErrorContext=function(e,t,r,n){return null},e.prototype.setScopedBehavior=function(e,t,r,n){null!==r?r(n):Object(s.unRegisterFunction)(e,t)},e.prototype.setBehavior=function(e,t,r){if(null===t)return delete this._rules[e],void this._cleanUpBehaviorPromisesForDependency(e);r?this._behaviorPromiseQueues[e]||(this._behaviorPromiseQueues[e]=HashTableUtility.create()):this._behaviorPromiseQueues[e]&&this._cleanUpBehaviorPromisesForDependency(e),this._rules[e]=t},e.prototype._cleanUpBehaviorPromisesForDependency=function(e){this._behaviorPromiseQueues[e]&&(HashTableUtility.forEach(this._behaviorPromiseQueues[e],(function(e){e.cancelAll()})),delete this._behaviorPromiseQueues[e])},e.prototype.waitOnBehaviorPromiseAsync=function(e,t){if(!this._behaviorPromiseQueues[e])return Promise.resolve();var r=this._behaviorPromiseQueues[e][t];return r?r.waitCurrentJobAsync():Promise.resolve()},e.prototype.tryCreateGatedReportRuntimeError=function(e){var t=this.getRaiseToastNotification(e.errorContext,e.raiseToastNotification);this._logRuntimeErrorTelemetry(e.errorContext,e.errorMessage,t,"IDataRuntime.tryCreateGatedReportRuntimeError",e.functionName,e.error);var r=AppMagic.getLanguageRuntime();return Object(n.isErrorHandlingFeatureEnabled)()?r.createReportableError(e.errorContext,e.errorMessage,t,!1,null,e.functionName):(r.raiseRuntimeErrorToast(e.errorMessage,t),null)},e.prototype.serviceReportRuntimeError=function(e,t,r,a){return this._logRuntimeErrorTelemetry(e,t,!0,"IDataRuntime.tryCreateGatedReportRuntimeError",r,a),Object(n.isErrorHandlingFeatureEnabled)()?Object(v.getLanguageRuntime)().createReportableError(e,t,!1,!1,a,r):(this.reportRuntimeError(e,t,a),null)},e.prototype.displayRuntimeError=function(e,t,r,a){void 0===a&&(a=null);var o=Object(v.getLanguageRuntime)();Object(n.isErrorHandlingFeatureEnabled)()?o.raiseRuntimeErrorToastErrorHandlingEnabled(e,t,a):(r=this.getRaiseToastNotification(e,r),o.raiseRuntimeErrorToast(t,r,a))},e.prototype._logRuntimeErrorTelemetry=function(e,t,r,n,a,o){r=this.getRaiseToastNotification(e,r);var i={errorMessage:Core.Telemetry.Utility.scrubSensitiveDataSafe(t),raiseToastNotification:r,functionName:a};o&&(i.error=Core.PromiseUtils.formatError(o,!0,!0)),e&&(i.errorContext=e),Core.Telemetry.Log.trackActivityEvent(n,i)},e.prototype.reportRuntimeError=function(e,t,r,a){void 0===e&&(e=null),a=this.getRaiseToastNotification(e,a),this._logRuntimeErrorTelemetry(e,t,a,"IDataRuntime.reportRuntimeError",null,r);var o=Object(v.getLanguageRuntime)();Object(n.isErrorHandlingFeatureEnabled)()?o.raiseRuntimeErrorToastErrorHandlingEnabled(e,t):o.raiseRuntimeErrorToast(t,a)},e.prototype.getCollectionDataSource=function(e){var t=this.currentApp.dataSources.tryGetDataSource(e);if(t&&l.CollectionDataSource.isCollectionDataSource(t))return t.data},e.prototype.getConnectedDataSourceAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n;return __generator(this,(function(a){switch(a.label){case 0:return null===(r=this.currentApp.dataSources.tryGetDataSource(e))?[3,4]:r.isPagable?[2,new g.QueryableDataSource(r,t)]:[3,1];case 1:return a.trys.push([1,,3,4]),this._pendingPromisesCount++,this._lastRuleExecutionTime=Date.now(),[4,r.waitForLoadingInitialDataAsync()];case 2:return a.sent(),[2,this.getLocalDataSource(e,v.EntityScope.GlobalScopeId)];case 3:return this._pendingPromisesCount--,this._lastRuleExecutionTime=Date.now(),[7];case 4:throw n=new c.NamedObjectNotFoundError(e),this.isAuthoring||Core.Log.errorEx("NamedObjectNotFoundError",n.message),n}}))}))},e.prototype.getLocalDataSource=function(e,t,r){var n=null!=t?t:v.EntityScope.GlobalScopeId,a=null!=r?r:this._globalBindingContext,o=Object(v.getLanguageRuntime)().getScopeCollectionValue(n,e,a);if(null!==o)return o.data;if(n===v.EntityScope.GlobalScopeId){var i=this.tryGetDataSourceData(e);if(null!==i)return i}var s=new c.NamedObjectNotFoundError(e);throw this.isAuthoring||Core.Log.errorEx("NamedObjectNotFoundError",s.message),s},e.prototype.isGlobalBindingContext=function(e){return e&&e===this._globalBindingContext},e.prototype.getComponentBindingContext=function(e,t){if(t.componentInstanceUniqueId===e)return t;var r=this.getNamedControl(e,t).OpenAjax.controlName,n=t.componentBindingContexts.getComponentContext(r);if(!n||n.componentInstanceUniqueId!==e){var a=this._globalBindingContext.componentBindingContexts;n=null==a?void 0:a.getComponentContext(r)}return n},e.prototype.getNamedControl=function(e,t){var r=this._globalBindingContext.rcManager.getControlNameById(e);return r?this.getNamedControlByDisplayName(r,t):this.getNamedControlByDisplayName(e,t)},e.prototype.getNamedControlAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r;return __generator(this,(function(n){switch(n.label){case 0:return[4,OpenAjax.widget.controlManager.waitForControlCreationAsync(e)];case 1:return n.sent(),r=this.getNamedControl(e,t),Core.Utility.isFunction(r.readyAsync)?[4,r.readyAsync()]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2,r]}}))}))},e.prototype.getDefaultableControlPropertyValue=function(e,t,r,n){try{var a=this.getNamedControl(e,r);return Object(v.getLanguageRuntime)().getPropertyValue(a,t,r)}catch(e){return n}},e.prototype.getNamedControlByDisplayName=function(e,t){var r=OpenAjax.widget.byId(e);if(null!==r){if(t&&t!==this._globalBindingContext){for(var n=t.componentInstance&&OpenAjax.widget.byId(t.componentInstance),a=t.parent;!n&&a;)n=a.componentInstance&&OpenAjax.widget.byId(a.componentInstance),a=a.parent;if(n&&n.OpenAjax.componentDefinitionName===e)return n}return r}var o=new c.NamedObjectNotFoundError(e);throw this.isAuthoring||Core.Log.errorEx("NamedObjectNotFoundError",o.message),o},e.prototype.getDataSourceNames=function(){return Object.keys(this._data).concat(this.currentApp.dataSources.getDataSourceNames())},e.prototype.tryGetDataSourceData=function(e){var t=this.currentApp.dataSources.tryGetDataSource(e);if(null!==t)return t.data;var r=this._data[e];return Core.Utility.isUndefined(r)?null:r},e.prototype.getDataSourceData=function(e){return this.tryGetDataSourceData(e)},e.prototype.addDataSourceData=function(e,t){this._data[e]=t},e.prototype.setDataSourceData=function(e,t){var r=this.tryGetDataSourceData(e);r!==t&&(null!==r&&this._disposeDatasourceData(r),this._data[e]=t)},e.prototype._renameDataSource=function(e,t){var r=this.currentApp.dataSources.tryGetDataSource(e);if(null===r){var n=this.getDataSourceData(e);delete this._data[e],Object(d.renameDataSource)(n,t),this._data[t]=n}else r.rename(t)},e.prototype._deleteDataSource=function(e){if(this.currentApp.dataSources.contains(e))return Core.Diagnostics.isEnabled()&&this.getCollectionDataSource(e)&&Object(v.getLanguageRuntime)().onVariableMetadataChanged(m.VariableType.Collection,[e],m.VariableMetadataAction.Removed),void this.currentApp.dataSources.deleteDataSource(e);var t=this.tryGetDataSourceData(e);null!==t&&(Object(d.getDataSourceKind)(t)===f.DataSourceKind.DynamicDataSource&&this.unsubscribeDynamicDataSource(e),this._disposeDatasourceData(t),delete this._data[e])},e.prototype._disposeDatasourceData=function(e){Object(C.releaseBlobs)(e),Object(n.AppMagicDataDataValue_isDataTable)(e)&&(e.length=0),Object(d.removeMetadataProperties)(e)},e.prototype.getResxDataLoader=function(e,t){var r=Object(a.getCdsMdlMetadataClient)();return r&&r.retrieveWebResourceResx?new y.MdlWebResourceDataLoader(r):(Core.Log.warningEx("addWebResourceDatasource_getResxDataLoader","mdlClient or retrieveWebResourceResx api was not available"),new T.WebResourceDataLoader(e,t))},e.prototype.addWebResourceDatasource=function(e,t,r){var n=this._getDatasetForCdsDataSource(r),a=new R.Authentication.DynamicResourceAuthenticationProvider((function(){return n.name}),this.currentApp.authenticationService),o=this.getResxDataLoader(a,this.currentApp),i=new T.WebResourceDataSource(e,t,r,this,o);return i.dataChanged.addListener(this.onAppDataSourceChanged.bind(this)),i.dataLoaded.addListener(this.onAppDataSourceLoad.bind(this)),this.currentApp.dataSources.addDataSource(i),n.ensureDataSetActions(this.currentApp.servicesManager,this.currentApp,a),i},e.prototype.getResourceString=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n;return __generator(this,(function(a){switch(a.label){case 0:if(!(r=this.currentApp.dataSources.tryGetDataSource(e)))throw n=new AppMagic.Runtime.App.NamedObjectNotFoundError(e),this.isAuthoring||Core.Log.errorEx("NamedObjectNotFoundError",n.message),n;return[4,r.getResourceString(t)];case 1:return[2,a.sent()]}}))}))},e.prototype.getQualifiedValue=function(e,t,r){return r},e.prototype.getQualifiedValueAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,r]}))}))},e.prototype.getModernTheme=function(e){var t=E.App.Theming.getBrand(e);return{Name:e,Font:E.App.Theming.getTheme(e).fontFamilyBase,Colors:{Darker70:Core.Utility.ColorUtility.getColorValue(t[10]),Darker60:Core.Utility.ColorUtility.getColorValue(t[20]),Darker50:Core.Utility.ColorUtility.getColorValue(t[30]),Darker40:Core.Utility.ColorUtility.getColorValue(t[40]),Darker30:Core.Utility.ColorUtility.getColorValue(t[50]),Darker20:Core.Utility.ColorUtility.getColorValue(t[60]),Darker10:Core.Utility.ColorUtility.getColorValue(t[70]),Primary:Core.Utility.ColorUtility.getColorValue(t[80]),Lighter10:Core.Utility.ColorUtility.getColorValue(t[90]),Lighter20:Core.Utility.ColorUtility.getColorValue(t[100]),Lighter30:Core.Utility.ColorUtility.getColorValue(t[110]),Lighter40:Core.Utility.ColorUtility.getColorValue(t[120]),Lighter50:Core.Utility.ColorUtility.getColorValue(t[130]),Lighter60:Core.Utility.ColorUtility.getColorValue(t[140]),Lighter70:Core.Utility.ColorUtility.getColorValue(t[150]),Lighter80:Core.Utility.ColorUtility.getColorValue(t[160])}}},e.prototype.tryCreateLookupColumnReference=function(e,t,r){var n=Object(d.getAppDataSource)(e);return n?n.tryCreateLookupColumnReference(t,r):(this.reportRuntimeError(r,AppMagic.Strings.LookupFunctionNotSupported),null)},e.prototype.getResourceMediaUri=function(e){var t=this.currentApp.tryGetResourceMediaUri(e);return t?t.toString():null},e.prototype.getGlobalBindingContext=function(){return this._globalBindingContext},e.prototype.addCollection=function(e,t){var r=null!=t?t:v.EntityScope.GlobalScopeId,n=Object(v.getLanguageRuntime)().getScopedEntityFullName(r,e),a=new l.CollectionDataSource(n,this,e);return a.dataChanged.addListener(this.onAppDataSourceChanged.bind(this)),this.currentApp.dataSources.addDataSource(a),Core.Diagnostics.isEnabled()&&r===v.EntityScope.GlobalScopeId&&Object(v.getLanguageRuntime)().onVariableMetadataChanged(m.VariableType.Collection,[e],m.VariableMetadataAction.Added,"Table"),AppMagic.getLanguageRuntime().setScopeCollectionValue(r,e,a,null),a},e.prototype.addComponentScopedCollectionInstance=function(e,t,r){var n=this.addCollection(e,t);AppMagic.getLanguageRuntime().setScopeCollectionValueToExistingScope(r,e,n,t)},e.prototype.removeCollection=function(e,t){var r=this,n=Object(v.getLanguageRuntime)().getScopedEntityFullName(t,e),a=Object(v.getLanguageRuntime)().getAllCollectionInstancesForGivenCollection(n);Object(v.getLanguageRuntime)().removeScopeCollectionValues(n,t),this._deleteDataSource(n),a.forEach((function(e){return r._deleteDataSource(e)}))},e.prototype.addExtensionComponentDataSource=function(e,t,r,n,a,o,i){var s=this._getDatasetForCdsDataSource(o),c=AppMagic.Data.ConnectedDataDeserialization.createDataSourceForExtensionDataComponent(e,t,r,n,a,s,i,this,this.currentApp);return this._registerDataSourceListeners(c),this.currentApp.dataSources.addCdsDataSource(c,s),c},e.prototype.addComponentDataSource=function(e,t,r,a,o){var i=Object(n.parseCdsTableDefinitionMetadata)(t),s=this._getDatasetForCdsDataSource(i.datasetName),c=s.typesManager,u={typesMgr:c,binaryResolver:Core.Loader.ObjectFactory.instance.getSingleton(E.App.AppPABinaryResolverSingletonKey),mediaRuntime:this.currentApp.mediaRuntime,entityType:n.Templates.ConnectedDataSourceEntityType.expandUrl({datasourceName:e})},l=R.ServiceConfigDeserialization.TypesManagerDeserializer.parseTypeDefinition(r,u);c.hasType(n.TypesManagerPrefix,i.name)||s.typesManager.addType(n.TypesManagerPrefix,i.name,l);var d=AppMagic.Data.ConnectedDataDeserialization.createDataSourceForDataComponent(e,i,this.currentApp,s,a,this);return this._registerDataSourceListeners(d),this.currentApp.dataSources.addCdsDataSource(d,s),d},e.prototype.addCdsDataSource=function(e,t,r,a){var o,i=this,s=Object(n.parseCdsTableDefinitionMetadata)(t),c=this._getDatasetForCdsDataSource(s.datasetName),u=new b.DynamicResourceAuthenticationProvider((function(){return c.name}),this.currentApp.authenticationService),l=c.typesManager,d=Core.Loader.ObjectFactory.instance.getSingleton(E.App.AppPABinaryResolverSingletonKey),p={typesMgr:l,binaryResolver:d,mediaRuntime:this.currentApp.mediaRuntime,entityType:n.Templates.ConnectedDataSourceEntityType.expandUrl({datasourceName:e})};if(!c.typesManager.hasType(n.TypesManagerPrefix,s.name)){var y=R.ServiceConfigDeserialization.TypesManagerDeserializer.parseTypeDefinition(r,p,{dataSourceName:e});if(!(null==a?void 0:a.refresh)){var g=c.typesManager.getDelayedType(n.TypesManagerPrefix,s.name);g&&g instanceof AppMagic.Services.TypeSystem.DelayedLoadingCdsObjectTType&&(o=g.ParentDataSourceNames)}c.typesManager.addType(n.TypesManagerPrefix,s.name,y)}var h=a?a.selects:void 0,m=AppMagic.Data.ConnectedDataDeserialization.createDataSourceFromCdsTableMetadata(e,s,c.typesManager,u,this.currentApp,d,c,this,h);return this._registerDataSourceListeners(m),this.currentApp.dataSources.addCdsDataSource(m,c),c.ensureDataSetActions(this.currentApp.servicesManager,this.currentApp,u),o&&o.forEach((function(e){var t=i.currentApp.dataSources.tryGetDataSource(e);t&&t.kind===f.DataSourceKind.CdsNativeDataSource&&t.refreshAsync()})),m},e.prototype._getDatasetForCdsDataSource=function(e){var t=this.currentApp.dataSources,r=t.tryGetCdsDataset(e);if(!r){var n=AppMagic.Data.ConnectedDataDeserialization.createCdsDataSetConnector(e);r=t.createCdsDataset(e,n)}return r},e.prototype._registerDataSourceListeners=function(e){e.dataChanged.addListener(this.onAppDataSourceChanged.bind(this)),e.dataLoaded.addListener(this.onAppDataSourceLoad.bind(this))},e.prototype.addConnectedDataSource=function(e,t,r,n){var a=Core.Loader.ObjectFactory.instance.getSingleton(E.App.IBlobManagerSingletonKey),o=Core.Loader.ObjectFactory.instance.getSingleton(E.App.AppPABinaryResolverSingletonKey),i=AppMagic.Data.ConnectedDataDeserialization.parseDataSourceDefinition(e,r,t,this.currentApp,this,a,o,n);i.dataChanged.addListener(this.onAppDataSourceChanged.bind(this)),i.dataLoaded.addListener(this.onAppDataSourceLoad.bind(this)),this.currentApp.dataSources.addDataSource(i)},e.prototype.setControlDynamicTType=function(e,t,r,n,a){return _.DynamicJsonSchemaHelper.setControlDynamicTType(this.currentApp.dataManager.dynamicJsonSchemaTTypeManager,e,t,r,n,a)},e.prototype.getControlDynamicTType=function(e,t){return _.DynamicJsonSchemaHelper.getControlDynamicTType(this.currentApp.dataManager.dynamicJsonSchemaTTypeManager,e,t)},e.prototype.resetControlDynamicTTypeAndBlockPayload=function(e,t){return _.DynamicJsonSchemaHelper.resetControlDynamicTTypeAndBlockPayload(this.currentApp.dataManager.dynamicJsonSchemaTTypeManager,e,t)},e.prototype._resetCollection=function(e){var t=this.tryGetDataSourceData(e);null!==t&&Object(n.AppMagicDataDataValue_isDataTable)(t)&&(Object(C.releaseBlobs)(t),t.length=0,Core.Utility.isDefined(t[S.idProperty])&&delete t[S.idProperty],Object(v.getLanguageRuntime)().assignTableID(t))},e.prototype._dynamicDataSourceErrorFunc=function(){},e.prototype._addDynamicDataSource=function(e){var t=Object(p.createInitialData)(e);this.addDataSourceData(e,t)},e.prototype.enableDynamicDatasource=function(e){return this.subscribeDynamicDataSource(e,!0)},e.prototype.disableDynamicDatasource=function(e){return this.unsubscribeDynamicDataSource(e)},e.prototype.unsubscribeDynamicDataSource=function(e){var t=AppMagic.DynamicDataSource.instance.getDynamicDataSource(e);return!!t.isEnabled&&(t.unSubscribe(),!0)},e.prototype.unsubscribeAllDynamicDataSources=function(){AppMagic.DynamicDataSource.instance.getAllDynamicDataSourceNames().forEach(this.unsubscribeDynamicDataSource,this)},e.prototype.subscribeDynamicDataSource=function(e,t){var r=AppMagic.DynamicDataSource.instance.getDynamicDataSource(e);return r.isEnabled||(t&&r.getData(this._dynamicDataSourceErrorFunc.bind(this)),r.subscribe()),!0},e.prototype.updateDynamicDatasource=function(e,t){var r=this.getDataSourceData(e);AppMagic.Utility.deepCompare(r,t)||(Object(p.addMetadata)(t,e),this.setDataSourceData(e,t),this.onDataSourceChanged(e))},e.prototype.screenChangeEventSubscribe=function(e){return this._activeScreenIndex.subscribe(e)},e.prototype._addStaticDataSource=function(e,t){Object(h.addMetadata)(e,t),Object(v.getLanguageRuntime)().assignTableID(e),null===this.tryGetDataSourceData(t)?this.addDataSourceData(t,e):this.setDataSourceData(t,e)},e.prototype.getDataTemplates=function(){return Object(n.clone)(this._dataTemplates,!1)},e.prototype.makeExpando=function(e){return AppMagic.Data.DataFlow.makeExpando(e,this)},e.prototype.onSuspend=function(e){Object(v.getLanguageRuntime)().onSuspend(e),e.data=this._data,e.documentId=this._documentId},e.prototype.onResumeFromTerminate=function(e){Object(v.getLanguageRuntime)().onResumeFromTerminate(e),this._data=e.data,this._documentId=e.documentId},e.prototype.coerceBlobToHyperlink=function(e){return e},e.prototype.coerceImageToHyperlink=function(e){return e},e.prototype.coerceMediaToHyperlink=function(e){return e},e.prototype.createZipAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,a,o,s,c;return __generator(this,(function(u){switch(u.label){case 0:return n=r,r?[3,2]:[4,this._getDocVersionStringAsync()];case 1:n=u.sent(),u.label=2;case 2:return a=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.AppPABinaryResolverSingletonKey),[4,Object(C.getMediaInDataForExportAsync)(e,this.currentApp.mediaRuntime,a)];case 3:return o=u.sent(),s=Object(C.cloneAndFlattenOpenAjax)(e),c={data:s,mediaInfoTable:o,docVersion:n,schema:t},[4,Core.Telemetry.Log.trackPromiseScenario(Core.Telemetry.ScenarioName.CreateZip,(function(){return i.ZipPacker.createZipAsync(c)}))];case 4:return[2,u.sent()]}}))}))},e.prototype.loadZipAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,Core.Telemetry.Log.trackPromiseScenario(Core.Telemetry.ScenarioName.LoadZip,(function(){return i.ZipPacker.loadZipAsync(e)}))];case 1:return[2,t.sent()]}}))}))},e.prototype.saveDataFolderAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r;return __generator(this,(function(n){switch(n.label){case 0:return[4,this._getDocVersionStringAsync()];case 1:return r=n.sent(),[4,o.FolderPacker.saveDataFolderAsync(e,t,r,this.currentApp.mediaRuntime)];case 2:return[2,n.sent()]}}))}))},e.prototype.loadDataFolderAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,o.FolderPacker.loadDataFolderAsync(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.clearDataFolderAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this._getDocVersionStringAsync()];case 1:return t.sent(),[4,o.FolderPacker.clearDataFolderAsync(e)];case 2:return[2,t.sent()]}}))}))},e.prototype.getImportedService=function(e){return this.currentApp.servicesManager.getImportedService(e)},e.prototype.getImportedServicesById=function(e){return this.currentApp.servicesManager.getImportedServicesById(e)},e.prototype.getImportedServicesByApiId=function(e){return this.currentApp.servicesManager.getImportedServicesByApiId(e)},e.prototype.tryGetImportedService=function(e){return this.currentApp.servicesManager.tryGetImportedService(e)},e.prototype.getServiceFunctionInvocation=function(e,t,r,n){return this.getServiceFunction(e,t).getFunctionInvocation(n,r)},e.prototype.getServiceFunction=function(e,t){return this.getImportedService(e).functions[t]},e.prototype.getRaiseToastNotification=function(e,t){return!(null==e?void 0:e.silentErrors)&&!!t},e.prototype.assignTableID=function(e){Object(v.getLanguageRuntime)().assignTableID(e)},e.prototype.assignRowID=function(e,t){void 0===e&&(e=null),Object(v.getLanguageRuntime)().assignRowID(e,t)},e.prototype.existsOngoingAsync=function(){return this._ongoingAsyncDataActions>0||this._pendingPromisesCount>0},e.prototype.startAsyncDataAction=function(){return this._ongoingAsyncDataActions+=1,Core.Environment.isDefaultRenderMode()?this._progressIndicatorViewModel.addProgressAction():-1},e.prototype.endAsyncDataAction=function(e){this._ongoingAsyncDataActions-=1,Core.Environment.isDefaultRenderMode()&&this._progressIndicatorViewModel.completeProgressAction(e)},e.prototype.getRuleForDependency_TestOnly=function(e){return this._rules[e]},e}();globalScopeObject._w0=Promise.resolve.bind(Promise),globalScopeObject._w1=Promise.resolve.bind(Promise),globalScopeObject._w2=Core.PromiseUtils.join},function(e,t,r){"use strict";r.r(t),r.d(t,"IoTCentralServiceName",(function(){return n})),r.d(t,"isIoTControl",(function(){return o})),r.d(t,"refreshDevicesThroughIoTConnector",(function(){return i})),r.d(t,"getIoTCentralAppCollection",(function(){return s})),r.d(t,"getIoTCentralServiceFunctions",(function(){return c}));var n="PowerAppsAzureIoTCentral",a=["IoTDeviceManager","msft_Microsoft.IoTDeviceManager","http://microsoft.com/appmagic/powercontrol/IoTDeviceManager","http://microsoft.com/appmagic/powercontrol/msft_Microsoft.IoTDeviceManager"];function o(e){Contracts.checkString(e,"isIoTControl.controlName");for(var t=0,r=a;t<r.length;t++){var n=r[t];if(e.startsWith(n))return!0}return!1}function i(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,a,o,i;return __generator(this,(function(s){switch(s.label){case 0:return s.trys.push([0,5,,6]),(r=HashTableUtility.create()).application=new AppMagic.Services.PrimitiveDArgument(e),[4,t.DevicesList.runAsync(r)];case 1:n=s.sent(),a=n.value,s.label=2;case 2:return n.nextLink?((o=HashTableUtility.create()).application=new AppMagic.Services.PrimitiveDArgument(e),o.nextLink=new AppMagic.Services.PrimitiveDArgument(n.nextLink),[4,t.DevicesList.runAsync(o)]):[3,4];case 3:return n=s.sent(),a=a.concat(n.value),[3,2];case 4:return[2,a];case 5:return i=s.sent(),Core.Log.errorEx("IoTCentralClient.refreshDevicesThroughIoTConnector",{error:i}),[2,null];case 6:return[2]}}))}))}function s(e){return __awaiter(this,void 0,Promise,(function(){var t,r;return __generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=HashTableUtility.create(),[4,e.ApplicationsList.runAsync(t)];case 1:return[2,n.sent().value];case 2:return r=n.sent(),Core.Log.errorEx("IoTCentralClient.refreshDevicesThroughIoTConnector",{error:r}),[2,null];case 3:return[2]}}))}))}function c(){return __awaiter(this,void 0,Promise,(function(){var e;return __generator(this,(function(t){return(e=AppMagic.AuthoringTool.Runtime.tryGetImportedService(n))?[2,e.functions]:(Core.Log.errorEx("IoTCentralClient._getAzureIoTCentralConnector","Error while retrieving connector, no datasource was created"),[2,null])}))}))}},function(e,t,r){"use strict";r.r(t),r.d(t,"UserDefinedFunction",(function(){return n}));var n=function(){function e(e){this._func=e}return e.prototype.execute=function(e,t){return this._func(e,t)},e.prototype.dispose=function(){this._func=null},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"BlobManager",(function(){return s}));var n=r(0),a=r(1),o=function(){function e(e){this._binary=e,this._count=0,this._objectUri=null}return Object.defineProperty(e.prototype,"binary",{get:function(){return this._binary},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isValidBlobEntry",{get:function(){return!!this._binary},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDisposed",{get:function(){return!this._binary},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){return this._count},enumerable:!1,configurable:!0}),e.prototype.getMediaReferenceUrlAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r;return __generator(this,(function(a){switch(a.label){case 0:return this._mediaReferenceUrl?[3,4]:(t=void 0,"appRelativeFile"!==this._binary.source.sourceType?[3,1]:(t=this._binary.source.relativeUrl,[3,3]));case 1:return[4,e.getAsBlobAsync(this._binary)];case 2:r=a.sent(),t=this._objectUri=URL.createObjectURL(r),a.label=3;case 3:this._mediaReferenceUrl=new n.Core_Url(t),a.label=4;case 4:return[2,this._mediaReferenceUrl]}}))}))},e.prototype.getMediaAsArrayBufferAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,e.getAsArrayBufferAsync(this._binary)];case 1:return[2,t.sent()]}}))}))},e.prototype.addRef=function(){return++this._count},e.prototype.getContentType=function(){return this._binary.contentType},e.prototype.release=function(){return--this._count<=0&&this.dispose(),this._count},e.prototype.dispose=function(){this.isDisposed||(this._objectUri&&URL.revokeObjectURL(this._objectUri.toString()),function(e){if("blob"===e.source.sourceType&&e.source.blob.msClose)return void e.source.blob.msClose();"appRelativeFile"===e.source.sourceType&&e.source.relativeUrl&&Object(n.tryDeleteAppRelativeFileAsync)(e.source.relativeUrl)}(this._binary),this._binary=null,this._count=0,this._objectUri=null)},e}();var i=a.Scheme+"://"+a.Hosts.BlobManager+"/",s=function(){function e(e){this._binaryResolver=e,this._batchId=Object(n.generateNonDashedUUID)(),this._entriesCreatedCount=0,this._entriesByUri=Object(n.HashTableUtility_create)(),this._lastStatsEntriesCreatedCount=-1,this._lastStatsNow=0}return Object.defineProperty(e.prototype,"count",{get:function(){return Object.keys(this._entriesByUri).length},enumerable:!1,configurable:!0}),e.isBlobManagerItemUri=function(e){return"string"==typeof e?e.length>=i.length&&e.substr(0,i.length)===i:e.scheme===a.Scheme&&e.host===a.Hosts.BlobManager},e.prototype.create=function(e,t){var r;Object(n.checkNonEmpty)(e),Object(n.checkObject)(t);try{r=MSApp.createBlobFromRandomAccessStream(e,t)}catch(e){return null}return this.addBlob(r)},e.prototype.addBlob=function(e){return Object(n.checkObject)(e),Object(n.Contracts_check)(e instanceof Blob),e.type||n.CoreLog.errorEx("BlobManager.addBlob",{error:Object(n.throwInline)(new Error("Missing content type."))}),this.addBinary(n.PABinary.createFromBlob(e))},e.prototype.addBinary=function(e){var t=(++this._entriesCreatedCount).toString(),r=a.Templates.BlobManagerItem.expandUrlString({batchId:this._batchId,entryId:t});return this._entriesByUri[r]=new o(e),this._tickPerfLogStats("addBinary"),r},e.prototype.addBinaryWithRef=function(e,t){var r=t;return this._entriesByUri[r]||(this._entriesByUri[r]=new o(e)),this._tickPerfLogStats("addBinaryWithRef"),r},e.prototype.getBinary=function(e){return this._entriesByUri[e].binary},e.prototype.getMediaReferenceUrlAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this._entriesByUri[e].getMediaReferenceUrlAsync(this._binaryResolver)];case 1:return[2,t.sent()]}}))}))},e.prototype.contains=function(e){return Object(n.checkString)(e),!!this._getEntry(e)},e.prototype.getMediaAsArrayBufferAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this._entriesByUri[e].getMediaAsArrayBufferAsync(this._binaryResolver)];case 1:return[2,t.sent()]}}))}))},e.prototype._getEntry=function(e){Object(n.checkString)(e);var t=this._entriesByUri[e];return t&&t.isValidBlobEntry?t:null},e.prototype.addRef=function(e){Object(n.checkString)(e);var t=this._getEntry(e);return!!t&&(t.addRef(),!0)},e.prototype.getRefCount=function(e){Object(n.checkString)(e);var t=this._getEntry(e);return t?t.count:-1},e.prototype.getContentType=function(e){Object(n.checkString)(e);var t=this._getEntry(e);return t?t.getContentType():""},e.prototype.release=function(e){Object(n.checkString)(e);var t=this._getEntry(e),r=!1;return t&&t.release()<=0&&(delete this._entriesByUri[e],r=!0),r},e.prototype.releaseAll=function(){this._logPerfStats("releaseAll"),Object(n.HashTableUtility_forEach)(this._entriesByUri,(function(e){e.dispose()})),this._batchId=Object(n.generateNonDashedUUID)(),this._entriesCreatedCount=0,this._entriesByUri=Object(n.HashTableUtility_create)(),this._lastStatsEntriesCreatedCount=-1,this._lastStatsNow=0},e.prototype._tickPerfLogStats=function(e){this._entriesCreatedCount-this._lastStatsEntriesCreatedCount<50&&Date.now()-this._lastStatsNow<6e4||this._logPerfStats(e)},e.prototype._logPerfStats=function(e){this._lastStatsEntriesCreatedCount=this._entriesCreatedCount,this._lastStatsNow=Date.now(),n.Log.trackActivityEvent("BlobManager."+e,{batchId:this._batchId,itemsCreatedCount:this._entriesCreatedCount,itemsCount:Object.keys(this._entriesByUri).length})},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"AppDataset",(function(){return n}));r(0);var n=function(e){function t(t){return e.call(this,t,!0)||this}return __extends(t,e),t.prototype.getDataSourceNames=function(){return this._internalComponents.getNames()},t.prototype.getDataSources=function(){return this._internalComponents.getValues()},t.prototype.contains=function(e){return this._internalComponents.containsName(e)},t.prototype.tryGetDataSource=function(e){return this._internalComponents.tryGetByName(e)},t.prototype.addDataSource=function(e){this._addComponent(e)},t.prototype.isEmpty=function(){return this._internalComponents.isEmpty()},t.prototype.deleteDataSource=function(e){var t=this._removeComponentByName(e);t.isLoaded&&t.unload(),t.dispose()},t}(AppMagic.Runtime.App.AppComponent)},function(e,t,r){"use strict";r.r(t),r.d(t,"CdsDataset",(function(){return l}));var n=r(0),a=r(83),o=r(39),i=r(93),s=r(113),c=r(94),u=AppMagic.Data,l=function(e){function t(t,r,a){var o=e.call(this,t)||this;return o._typesManager=r,o._cdsDataSetConnector=a,o.cdsRuntimeUrlFetcher=function(e){return function(){return __awaiter(o,void 0,void 0,(function(){var t,r;return __generator(this,(function(n){switch(n.label){case 0:return t=Object.keys(this._logicalNameToDataSource),r=this._logicalNameToDataSource[t[0]].name,[4,e.appHostClient.getCdsDataSourceConfigAsync(r)];case 1:return[2,n.sent().config.runtimeUrl]}}))}))}},o._logicalNameToDataSource=Object(n.HashTableUtility_create)(),o}return __extends(t,e),Object.defineProperty(t.prototype,"typesManager",{get:function(){return this._typesManager},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cdsDataSetConnector",{get:function(){return this._cdsDataSetConnector},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"datasetActions",{get:function(){return this._datasetActions},enumerable:!1,configurable:!0}),t.prototype.ensureDataSetActions=function(e,t,r){if(!this._datasetActions){var a=this.cdsRuntimeUrlFetcher(t),o=n.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.AppPABinaryResolverSingletonKey),s=Object(i.getRetrieveOrganizationInfoFunctionDefinition)(this.name),c=new AppMagic.Services.TabularDataService(this.name,"cc7d3565-6cda-4259-83d8-3d507f91343e",a,this.typesManager,r,[s],t.appHttpClient,t.restXhrClient,n.DefaultInstance,AppMagic.Services.MultipartBoundaryGenerator.DefaultInstance,e,t.mediaRuntime,o,t.authenticationService,t.appHostClient);this._datasetActions=c}},t.prototype.addDataSource=function(t){e.prototype.addDataSource.call(this,t),this._logicalNameToDataSource[t.logicalName]=t},t.prototype._validateTypeManagerStatus=function(e){return e instanceof s.DataComponentDataSource||(e instanceof c.WebResourceDataSource||this._typesManager.hasType(u.ConnectedDataConstants.TypesManagerPrefix,e.logicalName))},t.prototype.deleteDataSource=function(t){var r=e.prototype.tryGetDataSource.call(this,t);r&&(this._typesManager.removeType(u.ConnectedDataConstants.TypesManagerPrefix,r.logicalName),delete this._logicalNameToDataSource[r.logicalName],e.prototype.deleteDataSource.call(this,t))},t.prototype.tryGetCdsDataSourceByLogicalName=function(e){var t=this._logicalNameToDataSource[e];if(t&&t instanceof o.CdsDataSource)return t},t.prototype.dispose=function(){var t;this._logicalNameToDataSource=null,null===(t=this._datasetActions)||void 0===t||t.dispose(),this._datasetActions=null,e.prototype.dispose.call(this)},t}(a.AppDataset)},function(e,t,r){"use strict";r.r(t),r.d(t,"QueriedTable",(function(){return y}));var n=r(0),a=(r(62),r(58)),o=r(66),i=r(11),s=r(23),c=r(111),u=r(41),l=r(112),d=r(24),p=AppMagic.Data.ErrorValue,f=AppMagic.Data,y=function(e){function t(t,r,a,o,i,s){var c=this;return(c=e.call(this,t,r,a,i)||this)._queryDataProvider=o,c._rowProcessor=s,c._promiseQueue=new n.PromiseQueue("QueriedTable"),c.cacheableQuery=i[0],c}return __extends(t,e),t.prototype.cloneAsync=function(){var e=[this.cacheableQuery];return Promise.resolve(new t(this._connector,this.dataSource,this._dataRuntime,this._queryDataProvider,e,this._rowProcessor))},t.prototype.getNextResultsAsync=function(e,t,r,n){return this._promiseQueue.pushJob(this._getNextResultsAndHandleErrorAsync.bind(this,t,e,r,n))},t.prototype._getNextResultsAndHandleErrorAsync=function(e,t,r,n){return __awaiter(this,void 0,Promise,(function(){var a;return __generator(this,(function(i){switch(i.label){case 0:i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this._getNextResultsAsync(e,t,r,n)];case 2:return[2,i.sent()];case 3:if((a=i.sent())instanceof o.ConnectedDataQueryStringBuilderError)return[2,a.errValue];throw a;case 4:return[2]}}))}))},t.prototype._getNextResultsAsync=function(e,t,r,a){var o;return __awaiter(this,void 0,Promise,(function(){var r,i;return __generator(this,(function(s){switch(s.label){case 0:return r=!1,null===e&&(e=this._dataSource.maxGetRowsCount(),r=!0),(null===(o=this._dataSource)||void 0===o?void 0:o.isDelegable)||!Object(n.isUndefined)(this.cacheableQuery.queryDefinition.queryOptions)?[3,3]:(i=void 0,[4,this._getDataTableAndRefreshIfEmptyAsync(t)]);case 1:return i=s.sent(),[4,this._getNextPageUsingLocalDataAsync(i,e,t)];case 2:return[2,s.sent()];case 3:return[4,this._getNextResultFromCacheOrServerAsync(e,!0,t,a,r)];case 4:return[2,s.sent()]}}))}))},t.prototype._getNextResultFromServerPagerAsync=function(e,t,r,a){var o=this;void 0===a&&(a=null);var s=this._dataRuntime.startAsyncDataAction();this._ensureServerPagerCreated(a);var c=this._serverPager.getNextResultFromServerAsync(e,this._currentSkip,r).then((function(e){o._currentSkip+=e.results.length;var r=e.results;return Object(i.setAppDataSource)(r,o._dataSource),t&&o._dataRuntime.assignTableID(r),r}),(function(e){if(Object(n.isCanceledError)(e))throw e;return f.ErrorValue.isErrorHandlingFeatureEnabled()||Object(d.reportConnectedDataReadOperationErrors)(e,r,o._dataRuntime),n.CoreLog.errorEx("QueriedTable._getNextResultFromServerPagerAsync",{error:e}),Promise.resolve(o._createNetworkErrorFromServerError(r,e))}));return Object(n.wrapWithFinally)(c,(function(){return o._dataRuntime.endAsyncDataAction(s)}))},t.prototype._createNetworkErrorFromServerError=function(e,t){var r,n=AppMagic.Services.SendHttpResponse.isValid(null===(r=null==t?void 0:t.serverError)||void 0===r?void 0:r.response)?t.serverError.response:void 0,a=Object(d.getNetworkErrorMessageFromResponse)(n),o=AppMagic.AuthoringTool.Runtime.tryCreateGatedReportRuntimeError({errorContext:e,errorMessage:a,error:t,raiseToastNotification:!1,skipDisplayRuntimeError:!0,functionName:null});return f.ErrorValue.createGatedError(f.ErrorKind.Network,f.ErrorSeverity.Severe,a,o,n)},t.prototype._getNextResultFromCacheOrServerAsync=function(e,t,r,a,o){var s=this;if(n.FallbackSwitch.isActivated("AppConnectivity.splitCallsIfExpandsMoreThanLimit")){var c=this._dataRuntime.startAsyncDataAction(),u=this._queryDataProvider.getDataAsync(this._connector.value,this.dataSourceName,this.cacheableQueryList[0],r,e,this._currentSkip,a,o).then((function(e){s._currentSkip+=e.results.length;var r=e.results;return s._rowProcessor&&r.forEach((function(e){return s._rowProcessor(e)})),Object(i.setAppDataSource)(r,s._dataSource),t&&s._dataRuntime.assignTableID(r),null==e.serverRowCount||isNaN(e.serverRowCount)||(r.serverRowCount=e.serverRowCount),null!=e.serverRowLimitExceeded&&"boolean"==typeof e.serverRowLimitExceeded&&(r.serverRowLimitExceeded=e.serverRowLimitExceeded),r}),(function(e){return Object(n.throwIfCanceled)(e),f.ErrorValue.isErrorHandlingFeatureEnabled()||Object(d.reportConnectedDataReadOperationErrors)(e,r,s._dataRuntime),n.CoreLog.errorEx("QueriedTable._getNextResultFromServerAsync",{error:e}),s._createNetworkErrorFromServerError(r,e)}));return Object(n.wrapWithFinally)(u,(function(){return s._dataRuntime.endAsyncDataAction(c)}))}return this._getNextResultFromCacheOrServerWithExpandsSplitAsync(e,t,r,a,o,!0)},t.prototype._getNextResultFromCacheOrServerWithExpandsSplitAsync=function(e,t,r,o,s,c){var l;return __awaiter(this,void 0,Promise,(function(){var p,y,g,h,m,v,b,_,C,A,S,D=this;return __generator(this,(function(O){switch(O.label){case 0:p=this._dataRuntime.startAsyncDataAction(),g=[],this.cacheableQueryList.forEach((function(t){g.push(D._queryDataProvider.getDataAsync(D._connector.value,D.dataSourceName,t,r,e,D._currentSkip,o,s))})),O.label=1;case 1:return O.trys.push([1,3,9,10]),[4,Object(n.join)(g)];case 2:return h=O.sent(),m=h[0],h.forEach((function(e){Object(u.mergeRecords)(e,m)})),v=m.results,this._currentSkip+=v.length,this._rowProcessor&&v.forEach((function(e){return D._rowProcessor(e)})),Object(i.setAppDataSource)(v,this._dataSource),t&&this._dataRuntime.assignTableID(v),y=v,null==m.serverRowCount||isNaN(m.serverRowCount)||(y.serverRowCount=m.serverRowCount),null!=m.serverRowLimitExceeded&&"boolean"==typeof m.serverRowLimitExceeded&&(y.serverRowLimitExceeded=m.serverRowLimitExceeded),[3,10];case 3:return b=O.sent(),_=b[0],C=Object(a.tryGetCDSErrorFromError)(_),[4,this.getQueryKeyAsync()];case 4:return A=O.sent(),(null===(l=null==C?void 0:C.error)||void 0===l?void 0:l.code)==u.expandsLimitErrorCode&&c?(this._queryDataProvider.setSplitExpandsForQuery(A),S=this,[4,this.dataSource.trySplitExpandsQueryOptionsAsync(this.cacheableQuery)]):[3,7];case 5:return S.cacheableQueryList=O.sent(),[4,this._getNextResultFromCacheOrServerWithExpandsSplitAsync(e,t,r,o,s,!1)];case 6:return y=O.sent(),[3,8];case 7:Object(n.throwIfCanceled)(_),f.ErrorValue.isErrorHandlingFeatureEnabled()||Object(d.reportConnectedDataReadOperationErrors)(_,r,this._dataRuntime),n.CoreLog.errorEx("QueriedTable._getNextResultFromCacheOrServerWithExpandsSplitAsync",{error:_}),y=this._createNetworkErrorFromServerError(r,_),O.label=8;case 8:return[3,10];case 9:return this._dataRuntime.endAsyncDataAction(p),[2,y];case 10:return[2]}}))}))},t.prototype._ensureServerPagerCreated=function(e){this._serverPager||(this._serverPager=new l.ServerPager(this._connector,e,this.cacheableQuery))},t.prototype._getDataTableFromDataSource=function(){var e=Object(s.safeCast)(this._dataSource.data);return e||[]},t.prototype._getDataTableAndRefreshIfEmptyAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return this._dataSource.isDataLoaded?[2,this._getDataTableFromDataSource()]:[4,this._dataSource.refreshAsync(e,!0)];case 1:return t.sent(),[2,this._getDataTableFromDataSource()]}}))}))},t.prototype._getDataFromCache=function(e,t){var r=this._currentSkip+t,n=[];return r<=e.length?(n=e.slice(this._currentSkip,r),this._currentSkip=r):(n=e.slice(this._currentSkip),this._currentSkip=e.length),Object(i.setAppDataSource)(n,this._dataSource),n[AppMagic.Constants.Runtime.idProperty]=e[AppMagic.Constants.Runtime.idProperty],n},t.prototype._getNextPageUsingLocalDataAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n,a,o,c,u=this;return __generator(this,(function(l){switch(l.label){case 0:return n=e.length,this._dataSource.isDataLoaded&&n>0&&n<this._dataSource.maxGetRowsCount()?[2,this._getDataFromCache(e,t)]:(o=this._currentSkip+t)<=n?((a=e.slice(this._currentSkip,o))[AppMagic.Constants.Runtime.idProperty]=e[AppMagic.Constants.Runtime.idProperty],this._currentSkip=o,Object(i.setAppDataSource)(a,this._dataSource),[2,a]):(a=e.slice(this._currentSkip),n>0?a[AppMagic.Constants.Runtime.idProperty]=e[AppMagic.Constants.Runtime.idProperty]:this._dataRuntime.assignTableID(a),this._currentSkip+=a.length,[4,this._getNextResultFromServerPagerAsync(o-this._currentSkip,!1,r,Object(s.tryGetLastGetRowsResponse)(e))]);case 1:return null===(c=l.sent())?[2,a]:p.isGatedError(c)?[2,c]:(c.forEach((function(e){return u._dataRuntime.assignRowID(e)})),a=a.concat(c),Object(i.setAppDataSource)(a,this._dataSource),[2,a])}}))}))},t}(c.QueriedTableCore)},function(e,t,r){"use strict";r.r(t),r.d(t,"safeCast",(function(){return o})),r.d(t,"isValid",(function(){return i}));var n=r(0),a=r(92);function o(e){return i(e)?e:null}function i(e){return e&&Object(n.isNonEmptyString)(e.code)&&Object(n.isNonEmptyString)(e.message)&&(!e.innererror||Object(a.isValid)(e.innererror))}},function(e,t,r){"use strict";r.r(t),r.d(t,"addMetadata",(function(){return a})),r.d(t,"createInitialData",(function(){return o}));r(0);var n=r(11);r(4);function a(e,t){Object(n.setDynamicDataSourceName)(e,t)}function o(e){var t={};return a(t,e),t}},function(e,t,r){"use strict";r.r(t),r.d(t,"FolderPacker",(function(){return i}));var n=r(17),a=r(7),o=r(5),i=function(){function e(){}return Object.defineProperty(e,"promiseQueue",{get:function(){return e._promiseQueue||(e._promiseQueue=new Core.PromiseUtils.PromiseQueue("SaveLoadClearData")),e._promiseQueue},enumerable:!1,configurable:!0}),e.clearDataFolderAsync=function(t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){return[2,e.promiseQueue.pushJob((function(){return e._clearDataFolderAsync(t)}))]}))}))},e._clearDataFolderAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,a,o,i;return __generator(this,(function(s){switch(s.label){case 0:t=Core.Telemetry.Log.startScenario(Core.Telemetry.ScenarioName.ClearData),s.label=1;case 1:return s.trys.push([1,9,,10]),[4,Core.IO.FileSystem.getUserDataFolderAsync(!0)];case 2:return(r=s.sent())?e?(Core.Telemetry.Log.trackActivityEvent("FolderPacker.clearDataFolderAsync",{message:"Clear single folder",folderName:e}),[4,n.FileDataProcessor.deleteFolderAsync(r,e)]):[3,4]:[3,8];case 3:return s.sent(),[3,8];case 4:return Core.Telemetry.Log.trackActivityEvent("FolderPacker.clearDataFolderAsync",{message:"Clear all data"}),o=(a=n.FileDataProcessor).deleteFolderAsync,[4,r.getParentAsync()];case 5:return[4,o.apply(a,[s.sent(),Core.IO.Constants.UserSavedDataFolder])];case 6:return s.sent(),[4,Core.IO.FileSystem.getUserDataFolderAsync(!0)];case 7:r=s.sent(),s.label=8;case 8:return Core.Telemetry.Log.endScenario(t),[3,10];case 9:throw i=s.sent(),Core.Telemetry.Log.endAndThrowIfCanceled(i,t),Core.Log.error("FolderPacker.clearDataFolderAsync",i),Core.Telemetry.Log.failScenario(t,{error:i,customScenarioData:{folderName:null!=e?e:""}}),i;case 10:return[2]}}))}))},e.saveDataFolderAsync=function(t,r,n,a){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(o){return[2,e.promiseQueue.pushJob((function(){return e._saveDataFolderAsync(t,r,n,a)}))]}))}))},e._saveDataFolderAsync=function(e,t,r,i){return __awaiter(this,void 0,Promise,(function(){var s,c,u,l,d,p,f,y,g,h,m,v,b,_,C,A,S,D,O,E,T,R,w;return __generator(this,(function(M){switch(M.label){case 0:s=Core.Telemetry.Log.startScenario(Core.Telemetry.ScenarioName.SaveData),Core.Telemetry.Log.trackActivityEvent("FolderPacker.saveDataFolderAsync",{message:"Beginning SaveData operation",folderName:t}),l=!1,d=Date.now(),p=-1,f=-1,y=-1,g=-1,h=-1,m=-1,v=-1,M.label=1;case 1:return M.trys.push([1,7,,8]),[4,n.FileDataProcessor.loadFolderAsync(t)];case 2:return c=M.sent(),[4,n.FileDataProcessor.doesErrorFileExist(c)];case 3:return M.sent()?(Core.Telemetry.Log.trackActivityEvent("FolderPacker.saveDataFolderAsync",{message:"Error file exists. Overriding existing folder.",folderName:t}),c=null,[3,6]):[3,4];case 4:return[4,n.FileDataProcessor.loadDataFileAsync(c,a.headerFileName)];case 5:u=M.sent(),l=u&&u.documentFilesCount>0,M.label=6;case 6:return[3,8];case 7:return M.sent(),c=null,[3,8];case 8:return M.trys.push([8,24,,27]),c?[3,10]:[4,n.FileDataProcessor.createFolderAsync(t)];case 9:c=M.sent(),M.label=10;case 10:return p=Date.now(),[4,n.FileDataProcessor.SaveMediaAssetsAsync(e,c,i,l&&u.assetFilesCount>0)];case 11:if(b=M.sent(),f=Date.now(),_=n.FileDataProcessor.getChunkRecords(e),y=Date.now(),C=0,A=0,!(_>0))return[3,14];M.label=12;case 12:return C<e.length?(S=C+_,D=e.slice(C,S),C=S>=e.length?e.length:S,O=D,Object(o.hasOpenAjax)(D)&&(E=Object(o.cloneAndFlattenOpenAjax)(D),O=E),R=t+"_"+ ++A+".json",[4,n.FileDataProcessor.saveChunkDataFileAsync(O,c,l?"new_"+R:R)]):[3,14];case 13:return M.sent(),[3,12];case 14:return g=Date.now(),[4,n.FileDataProcessor.saveDataFileAsync({docVersion:r,documentFilesCount:A,assetFilesCount:b.assetFileList.length},c,l?"new_"+a.headerFileName:a.headerFileName)];case 15:if(M.sent(),h=Date.now(),!l)return[3,22];T=1,M.label=16;case 16:return T<=A?(R=t+"_"+T+++".json",[4,n.FileDataProcessor.renameDataFileAsync(c,"new_"+R,R)]):[3,18];case 17:return M.sent(),[3,16];case 18:return T<=u.documentFilesCount?(R=t+"_"+T+++".json",[4,n.FileDataProcessor.deleteFileAsync(c,R)]):[3,20];case 19:return M.sent(),[3,18];case 20:return[4,n.FileDataProcessor.renameDataFileAsync(c,"new_"+a.headerFileName,a.headerFileName)];case 21:M.sent(),M.label=22;case 22:return m=Date.now(),[4,n.FileDataProcessor.updateAssetListAsync(b,c)];case 23:return M.sent(),v=Date.now(),Core.Telemetry.Log.trackActivityEvent("FolderPacker.saveDataFolderAsync",{message:"Created '".concat(A,"' number of data files with chunk records '").concat(_,"'"),dataFilesCnt:A,chunkRecords:_,folderName:t,rowCount:null==e?void 0:e.length,saveDataFolderCreateTime:-1!==p?p-d:-1,saveMediaAssetsTime:-1!==f?f-p:-1,chunkedDataCreationTime:-1!==y?y-f:-1,saveChunkDataFileTime:-1!==g?g-y:-1,saveMetadataFileTime:-1!==h?h-g:-1,cleanupMetadataFilesTime:-1!==m?m-h:-1,cleanupOldAssetsTime:-1!==v?v-m:-1}),Core.Telemetry.Log.endScenario(s),[3,27];case 24:return w=M.sent(),Core.Telemetry.Log.endAndThrowIfCanceled(w,s),Core.Log.error("FolderPacker.saveDataFolderAsync",w),Core.Telemetry.Log.failScenario(s,{error:w,customScenarioData:{folderName:t}}),c?[4,n.FileDataProcessor.saveDataFileAsync("{}",c,a.errorFileName)]:[3,26];case 25:M.sent(),M.label=26;case 26:throw w;case 27:return[2]}}))}))},e.loadDataFolderAsync=function(t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){return[2,e.promiseQueue.pushJob((function(){return e._loadDataFolderAsync(t)}))]}))}))},e._loadDataFolderAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,i,s,c,u,l,d,p,f,y,g,h,m,v,b;return __generator(this,(function(_){switch(_.label){case 0:t=Core.Telemetry.Log.startScenario(Core.Telemetry.ScenarioName.LoadData),_.label=1;case 1:return _.trys.push([1,17,,18]),r=[],[4,n.FileDataProcessor.loadFolderAsync(e)];case 2:return i=_.sent(),[4,n.FileDataProcessor.loadDataFileAsync(i,a.headerFileName)];case 3:s=_.sent(),c=1,_.label=4;case 4:return c<=s.documentFilesCount?(u=e+"_"+c+++".json",[4,n.FileDataProcessor.loadChunkDataFileAsync(i,u)]):[3,6];case 5:return(l=_.sent())&&l.forEach((function(e){return r.push(e)})),[3,4];case 6:return s.assetFilesCount>0?[4,n.FileDataProcessor.loadFolderAsync(a.assetsFolder,i)]:[3,16];case 7:return d=_.sent(),[4,n.FileDataProcessor.loadDataFileAsync(d,a.assetsListFileName)];case 8:p=_.sent(),f=0,y=p,_.label=9;case 9:return f<y.length?(g=y[f],h=g.filename,Object(o.isSessionStorageUrl)(h)?[4,n.FileDataProcessor.loadSessionStorageDataAsync(h,d.fullPath)]:[3,11]):[3,16];case 10:return _.sent(),[3,15];case 11:return Core.FeatureGates.services.loadMediaAsBlob?[4,n.FileDataProcessor.loadBlobFromFileAsync(d,g.filename)]:[3,13];case 12:return m=_.sent(),n.FileDataProcessor.loadAndRegisterBlobsData(g.filename,m),[3,15];case 13:return[4,n.FileDataProcessor.loadArrayBufferFileAsync(d,g.filename)];case 14:v=_.sent(),n.FileDataProcessor.loadAndRegisterArrayBufferData(g.filename,v),_.label=15;case 15:return f++,[3,9];case 16:return Core.Telemetry.Log.trackActivityEvent("FolderPacker.loadDataFolderAsync",{message:"LoadData completed",folderName:e,rowCount:null==r?void 0:r.length}),Core.Telemetry.Log.endScenario(t),[2,r];case 17:throw b=_.sent(),Core.Telemetry.Log.endAndThrowIfCanceled(b,t),Core.Log.error("FolderPacker.loadDataFolderAsync",b),Core.Telemetry.Log.failScenario(t,{error:b,customScenarioData:{folderName:e}}),b;case 18:return[2]}}))}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"DynamicJsonSchemaHelper",(function(){return i}));var n=AppMagic.Constants.Runtime,a=AppMagic.Runtime,o=AppMagic.Services,i=function(){function e(){}return e.setControlDynamicTType=function(e,t,r,n,a,o){if(!n&&!a)return this.resetControlDynamicTTypeAndBlockPayload(e,t,r),!0;if(a||!this._trySetControlDynamicTType(e,t,r,n)){var i={propertyName:r,controlUniqueId:t,isSchemaConversionFail:a};return o&&(Object.assign(o,i),i=o),Core.Log.error("RuntimeBase.setControlDynamicTType",JSON.stringify(i)),this.resetControlDynamicTTypeAndBlockPayload(e,t,r),!1}return!0},e._trySetControlDynamicTType=function(e,t,r,i){try{var s=e.generateControlDynamicKey(t,r),c=Core.Utility.tryParseJson(i),u=Core.Loader.ObjectFactory.instance.getSingleton(a.App.AppPABinaryResolverSingletonKey),l=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.CurrentAppInstanceFunctionSingletonKey)().mediaRuntime,d={typesMgr:o.ServiceConfigDeserialization.TypesManagerDeserializer.parseTypesManager(c.typesbyprefix,l,u),mediaRuntime:l,binaryResolver:u},p=c.typesbyprefix[n.pcfDynamicTypePrefix],f=o.ServiceConfigDeserialization.TypesManagerDeserializer.parseTypeDefinition(p.typesbyname[n.pcfDynamicTypeEntryNode],d);return!!f&&(e.setTType(s,f),!0)}catch(e){return Core.Log.error("RuntimeBase._trySetControlDynamicTType","Error during control dynamic TType parsing."),!1}},e.getControlDynamicTType=function(e,t,r){var n=e.generateControlDynamicKey(t,r);return e.getTType(n)},e.resetControlDynamicTTypeAndBlockPayload=function(e,t,r){var n=e.generateControlDynamicKey(t,r);e.setTType(n,new AppMagic.Services.TypeSystem.JsonObjectTType(HashTableUtility.create()))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"createGetRowsResponse",(function(){return u})),r.d(t,"createResponseItemType",(function(){return l}));var n=r(0),a=AppMagic.Data,o=AppMagic.Services.Rest,i=AppMagic.Services.TypeSystem,s=a.ConnectedDataConstants.TypesManagerPrefix,c=new o.JsonResponseParam("/@odata.nextLink",new i.InlinedTTypeRef(new i.JsonStringTType));function u(e,t,r,a){var s=Object(n.HashTableUtility_create)();return s.items=new o.JsonResponseParam("/value",new i.InlinedTTypeRef(new i.JsonArrayTType(l(e,t,r,a)))),s.nextLink=c,s}function l(e,t,r,a){var o=e.getType(s,r);return Object(n.checkObject)(o,"We must have metadata for entity '".concat(r,"' that is referenced in query option. (Data Source: '").concat(t,"')")),new i.InlinedTTypeRef(o)}},function(e,t,r){"use strict";r.r(t),r.d(t,"MemoryStorage",(function(){return i}));var n=r(0),a=r(5),o=function(){function e(e,t,r){this._key=e,this._index=t,this._value=r}return Object.defineProperty(e.prototype,"key",{get:function(){return this._key},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!1,configurable:!0}),e.prototype.setIndex=function(e){this._index=e},e.prototype.setKey=function(e){this._key=e},e}(),i=function(){function e(){this._entries=Object(n.HashTableUtility_create)(),this._entryList=[]}return Object.defineProperty(e.prototype,"count",{get:function(){return this._entryList.length},enumerable:!1,configurable:!0}),e.prototype.contains=function(e){return Object(n.isDefined)(this._entries[e])},e.prototype.getEntry=function(e){return this._entries[e]||null},e.prototype.getAll=function(){return this._entryList},e.prototype.add=function(e,t){var r=new o(e,this._entryList.length,t);this._entries[e]=r,this._entryList.push(r)},e.prototype.replace=function(e,t,r){var n=this._entries[e];return delete this._entries[e],n.value=r,n.setKey(t),this._entries[t]=n,n},e.prototype.remove=function(e){var t=this._entries[e];if(Object(n.isUndefined)(t))return null;var r=t.index,a=this._entryList;a.splice(t.index,1),delete this._entries[e];for(var o=r,i=a.length;o<i;++o)a[o].setIndex(o);return t},e.prototype.bulkRemoveByIndex=function(e){if(0!==e.length){for(var t=0,r=e.length;t<r;++t){var n=this._entryList[e[t]];delete this._entries[n.key]}Object(a.arrayBulkRemove)(this._entryList,e);for(t=e[0],r=this._entryList.length;t<r;++t)this._entryList[t].setIndex(t)}},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"safeCast",(function(){return a})),r.d(t,"isValid",(function(){return o}));var n=r(0);function a(e){return o(e)?e:null}function o(e){return e&&Object(n.isNonEmptyString)(e.message)&&Object(n.isNonEmptyString)(e.stacktrace)&&Object(n.isNonEmptyString)(e.type)}},function(e,t,r){"use strict";r.r(t),r.d(t,"RetrieveOrganizationInfoFunctionName",(function(){return o})),r.d(t,"getRetrieveOrganizationInfoFunctionDefinition",(function(){return i}));var n=AppMagic.Services.ServiceConfigDeserialization,a=AppMagic.Services.ServiceConfigDeserialization.IRConstants,o="RetrieveOrganizationInfo";function i(e){var t={deftype:a.DefTypes.JsonPrimitive,primitive:a.JsonPrimitives.String,dtype:"s"},r={deftype:a.DefTypes.JsonObject,properties:{Id:{displayidx:0,type:t},VersionNumber:{displayidx:0,type:t},SolutionUniqueName:{displayidx:0,type:t},FriendlyName:{displayidx:0,type:t},PublisherId:{displayidx:0,type:t},PublisherIdName:{displayidx:0,type:t},PublisherUniqueName:{displayidx:0,type:t}}},i={deftype:a.DefTypes.JsonArray,items:{type:r}},s={deftype:a.DefTypes.JsonObject,properties:{InstanceType:{displayidx:0,type:t},Solutions:{displayidx:0,type:i}}},c={deftype:a.DefTypes.JsonObject,properties:{organizationInfo:{displayidx:0,type:s}}},u={resultform:a.ResultForm.Self,body:{mediatype:a.ResponseMediaType.Json,type:c}},l={deftype:n.IRConstants.DefTypes.ServiceVariableReference,name:"api.runtimeUrl"};return{deftype:n.IRConstants.DefTypes.RestFunction,disabletryit:!1,name:o,parameters:[],request:{auth:e,method:AppMagic.Services.HttpConstants.Method.GET,resource:{baseurlvalueexpression:l,paths:[{path:o,templates:[]}]},headers:[],querystringparameters:[]},response:u}}},function(e,t,r){"use strict";r.r(t),r.d(t,"WebResourceDataSource",(function(){return c}));var n=r(4),a=AppMagic.Data.AppDataSource,o=(AppMagic.Data.AppDataSourceError,Core.Globalization.currentCulture),i=Core.Globalization.LanguageValidation,s=Core.Globalization.lcidmap,c=function(e){function t(t,r,a,o,i){var s=e.call(this,t,a,n.DataSourceKind.WebResource,o)||this;return s._logicalName=r,s._resxDataLoader=i,s._loadingInitialDataJob=null,s._isDataLoaded=!1,s}return __extends(t,e),t.isWebResourceDataSource=function(e){return e.kind===n.DataSourceKind.WebResource},Object.defineProperty(t.prototype,"canClear",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canUserEdit",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canUserCreate",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canUserDelete",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportsSingleRecordPatch",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPagable",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDelegable",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shouldEnforceRowSchemaOnPatch",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"logicalName",{get:function(){return this._logicalName},enumerable:!1,configurable:!0}),t.prototype.waitForLoadingInitialDataAsync=function(){var e;return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,null===(e=this._loadingInitialDataJob)||void 0===e?void 0:e.waitAsync()];case 1:return t.sent(),[2]}}))}))},t.prototype.getResourceString=function(e,t){var r,n;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:return this._isDataLoaded?[3,2]:[4,this.waitForLoadingInitialDataAsync()];case 1:t.sent(),t.label=2;case 2:return[2,null!==(n=null===(r=this.dataInternal)||void 0===r?void 0:r[e])&&void 0!==n?n:e]}}))}))},t.getCustomPageLanguageCode=function(){var e=i.validateAndGetLocalizedLanguage(o().language),t=this.getUCIMappedLanguage(e);return(null==s?void 0:s.hasOwnProperty(t))?s[t]:(Core.Log.warningEx("WebResourceDataSource.getLanguageCode","lcid not found language "+t),1033)},t.getUCIMappedLanguage=function(e){switch(e){case"sr-Cyrl-RS":return"sr-Cyrl-CS";case"sr-Latn-RS":return"sr-Latn-CS";default:return e}},t.prototype._loadingInitialDataAsync=function(){var e=this;return this._loadingInitialDataJob=new Core.AsyncOperation("WebResourceDataSource._loadingInitialDataJob",(function(){var r;return null===(r=e._resxDataLoader)||void 0===r?void 0:r.getWebResourceResx(e.logicalName,t.getCustomPageLanguageCode()).then((function(t){t||(Core.Log.errorEx("WebResourceDataSource._loadingInitialDataJob","No data received for webresource ".concat(e.logicalName)),t={}),e._setData(t),e._loadingInitialDataJob=null,e._isDataLoaded=!0,e._onDataLoaded()}),(function(t){Core.PromiseUtils.throwIfCanceled(t),Core.Log.errorEx("WebResourceDataSource._loadingInitialDataJob",{error:t}),e._loadingInitialDataJob=null,e._reportDataSourceLoadErrorMessage(t)}))})),this._loadingInitialDataJob.start(),Promise.resolve()},t.prototype.refreshAsync=function(r,n){var a=this;if(void 0===r&&(r=null),void 0===n&&(n=!1),!this.isDataAvailable){try{throw new Error("Refresh is called when datasource is in stage: ".concat(Core.LifeCycleStage[this.stage],"."))}catch(e){Core.Log.errorEx("WebResourceDataSource.refreshAsync",e)}if(this.stage===Core.LifeCycleStage.Disposed)return Promise.resolve(!1)}return this._loadingInitialDataJob?(Core.Log.verbose("{0}: [{1}] {2}","WebResourceDataSource.refreshAsync",this.name,"loading initial data is in progress. Skipping refresh."),this._loadingInitialDataJob.waitAsync().then((function(){return!0}),(function(){return!1}))):this._refreshDataJob?(Core.Log.verbose("{0}: [{1}] {2}","WebResourceDataSource.refreshAsync",this.name,"a refresh job is already in progress. Using that job."),this._refreshDataJob.waitAsync()):(Core.Log.verbose("{0}: [{1}] {2}","WebResourceDataSource.refreshAsync",this.name,"Starting a new refresh job."),this._refreshDataJob=new Core.AsyncOperation("WebResourceDataSource._refreshDataJob",(function(){var r,o=null===(r=a._resxDataLoader)||void 0===r?void 0:r.getWebResourceResx(a.logicalName,t.getCustomPageLanguageCode()).then((function(e){a._setData(e),a._isDataLoaded=!0})).then((function(){if(!n)return e.prototype._onDataChangedAsync.call(a)})).then((function(){return a._onDataChanged(),!0}),(function(e){return Core.Utility.isCanceledError(e)||Core.Log.errorEx("WebResourceDataSource.refreshAsync","Exception in _refreshCoreAsync",{error:console.error}),!1}));return Core.PromiseUtils.wrapWithFinally(o,(function(){a._refreshDataJob=null}))}),{startOnWait:!0}),this._refreshDataJob.waitAsync().catch((function(e){return Core.Log.errorEx("WebResourceDataSource.refreshAsync","Exception in _refreshDataJob",{error:e,eventData:{isFatal:!1}}),!1})))},t}(a)},function(e,t,r){"use strict";r.r(t),r.d(t,"CdpDataSource",(function(){return w}));var n=r(0),a=r(73),o=r(114),i=r(115),s=r(10),c=r(14),u=r(4),l=(r(23),r(44)),d=r(16),p=r(25),f=r(8),y=r(22),g=r(18),h=r(37),m=AppMagic.Data,v=AppMagic.Data.ErrorKind,b=AppMagic.Data.ErrorSeverity,_=AppMagic.ConnectionHub,C=(AppMagic.Data.DataRecord,AppMagic.Data.DataEntityRecord),A=AppMagic.Data.DataTable,S=AppMagic.Data.ArrayColumnMetadata,D=AppMagic.Data.CdpLookupColumnMetadata,O=AppMagic.Data.ObjectColumnMetadata,E=AppMagic.Data.NavigationColumnMetadata,T=AppMagic.Data.PolymorphicLookup,R=AppMagic.Data.KeyKind,w=function(e){function t(t,r,a,o,s,c){var l=e.call(this,t,"Cdp_Internal_Dataset_"+t,u.DataSourceKind.ConnectedDataSource,a.primaryConnector,new n.Lazy((function(){return a.primaryConnector.metadata})),r,o,s,c)||this;return l._connectorManager=a,l._typeManager=new i.ConnectedDataTypesManager(l._connectorManager),l._lazyReadOnlyPrimaryLookupConnector=new n.Lazy((function(){return new g.ReadOnlyLookupConnector(l._primaryConnector)})),l._setData(A.create()),l}return __extends(t,e),Object.defineProperty(t.prototype,"connectorManager",{get:function(){return this._connectorManager},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"requiresAsync",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"protocol",{get:function(){return"cdp"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.dataTableInternal},enumerable:!1,configurable:!0}),t.prototype._setData=function(t){e.prototype._setData.call(this,t)},t.prototype._createTabularCachableQueryAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r;return __generator(this,(function(n){switch(n.label){case 0:return[4,this.connectorManager.primaryConnector.getConnectorTypeNameAsync()];case 1:return t=n.sent(),r=new f.CdpQueryDefinition(this._typeManager,this.name,t,this.connectorManager.primaryConnector.queryStringBuilder,e),[2,new d.TabularCachableQuery(r)]}}))}))},t.prototype.getDefaultRecord=function(){var t=e.prototype.getDefaultRecord.call(this);return AppMagic.Data.DataEntityRecord.makeUncommittedEntityRecord(t,this.connector.entityType,this.primaryTable.name,"cdp")},t.prototype.getNavigatedQueriedTableAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var r,o,i,s,c,u,g,h,m,_,A,S;return __generator(this,(function(D){switch(D.label){case 0:D.label=1;case 1:if(D.trys.push([1,3,,4]),Object(n.checkIsValid)(e,C.isDataEntityRecord,"Codegen sent an invalid data entity record for ".concat(t,".")),r=C.getTableName(e),o=C.getCanonicalId(e),i=this._connectorManager.tryGet(r),Object(n.checkObject)(i,"Connector for base table name '".concat(r,"' should have been managed by the Connector Manager.")),Object(n.checkDefined)(i.metadata.navigationColumns[t],"Expected column '".concat(t,"' to be a navigation column in table '").concat(r,"'.")),s=e[t],!AppMagic.Data.DataTable.isDataTable(s))throw new Error("Column name '".concat(t,"' should be a data table, but is not."));return c=s.nextLink,u={results:s,nextLink:c},g=this._connectorManager.tryGetNavigationConnector(i,t),Object(n.checkObject)(g,"Target connector for column '".concat(t,"' should have been managed by the Connector Manager.")),(h=new y.TableQueryOptions).expands=Object(n.HashTableUtility_mapToArray)(g.metadata.navigationColumns,(function(e,t){return new p.Expand(t)})),[4,g.getConnectorTypeNameAsync()];case 2:return m=D.sent(),_={sourceType:f.SourceType.CdpNavigatedColumnArrayQueryDefinition,dataSourceName:this.name,tableName:m.serverTableName,columnName:t,itemKey:o,requestUrl:c||"",responseParams:Object(a.createGetRowsResponse)(this._typeManager,this.name,m.serverTableName,h),queryOptions:h},A=new d.NavigatedArrayCacheableQuery(_),[2,new l.CdpNavigatedQueriedTable(this,g,this.dataRuntime,this._queryDataProvider,A,u)];case 3:return S=D.sent(),this._logError("CdpDataSource.getNavigatedQueriedTableAsync",S),[2,AppMagic.Data.ErrorValue.createGatedError(v.Unknown,b.Severe,Object(n.formatErrorMessage)(S))];case 4:return[2]}}))}))},t.prototype.getPrimaryKey=function(e){if(AppMagic.Data.DataEntityRecord.isDataEntityRecord(e)){var t=C.getTableName(e),r=this._connectorManager.tryGet(t);if(r)return r.metadata.getPrimaryKey(e);this._logError("CdpDataSource.getPrimaryKey",Object(n.throwInline)(new Error("Could not get primary key for item. Falling back to getPrimaryKey method from table.")),"Record has an entityId not known to this data source")}return this.primaryTable.getPrimaryKey(e)},t.prototype.tryGetPrimaryKey=function(e){if(AppMagic.Data.DataEntityRecord.isDataEntityRecord(e)){var t=C.getTableName(e),r=this._connectorManager.tryGet(t);if(r)return r.metadata.tryGetPrimaryKey(e);this._logError("CdpDataSource.tryGetPrimaryKey",Object(n.throwInline)(new Error("Could not get primary key for item. Falling back to tryGetPrimaryKey method from table.")),"Record has an entityId not known to this data source")}return this.primaryTable.tryGetPrimaryKey(e)},t.prototype.tryCreateLookupColumnReference=function(e,t){var r=this.primaryTable.tryGetColumn(e);return r&&r.isLookup?new o.ConnectedDataSourceLookupColumnReference(this._lazyReadOnlyPrimaryLookupConnector.value,r,this.dataRuntime,this._queryDataProvider,this.name,this.primaryTable.name):(this.dataRuntime.reportRuntimeError(t,Object(n.CoreUtility_formatString)(AppMagic.Strings.LookupFunctionColumnNotSupported,e)),null)},t.prototype.tryGetDisplayFormat=function(e){var t=this.primaryTable.tryGetColumn(e);if(t instanceof O||t instanceof D)return t.displayFormat;if(t instanceof S&&(t.items instanceof O||t.items instanceof D))return t.items.displayFormat;if(t instanceof E){var r=t.targetTableName,n=this._tryGetMetadataForTable(r);return n?n.displayFormat:null}return null},t.prototype._tryGetMetadataForTable=function(e){if(e===this.primaryTable.name)return this.primaryTable;var t=this.connectorManager.tryGet(e);return t?t.metadata:null},t.prototype.getChoicesAsync=function(e,t,r){return void 0===r&&(r=null),__awaiter(this,void 0,Promise,(function(){var a,o,i,s,c,u;return __generator(this,(function(l){switch(l.label){case 0:if(!(a=this.primaryTable.tryGetColumn(t))||!a.isLookup&&!a.isNavigation)return o=AppMagic.Strings.ErrUnknownErrorGettingChoices,i=AppMagic.AuthoringTool.Runtime.tryCreateGatedReportRuntimeError({errorContext:e,errorMessage:o,skipDisplayRuntimeError:!0,functionName:"Choices"}),m.ErrorValue.isErrorHandlingFeatureEnabled()||this.dataRuntime.reportRuntimeError(e,o),this._logError("CdpDataSource.getChoicesAsync",Object(n.throwInline)(new Error("there was a problem getting choices for column: ".concat(t,".")))),[2,m.ErrorValue.createGatedError(m.ErrorKind.InvalidFunctionUsage,m.ErrorSeverity.Severe,o,i)];s=this.dataRuntime.startAsyncDataAction(),c=null,l.label=1;case 1:return l.trys.push([1,6,7,8]),a.isLookup?[4,this._getLookupItemsAsync(e,a,r)]:[3,3];case 2:return c=l.sent(),[3,5];case 3:return[4,this._getNavigationEntityChoicesAsync(e,a)];case 4:c=l.sent(),l.label=5;case 5:return[3,8];case 6:return u=l.sent(),[2,this._handleGetChoicesError(u,e)];case 7:return this.dataRuntime.endAsyncDataAction(s),[7];case 8:return[2,c]}}))}))},t.prototype._getLookupItemsAsync=function(e,t,r){return void 0===r&&(r=null),__awaiter(this,void 0,Promise,(function(){var n,a;return __generator(this,(function(o){switch(o.label){case 0:return n=this.tryCreateLookupColumnReference(t.name,e),m.ErrorValue.isErrorValue(n)?[2,n]:[4,n.lookupItemsAsync(r,e)];case 1:return a=o.sent(),m.ErrorValue.isErrorValue(a)?[2,a]:a?[2,a.results]:[2,m.ErrorValue.createGatedError(m.ErrorKind.Network,m.ErrorSeverity.Severe)]}}))}))},t.prototype._getNavigationEntityChoicesAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,a,o,i;return __generator(this,(function(s){switch(s.label){case 0:return r=this.connectorManager.tryGet(t.targetTableName),n=AppMagic.Strings.ErrUnknownErrorGettingChoices,r?[4,r.getConnectorTypeNameAsync()]:(a={errorContext:e,errorMessage:n,raiseToastNotification:!1,wasReported:!1,functionName:null},m.ErrorValue.isErrorHandlingFeatureEnabled()||this.dataRuntime.reportRuntimeError(e,n),[2,m.ErrorValue.createGatedError(m.ErrorKind.InvalidFunctionUsage,m.ErrorSeverity.Severe,n,a)]);case 1:return o=s.sent(),i=new f.CdpQueryDefinition(this._typeManager,this.name,o,this.connectorManager.primaryConnector.queryStringBuilder),[2,this._queryDataProvider.getDataAsync(new g.ReadOnlyConnectedDataConnector(r),r.dataSourceName,new d.TabularCachableQuery(i),e,this.maxGetRowsCount()).then((function(t){if(t)return t.results;var r={errorContext:e,errorMessage:n,raiseToastNotification:!1,wasReported:!1,functionName:null};return m.ErrorValue.createGatedError(m.ErrorKind.Network,m.ErrorSeverity.Severe,n,r)}))]}}))}))},t.prototype._getRelateUnrelateInfo=function(e,t){var r=Object(n.tryParseJson)(m.DataEntityRecord.getCanonicalId(e)),a=Object(n.tryParseJson)(m.DataEntityRecord.getCanonicalId(t)),o=m.DataEntityRecord.tryGetODataId(t);if(!r)throw new Error("Could not parse serialized parentEntityKey. It may be corrupted. parentDataSource: '".concat(m.DataEntityRecord.getDataSourceName(e),"'"));return{parentEntityKey:r,targetEntityKey:a,targetOdataId:o}},t.prototype._postProcessEditColumn=function(e,t,r){this._updateOdataType(e,t,r)},t.prototype._updateOdataType=function(e,t,r){r.isLookup&&r.odataType&&e[t]&&(e[t+AppMagic.Services.ODataConstants.MetadataPropertyName.Type]=r.odataType)},t.prototype._tryGetConnectorForTable=function(e){return this._connectorManager.tryGet(e)},t.prototype._refreshCoreAsync=function(e){return void 0===e&&(e=null),__awaiter(this,void 0,Promise,(function(){var t,r;return __generator(this,(function(a){switch(a.label){case 0:if(this.isDelegable){try{this.cleanInternalDataSource()}catch(e){this._logError("CdpDataSource._refreshCoreAsync",e,"Error when cleaning up tabular cache.")}return[2]}return n.CoreLog.verbose("CdpDataSource[{0}]._refreshCoreAsync: Started.",this.name),[4,this.connector.getConnectorTypeNameAsync()];case 1:return t=a.sent(),r=new f.CdpQueryDefinition(this._typeManager,this.name,t,this.connectorManager.primaryConnector.queryStringBuilder,this._lazyDefaultQueryOption.value),[4,this.refreshCoreCommonAsync(r,e)];case 2:return[2,a.sent()]}}))}))},t.prototype._tryBindNavigation=function(e,t,r,n){var a=null,o=AppMagic.Services.CdpUtility.formatNavigationBindPropertyName(r);if(null===t)return e[o]=null,!0;var i=C.tryGetODataId(t);return i||(a=this._addNavigationValidationError("CdpDataSource._bindNavigation",r,e)),a?(Object(c.add)(n,a),!1):(e[o]=i,!0)},t.prototype._addNavigationValidationError=function(e,t,r){var n="Expected dataEntityRecord for navigation column";return this._logWarning(e,n),Object(s.columnValueInvalid)(r,t,n,v.Validation)},t.prototype.getPolymorphicLookupAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,n,a,o;return __generator(this,(function(i){switch(i.label){case 0:return null===(r=T.getPolymorphicValue(t))?[2,m.ErrorValue.createGatedError(m.ErrorKind.InvalidFunctionUsage,m.ErrorSeverity.Moderate,AppMagic.Strings.InvalidCast,AppMagic.AuthoringTool.Runtime.tryCreateGatedReportRuntimeError({errorContext:e,errorMessage:AppMagic.Strings.InvalidCast,functionName:null}))]:(n=null,this.primaryTable.keyColumns.forEach((function(e){if(e.keyKind===R.Primary){var t=e.name;n=t}})),null===n?[3,2]:(a=new d.CdpPolymorphicCacheableQuery({sourceType:f.SourceType.CdpPolymorphicQueryDefinition,dataSourceName:this.name,tableName:this.primaryTable.name,columnName:n,key:r}),[4,this._queryDataProvider.getDataAsync(new g.ReadOnlyCdpPolymorphicLookupConnector(this.connector),this.name,a,e,1,0)]));case 1:if((o=i.sent()).results&&1===o.results.length)return[2,o.results[0]];i.label=2;case 2:return[2,m.ErrorValue.createGatedError(m.ErrorKind.InvalidFunctionUsage,m.ErrorSeverity.Moderate,AppMagic.Strings.InvalidCast,AppMagic.AuthoringTool.Runtime.tryCreateGatedReportRuntimeError({errorContext:e,errorMessage:AppMagic.Strings.InvalidCast,functionName:null}))]}}))}))},t.prototype._tryBindPolymorphic=function(e,t,r,a,o){var i=this.connector,s=r.name;return i.connectionApiId!==_.Constants.ApiIds.CommonDataService||(t[s]=a,t=m.PolymorphicLookup.createPolymorphicLookupPointer(s,t,"cdp"),!Object(n.isUndefined)(t[s]))},t}(h.TabularDataSource)},function(e,t,r){"use strict";r.r(t),r.d(t,"safeCast",(function(){return i})),r.d(t,"isValidOptionSetDataRecord",(function(){return s}));var n=r(0),a=r(55),o=AppMagic.Data.DataRecord;function i(e){return s(e)?e:null}function s(e){return o.isDataRecord(e)&&Object(n.isObject)(e.Value)&&Object(a.isValidOptionSetData)(e.Value)}},function(e,t,r){"use strict";r.r(t),r.d(t,"safeCast",(function(){return o})),r.d(t,"isValidViewDataRecord",(function(){return i}));var n=r(56),a=AppMagic.Data.DataRecord;function o(e){return i(e)?e:null}function i(e){return a.isDataRecord(e)&&Core.Utility.isObject(e.Value)&&Object(n.isValidViewData)(e.Value)}},function(e,t,r){"use strict";r.r(t),r.d(t,"ISendMessagePluginSingletonKey",(function(){return n}));var n=Core.Loader.TypeKey.createForInterface("AppMagic.Runtime.App.Messaging.ISendMessagePlugin")},function(e,t,r){"use strict";r.r(t),r.d(t,"create",(function(){return n}));r(0);function n(e,t,r){return{Latitude:e,Longitude:t,Altitude:r}}},function(e,t,r){"use strict";r.r(t),r.d(t,"IDataFormatter",(function(){return i})),r.d(t,"CDSDataFormatter",(function(){return c})),r.d(t,"DataFormatterFactory",(function(){return u}));var n=r(0),a=r(195),o=r(125),i=AppMagic.Runtime.App.IDataFormatter;function s(e){if(e&&Object(n.isString)(e))return e=(e=e.replace("hh:","HH:")).replace("h:","H:")}var c=function(){function e(e){var t;this._orgAndUserSettings=e,e&&(this._formattingSettings=function(e){var t,r,n,a=[],o=null!==(t=e.userSettings.timeZoneDefinitionByCode)&&void 0!==t?t:{};for(var i in o)a.push(e.userSettings.timeZoneDefinitionByCode[i]);return{dateTimeFormat:null!==(r=e.userSettings.dateFormatInfo)&&void 0!==r?r:{},numberFormat:null!==(n=e.userSettings.numberFormatInfo)&&void 0!==n?n:{},timeZoneDefinitions:a}}(e),this._extendedDateTimeSettings=function(e){var t=Object(n.replaceTTwithAMPM)(s(e.ShortTimePattern),!1);return{shorttime24:t,shortdatetime24:"".concat(e.ShortDatePattern," ").concat(t),shortdatetime:"".concat(e.ShortDatePattern," ").concat(e.ShortTimePattern),longdatetime24:Object(n.replaceTTwithAMPM)(s(e.FullDateTimePattern),!1),longtime24:Object(n.replaceTTwithAMPM)(s(e.LongTimePattern),!1)}}(null===(t=this._formattingSettings)||void 0===t?void 0:t.dateTimeFormat))}return e.prototype.logIfResultNull=function(e,t,r){null===e&&null!=r&&n.CoreLog.errorEx("CDSDataFormatter.".concat(t),{eventData:{numberFormat:this._formattingSettings.numberFormat,datetimeformat:this._formattingSettings.dateTimeFormat},message:"CDSDataFormatter failed to parse/format data "})},e.prototype.getFormattedNumberValue=function(e){var t,r=Number.isInteger(null!==(t=this.getParsedNumberValue(e+""))&&void 0!==t?t:0)?0:void 0,n=Object(a.localeNumberFormatter)(e,this._formattingSettings,r);return this.logIfResultNull(n,"getFormattedNumberValue",e),n},e.prototype.getParsedNumberValue=function(e){var t=Object(o.parseNumber)(e,this._formattingSettings);return this.logIfResultNull(t,"getParsedNumberValue",e),t},e.prototype.getFormattedDateValue=function(e,t){var r=new Date(e);if(!isFinite(r.valueOf()))return null;var n,o=this._formattingSettings.dateTimeFormat;switch(t){case"'shortdate'":n=o.ShortDatePattern;break;case"'shortdatetime'":n=this._extendedDateTimeSettings.shortdatetime;break;case"'longdate'":n=o.LongDatePattern;break;case"'longdatetime'":n=o.FullDateTimePattern;break;case"'shorttime'":n=o.ShortTimePattern;break;case"'longtime'":n=o.LongTimePattern;break;case"'shortdatetime24'":n=this._extendedDateTimeSettings.shortdatetime24;break;case"'shorttime24'":n=this._extendedDateTimeSettings.shorttime24;break;case"'longdatetime24'":n=this._extendedDateTimeSettings.longdatetime24;break;case"'longtime24'":n=this._extendedDateTimeSettings.longtime24;break;case"'s'":case"'Y'":case"'y'":n=t.charAt(1);break;case"s":case"Y":case"y":n=t;break;case"'datelongabbreviated'":n=(n=(n=o.LongDatePattern).replace("MMMM","MMM")).replace("dddd","ddd");break;default:n=o.ShortDatePattern}var i=Object(a.dateFormatter)(r.toISOString(),this._formattingSettings,0,n);return this.logIfResultNull(i,"getFormattedDateValue",e),i},e.prototype.getParsedDateValue=function(e){var t=Object(o.parseDate)(e,this._formattingSettings);return this.logIfResultNull(t,"getParsedDateValue",e),t},e.prototype.getParsedDateTimeValue=function(e){var t=Object(o.parseDateTime)(e,this._formattingSettings);return this.logIfResultNull(t,"getParsedDateTimeValue",e),t},e.prototype.getParsedTimeValue=function(e){var t=Object(o.parseTime)(e,this._formattingSettings);null==t||t.setFullYear(1970,0,1);var r=null==t?void 0:t.getTime();return this.logIfResultNull(r,"getParsedTimeValue",e),r},e.prototype.getFormattedValue=function(e,t){var r=Object(a.FormatValue)(e,t,this._formattingSettings);return this.logIfResultNull(r,"getFormattedValue",e),r},e.prototype.getFormattingSettings=function(){return this._formattingSettings},e}(),u=function(){function e(){}return e.initializeDataFormatter=function(e){if(!e)throw new Error("No orgAndUserSettings provided for the dataformatter.");return new c(e)},e}()},function(e,t,r){"use strict";var n;r.r(t),r.d(t,"ARViewCapability",(function(){return n})),function(e){e[e.takeMeasurement=1]="takeMeasurement",e[e.viewModel=2]="viewModel",e[e.viewImage=4]="viewImage",e[e.viewVolume=8]="viewVolume",e[e.getApiVersion=16]="getApiVersion",e[e.placeAnnotations=32]="placeAnnotations",e[e.launchCommunicator=64]="launchCommunicator",e[e.isDeviceARCapable=128]="isDeviceARCapable"}(n||(n={}))},function(e,t,r){"use strict";r.r(t),r.d(t,"InSufficientMemorySaveDataError",(function(){return n})),r.d(t,"QuotaExceedsSaveDataError",(function(){return a})),r.d(t,"UnsupportedStorageSaveDataError",(function(){return o}));var n=function(e){function t(t){return void 0===t&&(t=AppMagic.Strings.SaveDataInsufficientMemory),e.call(this,t,"SaveData.InsufficientMemoryError")||this}return __extends(t,e),t}(Core.ErrorBase),a=function(e){function t(t){return void 0===t&&(t=AppMagic.Strings.SaveDataQuotaExceeds),e.call(this,t,"SaveData.QuotaExceedsSaveDataError")||this}return __extends(t,e),t}(Core.ErrorBase),o=function(e){function t(t){return void 0===t&&(t=AppMagic.Strings.SaveDataUnsupportedStorage),e.call(this,t,"SaveData.UnsupportedStorageSaveDataError")||this}return __extends(t,e),t}(Core.ErrorBase)},function(e,t,r){"use strict";r.r(t),r.d(t,"JSZipLoader",(function(){return n}));var n=function(){function e(){e._promise=this._injectJszipScriptsAsync()}return e.prototype._injectJszipScriptsAsync=function(){var e=AppMagic.Runtime.App.PublishedAppLoader.tryGetInstance(),t="openSource/unmodified/jszip/pa.jszip.bundle.js";return t=e?e.resolveAppAssetPath(t):Core.Utility.getAbsoluteUri(t),Core.UI.Utility.DomHelper.injectScript(t,t)},e.prototype.loadingPromise=function(){return e._promise},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"WebEncryptionProvider",(function(){return n}));var n=function(){function e(){}return e.prototype.decodeFromBase64String=function(e){return Core.IO.Utility.Conversion.base64ToArrayBuffer(e)},e.prototype.encodeToBase64String=function(e){return Core.IO.Utility.Conversion.arrayBufferToBase64(e)},e.prototype.encryptData=function(e){return Promise.resolve(e)},e.prototype.decryptArrayBufferAsync=function(e){return Promise.resolve(e)},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"collectItems",(function(){return o}));r(0);var n=r(1),a=(r(23),r(5));function o(e,t,r){for(var o=!1,i=0,s=t.length;i<s;++i){var c=t[i];if(c)if(Object(n.AppMagicDataDataRecord_isValid)(c)||Object(n.AppMagicDataErrorValue_isErrorValue)(c)){var u=Object(n.clone)(c,!0,!0);Object(a.addRefBlobs)(u),r.assignRowID(u),e.push(u),o=!0}else for(var l=c,d=0,p=l.length;d<p;++d){var f=l[d];if(null!==f){u=Object(n.clone)(f,!0,!0);Object(a.addRefBlobs)(u),r.assignRowID(u),e.push(u),o=!0}}}return o}},function(e,t,r){"use strict";r.r(t),r.d(t,"mergeRecord",(function(){return n}));r(1),r(0);function n(e,t,r){for(var n=Object.keys(t),a=0,o=n.length;a<o;a++){var i=n[a];e[i]=t[i]}return r.assignRowID(e),e}},function(e,t,r){"use strict";r.r(t),r.d(t,"AppDataSourceOnDataLoadEventManager",(function(){return a}));var n=r(0),a=function(){function e(e){this._jsRuntime=e,this._onDataLoadEventPromiseQueue=new n.PromiseQueue("AppDataSourceOnDataLoadEventManager")}return e.prototype.setControlPromise=function(e){n.Log.trackActivityEvent("AppDataSourceOnDataLoadEventManager.setControlPromise",{message:"Promise set."}),e=e.then(null,(function(e){n.CoreLog.error("AppDataSourceOnDataLoadEventManager.setControlPromise",e,"Control promise for OnDataLoadEvent failed.")})),this._onDataLoadEventPromiseQueue.pushJob((function(){return Object(n.wrapWithFinally)(e,(function(){n.Log.trackActivityEvent("AppDataSourceOnDataLoadEventManager.setControlPromise",{message:"Promise released."})}))}))},e.prototype.dispose=function(){this._onDataLoadEventPromiseQueue.cancelAll(),this._onDataLoadEventPromiseQueue=null},e.prototype.onDataLoaded=function(e){var t=this;if(0!==this._onDataLoadEventPromiseQueue.getJobsCount()){n.Log.trackActivityEvent("AppDataSourceOnDataLoadEventManager.onDataLoaded",{message:"Event paused."});var r=this._jsRuntime.startAsyncDataAction();this._onDataLoadEventPromiseQueue.pushJob((function(){t._jsRuntime.endAsyncDataAction(r),t._jsRuntime.onDataSourceChanged(e)}))}else this._jsRuntime.onDataSourceChanged(e)},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"QueriedScalar",(function(){return c}));var n=r(0),a=r(35),o=r(24),i=AppMagic.Data,s=AppMagic.Data.DataValue,c=function(){function e(e,t,r){this._connector=e,this._dataRuntime=t,this._queryOptions=r,this._promiseQueue=new n.PromiseQueue("QueriedScalar")}return Object.defineProperty(e.prototype,"queryOptions",{get:function(){return this._queryOptions},enumerable:!1,configurable:!0}),e.prototype.getResultAsync=function(e){var t=this;return this._promiseQueue.pushJob((function(){return t._getResultsAsync(e)}))},e.prototype._getResultsAsync=function(e){var t=this,r=this._dataRuntime.startAsyncDataAction(),c=this._connector.getScalarResultAsync(this._queryOptions,e).then((function(e){var t=i.QueryScalarResponse.safeCast(e);return s.safeCast(t.result)}),(function(r){var s;if(Object(n.throwIfCanceled)(r),r instanceof a.AppDataSourceError&&r.serverError instanceof AppMagic.Services.ConnectedDataQueryStringBuilderError)return r.serverError.errValue;var c=AppMagic.Services.SendHttpResponse.isValid(null===(s=null==r?void 0:r.serverError)||void 0===s?void 0:s.response)?r.serverError.response:void 0,u=Object(o.getNetworkErrorMessageFromResponse)(c),l={errorContext:e,errorMessage:u,error:r,raiseToastNotification:!1,wasReported:!1,functionName:null};return Object(o.reportConnectedDataReadOperationErrors)(r,e,t._dataRuntime),n.CoreLog.error("QueriedScalar._getResultsAsync",r),i.ErrorValue.createGatedError(i.ErrorKind.Network,i.ErrorSeverity.Severe,u,l,c)}));return Object(n.wrapWithFinally)(c,(function(){return t._dataRuntime.endAsyncDataAction(r)}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"CachedQueryData",(function(){return n}));r(0),r(23);var n=function(){function e(e,t,r,n,a,o){this._data=t,this._nextLink=n,this._serverRowCount=a,this._serverRowLimitExceeded=o,this._createdTime=(new Date).getTime(),this._queryDefinition=r,this._expirationTimeout=e,this._hasMoreData=!0}return Object.defineProperty(e.prototype,"nextLink",{get:function(){return this._nextLink},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverRowCount",{get:function(){return this._serverRowCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverRowLimitExceeded",{get:function(){return this._serverRowLimitExceeded},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"createdTime",{get:function(){return this._createdTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasMoreData",{get:function(){return this._hasMoreData},set:function(e){this._hasMoreData=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"queryDefinition",{get:function(){return this._queryDefinition},enumerable:!1,configurable:!0}),e.prototype.updateData=function(e){var t=e.leftovers?e.results.concat(e.leftovers):e.results;this._data=this._data.concat(t),this._nextLink=e.nextLink,this._serverRowCount=e.serverRowCount,this._serverRowLimitExceeded=e.serverRowLimitExceeded},e.prototype.getData=function(e,t){var r;if(void 0===e||void 0===t)r={results:this._data};else{var n=t+e;r={results:n<=this._data.length?this._data.slice(t,n):this._data.slice(t)}}return this._addNextLinkIfAvailable(r),this._addServerRowCountIfAvailable(r),this._addServerRowLimitExceededIfAvailable(r),r},Object.defineProperty(e.prototype,"isExpired",{get:function(){if(0===this._expirationTimeout)return!0;var e=(new Date).getTime();return this._createdTime+this._expirationTimeout<e},enumerable:!1,configurable:!0}),e.prototype.setExpired=function(){this._expirationTimeout=0},e.prototype._addNextLinkIfAvailable=function(e){this._nextLink&&(e.nextLink=this._nextLink)},e.prototype._addServerRowCountIfAvailable=function(e){null==this._serverRowCount||isNaN(this._serverRowCount)||(e.serverRowCount=this._serverRowCount)},e.prototype._addServerRowLimitExceededIfAvailable=function(e){null!=this._serverRowLimitExceeded&&"boolean"==typeof this._serverRowLimitExceeded&&(e.serverRowLimitExceeded=this._serverRowLimitExceeded)},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"CachedQueryDataRequest",(function(){return o}));var n,a=r(0);!function(e){e[e.Started=0]="Started",e[e.Completed=1]="Completed",e[e.CompletedWithErrors=2]="CompletedWithErrors"}(n||(n={}));var o=function(){function e(){this._reset()}return e.prototype._reset=function(){this._status=n.Started,this._request=Object(a.createCompletablePromise)()},e.prototype.resetIfCompleted=function(){this.completed&&this._reset()},Object.defineProperty(e.prototype,"completed",{get:function(){return this._status===n.Completed||this._status===n.CompletedWithErrors},enumerable:!1,configurable:!0}),e.prototype.complete=function(e){this._status=n.Completed,this._request.complete(e)},e.prototype.completeOnPromiseDone=function(e){var t=this;return e.then((function(e){t._status=n.Completed,t._request.complete(e)})).catch((function(e){t._status=n.CompletedWithErrors,t._request.error(e)})),this._request.promise},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"QueriedTableCore",(function(){return o}));var n=r(0),a=r(24),o=function(){function e(e,t,r,n){this._connector=e,this._dataSource=t,this._dataRuntime=r,this.cacheableQueryList=n,this.cacheableQuery=n[0],this._currentSkip=0}return Object.defineProperty(e.prototype,"queryOptions",{get:function(){return this.cacheableQuery.queryDefinition.queryOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._dataSource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataSourceName",{get:function(){return this._dataSource.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentSkip",{get:function(){return this._currentSkip},enumerable:!1,configurable:!0}),e.prototype.getPrimaryKey=function(e){return this._dataSource.getPrimaryKey(e)},e.prototype.tryGetPrimaryKey=function(e){return this._dataSource.tryGetPrimaryKey(e)},e.prototype.getResultCountAsync=function(e){var t=this,r=this._dataRuntime.startAsyncDataAction(),o=this._connector.value.getResultCountAsync(this.cacheableQuery.queryDefinition,e).catch((function(r){return Object(n.throwIfCanceled)(r),Object(a.reportConnectedDataReadOperationErrors)(r,e,t._dataRuntime),n.CoreLog.errorEx("QueriedTable.getResultCountAsync",{error:r}),null}));return Object(n.wrapWithFinally)(o,(function(){return t._dataRuntime.endAsyncDataAction(r)}))},e.prototype.getQueryKeyAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return e=this.dataSourceName,[4,this.cacheableQuery.getKeyAsync()];case 1:return[2,e+t.sent()]}}))}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ServerPager",(function(){return n}));var n=function(){function e(e,t,r){this._connector=e,this._previousResponse=t||{results:[]},this._cacheableQuery=r}return e.prototype.getNextResultFromServerAsync=function(t,r,n){return void 0===n&&(n=null),__awaiter(this,void 0,Promise,(function(){var a,o,i;return __generator(this,(function(s){switch(s.label){case 0:return this._previousResponse.leftovers&&this._previousResponse.leftovers.length>0?(a=this._previousResponse.leftovers,t>a.length?[4,this._getNextResultFromServerCoreAsync(t-a.length,r+a.length,n)]:[3,2]):[3,4];case 1:return(o=s.sent()).results=a.concat(o.results),this._previousResponse=o,[3,3];case 2:this._previousResponse=e._getNextResultFromLeftovers(this._previousResponse,t),s.label=3;case 3:return[3,6];case 4:return i=this,[4,this._getNextResultFromServerCoreAsync(t,r,n)];case 5:i._previousResponse=s.sent(),s.label=6;case 6:return[2,this._previousResponse]}}))}))},e.prototype._getNextResultFromServerCoreAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(n){return this._connector.value.isClientPageable?[2,this._connector.value.getRowsAsync(this._cacheableQuery.queryDefinition,r,{maxRowCount:e,skip:t})]:[2,this._getNextResultFromServerAsync(e,t,r)]}))}))},e.prototype._getNextResultFromServerAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n;return __generator(this,(function(a){switch(a.label){case 0:return Core.Utility.isString(this._previousResponse.nextLink)?[2,this._connector.value.getMoreRowsAsync(this._previousResponse,this._cacheableQuery.queryDefinition,e,r)]:[3,1];case 1:return 0!==t?[3,3]:[4,this._connector.value.getRowsAsync(this._cacheableQuery.queryDefinition,r)];case 2:return(n=a.sent()).leftovers=n.results.splice(e),[2,n];case 3:return[2,{results:[]}]}}))}))},e._getNextResultFromLeftovers=function(e,t){var r=__spreadArray([],e.leftovers,!0),n=r.splice(t);return{results:r,leftovers:n,nextLink:e.nextLink}},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"DataComponentDataSource",(function(){return i}));var n=r(39),a=r(19),o=r(13),i=function(e){function t(t,r,n,a,o,i,s,c,u,l,d){return e.call(this,t,r,c.name,n,a,o,i,s,c,u,l,new AppMagic.Data.NativeCdsMetadataProvider(s,t,a),d)||this}return __extends(t,e),Object.defineProperty(t.prototype,"dataset",{get:function(){return this._dataset},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underlyingEntityLogicalName",{get:function(){return this.primaryTable.logicalName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underlyingEntitySetName",{get:function(){return this.primaryTable.entitySetName},enumerable:!1,configurable:!0}),t.prototype._tryCreateListOfFilesToUpdate=function(e,t,r){return!0},t.prototype._tryCreateListOfAttachmentsToUpdate=function(e,t,r){return!0},t.prototype.submitCreateRow=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(n){switch(n.label){case 0:return[4,this.connector.createRowAsync(e,r)];case 1:return t=n.sent(),[2,Object(a.create)(t)]}}))}))},t.prototype.patchRowAsync=function(e,t,r){return void 0===r&&(r=null),__awaiter(this,void 0,Promise,(function(){var n;return __generator(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.connector.patchRowAsync(e,t,r)];case 1:return[2,a.sent()];case 2:return n=a.sent(),[2,this._convertErrorToErrorValue(n)];case 3:return[2]}}))}))},t.prototype._convertErrorToErrorValue=function(e){if(e instanceof o.ComponentDataError)return e.errorValue;throw e},t.prototype.removeRowAsync=function(e,t){return void 0===t&&(t=null),__awaiter(this,void 0,Promise,(function(){var r;return __generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.connector.deleteRowAsync(e,t)];case 1:return n.sent(),[2,!0];case 2:return r=n.sent(),[2,this._convertErrorToErrorValue(r)];case 3:return[2]}}))}))},t.prototype.createRowAsync=function(e,t){return void 0===t&&(t=null),__awaiter(this,void 0,Promise,(function(){var r;return __generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.connector.createRowAsync(e,t)];case 1:return[2,n.sent()];case 2:return r=n.sent(),[2,this._convertErrorToErrorValue(r)];case 3:return[2]}}))}))},t}(n.CdsDataSource)},function(e,t,r){"use strict";r.r(t),r.d(t,"ConnectedDataSourceLookupColumnReference",(function(){return d}));var n=r(0),a=r(16),o=r(8),i=r(13),s=r(24),c=AppMagic.Schema,u=AppMagic.Data.ColumnKind,l=AppMagic.Services,d=function(){function e(e,t,r,a,o,i){this._connector=e,this._column=t,this._dataRuntime=r,this._pendingPromises=new n.PromiseQueue("ConnectedDataSourceLookupColumnReference"),this._cacheProvider=a,this._dataSourceName=o,this._tableName=i}return Object.defineProperty(e.prototype,"supportsSearch",{get:function(){return this._column.lookupMetadata.supportsSearch},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"searchRequired",{get:function(){return this._column.lookupMetadata.searchRequired},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defaultDisplayFieldName",{get:function(){return this._getDefaultDisplayFieldName()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDisposed",{get:function(){return null===this._pendingPromises},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._pendingPromises.cancelAll(),this._connector=null,this._column=null,this._pendingPromises=null,this._dataRuntime=null,this._cacheProvider=null,this._dataSourceName=null,this._tableName=null},e.prototype._getDefaultDisplayFieldName=function(){return this._column.kind===u.Primitive?l.TypeSystem.TypesManager.ValueColumnName:this._column.getSchema().ptr[0].name},e.prototype.verifyDisplayFieldName=function(e,t){if(this._column.kind===u.Primitive)return e===l.TypeSystem.TypesManager.ValueColumnName;var r=this._column.getSchema();return!!c.containsSchemaMember(r,e)||(this._dataRuntime.reportRuntimeError(t,Object(n.CoreUtility_formatString)(AppMagic.Strings.LookupDisplayFieldInvalid_FieldName,e)),!1)},e.prototype.lookupItemsAsync=function(e,t,r,c){var u,l=this;return(null===(u=null==c?void 0:c.signal)||void 0===u?void 0:u.aborted)?Promise.reject(Object(n.createCanceledError)()):this._pendingPromises.pushJob((function(){var c=new a.LookupCacheableQuery({dataSourceName:l._dataSourceName,tableName:l._tableName,columnName:l._column.name,errorContext:t,sourceType:o.SourceType.LookupQueryDefinition,searchText:e,serviceFunctionName:l._column.lookupMetadata.serviceFunctionName});return l._cacheProvider.getDataAsync(l._connector,l._dataSourceName,c,t,r).then(null,(function(e){var r;Object(n.throwIfCanceled)(e),Object(s.reportConnectedDataReadOperationErrors)(e,t,l._dataRuntime),n.CoreLog.errorEx("ConnectedDataSourceLookupColumnReference.lookupItemsAsync",{error:e,message:"Call to searchAsync failed.",eventData:{errorKind:e.errorKind,isFatal:!(e instanceof i.TabularDataError)}});var a=e.serverError;(null==a?void 0:a.response)&&a.response.status>=400&&(r=AppMagic.Data.ErrorKind.Network);var o=AppMagic.Data.ErrorValue.isErrorHandlingFeatureEnabled()?Object(i.tryConvertErrorToErrorValue)(t,e,AppMagic.Strings.NetworkErrorDetails,null,r):null;return Promise.resolve(o)}))}),c)},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ConnectedDataTypesManager",(function(){return a}));r(0);var n=r(75),a=function(){function e(e){this._connectorManager=e}return e.prototype.addType=function(e,t,r){throw Error("Not Implemented exception.")},e.prototype.getType=function(e,t){var r=this._connectorManager.tryGet(t);if(!r)throw new n.RuntimeTypeError("Could not find the metadata for table ".concat(t," in the connector manager. The metadata likely has not been loaded yet."));if(!r.tableRowTypeRef)throw new n.RuntimeTypeError("Could not find type for target connector from table ".concat(t,". The connector should be a CdpConnector instance."));return r.tableRowTypeRef.getType()},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"MdlWebResourceDataLoader",(function(){return a}));var n=r(0),a=function(){function e(e){this._mdlclient=e}return e.prototype.getWebResourceResx=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,a;return __generator(this,(function(o){switch(o.label){case 0:t=Object(n.generate128BitUUID)(),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this._mdlclient.retrieveWebResourceResx(e,{requestId:t})];case 2:return(r=o.sent())||n.CoreLog.warning("MdlWebResourceDataLoader.getWebResourceResx","No webResource content retrieved from mdl for request id : ".concat(t)),[2,r];case 3:throw a=o.sent(),n.CoreLog.errorEx("MdlCdsMetadataProvider.getWebResourceResx",{error:a,message:"Failed to retrieve resx from MDL: entityLogicalName :".concat(e),eventData:{MdlMetadataClientRequestId:t}}),a;case 4:return[2]}}))}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"CacheDataChangeManager",(function(){return n}));var n=function(){function e(e){void 0===e&&(e=!1),this._connectedDataSourceDataChanged=new EventObject,this._onDataChangedList=HashTableUtility.create(),this._isEnabled=e}return Object.defineProperty(e.prototype,"onDataChanged",{get:function(){return this._connectedDataSourceDataChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEnabled",{set:function(e){this._isEnabled=e},enumerable:!1,configurable:!0}),e.prototype.register=function(e,t,r){if(this._isEnabled&&!(e.length<=0)){var n=r?r.id:"",a="".concat(t,"_").concat(n);this._onDataChangedList[a]={queryKey:e,ruleName:t,bindingContext:r}}},e.prototype.runRuleFn=function(e,t){if(this._isEnabled){var r=[];for(var n in HashTableUtility.forEach(this._onDataChangedList,(function(n,a){var o=n.ruleName.lastIndexOf("."),i=n.ruleName.substring(0,o),s=n.bindingContext.controlContexts[i];!s||s.disposed?r.push(a):n.queryKey===e&&(Core.Log.verbose("[LongLivingCache] {0}: evalResult[{1}]({2})",e,n.ruleName,n.bindingContext?n.bindingContext.id:""),t(n.ruleName,n.bindingContext))})),r)delete this._onDataChangedList[r[n]]}},e.prototype.notifyDataChanged=function(e){this._isEnabled&&this._connectedDataSourceDataChanged.dispatch({queryKey:e})},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"DynamicJsonSchemaTTypeManager",(function(){return n}));var n=function(){function e(){this._dynamicTTypeList=HashTableUtility.create()}return e.prototype.setTType=function(e,t){this._dynamicTTypeList[e]=t},e.prototype.getTType=function(e){return this._dynamicTTypeList[e]},e.prototype.clearTType=function(e){return delete this._dynamicTTypeList[e]},e.prototype.clear=function(){this._dynamicTTypeList=HashTableUtility.create()},e.prototype.generateControlDynamicKey=function(e,t){return e+"_"+t},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"addMetadata",(function(){return a}));var n=r(11);r(4);function a(e,t){var r={name:t,pluginType:AppMagic.Constants.DataConnections.Types.Excel};Object(n.setMeta)(e,r)}},function(e,t,r){"use strict";r.r(t),r.d(t,"GetVariablesCommandHandler",(function(){return n}));r(0);var n=function(){function e(e){this._runtime=e}return Object.defineProperty(e.prototype,"command",{get:function(){return"GetVariables"},enumerable:!1,configurable:!0}),e.prototype.execute=function(e,t){t(this._runtime.getVariableValuesJson())},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"Beta3XmlParsingStrategy",(function(){return o}));var n=r(1),a=r(7),o=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.parse=function(t){return this._schema=t.schema,this._stack.push({schema:this._schema.tableSchema}),e.prototype.parse.call(this,t)},t.prototype.onOpenTag=function(e){if(e.name!==a.tagApplicationData){var t=this._schema[this._schemaIdx++];this._schemaStack.push(t);var r=t.type;if(t.tag!==e.name)throw new Error("Unsupported format. XML Tag does not match node name.");this._stack.push(e.name),this._stack.push(r),e.isSelfClosing?"string"===r?this._stack.push(""):this._stack.push(null):"array"===r?this._stack.push([]):"object"===r&&this._stack.push(new Object)}},t.prototype.onCloseTag=function(e){if(e!==a.tagApplicationData){if(this._stack.length<4)throw new Error("Unsupported format. Invalid data cell.");var t=this._stack.pop(),r=this._stack.pop(),o=this._stack.pop(),i=this._stack[this._stack.length-1];if(Core.Utility.isUndefined(t)||!Core.Utility.isString(r)||!Core.Utility.isString(o)||!Core.Utility.isObject(i)&&!Core.Utility.isArray(i))throw new Error("Unsupported format. Invalid data cell.");var s=this._schemaStack.pop(),c=e===a.tagRow,u=e===a.tagEntityMetadata;if(c)switch(s.kind){case"row":i.push(t);break;case"record":this._stack.push(t);break;case"header":break;case"null":i.push(null);break;default:throw new Error("Unsupported format. Invalid type information.")}else if(u){var l=new n.LogReporter,d=t,p=Object(n.tryDeserializeDataEntityMetadata)(d,l);l.flushErrors(),p&&Object(n.makeEntityRecord)(i,p)}else if(0===this._schemaStack.length)i[o]=this._convert(t,r);else{var f=o,y=this._schemaStack[this._schemaStack.length-1];if("header"!==y.kind&&(f=y.columnMap[o],!Core.Utility.isString(f)))throw new Error("Unsupported format. Invalid type information.");i[f]=this._convert(t,r)}}},t.prototype._convert=function(e,t){switch(t){case"string":var r=e;return decodeURIComponent(r);case"number":r=e;var n=parseFloat(r);if(Core.Utility.isFiniteNumber(n))return n;throw new Error("Unsupported format. Invalid numeric value.");case"boolean":if("true"===(r=e))return!0;if("false"===r)return!1;throw new Error("Unsupported format. Invalid boolean value.");case"array":return null===e?[]:e;case"object":return e;default:throw new Error("Unsupported format. Invalid data type.")}},t}(r(122).XmlParsingStrategyBase)},function(e,t,r){"use strict";r.r(t),r.d(t,"XmlParsingStrategyBase",(function(){return n}));var n=function(){function e(e){this._resourceUritoBlobMap=e,this._stack=[],this._schemaStack=[],this._schemaIdx=0,this._strict=!0}return e.prototype.parse=function(e){var t=sax.parser(this._strict,{trim:!0,normalize:!0,xmlns:!0,position:!0});return t.onerror=this._onError.bind(this),t.onopentag=this.onOpenTag.bind(this),t.ontext=this._onText.bind(this),t.onclosetag=this.onCloseTag.bind(this),t.onend=this._onEnd.bind(this),t.write(e.xml).close(),this._stack.pop()},e.prototype._onError=function(e){throw new Error(e.message)},e.prototype.onOpenTag=function(e){},e.prototype.onCloseTag=function(e){},e.prototype._onText=function(e){/^ms-appdata:/g.test(e)||/^ms-appx:/g.test(e)?this._stack.push(this._resourceUritoBlobMap[e]):this._stack.push(e)},e.prototype._onEnd=function(){if(1!==this._stack.length)throw new Error("Unsupported format.")},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"DynamicResourceAuthenticationProvider",(function(){return o}));var n=AppMagic.Services.AuthenticationProvider,a=AppMagic.Services.HttpConstants,o=function(e){function t(t,r){var n=e.call(this)||this;return n._resourceIdLazy=new Core.Lazy((function(){var e=t();if(!e)throw new Error("The resource id has not been setup for this app correctly.");return e})),n._authenticationService=r,n}return __extends(t,e),t.prototype.authenticateCoreAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this._authenticateAndGetTokenAsync()];case 1:return e.sent(),[2]}}))}))},t.prototype.authenticateRequestCoreAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return[4,this._authenticateAndGetTokenAsync()];case 1:return t=r.sent(),e.addHeader(a.HeaderName.Authorization,AppMagic.Services.Authentication.AppHttpClient.formatDynamicAccessTokenAuthorizationHeader(t)),[2]}}))}))},t.prototype._isValidAccessToken=function(e){return!(!e||!e.accessToken)&&("dynamicauth"===e.tokenType||"mer"===e.tokenType)},t.prototype._authenticateAndGetTokenAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e,t,r;return __generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),e={resourceName:"dynamic",resourceId:this._resourceIdLazy.value},[4,this._authenticationService.getAccessTokenForResourceAsync(e)];case 1:if(t=n.sent(),!this._isValidAccessToken(t))throw new Error("Invalid access token received from authentication service.");return[2,t.accessToken];case 2:throw r=n.sent(),Core.PromiseUtils.throwIfCanceled(r),Core.Log.error("DynamicResourceAuthenticationProvider._getAccessToken",r),new Error(AppMagic.Strings.DynamicResourceUnauthorizedAccess);case 3:return[2]}}))}))},t}(n)},function(e,t,r){"use strict";r.r(t),r.d(t,"UserDefinedFunctionNamespace",(function(){return o}));var n=r(81),a=r(53),o=function(){function e(e){this._namespaceName=e,this._functionsByName=HashTableUtility.create()}return e.prototype.addOrReplace=function(e,t){var r=new n.UserDefinedFunction(t);return this._functionsByName[e]=r,r},e.prototype.deleteFunction=function(e){this._functionsByName[e]&&delete this._functionsByName[e]},e.prototype.getFunction=function(e,t){void 0===t&&(t=!0);var r=this._functionsByName[e];if(!r&&t)throw new a.NamedObjectNotFoundError(e);return r},e.prototype.getAllFunctionNames=function(){return new Set(Object.keys(this._functionsByName))},e.prototype.dispose=function(){var e=this;HashTableUtility.forEach(this._functionsByName,(function(t,r){t.dispose(),e.deleteFunction(r)}))},e}()},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.parseNumber=t.parseToRawType=t.parseDateToISO=t.parseTime=t.parseDateTime=t.parseDate=void 0;var o=r(219),i=r(224),s=r(225);t.parseToRawType=function(e,r,n){var a;switch(r.Type){case s.AttributeType.BigInt:case s.AttributeType.Decimal:case s.AttributeType.Double:case s.AttributeType.Integer:return c(e,n);case s.AttributeType.Date:case s.AttributeType.DateTime:return t.parseDateToISO(e,n);case s.AttributeType.String:switch(null===(a=r)||void 0===a?void 0:a.Format){case"Url":return y(e);default:return u(e)}default:return e}};var c=function(e,t,r){if("number"==typeof e)return e;if("string"==typeof e){if(!t||!r){var n=function(e){return""!==e&&e.indexOf(" ")<0&&isFinite(Number(e))?Number(e):NaN}(e);if(!isNaN(n))return n}if(t){var a=i.parseNumberWithGroupAndDecimal(e,t.numberFormat.NumberGroupSeparator,t.numberFormat.NumberDecimalSeparator);if(a&&!isNaN(a))return a}}return null};t.parseNumber=c;var u=function(e){return"string"!=typeof e?null:e};function l(e){if("string"==typeof e){var t=Date.parse(e);if(!isNaN(t)){var r=new Date(t);if(r.toISOString()===e)return r}}return null}t.parseDate=function(e,t){if(e&&"object"==typeof e&&"toISOString"in e)return e;var r=l(e);if(r)return r;if("string"==typeof e&&t){var n=function(e,t){var r,n,o=t.dateTimeFormat.ShortDatePattern,i=[];["/","-",".",". "].forEach((function(e){return i.push(p(o,e))}));try{for(var s=a(i),c=s.next();!c.done;c=s.next()){var u=c.value,l=d(e,u,t);if(l)return l}}catch(e){r={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return null}(e,t);if(n)return n;var o=d(e,null==t?void 0:t.dateTimeFormat.LongDatePattern,t);return o||null}return null};t.parseDateTime=function(e,t){if(e&&"object"==typeof e&&"toISOString"in e)return e;var r=l(e);if(r)return r;if("string"==typeof e&&t){var n=function(e,t,r){var n,o,i=[],s=["/","-",".",". "],c=[":","."];c.forEach((function(e){return i.push(f(t,e))})),s.forEach((function(e){return i.push(p(t,e))})),s.forEach((function(e){var r=p(t,e);c.forEach((function(e){return i.push(f(r,e))}))}));try{for(var u=a(i),l=u.next();!l.done;l=u.next()){var y=l.value,g=d(e,y,r);if(g)return g}}catch(e){n={error:e}}finally{try{l&&!l.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}return null}(e,t.dateTimeFormat.ShortDatePattern+" "+t.dateTimeFormat.ShortTimePattern,t);if(n)return n;var o=d(e,t.dateTimeFormat.FullDateTimePattern,t);return o||null}return null};t.parseTime=function(e,t){var r,n;if("string"==typeof e&&t){var o=[t.dateTimeFormat.ShortTimePattern,t.dateTimeFormat.LongTimePattern,f(t.dateTimeFormat.ShortTimePattern,"."),f(t.dateTimeFormat.LongTimePattern,".")];try{for(var i=a(o),s=i.next();!s.done;s=i.next()){var c=d(e,s.value,t);if(c)return c}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}}return null};function d(e,t,r){return o.parseDateTimeString(e,t,n({name:"name"},r))}function p(e,t){return e.replace(new RegExp("/","g"),t)}function f(e,t){return e.replace(new RegExp(":","g"),t)}t.parseDateToISO=function(e,r){var n=t.parseDate(e,r);return n?n.toISOString():null};var y=function(e){if(!u(e))return null;var t=e;if(t){new RegExp("^((http|https|ftp|ftps)://)|^(tel:|onenote:)|^/").test(t.toLowerCase())||""===t||(t="https://".concat(t))}return t}},function(e,t,r){},function(e,t,r){},function(e,t,r){"use strict";r.r(t),r.d(t,"AsyncUserResponse",(function(){return a})),r.d(t,"UserResponseStatus",(function(){return n}));var n,a=function(){function e(e,t){this._status=e,this._response=t||null}return Object.defineProperty(e.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"response",{get:function(){return this._response},enumerable:!1,configurable:!0}),e}();!function(e){e[e.Failure=0]="Failure",e[e.Success=1]="Success",e[e.EmptyUserInput=2]="EmptyUserInput",e[e.UserCancelled=3]="UserCancelled"}(n||(n={}))},function(e,t,r){"use strict";r.r(t),r.d(t,"serializeData",(function(){return n})),r.d(t,"deserializeData",(function(){return a}));r(0);function n(e){return AppMagic.Utility.jsonClone(e)}function a(e){return AppMagic.Utility.jsonClone(e)}},function(e,t,r){"use strict";r.r(t),r.d(t,"getDataSourceAttributeAsync",(function(){return l})),r.d(t,"getDataSourceColumnAttributeAsync",(function(){return p}));var n,a,o=r(0),i=r(1),s=r(12),c=r(15),u=AppMagic.Data;function l(e,t){return __awaiter(this,void 0,Promise,(function(){var r;return __generator(this,(function(n){switch(n.label){case 0:switch(t){case s.EditPermission:return[3,1];case s.CreatePermission:return[3,3];case s.DeletePermission:return[3,5];case s.ReadPermission:return[3,7];case s.DisplayName:return[3,9]}return[3,10];case 1:return[4,e.canUserEditAsync];case 2:return[2,n.sent()];case 3:return[4,e.canUserCreateAsync];case 4:return[2,n.sent()];case 5:return[4,e.canUserDeleteAsync];case 6:return[2,n.sent()];case 7:return[4,e.canUserReadAsync];case 8:return[2,n.sent()];case 9:return[2,(r=e.tryGetTableMetadata())?r.displayName:null];case 10:return[2,null]}}))}))}function d(e){var t,r=this,o=null===(t=AppMagic.CDS)||void 0===t?void 0:t.columnNames;return o?a=new Promise((function(t){return __awaiter(r,void 0,void 0,(function(){return __generator(this,(function(r){switch(r.label){case 0:return[4,e.retrieveAllColumnLocalizationInformationAsync(o)];case 1:return n=r.sent(),t(),[2]}}))}))})):(n={},Promise.resolve())}function p(e,t,r){var l,p;return __awaiter(this,void 0,Promise,(function(){var f,y,g,h,m,v,b;return __generator(this,(function(_){switch(_.label){case 0:switch(f=e.tryGetTableMetadata(),y=null!==f?f.tryGetColumn(r):null,g=null!==y?y.constraints:null,t){case s.Required:return[3,1];case s.MaxLength:return[3,2];case s.MinLength:return[3,3];case s.MaxValue:return[3,4];case s.MinValue:return[3,5];case s.DisplayName:return[3,6];case s.AllowedValues:return[3,12]}return[3,13];case 1:return[2,null!==g&&!g.isNullable];case 2:return null!==g&&g instanceof i.StringColumnConstraints?[2,g.maxLength]:[2,null];case 3:return null!==g&&g instanceof i.StringColumnConstraints?[2,g.minLength]:[2,null];case 4:return null!==g&&g instanceof i.NumericColumnConstraints?[2,g.max]:[2,null];case 5:return null!==g&&g instanceof i.NumericColumnConstraints?[2,g.min]:[2,null];case 6:return e.kind===u.DataSourceKind.CdsNativeDataSource&&o.FeatureGates_language.enableCdsLocalization?(h=e,n?[3,10]:a?[4,a]:[3,8]):[3,11];case 7:return _.sent(),[3,10];case 8:return[4,d(h)];case 9:_.sent(),_.label=10;case 10:return m=Core.Globalization.currentCulture().currentLocaleName,v="",(null===(p=null===(l=n[m])||void 0===l?void 0:l[h.logicalName])||void 0===p?void 0:p[r])&&(v=n[m][h.logicalName][r]),[2,v||(null===y?r:y.extendedMetadata.displayName)];case 11:return[2,null===y?r:y.extendedMetadata.displayName];case 12:return null!==y&&y.extendedMetadata.hasAllowedValues?[2,(b=Object(c.getLanguageRuntime)()).makeColumn(y.extendedMetadata.allowedValues,b.generateId())]:[2,null];case 13:return[2,null]}}))}))}},function(e,t,r){"use strict";r.r(t),r.d(t,"AppresDataSourcesUriResolver",(function(){return i}));var n=r(0),a=r(1),o=AppMagic.Common.Media,i=function(){function e(e,t){this._datasourceResolver=e,this._mediaRuntime=t}return e.prototype.canResolveUri=function(e){return e.scheme===a.Scheme&&e.host===a.Hosts.DataSources},e.prototype._getDownloadedMediaUri=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r;return __generator(this,(function(i){switch(i.label){case 0:if(t=e.getSegment(a.SegmentIndexes.DataSourceName),!Object(n.isNonEmptyString)(t))throw new o.MediaResourceError("Invalid mediaUri; missing a datasource name.");if(!(r=this._datasourceResolver.tryGetDataSource(t)))throw new o.MediaResourceError("App datasource with name '".concat(t,"' could not be found."));return[4,r.downloadMediaResourceAsync(e)];case 1:return[2,i.sent()]}}))}))},e.prototype.createReferenceAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return[4,this._getDownloadedMediaUri(e)];case 1:return t=r.sent(),[4,this._mediaRuntime.createMediaReferenceAsync(t)];case 2:return[2,r.sent()]}}))}))},e.prototype.getAsBinaryAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return[4,this._getDownloadedMediaUri(e)];case 1:return t=r.sent(),[4,this._mediaRuntime.getMediaAsBinaryAsync(t)];case 2:return[2,r.sent()]}}))}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"AppresResourceUriResolver",(function(){return c}));var n=r(0),a=r(1),o=r(45),i=r(51),s=AppMagic.Common.Media,c=function(){function e(e){this._resourceResolver=e}return e.prototype.canResolveUri=function(e){return e.scheme===a.Scheme&&e.host===a.Hosts.Resources},e.prototype._getAssetLocalUrlAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r;return __generator(this,(function(o){switch(o.label){case 0:if(t=e.getSegment(a.SegmentIndexes.ResourceName),!Object(n.isNonEmptyString)(t))throw new s.MediaResourceError("Invalid resource.");return[4,this._resourceResolver.tryGetResourceLocalUrlAsync(t)];case 1:if(!(r=o.sent()))throw new s.MediaResourceError("App Resource entity with name '".concat(t,"' could not be found."));return[2,r]}}))}))},e.prototype.createReferenceAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return[4,this._getAssetLocalUrlAsync(e)];case 1:return t=r.sent(),[2,Object(o.createPassThrough)(t)]}}))}))},e.prototype.getAsBinaryAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r;return __generator(this,(function(a){switch(a.label){case 0:return[4,this._getAssetLocalUrlAsync(e)];case 1:return t=a.sent(),[4,Object(i.getAsBlobViaNativeXhrAsync)(t)];case 2:return[2,(r=a.sent())?n.PABinary.createFromBlob(r):null]}}))}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"Action",(function(){return n})),r.d(t,"Function",(function(){return a}));var n=0,a=1},function(e,t,r){"use strict";r.r(t),r.d(t,"hasOrganizationSettingsAsync",(function(){return a})),r.d(t,"getOrganizationSettingsAsync",(function(){return o}));var n=r(39);function a(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,i(AppMagic.Services.OrganizationSettingsConstants.OrganizationsDataSourceName)];case 1:return[2,!!e.sent()]}}))}))}function o(e){return __awaiter(this,void 0,Promise,(function(){var t,r,n;return __generator(this,(function(a){switch(a.label){case 0:return[4,s(AppMagic.Services.OrganizationSettingsConstants.OrganizationsDataSourceName)];case 1:return t=a.sent(),[4,t.getOrganizationSettingsAsync(e,"organizations")];case 2:return r=a.sent(),(n=r.response.value[0])?[2,e.reduce((function(e,t){return e[t]=n[t],e}),{})]:[2,{}]}}))}))}function i(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return[4,Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.CurrentAppInstanceFunctionSingletonKey)().dataSources.tryGetDatasourceAsync(e)];case 1:return(t=r.sent())instanceof n.CdsDataSource?[2,t.connector]:[2,null]}}))}))}function s(e){return __awaiter(this,void 0,Promise,(function(){var t,r;return __generator(this,(function(n){switch(n.label){case 0:return[4,i(e)];case 1:if(!(t=n.sent()))throw r="Error while retrieving connector, no datasource named ".concat(e," was created"),Core.Log.errorEx("OrganizationSettingsClient._getCdsConnector",r),new Error(r);return[2,t]}}))}))}},function(e,t,r){"use strict";var n;r.r(t),r.d(t,"NumberedNameGeneratorOptions",(function(){return n})),r.d(t,"NumberedNameGenerator",(function(){return a})),function(e){e[e.none=0]="none",e[e.includeBaseName=2]="includeBaseName"}(n||(n={}));var a=function(){function e(){}return e.create=function(t,r,a){if(Contracts.checkString(t),Contracts.checkNumber(r),Contracts.checkFunction(a),r&n.includeBaseName&&a(t))return t;var o=1,i=/^.*_(\d+)$/.exec(t);i&&((o=parseInt(i[1],10))<=e.maximumSeed?t=t.substr(0,t.length-i[1].length-1):o=1);var s=null;do{s=Core.Utility.formatString(AppMagic.Strings.NumberedNameGenerator_NameFormat,t,o),o++}while(!a(s));return s},e.maximumSeed=1e3,e}()},function(e,t,r){"use strict";function n(e,t,r){var n=e,a=/[.\\+*?\[\^\]$(){}=!<>|:\-]/,o=t.split("").map((function(e){return e.replace(a,"\\$&")})).join("|");return o="("+o+")",n=n.replace(new RegExp(o,"g"),(function(e){return r+e}))}function a(e,t){return e.replace(/{{|}}|{(\d+)}/g,(function(e,r){if("{{"===e)return"{";if("}}"===e)return"}";var n=parseInt(r,10);Contracts.check(n>=0&&n<t.length,"The format item {"+n+"} has not been provided an argument in the 'args' parameter.");var a=t[n];return null==a?"":(Contracts.checkPrimitiveType(a,"dotNetStringFormat_format_args can only convert from primitive value types."),a.toString())}))}r.r(t),r.d(t,"escapeCharacters",(function(){return n})),r.d(t,"dotNetStringFormat_format_args",(function(){return a}))},function(e,t,r){"use strict";r.r(t),r.d(t,"AppCommander",(function(){return n}));var n=function(){function e(e){this._appToHostCommandExecutor=e,this._hostToAppCommands=HashTableUtility.create(),this._appToHostCommands=HashTableUtility.create()}return e.prototype.createHostToAppCommandRegisterer=function(e){var t=this;return{register:function(r){var n={execute:r};t._hostToAppCommands[e]=n}}},e.prototype.tryGetHostToAppCommand=function(e){return this._hostToAppCommands[e]||null},e.prototype.getAppToHostCommand=function(e){var t=this,r=this._appToHostCommands[e];return r||(r={executeAsync:function(r){return t._appToHostCommandExecutor.executeAppToHostCommandAsync(e,r)}},this._appToHostCommands[e]=r),r},e}()},function(e,t,r){"use strict";function n(e){var t,r;return(null===(t=null==e?void 0:e.capabilities)||void 0===t?void 0:t.indexOf("UseCordova"))>-1||!!(null==e?void 0:e.appHttpClient)&&Core.Utility.isNonEmptyString(null===(r=null==e?void 0:e.cdsConfig)||void 0===r?void 0:r.runtimeUrl)}function a(e){return!!e&&!!e.region&&!!e.logger&&Core.Utility.isObject(e.logger)}r.r(t),r.d(t,"isValid",(function(){return n})),r.d(t,"isTelemetryConfigValid",(function(){return a}))},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){"use strict";r.r(t),r.d(t,"LocalFileCache",(function(){return n}));var n=function(){function e(e){Contracts.checkValue(e),this._blobManager=e,this._fileToBlobMap=HashTableUtility.create()}return Object.defineProperty(e.prototype,"count",{get:function(){return Object.keys(this._fileToBlobMap).length},enumerable:!1,configurable:!0}),e.prototype.clear=function(){for(var e in this._fileToBlobMap)this.removeUrlEntry(e);this._fileToBlobMap=HashTableUtility.create()},e.prototype.removeUrlEntry=function(e){Contracts.checkString(e);try{var t=this._fileToBlobMap[e];t&&AppMagic.Utility.blobManager.release(t)&&delete this._fileToBlobMap[e]}catch(e){}},e.prototype.tryGetEntry=function(e){return Contracts.checkString(e),this._fileToBlobMap[e]||null},e.prototype.getEntries=function(){var e=[];for(var t in this._fileToBlobMap)e.push(t);return e},e.prototype.getOrCreateUrlFromBlob=function(e,t){Contracts.checkString(e),Contracts.checkValue(t);var r=this._fileToBlobMap[e];return r||(r=this._blobManager.addBlob(t),this._blobManager.addRef(r),this._fileToBlobMap[e]=r,r)},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"AuthenticationCache",(function(){return n}));r(0);var n=function(){function e(e){this._settings=e}return e.prototype.getToken=function(e,t){var r=this._getCachedTokens(),n=this._generateCacheKey(e,t);return void 0!==r[n]?r[n]:null},e.prototype.setToken=function(e,t,r){var n=this._getCachedTokens();n[this._generateCacheKey(e,t)]=r,this._settings.setValue("OAuthTokens",n)},e.prototype.removeToken=function(e,t){var r=this._getCachedTokens();delete r[this._generateCacheKey(e,t)],this._settings.setValue("OAuthTokens",r)},e.prototype.clearTokens=function(){this._settings.setValue("OAuthTokens",{})},e.prototype._getCachedTokens=function(){return this._settings.getValue("OAuthTokens")||{}},e.prototype._generateCacheKey=function(e,t){return[e.length.toString(),"+",t.length.toString(),"_",e,t].join("")},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"AppDatasetManager",(function(){return o}));var n=r(0),a=r(35),o=function(e){function t(t){var r=this;return(r=e.call(this,t,!0)||this)._datasetsTable=Object(n.HashTableUtility_create)(),r}return __extends(t,e),t.prototype.contains=function(e){return!!this._datasetsTable[e]},t.prototype.addDataset=function(e,t){Object(n.verbose)("AppDatasetManager: Adding dataset '".concat(e,"'")),this._datasetsTable[t.name]=t,this._addComponent(t)},t.prototype.getDataset=function(e){var t=this.tryGetDataset(e);if(!t)throw new a.AppDataSourceError({message:"Could not find dataset '".concat(e,"'. The data set was either deleted or unregistered.")});return t},t.prototype.tryGetDataset=function(e){return this._datasetsTable[e]||null},t.prototype.removeDataset=function(e){var t=this._datasetsTable[e];t&&(Object(n.verbose)("AppDatasetManager: Removing dataset '".concat(e,"'")),this._removeComponentByName(t.name),t.isLoaded&&t.unload(),t.dispose(),delete this._datasetsTable[e])},t}(AppMagic.Runtime.App.AppComponent)},function(e,t,r){"use strict";r.r(t),r.d(t,"AppDataSourcesManager",(function(){return s}));var n=r(0),a=r(83),o=r(84),i=r(60),s=function(e){function t(t,r){var a=e.call(this,t,!0)||this;return a._datasetManager=r,a._datasourceCreationPromises=new Map,a._dataSourceToDatasetMapping=Object(n.HashTableUtility_create)(),a._globalOnDataChangeDataFlowTasks=new n.AsyncTaskExecuter("globalOnDataChangeDataFlowTask"),a}return __extends(t,e),t.prototype.getDataSourceNames=function(){return Object(n.HashTableUtility_mapToArray)(this._dataSourceToDatasetMapping,(function(e,t){return t}))},t.prototype.registerGlobalOnDataChangeTask=function(e,t){this._globalOnDataChangeDataFlowTasks.registerTask(e,t)},t.prototype.unregisterGlobalOnDataChangeTask=function(e){this._globalOnDataChangeDataFlowTasks.unregisterTask(e)},t.prototype.getDataSources=function(){var e=[];return Object(n.HashTableUtility_forEach)(this._dataSourceToDatasetMapping,(function(t,r){e=e.concat(t.getDataSources())})),e},t.prototype.getCollectionDataSourceNames=function(){return this.getDataSources().filter((function(e){return i.CollectionDataSource.isCollectionDataSource(e)})).map((function(e){return e.name}))},t.prototype.contains=function(e){return!!this._dataSourceToDatasetMapping[e]},t.prototype.containsDataset=function(e){return this._datasetManager.contains(e)},t.prototype.tryGetDataSource=function(e){var t=this._dataSourceToDatasetMapping[e];return t?t.tryGetDataSource(e):null},t.prototype.addDataSource=function(e){var t=this._datasetManager.tryGetDataset(e.datasetName);return t||(t=new a.AppDataset(e.datasetName),this._datasetManager.addDataset(e.datasetName,t)),this._addDataSourceCore(e,t)},t.prototype.deleteDataSource=function(e){n.CoreLog.verbose("AppDataSources: deleting '{0}'.",e);var t=this._dataSourceToDatasetMapping[e];t&&(t.deleteDataSource(e),delete this._dataSourceToDatasetMapping[e],t.isEmpty()&&this._datasetManager.removeDataset(t.name))},t.prototype.addCdsDataSource=function(e,t){var r=this._datasetManager.tryGetDataset(e.datasetName);return r||(this._datasetManager.addDataset(e.datasetName,t),r=t),e.registerGlobalAsyncTaskExecuter(this._globalOnDataChangeDataFlowTasks),this._addDataSourceCore(e,r)},t.prototype.createCdsDataset=function(e,t){var r=new AppMagic.Services.TypeSystem.TypesManager,n=new o.CdsDataset(e,r,t);return this._datasetManager.addDataset(e,n),n},t.prototype.tryGetCdsDataset=function(e){var t=this._datasetManager.tryGetDataset(e);return t instanceof o.CdsDataset?t:null},t.prototype.registerDatasourceCreationPromises=function(e,t,r){var a=this;void 0===r&&(r=new AbortController),e.forEach((function(e){a._datasourceCreationPromises.set(e,{promise:t,abortController:r}),Object(n.wrapWithFinally)(a._datasourceCreationPromises.get(e).promise,(function(){a._datasourceCreationPromises.delete(e)})).catch((function(e){n.CoreLog.error("AppDataSourceManager.registerDatasourceCreationPromises",e)}))}))},t.prototype.tryGetDatasourceAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:r.label=1;case 1:return r.trys.push([1,4,,5]),this._datasourceCreationPromises.has(e)?[4,this._datasourceCreationPromises.get(e).promise]:[3,3];case 2:r.sent(),r.label=3;case 3:return[3,5];case 4:throw t=r.sent(),n.CoreLog.error("AppDataSourceManager.tryGetDatasourceAsync",t),t;case 5:return[2,this.tryGetDataSource(e)]}}))}))},t.prototype._addDataSourceCore=function(e,t){try{this._dataSourceToDatasetMapping[e.name]=t,t.addDataSource(e)}catch(t){throw n.CoreLog.errorEx("AppDataSourceManager._addDataSourceCore",{error:t}),delete this._dataSourceToDatasetMapping[e.name],t}},t.prototype._disposing=function(){var t=this;Object(n.HashTableUtility_forEach)(this._dataSourceToDatasetMapping,(function(e,r){delete t._dataSourceToDatasetMapping[r]})),this._datasourceCreationPromises.forEach((function(e,r){Object(n.abortPromise)(e.promise,e.abortController),t._datasourceCreationPromises.delete(r)})),e.prototype._disposing.call(this)},t}(AppMagic.Runtime.App.AppComponent)},function(e,t,r){"use strict";r.r(t),r.d(t,"MdlCdsMetadataProvider",(function(){return s}));var n,a=r(0),o=r(68),i=AppMagic.Services.SavedQueryType;!function(e){e.DataSourcePermissions="DataSourcePermissions",e.RecordPermissions="RecordPermissions",e.RetrieveEntity="RetrieveEntity",e.RetrieveViews="RetrieveViews",e.RetrieveLocalizedLabel="RetrieveLocalizedLabel"}(n||(n={}));var s=function(e){function t(t,r){var n=e.call(this)||this;return n.mdlMetadataClient=t,n.executeMetadataRequestProxy=r,n.shouldUseFunctionProxy=!t,n}return __extends(t,e),t.prototype.getOptionSetChoicesAsync=function(e,t,r){var o,i;return __awaiter(this,void 0,Promise,(function(){var s,c,u,l,d,p;return __generator(this,(function(f){switch(f.label){case 0:s=Object(a.generate128BitUUID)(),a.Log.trackActivityEvent("MdlCdsMetadataProvider.getOptionSetChoicesAsync",{MdlMetadataClientRequestId:s,message:"TableName :".concat(t," ColumnName :").concat(e)}),f.label=1;case 1:return f.trys.push([1,6,,7]),this.shouldUseFunctionProxy?[3,3]:[4,this.mdlMetadataClient.retrieveEntity(t,[e],{requestId:s})];case 2:return u=f.sent(),[3,5];case 3:return[4,this._executeFunctionViaProxy(n.RetrieveEntity,{entityLogicalName:t,attributes:[e]},{requestId:s})];case 4:u=f.sent(),f.label=5;case 5:return l=(c=u)&&(null===(o=c[e])||void 0===o?void 0:o.OptionSet),d=c&&(null===(i=c[e])||void 0===i?void 0:i.OptionSetType),[2,{results:l?this._mapCdsOptionSetToPAOptionChoices(l,d):[]}];case 6:throw p=f.sent(),a.CoreLog.errorEx("MdlCdsMetadataProvider.getOptionSetChoicesAsync",{error:p,message:"Failed to retrieve attribute from MDL: tableName :".concat(t," columnName :").concat(e," errorContextId:").concat(null==r?void 0:r.id),eventData:{MdlMetadataClientRequestId:s}}),p;case 7:return[2]}}))}))},t.prototype.getViewChoicesAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var o,s,c,u;return __generator(this,(function(l){switch(l.label){case 0:o=Object(a.generate128BitUUID)(),a.Log.trackActivityEvent("MdlCdsMetadataProvider.getViewChoicesAsync",{MdlMetadataClientRequestId:o,message:"EntityLogicalName :".concat(t," DatasourceName :").concat(e)}),l.label=1;case 1:return l.trys.push([1,6,,7]),this.shouldUseFunctionProxy?[3,3]:[4,this.mdlMetadataClient.retrieveViews({entityLogicalName:t,viewQueryTypes:[i.MAIN_APPLICATION_VIEW,i.ADVANCED_SEARCH,i.SUB_GRID,i.LOOKUP_VIEW]},{requestId:o})];case 2:return c=l.sent(),[3,5];case 3:return[4,this._executeFunctionViaProxy(n.RetrieveViews,{query:{entityLogicalName:t,viewQueryTypes:[i.MAIN_APPLICATION_VIEW,i.ADVANCED_SEARCH,i.SUB_GRID,i.LOOKUP_VIEW]}},{requestId:o})];case 4:c=l.sent(),l.label=5;case 5:return[2,{results:(s=c)?this._mapViewDescriptorToPAViews(s):[]}];case 6:throw u=l.sent(),a.CoreLog.errorEx("MdlCdsMetadataProvider.getViewChoicesAsync",{error:u,message:"Failed to retrieve view from MDL: entityLogicalName :".concat(t," datasourceName :").concat(e," errorContextId:").concat(null==r?void 0:r.id),eventData:{MdlMetadataClientRequestId:o}}),u;case 7:return[2]}}))}))},t.prototype.getUserPrivilegeForEntityAsync=function(e,t,r,o){return __awaiter(this,void 0,Promise,(function(){var i,s,c,u;return __generator(this,(function(l){switch(l.label){case 0:i=Object(a.generate128BitUUID)(),a.Log.trackActivityEvent("MdlCdsMetadataProvider.getUserPrivilegeForEntityAsync",{MdlMetadataClientRequestId:i,message:"entityLogicalName :".concat(e," privilegeType :").concat(t," privilegeDepth :").concat(r)}),l.label=1;case 1:return l.trys.push([1,6,,7]),this.shouldUseFunctionProxy?[3,3]:[4,this.mdlMetadataClient.getDataSourcePermissions(e,t,r,{requestId:i})];case 2:return c=l.sent(),[3,5];case 3:return[4,this._executeFunctionViaProxy(n.DataSourcePermissions,{entityLogicalName:e,privilegeType:t,privilegeDepth:r},{requestId:i})];case 4:c=l.sent(),l.label=5;case 5:return s=c,[2,Promise.resolve({results:[{value:s}]})];case 6:throw u=l.sent(),a.CoreLog.errorEx("MdlCdsMetadataProvider.getUserPrivilegeForEntityAsync",{error:u,message:"Failed to retrieve user privileges for entity from MDL: entityLogicalName :".concat(e," privilegeType :").concat(t," privilegeDepth :").concat(r," errorContextId:").concat(null==o?void 0:o.id),eventData:{MdlMetadataClientRequestId:i}}),u;case 7:return[2]}}))}))},t.prototype.getUserPrivilegeForRecordAsync=function(e,t,r,i){return __awaiter(this,void 0,Promise,(function(){var s,c,u,l;return __generator(this,(function(d){switch(d.label){case 0:s=Object(a.generate128BitUUID)(),a.Log.trackActivityEvent("MdlCdsMetadataProvider.getUserPrivilegeForRecordAsync",{MdlMetadataClientRequestId:s,message:"tableName :".concat(e," recordId :").concat(t," privilege :").concat(r," ")}),d.label=1;case 1:return d.trys.push([1,6,,7]),this.shouldUseFunctionProxy?[3,3]:[4,this.mdlMetadataClient.getRecordPermissions(e,t,o.RecordInfoEnumMap[r],{requestId:s})];case 2:return u=d.sent(),[3,5];case 3:return[4,this._executeFunctionViaProxy(n.RecordPermissions,{entityLogicalName:e,recordID:t,requestedAccess:o.RecordInfoEnumMap[r]},{requestId:s})];case 4:u=d.sent(),d.label=5;case 5:return c=u,[2,Promise.resolve({results:[{value:c}]})];case 6:throw l=d.sent(),a.CoreLog.errorEx("MdlCdsMetadataProvider.getUserPrivilegeForRecordAsync",{error:l,message:"Failed to retrieve user privileges for record from MDL: entityLogicalName :".concat(e," recordId :").concat(t," privilege :").concat(r," errorContextId:").concat(null==i?void 0:i.id),eventData:{MdlMetadataClientRequestId:s}}),l;case 7:return[2]}}))}))},t.prototype.getLocalizedDisplayNamesAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var r,o,i,s,c,u;return __generator(this,(function(l){switch(l.label){case 0:r=Object(a.generate128BitUUID)(),a.Log.trackActivityEvent("MdlCdsMetadataProvider.getLocalizedDisplayNamesAsync",{MdlMetadataClientRequestId:r,message:"tableName: ".concat(e," columnNames: ").concat(t.toString())}),l.label=1;case 1:return l.trys.push([1,6,,7]),o={},this.shouldUseFunctionProxy?[3,3]:[4,this.mdlMetadataClient.retrieveEntity(e,t,{requestId:r})];case 2:return s=l.sent(),[3,5];case 3:return[4,this._executeFunctionViaProxy(n.RetrieveEntity,{entityLogicalName:e,attributes:t},{requestId:r})];case 4:s=l.sent(),l.label=5;case 5:for(c in i=s)o[c]=i[c].DisplayName;return[2,{results:[{value:o}]}];case 6:throw u=l.sent(),a.CoreLog.errorEx("MdlCdsMetadataProvider.getLocalizedDisplayNamesAsync",{error:u,message:"Failed to retrieve localized display names for entityLogicalName: ".concat(e," and columnNames: ").concat(t.toString()),eventData:{MdlMetadataClientRequestId:r}}),u;case 7:return[2]}}))}))},t.prototype._executeFunctionViaProxy=function(e,t,r){return __awaiter(this,void 0,void 0,(function(){var n;return __generator(this,(function(a){switch(a.label){case 0:if(!this.executeMetadataRequestProxy)throw new Error("Metadata Executor Proxy not initialized");return[4,this.executeMetadataRequestProxy(e,t,r)];case 1:if((n=a.sent())instanceof Object)return[2,n.value];throw new Error("Metadata Executor Proxy did not return a value")}}))}))},t.prototype._mapCdsOptionSetToPAOptionChoices=function(e,t){var r=this,n=[];return e.forEach((function(e){var a={Value:{Id:r._getPAOptionSetId(t,e.Value),Value:e.Label}};n.push(a)})),n},t.prototype._getPAOptionSetId=function(e,t){return e===AppMagic.Services.OptionSetType.Boolean?0!==t:t},t.prototype._mapViewDescriptorToPAViews=function(e){var t=[];return e.sort((function(e,t){return e.title.localeCompare(t.title)})).forEach((function(e){var r={Value:{Id:e.viewId,Value:e.title,DoesNotSupportBinary:e.hasDistinct}};t.push(r)})),t},t}(a.Disposable)},function(e,t,r){"use strict";r.r(t),r.d(t,"NativeCdsMetadataProvider",(function(){return c}));var n=r(0),a=r(16),o=r(8),i=r(18),s=r(68),c=function(e){function t(t,r,a){var o=e.call(this)||this;return o._queryDataProvider=t,o._dataSourceName=r,o.track("_connector",a),o.track("_lazyOptionSetReadOnlyConnector",new n.Lazy((function(){return new i.ReadOnlyCdsNativeOptionSetConnector(o._connector)}))),o.track("_lazyViewsReadOnlyConnector",new n.Lazy((function(){return new i.ReadOnlyCdsNativeViewsConnector(o._connector)}))),o.track("_lazyUserEntityPrivilegeReadOnlyConnector",new n.Lazy((function(){return new i.ReadOnlyUserEntityPrivilegeConnector(o._connector)}))),o.track("_lazyUserRecordPrivilegeReadOnlyConnector",new n.Lazy((function(){return new i.ReadOnlyUserRecordPrivilegeConnector(o._connector)}))),o.track("_lazyLocalizedDisplayNameConnector",new n.Lazy((function(){return new i.ReadOnlyLocalizedDisplayNameConnector(o._connector)}))),o}return __extends(t,e),t.prototype.getViewChoicesAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var r;return __generator(this,(function(n){switch(n.label){case 0:return r={dataSourceName:e,sourceType:o.SourceType.CdsViewsQueryDefinition,tableName:t},[4,this._queryDataProvider.getDataAsync(this._lazyViewsReadOnlyConnector.value,e,new a.CdsViewsCacheableQuery(r),null)];case 1:return[2,n.sent()]}}))}))},t.prototype.getOptionSetChoicesAsync=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var n;return __generator(this,(function(i){switch(i.label){case 0:return n={columnName:e,dataSourceName:this._dataSourceName,sourceType:o.SourceType.CdsOptionSetQueryDefinition,tableName:t},[4,this._queryDataProvider.getDataAsync(this._lazyOptionSetReadOnlyConnector.value,this._dataSourceName,new a.CdsOptionSetCacheableQuery(n),r)];case 1:return[2,i.sent()]}}))}))},t.prototype.getUserPrivilegeForEntityAsync=function(e,t,r,n){var i;return __awaiter(this,void 0,Promise,(function(){var r,s,c;return __generator(this,(function(u){switch(u.label){case 0:return r=!0,s={dataSourceName:this._dataSourceName,sourceType:o.SourceType.CdsUserPrivilegeForEntityDefinition,privilegeName:t,tableName:e},[4,this._queryDataProvider.getDataAsync(this._lazyUserEntityPrivilegeReadOnlyConnector.value,this._dataSourceName,new a.CdsUserPrivilegeForEntityQuery(s),n)];case 1:return c=u.sent(),r=!!(null===(i=null==c?void 0:c.results[0])||void 0===i?void 0:i.value),[2,Promise.resolve({results:[{value:r}]})]}}))}))},t.prototype.getUserPrivilegeForRecordAsync=function(e,t,r,n){var i;return __awaiter(this,void 0,Promise,(function(){var c,u,l,d,p,f;return __generator(this,(function(y){switch(y.label){case 0:return c=!0,u=s.RecordInfoEnumMap,l={dataSourceName:this._dataSourceName,sourceType:o.SourceType.CdsUserPrivilegeForRecordDefinition,recordId:t,tableName:e},[4,this._queryDataProvider.getDataAsync(this._lazyUserRecordPrivilegeReadOnlyConnector.value,this._dataSourceName,new a.CdsUserPrivilegeForRecordQuery(l),n)];case 1:return d=y.sent(),p=null===(i=null==d?void 0:d.results[0])||void 0===i?void 0:i.AccessRights,(f=u[r])&&p&&(c=p.indexOf(f)>-1),[2,Promise.resolve({results:[{value:c}]})]}}))}))},t.prototype.getLocalizedDisplayNamesAsync=function(e,t,r){var n={dataSourceName:this._dataSourceName,tableName:e,sourceType:o.SourceType.CdsEntityDefinition,columnNames:t};return this._queryDataProvider.getDataAsync(this._lazyLocalizedDisplayNameConnector.value,this._dataSourceName,new a.CdsLocalizedDisplayNameQuery(n),r)},t}(n.Disposable)},function(e,t,r){"use strict";r.r(t),r.d(t,"MdlUserSettingsDataLoader",(function(){return a}));var n=r(0),a=function(){function e(e){this._mdlclient=e}return e.prototype.tryGetUserAndOrgSettingsMetadata=function(){var e=Object(n.generate128BitUUID)();try{var t=this._mdlclient.retrieveOrgAndUserSettings({requestId:e});return t||n.CoreLog.errorEx("MdlUserSettingsDataLoader.tryGetUserAndOrgSettingsMetadata","No user settings content retrieved from MDL for request id ".concat(e),{eventData:{MdlMetadataClientRequestId:e}}),t}catch(t){return n.CoreLog.errorEx("MdlUserSettingsDataLoader.tryGetUserAndOrgSettingsMetadata",{error:t,message:"Failed to retrieve user settings from MDL for request id ".concat(e),eventData:{MdlMetadataClientRequestId:e}}),null}},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"WebResourceDataLoader",(function(){return i}));var n=AppMagic.Services.HttpConstants,a=AppMagic.Services.PowerAppsHttpTelemetry,o=AppMagic.Services,i=function(){function e(e,t){this._authProvider=e,this._appInstance=t}return e.prototype._getInstanceUrl=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return[4,this._appInstance.appHostClient.getComponentConfigForWebResource(e)];case 1:if(!(t=r.sent()))throw Core.Log.error("WebResourceDataLoader._loadData","_getInstanceUrl failed as no config was received from databasereferences"),Error("getInstanceUrl failed as no config was received from databasereferences");return[2,t.runtimeUrl]}}))}))},e.prototype.getWebResourceResx=function(e,t){var r,n;return __awaiter(this,void 0,Promise,(function(){var a,o;return __generator(this,(function(i){switch(i.label){case 0:return[4,this.fetchWebResourceforLanguage(t,e)];case 1:if(a=i.sent(),(null===(r=null==a?void 0:a.value)||void 0===r?void 0:r.length)>0){if(o=null===(n=a.value[0])||void 0===n?void 0:n.contentjson)return[2,JSON.parse(o)];Core.Log.warning("WebResourceDataLoader.getWebResourceResx","No webResource content retrieved for name ".concat(e," and the language.").concat(t))}return[2]}}))}))},e.prototype.fetchWebResourceforLanguage=function(e,t){return __awaiter(this,void 0,void 0,(function(){var r,i,s,c,u,l;return __generator(this,(function(d){switch(d.label){case 0:return[4,this._getInstanceUrl(t)];case 1:return r=d.sent(),i=t,t.endsWith(".resx")||(i=t+"."+e+".resx"),s=r+"/api/data/v9.0/webresourceset?"+"$filter=(name%20eq%20'".concat(t,"'%20or%20name%20eq%20'").concat(i,"')%20and%20languagecode%20eq%20").concat(e,"%20&$select=displayname,contentjson,name"),c=HashTableUtility.create(),u={method:n.Method.GET,url:s,headers:c},[4,this._authProvider.authenticator.authenticateRequestAsync(u)];case 2:return d.sent(),o.appendCustomHeadersOptions(u,{addCustomHeaders:!0}),l=this._appInstance.appHttpClient,[4,a.sendHttpJsonResponseAsync(l,u,"getRsxAsync")];case 3:return[2,d.sent()]}}))}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"isValid",(function(){return a}));var n=r(0);function a(e){return Object(n.isArray)(e.results)&&Object(n.isNonEmptyStringOrUndefined)(e.nextLink)&&Object(n.isArrayOrUndefined)(e.leftovers)}},function(e,t,r){"use strict";r.r(t),r.d(t,"doesFilterEvaluateToFalse",(function(){return o}));r(0);var n=r(2),a=r(9);function o(e){var t;return void 0===e&&(e=null),(null===(t=null==e?void 0:e.filter)||void 0===t?void 0:t.operator)===n.FilterOperator.None&&e.filter.firstOperand.operandKind===a.OperandKind.Value&&!1===e.filter.firstOperand.value}},function(e,t,r){"use strict";r.r(t),r.d(t,"RuntimeDataManager",(function(){return i}));var n=r(117),a=r(118),o=r(62),i=function(e){function t(t){var r=e.call(this,t,!0)||this;return r._cacheDataChangeManager=new n.CacheDataChangeManager,r._dynamicJsonSchemaTTypeManager=new a.DynamicJsonSchemaTTypeManager,r._queryDataProvider=new o.CachedQueryDataProvider(r._cacheDataChangeManager),r}return __extends(t,e),Object.defineProperty(t.prototype,"cacheDataChangeManager",{get:function(){return this._cacheDataChangeManager},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"queryDataProvider",{get:function(){return this._queryDataProvider},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dynamicJsonSchemaTTypeManager",{get:function(){return this._dynamicJsonSchemaTTypeManager},enumerable:!1,configurable:!0}),t}(AppMagic.Runtime.App.AppComponent)},function(e,t,r){"use strict";r.r(t),r.d(t,"DataSourceSetupState",(function(){return n}));var n=function(){function e(){}return e.Unready="unready",e.Ready="ready",e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"DefaultDateProvider",(function(){return n}));var n=function(){function e(){}return e.prototype.toUTCString=function(){return(new Date).toUTCString()},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"addParameters",(function(){return o}));var n=r(1),a=AppMagic.Services;function o(e,t){Core.Diagnostics.isEnabled()&&t&&(e[n.DiagnosticsContextParameterName]=new a.PrimitiveDArgument(JSON.stringify(t)))}},function(e,t,r){"use strict";r.r(t),r.d(t,"AccelerationDataSource",(function(){return n}));r(0);var n=function(){function e(e,t){var r=this;this._isEnabled=!1,this._x=null,this._y=null,this._z=null,this._accelerationProfile=e,t||(t=function(e){var t=AppMagic.Strings&&AppMagic.Strings.AccelerationDataSourceName?AppMagic.Strings.AccelerationDataSourceName:"Acceleration";AppMagic.AuthoringTool.Runtime.updateDynamicDatasource(t,e)}),this._updateDataFn=function(e){t(e),r._x=e.X,r._y=e.Y,r._z=e.Z}}return Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this._isEnabled},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(){this._isEnabled=!0,this._accelerationProfile.subscribe(this._updateDataFn.bind(this))},e.prototype.unSubscribe=function(){this._isEnabled=!1,this._accelerationProfile.unsubscribe()},e.prototype.getData=function(){var e=this._accelerationProfile.getData(this._x,this._y,this._z);return this._updateDataFn(e),e},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"CordovaAccelerationProfile",(function(){return a}));r(0);var n=r(70),a=function(){function e(){this._accelerometer=navigator.accelerometer,this._watchID=null,this._updateDataFn=null}return e.prototype.subscribe=function(e){if(this._updateDataFn=e,null!==navigator.accelerometer){this._watchID=navigator.accelerometer.watchAcceleration(this._accelerometerSuccess.bind(this),this._accelerometerError.bind(this),{frequency:500})}},e.prototype.unsubscribe=function(){null!==navigator.accelerometer&&(navigator.accelerometer.clearWatch(this._watchID),this._watchID=null)},e.prototype.getData=function(e,t,r){return Object(n.create)(e,t,r)},e.prototype._accelerometerSuccess=function(e){var t=Object(n.create)(e.x,e.y,e.z);this._updateDataFn(t)},e.prototype._accelerometerError=function(){var e=Object(n.create)(null,null,null);this._updateDataFn(e)},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"NullAccelerationDataSource",(function(){return a}));r(0);var n=r(70),a=function(){function e(){this._isEnabled=!1}return Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this._isEnabled},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(){this._isEnabled=!0},e.prototype.unSubscribe=function(){this._isEnabled=!1},e.prototype.getData=function(e){var t=Object(n.create)(null,null,null),r=AppMagic.Strings&&AppMagic.Strings.AccelerationDataSourceName?AppMagic.Strings.AccelerationDataSourceName:"Acceleration";return AppMagic.AuthoringTool.Runtime.updateDynamicDatasource(r,t),t},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"CompassDataSource",(function(){return n}));r(0);var n=function(){function e(e,t){var r=this;this._heading=null,this._compassProfile=e,t||(t=function(e){var t=AppMagic.Strings&&AppMagic.Strings.CompassDataSourceName?AppMagic.Strings.CompassDataSourceName:"Compass";AppMagic.AuthoringTool.Runtime.updateDynamicDatasource(t,e)}),this._updateDataFn=function(e){t(e),r._heading=e.Heading}}return Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this._isEnabled},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(){this._isEnabled=!0,this._compassProfile.subscribe(this._updateDataFn.bind(this))},e.prototype.unSubscribe=function(){this._isEnabled=!1,this._compassProfile.unsubscribe()},e.prototype.getData=function(){var e=this._compassProfile.getData(this._heading);return this._updateDataFn(e),e},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"CordovaCompassProfile",(function(){return a}));r(0);var n=r(78),a=function(){function e(){this._watchID=null,this._updateDataFn=null}return e.prototype.subscribe=function(e){if(navigator.compass){this._updateDataFn=e;this._watchID=navigator.compass.watchHeading(this._compassSuccess.bind(this),this._compassError.bind(this),{frequency:500})}},e.prototype.unsubscribe=function(){null!==navigator.compass&&void 0!==navigator.compass&&(navigator.compass.clearWatch(this._watchID),this._watchID=null)},e.prototype.getData=function(e){return Object(n.create)(e)},e.prototype._compassSuccess=function(e){var t=this.getData(e.trueHeading?e.trueHeading:e.magneticHeading);this._updateDataFn(t)},e.prototype._compassError=function(){var e=Object(n.create)(null);this._updateDataFn(e)},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"NullCompassDataSource",(function(){return a}));r(0);var n=r(78),a=function(){function e(){this._isEnabled=!1}return Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this._isEnabled},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(){this._isEnabled=!0},e.prototype.unSubscribe=function(){this._isEnabled=!1},e.prototype.getData=function(e){var t=Object(n.create)(null),r=AppMagic.Strings&&AppMagic.Strings.CompassDataSourceName?AppMagic.Strings.CompassDataSourceName:"Compass";return AppMagic.AuthoringTool.Runtime.updateDynamicDatasource(r,t),t},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ConnectionDataSource",(function(){return a}));r(0);var n=r(59),a=function(){function e(e,t){var r=this;this._isEnabled=!1,this._connected=!0,this._metered=!1,this._sync=n.b.Connected,this._lastSyncMessage="",this._lastSyncDate=0,this._networkConnectionProfile=e,t||(t=function(e){var t=AppMagic.Strings&&AppMagic.Strings.ConnectionDataSourceName?AppMagic.Strings.ConnectionDataSourceName:"Connection";AppMagic.AuthoringTool.Runtime.updateDynamicDatasource(t,e),r._connected=e.Connected,r._metered=e.Metered,r._sync=e.Sync,r._lastSyncMessage=e.LastSyncMessage,r._lastSyncDate=e.LastSyncDate}),this._updateDataFn=t}return Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this._isEnabled},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(){this._networkConnectionProfile.subscribe(this._updateDataFn.bind(this)),this._isEnabled=!0},e.prototype.unSubscribe=function(){this._networkConnectionProfile.unsubscribe(),this._isEnabled=!1},e.prototype.getData=function(){var e=this._networkConnectionProfile.getConnectionType();return this._updateDataFn(e),e},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"CordovaNetworkConnectionProfile",(function(){return s}));var n=r(0),a=r(69),o=r(59),i=r(98),s=function(){function e(){this._eventTracker=null,this._updateDataFn=null,this._sync=o.b.Connected,this._lastSyncMessage="",this._lastSyncDate=0}return e.prototype.subscribe=function(e){this._updateDataFn=e,this._eventTracker=new n.EventTracker,this._eventTracker.add(document,"offline",this._onConnectionSignalChanged,this),this._eventTracker.add(document,"online",this._onConnectionSignalChanged,this),n.FeatureGates_language.ConnectionSyncProperty&&this._setupOfflineSyncCallback()},e.prototype.unsubscribe=function(){this._eventTracker.dispose(),this._eventTracker=null},e.prototype.getConnectionType=function(){var e=navigator.connection.type!==Connection.NONE,t=navigator.connection.type===Connection.CELL||navigator.connection.type===Connection.CELL_2G||navigator.connection.type===Connection.CELL_3G||navigator.connection.type===Connection.CELL_4G;return Object(a.create)(e,t,this._sync,this._lastSyncMessage,this._lastSyncDate)},e.prototype._onConnectionSignalChanged=function(){var e=this.getConnectionType();this._updateDataFn(e)},e.prototype._setupOfflineSyncCallback=function(){return __awaiter(this,void 0,void 0,(function(){var e,t,r,a=this;return __generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),(e=n.ObjectFactory.instance.isObjectRegistered(i.ISendMessagePluginSingletonKey)?n.ObjectFactory.instance.getSingleton(i.ISendMessagePluginSingletonKey):null)?[4,e.getMessageReceiverAsync("OfflineSync",{isCompatible:function(){return{isCompatible:!0}}})]:[3,2];case 1:(t=o.sent()).isCompatible&&(t.sendMessage({method:"getOfflineSyncState"}).onMessageReceived=function(e){a._sync=e.sync,a._lastSyncMessage=e.lastSyncMessage,a._lastSyncDate=e.lastSyncDate,a._onConnectionSignalChanged()}),o.label=2;case 2:return[3,4];case 3:return r=o.sent(),n.Log.trackErrorEvent("CordovaNetworkConnectionProfile._setupOfflineSyncCallback",{message:null==r?void 0:r.message}),[3,4];case 4:return[2]}}))}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"NullConnectionDataSource",(function(){return o}));r(0);var n=r(69),a=r(59),o=function(){function e(){this._isEnabled=!1}return Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this._isEnabled},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(){this._isEnabled=!0},e.prototype.unSubscribe=function(){this._isEnabled=!1},e.prototype.getData=function(e){var t=Object(n.create)(null,null,a.b.Connected,"",0),r=AppMagic.Strings&&AppMagic.Strings.ConnectionDataSourceName?AppMagic.Strings.ConnectionDataSourceName:"Connection";return AppMagic.AuthoringTool.Runtime.updateDynamicDatasource(r,t),t},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"WebNetworkConnectionProfile",(function(){return i}));var n=r(0),a=r(69),o=r(59),i=function(){function e(){this._eventTracker=null,this._updateDataFn=null,this._sync=o.b.Connected,this._lastSyncMessage="",this._lastSyncDate=0}return e.prototype.subscribe=function(e){this._updateDataFn=e,this._eventTracker=new n.EventTracker,this._eventTracker.add(document,"offline",this._onConnectionSignalChanged,this),this._eventTracker.add(document,"online",this._onConnectionSignalChanged,this)},e.prototype.unsubscribe=function(){this._eventTracker.dispose(),this._eventTracker=null},e.prototype.getConnectionType=function(){var e=!!navigator.onLine;return Object(a.create)(e,null,this._sync,this._lastSyncMessage,this._lastSyncDate)},e.prototype._onConnectionSignalChanged=function(){var e=this.getConnectionType();this._updateDataFn(e)},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"CordovaLocationProfile",(function(){return a}));var n=r(0),a=function(){function e(){}return e.prototype.getCurrentPosition=function(e,t){Cordova.exec((function(t){var r;r={coords:t,timestamp:Date.now()},e(r)}),(function(e){n.Log.trackErrorEvent("CordovaLocationProfile.getCurrentPosition",e),t&&t(e)}),"Geolocation","getLocation",[])},e.prototype.watchPosition=function(e,t){return Cordova.exec((function(t){var r;r={coords:t,timestamp:Date.now()},e(r)}),(function(e){n.Log.trackErrorEvent("CordovaLocationProfile.watchPosition",e),t&&t(e)}),"Geolocation","addWatch",[]),1},e.prototype.clearWatch=function(e){Cordova.exec((function(e){}),(function(e){n.Log.trackErrorEvent("CordovaLocationProfile.clearWatch",e)}),"Geolocation","clearWatch",[e])},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"HTML5LocationDataSource",(function(){return a}));r(0);var n=r(99),a=function(){function e(e){this._locationProfile=e||navigator.geolocation,this._isEnabled=!1}return Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this._isEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"locationService",{get:function(){return this._locationProfile},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(){this._watchId=this._locationProfile.watchPosition(this.onPositionSignalChanged.bind(this)),this._isEnabled=!0},e.prototype.unSubscribe=function(){this._locationProfile.clearWatch(this._watchId),this._isEnabled=!1,this._watchId=null},e.prototype.getData=function(e){return this._locationProfile.getCurrentPosition(this.onPositionSignalChanged.bind(this),e),Object(n.create)(0,0,0)},e.prototype.onPositionSignalChanged=function(e){if(e&&e.coords){var t=e.coords,r=Object(n.create)(t.latitude,t.longitude,t.altitude),a=AppMagic.Strings&&AppMagic.Strings.LocationDataSourceName?AppMagic.Strings.LocationDataSourceName:"Location";AppMagic.AuthoringTool.Runtime.updateDynamicDatasource(a,r)}},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"instance",(function(){return n}));var n=null},function(e,t,r){"use strict";r.r(t),r.d(t,"instance",(function(){return n}));var n=null},function(e,t,r){"use strict";r.r(t),r.d(t,"getDataSourceAttribute",(function(){return a}));r(0);var n=r(12);function a(e,t){switch(e){case n.EditPermission:case n.CreatePermission:case n.DeletePermission:case n.Required:return!1;case n.ReadPermission:return!0;case n.MaxLength:case n.MinLength:case n.MaxValue:case n.MinValue:return null;case n.DisplayName:return t||null;case n.AllowedValues:default:return null}}},function(e,t,r){"use strict";r.r(t),r.d(t,"AppresBlobManagerUriResolver",(function(){return a}));r(0);var n=r(1),a=function(){function e(e,t){this._blobManager=e,this._binaryResolver=t}return e.prototype.canResolveUri=function(e){return e.scheme===n.Scheme&&e.host===n.Hosts.BlobManager},e.prototype._checkUriIsOwnedByBlobManager=function(e){if(!this._blobManager.contains(e))throw new AppMagic.Common.Media.MediaResourceError("The managed blob uri is not owned by the current app's BlobManager.")},e.prototype.createReferenceAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,r,n;return __generator(this,(function(a){switch(a.label){case 0:return t=e.toString(),this._checkUriIsOwnedByBlobManager(t),this._blobManager.addRef(t),[4,this._blobManager.getMediaReferenceUrlAsync(t)];case 1:return r=a.sent(),n=this._blobManager,[2,{url:r,dispose:function(){n.release(t),n=null}}]}}))}))},e.prototype.getAsBinaryAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){return t=e.toString(),this._checkUriIsOwnedByBlobManager(t),[2,this._blobManager.getBinary(t)]}))}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"AppresDataSourceToBlobManagerUriResolver",(function(){return a}));var n=r(0),a=function(){function e(e,t){this._blobManager=e,this._blobManagerUriResolver=t,this._linkedReferences=Object(n.HashTableUtility_create)()}return e.prototype.canResolveUri=function(e){return!!this._linkedReferences[e.toString()]},e.prototype.updateReference=function(e,t){var r=this._linkedReferences[e];r&&this._blobManager.release(r.toString()),this._linkedReferences[e]=new n.Core_Url(t)},e.prototype.createReferenceAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this._blobManagerUriResolver.createReferenceAsync(this._linkedReferences[e.toString()])];case 1:return[2,t.sent()]}}))}))},e.prototype.getAsBinaryAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){return[2,this._blobManagerUriResolver.getAsBinaryAsync(this._linkedReferences[e.toString()])]}))}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"AppresUnrecognizedUriResolver",(function(){return o}));r(0);var n=r(1),a=AppMagic.Common.Media,o=function(){function e(){}return e.prototype.canResolveUri=function(e){return e.isAbsolute&&e.scheme===n.Scheme},e.prototype._failAlways=function(e){if(!Object(n.AppMagicAppResourceUri_isValid)(e))throw new a.MediaResourceError("Invalid appres uri format.");throw new a.MediaResourceError("Unrecognized host '".concat(e.host,"' for appres uri."))},e.prototype.createReferenceAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this._failAlways(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.getAsBinaryAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this._failAlways(e)];case 1:return[2,t.sent()]}}))}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"BlobUriResolver",(function(){return o}));var n=r(0),a="Blob uri's are invalid in app data flow. Make sure the Blob is registered with the MediaRuntime or the BlobManager.",o=function(){function e(){}return e.prototype.canResolveUri=function(e){return e.isAbsolute&&e.scheme===n.Blob},e.prototype.createReferenceAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){throw new AppMagic.Common.Media.MediaResourceError(a)}))}))},e.prototype.getAsBinaryAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){throw new AppMagic.Common.Media.MediaResourceError(a)}))}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"DataUriResolver",(function(){return o}));var n=r(0),a=r(45),o=function(){function e(){}return e.prototype.canResolveUri=function(e){return e.isAbsolute&&e.scheme===n.Data},e.prototype.createReferenceAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){return[2,Object(a.createPassThrough)(e)]}))}))},e.prototype.getAsBinaryAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,n.PABinary.createFromDataUri(e.toString())];case 1:return[2,t.sent()]}}))}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"PassThroughWebUriResolver",(function(){return i}));var n=r(1),a=r(45),o=r(51),i=function(){function e(e){this._httpClient=e}return e.prototype.canResolveUri=function(e){return e.isAbsolute&&e.scheme!==n.Scheme&&"blob"!==e.scheme},e.prototype.createReferenceAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){return[2,Object(a.createPassThrough)(e)]}))}))},e.prototype.getAsBinaryAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,Object(o.getAsBinaryViaHttpClientAsync)(e,this._httpClient)];case 1:return[2,t.sent()]}}))}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"RelativeUrlResolver",(function(){return i}));var n=r(0),a=r(45),o=r(51),i=function(){function e(e,t){void 0===e&&(e=o.getContentDetailsViaNativeXhrAsync),void 0===t&&(t=o.getAsBlobViaNativeXhrAsync),this._getContentDetailsViaNativeXhrAsync=e,this._getAsBlobViaNativeXhrAsync=t}return e.relativeUrlToAbsoluteUrl=function(e){return this._anchorEl||(this._anchorEl=self.document.createElement("a")),this._anchorEl.href=e.toString()||".",new Core.Url(this._anchorEl.href)},e.prototype.canResolveUri=function(e){return!e.isAbsolute},e.prototype.createReferenceAsync=function(t){return __awaiter(this,void 0,Promise,(function(){var r;return __generator(this,(function(n){return r=e.relativeUrlToAbsoluteUrl(t),[2,Object(a.createPassThrough)(r)]}))}))},e.prototype.getAsBinaryAsync=function(t){return __awaiter(this,void 0,Promise,(function(){var r,a,o,i,s,c,u,l;return __generator(this,(function(d){switch(d.label){case 0:if(r=e.relativeUrlToAbsoluteUrl(t),a="RelativeUrlResolver.getAsBinaryAsync",o=Core.Telemetry.Utility.scrubSensitiveDataSafe(r.toString()),Core.FallbackSwitch.isActivated("AppRuntime.DisableAppRelativePABinaryOptimization"))return[3,4];d.label=1;case 1:return d.trys.push([1,3,,4]),[4,this._getContentDetailsViaNativeXhrAsync(r)];case 2:return i=d.sent(),s=i.length,c=i.type,"number"==typeof s&&s>0&&void 0!==c?(Core.Telemetry.Log.trackActivityEvent(a,{message:"HEAD request succeeded",absoluteMediaUrl:o,length:s,type:c}),[2,Core.PABinary.createFromAppRelativeFile(t.toString(),s,c)]):(Core.Telemetry.Log.trackActivityEvent(a,{message:"HEAD request did not return valid metadata",absoluteMediaUrl:o,length:s,type:c}),[3,4]);case 3:return u=d.sent(),n.CoreLog.errorEx(a,"Failed to fetch content metadata",{error:u,eventData:{scrubbedUrl:o}}),[3,4];case 4:return Core.Telemetry.Log.trackActivityEvent(a,{message:"Fetch full blob content",absoluteMediaUrl:o}),[4,this._getAsBlobViaNativeXhrAsync(r)];case 5:return[2,(l=d.sent())?Core.PABinary.createFromBlob(l):null]}}))}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"WindowsFilePathMediaResolver",(function(){return o}));var n=/^\\\\[^<>:"/\\|?*]+(\\[^<>:"/\\|?*]+)+\\?$/,a=/^[a-zA-Z]:\\[^<>:"/\\|?*]+(\\[^<>:"/\\|?*]+)+\\?/,o=function(){function e(e){this._localFileCache=e}return e.prototype.canResolvePath=function(e){return a.test(e)||n.test(e)},e.prototype.normalizePath=function(e){var t=e.toLowerCase();return{path:t,uri:Core.IO.WindowsFileSystem.tryParsePathToFileUri(t)}},e.prototype.getOrCreateBlobUriForFileAsync=function(e,t){var r=this,n=t.toString(),a=this._localFileCache.tryGetEntry(n);return a?Promise.resolve(new Core.Url(a)):Core.IO.FileSystem.getFileFromPath(e).then((function(e){return e.readBlobAsync()})).then((function(e){return a=r._localFileCache.getOrCreateUrlFromBlob(n,e),new Core.Url(a)}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"PromiseCollection",(function(){return n}));var n=function(){function e(){this._jobs=HashTableUtility.create(),this._nextJobId=0}return e.prototype.addJob=function(e,t){var r;void 0===t&&(t=new AbortController);var n=new Promise((function(e){r=e})),a=this,o=this._getNextJobId();return n=n.then((function(){return e(t)})).then((function(e){return delete a._jobs[o],e}),(function(e){throw delete a._jobs[o],e})),this._jobs[o]={promise:n,abortController:t},r(),n},e.prototype.cancelAll=function(){var e=this;Object.keys(this._jobs).forEach((function(t){Core.PromiseUtils.abortPromise(e._jobs[t].promise,e._jobs[t].abortController)}))},e.prototype.getJobsCount=function(){return Object.keys(this._jobs).length},e.prototype._getNextJobId=function(){var e=Core.Utility.getNextId(this._nextJobId,this._jobs);return this._nextJobId=e.newCounter,e.id},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"Runtime",(function(){}))},function(e,t,r){"use strict";r.r(t),r.d(t,"ConnectionAuthenticationProvider",(function(){return n}));var n=function(e){function t(t,r){var n=e.call(this)||this;return n._apiIdLazy=new Core.Lazy((function(){var e=t();if(!e)throw new Error("The service variables for connection api id does not exist.");return e})),n._authenticationService=r,n}return __extends(t,e),t.prototype.authenticateCoreAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this._authenticateAndGetTokenAsync()];case 1:return e.sent(),[2]}}))}))},t.prototype.authenticateRequestCoreAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return[4,this._authenticateAndGetTokenAsync()];case 1:return t=r.sent(),e.addHeader(AppMagic.Services.HttpConstants.HeaderName.Authorization,AppMagic.Services.Authentication.AppHttpClient.formatAppAccessTokenAuthorizationHeader(t)),[2]}}))}))},t.prototype._authenticateAndGetTokenAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e,t,r;return __generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),e={resourceName:"appservice",apiId:this._apiIdLazy.value},[4,this._authenticationService.getAccessTokenForResourceAsync(e)];case 1:if(!(t=n.sent())||"paauth"!==t.tokenType||!t.accessToken)throw new Error("Invalid access token received from authentication service.");return[2,t.accessToken];case 2:throw r=n.sent(),Core.PromiseUtils.throwIfCanceled(r),Core.Log.error("ConnectionAuthenticationProvider._getAccessToken",r),new Error(AppMagic.Strings.ConnectionsUnauthorizedAccess);case 3:return[2]}}))}))},t}(AppMagic.Services.AuthenticationProvider)},function(e,t,r){"use strict";r.r(t),r.d(t,"CanvasUtility",(function(){return a}));var n=r(5),a=function(){function e(){}return e.saveCanvasToUrl=function(e,t){var r=null;t=t||"image/png";try{var a=e.toDataURL(),o=Core.IO.Utility.Conversion.dataURItoBlob(a);Core.Environment.getCordovaPlatformId()===Core.Environment.CordovaPlatformId.iOS?r=URL.createObjectURL(o):(r=n.blobManager.addBlob(o),n.blobManager.addRef(r))}catch(e){Core.Log.verbose("CanvasUtility: Failed to save canvas to url. Error: "+e)}return r},e.loadBlobToCanvas=function(e,t){var r=Core.PromiseUtils.createCompletablePromise(),n=new Image;return n.src="",n.onload=function(){t.drawImage(n,0,0),n.onload=null,r.complete()},n.onerror=function(e){var t;t="string"==typeof e?e:e.message?e.message:"",r.error("Error loading blob to canvas. "+t)},n.src=e,r.promise},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ElementRenderer",(function(){return n}));var n=function(){function e(){this._offscreenCanvas=document.createElement("canvas"),this._offscreenCanvas.style.display="none",this._offscreenCanvas.setAttribute("aria-role","presentation"),this._canvasContext=this._offscreenCanvas.getContext("2d")}return e.prototype.renderElementToDataUrl=function(e,t,r){t.imageType=t.imageType||"image/jpeg",void 0===t.width&&(t.width=e.offsetWidth),void 0===t.height&&(t.height=e.offsetHeight),this._canvasContext.save();var n,a=t.width,o=t.height;if(void 0!==t.rotation)switch(t.rotation%360){case 90:a=t.height,o=t.width,n={horizontalScaling:0,verticalSkewing:1,horizontalSkewing:-1,verticalScaling:0,horizontalTranslation:a,verticalTranslation:0};break;case 270:case-90:a=t.height,n={horizontalScaling:0,verticalSkewing:-1,horizontalSkewing:1,verticalScaling:0,horizontalTranslation:0,verticalTranslation:o=t.width};break;case 180:n={horizontalScaling:-1,verticalSkewing:0,horizontalSkewing:0,verticalScaling:-1,horizontalTranslation:a,verticalTranslation:o}}this._offscreenCanvas.width=a,this._offscreenCanvas.height=o,this._offscreenCanvas.style.width=a.toString()+"px",this._offscreenCanvas.style.height=o.toString()+"px",n&&this._canvasContext.setTransform(n.horizontalScaling,n.verticalSkewing,n.horizontalSkewing,n.verticalScaling,n.horizontalTranslation,n.verticalTranslation),t.mirrored&&this._canvasContext.setTransform(-1,0,0,1,a,0),this._canvasContext.drawImage(e,0,0,t.width,t.height);var i=this._getURL(t.imageType,r);return this._canvasContext.restore(),i},e.prototype._getURL=function(e,t){var r=this;return new Promise((function(n,a){var o=r._offscreenCanvas.toDataURL(e);t&&window.ResourceManagerPlugin?window.ResourceManagerPlugin.writeDataToSessionStore(n,a,o):n(o)}))},e.prototype.dispose=function(){this._offscreenCanvas=null,this._canvasContext=null},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"AppExternalMessageManager",(function(){return a}));var n=r(5),a=function(e){function t(t){var r=e.call(this,"AppExternalMessageManager",!1)||this;return r._previewFlagName=t,r}return __extends(t,e),t.prototype._onLoaded=function(){e.prototype._onLoaded.call(this),Object(n.getAppPreviewFlag)(this._previewFlagName)&&Core.FeatureGates.documentPreviewFlags.externalMessage&&this._registerExternalMessage()},t.prototype._onUnloaded=function(){Core.Log.verbose("AppComponent[{0}]: onUnloaded",this.name),e.prototype._onUnloaded.call(this),this._unregisterBarcodeScanner()},t.prototype._registerExternalMessage=function(){this._registerBarcodeScanner()},t.prototype._registerBarcodeScanner=function(){DataWedgeIntentPlugin.registerBroadcastReceiver((function(){}),this._getErrorFunction("_registerBarcodeScanner"),{filterActions:["com.microsoft.msapps.ACTION"]}),DataWedgeIntentPlugin.registerListener(this._dataWedgeIntentSuccessListener.bind(this),this._getErrorFunction("registerListener"))},t.prototype._unregisterBarcodeScanner=function(){DataWedgeIntentPlugin.clearListener((function(){}),this._getErrorFunction("_unregisterBarcodeScanner"))},t.prototype._dataWedgeIntentSuccessListener=function(e){var t={Message:{Source:"barcodescanner",Value:e["com.symbol.datawedge.data_string"],TimeStamp:Date.now()}};this._invokeBehaviorPropertyWithScopedVariable(AppMagic.Constants.Runtime.appInfoControlName,AppMagic.Constants.Runtime.onMessageRuleName,t),Core.Telemetry.Log.trackActivityEvent("AppExternalMessageManager.BarCodeType",{message:e["com.symbol.datawedge.label_type"]})},t.prototype._invokeBehaviorPropertyWithScopedVariable=function(e,t,r){var n=AppMagic.AuthoringTool.Runtime.getNamedControl(e),a=n.OpenAjax.getAuthoringControlContext();n.OpenAjax.fireEvent(t,a,r)},t.prototype._getErrorFunction=function(e){return function(t){Core.Telemetry.Log.trackErrorEvent("AppExternalMessageManager.".concat(e),{message:t})}},t}(AppMagic.Runtime.App.AppComponent)},function(e,t,r){"use strict";r.r(t),r.d(t,"IARViewerPluginSingletonKey",(function(){return n}));var n=Core.Loader.TypeKey.createForInterface("AppMagic.Runtime.App.AugmentedReality.IARViewerPlugin")},function(e,t,r){"use strict";r.r(t),r.d(t,"DataStateProcessor",(function(){return c}));var n=r(17),a=r(27),o=r(52),i=r(5),s=AppMagic.Data.DataEntityRecordSerialization.LogReporter,c=function(){function e(){}return Object.defineProperty(e,"maxPayLoadLimit",{get:function(){return Core.FallbackSwitch.isActivated("AppConnectivity.ReduceSaveDataLimitForWeb")?1048576:5242880},enumerable:!1,configurable:!0}),Object.defineProperty(e,"promiseQueue",{get:function(){return e._promiseQueue||(e._promiseQueue=new Core.PromiseUtils.PromiseQueue("SaveLoadClearData")),e._promiseQueue},enumerable:!1,configurable:!0}),e.saveDataStoreAsync=function(t,r){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(n){return[2,e.promiseQueue.pushJob((function(){return e._saveDataStoreAsync(t,r)}))]}))}))},e._getSaveDataLoadDataPluginClient=function(){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:return e._saveDataLoadDataPluginClient?[3,3]:(t=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.Plugins.PluginVersionManager.singletonKey)).versionsExchanged.hasFired?[3,2]:[4,t.versionsExchanged.waitAsync()];case 1:r.sent(),r.label=2;case 2:e._saveDataLoadDataPluginClient=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.ISaveDataLoadDataPluginClientSingletonKey),r.label=3;case 3:return[2,e._saveDataLoadDataPluginClient]}}))}))},e._saveDataStoreAsync=function(t,r){return __awaiter(this,void 0,Promise,(function(){var n,s,c,u,l,d,p,f,y,g,h,m,v,b,_,C;return __generator(this,(function(A){switch(A.label){case 0:n=Core.Telemetry.Log.startScenario(Core.Telemetry.ScenarioName.SaveData),A.label=1;case 1:return A.trys.push([1,13,,14]),[4,e._getSaveDataLoadDataPluginClient()];case 2:return(s=A.sent())?(c=Object(i.getManagedBinaryMediaUrlsInData)(t),u=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.CurrentAppInstanceFunctionSingletonKey)(),[4,this._estimateDataSize(t,c,u.mediaRuntime)]):[3,11];case 3:if(l=A.sent(),this.maxPayLoadLimit<l)return[2,Core.IO.SaveDataResult.QuotaExceeds];if(d=t,Object(i.hasOpenAjax)(d)&&(p=Object(i.cloneAndFlattenOpenAjax)(d),d=p),f=HashTableUtility.create(),!(c.length>0))return[3,9];y=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.AppPABinaryResolverSingletonKey),g=0,h=c,A.label=4;case 4:if(!(g<h.length))return[3,9];m=h[g],A.label=5;case 5:return A.trys.push([5,7,,8]),[4,Object(i.getMediaAsArrayBufferWithContentTypeAsync)(m,u.mediaRuntime,y)];case 6:return(v=A.sent())&&(b=o.ZipPacker.generateMediaPath(m,v,!0),f[b]=v.arrayBuffer),[3,8];case 7:return A.sent(),Core.Telemetry.Log.trackActivityEvent("DataStateProcessor.saveDataStoreAsync",{message:"Failed to load Media Uri '".concat(m,"'"),mediaUri:m}),[3,8];case 8:return g++,[3,4];case 9:return Object(a.updateEnumerable)(d,!0),[4,s.saveDataAsync(r,l,this.maxPayLoadLimit,JSON.stringify(d,a.stringfyReplacer),f)];case 10:return _=A.sent(),Object(a.updateEnumerable)(d,!1),Core.Telemetry.Log.endScenario(n,{message:"SaveData with key '".concat(r,"' with estimated size '").concat(l,"' with assets count '").concat(f.length)}),[2,_];case 11:return Core.Telemetry.Log.failScenario(n,{message:"unexpected error saveDataLoadDataPluginClient is null"}),[2,Core.IO.SaveDataResult.Unknown];case 12:return[3,14];case 13:throw C=A.sent(),Core.Telemetry.Log.endAndThrowIfCanceled(C,n),Core.Log.error("DataStateProcessor.saveDataStoreAsync",C),Core.Telemetry.Log.failScenario(n,{error:C}),C;case 14:return[2]}}))}))},e.loadDataStoreAsync=function(t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){return[2,e.promiseQueue.pushJob((function(){return e._loadDataStoreAsync(t)}))]}))}))},e._loadDataStoreAsync=function(t){return __awaiter(this,void 0,Promise,(function(){var r,o,i,c,u,l,d,p=this;return __generator(this,(function(f){switch(f.label){case 0:r=Core.Telemetry.Log.startScenario(Core.Telemetry.ScenarioName.LoadData),f.label=1;case 1:return f.trys.push([1,6,,7]),[4,e._getSaveDataLoadDataPluginClient()];case 2:return(o=f.sent())?(i=void 0,[4,o.loadDataAsync(t)]):[3,4];case 3:if((c=f.sent()).isMissingKey)throw new AppMagic.Runtime.App.NonExistentFileFlagError;return u=function(e,t){return Object(a.parseReplacer)(e,t,l)},l=new s,i=JSON.parse(c.data,u),Object(a.updateEnumerable)(i,!1),HashTableUtility.forEach(c.assets,(function(e,t){return __awaiter(p,void 0,void 0,(function(){return __generator(this,(function(r){return n.FileDataProcessor.loadAndRegisterArrayBufferData(t,e),[2]}))}))})),Core.Telemetry.Log.endScenario(r,{message:"LoadData with key '".concat(t,"'  with assets count '").concat(c.assets.length)}),[2,i];case 4:return Core.Telemetry.Log.failScenario(r,{message:"unexpected error saveDataLoadDataPluginClient is null"}),[2,null];case 5:return[3,7];case 6:throw d=f.sent(),Core.Telemetry.Log.endAndThrowIfCanceled(d,r),Core.Log.error("DataStateProcessor.loadDataStoreAsync",d),Core.Telemetry.Log.failScenario(r,{error:d}),d;case 7:return[2]}}))}))},e.clearDataStoreAsync=function(t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(r){return[2,e.promiseQueue.pushJob((function(){return e._clearDataStoreAsync(t)}))]}))}))},e._clearDataStoreAsync=function(t){return __awaiter(this,void 0,Promise,(function(){var r,n,a,o;return __generator(this,(function(i){switch(i.label){case 0:r=Core.Telemetry.Log.startScenario(Core.Telemetry.ScenarioName.ClearData),i.label=1;case 1:return i.trys.push([1,6,,7]),[4,e._getSaveDataLoadDataPluginClient()];case 2:return(n=i.sent())?[4,n.clearDataAsync(t)]:[3,4];case 3:return a=i.sent(),Core.Telemetry.Log.endScenario(r,{message:"Clear data with key '".concat(t,"'")}),[2,a];case 4:return Core.Telemetry.Log.failScenario(r,{message:"unexpected error saveDataLoadDataPluginClient is null"}),[2,!1];case 5:return[3,7];case 6:throw o=i.sent(),Core.Telemetry.Log.endAndThrowIfCanceled(o,r),Core.Log.error("DataStateProcessor.clearDataStoreAsync",o),Core.Telemetry.Log.failScenario(r,{error:o}),o;case 7:return[2]}}))}))},e._estimateDataSize=function(e,t,r){return __awaiter(this,void 0,Promise,(function(){var a,o,s,c,u,l,d,p,f,y,g;return __generator(this,(function(h){switch(h.label){case 0:if(a=n.FileDataProcessor.getChunkRecords(e),o=0,s=0,c=0,a>0)for(;o<e.length;)u=o+a,l=e.slice(o,u),o=u>=e.length?e.length:u,s+=n.FileDataProcessor.getJSonUnreferenceStringLength(l);if(!(t.length>0))return[3,6];d=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.App.AppPABinaryResolverSingletonKey),p=0,f=t,h.label=1;case 1:if(!(p<f.length))return[3,6];y=f[p],h.label=2;case 2:return h.trys.push([2,4,,5]),[4,Object(i.getMediaAsArrayBufferWithContentTypeAsync)(y,r,d)];case 3:return g=h.sent(),c+=g.arrayBuffer.byteLength,[3,5];case 4:return h.sent(),Core.Telemetry.Log.trackActivityEvent("DataStateProcessor._estimateDataSize",{message:"Failed to load Media Uri '".concat(y,"'"),mediaUri:y}),[3,5];case 5:return p++,[3,1];case 6:return[2,s+c]}}))}))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"SaveDataCurrentVersion",(function(){return n}));var n="1.0"},function(e,t,r){"use strict";r.r(t),r.d(t,"UserDefinedFunctionNamespaceManager",(function(){return o}));var n=r(124),a=r(53),o=function(){function e(){this._namespaces=HashTableUtility.create()}return e.prototype.getNamespace=function(e,t){var r=this._namespaces[e];if(!r&&t)throw new a.NamedObjectNotFoundError(e);return r},e.prototype.deleteNamespace=function(e){this._namespaces[e]&&delete this._namespaces[e]},e.prototype.getOrCreateNamespace=function(e){return this._namespaces[e]||(this._namespaces[e]=new n.UserDefinedFunctionNamespace(e)),this._namespaces[e]},e.prototype.deleteAllNamespaces=function(){var e=this;HashTableUtility.forEach(this._namespaces,(function(t,r){t.dispose(),e.deleteNamespace(r)}))},e.prototype.dispose=function(){this.deleteAllNamespaces(),delete this._namespaces},e}()},function(e,t,r){"use strict";r.r(t)},function(e,t,r){"use strict";r.r(t),r.d(t,"NonExistentFileFlagError",(function(){return n}));var n=function(e){function t(t){return void 0===t&&(t="File or folder does not exist"),e.call(this,t,"NonExistentFileFlagError")||this}return __extends(t,e),t}(Core.ErrorBase)},function(e,t,r){"use strict";r.r(t),r.d(t,"NoopRuntimeFunctionsHelper",(function(){return n}));var n=function(){function e(){}return e.prototype.exitAppAsync=function(e){return Core.Log.warningEx("NoopRuntimeFunctionsHelper.exitAppAsync","Call to exitAppAsync received, but no implementation is available."),Promise.resolve(!1)},e.prototype.navigateBack=function(){return Core.Log.warningEx("NoopRuntimeFunctionsHelper.navigateBack","Call to navigateBack received, but no implementation is available."),!1},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ScopeMonitor",(function(){return a}));var n=r(46),a=function(){function e(){this._loadAppScope=new n.CompositeScopeTracker(e.loadAppScopeName),this._screenScopes=HashTableUtility.create(),this._expressionExecutionContext=HashTableUtility.create(),this._isLoaded=!1,this._isLoading=!1,this._navigateToScreen=null,this._currentScreen=null}return Object.defineProperty(e.prototype,"loadAppScope",{get:function(){return this._loadAppScope},enumerable:!1,configurable:!0}),e.prototype.startInitialLoad=function(){Core.Telemetry.PerfMarker.startMarker("Scope-RuleLoad."),this._isLoading=!0},e.prototype.endInitialLoad=function(){Core.Telemetry.PerfMarker.endMarker("Scope-RuleLoad."),this._isLoaded=!0,this._isLoading=!1},e.prototype.startNavigation=function(e,t){Core.Telemetry.PerfMarker.startMarker("Scope-Nav-To-".concat(e)),t&&this._getOrCreateScopeForScreen(e).setData(t),this._navigateToScreen=e,this._currentScreen=e},e.prototype.endNavigation=function(e){Core.Telemetry.PerfMarker.endMarker("Scope-Nav-To-".concat(this._navigateToScreen)),this._navigateToScreen=null,this._screenScopes[e]&&this._screenScopes[e].endScope()},e.prototype.tryGetCurrentScreenScope=function(){return this._currentScreen?this.tryGetScreenScope(this._currentScreen):null},e.prototype.tryGetScreenScope=function(e){return this._screenScopes[e]||null},e.prototype.registerStartScopeListenerForScreen=function(e,t){this._getOrCreateScopeForScreen(e).registerStartScopeListener(t)},e.prototype.registerEndScopeListenerForScreen=function(e,t){this._getOrCreateScopeForScreen(e).registerEndScopeListener(t)},e.prototype.registerCancelScopeListenerForScreen=function(e,t){this._getOrCreateScopeForScreen(e).registerCancelScopeListener(t)},e.prototype._getOrCreateScopeForScreen=function(e){return this._screenScopes[e]||(this._screenScopes[e]=new n.DataScopeTracker(e)),this._screenScopes[e]},e.prototype.dispose=function(){HashTableUtility.forEach(this._screenScopes,(function(e){e.dispose()})),this._screenScopes=null,this._navigateToScreen=null},e.prototype.startExpressionComponentRun=function(e){this._expressionExecutionContext[e]=new n.DataScopeTracker(e)},e.prototype.endExpressionComponentRun=function(e){this._expressionExecutionContext[e]&&(this._expressionExecutionContext[e].endScope(),this._expressionExecutionContext[e].dispose(),delete this._expressionExecutionContext[e])},e.prototype.isDataFlowActiveAfterExpression=function(e){return!!this._expressionExecutionContext[e]&&this._expressionExecutionContext[e].isActive},e.prototype.registerStartExpressionComponentListener=function(e,t){this._expressionExecutionContext[e].registerStartScopeListener(t)},e.prototype.registerEndExpressionComponentListener=function(e,t){this._expressionExecutionContext[e].registerEndScopeListener(t)},e.prototype._trackAsyncWorkForRunningExpressions=function(e,t,r){HashTableUtility.forEach(this._expressionExecutionContext,(function(n,a){n.activateScope(e).trackPromise(t,r)}))},e.prototype.trackPromise=function(e,t,r){this._isLoading?this._loadAppScope.activateScope(e).trackPromise(t,r):this._navigateToScreen&&(this._screenScopes[this._navigateToScreen]||(this._screenScopes[this._navigateToScreen]=new n.DataScopeTracker(this._navigateToScreen)),this._screenScopes[this._navigateToScreen].activateScope(e).trackPromise(t,r)),this._trackAsyncWorkForRunningExpressions(e,t,r)},e.loadAppScopeName="loadApp_b3458955-831f-409d-a111-99599c7ac194",e}()},function(e,t,r){"use strict";r.r(t);var n,a=r(0),o=new Uint8Array(16);function i(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(o)}var s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var c=function(e){return"string"==typeof e&&s.test(e)},u=[],l=0;l<256;++l)u.push((l+256).toString(16).substr(1));var d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]).toLowerCase();if(!c(r))throw TypeError("Stringified UUID is invalid");return r};var p=function(e,t,r){var n=(e=e||{}).random||(e.rng||i)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var a=0;a<16;++a)t[r+a]=n[a];return t}return d(n)},f=r(26),y=r(64),g=r(77),h=r(25),m=r(57),v=r(4);r.d(t,"CanvasDataProvider",(function(){return b}));var b=function(){function e(e){this._canUserCreate=!0,this._canUserEdit=!0,this._cachedRecordsById={},this._defaultSelectedItemsTable=null,this._lastCdpRecordCounts={totalRecordCount:0,cdpTotalRecordCount:0},this._dummyRecordIdIndex=0,this._selectedRecordIds=[],this._setSelectedRecordIdsAction=e}return e.prototype._disableInvalidSorting=function(e,t){var r=[];return null==e||e.forEach((function(e){var n,a,o,i=e,s=null===(n=e.dataType)||void 0===n?void 0:n.toLocaleLowerCase();i.disableSorting=e.disableSorting||("string"===s||"singleline.text"===s)&&null===(null===(a=e.attributes)||void 0===a?void 0:a.MaxLength)&&void 0===(null===(o=e.attributes)||void 0===o?void 0:o.Format)||"file"===s||("lookup"===s||"lookup.simple"===s)&&t,r.push(i)})),r},e.prototype.updateQueryableDataSource=function(e,t,r,n){var a=this,o=void 0!==(null==e?void 0:e.dataSource);this._columns=this._disableInvalidSorting(t,o),this._aliasMap={},(t||[]).forEach((function(e){a._aliasMap[e.alias]=e.name}));var i=!1,s=!1;this._dataSource!==e&&(this._dataSource=e,this._cachedRecordsById={},this._dummyRecordIdIndex=0);var c=this._filterRecordsFromItems(r);if(JSON.stringify(this._selectedRecordIds)!==JSON.stringify(c)&&(this._selectedRecordIds=c,i=!0),this._defaultSelectedItemsTable!==n&&(this._defaultSelectedItemsTable=n,s=!0),s){this._flushDummyRecords();var u=this._filterRecordsFromItems(this._defaultSelectedItemsTable,!0);this.setSelectedRecordIds(u)}else i&&this._setSelectedRecordIdsAction(c)},Object.defineProperty(e.prototype,"shouldLeverageCdpMoreRecordDetermination",{get:function(){var e,t,r=null===(t=null===(e=this._dataSource)||void 0===e?void 0:e.dataSource)||void 0===t?void 0:t.kind;return r&&r!==v.DataSourceKind.CdsNativeDataSource&&!a.FallbackSwitch.isActivated("Controls.DisablePcfCdpMoreRecordDetermination")},enumerable:!1,configurable:!0}),e.prototype._flushDummyRecords=function(){this._selectedRecordIds=[];for(var t=0;t<this._dummyRecordIdIndex;t++)delete this._cachedRecordsById[e.INJECTED_RECORD_PREFIX+t];this._dummyRecordIdIndex=0},e.prototype.getEntityName=function(){var e,t=this._dataSource;return"default.cds"===(null===(e=null==t?void 0:t.dataSource)||void 0===e?void 0:e.datasetName)?t.dataSource.logicalName:""},e.prototype.reset=function(){this._selectedRecordIds=[],this._defaultSelectedItemsTable=null},e.prototype.addSelectsAndExpands=function(e,t,r,n){var o=this,i=!a.FallbackSwitch.isActivated("PCF.CanvasCdpLookupV2Fallback"),s={};if(i)for(var c=0,u=null!=n?n:[];c<u.length;c++){var l=u[c];s[l.name]=l}null==e||e.forEach((function(e){var n,a,c;if(o._aliasMap[e.alias]||(o._aliasMap[e.alias]=e.name),t&&(null===(a=null===(n=t[e.name])||void 0===n?void 0:n.Type)||void 0===a?void 0:a.startsWith("Lookup"))&&!(null===(c=null==r?void 0:r.expands)||void 0===c?void 0:c.find((function(t){return t.propertyName===e.name})))&&(!i||s[e.name]instanceof AppMagic.Data.NavigationColumnMetadata||s[e.name]instanceof AppMagic.Data.PolymorphicLookupColumnMetadata)){var u=t[e.name].ReferencingFieldName||e.name;r.selects.push("_".concat(u,"_value")),r.expands=r.expands||[],r.expands.push(new h.Expand(e.name))}}))},e.prototype.getRecords=function(e){var t,r,n,o,i,s,c,u,l,d,p,g;return __awaiter(this,void 0,Promise,(function(){var h,m,v,b,_,C,A,S,D,O,E;return __generator(this,(function(T){switch(T.label){case 0:if(this._lastQueryId=null==e?void 0:e.queryId,!this._dataSource)return[2,{records:{},hasNextPage:!1,sortedRecordIds:[]}];T.label=1;case 1:return T.trys.push([1,4,,5]),h=null===(t=this._dataSource)||void 0===t?void 0:t.queryOptions,m=null!==(n=null===(r=this.getCapabilities())||void 0===r?void 0:r.canPaginate)&&void 0!==n&&n,v=Object(y.mergeQueryOptions)(h,e,this._dataSource,this._columns),this._currentView=this._tryGetView(null==v?void 0:v.filter),[4,this.getMetadata(null==v?void 0:v.selects)];case 2:return b=T.sent(),_=null===(s=null===(i=null===(o=this._dataSource)||void 0===o?void 0:o.dataSource)||void 0===i?void 0:i.tryGetTableMetadata)||void 0===s?void 0:s.call(i),this.addSelectsAndExpands(null==e?void 0:e.columns,null===(c=null==b?void 0:b.primaryEntityMetadata)||void 0===c?void 0:c.metadata,v,null==_?void 0:_.columns),C=Object(f.getPrimaryKeyFromTable)(this._dataSource),A=null===(u=null==_?void 0:_.tempKeyColumn)||void 0===u?void 0:u.name,C&&C!==A&&-1===(null===(l=null==v?void 0:v.selects)||void 0===l?void 0:l.indexOf(C))&&!Object(f.shouldHandleNavigationQueriedTable)(this._dataSource)&&v.selects.push(C),!a.FallbackSwitch.isActivated("Controls.DisablePcfSelectionEnforcement")&&!1===(null===(d=null==_?void 0:_.capabilities)||void 0===d?void 0:d.isSelectable)&&(null===(p=null==v?void 0:v.selects)||void 0===p?void 0:p.length)&&(v.selects=[]),[4,Object(f.getIPcfQueryResult)(this._dataSource,e,v,b,m,this._aliasMap,this._columns)];case 3:if(S=T.sent(),this.shouldLeverageCdpMoreRecordDetermination&&(this._lastCdpRecordCounts.totalRecordCount=S.totalRecordCount,this._lastCdpRecordCounts.cdpTotalRecordCount=S.cdpTotalRowCount,a.Log.trackActivityEvent("CanvasDataProvider_getRecords",{name:"SettingLastCdpRecordCounts",hadMoreResultsThanMax:-1===S.totalRecordCount,countsMatched:S.totalRecordCount===S.cdpTotalRowCount})),this._flushDummyRecords(),(null==e?void 0:e.queryId)===this._lastQueryId){for(D in null==S?void 0:S.records)D in this._cachedRecordsById&&this._cachedRecordsById[D].isDirty()&&(S.records[D]=this._cachedRecordsById[D]);(null===(g=this._dataSource)||void 0===g?void 0:g.dataSource)?this._cachedRecordsById=__assign(__assign({},this._cachedRecordsById),(null==S?void 0:S.records)||{}):this._cachedRecordsById=__assign({},(null==S?void 0:S.records)||{}),this._dummyRecordIdIndex=0}return O=this._filterRecordsFromItems(this._defaultSelectedItemsTable,!0,S),this.setSelectedRecordIds(O),[2,S];case 4:throw E=T.sent(),a.CoreLog.error("AppMagicData.CanvasDataProvider.getRecords",E),E;case 5:return[2]}}))}))},e.prototype.getMetadata=function(e){var t,r;return __awaiter(this,void 0,Promise,(function(){var n,o,i,s,c;return __generator(this,(function(u){switch(u.label){case 0:if(!(null===(t=this._dataSource)||void 0===t?void 0:t.dataSource))return this._metaData=this._createMetadataFromColumns(e),[2,this._metaData];u.label=1;case 1:return u.trys.push([1,5,,6]),n=null===(r=this._dataSource)||void 0===r?void 0:r.dataSource,o=this,[4,n.canUserEditAsync];case 2:return o._canUserEdit=u.sent(),i=this,[4,n.canUserCreateAsync];case 3:return i._canUserCreate=u.sent(),s=this,[4,Object(f.convertToDataSetMetadata)(n,e)];case 4:return s._metaData=u.sent(),[2,this._metaData];case 5:throw c=u.sent(),a.CoreLog.error("AppMagicData.CanvasDataProvider.getMetadata",c),c;case 6:return[2]}}))}))},e.prototype._createMetadataFromColumns=function(e){var t;if(!a.FeatureGates_controls.pcfDataSetColumnTypeWithoutMetadata||!(null===(t=this._columns)||void 0===t?void 0:t.length))return null;for(var r={},n=0,o=e?this._columns.filter((function(t){return-1!==e.indexOf(t.name)})):this._columns;n<o.length;n++){var i=o[n];r[i.name]={Type:i.dataType,DisplayName:void 0,LogicalName:void 0,RequiredLevel:void 0,IsSecured:void 0,IsReadable:void 0,IsEditable:void 0,SourceType:void 0,Description:void 0}}return{primaryEntityMetadata:{metadata:r,displayName:void 0,logicalName:void 0,primaryNameAttribute:void 0,primaryIdAttribute:void 0,primaryImageAttribute:void 0,privilegesByType:void 0,description:void 0,entityPluralName:void 0,attributeNames:void 0},relatedEntityMetadata:void 0}},e.prototype.newRecord=function(){var e,t;return __awaiter(this,void 0,Promise,(function(){var r,n,a;return __generator(this,(function(o){switch(o.label){case 0:if(!(null===(e=this._dataSource)||void 0===e?void 0:e.dataSource))return[2,Promise.reject("Cannot insert a new record to a non-Queryable data source")];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.getMetadata()];case 2:return r=o.sent(),n=new g.DataSetEntityRecord(null===(t=this._dataSource)||void 0===t?void 0:t.dataSource,{},r,"",{},p(),!0),[2,Promise.resolve(n)];case 3:return a=o.sent(),[2,Promise.reject(a)];case 4:return[2]}}))}))},e.prototype.delete=function(e){var t,r;return __awaiter(this,void 0,Promise,(function(){var n,o,i,s;return __generator(this,(function(c){switch(c.label){case 0:if(!(null===(t=this._dataSource)||void 0===t?void 0:t.dataSource))return[2,Promise.reject("Cannot delete a record from non-Queryable data source")];if(!(e&&e.length>0))return[3,4];if(null===(n=Object(f.getPrimaryKeyFromTable)(this._dataSource)))return[2,Promise.reject("Primary column not found")];o=[],e.forEach((function(e){var t={};t[n]=e,o.push(t)})),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,null===(r=this._dataSource)||void 0===r?void 0:r.dataSource.removeAsync(o)];case 2:return i=c.sent(),AppMagic.Data.ErrorValue.isErrorValue(i)?(a.Log.trackActivityEvent("CanvasDataProvider_delete",{message:JSON.stringify(i)}),[2,Promise.reject(i)]):[3,4];case 3:return s=c.sent(),[2,Promise.reject(s)];case 4:return a.Log.trackActivityEvent("CanvasDataProvider_delete"),[2,Promise.resolve()]}}))}))},e.prototype.getCapabilities=function(){var e,t,r,n,o,i,s=null===(e=this._dataSource)||void 0===e?void 0:e.dataSource;if(s){var c=s.tryGetTableMetadata();if(i={canCreateNewRecords:this._canUserCreate,canPaginate:null===(t=c.capabilities)||void 0===t?void 0:t.isPagable,isEditable:this._canUserEdit,isFilterable:!0,isSortable:!0,hasRecordNavigation:!1},this.shouldLeverageCdpMoreRecordDetermination){var u={determinationType:"Default"};if(-1===(null===(r=this._lastCdpRecordCounts)||void 0===r?void 0:r.totalRecordCount)){var l=null===(n=this._lastCdpRecordCounts)||void 0===n?void 0:n.cdpTotalRecordCount;l&&"number"==typeof l?(i.totalRecordLimit=l,u.determinationType="CdpRecordCount"):(i.totalRecordLimit=f.ODATA_MAX_RESULTS,u.determinationType="CdpRecordCountFalsey")}else(null===(o=this._lastCdpRecordCounts)||void 0===o?void 0:o.totalRecordCount)>f.ODATA_MAX_RESULTS?(i.totalRecordLimit=this._lastCdpRecordCounts.totalRecordCount,u.determinationType="CountsGreaterThanOData"):i.totalRecordLimit=f.ODATA_MAX_RESULTS;a.Log.trackActivityEvent("CanvasDataProvider_getCapabilities",__assign({name:"CdpTotalRecordLimit"},u))}return i}return{canCreateNewRecords:!1,canPaginate:!1,isEditable:!1,isFilterable:!0,isSortable:!0,hasRecordNavigation:!1}},e.prototype.setSelectedRecordIds=function(e){e=e||[],function(e,t){if(e.length===t.length){var r=__spreadArray([],e,!0).sort(),n=__spreadArray([],t,!0).sort();return r.every((function(e,t){return e===n[Number(t)]}))}return!1}(this._selectedRecordIds,e)||(this._selectedRecordIds=e,this._setSelectedRecordIdsAction(e))},e.prototype.getSelectedRecordIds=function(){return this._selectedRecordIds||[]},e.prototype.clearSelectedRecordIds=function(){this.setSelectedRecordIds([])},e.prototype.getRelatedDataSet=function(e,t,r){throw new Error("Method not implemented.")},e.prototype.destroy=function(){},e.prototype.getRecordById=function(e){return this._cachedRecordsById[e]||Object(f.getRecordFromDatasource)(this._dataSource,e)||null},e.prototype._filterRecordsFromItems=function(e,t,r){var n;void 0===t&&(t=!1);var a=null,o=null==e?void 0:e.dataSource;if(o&&(a=null===(n=o.data)||void 0===n?void 0:n.filter((function(e){return!!e}))),!a&&!(null==e?void 0:e.length))return[];a||(a=null==e?void 0:e.filter((function(e){return!!e})));var i=[];for(var s in a){var c=this._getIdForMatchingRecord(a[s]);if(null!=c)i.push(c);else if(t&&this._isValidRecord(a[s])){var u=this._injectRecordToLocalSource(a[s],r);i.push(u)}}return i},e.prototype._isValidRecord=function(e){for(var t=0,r=this._columns.map((function(e){return e.name}));t<r.length;t++){var n=r[t];if(!e.hasOwnProperty(n))return!1}return!0},e.prototype._injectRecordToLocalSource=function(t,r){var n=e.INJECTED_RECORD_PREFIX+this._dummyRecordIdIndex,a=new g.DataSetEntityRecord(null,t,null,"",this._aliasMap,n,!1);return this._cachedRecordsById[n]=a,r&&(r.records[n]=a,r.sortedRecordIds.push(n)),this._dummyRecordIdIndex++,n},e.prototype._getIdForMatchingRecord=function(e){var t,r=Object(f.getRecordId)(e,this._dataSource);if(this._cachedRecordsById){for(var n in this._cachedRecordsById){var a=null==(l=this._cachedRecordsById[n])?void 0:l.getRecord();if(this._areRecordsSame(e,a||l))return n}r&&(t=this._cachedRecordsById[r]&&r||null)}if(!t)if(r)t=Object(f.getRecordFromDatasource)(this._dataSource,r)&&r||null;else for(var o=Object(f.getPrimaryKeyFromTable)(this._dataSource),i=AppMagic.Constants.Runtime.idProperty,s=AppMagic.Data.DataEntityRecord.entityMetadataPropertyName,c=this._dataSource,u=0;u<c.length;u++){var l=c[u];if(this._areRecordsSame(e,l))return(l[o]||l[i]||l[s]||u).toString()}return t},e.prototype._areRecordsSame=function(e,t){var r=this;if(e===t)return!0;return AppMagic.Data.Record.Utility.isSameRecord(e,t,(function(){var e;return null!==(e=r._columns.map((function(e){return e.name})))&&void 0!==e?e:[]}),(function(e,t){return t.getValue?t.getValue(e):t[e]}))},e.prototype.saveMultipleRecords=function(e){throw new Error("Method not implemented.")},e.prototype.getViewId=function(){var e;return null===(e=this._currentView)||void 0===e?void 0:e.id},e.prototype.getTitle=function(){var e;return null===(e=this._currentView)||void 0===e?void 0:e.name},e.prototype.getEntityDisplayName=function(){var e,t,r=this._dataSource;return null!==(t=null===(e=null==r?void 0:r.dataSource)||void 0===e?void 0:e.name)&&void 0!==t?t:""},e.prototype._tryGetView=function(e){var t,r,n,a,o;if(e){var i=this._dataSource;if("default.cds"===(null===(t=null==i?void 0:i.dataSource)||void 0===t?void 0:t.datasetName)){var s=null===(n=null===(r=null==i?void 0:i.dataSource)||void 0===r?void 0:r.tryGetTableMetadata)||void 0===n?void 0:n.call(r),c=(null===(a=null==s?void 0:s.viewSet)||void 0===a?void 0:a.views)||[],u=null===(o=s.viewSet)||void 0===o?void 0:o.viewsNotSupportingBinary,l=Object(m.getCdsViewIdFromFilterQuery)(e);if(l){for(var d in c)if(c[d].id===l)return c[d];return{id:l,name:u[l]}}}}return null},e.INJECTED_RECORD_PREFIX="INJECT",e}()},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.localeNumberFormatter=t.numberFormatter=t.dateFormatter=t.FormatValue=void 0;var a=r(222),o=r(218),i=r(219),s=r(223),c=r(125),u=String.fromCharCode(41);t.FormatValue=function(e,t,r){if(null==e)return null;switch(t.Type){case o.AttributeType.Boolean:return h(e,t);case o.AttributeType.Date:return l(e,r,t.Behavior);case o.AttributeType.DateTime:var n=t,a=void 0;return!(2===n.Behavior||"DateOnly"===n.Format)&&r&&(a=r.dateTimeFormat.ShortDatePattern+" "+r.dateTimeFormat.ShortTimePattern),l(e,r,n.Behavior,a);case o.AttributeType.Decimal:case o.AttributeType.Double:return d(e,r,t.Precision);case o.AttributeType.Integer:switch(t.Format){case"TimeZone":return y(e,r);case"Language":return g(e);default:return d(e,r,0)}default:return null}};var l=function(e,t,r,a){if(!t)return null;if(!c.parseDateToISO(e,t))return null;var o=new Date(Date.parse(e));return 2!==r&&3!==r||(o=function(e){if(!e)return e;var t=6e4*e.getTimezoneOffset();return new Date(e.getTime()+t)}(o)),i.localeFormatDate(o,a||t.dateTimeFormat.ShortDatePattern,n({name:"name"},t))};t.dateFormatter=l;var d=function(e,t,r){var n=c.parseNumber(e);return null!==n&&t?s.expandNumber(n,null!=r?r:t.numberFormat.NumberDecimalDigits,t.numberFormat.NumberGroupSizes,t.numberFormat.NumberGroupSeparator,t.numberFormat.NumberDecimalSeparator):null};function p(e,t,r){return s.localeFormatNumber(e,"N"+(null!=r?r:t.numberFormat.NumberDecimalDigits),n({name:"custom"},t))}function f(e,t,r){var n=p(Math.abs(e),t,r);return function(e,t){switch(e){case 1:return"-"+t;case 2:return"-"+u+t;case 3:return t+"-";case 4:return""+t+u+"-";default:return"("+t+")"}}(t.numberFormat.NumberNegativePattern,n)}t.numberFormatter=d;t.localeNumberFormatter=function(e,t,r){var n=c.parseNumber(e);return null!==n&&t?n<0?f(n,t,r):p(n,t,r):null};var y=function(e,t){var r=c.parseNumber(e);if(null===r||!t)return null;var n=t.timeZoneDefinitions.find((function(e){return e.TimeZoneCode===r}));return n?n.UserInterfaceName:r.toString()},g=function(e){var t=c.parseNumber(e);return null===t?null:a.instance.getLocalizedString("languages.lang_"+t,[])},h=function(e,t){var r,n=t.Options,a="boolean"==typeof e?e?1:0:c.parseNumber(e);if(null===a||!n)return null;var o=n.find((function(e){return e.Value===a}));return null!==(r=null==o?void 0:o.Label)&&void 0!==r?r:null}},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.AttributeType=void 0,function(e){e.Boolean="boolean",e.Unknown="unknown",e.Customer="customer",e.Date="date",e.DateTime="datetime",e.Decimal="decimal",e.Double="double",e.Image="image",e.Integer="integer",e.Lookup="lookup",e.ManagedProperty="managedproperty",e.Memo="memo",e.Money="money",e.Owner="owner",e.PartyList="partylist",e.PickList="picklist",e.State="state",e.Status="status",e.String="string",e.UniqueIdentifier="uniqueidentifier",e.CalendarRules="calendarrules",e.Virtual="virtual",e.BigInt="bigint",e.EntityName="entityname",e.EntityImage="entityimage",e.AliasedValue="aliasedvalue",e.Regarding="regarding",e.MultiSelectPickList="multiselectpicklist",e.File="file",e.NavigationProperty="navigationproperty"}(n||(n={})),t.AttributeType=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseDateTimeString=t.localeFormatDate=t.StringBuilder=void 0;var n=function(){function e(e){this._text="",e&&(this._text=e.toString())}return e.prototype.append=function(e){this._text+=e},e.prototype.toString=function(){return this._text},e}();function a(e,t){return e[t]}function o(e,t){for(var r=0,n=!1,a=0,o=e.length;a<o;a++){var i=e.charAt(a);switch(i){case"'":n?t.append("'"):r++,n=!1;break;case"\\":n&&t.append("\\"),n=!n;break;default:t.append(i),n=!1}}return r}function i(e,t){t||(t="F");var r=t.length;if(1===r)switch(t){case"d":return a(e,"ShortDatePattern");case"D":return a(e,"LongDatePattern");case"t":return a(e,"ShortTimePattern");case"T":return a(e,"LongTimePattern");case"f":return a(e,"LongDatePattern")+" "+a(e,"ShortTimePattern");case"F":return a(e,"FullDateTimePattern");case"M":case"m":return a(e,"MonthDayPattern");case"s":return a(e,"SortableDateTimePattern");case"Y":case"y":return a(e,"YearMonthPattern");default:throw Error("Sys.Res.formatInvalidString")}else 2===r&&"%"===t.charAt(0)&&(t=t.charAt(1));return t}function s(e,t){if(!t)return 0;for(var r,n=e.getTime(),a=0;t[a];a+=4)if(null===(r=t[a+2])||n>=r)return a;return 0}function c(e,t,r,n){var o=e.getFullYear();return!n&&a(t,"eras")&&(o-=a(t,"eras")[r+3]),o}function u(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g}function l(e){return e.split("").join(" ").toUpperCase()}function d(e){for(var t=[],r=0,n=e.length;r<n;r++)t[r]=l(e[r]);return t}function p(e,t,r){var n=l(e),a=t.indexOf(n);return-1===a&&(a=r.indexOf(n)),a}function f(e,t){return p(t,d(e.dateTimeFormat.MonthNames),d(e.dateTimeFormat.MonthGenitiveNames))}function y(e,t){return p(t,d(a(e.dateTimeFormat,"AbbreviatedMonthNames")),d(a(e.dateTimeFormat,"AbbreviatedMonthGenitiveNames")))}function g(e,t){return d(a(e.dateTimeFormat,"DayNames")).indexOf(l(t))}function h(e,t){return d(a(e.dateTimeFormat,"AbbreviatedDayNames")).indexOf(l(t))}function m(e,t){var r=new Date,n=s(r,a(e,"eras"));if(t<100){var o=c(r,e,n);(t+=o-o%100)>a(a(e,"Calendar"),"TwoDigitYearMax")&&(t-=100)}return t}t.StringBuilder=n,t.localeFormatDate=function(e,t,r){return function e(t,r,l){var d=l.dateTimeFormat,p=a(d,"Calendar").convert;if(!r||!r.length||"i"===r){if(l&&l.name.length){if(p)return e(t,a(d,"FullDateTimePattern"),l);var f=new Date(t.getTime()),y=s(t,a(d,"eras"));return f.setFullYear(c(t,d,y)),f.toLocaleString()}return t.toString()}var g=a(d,"eras"),h="s"===r;r=i(d,r);var m,v,b,_=new n;function C(e){return e<10?"0"+e:e.toString()}function A(e){return e<10?"00"+e:e<100?"0"+e:e.toString()}function S(e){return e<10?"000"+e:e<100?"00"+e:e<1e3?"0"+e:e.toString()}var D=/([^d]|^)(d|dd)([^d]|$)/g;function O(){return v||b||(v=D.test(r),b=!0),v}var E,T=0,R=u();function w(e,t){if(E)return E[t];switch(t){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();default:throw new Error("part should be 1 or 2 or 3")}}for(!h&&p&&(E=p.fromGregorian(t));;){var M=R.lastIndex,P=R.exec(r);if(T+=o(r.slice(M,P?P.index:r.length),_),!P)break;if(T%2!=1)switch(P[0]){case"dddd":_.append(a(d,"DayNames")[t.getDay()]);break;case"ddd":_.append(a(d,"AbbreviatedDayNames")[t.getDay()]);break;case"dd":v=!0,_.append(C(w(t,2)));break;case"d":v=!0,_.append(w(t,2).toString());break;case"MMMM":_.append(a(d,"MonthGenitiveNames")&&O()?a(d,"MonthGenitiveNames")[w(t,1)]:a(d,"MonthNames")[w(t,1)]);break;case"MMM":_.append(a(d,"AbbreviatedMonthGenitiveNames")&&O()?a(d,"AbbreviatedMonthGenitiveNames")[w(t,1)]:a(d,"AbbreviatedMonthNames")[w(t,1)]);break;case"MM":_.append(C(w(t,1)+1));break;case"M":_.append((w(t,1)+1).toString());break;case"yyyy":_.append(S(E?E[0]:c(t,d,s(t,g),h)));break;case"yy":_.append(C((E?E[0]:c(t,d,s(t,g),h))%100));break;case"y":_.append(E?E[0].toString():(c(t,d,s(t,g),h)%100).toString());break;case"hh":0===(m=t.getHours()%12)&&(m=12),_.append(C(m));break;case"h":0===(m=t.getHours()%12)&&(m=12),_.append(m.toString());break;case"HH":_.append(C(t.getHours()));break;case"H":_.append(t.getHours().toString());break;case"mm":_.append(C(t.getMinutes()));break;case"m":_.append(t.getMinutes().toString());break;case"ss":_.append(C(t.getSeconds()));break;case"s":_.append(t.getSeconds().toString());break;case"tt":_.append(t.getHours()<12?a(d,"AMDesignator"):a(d,"PMDesignator"));break;case"t":_.append((t.getHours()<12?a(d,"AMDesignator"):a(d,"PMDesignator")).charAt(0));break;case"f":_.append(A(t.getMilliseconds()).charAt(0));break;case"ff":_.append(A(t.getMilliseconds()).substr(0,2));break;case"fff":_.append(A(t.getMilliseconds()));break;case"z":m=t.getTimezoneOffset()/60,_.append((m<=0?"+":"-")+Math.floor(Math.abs(m)));break;case"zz":m=t.getTimezoneOffset()/60,_.append((m<=0?"+":"-")+C(Math.floor(Math.abs(m))));break;case"zzz":m=t.getTimezoneOffset()/60,_.append((m<=0?"+":"-")+C(Math.floor(Math.abs(m)))+":"+C(Math.abs(t.getTimezoneOffset()%60)));break;case"g":case"gg":a(d,"eras")&&_.append(a(d,"eras")[s(t,g)+1]);break;case"/":_.append(a(d,"DateSeparator"));break;default:throw Error("Invalid date format pattern")}else _.append(P[0])}return _.toString()}(e,t,r)},t.parseDateTimeString=function(e,t,r){e=e.trim();var s=r.dateTimeFormat,c=function(e,t){var r=i(e,t);r=r.replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");for(var a=new n("^"),s=[],c=0,l=0,d=u(),p=d.exec(r);null!==p;){var f=r.slice(c,p.index);if(c=d.lastIndex,(l+=o(f,a))%2!=1){switch(p[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gg":case"g":a.append("(\\D+)");break;case"tt":case"t":a.append("(\\D*)");break;case"yyyy":a.append("(\\d{4})");break;case"fff":a.append("(\\d{3})");break;case"ff":a.append("(\\d{2})");break;case"f":a.append("(\\d)");break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":a.append("(\\d\\d?)");break;case"zzz":a.append("([+-]?\\d\\d?:\\d{2})");break;case"zz":case"z":a.append("([+-]?\\d\\d?)");break;case"/":a.append("(\\/)");break;case".":a.append("(\\.)");break;case"-":a.append("(\\-)");break;default:throw Error("Invalid date format pattern")}s.push(p[0]),p=d.exec(r)}else a.append(p[0])}return o(r.slice(c),a),a.append("$"),{regExp:a.toString().replace(/\s+/g,"\\s+"),groups:s}}(s,t),l=new RegExp(c.regExp).exec(e);if(null===l)return null;for(var d,p=c.groups,v=null,b=null,_=null,C=null,A=null,S=0,D=0,O=0,E=0,T=null,R=!1,w=0,M=p.length;w<M;w++){var P=l[w+1];if(P)switch(p[w]){case"dd":case"d":if((C=parseInt(P,10))<1||C>31)return null;break;case"MMMM":if((_=f(r,P))<0||_>11)return null;break;case"MMM":if((_=y(r,P))<0||_>11)return null;break;case"M":case"MM":if((_=parseInt(P,10)-1)<0||_>11)return null;break;case"y":case"yy":if((b=m(s,parseInt(P,10)))<0||b>9999)return null;break;case"yyyy":if((b=parseInt(P,10))<0||b>9999)return null;break;case"h":case"hh":if(12===(S=parseInt(P,10))&&(S=0),S<0||S>11)return null;break;case"H":case"HH":if((S=parseInt(P,10))<0||S>23)return null;break;case"m":case"mm":if((D=parseInt(P,10))<0||D>59)return null;break;case"s":case"ss":if((O=parseInt(P,10))<0||O>59)return null;break;case"tt":case"t":var F=P.toUpperCase();if(!(R=F===a(s,"PMDesignator").toUpperCase())&&F!==a(s,"AMDesignator").toUpperCase())return null;break;case"f":if((E=100*parseInt(P,10))<0||E>999)return null;break;case"ff":if((E=10*parseInt(P,10))<0||E>999)return null;break;case"fff":if((E=parseInt(P,10))<0||E>999)return null;break;case"dddd":if((A=g(r,P))<0||A>6)return null;break;case"ddd":if((A=h(r,P))<0||A>6)return null;break;case"zzz":var N=P.split(/:/);if(2!==N.length)return null;if((d=parseInt(N[0],10))<-12||d>13)return null;var I=parseInt(N[1],10);if(I<0||I>59)return null;T=60*d+(P.startsWith("-")?-I:I);break;case"z":case"zz":if((d=parseInt(P,10))<-12||d>13)return null;T=60*d;break;case"g":case"gg":var x=P,j=a(s,"eras");if(!x||!j)return null;x=x.toLowerCase().trim();for(var L=0,U=Object.keys(j).length;L<U;L+=4)if(x===j[L+1].toLowerCase()){v=L;break}if(null===v)return null}}var k,V=new Date,B=a(s,"Calendar").convert;if(k=B?B.fromGregorian(V)[0]:V.getFullYear(),null===b?b=k:a(s,"eras")&&(b+=a(s,"eras")[(v||0)+3]),null===_&&(_=0),null===C&&(C=1),B){if(null===(V=B.toGregorian(b,_,C)))return null}else{if(V.setFullYear(b,_,C),V.getDate()!==C)return null;if(null!==A&&V.getDay()!==A)return null}if(R&&S<12&&(S+=12),V.setHours(S,D,O,E),null!==T){var Q=V.getMinutes()-(T+V.getTimezoneOffset());V.setHours(V.getHours()+Q/60,Q%60)}return V}},function(e,t){!function(){e.exports=function(){return this?this:window}()["@pa-client/core-services"]}()},function(e,t,r){r(227),e.exports=r(226)},function(e,t,r){"use strict";r.r(t),r.d(t,"Localizer",(function(){return n})),r.d(t,"instance",(function(){return a}));var n=function(){function e(){}return e.prototype.initWithProvider=function(e){return!a._localizationProvider&&(a._localizationProvider=e,!0)},e.prototype.getLocalizedString=function(e,t){var r=this._localizationProvider?this._localizationProvider.getLocalizedString(e,t):"";return r&&r.length>0?r:""},e}(),a=new n},function(e,t,r){"use strict";function n(e,t){return e[t]}function a(e,t,r){for(var n=e.length;n<t;n++)e=r?"0"+e:e+"0";return e}function o(e,t,r,n,o){var i=r[0],s=1,c=Math.pow(10,t),u=Math.round(e*c)/c;isFinite(u)||(u=e);var l,d=(e=u).toString(),p="",f=d.split(/e/i);d=f[0],l=f.length>1?parseInt(f[1],10):0,f=d.split("."),d=f[0],p=f.length>1?f[1]:"",l>0?(d+=(p=a(p,l,!1)).slice(0,l),p=p.substr(l)):l<0&&(p=(d=a(d,(l=-l)+1,!0)).slice(-l,d.length)+p,d=d.slice(0,-l)),p=t>0?o+(p=p.length>t?p.slice(0,t):a(p,t,!1)):"";for(var y=d.length-1,g="";y>=0;){if(0===i||i>y)return g.length>0?d.slice(0,y+1)+n+g+p:d.slice(0,y+1)+p;g=g.length>0?d.slice(y-i+1,y+1)+n+g:d.slice(y-i+1,y+1),y-=i,s<r.length&&(i=r[s],s++)}return d.slice(0,y+1)+n+g+p}Object.defineProperty(t,"__esModule",{value:!0}),t.zeroPad=t.expandNumber=t.localeFormatNumber=void 0,t.localeFormatNumber=function(e,t,r){return function(e,t,r){if(!t||0===t.length||"i"===t)return r&&r.name.length>0?e.toLocaleString():e.toString();var i=["(n)","-n","- n","n-","n -"],s=r.numberFormat,c=Math.abs(e).toString();t||(t="D");var u,l=-1;switch(t.length>1&&(l=parseInt(t.slice(1),10)),t.charAt(0)){case"d":case"D":u="n",c=Math.abs(Math.floor(e)).toString(),-1!==l&&(c=a(""+c,l,!0)),e<0&&(c=(-c).toString());break;case"f":case"F":u=e<0?i[n(s,"NumberNegativePattern")]:"n",-1===l&&(l=n(s,"NumberDecimalDigits")),c=o(+Math.abs(e).toFixed(l),l,n(s,"NumberGroupSizes"),n(s,"NumberGroupSeparator"),n(s,"NumberDecimalSeparator"));break;case"c":case"C":u=e<0?["($n)","-$n","$-n","$n-","(n$)","-n$","n-$","n$-","-n $","-$ n","n $-","$ n-","$ -n","n- $","($ n)","(n $)"][n(s,"CurrencyNegativePattern")]:["$n","n$","$ n","n $"][n(s,"CurrencyPositivePattern")],-1===l&&(l=n(s,"CurrencyDecimalDigits")),c=o(Math.abs(e),l,n(s,"CurrencyGroupSizes"),n(s,"CurrencyGroupSeparator"),n(s,"CurrencyDecimalSeparator"));break;case"n":case"N":u=e<0?i[n(s,"NumberNegativePattern")]:"n",-1===l&&(l=n(s,"NumberDecimalDigits")),c=o(Math.abs(e),l,n(s,"NumberGroupSizes"),n(s,"NumberGroupSeparator"),n(s,"NumberDecimalSeparator"));break;case"p":case"P":u=e<0?["-n %","-n%","-%n"][n(s,"PercentNegativePattern")]:["n %","n%","%n"][n(s,"PercentPositivePattern")],-1===l&&(l=n(s,"PercentDecimalDigits")),c=o(100*Math.abs(e),l,n(s,"PercentGroupSizes"),n(s,"PercentGroupSeparator"),n(s,"PercentDecimalSeparator"));break;default:throw Error("Sys.Res.formatBadFormatSpecifier")}for(var d=/n|\$|-|%/g,p="";;){var f=d.lastIndex,y=d.exec(u);if(p+=u.slice(f,y?y.index:u.length),!y)break;switch(y[0]){case"n":p+=c;break;case"$":p+=n(s,"CurrencySymbol");break;case"-":/[1-9]/.test(c)&&(p+=n(s,"NegativeSign"));break;case"%":p+=n(s,"PercentSymbol");break;default:throw Error("Invalid number format pattern")}}return p}(e,t,r)},t.zeroPad=a,t.expandNumber=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseNumberWithGroupAndDecimal=void 0,t.parseNumberWithGroupAndDecimal=function(e,t,r){if(null==e||""===e.trim())return null;var n=e.lastIndexOf(r),a="";return-1!==n&&(a=e.slice(n),e=e.slice(0,-a.length)),e=e.split(t).join(""),e=(e+=a).split(r).join("."),Number(function(e){var t=e.includes("-")||e.includes("(")&&e.includes(")");e=e.replace(/\(|\)|\-/g,"").trim(),t&&(e="-"+e);return e}(e))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attributeMetadataToValidatorParams=t.AttributeType=t.RequiredLevel=void 0;var n,a=r(218);Object.defineProperty(t,"AttributeType",{enumerable:!0,get:function(){return a.AttributeType}}),function(e){e[e.None=0]="None",e[e.SystemRequired=1]="SystemRequired",e[e.ApplicationRequired=2]="ApplicationRequired",e[e.Recommended=3]="Recommended"}(n=t.RequiredLevel||(t.RequiredLevel={}));t.attributeMetadataToValidatorParams=function(e){var t=e.Type;switch(e.Type){case a.AttributeType.String:"Email"===e.Format&&(t="Email");break;case a.AttributeType.Date:case a.AttributeType.DateTime:"DateOnly"===e.Format&&(t="DateOnly");break;case a.AttributeType.Integer:t="Integer"}var r={dataType:t,required:e.RequiredLevel===n.SystemRequired||e.RequiredLevel===n.ApplicationRequired};return r.maxLength=e.MaxLength,r.maxValue=e.MaxValue,r.minValue=e.MinValue,r}},function(e,t,r){"use strict";r.r(t);var n=r(137);r.d(t,"AppCommander",(function(){return n.AppCommander})),r.d(t,"IAppToHostCommandDelegatedExecutor",(function(){return n.IAppToHostCommandDelegatedExecutor}));var a=r(185);r.d(t,"AppExternalMessageManager",(function(){return a.AppExternalMessageManager}));var o=r(186);r.d(t,"IARViewerPluginSingletonKey",(function(){return o.IARViewerPluginSingletonKey}));var i=r(101);r.d(t,"ARViewCapability",(function(){return i.ARViewCapability})),r.d(t,"ARViewerOptions",(function(){return i.ARViewerOptions})),r.d(t,"IARViewerPlugin",(function(){return i.IARViewerPlugin}));var s=r(98);r.d(t,"ISendMessagePluginSingletonKey",(function(){return s.ISendMessagePluginSingletonKey}));var c=r(190);r.d(t,"ISendMessagePlugin",(function(){return c.ISendMessagePlugin}));var u=r(117);r.d(t,"CacheDataChangeManager",(function(){return u.CacheDataChangeManager}));var l=r(121);r.d(t,"Beta3XmlParsingStrategy",(function(){return l.Beta3XmlParsingStrategy}));var d=r(187);r.d(t,"DataStateProcessor",(function(){return d.DataStateProcessor}));var p=r(17);r.d(t,"FileDataProcessor",(function(){return p.FileDataProcessor}));var f=r(88);r.d(t,"FolderPacker",(function(){return f.FolderPacker}));var y=r(217);r.d(t,"ISaxNodeObject",(function(){return y.ISaxNodeObject}));var g=r(71);r.d(t,"IDataRoot",(function(){return g.IDataRoot})),r.d(t,"IMediaInfoEntry",(function(){return g.IMediaInfoEntry})),r.d(t,"ISaxError",(function(){return g.ISaxError})),r.d(t,"ISerializedEntityMetadata",(function(){return g.ISerializedEntityMetadata})),r.d(t,"ISerializedMetadataItem",(function(){return g.ISerializedMetadataItem})),r.d(t,"IXmlBaseDataFormat",(function(){return g.IXmlBaseDataFormat})),r.d(t,"IZipData",(function(){return g.IZipData}));var h=r(7);r.d(t,"assetsFolder",(function(){return h.assetsFolder})),r.d(t,"assetsFolderName",(function(){return h.assetsFolderName})),r.d(t,"assetsListFileName",(function(){return h.assetsListFileName})),r.d(t,"attrName",(function(){return h.attrName})),r.d(t,"attrType",(function(){return h.attrType})),r.d(t,"dataFileName",(function(){return h.dataFileName})),r.d(t,"entityMetadataFileName",(function(){return h.entityMetadataFileName})),r.d(t,"errorFileName",(function(){return h.errorFileName})),r.d(t,"headerFileName",(function(){return h.headerFileName})),r.d(t,"invariantNameKey",(function(){return h.invariantNameKey})),r.d(t,"msImpexAppDataScheme",(function(){return h.msImpexAppDataScheme})),r.d(t,"schemaFileName",(function(){return h.schemaFileName})),r.d(t,"tagApplicationData",(function(){return h.tagApplicationData})),r.d(t,"tagCell",(function(){return h.tagCell})),r.d(t,"tagData",(function(){return h.tagData})),r.d(t,"tagEntityMetadata",(function(){return h.tagEntityMetadata})),r.d(t,"tagRecord",(function(){return h.tagRecord})),r.d(t,"tagRow",(function(){return h.tagRow})),r.d(t,"tagTable",(function(){return h.tagTable})),r.d(t,"xmlFileName",(function(){return h.xmlFileName}));var m=r(188);r.d(t,"SaveDataCurrentVersion",(function(){return m.SaveDataCurrentVersion}));var v=r(30);r.d(t,"ExportNullDataError",(function(){return v.ExportNullDataError})),r.d(t,"ExportUnknownError",(function(){return v.ExportUnknownError})),r.d(t,"ExportUpdateError",(function(){return v.ExportUpdateError})),r.d(t,"ImportCorruptedZipError",(function(){return v.ImportCorruptedZipError})),r.d(t,"ImportInvalidJSONError",(function(){return v.ImportInvalidJSONError})),r.d(t,"ImportInvalidXMLError",(function(){return v.ImportInvalidXMLError})),r.d(t,"ImportJsonNotFoundError",(function(){return v.ImportJsonNotFoundError})),r.d(t,"ImportNoSchemaError",(function(){return v.ImportNoSchemaError})),r.d(t,"ImportUnknownError",(function(){return v.ImportUnknownError})),r.d(t,"ImportXMLNotFoundError",(function(){return v.ImportXMLNotFoundError}));var b=r(102);r.d(t,"InSufficientMemorySaveDataError",(function(){return b.InSufficientMemorySaveDataError})),r.d(t,"QuotaExceedsSaveDataError",(function(){return b.QuotaExceedsSaveDataError})),r.d(t,"UnsupportedStorageSaveDataError",(function(){return b.UnsupportedStorageSaveDataError}));var _=r(103);r.d(t,"JSZipLoader",(function(){return _.JSZipLoader}));var C=r(122);r.d(t,"XmlParsingStrategyBase",(function(){return C.XmlParsingStrategyBase}));var A=r(27);r.d(t,"parseReplacer",(function(){return A.parseReplacer})),r.d(t,"processData",(function(){return A.processData})),r.d(t,"stringfyReplacer",(function(){return A.stringfyReplacer})),r.d(t,"updateEnumerable",(function(){return A.updateEnumerable}));var S=r(52);r.d(t,"ZipPacker",(function(){return S.ZipPacker}));var D=r(118);r.d(t,"DynamicJsonSchemaTTypeManager",(function(){return D.DynamicJsonSchemaTTypeManager}));var O=r(138);r.d(t,"isTelemetryConfigValid",(function(){return O.isTelemetryConfigValid})),r.d(t,"AppMagicRuntimeAppExpressionRuntimeConfig_isValid",(function(){return O.isValid}));var E=r(40);r.d(t,"doesFunctionExist",(function(){return E.doesFunctionExist})),r.d(t,"executeFunction",(function(){return E.executeFunction})),r.d(t,"executeFunctionAsync",(function(){return E.executeFunctionAsync})),r.d(t,"getArgValue",(function(){return E.getArgValue})),r.d(t,"getFunctionArgs",(function(){return E.getFunctionArgs})),r.d(t,"getFunctionNamespace",(function(){return E.getFunctionNamespace})),r.d(t,"registerFunction",(function(){return E.registerFunction})),r.d(t,"unRegisterFunction",(function(){return E.unRegisterFunction})),r.d(t,"unRegisterNamespace",(function(){return E.unRegisterNamespace}));var T=r(124);r.d(t,"UserDefinedFunctionNamespace",(function(){return T.UserDefinedFunctionNamespace}));var R=r(189);r.d(t,"UserDefinedFunctionNamespaceManager",(function(){return R.UserDefinedFunctionNamespaceManager}));var w=r(81);r.d(t,"IFunctionArgs",(function(){return w.IFunctionArgs})),r.d(t,"UserDefinedFunc",(function(){return w.UserDefinedFunc})),r.d(t,"UserDefinedFunction",(function(){return w.UserDefinedFunction}));var M=r(141);r.d(t,"IDynamicTypeInfoTelemetryContext",(function(){return M.IDynamicTypeInfoTelemetryContext})),r.d(t,"INavigationStackEntry",(function(){return M.INavigationStackEntry}));var P=r(142);r.d(t,"IHostControlDefinition",(function(){return P.IHostControlDefinition})),r.d(t,"IHostControlPropertyDefinition",(function(){return P.IHostControlPropertyDefinition}));var F=r(53);r.d(t,"NamedObjectNotFoundError",(function(){return F.NamedObjectNotFoundError}));var N=r(191);r.d(t,"NonExistentFileFlagError",(function(){return N.NonExistentFileFlagError}));var I=r(192);r.d(t,"NoopRuntimeFunctionsHelper",(function(){return I.NoopRuntimeFunctionsHelper}));var x=r(193);r.d(t,"ScopeMonitor",(function(){return x.ScopeMonitor}));var j=r(46);r.d(t,"CompositeScopeTracker",(function(){return j.CompositeScopeTracker})),r.d(t,"DataScopeTracker",(function(){return j.DataScopeTracker})),r.d(t,"IScopeTracker",(function(){return j.IScopeTracker})),r.d(t,"PrimitiveScopeTracker",(function(){return j.PrimitiveScopeTracker})),r.d(t,"ScopeTracker",(function(){return j.ScopeTracker}));var L=r(128);r.d(t,"AsyncUserResponse",(function(){return L.AsyncUserResponse})),r.d(t,"UserResponseStatus",(function(){return L.UserResponseStatus}));var U=r(144);r.d(t,"AuthenticationCache",(function(){return U.AuthenticationCache}));var k=r(83);r.d(t,"AppDataset",(function(){return k.AppDataset}));var V=r(72);r.d(t,"AppDataSource",(function(){return V.AppDataSource})),r.d(t,"IDataSourceEventDetails",(function(){return V.IDataSourceEventDetails}));var B=r(35);r.d(t,"AppDataSourceError",(function(){return B.AppDataSourceError})),r.d(t,"IAppDataSourceErrorParams",(function(){return B.IAppDataSourceErrorParams}));var Q=r(107);r.d(t,"AppDataSourceOnDataLoadEventManager",(function(){return Q.AppDataSourceOnDataLoadEventManager}));var K=r(146);r.d(t,"AppDataSourcesManager",(function(){return K.AppDataSourcesManager}));var q=r(145);r.d(t,"AppDatasetManager",(function(){return q.AppDatasetManager}));var G=r(29);r.d(t,"addToAttachmentTable",(function(){return G.addToAttachmentTable})),r.d(t,"copyAttachmentTable",(function(){return G.copyAttachmentTable})),r.d(t,"createStagedAttachmentRecord",(function(){return G.createStagedAttachmentRecord})),r.d(t,"deleteAttachment",(function(){return G.deleteAttachment})),r.d(t,"getDeletedAttachments",(function(){return G.getDeletedAttachments})),r.d(t,"getStagedAttachments",(function(){return G.getStagedAttachments})),r.d(t,"isAttachmentTable",(function(){return G.isAttachmentTable})),r.d(t,"isValidAttachment",(function(){return G.isValidAttachment})),r.d(t,"isValidServiceAttachment",(function(){return G.isValidServiceAttachment})),r.d(t,"isValidStagedAttachment",(function(){return G.isValidStagedAttachment})),r.d(t,"AppMagicDataAttachments_safeCast",(function(){return G.safeCast})),r.d(t,"undoDeleteAttachment",(function(){return G.undoDeleteAttachment}));var H=r(109);r.d(t,"CachedQueryData",(function(){return H.CachedQueryData}));var z=r(62);r.d(t,"CacheBehaviorFlags",(function(){return z.CacheBehaviorFlags})),r.d(t,"CachedQueryDataProvider",(function(){return z.CachedQueryDataProvider})),r.d(t,"DataExpirationDefaultTimeoutInMS",(function(){return z.DataExpirationDefaultTimeoutInMS})),r.d(t,"LongLivingDataExpirationTimeoutInMS",(function(){return z.LongLivingDataExpirationTimeoutInMS}));var J=r(110);r.d(t,"CachedQueryDataRequest",(function(){return J.CachedQueryDataRequest}));var W=r(194);r.d(t,"CanvasDataProvider",(function(){return W.CanvasDataProvider}));var Z=r(26);r.d(t,"convertToDataSetMetadata",(function(){return Z.convertToDataSetMetadata})),r.d(t,"getAttributeMetadataAsync",(function(){return Z.getAttributeMetadataAsync})),r.d(t,"getIPcfQueryResult",(function(){return Z.getIPcfQueryResult})),r.d(t,"schemaToPcfType",(function(){return Z.schemaToPcfType})),r.d(t,"tryGetPrimaryColumnName",(function(){return Z.tryGetPrimaryColumnName}));var X=r(64);r.d(t,"convertPcfToQueryFilter",(function(){return X.convertPcfToQueryFilter})),r.d(t,"AppMagicDataCanvasDataProviderQueryMergeUtilities_mergeQueryOptions",(function(){return X.mergeQueryOptions})),r.d(t,"pageDataRecords",(function(){return X.pageDataRecords}));var $=r(95);r.d(t,"CdpDataSource",(function(){return $.CdpDataSource}));var Y=r(73);r.d(t,"AppMagicServicesCdpGetRowsResponseParamBuilder_createGetRowsResponse",(function(){return Y.createGetRowsResponse})),r.d(t,"AppMagicServicesCdpGetRowsResponseParamBuilder_createResponseItemType",(function(){return Y.createResponseItemType}));var ee=r(39);r.d(t,"CdsDataSource",(function(){return ee.CdsDataSource}));var te=r(84);r.d(t,"CdsDataset",(function(){return te.CdsDataset}));var re=r(148);r.d(t,"NativeCdsMetadataProvider",(function(){return re.NativeCdsMetadataProvider}));var ne=r(147);r.d(t,"MdlCdsMetadataProvider",(function(){return ne.MdlCdsMetadataProvider}));var ae=r(86);r.d(t,"AppMagicDataCdsError_isValid",(function(){return ae.isValid})),r.d(t,"AppMagicDataCdsError_safeCast",(function(){return ae.safeCast}));var oe=r(58);r.d(t,"AppMagicDataCdsErrorResponse_isValid",(function(){return oe.isValid})),r.d(t,"AppMagicDataCdsErrorResponse_safeCast",(function(){return oe.safeCast})),r.d(t,"tryGetCDSErrorFromError",(function(){return oe.tryGetCDSErrorFromError}));var ie=r(93);r.d(t,"RetrieveOrganizationInfoFunctionName",(function(){return ie.RetrieveOrganizationInfoFunctionName})),r.d(t,"getRetrieveOrganizationInfoFunctionDefinition",(function(){return ie.getRetrieveOrganizationInfoFunctionDefinition}));var se=r(90);r.d(t,"AppMagicServicesCdsGetRowsResponseParamBuilder_createGetRowsResponse",(function(){return se.createGetRowsResponse})),r.d(t,"AppMagicServicesCdsGetRowsResponseParamBuilder_createResponseItemType",(function(){return se.createResponseItemType}));var ce=r(92);r.d(t,"AppMagicDataCdsInnerError_isValid",(function(){return ce.isValid})),r.d(t,"AppMagicDataCdsInnerError_safeCast",(function(){return ce.safeCast}));var ue=r(57);r.d(t,"getCdsViewIdFromFilterQuery",(function(){return ue.getCdsViewIdFromFilterQuery})),r.d(t,"isValidFilterQuery",(function(){return ue.isValidFilterQuery}));var le=r(60);r.d(t,"CollectionDataSource",(function(){return le.CollectionDataSource}));var de=r(151);r.d(t,"AppMagicDataConnectedDataGetRowsResponse_isValid",(function(){return de.isValid}));var pe=r(42);r.d(t,"CreateCdpQueryStringBuilder",(function(){return pe.CreateCdpQueryStringBuilder})),r.d(t,"CreateCdsQueryStringBuilder",(function(){return pe.CreateCdsQueryStringBuilder})),r.d(t,"IConnectedDataQueryStringBuilder",(function(){return pe.IConnectedDataQueryStringBuilder}));var fe=r(152);r.d(t,"doesFilterEvaluateToFalse",(function(){return fe.doesFilterEvaluateToFalse}));var ye=r(66);r.d(t,"ConnectedDataQueryStringBuilderError",(function(){return ye.ConnectedDataQueryStringBuilderError}));var ge=r(114);r.d(t,"ConnectedDataSourceLookupColumnReference",(function(){return ge.ConnectedDataSourceLookupColumnReference}));var he=r(115);r.d(t,"ConnectedDataTypesManager",(function(){return he.ConnectedDataTypesManager}));var me=r(113);r.d(t,"DataComponentDataSource",(function(){return me.DataComponentDataSource}));var ve=r(129);r.d(t,"deserializeData",(function(){return ve.deserializeData})),r.d(t,"serializeData",(function(){return ve.serializeData}));var be=r(77);r.d(t,"DataSetEntityRecord",(function(){return be.DataSetEntityRecord}));var _e=r(49);r.d(t,"GetValidator",(function(){return _e.GetValidator})),r.d(t,"IValidatorResult",(function(){return _e.IValidatorResult})),r.d(t,"RawFieldTypes",(function(){return _e.RawFieldTypes})),r.d(t,"UnitValidator",(function(){return _e.UnitValidator})),r.d(t,"ValidationError",(function(){return _e.ValidationError})),r.d(t,"ValidationResult",(function(){return _e.ValidationResult})),r.d(t,"Validator",(function(){return _e.Validator}));var Ce=r(10);r.d(t,"columnGenerated",(function(){return Ce.columnGenerated})),r.d(t,"columnInvalidForUpdate",(function(){return Ce.columnInvalidForUpdate})),r.d(t,"columnReadOnly",(function(){return Ce.columnReadOnly})),r.d(t,"columnValueInvalid",(function(){return Ce.columnValueInvalid})),r.d(t,"createCustomError",(function(){return Ce.createCustomError})),r.d(t,"createPermissionDenied",(function(){return Ce.createPermissionDenied})),r.d(t,"deletePermissionDenied",(function(){return Ce.deletePermissionDenied})),r.d(t,"AppMagicDataDataSourceError_dispose",(function(){return Ce.dispose})),r.d(t,"editPermissionDenied",(function(){return Ce.editPermissionDenied})),r.d(t,"formatDataSourceError",(function(){return Ce.formatDataSourceError})),r.d(t,"fromConnectorError",(function(){return Ce.fromConnectorError})),r.d(t,"rowExists",(function(){return Ce.rowExists})),r.d(t,"rowNotFound",(function(){return Ce.rowNotFound}));var Ae=r(14);r.d(t,"add",(function(){return Ae.add})),r.d(t,"AppMagicDataDataSourceErrorTable_create",(function(){return Ae.create})),r.d(t,"AppMagicDataDataSourceErrorTable_dispose",(function(){return Ae.dispose}));var Se=r(11);r.d(t,"getAppDataSource",(function(){return Se.getAppDataSource})),r.d(t,"getDataSourceKind",(function(){return Se.getDataSourceKind})),r.d(t,"getDataSourceName",(function(){return Se.getDataSourceName})),r.d(t,"getDataSourcePluginType",(function(){return Se.getDataSourcePluginType})),r.d(t,"hasMetadata",(function(){return Se.hasMetadata})),r.d(t,"isDataSourceMutable",(function(){return Se.isDataSourceMutable})),r.d(t,"isDataSourceRefreshable",(function(){return Se.isDataSourceRefreshable})),r.d(t,"isDataSourceRenameable",(function(){return Se.isDataSourceRenameable})),r.d(t,"isPrivatePropertyName",(function(){return Se.isPrivatePropertyName})),r.d(t,"AppMagicDataDataSourceValue_isValid",(function(){return Se.isValid})),r.d(t,"isValidData",(function(){return Se.isValidData})),r.d(t,"removeMetadataProperties",(function(){return Se.removeMetadataProperties})),r.d(t,"renameDataSource",(function(){return Se.renameDataSource})),r.d(t,"setAppDataSource",(function(){return Se.setAppDataSource})),r.d(t,"setDynamicDataSourceName",(function(){return Se.setDynamicDataSourceName})),r.d(t,"setMeta",(function(){return Se.setMeta})),r.d(t,"tryGetAppDataSource",(function(){return Se.tryGetAppDataSource}));var De=r(87);r.d(t,"AppMagicDataDynamicDataSource_addMetadata",(function(){return De.addMetadata})),r.d(t,"createInitialData",(function(){return De.createInitialData}));var Oe=r(4);r.d(t,"DataRuntimeEvent",(function(){return Oe.DataRuntimeEvent})),r.d(t,"DataSourceKind",(function(){return Oe.DataSourceKind})),r.d(t,"PcfTypes",(function(){return Oe.PcfTypes}));var Ee=r(196);r.d(t,"IAppDatasetManager",(function(){return Ee.IAppDatasetManager}));var Te=r(126);r.d(t,"IAttachmentDataRecord",(function(){return Te.IAttachmentDataRecord})),r.d(t,"IAttachmentDataTable",(function(){return Te.IAttachmentDataTable})),r.d(t,"IAttachmentEntityRecord",(function(){return Te.IAttachmentEntityRecord}));var Re=r(197);r.d(t,"ICdpConnectorManager",(function(){return Re.ICdpConnectorManager}));var we=r(127);r.d(t,"ICdsError",(function(){return we.ICdsError})),r.d(t,"ICdsErrorResponse",(function(){return we.ICdsErrorResponse})),r.d(t,"ICdsInnerError",(function(){return we.ICdsInnerError}));var Me=r(54);r.d(t,"BatchInfo",(function(){return Me.BatchInfo})),r.d(t,"ICdpConnector",(function(){return Me.ICdpConnector})),r.d(t,"ICdsConnector",(function(){return Me.ICdsConnector})),r.d(t,"TabularConnectorType",(function(){return Me.TabularConnectorType})),r.d(t,"IConnectedDataConnector",(function(){return Me.IConnectedDataConnector})),r.d(t,"IConnectorTypeName",(function(){return Me.IConnectorTypeName})),r.d(t,"ICopilotConnector",(function(){return Me.ICopilotConnector})),r.d(t,"IODataConnector",(function(){return Me.IODataConnector})),r.d(t,"ICdsDataSetConnector",(function(){return Me.ICdsDataSetConnector}));var Pe=r(198);r.d(t,"IDataChangedProvider",(function(){return Pe.IDataChangedProvider}));var Fe=r(74);r.d(t,"clone",(function(){return Fe.clone}));var Ne=r(139);r.d(t,"IDataSourceError",(function(){return Ne.IDataSourceError})),r.d(t,"IDataSourceErrorTable",(function(){return Ne.IDataSourceErrorTable}));var Ie=r(199);r.d(t,"IDataSourceValueMetadata",(function(){return Ie.IDataSourceValueMetadata}));var xe=r(23);r.d(t,"AppMagicDataDataTable_isValid",(function(){return xe.isValid})),r.d(t,"AppMagicDataDataTable_safeCast",(function(){return xe.safeCast})),r.d(t,"setLastGetRowsResponse",(function(){return xe.setLastGetRowsResponse})),r.d(t,"tryGetLastGetRowsResponse",(function(){return xe.tryGetLastGetRowsResponse}));var je=r(33);r.d(t,"IFileDataRecord",(function(){return je.IFileDataRecord})),r.d(t,"IImageDataRecord",(function(){return je.IImageDataRecord})),r.d(t,"isFileDataRecord",(function(){return je.isFileDataRecord})),r.d(t,"isImageDataRecord",(function(){return je.isImageDataRecord})),r.d(t,"isValidFileDataRecord",(function(){return je.isValidFileDataRecord})),r.d(t,"isValidImageDataRecord",(function(){return je.isValidImageDataRecord}));var Le=r(200);r.d(t,"ILookupColumnReference",(function(){return Le.ILookupColumnReference}));var Ue=r(201);r.d(t,"IQueriedScalar",(function(){return Ue.IQueriedScalar}));var ke=r(91);r.d(t,"IStorageEntry",(function(){return ke.IStorageEntry})),r.d(t,"MemoryStorage",(function(){return ke.MemoryStorage}));var Ve=r(44);r.d(t,"NavigatedQueriedTable",(function(){return Ve.NavigatedQueriedTable})),r.d(t,"CdpNavigatedQueriedTable",(function(){return Ve.CdpNavigatedQueriedTable})),r.d(t,"CdsNavigatedQueriedTable",(function(){return Ve.CdsNavigatedQueriedTable}));var Be=r(50);r.d(t,"CDPFunctionQueryStringBuilder",(function(){return Be.CDPFunctionQueryStringBuilder})),r.d(t,"IFunctionQueryStringBuilder",(function(){return Be.IFunctionQueryStringBuilder})),r.d(t,"formatAggregateCount",(function(){return Be.formatAggregateCount})),r.d(t,"formatCdsUnfilteredCount",(function(){return Be.formatCdsUnfilteredCount})),r.d(t,"isCountFunction",(function(){return Be.isCountFunction})),r.d(t,"isUnfilteredCountFunction",(function(){return Be.isUnfilteredCountFunction}));var Qe=r(19);r.d(t,"AppMagicDataOperationResult_create",(function(){return Qe.create})),r.d(t,"createErrors",(function(){return Qe.createErrors})),r.d(t,"createSingleError",(function(){return Qe.createSingleError}));var Ke=r(55);r.d(t,"isOptionSetTable",(function(){return Ke.isOptionSetTable})),r.d(t,"isValidOptionSetData",(function(){return Ke.isValidOptionSetData})),r.d(t,"isValidOptionSetTable",(function(){return Ke.isValidOptionSetTable})),r.d(t,"AppMagicDataOptionSet_safeCast",(function(){return Ke.safeCast})),r.d(t,"tryGetOptionSetData",(function(){return Ke.tryGetOptionSetData}));var qe=r(96);r.d(t,"isValidOptionSetDataRecord",(function(){return qe.isValidOptionSetDataRecord})),r.d(t,"AppMagicDataOptionSetDataRecord_safeCast",(function(){return qe.safeCast}));var Ge=r(20);r.d(t,"IPcfAttributeMetadata",(function(){return Ge.IPcfAttributeMetadata})),r.d(t,"IPcfColumnInfo",(function(){return Ge.IPcfColumnInfo})),r.d(t,"IPcfDataProvider",(function(){return Ge.IPcfDataProvider})),r.d(t,"IPcfDataProviderCapabilities",(function(){return Ge.IPcfDataProviderCapabilities})),r.d(t,"IPcfDataSet",(function(){return Ge.IPcfDataSet})),r.d(t,"IPcfDataSetColumn",(function(){return Ge.IPcfDataSetColumn})),r.d(t,"IPcfDataSetEntityRecord",(function(){return Ge.IPcfDataSetEntityRecord})),r.d(t,"IPcfDataSetMetadata",(function(){return Ge.IPcfDataSetMetadata})),r.d(t,"IPcfDateTimeFieldBehavior",(function(){return Ge.IPcfDateTimeFieldBehavior})),r.d(t,"IPcfDateTimeMetadata",(function(){return Ge.IPcfDateTimeMetadata})),r.d(t,"IPcfDecimalNumberMetadata",(function(){return Ge.IPcfDecimalNumberMetadata})),r.d(t,"IPcfDictionary",(function(){return Ge.IPcfDictionary})),r.d(t,"IPcfEntityMetadata",(function(){return Ge.IPcfEntityMetadata})),r.d(t,"IPcfEntityReference",(function(){return Ge.IPcfEntityReference})),r.d(t,"IPcfFloatingNumberMetadata",(function(){return Ge.IPcfFloatingNumberMetadata})),r.d(t,"IPcfImeMode",(function(){return Ge.IPcfImeMode})),r.d(t,"IPcfLookupMetadata",(function(){return Ge.IPcfLookupMetadata})),r.d(t,"IPcfNumberMetadata",(function(){return Ge.IPcfNumberMetadata})),r.d(t,"IPcfOptionMetadata",(function(){return Ge.IPcfOptionMetadata})),r.d(t,"IPcfOptionSetMetadata",(function(){return Ge.IPcfOptionSetMetadata})),r.d(t,"IPcfQuery",(function(){return Ge.IPcfQuery})),r.d(t,"IPcfQueryResult",(function(){return Ge.IPcfQueryResult})),r.d(t,"IPcfRequiredLevel",(function(){return Ge.IPcfRequiredLevel})),r.d(t,"IPcfStringMetadata",(function(){return Ge.IPcfStringMetadata})),r.d(t,"IPcfTwoOptionMetadata",(function(){return Ge.IPcfTwoOptionMetadata})),r.d(t,"IPcfWholeNumberMetadata",(function(){return Ge.IPcfWholeNumberMetadata})),r.d(t,"IPcfonDataSetUpdatedCallback",(function(){return Ge.IPcfonDataSetUpdatedCallback}));var He=r(108);r.d(t,"QueriedScalar",(function(){return He.QueriedScalar}));var ze=r(85);r.d(t,"QueriedTable",(function(){return ze.QueriedTable}));var Je=r(111);r.d(t,"QueriedTableCore",(function(){return Je.QueriedTableCore}));var We=r(16);r.d(t,"AttachmentCacheableQuery",(function(){return We.AttachmentCacheableQuery})),r.d(t,"CacheableQuery",(function(){return We.CacheableQuery})),r.d(t,"CdpPolymorphicCacheableQuery",(function(){return We.CdpPolymorphicCacheableQuery})),r.d(t,"CdsOptionSetCacheableQuery",(function(){return We.CdsOptionSetCacheableQuery})),r.d(t,"CdsPolymorphicCacheableQuery",(function(){return We.CdsPolymorphicCacheableQuery})),r.d(t,"CdsViewsCacheableQuery",(function(){return We.CdsViewsCacheableQuery})),r.d(t,"ICacheableQuery",(function(){return We.ICacheableQuery})),r.d(t,"IQueryBuilderCallContext",(function(){return We.IQueryBuilderCallContext})),r.d(t,"LookupCacheableQuery",(function(){return We.LookupCacheableQuery})),r.d(t,"NavigatedArrayCacheableQuery",(function(){return We.NavigatedArrayCacheableQuery})),r.d(t,"TabularCachableQuery",(function(){return We.TabularCachableQuery})),r.d(t,"getCacheableQueryKey",(function(){return We.getCacheableQueryKey}));var Ze=r(65);r.d(t,"ConstantOperand",(function(){return Ze.ConstantOperand})),r.d(t,"OdataConstantType",(function(){return Ze.OdataConstantType}));var Xe=r(25);r.d(t,"Expand",(function(){return Xe.Expand}));var $e=r(2);r.d(t,"Filter",(function(){return $e.Filter})),r.d(t,"FilterOperator",(function(){return $e.FilterOperator}));var Ye=r(61);r.d(t,"Format",(function(){return Ye.Format})),r.d(t,"ODataMetadataEnum",(function(){return Ye.ODataMetadataEnum}));var et=r(3);r.d(t,"AppMagicDataQuery_FunctionKind",(function(){return et.FunctionKind})),r.d(t,"FunctionOperand",(function(){return et.FunctionOperand}));var tt=r(9);r.d(t,"Operand",(function(){return tt.Operand})),r.d(t,"OperandKind",(function(){return tt.OperandKind}));var rt=r(31);r.d(t,"PropertyOperand",(function(){return rt.PropertyOperand}));var nt=r(8);r.d(t,"CdpQueryDefinition",(function(){return nt.CdpQueryDefinition})),r.d(t,"IActionQueryDefinition",(function(){return nt.IActionQueryDefinition})),r.d(t,"IAttachmentQueryDefinition",(function(){return nt.IAttachmentQueryDefinition})),r.d(t,"ICdpNavigatedColumnArrayQueryDefinition",(function(){return nt.ICdpNavigatedColumnArrayQueryDefinition})),r.d(t,"ICdpPolymorphicQueryDefinition",(function(){return nt.ICdpPolymorphicQueryDefinition})),r.d(t,"ICdpQueryDefinition",(function(){return nt.ICdpQueryDefinition})),r.d(t,"ICdsNavigatedColumnArrayQueryDefinition",(function(){return nt.ICdsNavigatedColumnArrayQueryDefinition})),r.d(t,"ICdsOptionSetQueryDefinition",(function(){return nt.ICdsOptionSetQueryDefinition})),r.d(t,"ICdsPolymorphicQueryDefinition",(function(){return nt.ICdsPolymorphicQueryDefinition})),r.d(t,"ICdsQueryDefinition",(function(){return nt.ICdsQueryDefinition})),r.d(t,"ICdsViewsQueryDefinition",(function(){return nt.ICdsViewsQueryDefinition})),r.d(t,"ILookupQueryDefinition",(function(){return nt.ILookupQueryDefinition})),r.d(t,"INavigatedColumnArrayQueryDefinition",(function(){return nt.INavigatedColumnArrayQueryDefinition})),r.d(t,"IQueryDefinitionBase",(function(){return nt.IQueryDefinitionBase})),r.d(t,"ITabularQueryDefinition",(function(){return nt.ITabularQueryDefinition})),r.d(t,"QueryDefinition",(function(){return nt.QueryDefinition})),r.d(t,"SourceType",(function(){return nt.SourceType}));var at=r(22);r.d(t,"QueryOptions",(function(){return at.QueryOptions})),r.d(t,"RecordQueryOptions",(function(){return at.RecordQueryOptions})),r.d(t,"ScalarQueryOptions",(function(){return at.ScalarQueryOptions})),r.d(t,"TableQueryOptions",(function(){return at.TableQueryOptions}));var ot=r(67);r.d(t,"Sort",(function(){return ot.Sort}));var it=r(28);r.d(t,"ValueOperand",(function(){return it.ValueOperand}));var st=r(76);r.d(t,"QueryableDataSource",(function(){return st.QueryableDataSource}));var ct=r(18);r.d(t,"IReadOnlyConnector",(function(){return ct.IReadOnlyConnector})),r.d(t,"ReadOnlyAttachmentConnector",(function(){return ct.ReadOnlyAttachmentConnector})),r.d(t,"ReadOnlyCdpPolymorphicLookupConnector",(function(){return ct.ReadOnlyCdpPolymorphicLookupConnector})),r.d(t,"ReadOnlyCdsNativeNavigatedRowRetrieverConnector",(function(){return ct.ReadOnlyCdsNativeNavigatedRowRetrieverConnector})),r.d(t,"ReadOnlyCdsNativeOptionSetConnector",(function(){return ct.ReadOnlyCdsNativeOptionSetConnector})),r.d(t,"ReadOnlyCdsNativePolymorphicLookupConnector",(function(){return ct.ReadOnlyCdsNativePolymorphicLookupConnector})),r.d(t,"ReadOnlyCdsNativeViewsConnector",(function(){return ct.ReadOnlyCdsNativeViewsConnector})),r.d(t,"ReadOnlyConnectedDataConnector",(function(){return ct.ReadOnlyConnectedDataConnector})),r.d(t,"ReadOnlyLookupConnector",(function(){return ct.ReadOnlyLookupConnector})),r.d(t,"ReadOnlyNavigationPagingConnector",(function(){return ct.ReadOnlyNavigationPagingConnector}));var ut=r(41);r.d(t,"getShallowChanges",(function(){return ut.getShallowChanges})),r.d(t,"isDataSourceReadOnly",(function(){return ut.isDataSourceReadOnly})),r.d(t,"isSameRecord",(function(){return ut.isSameRecord})),r.d(t,"isSameDataSource",(function(){return ut.isSameDataSource})),r.d(t,"mergeRecords",(function(){return ut.mergeRecords})),r.d(t,"tryGetPrimaryKeyFn",(function(){return ut.tryGetPrimaryKeyFn}));var lt=r(153);r.d(t,"RuntimeDataManager",(function(){return lt.RuntimeDataManager}));var dt=r(75);r.d(t,"RuntimeTypeError",(function(){return dt.RuntimeTypeError}));var pt=r(112);r.d(t,"ServerPager",(function(){return pt.ServerPager}));var ft=r(119);r.d(t,"AppMagicDataStaticDataSource_addMetadata",(function(){return ft.addMetadata}));var yt=r(13);r.d(t,"ComponentDataError",(function(){return yt.ComponentDataError})),r.d(t,"ConnectedDataErrorKind",(function(){return yt.ConnectedDataErrorKind})),r.d(t,"IConnectedDataConnectorErrorParams",(function(){return yt.IConnectedDataConnectorErrorParams})),r.d(t,"TabularDataError",(function(){return yt.TabularDataError}));var gt=r(37);r.d(t,"IAttachmentUpdate",(function(){return gt.IAttachmentUpdate})),r.d(t,"ICreateRowProcessColumnContext",(function(){return gt.ICreateRowProcessColumnContext})),r.d(t,"IFileUpdate",(function(){return gt.IFileUpdate})),r.d(t,"IOperationResult",(function(){return gt.IOperationResult})),r.d(t,"IRelateUnrelateInfo",(function(){return gt.IRelateUnrelateInfo})),r.d(t,"IRemoveOperationResult",(function(){return gt.IRemoveOperationResult})),r.d(t,"TabularDataSource",(function(){return gt.TabularDataSource}));var ht=r(24);r.d(t,"isCdsDataSource",(function(){return ht.isCdsDataSource})),r.d(t,"isConnectedDataSource",(function(){return ht.isConnectedDataSource})),r.d(t,"isTabularDataSource",(function(){return ht.isTabularDataSource})),r.d(t,"reportConnectedDataReadOperationErrors",(function(){return ht.reportConnectedDataReadOperationErrors})),r.d(t,"getNetworkErrorMessageFromResponse",(function(){return ht.getNetworkErrorMessageFromResponse}));var mt=r(56);r.d(t,"isValidViewData",(function(){return mt.isValidViewData})),r.d(t,"isValidViewTable",(function(){return mt.isValidViewTable})),r.d(t,"isViewTable",(function(){return mt.isViewTable})),r.d(t,"AppMagicDataView_safeCast",(function(){return mt.safeCast})),r.d(t,"tryGetViewData",(function(){return mt.tryGetViewData}));var vt=r(97);r.d(t,"isValidViewDataRecord",(function(){return vt.isValidViewDataRecord})),r.d(t,"AppMagicDataViewDataRecord_safeCast",(function(){return vt.safeCast}));var bt=r(116);r.d(t,"MdlWebResourceDataLoader",(function(){return bt.MdlWebResourceDataLoader}));var _t=r(149);r.d(t,"MdlUserSettingsDataLoader",(function(){return _t.MdlUserSettingsDataLoader}));var Ct=r(150);r.d(t,"WebResourceDataLoader",(function(){return Ct.WebResourceDataLoader}));var At=r(94);r.d(t,"WebResourceDataSource",(function(){return At.WebResourceDataSource})),r.d(t,"ICdsResourceProvider",(function(){return At.ICdsResourceProvider}));var St=r(154);r.d(t,"DataSourceSetupState",(function(){return St.DataSourceSetupState}));var Dt=r(155);r.d(t,"DefaultDateProvider",(function(){return Dt.DefaultDateProvider}));var Ot=r(156);r.d(t,"addParameters",(function(){return Ot.addParameters}));var Et=r(120);r.d(t,"GetVariablesCommandHandler",(function(){return Et.GetVariablesCommandHandler}));var Tt=r(32);r.d(t,"InspectCommandHandler",(function(){return Tt.InspectCommandHandler})),r.d(t,"InspectSubscriptionDictionary",(function(){return Tt.InspectSubscriptionDictionary})),r.d(t,"VariableMetadataAction",(function(){return Tt.VariableMetadataAction})),r.d(t,"VariableType",(function(){return Tt.VariableType}));var Rt=r(70);r.d(t,"AppMagicDynamicDataSourceAccelerationData_create",(function(){return Rt.create}));var wt=r(157);r.d(t,"AccelerationDataSource",(function(){return wt.AccelerationDataSource}));var Mt=r(158);r.d(t,"CordovaAccelerationProfile",(function(){return Mt.CordovaAccelerationProfile}));var Pt=r(202);r.d(t,"IAccelerationData",(function(){return Pt.IAccelerationData}));var Ft=r(203);r.d(t,"IAccelerationProfile",(function(){return Ft.IAccelerationProfile}));var Nt=r(159);r.d(t,"NullAccelerationDataSource",(function(){return Nt.NullAccelerationDataSource}));var It=r(78);r.d(t,"AppMagicDynamicDataSourceCompassData_create",(function(){return It.create}));var xt=r(160);r.d(t,"CompassDataSource",(function(){return xt.CompassDataSource}));var jt=r(161);r.d(t,"CordovaCompassProfile",(function(){return jt.CordovaCompassProfile}));var Lt=r(204);r.d(t,"ICompassData",(function(){return Lt.ICompassData}));var Ut=r(205);r.d(t,"ICompassProfile",(function(){return Ut.ICompassProfile}));var kt=r(162);r.d(t,"NullCompassDataSource",(function(){return kt.NullCompassDataSource}));var Vt=r(69);r.d(t,"AppMagicDynamicDataSourceConnectionData_create",(function(){return Vt.create}));var Bt=r(163);r.d(t,"ConnectionDataSource",(function(){return Bt.ConnectionDataSource}));var Qt=r(164);r.d(t,"CordovaNetworkConnectionProfile",(function(){return Qt.CordovaNetworkConnectionProfile}));var Kt=r(59);r.d(t,"IConnectionData",(function(){return Kt.IConnectionData}));var qt=r(206);r.d(t,"INetworkConnectionProfile",(function(){return qt.INetworkConnectionProfile}));var Gt=r(165);r.d(t,"NullConnectionDataSource",(function(){return Gt.NullConnectionDataSource}));var Ht=r(166);r.d(t,"WebNetworkConnectionProfile",(function(){return Ht.WebNetworkConnectionProfile}));var zt=r(167);r.d(t,"CordovaLocationProfile",(function(){return zt.CordovaLocationProfile}));var Jt=r(168);r.d(t,"HTML5LocationDataSource",(function(){return Jt.HTML5LocationDataSource}));var Wt=r(207);r.d(t,"ILocationData",(function(){return Wt.ILocationData}));var Zt=r(208);r.d(t,"ILocationProfile",(function(){return Zt.ILocationProfile}));var Xt=r(99);r.d(t,"AppMagicDynamicDataSourceLocationData_create",(function(){return Xt.create}));var $t=r(169);r.d(t,"AppMagicDynamicDataSource_instance",(function(){return $t.instance}));var Yt=r(104);r.d(t,"WebEncryptionProvider",(function(){return Yt.WebEncryptionProvider}));var er=r(170);r.d(t,"AppMagicCommonFilePicker_instance",(function(){return er.instance}));var tr=r(105);r.d(t,"collectItems",(function(){return tr.collectItems}));var rr=r(12);r.d(t,"AllowedValues",(function(){return rr.AllowedValues})),r.d(t,"CreatePermission",(function(){return rr.CreatePermission})),r.d(t,"DeletePermission",(function(){return rr.DeletePermission})),r.d(t,"DisplayName",(function(){return rr.DisplayName})),r.d(t,"EditPermission",(function(){return rr.EditPermission})),r.d(t,"MaxLength",(function(){return rr.MaxLength})),r.d(t,"MaxValue",(function(){return rr.MaxValue})),r.d(t,"MinLength",(function(){return rr.MinLength})),r.d(t,"MinValue",(function(){return rr.MinValue})),r.d(t,"ReadPermission",(function(){return rr.ReadPermission})),r.d(t,"Required",(function(){return rr.Required}));var nr=r(68);r.d(t,"RecordInfoEnumMap",(function(){return nr.RecordInfoEnumMap})),r.d(t,"AccessList",(function(){return nr.AccessList}));var ar=r(130);r.d(t,"AppMagicFunctionsDataSourceAttributeLookup_getDataSourceAttribute",(function(){return ar.getDataSourceAttributeAsync})),r.d(t,"getDataSourceColumnAttributeAsync",(function(){return ar.getDataSourceColumnAttributeAsync}));var or=r(171);r.d(t,"AppMagicFunctionsDataSourceDefaultAttributeLookup_getDataSourceAttribute",(function(){return or.getDataSourceAttribute}));var ir=r(100);r.d(t,"DataFormatterFactory",(function(){return ir.DataFormatterFactory})),r.d(t,"IDataFormatter",(function(){return ir.IDataFormatter})),r.d(t,"CDSDataFormatter",(function(){return ir.CDSDataFormatter}));var sr=r(36);r.d(t,"ExpandQueriedTable",(function(){return sr.ExpandQueriedTable})),r.d(t,"IExpandQueriedTable",(function(){return sr.IExpandQueriedTable})),r.d(t,"getAggregateResultAsync",(function(){return sr.getAggregateResultAsync})),r.d(t,"getAttachmentsAsync",(function(){return sr.getAttachmentsAsync})),r.d(t,"getCurrentTimeZoneOffsetAsOdataDuration",(function(){return sr.getCurrentTimeZoneOffsetAsOdataDuration})),r.d(t,"getFirstRowAsync",(function(){return sr.getFirstRowAsync})),r.d(t,"getNextResultsAsync",(function(){return sr.getNextResultsAsync})),r.d(t,"getResultCountAsync",(function(){return sr.getResultCountAsync}));var cr=r(6);r.d(t,"AppMagicFunctions_FunctionKind",(function(){return cr.FunctionKind})),r.d(t,"addExpandAndSelectOption",(function(){return cr.addExpandAndSelectOption})),r.d(t,"addSelectQueryOptions",(function(){return cr.addSelectQueryOptions})),r.d(t,"appendExpandToParent",(function(){return cr.appendExpandToParent})),r.d(t,"appendQueryOptions",(function(){return cr.appendQueryOptions})),r.d(t,"appendQueryOptionsAsync",(function(){return cr.appendQueryOptionsAsync})),r.d(t,"createAggregateFunctionOperand",(function(){return cr.createAggregateFunctionOperand})),r.d(t,"createBinaryBooleanFilterOperand",(function(){return cr.createBinaryBooleanFilterOperand})),r.d(t,"createBooleanFilterOperand",(function(){return cr.createBooleanFilterOperand})),r.d(t,"createBooleanFilterOperandAsync",(function(){return cr.createBooleanFilterOperandAsync})),r.d(t,"createCountFunctionOperand",(function(){return cr.createCountFunctionOperand})),r.d(t,"createFilterOperand",(function(){return cr.createFilterOperand})),r.d(t,"createFilterOperandAsync",(function(){return cr.createFilterOperandAsync})),r.d(t,"createFunctionOperand",(function(){return cr.createFunctionOperand})),r.d(t,"createIsBlankFilterOperand",(function(){return cr.createIsBlankFilterOperand})),r.d(t,"createNavigationPropertyQueryOptions",(function(){return cr.createNavigationPropertyQueryOptions})),r.d(t,"createNoneFilterOperand",(function(){return cr.createNoneFilterOperand})),r.d(t,"createNullOperand",(function(){return cr.createNullOperand})),r.d(t,"createPropertyOperand",(function(){return cr.createPropertyOperand})),r.d(t,"createSearchFunctionOperand",(function(){return cr.createSearchFunctionOperand})),r.d(t,"createSearchFunctionOperandAsync",(function(){return cr.createSearchFunctionOperandAsync})),r.d(t,"createSearchOperand",(function(){return cr.createSearchOperand})),r.d(t,"createSearchOperandAsync",(function(){return cr.createSearchOperandAsync})),r.d(t,"createSearchQueryOptions",(function(){return cr.createSearchQueryOptions})),r.d(t,"createTextMatchOperand",(function(){return cr.createTextMatchOperand})),r.d(t,"createValueOperand",(function(){return cr.createValueOperand})),r.d(t,"createValueOperandAsync",(function(){return cr.createValueOperandAsync})),r.d(t,"expandQueryOptions",(function(){return cr.expandQueryOptions})),r.d(t,"formatTableValueOperand",(function(){return cr.formatTableValueOperand})),r.d(t,"formatTableValueOperandAsync",(function(){return cr.formatTableValueOperandAsync})),r.d(t,"getEntityItemIdFromThisItem",(function(){return cr.getEntityItemIdFromThisItem})),r.d(t,"getFilterQueryOptions",(function(){return cr.getFilterQueryOptions})),r.d(t,"getFilterQueryOptionsAsync",(function(){return cr.getFilterQueryOptionsAsync})),r.d(t,"getNavigatedQueriedTableAsync",(function(){return cr.getNavigatedQueriedTableAsync})),r.d(t,"getPolyValue",(function(){return cr.getPolyValue})),r.d(t,"getRecordValue",(function(){return cr.getRecordValue})),r.d(t,"getScalarQueryOptions",(function(){return cr.getScalarQueryOptions})),r.d(t,"getSortQueryOptions",(function(){return cr.getSortQueryOptions})),r.d(t,"getTopQueryOptions",(function(){return cr.getTopQueryOptions})),r.d(t,"mergeExpandArrays",(function(){return cr.mergeExpandArrays})),r.d(t,"AppMagicFunctions_mergeQueryOptions",(function(){return cr.mergeQueryOptions})),r.d(t,"mergeQueryOptionsAsync",(function(){return cr.mergeQueryOptionsAsync})),r.d(t,"queryScalarAsync",(function(){return cr.queryScalarAsync})),r.d(t,"queryTableAsync",(function(){return cr.queryTableAsync}));var ur=r(106);r.d(t,"mergeRecord",(function(){return ur.mergeRecord}));var lr=r(38);r.d(t,"getConditions",(function(){return lr.getConditions})),r.d(t,"getIndices",(function(){return lr.getIndices})),r.d(t,"getIndicesAsync",(function(){return lr.getIndicesAsync})),r.d(t,"getPredicates",(function(){return lr.getPredicates})),r.d(t,"removeIndices",(function(){return lr.removeIndices})),r.d(t,"removeRows",(function(){return lr.removeRows})),r.d(t,"removeDValueRows",(function(){return lr.removeDValueRows}));var dr=r(34);r.d(t,"IFunctionEntry",(function(){return dr.IFunctionEntry})),r.d(t,"IMayBeAsyncFunctionEntry",(function(){return dr.IMayBeAsyncFunctionEntry})),r.d(t,"IDelegatedFunctionEntry",(function(){return dr.IDelegatedFunctionEntry})),r.d(t,"getDelegatedFunctions",(function(){return dr.getDelegatedFunctions})),r.d(t,"getAsyncFunctions",(function(){return dr.getAsyncFunctions})),r.d(t,"getFunctions",(function(){return dr.getFunctions})),r.d(t,"getProjectionAsync",(function(){return dr.getProjectionAsync})),r.d(t,"updateRowIfAsync",(function(){return dr.updateRowIfAsync})),r.d(t,"updateDValueRows",(function(){return dr.updateDValueRows}));var pr=r(140);r.d(t,"AppLifecycleFullLoadResult",(function(){return pr.AppLifecycleFullLoadResult})),r.d(t,"IAppLifecycleEvents",(function(){return pr.IAppLifecycleEvents}));var fr=r(209);r.d(t,"IDataSourceConfiguration",(function(){return fr.IDataSourceConfiguration}));var yr=r(210);r.d(t,"IDataSourceInfo",(function(){return yr.IDataSourceInfo}));var gr=r(211);r.d(t,"IDateProvider",(function(){return gr.IDateProvider}));var hr=r(212);r.d(t,"IFilePicker",(function(){return hr.IFilePicker}));var mr=r(213);r.d(t,"IListTablesResult",(function(){return mr.IListTablesResult}));var vr=r(214);r.d(t,"IPreSetupDataSourceProviderResult",(function(){return vr.IPreSetupDataSourceProviderResult}));var br=r(15);r.d(t,"EntityScope",(function(){return br.EntityScope})),r.d(t,"LanguageRuntime",(function(){return br.LanguageRuntime})),r.d(t,"getLanguageRuntime",(function(){return br.getLanguageRuntime})),r.d(t,"testOnlyResetLanguageRuntime",(function(){return br.testOnlyResetLanguageRuntime}));var _r=r(172);r.d(t,"AppresBlobManagerUriResolver",(function(){return _r.AppresBlobManagerUriResolver}));var Cr=r(173);r.d(t,"AppresDataSourceToBlobManagerUriResolver",(function(){return Cr.AppresDataSourceToBlobManagerUriResolver}));var Ar=r(131);r.d(t,"AppresDataSourcesUriResolver",(function(){return Ar.AppresDataSourcesUriResolver})),r.d(t,"IDataSourceResolver",(function(){return Ar.IDataSourceResolver}));var Sr=r(132);r.d(t,"AppresResourceUriResolver",(function(){return Sr.AppresResourceUriResolver})),r.d(t,"IAppResourceResolver",(function(){return Sr.IAppResourceResolver}));var Dr=r(174);r.d(t,"AppresUnrecognizedUriResolver",(function(){return Dr.AppresUnrecognizedUriResolver}));var Or=r(82);r.d(t,"BlobManager",(function(){return Or.BlobManager}));var Er=r(175);r.d(t,"BlobUriResolver",(function(){return Er.BlobUriResolver}));var Tr=r(176);r.d(t,"DataUriResolver",(function(){return Tr.DataUriResolver}));var Rr=r(143);r.d(t,"LocalFileCache",(function(){return Rr.LocalFileCache}));var wr=r(45);r.d(t,"createPassThrough",(function(){return wr.createPassThrough})),r.d(t,"AppMagicCommonMediaMediaReference_isValid",(function(){return wr.isValid}));var Mr=r(51);r.d(t,"getAsBinaryViaHttpClientAsync",(function(){return Mr.getAsBinaryViaHttpClientAsync})),r.d(t,"getAsBlobViaNativeXhrAsync",(function(){return Mr.getAsBlobViaNativeXhrAsync}));var Pr=r(177);r.d(t,"PassThroughWebUriResolver",(function(){return Pr.PassThroughWebUriResolver}));var Fr=r(178);r.d(t,"RelativeUrlResolver",(function(){return Fr.RelativeUrlResolver}));var Nr=r(179);r.d(t,"WindowsFilePathMediaResolver",(function(){return Nr.WindowsFilePathMediaResolver}));var Ir=r(215);r.d(t,"Predicate",(function(){return Ir.Predicate}));var xr=r(180);r.d(t,"PromiseCollection",(function(){return xr.PromiseCollection}));var jr=r(181);r.d(t,"Runtime",(function(){return jr.Runtime}));var Lr=r(79);r.d(t,"IAddConnectedDataSourceOptions",(function(){return Lr.IAddConnectedDataSourceOptions})),r.d(t,"IAppPreviewFlagSetEventDetails",(function(){return Lr.IAppPreviewFlagSetEventDetails})),r.d(t,"ISubscribable",(function(){return Lr.ISubscribable})),r.d(t,"RuntimeBase",(function(){return Lr.RuntimeBase})),r.d(t,"RuntimeNamedObject",(function(){return Lr.RuntimeNamedObject}));var Ur=r(182);r.d(t,"ConnectionAuthenticationProvider",(function(){return Ur.ConnectionAuthenticationProvider}));var kr=r(123);r.d(t,"DynamicResourceAuthenticationProvider",(function(){return kr.DynamicResourceAuthenticationProvider}));var Vr=r(89);r.d(t,"DynamicJsonSchemaHelper",(function(){return Vr.DynamicJsonSchemaHelper}));var Br=r(48);r.d(t,"OrganizationDataSourceName",(function(){return Br.OrganizationDataSourceName})),r.d(t,"OrganizationSettingEntityName",(function(){return Br.OrganizationSettingEntityName})),r.d(t,"OrganizationSettingLogicalName",(function(){return Br.OrganizationSettingLogicalName})),r.d(t,"checkIfOrganizationCdsDataSourceExists",(function(){return Br.checkIfOrganizationCdsDataSourceExists})),r.d(t,"clearCache",(function(){return Br.clearCache})),r.d(t,"getGeospatialOrgSettingThroughCdsConnector",(function(){return Br.getGeospatialOrgSettingThroughCdsConnector})),r.d(t,"isGeospatialAzureMapsIntegrationEnabled",(function(){return Br.isGeospatialAzureMapsIntegrationEnabled})),r.d(t,"isGeospatialControl",(function(){return Br.isGeospatialControl})),r.d(t,"tryGetIsGeospatialAzureMapsIntegrationEnabledResponse",(function(){return Br.tryGetIsGeospatialAzureMapsIntegrationEnabledResponse}));var Qr=r(21);r.d(t,"BadInput",(function(){return Qr.BadInput})),r.d(t,"GenericError",(function(){return Qr.GenericError})),r.d(t,"ModelInvalid",(function(){return Qr.ModelInvalid})),r.d(t,"ModelNotFound",(function(){return Qr.ModelNotFound})),r.d(t,"ModelNotShared",(function(){return Qr.ModelNotShared})),r.d(t,"NoRoleAssignedError",(function(){return Qr.NoRoleAssignedError})),r.d(t,"PrivilegeError",(function(){return Qr.PrivilegeError}));var Kr=r(43);r.d(t,"_getModelsWithActiveRunConfigIdQueryDefinition",(function(){return Kr._getModelsWithActiveRunConfigIdQueryDefinition})),r.d(t,"cleanUpModelName",(function(){return Kr.cleanUpModelName})),r.d(t,"getLabelsForObjectDetectionModelAsync",(function(){return Kr.getLabelsForObjectDetectionModelAsync})),r.d(t,"getModelsAsync",(function(){return Kr.getModelsAsync})),r.d(t,"getPreTrainedModelIdAsync",(function(){return Kr.getPreTrainedModelIdAsync})),r.d(t,"getPredictionSchemaAsync",(function(){return Kr.getPredictionSchemaAsync})),r.d(t,"invokeAiModelActionAsync",(function(){return Kr.invokeAiModelActionAsync})),r.d(t,"invokeGlobalOperationAsync",(function(){return Kr.invokeGlobalOperationAsync})),r.d(t,"invokeCopilotActionAsync",(function(){return Kr.invokeCopilotActionAsync})),r.d(t,"predictAsync",(function(){return Kr.predictAsync}));var qr=r(47);r.d(t,"IFailureResponse",(function(){return qr.IFailureResponse})),r.d(t,"IIntelligenceOperationRequest",(function(){return qr.IIntelligenceOperationRequest})),r.d(t,"IIntelligenceResponse",(function(){return qr.IIntelligenceResponse})),r.d(t,"IIntelligenceResponseBodyV1",(function(){return qr.IIntelligenceResponseBodyV1})),r.d(t,"IObjectDetectionLabel",(function(){return qr.IObjectDetectionLabel})),r.d(t,"IRequestDescription",(function(){return qr.IRequestDescription})),r.d(t,"ISuccessResponse",(function(){return qr.ISuccessResponse})),r.d(t,"IntelligenceApiErrors",(function(){return qr.IntelligenceApiErrors})),r.d(t,"ODataGlobalOperationType",(function(){return qr.ODataGlobalOperationType})),r.d(t,"Payload",(function(){return qr.Payload}));var Gr=r(133);r.d(t,"Action",(function(){return Gr.Action})),r.d(t,"Function",(function(){return Gr.Function}));var Hr=r(80);r.d(t,"IoTCentralServiceName",(function(){return Hr.IoTCentralServiceName})),r.d(t,"getIoTCentralAppCollection",(function(){return Hr.getIoTCentralAppCollection})),r.d(t,"getIoTCentralServiceFunctions",(function(){return Hr.getIoTCentralServiceFunctions})),r.d(t,"isIoTControl",(function(){return Hr.isIoTControl})),r.d(t,"refreshDevicesThroughIoTConnector",(function(){return Hr.refreshDevicesThroughIoTConnector}));var zr=r(134);r.d(t,"hasOrganizationSettingsAsync",(function(){return zr.hasOrganizationSettingsAsync})),r.d(t,"getOrganizationSettingsAsync",(function(){return zr.getOrganizationSettingsAsync}));var Jr=r(183);r.d(t,"CanvasUtility",(function(){return Jr.CanvasUtility}));var Wr=r(184);r.d(t,"ElementRenderer",(function(){return Wr.ElementRenderer}));var Zr=r(216);r.d(t,"IRenderElementToDataURLOptions",(function(){return Zr.IRenderElementToDataURLOptions}));var Xr=r(135);r.d(t,"NumberedNameGenerator",(function(){return Xr.NumberedNameGenerator})),r.d(t,"NumberedNameGeneratorOptions",(function(){return Xr.NumberedNameGeneratorOptions}));var $r=r(136);r.d(t,"dotNetStringFormat_format_args",(function(){return $r.dotNetStringFormat_format_args})),r.d(t,"escapeCharacters",(function(){return $r.escapeCharacters}));var Yr=r(5);r.d(t,"ArrayBufferWithContentType",(function(){return Yr.ArrayBufferWithContentType})),r.d(t,"Base64WithContentType",(function(){return Yr.Base64WithContentType})),r.d(t,"EventTracker",(function(){return Yr.EventTracker})),r.d(t,"IMediaForExport",(function(){return Yr.IMediaForExport})),r.d(t,"addRefBlobs",(function(){return Yr.addRefBlobs})),r.d(t,"arrayBulkRemove",(function(){return Yr.arrayBulkRemove})),r.d(t,"blobManager",(function(){return Yr.blobManager})),r.d(t,"cloneAndFlattenOpenAjax",(function(){return Yr.cloneAndFlattenOpenAjax})),r.d(t,"createMediaReferenceAsync",(function(){return Yr.createMediaReferenceAsync})),r.d(t,"formatUrlStringForCss",(function(){return Yr.formatUrlStringForCss})),r.d(t,"getAppPreviewFlag",(function(){return Yr.getAppPreviewFlag})),r.d(t,"getManagedBinaryMediaUrlsInData",(function(){return Yr.getManagedBinaryMediaUrlsInData})),r.d(t,"getMediaAsArrayBufferWithContentTypeAsync",(function(){return Yr.getMediaAsArrayBufferWithContentTypeAsync})),r.d(t,"getMediaAsBase64WithContentTypeAsync",(function(){return Yr.getMediaAsBase64WithContentTypeAsync})),r.d(t,"getMediaAsBinaryAsync",(function(){return Yr.getMediaAsBinaryAsync})),r.d(t,"getMediaAsBlobAsync",(function(){return Yr.getMediaAsBlobAsync})),r.d(t,"getBinaryAsBlobAsync",(function(){return Yr.getBinaryAsBlobAsync})),r.d(t,"getMediaInDataForExportAsync",(function(){return Yr.getMediaInDataForExportAsync})),r.d(t,"getSessionStorageMediaUrlsInData",(function(){return Yr.getSessionStorageMediaUrlsInData})),r.d(t,"hasOpenAjax",(function(){return Yr.hasOpenAjax})),r.d(t,"isSessionStorageUrl",(function(){return Yr.isSessionStorageUrl})),r.d(t,"isManagedMediaUrl",(function(){return Yr.isManagedMediaUrl})),r.d(t,"loadSvgMediaAsIconAsync",(function(){return Yr.loadSvgMediaAsIconAsync})),r.d(t,"localFileCache",(function(){return Yr.localFileCache})),r.d(t,"releaseBlobs",(function(){return Yr.releaseBlobs})),r.d(t,"resolveWebViewControlPath",(function(){return Yr.resolveWebViewControlPath}));var en=r(63);r.d(t,"IAppRuntime",(function(){return en.IAppRuntime})),r.d(t,"IAppRuntimeGetterFunction",(function(){return en.IAppRuntimeGetterFunction})),r.d(t,"IAppRuntimeGetterFunctionSingletonKey",(function(){return en.IAppRuntimeGetterFunctionSingletonKey})),r.d(t,"IAppRuntimeSingletonKey",(function(){return en.IAppRuntimeSingletonKey}))},function(e,t,r){"use strict";r.r(t);var n=r(143);Core.exportToNamespace(["AppMagic","Common","Media"],n);var a=r(103),o=r(104),i=r(63),s=r(82);!function(e){e.register(i.IAppRuntimeGetterFunctionSingletonKey,[],(function(){return function(){var e=AppMagic.AuthoringTool.Runtime;return Contracts.checkObject(e,"The current runtime instance must exist."),e}})),e.register(AppMagic.Runtime.App.CurrentAppInstanceFunctionSingletonKey,[i.IAppRuntimeGetterFunctionSingletonKey],(function(e){return function(){return e().currentApp}})),e.register(AppMagic.Encryption.IEncryptionProviderSingletonKey,[],(function(){return new o.WebEncryptionProvider})),e.register(AppMagic.Runtime.App.AppPABinaryResolverSingletonKey,[],(function(){return new AppMagic.Services.WinJSPABinaryResolver(WinJS.xhr)})),e.register(AppMagic.Runtime.App.IBlobManagerSingletonKey,[AppMagic.Runtime.App.AppPABinaryResolverSingletonKey],(function(e){return new s.BlobManager(e)})),e.register(AppMagic.Runtime.App.ILocalFileCacheSingletonKey,[AppMagic.Runtime.App.IBlobManagerSingletonKey],(function(e){return new AppMagic.Common.Media.LocalFileCache(e)})),e.register(AppMagic.Runtime.App.JSZipLoaderSingletonKey,[],(function(){return new a.JSZipLoader}))}(Core.Loader.ObjectFactory.instance);var c=r(128),u=r(0);Object(u.exportToNamespace)(["AppMagic","Common"],c);var l=r(144);Object(u.exportToNamespace)(["AppMagic","Services"],l);var d=r(83);Object(u.exportToNamespace)(["AppMagic","Data"],d);var p=r(145);Object(u.exportToNamespace)(["AppMagic","Data"],p);var f=r(72);Object(u.exportToNamespace)(["AppMagic","Data"],f);var y=r(35);Object(u.exportToNamespace)(["AppMagic","Data"],y);var g=r(107);Object(u.exportToNamespace)(["AppMagic","Data"],g);var h=r(146);Object(u.exportToNamespace)(["AppMagic","Data"],h);var m=r(29);Object(u.exportToNamespace)(["AppMagic","Data","Attachments"],m);var v=r(109);Object(u.exportToNamespace)(["AppMagic","Data"],v);var b=r(62);Object(u.exportToNamespace)(["AppMagic","Data"],b);var _=r(110);Object(u.exportToNamespace)(["AppMagic","Data"],_);var C=r(194);Object(u.exportToNamespace)(["AppMagic","Data"],C);var A=r(26);Object(u.exportToNamespace)(["AppMagic","Data","CanvasDataProviderHelper"],A);var S=r(64);Object(u.exportToNamespace)(["AppMagic","Data","CanvasDataProviderQueryMergeUtilities"],S);var D=r(95);Object(u.exportToNamespace)(["AppMagic","Data"],D);var O=r(73);Object(u.exportToNamespace)(["AppMagic","Services","CdpGetRowsResponseParamBuilder"],O);var E=r(84);Object(u.exportToNamespace)(["AppMagic","Data"],E);var T=r(39);Object(u.exportToNamespace)(["AppMagic","Data"],T);var R=r(147);Object(u.exportToNamespace)(["AppMagic","Data"],R);var w=r(148);Object(u.exportToNamespace)(["AppMagic","Data"],w);var M=r(116);Object(u.exportToNamespace)(["AppMagic","Data"],M);var P=r(149);Object(u.exportToNamespace)(["AppMagic","Data"],P);var F=r(94);Core.exportToNamespace(["AppMagic","Data"],F);var N=r(150);Core.exportToNamespace(["AppMagic","Data"],N);var I=r(86);Object(u.exportToNamespace)(["AppMagic","Data","CdsError"],I);var x=r(58);Object(u.exportToNamespace)(["AppMagic","Data","CdsErrorResponse"],x);var j=r(93);Object(u.exportToNamespace)(["AppMagic","Data","CdsFunctionDefinition"],j);var L=r(90);Object(u.exportToNamespace)(["AppMagic","Services","CdsGetRowsResponseParamBuilder"],L);var U=r(92);Object(u.exportToNamespace)(["AppMagic","Data","CdsInnerError"],U);var k=r(57);Object(u.exportToNamespace)(["AppMagic","Services","CdsQueryStringBuilder"],k);var V=r(60);Object(u.exportToNamespace)(["AppMagic","Data"],V);var B=r(151);Object(u.exportToNamespace)(["AppMagic","Data","ConnectedDataGetRowsResponse"],B);var Q=r(42);Object(u.exportToNamespace)(["AppMagic","Services","ConnectedDataQueryBuilderFactory"],Q);var K=r(152);Object(u.exportToNamespace)(["AppMagic","Services","ConnectedDataQueryStringBuilder"],K);var q=r(66);Object(u.exportToNamespace)(["AppMagic","Services"],q);var G=r(114);Object(u.exportToNamespace)(["AppMagic","Data"],G);var H=r(115);Object(u.exportToNamespace)(["AppMagic","Data"],H);var z=r(113);Object(u.exportToNamespace)(["AppMagic","Data"],z);var J=r(100);Object(u.exportToNamespace)(["AppMagic","Data","DataFormattingUtilities"],J);var W=r(129);Object(u.exportToNamespace)(["AppMagic","Data","DataSerializer"],W);var Z=r(77);Object(u.exportToNamespace)(["AppMagic","Data"],Z);var X=r(49);Object(u.exportToNamespace)(["AppMagic","Data","DataSetEntityRecordValidators"],X);var $=r(10);Object(u.exportToNamespace)(["AppMagic","Data","DataSourceError"],$);var Y=r(14);Object(u.exportToNamespace)(["AppMagic","Data","DataSourceErrorTable"],Y);var ee=r(11);Object(u.exportToNamespace)(["AppMagic","Data","DataSourceValue"],ee);var te=r(87);Object(u.exportToNamespace)(["AppMagic","Data","DynamicDataSource"],te);var re=r(4);Object(u.exportToNamespace)(["AppMagic","Data"],re);r(196),r(126),r(197),r(127),r(54),r(198);var ne=r(74);Object(u.exportToNamespace)(["AppMagic","Data","DataRecord"],ne);r(139),r(199);var ae=r(23);Object(u.exportToNamespace)(["AppMagic","Data","DataTable"],ae);var oe=r(33);Object(u.exportToNamespace)(["AppMagic","Data"],oe);r(200),r(201);var ie=r(91);Object(u.exportToNamespace)(["AppMagic","Data"],ie);var se=r(44);Object(u.exportToNamespace)(["AppMagic","Data"],se);var ce=r(50);Object(u.exportToNamespace)(["AppMagic","Services","ODataFunctionQueryStringBuilder"],ce);var ue=r(19);Object(u.exportToNamespace)(["AppMagic","Data","OperationResult"],ue);var le=r(55);Object(u.exportToNamespace)(["AppMagic","Data","OptionSet"],le);var de=r(96);Object(u.exportToNamespace)(["AppMagic","Data","OptionSetDataRecord"],de);r(20);var pe=r(108);Object(u.exportToNamespace)(["AppMagic","Data"],pe);var fe=r(85);Object(u.exportToNamespace)(["AppMagic","Data"],fe);var ye=r(111);Object(u.exportToNamespace)(["AppMagic","Data"],ye);var ge=r(16);Object(u.exportToNamespace)(["AppMagic","Data","Query"],ge);var he=r(65);Object(u.exportToNamespace)(["AppMagic","Data","Query"],he);var me=r(25);Object(u.exportToNamespace)(["AppMagic","Data","Query"],me);var ve=r(2);Core.exportToNamespace(["AppMagic","Data","Query"],ve);var be=r(61);Core.exportToNamespace(["AppMagic","Data","Query"],be);var _e=r(3);Core.exportToNamespace(["AppMagic","Data","Query"],_e);var Ce=r(9);Core.exportToNamespace(["AppMagic","Data","Query"],Ce);var Ae=r(31);Core.exportToNamespace(["AppMagic","Data","Query"],Ae);var Se=r(8);Core.exportToNamespace(["AppMagic","Data","Query"],Se);var De=r(22);Core.exportToNamespace(["AppMagic","Data","Query"],De);var Oe=r(67);Core.exportToNamespace(["AppMagic","Data","Query"],Oe);var Ee=r(28);Core.exportToNamespace(["AppMagic","Data","Query"],Ee);var Te=r(76);Core.exportToNamespace(["AppMagic","Data"],Te);var Re=r(18);Core.exportToNamespace(["AppMagic","Data"],Re);var we=r(41);Core.exportToNamespace(["AppMagic","Data","Record","Utility"],we);var Me=r(153);Core.exportToNamespace(["AppMagic","Data"],Me);var Pe=r(75);Core.exportToNamespace(["AppMagic","Data"],Pe);var Fe=r(112);Core.exportToNamespace(["AppMagic","Data"],Fe);var Ne=r(119);Core.exportToNamespace(["AppMagic","Data","StaticDataSource"],Ne);var Ie=r(13);Core.exportToNamespace(["AppMagic","Data"],Ie);var xe=r(37);Core.exportToNamespace(["AppMagic","Data"],xe);var je=r(24);Core.exportToNamespace(["AppMagic","Data","TabularDataUtilities"],je);var Le=r(56);Core.exportToNamespace(["AppMagic","Data","View"],Le);var Ue=r(97);Core.exportToNamespace(["AppMagic","Data","ViewDataRecord"],Ue);var ke=r(154);Core.exportToNamespace(["AppMagic","Common"],ke);var Ve=r(155);Core.exportToNamespace(["AppMagic","Common"],Ve);var Be=r(156);Object(u.exportToNamespace)(["AppMagic","Diagnostics"],Be);var Qe=r(120);Object(u.exportToNamespace)(["AppMagic"],Qe);var Ke=r(32);Object(u.exportToNamespace)(["AppMagic"],Ke);var qe=r(70);Object(u.exportToNamespace)(["AppMagic","DynamicDataSource","AccelerationData"],qe);var Ge=r(157);Object(u.exportToNamespace)(["AppMagic","DynamicDataSource"],Ge);var He=r(158);Object(u.exportToNamespace)(["AppMagic","DynamicDataSource"],He);r(202),r(203);var ze=r(159);Object(u.exportToNamespace)(["AppMagic","DynamicDataSource"],ze);var Je=r(78);Object(u.exportToNamespace)(["AppMagic","DynamicDataSource","CompassData"],Je);var We=r(160);Object(u.exportToNamespace)(["AppMagic","DynamicDataSource"],We);var Ze=r(161);Object(u.exportToNamespace)(["AppMagic","DynamicDataSource"],Ze);r(204),r(205);var Xe=r(162);Object(u.exportToNamespace)(["AppMagic","DynamicDataSource"],Xe);var $e=r(69);Object(u.exportToNamespace)(["AppMagic","DynamicDataSource","ConnectionData"],$e);var Ye=r(163);Object(u.exportToNamespace)(["AppMagic","DynamicDataSource"],Ye);var et=r(164);Object(u.exportToNamespace)(["AppMagic","DynamicDataSource"],et);r(59),r(206);var tt=r(165);Object(u.exportToNamespace)(["AppMagic","DynamicDataSource"],tt);var rt=r(166);Object(u.exportToNamespace)(["AppMagic","DynamicDataSource"],rt);var nt=r(167);Object(u.exportToNamespace)(["AppMagic","DynamicDataSource"],nt);var at=r(168);Object(u.exportToNamespace)(["AppMagic","DynamicDataSource"],at);r(207),r(208);var ot=r(99);Object(u.exportToNamespace)(["AppMagic","DynamicDataSource","LocationData"],ot);var it=r(169);Object(u.exportToNamespace)(["AppMagic","DynamicDataSource"],it),Object(u.exportToNamespace)(["AppMagic","Encryption"],o);var st=r(170);Object(u.exportToNamespace)(["AppMagic","Common","FilePicker"],st);var ct=r(105);Object(u.exportToNamespace)(["AppMagic","Functions","Collect"],ct);var ut=r(68);Object(u.exportToNamespace)(["AppMagic","Functions","RecordInfoAttributeConstants"],ut);var lt=r(12);Object(u.exportToNamespace)(["AppMagic","Functions","DataSourceAttributeConstants"],lt);var dt=r(130);Object(u.exportToNamespace)(["AppMagic","Functions","DataSourceAttributeLookup"],dt);var pt=r(171);Object(u.exportToNamespace)(["AppMagic","Functions","DataSourceDefaultAttributeLookup"],pt);var ft=r(36);Object(u.exportToNamespace)(["AppMagic","Functions"],ft);var yt=r(6);Object(u.exportToNamespace)(["AppMagic","Functions"],yt);var gt=r(106);Object(u.exportToNamespace)(["AppMagic","Functions"],gt);var ht=r(38);Object(u.exportToNamespace)(["AppMagic","Functions","RemoveIf"],ht);var mt=r(34);Object(u.exportToNamespace)(["AppMagic","Functions","UpdateIf"],mt);r(140),r(209),r(210),r(211),r(212),r(213),r(214);Object(u.exportToNamespace)(["AppMagic"],i);var vt=r(15);Object(u.exportToNamespace)(["AppMagic"],vt);var bt=r(172);Object(u.exportToNamespace)(["AppMagic","Common","Media"],bt);var _t=r(131);Object(u.exportToNamespace)(["AppMagic","Common","Media"],_t);var Ct=r(173);Object(u.exportToNamespace)(["AppMagic","Common","Media"],Ct);var At=r(132);Object(u.exportToNamespace)(["AppMagic","Common","Media"],At);var St=r(174);Object(u.exportToNamespace)(["AppMagic","Common","Media"],St),Object(u.exportToNamespace)(["AppMagic","Common","Media"],s);var Dt=r(175);Object(u.exportToNamespace)(["AppMagic","Common","Media"],Dt);var Ot=r(176);Object(u.exportToNamespace)(["AppMagic","Common","Media"],Ot);var Et=r(45);Core.exportToNamespace(["AppMagic","Common","Media","MediaReference"],Et);var Tt=r(51);Core.exportToNamespace(["AppMagic","Common","Media","MediaUriResolver"],Tt);var Rt=r(177);Core.exportToNamespace(["AppMagic","Common","Media"],Rt);var wt=r(178);Core.exportToNamespace(["AppMagic","Common","Media"],wt);var Mt=r(179);Core.exportToNamespace(["AppMagic","Common","Media"],Mt);r(215);var Pt=r(180);Core.exportToNamespace(["AppMagic","Common"],Pt);var Ft=r(181);Core.exportToNamespace(["AppMagic","AuthoringTool"],Ft);var Nt=r(79);Core.exportToNamespace(["AppMagic"],Nt);var It=r(182);Core.exportToNamespace(["AppMagic","Services","Authentication"],It);var xt=r(123);Core.exportToNamespace(["AppMagic","Services","Authentication"],xt);var jt=r(89);Core.exportToNamespace(["AppMagic","Services"],jt);var Lt=r(48);Core.exportToNamespace(["AppMagic","Runtime","GeospatialDataService"],Lt);var Ut=r(21);Core.exportToNamespace(["AppMagic","Services","Intelligence","IntelligenceApiErrorCodes"],Ut);var kt=r(43);Core.exportToNamespace(["AppMagic","Services","Intelligence"],kt);r(47);var Vt=r(133);Core.exportToNamespace(["AppMagic","Services","Intelligence","ODataGlobalOperationTypeCodes"],Vt);var Bt=r(80);Core.exportToNamespace(["AppMagic","Services","IoT"],Bt);var Qt=r(134);Core.exportToNamespace(["AppMagic","Services","OrganizationSettings"],Qt);var Kt=r(183);Core.exportToNamespace(["AppMagic","Utility"],Kt);var qt=r(184);Core.exportToNamespace(["AppMagic","Utility"],qt);r(216);var Gt=r(135);Core.exportToNamespace(["AppMagic","Utility"],Gt);var Ht=r(136);Core.exportToNamespace(["AppMagic","Utility","StringUtility"],Ht);var zt=r(5);Core.exportToNamespace(["AppMagic","Utility"],zt);var Jt=r(137);Core.exportToNamespace(["AppMagic","Runtime","App"],Jt);var Wt=r(185);Core.exportToNamespace(["AppMagic","Runtime","App"],Wt);var Zt=r(186);Core.exportToNamespace(["AppMagic","Runtime","App","AugmentedReality"],Zt);var Xt=r(101);Core.exportToNamespace(["AppMagic","Runtime","App","AugmentedReality"],Xt);var $t=r(117);Core.exportToNamespace(["AppMagic","Runtime","App"],$t);var Yt=r(121);Core.exportToNamespace(["AppMagic","Runtime","App","Data"],Yt);var er=r(187);Core.exportToNamespace(["AppMagic","Runtime","App","Data"],er);var tr=r(17);Core.exportToNamespace(["AppMagic","Runtime","App","Data"],tr);var rr=r(88);Core.exportToNamespace(["AppMagic","Runtime","App","Data"],rr);r(71);var nr=r(7);Core.exportToNamespace(["AppMagic","Runtime","App","Data","ImpexStringsConstants"],nr);var ar=r(188);Core.exportToNamespace(["AppMagic","Runtime","App","Data","ImpexStringsVersions"],ar);var or=r(30);Core.exportToNamespace(["AppMagic","Runtime","App","Data","ImportExportErrors"],or);var ir=r(102);Core.exportToNamespace(["AppMagic","Runtime","App","Data"],ir);r(217);Core.exportToNamespace(["AppMagic","Runtime","App","Data"],a);var sr=r(122);Core.exportToNamespace(["AppMagic","Runtime","App","Data"],sr);var cr=r(27);Core.exportToNamespace(["AppMagic","Runtime","App","Data","ZipDataProcessor"],cr);var ur=r(52);Core.exportToNamespace(["AppMagic","Runtime","App","Data"],ur);var lr=r(118);Core.exportToNamespace(["AppMagic","Runtime","App"],lr);var dr=r(138);Core.exportToNamespace(["AppMagic","Runtime","App","ExpressionRuntimeConfig"],dr);var pr=r(40);Core.exportToNamespace(["AppMagic","Runtime","App","Functions"],pr);var fr=r(81);Core.exportToNamespace(["AppMagic","Runtime","App","Functions"],fr);var yr=r(124);Core.exportToNamespace(["AppMagic","Runtime","App","Functions"],yr);var gr=r(189);Core.exportToNamespace(["AppMagic","Runtime","App","Functions"],gr);r(141),r(142);var hr=r(98);Core.exportToNamespace(["AppMagic","Runtime","App","Messaging"],hr);var mr=r(190);Core.exportToNamespace(["AppMagic","Runtime","App","Messaging"],mr);var vr=r(53);Core.exportToNamespace(["AppMagic","Runtime","App"],vr);var br=r(191);Core.exportToNamespace(["AppMagic","Runtime","App"],br);var _r=r(192);Core.exportToNamespace(["AppMagic","Runtime","App"],_r);var Cr=r(193);Core.exportToNamespace(["AppMagic","Runtime","App"],Cr);var Ar=r(46);Core.exportToNamespace(["AppMagic","Runtime","App"],Ar)}]);
//# sourceMappingURL=D:/a/_work/1/s/obj/Assets/js/AppMagic.Runtime.App/AppMagic.Runtime.App.js.map
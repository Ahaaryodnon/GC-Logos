/*! For license information please see Player.Client.js.LICENSE.txt */
(function(){return this?this:window}())["@pa-client/player-client"]=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=75)}([function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"k",(function(){return s})),n.d(t,"i",(function(){return l})),n.d(t,"t",(function(){return p})),n.d(t,"l",(function(){return c})),n.d(t,"m",(function(){return d})),n.d(t,"j",(function(){return u})),n.d(t,"s",(function(){return g})),n.d(t,"r",(function(){return m})),n.d(t,"q",(function(){return h})),n.d(t,"o",(function(){return y})),n.d(t,"n",(function(){return f})),n.d(t,"p",(function(){return v})),n.d(t,"v",(function(){return C})),n.d(t,"u",(function(){return P})),n.d(t,"E",(function(){return b})),n.d(t,"I",(function(){return _})),n.d(t,"y",(function(){return A})),n.d(t,"G",(function(){return S})),n.d(t,"C",(function(){return w})),n.d(t,"B",(function(){return E})),n.d(t,"J",(function(){return T})),n.d(t,"z",(function(){return I})),n.d(t,"A",(function(){return k})),n.d(t,"h",(function(){return D})),n.d(t,"F",(function(){return M})),n.d(t,"H",(function(){return R})),n.d(t,"M",(function(){return L})),n.d(t,"K",(function(){return H})),n.d(t,"c",(function(){return U})),n.d(t,"g",(function(){return W})),n.d(t,"f",(function(){return x})),n.d(t,"w",(function(){return O})),n.d(t,"x",(function(){return N})),n.d(t,"D",(function(){return F})),n.d(t,"N",(function(){return B})),n.d(t,"L",(function(){return V}));var r="appindex.json",o="appIdentityMap",i="cachedserverappindex.json",a="cachemanager.json",s="Unknown App",l=0,p="0.0.0",c="",d="",u="",g="0",m=!0,h=!0,y=0,f=0,v="",C="EnableDebugUI",P="DisableDebugUI",b=".msappk",_="serverapps",A="lastUpdated",S=12e4,w=6,E=6,T="ms-apps-edit://",I="ms-apps-primary-host://",k="ms-apps-secondary-host://",D="/controls/player.client/",M="plugins",R="js",L="www",H={PrivacyTerms:"https://go.microsoft.com/fwlink/p/?LinkID=698505",SuggestAFeature:"https://go.microsoft.com/fwlink/p/?LinkID=698506",TermsOfService:"https://go.microsoft.com/fwlink/p/?LinkID=698507",SignUp:"https://go.microsoft.com/fwlink/p/?LinkID=717081",WebPlayerSignUp:"https://go.microsoft.com/fwlink/p/?LinkID=717081",FeedbackPrivacyTerms:"https://go.microsoft.com/fwlink/p/?LinkID=698510",LearnMore:"https://go.microsoft.com/fwlink/p/?LinkID=698511",iOSUpdateLink:"https://aka.ms/powerappsios",WindowsStoreLink:"https://aka.ms/powerappswin",AndroidStoreLink:"https://aka.ms/powerappsandroid",AndroidUpdateLink:"https://play.google.com/store/search?q=PowerApps",WindowsUpdateLink:"ms-windows-store:PDP?PFN=Microsoft.MSApps_8wekyb3d8bbwe",Help:Core.Environment.getCordovaPlatformId()===Core.Environment.CordovaPlatformId.iOS?"https://go.microsoft.com/fwlink/?linkid=846192":"https://go.microsoft.com/fwlink/p/?LinkID=698503",OpenSourceLicenses:Core.Environment.getCordovaPlatformId()===Core.Environment.CordovaPlatformId.iOS?"https://go.microsoft.com/fwlink/p/?LinkID=846194":"https://go.microsoft.com/fwlink/p/?LinkID=698508",Support:Core.Environment.getCordovaPlatformId()===Core.Environment.CordovaPlatformId.iOS?"https://go.microsoft.com/fwlink/?LinkID=846193":"https://go.microsoft.com/fwlink/?LinkID=760663",LearnCanvasApps:"https://aka.ms/learnCanvasApps",Legal:"https://go.microsoft.com/fwlink/?linkid=831507",Community:"https://go.microsoft.com/fwlink/?linkid=830843",Blogs:"https://go.microsoft.com/fwlink/?linkid=830847",UnsupportedControlsLearnMore:"https://go.microsoft.com/fwlink/?linkid=2148807"},U=Core.UI.Constants.BackstageIcons,W={webcam:function(){return Player.Strings.CapabilitiesWebcam},location:function(){return Player.Strings.CapabilitiesLocation},microphone:function(){return Player.Strings.CapabilitiesMicrophone}},x={webcam:"url(images/capabilities/camera.svg)",location:"url(images/capabilities/location.svg)",microphone:"url(images/capabilities/microphone.svg)"},O=".cancel-click,.dropdown-backdrop",N=!1,F="Â© 2015 Microsoft",B=["gmail.com","hotmail.com","outlook.com","live.com","yahoo.com","msn.com","mac.com","comcast.net","charter.net","cox.net","fastmail.fm","rogers.com"],V={CanvasApp_Standalone:"CanvasApp_Standalone",CanvasApp_Embedded_Teams:"CanvasApp_Embedded_Teams",CanvasApp_Embedded_SharePointForm:"CanvasApp_Embedded_SharePointForm",CanvasApp_Embedded_ShareWebPart:"CanvasApp_Embedded_ShareWebPart",CanvasApp_Embedded_PowerBI:"CanvasApp_Embedded_PowerBI",CanvasApp_Embedded_ModelAppForm:"CanvasApp_Embedded_ModelAppForm",CanvasApp_Embedded_iFrame:"CanvasApp_Embedded_iFrame",Consent_Embedded_CanvasApp:"Consent_Embedded_CanvasApp",Consent_Embedded_ModelApp:"Consent_Embedded_ModelApp",ModelApp_Standalone:"ModelApp_Standalone",ModelApp_Embedded_Teams:"ModelApp_Embedded_Teams",ModelApp_Embedded_iFrame:"ModelApp_Embedded_iFrame",AppHost_Embedded_CanvasApp:"AppHost_Embedded_CanvasApp",AppHost_Embedded_ModelApp:"AppHost_Embedded_ModelApp"}},function(e,t,n){"use strict";n.r(t),n.d(t,"WebPlayerErrorType",(function(){return r})),n.d(t,"RequestAppAccessStateType",(function(){return o})),n.d(t,"WebPlayerErrorDialog",(function(){return l})),n.d(t,"WebPlayerErrorDialogDetails",(function(){return p}));var r,o,i=n(10),a=n(9),s=n(72);!function(e){e[e.InvalidParameter=0]="InvalidParameter",e[e.GetAppNotFound=1]="GetAppNotFound",e[e.GetAppForbidden=2]="GetAppForbidden",e[e.GetAppFailure=3]="GetAppFailure",e[e.Unknown=4]="Unknown",e[e.RunAppFailure=5]="RunAppFailure",e[e.AppApiVersionNewer=6]="AppApiVersionNewer",e[e.AppApiVersionOlder=7]="AppApiVersionOlder",e[e.UnifiedApp=8]="UnifiedApp",e[e.UserNotLoggedIn=9]="UserNotLoggedIn",e[e.InvokeScriptBlocked=10]="InvokeScriptBlocked"}(r||(r={})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Failed=1]="Failed",e[e.Sending=2]="Sending",e[e.Sent=3]="Sent"}(o||(o={}));var l=function(e){function t(t){var n=e.call(this,t)||this,r=(new a.ShellHeaderManager).getShellHeader(),i=r?r.getHeight():0;return n.state={headerHeight:i,requestState:o.NotStarted},n._setDialogRootRef=n._setDialogRootRef.bind(n),n._requestAccessButtonHandlerAsync=n._requestAccessButtonHandlerAsync.bind(n),n}return __extends(t,e),t._clearAllStorage=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:try{localStorage.clear()}catch(e){}try{sessionStorage.clear()}catch(e){}try{Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.Client.ComponentKeys.SettingsProvider).clear()}catch(e){}try{Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.Client.ComponentKeys.UnencryptedSettingsProvider).clear()}catch(e){}try{Core.Environment.isWebPlayerEncryptedStorageEnabled()&&Core.Loader.ObjectFactory.instance.getSingleton(Core.IO.IEncryptedStorageKey).clearAllDataAsync()}catch(e){}try{Core.Loader.ObjectFactory.instance.getSingleton(Core.IO.IAsyncSettingsProviderKey).clearAsync()}catch(e){}e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Object(s.a)()];case 2:return e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:return[2]}}))}))},t.display=function(e,n,r,o,a){t._clearAllStorage(),t._containerElement=document.createElement("div"),ReactDOM.render(React.createElement(t,{errorType:e,details:n,requestAppAccessAsync:r,errorMessage:o,errorCode:a}),t._containerElement),document.body.appendChild(t._containerElement),i.WebPlayerSessionExpiredBanner.preventDisplay=!0,document.body.style.backgroundColor="white";var s=document.getElementById("loading-spinner"),l=document.getElementById("screenLoadingPlaceholder");s&&document.body.removeChild(s),l&&document.body.removeChild(l)},t.prototype.render=function(){var e,n,i,a={errorMessage:"",errorSubText:"",detailsText:this.props.details};switch(this.props.errorType){case r.AppApiVersionNewer:case r.AppApiVersionOlder:a.errorMessage=Player.Strings.WebPlayerErrorAppApiVersionMismatch;break;case r.RunAppFailure:a.errorMessage=Player.Strings.WebPlayerErrorRunAppFailure;break;case r.Unknown:a.errorMessage=Player.Strings.WebPlayerErrorUnknown;break;case r.GetAppFailure:a.errorMessage=Player.Strings.WebPlayerErrorGetAppFailure;break;case r.GetAppForbidden:Core.FeatureGates.playerUI.enableRequestAppAccessDialog&&this.props.errorCode===t._appShareErrorCode?a=this._getRequestAppAccessDialogInfo(this.props.details):(a.errorMessage=AppMagic.Strings.GenericPublishedAppErrorTitle,a.errorSubText=this.props.errorMessage||Player.Strings.WebPlayer403ErrorText);break;case r.GetAppNotFound:a.errorMessage=Player.Strings.WebPlayerErrorGetAppNotFound;break;case r.InvalidParameter:a.errorMessage=Player.Strings.WebPlayerErrorInvalidParameter,a.errorSubText=Player.Strings.WebPlayerErrorInvalidParameterSubText,a.detailsText=Core.Utility.formatString("{0}\n{1}\n{2}",Player.Strings.WebPlayerEncodingErrorExplanatoryDetails,Player.Strings.WebPlayerAppIdErrorExplanatoryDetails,a.detailsText);break;case r.UnifiedApp:if(this.props.errorCode)switch(this.props.errorCode){case"403":a.errorMessage=Player.Strings.WebPlayerErrorGetAppNotFound,a.detailsText=Player.Strings.UnifiedAppSubdomainMismatchErrorDescription;break;case"404":a.errorMessage=Player.Strings.WebPlayerErrorGetAppNotFound,a.detailsText=Player.Strings.UnifiedAppNotFoundErrorDescription;break;case"500":a.errorMessage=Player.Strings.WebPlayerErrorRunAppFailure,a.detailsText=Player.Strings.WebPlayer500ErrorText;break;default:a.errorMessage=Player.Strings.Error}else a.errorMessage=this.props.errorMessage||Player.Strings.Error;Core.Telemetry.Log.trackActivityEvent("WebPlayerErrorDialog.UnifiedAppErrorDialog",{errorCode:this.props.errorCode});break;case r.InvokeScriptBlocked:var s=Player.Strings.WebPlayerErrorInvokeScriptBlocked.split("##LINK##");3===s.length?(a.errorMessage=s[0],e=s[1],n="https://go.microsoft.com/fwlink/?linkid=2220204",i=s[2]):a.errorMessage=Player.Strings.WebPlayerErrorInvokeScriptBlocked;break;default:a.errorMessage=Player.Strings.Error}a.detailsText="".concat(a.detailsText?a.detailsText+"\r\n\r\n":"").concat(AppMagic.Strings.MessageDialogDetailsSessionIdTitle," ").concat(Core.Telemetry.Log.sessionId);var l=this.props.errorType===r.GetAppForbidden&&this.props.errorCode===t._appShareErrorCode&&this.state.requestState===o.NotStarted;return React.createElement("div",{ref:this._setDialogRootRef,className:aphrodite.css(c.container),style:{top:this.state.headerHeight},"aria-labelledby":"errorMessage errorSubText",role:"main"},React.createElement("div",{role:"alert"},React.createElement("p",{className:aphrodite.css(c.errorMessageText),"aria-label":a.errorMessage,id:"errorMessage"},a.errorMessage,n&&e&&React.createElement("a",{href:n,target:"_blank",rel:"noreferrer"},e),i),a.errorSubText&&React.createElement("p",{className:aphrodite.css(c.errorSubText),"aria-label":a.errorSubText,id:"errorSubText"},a.errorSubText)),this.state.requestState===o.Sending?React.createElement(Core.UI.Components.DotAnimation.DotAnimation,{key:"dot",color:"#872d87"}):React.createElement(p,{detailsText:a.detailsText,showRequestAccessButton:l,requestAccessButtonHandler:this._requestAccessButtonHandlerAsync}))},t.prototype.componentDidMount=function(){var e,t=this;window.webPlayerErrorDialogIsDisplayed=!0,null===(e=Core.Telemetry.Log.providerInstance)||void 0===e||e.setDefaultProperties({IsErrorPageDisplayed:!0}),Core.FeatureGates.playerUI.enableRequestAppAccessDialog&&this.props.errorType===r.GetAppForbidden&&Core.Telemetry.Log.trackUIActivityEvent("WebPlayerErrorDialog.componentDidMount.renderRequestAppAccessDialog"),setTimeout((function(){var e=document.getElementById("fullscreen-app-host");e&&e.setAttribute("aria-hidden","true"),!Core.Environment.isIframed()&&t._dialogRoot&&Core.UI.Utility.A11y.focusElement(t._dialogRoot)}))},t.prototype._getRequestAppAccessDialogInfo=function(e){var t={errorMessage:"",errorSubText:"",detailsText:e};switch(this.state.requestState){case o.Sending:t.errorMessage=Player.Strings.RequestAppAccessSendingTitle,t.errorSubText=Player.Strings.RequestAppAccessSendingMessage;break;case o.Sent:t.errorMessage=Player.Strings.RequestAppAccessSuccessTitle,t.errorSubText=Player.Strings.RequestAppAccessSuccessMessage;break;case o.Failed:t.errorMessage=Player.Strings.RequestAppAccessFailedTitle,t.errorSubText=Player.Strings.RequestAppAccessFailedMessage;break;case o.NotStarted:default:t.errorMessage=AppMagic.Strings.GenericPublishedAppErrorTitle,t.errorSubText=Player.Strings.PublishedAppErrorGetAppForbidden}return t},t.prototype._requestAccessButtonHandlerAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return this.setState({requestState:o.Sending}),[4,this.props.requestAppAccessAsync()];case 1:return e=t.sent(),this.setState({requestState:e}),[2]}}))}))},t.prototype._setDialogRootRef=function(e){this._dialogRoot=e},t._appShareErrorCode="Forbidden",t}(React.Component),p=function(e){function t(t){var n=e.call(this,t)||this;return n.state={showDetails:!1},n}return __extends(t,e),t.prototype.render=function(){return React.createElement("div",null,React.createElement("hr",{className:aphrodite.css(c.divider)}),React.createElement("div",{className:aphrodite.css(c.details)},React.createElement("div",{className:aphrodite.css(c.buttonRow)},React.createElement("button",{className:aphrodite.css(c.button),onClick:this._toggleDetails.bind(this)},this.state.showDetails?AppMagic.Strings.Less:AppMagic.Strings.More),this.props.showRequestAccessButton&&React.createElement("button",{className:aphrodite.css(c.button),onClick:this.props.requestAccessButtonHandler},Player.Strings.RequestAppAccessRequestAccessButton)),this.state.showDetails&&React.createElement("textarea",{className:aphrodite.css(c.detailsText),readOnly:!0,rows:4},this.props.detailsText)))},t.prototype._toggleDetails=function(){this.setState({showDetails:!this.state.showDetails})},t}(React.Component),c=aphrodite.StyleSheet.create({container:{position:"absolute",left:0,right:0,bottom:0,overflow:"auto",paddingRight:"10%",paddingLeft:"10%",display:"flex",flexDirection:"column",justifyContent:"center",zIndex:1029,backgroundColor:"white"},divider:{margin:"34px 0px",borderWidth:"0px",borderTop:"1px solid #c6c6c6"},errorMessageText:{fontSize:"2.77em",color:"black",fontWeight:200,textAlign:"center",fontFamily:"Segoe UI",margin:"118px 0px 16px",whiteSpace:"pre-line"},errorSubText:{fontSize:"1.85em",color:"black",fontWeight:200,textAlign:"center",fontFamily:"Segoe UI",bottomMargin:"16px",whiteSpace:"pre-line"},details:{display:"flex",flexDirection:"column",marginTop:"10px"},buttonRow:{display:"flex",flexDirection:"row",marginTop:"0px",justifyContent:"space-between"},button:{cursor:"pointer",background:"none",border:"none",padding:"0px",width:"auto",minWidth:"auto",color:"#742774",display:"block",":hover":{textDecoration:"underline"},":active":{color:"#5B0E5B"}},detailsText:{fontSize:"0.75em",color:"black",fontFamily:"Segoe UI"}})},function(e,t,n){"use strict";n.r(t),n.d(t,"showSessionDetails",(function(){return o})),n.d(t,"signOut",(function(){return i})),n.d(t,"downloadActionHandler",(function(){return a})),n.d(t,"addToTeamsActionHandler",(function(){return s})),n.d(t,"generateTrustedSideLoadingDeepLink",(function(){return l})),n.d(t,"dispatchResizeWindow",(function(){return p})),n.d(t,"removePlaceholderHeader",(function(){return c})),n.d(t,"formatOneShellErrorMessage",(function(){return d})),n.d(t,"getShellHeaderBootstrapUrl",(function(){return u})),n.d(t,"getShellHeaderBootstrapHost",(function(){return g}));var r=n(26);function o(){(new r.WebPlayerSessionDetailsDialog).showAsync()}function i(){Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.Client.IClientRuntimeSingletonKey).userService.logOutAsync()}function a(e,t){Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.webPlayerSwitchToNativeClient);var n=AppMagic.PowerApps.PowerAppsUtility.parseAppNameFromAppId(e);window.open(AppMagic.Services.Azure.Region.getCurrentRegion().appDownloadRootUri+n+t)}function s(e,t){var n=l(e,t);Core.Telemetry.Log.trackUIActivityEvent("WebPlayer.AddToTeamsButtonClicked",{appName:e,envName:t,addToTeamsDeepLink:Core.Telemetry.Utility.scrubSensitiveDataSafe(n)});try{window.open(n,"_blank")}catch(e){Core.Telemetry.Log.trackErrorEvent("OneShellAddtoTeamsFailedEvent",{message:"Failed to open deep link with error: ".concat(e)})}}function l(e,t){var n=AppMagic.Services.Azure.Region.getCurrentRegion().teamsEndpoint.host,r=AppMagic.Services.Azure.Region.getCurrentRegion().teamsPowerAppsId;return"https://".concat(n,"/l/app/").concat(r,"?templateInstanceId=").concat(e,"&environment=").concat(t)}function p(){var e;Core.Environment.getBrowserId()===Core.Environment.BrowserId.InternetExplorer?(e=document.createEvent("Event")).initEvent("resize",!0,!1):e=new Event("resize"),window.dispatchEvent(e)}function c(){var e=document.getElementById("shell-header-container");e&&e.parentElement.removeChild(e);var t=document.getElementById("shellHeaderPlaceHolderStyle");t&&t.parentElement.removeChild(t)}function d(e){var t;try{t=JSON.stringify(e)}catch(n){t="object"==typeof e&&"string"==typeof e.message?e.message:"Failed to parse OfficeShellHeader error"}return t}function u(e){return"".concat(g(e),"/api/shellbootstrapper/business/oneshell")}function g(e){switch(e){case"ex":return"https://shell.azurefd.eaglex.ic.gov";case"rx":return"https://shell.azurefd.microsoft.scloud";default:return"https://shell.cdn.office.net"}}},function(e,t,n){"use strict";n.r(t),n.d(t,"WebPlayerRuntime",(function(){return h}));var r=n(72),o=n(71),i=n(34),a=n(1),s=n(17),l=n(8),p=n(4),c=n(6),d=n(41),u=n(28),g=n(5),m=n(42),h=function(){function e(){}return Object.defineProperty(e,"_appHostRuntime",{get:function(){return s.AppHostRuntime.getInstance(e._appLoadedHandler,e._appFailedHandler,e._appErrorStateHandler,e._appIndexLoadedEventHandler,e._showAppSplashScreen,e._displayGettingDataString,e._showUnsupportedControlsBanner,e._exitHostedApp,e._handleExitCurrentApp,e._handlePostExitCurrentApp,null)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"_webPlayerUIProvider",{get:function(){return m.WebPlayerUIProvider.getInstance()},enumerable:!1,configurable:!0}),e._appLoadedHandler=function(){e._appLoaded=!0,e._endScenario({scenarioGuidPropertyName:"_playAppScenarioGuid",scenarioResult:Core.Telemetry.ScenarioResult.Success}),e._endScenario({scenarioGuidPropertyName:"_playerSdkScenarioGuid",scenarioResult:Core.Telemetry.ScenarioResult.Success}),e._setIframeTitle(),e._webPlayerFitToScreen(),e._showDeprecationBanner(),e._promptForCsatIfNeededAsync(),e._removeReloadCountParameter(),e._webPlayerUIProvider.hideSplashScreen(),e._webPlayerUIProvider.endSplashScreenScenario(),Core.Environment.isUsingWebPlayerSdk()&&e.postMessageToSdk({api:WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.AppLoaded},"*"),Core.Environment.isSkypeTeams()&&(c.TeamsWebPlayerRuntime.notifyAppInitializationSuccess(),c.TeamsWebPlayerRuntime.sendTeamsContextToApp()),e._renderShellHeader(),e._webPlayerFitToScreen()},e._appFailedHandler=function(t){var n;if(e._endScenario({scenarioGuidPropertyName:"_playerSdkScenarioGuid",scenarioResult:Core.Telemetry.ScenarioResult.Failed}),e._endScenario({scenarioGuidPropertyName:"_playerSdkScenarioGuid",scenarioResult:Core.Telemetry.ScenarioResult.Failed}),window.location.href.toLowerCase().indexOf("skipmetadata=true")<0){if(!1===Core.Environment.isPublishedAppExternalToHost()&&(null===(n=window.webPlayerServerConfig.FeatureGates)||void 0===n?void 0:n.EntryPointCaching)&&(!Core.Environment.isIframed()||Core.Environment.isSkypeTeams())){var r=new Core.UrlBuilder(window.location.href);return r.setQueryParam("skipmetadata","true"),Core.Telemetry.Log.trackActivityEvent("WebPlayerRuntime.RefreshingOnAppError",{source:window.webPlayerServerConfig.MetadataSource,cachingResult:window.webPlayerServerConfig.MetadataCachingResult,errorMessage:t}),void e._tryClearEntryCacheAndReload(r.toString())}if(Core.Environment.isPublishedAppExternalToHost()&&!window.webPlayerServerConfig.IsConsentOnly)return void e._clearSiblingIframeAndReload()}Core.Environment.isUsingWebPlayerSdk()&&e.postMessageToSdk({api:WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.AppFailed},"*"),Core.Environment.isSkypeTeams()&&c.TeamsWebPlayerRuntime.notifyAppInitializationFailure(t),e._webPlayerUIProvider.handleAppFailedUI(),e._webPlayerUIProvider.endSplashScreenScenario()},e._tryClearEntryCacheAndReload=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n;return __generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),Core.Telemetry.Log.trackActivityEvent("WebPlayerRuntime._tryClearEntryCacheAndReload.Start"),[4,Core.PromiseUtils.wrapWithTimeout(Object(r.a)(window.location.pathname),3e3)];case 1:return t=o.sent().hasTimedOut,Core.Telemetry.Log.trackActivityEvent("WebPlayerRuntime._tryClearEntryCacheAndReload.Success",{hasTimedOut:t}),[3,3];case 2:return n=o.sent(),Core.Telemetry.Log.trackActivityEvent("WebPlayerRuntime._tryClearEntryCacheAndReload.Failed",{error:Core.PromiseUtils.formatError(n)}),[3,3];case 3:return Core.Telemetry.Log.flush(),window.location.replace(e),[2]}}))}))},e._clearSiblingIframeAndReload=function(){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(n){return(t=new Core.UrlBuilder(window.location.href)).setQueryParam("skipmetadata","true"),Core.Environment.publishedAppHasCachedFiles()&&(e._postClearPublishedAppMessageToHost(),t.setQueryParam("hasCachedFiles",void 0),t.setQueryParam("skipIframeCreation",void 0)),t.setQueryParam("packageProperties",void 0),[2,e._tryClearEntryCacheAndReload(t.toString())]}))}))},e._appIndexLoadedEventHandler=function(){var t;(e._webPlayerUIProvider.shortAppSplashScreen||!(null===(t=e._appHostManager)||void 0===t?void 0:t.currentAppHost))&&e._webPlayerUIProvider.hideSplashScreen()},e._showAppSplashScreen=function(){e._webPlayerUIProvider.showAppSplashScreen(e._appPreloadData)},e._displayGettingDataString=function(){e._appHostManager.appIsLoading&&(Core.PerformanceTracker.trackPerfStartEvent("webPlayerDisplayGettingDataOnSplashScreen"),e._webPlayerUIProvider.displayGettingDataString())},e._showUnsupportedControlsBanner=function(t){e._webPlayerUIProvider.showUnsupportedControlsBanner(t)},e._initializeAppHostUI=function(){e._webPlayerUIProvider.initializeAppHostUI()},e._disposeUIProvider=function(){e._webPlayerUIProvider.dispose()},e._layoutUpdateHandler=function(){e._webPlayerUIProvider.layoutUpdateHandler()},e._renderShellHeader=function(){e._webPlayerUIProvider.renderShellHeader(e._appHostManager.runningAppInfo,e._errorDuringAppLaunch,e._playerRuntime)},e._setIframeTitle=function(){e._webPlayerUIProvider.setIframeTitle(e._appHostManager.runningAppInfo)},e._exitHostedApp=function(){e._renderShellHeader(),e._layoutUpdateHandler()},e._appErrorStateHandler=function(t){var n,r;"AppNotFound"===t.code?(n=a.WebPlayerErrorType.GetAppNotFound,r=Player.Strings.WebPlayerErrorGetAppNotFound):"AppForbidden"===t.code?(n=a.WebPlayerErrorType.GetAppForbidden,r=Player.Strings.WebPlayerErrorGetAppForbidden):"InvokeScriptBlocked"===t.code&&(n=a.WebPlayerErrorType.InvokeScriptBlocked,r=Player.Strings.WebPlayerErrorInvokeScriptBlocked),n&&e.handleErrorAndCleanUp(n,r,"",r)},Object.defineProperty(e,"_webPlayerParams",{get:function(){return e._appHostRuntime.webPlayerParams},enumerable:!1,configurable:!0}),Object.defineProperty(e,"_playerRuntime",{get:function(){return e._appHostRuntime.playerRuntime},enumerable:!1,configurable:!0}),Object.defineProperty(e,"_appHostManager",{get:function(){return e._appHostRuntime.appHostManager},enumerable:!1,configurable:!0}),e.startAsync=function(){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(n){switch(n.label){case 0:return Core.Environment.isSdkPreload()?[2]:(e._appHostRuntime.setWebplayerUrlTelemetryDefaultProperty(),[4,e._redirectIfOnMobileAndNotEmbedded()]);case 1:return n.sent(),"PlayerLifecycle.WebPlayer.Play.PlayApp",e._playAppScenarioGuid=Core.Telemetry.Log.startScenario(Core.Telemetry.ScenarioName.PlayerLifecycleWebPlayerPlayPlayApp,{operationName:"PlayerLifecycle.WebPlayer.Play.PlayApp"}),"PlayerLifecycle.PlayerSDK.PlayApp",e._playerSdkScenarioGuid=Core.Telemetry.Log.startScenario(Core.Telemetry.ScenarioName.PlayerLifecyclePlayerSDKPlayApp,{operationName:"PlayerLifecycle.PlayerSDK.PlayApp"}),e._appHostRuntime.initialize(),e._scenarioResult="",e._playerRuntime.identityService.identityChangeEvent.addListener((function(){Core.Telemetry.Log.trackActivityEvent("PlayerLifecycle.PlayerSDK.PlayApp.LoadAppHost.InitPlugins.UserIdentityInitialized")})),Core.Environment.isSkypeTeams()&&c.TeamsWebPlayerRuntime.start(),e._trackWebPlayerActiveState(),window.addEventListener("message",e._handleMessage),setTimeout((function(){e.postMessageToSdk({api:WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.ReadyToHandleMessages})})),(t=Object(l.getSessionParams)())?[4,e._setUpMonitorSessionAsync(t)]:[3,3];case 2:n.sent(),Core.Diagnostics.setupAndEnableDiagnostics(null==t?void 0:t.baseUrl,null==t?void 0:t.sessionToken),n.label=3;case 3:return e._prepareWindowBeforeUnloadHandler(),e.initializeWebPlayerAndRunPublishedAppAsync(),[2]}}))}))},e._prepareWindowBeforeUnloadHandler=function(){window.isWebPlayerBVT||(window.onbeforeunload=function(){var t;return Core.Telemetry.Log.trackActivityEvent(window.Core.Telemetry.Strings.webPlayerAppExit),null===(t=e._appHostManager)||void 0===t?void 0:t.notificationProvider.confirmExitBeforeUnload()})},e._setUpMonitorSessionAsync=function(t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(n){switch(n.label){case 0:return this._appHostRuntime.appHost?[4,this._appHostRuntime.appHost.loaded.waitAsync().then((function(){return Object(l.setUpSessionAsync)(e._playerRuntime.httpClient,t)}))]:(Core.Telemetry.Log.trackErrorEvent("WebPlayerRuntime._setUpMonitorSessionAsync",{message:"App host not available!"}),Object(l.disableSession)(),[2]);case 1:return n.sent(),[2]}}))}))},e.initializeWebPlayerAndRunPublishedAppAsync=function(){var t;return __awaiter(this,void 0,Promise,(function(){var n;return __generator(this,(function(r){return e._initPluginsScenarioGuid=Core.Telemetry.Log.startScenario(Core.Telemetry.ScenarioName.PlayerLifecyclePlayerSDKPlayAppLoadAppHostInitPlugins,{operationName:"PlayerLifecycle.PlayerSDK.PlayApp.LoadAppHost.InitPlugins"}),n=new Promise((function(t){e._initializeAppHostUI(),e._appHostRuntime.initializeWebPlayer(),t()})),window.CurrentActiveView=ko.observable(),Core.Environment.isSkypeTeams()&&(window.invertedLoad||(null===(t=window.performance)||void 0===t||t.mark("webPlayerTeamsNotifyAppInitializationLoaded"),microsoftTeams.appInitialization.notifyAppLoaded())),Core.PromiseUtils.join([n,this._appHostRuntime.appHost.loaded.waitAsync()]).then((function(){e._scenarioGuid=e._appHostRuntime.logWebPlayerLaunchTelemetry(),e._playerRuntime.userService.skipEnroll();var t=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.Client.ComponentKeys.EcsHelper);return Core.FeatureGates.flighting.enableEcsFeatures||null===g.AppMetadataCaching||void 0===g.AppMetadataCaching||g.AppMetadataCaching.updateCachedMetadataWithEcsResponseAsync({}),(null==t?void 0:t.configUpdated)&&t.configUpdated.subscribe((function(e){var t;null===g.AppMetadataCaching||void 0===g.AppMetadataCaching||g.AppMetadataCaching.updateCachedMetadataWithEcsResponseAsync(null!==(t=null==e?void 0:e.FallbackSwitch)&&void 0!==t?t:{})})),e._getAppAndRunAsync(!1)})).catch((function(t){return Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.webPlayerRuntimeOptimisticStartErrorHandled,{message:"First _getAppAndRunAsync() threw an exception that we handled.\r\n".concat(Core.PromiseUtils.formatErrorMessage(t))}),e._checkUserAsync(t).then((function(t){if(t)return e._getAppAndRunAsync(!0)}))})).catch((function(t){e.handleErrorAndCleanUp(a.WebPlayerErrorType.Unknown,Core.PromiseUtils.formatError(t),Core.DiagnosticError.tryGetDiagnosticMessage(t))})),[2]}))}))},e.unloadAppHostManager=function(){e._appHostManager&&(e._postClearPublishedAppMessageToHost(),e._disposeUIProvider(),e._appHostRuntime.disposeAppHostManager())},e.getPublishedAppContainer=function(){return document.getElementsByClassName(e.publishedAppContainerClass)[0]},e.postMessageToSdk=function(t,n){if(void 0===n&&(n="*"),Core.Environment.isUsingWebPlayerSdk()&&window.parent){var r=e._webPlayerParams.appId,o=e._webPlayerParams.iframeContainerId;t=Object.assign(t,{appId:r,containerId:o}),window.parent.postMessage(t,n)}else(Core.Environment.isSharedAppHost()||Core.Environment.isSharedConsentOnly())&&e._appHostRuntime.postMessageToSdk(t,n)},e.onInteractionRequired=function(t){var n,r;if(!window.webPlayerServerConfig.IsConsentOnly&&Core.Environment.isPublishedAppExternalToHost()&&!e._appLoaded){e._postClearPublishedAppMessageToHost();var o=new Core.UrlBuilder(window.location.href);o.setQueryParam("packageProperties",void 0),o.setQueryParam("hasCachedFiles",void 0),o.setQueryParam("skipIframeCreation",void 0),o.setQueryParam("spoInteractionRequired","true"),Core.Telemetry.Log.trackErrorEvent("onInteractionRequired.AppNotLoaded"),Core.Telemetry.Log.flush(),window.Utilities.reloadWindowWithLogging(window,"WebPlayerRuntime.onInteractionRequired",o.toString(),null===(r=null===(n=Core.Telemetry)||void 0===n?void 0:n.Log)||void 0===r?void 0:r.sessionId)}var i={api:WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.InteractionRequired};t&&(i.data=t),e.postMessageToSdk(i),Core.Environment.isSkypeTeams()&&c.TeamsWebPlayerRuntime.notifyAppInitializationSuccess()},e.getAppTitle=function(){var t,n,r;return null!==(r=null===(n=null===(t=e._appHostManager)||void 0===t?void 0:t.runningAppInfo)||void 0===n?void 0:n.name)&&void 0!==r?r:""},e.navigateToPreconfiguredPortalUri=function(){Core.Telemetry.Log.flush();var e=Core.Environment.getWebPlayerQueryParam(WebPlayerSettings.sourceParam);Core.Environment.isIframed()||Core.Environment.isSkypeTeams()?window.location.href="about:blank":e&&"portal"===e.toLowerCase()?window.location.href=AppMagic.Services.Azure.Region.getCurrentRegion().portalUri.toString():window.location.href=AppMagic.Services.Azure.Region.getCurrentRegion().consumerPortalUri.toString()},e._trackWebPlayerActiveState=function(){var t,n;void 0!==document.hidden?(t="hidden",n="visibilitychange"):void 0!==document.msHidden&&(t="msHidden",n="msvisibilitychange"),t?(e._logDocumentVisibilityTelemetry=e._logDocumentVisibilityTelemetry.bind(null,t),e._logDocumentVisibilityTelemetry(),document.addEventListener(n,e._logDocumentVisibilityTelemetry)):Core.Telemetry.Log.trackActivityEvent("WebPlayer.TrackBackgrounding",{message:"Unable to set backgrounding tracking. PageVisibility API unavailable: document hidden property undefined."})},e._logDocumentVisibilityTelemetry=function(t){var n=e._setMarkerTime.bind(null,"WebPlayerInactiveMarkers");if(document[t]){if(null!=e._webPlayerInactiveScenarioGuid)return;n([Date.now(),null]),e._webPlayerInactiveScenarioGuid=Core.Telemetry.Log.startScenario(Core.Telemetry.ScenarioName.WebPlayerInactive),Core.Telemetry.Log.updateOpenAppData({inactive:!0,lastInactiveTime:Date.now()}),Core.Telemetry.Log.setInactive(!0);var r=performance.memory;r&&Core.Telemetry.Log.trackActivityEvent("Perf.Memory.TabInactive",{totalHeapSize:r.totalJSHeapSize,usedHeapSize:r.usedJSHeapSize,heapSizeLimit:r.jsHeapSizeLimit})}else if(e._webPlayerInactiveScenarioGuid){n([null,Date.now()]);var o=Core.Telemetry.Log.endScenario(e._webPlayerInactiveScenarioGuid),i=Core.Telemetry.Log.getOpenAppDataProperties().inactiveDuration||0;i+=o,Core.Telemetry.Log.updateOpenAppData({inactive:!1,lastInactiveTime:null,inactiveDuration:i}),Core.Telemetry.Log.setInactive(!1),e._webPlayerInactiveScenarioGuid=null}},e._logClientControlConnectorAndDeviceCapabilities=function(e){var t=Core.Environment.getDeviceId();Core.Telemetry.Log.trackActivityEvent("WebPlayerRuntime.ClientControlConnectorAndDeviceCapabilities",{device:Core.Environment.DeviceId[t],requestedCapabilities:null==e?void 0:e.deviceCapabilities,connectionIds:null==e?void 0:e.connectionIds,isTeams:Core.Environment.isSkypeTeams(),isMobile:Core.Environment.isMobileDevice()})},e._handleMessage=function(t){var n,r=t.data;if(r&&r.api)switch(r.api){case WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.SetConnectorAuthResult:d.WebPlayerSDKMessenger.processConnectorAuthResult(r.data);break;case WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.SetConsentResult:null===(n=e._appHostManager)||void 0===n||n.currentAppHost.powerAppsClient.consentProvider.updateConsentResultAsync(r.data);break;case WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.VisibilityChanged:var o=t.data,i=e._setMarkerTime.bind(null,"WebPlayerEmbeddedHiddenMarkers");if(o.visible){if(e._webPlayerEmbeddedHiddenScenarioGuid){i([null,Date.now()]);var a=Core.Telemetry.Log.endScenario(e._webPlayerEmbeddedHiddenScenarioGuid),s=Core.Telemetry.Log.getOpenAppDataProperties().embeddedHiddenDuration||0;s+=a,Core.Telemetry.Log.updateOpenAppData({embeddedHidden:!1,lastEmbeddedHiddenTime:null,embeddedHiddenDuration:s}),e._webPlayerEmbeddedHiddenScenarioGuid=null}}else i([Date.now(),null]),e._webPlayerEmbeddedHiddenScenarioGuid=Core.Telemetry.Log.startScenario(Core.Telemetry.ScenarioName.WebPlayerEmbeddedHidden),Core.Telemetry.Log.updateOpenAppData({embeddedHidden:!0,lastEmbeddedHiddenTime:Date.now()})}},e._setMarkerTime=function(e,t){var n,r=Core.Telemetry.Log.getOpenAppDataProperties()[e]||[],o=t[0],i=t[1];if(o&&r.push([o,null]),i){var a=r[r.length-1];a&&!a[a.length-1]&&(a[a.length-1]=i)}Core.Telemetry.Log.updateOpenAppData(((n={})[e]=r,n))},e._getAppAndRunAsync=function(t){var n,r,i,s;return __awaiter(this,void 0,Promise,(function(){var l,p,d,m,h,y,f,v,C,P,b,_,A,S,w,E,T,I,k,D;return __generator(this,(function(M){switch(M.label){case 0:if(Core.Telemetry.Log.trackActivityEvent(Core.Telemetry.Strings.webPlayerGetApp,{isUserChecked:t}),!e._webPlayerParams.appId||Core.Utility.isEmptyString(e._webPlayerParams.appId))return[3,13];Core.Telemetry.Log.setPlayerAppId(e._webPlayerParams.appId),Core.Telemetry.Log.updateOpenAppData({appId:e._webPlayerParams.appId}),l=Core.PerformanceTracker.exitScopeAndGetRunTime(e._appHostRuntime.webPlayerAppHostLoadScopeName),Core.Telemetry.Log.updateOpenAppData({webPlayerLoadAppHostTime:l}),Core.Utility.isNonEmptyNonWhitespaceString(e._webPlayerParams.environmentName)&&(p={id:"/providers/Microsoft.PowerApps/environments/".concat(e._webPlayerParams.environmentName),name:e._webPlayerParams.environmentName},e._playerRuntime.clientRuntime.userService.getEnvironmentService().switchEnvironment(p)),M.label=1;case 1:return M.trys.push([1,11,,12]),d=void 0,m=t,(Core.Utility.isNumber(e._webPlayerParams.sasKeyDebugDuration)&&e._webPlayerParams.sasKeyDebugDuration>=0||Core.Environment.getSkipLaunchAppCache())&&(m=!0),h=e._webPlayerParams.appId+"-PackagePropertiesJson",[4,(y=Core.Loader.ObjectFactory.instance.getSingleton(Core.IO.IAsyncSettingsProviderKey)).getValueAsync(h)];case 2:if(f=M.sent(),v=Core.Environment.getWebPlayerQueryParam(WebPlayerSettings.packageProperties,!0))try{JSON.parse(v)}catch(e){Core.Telemetry.Log.trackActivityEvent("WebPlayerRuntime.RemovedPackagePropertiesAsInvalid",{passedPackageProperties:v}),v=null}return!Core.Environment.publishedAppHasCachedFiles()||v?[3,4]:(e._postClearPublishedAppMessageToHost(),(C=new Core.UrlBuilder(window.location.href)).setQueryParam("packageProperties",void 0),C.setQueryParam("hasCachedFiles",void 0),C.setQueryParam("skipIframeCreation",void 0),Core.Telemetry.Log.trackErrorEvent("_getAppAndRunAsync.MissingPackagePropsInCachedFileMode"),Core.Telemetry.Log.flush(),[4,window.Utilities.reloadWindowWithLogging(window,"WebPlayerRuntime._getAppAndRunAsync",C.toString(),null===(r=null===(n=Core.Telemetry)||void 0===n?void 0:n.Log)||void 0===r?void 0:r.sessionId)]);case 3:M.sent(),M.label=4;case 4:return!v&&window.webPlayerServerConfig.PublishedAppConfig&&(v=window.webPlayerServerConfig.PublishedAppConfig.ServerPackageProperties,Core.Telemetry.Log.trackActivityEvent("WebPlayerRuntime.ServerPreloadPackageMetadata",{metadata:window.webPlayerServerConfig.PublishedAppConfig.ServerPackageProperties})),f?(v&&!e._propertiesAreEqual(v,f)&&(y.setValueAsync(h,v,!0),m=!0,Core.Telemetry.Log.trackActivityEvent("_getAppAndRunAsync.BypassLaunchAppCache",{passedPackageProperties:v,storedPackageProperties:f})),[3,7]):[3,5];case 5:return v?[4,y.setValueAsync(h,v,!0)]:[3,7];case 6:M.sent(),M.label=7;case 7:return[4,e._getAppPreloadDataAsync(m)];case 8:return d=M.sent(),Core.Environment.isSkypeTeams()&&c.TeamsWebPlayerRuntime.appendHintToTeamsUrl(d.getAppResourcesPromise,e._webPlayerParams.appId),!Core.FeatureGates.webPlayer.authoringPreview||Core.Utility.isEmpty(e._webPlayerParams.draftKey)||-1===e._webPlayerParams.docServerHost.indexOf("local.create.powerapps.com")?[3,10]:[4,e._playerRuntime.userService.appResourceManager.getDraftAppDataAsync(e._webPlayerParams.draftKey,e._webPlayerParams.docServerHost)];case 9:d=M.sent(),M.label=10;case 10:return e._appPreloadData=d.appPreloadData,e._logClientControlConnectorAndDeviceCapabilities(e._appPreloadData),e._appPreloadData.documentServerVersion&&(P=JSON.stringify(e._appPreloadData.documentServerVersion),Core.Telemetry.Log.updateOpenAppData({documentServerVersion:P})),v&&e._appPreloadData.packageProperties&&(e._propertiesAreEqual(v,e._appPreloadData.packageProperties)||(Core.Telemetry.Log.trackErrorEvent("_getAppAndRunAsync.PassedPackagePropertiesMismatch",{passedPackageProperties:v,appInfoPackageProperties:e._appPreloadData.packageProperties}),this._clearSiblingIframeAndReload())),window.location.href.toLowerCase().indexOf("skipmetadata=true")<0&&(null===g.AppMetadataCaching||void 0===g.AppMetadataCaching||g.AppMetadataCaching.updateCachedMetadataWithLaunchAppResponseAsync(d)),Core.Telemetry.Log.updateOpenAppData({howOpened:Core.Telemetry.OpenAppData.HowOpenedLaunchApp}),WebPlayerSettings.allowDebugOptions&&e._webPlayerParams.localHash&&("https://patestresources.blob.core.windows.net/","/web/index.web.html",e._appPreloadData.webPackageUrl="https://patestresources.blob.core.windows.net/"+e._webPlayerParams.localHash+"/web/index.web.html"),document.title="".concat(e._appPreloadData.displayName," - ").concat(AppMagic.Strings.PowerApps),document.getElementById("shell-header-app-name")&&(document.querySelector("#shell-header-app-name .shell-brand-title").innerText=e._appPreloadData.displayName),b=o.b.getTimeUntilSASRenewalInMs(e._appPreloadData.webPackageUrl),e._webPlayerSessionManager=new u.WebPlayerSessionManager(e._appPreloadData.displayName,null,!!(null===(i=window.webPlayerServerConfig.PublishedAppConfig)||void 0===i?void 0:i.UsesAltAuth),window.webPlayerServerConfig.AuthConfig.OnBehalfOfResource,void 0,void 0,b,null===(s=e._appPreloadData.environment)||void 0===s?void 0:s.name),e._runWebPlayerApp(e._appPreloadData,d.getAppResourcesPromise),[3,12];case 11:if(_=M.sent(),A=a.WebPlayerErrorType.Unknown,S=Core.PromiseUtils.formatErrorMessage(_),w=null,E=null,T=null,AppMagic.Services.errorHasHttpResponse(_))switch(Core.Log.error("PowerAppsApp.getAppAsync",_,"response.status: "+_.response.status),_.response.status){case AppMagic.Services.HttpConstants.HttpStatusCode.NotFound:A=a.WebPlayerErrorType.GetAppNotFound,S="Received not found from launchApp";try{(I=JSON.parse(_.message))&&I.error&&I.error.message&&(w=I.error.message)}catch(e){S=_.message}break;case AppMagic.Services.HttpConstants.HttpStatusCode.Forbidden:if(!t)throw _;A=a.WebPlayerErrorType.GetAppForbidden,k=e._tryParseRpError(S);try{k&&(T=k.code,E=k.message,w=E,(D=k.details)&&D.forEach((function(e){var t=null==e?void 0:e.message;t&&(w+="\n",w+=t)})))}catch(e){Core.Telemetry.Log.trackErrorEvent("WebPlayerRuntime._getAppAndRunAsync.ParseRpErrorFailed",{message:S,error:e})}S="Received forbidden from launchApp";break;default:A=a.WebPlayerErrorType.GetAppFailure,S="Received failure from launchApp"}else""===S&&(S="Unknown Error");if(!t)throw _;return e.handleErrorAndCleanUp(A,S,w,E,T),[3,12];case 12:return[3,14];case 13:e.handleErrorAndCleanUp(a.WebPlayerErrorType.InvalidParameter,"Unable to get app Id from url"),M.label=14;case 14:return[2]}}))}))},e._tryParseRpError=function(e){try{var t=JSON.parse(e);return null==t?void 0:t.error}catch(t){Core.Telemetry.Log.trackErrorEvent("WebPlayerRuntime._tryParseRpError",{message:e,error:t})}},e._getAppPreloadDataAsync=function(t){return __awaiter(this,void 0,Promise,(function(){var n,r,o;return __generator(this,(function(i){switch(i.label){case 0:e._appHostRuntime.appHost.appResourceManagerEvents().addListener(e._appEventListener),n=Core.Telemetry.Log.startScenario(Core.Telemetry.ScenarioName.PlayerLifecyclePlayerSDKPlayAppLoadMetadataFetchAppMetadata,{operationName:"PlayerLifecycle.PlayerSDK.PlayApp.LoadMetadata.FetchAppMetadata"}),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,e._playerRuntime.userService.appResourceManager.getAppPreloadDataAsync(e._webPlayerParams.appId,t,!1,!0,AppMagic.Runtime.Client.AppPackageType.WebPlayer,e._webPlayerParams.sasKeyDebugDuration)];case 2:return r=i.sent(),Core.Telemetry.Log.passScenario(n,{customScenarioData:{ListPackageIsCalled:e._listPackageIsCalled,MaxListPackagePolling:e._currentListPackagePollingTime}}),[2,r];case 3:throw o=i.sent(),Core.Telemetry.Log.failScenario(n,{customScenarioData:{ListPackageIsCalled:e._listPackageIsCalled,MaxListPackagePolling:e._currentListPackagePollingTime}}),o;case 4:return e._appHostRuntime.appHost.appResourceManagerEvents().removeListener(e._appEventListener),e._listPackageIntervalId&&(clearInterval(e._listPackageIntervalId),e._listPackageIntervalId=null),[7];case 5:return[2]}}))}))},e._propertiesAreEqual=function(e,t){var n="string"==typeof e?JSON.parse(e):e,r="string"==typeof t?JSON.parse(t):t;if(Object.getOwnPropertyNames(n).length!==Object.getOwnPropertyNames(r).length)return!1;for(var o=0,i=Object.getOwnPropertyNames(n);o<i.length;o++){var a=i[o];if(!r.hasOwnProperty(a)||r[a]!==n[a])return!1}return!0},e._checkUserAsync=function(t){return __awaiter(this,void 0,Promise,(function(){var n,r;return __generator(this,(function(o){switch(o.label){case 0:return null===(n=e._playerRuntime.userService.userProfile)?[3,2]:[4,Object(p.handleLaunchAppCallErrorAsync)(t,e._playerRuntime.userService,e._playerRuntime.httpClient,n.isGuest,e._webPlayerParams.appId,e._webPlayerParams.environmentName)];case 1:return o.sent(),[2,!0];case 2:return r="Unknown user",AppMagic.Runtime.Client.Adal.ServerAccessTokenRetriever.lastAuthError&&(r=JSON.stringify(AppMagic.Runtime.Client.Adal.ServerAccessTokenRetriever.lastAuthError)),Core.Telemetry.Log.trackErrorEvent("WebPlayer.NoUser.Error",{errorDetail:r}),e.handleErrorAndCleanUp(a.WebPlayerErrorType.Unknown,"Unknown user",r),[2,!1]}}))}))},e.handleErrorAndCleanUp=function(t,n,r,o,i){var s;if(e._errorDuringAppLaunch=!0,e._endScenario({scenarioGuidPropertyName:"_playAppScenarioGuid",scenarioResult:Core.Telemetry.ScenarioResult.Failed}),e._endScenario({scenarioGuidPropertyName:"_playerSdkScenarioGuid",scenarioResult:Core.Telemetry.ScenarioResult.Failed}),Core.Environment.isSharedAppHost())e._appHostRuntime.handleErrorAndCleanUp(t,n,r,o,!0);else{var l={message:Core.Telemetry.Utility.scrubSensitiveDataSafe(n),url:Core.Telemetry.Utility.scrubSensitiveDataSafe(window.location.href),errorType:t,errorDetails:Core.Telemetry.Utility.scrubSensitiveDataSafe(r)};e._scenarioResult=n,Core.Telemetry.Log.trackErrorEvent(Core.Telemetry.Strings.webPlayerError,l),e._appHostRuntime.tryHandleWarmAppLoadInTeamsError()||(a.WebPlayerErrorDialog.display(t,r,e._requestAppAccessAsync,o,i),null===(s=e._appHostManager)||void 0===s||s.exitHostedApp(),Core.Environment.isUsingWebPlayerSdk()&&window.parent&&e.postMessageToSdk({api:WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.AppFailed},"*"),e._postClearPublishedAppMessageToHost(),e.removePlayerSplashScreen(),e._appHostRuntime.flushTelemetry())}},e._requestAppAccessAsync=function(){return __awaiter(this,void 0,Promise,(function(){var t,n;return __generator(this,(function(r){switch(r.label){case 0:if(!(t=window.webPlayerServerConfig.AppId))return Core.Telemetry.Log.trackErrorEvent("WebPlayerRuntime._requestAppAccessAsync.InvalidAppId",{appId:t}),[2,a.RequestAppAccessStateType.Failed];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e._playerRuntime.userService.appResourceManager.sendAppAccessRequestAsync(t)];case 2:return r.sent(),Core.Telemetry.Log.trackActivityEvent("WebPlayerRuntime._requestAppAccessAsync.RequestSucceeded",{appId:t}),[2,a.RequestAppAccessStateType.Sent];case 3:return n=r.sent(),Core.Telemetry.Log.trackErrorEvent("WebPlayerRuntime._requestAppAccessAsync.RequestFailed",{appId:t,error:n}),[2,a.RequestAppAccessStateType.Failed];case 4:return[2]}}))}))},e._validateAppVersionInfo=function(t){return i.BackwardCompatibilityManager.isAppApiVersionNewerThanSupported(t)?(e.handleErrorAndCleanUp(a.WebPlayerErrorType.AppApiVersionNewer,Player.Strings.AppInstallErrorAppNewerThanSupported,"",Player.Strings.AppInstallErrorAppNewerThanSupported),!1):!i.BackwardCompatibilityManager.isAppApiVersionOlderThanSupported(t)||(e.handleErrorAndCleanUp(a.WebPlayerErrorType.AppApiVersionOlder,Player.Strings.AppInstallErrorAppOlderThanSupported,"",Player.Strings.AppInstallErrorAppOlderThanSupported),!1)},e._getWebPlayerLoadTime=function(){return Date.now()-window.webPlayerLoadStartDateTime},e.removePlayerSplashScreen=function(t){var n=document.getElementById("loading-spinner");n&&document.body.removeChild(n);var r=document.getElementById("screenLoadingPlaceholder");r&&document.body.removeChild(r);var o=e._getWebPlayerLoadTime();""===e._scenarioResult?Core.Telemetry.Log.passScenario(e._scenarioGuid,{overrideElapsedDuration:o}):Core.Telemetry.Log.failScenario(e._scenarioGuid,{message:e._scenarioResult,overrideElapsedDuration:o}),Core.Telemetry.Log.updateOpenAppData({webPlayerPowerAppsSplashScreenTime:o}),Core.Telemetry.Log.trackActivityEvent("WebPlayerRuntime.removePlayerSplashscreen",{webPlayerRuntimeStartTimestamp:e._webPlayerRuntimeStartTimestamp,shortSplashScreen:t,splashScreenAlreadyRemoved:!n&&!r})},e.isUsingLocalHash=function(){return!!e._webPlayerParams.localHash},e._runWebPlayerApp=function(t,n){var r,o;e._validateAppVersionInfo(t.minimumRequiredApiVersion)&&(null===(r=window.performance)||void 0===r||r.mark("webPlayerCreateAppHostAndOpenAppStarted"),null===(o=e._appHostManager)||void 0===o||o.createAppHostAndOpenAppUsingPreloadData(t,n,"WebPlayerRuntime._runWebPlayerApp").then((function(){e._endScenario({scenarioGuidPropertyName:"_initPluginsScenarioGuid",scenarioResult:Core.Telemetry.ScenarioResult.Success}),Core.Environment.isSkypeTeams()&&c.TeamsWebPlayerRuntime.initializeAppHostManager(e._appHostManager)})).catch((function(t){e._endScenario({scenarioGuidPropertyName:"_initPluginsScenarioGuid",scenarioResult:Core.Telemetry.ScenarioResult.Failed}),e.handleErrorAndCleanUp(a.WebPlayerErrorType.RunAppFailure,Core.PromiseUtils.formatError(t),Core.DiagnosticError.tryGetDiagnosticMessage(t))})))},e._redirectIfOnMobileAndNotEmbedded=function(){return __awaiter(this,void 0,Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return Core.Environment.isMobileDevice()?new URLSearchParams(window.location.search).get("skipMobileRedirect")||Core.Environment.isSkypeTeams()||Core.Environment.isIframed()?[3,2]:(Core.Telemetry.Log.trackActivityEvent("WebPlayerRuntime._redirectIfOnMobileAndNotEmbedded",{message:"redirecting to mobile client redirect page",redirect:!0,isMobileDevice:Core.Environment.isMobileDevice(),isSkypeTeams:Core.Environment.isSkypeTeams(),isIframed:Core.Environment.isIframed()}),Core.Telemetry.Log.flush(),[4,new Promise((function(e){return setTimeout(e,500)}))]):[3,2];case 1:t.sent(),(e=new URL(Core.Environment.getWebPlayerSFDomain()+"/mobile/redirect")).searchParams.append("canvasapp","1"),e.searchParams.append("appid",window.webPlayerServerConfig.AppId),e.searchParams.append("tenantid",window.webPlayerServerConfig.AuthConfig.TenantId),e.searchParams.append("sourceurl",encodeURI(window.location.href)),window.location.assign(e.toString()),t.label=2;case 2:return Core.Telemetry.Log.trackActivityEvent("WebPlayerRuntime._redirectIfOnMobileAndNotEmbedded",{message:"not redirecting mobile client redirect page",redirect:!1,isMobileDevice:Core.Environment.isMobileDevice(),isSkypeTeams:Core.Environment.isSkypeTeams(),isIframed:Core.Environment.isIframed()}),[2]}}))}))},e._postClearPublishedAppMessageToHost=function(){var t;null===(t=e._appHostRuntime)||void 0===t||t.postMessageToHost("clearPublishedApp")},e._webPlayerFitToScreen=function(){Core.UI.Utility.webPlayerFitToScreen()},e._showDeprecationBanner=function(){if((Core.Environment.getBrowserId()===Core.Environment.BrowserId.InternetExplorer||Core.Environment.getBrowserId()===Core.Environment.BrowserId.MicrosoftEdge)&&!Core.Environment.isIframed()){var e=void 0,t=void 0;Core.Environment.getBrowserId()===Core.Environment.BrowserId.InternetExplorer?(e=Player.Strings.InternetExplorer,t=Core.Utility.formatString(Player.Strings.WebplayerDeprecatedBrowserProblemIE,e,Player.Strings.MicrosoftEdge)):(e=Player.Strings.MicrosoftEdge,t=Core.Utility.formatString(Player.Strings.WebplayerDeprecatedBrowserProblemEdge,e,Player.Strings.Edge));var n={message:t,clickHandlers:[function(){window.open("https://docs.microsoft.com/power-platform/admin/support-end-internet-explorer","_blank")}]};Core.UI.Toast.ToastHandler.suspendOnClickToastWithLinks({message:n,type:Core.UI.Toast.ToastType.warning,timeout:0,showCloseButton:!1,extendedTimeOut:0,targetClass:"player-toast-area"})}},e._promptForCsatIfNeededAsync=function(){var t,n;Player.Client.Components.WebPlayerCSATDialog.WebPlayerCSATDialog.promptForCsatIfNeededAsync(e._playerRuntime.clientRuntime.npsService,e._appHostManager.runningAppInfo?Core.Utility.getGuidFromAppId(e._appHostManager.runningAppInfo.appId):"",null===(t=e._appHostManager.runningAppInfo)||void 0===t?void 0:t.name,Core.Environment.isIframed(),null===(n=window.webPlayerServerConfig)||void 0===n?void 0:n.Environment)},e._handleExitCurrentApp=function(t){!Core.Environment.isIframed()||Core.Environment.isSkypeTeams()||Core.Environment.isTestMode()?t||e.navigateToPreconfiguredPortalUri():(Core.Telemetry.Log.flush(),window.location.replace("".concat(window.location.protocol,"//").concat(window.location.host,"/exitapp")))},e._handlePostExitCurrentApp=function(t){var n;Core.Telemetry.Log.trackEvent(t,{exitAppId:e._appHostManager.runningAppInfo.appId}),null===(n=e._appHostRuntime)||void 0===n||n.postMessageToHost("clearPublishedApp")},e._removeReloadCountParameter=function(){var e=new RegExp("&?".concat("PAWebPlayerReloadCount","=([0-9]*)")),t=Core.Url.decode(window.location.hash).substring(1);window.location.hash=Core.Url.encode(t.replace(e,""))},e._trackListPackageCalls=function(){Core.Telemetry.Log.trackActivityEvent("PlayerLifecycle.PlayerSDK.PlayApp.LoadMetadata.FetchAppMetadata.ListPackageStarted");e._listPackageIntervalId=setInterval((function(){e._currentListPackagePollingTime+=7500,Core.Telemetry.Log.trackActivityEvent("PlayerLifecycle.PlayerSDK.PlayApp.LoadMetadata.FetchAppMetadata.ListPackagePolling",{maxPollingTime:e._currentListPackagePollingTime})}),7500)},e._appEventListener=function(t){switch(t.EventType){case"app-package-missing":e._appStaleEventHandler(t)}},e._appStaleEventHandler=function(t){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){return e._currentListPackagePollingTime=0,e._listPackageIsCalled=!0,e._trackListPackageCalls(),[2]}))}))},e._endScenario=function(t){t.scenarioGuidPropertyName&&""!=t.scenarioGuidPropertyName?(Core.Telemetry.Log.endScenario(e[t.scenarioGuidPropertyName],{scenarioResult:t.scenarioResult}),e[t.scenarioGuidPropertyName]=null):Core.Telemetry.Log.trackActivityEvent("Unable to end scenario with scenarioGuidPropertyName",{scenarioGuidPropertyName:t.scenarioGuidPropertyName,scenarioResult:t.scenarioResult})},e._errorDuringAppLaunch=!1,e._currentListPackagePollingTime=0,e._listPackageIntervalId=null,e._listPackageIsCalled=!1,e._appLoaded=!1,e.publishedAppContainerClass="publishedAppContainer",e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"_setEnrollPollTimeout",(function(){return l})),n.d(t,"_getEnrollPollTimeout",(function(){return p})),n.d(t,"handleLaunchAppCallErrorAsync",(function(){return c})),n.d(t,"showNoPlansDialogAsync",(function(){return d})),n.d(t,"handleRedirectToConsentUri",(function(){return f})),n.d(t,"_setHandleRedirectToConsentUri",(function(){return v})),n.d(t,"showTrialPopup",(function(){return P})),n.d(t,"_setShowTrialPopup",(function(){return b})),n.d(t,"handlePremiumPlanPopup",(function(){return A})),n.d(t,"_setHandlePremiumPlanPopup",(function(){return S})),n.d(t,"handleNoPlansClick",(function(){return E})),n.d(t,"_setHandleNoPlansClick",(function(){return T})),n.d(t,"handleNoPlanGuestClick",(function(){return k})),n.d(t,"_setHandleNoPlanGuestClick",(function(){return D}));var r,o=n(15),i=n(27),a=n(3);!function(e){e.Forbidden="Forbidden",e.NoEntitlementsFound="NoEntitlementsFound",e.NoActiveEntitlementsFound="NoActiveEntitlementsFound",e.InsufficientPlanForApp="InsufficientPlanForApp",e.InsufficientActivePlanForApp="InsufficientActivePlanForApp",e.NonActivePlansIncludeTrialPlan="NonActivePlansIncludeTrialPlan"}(r||(r={}));var s=3e3;function l(e){s=e}function p(){return s}function c(e,t,n,i,a,s){var l,p;return __awaiter(this,void 0,Promise,(function(){var c,m,h,y,f;return __generator(this,(function(v){c=Core.PromiseUtils.formatErrorMessage(e);try{m=JSON.parse(c)}catch(e){m=null}switch(h=null===(l=null==m?void 0:m.error)||void 0===l?void 0:l.code,y=null===(p=null==m?void 0:m.error)||void 0===p?void 0:p.details,f=!!y&&y.length>0&&y[0].code===r.NonActivePlansIncludeTrialPlan,h){case r.NoEntitlementsFound:case r.NoActiveEntitlementsFound:return[2,d(t,n,i,a,s,f)];case r.InsufficientActivePlanForApp:case r.InsufficientPlanForApp:return Core.Environment.isIframed()?(Core.Telemetry.Log.trackActivityEvent("PlansHelper.WaitForPremiumPlan"),function(e,t,n){o.WebPlayerNoPlansDialog.display(A(e),t,!0,n)}(M(f,a,s,!1),i,f),[2,g(n,a)]):[2,u(M(f,a,s,!0),i,f)];case r.Forbidden:default:return[2]}return[2]}))}))}function d(e,t,n,r,i,a){return __awaiter(this,void 0,Promise,(function(){var e;return __generator(this,(function(s){return e=Core.PromiseUtils.createCompletablePromise(),Core.Environment.isSkypeTeams()||Core.Environment.isIframed()?(Core.Telemetry.Log.trackActivityEvent("PlansHelper.WaitForPlan"),o.WebPlayerNoPlansDialog.display((function(){e.complete(function(e,t,n){return(Core.Environment.isSourcedFromSkypeTab()?h:P)(),g(t,n)}(0,t,r))}))):n?(Core.Telemetry.Log.trackActivityEvent("PlansHelper.GuestUsershowNoPlansDialogAsync"),o.WebPlayerNoPlansDialog.display(k,!0,!1,!1,(function(){return function(e,t){return __awaiter(this,void 0,Promise,(function(){var n,r,o,i,a,s,l,p,c,d;return __generator(this,(function(u){switch(u.label){case 0:r=Core.Utility.getGuidFromAppId(t),o=AppMagic.PowerApps.PowerAppsUtility.tryGetPowerPlatformLaunchServiceUrl(r),i=AppMagic.Services.Azure.Region.getCurrentRegion(),l=!1,o?((n=new Core.UrlBuilder(o)).appendPath("evaluateEntitlements"),a=i.powerPlatformResource,s=AppMagic.PowerApps.PowerAppsUtility.getPowerPlatformApiVersion(),l=!0):((n=new Core.UrlBuilder(i.powerAppsRpBaseUrl)).appendPath("apps"),n.appendPath(r),n.appendPath("evaluateEntitlements"),s=AppMagic.PowerApps.PowerAppsUtility.getApiVersion(),a=AppMagic.Runtime.Client.ResourceNames.PowerAppsService),(p=new AppMagic.Services.BodilessHttpRequestBuilder).setBaseUrl(n.toUrl()),p.setMethod(AppMagic.Services.HttpConstants.Method.POST),AppMagic.Runtime.Client.addAuthorizationOptionsToBuilder(p,{resource:a,isDynamicResource:l}),AppMagic.Services.addCustomHeadersOptionsToBuilder(p,{optInMSHeaders:!0}),p.addQueryParameter(AppMagic.PowerApps.Constants.PowerAppEndpoints.apiVersionKey,s),u.label=1;case 1:return u.trys.push([1,3,,4]),c=p.generateSendHttpRequestParameters(),[4,AppMagic.Services.PowerAppsHttpTelemetry.sendHttpJsonResponseAsync(e,c,"evaluateEntitlements")];case 2:return[2,u.sent().displayMessages];case 3:return d=u.sent(),Core.Telemetry.Log.trackErrorEvent("PlansHelper.getTrialReasonAsync",{error:d}),[3,4];case 4:return[2,[Player.Strings.somethingWentWrongTitle]]}}))}))}(t,r)})),e.complete(Core.PromiseUtils.never())):(Core.Telemetry.Log.trackActivityEvent("PlansHelper.showNoPlansDialogAsync"),o.WebPlayerNoPlansDialog.display(f(r,i,a),!1,!1,a),e.complete(Core.PromiseUtils.never())),[2,e.promise]}))}))}function u(e,t,n){return Core.Telemetry.Log.trackActivityEvent("PlansHelper.DisplayNoPremiumPlan"),o.WebPlayerNoPlansDialog.display(E(e),t,!0,n),Core.PromiseUtils.never()}function g(e,t){return __awaiter(this,void 0,Promise,(function(){var n,r,o,i,a=this;return __generator(this,(function(s){return n=Core.PromiseUtils.createCompletablePromise(),r=[0,1,2,2],o=!1,i=0,new Core.AsyncWhile((function(){return!o&&i<r.length})).loop((function(){return __awaiter(a,void 0,void 0,(function(){return __generator(this,(function(a){switch(a.label){case 0:return i++,[4,m(e,t)];case 1:return(o=a.sent())?(n.complete(),[2,Promise.resolve()]):[2,Core.PromiseUtils.timeout(6e4*r[i])]}}))}))})),[2,n.promise]}))}))}function m(e,t){return __awaiter(this,void 0,Promise,(function(){var n;return __generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,AppMagic.Runtime.Client.LaunchAppService.launchAppAsync(e,t,{isBlocking:!0},AppMagic.Runtime.Client.AppPackageType.WebPlayer,!0)];case 1:return r.sent(),o.WebPlayerNoPlansDialog.hide(),[2,!0];case 2:return n=r.sent(),Core.Telemetry.Log.trackErrorEvent("TrialSignupPlanCheckFailed",{error:n}),[3,3];case 3:return[2,!1]}}))}))}function h(e){void 0===e&&(e=AppMagic.Services.Azure.Region.getCurrentRegion().webPlayerConsentUri.toString()),Core.Telemetry.Log.trackActivityEvent("PlansHelper.showTeamsNoPlansPopup"),microsoftTeams.authentication.authenticate({url:e,width:600,height:600,successCallback:Core.Utility.noOpFn,failureCallback:Core.Utility.noOpFn})}var y=function(e,t,n){return function(){var r,o;Core.Telemetry.Log.trackActivityEvent("PlansHelper.RedirectToConsentUriClick");var i=new Core.UrlBuilder(AppMagic.Services.Azure.Region.getCurrentRegion().webPlayerConsentUri);i.setQueryParam("appId",e),i.setQueryParam("environmentName",t),i.setQueryParam("redirect","player"),n&&i.setQueryParam("expired","true"),Core.Telemetry.Log.flush(),window.Utilities.reloadWindowWithLogging(window,"PlansHelper._handleRedirectToConsentUri",i.toString(),null===(o=null===(r=Core.Telemetry)||void 0===r?void 0:r.Log)||void 0===o?void 0:o.sessionId,!0)}},f=function(e,t,n){return y(e,t,n)};function v(e){y=e}var C=function(){Core.Telemetry.Log.trackActivityEvent("PlansHelper.OpenTrialPopup"),R(window.open(AppMagic.Services.Azure.Region.getCurrentRegion().webPlayerConsentUri.toString(),"TrialPopup"))},P=function(){return C()};function b(e){C=e}var _=function(e){return function(){Core.Environment.isSourcedFromSkypeTab()?h(e):(Core.Telemetry.Log.trackActivityEvent("PlansHelper.NoPremiumPlans"),R(window.open(e,"ModalPopUp","toolbar=no,location=no,statusbar=no,menubar=no,width=600,height=400")))}},A=function(e){return _(e)};function S(e){_=e}var w=function(e){return function(){var t,n;Core.Telemetry.Log.trackActivityEvent("PlansHelper.RedirectForPremiumPlanClick"),Core.Telemetry.Log.flush(),window.Utilities.reloadWindowWithLogging(window,"PlansHelper._handleNoPlansClick",e.toString(),null===(n=null===(t=Core.Telemetry)||void 0===t?void 0:t.Log)||void 0===n?void 0:n.sessionId,!0)}},E=function(e){return w(e)};function T(e){w=e}var I=function(){Core.Telemetry.Log.trackActivityEvent("PlansHelper.NavigateToPortalClick"),Core.Telemetry.Log.flush(),a.WebPlayerRuntime.navigateToPreconfiguredPortalUri()},k=function(){return I()};function D(e){I=e}function M(e,t,n,r){var o=new Core.UrlBuilder(AppMagic.Services.Azure.Region.getCurrentRegion().webPlayerConsentUri);return o.setQueryParam("appId",t),o.setQueryParam("environmentName",n),o.setQueryParam("connections","premium"),e&&o.setQueryParam("expired","true"),r&&o.setQueryParam("redirect","player"),o.toString()}function R(e){e?e.focus():Object(i.display)()}},function(e,t,n){"use strict";var r;n.r(t),n.d(t,"AppMetadataCacheUpdateResult",(function(){return r})),n.d(t,"AppMetadataCaching",(function(){return o})),function(e){e[e.UpdateOk=0]="UpdateOk",e[e.NoMetadataIsCachedForApp=1]="NoMetadataIsCachedForApp",e[e.FailedToUpdateCachedAppMetadata=2]="FailedToUpdateCachedAppMetadata",e[e.FailedToParseCachedAppMetadata=3]="FailedToParseCachedAppMetadata",e[e.FailedToGetLocalStorageData=4]="FailedToGetLocalStorageData"}(r||(r={}));var o=function(){function e(){}return e.updateCachedMetadataWithLaunchAppResponseAsync=function(t){var n,o;return __awaiter(this,void 0,Promise,(function(){var i,a,s;return __generator(this,(function(l){switch(l.label){case 0:if(!t||!(window.webPlayerServerConfig.IsTeams&&window.webPlayerServerConfig.FeatureGates.EntryPointCaching||!Core.Environment.isIframed()&&window.webPlayerServerConfig.FeatureGates.EntryPointCachingStandalone||Core.Environment.isSharedAppHost()&&window.webPlayerServerConfig.FeatureGates.EntryPointCachingSharedAppHost))return[3,6];Core.Telemetry.Log.trackActivityEvent("AppMetadataCaching.MetadataUserForAppOpening",{metadataSource:window.webPlayerServerConfig.MetadataSource}),e._cacheLaunchAppPromise=Core.PromiseUtils.createCompletablePromise(),l.label=1;case 1:return l.trys.push([1,4,,5]),[4,t.getAppResourcesPromise];case 2:return i=l.sent(),[4,this._updateCacheWithLaunchAppDataAsync(i)];case 3:return a=l.sent(),Core.Telemetry.Log.trackActivityEvent("AppMetadataCaching.cacheUpdateResult",{result:r[a.result],data:null!==(n=JSON.stringify(a.data))&&void 0!==n?n:"",error:null!==(o=a.error)&&void 0!==o?o:""}),[3,5];case 4:return s=l.sent(),Core.Telemetry.Log.trackActivityEvent("AppMetadataCaching.AppResourcesPromiseFailed",{message:s.message}),[3,5];case 5:e._cacheLaunchAppPromise.complete(),l.label=6;case 6:return[2]}}))}))},e.updateCachedMetadataWithEcsResponseAsync=function(t){var n,o,i;return __awaiter(this,void 0,Promise,(function(){var a;return __generator(this,(function(s){switch(s.label){case 0:return[4,null===(n=e._cacheLaunchAppPromise)||void 0===n?void 0:n.promise];case 1:return s.sent(),[4,this._updateCacheWithEcsResponseAsync(t)];case 2:return a=s.sent(),Core.Telemetry.Log.trackActivityEvent("AppMetadataCaching.updateCachedMetadataWithEcsResponseAsync",{result:r[a.result],data:null!==(o=JSON.stringify(a.data))&&void 0!==o?o:"",error:null!==(i=a.error)&&void 0!==i?i:""}),[2]}}))}))},e.updateCacheWithOpenAppDataAsync=function(t){var n,o,i;return __awaiter(this,void 0,void 0,(function(){var a;return __generator(this,(function(s){switch(s.label){case 0:return[4,null===(n=e._cacheLaunchAppPromise)||void 0===n?void 0:n.promise];case 1:return s.sent(),[4,this._updateCacheWithOpenAppDataAsync(t)];case 2:return a=s.sent(),Core.Telemetry.Log.trackActivityEvent("AppMetadataCaching.updateCacheWithOpenAppDataAsync",{result:r[a.result],data:null!==(o=JSON.stringify(a.data))&&void 0!==o?o:"",error:null!==(i=a.error)&&void 0!==i?i:""}),[2]}}))}))},e.getCachedMetadataKey=function(){var t=window.webPlayerServerConfig.AppName?"".concat(window.webPlayerServerConfig.AppEnvironmentId,"â-").concat(window.webPlayerServerConfig.AppName,"â"):window.webPlayerServerConfig.AppId;return t?e.cachedAppMetadataKey+"-"+t:null},e.getSASKeyExpiryDate=function(e){if(!e)return null;var t=new Core.Url(e).getQueryParamFirstValue("se");return t?new Date(decodeURIComponent(t)):null},e._getMetadataExpiryDate=function(e,t){var n=Date.now()+3312e5,r=this.getSASKeyExpiryDate(e),o=this.getSASKeyExpiryDate(t);return r?n=r.getTime()-324e5:-1!==(null==e?void 0:e.indexOf("/alt"))?n=Date.now()+2592e6:o&&(n=o.getTime()-324e5),new Date(n)},e._updateCacheWithLaunchAppDataAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t=this;return __generator(this,(function(n){switch(n.label){case 0:return[4,this._updateCacheAsync((function(n){return __awaiter(t,void 0,void 0,(function(){var t,o,i,a,s,l,p,c,d,u;return __generator(this,(function(g){return e&&e.appInfo?(t=Core.Environment.getWebPlayerQueryParam("hint"),o=!(!e.appInfo.unauthenticatedWebPackageUrl||t!==e.appInfo.unauthenticatedWebPackageHint),(i=n).PublishedAppConfig.IndexWebHtmlUrl=o?e.appInfo.unauthenticatedWebPackageUrl:e.appInfo.webPackageUrl,i.PublishedAppConfig.ReadonlyIndexWebHtmlUrl=e.appInfo.webReadOnlyPackageUrl,i.PublishedAppConfig.UsesAltAuth=o,i.PublishedAppConfig.CdsOrgUrl=null!==(l=null===(s=null===(a=e.appInfo.environment.properties)||void 0===a?void 0:a.linkedEnvironmentMetadata)||void 0===s?void 0:s.instanceUrl)&&void 0!==l?l:null,n.PublishedAppConfig.AppRuntimeEndpoint!==(null===(c=null===(p=e.appInfo.environment)||void 0===p?void 0:p.properties)||void 0===c?void 0:c.runtimeEndpoints["microsoft.PowerApps"])&&(i.PublishedAppConfig.AppRuntimeEndpoint=null===(u=null===(d=e.appInfo.environment)||void 0===d?void 0:d.properties)||void 0===u?void 0:u.runtimeEndpoints["microsoft.PowerApps"]),i.PublishedAppConfig.DocumentVersion=JSON.stringify(e.appInfo.documentServerVersion),i.AppPreviewFlags=null,i.FallbackSwitch=null,i.MetadataTime=new Date(Date.now()),i.MetadataExpiration=this._getMetadataExpiryDate(i.PublishedAppConfig.IndexWebHtmlUrl,i.PublishedAppConfig.ReadonlyIndexWebHtmlUrl),[2,{result:r.UpdateOk,data:{indexWebHtmlUrlChanged:i.PublishedAppConfig.IndexWebHtmlUrl!==n.PublishedAppConfig.IndexWebHtmlUrl,readOnlyIndexWebHtmlUrlChanged:i.PublishedAppConfig.ReadonlyIndexWebHtmlUrl!==n.PublishedAppConfig.ReadonlyIndexWebHtmlUrl,appRuntimeEndpointChanged:i.PublishedAppConfig.AppRuntimeEndpoint!==n.PublishedAppConfig.AppRuntimeEndpoint,documentVersionChanged:i.PublishedAppConfig.DocumentVersion!==n.PublishedAppConfig.DocumentVersion}}]):[2,{result:r.NoMetadataIsCachedForApp}]}))}))}))];case 1:return[2,n.sent()]}}))}))},e._updateCacheWithEcsResponseAsync=function(e){return __awaiter(this,void 0,void 0,(function(){var t=this;return __generator(this,(function(n){switch(n.label){case 0:return[4,this._updateCacheAsync((function(n){return __awaiter(t,void 0,void 0,(function(){return __generator(this,(function(t){return e?(n.FallbackSwitch=e,[2,{result:r.UpdateOk,data:{}}]):[2,{result:r.NoMetadataIsCachedForApp}]}))}))}))];case 1:return[2,n.sent()]}}))}))},e._updateCacheWithOpenAppDataAsync=function(e){return __awaiter(this,void 0,void 0,(function(){var t=this;return __generator(this,(function(n){switch(n.label){case 0:return[4,this._updateCacheAsync((function(n){return __awaiter(t,void 0,void 0,(function(){return __generator(this,(function(t){return e?(n.AppPreviewFlags=e.appPreviewFlags,n.BlockStartRule=e.blockOnStartRule||e.blockStartScreenRule,[2,{result:r.UpdateOk,data:{}}]):[2,{result:r.NoMetadataIsCachedForApp}]}))}))}))];case 1:return[2,n.sent()]}}))}))},e._updateCacheAsync=function(e){var t,n,o,i,a,s,l,p;return __awaiter(this,void 0,Promise,(function(){var c,d,u,g,m;return __generator(this,(function(h){switch(h.label){case 0:if(d=this.getCachedMetadataKey())try{c=null===(t=window.localStorage)||void 0===t?void 0:t.getItem(d)}catch(e){return Core.Telemetry.Log.trackActivityEvent("AppMetadataCaching.FailedToGetLocalStorageData"),[2,{result:r.FailedToGetLocalStorageData,error:e}]}h.label=1;case 1:return h.trys.push([1,5,,6]),u=void 0,(u=c?JSON.parse(c):{AppId:null!==(n=window.webPlayerServerConfig.AppId)&&void 0!==n?n:null,CdnUrl:null!==(i=null===(o=window.webPlayerServerConfig.CdnConfig)||void 0===o?void 0:o.CdnUrl)&&void 0!==i?i:null,PublishedAppConfig:null!==(a=window.webPlayerServerConfig.PublishedAppConfig)&&void 0!==a?a:null,AppPreviewFlags:null,BlockStartRule:null,FallbackSwitch:null,MetadataTime:null!==(s=window.webPlayerServerConfig.MetadataTime)&&void 0!==s?s:new Date(Date.now()),MetadataExpiration:this._getMetadataExpiryDate(null===(l=window.webPlayerServerConfig.PublishedAppConfig)||void 0===l?void 0:l.IndexWebHtmlUrl,null===(p=window.webPlayerServerConfig.PublishedAppConfig)||void 0===p?void 0:p.ReadonlyIndexWebHtmlUrl)})&&u.PublishedAppConfig?[4,e(u)]:[3,3];case 2:return(g=h.sent()).result===r.UpdateOk&&window.localStorage.setItem(d,JSON.stringify(u)),g.data&&(g.data.appId=d),[2,g];case 3:return[2,{result:r.NoMetadataIsCachedForApp}];case 4:return[3,6];case 5:return m=h.sent(),[2,{result:r.FailedToUpdateCachedAppMetadata,error:null!=m?m:"unknown error"}];case 6:return[2]}}))}))},e.cachedAppMetadataKey="cachedAppMetadata",e._cacheLaunchAppPromise=null,e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"TeamsWebPlayerRuntime",(function(){return p}));var r,o=n(14),i=n(17),a=n(50),s=n(11),l=n(3);!function(e){e.ContextEntityId="ContextEntityId",e.IsFullScreen="IsFullScreen",e.IsSidePanel="IsSidePanel",e.Theme="Theme",e.ThisChannel="ThisChannel",e.ThisMeeting="ThisMeeting",e.ThisTeam="ThisTeam"}(r||(r={}));var p=function(){function e(){}return e.start=function(){e._publishedAppIframeCacher=new a.PublishedAppIframeCacher(l.WebPlayerRuntime.getPublishedAppContainer,o.getAppIframe,e._publishedAppIframeCacheId),microsoftTeams.registerBeforeUnloadHandler(e._beforeUnloadHandler),microsoftTeams.registerOnLoadHandler(e._onLoadHandler),microsoftTeams.registerOnThemeChangeHandler(e.sendTeamsContextToApp),e._updateContext(),e._updateWebPlayerUrlAsNeeded(),e._didNotifySuccess=window.invertedLoad},e.notifyAppInitializationSuccess=function(){e._didNotifySuccess||(e._didNotifySuccess=!0,microsoftTeams.appInitialization.notifySuccess(),Core.Telemetry.Log.trackActivityEvent("".concat(e._operationName,".notifyAppInitializationSuccess")),Core.PerformanceTracker.addDataPoint("webPlayerTeamsNotifyAppInitializationSuccess"))},e.notifyAppInitializationFailure=function(t){microsoftTeams.appInitialization.notifyFailure({reason:microsoftTeams.appInitialization.FailedReason.Other,message:t}),Core.Telemetry.Log.trackActivityEvent("".concat(e._operationName,".notifyAppInitializationFailure"),{message:t})},e._updateWebPlayerUrlAsNeeded=function(){var t,n;if((null===(t=window.webPlayerServerConfig)||void 0===t?void 0:t.FeatureGates.UpdateWebPlayerUrlInTeams)&&(null===(n=window.webPlayerServerConfig)||void 0===n?void 0:n.AppEnvironmentId))try{microsoftTeams.settings.getSettings((function(t){var n=t.entityId,r=window.webPlayerServerConfig.AppId;if(e._doAppIdsMatch(n,window.webPlayerServerConfig.AppId)){r=r.replace(Core.Utility.Constants.PowerAppIdPrefix,"");var o="/play/e/".concat(window.webPlayerServerConfig.AppEnvironmentId,"/"),i=!0;t.contentUrl.indexOf(o)>0&&(i=!1);var a=!0;if(t.websiteUrl&&t.websiteUrl.indexOf(o)>0&&(a=!1),i||a){var s=t.contentUrl;if(i){var l=new Core.Url(t.contentUrl),p=e._generateTeamsSFUrl(r,window.webPlayerServerConfig.AppEnvironmentId,l.query);t.contentUrl=Core.Url.decode(p)}var c=t.websiteUrl;if(a){var d=new Core.Url(t.websiteUrl),u=e._generateTeamsSFUrl(r,window.webPlayerServerConfig.AppEnvironmentId,d.query);t.websiteUrl=Core.Url.decode(u)}t.contentUrl&&t.websiteUrl?(Core.Telemetry.Log.trackActivityEvent(Core.Telemetry.Strings.webPlayerUpdateTeamsTab,{appGuid:r,oldContentUrl:Core.Telemetry.Utility.scrubSensitiveDataSafe(s),newContentUrl:Core.Telemetry.Utility.scrubSensitiveDataSafe(t.contentUrl),oldWebSiteUrl:Core.Telemetry.Utility.scrubSensitiveDataSafe(c),newWebsiteUrl:Core.Telemetry.Utility.scrubSensitiveDataSafe(t.websiteUrl)}),microsoftTeams.settings.setSettings(t,(function(e,t){e||Core.Telemetry.Log.trackActivityEvent("TeamsWebPlayerRuntime.SetSettingsUpdateWebPlayerUrlFailed",{reason:t})}))):Core.Telemetry.Log.trackActivityEvent(Core.Telemetry.Strings.webPlayerUpdateTeamsTabEmptyDomain,{message:"newContentUrl and/or newWebsiteUrl are empty. Teams Url not updated."})}}else Core.Telemetry.Log.trackErrorEvent("TeamsWebPlayerRuntime._updateWebPlayerUrlAsNeeded.AppIdsDoNotMatch",{errorMessage:"App IDs do not match between the window URL and settings URL.",appGuid:r,settingsAppId:n})}))}catch(e){Core.Telemetry.Log.trackActivityEvent("TeamsWebPlayerRuntime._updateWebPlayerUrlAsNeededAsync.Failed",{error:e})}},e._generateTeamsSFUrl=function(e,t,n){var r=Core.Environment.getWebPlayerSFDomain();if(!r)return"";var o=new Core.UrlBuilder(r);return o.appendPath("play/e"),o.appendPath(t),o.appendPath("a"),o.appendPath(e),n&&o.appendQuery(n),o.toString()},e.initializeAppHostManager=function(t){e._appHostManager||(e._appHostManager=t)},e._doAppIdsMatch=function(e,t){return e&&-1===(null==e?void 0:e.indexOf(Core.Utility.Constants.PowerAppIdPrefix))&&(e=Core.Utility.Constants.PowerAppIdPrefix+e),t&&-1===(null==t?void 0:t.indexOf(Core.Utility.Constants.PowerAppIdPrefix))&&(t=Core.Utility.Constants.PowerAppIdPrefix+t),!(!t||!e||t!==e)},e.appendHintToTeamsUrl=function(t,n){var r=this;try{microsoftTeams.settings.getSettings((function(n){return __awaiter(r,void 0,void 0,(function(){var r,o,i,a,s,l,p,c,d;return __generator(this,(function(u){switch(u.label){case 0:return r=n.entityId,o=window.webPlayerServerConfig.AppId,e._doAppIdsMatch(r,o)?(i=new Core.Url(n.contentUrl),a=new Core.UrlBuilder(i),s=i.getQueryParamFirstValue("hint"),[4,t]):(Core.Telemetry.Log.trackErrorEvent("TeamsWebPlayerRuntime.appendHintToTeamsUrl.AppIdsDoNotMatch",{errorMessage:"App IDs do not match between the window URL and settings URL.",windowAppId:o,settingsAppId:r}),[2]);case 1:if(l=u.sent(),p=null===(d=null==l?void 0:l.appInfo)||void 0===d?void 0:d.unauthenticatedWebPackageHint,c=p!==s&&!((Core.Utility.isNullOrUndefined(p)||Core.Utility.isEmptyString(p))&&(Core.Utility.isNullOrUndefined(s)||Core.Utility.isEmptyString(s))),Core.Telemetry.Log.trackActivityEvent("TeamsWebPlayerRuntime.UpdateTeamsTabHint",{urlNeedsRewrite:c,newHint:p,oldHint:s,reloadFromAltAuth:e._reloadFromAlternateAuthHint}),c)try{p?a.setQueryParam("hint",p):a.setQueryParam("hint",void 0),n.contentUrl=Core.Url.decode(a.toString()),e._reloadFromAlternateAuthHint=!0,microsoftTeams.settings.setSettings(n,(function(e,t){e||Core.Telemetry.Log.trackActivityEvent("TeamsWebPlayerRuntime.SetSettingsUrlHintFailed",{reason:t,urlNeedsRewrite:c,newHint:p,oldHint:s})}))}catch(t){Core.Telemetry.Log.trackActivityEvent("TeamsWebPlayerRuntime.UpdateTeamsTabHintFailed",{error:t,urlNeedsRewrite:c,newHint:p,oldHint:s,reloadFromAltAuth:e._reloadFromAlternateAuthHint})}return[2]}}))}))}))}catch(t){Core.Telemetry.Log.trackActivityEvent("TeamsWebPlayerRuntime.GetSettings.Failed",{error:t,reloadFromAltAuth:e._reloadFromAlternateAuthHint})}},e.sendTeamsContextToApp=function(){var t,n,o,i,a,s=null===(n=null===(t=e._appHostManager)||void 0===t?void 0:t.currentAppHost)||void 0===n?void 0:n.automationClient.hostControls;(null===(a=null===(i=null===(o=e._appHostManager)||void 0===o?void 0:o.currentAppHost)||void 0===i?void 0:i.automationClient)||void 0===a?void 0:a.hostControls)?microsoftTeams.getContext((function(e){var t,n,o,i,a,l,p,c;s.setPropertyValueAsync("dynamic",r.ContextEntityId,e.entityId),s.setPropertyValueAsync("dynamic",r.IsFullScreen,e.isFullScreen),s.setPropertyValueAsync("dynamic",r.IsSidePanel,e.frameContext===microsoftTeams.FrameContexts.sidePanel),s.setPropertyValueAsync("dynamic",r.Theme,{Name:null!==(t=e.theme)&&void 0!==t?t:""}),s.setPropertyValueAsync("dynamic",r.ThisChannel,{DisplayName:null!==(n=e.channelName)&&void 0!==n?n:"",Id:null!==(o=e.channelId)&&void 0!==o?o:"",Kind:null!==(i=e.channelType)&&void 0!==i?i:""}),s.setPropertyValueAsync("dynamic",r.ThisMeeting,{Id:null!==(a=e.meetingId)&&void 0!==a?a:""}),s.setPropertyValueAsync("dynamic",r.ThisTeam,{DisplayName:null!==(l=e.teamName)&&void 0!==l?l:"",Id:null!==(p=e.teamId)&&void 0!==p?p:"",GroupId:null!==(c=e.groupId)&&void 0!==c?c:""})})):Core.Telemetry.Log.trackErrorEvent("".concat(e._operationName,".sendTeamsContextToApp"),{errorMessage:"appHost isn't initialized correctly"})},e.navigateToApp=function(t){var n,r,o;null===(n=e._publishedAppIframeCacher)||void 0===n||n.clearCache(),i.AppHostRuntime.getInstance().flushTelemetry(),window.Utilities.reloadWindowWithLogging(window,"TeamsWebPlayerRuntime.navigateToApp",t.contentUrl,null===(o=null===(r=Core.Telemetry)||void 0===r?void 0:r.Log)||void 0===o?void 0:o.sessionId,!0)},e._onLoadHandler=function(t){var n,r;null===(n=window.performance)||void 0===n||n.clearMarks("webPlayerTeamsOnLoad"),null===(r=window.performance)||void 0===r||r.mark("webPlayerTeamsOnLoad"),e._isWarmAppLoad=!0,e._didNotifySuccess=!1,delete window.invertedLoad,window.webPlayerLoadStartDateTime=Date.now();var o=Core.Utility.getGuidFromAppId(t.entityId),i=o===e._unloadedAppId;Core.Telemetry.Log.trackActivityEvent("".concat(e._operationName,"._onLoadHandler"),{teamsOnLoadHandlerCallCount:++e._teamsOnLoadHandlerCallCount,unloadedAppId:e._unloadedAppId,requestedAppId:o,isReturningToApp:i,reloadFromAltAuth:e._reloadFromAlternateAuthHint}),e._reloadFromAlternateAuthHint&&t.contentUrl!==window.location.href&&(i=!1),i?e._returnToApp(t):e.navigateToApp(t)},e._beforeUnloadHandler=function(t){var n,r;Core.Telemetry.Log.trackActivityEvent("".concat(e._operationName,"._beforeUnloadHandler")),e._unloadedAppId=Core.Utility.getGuidFromAppId(window.webPlayerServerConfig.AppId),l.WebPlayerRuntime.unloadAppHostManager(),e._appHostManager=null,null===(n=e._publishedAppIframeCacher)||void 0===n||n.tryCachePublishedAppIframe(),i.AppHostRuntime.getInstance().flushTelemetry(),t(),null===(r=Core.Telemetry.Log.providerInstance)||void 0===r||r.setDefaultProperties({teamsAppLaunchId:void 0});var o=performance.memory;return o&&Core.Telemetry.Log.trackActivityEvent("Perf.Memory.TabBeforeUnload",{totalHeapSize:o.totalJSHeapSize,usedHeapSize:o.usedJSHeapSize,heapSizeLimit:o.jsHeapSizeLimit}),!0},e._returnToApp=function(t){var n,r,o,a=Core.Telemetry.Log.providerInstance;if(e._updateContext(),a&&a.setDefaultProperties({subSessionId:Core.Utility.generate128BitUUID()}),null===(n=window.WebPlayerViews)||void 0===n||n.App.setupMessageEventHandlers(),!(null===(r=e._publishedAppIframeCacher)||void 0===r?void 0:r.tryAddCachedPublishedAppIframe(Object(s.getParamsMapFromUrl)(t.contentUrl))))return Core.Telemetry.Log.trackErrorEvent("".concat(e._operationName,"._returnToApp.publishedAppIframeNotReady")),void e.navigateToApp(t);for(var p=0,c=__spreadArray([],Core.PerformanceTracker.getAllActiveScopes(),!0);p<c.length;p++){var d=c[p];Core.PerformanceTracker.exitScope(d)}null===(o=window.performance)||void 0===o||o.clearMarks("webPlayerTeamsNotifyAppInitializationLoaded"),i.AppHostRuntime.getInstance().logWebPlayerFeatureGatesTelemetry(),l.WebPlayerRuntime.initializeWebPlayerAndRunPublishedAppAsync()},e._updateContext=function(){microsoftTeams.getContext((function(t){var n;e._hostClientType=t.hostClientType,e._channelId=t.channelId,e._meetingId=t.meetingId,e._chatId=t.chatId,e._frameContext=t.frameContext;var r={hostClientType:e._hostClientType,frameContext:e._frameContext,channelId:e._channelId,isMeeting:!!e._meetingId,isChat:!!e._chatId,ringId:t.ringId,teamsAppLaunchId:t.appLaunchId,userClickTime:t.userClickTime};Core.Telemetry.Log.trackActivityEvent("".concat(e._operationName,"._updateContext.getContext"),r),null===(n=Core.Telemetry.Log.providerInstance)||void 0===n||n.setDefaultProperties({teamsAppLaunchId:t.appLaunchId})}))},e.getChannelId=function(){return this._channelId},e.getMeetingId=function(){return this._meetingId},e.getMeetingOrChannelId=function(){return this._meetingId||this._channelId},e.getChatId=function(){return this._chatId},e.getHostClientType=function(){if(!this._hostClientType)return Core.Environment.TeamsHostClientType.None;switch(this._hostClientType){case microsoftTeams.HostClientType.desktop:return Core.Environment.TeamsHostClientType.Desktop;case microsoftTeams.HostClientType.web:return Core.Environment.TeamsHostClientType.Web;case microsoftTeams.HostClientType.ios:return Core.Environment.TeamsHostClientType.Android;case microsoftTeams.HostClientType.android:return Core.Environment.TeamsHostClientType.iOS;default:return Core.Environment.TeamsHostClientType.Unknown}},e.isWarmAppLoad=function(){return this._isWarmAppLoad},e._teamsOnLoadHandlerCallCount=0,e._reloadFromAlternateAuthHint=!1,e._isWarmAppLoad=!1,e._didNotifySuccess=!1,e._operationName="TeamsWebPlayerRuntime",e._publishedAppIframeCacheId="".concat(e._operationName,".publishedAppIframe"),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"getControlPath",(function(){return o})),n.d(t,"getPersonalizedGreetingMessage",(function(){return i})),n.d(t,"getHostUrl",(function(){return a})),n.d(t,"getLocalizedBrowserName",(function(){return s}));var r=n(0);function o(e){return r.h+e}function i(e){if(Core.Utility.isNonEmptyString(e)){var t=e.split(" ")[0];return Core.Utility.formatString(Player.Strings.PersonalizedGreetingFormat,t)}return""}function a(){var e=window.location.href.split("/");return e[0]+"//"+e[2]}function s(e){var t;switch(e){case Core.Environment.BrowserId.MicrosoftEdge:t=Player.Strings.MicrosoftEdgeLegacy;break;case Core.Environment.BrowserId.ChromiumEdge:t=Player.Strings.MicrosoftEdge;break;case Core.Environment.BrowserId.InternetExplorer:t=Player.Strings.InternetExplorer;break;case Core.Environment.BrowserId.Firefox:t=Player.Strings.Firefox;break;case Core.Environment.BrowserId.Chrome:t=Player.Strings.GoogleChrome;break;case Core.Environment.BrowserId.PhantomJS:t=Player.Strings.PhantomJS;break;case Core.Environment.BrowserId.Safari:t=Player.Strings.Safari;break;case Core.Environment.BrowserId.Opera:t=Player.Strings.Opera;break;default:t=Player.Strings.UnknownBrowser}return t}},function(e,t,n){"use strict";n.r(t),n.d(t,"getSessionParams",(function(){return i})),n.d(t,"setUpSessionAsync",(function(){return a})),n.d(t,"disableSession",(function(){return s})),n.d(t,"JoinSessionConsentDialog",(function(){return l})),n.d(t,"JoinSessionErrorDialog",(function(){return p})),n.d(t,"getAllowedEndpoints",(function(){return f})),n.d(t,"isValidEndpoint",(function(){return v}));var r=n(14),o=n(11);function i(e){if(!g())return null;var t=Core.Url.tryParse(e||window.location.href);if(!t)return null;var n=t.getQueryParams(),r=m(n,c);if(!r)return null;var o=Core.Url.decode(r);if(!Core.Url.tryParse(o))return null;var i=m(n,d),a=m(n,u);return!!i==!!a?null:{baseUrl:o,sessionToken:i||a}}function a(e,t){return __awaiter(this,void 0,Promise,(function(){var n,r,o;return __generator(this,(function(i){switch(i.label){case 0:r=Core.Telemetry.Log.startScenario(Core.Telemetry.ScenarioName.WebPlayerSetUpMonitorDebugSession,{monitorEndpoint:t.baseUrl}),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,h(e,t)];case 2:return n=i.sent(),Core.Telemetry.Log.endScenario(r,{customScenarioData:{joined:n}}),[3,4];case 3:return o=i.sent(),n=!1,Core.Telemetry.Log.failScenario(r,{error:o}),[3,4];case 4:return[2,n]}}))}))}function s(){var e="^(?:".concat(c,"|").concat(d,"|").concat(u,")=.*");Object(o.setPublishedAppParamsQuery)((function(t){return t.split("&").filter((function(t){return!t.match(e)})).join("&")}),g())}var l=function(e){function t(){var t=e.call(this,{id:"MonitorHelper.JoinSessionConsentDialog",title:Player.Strings.MonitorConsentDialogTitleText,message:Player.Strings.MonitorConsentDialogMessageText})||this;return e.prototype.addButton.call(t,Player.Strings.MonitorConsentDialogJoinButtonText),e.prototype.addButton.call(t,Player.Strings.MonitorConsentDialogDoNotJoinButtonText),t}return __extends(t,e),t.prototype.addButton=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.showAsync=function(){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(n){switch(n.label){case 0:return[4,e.prototype.showAsync.call(this)];case 1:return t=n.sent(),[2,t===Player.Strings.MonitorConsentDialogJoinButtonText?(!0).toString():null]}}))}))},t}(Core.UI.Popups.MessageDialog),p=function(e){function t(t){var n=e.call(this,{id:"MonitorHelper.JoinSessionErrorDialog",title:Player.Strings.MonitorCannotJoinSession,message:"".concat(t," ")+Core.Utility.formatString(Player.Strings.MonitorPressButtonToContinue,Player.Strings.OK)})||this;return e.prototype.addButton.call(n,Player.Strings.OK),n}return __extends(t,e),t.prototype.addButton=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t}(Core.UI.Popups.MessageDialog),c="mep",d="mjt",u="mss";function g(){return Object(r.getAppIframe)()||null}function m(e,t){var n=e[t];return"string"==typeof n&&n?n:Array.isArray(n)&&1===n.length&&"string"==typeof n[0]&&n[0]?n[0]:null}function h(e,t){return __awaiter(this,void 0,Promise,(function(){var n,r,i,a;return __generator(this,(function(l){switch(l.label){case 0:n="".concat("MonitorHelper","._setUpSessionAsync"),l.label=1;case 1:return l.trys.push([1,5,,7]),[4,y(e,t)];case 2:return r=l.sent(),(i=r.isSessionOwner)?[3,4]:[4,P()];case 3:i=l.sent(),l.label=4;case 4:return i?(function(e,t){var n="^(?:".concat(c,"|").concat(d,"|").concat(u,")=.*");Object(o.setPublishedAppParamsQuery)((function(r){return r.split("&").filter((function(e){return!e.match(n)})).join("&").concat("&".concat(c,"=").concat(Core.Url.encode(e))).concat("&".concat(u,"=").concat(t))}),g())}(t.baseUrl,r.sessionState),[2,!0]):[3,7];case 5:return a=l.sent(),Core.Telemetry.Log.trackErrorEvent(n,{errorMessage:a.message}),[4,b(a).catch((function(){}))];case 6:return l.sent(),[3,7];case 7:return s(),[2,!1]}}))}))}function y(e,t){return __awaiter(this,void 0,Promise,(function(){var n,r,o,i,a,s,l;return __generator(this,(function(p){switch(p.label){case 0:if(n="".concat("MonitorHelper","._joinSessionAsync"),r=AppMagic.Services.Azure.Constants.DefaultRegionProperties,o=f(r),!v(t.baseUrl,o))throw new Error("Invalid base URL for joinsession request: ".concat(t.baseUrl));return[4,AppMagic.Services.PowerAppsHttpTelemetry.sendHttpAsync(e,C(t),n)];case 1:if(i=p.sent(),"object"!=typeof(a=JSON.parse(i.responseText))||!a.hasOwnProperty("sessionState")||"string"!=typeof a.sessionState||!a.sessionState)throw new Error("Invalid WebAuth /joinsession response");if(0!==(s=parseInt(i.headers["x-ms-is-session-owner"]))&&1!==s)throw new Error("Invalid WebAuth /joinsession response");return l=1===s,[2,{sessionState:a.sessionState,isSessionOwner:l}]}}))}))}function f(e){var t=new Set;return Object.keys(e).forEach((function(n){t.add(e[n].docServerEndpoint)})),t.add(new Core.Url("https://fakewebauth.example.net")),t.add(new Core.Url("https://fakewebauthcdn.example.com")),t.add(new Core.Url("https://local.create.powerapps.com")),t.add(new Core.Url("https://localhost")),t}function v(e,t){var n=!1,r=new Core.Url(e).getTrimmedHost(2);return t.forEach((function(e){e.getTrimmedHost(2)==r&&(n=!0)})),n}function C(e){var t=new AppMagic.Services.BodilessHttpRequestBuilder,n=new Core.Url("".concat(e.baseUrl,"/api/authoringsession/joinsession"));return AppMagic.PowerApps.PowerAppsUtility.authorizeHttpBuilder(t,AppMagic.Services.HttpConstants.Method.POST,n,AppMagic.Runtime.Client.ResourceNames.PowerAppsService),t.addHeader("x-ms-join-session-token",e.sessionToken),t.addHeader("Content-Type","application/json"),t.generateSendHttpRequestParameters()}function P(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,(new l).showAsync()];case 1:return[2,!!e.sent()]}}))}))}function b(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(n){switch(n.label){case 0:if(t=Player.Strings.MonitorUnexpectedErrorOccurred,AppMagic.Services.errorHasHttpResponse(e))switch(e.response.status){case AppMagic.Services.HttpConstants.HttpStatusCode.Gone:t=Player.Strings.MonitorSessionExpired;break;case AppMagic.Services.HttpConstants.HttpStatusCode.Unauthorized:t=Player.Strings.MonitorUnauthorizedToJoinSession}return[4,new p(t).showAsync()];case 1:return n.sent(),[2]}}))}))}},function(e,t,n){"use strict";n.r(t),n.d(t,"ShellHeaderManager",(function(){return i}));var r=n(40),o=n(43),i=function(){function e(){}return e.prototype.getShellHeader=function(){if(!e.shellHeader&&this._shouldRenderFullHeader())if(this._shouldUseOfficeHeader())e.shellHeader=new o.OneShellHeader;else{if(!this._shouldUseD365Header())return null;e.shellHeader=new r.D365ShellHeader}return e.shellHeader},e.prototype._shouldUseOfficeHeader=function(){var e,t=Core.Environment.getRegionConfig();return Core.Environment.isServiceFabric()&&!!(null===(e=null==t?void 0:t.webPlayerConfig)||void 0===e?void 0:e.enableOfficeHeader)},e.prototype._shouldUseD365Header=function(){var e,t=Core.Environment.getRegionConfig();return!Core.Environment.isServiceFabric()&&!(null===(e=null==t?void 0:t.webPlayerConfig)||void 0===e?void 0:e.disableD365Header)},e.prototype._shouldRenderFullHeader=function(){return!Core.Environment.shouldHideWebPlayerNavBar()&&!Core.Environment.isIframed()},e.dispose=function(){e.shellHeader=null},e.shellHeader=null,e}()},function(e,t,n){"use strict";function r(e){o.display(e)}n.r(t),n.d(t,"display",(function(){return r})),n.d(t,"WebPlayerSessionExpiredBanner",(function(){return o}));var o=function(e){function t(t){var n=this;return(n=e.call(this,t)||this).appDisplayName=t.appDisplayName,n._setDialogRootRef=n._setDialogRootRef.bind(n),n}return __extends(t,e),t.prototype.render=function(){var e=Core.Utility.formatString(Player.Strings.WebPlayerSessionEndedText,this.appDisplayName);return React.createElement("div",{className:aphrodite.css(i.container)},React.createElement("div",{ref:this._setDialogRootRef,className:aphrodite.css(i.messageContainer),role:"dialog","aria-label":e},React.createElement("div",{className:aphrodite.css(i.sessionEndedText)},e),React.createElement("button",{id:"refresh-session",className:aphrodite.css(i.button)+" btn btn-default",onClick:this._refreshClicked,"data-appmagic-initialfocus":"true"},Player.Strings.WebPlayerSessionEndedButton)))},t.prototype.componentDidMount=function(){var e=this;this._focusRetainer=new Core.UI.Utility.FocusRetainer(this._dialogRoot),setTimeout((function(){return e._focusRetainer.on()}))},t.prototype.componentWillUnmount=function(){this._focusRetainer.off(),this._focusRetainer.dispose()},t.prototype._refreshClicked=function(){var e,t;window.Utilities.reloadWindowWithLogging(window,"WebPlayerSessionExpiredBanner._refreshClicked",null,null===(t=null===(e=Core.Telemetry)||void 0===e?void 0:e.Log)||void 0===t?void 0:t.sessionId,!0)},t.prototype._setDialogRootRef=function(e){this._dialogRoot=e},t.display=function(e){t.preventDisplay||ReactDOM.render(React.createElement(t,{appDisplayName:e}),document.body)},t.preventDisplay=!1,t}(React.Component),i=aphrodite.StyleSheet.create({container:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.75)",transition:"opacity 0.5s ease-in",display:"flex",flexDirection:"column",justifyContent:"center",zIndex:5e3},messageContainer:{backgroundColor:"white"},sessionEndedText:{marginTop:"36px",marginBottom:"36px",textAlign:"center",fontSize:"18px"},button:{display:"block",marginLeft:"auto",marginRight:"auto",backgroundColor:"rgb(0, 120, 215)",color:"white",width:"150px",marginTop:"36px",marginBottom:"36px"}})},function(e,t,n){"use strict";function r(e){var t={};try{new Core.UrlBuilder(e).query.split("&").filter((function(e){return!!e})).map((function(e){return e.split("=")})).filter((function(e){return 2===e.length})).forEach((function(e){t[e[0]]=e[1]}))}catch(e){Core.Telemetry.Log.trackErrorEvent("PublishedAppUrlUtil.getParamsMapFromUrl.Failure",{error:e})}return t}function o(e,t){i((function(t){var n=Object.keys(e),r="^(?:".concat(n.join("|"),")=.*");return t.split("&").filter((function(e){return!e.match(r)})).join("&").concat(n.map((function(t){var n;return"&".concat(t,"=").concat(null!==(n=e[t])&&void 0!==n?n:"")})).join(""))}),t)}function i(e,t){try{var n=new Core.UrlBuilder(t.src),r=JSON.parse(Core.Url.decode(n.fragment));"object"==typeof r&&r.hasOwnProperty("paramsQuery")&&"string"==typeof r.paramsQuery?(r.paramsQuery=e(r.paramsQuery),n.fragment=Core.Url.encode(JSON.stringify(r)),t.setAttribute("src",n.toString())):Core.Telemetry.Log.trackErrorEvent("PublishedAppUrlUtil.setPublishedAppParamsQuery.Failure",{badUrlFragment:r})}catch(e){Core.Telemetry.Log.trackErrorEvent("PublishedAppUrlUtil.setPublishedAppParamsQuery.Failure",{error:e})}}n.r(t),n.d(t,"getParamsMapFromUrl",(function(){return r})),n.d(t,"updatePublishedAppParamsQuery",(function(){return o})),n.d(t,"setPublishedAppParamsQuery",(function(){return i}))},function(e,t,n){"use strict";n.r(t),n.d(t,"display",(function(){return o})),n.d(t,"_setDisplay",(function(){return i})),n.d(t,"close",(function(){return s})),n.d(t,"_setClose",(function(){return l})),n.d(t,"WebPlayerConsentDialog",(function(){return p}));var r=function(e){p.display(e)};function o(e){r(e)}function i(e){r=e}var a=function(){p.close()};function s(){a()}function l(e){a=e}var p=function(e){function t(t){var n=e.call(this,t)||this;n._appResources=t.appResources,n._onSuccessCallback=t.onSuccess,n._onFailureCallback=t.onFailure,n._authPlugin=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.Client.ComponentKeys.AuthenticationPluginCreator).getAuthenticationPlugin();var r=[];for(var o in n._appResources.connectionUsages)r.push(n._appResources.connectionUsages[o].connection);n._hostConfig={appId:n.getAppId(window.webPlayerServerConfig.AppId),region:window.webPlayerServerConfig.Environment,consentRedirectUrl:window.origin+"/webplayer/webClientAuthRedirect.html",consentLoadUrl:window.origin+"/webplayer/webClientAuthStart.html",rootUrl:window.origin+"/webplayer/",appData:{app:JSON.parse(n._appResources.appInfo.originalJson),apis:n._appResources.apis.map((function(e){return e.serializeToJson()})),appConnections:r.map((function(e){return e.serializeToJson()})),connections:n._appResources.connections.map((function(e){return e.serializeToJson()}))},onSuccess:n._onSuccessCallback,onFailure:n._onFailureCallback};return n._authService={getAccessToken:function(e){return new Promise((function(t,r){n._authPlugin.acquireTokenSilentAsync(e).then((function(e){t(e.accessToken)}))}))}},n._telemetryService={logError:function(e,t){Core.Telemetry.Log.trackErrorEvent(e,t)},logEvent:function(e,t){Core.Telemetry.Log.trackActivityEvent(e,t)}},n}return __extends(t,e),t.prototype.render=function(){return React.createElement("div",{className:aphrodite.css(c.container)},React.createElement("div",{className:aphrodite.css(c.messageContainer),role:"dialog","aria-label":"Consent Dialog"},React.createElement(PlayerStandAloneConsent.StandaloneConnectionConsent,{authenticationService:this._authService,config:this._hostConfig,telemetryService:this._telemetryService})))},t.prototype.getAppId=function(e){var t=/\/providers\/microsoft.powerapps\/apps\/(.*)/gi.exec(e);return 2==t.length?t[1]:e},t.close=function(){t._containerElement&&(ReactDOM.unmountComponentAtNode(t._containerElement),document.body.removeChild(t._containerElement),t._containerElement=null)},t.display=function(e){t._containerElement=document.createElement("div"),ReactDOM.render(React.createElement(t,__assign({},e)),t._containerElement),document.body.appendChild(t._containerElement)},t.preventDisplay=!1,t}(React.Component),c=aphrodite.StyleSheet.create({container:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.75)",transition:"opacity 0.5s ease-in",display:"flex",flexDirection:"column",justifyContent:"center",zIndex:5e3},iframe:{display:"block",width:"100%",height:"100%",border:"none"},messageContainer:{backgroundColor:"white",width:480,height:680,margin:"auto",padding:16}})},function(e,t){!function(){e.exports=function(){return this?this:window}()["@pa-client/player-apphost"]}()},function(e,t,n){"use strict";n.r(t),n.d(t,"getAppIframe",(function(){return r})),n.d(t,"parseAppHashParams",(function(){return o}));function r(){return document.getElementById("fullscreen-app-host")}function o(e){if(Core.Environment.isPublishedAppExternalToHost())return{platform:"notwindows",hideNavBar:!0,antiCSRFToken:e||Core.Utility.generate128BitUUID(),cdnUrl:null,iframeMode:"sibling"};if(Core.Environment.isTrustedUCI())return{antiCSRFToken:window.webPlayerServerConfig.UnifiedAppConfig.AntiCSRFToken};var t=r();if(t){var n=new Core.Url(t.src);return JSON.parse(decodeURIComponent(n.fragment))}return{antiCSRFToken:e||Core.Utility.generate128BitUUID()}}},function(e,t,n){"use strict";n.r(t),n.d(t,"WebPlayerNoPlansDialog",(function(){return r}));var r=function(e){function t(t){var n=this;return(n=e.call(this,t)||this)._setupPopupWindow=t.popupWindowSetup,n.state={showReasons:!1,trialReasons:[],visible:!0},n._setDialogRootRef=n._setDialogRootRef.bind(n),n._toggleTrialReasonsAsync=n._toggleTrialReasonsAsync.bind(n),n._getTrialReasonSection=n._getTrialReasonSection.bind(n),n}return __extends(t,e),t.prototype._toggleTrialReasonsAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return this.state.showReasons?(this.setState({showReasons:!1}),[3,4]):[3,1];case 1:return 0!==this.state.trialReasons.length?[3,3]:[4,this._getTrialReasonPromise];case 2:e=t.sent(),this.setState({trialReasons:e}),t.label=3;case 3:this.setState({showReasons:!0}),t.label=4;case 4:return[2]}}))}))},t.prototype._getTrialReasonSection=function(){if(this.state.showReasons){for(var e=[],t=0;t<this.state.trialReasons.length;t++)e.push(React.createElement("span",{key:t},this.state.trialReasons[t])),e.push(React.createElement("br",{key:"linebreak".concat(t)}));return e.push(React.createElement("span",{key:this.state.trialReasons.length},"".concat(AppMagic.Strings.MessageDialogDetailsSessionIdTitle," ").concat(Core.Telemetry.Log.sessionId))),React.createElement("div",{id:"trialReasonArea",tabIndex:0,className:aphrodite.css(o.reasonTextBox)},e)}},t.prototype.render=function(){var e=AppMagic.Strings.Consent_Text1,t=AppMagic.Strings.Consent_Button_Text,n=void 0;if(this.props.isGuest){e=Player.Strings.GuestAccessWithRevokedLicense,t=AppMagic.Strings.Close;var r=this.state.showReasons?Player.Strings.LessDetails:AppMagic.Strings.MoreDetails,i=this._getTrialReasonSection();n=React.createElement("div",{className:aphrodite.css(o.contextContainer)},React.createElement("button",{className:aphrodite.css(o.linkButton),onClick:this._toggleTrialReasonsAsync},r),i)}else this.props.premium&&(e=this.props.expired?Player.Strings.UserPlanWebPlayerRenewal:Player.Strings.UserPlanWebPlayerSignUp,t=AppMagic.Strings.SignIn_Next);return this.state.visible?React.createElement("div",{role:"main",className:aphrodite.css(o.container)},React.createElement("div",{ref:this._setDialogRootRef,className:aphrodite.css(o.messageContainer),role:"dialog","aria-label":e},React.createElement("div",{className:aphrodite.css(o.PlanNeededText)},e),n,React.createElement("button",{id:"response",className:aphrodite.css(o.button)+" btn btn-default",onClick:this._setupPopupWindow.bind(this),"data-appmagic-initialfocus":"true"},t))):null},t.prototype.componentDidMount=function(){var e=this;this._getTrialReasonPromise||(this._getTrialReasonPromise=this.props.getTrialReasonAsync?this.props.getTrialReasonAsync():Promise.resolve([])),this._focusRetainer=new Core.UI.Utility.FocusRetainer(this._dialogRoot),setTimeout((function(){return e._focusRetainer.on()}))},t.prototype.componentWillUnmount=function(){this._focusRetainer.off(),this._focusRetainer.dispose()},t.display=function(e,n,r,o,i){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===o&&(o=!1),AppMagic.Runtime.WebPlayerRuntime.onInteractionRequired(),t._containerElement=document.createElement("div"),ReactDOM.render(React.createElement(t,{popupWindowSetup:e,isGuest:n,premium:r,expired:o,getTrialReasonAsync:i}),t._containerElement),document.body.appendChild(t._containerElement)},t.hide=function(){t._containerElement&&(ReactDOM.unmountComponentAtNode(t._containerElement),t._containerElement.parentNode.removeChild(t._containerElement),t._containerElement=null)},t.prototype._setDialogRootRef=function(e){this._dialogRoot=e},t}(React.Component),o=aphrodite.StyleSheet.create({container:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.75)",transition:"opacity 0.5s ease-in",display:"flex",flexDirection:"column",justifyContent:"center",zIndex:5e3},messageContainer:{backgroundColor:"white"},PlanNeededText:{marginTop:"36px",marginBottom:"36px",textAlign:"center",fontSize:"18px"},button:{display:"block",marginLeft:"auto",marginRight:"auto",backgroundColor:"#742774",color:"white",width:"150px",marginTop:"36px",marginBottom:"36px"},linkButton:{display:"block",background:"none transparent",color:"rgb(63, 21, 63)",":hover":{textDecoration:"underline"},":focus":{color:"rgb(116, 39, 116)"},borderTop:"none",borderBottom:"1px solid transparent",borderLeft:"none",borderRight:"none",textAlign:"center",padding:"0px 0px 15px",userSelect:"text",outline:"none",margin:"0px",borderImage:"initial"},contextContainer:{display:"flex",flexDirection:"column",textAlign:"left",margin:"auto",maxWidth:"450px"},reasonTextBox:{border:"1px solid #CCCCCC",position:"relative",overflow:"auto",maxHeight:"150px",maxWidth:"450px"}})},function(e,t,n){"use strict";n.r(t),n.d(t,"display",(function(){return o})),n.d(t,"_setDisplay",(function(){return i})),n.d(t,"close",(function(){return s})),n.d(t,"_setClose",(function(){return l})),n.d(t,"WebPlayerConsentRequiredDialog",(function(){return p}));var r=function(e){p.display(e)};function o(e){r(e)}function i(e){r=e}var a=function(){p.close()};function s(){a()}function l(e){a=e}var p=function(e){function t(t){var n=this;return(n=e.call(this,t)||this)._appDisplayName=t.appDisplayName,n._onCloseButtonClick=t.onCloseButtonClick,n._setDialogRootRef=n._setDialogRootRef.bind(n),n}return __extends(t,e),t.prototype.render=function(){var e=Core.Utility.formatString(Player.Strings.ConsentRequiredMessage,this._appDisplayName);return React.createElement("div",{className:aphrodite.css(c.container)},React.createElement("div",{ref:this._setDialogRootRef,className:aphrodite.css(c.messageContainer),role:"dialog","aria-label":e},React.createElement("div",{className:aphrodite.css(c.messageText)},e),React.createElement("button",{id:"close-dialog",className:aphrodite.css(c.button)+" btn btn-default",onClick:this._onCloseButtonClick,"data-appmagic-initialfocus":"true"},Player.Strings.Back)))},t.prototype.componentDidMount=function(){var e=this;this._focusRetainer=new Core.UI.Utility.FocusRetainer(this._dialogRoot),setTimeout((function(){return e._focusRetainer.on()}))},t.prototype.componentWillUnmount=function(){this._focusRetainer.off(),this._focusRetainer.dispose()},t.prototype._setDialogRootRef=function(e){this._dialogRoot=e},t.close=function(){t._containerElement&&(ReactDOM.unmountComponentAtNode(t._containerElement),document.body.removeChild(t._containerElement),t._containerElement=null)},t.display=function(e){t._containerElement=document.createElement("div"),ReactDOM.render(React.createElement(t,__assign({},e)),t._containerElement),document.body.appendChild(t._containerElement)},t}(React.Component),c=aphrodite.StyleSheet.create({container:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.75)",transition:"opacity 0.5s ease-in",display:"flex",flexDirection:"column",justifyContent:"center",zIndex:5e3,fontFamily:"'Segoe UI','Helvetica Neue',Helvetica,Arial,sans-serif"},messageContainer:{backgroundColor:"white"},messageText:{margin:"36px",textAlign:"center",fontSize:"18px"},button:{display:"block",marginLeft:"auto",marginRight:"auto",backgroundColor:"#742774",color:"white",width:"150px",marginTop:"36px",marginBottom:"36px",minWidth:"48px",minHeight:"48px",padding:"12px",border:"none",cursor:"pointer"}})},function(e,t,n){"use strict";n.r(t),n.d(t,"AppHostRuntime",(function(){return y}));var r=n(13),o=n(71),i=n(37),a=n(1),s=n(45),l=n(14),p=n(25),c=n(6),d=n(46),u=n(28),g=n(47),m=n(59),h=n(73),y=function(){function e(e,t,n,r,o,i,a,s,l,p,c,d,u,g,m){var h=this;this._appErrorStateHandler=a,this._showUnsupportedControlsBanner=c,this._handleExitCurrentApp=d,this._handlePostExitCurrentApp=u,this._appTargetOrigin=g,this._exitHostedApp=m,this._clusterPath="gateway/cluster",this._notificationShown=!1,this._skipIframeCreation=Core.Environment.isPublishedAppExternalToHost(),this.appEventListener=function(e){switch(e.EventType){case"app-new-version-available":h._appEventCacheMismatchHandler(e);case"app-package-missing":h._appStaleEventHandler(e)}},this._handleMessage=function(e){var t,n=h._messageProvider.getMessageFromEvent(e);n&&"setConsentResult"===n.messageType&&(null===(t=h._appHostManager)||void 0===t||t.currentAppHost.powerAppsClient.consentProvider.updateConsentResultAsync(n.data))},this._telemetryManager=e,this._parser=t,this._appHostManagerFactory=n,this._appHost=r,this._appLoadedHandler=o,this._appFailedHandler=i,this._appIndexLoadedHandler=s,this._showAppSplashScreen=l,this._displayGettingDataString=p,this._onAppLoaded=this._onAppLoaded.bind(this),this._onAppFailed=this._onAppFailed.bind(this),this._onShowAppSplashScreen=this._onShowAppSplashScreen.bind(this),this._onDisplayGettingDataString=this._onDisplayGettingDataString.bind(this),this._onAppErrorState=this._onAppErrorState.bind(this),this.clearTelemetryFlushTimeout=this.clearTelemetryFlushTimeout.bind(this),this._handleInvalidAppFrameLoad=this._handleInvalidAppFrameLoad.bind(this),this._appHost&&(this._appHostManager=this._appHostManagerFactory.getAppHostManager(this._appHost.playerRuntime,null,null,null,this._appHost.apiHandler,this._onAppLoaded,this._onAppFailed,this._onAppErrorState,this._onAppIndexLoaded,null,this._onShowAppSplashScreen,this._onDisplayGettingDataString,this._showUnsupportedControlsBanner,this._handleExitCurrentApp,this._handlePostExitCurrentApp,this._exitHostedApp)),Core.Environment.setWebPlayerEmbedderOrigin(this.embedderOrigin)}return e.getInstance=function(t,n,r,o,a,s,l,p,c,u,m){if(!e._appHostRunTime){var h=new d.TelemetryManager,y=new g.WebPlayerUrlParser,f=new i.AppHostManagerFactory(e.notificationProvider);e._appHostRunTime=new e(h,y,f,null,t,n,r,o,a,s,l,c,u,m,p)}return e._appHostRunTime},Object.defineProperty(e.prototype,"appHost",{get:function(){return this._appHost},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webPlayerParams",{get:function(){return this._webPlayerParams},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playerRuntime",{get:function(){return this._appHost.playerRuntime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appHostManager",{get:function(){return this._appHostManager},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webPlayerAppHostLoadScopeName",{get:function(){return this._webPlayerAppHostLoadScopeName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appIdentifier",{get:function(){return this._appIdentifier||(this._appIdentifier=Core.Environment.isRunningInRootAppMode()?new AppMagic.Runtime.Client.UnifiedAppIdentifier(Core.Environment.getWebPlayerAppEnvironmentId(),Core.Environment.getWebPlayerAppLogicalName()):window.webPlayerServerConfig.AppId),this._appIdentifier},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"embedderOrigin",{get:function(){var e;return Core.Environment.isSharedAppHost()?e=Core.Environment.WebPlayerEmbedderOrigin.ModelEmbedded:Core.Environment.isWebPlayer()&&(Core.Environment.isSkypeTeams()?e=Core.Environment.WebPlayerEmbedderOrigin.Teams:Core.Environment.isModelDrivenAllowedOrigin(Core.Environment.getWebPlayerQueryParam(window.WebPlayerSettings.embedderOrigin))&&(e=Core.Environment.WebPlayerEmbedderOrigin.ModelEmbedded)),null!=e?e:null},enumerable:!1,configurable:!0}),e.prototype.setWebplayerUrlTelemetryDefaultProperty=function(){this._webPlayerParams=this._parser.parseQueryParams(),this._telemetryManager.setDefaultTelemetryProperties(this._webPlayerParams.url.toString(),this._webPlayerParams.externalCorrelationId)},e.prototype.initialize=function(e){var t,n;this.setWebplayerUrlTelemetryDefaultProperty();var o,i=Core.Telemetry.Log.startScenario(Core.Telemetry.ScenarioName.PlayerLifecyclePlayerSDKPlayAppLoadAppHostCreateAppHost,{operationName:"PlayerLifecycle.PlayerSDK.PlayApp.LoadAppHost.CreateAppHost"});e&&(o={getAuthenticationPlugin:function(){return __assign(__assign({},e),{loadConfigurationAsync:function(e){return Promise.resolve()}})}}),Object(h.registerPlayerRuntimeObjects)(Core.Loader.ObjectFactory.instance,o),this._messageProvider=Core.Loader.ObjectFactory.instance.getSingleton(Core.Player.IHostMessageProviderSingletonKey),this._telemetryManager.setTelemetryFlushTimeout(),this._antiCSRFToken=Object(l.parseAppHashParams)().antiCSRFToken,this.logWebPlayerFeatureGatesTelemetry(),this._clearInfiniteLoopDetection(),this._appHost=Object(r.initializeAppHost)({appId:window.webPlayerServerConfig.AppId,appRuntimeEndpoint:null===(t=window.webPlayerServerConfig.PublishedAppConfig)||void 0===t?void 0:t.AppRuntimeEndpoint,cdsOrgUrl:null===(n=window.webPlayerServerConfig.UnifiedAppConfig)||void 0===n?void 0:n.InstanceUrl,serviceProxyUrl:window.webPlayerServerConfig.EndpointConfig.ServiceProxyEndpoint,tenantId:window.webPlayerServerConfig.AuthConfig.TenantId}),Core.Telemetry.Log.passScenario(i),this._testEnvironmentPowerPlatformApiAsNeededAsync(),this._testTenantPowerPlatformApiAsNeededAsync()},e.prototype.startAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n,r,o,i,s,l,c,d,u,g;return __generator(this,(function(m){switch(m.label){case 0:this.initialize(e),window.addEventListener("message",this._handleMessage),r=new Promise((function(e,r){t=e,n=r})),this._publishedAppMetadataPersistedPromise=new Promise((function(e,t){o=e,t})),m.label=1;case 1:return m.trys.push([1,4,,5]),this._initializeAppLoadedPromise(),this.initializeWebPlayer(r,o),[4,this._appHost.loaded.waitAsync()];case 2:return m.sent(),this._appHost.appResourceManagerEvents().addListener(this.appEventListener,this),this._scenarioGuid=this.logWebPlayerLaunchTelemetry(),this.playerRuntime.userService.skipEnroll(),[4,this._getAndRunAppAsync(this.appIdentifier)];case 3:return i=m.sent(),t(i),[3,5];case 4:if(s=m.sent(),l=a.WebPlayerErrorType.Unknown,c=Core.PromiseUtils.formatErrorMessage(s),d=null==s?void 0:s.message,AppMagic.Services.errorHasHttpResponse(s))switch(s.response.status){case AppMagic.Services.HttpConstants.HttpStatusCode.NotFound:l=a.WebPlayerErrorType.GetAppNotFound;break;case AppMagic.Services.HttpConstants.HttpStatusCode.Forbidden:l=a.WebPlayerErrorType.GetAppForbidden,(u=this._parseErrorMessage(c))&&(d=u);break;default:l=a.WebPlayerErrorType.GetAppFailure}else(null==s?void 0:s.errorKind)===AppMagic.Services.Adal.AuthenticationErrorKind.NotLoggedInError&&(l=a.WebPlayerErrorType.UserNotLoggedIn);return g=p.SharedAppHostErrorParser.parseSharedAppHostError(l,d),n(g),this.handleErrorAndCleanUp(l,c,Core.DiagnosticError.tryGetDiagnosticMessage(s),d),[3,5];case 5:return[2]}}))}))},e.prototype._testPpApiAsync=function(t,n){return __awaiter(this,void 0,Promise,(function(){var r,o,i;return __generator(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t="".concat(t,"?").concat(AppMagic.PowerApps.Constants.PowerAppEndpoints.apiVersionKey,"=").concat(AppMagic.PowerApps.PowerAppsUtility.getPowerPlatformApiVersion()),r={url:t,method:"GET",headers:HashTableUtility.create((i={},i[AppMagic.Services.HttpConstants.HeaderName.CacheControl]=AppMagic.Services.HttpConstants.HeaderValue.NoCacheNoStore,i))},AppMagic.Services.addTelemetryOptions(r,{operationName:n}),[4,this.playerRuntime.httpClient.sendHttpAsync(r,"json")];case 1:return a.sent(),[3,3];case 2:return o=a.sent(),!this._notificationShown&&AppMagic.Services.errorHasHttpResponse(o)&&0===o.response.status&&"mooncake"!==window.webPlayerServerConfig.Environment&&"rx"!==window.webPlayerServerConfig.Environment&&(this._notificationShown=!0,setTimeout((function(){e.notificationProvider.showToastMessage({type:"warning",message:[Player.Strings.PowerPlatformAPIBlockedNotification,null],timeout:6e4,preventDuplicates:!0,clickHandler:null})}),3e3)),Core.Telemetry.Log.trackErrorEvent(n,{errorMessage:"Failed to send PPAPI test request. Error Message: ".concat(o.message),notificationShown:this._notificationShown}),[3,3];case 3:return[2]}}))}))},e.prototype._testEnvironmentPowerPlatformApiAsNeededAsync=function(){var e;return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(n){switch(n.label){case 0:return(null===(e=window.webPlayerServerConfig.FeatureGates)||void 0===e?void 0:e.UsePowerPlatformAPI)||!window.webPlayerServerConfig.AppEnvironmentId?[2]:((t=AppMagic.PowerApps.PowerAppsUtility.createPowerPlatformEnvironmentUrlBuilder(window.webPlayerServerConfig.AppEnvironmentId)).appendPath(this._clusterPath),[4,this._testPpApiAsync(t.toString(),"AppHostRuntime._testEnvironmentPowerPlatformApiAsNeededAsync")]);case 1:return n.sent(),[2]}}))}))},e.prototype._testTenantPowerPlatformApiAsNeededAsync=function(){var e,t;return __awaiter(this,void 0,Promise,(function(){var n;return __generator(this,(function(r){switch(r.label){case 0:return(null===(e=window.webPlayerServerConfig.FeatureGates)||void 0===e?void 0:e.UsePowerPlatformAPI)||!(null===(t=window.webPlayerServerConfig.AuthConfig)||void 0===t?void 0:t.TenantId)?[2]:((n=AppMagic.PowerApps.PowerAppsUtility.createPowerPlatformTenantUrlBuilder(window.webPlayerServerConfig.AuthConfig.TenantId)).appendPath(this._clusterPath),[4,this._testPpApiAsync(n.toString(),"AppHostRuntime._testTenantPowerPlatformApiAsNeededAsync")]);case 1:return r.sent(),[2]}}))}))},e.prototype._handleInvalidAppFrameLoad=function(){Core.Telemetry.Log.flush(),ScriptLoader.reloadPlayerWithStaticContentFallback()},e.prototype._onAppLoaded=function(){var e,t;this.clearTelemetryFlushTimeout(),this._startHostServiceWorkerAsync(),null===(e=this._appLoadedPromiseResolver)||void 0===e||e.call(this),null===(t=this._appLoadedHandler)||void 0===t||t.call(this),this._disposePerformanceObserver()},e.prototype._onAppFailed=function(e){var t,n;null===(t=this._appLoadedPromiseRejector)||void 0===t||t.call(this,e),null===(n=this._appFailedHandler)||void 0===n||n.call(this,e),this._disposePerformanceObserver()},e.prototype._onAppIndexLoaded=function(){var e;null===(e=this._appIndexLoadedHandler)||void 0===e||e.call(this),Core.Telemetry.Log.trackActivityEvent("PlayerLifecycle.PlayerSDK.PlayApp.LoadApp.CreateAppFrame.AppIframeInitialized")},e.prototype._onShowAppSplashScreen=function(){var e;null===(e=this._showAppSplashScreen)||void 0===e||e.call(this)},e.prototype._onDisplayGettingDataString=function(){var e;null===(e=this._displayGettingDataString)||void 0===e||e.call(this)},e.prototype._onAppErrorState=function(e){var t;null===(t=this._appErrorStateHandler)||void 0===t||t.call(this,e)},e.prototype.clearTelemetryFlushTimeout=function(){this._telemetryManager.clearTelemetryFlushTimeout()},e.prototype.flushTelemetry=function(){this._telemetryManager.flushTelemetry()},e.prototype.initializeWebPlayer=function(e,t){var n,r=this;this._appDetailsProvider=new s.AppDetailsProvider(this.playerRuntime,this.appIdentifier,t,Core.Environment.isRunningInRootAppMode(),Object(l.parseAppHashParams)(this._antiCSRFToken));var o,i=Core.Environment.tryGetPublishedAppMetadataFromWebPlayerServerConfig();if(this._appDetailsProvider.setAppDetails(i,"AppHostRuntime.initializeWebPlayer"),!this._skipIframeCreation&&!(o=Object(l.getAppIframe)()))throw Core.Telemetry.Log.trackErrorEvent("AppHostRuntime.InitializeWebPlayer.NullIframe"),a.WebPlayerErrorDialog.display(a.WebPlayerErrorType.RunAppFailure),null===(n=this._exitHostedApp)||void 0===n||n.call(this),new Error("AppHostRuntime.InitializeWebPlayer.NullIframe");this._messageChannel=new AppMagic.Runtime.Client.MessageChannel(Object(l.getAppIframe)(),this._antiCSRFToken,this._appTargetOrigin),this._apiHandler=new PlayerApiHost.CordovaApiHost.AppHostAPIHandler(this._messageChannel,(function(){r._handleInvalidAppFrameLoad()})),Core.Telemetry.Log.trackActivityEvent("PlayerLifecycle.PlayerSDK.PlayApp.LoadAppHost.InitPlugins.CommonPluginsInitialized"),this._appHostManager=this._appHostManagerFactory.getAppHostManager(this.playerRuntime,this.appIdentifier,o,this._appDetailsProvider,this._apiHandler,this._onAppLoaded,this._onAppFailed,this._onAppErrorState,this._onAppIndexLoaded,e,this._onShowAppSplashScreen,this._onDisplayGettingDataString,this._showUnsupportedControlsBanner,this._handleExitCurrentApp,this._handlePostExitCurrentApp,this._exitHostedApp),this._webPlayerAppHostLoadScopeName=Core.Utility.generateNonDashedUUID(),Core.PerformanceTracker.enterScope(this._webPlayerAppHostLoadScopeName)},e.prototype.setAppDetailsFromExtendedMetadata=function(e,t){var n;if(this._isAppExtendedMetadata(e)){var r=e,o={indexWebHtmlUrl:r.webPackage.value,readonlyIndexWebHtmlUrl:r.webPackage.readonlyValue,documentVersion:r.documentServerVersion,appPackageResourcesKind:r.appPackageResourcesKind,appVersion:r.appVersion};null===(n=this._appDetailsProvider)||void 0===n||n.setAppDetails(o,t)}else Core.Telemetry.Log.trackActivityEvent("WebPlayer.setAppDetailsFromExtendedMetadata.CouldNotConvertAndUseSessionData",{metadata:e})},e.prototype.logWebPlayerLaunchTelemetry=function(){return this._telemetryManager.logWebPlayerLaunchTelemetry(this._webPlayerParams.appId,this._webPlayerParams.source,this._webPlayerParams.appType,this._webPlayerParams.connectionType)},e.prototype.logWebPlayerFeatureGatesTelemetry=function(){this._telemetryManager.logWebPlayerServerFeatureGates()},e.prototype.disposeAppHostManager=function(){var e,t,n;null===(e=this._appHostManager)||void 0===e||e.dispose(),this._appHostManager=void 0,null===(t=this._apiHandler)||void 0===t||t.dispose(),this._apiHandler=void 0,null===(n=this._messageChannel)||void 0===n||n.dispose(),this._messageChannel=void 0},e.prototype.handleErrorAndCleanUp=function(e,t,n,r,o,i){var a;void 0===o&&(o=!1),void 0===i&&(i=window);var s={message:Core.Telemetry.Utility.scrubSensitiveDataSafe(t),url:Core.Telemetry.Utility.scrubSensitiveDataSafe(i.location.href),errorType:e,errorDetails:Core.Telemetry.Utility.scrubSensitiveDataSafe(n)};if(Core.Telemetry.Log.trackErrorEvent(Core.Telemetry.Strings.webPlayerError,s),!this.tryHandleWarmAppLoadInTeamsError(i)){if(o){var l=p.SharedAppHostErrorParser.parseSharedAppHostError(e,r);this.postMessageToHost("sendError",{info:0,parameterType:"error",error:l})}Core.Telemetry.Log.failScenario(this._scenarioGuid,{message:t}),null===(a=Core.Telemetry.Log.providerInstance)||void 0===a||a.setDefaultProperties({sessionFailed:"true"}),this.flushTelemetry()}},e.prototype.tryHandleWarmAppLoadInTeamsError=function(e){var t,n;return void 0===e&&(e=window),!(!Core.Environment.isSkypeTeams()||!c.TeamsWebPlayerRuntime.isWarmAppLoad())&&(Core.Telemetry.Log.trackActivityEvent("AppHostRuntime.handleErrorAndCleanUp.reloadWebPlayerWhenInTeamsAppCaching"),this.flushTelemetry(),window.Utilities.reloadWindowWithLogging(e,"AppHostRuntime.tryHandleWarmAppLoadInTeamsError",e.location.href,null===(n=null===(t=Core.Telemetry)||void 0===t?void 0:t.Log)||void 0===n?void 0:n.sessionId,!1),!0)},e.prototype.postMessageToSdk=function(e,t){switch(void 0===t&&(t="*"),e.api){case WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.CloseConsentPage:this.postMessageToHost("closeConsentPage");break;case WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.OpenConsentPage:var n={info:!0,parameterType:"standAloneConsent",data:{openConsentData:e.data}};this.postMessageToHost("openConsentPage",n);break;case WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.SetConsentResult:var r={info:!0,parameterType:"standAloneConsent",data:{consentResult:e.data}};this.postMessageToHost("setConsentResult",r);break;case WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.GetPreloadConsentServiceData:this.postMessageToHost("getPreloadConsentServiceData");break;case WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.OpenConnectorAuthPopup:var o={info:!0,parameterType:"standAloneConsent",data:{connectorAuthMessage:e.data}};this.postMessageToHost("authenticateConnector",o);break;default:Core.Telemetry.Log.trackErrorEvent("AppHostRuntime.postMessageToSdk",{message:"Received API ".concat(e.api," which is invalid.")})}},e.prototype._appEventCacheMismatchHandler=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this._publishedAppMetadataPersistedPromise];case 1:return e.sent(),Core.Loader.ObjectFactory.instance.getSingleton(Core.Player.IHostMessageProviderSingletonKey).sendLifecycleEvent({eventName:"app-new-version-available"}),[2]}}))}))},e.prototype._appStaleEventHandler=function(e){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(n){return t=Core.Loader.ObjectFactory.instance.getSingleton(Core.Player.IHostMessageProviderSingletonKey),Core.Utility.isValue(null==e?void 0:e.cachedAppMetadataVersion)&&(null==e?void 0:e.cachedAppMetadataVersion)!==(null==e?void 0:e.unifiedAppMetadataVersion)&&t.sendLifecycleEvent({eventName:"app-stale"}),[2]}))}))},e.prototype.postMessageToHost=function(e,t){if(Core.Environment.isPublishedAppExternalToHost()||Core.Environment.isTrustedUCI())switch(e){case"resizeHost":return this._messageProvider.resizeHost(t.info,t.parameterType);case"clearPublishedApp":return this._messageProvider.clearPublishedApp();case"sendError":return this._messageProvider.sendErrorMessage(t.error);case"openConsentPage":return this._messageProvider.sendOpenConsentMessage(t.data.openConsentData);default:return}},e.prototype._parseErrorMessage=function(e){var t,n,r,o=void 0;try{var i=JSON.parse(e);(null===(t=null==i?void 0:i.error)||void 0===t?void 0:t.message)&&(o=Core.Utility.replaceAll(null===(n=null==i?void 0:i.error)||void 0===n?void 0:n.message,"\r\n"," "));var a=null===(r=null==i?void 0:i.error)||void 0===r?void 0:r.details;a&&a.forEach((function(e){var t=null==e?void 0:e.message;t&&(o+=" ",o+=Core.Utility.replaceAll(t,"\r\n"," "))}))}catch(t){Core.Telemetry.Log.trackErrorEvent("AppHostRuntime._parseErrorMessage",{message:"Failed to parse error message. Raw Error Message: ".concat(e)})}return o},e.prototype._isAppExtendedMetadata=function(e){var t,n=e;return n&&void 0!==(null===(t=n.webPackage)||void 0===t?void 0:t.value)&&void 0!==n.webPackage.readonlyValue&&void 0!==n.documentServerVersion&&void 0!==n.appPackageResourcesKind&&void 0!==n.appVersion},e.prototype._getAndRunAppAsync=function(e){var t,n;return __awaiter(this,void 0,Promise,(function(){var r,i,a,s;return __generator(this,(function(l){switch(l.label){case 0:return Core.Telemetry.Log.trackActivityEvent(Core.Telemetry.Strings.webPlayerGetApp,{isUserChecked:!1}),r=Core.PerformanceTracker.exitScopeAndGetRunTime(this._webPlayerAppHostLoadScopeName),Core.Telemetry.Log.updateOpenAppData({webPlayerLoadAppHostTime:r}),Core.Telemetry.Log.updateOpenAppData({appId:this._webPlayerParams.appId}),i=!1,e instanceof AppMagic.Runtime.Client.UnifiedAppIdentifier&&(i=Core.Environment.getSkipLaunchAppCache(),Core.Telemetry.Log.updateOpenAppData({appLogicalName:e.appLogicalName})),[4,this._appHost.getAppPreloadDataAsync(e,i)];case 1:return a=l.sent(),null===(t=window.performance)||void 0===t||t.mark("webPlayerCreateAppHostAndOpenAppStarted"),null===(n=this._appHostManager)||void 0===n||n.createAppHostAndOpenAppUsingPreloadData(a.appPreloadData,a.getAppResourcesPromise,"AppHostRuntime._getAndRunAppAsync"),Core.Telemetry.Log.passScenario(this._scenarioGuid),s=o.b.getTimeUntilSASRenewalInMs(a.appPreloadData.webPackageUrl),this._webPlayerSessionManager=new u.WebPlayerSessionManager("",this,!1,void 0,void 0,void 0,s),[2,a.appPreloadData]}}))}))},e.prototype._clearInfiniteLoopDetection=function(){var e;(null===(e=window.webPlayerServerConfig.AuthConfig)||void 0===e?void 0:e.UseClientSideAuth)&&window.WebAuthenticationBootstrap&&window.WebAuthenticationBootstrap.allGoodConfirmed()},e.prototype._initializeAppLoadedPromise=function(){var e,t=this;this._appLoadedPromise=null!==(e=this._appLoadedPromise)&&void 0!==e?e:new Promise((function(e,n){t._appLoadedPromiseResolver=e,t._appLoadedPromiseRejector=n}))},e.prototype._disposePerformanceObserver=function(){var e;null===(e=window.disconnectPerformanceObserver)||void 0===e||e.call(window)},e.prototype._startHostServiceWorkerAsync=function(){var e,t,n;return __awaiter(this,void 0,Promise,(function(){var r,o,i,a,s,l=this;return __generator(this,(function(p){return r=null===(e=window.webPlayerServerConfig.FeatureGates)||void 0===e?void 0:e.hostServiceWorker,o=!Core.Environment.isIframed()&&!!(null===(t=window.webPlayerServerConfig.FeatureGates)||void 0===t?void 0:t.HostServiceWorkerStandalone),i=(null===(n=window.webPlayerServerConfig.FeatureGates)||void 0===n?void 0:n.HostServiceWorkerSharedAppHost)&&Core.Environment.isSharedAppHost(),a="serviceWorker"in navigator,s=Core.Environment.isSkypeTeams(),r&&a&&(s||o||i)?(Core.Telemetry.Log.trackActivityEvent("WebPlayer.ServiceWorker.Host.ServiceWorkerIsEnabled"),setTimeout((function(){return __awaiter(l,void 0,void 0,(function(){var e,t;return __generator(this,(function(n){switch(n.label){case 0:Core.Telemetry.Log.trackActivityEvent("WebPlayer.ServiceWorker.Host.Starting"),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,new PowerAppsServiceWorkerManager.HostServiceWorkerManager((function(e){try{var t=e;t.data=JSON.stringify(e.data),t.metrics=JSON.stringify(e.metrics),Core.Telemetry.Log.trackActivityEvent("WebPlayer.ServiceWorker.Host",t)}catch(e){Core.Telemetry.Log.trackErrorEvent("Failed to stringify service worker data")}}),!0,Core.Telemetry.Log.sessionId,(function(e){var t=Core.Telemetry.Log.providerInstance;t&&t.setDefaultProperties({serviceWorkerSessionId:e})})).startAsync()];case 2:return e=n.sent(),Core.Telemetry.Log.trackActivityEvent("WebPlayer.ServiceWorker.Host.Started",{startResult:null==e?void 0:e.result}),[3,4];case 3:return t=n.sent(),Core.Telemetry.Log.trackErrorEvent("Failed to register Host Service Worker",t),[3,4];case 4:return[2]}}))}))}),5e3)):Core.Telemetry.Log.trackActivityEvent("WebPlayer.ServiceWorker.Host.ServiceWorkerIsNotEnabled",{isFeatureGateEnabled:r,isServiceWorkerSupported:a,isStandaloneEnabled:o,isTeams:s,isSharedAppHostEnabled:i}),[2]}))}))},e.notificationProvider=new m.WebPlayerNotificationProvider,e}()},function(e,t,n){"use strict";function r(e,t,n){void 0===n&&(n=!0),o.display(e,t,n)}n.r(t),n.d(t,"display",(function(){return r})),n.d(t,"WebPlayerAuthDialog",(function(){return o}));var o=function(e){function t(t){var n=this;return(n=e.call(this,t)||this)._setupPopupWindow=t.popupWindowSetup,n._loginPromise=t.loginPromise,n.state={visible:!0},n._setDialogRootRef=n._setDialogRootRef.bind(n),n}return __extends(t,e),t.prototype.render=function(){var e;if(this.state.visible){var t=void 0;t=this.props.cookiesEnabled?this.props.requiresMFA?AppMagic.Strings.SignIn_AlreadySignedIn:Player.Strings.WebPlayerReauthenticateSignInMessage:Player.Strings.WebPlayerCookiesBlockedMessage,e=React.createElement("div",{className:aphrodite.css(i.container)},React.createElement("div",{ref:this._setDialogRootRef,className:aphrodite.css(i.messageContainer),role:"dialog","aria-label":t},React.createElement("div",{className:aphrodite.css(i.loginNeededText)},t),React.createElement("button",{id:"login",className:aphrodite.css(i.button)+" btn btn-default",onClick:this._loginClicked.bind(this),"data-appmagic-initialfocus":"true"},AppMagic.Strings.SignIn)))}else e=null;return e},t.prototype.componentDidMount=function(){var e=this;this._focusRetainer=new Core.UI.Utility.FocusRetainer(this._dialogRoot),setTimeout((function(){return e._focusRetainer.on()}))},t.prototype.componentWillUnmount=function(){this._focusRetainer.off(),this._focusRetainer.dispose()},t.display=function(e,n,r){return void 0===r&&(r=!0),__awaiter(this,void 0,void 0,(function(){var o,i;return __generator(this,(function(a){switch(a.label){case 0:return AppMagic.Runtime.Client.Adal.LoginUITelemetry.markLoginUIAsVisible(),AppMagic.Runtime.WebPlayerRuntime.onInteractionRequired(),t._timeOutTrackHeight=setTimeout((function(){Core.Telemetry.Log.trackActivityEvent("WebPlayerAuthDialog.display.height",{height:window.innerHeight})}),2e3),[4,AppMagic.Strings.loadingPromise()];case 1:return a.sent(),o=Core.PromiseUtils.createCompletablePromise(),i=document.createElement("div"),t._containerElements.push(i),ReactDOM.render(React.createElement(t,{popupWindowSetup:e,loginPromise:o,requiresMFA:n,cookiesEnabled:r}),i),document.body.appendChild(i),[2,o.promise]}}))}))},t.hide=function(){for(;t._containerElements.length>0;){var e=t._containerElements.pop();ReactDOM.unmountComponentAtNode(e)}AppMagic.Runtime.Client.Adal.LoginUITelemetry.markLoginUIAsDismissed()},t.prototype._loginClicked=function(){var e=this;this._setupPopupWindow().then((function(){e._loginPromise.complete(),clearTimeout(t._timeOutTrackHeight)}),(function(t){return e._loginPromise.error(t)}))},t.prototype._setDialogRootRef=function(e){this._dialogRoot=e},t._containerElements=[],t._timeOutTrackHeight=null,t}(React.Component),i=aphrodite.StyleSheet.create({container:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.75)",transition:"opacity 0.5s ease-in",display:"flex",flexDirection:"column",justifyContent:"center",zIndex:5e3,fontFamily:"'Segoe UI','Helvetica Neue',Helvetica,Arial,sans-serif"},messageContainer:{backgroundColor:"white"},loginNeededText:{marginTop:"36px",marginBottom:"36px",textAlign:"center",fontSize:"18px"},button:{display:"block",marginLeft:"auto",marginRight:"auto",backgroundColor:"#742774",color:"white",width:"150px",marginTop:"36px",marginBottom:"36px",minWidth:"48px",minHeight:"48px",padding:"12px",border:"none",cursor:"pointer"}})},function(e,t,n){"use strict";n.r(t),n.d(t,"AppConnectionsViewModel",(function(){return p}));var r=n(13),o=n(51),i=n(0),a=n(52),s=n(33),l=[{action:{apiName:"SharePoint",actionName:"HttpRequest"},warning:function(){return AppMagic.Strings.SharePointHttpWarning}}],p=function(e){function t(t){var n=e.call(this)||this;n._updateConnectionsInfoAbortController=new AbortController,n._appResources=t.appResources,n._deviceCapabilities=t.deviceCapabilities,n._authResources=t.authResources,n._powerAppsService=t.powerAppsService,n._powerAppsClient=t.powerAppsClient,n._displayName=t.displayName,n._appName=t.appName,n._authorEmail=t.authorEmail,n._environment=t.environment,n._allConnectionsSetUp=ko.observable(!1),n._loading=ko.observable(!0),n._saving=ko.observable(!1),n._currentAddConnectionViewModel=null;var i=t.userService;i||(i=Core.Loader.ObjectFactory.instance.getSingleton(r.PlayerRuntimeSingletonKey).userService);return n._userService=i,n._addConnectionComponentFactory=new o.AddPlayerConnectionComponentFactory(i),n._addConnectionAbortController=null,n._addConnectionPromise=null,n._disableAutoSelect=!!t.disableAutoSelect,n._selectedConnection=ko.observable(null),n.track("_showSelectionList",ko.computed((function(){return!!n._selectedConnection()}))),t.setShowMessage&&n._showSelectionList.subscribe((function(e){return t.setShowMessage(!e)})),n._connectionsInfo=[],t.connectionReferences&&(HashTableUtility.forEach(t.connectionReferences,(function(e,t){var r={reference:e,dataSourceName:t,allowCreation:!e.sharedConnectionId,isOnPremise:!!e.isOnPremiseConnection,consentOptions:e.consentOptions,parent:n},o=new s.ConnectionInfo(r);n._connectionsInfo.push(o)})),n._connectionsInfo.sort((function(e){return e.showAddButton?0:1})),t.appResources.appInfo&&HashTableUtility.forEach(t.appResources.appInfo.connectionReferences,(function(e){if(e.nestedActions){var t=l.filter((function(t){var n;return null===(n=e.nestedActions)||void 0===n?void 0:n.some((function(e){return e.apiName===t.action.apiName&&e.actionName===t.action.actionName}))}));t.length>0&&e.dependencies&&HashTableUtility.forEach(e.dependencies,(function(r){var o=n._connectionsInfo.find((function(e){return e.dataSourceName===r}));o&&(o.addWarnings.apply(o,t.map((function(e){return e.warning()}))),Core.Telemetry.Log.trackActivityEvent("ConsentDialog.Warnings.render",{warnings:t.map((function(e){return e.action})),connection:o.reference.id,source:e.id}))}))}}))),n._addConnectionAbortController=new AbortController,n._updateConnectionsInfoPromise=n.updateConnectionsInfoAsync(!1,Core.Environment.isWebAuthoring()).then((function(){n._connectionsInfo.forEach((function(e){var t,n;if(!e.isSetupComplete()){var r=AppMagic.ConnectionHub.PowerAppsConnectionService.getParameterSetName(e.reference);Core.Telemetry.Log.trackActivityEvent("PlayerLifecycle.LoadConnections.UsagesNeeded",{selectedConnectionId:e.selected<0||0===e.availableConnections.length?null:e.availableConnections[e.selected].id,isAuthenticated:-1!==e.selected&&e.isAuthenticated,sharedConnectionMissing:e.showShareError,sharedConnectionId:e.reference.sharedConnectionId,apiId:null===(t=e.api)||void 0===t?void 0:t.id,authType:r,isSSOconnection:null===(n=e.api)||void 0===n?void 0:n.getIsFirstParty(r)});var o=void 0;Core.Utility.isGuid(e.reference.sharedConnectionId)?o=AppMagic.Strings.SharedConnectionMissingMessage:0===e.availableConnections.length&&(o=AppMagic.Strings.SharedConnectionDeletedMessage),o&&Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.Connection,"LoadConnections",{errorMessage:o,sharedConnectionId:e.reference.sharedConnectionId,availableConnectionsLength:e.availableConnections.length},Core.Diagnostics.MonitorLogLevel.Error)}}))})),n}return __extends(t,e),t.prototype.dispose=function(){this._addConnectionPromise&&(Core.PromiseUtils.abortPromise(this._addConnectionPromise,this._addConnectionAbortController),this._addConnectionPromise=null,this._addConnectionAbortController=null),this._updateConnectionsInfoPromise&&(Core.PromiseUtils.abortPromise(this._updateConnectionsInfoPromise,this._updateConnectionsInfoAbortController),this._updateConnectionsInfoPromise=null,this._updateConnectionsInfoAbortController=null),this._connectionsInfo.forEach((function(e){return e.dispose()})),e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"connectionsInfo",{get:function(){return this._connectionsInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceCapabilities",{get:function(){return this._deviceCapabilities},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authResources",{get:function(){return this._authResources},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentAddConnectionViewModel",{get:function(){return this._currentAddConnectionViewModel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allConnectionsSetUpObservable",{get:function(){return this._allConnectionsSetUp},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loading",{get:function(){return this._loading()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"saving",{get:function(){return this._saving()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disableAutoSelect",{get:function(){return this._disableAutoSelect},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectedConnection",{get:function(){return this._selectedConnection()},set:function(e){this._selectedConnection(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showSelectionList",{get:function(){return this._showSelectionList()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showSelectionListObservable",{get:function(){return this._showSelectionList},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_connectionService",{get:function(){return this._userService.tryGetConnectionService()},enumerable:!1,configurable:!0}),t.prototype.waitForConnectionsToBeUpdatedAsync_TestOnly=function(){return this._updateConnectionsInfoPromise},t.prototype.updateConnectionsInfoAsync=function(e,t,n){var r=this;if(0===this._connectionsInfo.length)return this._allConnectionsSetUp(!0),this._loading(!1),Promise.resolve();this._loading(!0),Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appConnectionsUpdateStarted);var o=Promise.resolve();return e&&(o=this._forceRefreshAppResourcesAsync(t)),o.then((function(){var t=r._appResources.connections,o=r._appResources.connectionUsages?HashTableUtility.mapToArray(r._appResources.connectionUsages,(function(e){return e})):[],i=r._connectionsInfo.map((function(i){return r._populateConnectionInfoAsync(i,t,o,e,n)}));return Core.PromiseUtils.join(i)})).then((function(){r._loading(!1),r.refreshSetUpStatus(),Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appConnectionsUpdateCompleted)}),(function(e){return Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appConnectionsUpdateError,{error:Core.PromiseUtils.formatError(e)}),r._loading(!1),Core.UI.Popups.showErrorDialogAsync({id:"AppConnectionsViewModel.updateConnectionsInfoAsync.error",message:Player.Strings.PermissionsCantLoad,title:Player.Strings.Error}).then(Core.Utility.noOpFnAsync)}))},t.prototype._forceRefreshAppResourcesAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n,r,o,i=this;return __generator(this,(function(a){return e?(r=Promise.resolve(HashTableUtility.create()),this._appName&&(o=AppMagic.PowerApps.PowerAppsUtility.getPowerAppsAppId(this._appName),r=this._connectionService.getCurrentUserConnectionsForAppAsync(o).then(null,(function(e){return Core.Log.error("AppConnectionsViewModel.updateConnectionsInfoAsync",e,"Error in getCurrentUserConnectionsForAppAsync call."),HashTableUtility.create()}))),[2,Core.PromiseUtils.join([this._connectionService.getConnectionsAsync(),this._connectionService.getApisAsync(),r]).then((function(e){var t=e[0],n=e[1],r=e[2];i._appResources=new AppMagic.Runtime.Client.AppResources(null,n,t,r)}))]):(o=AppMagic.PowerApps.PowerAppsUtility.getPowerAppsAppId(this._appName),t=Core.Environment.getWebPlayerAppEnvironmentId(),n=Core.Environment.getWebPlayerAppLogicalName(),Core.Environment.isSharedConsentOnly()&&Core.Utility.isNonEmptyNonWhitespaceString(n)&&Core.Utility.isNonEmptyNonWhitespaceString(t)&&(o=new AppMagic.Runtime.Client.UnifiedAppIdentifier(t,n)),[2,this._userService.appResourceManager.getAppResourcesAsync(o,!0,!1,!0).then((function(e){i._appResources=e}))])}))}))},t.prototype._populateConnectionInfoAsync=function(e,t,n,r,o){return __awaiter(this,void 0,Promise,(function(){var i,a,s,l,p,c;return __generator(this,(function(d){switch(d.label){case 0:return a=!1,e.reference.unauthenticatedConnection?(i=[e.reference.unauthenticatedConnection],a=!0):i=n.filter((function(t){return t.reference===e.dataSourceName})).map((function(e){return e.connection})),(s=this._appResources.apis.find((function(t){return AppMagic.PowerApps.PowerAppsUtility.compareApiId(t.id,e.reference.id)}))||null)?e.api=s:Core.Log.error("AppConnectionsViewModel._populateConnectionInfoAsync","Unable to find the API with id: "+e.reference.id),l=AppMagic.Runtime.Client.ConnectionOperations.filterAndSortAvailableConnections(e.reference,t,this._userService.userProfile.email),[4,this._ensureSsoConnectionIsCreatedAsync(e,s,l,o)];case 1:return d.sent(),e.selected=this._findSelectedConnectionIndex(l,i),!r&&a&&e.selected>-1&&l[e.selected]&&i[0]&&(l[e.selected]=i[0]),e.availableConnections=l,0===i.length?e.needsSaving=!0:!Core.FallbackSwitch.isActivated("AppConnectivity.GranularConsentDialogV2")&&!this.isUnifiedApp()&&e.selected>-1&&l[e.selected]&&(p=n.find((function(t){return Core.Utility.equalsIgnoreCase(t.reference,e.dataSourceName)})))&&(c=p.appActions,e.reference.appActions&&e.reference.appActions.some((function(e){if(!c||!c.some((function(t){return Core.Utility.equalsIgnoreCase(t,e)})))return!0}))&&(e.needsSaving=!0)),[2]}}))}))},t.prototype._ensureSsoConnectionIsCreatedAsync=function(e,t,n,r){var o;return __awaiter(this,void 0,Promise,(function(){var i,a,s,l,p,c,d;return __generator(this,(function(u){switch(u.label){case 0:if(!t)return[2];if(i=AppMagic.ConnectionHub.PowerAppsConnectionService.getParameterSetName(e.reference),a=HashTableUtility.some(t.getConnectionParameters(i),(function(e){return e.isRequiredCloudParameter()})),s=e.consentOptions&&e.consentOptions.manualLoginSettings===AppMagic.ConnectionHub.ManualLoginSettings.Force,l=t.getIsFirstParty(i),p=n.length>0||!l||a||s,Core.Telemetry.Log.trackEvent("_ensureSsoConnectionIsCreatedAsync",{skipSSOConnectionCreation:p,availableConnections:n.length,isOnPremise:e.isOnPremise,isFirstParty:l,hasRequiredCloudParameter:a,forceManualLogin:s,parameterSetName:i}),p)return[2];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,this._connectionService.addConnectionAsync(t,void 0,null===(o=e.reference)||void 0===o?void 0:o.gatewayObjectIdHint,void 0,i,void 0,void 0,r)];case 2:return c=u.sent(),n.push(c),this._appResources.connections.push(c),[3,4];case 3:return d=u.sent(),Core.PromiseUtils.throwIfCanceled(d),e.consentOptions={manualLoginSettings:AppMagic.ConnectionHub.ManualLoginSettings.Force},Core.Log.error("AppConnectionViewModel.ensureSsoConnectionIsCreatedAsync",d,"Failed trying to automatically create SSO connection."),[3,4];case 4:return[2]}}))}))},t.prototype.getFullApiAsync=function(e){return AppMagic.Runtime.Client.ConnectionOperations.getFullApiByIdAsync(this._connectionService,e)},t.prototype.addOrUpdateConnection=function(e,t){var n=this,r=e.reference.id.split("/").pop();if(this._saving(!0),e.addingConnection=!0,Core.Telemetry.Log.trackEvent(t?Core.Telemetry.Strings.appConnectionsUpdateStarted:Core.Telemetry.Strings.appConnectionsAddStarted,{apiName:r}),e.api){var o=function(o){n._backToSelectingAndDisposeCurrentObjects(e),Core.PromiseUtils.throwIfCanceled(o),Core.Log.error("AppConnectionsViewModel.addOrUpdateConnection",o),Core.Telemetry.Log.trackEvent(t?Core.Telemetry.Strings.appConnectionsUpdateError:Core.Telemetry.Strings.appConnectionsAddError,{apiName:r,error:Core.PromiseUtils.formatError(o)})},i=new AbortController,s=Promise.resolve().then((function(){var s=n._addConnectionComponentFactory.createComponent(e.api,n._connectionService,AppMagic.ConnectionHub.PowerAppsConnectionService.getParameterSetName(e.reference),{consentOptions:e.consentOptions,connectionName:t},e.reference.gatewayObjectIdHint);if(n._currentAddConnectionViewModel=s.viewModel,n.trackAnonymous(n._currentAddConnectionViewModel.addConnectionEvent.addListener((function(t){return n._handleCreatedConnection(t,e,r)}))),n.trackAnonymous(n._currentAddConnectionViewModel.updateConnectionEvent.addListener((function(t){return n._handleUpdatedConnection(t,e,r)}))),n._currentAddConnectionViewModel.canConnectDirectly)return n._currentAddConnectionViewModel.connectAsync(i);var l=new a.AddConnectionDialogViewModel(e.reference.displayName,n._currentAddConnectionViewModel);n._currentDialog=new Core.UI.Popups.Dialog(l),l.buttons.unshift(new Core.UI.Popups.DialogButtonViewModel(Player.Strings.PermissionsButtonCancel,(function(){return n._backToSelectingAndDisposeCurrentObjects(e)}),null,ko.computed((function(){return!n._currentAddConnectionViewModel.loading})),ko.computed((function(){return n._currentAddConnectionViewModel.loading})))),l.buttons.unshift(new Core.UI.Popups.DialogButtonViewModel(n._currentAddConnectionViewModel.connectButtonText,(function(){return n._currentAddConnectionViewModel.connectAsync().catch(o)}),null,ko.computed((function(){return n._currentAddConnectionViewModel.isValid&&!n._currentAddConnectionViewModel.loading})),ko.computed((function(){return n._currentAddConnectionViewModel.loading})))),n._currentDialog.showAsync()}));s.catch(o),this._addConnectionPromise=s,this._addConnectionAbortController=i}else Core.UI.Popups.showErrorDialogAsync({id:"AppConnectionsViewModel.addOrUpdateConnection.noApi",message:AppMagic.Strings.ConnectionHubAddConnectionErrorDescription,title:AppMagic.Strings.ConnectionHubLoadingErrorTitle,details:Core.Utility.formatString("Cannot add connection for the API: {0}. Please make sure it exists and you have access to it.",r)})},t.prototype.testConnectionAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n;return __generator(this,(function(r){switch(r.label){case 0:t=e.availableConnections[e.selected],r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this._connectionService.testConnectionAsync(t)];case 2:return r.sent(),[3,4];case 3:throw n=r.sent(),this._connectionService.deleteConnectionAsync(t.id,t.apiId),Core.UI.Popups.showErrorDialogAsync({id:"AppConnectionsViewModel.testConnectionAsync",message:AppMagic.Strings.ConnectionHubAddConnectionErrorDescription,title:AppMagic.Strings.ConnectionHubLoadingErrorTitle,details:Core.DiagnosticError.tryGetDiagnosticMessage(n)}),e.availableConnections=e.availableConnections.filter((function(e){return e.id!=t.id})),e.selected=e.availableConnections.length>0?0:-1,this.refreshSetUpStatus(),n;case 4:return[2]}}))}))},t.prototype.saveConnectionsAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n,o,i,a;return __generator(this,(function(s){switch(s.label){case 0:if(this._saving(!0),t=e?[e]:this._connectionsInfo,Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appConnectionsSaveStarted),0===(t=t.filter((function(e){return e.needsSaving}))).length)return Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appConnectionsSaveSkipped),this._saving(!1),[2,Promise.resolve(!1)];n=t.map((function(e){var t={connection:e.availableConnections[e.selected],localConnectionId:e.dataSourceName,apiId:e.reference.id,actions:e.reference.appActions};if(e.selectedDataset){var n=HashTableUtility.create();n[e.datasetRefId]=e.selectedDataset.name,t.datasetOverrides=n}return t})),o=!1,i=new AppMagic.PowerApps.DisambiguationResultProcessor(this._powerAppsService.connectionUsageManager,this._powerAppsClient),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,i.saveDisambiguationResultsAndUpdateRuntimeAsync(n,AppMagic.PowerApps.ScopeConsentType.userConsent,this._appName)];case 2:return s.sent(),t.forEach((function(e){e.needsSaving=!1,e.reference.unauthenticatedConnection=null})),o=!0,Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appConnectionsSaveCompleted),Core.Environment.isWebPlayer()&&window.webPlayerServerConfig.IsConsentOnly&&n&&this._powerAppsClient instanceof r.PlayerPublishedClient&&this._powerAppsClient.updateConnectionsForConsentService(n),[3,4];case 3:return a=s.sent(),Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appConnectionsSaveError,{error:Core.PromiseUtils.formatError(a)}),Core.UI.Popups.showErrorDialogAsync({id:"AppConnectionsViewModel.saveConnectionsAsync.error",message:Player.Strings.PermissionsCantSave,title:Player.Strings.Error}),[3,4];case 4:return this._saving(!1),[2,o]}}))}))},t.prototype.reauthenticateConnectionAsync=function(e,t){return AppMagic.Runtime.Client.ConnectionOperations.getConnectionConsentAsync(this._connectionService,e,t)},t.prototype.getCapabilityFriendlyName=function(e){var t=i.g[e];return t?t():e},t.prototype.getImageUriFromCssUrl=function(e){var t=/url\(([^[)]*)\)/i.exec(e);return t&&t.length>1&&t[1]&&(e=t[1]),window.ResourceLoader.mapResourceUrl(window.document,e)},t.prototype.refreshSetUpStatus=function(){var e=this._connectionsInfo.every((function(e){return e.isSetupComplete()}));this._allConnectionsSetUp(e)},t.prototype.getDatasetsAsync=function(e){var t=e.availableConnections[e.selected];return this._powerAppsClient.getApiManagerAsync(t.apiId).then((function(e){return e.createDatasetsService(t.name)})).then((function(e){return e.getDatasetsAsync()}))},t.prototype.launchShareRequestEmail=function(e){var t=AppMagic.PowerApps.ShareRequestEmailGenerator.generate(this._authorEmail,this._appName,this._displayName,e.reference.sharedConnectionId,e.reference.displayName,this._environment);Core.UI.Utility.launchInBrowser(t),Core.Telemetry.Log.trackUIActivityEvent(Core.Telemetry.OperationNames.appConnectionsShareRequestClicked,{connectionId:e.reference.id})},t.prototype.isUserOwner=function(){return this._authorEmail&&this._authorEmail.toLowerCase()===this._userService.userProfile.email.toLowerCase()},t.prototype._handleCreatedConnection=function(e,t,n){var r=this;this._currentDialog&&this._currentDialog.isOpen&&this._currentDialog.close(),this._appResources.connections.push(e),this.updateConnectionsInfoAsync(Core.FallbackSwitch.isActivated("AppConnectivity.SkipLaunchAppInConsentDialog"),Core.Environment.isWebAuthoring()).then((function(){if(e){Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appConnectionsAddCompleted,{apiName:n});var o=r._findSelectedConnectionIndex(t.availableConnections,[e]),i=t.selectConnectionAsync(o);return Core.Telemetry.Log.trackActivityEvent("PlayerLifecycle.LoadConnections.ShowConsentDialog.ConnectionCreated",{selectedConnectionId:t.availableConnections[o].id,apiId:t.api.id,remainingConnections:r.connectionsInfo.filter((function(e){e.isSetupComplete()})).length}),i}Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appConnectionsAddCanceled,{apiName:n})})).then((function(){r._backToSelectingAndDisposeCurrentObjects(t)}),(function(e){Core.Log.error("AppConnectionsViewModel._handleCreatedConnection",e),r._backToSelectingAndDisposeCurrentObjects(t)}))},t.prototype._handleUpdatedConnection=function(e,t,n){var r,o=this;this._currentDialog&&this._currentDialog.isOpen&&this._currentDialog.close();var i=this._appResources.connections.findIndex((function(t){return t.name===e.name}));if(-1!==i){this._appResources.connections[i]=e;var a=null===(r=this.connectionsInfo)||void 0===r?void 0:r.findIndex((function(t){var n,r;return(null===(r=null===(n=null==t?void 0:t.reference)||void 0===n?void 0:n.unauthenticatedConnection)||void 0===r?void 0:r.name)===e.name}));if(e.isAuthenticated&&!Core.Utility.isNullOrUndefined(a)&&a>-1)delete this.connectionsInfo[a].reference.unauthenticatedConnection;this.updateConnectionsInfoAsync(!0,Core.Environment.isWebAuthoring()).then((function(){if(e){Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appConnectionsUpdateCompleted,{apiName:n});var r=o._findSelectedConnectionIndex(t.availableConnections,[e]);return t.selectConnectionAsync(r)}Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appConnectionsUpdateCanceled,{apiName:n})})).then((function(){o._backToSelectingAndDisposeCurrentObjects(t)}),(function(e){Core.Log.error("AppConnectionsViewModel._handleUpdatedConnection",e),o._backToSelectingAndDisposeCurrentObjects(t)}))}else Core.Log.error("AppConnectionsViewModel._handleUpdatedConnection","Connection with name ".concat(e.name," missing in the connections list."))},t.prototype._backToSelectingAndDisposeCurrentObjects=function(e){this._saving(!1),e.addingConnection=!1,this._currentDialog&&(this._currentDialog.isOpen&&this._currentDialog.close(),this._currentDialog.dispose()),this._currentAddConnectionViewModel&&(this._currentAddConnectionViewModel.dispose(),this._currentAddConnectionViewModel=null),this._addConnectionPromise&&(Core.PromiseUtils.abortPromise(this._addConnectionPromise,this._addConnectionAbortController),this._addConnectionPromise=null,this._addConnectionAbortController=null)},t.prototype._findSelectedConnectionIndex=function(e,t){var n=this._disableAutoSelect?-1:0;if(t.length>0)for(var r=0;r<e.length;r++)if(Core.Utility.equalsIgnoreCase(t[0].id,e[r].id)){n=r,!0;break}return n},t.prototype._connectionMatchesReference=function(e,t){if(t.sharedConnectionId)return e.id===t.sharedConnectionId;var n=e.apiId===t.id;return n?e.isOnPremise===!!t.isOnPremiseConnection:n},t.prototype._compareConnections=function(e,t,n){var r=e.sharedConnectionId;if(r){if(r===t.id)return-1;if(r===n.id)return 1}var o=e.gatewayObjectIdHint;if(o){var i=AppMagic.ConnectionHub.PowerAppsConnectionService.tryGetGatewayObjectId(t)===o,a=AppMagic.ConnectionHub.PowerAppsConnectionService.tryGetGatewayObjectId(n)===o;if(i&&!a)return-1;if(a&&!i)return 1}return t.displayName&&n.displayName?t.displayName.localeCompare(n.displayName):t.id.localeCompare(n.id)},t.prototype.isUnifiedApp=function(){var e;return Core.Utility.equalsIgnoreCase(null===(e=this._appResources.appInfo)||void 0===e?void 0:e.appType,"UnifiedApp")},t}(Core.Disposable)},function(e,t,n){"use strict";function r(e){o.display(e)}n.r(t),n.d(t,"display",(function(){return r})),n.d(t,"WebPlayerBanner",(function(){return o}));var o=function(e){function t(t){var n=e.call(this,t)||this;return n._message=t.message,n._title=t.title?t.title:"",n._onButtonClick=t.onButtonClick,n._buttonText=t.buttonText,n._additionalText=t.additionalText,n._setDialogRootRef=n._setDialogRootRef.bind(n),n}return __extends(t,e),t.prototype.render=function(){return React.createElement("div",{className:aphrodite.css(i.container)},React.createElement("div",{ref:this._setDialogRootRef,className:aphrodite.css(i.messageContainer),role:"dialog","aria-label":this._message},React.createElement("div",{className:aphrodite.css(i.titleText)},this._title),React.createElement("div",{className:aphrodite.css(i.messageText)},this._message),this._additionalText&&React.createElement("div",{className:aphrodite.css(i.messageText)},this._additionalText),React.createElement("div",{className:aphrodite.css(i.buttonContainer)},this._onButtonClick&&this._buttonText&&React.createElement("button",{id:"banner-optional-btn",className:a+" btn btn-default",onClick:this._onButtonClick},this._buttonText),React.createElement("button",{id:"close-banner",className:aphrodite.css(i.baseButton)+" btn btn-default",onClick:this._close,"data-appmagic-initialfocus":"true"},Player.Strings.AriaLabelClose))))},t.prototype.componentDidMount=function(){var e=this;this._focusRetainer=new Core.UI.Utility.FocusRetainer(this._dialogRoot),setTimeout((function(){return e._focusRetainer.on()}))},t.prototype.componentWillUnmount=function(){this._focusRetainer.off(),this._focusRetainer.dispose()},t.prototype._setDialogRootRef=function(e){this._dialogRoot=e},t.prototype._close=function(){t._containerElement&&(ReactDOM.unmountComponentAtNode(t._containerElement),document.body.removeChild(t._containerElement),t._containerElement=null)},t.display=function(e){t._containerElement=document.createElement("div"),ReactDOM.render(React.createElement(t,__assign({},e)),t._containerElement),document.body.appendChild(t._containerElement)},t.preventDisplay=!1,t}(React.Component),i=aphrodite.StyleSheet.create({container:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.75)",transition:"opacity 0.5s ease-in",display:"flex",flexDirection:"column",justifyContent:"center",zIndex:5e3},titleText:{marginTop:"36px",marginBottom:"6px",textAlign:"center",fontSize:"24px"},messageContainer:{backgroundColor:"white"},messageText:{marginTop:"12px",marginLeft:"6px",marginRight:"6px",textAlign:"center",fontSize:"18px",whiteSpace:"pre-wrap"},buttonContainer:{textAlign:"center",marginTop:"36px",marginBottom:"36px"},optionalButton:{marginRight:"18px"},baseButton:{display:"inline-block",marginLeft:"auto",marginRight:"auto",backgroundColor:"rgb(0, 120, 215)",color:"white",width:"150px"}}),a=aphrodite.css(i.baseButton,i.optionalButton)},function(e,t,n){"use strict";n.r(t),n.d(t,"WebPlayerShell",(function(){return s}));var r=n(30),o=n(31),i=n(23),a=n(9),s=function(e){function t(t){var n=e.call(this,t)||this;return n._refs={},n._disposeCallbacks=[],n.state={splashScreenProps:null,unsupportedControls:null},n._activatePlayerWithoutFocus=n._activatePlayer.bind(n,!1),n._activatePlayer=n._activatePlayer.bind(n,!0),n._renderShellStage=n._renderShellStage.bind(n),n._renderSkipLink=n._renderSkipLink.bind(n),n._renderShellContentAfterHeader=n._renderShellContentAfterHeader.bind(n),n}return __extends(t,e),t.prototype.componentWillMount=function(){this._onWebPlayerShellCreated()},t.prototype.componentWillUnmount=function(){this._disposeCallbacks.forEach((function(e){return e()})),this._disposeCallbacks=[]},t.prototype.render=function(){var e=this._showAppSplashScreen;return React.createElement("div",null,this._renderShellStage("stageBeforeHeader",this._renderSkipLink),this._renderShellStage("stageAfterHeader",this._renderShellContentAfterHeader),e&&React.createElement(o.WebPlayerSplashScreen,__assign({},this.state.splashScreenProps)),React.createElement(r.HostContextMenu,{activatePlayer:this.state.activatePlayer}))},t.prototype._renderShellStage=function(e,t){var n=this.state.stageLayoutStylesheet;return React.createElement("div",{ref:this._createSetRefForKey(e),className:aphrodite.css(l.borderBox,l.stage,n&&n.stageOverrides)},React.createElement("div",{className:aphrodite.css(l.borderBox,l.stageBoundary)},t()))},t.prototype._renderShellContentAfterHeader=function(){var e=this;return this.state.unsupportedControls&&React.createElement(i.WebPlayerWarningBanner,{unsupportedControls:this.state.unsupportedControls,dismissBanner:function(){var t=Object.assign({},e.state,{unsupportedControls:null});e.setState(t),e._hideHost()}})},t.prototype._renderSkipLink=function(){if(this.props.showSkipToMainContentLink)return React.createElement("button",{onClick:this._activatePlayer,className:aphrodite.css(l.borderBox,l.skipLinkContainer)},Player.Strings.A11ySkipToMainContent)},t.prototype._onWebPlayerShellCreated=function(){var e=this;this.props.onWebPlayerShellCreated({showAppSplashScreen:function(t){var n=Object.assign({},e.state,{splashScreenProps:t});e.setState(n)},hideAppSplashScreen:function(){if(e.state.splashScreenProps&&e.state.splashScreenProps.showGettingDataString){Core.PerformanceTracker.trackPerfEndEvent("webPlayerDisplayGettingDataOnSplashScreen");var t=Core.PerformanceTracker.getPerfDataForTask("webPlayerDisplayGettingDataOnSplashScreen");Core.Telemetry.Log.updateOpenAppData({timeFromFirstOnStartDataCall:t.end-t.start})}var n=Object.assign({},e.state,{splashScreenProps:null});e.setState(n,(function(){e._activatePlayerWithoutFocus()}))},isAppSplashScreenVisible:function(){return e._showAppSplashScreen},showWarningBanner:function(t){e.setState({unsupportedControls:t})},toggleGettingDataString:function(t){var n=Object.assign({},e.state,{splashScreenProps:__assign(__assign({},e.state.splashScreenProps),{showGettingDataString:t})});e.setState(n)},updateShellLayout:function(){e._updateShellLayout()}})},Object.defineProperty(t.prototype,"_showAppSplashScreen",{get:function(){return!(!this.state.splashScreenProps||Core.Environment.shouldHideAppSplashScreen())},enumerable:!1,configurable:!0}),t.prototype._hideHost=function(){Core.Environment.isPublishedAppExternalToHost()&&Core.Loader.ObjectFactory.instance.getSingleton(Core.Player.IHostMessageProviderSingletonKey).resizeHost(0,"banner")},t.prototype._createSetRefForKey=function(e){return this._setRef.bind(this,e)},t.prototype._setRef=function(e,t){this._refs[e]=t},t.prototype._activatePlayer=function(e){void 0===e&&(e=!0);var t=this.props.getIframeElement();t&&(t.setAttribute("aria-hidden","false"),e?t.focus():t===document.activeElement&&document.activeElement.blur())},t.prototype._updateShellLayout=function(){var e=(new a.ShellHeaderManager).getShellHeader();if(e){var t=e.getHeight(),n="".concat(t,"px"),r="".concat(n," !important"),o="calc(100vh - ".concat(n,") !important");this.state.stageLayoutStylesheet&&this.state.stageLayoutStylesheet.stageOverrides.top===r&&this.state.stageLayoutStylesheet.stageOverrides.height===o||this.setState({stageLayoutStylesheet:aphrodite.StyleSheet.create({stageOverrides:{top:r,height:o}})})}},t}(React.Component),l=aphrodite.StyleSheet.create({playerShell:{width:"100vw",height:"100vh",position:"absolute",top:"0px",left:"0px",zIndex:3e3,overflow:"hidden",display:"flex",flexDirection:"column"},invisible:{display:"none"},stage:{position:"absolute",top:"0",width:"100vw",height:"100vh"},stageBoundary:{position:"relative",width:"100%",height:"100%"},skipLinkContainer:{position:"absolute",top:"10px",left:"10px",zIndex:-1,border:"none",padding:"5px",color:"#000",backgroundColor:"#fff",boxShadow:"0 3px 3px 0 rgba(0,0,0,.5)",fontSize:"12px","@media print":{display:"none"},":focus":{zIndex:3001}},focusWithin:{transform:"none"},borderBox:{boxSizing:"border-box"}})},function(e,t,n){"use strict";n.r(t),n.d(t,"AppPermissionsDialog",(function(){return i})),n.d(t,"createAppPermissionsDialog",(function(){return s})),n.d(t,"_setAppPermissionsDialogFactory",(function(){return l}));var r=n(57),o=n(3),i=function(e){function t(t){var n=this,i=new r.AppPermissionsDialogViewModel(t);(n=e.call(this,i)||this)._dialogViewModel=i,n._showHostIframe(!0),n.track("_enableLaunchButton",ko.pureComputed((function(){return n._dialogViewModel.appConnections.allConnectionsSetUpObservable()&&!n._dialogViewModel.appConnections.saving}))),n._enableCancelButton=ko.observable(!0),n._enableDontChangeButton=ko.observable(!0),n.track("_hideDontChangeButton",ko.pureComputed((function(){return!n._dialogViewModel.appConnections.showSelectionListObservable()})));var a=function(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=null),n._showHostIframe(!1);var o=Core.Telemetry.Log.getOpenAppDataProperties(),i=window.webPlayerServerConfig&&window.webPlayerServerConfig.IsConsentOnly&&0!==o.connectionDisambiguationTimeSpent?o.connectionDisambiguationTimeSpent:Core.PerformanceTracker.exitScopeAndGetRunTime(Core.Telemetry.Strings.userTimeSpentOnAppPermissionsDialog);t&&Core.Telemetry.Log.updateOpenAppData({connectionDisambiguationTimeSpent:i,connectionDisambiguationEnd:Date.now()});var a={elapsedTime:i};r&&(a=Object.assign(a,{error:r})),Core.Telemetry.Log.trackEvent(e,a)};return n._approveButtonTitle=t.approveButtonTitle||Player.Strings.PermissionsButtonLaunch,n._dialogViewModel.buttons.push(new Core.UI.Popups.DialogButtonViewModel(n._approveButtonTitle,(function(){return __awaiter(n,void 0,void 0,(function(){var e,t,n=this;return __generator(this,(function(r){switch(r.label){case 0:this._enableCancelButton(!1),r.label=1;case 1:return r.trys.push([1,5,,6]),[4,this._dialogViewModel.appConnections.saveConnectionsAsync()];case 2:return r.sent(),(e=this._dialogViewModel.appConnections.connectionsInfo.filter((function(e){return e.availableConnections[e.selected].isTestConnectionRequiredAfterConsent}))).length>0?(Core.Telemetry.Log.trackActivityEvent("PowerAppsClient.AppPermissionsDialog.approveButton",{mobilePlayerFlavor:Core.Environment.getMobilePlayerFlavor(),numberOfConnectionsToTest:e.length}),[4,Core.PromiseUtils.join(e.map((function(e){return n._dialogViewModel.appConnections.testConnectionAsync(e)})))]):[3,4];case 3:r.sent(),r.label=4;case 4:return[3,6];case 5:return t=r.sent(),Core.Utility.isCanceledError(t)||a(Core.Telemetry.Strings.appPermissionsDialogClosedError,!1,Core.PromiseUtils.formatError(t)),this._enableCancelButton(!0),[2];case 6:return this.close(this._approveButtonTitle),a(Core.Telemetry.Strings.appPermissionsDialogClosedComplete,!0),[2]}}))}))}),null,n._enableLaunchButton,n._dialogViewModel.appConnections.showSelectionListObservable)),n._disapproveButtonTitle=Player.Strings.PermissionsButtonCancel,n._dialogViewModel.buttons.push(new Core.UI.Popups.DialogButtonViewModel(n._disapproveButtonTitle,(function(){n.close(n._disapproveButtonTitle),a(Core.Telemetry.Strings.appPermissionsDialogClosedCanceled)}),null,n._enableCancelButton,n._dialogViewModel.appConnections.showSelectionListObservable)),n._dialogViewModel.buttons.push(new Core.UI.Popups.DialogButtonViewModel(Player.Strings.PermissionsButtonDontChange,(function(){n._dialogViewModel.appConnections.selectedConnection=null,a(Core.Telemetry.Strings.appPermissionsDialogChangeCanceled)}),null,n._enableDontChangeButton,n._hideDontChangeButton)),Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appPermissionsDialogOpened),Core.Telemetry.Log.updateOpenAppData({connectionDisambiguationStart:Date.now()}),Core.PerformanceTracker.enterScope(Core.Telemetry.Strings.userTimeSpentOnAppPermissionsDialog),Core.Environment.isWebPlayer()&&(o.WebPlayerRuntime.onInteractionRequired({source:"AppPermissionDialog",consentDialogLoadedTimestamp:Date.now()}),n._timeOutTrackHeight=setTimeout((function(){Core.Telemetry.Log.trackActivityEvent("AppPermissionsDialog.display.height",{height:window.innerHeight})}),2e3),window.webPlayerServerConfig.IsConsentOnly&&Core.Telemetry.Log.openConsentDialogOnlyEndEvent()),n._addFocusStyleEventListenerOnTab.bind(n),n._removeFocusStyleOnClick.bind(n),n}return __extends(t,e),Object.defineProperty(t.prototype,"approveButtonTitle",{get:function(){return this._approveButtonTitle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disapproveButtonTitle",{get:function(){return this._disapproveButtonTitle},enumerable:!1,configurable:!0}),t.prototype.showAsync=function(){return document.addEventListener("keydown",this._addFocusStyleEventListenerOnTab),document.addEventListener("mousedown",this._removeFocusStyleOnClick),e.prototype.showAsync.call(this)},t.prototype.dispose=function(){document.removeEventListener("keydown",this._addFocusStyleEventListenerOnTab),document.removeEventListener("mousedown",this._removeFocusStyleOnClick),e.prototype.dispose.call(this)},t.prototype.close=function(t){this._removeFocusStyleOnClick(),this._timeOutTrackHeight&&clearTimeout(this._timeOutTrackHeight),e.prototype.close.call(this,t)},t.prototype._addFocusStyleEventListenerOnTab=function(e){e.key!==Core.UI.Constants.Keys.tab&&9!==(e.keyCode||e.which)||document.body.classList.add("show-focus-styles")},t.prototype._removeFocusStyleOnClick=function(){document.body.classList.remove("show-focus-styles")},t.prototype._showHostIframe=function(e){if(Core.Environment.isPublishedAppExternalToHost()){var t=Core.Loader.ObjectFactory.instance.getSingleton(Core.Player.IHostMessageProviderSingletonKey);e?t.resizeHost(!0,"host"):t.resizeHost(!1,"host")}},t}(Core.UI.Popups.Dialog),a=function(e){return new i(e)};function s(e){return a(e)}function l(e){a=e}},function(e,t,n){"use strict";n.r(t),n.d(t,"WebPlayerWarningBanner",(function(){return o}));var r=n(0),o=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.render=function(){var e=Player.Strings.WebplayerUnsupportedControlsWarningProblem.split("##LINK##");return React.createElement("div",{tabIndex:0,role:"status",id:t.warningBannerId,className:aphrodite.css(i.incompatWarningBanner)},React.createElement("div",{className:aphrodite.css(i.warningMessage)},e[0],React.createElement("a",{href:r.K.UnsupportedControlsLearnMore,target:"_blank",rel:"noreferrer"},e[1]),e[2]),React.createElement("button",{"aria-label":AppMagic.Strings.Close,className:aphrodite.css(i.dismissIcon),onClick:this.props.dismissBanner}))},t.warningBannerId="incompat-warning-banner",t}(React.Component),i=aphrodite.StyleSheet.create({incompatWarningBanner:{position:"fixed",display:"flex",backgroundColor:"#FFF9AE",width:"100%",flexDirection:"row",paddingTop:"5px",paddingBottom:"5px",zIndex:1},dismissIcon:{backgroundImage:'url("/webplayer/Components/WebPlayerShell/dismiss.svg")',marginLeft:"auto",marginRight:"32px",marginTop:"auto",marginBottom:"auto",width:"32px",height:"32px",backgroundRepeat:"no-repeat",backgroundColor:"transparent",border:0},warningMessage:{display:"flex",flexDirection:"column",flexBasis:"100%",marginLeft:"10px"}})},function(e,t,n){"use strict";function r(e,t){var n;if(!function(e){var t;return e&&e.api===WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.GetPreloadConsentServiceData&&e.data&&(e.data.appResources&&e.data.appResources.appInfoInRawJson&&e.data.appResources.apisInRawJson&&e.data.appResources.connectionsMappingInRawJson&&e.data.appResources.connectionsUsageMappingInRawJson||(null===(t=e.data.appResources)||void 0===t?void 0:t.appMetadataRawJson)||e.data.appMetadata)}(e))return Core.Log.errorEx("PowerAppsClient.ConsentServiceError","Invalid WebPlayer Sdk payload passed to completeGetAppResourcesPromise()"),t.error("Invalid WebPlayer Sdk payload passed to completeGetAppResourcesPromise()");try{var r=e.data.appMetadata?AppMagic.Runtime.Client.CacheableAppResources.parse(e.data.appMetadata):function(e){if(e.appMetadataRawJson)try{return AppMagic.Runtime.Client.CacheableAppResources.parse(e.appMetadataRawJson)}catch(e){Core.Log.errorEx("PowerAppsClient.ConsentServiceError",{error:e,message:"Failed to parse appMetadataRawJson."})}var t=e.apisInRawJson.map((function(e){return AppMagic.ConnectionHub.Api.deserialize(e)})),n=HashTableUtility.fromJsonObject(e.connectionsMappingInRawJson),r=[],o=!0;if(t.forEach((function(e){var t=n[e.id];t&&t.forEach((function(t){var n=AppMagic.ConnectionHub.Connection.deserialize(t,e);n?r.push(n):o=!1}))})),!o)throw Core.Log.errorEx("PowerAppsClient.ConsentServiceError","Failed to parse connection(s)."),new Error("Failed to parse connection(s).");var i=HashTableUtility.fromJsonObject(e.connectionsUsageMappingInRawJson),a=HashTableUtility.map(i,(function(e,t){return AppMagic.ConnectionHub.UserConnectionForApp.deserialize(e)}));return new AppMagic.Runtime.Client.AppResources(AppMagic.PowerApps.AppInfo.deserialize(e.appInfoInRawJson),t,r,a)}(e.data.appResources);t.complete(r),Core.Telemetry.Log.trackActivityEvent("PowerAppsClient.completeGetAppResourcesPromise",{hasAppMetadata:!!e.data.appMetadata,hasAppResources:!!e.data.appResources,hasAppMetadataRawJson:!!(null===(n=e.data.appResources)||void 0===n?void 0:n.appMetadataRawJson)})}catch(e){Core.Log.errorEx("PowerAppsClient.ConsentServiceError",{error:e,message:"Failed to parse connection(s)."}),t.error((null==e?void 0:e.message)||"Failed to parse app resources.")}}function o(e){var t=e.appInfo.serializeToJson(),n=function(e){var t=HashTableUtility.create();return e.connections.forEach((function(e){t[e.apiId]||(t[e.apiId]=[]),t[e.apiId].push(e.serializeToJson())})),t}(e),r=HashTableUtility.map(e.connectionUsages,(function(e,t){return AppMagic.ConnectionHub.UserConnectionForApp.serializeToJson(e)}),!0);return{appInfoInRawJson:t,apisInRawJson:e.apis.map((function(e){return e.serializeToJson()})),connectionsMappingInRawJson:HashTableUtility.toJsonHashTable(n),connectionsUsageMappingInRawJson:r}}n.r(t),n.d(t,"completeGetAppResourcesPromise",(function(){return r})),n.d(t,"serializeAppResources",(function(){return o}))},function(e,t,n){"use strict";n.r(t),n.d(t,"SharedAppHostErrorParser",(function(){return o}));var r=n(1),o=function(){function e(){}return e.parseSharedAppHostError=function(t,n,o){var i=r.WebPlayerErrorType[t],a=this._errorDictionary[i];return a?__assign(__assign({},a),{localizedMessage:o||e._getLocalizedErrorMessage(t),message:n}):{source:this._errorDictionary.Unknown.source,code:this._errorDictionary.Unknown.code}},e._getLocalizedErrorMessage=function(e){var t;switch(e){case r.WebPlayerErrorType.AppApiVersionNewer:case r.WebPlayerErrorType.AppApiVersionOlder:t=Player.Strings.WebPlayerErrorAppApiVersionMismatch;break;case r.WebPlayerErrorType.RunAppFailure:t=Player.Strings.WebPlayerErrorRunAppFailure;break;case r.WebPlayerErrorType.Unknown:t=Player.Strings.WebPlayerErrorUnknown;break;case r.WebPlayerErrorType.GetAppFailure:t=Player.Strings.WebPlayerErrorGetAppFailure;break;case r.WebPlayerErrorType.GetAppForbidden:t=Player.Strings.WebPlayer403ErrorText;break;case r.WebPlayerErrorType.GetAppNotFound:t=Player.Strings.WebPlayerErrorGetAppNotFound;break;case r.WebPlayerErrorType.InvalidParameter:t=AppMagic.Strings.SharedAppHostInternalError;break;case r.WebPlayerErrorType.UserNotLoggedIn:t=AppMagic.Strings.SignIn_SignInFailed;break;default:t=Player.Strings.Error}return t},e._errorDictionary={InvalidParameter:{source:"sharedAppHost",code:"InternalError"},GetAppNotFound:{source:"sharedAppHost",code:"AppNotFound"},GetAppForbidden:{source:"sharedAppHost",code:"AppForbidden"},GetAppFailure:{source:"sharedAppHost",code:"AppFetchedFailure"},UserNotLoggedIn:{source:"sharedAppHost",code:"UserNotLoggedIn"},RunAppFailure:{source:"canvasApp",code:"AppExecutionFailure"},AppApiVersionNewer:{source:"canvasApp",code:"AppCompatibilityError"},AppApiVersionOlder:{source:"canvasApp",code:"AppCompatibilityError"},Unknown:{source:"unknown",code:"UnknownError"}},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"WebPlayerSessionDetailsDialog",(function(){return o}));var r=n(3);var o=function(e){function t(t){var n=e.call(this,function(e){return e?e+" "+AppMagic.Strings.LinkTitle_SessionDetails:AppMagic.Strings.LinkTitle_SessionDetails}(r.WebPlayerRuntime.getAppTitle()),"",function(){var e=[];return e.push("".concat(AppMagic.Strings.MessageDialogDetailsSessionIdTitle," ").concat(Core.Telemetry.Log.sessionId)),e.push("".concat(AppMagic.Strings.PowerApps," ").concat(Core.Environment.Version.VERSION_NUMBER)),e.join("\n")}(),AppMagic.Strings.Close,(function(){n.close()}))||this;return n._onCloseCallBack=t,n._showFocusBorderStylesClassName="show-focus-styles",n._addFocusStyleEventListenerOnTab=function(e){e.key!==Core.UI.Constants.Keys.tab&&9!==(e.keyCode||e.which)||document.body.classList.add(n._showFocusBorderStylesClassName)},n._removeFocusStyleOnClick=function(){document.body.classList.remove(n._showFocusBorderStylesClassName)},n}return __extends(t,e),t.prototype.showAsync=function(){return document.addEventListener("keydown",this._addFocusStyleEventListenerOnTab),document.addEventListener("mousedown",this._removeFocusStyleOnClick),e.prototype.showAsync.call(this)},t.prototype.dispose=function(){document.removeEventListener("keydown",this._addFocusStyleEventListenerOnTab),document.removeEventListener("mousedown",this._removeFocusStyleOnClick),e.prototype.dispose.call(this)},t.prototype.close=function(){document.body.classList.remove(this._showFocusBorderStylesClassName),e.prototype.close.call(this),this._onCloseCallBack&&this._onCloseCallBack()},t}(Core.UI.Popups.TextAreaDialog)},function(e,t,n){"use strict";n.r(t),n.d(t,"display",(function(){return o}));var r=n(20);function o(){var e=AppMagic.Strings.DisablePopUpBlockersMessage,t=null,n=null,o=null,i=null,a=Core.Environment.getBrowserId()===Core.Environment.BrowserId.InternetExplorer||Core.Environment.getBrowserId()===Core.Environment.BrowserId.MicrosoftEdge;if(a)try{var s=new Core.Url(window.location.href).host,l=new Core.Url(window.document.referrer).host;""!==s&&""!==l&&s!==l&&(e=Core.Utility.formatString(AppMagic.Strings.EdgeDisablePopUpBlockersMessage,s,l)),i=AppMagic.Strings.NewWindowPrompt,n=AppMagic.Strings.OpenInNewTab,t=Core.Environment.getFullPageWebPlayerUrl(window.location.href),o=function(){window.open(t)}}catch(e){Core.Telemetry.Log.trackErrorEvent("WebPlayerPopupBanner.display.catch",{frameHref:window.location.href,referrerHref:window.document.referrer,error:e.toString()})}Core.Telemetry.Log.trackErrorEvent("WebPlayerPopupBanner.display",{isIEOrEdge:a}),r.display({message:e,title:AppMagic.Strings.DisablePopUpBlockersTitle,buttonText:n,onButtonClick:o,additionalText:i})}},function(e,t,n){"use strict";n.r(t),n.d(t,"WebPlayerSessionManager",(function(){return a}));var r=n(1),o=n(10),i=n(25),a=function(){function e(t,n,r,o,i,a,s,l){var p=this;this._appDisplayName=t,this._appHostRuntime=n,this._handleUpdateAppMetadataCookie=this._handleUpdateAppMetadataCookie.bind(this),this._handleSessionExpiry=this._handleSessionExpiry.bind(this),this._handleUpdateOrgSettingsCookie=this._handleUpdateOrgSettingsCookie.bind(this),this._resource=o,s&&s<e._defaultMaxSessionExpiryInMilliseconds&&(s=e._defaultMaxSessionExpiryInMilliseconds),s&&setTimeout(this._handleSessionExpiry,s),Core.Telemetry.Log.trackActivityEvent("WebPlayerSessionManager.constructor",{maxSessionExpiryInMilliseconds:s}),!1===r&&o&&(this._authPlugin=null!=a?a:Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.Client.ComponentKeys.ClientAuthenticationRuntime).azureAuthenticationManager.getProviderForResourceUrl(this._resource,!0),i=null!=i?i:Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.Client.ComponentKeys.HttpClient),this._sessionClient=new AppMagic.Runtime.Client.Adal.WebPlayerAuthSessionClient(i,null,!0),this._handleUpdateOrgSettingsCookie(l),setInterval((function(){return p._handleUpdateAppMetadataCookie()}),e._updateAppMetadataCookieIntervalInMilliseconds))}return e.prototype._handleUpdateAppMetadataCookie=function(){return __awaiter(this,void 0,Promise,(function(){var t;return __generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),[4,this._authPlugin.authenticateSilentAsync()];case 1:return n.sent(),null==(t=this._authPlugin.store)?[3,3]:[4,this._sessionClient.extendSessionAsync(t.accessToken,window.location.pathname)];case 2:n.sent(),Core.Telemetry.Log.trackActivityEvent("".concat(e._operationName,"._handleUpdateAppMetadataCookie"),{succeeded:"true"}),n.label=3;case 3:return[3,5];case 4:return n.sent(),Core.Telemetry.Log.trackActivityEvent("".concat(e._operationName,"._handleUpdateAppMetadataCookie"),{succeeded:"false"}),[3,5];case 5:return[2]}}))}))},e.prototype._handleUpdateOrgSettingsCookie=function(t){return __awaiter(this,void 0,Promise,(function(){var n;return __generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this._authPlugin.authenticateSilentAsync()];case 1:return r.sent(),null!=(n=this._authPlugin.store)&&(this._sessionClient.updateOrgSettingCacheAsync(n.accessToken,t),Core.Telemetry.Log.trackActivityEvent("".concat(e._operationName,"._handleUpdateOrgSettingsCookie"),{succeeded:"true"})),[3,3];case 2:return r.sent(),Core.Telemetry.Log.trackActivityEvent("".concat(e._operationName,"._handleUpdateOrgSettingsCookie"),{succeeded:"false"}),[3,3];case 3:return[2]}}))}))},e.prototype._handleSessionExpiry=function(){var e,t;if(null===(e=Core.Telemetry.Log.providerInstance)||void 0===e||e.setDefaultProperties({sessionExpired:"true"}),Core.Environment.isSkypeTeams())this._handleSessionExpiryInTeams();else if(Core.Environment.isSharedAppHost()){var n=i.SharedAppHostErrorParser.parseSharedAppHostError(r.WebPlayerErrorType.RunAppFailure,"Shared app host session timed out",Player.Strings.SharedAppHostSessionEndedText);null===(t=this._appHostRuntime)||void 0===t||t.postMessageToHost("sendError",{info:0,parameterType:"error",error:n})}else Object(o.display)(this._appDisplayName)},e.prototype._handleSessionExpiryInTeams=function(){var t,n;Core.Telemetry.Log.trackActivityEvent("".concat(e._operationName,"._handleSessionExpiryInTeams")),Core.Telemetry.Log.flush(),window.Utilities.reloadWindowWithLogging(window,"WebPlayerSessionManager._handleSessionExpiryInTeams",null,null===(n=null===(t=Core.Telemetry)||void 0===t?void 0:t.Log)||void 0===n?void 0:n.sessionId,!0)},e._operationName="WebPlayerSessionManager",e._defaultMaxSessionExpiryInMilliseconds=288e5,e._updateAppMetadataCookieIntervalInMilliseconds=36e5,e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"AddPlayerConnectionViewModel",(function(){return r}));var r=function(e){function t(t,n,r,o,i,a,s,l){var p=e.call(this,t,n,r,o,i,{consentOptions:s,connectionName:l})||this;return p._gatewayObjectIdOverride=a,p.selectedDataLocation=p._getDefaultDataLocation(),p.reload(),p}return __extends(t,e),t.prototype._shouldBypassDataLocationSettings=function(){return!0},t.prototype._getDefaultDataLocation=function(){return this._gatewayObjectIdOverride?Core.Authoring.ConnectionHub.Gateway:e.prototype._getDefaultDataLocation.call(this)},t.prototype._getGatewayObjectId=function(){return this._gatewayObjectIdOverride?this._gatewayObjectIdOverride:e.prototype._getGatewayObjectId.call(this)},t}(Core.Authoring.ConnectionHub.AddConnectionViewModel)},function(e,t,n){"use strict";n.r(t),n.d(t,"HostContextMenu",(function(){return o}));var r=n(26),o=function(e){function t(t){var n=e.call(this,t)||this;return n._disposeCallbacks=[],n._awaitingUserAction=!1,n.state={showContextMenu:!1,focusWithin:!1,withTransition:!0},n.setContextMenuRef=n.setContextMenuRef.bind(n),n.showContextMenu=n.showContextMenu.bind(n),n.hideContextMenu=n.hideContextMenu.bind(n),n.showSessionDetails=n.showSessionDetails.bind(n),n._portalElement=document.createElement("div"),document.body.appendChild(n._portalElement),n}return __extends(t,e),t.prototype.componentDidMount=function(){var e=this;this._hostContextMenuEventDescriptors=new Player.Client.Components.HostContextMenuEventDescriptors({showRequested:this.showContextMenu,hideRequested:this.hideContextMenu}),this._disposeCallbacks.push((function(){var t;null===(t=e._sessionDetailsDialog)||void 0===t||t.close()})),this._disposeCallbacks.push(this.addEventListeners(this._contextMenu,"click",(function(t){e.hideContextMenu()}))),this._disposeCallbacks.push(this.addEventListeners(window,"message",(function(t){var n=t.data,r=n.messageType,o=n.payload;"showContextMenu"===r?e.showContextMenu(o):"hideContextMenu"===r&&e.hideContextMenu()})))},t.prototype.render=function(){var e=React.createElement("ul",{ref:this.setContextMenuRef,id:t.RootElementId,className:aphrodite.css(i.borderBox,i.hostContextMenuContainer,!this.state.showContextMenu&&i.closed,this.state.focusWithin&&i.focusWithin,this.state.withTransition&&i.withTransition),style:{top:this.state.top,left:this.state.left}},React.createElement("li",{className:aphrodite.css(i.borderBox)},React.createElement("button",{className:aphrodite.css(i.borderBox,i.button),onClick:this.showSessionDetails},AppMagic.Strings.LinkTitle_SessionDetails)));return ReactDOM.createPortal(e,this._portalElement)},t.prototype.componentWillUnmount=function(){this._disposeCallbacks.forEach((function(e){return e()})),this._disposeCallbacks=[],this._portalElement.parentElement.removeChild(this._portalElement),this._hostContextMenuEventDescriptors&&this._hostContextMenuEventDescriptors.dispose()},t.prototype.setContextMenuRef=function(e){this._contextMenu=e},t.prototype.addEventListeners=function(e,t,n){var r=t.split(" ").map((function(t){return e.addEventListener(t,n),function(){e.removeEventListener(t,n)}}));return function(){return r.forEach((function(e){return e()}))}},t.prototype.showContextMenu=function(e){var t=this;if(this._awaitingUserAction)return!1;var n=document.body,r=n.offsetWidth,o=n.offsetHeight;o=Math.max(o,window.innerHeight+window.scrollY);var i=this._contextMenu.getBoundingClientRect(),a=i.width,s=i.height,l=e.pageX,p=e.pageY;return r-l<a&&(l-=a),o-p<s&&(p-=s),this._showHost(!0),this.setState({showContextMenu:!0,top:"".concat(p,"px"),left:"".concat(l,"px"),withTransition:!1},(function(){t._contextMenu.focus()})),!0},t.prototype.hideContextMenu=function(e){var t=this;!this.state.showContextMenu||e&&"touchstart"===e.type&&this._contextMenu.contains(e.target)||(this.setState({showContextMenu:!1,top:null,left:null,focusWithin:!1},(function(){setTimeout((function(){t.setState({withTransition:!0})}),50)})),this._showHost(!1))},t.prototype.showSessionDetails=function(e){var t=this;this._sessionDetailsDialog=new r.WebPlayerSessionDetailsDialog((function(){t._showHost(!1),t.props.activatePlayer&&t.props.activatePlayer()})),this._awaitingUserAction=!0,this._sessionDetailsDialog.showAsync().then((function(){t._awaitingUserAction=!1})),e.nativeEvent.stopImmediatePropagation(),this._showHost(!0)},t.prototype._showHost=function(e){Core.Environment.isPublishedAppExternalToHost()&&Core.Loader.ObjectFactory.instance.getSingleton(Core.Player.IHostMessageProviderSingletonKey).resizeHost(e,"host")},t.RootElementId="AppHostContextMenu",t}(React.Component),i=aphrodite.StyleSheet.create({hostContextMenuContainer:{display:"block",position:"absolute",border:"none",listStyleType:"none",padding:0,margin:0,zIndex:9e3,color:"#000",backgroundColor:"#fff",boxShadow:"0 3px 3px 0 rgba(0,0,0,.5)",":nth-child(1n) > li:last-child > button":{borderBottomColor:"transparent"}},closed:{top:"25px",left:"25px",transform:"translate(0, -100%) translate(0, -50px)",display:"none"},withTransition:{transition:"transform .5s"},focusWithin:{transform:"none"},button:{padding:"8px 12px",backgroundColor:"transparent",cursor:"pointer",minHeight:"36px",lineHeight:1.3,textAlign:"left",border:"none",borderTop:"1px solid #eaeaea"},borderBox:{boxSizing:"border-box"}})},function(e,t,n){"use strict";n.r(t),n.d(t,"WebPlayerSplashScreen",(function(){return r}));var r=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.componentDidMount=function(){var e=this;this._splashscreenRef&&!Core.Environment.isIframed()&&setTimeout((function(){e._splashscreenRef&&e._splashscreenRef.focus()}))},t.prototype.render=function(){var e=this;return React.createElement("div",{tabIndex:-1,ref:function(t){return e._splashscreenRef=t},"aria-live":"polite",className:aphrodite.css(i.appSplashScreen),"aria-label":Player.Strings.AriaLabelAppSplashScreen,style:{backgroundColor:"white"}},React.createElement("img",{className:aphrodite.css(i.appIconNewTheme),"aria-label":Player.Strings.AriaLabelAppIcon,src:this.props.iconUrl,style:{backgroundColor:this.props.backgroundColor}}),React.createElement("p",{className:aphrodite.css(i.splashScreenTextNewTheme)},this.props.appName),React.createElement("div",{role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuetext":Player.Strings.AriaLabelAppLoading,className:aphrodite.css(i.dotAnimationContainer)},["0s","0.25s","0.50s","0.75s"].map((function(t){return React.createElement("div",{key:t,role:Core.UI.AriaRoles.Presentation,className:aphrodite.css(i.dotNewTheme),style:{animationDelay:t}},e._getDotSVG())}))),this.props.showGettingDataString&&React.createElement("p",{className:aphrodite.css(i.splashScreenText)},Player.Strings.GettingYourData))},t.prototype._getDotSVG=function(){return React.createElement("svg",{className:aphrodite.css(i.svg),xmlns:"http://www.w3.org/2000/svg"},React.createElement("symbol",{viewBox:"0 0 100 100"},React.createElement("circle",{fill:"#fff",r:"50",cy:"50",cx:"50"})))},t}(React.Component),o={"0%":{transform:"scale(0.5)"},"50%":{transform:"scale(1.5)"}},i=aphrodite.StyleSheet.create({appSplashScreen:{width:"100%",height:"100%",position:"absolute",top:"0px",left:"0px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",outline:"none",zIndex:1},appIcon:{height:"20vh",width:"auto",margin:"0 auto",display:"block"},appIconNewTheme:{height:"20vh",width:"auto",margin:"30px auto",display:"block"},splashScreenText:{fontSize:"16pt",color:"white"},splashScreenTextNewTheme:{fontSize:"16pt",color:"#242424"},dotAnimationContainer:{display:"flex",margin:"20px"},dot:{width:"8px",height:"8px",backgroundColor:"white",borderRadius:"8px",margin:"6px",animationDuration:"1s",animationName:o,animationIterationCount:"infinite",animationDirection:"alternate"},dotNewTheme:{width:"8px",height:"8px",backgroundColor:"#616161",borderRadius:"8px",margin:"6px",animationDuration:"1s",animationName:o,animationIterationCount:"infinite",animationDirection:"alternate"},svg:{width:"100%",height:"100%",display:"block"}})},function(e,t,n){"use strict";n.r(t),n.d(t,"PlayerDebugViewModel",(function(){return o}));var r=n(55),o=function(e){function t(t,n){var r=e.call(this,n)||this;r._closeButtonClicked=null,r._testProfilesInitialized=!1,r._closeButtonClicked=new EventObject,r._logs=ko.observable(""),r._logs(Core.Log.getFormattedLogs()),r._shouldAnimate=ko.observable(!1),r._powerAppsService=t,r._authoringAllowed=Core.Environment.isWebAuthoring()||Core.Environment.isTestMode(),r._selectedNotificationDelay=ko.observable(0),r._testProfiles=ko.observable({docServerTestProfiles:[]}),r._selectedDocServerPackagerProfileVariant=ko.observable(void 0),r._currentEnvDocServerPackagerEndpoint=ko.observable(""),r._currentEnvPlayerResourcesEndpoint=ko.observable(""),r._refreshCurrentEnvironmentVars();var o=new AppMagic.Runtime.Client.TestProfilesLoader(t.httpClient);return o.loadAsync().then((function(){o.testProfiles&&(r._testProfilesInitialized=!0,r._testProfiles(o.testProfiles),r._findSelectedProfile())})),r}return __extends(t,e),t.prototype._findSelectedProfile=function(){for(var e=AppMagic.Services.Azure.Region.getGlobalOverrides(),t=0,n=this.flattenedTestProfileVariants;t<n.length;t++){var r=n[t],o=__assign(__assign({},r.profile.settings),r.variant.settings);if(!!o.docServerEndpoint==!!e.docServerEndpoint&&!!o.docServerEnvironment==!!e.docServerRegion&&!!o.playerResourcesEndpoint==!!e.playerResourcesEndpoint&&!(o.docServerEndpoint&&e.docServerEndpoint.toString()!==new Core.Url(o.docServerEndpoint).toString()||o.docServerEnvironment&&e.docServerRegion!==o.docServerEnvironment||o.playerResourcesEndpoint&&e.playerResourcesEndpoint.toString()!==new Core.Url(o.playerResourcesEndpoint).toString())){this.selectedDocServerPackagerProfileVariant=r.index;break}}},Object.defineProperty(t.prototype,"selectedNotificationDelay",{get:function(){return this._selectedNotificationDelay()},set:function(e){this._selectedNotificationDelay(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"notificationDelayOptions",{get:function(){return[0,3,5,10]},enumerable:!1,configurable:!0}),t.prototype.goBack=function(){this._closeButtonClicked.dispatch()},Object.defineProperty(t.prototype,"closeButtonClicked",{get:function(){return this._closeButtonClicked},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shouldAnimate",{get:function(){return this._shouldAnimate()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"logs",{get:function(){return this._logs()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectedDocServerPackagerProfileVariant",{get:function(){return this._selectedDocServerPackagerProfileVariant()},set:function(e){if(this._testProfilesInitialized){this._selectedDocServerPackagerProfileVariant(e);var t=this.flattenedTestProfileVariants.find((function(t){return t.index===e}));if(t){var n=__assign(__assign({},t.profile.settings),t.variant.settings);AppMagic.Services.Azure.Region.setGlobalOverrides({playerResourcesEndpoint:n.playerResourcesEndpoint&&new Core.Url(n.playerResourcesEndpoint),docServerEndpoint:n.docServerEndpoint&&new Core.Url(n.docServerEndpoint),docServerRegion:n.docServerEnvironment||void 0,useCustomDocServerPackager:!0})}else AppMagic.Services.Azure.Region.clearGlobalOverrides();this._refreshCurrentEnvironmentVars()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flattenedTestProfileVariants",{get:function(){for(var e=[],t=1,n=0,r=this._testProfiles().docServerTestProfiles;n<r.length;n++)for(var o=r[n],i=0,a=o.variants;i<a.length;i++){var s=a[i];e.push({profile:o,variant:s,index:t++})}return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authoringAllowed",{get:function(){return this._authoringAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentEnvDocServerPackagerEndpoint",{get:function(){return this._currentEnvDocServerPackagerEndpoint()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentEnvPlayerResourcesEndpoint",{get:function(){return this._currentEnvPlayerResourcesEndpoint()},enumerable:!1,configurable:!0}),t.prototype._refreshCurrentEnvironmentVars=function(){var e=AppMagic.Services.Azure.Region.getCurrentRegion();this._currentEnvDocServerPackagerEndpoint(e.useCustomDocServerPackager?e.docServerEndpoint.toString():"(RP decides)"),this._currentEnvPlayerResourcesEndpoint(e.playerResourcesEndpoint.toString())},t.prototype.debugClicked=function(){var e=new r.DebugDialog(this._powerAppsService,this._clientSettings);this._logs(Core.Log.getFormattedLogs()),e.showAsync()},t.prototype.dispose=function(){this._closeButtonClicked.dispose(),this._logListener.dispose(),e.prototype.dispose.call(this)},t.prototype.requestNotification=function(){var e=this;window.setTimeout((function(){e._powerAppsService.requestPushNotificationAsync().then((function(e){e?Core.Log.verbose("Request to send test notification was sent successfully."):Core.Log.warning("PlayerDebugViewModel.requestNotification","Request to send test notification failed.")}),(function(e){Core.Utility.isCanceledError(e)?Core.Log.verbose("Request to send notification was canceled."):Core.Log.error("PlayerDebugViewModel.requestNotification",e,"Unexpected exception while requesting test notification.")}))}),1e3*this.selectedNotificationDelay)},t.prototype.copyLog=function(){var e=this;this._shouldAnimate(!1),Core.Utility.isDefined(window.clipboardData)?window.clipboardData.setData("Text",this.logs):cordova.plugins.clipboard.copy(this.logs),setTimeout((function(){e._shouldAnimate(!0)}),0)},t}(Core.Debug.DebugViewModel)},function(e,t,n){"use strict";n.r(t);var r=n(53),o=n(7),i=function(e){function t(t,n){var r=this;if((r=e.call(this,{id:"GranularConnectionPermissionsViewModel",message:"",title:""})||this)._api=t,r._actionsDescriptions=[],r._api.swaggerJson){var i=JSON.parse(r._api.swaggerJson);Object.keys(i.paths).forEach((function(e){var t=i.paths[e];Object.keys(t).forEach((function(e){n.some((function(n){return Core.Utility.equalsIgnoreCase(n,t[e].operationId)}))&&r._actionsDescriptions.push(t[e].description)}))}))}return n.find((function(e){return Core.Utility.equalsIgnoreCase(e,AppMagic.PowerApps.Constants.TabularActions.Read)}))&&r._actionsDescriptions.push(AppMagic.Strings.TabularActionRead),n.find((function(e){return Core.Utility.equalsIgnoreCase(e,AppMagic.PowerApps.Constants.TabularActions.Write)}))&&r._actionsDescriptions.push(AppMagic.Strings.TabularActionWrite),n.find((function(e){return Core.Utility.equalsIgnoreCase(e,AppMagic.PowerApps.Constants.TabularActions.Delete)}))&&r._actionsDescriptions.push(AppMagic.Strings.TabularActionDelete),r._url=ko.observable(Object(o.getControlPath)("dialogs/GranularConnectionPermissionsBody.html")),r}return __extends(t,e),Object.defineProperty(t.prototype,"displayName",{get:function(){return this._api.displayName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"iconUri",{get:function(){return this._api.iconUri},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"description",{get:function(){return this._api.description},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"actionDescriptions",{get:function(){return this._actionsDescriptions},enumerable:!1,configurable:!0}),t}(Core.UI.Popups.MessageDialogViewModel),a=function(e){function t(t,n){var r=this,o=new i(t,n);return r=e.call(this,o)||this,o.buttons.push(new Core.UI.Popups.DialogButtonViewModel(AppMagic.Strings.Close,(function(){return r.close()}))),r}return __extends(t,e),t}(Core.UI.Popups.Dialog);n.d(t,"ConnectionInfo",(function(){return s}));var s=function(e){function t(t){var n=e.call(this)||this;return n._reference=t.reference,n._dataSourceName=t.dataSourceName,n._parent=t.parent,n._isOnPremise=t.isOnPremise,n._consentOptions=t.consentOptions,n._availableConnections=ko.observableArray([]),n._selected=ko.observable(0),n._addingConnection=ko.observable(!1),n._needsSaving=!1,n._api=ko.observable(null),n._datasetRefId="",n._needsDataset=!1,n._datasets=ko.observableArray(null),n._warnings=ko.observableArray(null),n._dropdownCloseEvent=new EventObject,n._selectedDataset=ko.observable(null),n._datasetHasError=ko.observable(!1),n._showWarnings=ko.observable(!1),n._fullApi=ko.observable(null),n.track("_showLoadingDots",ko.computed((function(){return n._parent.loading||n._addingConnection()||!n._parent.loading&&n._needsDataset&&n._datasets().length<1&&!n._datasetHasError()}))),n.track("_enableButtons",ko.computed((function(){return!(n._parent.loading||n._parent.saving||n._addingConnection())}))),n.track("_showAddButton",ko.computed((function(){return t.allowCreation&&0===n._availableConnections().length&&!n._parent.loading}))),n.track("_showChangeButton",ko.computed((function(){return!AppMagic.ConnectionHub.PowerAppsConnectionService.isRuntimeServiceApi(n._reference.id)&&n._availableConnections().length>0&&!n._reference.sharedConnectionId&&!n._parent.loading}))),n.track("_showAddAnotherButton",ko.computed((function(){return t.allowCreation&&!n._parent.loading}))),n.track("_showInfo",ko.computed((function(){return n._availableConnections().length>0&&n._selected()>=0&&!n._showLoadingDots()}))),n.track("_showCreator",ko.computed((function(){return(0===n._availableConnections().length||n._selected()<0)&&n._api()&&!n._showLoadingDots()}))),n.track("_showError",ko.computed((function(){return!n._showLoadingDots()&&(0===n._availableConnections().length||-1===n._selected())}))),n.track("_showDatasets",ko.computed((function(){return!n._showLoadingDots()&&n._needsDataset}))),n.track("_selectedConnectionName",ko.computed((function(){var e=n._availableConnections()[n._selected()];return e?e.displayName:""}))),n.track("_isAuthenticated",ko.computed((function(){var e=n._availableConnections()[n._selected()];return!!e&&e.status.isAuthenticated}))),n.track("_apiCreator",ko.computed((function(){var e=n._api();return e&&e.creator.kind===AppMagic.ConnectionHub.UserKind.Custom?e.creator.createdBy.displayName:""}))),n.track("_showScope",ko.computed((function(){var e,t;if(n._api()){if(!Core.FallbackSwitch.isActivated("AppConnectivity.GranularConsentDialogV2")&&!n._parent.isUnifiedApp()&&(null===(e=n._reference.appActions)||void 0===e?void 0:e.length)>0&&!((null===(t=n._reference.dependents)||void 0===t?void 0:t.length)>0))return!0;var r=n._api().getScopesWill();return!!r&&r.length>0}return!1}))),n.track("_showPreviewTag",ko.computed((function(){var e=n._api();return!!e&&e.releaseStatus===AppMagic.ConnectionHub.ApiReleaseStatus.Preview}))),n.track("_showPremiumTag",ko.computed((function(){var e=n._api();return!!e&&e.tier===AppMagic.ConnectionHub.ApiTier.Premium}))),n.track("_showEnterpriseTag",ko.computed((function(){var e=n._api();return!!e&&e.tier===AppMagic.ConnectionHub.ApiTier.Enterprise}))),n.reference.datasets&&!n._parent.disableAutoSelect&&(n._needsDataset=HashTableUtility.some(n.reference.datasets,(function(e,t){return!(!e.datasetOverride||e.datasetOverride.name)&&(n._datasetRefId=t,!0)}))),n.track("_showShareError",ko.computed((function(){var e;if(!n._reference.sharedConnectionId)return!1;var t=n._availableConnections().length>0,r=!n._showLoadingDots()&&!t;return r&&Core.Telemetry.Log.trackUIActivityEvent(Core.Telemetry.OperationNames.appConnectionsShareRequestShown,{connectionId:n.reference.id,displayName:n.reference.displayName,sharedConnectionId:n.reference.sharedConnectionId,firstDataSource:(null===(e=n.reference.dataSources)||void 0===e?void 0:e.length)>0?n.reference.dataSources[0]:""}),r}))),n}return __extends(t,e),Object.defineProperty(t.prototype,"selected",{get:function(){return this._selected()},set:function(e){this._selected(e),!this._parent.disableAutoSelect&&this._needsDataset&&this._datasets().length<1&&this._populateDatasetsAsync()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"needsSaving",{get:function(){return this._needsSaving},set:function(e){this._needsSaving=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"addingConnection",{get:function(){return this._addingConnection()},set:function(e){this._addingConnection(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"availableConnections",{get:function(){return this._availableConnections()},set:function(e){this._availableConnections(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataSourceName",{get:function(){return this._dataSourceName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"reference",{get:function(){return this._reference},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isOnPremise",{get:function(){return this._isOnPremise},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showLoadingDots",{get:function(){return this._showLoadingDots()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"enableButtons",{get:function(){return this._enableButtons()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showAddButton",{get:function(){return this._showAddButton()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showChangeButton",{get:function(){return this._showChangeButton()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showAddAnotherButton",{get:function(){return this._showAddAnotherButton()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showInfo",{get:function(){return this._showInfo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showCreator",{get:function(){return this._showCreator()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectedConnectionName",{get:function(){return this._selectedConnectionName()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showError",{get:function(){return this._showError()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showScope",{get:function(){return this._showScope()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showPreviewTag",{get:function(){return this._showPreviewTag()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showPremiumTag",{get:function(){return this._showPremiumTag()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showEnterpriseTag",{get:function(){return this._showEnterpriseTag()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAuthenticated",{get:function(){return this._isAuthenticated()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiCreator",{get:function(){return this._apiCreator()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"datasets",{get:function(){return this._datasets()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"warnings",{get:function(){return this._warnings()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectedDataset",{get:function(){return this._selectedDataset()},set:function(e){void 0!==e&&e!==this._selectedDataset()&&this.setSelectedDataset(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showDatasets",{get:function(){return this._showDatasets()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropdownCloseEvent",{get:function(){return this._dropdownCloseEvent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"datasetRefId",{get:function(){return this._datasetRefId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"needsDataset",{get:function(){return this._needsDataset},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"datasetHasError",{get:function(){return this._datasetHasError()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showShareError",{get:function(){return this._showShareError()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showWarnings",{get:function(){return this._showWarnings()},set:function(e){this._showWarnings(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"api",{get:function(){return this._api()},set:function(e){this._api(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"consentOptions",{get:function(){return this._consentOptions},set:function(e){this._consentOptions=e},enumerable:!1,configurable:!0}),t.prototype.setSelectedDataset=function(e){this._selectedDataset(e),this._needsSaving=!0,this._dropdownCloseEvent.dispatch(),this._parent.updateConnectionsInfoAsync(!0,Core.Environment.isWebAuthoring())},Object.defineProperty(t.prototype,"dropDownText",{get:function(){var e=AppMagic.Strings.ConnectionDialogSelectDataset;return this.selectedDataset&&(e=this._selectedDataset().displayName),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"finishedSettingDataset",{get:function(){return!this.needsDataset||!(!this._selectedDataset()||!this._selectedDataset().name)},enumerable:!1,configurable:!0}),t.prototype.addConnection=function(){return this._parent.addOrUpdateConnection(this)},t.prototype._reauthenticateNonOAuthConnection=function(e){return this._parent.addOrUpdateConnection(this,e)},t.prototype.changeConnection=function(){Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appConnectionsChangeStarted,{apiName:this._getApiName()}),this._parent.selectedConnection=this},t.prototype.toggleWarnings=function(){this.showWarnings=!this.showWarnings,this.showWarnings&&Core.Telemetry.Log.trackActivityEvent("ConsentDialog.Warnings.show",{connection:this._reference.id})},t.prototype.selectConnectionAsync=function(e){var t=this;return this._parent.selectedConnection=null,e!==this._selected()||this._needsSaving?(this._selected(e),this._needsSaving=!0,this._addingConnection(!0),this._parent.saveConnectionsAsync(this).then((function(e){return t._addingConnection(!1),t._needsSaving=!e,t._parent.refreshSetUpStatus(),Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appConnectionsChangeCompleted,{apiName:t._getApiName()}),e}))):(Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appConnectionsChangeSkipped,{apiName:this._getApiName()}),Promise.resolve(!1))},t.prototype.isSetupComplete=function(){return this.availableConnections.length>0&&this.isAuthenticated&&this.finishedSettingDataset},t.prototype.fixConnection=function(){var e=this,t=this._availableConnections()[this._selected()];t&&(t.isAuthenticated||t.isApiConsentRequired?(Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appConnectionsFixStarted,{apiName:this._getApiName()}),this._parent.reauthenticateConnectionAsync(t,this.consentOptions).then((function(){e._parent.updateConnectionsInfoAsync(!0,Core.Environment.isWebAuthoring()),Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appConnectionsFixCompleted,{apiName:e._getApiName()}),Core.Telemetry.Log.trackActivityEvent("PlayerLifecycle.LoadConnections.ShowConsentDialog.ConnectionFixed",{selectedConnectionId:e._availableConnections()[e._selected()].id,apiId:e._api().id,remainingConnections:e._parent.connectionsInfo.filter((function(e){e.isSetupComplete()})).length})}),(function(t){Core.PromiseUtils.throwIfCanceled(t),Core.Log.error("ConnectionInfo.fixConnection",t),Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appConnectionsFixError,{apiName:e._getApiName()})}))):this._reauthenticateNonOAuthConnection(t.name))},t.prototype.openPermissionsDialogAsync=function(){var e;return __awaiter(this,void 0,Promise,(function(){var t,n;return __generator(this,(function(o){switch(o.label){case 0:if(!this._showScope())return[3,5];if(Core.FallbackSwitch.isActivated("AppConnectivity.GranularConsentDialogV2")||this._parent.isUnifiedApp()||(null===(e=this._reference.dependents)||void 0===e?void 0:e.length)>0||this._fullApi())return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this._parent.getFullApiAsync(this._api().id)];case 2:return t=o.sent(),this._fullApi(t),[3,4];case 3:return n=o.sent(),Core.Log.warningEx("ConnectionInfo.openPermissionsDialog",n),[3,4];case 4:this._fullApi()?new a(this._fullApi(),this._reference.appActions).showAsync():new r.ApiScopeDialog(this._api()).showAsync(),o.label=5;case 5:return[2]}}))}))},t.prototype.refreshDatasetsAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return(e=document.querySelector(".datasets-error-btn")).classList.add("loading"),[4,this._populateDatasetsAsync()];case 1:return t.sent(),e.classList.remove("loading"),[2]}}))}))},t.prototype.launchShareRequestEmail=function(){this._parent.launchShareRequestEmail(this)},t.prototype.addWarnings=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this._warnings).push.apply(e,t)},t.prototype._getApiName=function(){return this._reference.id.split("/").pop()},t.prototype._populateDatasetsAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e,t;return __generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this._parent.getDatasetsAsync(this)];case 1:return e=n.sent(),this._datasetHasError(!1),[3,3];case 2:return t=n.sent(),Core.Log.error("ConnectionInfo._populateDatasets",t),e=[],this._datasetHasError(!0),[3,3];case 3:return this._datasets(e),[2]}}))}))},t}(Core.Disposable)},function(e,t,n){"use strict";n.r(t),n.d(t,"BackwardCompatibilityManager",(function(){return r}));var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.isAppApiVersionOlderThanSupported=function(e){return Core.Utility.isNonEmptyNonWhitespaceString(e)||(e=t.InitialSupportedApiVersion),!!(t._getAppVersionCheckEnabled()&&Core.Environment.compareVersionNumber(e,this._getMinimumSupportedApiVersion())<0)&&(Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appDownloadAppOlderThanSupported,{minimumRequiredApiVersion:e,currentApiVersion:Core.Environment.Version.APP_API_VERSION_NUMBER}),!0)},t.isAppApiVersionNewerThanSupported=function(e){return Core.Utility.isNonEmptyNonWhitespaceString(e)||(e=t.InitialSupportedApiVersion),!!(t._getAppVersionCheckEnabled()&&Core.Environment.compareVersionNumber(e,this._getCurrentApiVersion())>0)&&(Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appDownloadAppNewerThanSupported,{minimumRequiredApiVersion:e,currentApiVersion:Core.Environment.Version.APP_API_VERSION_NUMBER}),!0)},t._getAppVersionCheckEnabled=function(){return Core.Debug.DebugViewModel.enableAppVersionCheck},t._getCurrentApiVersion=function(){return Core.Environment.Version.APP_API_VERSION_NUMBER},t._getMinimumSupportedApiVersion=function(){return t.MinimumSupportedApiVersion},t.InitialSupportedApiVersion="2.0.0",t.MinimumSupportedApiVersion="2.0.0",t}(Core.Disposable)},function(e,t,n){"use strict";n.r(t),n.d(t,"AppConnectionsView",(function(){return r}));var r=function(e){function t(t,n){var r=this;(r=e.call(this)||this)._element=t;var o=r._element.querySelector(".change-connection-pane");return r.trackAnonymous(n.showSelectionListObservable.subscribe((function(e){e?(r._returnFocusToElement=document.activeElement,window.setImmediate((function(){return r._openSelectionPane()})),window.setImmediate((function(){return Core.UI.Utility.A11y.focusElement(o)}))):window.setImmediate((function(){Core.UI.Utility.A11y.focusElement(r._returnFocusToElement),r._returnFocusToElement=null}))}))),r}return __extends(t,e),t.prototype._openSelectionPane=function(){var e=this._element.parentElement;e.classList.contains(t.CssClasses.dialogScrollingParent)||(e=e.parentElement),e.scrollTop=0},t.CssClasses={dialogScrollingParent:"dialog-body",paneScrollingParent:"pane-content"},t}(Core.Disposable)},function(e,t,n){"use strict";n.r(t),n.d(t,"AddConnectionView",(function(){return r}));var r=function(e){function t(n,r){for(var o=e.call(this)||this,i=n.querySelectorAll(".add-connection-data-location > input[type=radio]"),a=0;a<i.length;a++){(l=i.item(a)).id+=t.componentIdSuffix,l.name+=t.componentIdSuffix}var s=n.querySelectorAll(".add-connection-data-location");for(a=0;a<s.length;a++){var l;(l=s.item(a)).htmlFor+=t.componentIdSuffix}t.componentIdSuffix++;var p=n.querySelector(".add-connection-content");return o.track("_eventTracker",new Core.EventTracker),o._eventTracker.add(p,"scroll",(function(e){Core.UI.FlyoutHelper.closeAll()})),o}return __extends(t,e),t.componentIdSuffix=0,t}(Core.Disposable)},function(e,t,n){"use strict";n.r(t),n.d(t,"AppHostManagerFactory",(function(){return o}));var r=n(38),o=function(){function e(e){this._notificationProvider=e}return e.prototype.getAppHostManager=function(e,t,n,o,i,a,s,l,p,c,d,u,g,m,h,y){return void 0===c&&(c=Promise.resolve(null)),void 0===d&&(d=null),void 0===u&&(u=null),void 0===g&&(g=null),new r.WebPlayerPreloadAppHostManager(e,t,n,o,i,a,s,l,p,c,null,d,u,this._notificationProvider,g,m,h,y)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"WebPlayerPreloadAppHostManager",(function(){return i}));var r=n(39),o=n(5),i=function(e){function t(t,n,r,o,i,a,s,l,p,c,d,u,g,m,h,y,f,v){void 0===c&&(c=Promise.resolve(null)),void 0===d&&(d=null),void 0===u&&(u=null),void 0===g&&(g=null),void 0===m&&(m=null),void 0===h&&(h=null),void 0===y&&(y=null),void 0===f&&(f=null),void 0===v&&(v=null);var C,P,b=this;return(b=e.call(this,t,d)||this)._appIdentifier=n,b._iframeElement=r,b._appDetailsProvider=o,b._apiHandler=i,b._onAppErrorState=l,b._notificationProvider=m,b._handleExitCurrentApp=y,b._handlePostExitCurrentApp=f,b._exitHostedApp=v,b._isAppLoaded=!1,b._shouldPreloadInitCall=!1,b._onAppLoaded=a,b._onAppFailed=s,b._onAppIndexLoaded=p,b._showAppSplashScreen=u,b._displayGettingDataString=g,b._showUnsupportedControlsBanner=h,b._appIsLoading=!1,b._initializePromise=c,b._skipIframeCreation=Core.Environment.isPublishedAppExternalToHost(),b._shouldPreloadInitCall=(null===(C=window.webPlayerServerConfig.FeatureGates)||void 0===C?void 0:C.PreloadSdkInitCall)&&Core.Environment.isSharedAppHost(),b._appFirstHttpClientEventHandler=b._appFirstHttpClientEventHandler.bind(b),b._appIndexLoadedEventHandler=b._appIndexLoadedEventHandler.bind(b),b._appLoadedEventHandler=b._appLoadedEventHandler.bind(b),b._appFullLoadEventHandler=b._appFullLoadEventHandler.bind(b),b._appFailedEventHandler=b._appFailedEventHandler.bind(b),b._appInvokeScriptBlockedEventHandler=b._appInvokeScriptBlockedEventHandler.bind(b),b._appRuntimeStartHandler=b._appRuntimeStartHandler.bind(b),(b._skipIframeCreation||Core.Environment.isTrustedUCI())&&(b._messageProvider=Core.Loader.ObjectFactory.instance.getSingleton(Core.Player.IHostMessageProviderSingletonKey)),null===(P=window.performance)||void 0===P||P.mark("webPlayerStartUp"),Core.Telemetry.Log.openAppStartEvent(),b._preloadAppHost(),b}return __extends(t,e),t.prototype._preloadAppHost=function(){var e,t=this._appDetailsProvider.cdnUrl,n=Core.Telemetry.Log.startScenario(Core.Telemetry.ScenarioName.WebPlayerPreloadAppHost,{appModuleId:null===(e=window.webPlayerServerConfig.UnifiedAppConfig)||void 0===e?void 0:e.AppModuleId,cdnUrl:t,correlationId:window.webPlayerServerConfig.CorrelationId,preloadUrl:this._skipIframeCreation?void 0:Core.Telemetry.Utility.scrubSensitiveDataSafe(this._iframeElement.src),skipIframeCreation:this._skipIframeCreation,shouldPreloadInitCall:this._shouldPreloadInitCall});this._skipIframeCreation?Core.Telemetry.Log.trackActivityEvent("WebPlayerPreloadAppHostManager.preloadAppHost",{skipIframeCreation:!0}):Core.Telemetry.Log.trackActivityEvent("WebPlayerPreloadAppHostManager.preloadAppHost",{preloadUrl:this._iframeElement.src,cdnUrl:t}),this._registerHandlers(),this._apiHandler.start(),this._skipIframeCreation&&this._shouldPreloadInitCall&&this._messageProvider.init(this._appDetailsProvider.params.antiCSRFToken),Core.Telemetry.Log.endScenario(n)},t.prototype._registerHandlers=function(){var e=this._apiHandler.communicationChannel;this._apiHandler.registerHandler("AppDependenciesResolver",new PlayerApiHost.CordovaApiHost.Plugins.AppDependenciesResolverPlugin(e,this._appDetailsProvider.metadataParser)),this._apiHandler.registerHandler("AppModuleService",new PlayerApiHost.CordovaApiHost.Plugins.AppModuleService.AppModuleServicePlugin(e,this._appModuleManager)),this._apiHandler.registerHandler("AppLifecycle",new PlayerApiHost.CordovaApiHost.Plugins.AppLifecyclePlugin(e,this._notificationProvider)),e.appFailedEvent.addListener(this._appFailedEventHandler),e.appInvokeScriptBlockedEvent.addListener(this._appInvokeScriptBlockedEventHandler),e.appFirstHttpClientEvent.addListener(this._appFirstHttpClientEventHandler),e.appIndexLoadedEvent.addListener(this._appIndexLoadedEventHandler),e.appLoadedEvent.addListener(this._appLoadedEventHandler),e.appFullLoadEvent.addListener(this._appFullLoadEventHandler),e.appRuntimeStartEvent.addListener(this._appRuntimeStartHandler)},t.prototype.createAppHostAndOpenAppUsingPreloadData=function(e,t,n){var r;return __awaiter(this,void 0,Promise,(function(){var o,i,a;return __generator(this,(function(s){switch(s.label){case 0:return this._appIsLoading=!0,null===(r=this._showAppSplashScreen)||void 0===r||r.call(this),this.switchAppEnvironment(e),this._appDetailsProvider.setAppDetailsUsingPreloadData(e,n),o=new Player.Common.AppInfoPlayerAdapter(e),i=e.appConnectionUsages,a=Core.Environment.isStandAloneConsent()?new AppMagic.Runtime.Consent.StandaloneConsentProvider:new AppMagic.Runtime.Consent.DefaultConsentProvider,[4,this.createAppHost(o,i,e.connectionIds,e.authResources,t,a,this._notificationProvider)];case 1:return s.sent(),this.currentAppHost.initializeView(this._apiHandler),Core.FeatureGates.webPlayer.preloadStartupRequests&&this._isAppLoaded&&this.currentAppHost.onAppLoaded(),this._apiHandler.signalAllPluginsRegistered(),this.logConnectionReferenceTelemetry(),this._skipIframeCreation&&!this._shouldPreloadInitCall&&this._messageProvider.init(this._appDetailsProvider.params.antiCSRFToken),[2]}}))}))},Object.defineProperty(t.prototype,"_appModuleManager",{get:function(){var e=this,t=new Core.AsyncLazy("getCurrentEnvironmentAsync().name",(function(){return __awaiter(e,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this._playerRuntime.userService.getEnvironmentService().getCurrentEnvironmentAsync()];case 1:return[2,e.sent().name]}}))}))})),n=new Core.Lazy((function(){return e._playerRuntime.userService.appResourceManager})),r=new Core.Lazy((function(){return e.runningAppInfo.appType}));return new PlayerApiHost.CordovaApiHost.Plugins.AppModuleService.AppModuleManager(this._playerRuntime.httpClient,n,__assign(__assign({},this._appDetailsProvider.metadataParserConfig),{environmentNameAsyncLazy:t}),(function(t){e.currentAppHost.powerAppsClient.initializeConnectionsForApp(t)}),r,this._lazyListPackageClient,this._appDetailsProvider.metadataParser,this._appDetailsProvider.metadataParserCache,this._initializePromise)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_lazyListPackageClient",{get:function(){var e=this;return new Core.Lazy((function(){return new AppMagic.Runtime.Client.ListPackageClient(e._appIdentifier,e._playerRuntime.httpClient)}))},enumerable:!1,configurable:!0}),t.prototype._appIndexLoadedEventHandler=function(){this._onAppIndexLoaded()},t.prototype._appFirstHttpClientEventHandler=function(){var e;null===(e=this._displayGettingDataString)||void 0===e||e.call(this)},t.prototype._recordAppLoadPerfTelemetry=function(e,t,n){var r,o=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.Client.ComponentKeys.ResourceTimingProvider),i=window.WebPlayerAppLoader.getWebPlayerConfig();i=(i=i&&i.groups?i.groups:[]).map((function(e){return e.contents?e.contents.map((function(e){return e.src})):e.id})),(i=[].concat.apply([],i)).filter((function(e){var t=o.getPerformanceByUrl(e);t&&Core.Telemetry.Log.trackActivityEvent("WebPlayer.Host.ScriptLoadPerformance",t)}));var a=WebPlayerSettings.getWebPlayerPerformanceData();if(e&&e.publishedAppScriptPerf&&(e.publishedAppScriptPerf.forEach((function(e){e&&Core.Telemetry.Log.trackActivityEvent("WebPlayer.PublishedAppScriptPerf",e)})),delete e.publishedAppScriptPerf),e&&e.appPreviewFlags&&(Core.Telemetry.Log.updateOpenAppData({appPreviewFlags:e.appPreviewFlags,blockOnStartRule:e.blockOnStartRule,blockStartScreenRule:e.blockStartScreenRule}),delete e.appPreviewFlags,delete e.blockOnStartRule,delete e.blockStartScreenRule),Core.Utility.upsertObjectProperties(a,e),Core.Utility.upsertObjectProperties(a,{epochNow:Date.now(),performanceNow:null===performance||void 0===performance?void 0:performance.now(),webPlayerTimeOrigin:null===performance||void 0===performance?void 0:performance.timeOrigin,appDocumentComplexity:this.runningAppInfo.appDocumentComplexity}),Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.webPlayerPerf,a),t&&Core.Utility.isObject(t))for(var s in t){var l={};l[s]=t[s],Core.Telemetry.Log.updateOpenAppData(l)}if(Core.Telemetry.Log.openAppEndEvent(n),n&&!this._skipIframeCreation){var p=Core.Telemetry.Log.getOpenAppDataProperties();this._logPlayerSessionSummary(a,t,p,"CacheUsed"===(null===(r=window.webPlayerServerConfig.MetadataCachingResult)||void 0===r?void 0:r.MetadataCachingResult))}Core.Telemetry.Log.flush()},t.prototype._logPlayerSessionSummary=function(e,t,n,r){var o,i,a,s,l,p,c,d,u,g,m="other",h="other",y="other",f=!1;"webPlayerTimeOrigin"in e&&"number"==typeof e.webPlayerTimeOrigin&&(a=e.webPlayerTimeOrigin),void 0!==a&&"publishedAppTimeOrigin"in e&&"number"==typeof e.publishedAppTimeOrigin&&(s=e.publishedAppTimeOrigin,l=e.publishedAppTimeOrigin-a),void 0!==l&&"publishedAppAppMagicStart"in e&&"number"==typeof e.publishedAppAppMagicStart&&(p=l+e.publishedAppAppMagicStart),void 0!==a&&"webPlayerRemoveSplashScreen"in e&&"number"==typeof e.webPlayerRemoveSplashScreen&&(g=e.webPlayerRemoveSplashScreen),void 0!==l&&"publishedAppFirstOrStartingScreenPainted"in e&&"number"==typeof e.publishedAppFirstOrStartingScreenPainted&&void 0!==(c=l+e.publishedAppFirstOrStartingScreenPainted)&&void 0!==g&&c<g&&(c=g),void 0!==l&&"publishedAppFirstOrStartingScreenFullLoad"in e&&"number"==typeof e.publishedAppFirstOrStartingScreenFullLoad&&(void 0!==(d=l+e.publishedAppFirstOrStartingScreenFullLoad)&&void 0!==c&&d<c&&(d=c),u=null!==(o=e.publishedAppFirstOrStartingScreenFullLoadResult)&&void 0!==o?o:"unknown");var v=e.publishedAppFirstOrStartingScreen;"webPlayerTeamsOnLoad"in e&&"number"==typeof e.webPlayerTeamsOnLoad&&(p-=e.webPlayerTeamsOnLoad,c-=e.webPlayerTeamsOnLoad,g-=e.webPlayerTeamsOnLoad,void 0!==d&&(d-=e.webPlayerTeamsOnLoad),f=!0),"numControls"in t&&"number"==typeof t.numControls&&"numDataSources"in t&&"number"==typeof t.numDataSources&&t.numControls<=500&&t.numDataSources<=30&&void 0!==p&&void 0!==g&&(m="common");var C=n.connectionDisambiguationTimeSpent+n.interactiveAuthenticationTime,P="blockOnStartRule"in n&&"boolean"==typeof n.blockOnStartRule&&n.blockOnStartRule,b="blockStartScreenRule"in n&&"boolean"==typeof n.blockStartScreenRule&&n.blockStartScreenRule,_="usesAltAuth"in n&&"boolean"==typeof n.usesAltAuth&&n.usesAltAuth;(h=!0===P||!0===b?"blockingStartRule":C>0?"interactionRequired":(null===(i=this._apiHandler)||void 0===i?void 0:i.didAppFrameReload())?"other":f?"appOnly":r?"warm":_?"coldWithHint":"cold",n.inactiveDuration>0&&(y="throttled"),void 0!==a&&"performanceNow"in e&&"number"==typeof e.performanceNow&&"epochNow"in e&&"number"==typeof e.epochNow)&&(Math.abs(a+e.performanceNow-e.epochNow)>500&&(y="unhealthy"));void 0===p?Core.Telemetry.Log.trackErrorEvent("Player.SessionSummary.Failure",{error:{message:"Missing timeToAppStart data summarizing session"}}):void 0===g?Core.Telemetry.Log.trackErrorEvent("Player.SessionSummary.Failure",{error:{message:"Missing timeToPlayerRemoveSplash data summarizing session"}}):"unhealthy"!==y&&a>s?Core.Telemetry.Log.trackErrorEvent("Player.SessionSummary.Failure",{error:{message:"App time origin should start after player time origin"}}):Core.Telemetry.Log.trackActivityEvent("Player.SessionSummary",{totalUserInteractionTime:C,totalAuthDialogInteractionTime:n.interactiveAuthenticationTime,totalConnectionDialogInteractionTime:n.connectionDisambiguationTimeSpent,totalInactiveTime:n.inactiveDuration,timeToAppStart:p,timeToAppInteractive:c,timeToAppFullLoad:d,timeToPlayerRemoveSplash:g,perfGroupLoad:h,perfGroupApp:m,perfGroupDevice:y,perfGroupFullLoad:u,perfGroupVersion:2,firstOrStartingScreenId:v})},t.prototype._appLoadedEventHandler=function(e){var t;this._isAppLoaded=!0,Core.Environment.isSharedAppHost()||this._checkWebPlayerControlCompatibilityAsync(),Core.FeatureGates.webPlayer.preloadStartupRequests&&(null===(t=this.currentAppHost)||void 0===t||t.onAppLoaded()),this._appIsLoading=!1,this._onAppLoaded();var n=this._tryParsePerfData(e.length>0?e[0]:null),r=e.length>1?e[1]:null;if(this._scenarioInitAppRuntimeGuid&&(Core.Telemetry.Log.endScenario(this._scenarioInitAppRuntimeGuid),this._scenarioInitAppRuntimeGuid=null),(null==n?void 0:n.supportsFullLoad)&&!this._appFullLoadData?(this._appComplexityData=r,this._appPerfData=n):(this._appFullLoadData&&n&&Object.assign(n,this._appFullLoadData),this._appFullLoadData=void 0,this._recordAppLoadPerfTelemetry(n,r,!0)),this._shouldCacheInvertedLoadData()){var i=Core.Telemetry.Log.getOpenAppDataProperties();o.AppMetadataCaching.updateCacheWithOpenAppDataAsync(i)}},t.prototype._appFullLoadEventHandler=function(e){var t=e.length>0?e[0]:null;t&&this._appPerfData?(Object.assign(this._appPerfData,t),this._recordAppLoadPerfTelemetry(this._appPerfData,this._appComplexityData,!0),this._appPerfData=void 0,this._appComplexityData=void 0):this._appFullLoadData=t},t.prototype._appRuntimeStartHandler=function(e){this._scenarioInitAppRuntimeGuid=Core.Telemetry.Log.startScenario(Core.Telemetry.ScenarioName.PlayerLifecyclePlayerSDKPlayAppLoadAppInitAppRuntime,{operationName:"PlayerLifecycle.PlayerSDK.PlayApp.LoadApp.InitAppRuntime"})},t.prototype._appFailedEventHandler=function(e){var t,n,r,o=null===(t=e[0])||void 0===t?void 0:t.toString(),i=this._tryParsePerfData(e.length>3?e[3]:null);this._recordAppLoadPerfTelemetry(i,null,!1),this._onAppFailed(o),this._scenarioInitAppRuntimeGuid&&(Core.Telemetry.Log.failScenario(this._scenarioInitAppRuntimeGuid,{customScenarioData:{error:new Error(o),message:"PlayerLifecycle.PlayerSDK.PlayApp.LoadApp.InitAppRuntime"}}),this._scenarioInitAppRuntimeGuid=null),Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appDismissedWithError,{appId:this.runningAppInfo?this.runningAppInfo.appId:void 0,appName:this.runningAppInfo?this.runningAppInfo.name:void 0,errorString:o,stackTrace:e[1],errors:e.length>2?e[2]:null,isSplitEnabled:this.runningAppInfo?this.runningAppInfo.appPackageResourcesKind&&-1!==this.runningAppInfo.appPackageResourcesKind.toLocaleLowerCase().indexOf("split"):void 0,source:window.webPlayerServerConfig.MetadataSource,cachingResult:null===(n=window.webPlayerServerConfig.MetadataCachingResult)||void 0===n?void 0:n.MetadataCachingResult,metadataCachingError:null===(r=window.webPlayerServerConfig.MetadataCachingResult)||void 0===r?void 0:r.ErrorMessage}),this.exitHostedApp(),Core.Telemetry.Log.flush()},t.prototype._appInvokeScriptBlockedEventHandler=function(e){this._onAppErrorState({code:"InvokeScriptBlocked"})},t.prototype._checkWebPlayerControlCompatibilityAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e=this;return __generator(this,(function(t){return this._appDetailsProvider.metadataParser.getAppControls({onSuccess:function(t){var n=Core.ControlsCompatibilityValidator.WebplayerControlsCompatibilityValidator.getUnsupportedControlsInManifest(t);if(n.length>0){var r=Core.Environment.getWebPlayerQueryParam(WebPlayerSettings.appTypeParam);Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.webPlayerIncompatibleControlsDetected,{appId:e.runningAppInfo.appId,appType:r}),"sample"!==r&&"featured"!==r&&e._showUnsupportedControlsBanner(n)}},onFailure:function(e){Core.Telemetry.Log.trackErrorEvent("DefaultPublishedAppMetadataParser.GetAppControls.Error",{message:null==e?void 0:e.message,stack:null==e?void 0:e.stack})}}),[2]}))}))},t.prototype.notifyAppErrorState=function(e){this._onAppErrorState(e)},t.prototype.notifyAppExitRequested=function(){var e=this;if(Core.Environment.isTrustedUCI()){var t=new Error("Not implemented for unified apps");throw Core.Log.errorEx("WebPlayerPreloadAppHostManager.notifyAppExitRequested",{error:t}),t}Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appExitInitiated,{exitAppId:this.runningAppInfo.appId}),this.exitCurrentAppAsync().then((function(){e._handlePostExitCurrentApp(Core.Telemetry.Strings.appExitSucceeded)}),(function(t){e._handlePostExitCurrentApp(Core.Telemetry.Strings.appExitFailed)}))},t.prototype.dispose=function(){this.clearRunningApp(),this._apiHandler&&(this._apiHandler.communicationChannel.appFirstHttpClientEvent.removeListener(this._appFirstHttpClientEventHandler),this._apiHandler.communicationChannel.appIndexLoadedEvent.removeListener(this._appIndexLoadedEventHandler),this._apiHandler.communicationChannel.appLoadedEvent.removeListener(this._appLoadedEventHandler),this._apiHandler.communicationChannel.appFullLoadEvent.removeListener(this._appFullLoadEventHandler),this._apiHandler.communicationChannel.appFailedEvent.removeListener(this._appFailedEventHandler),this._apiHandler.communicationChannel.appRuntimeStartEvent.removeListener(this._appRuntimeStartHandler)),e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"notificationProvider",{get:function(){return this._notificationProvider},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAppLoaded",{get:function(){return this._isAppLoaded},enumerable:!1,configurable:!0}),t.prototype.exitCurrentAppAsync=function(e){var t=this;return this.currentAppHost.sendAppExitRequestedEvent().then((function(){t.currentAppHost.unload(),setTimeout((function(){Core.Telemetry.Log.trackActivityEvent("WebPlayerPreloadAppHostManager._exitCurrentAppAsync"),t.exitHostedApp(),t._handleExitCurrentApp(e)}))}))},t.prototype.exitHostedApp=function(){this._exitHostedApp(),this.dispose()},t.prototype.postMessageToHost=function(e,t){if(Core.Environment.isPublishedAppExternalToHost()||Core.Environment.isTrustedUCI())switch(e){case"resizeHost":return this._messageProvider.resizeHost(t.info,t.parameterType);case"clearPublishedApp":return this._messageProvider.clearPublishedApp();case"sendError":return this._messageProvider.sendErrorMessage(t.error);case"openConsentPage":return this._messageProvider.sendOpenConsentMessage(t.data.openConsentData);default:return}},t.prototype._shouldCacheInvertedLoadData=function(){return o.AppMetadataCaching&&window.location.href.toLowerCase().indexOf("skipmetadata=true")<0&&!Core.Environment.isSharedAppHost()},t.prototype._tryParsePerfData=function(e){if("string"==typeof e)try{return JSON.parse(e)}catch(e){Core.Telemetry.Log.trackErrorEvent("WebPlayerPreloadAppHostManager._tryParsePerfData",{name:null==e?void 0:e.name,message:null==e?void 0:e.message})}return null},t.publishedAppIframeId="fullscreen-app-host",t}(r.BaseAppHostManager)},function(e,t,n){"use strict";n.r(t),n.d(t,"BaseAppHostManager",(function(){return o}));var r=n(6),o=function(){function e(e,t){void 0===t&&(t=null),this._playerRuntime=e,this._appHost=t,this._runningAppInfo=null,this._notificationProvider=null,Core.Environment.setIsAppHostDisposed(!1)}return Object.defineProperty(e.prototype,"currentAppHost",{get:function(){return this._appHost},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"runningAppInfo",{get:function(){return this._runningAppInfo},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appIsLoading",{get:function(){return this._appIsLoading},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"notificationProvider",{get:function(){return this._notificationProvider},enumerable:!1,configurable:!0}),e.prototype.createAppHost=function(e,t,n,o,i,a,s){var l=this;this._runningAppInfo=e;var p=new Core.Lazy((function(){var e,t,n;return new PlayerApiHost.DataState.DataStateManager(null===(e=l.runningAppInfo)||void 0===e?void 0:e.appId,null!==(n=null===(t=l._playerRuntime.userService.userProfile)||void 0===t?void 0:t.objectId)&&void 0!==n?n:"",r.TeamsWebPlayerRuntime.getChannelId(),new PlayerApiHost.DataState.AppLocalStore(new Core.IO.LocalForageDataStore),new PlayerApiHost.DataState.PowerAppsLocalStore(new Core.IO.LocalForageDataStore))}));return this._appHost=this._playerRuntime.createAppHost(e,t,n,o,this,i,a,s,p),this._appHost.initialize(),this._appHost.loadAsync()},e.prototype.displayGettingDataString=function(){},e.prototype.postMessageToHost=function(e,t){},e.prototype.logConnectionReferenceTelemetry=function(){var e=this,t=this._runningAppInfo.connectionReferences,n=Core.Utility.generate128BitUUID();if(t){var r=0;HashTableUtility.forEach(t,(function(t){Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.appOpenConnectionReference,{appId:e._runningAppInfo.appId,correlationId:n,apiId:t.id,dataSources:Core.Telemetry.Utility.scrubSensitiveDataSafe(JSON.stringify(t.dataSources)),isOnPremiseConnection:t.isOnPremiseConnection,sharedConnectionId:t.sharedConnectionId,gatewayObjectIdHint:t.gatewayObjectIdHint}),r++})),Core.Telemetry.Log.updateOpenAppData({numberOfConnectionReferences:r}),Core.Telemetry.Log.updateOpenAppData({connectionReferenceCorrelationId:n})}var o=this._runningAppInfo.databaseReferences;o&&!HashTableUtility.isEmpty(o)&&Core.Telemetry.Log.trackActivityEvent(Core.Telemetry.Strings.appOpenConnectionReference,{appId:this._runningAppInfo.appId,correlationId:n,apiId:Core.Telemetry.Strings.cdsNativeApi,hasCurEnv:HashTableUtility.some(o,(function(e,t){return t===AppMagic.ConnectionHub.Constants.CdsDefaultDatasetName})),xrefEnvs:HashTableUtility.count(HashTableUtility.filter(o,(function(e,t){return t!==AppMagic.ConnectionHub.Constants.CdsDefaultDatasetName})))})},e.prototype.clearRunningApp=function(){Core.Telemetry.Log.setPlayerAppId(""),this._appHost&&(this._appHost.dispose(),this._appHost=null),this._runningAppInfo=null},e.prototype.notifyAppErrorState=function(e){},e.prototype.notifyAppExitRequested=function(){},e.prototype.switchAppEnvironment=function(e){if(e.environment&&e.environment.id){var t=this._playerRuntime.clientRuntime.userService.getEnvironmentService();Core.Log.verbose("Switching to environment: {0}, for app: {1}",e.environment.id,e.id),t.switchEnvironment(e.environment)}else Core.Log.verbose("Skipping environment switching for app {0}",e.id)},e.prototype.dispose=function(){Core.Environment.setIsAppHostDisposed(!0)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"D365ShellHeader",(function(){return a}));var r=n(0),o=n(2),i=aphrodite.StyleSheet.create({apphostD365ShellHeader:{display:"flex",flex:"0 0 auto"},invisible:{display:"none"}}),a=function(){function e(){}return e.prototype._initializeHeaderFunctionality=function(t){this._d365Shell=this._initD365Shell(t.appId,t.title,t.authenticationManager),this._d365Shell.header.setTitle(t.title),"sharepoint"!==t.source&&(t.title&&Core.Utility.isNonEmptyNonWhitespaceString(t.title)&&this._d365Shell.taskpane.addTransientApp({id:t.appId,displayName:t.title,backgroundColor:t.backgroundColor,iconUri:t.backgroundImageUrl,appOpenUri:window.location.href}),t.appId&&Core.Utility.isNonEmptyNonWhitespaceString(t.appId)&&this._d365Shell.taskpane.identifyActiveApp(t.appId));var n=Core.Loader.ObjectFactory.instance.getSingleton(AppMagic.Runtime.Client.ComponentKeys.AuthenticationPluginCreator);this._adalPlugin=n.getAuthenticationPlugin(),this._d365Shell.promise.then((function(){Object(o.removePlaceholderHeader)(),Object(o.dispatchResizeWindow)(),e._isLoaded=!0}))},e.prototype.getContainerOutline=function(){return React.createElement("div",null,React.createElement("div",{id:e.D365HeaderContainerId,className:aphrodite.css(Core.Environment.shouldHideWebPlayerNavBar()?i.invisible:i.apphostD365ShellHeader),"aria-hidden":!1}),React.createElement("div",{id:e.D365TaskPaneContainerId,"aria-hidden":!1}))},e.prototype.render=function(t,n){if(!e._isLoaded){this._initializeHeaderFunctionality(t);var r=document.createElement("div");r.id="D365Container",document.body.insertBefore(r,n),ReactDOM.render(React.createElement(this.getContainerOutline,null),document.getElementById("D365Container"))}},e.prototype.getHeight=function(){return e.D365HeaderHeight},Object.defineProperty(e,"isLoaded",{get:function(){return e._isLoaded},enumerable:!1,configurable:!0}),e.prototype._initD365Shell=function(t,n,r){var i=this,a=[];if(Core.Environment.shouldAllowNativePlayerDownload()&&t&&Core.Utility.isNonEmptyNonWhitespaceString(t)){var s={id:"download",displayName:Player.Strings.D365_Download,action:o.downloadActionHandler.bind(this,t)};a.push(s)}var l=[],p={id:"Fit to screen",displayName:Player.Strings.D365_FitToScreen,action:Core.UI.Utility.webPlayerFitToScreen.bind(this)};l.push(p);var c={id:"sessionDetails",displayName:AppMagic.Strings.LinkTitle_SessionDetails,action:o.showSessionDetails};l.push(c);var d=[],u={id:"help",displayName:Player.Strings.D365_Help,action:this._helpActionHandler.bind(this)};d.push(u);var g=o.signOut.bind(this),m={header:{containerId:e.D365HeaderContainerId,onSignOut:g,iconActions:a,settingsMenuActions:l,helpMenuActions:d},environment:Core.Environment.getRegionConfig().d365HostingEnvironment,acquireToken:function(e){return i._acquireTokenAsync(e,r)}};return m.brand={name:AppMagic.Strings.PowerApps,version:"1.0.0",theme:{primaryColor:"#742774",primaryColorAlt:"#461746"}},m.product="powerapps",m.taskpane={containerId:e.D365TaskPaneContainerId,topOffsetInPixel:e.D365HeaderHeight},D365.init(m)},e.prototype._helpActionHandler=function(){window.open(r.K.Help)},e.prototype._defaultToADALPluginAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,this._adalPlugin.acquireTokenSilentAsync(e)];case 1:return[2,t.sent().accessToken]}}))}))},e.prototype._acquireTokenAsync=function(e,t){return __awaiter(this,void 0,Promise,(function(){var n;return __generator(this,(function(r){switch(r.label){case 0:return t?[3,2]:[4,this._defaultToADALPluginAsync(e)];case 1:return[2,r.sent()];case 2:return r.trys.push([2,4,,6]),[4,(n=t.getProviderForResourceUrl(e)).authenticateSilentAsync()];case 3:return r.sent(),[2,n.store.accessToken];case 4:return r.sent(),Core.Telemetry.Log.trackErrorEvent(Core.Telemetry.Strings.webPlayerInvalidResourceUrl,{resourceUrl:e}),[4,this._defaultToADALPluginAsync(e)];case 5:return[2,r.sent()];case 6:return[2]}}))}))},e.dispose=function(){e._isLoaded=!1},e.D365HeaderContainerId="d365-shell-header",e.D365HeaderHeight=48,e.D365TaskPaneContainerId="d365-task-pane",e._isLoaded=!1,e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"WebPlayerSDKMessenger",(function(){return o}));var r=n(3),o=function(){function e(){e._authResultTable=HashTableUtility.create()}return e.prototype.authenticateConnectorAsync=function(t){var n=t.connectorUrl?t.connectorUrl:t;return r.WebPlayerRuntime.postMessageToSdk({api:WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.OpenConnectorAuthPopup,data:n}),e._authResultTable[t.connectorId]&&(Core.Telemetry.Log.trackErrorEvent("WebPlayerSDKMessenger.authenticateConnectorAsync","Received another authentication request for connector ".concat(t.connectorId," before the previous authentication request was completed.")),e._authResultTable[t.connectorId].cancel()),e._authResultTable[t.connectorId]=Core.PromiseUtils.createCancellablePromise(),e._authResultTable[t.connectorId].promise},e.processConnectorAuthResult=function(t){e._authResultTable[t.connectorAuthUrl]?(e._authResultTable[t.connectorAuthUrl].complete({result:t.result,error:t.error}),delete e._authResultTable[t.connectorAuthUrl]):Core.Telemetry.Log.trackErrorEvent("WebPlayerSDKMessenger.processConnectorAuthResult","Unable to find the matching promise for ".concat(t.connectorAuthUrl))},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"WebPlayerUIProvider",(function(){return s}));var r=n(21),o=n(9),i=n(3),a=n(23),s=function(){function e(e){void 0===e&&(e=null),this._splashScreenHidden=!1;var t=AppMagic.PowerApps.AppInfo.tryParsePackageProperties(Core.Environment.getWebPlayerQueryParam(WebPlayerSettings.packageProperties));this._shortAppSplashScreen=!(!t||!t.shortSplash)&&t.shortSplash,this._showingAppSplashScreen=!1,this._messageProvider=Core.Loader.ObjectFactory.instance.getSingleton(Core.Player.IHostMessageProviderSingletonKey),this._skipIframeCreation=Core.Environment.isPublishedAppExternalToHost(),this._shellManager=e||new o.ShellHeaderManager,this._iframeElement=this._getAppIframe()}return e.prototype.initializeAppHostUI=function(){var e,t,n=this;this._iframeElement=null!==(e=this._iframeElement)&&void 0!==e?e:this._getAppIframe(),Core.Telemetry.Log.trackActivityEvent("WebPlayerUIProvider.initializeAppHostUI"),this.layoutUpdateHandler=this.layoutUpdateHandler.bind(this),window.addEventListener("resize",this.layoutUpdateHandler),window.addEventListener("orientationchange",this.layoutUpdateHandler),Core.Environment.shouldHideWebPlayerNavBar()&&!this._skipIframeCreation&&(this._iframeElement.style.margin="0px"),this._appHostContainer=document.createElement("div"),this._appHostContainer.style.zIndex="3000",null===(t=this.createWebPlayerShellAsync)||void 0===t||t.call(this,this._appHostContainer,(function(){return n._iframeElement})).then((function(e){n._webPlayerShellFunctions=e})),document.body.insertBefore(this._appHostContainer,document.body.firstChild),this.layoutUpdateHandler()},e.prototype._getAppIframe=function(){return document.getElementById("fullscreen-app-host")},e.getInstance=function(){return e._uiProvider||(e._uiProvider=new e),e._uiProvider},Object.defineProperty(e.prototype,"shortAppSplashScreen",{get:function(){return this._shortAppSplashScreen},enumerable:!1,configurable:!0}),e.prototype.createWebPlayerShellAsync=function(e,t){var n,o=this,i=new Promise((function(e,t){n=e}));return ReactDOM.render(React.createElement(r.WebPlayerShell,{getIframeElement:t,onWebPlayerShellCreated:function(e){o._webPlayerShellFunctions=e,n(o._webPlayerShellFunctions)},showSkipToMainContentLink:!Core.Environment.isSkypeTeams()&&!Core.Environment.isIframed()}),e),document.body.insertBefore(e,document.body.firstChild),i},e.prototype.showAppSplashScreen=function(e){this._splashScreenScenarioGuid=Core.Telemetry.Log.startScenario(Core.Telemetry.ScenarioName.PowerAppSplashScreen),Core.PerformanceTracker.enterScope(Core.Telemetry.Strings.powerAppSplashScreenPerformance),this._shortAppSplashScreen||(this._shortAppSplashScreen=!(!e.packageProperties||!e.packageProperties.shortSplash)&&e.packageProperties.shortSplash),Core.Environment.shouldHideAppSplashScreen()||this._shortAppSplashScreen||this._splashScreenHidden||(this._webPlayerShellFunctions?(i.WebPlayerRuntime.removePlayerSplashScreen(this._shortAppSplashScreen),this._webPlayerShellFunctions.showAppSplashScreen({appName:e.displayName,iconUrl:e.imageUrl,backgroundColor:e.backgroundColor,showGettingDataString:!1}),this._showingAppSplashScreen=!0):Core.Telemetry.Log.trackErrorEvent("WebPlayerUIProvider.showAppSplashScreen.noShell",{message:"WebPlayer shell not ready, not showing app splash"}),this._postMessageToHost("resizeHost",{info:!0,parameterType:"host"}))},e.prototype.hideSplashScreen=function(){var e,t;this._showingAppSplashScreen||i.WebPlayerRuntime.removePlayerSplashScreen(this._shortAppSplashScreen),null===(e=this._webPlayerShellFunctions)||void 0===e||e.hideAppSplashScreen(),this._showingAppSplashScreen=!1,this._splashScreenHidden=!0,null===(t=window.performance)||void 0===t||t.mark("webPlayerRemoveSplashScreen"),this._postMessageToHost("resizeHost",{info:!1,parameterType:"host"})},e.prototype.endSplashScreenScenario=function(){Core.Telemetry.Log.endScenario(this._splashScreenScenarioGuid);var e=Core.PerformanceTracker.exitScopeAndGetRunTime(Core.Telemetry.Strings.powerAppSplashScreenPerformance);Core.Telemetry.Log.updateOpenAppData({appSplashScreenTime:e}),Core.Diagnostics.trace(Core.Diagnostics.CategoryNames.Performance,Player.Strings.AppOpenSuccessEvent,{duration:e}),this._splashScreenScenarioGuid=""},e.prototype.displayGettingDataString=function(){if(Core.Environment.shouldHideAppSplashScreen()){var e=document.getElementById("splash-screen-message");e?(e.setAttribute("tabindex","0"),e.textContent=Player.Strings.GettingYourData):Core.Telemetry.Log.trackErrorEvent("WebPlayerUIProvider.displayGettingDataString.NullGettingDataTag")}else this._webPlayerShellFunctions&&this._webPlayerShellFunctions.toggleGettingDataString(!0)},e.prototype.layoutUpdateHandler=function(){var e,t;if(this._iframeElement=null!==(e=this._iframeElement)&&void 0!==e?e:this._getAppIframe(),this._shellManager=null!==(t=this._shellManager)&&void 0!==t?t:new o.ShellHeaderManager,Core.Telemetry.Log.trackActivityEvent("WebPlayerUIProvider.layoutUpdateHandler"),this._iframeElement){var n=this._shellManager.getShellHeader()?this._shellManager.getShellHeader().getHeight():0;n&&this._iframeElement.parentElement.style.setProperty("height","calc(100vh - ".concat(n,"px)")),this._iframeElement.parentElement.style.setProperty("margin-bottom","")}this._webPlayerShellFunctions&&this._webPlayerShellFunctions.updateShellLayout()},e.prototype.dispose=function(){Core.Telemetry.Log.trackActivityEvent("WebPlayerUIProvider.dispose"),this._renderHeaderTimeout&&clearTimeout(this._renderHeaderTimeout),this._iframeElement&&(this._iframeElement.removeEventListener("load",this.layoutUpdateHandler),this._iframeElement.src.replace(this._iframeElement.src,"about:blank"),this._iframeElement=null),this._webPlayerShellFunctions=null,window.removeEventListener("resize",this.layoutUpdateHandler),window.removeEventListener("orientationchange",this.layoutUpdateHandler),this._appHostContainer&&(ReactDOM.unmountComponentAtNode(this._appHostContainer),this._appHostContainer.parentNode.removeChild(this._appHostContainer),this._appHostContainer=null),this._shellManager=null},e.prototype.renderShellHeader=function(e,t,n){var r=this;this._renderHeaderTimeout=setTimeout((function(){r._renderHeader(e,t,n)}),3e3)},e.prototype.showUnsupportedControlsBanner=function(e){var t,n=this;null===(t=this._webPlayerShellFunctions)||void 0===t||t.showWarningBanner(e),setTimeout((function(){var e=document.getElementById(a.WebPlayerWarningBanner.warningBannerId);if(e){var t=e.getBoundingClientRect().height;n._postMessageToHost("resizeHost",{info:t,parameterType:"banner"})}}),0)},e.prototype.setIframeTitle=function(e){Core.Telemetry.Log.trackActivityEvent("WebPlayerUIProvider.setIframeTitle");try{this._iframeElement&&e&&e.name&&(this._iframeElement.title=e.name)}catch(e){}},e.prototype.handleAppFailedUI=function(){var e=document.getElementById("screenLoadingPlaceholder");e&&e.style.setProperty("display","none"),Core.Log.verbose("Published app exiting with error"),Player.Client.Components.WebPlayerErrorDialog.WebPlayerErrorDialog.display(Player.Client.Components.WebPlayerErrorDialog.WebPlayerErrorType.RunAppFailure)},e.prototype._renderHeader=function(e,t,n){var r;if(Core.Telemetry.Log.trackActivityEvent("WebPlayerUIProvider._renderHeader"),this._shellManager=null!==(r=this._shellManager)&&void 0!==r?r:new o.ShellHeaderManager,this._shellManager.getShellHeader()){var i=e?e.name:"",a=e?e.appId:"",s=e?e.backgroundImageUrl:"",l=e?e.backgroundColor:"",p={title:i,source:Core.Environment.getWebPlayerQueryParam(WebPlayerSettings.sourceParam),appId:a,envName:n.userService.getEnvironmentService().tryGetCurrentEnvironment().name,backgroundColor:l,backgroundImageUrl:s,authenticationManager:n.clientRuntime.authenticationRuntime.azureAuthenticationManager,region:Core.Environment.getRegionConfig().region,queryString:window.location.search,userProfile:n.userService.userProfile,errorDuringAppLaunch:t};this._shellManager.getShellHeader().render(p,this._appHostContainer)}},e.prototype._postMessageToHost=function(e,t){if(Core.Environment.isPublishedAppExternalToHost())switch(e){case"resizeHost":return this._messageProvider.resizeHost(t.info,t.parameterType);case"clearPublishedApp":return this._messageProvider.clearPublishedApp();default:return}},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"OneShellHeader",(function(){return a}));var r=n(0),o=n(44),i=n(2),a=function(){function e(){this.OfficeShellPropertyName="O365Shell",this._officeShellHeaderId="officeShellHeaderId",this.regionConfig=Core.Environment.getRegionConfig(),this._appBrandTheme={Primary:Core.UI.StyleConstants.MainLogoColor,HoverBackground:Core.UI.StyleConstants.MainHoverBackgroundColor,PressedBackground:Core.UI.StyleConstants.MainHoverBackgroundColor},this._fitToScreenButtonData={affordanceMenuItemText:Player.Strings.D365_FitToScreen,ariaLabel:Player.Strings.D365_FitToScreen,iconFontName:"î´",iconFontFamily:"FabricMDL2Icons",id:"FitToScreenButton",onHide:function(){},onShow:Core.UI.Utility.webPlayerFitToScreen,isStateless:!0},this._helpLinks=[{Id:"DocumentationHelpLink",Text:AppMagic.Strings.LinkTitle_Documentation,Url:r.K.LearnMore,TargetWindow:"_blank"},{Id:"LearnHelpLink",Text:AppMagic.Strings.LinkTitle_LearnMore,Url:r.K.LearnCanvasApps,TargetWindow:"_blank"},{Id:"SupportHelpLink",Text:AppMagic.Strings.LinkTitle_Support,Url:r.K.Support,TargetWindow:"_blank"},{Id:"CommunityHelpLink",Text:AppMagic.Strings.SignIn_VisitCommunity,Url:r.K.Community,TargetWindow:"_blank"},{Id:"BlogsHelpLink",Text:AppMagic.Strings.LinkTitle_Blogs,Url:r.K.Blogs,TargetWindow:"_blank"}]}return e.prototype.render=function(t,n){var r;if(!e._isLoaded){var i=document.createElement("link");i.id="fabricCoreStyle",i.rel="stylesheet",i.href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css",document.body.insertBefore(i,n);var a=document.createElement("div");a.id=this._officeShellHeaderId,document.body.insertBefore(a,n.nextSibling),this._loader=new o.OneShellLoader(t.region),this._loader.bootstrap().then(this.onOneShellLoaded.bind(this,t.appId,t.envName,t.title,t.region,t.queryString,t.errorDuringAppLaunch,t.userProfile),this.onOneShellFailedToLoad.bind(this)),!1===(null===(r=t.userProfile)||void 0===r?void 0:r.isGuest)&&this._loader.loadNavBarData().then(this.setNavBarData.bind(this))}},e.prototype.getHeight=function(){return e._defaultHeaderHeight},e.prototype.setNavBarData=function(t){try{window[this.OfficeShellPropertyName]&&(window[this.OfficeShellPropertyName].SetData(t),e._isLoaded=!0)}catch(e){Core.Telemetry.Log.trackErrorEvent("OneShellHeader.UserNavBarDataFailed",{message:"Error occurred while trying to set the user nav bar data",error:Object(i.formatOneShellErrorMessage)(e)})}},e.prototype.onOneShellLoaded=function(e,t,n,r,o,a,s){var l,p,c=this;try{window[this.OfficeShellPropertyName].RenderAsync(this._getRenderSettings(e,n,r,s),(function(){c._postRender()}),(function(){c._postRenderHeaderSuccess(r)}),this._postRenderHeaderFailure),window[this.OfficeShellPropertyName].OnSignOut(i.signOut),Core.Environment.shouldAllowNativePlayerDownload()&&(Core.FeatureGates.webPlayer.enableNewAppDownloadLink?window[this.OfficeShellPropertyName].Extensibility.AddOrUpdateCustomHeaderButton(this._getQRCodeDownloadButtonData(e,o)):window[this.OfficeShellPropertyName].Extensibility.AddOrUpdateCustomHeaderButton(this._getDownloadButtonData(e,o))),window[this.OfficeShellPropertyName].Extensibility.AddOrUpdateCustomHeaderButton(this._fitToScreenButtonData),window.webPlayerServerConfig.FeatureGates.OfficeHeaderAddToTeams&&(null===(p=null===(l=this.regionConfig)||void 0===l?void 0:l.webPlayerConfig)||void 0===p?void 0:p.enableAddtoTeamsButtonOfficeHeader)&&!a&&this.isAppNameValid(e)&&this.isEnvNameValid(t)&&window[this.OfficeShellPropertyName].Extensibility.AddOrUpdateCustomHeaderButton(this._getAddToTeamsButtonData(this.appName,t))}catch(e){var d=Object(i.formatOneShellErrorMessage)(e);Core.Telemetry.Log.trackErrorEvent("OneShellRenderFailedEvent",{message:"Failed to Render One Shell",errorObject:d})}},e.prototype.isAppNameValid=function(e){if(!e||""==e)return Core.Telemetry.Log.trackErrorEvent("OneShellAddtoTeamsFailedEvent",{message:"AppId is invalid.",appId:e}),!1;var t=AppMagic.PowerApps.PowerAppsUtility.parseAppNameFromAppId(e);return t&&""!=t?(this.appName=t,!0):(Core.Telemetry.Log.trackErrorEvent("OneShellAddtoTeamsFailedEvent",{message:"AppName is invalid.",appId:e,appName:t}),!1)},e.prototype.isEnvNameValid=function(e){return!(!e||""==e)||(Core.Telemetry.Log.trackErrorEvent("OneShellAddtoTeamsFailedEvent",{message:"EnvName is invalid.",envName:e}),!1)},e.prototype._postRender=function(){Object(i.removePlaceholderHeader)(),Object(i.dispatchResizeWindow)()},e.prototype.onOneShellFailedToLoad=function(e){var t=Object(i.formatOneShellErrorMessage)(e);Core.Telemetry.Log.trackErrorEvent("OneShellLoadFailedEvent",{message:"Failed to Load One Shell",errorObject:t})},e.prototype._getAddToTeamsButtonData=function(e,t){return{affordanceMenuItemText:Player.Strings.Office_AddToTeams,ariaLabel:Player.Strings.Office_AddToTeams,iconFontName:"ï",iconFontFamily:"FabricMDL2Icons",id:"AddToTeamsButton",onHide:function(){},onShow:i.addToTeamsActionHandler.bind(this,e,t),isStateless:!0}},e.prototype._getDownloadButtonData=function(e,t){return{affordanceMenuItemText:Player.Strings.D365_Download,ariaLabel:Player.Strings.D365_Download,iconFontName:"î¢",iconFontFamily:"FabricMDL2Icons",id:"DownloadAppButton",onHide:function(){},onShow:i.downloadActionHandler.bind(this,e,t),isStateless:!0}},e.prototype._getQRCodeDownloadButtonData=function(e,t){return{affordanceMenuItemText:Player.Strings.D365_Download,ariaLabel:Player.Strings.D365_Download,iconFontName:"î£ª",iconFontFamily:"FabricMDL2Icons",id:"DownloadAppQRCodeButton",onHide:function(){},onShow:i.downloadActionHandler.bind(this,e,t),isStateless:!0}},e.prototype._getSettingsSublinks=function(e,t){var n=this;return[{Id:"SessionDetailsLink",Text:AppMagic.Strings.LinkTitle_SessionDetails,Action:function(){return n._openSessionDetailsDialog(),!1},Url:"#"}]},e.prototype._getRenderSettings=function(e,t,n,o){var a={top:this._officeShellHeaderId,isThinHeader:!0,collapseO365Settings:!0,initialRenderData:{Culture:Core.Globalization.currentCulture().language,IsConsumer:!1,IsGuestMode:!!(null==o?void 0:o.isGuest),ShellBootHost:Object(i.getShellHeaderBootstrapHost)(n),WorkloadId:PlayerApiHost.CordovaApiHost.Plugins.OfficeHeaderWorkloadId,AppBrandTheme:this._appBrandTheme},shellDataOverrides:{HelpLink:null,FeedbackLink:null,CommunityLink:null,PrivacyLink:{Id:"PrivacyLink",MenuName:null,SubLinks:null,TargetWindow:"_blank",Text:AppMagic.Strings.LinkTitle_PrivacyTerms,Url:r.K.PrivacyTerms},LegalLink:{Id:"LegalLink",MenuName:null,SubLinks:null,TargetWindow:"_blank",Text:AppMagic.Strings.LinkTitle_Legal,Url:r.K.Legal},AppHeaderLinkText:this.getHeaderTitle(t,n),AppHeaderLinkUrl:null},workloadHelpSubLinks:this._helpLinks,workloadSettingsSubLinks:this._getSettingsSublinks(e,t)};return(null==o?void 0:o.isGuest)&&(a.initialRenderData.UserId=o.email,a.initialRenderData.UserDisplayName=o.fullName),a},e.prototype._postRenderHeaderSuccess=function(e){if(Core.Telemetry.Log.trackActivityEvent("OneShellRenderSucceeded"),"mooncake"===e){var t=document.getElementById(this._officeShellHeaderId);if(t){new MutationObserver((function(e,t){for(var n=0;n<e.length;n++)if("childList"===e[n].type&&e[n].addedNodes)for(var r=0;r<e[n].addedNodes.length;r++){var o=e[n].addedNodes[r];if(o instanceof HTMLElement&&"O365_BrandingLogo"===o.id){var i=o;i.removeAttribute("role"),i.removeAttribute("href"),i.setAttribute("aria-label",AppMagic.Strings.PowerApps);for(var a=i.querySelectorAll("span"),s=0;s<a.length;s++)if("Office 365"===a[s].innerText){a[s].textContent=AppMagic.Strings.PowerApps,t.disconnect();break}}}})).observe(t,{childList:!0,subtree:!0,characterData:!1,attributes:!1})}}},e.prototype._postRenderHeaderFailure=function(e){Core.Telemetry.Log.trackErrorEvent("OneShellRenderFailed",{message:e.Details,resource:e.ResourceName})},e.prototype.getHeaderTitle=function(e,t){return"mooncake"===t?e:"".concat(AppMagic.Strings.PowerApps).concat("Â ").concat("Â ","|").concat("Â ").concat("Â ").concat(e)},e.prototype._openSessionDetailsDialog=function(){Object(i.showSessionDetails)(),window[this.OfficeShellPropertyName]&&window[this.OfficeShellPropertyName].FlexPane.CloseFlexPaneForProvider()},e._isLoaded=!1,e._defaultHeaderHeight=48,e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"OneShellLoader",(function(){return o}));var r=n(2),o=function(){function e(e){this._region=e,this._boostrapStartTime=0,this._bootstrapEndTime=0,this._scriptLoaderId="oneShellLoader"}return e.prototype.bootstrap=function(){return __awaiter(this,void 0,Promise,(function(){var t=this;return __generator(this,(function(n){return e._hasLoaded?[2]:[2,new Promise((function(n,o){if(!e._isLoading){e._isLoading=!0,t._boostrapStartTime=Date.now();var i=document.createElement("script");i.id=t._scriptLoaderId,i.type="text/javascript",i.src=Object(r.getShellHeaderBootstrapUrl)(t._region),i.crossOrigin="anonymous",i.async=!0,i.onload=t._notifySubscriberOfLoad.bind(t,n),i.onerror=t._notifySubscriberOfFailure.bind(t,o),document.body.appendChild(i)}}))]}))}))},e.prototype.loadNavBarData=function(){return __awaiter(this,void 0,Promise,(function(){var e,t,n;return __generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,PlayerApiHost.CordovaApiHost.Plugins.fetchNavBarData(this._region)];case 1:return e=o.sent(),[2,JSON.parse(e.responseText)];case 2:throw t=o.sent(),n=Object(r.formatOneShellErrorMessage)(t),Core.Telemetry.Log.trackErrorEvent("OneShellGetDataFailed",{message:"One Shell Failed to Get Nav Bar Data",error:n}),t;case 3:return[2]}}))}))},e.prototype._notifySubscriberOfLoad=function(t){this._bootstrapEndTime=Date.now(),Core.Telemetry.Log.trackMetric("OneShellBootstrapLoadTime",this._bootstrapEndTime-this._boostrapStartTime),e._hasLoaded=!0,e._isLoading=!1,t()},e.prototype._notifySubscriberOfFailure=function(t){this._bootstrapEndTime=Date.now(),Core.Telemetry.Log.trackMetric("OneShellBootstrapLoadTimeFailure",this._bootstrapEndTime-this._boostrapStartTime);var n=document.getElementById(this._scriptLoaderId);n&&n.parentElement.removeChild(n),e._isLoading=!1,t()},e.dispose=function(){e._hasLoaded=!1,e._isLoading=!1},e._isLoading=!1,e._hasLoaded=!1,e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"AppDetailsProvider",(function(){return r}));var r=function(){function e(e,t,n,r,o){var i,a,s,l,p=this;this._playerRuntime=e,this._appIdentifier=t,this._publishedAppMetadataPersistedPromiseResolver=n,this._isRootAppMode=r,this._params=o,this._cdnUrl=null!==(a=null===(i=this._params)||void 0===i?void 0:i.cdnUrl)&&void 0!==a?a:null===(l=null===(s=this._playerRuntime.clientRuntime)||void 0===s?void 0:s.clientConfiguration)||void 0===l?void 0:l.playerResourcesEndpoint,Core.Environment.isWebPlayerEncryptedStorageEnabled()&&Core.Environment.getBrowserId()!==Core.Environment.BrowserId.InternetExplorer&&(this._metadataParserCache=new Player.Common.PublishedAppMetadataCache(Core.Loader.ObjectFactory.instance.getSingleton(Core.IO.IAsyncSettingsProviderKey),Core.Loader.ObjectFactory.instance.getSingleton(Core.IO.IEncryptedStorageKey),this._publishedAppMetadataPersistedPromiseResolver)),this._metadataParserConfig={appId:window.webPlayerServerConfig.AppId,cdnPath:this._cdnUrl,webPlayerProxyUrl:Core.Environment.getWebPlayerProxyUrl(),isPublishedAppExternalToHost:Core.Environment.isPublishedAppExternalToHost(),publishedAppHasCachedFiles:Core.Environment.publishedAppHasCachedFiles(),isWebPlayer:Core.Environment.isWebPlayer(),isWebPlayerBVT:window.isWebPlayerBVT,debugConfig:{publishedAppResourceHash:Core.Debug.WebPlayerDebugOverrides.getPublishedAppResourceHash(),publishedAppResourceUrl:Core.Debug.WebPlayerDebugOverrides.getPublishedAppResourceUrl()}};var c=new Core.Lazy((function(){return new AppMagic.Runtime.Client.ListPackageClient(p._appIdentifier,p._playerRuntime.httpClient)}));this._metadataParser=this._isRootAppMode?new Player.Common.RootAppMetadataParser(this._playerRuntime.httpClient,this._metadataParserConfig,c,this._metadataParserCache):new Player.Common.DefaultPublishedAppMetadataParser(this._playerRuntime.httpClient,this._metadataParserConfig,c,this._metadataParserCache)}return Object.defineProperty(e.prototype,"cdnUrl",{get:function(){return this._cdnUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadataParser",{get:function(){return this._metadataParser},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadataParserCache",{get:function(){return this._metadataParserCache},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadataParserConfig",{get:function(){return this._metadataParserConfig},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._metadataParser=null,this._params=null},e.prototype.setAppDetails=function(e,t){var n,r=null,o=null,i=null,a=null,s=!!Core.Environment.getWebPlayerQueryParam(WebPlayerSettings.overridePackager);if(s||WebPlayerSettings.allowDebugOptions&&AppMagic.Runtime.WebPlayerRuntime.isUsingLocalHash())Core.Telemetry.Log.trackActivityEvent("AppDetailsProvider.setAppDetails.Skip",{message:"Skipping setAppDetails due to local override",isPackagerOverridden:s});else{if(e){var l=e.documentVersion,p=e.appVersion;if(r=e.indexWebHtmlUrl,o=null!==(n=e.readonlyIndexWebHtmlUrl)&&void 0!==n?n:e.indexWebHtmlUrl,i=e.appPackageResourcesKind,r&&o&&i)return this._params.appIdWithVersion=r,this._params.appId=window.webPlayerServerConfig.AppId,Core.Telemetry.Log.trackActivityEvent("AppDetailsProvider.setAppDetails",{isPreLaunchApp:!0}),void this._metadataParser.setAppDetails(r,o,i,l,p,encodeURIComponent(JSON.stringify(this._params)),t);a=JSON.stringify({indexWebHtml:r,readonlyIndexWebHtml:o,appPackageResourcesKind:i})}Core.Telemetry.Log.trackActivityEvent("AppDetailsProvider.setAppDetails",{message:e?"Invalid metadata":"Null metadata",provided:a})}},e.prototype.setAppDetailsUsingPreloadData=function(e,t){var n;this._params.appIdWithVersion=e.draftWebPackageUrl?e.draftWebPackageUrl:e.webPackageUrl,this._params.appId=e.id,this._params.appName=e.displayName,this._params.playerSessionId=Core.Telemetry.Log.sessionId,this._params.environmentId=Core.Telemetry.Log.getEnvironmentId(),this._playerRuntime.identityService.hasIdentity&&(this._params.userObjectId=this._playerRuntime.identityService.identity.objectId);var r=e.webPackageUrl,o=e.webReadOnlyPackageUrl,i=e.appType==AppMagic.PowerApps.Constants.AppTypesFromRP.UnifiedApp;e.unauthenticatedWebPackageUrl&&(null===(n=window.webPlayerServerConfig.PublishedAppConfig)||void 0===n?void 0:n.UsesAltAuth)&&(r=e.unauthenticatedWebPackageUrl),e.draftWebPackageUrl&&(r=e.draftWebPackageUrl,o=e.draftWebPackageUrl),r&&o||i&&this._isRootAppMode?this._metadataParser.setAppDetails(r,o,e.appPackageResourcesKind,e.documentServerVersion,e.appVersion,encodeURIComponent(JSON.stringify(this._params)),t):Core.Telemetry.Log.trackActivityEvent("WebPlayerPreloadAppHostManager.createAppHostAndOpenAppUsingPreloadData.SkipSetAppDetails",{appType:e.appType,appName:e.appName})},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"TelemetryManager",(function(){return o}));var r=n(0),o=function(){function e(){}return e.prototype.clearTelemetryFlushTimeout=function(){clearTimeout(this._appLoadedTelemetryFlushTimeout)},e.prototype.flushTelemetry=function(){this.clearTelemetryFlushTimeout(),Core.Telemetry.Log.flush()},e.prototype.logWebPlayerLaunchTelemetry=function(e,t,n,r){var o,i,a;try{a=JSON.stringify(window.webPlayerServerConfig.MetadataCachingResult)}catch(e){a="Failed to stringify metadata results"}var s={webPlayerSource:t,appId:e,apptype:n,connectionType:r,usingSdk:Core.Environment.isUsingWebPlayerSdk(),embedded:Core.Environment.isIframed(),referrer:new Core.Url(document.referrer).host,webPlayerLoadStartDateTime:window.webPlayerLoadStartDateTime,isConsentOnly:window.webPlayerServerConfig.IsConsentOnly,hasCachedFiles:null===(o=window.webPlayerServerConfig.PublishedAppConfig)||void 0===o?void 0:o.HasCachedFiles,staticContentFallbackEnabled:ScriptLoader.WebPlayerUrlMapper._staticContentFallbackEnabled,useStaticContentFallback:ScriptLoader.WebPlayerUrlMapper._useStaticContentFallback,isHostInPreviewMode:Core.Environment.getIsHostInPreviewMode(),metadataSource:window.webPlayerServerConfig.MetadataSource,metadataResults:a,serverMetadataTime:window.webPlayerServerConfig.MetadataTime,cacheMetadataTime:null===(i=window.webPlayerServerConfig.MetadataCachingResult)||void 0===i?void 0:i.cachedMetadataTime},l=Core.Telemetry.Log.startScenario(Core.Telemetry.ScenarioName.WebPlayerLaunchApp,s);return Core.Telemetry.Log.updateOpenAppData({appType:n}),Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.webPlayerAppLaunch,s),l},e.prototype.logWebPlayerServerFeatureGates=function(){Core.Telemetry.Log.trackActivityEvent("WebPlayer.FeatureGates",{ServerFeatureGates:JSON.stringify(window.webPlayerServerConfig.FeatureGates)})},e.prototype.getHostConfig=function(){var e,t,n=Core.Environment.isIframed(),r=null===(t=Core.Environment.getWebPlayerQueryParam(null!==(e=window.WebPlayerSettings.sourceParam)&&void 0!==e?e:"source"))||void 0===t?void 0:t.toLowerCase();return{hostMode:Core.Environment.isSharedAppHost()?"Shared":"StandaloneOnePlayer",isEmbedded:n,source:r,isTeams:Core.Environment.isSkypeTeams()}},e.prototype.setDefaultTelemetryProperties=function(e,t){var n,r,o,i=Core.Telemetry.Log.providerInstance;if(i){var a=e;0!==a.indexOf("https")&&(a=a.substring(0,7));i.setDefaultProperties({webPlayerUrl:Core.Telemetry.Utility.scrubSensitiveDataSafe(a,["appguid","appname","environmentid","screencolor"," disablepreviewredirect","source","authmode","packageproperties","locale","skipiframecreation","hascachedfiles","appId","hidenavbar","tenantid","tenant","skipmetadata","embedderorigin","hint","hostmode","correlationid","sdkversion"]),externalCorrelationId:t,hostMode:Core.Environment.AppHostMode[window.webPlayerServerConfig.HostMode],tenantId:null===(n=window.webPlayerServerConfig.AuthConfig)||void 0===n?void 0:n.TenantId,isTrustedUCI:Core.Environment.isTrustedUCI(),webPlayerScenario:this.getWebplayerScenarioName(),automationSource:this._getAutomationSource(),cloud:window.webPlayerServerConfig.Environment,station:window.webPlayerServerConfig.ServerStation?window.webPlayerServerConfig.ServerStation:"Unknown",telemetryLocation:null===(r=Core.Environment.getTelemetryConfig())||void 0===r?void 0:r.telemetryLocation,geoLocation:null===(o=Core.Environment.getTelemetryConfig())||void 0===o?void 0:o.geoLocation}),Core.Environment.isSkypeTeams()&&microsoftTeams.getContext((function(e){i.setDefaultProperties({teamsSessionId:e.sessionId,teamsAppSessionId:e.appSessionId,teamsAppLaunchId:e.appLaunchId,teamsHostClientType:e.hostClientType,teamsContext:e.frameContext,isMeeting:!!e.meetingId,isChannel:!!e.channelId,isChat:!!e.chatId})}))}},e.prototype.setTelemetryFlushTimeout=function(){this._appLoadedTelemetryFlushTimeout=setTimeout((function(){console.log("AppLoadedEvent Timeout Expired ... Flushing Telemetry"),Core.Telemetry.Log.flush()}),3e4)},e.prototype.getWebplayerScenarioName=function(e){var t=e||this.getHostConfig(),n=t.hostMode;return window.webPlayerServerConfig.IsConsentOnly?Core.Environment.isSharedConsentOnly()?r.L.Consent_Embedded_ModelApp:r.L.Consent_Embedded_CanvasApp:"StandaloneOnePlayer"===n?t.isTeams?r.L.CanvasApp_Embedded_Teams:"spolistformbackground"===t.source||"spolistform"===t.source?r.L.CanvasApp_Embedded_SharePointForm:"spclient-powerappsplayerwebpart"===t.source||"spclient-enhancedpowerappswebpart"===t.source?r.L.CanvasApp_Embedded_ShareWebPart:"powerbiintegration"===t.source||"powerbi"===t.source?r.L.CanvasApp_Embedded_PowerBI:"modeldrivenformintegration"===t.source?r.L.CanvasApp_Embedded_ModelAppForm:t.isEmbedded?r.L.CanvasApp_Embedded_iFrame:r.L.CanvasApp_Standalone:"Shared"===n?window.webPlayerServerConfig.IsTrustedUCI?t.isTeams?r.L.ModelApp_Embedded_Teams:t.isEmbedded?r.L.ModelApp_Embedded_iFrame:r.L.ModelApp_Standalone:r.L.AppHost_Embedded_ModelApp:"Unknown"},e.prototype._getAutomationSource=function(e){var t=e||this.getHostConfig();if("playwright"===t.source||"newrelic"===t.source)return t.source},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"WebPlayerUrlParser",(function(){return r}));var r=function(){function e(){}return e.prototype.parseQueryParams=function(){var e={appId:window.webPlayerServerConfig.AppId,appType:Core.Environment.getWebPlayerQueryParam(WebPlayerSettings.appTypeParam),connectionType:Core.Environment.getWebPlayerQueryParam(WebPlayerSettings.connectionTypeParam),docServerHost:Core.Environment.getWebPlayerQueryParam(WebPlayerSettings.docServerHostParam)||"https://local.create.powerapps.com:44300",draftKey:Core.Environment.getWebPlayerQueryParam(WebPlayerSettings.draftKeyParam)||"",embedderOrigin:Core.Environment.getWebPlayerQueryParam(WebPlayerSettings.embedderOrigin),environmentName:window.webPlayerServerConfig.AppEnvironmentId||Core.Environment.getWebPlayerQueryParam(WebPlayerSettings.environmentNameParam),externalCorrelationId:Core.Environment.getWebPlayerQueryParam(WebPlayerSettings.externalCorrelationIdParam)||"",iframeContainerId:Core.Environment.getWebPlayerQueryParam(WebPlayerSettings.iframeContainerId,!0),source:Core.Environment.getWebPlayerQueryParam(WebPlayerSettings.sourceParam),testDrive:(Core.Environment.getWebPlayerQueryParam(WebPlayerSettings.testDriveParam)||"").toLowerCase()===(!0).toString(),url:Core.Environment.getWebPlayerUrl()};if(WebPlayerSettings.allowDebugOptions){e.useDebugPackage=Core.Environment.getWebPlayerQueryParam(WebPlayerSettings.useDebugPackageParam);var t=Core.Environment.getWebPlayerQueryParam(WebPlayerSettings.useDebugResourceUrlParam),n=Core.Environment.getWebPlayerQueryParam(WebPlayerSettings.useDebugResourceHashParam);Core.Utility.isNonEmptyNonWhitespaceString(e.useDebugPackage)&&(AppMagic.PowerApps.PowerAppsService.setGenerateDebugPlayerPackageLocally(Number(e.useDebugPackage)),Core.Utility.isNonEmptyNonWhitespaceString(t)||(t=window.location.protocol+"//"+window.location.host),Core.Utility.isNonEmptyNonWhitespaceString(n)||(n="webplayer")),Core.Utility.isNonEmptyNonWhitespaceString(t)&&Core.Debug.WebPlayerDebugOverrides.setPublishedAppResourceUrl(t),Core.Utility.isNonEmptyNonWhitespaceString(n)&&Core.Debug.WebPlayerDebugOverrides.setPublishedAppResourceHash(n),e.localHash=Core.Environment.getWebPlayerQueryParam(WebPlayerSettings.localHashParam);var r=parseInt(Core.Environment.getWebPlayerQueryParam(WebPlayerSettings.sasKeyDurationParam),10);e.sasKeyDebugDuration=r>=0?r:null}return e},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"WebPlayerAdalPluginCreator",(function(){return a}));var r=n(18),o=n(27),i=n(10),a=function(){function e(){this._authPlugin=new AppMagic.Runtime.Client.Adal.WebPlayerAdalPlugin({hideAuthDialog:function(){i.WebPlayerSessionExpiredBanner.preventDisplay=!1,r.WebPlayerAuthDialog.hide()},showAuthDialog:function(e,t,n){i.WebPlayerSessionExpiredBanner.preventDisplay=!0,Core.Telemetry.Log.trackActivityEvent("WebPlayer.showAuthDialog",{message:"Displaying AuthDialog for interactive authentication"}),Object(r.display)(e,t,n)},showPopupBanner:function(){Object(o.display)()},onInteractionRequired:function(){AppMagic.Runtime.WebPlayerRuntime.onInteractionRequired()}})}return e.prototype.getAuthenticationPlugin=function(e){return this._authPlugin},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"WebPlayerSdkIntegrator",(function(){return o}));var r="sharepointforms",o=function(e){function t(t,n,r){var o=e.call(this)||this;return o._hostToAppRequests={},o._automationClient=t,o._automationClient.behaviorFunctions.registerDelegateLaunchUrlExecutor((function(e){var t={api:WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.DelegateLaunchUrl,url:e};n(t,"*")})),o._automationClient.behaviorFunctions.registerRequestHideExecutor((function(){n({api:WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.RequestHide},"*")})),o._automationClient.appToHostTelemetryClient.registerSendEventExecutor((function(e,t){var r={api:WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.SendTelemetryEvent,message:e,data:t};n(r,"*")})),o._automationClient.appToHostFunctionsClient.registerSendTriggerExecutor((function(e){var t=Core.GuidGenerator.DefaultInstance.generateGuid(),r=o._registerHostToAppRequest(t),i={api:WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.SendTrigger,requestParameters:e,requestId:t};return n(i,"*"),r.promise})),o._onMessageReceivedHandler=o._onMessageReceived.bind(o),window.addEventListener("message",o._onMessageReceivedHandler),o}return __extends(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),window.removeEventListener("message",this._onMessageReceivedHandler)},t.prototype._registerHostToAppRequest=function(e){var t=Core.PromiseUtils.createCompletablePromise();return this._hostToAppRequests[e]=t,t},t.prototype._onMessageReceived=function(e){var t=this;if(e.data){var n=e.data;if(!n)return;var o=void 0,i=n.originalClickTime,a=Date.now(),s=i?a-i:void 0;switch(n.api){case WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.EditItem:var l=n;Core.Telemetry.Log.trackActivityEvent("WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.EditItem",{itemId:l.itemId,originalClickTime:i,clickToMessageDelta:s}),o=this._automationClient.hostControls.setPropertyValueAsync(r,"SelectedListItemID",parseInt(l.itemId,10)||0).then((function(){return t._automationClient.hostControls.invokeBehaviorAsync(r,"OnEdit")}));break;case WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.ViewItem:var p=n;Core.Telemetry.Log.trackActivityEvent("WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.ViewItem",{itemId:p.itemId,originalClickTime:i,clickToMessageDelta:s}),o=this._automationClient.hostControls.setPropertyValueAsync(r,"SelectedListItemID",parseInt(p.itemId,10)||0).then((function(){return t._automationClient.hostControls.invokeBehaviorAsync(r,"OnView")}));break;case WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.SaveItem:Core.Telemetry.Log.trackActivityEvent("WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.SaveItem"),o=this._automationClient.hostControls.invokeBehaviorAsync(r,"OnSave");break;case WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.NewItem:Core.Telemetry.Log.trackActivityEvent("WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.NewItem",{originalClickTime:i,clickToMessageDelta:s}),o=this._automationClient.hostControls.invokeBehaviorAsync(r,"OnNew");break;case WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.CancelEditItem:Core.Telemetry.Log.trackActivityEvent("WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.CancelEditItem"),o=this._automationClient.hostControls.invokeBehaviorAsync(r,"OnCancel");break;case WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.SetProperty:var c=n;Core.Telemetry.Log.trackActivityEvent("WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.SetProperty",{hostType:c.hostType,propertyName:c.propertyName}),o=this._automationClient.hostControls.setPropertyValueAsync(c.hostType,c.propertyName,c.value);break;case WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.Log:var d=n;Core.Telemetry.Log.trackActivityEvent("WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.Log",{data:Core.Telemetry.Utility.scrubSensitiveDataFromObjectSafe(d.data)});break;case WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.SendTriggerResponse:var u=n,g=u.requestId;u.status,u.data;this._hostToAppRequests.hasOwnProperty(g)&&(this._hostToAppRequests[g].complete(u),delete this._hostToAppRequests[g])}o&&this.trackAnonymous(o)}},t}(Core.Disposable)},function(e,t,n){"use strict";n.r(t),n.d(t,"PublishedAppIframeCacher",(function(){return o}));var r=n(11),o=function(){function e(e,t,n){this._getPublishedAppContainer=e,this._getPublishedAppIframe=t,this._publishedAppIframeCacheId=n}return e.prototype.tryAddCachedPublishedAppIframe=function(e){if(this.isPublishedAppIframePresent())return!1;var t=sessionStorage.getItem(this._publishedAppIframeCacheId);if(!t)return!1;var n=this._getPublishedAppContainer();if(!n)return!1;var o=(new DOMParser).parseFromString(t,"text/html").getElementsByTagName("iframe")[0];return o.referrerPolicy="strict-origin-when-cross-origin",e&&Object(r.updatePublishedAppParamsQuery)(e,o),o=document.adoptNode(o),n.appendChild(o),!0},e.prototype.tryCachePublishedAppIframe=function(){var e=this._getPublishedAppIframe();if(!e)return!1;var t=e.outerHTML;return!!this._tryClearPublishedAppContainer()&&(sessionStorage.setItem(this._publishedAppIframeCacheId,t),!0)},e.prototype.clearCache=function(){sessionStorage.removeItem(this._publishedAppIframeCacheId)},e.prototype.isPublishedAppIframePresent=function(){return!!this._getPublishedAppIframe()},e.prototype._tryClearPublishedAppContainer=function(){var e=this._getPublishedAppContainer();if(!e)return!1;var t=e.cloneNode(!1);return e.parentNode.replaceChild(t,e),!0},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"AddPlayerConnectionComponentFactory",(function(){return o}));var r=n(29),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createComponent=function(e,t,n,o,i){var a=this._createConnectionParameterComponents(e);return{name:"connection-hub-add-player-connection",viewModel:new r.AddPlayerConnectionViewModel(e,t,this._userService,a,n,i,null==o?void 0:o.consentOptions,null==o?void 0:o.connectionName)}},t}(Core.Authoring.ConnectionHub.AddConnectionComponentFactory)},function(e,t,n){"use strict";n.r(t),n.d(t,"AddConnectionDialogViewModel",(function(){return o}));var r=n(7),o=function(e){function t(t,n){var o=this;return(o=e.call(this,{id:"AddConnectionDialogViewModel",message:"",title:t})||this)._addConnectionViewModel=ko.observable(n),o._url=ko.observable(Object(r.getControlPath)("dialogs/addConnectionDialogBody.html")),o}return __extends(t,e),Object.defineProperty(t.prototype,"addConnectionViewModel",{get:function(){return this._addConnectionViewModel()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"description",{get:function(){return""},enumerable:!1,configurable:!0}),t}(Core.UI.Popups.MessageDialogViewModel)},function(e,t,n){"use strict";n.r(t),n.d(t,"ApiScopeDialog",(function(){return o}));var r=n(54),o=function(e){function t(t){var n=this,o=new r.ApiScopeDialogViewModel(t);return n=e.call(this,o)||this,o.buttons.push(new Core.UI.Popups.DialogButtonViewModel(AppMagic.Strings.Close,(function(){return n.close()}))),n}return __extends(t,e),t}(Core.UI.Popups.Dialog)},function(e,t,n){"use strict";n.r(t),n.d(t,"ApiScopeDialogViewModel",(function(){return o}));var r=n(7),o=function(e){function t(t){var n=this;return(n=e.call(this,{id:"ApiScopeDialogViewModel",message:"",title:""})||this)._api=t,n._url=ko.observable(Object(r.getControlPath)("dialogs/ApiScopeDialogBody.html")),n}return __extends(t,e),Object.defineProperty(t.prototype,"displayName",{get:function(){return this._api.displayName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"iconUri",{get:function(){return this._api.iconUri},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"description",{get:function(){return this._api.description},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"will",{get:function(){return this._api.getScopesWill()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wont",{get:function(){return this._api.getScopesWont()},enumerable:!1,configurable:!0}),t}(Core.UI.Popups.MessageDialogViewModel)},function(e,t,n){"use strict";n.r(t),n.d(t,"DebugDialog",(function(){return i}));var r=n(56),o=n(32),i=function(e){function t(t,n){var i=this,a=new o.PlayerDebugViewModel(t,n),s=new r.DebugDialogViewModel(a);return a.closeButtonClicked.addListener((function(){i.close()})),(i=e.call(this,s)||this)._debugDialogViewModel=s,i}return __extends(t,e),t}(Core.UI.Popups.Dialog)},function(e,t,n){"use strict";n.r(t),n.d(t,"DebugDialogViewModel",(function(){return o}));var r=n(7),o=function(e){function t(t){var n=e.call(this)||this;return n._playerDebugViewModel=null,n._url=ko.observable(Object(r.getControlPath)("dialogs/debugDialogBody.html")),n._isUsingLightTheme=!0,n._playerDebugViewModel=t,n}return __extends(t,e),Object.defineProperty(t.prototype,"playerDebugViewModel",{get:function(){return this._playerDebugViewModel},enumerable:!1,configurable:!0}),t}(Core.UI.Popups.DialogViewModel)},function(e,t,n){"use strict";n.r(t),n.d(t,"AppPermissionsDialogViewModel",(function(){return i}));var r=n(19),o=n(7),i=function(e){function t(t){var n=t.appResources,i=t.appName,a=t.displayName,s=t.deviceCapabilities,l=t.authResources,p=t.powerAppsService,c=t.powerAppsClient,d=t.authorEmail,u=t.environment,g=t.missingConnections,m=t.title,h=this;return(h=e.call(this,{id:"AppPermissionsDialogViewModel",title:m||Player.Strings.PermissionsTitle,message:Core.Utility.formatString(Player.Strings.PermissionsMessage,a),dialogHtml:"dialogs/consentDialog.html"})||this)._showMessage=ko.observable(!0),h._url=ko.observable(Object(o.getControlPath)("dialogs/appPermissionsDialogBody.html")),h._appConnections=new r.AppConnectionsViewModel({appResources:n,appName:i,displayName:a,deviceCapabilities:s,authResources:l,powerAppsService:p,powerAppsClient:c,authorEmail:d,environment:u,connectionReferences:g,setShowMessage:function(e){return h._showMessage(e)}}),h}return __extends(t,e),Object.defineProperty(t.prototype,"showMessage",{get:function(){return this._showMessage},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"appConnections",{get:function(){return this._appConnections},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ariaLabel",{get:function(){return"".concat(this.title," ").concat(this.message)},enumerable:!1,configurable:!0}),t}(Core.UI.Popups.MessageDialogViewModel)},function(e,t,n){"use strict";n.r(t),n.d(t,"ConsentOnlyProvider",(function(){return r}));var r=function(){function e(e){this._sendResponseToHost=e,this._consentDialogHandler=new AppMagic.Runtime.App.Host.ConsentDialogHandler,this._disambiguationResults=[]}return e.prototype.showConsentDialogAsync=function(e,t,n,r,o,i,a,s,l,p){return __awaiter(this,void 0,Promise,(function(){var c,d,u,g,m,h,y;return __generator(this,(function(f){switch(f.label){case 0:return[4,this._consentDialogHandler.showConsentDialogAndGetResultAsync(e,t,n,r,o,i,a,s,l,p)];case 1:return c=f.sent(),d=this._disambiguationResults.map((function(e){return{id:e.connection.id,name:e.connection.name,environmentName:e.connection.environmentName,apiId:e.connection.apiId,apiRuntimeUrlString:e.connection.apiRuntimeUrlString,isAuthenticated:e.connection.isAuthenticated,apiScopeWill:e.connection.apiScopes?e.connection.apiScopes.will:null,apiScopeWont:e.connection.apiScopes?e.connection.apiScopes.wont:null,localConnectionId:e.localConnectionId,datasetOverrides:e.datasetOverrides,connectionParamaters:e.connection.connectionParameters}})),u=Core.Telemetry.Log.getOpenAppDataProperties(),g=u.connectionDisambiguationTimeSpent,m=u.connectionDisambiguationStart,h=u.connectionDisambiguationEnd,0===g&&(h=Date.now(),g=Core.PerformanceTracker.exitScopeAndGetRunTime(Core.Telemetry.Strings.userTimeSpentOnAppPermissionsDialog),Core.Telemetry.Log.updateOpenAppData({connectionDisambiguationTimeSpent:g,connectionDisambiguationEnd:h})),y={connections:d,consentApproved:c.approvedConsent,connectionDisambiguationStart:m,connectionDisambiguationEnd:h,connectionDisambiguationTimeSpent:g,consentSessionId:Core.Telemetry.Log.sessionId},this._sendResponseToHost(y),[2,__assign(__assign({},c),{shouldProcessResult:!1})]}}))}))},e.prototype.updateConnections=function(e){var t=this;e.forEach((function(e){t._disambiguationResults.findIndex((function(t){return t.localConnectionId===e.localConnectionId}))<0&&t._disambiguationResults.push(e)}))},e.prototype.updateConsentResultAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2]}))}))},e.prototype.dispose=function(){this._consentDialogHandler.dispose()},e}()},function(e,t,n){"use strict";var r,o,i;n.r(t),function(e){e.Success="Success",e.Failed="Failed",e.SuccessWithErrors="SuccessWithErrors",e.TerminatedOnAppClose="TerminatedOnAppClose",e.Canceled="Canceled"}(r||(r={})),function(e){e.None="None",e.Http="Http"}(o||(o={})),function(e){e[e.error=0]="error",e[e.warning=1]="warning",e[e.success=2]="success",e[e.info=3]="info"}(i||(i={})),n.d(t,"WebPlayerNotificationProvider",(function(){return a}));var a=function(){function e(){this._confirmExit=!1,this._confirmExitMessage=AppMagic.Strings.AppControlConfirmExitDefaultMessage,this._userConfirmedExit=!1}return e.prototype.showToastMessage=function(e){Array.isArray(e.message)?Core.UI.Toast.ToastHandler.showToastInternal({type:e.type,message:e.message,timeout:e.timeout,errorCategory:e.errorCategory,telemetryData:e.telemetryData,clickHandler:e.clickHandler,preventDuplicates:e.preventDuplicates,isSuppressed:e.isSuppressed},"player-toast-area"):Core.UI.Toast.ToastHandler.suspendOnClickToastWithLinks({type:i.error,message:e.message,timeout:e.timeout,errorCategory:e.errorCategory,telemetryData:e.telemetryData,clickHandler:e.clickHandler,targetClass:"player-toast-area",isSuppressed:e.isSuppressed})},e.prototype.clearAllToasts=function(){Core.UI.Toast.ToastHandler.clearAllToasts()},e.prototype.updateConfirmExitProperties=function(e,t){this._confirmExit=e,this._confirmExitMessage=t},e.prototype.confirmExit=function(){return!this._confirmExit||(this._userConfirmedExit=window.confirm(this._confirmExitMessage),this._userConfirmedExit)},e.prototype.confirmExitBeforeUnload=function(){if(!Core.Environment.isSkypeTeams()&&this._confirmExit&&!this._userConfirmedExit)return this._confirmExitMessage},e}()},function(e,t,n){"use strict";n.r(t);var r=function(){function e(e){this._targetWindow=e||window.parent}return e.prototype.addMessageListener=function(e){window.addEventListener("message",e)},e.prototype.removeMessageListener=function(e){window.removeEventListener("message",e)},e.prototype.sendMessageReply=function(e,t){e.source.postMessage(t,e.origin)},e.prototype.sendMessageToTarget=function(e,t){this._targetWindow.postMessage(e,t)},e}(),o=function(){function e(e){void 0===e&&(e=null),this._messageHandler=e,this._count=0,this._onMessageReceived=this._onMessageReceived.bind(this),this._messageHandler||(this._messageHandler=new r),this._iframeId=window.frames.name,this._messageHandler.addMessageListener(this._onMessageReceived),this._pendingCallbacks=Object.create(null)}return e.prototype._generateRequestId=function(){return"".concat(this._count++,"-").concat(Date.now())},e.prototype.sendIframeInitRequest=function(e){var t={messageType:"initCommunication",requestId:null,antiCSRFToken:e,iframeId:null};this.sendMessage(t)},e.prototype.sendMessage=function(e){this._sendMessage(e,null)},e.prototype.sendMessageWithCallback=function(e,t){this._sendMessage(e,t)},e.prototype._sendMessage=function(e,t){e.iframeId=this._iframeId,e.requestId||(e.requestId=this._generateRequestId()),t&&(this._pendingCallbacks[e.requestId]=t),this._messageHandler.sendMessageToTarget(e,"*")},e.prototype.getMessageFromEvent=function(e){var t=e.data;return t&&t.iframeId===this._iframeId?t:null},e.prototype._onMessageReceived=function(e){var t=this.getMessageFromEvent(e);if(t){var n=t.requestId,r=this._pendingCallbacks[n];r&&(r(t),delete this._pendingCallbacks[n])}this.onMessageReceived(e,t)},e.prototype.dispose=function(){this._messageHandler.removeMessageListener(this._onMessageReceived)},e}();n.d(t,"HostSDKMessenger",(function(){return i}));var i=function(e){function t(n,o){void 0===n&&(n=null);var i=this;if(!n){var a=Core.Environment.isTrustedUCI()?document.getElementById("fullscreen-app-host").contentWindow:window.parent;n=new r(a)}return(i=e.call(this,n)||this)._postMessageToSdk=o,t._authResultTable=HashTableUtility.create(),i}return __extends(t,e),t.prototype.init=function(e){this.sendIframeInitRequest(e)},t.prototype.authenticateConnectorAsync=function(e){var n=e.connectorUrl?e.connectorUrl:e;return this._postMessageToSdk({api:WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.OpenConnectorAuthPopup,data:n},"*"),t._authResultTable[e.connectorId]&&(Core.Telemetry.Log.trackErrorEvent("HostSDKMessenger.authenticateConnectorAsync","Received another authentication request for connector ".concat(e.connectorId," before the previous authentication request was completed.")),t._authResultTable[e.connectorId].cancel()),t._authResultTable[e.connectorId]=Core.PromiseUtils.createCancellablePromise(),t._authResultTable[e.connectorId].promise},t.prototype.resizeHost=function(e,t){var n={messageType:"resizeHost",requestId:null,info:e,type:t,iframeId:null};this.sendMessage(n),Core.Telemetry.Log.trackEvent("HostSDKMessenger.resizeHost",{info:e,type:t})},t.prototype.clearPublishedApp=function(){this.sendMessage({messageType:"clearPublishedApp",requestId:null,iframeId:null}),Core.Telemetry.Log.trackEvent("HostSDKMessenger.clearPublishedApp",{})},t.prototype.sendErrorMessage=function(e){var t={messageType:"sendError",requestId:null,iframeId:null,sessionId:Core.Telemetry.Log.sessionId,sharedAppHostError:e};this.sendMessage(t),Core.Telemetry.Log.trackEvent("HostSDKMessenger.sendErrorMessage",{})},t.prototype.sendNotificationMessage=function(e,t){var n={messageType:"sendToast",requestId:null,iframeId:null,sessionId:Core.Telemetry.Log.sessionId,toastMessage:e};this.sendMessageWithCallback(n,t),Core.Telemetry.Log.trackEvent("HostSDKMessenger.sendNotificationMessage",{})},t.prototype.sendLifecycleEvent=function(e){var t={messageType:"sendLifecycleEvent",requestId:null,iframeId:null,sessionId:Core.Telemetry.Log.sessionId,lifecycleEvent:e};this.sendMessage(t)},t.prototype.sendOpenConsentMessage=function(e){var t={messageType:"openConsentPage",requestId:null,iframeId:null,data:e};this.sendMessage(t),Core.Telemetry.Log.trackEvent("HostSDKMessenger.sendOpenConsentMessage",{})},t.prototype.sendCloseConsentMessage=function(){var e={messageType:"closeConsentPage",requestId:null,iframeId:null,sessionId:Core.Telemetry.Log.sessionId};this.sendMessage(e),Core.Telemetry.Log.trackEvent("HostSDKMessenger.sendCloseConsentMessage",{})},t.prototype.sendConsentResultMessage=function(e){var t={messageType:"setConsentResult",requestId:null,iframeId:null,sessionId:Core.Telemetry.Log.sessionId,consentResult:e};this.sendMessage(t),Core.Telemetry.Log.trackEvent("HostSDKMessenger.sendConsentResultMessage",{})},t.prototype.getPreloadConsentServiceData=function(){this.sendMessage({messageType:"getPreloadConsentServiceData",requestId:null,iframeId:null}),Core.Telemetry.Log.trackEvent("HostSDKMessenger.getPreloadConsentServiceData",{})},t.prototype.sendAuthenticateConnectorMessage=function(e){var t={messageType:"authenticateConnector",requestId:null,iframeId:null,data:e};this.sendMessage(t),Core.Telemetry.Log.trackEvent("HostSDKMessenger.sendAuthenticateConnectorMessage",{})},t.prototype.getManifestJsonAsync=function(){var e=Core.PromiseUtils.createCompletablePromise();return this.sendMessageWithCallback({messageType:"getManifestJson",requestId:null,iframeId:null},(function(t){var n=t.resourceData;e.complete(n)})),Core.Telemetry.Log.trackEvent("HostSDKMessenger.getManifestJsonAsync",{}),e.promise},t.prototype.onMessageReceived=function(e,t){if(t){if("sendTelemetry"===t.messageType){var n=t;if(n.messages&&n.messages.length>0)for(var r=0;r<n.messages.length;r++){var o=n.messages[r];Core.Telemetry.Log.trackActivityEvent(o.operationName,o.data)}}t.linkClickHandlerKey&&Core.UI.Toast.ToastHandler.onClick(t.linkClickHandlerKey)}},t}(o)},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t),n.d(t,"TestEventDispatcher",(function(){return r}));var r=function(){function e(){this._eventDispatcher=new EventObject}return Object.defineProperty(e.prototype,"eventDispatcher",{get:function(){return this._eventDispatcher},enumerable:!1,configurable:!0}),e.prototype.start=function(){},e.prototype.dispatchEvent=function(e){this._eventDispatcher.dispatch(e)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"TestHooksHelper",(function(){return r}));var r=function(){function e(){}return e.OpenSienapkgFile=function(e,t){var n;Core.Log.verbose("[Testhooks.openSienaPkgFile] Opening .msappk file."),Core.IO.FileSystem.getAppDataFolderAsync().then((function(e){return Core.Log.verbose("[Testhooks.openSienaPkgFile] Creating {0} file.","temp.msappk"),e.getOrCreateFile("temp.msappk")})).then((function(t){return n=t,Core.Log.verbose("[Testhooks.openSienaPkgFile] Converting base64 to blob."),Core.IO.Utility.Conversion.base64ToBlob(e,"application/octet-stream")})).then((function(e){return Core.Log.verbose("[Testhooks.openSienaPkgFile] Writing blob to file."),n.writeBlobAsync(e)})).then((function(){var e={type:Core.Lifecycle.LifecycleEventType.OpenFromFile,file:n};Core.Log.verbose("[Testhooks.openSienaPkgFile] Dispatching package open event."),t.dispatchEvent(e)}),(function(e){return Core.Log.verbose("Testhooks: Opening sienapkg file failed with following error: {0}",e)}))},e.setPlayerResourcesZipUrlOverride=function(e){Core.Environment.setPlayerResourcesZipUrlOverride(e)},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"WebPlayerCSATDialog",(function(){return r}));var r=function(){function e(){}return e.promptForCsatIfNeededAsync=function(e,t,n,r,o){return __awaiter(this,void 0,Promise,(function(){var i;return __generator(this,(function(a){switch(a.label){case 0:return Core.Environment.isSovereignCloudRegion(o)||r||Core.Environment.isNpsServiceDisabled()?[3,3]:[4,e.getNpsDialogUrlIfNeededAsync("powerappsweb",0,this._getPlayerNpsCustomData(t,n))];case 1:return(i=a.sent())?[4,new Core.UI.NpsDialog(i,AppMagic.PowerApps.NpsUrlOrigin).showAsync()]:[3,3];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))},e._getPlayerNpsCustomData=function(e,t){return{Origin:"webplayer",version:Core.Environment.Version.VERSION_NUMBER,browser:Core.Environment.BrowserId[Core.Environment.getBrowserId()],AppId:e,AppName:t,SessionId:Core.Telemetry.Log.sessionId}},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"ConsentDialogHandler",(function(){return a}));var r=n(16),o=n(12),i=n(22),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._consentDialogPromisesToDispose=[],t}return __extends(t,e),t.prototype.showConsentDialogAndGetResultAsync=function(e,t,n,a,s,l,p,c,d,u){var g;return void 0===t&&(t=!1),void 0===u&&(u=!1),__awaiter(this,void 0,Promise,(function(){var m,h,y,f,v,C,P,b,_,A,S=this;return __generator(this,(function(w){switch(w.label){case 0:m=!1,h=!0,w.label=1;case 1:if(!h)return[3,11];if(this._disposeRunningConsentDialog(),!(null===(g=window.webPlayerServerConfig.FeatureGates)||void 0===g?void 0:g.UsePPUXConsentDialogService)||"true"===Core.Environment.getWebPlayerQueryParam("useOldConnectionConsent"))return[3,6];y=Date.now(),Core.Telemetry.Log.updateOpenAppData({connectionDisambiguationStart:y}),f=new Promise((function(e,t){o.display({onSuccess:function(){return __awaiter(S,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:return o.close(),[4,l.appResourceManager.getAppResourcesAsync(p.appId,!0,!1,!0)];case 1:return n=t.sent(),e(!0),[2]}}))}))},onFailure:function(){o.close(),t(!1)},appResources:n})})),this._consentDialogPromisesToDispose.push(f),w.label=2;case 2:return w.trys.push([2,4,,5]),[4,f];case 3:return m=w.sent(),[3,5];case 4:return w.sent(),m=!1,[3,5];case 5:return v=Date.now()-y,Core.Telemetry.Log.updateOpenAppData({connectionDisambiguationTimeSpent:v,connectionDisambiguationEnd:Date.now(),success:m}),[3,8];case 6:return C=n.appInfo,P={appName:C.name,displayName:C.displayName,missingConnections:e,deviceCapabilities:s,authResources:a,powerAppsService:c,powerAppsClient:d,environment:C.environment.name,authorEmail:C.owner?C.owner.email:"",appResources:n},t&&(P.title=Player.Strings.PermissionsTitleAppAlreadyRunning,P.approveButtonTitle=Player.Strings.PermissionsButtonLaunchAppAlreadyRunning),b=Object(i.createAppPermissionsDialog)(P),this._appPermissionsDialog=b,_=b.showAsync(),this._consentDialogPromisesToDispose.push(_),[4,_];case 7:switch(w.sent()){case b.approveButtonTitle:m=!0;break;default:m=!1}w.label=8;case 8:return(h=u&&!m)?(A=new Promise((function(e){r.display({appDisplayName:n.appInfo.displayName,onCloseButtonClick:function(){e()}})})),this._consentDialogPromisesToDispose.push(A),[4,A]):[3,10];case 9:w.sent(),w.label=10;case 10:return[3,1];case 11:return[2,{approvedConsent:m,appResources:n}]}}))}))},t.prototype.dispose=function(){this._disposeRunningConsentDialog(),e.prototype.dispose.call(this)},t.prototype._disposeRunningConsentDialog=function(){var e;this._consentDialogPromisesToDispose=[],null===(e=this._appPermissionsDialog)||void 0===e||e.close(),this._appPermissionsDialog=null,o.close(),r.close()},t}(Core.Disposable)},function(e,t,n){"use strict";n.r(t),n.d(t,"DefaultConsentProvider",(function(){return r}));var r=function(){function e(){this._consentDialogHandler=new AppMagic.Runtime.App.Host.ConsentDialogHandler}return e.prototype.showConsentDialogAsync=function(e,t,n,r,o,i,a,s,l,p){return __awaiter(this,void 0,Promise,(function(){var c;return __generator(this,(function(d){switch(d.label){case 0:return[4,this._consentDialogHandler.showConsentDialogAndGetResultAsync(e,t,n,r,o,i,a,s,l,p)];case 1:return c=d.sent(),[2,__assign(__assign({},c),{shouldProcessResult:!0})]}}))}))},e.prototype.updateConnections=function(e){},e.prototype.updateConsentResultAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2]}))}))},e.prototype.dispose=function(){this._consentDialogHandler.dispose()},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"StandaloneConsentProvider",(function(){return i}));var r=n(24),o=n(3),i=function(){function e(){}return e.prototype.showConsentDialogAsync=function(e,t,n,i,a,s,l,p,c,d){this._userService=s,this._appInfoCore=l,Core.Telemetry.Log.trackActivityEvent("PowerAppsClient.OpenStandaloneConsentDialog"),this._consentServiceStartTime=Date.now();var u=Object(r.serializeAppResources)(n);return o.WebPlayerRuntime.postMessageToSdk({api:WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.OpenConsentPage,data:{appResourcePayload:u,initConsentServiceTimeStamp:Date.now()}}),this._disambiguationPromise=Core.PromiseUtils.createCompletablePromise(),this._disambiguationPromise.promise},e.prototype.updateConnections=function(e){},e.prototype.updateConsentResultAsync=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n,r,o,i,a,s,l,p;return __generator(this,(function(c){switch(c.label){case 0:return t=Date.now()-this._consentServiceStartTime,n=e.connections,r=e.consentApproved,o=e.consentSessionId,i=e.connectionDisambiguationTimeSpent,a=e.connectionDisambiguationStart,s=e.connectionDisambiguationEnd,Core.Telemetry.Log.trackActivityEvent("PowerAppsClient.StandaloneConsentDialogClosed",{consentApproved:r,consentSessionId:o,connectionDisambiguationTimeSpent:i}),Core.Telemetry.Log.updateOpenAppData({connectionDisambiguationStart:a,connectionDisambiguationEnd:s,connectionDisambiguationTimeSpent:i,consentServiceTotalDuration:t}),this._consentServiceStartTime=null,l={approvedConsent:r,appResources:null,shouldProcessResult:!0,connections:n},r?[4,this._userService.appResourceManager.getAppResourcesAsync(this._appInfoCore.appId,!0,!1,!0)]:[3,2];case 1:p=c.sent(),l.appResources=p,c.label=2;case 2:return this._disambiguationPromise.complete(l),[2]}}))}))},e.prototype.dispose=function(){},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"StandaloneConsentRuntime",(function(){return a}));var r=n(17),o=n(58),i=n(24),a=function(){function e(e,t){void 0===e&&(e=r.AppHostRuntime.getInstance()),void 0===t&&(t=null);var n=this;this._appHostRuntime=e,this._consentProvider=t,this._handleMessage=function(e){var t=e.data;switch(null==t?void 0:t.api){case WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.GetPreloadConsentServiceData:try{Object(i.completeGetAppResourcesPromise)(t,n._getAppResourcesCompletablePromise)}catch(e){n.handleErrorAndCleanUp(e)}}},this._getAppResourcesCompletablePromise=Core.PromiseUtils.createCompletablePromise(),this._consentProvider=new o.ConsentOnlyProvider((function(e){n._postMessageToHost({api:WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.SetConsentResult,data:e})}))}return e.getInstance=function(){return e._standaloneRuntime||(e._standaloneRuntime=new e),e._standaloneRuntime},Object.defineProperty(e.prototype,"_webPlayerParams",{get:function(){return this._appHostRuntime.webPlayerParams},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_playerRuntime",{get:function(){return this._appHostRuntime.playerRuntime},enumerable:!1,configurable:!0}),e.prototype.startAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:if(t.trys.push([0,3,,4]),this._appHostRuntime.initialize(),this._hostMessageProvider=Core.Loader.ObjectFactory.instance.getSingleton(Core.Player.IHostMessageProviderSingletonKey),!this._webPlayerParams.appId)throw new Error("Unable to get app Id from url");return window.addEventListener("message",this._handleMessage),Core.Telemetry.Log.openConsentDialogOnlyStartEvent(),window.CurrentActiveView=ko.observable(),[4,this._appHostRuntime.appHost.loaded.waitAsync()];case 1:return t.sent(),this._appHostRuntime.logWebPlayerLaunchTelemetry(),[4,this._getAppAndRunAsync()];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),this.handleErrorAndCleanUp(e),[3,4];case 4:return[2]}}))}))},e.prototype._getAppAndRunAsync=function(){return __awaiter(this,void 0,Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return Core.Telemetry.Log.trackActivityEvent(Core.Telemetry.Strings.webPlayerGetApp),this._playerRuntime.userService.skipEnroll(),this._postMessageToHost({api:WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.GetPreloadConsentServiceData}),[4,this._getAppResourcesCompletablePromise.promise];case 1:return e=t.sent(),this._runConnectionConsent(e),[2]}}))}))},e.prototype._runConnectionConsent=function(e){return __awaiter(this,void 0,Promise,(function(){var t,n,r,o;return __generator(this,(function(i){switch(i.label){case 0:return t=this._playerRuntime.userService.appResourceManager.getAppPreloadDataFromAppInfo(e.appInfo.id,e),n=Core.Environment.getDeviceId(),Core.Telemetry.Log.trackActivityEvent("WebPlayerRuntime.ClientControlConnectorAndDeviceCapabilities",{device:Core.Environment.DeviceId[n],requestedCapabilities:null==t?void 0:t.deviceCapabilities,connectionIds:null==t?void 0:t.connectionIds,isTeams:Core.Environment.isSkypeTeams(),isMobile:Core.Environment.isMobileDevice()}),document.title="".concat(t.displayName," - ").concat(AppMagic.Strings.PowerApps),r=new Player.Common.AppInfoPlayerAdapter(t),(o=this._playerRuntime.createAppHost(r,t.appConnectionUsages,t.connectionIds,t.authResources,this._getAppManager(),Promise.resolve(e),this._consentProvider,null)).initialize(),[4,o.loadAsync()];case 1:return i.sent(),[4,o.powerAppsClient.loadAppConnectionsAsync(!1,!1)];case 2:return i.sent(),this._postMessageToHost({api:WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.CloseConsentPage}),[2]}}))}))},e.prototype._getAppManager=function(){return{isAppLoaded:!1,exitHostedApp:function(){},exitCurrentAppAsync:function(e){return Promise.resolve()},notifyAppErrorState:function(e){},notifyAppExitRequested:function(){throw new Error("Not implemented")}}},e.prototype._postMessageToHost=function(e,t){if(void 0===t&&(t="*"),Core.Environment.isUsingWebPlayerSdk()&&window.parent){var n=this._webPlayerParams.appId,r=this._webPlayerParams.iframeContainerId;e=Object.assign(e,{appId:n,containerId:r}),window.parent.postMessage(e,t)}else if(Core.Environment.isSharedConsentOnly())switch(e.api){case WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.CloseConsentPage:return this._hostMessageProvider.sendCloseConsentMessage();case WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.SetConsentResult:return this._hostMessageProvider.sendConsentResultMessage(e.data);case WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.GetPreloadConsentServiceData:return this._hostMessageProvider.getPreloadConsentServiceData();case WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.OpenConnectorAuthPopup:return this._hostMessageProvider.sendAuthenticateConnectorMessage(e.data);default:Core.Telemetry.Log.trackErrorEvent("AppHostRuntime.postMessageToSdk",{message:"Received API ".concat(e.api," which is invalid.")})}},e.prototype.handleErrorAndCleanUp=function(e){var t,n=null!==(t=Core.PromiseUtils.formatError(e))&&void 0!==t?t:"Unknown Error",r=Core.DiagnosticError.tryGetDiagnosticMessage(e),o={message:Core.Telemetry.Utility.scrubSensitiveDataSafe(n),url:Core.Telemetry.Utility.scrubSensitiveDataSafe(window.location.href),errorDetails:Core.Telemetry.Utility.scrubSensitiveDataSafe(r)};Core.Telemetry.Log.trackErrorEvent(Core.Telemetry.Strings.webPlayerError,o),this._appHostRuntime.flushTelemetry(),Core.Environment.isUsingWebPlayerSdk()&&window.parent&&this._postMessageToHost({api:WebPlayer.Sdk.PowerAppsEmbeddingCallbackApi.AppFailed,data:{errorMessage:Core.Telemetry.Utility.scrubSensitiveDataSafe(n)}},"*")},e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"MessageChannel",(function(){return r}));var r=function(){function e(e,t,n){void 0===n&&(n=void 0),this._antiCSRFToken=t,this._targetOrigin=n,this._onCallbackMessageHandler=null,this._onPluginCallMessageHandler=null,this._unpostedMessages=[],this._iframe=e,this._onPluginCallMessageHandler=this._onNativePluginCallFromAppHostToPlayer.bind(this),this._onCallbackMessageHandler=this._onScriptResultFromAppHostToPlayer.bind(this),window.addEventListener("message",this._onCallbackMessageHandler),this._iframe&&(this._postMessageLocation=e.contentWindow),this._messagePortTracker=new Collections.Generic.Dictionary}return Object.defineProperty(e.prototype,"antiCSRFToken",{get:function(){return this._antiCSRFToken},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"targetOrigin",{get:function(){return this._targetOrigin},enumerable:!1,configurable:!0}),e.prototype.start=function(){if(window.addEventListener("message",this._onPluginCallMessageHandler),window.messageHoldingQueue&&window.messageHoldingHandler){window.removeEventListener("message",window.messageHoldingHandler);for(var e=0;e<window.messageHoldingQueue.length;e++)this._onPluginCallMessageHandler(window.messageHoldingQueue[e]);delete window.messageHoldingQueue,delete window.messageHoldingHandler}Core.Telemetry.Log.trackActivityEvent("AppHostAPIHandler.apiHandlerStarted")},e.prototype.postMessage=function(e,t,n){if(n&&this._messagePortTracker.containsKey(n)){var r=this._messagePortTracker.getValue(n);t?r.postMessage(e,t):r.postMessage(e)}else this._postMessageLocation?t?this._postMessageLocation.postMessage(e,"*",t):this._postMessageLocation.postMessage(e,"*"):this._unpostedMessages.push(e)},e.prototype.dispose=function(){this._onCallbackMessageHandler&&(window.removeEventListener("message",this._onCallbackMessageHandler),this._onCallbackMessageHandler=null),this._onPluginCallMessageHandler&&(window.removeEventListener("message",this._onPluginCallMessageHandler),this._onPluginCallMessageHandler=null),this._messagePortTracker=null,this._iframe=null,this._postMessageLocation=null},e.prototype._onNativePluginCallFromAppHostToPlayer=function(e){var t;Core.Log.verbose("Call to native plugin received from app: "+JSON.stringify(e.data));var n=e.data;if(n&&!0===n.isPluginCall){if(this.antiCSRFToken!==n.antiCSRFToken){var r={expectedCSRFToken:this.antiCSRFToken,actualCSRFToken:n.antiCSRFToken,serviceName:n.service,actionName:n.action};return Core.Telemetry.Log.trackEvent(Core.Telemetry.Strings.invalidAntiCSRFToken,r),Core.Telemetry.Log.trackActivityEvent("PlayerLifecycle.PlayerSDK.PlayApp.LoadApp.CreateAppFrame.AppIframeReloaded"),void(null===(t=this.onReloadIframe)||void 0===t||t.call(this,!0))}if(!this._isValidOrigin(e.origin))return void Core.Telemetry.Log.trackActivityEvent("PowerAppsClient.AppHostAPIHandler.InvalidOrigin",{message:"Message origin is invalid. Expected Origin: ".concat(this.targetOrigin,"  Actual Origin: ").concat(e.origin)});null==this||this.onPluginCall(n)}},e.prototype._isValidOrigin=function(e){return!this.targetOrigin||e.toLowerCase()===this.targetOrigin},e.prototype._onScriptResultFromAppHostToPlayer=function(e){var t,n,r=this;Core.Log.verbose("Call returning script result received from app: "+JSON.stringify(e.data));var o=e.data;if(o&&!1===o.isPluginCall)null===(t=this.onCallback)||void 0===t||t.call(this,o);else if(o)switch(o.messageType){case"initCommunication":Core.Telemetry.Log.trackActivityEvent("IframeCommunicationChannel.InitializedCommunication"),this._postMessageLocation=window.parent.frames[o.iframeIdToSendMessagesTo];for(var i=0;i<this._unpostedMessages.length;i++)this._postMessageLocation.postMessage(this._unpostedMessages[i],"*");break;case"initCommunicationWithPort":var a="IframeCommunicationChannel.initCommunicationWithPort",s=null===(n=e.ports)||void 0===n?void 0:n[0];if(!o.instanceId){Core.Telemetry.Log.trackErrorEvent(a,{errorMessage:"initCommunicationWithPort request received without instance ID."});break}s?this._messagePortTracker.containsKey(o.instanceId)?Core.Telemetry.Log.trackErrorEvent(a,{errorMessage:"initCommunicationWithPort request received with duplicate instance ID."}):(Core.Telemetry.Log.trackActivityEvent(a,{message:"Port Instance ID: ".concat(o.instanceId)}),this._messagePortTracker.addValue(o.instanceId,s),s.onmessage=this._onNativePluginCallFromAppHostToPlayer.bind(this),this._unpostedMessages.forEach((function(e){r.postMessage(e,null,o.instanceId)}))):Core.Telemetry.Log.trackErrorEvent(a,{errorMessage:"initCommunicationWithPort request received but port was not passed."});break;case"initMessagePort":var l="IframeCommunicationChannel.initMessagePort";e.ports&&e.ports.length>0?this._messagePortTracker.containsKey(o.instanceId)?Core.Telemetry.Log.trackErrorEvent(l,{errorMessage:"initMessagePort request received with duplicate instance ID."}):(Core.Telemetry.Log.trackActivityEvent(l),this._messagePortTracker.addValue(o.instanceId,e.ports[0])):Core.Telemetry.Log.trackErrorEvent(l,{errorMessage:"initMessagePort request received but port was not passed."});break;case"disposeMessagePort":this._messagePortTracker.containsKey(o.instanceId)?this._messagePortTracker.deleteValue(o.instanceId):Core.Telemetry.Log.trackActivityEvent("IframeCommunicationChannel.disposeMessagePort",{errorMessage:"disposeMessagePort received with invalid instance ID."})}return Promise.resolve()},Object.defineProperty(e.prototype,"appHostElement",{get:function(){return this._iframe},enumerable:!1,configurable:!0}),e}()},function(e,t,n){"use strict";var r,o,i,a,s;function l(e){var t=[],n=e.controls;for(var r in n)r&&t.push(r.toLowerCase());return t}function p(e){var t={};e.staticDependencies&&e.staticDependencies.forEach((function(e){t[e.sourcePath.toLocaleLowerCase()]=e.sourceUrl}));var n=e.controlDependencies;for(var r in n)r&&n[r].forEach((function(e){e&&e.sourcePath&&(t[e.sourcePath.toLocaleLowerCase()]=e.sourceUrl)}));return t}function c(e){var t=[];return(null==e?void 0:e.app)&&(t=e.app),t}function d(e){var t,n={};return(null===(t=null==e?void 0:e.dataComponentDependencies)||void 0===t?void 0:t.expressionRuntime)&&e.dataComponentDependencies.expressionRuntime.forEach((function(e){n[e.sourcePath.toLocaleLowerCase()]=e.sourceUrl})),n}function u(e,t){var n,r=[];return(null===(n=null==e?void 0:e.dataComponentDependencies)||void 0===n?void 0:n[t])&&(r=e.dataComponentDependencies[t]),r}function g(e){for(var t,n,r,o,i=(new DOMParser).parseFromString(e,"text/html").head.getElementsByTagName("script"),a=[],s=0;s<i.length;s++){var l=i[s].text;-1!==l.indexOf("AppResources")?t=i[s].innerText:-1!==l.indexOf("AppPrefetchResources")?n=i[s].innerText:-1!==l.indexOf("LanguageSpecificResources")?r=i[s].innerText:-1!==l.indexOf("PowerAppsTitle")?o=i[s].innerText:a.push(i[s].outerHTML)}return{appResourcesScript:t,prefetchAppResourcesScript:n,languageResourcesScript:r,powerAppsTitleScript:o,headerScripts:a}}!function(e){e[e.InternalServerError=500]="InternalServerError",e[e.ServiceUnavailable=503]="ServiceUnavailable"}(r||(r={})),function(e){e.PublishedAppGetAppDetails="PublishedAppGetAppDetails",e.WebPlayerDownloadManifest="WebPlayerDownloadManifest",e.WebPlayerDownloadManifestRetry="WebPlayerDownloadManifestRetry",e.WebPlayerDownloadIndex="WebPlayerDownloadIndex",e.WebPlayerDownloadIndexRetry="WebPlayerDownloadIndexRetry",e.PlayerLifecyclePlayerSDKPlayAppLoadMetadataFetchAppPackageMetadata="PlayerLifecyclePlayerSDKPlayAppLoadMetadataFetchAppPackageMetadata"}(o||(o={})),function(e){e[e.split=0]="split",e[e.zip=1]="zip",e[e.unknown=2]="unknown"}(i||(i={})),function(e){e.WebPackageUrl="WebPackageUrl",e.UnauthenticatedWebPackageUrl="UnauthenticatedWebPackageUrl"}(a||(a={})),function(e){e[e.NotStart=0]="NotStart",e[e.InProgress=1]="InProgress",e[e.Processed=2]="Processed",e[e.Error=3]="Error"}(s||(s={}));var m=function(){function e(e,t){this._indexHtmlDownloader=e.indexHtmlDownloader,this._manifestJsonDownloader=e.manifestJsonDownloader,this._telemetryLogger=e.telemetryLogger,this._appMetadataResponseProcessor=e.appMetadataResponseProcessor,this._config=t,this._isInDebugMode=this._checkIfUsingDebugConfig(this._config.debugConfig)}return e.prototype._checkIfUsingDebugConfig=function(e){return e&&"string"==typeof e.publishedAppResourceHash&&"string"==typeof e.publishedAppResourceUrl},e.prototype._scrubOtherSensitiveDataSafe=function(e){var t=this;try{if(new RegExp(/(password|token|key|sig)/i).test(e)){var n=e;return["password","token","key","sig"].forEach((function(e){n=t._replaceRestOfStringIfFound(n,e,"_scrubbedSensitiveData_")})),n.toString()}return e}catch(e){return this._telemetryLogger.trackErrorEvent("BasePublishedAppMetadataParser._scrubOtherSensitiveDataSafe",{errorMessage:e.message,message:"Failed to scrub sensitive data from the URL"}),""}},e.prototype._replaceRestOfStringIfFound=function(e,t,n){return e.toLowerCase().indexOf(t)>0?e.replace(e.substring(e.toLowerCase().indexOf(t)),n):e},e.prototype.setAppDetails=function(t,n,r,o,i,a,s){var l=e._getSASKeyExpiryDate(t).getTime(),p=Date.now()+9e5,c=this._scrubOtherSensitiveDataSafe(t),d=this._scrubOtherSensitiveDataSafe(n);l<p?this._telemetryLogger.trackErrorEvent("BasePublishedAppMetadataParser.setAppDetails",{scrubbedIndexWebHtmlUrl:c,scrubbedReadonlyIndexWebHtmlUrl:d,source:s,errorMessage:"SAS key expired or very close to expire."}):(this._telemetryLogger.trackActivityEvent("BasePublishedAppMetadataParser.setAppDetails",{documentServerVersion:o?JSON.stringify(o):"",scrubbedIndexWebHtmlUrl:c,scrubbedReadonlyIndexWebHtmlUrl:d,source:s}),this._appVersion=i,this._updatedHash=a,this._primaryWebPlayerPackageUrl=t,this._secondaryWebPlayerPackageUrl=n,this._appPackageResourcesKind=r,this._documentServerVersion=o,this._packageKind=this._getPackageKindConfig(r,{isInDebugMode:this._isInDebugMode,isWebPlayerBVT:this._config.isWebPlayerBVT}),this._primaryWebPlayerManifestUrl=this._primaryWebPlayerPackageUrl.replace("index.web.html","manifest.json"),this._secondaryWebPlayerManifestUrl=this._secondaryWebPlayerPackageUrl.replace("index.web.html","manifest.json"),this._currentWebPlayerPackageUrl=this._primaryWebPlayerPackageUrl,this._currentWebPlayerManifestUrl=this._primaryWebPlayerManifestUrl,this._overrideSVGUpdateFunction=!o||o.minor<18e3&&o.major<3,this._overrideSVGUpdateFunction&&this._telemetryLogger.trackActivityEvent("WebPlayer.SVGUpdate.OverrideFunction"),this._isAppMetadataSet=!0)},e.prototype.getAppDetails=function(e,t){var n=this;if(!this._config.isWebPlayer)throw this._telemetryLogger.error("PublishedAppMetadataParser.getAppDetails","GetAppDetails should only be called in web player"),"Not supported";this._isAppMetadataSet||e.onFailure(new Error("Please make sure you call setAppDetails first"));var r,a,l,p,c,d,u,g=this._telemetryLogger.startScenario(o.PublishedAppGetAppDetails,new Date,{}),m={manifestType:"publishedApp"},h=this._telemetryLogger.startScenario(o.PlayerLifecyclePlayerSDKPlayAppLoadMetadataFetchAppPackageMetadata,new Date,__assign(__assign({},m),{operationName:"PlayerLifecycle.PlayerSDK.PlayApp.LoadMetadata.FetchAppPackageMetadata"}));this._telemetryLogger.updateOpenAppData({playerResourcesSplitEnabled:this._packageKind===i.split});var y=this._generateEmptyError(),f=this._generateEmptyError(),v=s.NotStart,C=s.NotStart;v=s.InProgress,this._downloadResourceImpl("manifest",{onSuccess:function(t){if(r=n._appMetadataResponseProcessor.getWebPlayerZipDetails(t,n._packageKind,n._isInDebugMode),a=n._appMetadataResponseProcessor.getSplitPackageDetails(t,n._packageKind),l=n._appMetadataResponseProcessor.generateWebPlayerDetails(n._currentWebPlayerPackageUrl),p=n._appMetadataResponseProcessor.generateWebPlayerResourceDetails(),d=n._appMetadataResponseProcessor.getDataComponentPackageDetails(t,n._packageKind),u=n._appMetadataResponseProcessor.getComponentLibraryPackageDetails(t,n._packageKind),v=s.Processed,C===s.Processed){n._telemetryLogger.endScenario(g),n._telemetryLogger.endScenario(h,m);var o={packageKind:n._packageKind,webPlayerZipDetails:r,webPlayerPackageDetails:l,webPlayerResourceDetails:p,splitPackageDetails:a,scriptPackageDetails:c,overrideSVGUpdateFunction:n._overrideSVGUpdateFunction,appVersion:n._appVersion,appId:n._config.appId};d&&(o.dataComponentPackageDetails=d),u&&(o.componentLibraryPackageDetails=u),e.onSuccess(o)}else C===s.Error&&(n._telemetryLogger.failScenario(g,{}),n._telemetryLogger.failScenario(h,{customScenarioData:__assign({manifestParsingState:n._getProcessStateString(v),htmlParsingState:n._getProcessStateString(C)},m)}),e.onFailure(n._mergeErrorMessage(y,f)))},onFailure:function(t){y=t,v=s.Error,C!==s.Processed&&C!==s.Error||(n._telemetryLogger.failScenario(g,{}),n._telemetryLogger.failScenario(h,{customScenarioData:__assign({manifestParsingState:n._getProcessStateString(v),htmlParsingState:n._getProcessStateString(C)},m)}),e.onFailure(n._mergeErrorMessage(y,f)))}},t,!0),C=s.InProgress,this._downloadResourceImpl("index",{onSuccess:function(t){if(c=n._appMetadataResponseProcessor.generateScriptPackageDetails(t,n._updatedHash),C=s.Processed,v===s.Processed){n._telemetryLogger.endScenario(g),n._telemetryLogger.endScenario(h,m);var o={packageKind:n._packageKind,webPlayerZipDetails:r,webPlayerPackageDetails:l,webPlayerResourceDetails:p,splitPackageDetails:a,scriptPackageDetails:c,overrideSVGUpdateFunction:n._overrideSVGUpdateFunction,appVersion:n._appVersion,appId:n._config.appId};d&&(o.dataComponentPackageDetails=d),u&&(o.componentLibraryPackageDetails=u),e.onSuccess(o)}else v===s.Error&&(n._telemetryLogger.failScenario(g,{}),n._telemetryLogger.failScenario(h,{customScenarioData:__assign({manifestParsingState:n._getProcessStateString(v),htmlParsingState:n._getProcessStateString(C)},m)}),e.onFailure(n._mergeErrorMessage(y,f)))},onFailure:function(t){f=t,C=s.Error,v!==s.Processed&&v!==s.Error||(n._telemetryLogger.failScenario(g,{}),n._telemetryLogger.failScenario(h,{customScenarioData:__assign({manifestParsingState:n._getProcessStateString(v),htmlParsingState:n._getProcessStateString(C)},m)}),e.onFailure(n._mergeErrorMessage(y,f)))}},t,!0)},e.prototype.getAppBaseMetadata=function(){return{indexWebHtmlUrl:this._primaryWebPlayerPackageUrl,readonlyIndexWebHtmlUrl:this._secondaryWebPlayerPackageUrl,appPackageResourcesKind:this._appPackageResourcesKind,documentServerVersion:this._documentServerVersion,appVersion:this._appVersion}},e.prototype._generateEmptyError=function(){var e=new Error;return e.name="",e.message="",e.stack="",e},e.prototype._mergeErrorMessage=function(e,t){var n=new Error;return n.name="Failed to get and parse appMetadata",n.message=e.message+"\n"+t.message,n.stack=e.stack+"\n"+t.stack,n},e.prototype.getAppControls=function(e,t){var n=this;this._downloadResourceImpl("manifest",{onSuccess:function(t){var r=n._appMetadataResponseProcessor.parseControlsListFromManifest(t);e.onSuccess(r)},onFailure:function(t){e.onFailure(t)}},t,!0)},e.prototype.getAppDependencies=function(e,t){this._downloadResourceImpl("manifest",{onSuccess:function(t){e.onSuccess(t)},onFailure:function(t){e.onFailure(t)}},t,!0)},e.prototype._downloadResourceImpl=function(e,t,n,r){var i=this,a="index"===e?o.WebPlayerDownloadIndex:o.WebPlayerDownloadManifest;r?"index"===e?this._currentWebPlayerPackageUrl=this._primaryWebPlayerPackageUrl:this._currentWebPlayerManifestUrl=this._primaryWebPlayerManifestUrl:"index"===e?this._currentWebPlayerPackageUrl=this._secondaryWebPlayerPackageUrl:this._currentWebPlayerManifestUrl=this._secondaryWebPlayerManifestUrl;var s="index"===e?this._indexHtmlDownloader:this._manifestJsonDownloader,l=this._telemetryLogger.startScenario(a,new Date),p={url:"index"===e?this._currentWebPlayerPackageUrl:this._currentWebPlayerManifestUrl,method:"GET"};s.downloadResource(p,{onSuccess:function(e){i._telemetryLogger.endScenario(l),t.onSuccess(e)},onFailure:function(n){var o="index"===e?"Failed to download indexWebHtml":"Failed to download manifest";i._telemetryLogger.failScenario(l,{message:o}),r?i._downloadResourceImpl(e,t,!0,!1):t.onFailure(n)}},n)},e._getSASKeyExpiryDate=function(e){var t=this.getUrlParams(e,"se");return new Date(decodeURIComponent(t))},e.getUrlParams=function(e,t){var n=new RegExp("[?&]"+t+"=([^&#]*)").exec(e);return null==n?null:decodeURI(n[1])||null},e.isSASKeyExpired=function(e){var t=this._getSASKeyExpiryDate(e);return(new Date).getTime()>t.getTime()},e.getTimeUntilSASRenewalInMs=function(e){var t=this._getSASKeyExpiryDate(e).getTime();if(!isNaN(t)){var n=t-(new Date).getTime(),r=Math.floor(51*Math.random())+10;(r<10||r>60)&&(r=10);var o=n-(r*=6e4);return o<=0?0:o}},e.prototype._getPackageKindConfig=function(e,t){var n;return n=i.zip,t.isWebPlayerBVT||t.isInDebugMode||(n="split"===(null==e?void 0:e.toLocaleLowerCase())?i.split:i.zip),n},e.prototype._getProcessStateString=function(e){var t="";switch(e){case s.NotStart:t="NotStarted";break;case s.InProgress:t="InProgress";break;case s.Processed:t="Processed";break;case s.Error:t="Error"}return t},e}();(function(){function e(e){this._fetchResource=e,this._callbackArray=[],this._isDownloading=!1,this._cacheResource=void 0}e.prototype.downloadResource=function(e,t,n){if(!this._isDownloading)return n?(this._cacheResource=void 0,void this._downloadResourceImpl(e,t,n)):void(this._cacheResource?t.onSuccess(this._cacheResource):this._downloadResourceImpl(e,t));this._callbackArray.push(t)},e.prototype._downloadResourceImpl=function(e,t,n){var r=this;this._callbackArray.push(t),this._isDownloading=!0,this._fetchResource(e,{onSuccess:function(e){r._cacheResource=e,r._isDownloading=!1;for(var t=r._callbackArray.length,n=0;n<t;n++){r._callbackArray.shift().onSuccess(e)}},onFailure:function(e){r._isDownloading=!1;for(var t=r._callbackArray.length,n=0;n<t;n++){r._callbackArray.shift().onFailure(e)}}},n)}})(),function(){function e(e){this._config=e}e.prototype.getWebPlayerZipDetails=function(e,t,n){var r=null;if(t===i.zip){var o=this._config.cdnPath,a=null;n&&(o=this._config.debugConfig.publishedAppResourceUrl,a=this._config.debugConfig.publishedAppResourceHash),"/"!==o.charAt(o.length-1)&&(o+="/"),null===a&&(a=e.hash),r={rootPath:o+=a+"/PlayerResources/"}}return r},e.prototype.getSplitPackageDetails=function(e,t){return t===i.split?{appDependencies:p(e),nonSharedAppResources:c(e)}:null},e.prototype.getDataComponentPackageDetails=function(e,t){return t===i.split&&(null==e?void 0:e.dataComponentDependencies)?{expressionRuntime:d(e),scripts:u(e,"scripts"),metadata:u(e,"metadata")}:void 0},e.prototype.getComponentLibraryPackageDetails=function(e,t){return t===i.split&&(null==e?void 0:e.componentNameMap)&&(null==e?void 0:e.expressionRuntime)?{componentNameMap:e.componentNameMap,expressionRuntime:e.expressionRuntime.map((function(e){var t;return(t={})[e.sourcePath.toLocaleLowerCase()]=e.sourceUrl,t})).reduce((function(e,t){return __assign(__assign({},e),t)}))}:void 0},e.prototype.generateWebPlayerResourceDetails=function(){var e={};if(void 0!==window.ResourceLoader){e["js/MessageWorker.js"]=window.ResourceLoader.mapResourceUrl(document,"js/MessageWorker.js")}return{resourceMap:e}},e.prototype.generateWebPlayerDetails=function(e){var t=(e=e.split("#")[0]).split("?")[1];return e.indexOf("index.web.html?")>=0?{host:e.replace("index.web.html?","").replace(t,""),queryString:"?"+t,proxyPath:this._config.webPlayerProxyUrl,timeUntilSASRenewalInMs:m.getTimeUntilSASRenewalInMs(e)}:{host:e.replace("index.web.html",""),queryString:"",proxyPath:this._config.webPlayerProxyUrl}},e.prototype.generateScriptPackageDetails=function(e,t){var n=g(e);return{appResources:null==n?void 0:n.appResourcesScript,appLoadLinkResources:null==n?void 0:n.prefetchAppResourcesScript,languageSpecificResources:null==n?void 0:n.languageResourcesScript,powerAppsTitle:null==n?void 0:n.powerAppsTitleScript,headerScripts:null==n?void 0:n.headerScripts,updatedHash:t}},e.prototype.parseControlsListFromManifest=function(e){return l(e)},e.prototype.parseNestedCanvasAppsFromManifest=function(e){return function(e){return e.nestedCanvasApps}(e)}}();n.d(t,"g",(function(){return"se"})),n.d(t,"c",(function(){return"manifest.json"})),n.d(t,"a",(function(){return"index.web.html"})),n.d(t,"f",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"l",(function(){return l})),n.d(t,"h",(function(){return p})),n.d(t,"i",(function(){return c})),n.d(t,"k",(function(){return d})),n.d(t,"j",(function(){return u})),n.d(t,"m",(function(){return g})),n.d(t,"b",(function(){return m}))},function(e,t,n){"use strict";function r(e){return void 0===e&&(e=""),__awaiter(this,void 0,Promise,(function(){var t,n,r;return __generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),[4,caches.open("webplayer-entrypoint")];case 1:return[4,(t=o.sent()).keys()];case 2:return n=o.sent(),r=n.filter((function(t){return t.url.indexOf(e)>-1})),[4,Promise.all(r.map((function(e){return t.delete(e)})))];case 3:return o.sent(),[3,5];case 4:return o.sent(),[3,5];case 5:return[2]}}))}))}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.r(t);var r=n(13),o=n(6),i=n(48),a=n(3),s=n(49),l=function(){function e(){}return e.prototype.getValueAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2,void 0]}))}))},e.prototype.removeValueAsync=function(e){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2]}))}))},e.prototype.setValueAsync=function(e,t,n){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2]}))}))},e.prototype.clearAsync=function(){return __awaiter(this,void 0,Promise,(function(){return __generator(this,(function(e){return[2]}))}))},e}(),p=n(60);n.d(t,"registerPlayerRuntimeObjects",(function(){return d}));var c=!1;function d(e,t){if(!c){if(c=!0,AppMagic.Runtime.Client.registerClientRuntimeObjects(e),Core.Environment.isWebPlayer()){if(e.register(Core.IO.IAsyncSettingsProviderKey,[],(function(){return window.webPlayerServerConfig.IsConsentOnly?new l:new Core.IO.SettingsProviders.LocalForageAsyncSettingsProvider("PowerApps",Core.Environment.getWebPlayerLocalForageStoreName())})),window.webPlayerServerConfig.IsConsentOnly){var n=new Core.IO.SettingsProviders.LocalForageAsyncSettingsProvider("PowerApps",Core.Environment.getWebPlayerLocalForageStoreName());e.register(AppMagic.Runtime.Client.ComponentKeys.EcsSettingsProvider,[],(function(){return new Core.IO.SettingsProviders.LocalForageSettingsProviderBySetting("appsettings-unencrypted.json",n)}))}Core.Environment.isWebPlayerEncryptedStorageEnabled()&&(Core.Environment.isRunningInTeamsNative()?e.register(Core.IO.IEncryptedStorageKey,[Core.IO.IAsyncSettingsProviderKey],(function(e){var t;try{t=new Core.IO.TeamsNativeEncryptedStorage(e)}catch(n){Core.Telemetry.Log.trackErrorEvent("FailedToInitializeEncryptedStorage",{encryptedStorageUsed:"TeamsNativeEncryptedStorage",error:n}),t=new Core.IO.EncryptedStorage(e)}return t})):e.register(Core.IO.IEncryptedStorageKey,[Core.IO.IAsyncSettingsProviderKey],(function(e){return new Core.IO.EncryptedStorage(e)})))}t?e.register(AppMagic.Runtime.Client.ComponentKeys.AuthenticationPluginCreator,[],(function(){return t})):Core.Environment.isWebPlayer()&&e.register(AppMagic.Runtime.Client.ComponentKeys.AuthenticationPluginCreator,[AppMagic.Runtime.Client.ComponentKeys.HttpClient,AppMagic.Runtime.Client.ComponentKeys.SettingsProvider],(function(e,t){return new i.WebPlayerAdalPluginCreator})),e.register(r.ErrorSerializersManagerSingletonKey,[],(function(){return PlayerApiHost.LocalServices.Serialization.createAppErrorsSerializer()})),e.register(r.PABinarySerializerSingletonKey,[],(function(){return new PlayerApiHost.LocalServices.Serialization.PABinarySerializer})),e.register(r.PlayerRuntimeSingletonKey,[AppMagic.Runtime.Client.IClientRuntimeSingletonKey],(function(e){var t=new r.PlayerRuntime(e);return t.initialize(),t.loadAsync(),t}),!0,(function(e){return e.loaded.waitAsync()})),Core.Environment.isWebPlayer()&&e.register(r.TeamsIntegrationSingletonKey,[],(function(){return{getHostClientType:o.TeamsWebPlayerRuntime.getHostClientType}})),e.register(r.AutomationClientIntegrationCreatorSingletonKey,[],(function(){return{getAutomationClientIntegration:function(e,t){if(Core.Environment.isUsingWebPlayerSdk()&&window.parent)return new s.WebPlayerSdkIntegrator(e,a.WebPlayerRuntime.postMessageToSdk,t)}}})),e.register(Core.Player.IHostMessageProviderSingletonKey,[],(function(){return new p.HostSDKMessenger(null,a.WebPlayerRuntime.postMessageToSdk)}))}}},function(e,t,n){},function(e,t,n){n(79),e.exports=n(78)},function(e,t,n){"use strict";Core.UI.MarkupService.setInstance(new Core.UI.MarkupService.FileSystemMarkupService),Core.UI.ThemeProvider.setInstance(new Core.UI.Popups.LightThemeProvider)},function(e,t,n){"use strict";Player.Strings=Core.Globalization.StringsConstantsFactory.getInstance("player")},function(e,t,n){"use strict";n.r(t);var r=n(13);n.d(t,"ErrorSerializersManagerSingletonKey",(function(){return r.ErrorSerializersManagerSingletonKey}));var o=n(5);n.d(t,"AppMetadataCacheUpdateResult",(function(){return o.AppMetadataCacheUpdateResult})),n.d(t,"AppMetadataCaching",(function(){return o.AppMetadataCaching})),n.d(t,"IAppMetadataCacheResult",(function(){return o.IAppMetadataCacheResult}));var i=n(37);n.d(t,"AppHostManagerFactory",(function(){return i.AppHostManagerFactory}));var a=n(34);n.d(t,"BackwardCompatibilityManager",(function(){return a.BackwardCompatibilityManager}));var s=n(39);n.d(t,"BaseAppHostManager",(function(){return s.BaseAppHostManager}));var l=n(61);n.d(t,"IAppHostManager",(function(){return l.IAppHostManager})),n.d(t,"IMessageData",(function(){return l.IMessageData})),n.d(t,"IMessageParameter",(function(){return l.IMessageParameter}));var p=n(74);n.d(t,"IAppHostManagerFactory",(function(){return p.IAppHostManagerFactory}));var c=n(38);n.d(t,"WebPlayerPreloadAppHostManager",(function(){return c.WebPlayerPreloadAppHostManager}));var d=n(63);n.d(t,"TestEventDispatcher",(function(){return d.TestEventDispatcher}));var u=n(64);n.d(t,"TestHooksHelper",(function(){return u.TestHooksHelper}));var g=n(35);n.d(t,"AppConnectionsView",(function(){return g.AppConnectionsView}));var m=n(19);n.d(t,"AppConnectionsViewModel",(function(){return m.AppConnectionsViewModel})),n.d(t,"IAppConnectionsViewModelParams",(function(){return m.IAppConnectionsViewModelParams}));var h=n(33);n.d(t,"ConnectionInfo",(function(){return h.ConnectionInfo})),n.d(t,"IConnectionInfoParams",(function(){return h.IConnectionInfoParams}));var y=n(55);n.d(t,"DebugDialog",(function(){return y.DebugDialog}));var f=n(56);n.d(t,"DebugDialogViewModel",(function(){return f.DebugDialogViewModel}));var v=n(32);n.d(t,"IFlattenedTestProfileVariant",(function(){return v.IFlattenedTestProfileVariant})),n.d(t,"PlayerDebugViewModel",(function(){return v.PlayerDebugViewModel}));var C=n(18);n.d(t,"IWebPlayerAuthDialogProps",(function(){return C.IWebPlayerAuthDialogProps})),n.d(t,"IWebPlayerAuthDialogState",(function(){return C.IWebPlayerAuthDialogState})),n.d(t,"WebPlayerAuthDialog",(function(){return C.WebPlayerAuthDialog})),n.d(t,"PlayerClientComponentsWebPlayerAuthDialog_display",(function(){return C.display}));var P=n(20);n.d(t,"IWebPlayerBannerProps",(function(){return P.IWebPlayerBannerProps})),n.d(t,"IWebPlayerBannerState",(function(){return P.IWebPlayerBannerState})),n.d(t,"WebPlayerBanner",(function(){return P.WebPlayerBanner})),n.d(t,"PlayerClientComponentsWebPlayerBanner_display",(function(){return P.display}));var b=n(65);n.d(t,"WebPlayerCSATDialog",(function(){return b.WebPlayerCSATDialog}));var _=n(16);n.d(t,"IWebPlayerConsentRequiredDialogProps",(function(){return _.IWebPlayerConsentRequiredDialogProps})),n.d(t,"WebPlayerConsentRequiredDialog",(function(){return _.WebPlayerConsentRequiredDialog})),n.d(t,"PlayerClientComponentsWebPlayerConsentRequiredDialog__setClose",(function(){return _._setClose})),n.d(t,"PlayerClientComponentsWebPlayerConsentRequiredDialog__setDisplay",(function(){return _._setDisplay})),n.d(t,"PlayerClientComponentsWebPlayerConsentRequiredDialog_close",(function(){return _.close})),n.d(t,"PlayerClientComponentsWebPlayerConsentRequiredDialog_display",(function(){return _.display}));var A=n(12);n.d(t,"IWebPlayerConsentDialogProps",(function(){return A.IWebPlayerConsentDialogProps})),n.d(t,"WebPlayerConsentDialog",(function(){return A.WebPlayerConsentDialog})),n.d(t,"PlayerClientComponentsWebPlayerConsentDialog__setClose",(function(){return A._setClose})),n.d(t,"PlayerClientComponentsWebPlayerConsentDialog__setDisplay",(function(){return A._setDisplay})),n.d(t,"PlayerClientComponentsWebPlayerConsentDialog_close",(function(){return A.close})),n.d(t,"PlayerClientComponentsWebPlayerConsentDialog_display",(function(){return A.display}));var S=n(1);n.d(t,"IWebPlayerErrorDialogDetailsProps",(function(){return S.IWebPlayerErrorDialogDetailsProps})),n.d(t,"IWebPlayerErrorDialogProps",(function(){return S.IWebPlayerErrorDialogProps})),n.d(t,"IWebPlayerErrorDialogState",(function(){return S.IWebPlayerErrorDialogState})),n.d(t,"RequestAppAccessStateType",(function(){return S.RequestAppAccessStateType})),n.d(t,"WebPlayerErrorDialog",(function(){return S.WebPlayerErrorDialog})),n.d(t,"WebPlayerErrorDialogDetails",(function(){return S.WebPlayerErrorDialogDetails})),n.d(t,"WebPlayerErrorType",(function(){return S.WebPlayerErrorType}));var w=n(15);n.d(t,"IWebPlayerNoPlansDialogProps",(function(){return w.IWebPlayerNoPlansDialogProps})),n.d(t,"IWebPlayerNoPlansDialogState",(function(){return w.IWebPlayerNoPlansDialogState})),n.d(t,"WebPlayerNoPlansDialog",(function(){return w.WebPlayerNoPlansDialog}));var E=n(27);n.d(t,"PlayerClientComponentsWebPlayerPopupBanner_display",(function(){return E.display}));var T=n(26);n.d(t,"WebPlayerSessionDetailsDialog",(function(){return T.WebPlayerSessionDetailsDialog}));var I=n(10);n.d(t,"IWebPlayerSessionExpiredBannerProps",(function(){return I.IWebPlayerSessionExpiredBannerProps})),n.d(t,"IWebPlayerSessionExpiredBannerState",(function(){return I.IWebPlayerSessionExpiredBannerState})),n.d(t,"WebPlayerSessionExpiredBanner",(function(){return I.WebPlayerSessionExpiredBanner})),n.d(t,"PlayerClientComponentsWebPlayerSessionExpiredBanner_display",(function(){return I.display}));var k=n(30);n.d(t,"HostContextMenu",(function(){return k.HostContextMenu})),n.d(t,"IHostContextMenuProps",(function(){return k.IHostContextMenuProps}));var D=n(21);n.d(t,"IWebPlayerShellFunctions",(function(){return D.IWebPlayerShellFunctions})),n.d(t,"IWebPlayerShellProps",(function(){return D.IWebPlayerShellProps})),n.d(t,"IWebPlayerShellState",(function(){return D.IWebPlayerShellState})),n.d(t,"WebPlayerShell",(function(){return D.WebPlayerShell}));var M=n(31);n.d(t,"IWebPlayerSplashScreenProps",(function(){return M.IWebPlayerSplashScreenProps})),n.d(t,"WebPlayerSplashScreen",(function(){return M.WebPlayerSplashScreen}));var R=n(23);n.d(t,"IWebPlayerWarningBannerProps",(function(){return R.IWebPlayerWarningBannerProps})),n.d(t,"WebPlayerWarningBanner",(function(){return R.WebPlayerWarningBanner}));var L=n(51);n.d(t,"AddPlayerConnectionComponentFactory",(function(){return L.AddPlayerConnectionComponentFactory}));var H=n(29);n.d(t,"AddPlayerConnectionViewModel",(function(){return H.AddPlayerConnectionViewModel}));var U=n(36);n.d(t,"AddConnectionView",(function(){return U.AddConnectionView}));var W=n(0);n.d(t,"AppIdentityMapFileName",(function(){return W.a})),n.d(t,"AppIndexFileName",(function(){return W.b})),n.d(t,"BackstageIcons",(function(){return W.c})),n.d(t,"CacheManagerFileName",(function(){return W.d})),n.d(t,"CachedServerAppIndexFileName",(function(){return W.e})),n.d(t,"CapabilitiesIcons",(function(){return W.f})),n.d(t,"CapabilitiesLocalizedNames",(function(){return W.g})),n.d(t,"ControlsBaseURL",(function(){return W.h})),n.d(t,"DefaultCreatedDate",(function(){return W.i})),n.d(t,"DefaultDescription",(function(){return W.j})),n.d(t,"DefaultPackageName",(function(){return W.k})),n.d(t,"DefaultPackageUrl",(function(){return W.l})),n.d(t,"DefaultPowerAppsName",(function(){return W.m})),n.d(t,"DefaultPrimaryDeviceHeight",(function(){return W.n})),n.d(t,"DefaultPrimaryDeviceWidth",(function(){return W.o})),n.d(t,"DefaultPrimaryFormFactor",(function(){return W.p})),n.d(t,"DefaultSupportsLandscape",(function(){return W.q})),n.d(t,"DefaultSupportsPortrait",(function(){return W.r})),n.d(t,"DefaultUserId",(function(){return W.s})),n.d(t,"DefaultVersion",(function(){return W.t})),n.d(t,"DisableDebugUIDeepLinkCommandName",(function(){return W.u})),n.d(t,"EnableDebugUIDeepLinkCommandName",(function(){return W.v})),n.d(t,"InvalidClickTargetSelector",(function(){return W.w})),n.d(t,"IsMainUIUsingDarkStatusBarBackground",(function(){return W.x})),n.d(t,"LastUpdatedPropertyName",(function(){return W.y})),n.d(t,"LaunchPrimaryHostProtocol",(function(){return W.z})),n.d(t,"LaunchSecondaryHostProtocol",(function(){return W.A})),n.d(t,"MaxNewApps",(function(){return W.B})),n.d(t,"MaxRecentApps",(function(){return W.C})),n.d(t,"MicrosoftCopyright",(function(){return W.D})),n.d(t,"PlayerPackageExtension",(function(){return W.E})),n.d(t,"PluginsFolderName",(function(){return W.F})),n.d(t,"RefreshInterval",(function(){return W.G})),n.d(t,"ScriptsFolderName",(function(){return W.H})),n.d(t,"ServerAppsPropertyName",(function(){return W.I})),n.d(t,"SienaProtocol",(function(){return W.J})),n.d(t,"WebLinks",(function(){return W.K})),n.d(t,"WwwFolderName",(function(){return W.M})),n.d(t,"disallowedEmailDomains",(function(){return W.N}));var x=n(53);n.d(t,"ApiScopeDialog",(function(){return x.ApiScopeDialog}));var O=n(22);n.d(t,"AppPermissionsDialog",(function(){return O.AppPermissionsDialog})),n.d(t,"IAppPermissionsDialogParams",(function(){return O.IAppPermissionsDialogParams})),n.d(t,"_setAppPermissionsDialogFactory",(function(){return O._setAppPermissionsDialogFactory})),n.d(t,"createAppPermissionsDialog",(function(){return O.createAppPermissionsDialog}));var N=n(52);n.d(t,"AddConnectionDialogViewModel",(function(){return N.AddConnectionDialogViewModel}));var F=n(54);n.d(t,"ApiScopeDialogViewModel",(function(){return F.ApiScopeDialogViewModel}));var B=n(57);n.d(t,"AppPermissionsDialogViewModel",(function(){return B.AppPermissionsDialogViewModel}));var V=n(66);n.d(t,"ConsentDialogHandler",(function(){return V.ConsentDialogHandler}));var j=n(67);n.d(t,"DefaultConsentProvider",(function(){return j.DefaultConsentProvider}));var G=n(68);n.d(t,"StandaloneConsentProvider",(function(){return G.StandaloneConsentProvider}));var z=n(58);n.d(t,"ConsentOnlyProvider",(function(){return z.ConsentOnlyProvider}));var q=n(69);n.d(t,"StandaloneConsentRuntime",(function(){return q.StandaloneConsentRuntime}));var K=n(24);n.d(t,"completeGetAppResourcesPromise",(function(){return K.completeGetAppResourcesPromise})),n.d(t,"serializeAppResources",(function(){return K.serializeAppResources}));var J=n(60);n.d(t,"HostSDKMessenger",(function(){return J.HostSDKMessenger}));var Q=n(45);n.d(t,"AppDetailsProvider",(function(){return Q.AppDetailsProvider}));var Z=n(14);n.d(t,"parseAppHashParams",(function(){return Z.parseAppHashParams}));var Y=n(17);n.d(t,"AppHostRuntime",(function(){return Y.AppHostRuntime}));var X=n(62);n.d(t,"ITelemetryManager",(function(){return X.ITelemetryManager})),n.d(t,"IWebPlayerParameters",(function(){return X.IWebPlayerParameters})),n.d(t,"IWebPlayerUrlParser",(function(){return X.IWebPlayerUrlParser}));var $=n(70);n.d(t,"MessageChannel",(function(){return $.MessageChannel}));var ee=n(8);n.d(t,"JoinSessionConsentDialog",(function(){return ee.JoinSessionConsentDialog})),n.d(t,"JoinSessionErrorDialog",(function(){return ee.JoinSessionErrorDialog})),n.d(t,"SessionParams",(function(){return ee.SessionParams})),n.d(t,"disableSession",(function(){return ee.disableSession})),n.d(t,"getSessionParams",(function(){return ee.getSessionParams})),n.d(t,"setUpSessionAsync",(function(){return ee.setUpSessionAsync})),n.d(t,"getAllowedEndpoints",(function(){return ee.getAllowedEndpoints})),n.d(t,"isValidEndpoint",(function(){return ee.isValidEndpoint}));var te=n(4);n.d(t,"_getEnrollPollTimeout",(function(){return te._getEnrollPollTimeout})),n.d(t,"_setEnrollPollTimeout",(function(){return te._setEnrollPollTimeout})),n.d(t,"_setHandleNoPlanGuestClick",(function(){return te._setHandleNoPlanGuestClick})),n.d(t,"_setHandleNoPlansClick",(function(){return te._setHandleNoPlansClick})),n.d(t,"_setHandlePremiumPlanPopup",(function(){return te._setHandlePremiumPlanPopup})),n.d(t,"_setHandleRedirectToConsentUri",(function(){return te._setHandleRedirectToConsentUri})),n.d(t,"_setShowTrialPopup",(function(){return te._setShowTrialPopup})),n.d(t,"handleLaunchAppCallErrorAsync",(function(){return te.handleLaunchAppCallErrorAsync})),n.d(t,"handleNoPlanGuestClick",(function(){return te.handleNoPlanGuestClick})),n.d(t,"handleNoPlansClick",(function(){return te.handleNoPlansClick})),n.d(t,"handlePremiumPlanPopup",(function(){return te.handlePremiumPlanPopup})),n.d(t,"handleRedirectToConsentUri",(function(){return te.handleRedirectToConsentUri})),n.d(t,"showNoPlansDialogAsync",(function(){return te.showNoPlansDialogAsync})),n.d(t,"showTrialPopup",(function(){return te.showTrialPopup}));var ne=n(50);n.d(t,"PublishedAppIframeCacher",(function(){return ne.PublishedAppIframeCacher}));var re=n(11);n.d(t,"ParamsMap",(function(){return re.ParamsMap})),n.d(t,"getParamsMapFromUrl",(function(){return re.getParamsMapFromUrl})),n.d(t,"setPublishedAppParamsQuery",(function(){return re.setPublishedAppParamsQuery})),n.d(t,"updatePublishedAppParamsQuery",(function(){return re.updatePublishedAppParamsQuery}));var oe=n(25);n.d(t,"SharedAppHostErrorParser",(function(){return oe.SharedAppHostErrorParser}));var ie=n(6);n.d(t,"TeamsWebPlayerRuntime",(function(){return ie.TeamsWebPlayerRuntime}));var ae=n(46);n.d(t,"TelemetryManager",(function(){return ae.TelemetryManager}));var se=n(48);n.d(t,"WebPlayerAdalPluginCreator",(function(){return se.WebPlayerAdalPluginCreator}));var le=n(3);n.d(t,"WebPlayerRuntime",(function(){return le.WebPlayerRuntime}));var pe=n(49);n.d(t,"WebPlayerSdkIntegrator",(function(){return pe.WebPlayerSdkIntegrator}));var ce=n(41);n.d(t,"WebPlayerSDKMessenger",(function(){return ce.WebPlayerSDKMessenger}));var de=n(28);n.d(t,"WebPlayerSessionManager",(function(){return de.WebPlayerSessionManager}));var ue=n(59);n.d(t,"WebPlayerNotificationProvider",(function(){return ue.WebPlayerNotificationProvider}));var ge=n(42);n.d(t,"WebPlayerUIProvider",(function(){return ge.WebPlayerUIProvider}));var me=n(47);n.d(t,"WebPlayerUrlParser",(function(){return me.WebPlayerUrlParser}));var he=n(40);n.d(t,"D365ShellHeader",(function(){return he.D365ShellHeader}));var ye=n(43);n.d(t,"OneShellHeader",(function(){return ye.OneShellHeader}));var fe=n(44);n.d(t,"OneShellLoader",(function(){return fe.OneShellLoader}));var ve=n(2);n.d(t,"AppBrandTheme",(function(){return ve.AppBrandTheme})),n.d(t,"CustomHeaderButtonRenderData",(function(){return ve.CustomHeaderButtonRenderData})),n.d(t,"NavBarLinkData",(function(){return ve.NavBarLinkData})),n.d(t,"OfficeShellRenderSettings",(function(){return ve.OfficeShellRenderSettings})),n.d(t,"ShellLoadErrorEvent",(function(){return ve.ShellLoadErrorEvent})),n.d(t,"dispatchResizeWindow",(function(){return ve.dispatchResizeWindow})),n.d(t,"downloadActionHandler",(function(){return ve.downloadActionHandler})),n.d(t,"generateTrustedSideLoadingDeepLink",(function(){return ve.generateTrustedSideLoadingDeepLink})),n.d(t,"formatOneShellErrorMessage",(function(){return ve.formatOneShellErrorMessage})),n.d(t,"removePlaceholderHeader",(function(){return ve.removePlaceholderHeader})),n.d(t,"showSessionDetails",(function(){return ve.showSessionDetails})),n.d(t,"signOut",(function(){return ve.signOut})),n.d(t,"getShellHeaderBootstrapUrl",(function(){return ve.getShellHeaderBootstrapUrl})),n.d(t,"getShellHeaderBootstrapHost",(function(){return ve.getShellHeaderBootstrapHost}));var Ce=n(9);n.d(t,"IShellHeader",(function(){return Ce.IShellHeader})),n.d(t,"IShellHeaderManager",(function(){return Ce.IShellHeaderManager})),n.d(t,"IShellHeaderProps",(function(){return Ce.IShellHeaderProps})),n.d(t,"ShellHeaderManager",(function(){return Ce.ShellHeaderManager}));var Pe=n(7);n.d(t,"getControlPath",(function(){return Pe.getControlPath})),n.d(t,"getHostUrl",(function(){return Pe.getHostUrl})),n.d(t,"getLocalizedBrowserName",(function(){return Pe.getLocalizedBrowserName})),n.d(t,"getPersonalizedGreetingMessage",(function(){return Pe.getPersonalizedGreetingMessage}))},function(e,t,n){"use strict";n.r(t);var r=n(37);Core.exportToNamespace(["AppNavigation"],r);var o=n(34);Core.exportToNamespace(["AppNavigation"],o);var i=n(39);Core.exportToNamespace(["AppNavigation"],i);n(61),n(74);var a=n(63);Core.exportToNamespace(["Player","Client","CommonTestComponents"],a);var s=n(64);Core.exportToNamespace(["Player","Client","CommonTestComponents"],s);var l=n(35);Core.exportToNamespace(["Player","Client","Components"],l);var p=n(19);Core.exportToNamespace(["Player","Client","Components"],p);var c=n(33);Core.exportToNamespace(["Player","Client","Components"],c);var d=n(29),u=n(36);Core.Environment.isWebAuthoring();Core.Knockout.Components.registerWithViewAndViewModel("app-connections","Components/AppConnections/AppConnections.html",l.AppConnectionsView,p.AppConnectionsViewModel,!0),Core.Knockout.Components.registerWithViewModelFromParentAndView("app-connections-from-parent","Components/AppConnections/AppConnections.html",l.AppConnectionsView,p.AppConnectionsViewModel,!0),Core.Knockout.Components.registerWithViewModelFromParentAndView("connection-hub-add-connection","ConnectionHub/Connector/AddConnection.html",u.AddConnectionView,Core.Authoring.ConnectionHub.AddConnectionViewModel,!0),Core.Knockout.Components.registerWithViewModelFromParentAndView("connection-hub-add-player-connection","ConnectionHub/Connector/AddConnection.html",u.AddConnectionView,d.AddPlayerConnectionViewModel,!0),Core.Knockout.Components.registerWithViewModelFromParent("connection-hub-parameter-label","ConnectionHub/Connector/Parameters/ParameterLabel.html",void 0,!0),Core.Knockout.Components.registerWithViewModelFromParent("connection-hub-string-parameter","ConnectionHub/Connector/Parameters/StringParameter.html",Core.Authoring.ConnectionHub.StringParameterViewModel,!0),Core.Knockout.Components.registerWithViewModelFromParent("connection-hub-dropdown-parameter","ConnectionHub/Connector/Parameters/DropdownParameter.html",Core.Authoring.ConnectionHub.DropdownParameterViewModel,!0),Core.Knockout.Components.registerWithViewModelFromParent("connection-hub-integer-parameter","ConnectionHub/Connector/Parameters/IntegerParameter.html",Core.Authoring.ConnectionHub.IntegerParameterViewModel,!0),Core.Knockout.Components.registerWithViewModelFromParent("connection-hub-boolean-parameter","ConnectionHub/Connector/Parameters/BooleanParameter.html",Core.Authoring.ConnectionHub.BooleanParameterViewModel,!0),Core.Knockout.Components.registerWithViewModelFromParent("connection-badge-banner","ConnectionHub/Connector/ConnectionBadgeBanner/ConnectionBadgeBanner.html",Core.Authoring.ConnectionHub.ConnectionBadgeBannerViewModel,!0),Core.Knockout.Components.registerWithViewModelFromParent("loading-spinner","ConnectionHub/LoadingSpinner/LoadingSpinner.html",Core.Authoring.ConnectionHub.LoadingSpinnerViewModel);var g=n(55);Core.exportToNamespace(["Player","Client","Components"],g);var m=n(56);Core.exportToNamespace(["Player","Client","Components"],m);var h=n(32);Core.exportToNamespace(["Player","Client","Components"],h);var y=n(65);Core.exportToNamespace(["Player","Client","Components","WebPlayerCSATDialog"],y);var f=n(26);Core.exportToNamespace(["Player","Client","Components"],f);var v=n(51);Core.exportToNamespace(["Player","Client","ConnectionHub"],v),Core.exportToNamespace(["Player","Client","ConnectionHub"],d),Core.exportToNamespace(["Player","Client","Components"],u);var C=n(0);Core.exportToNamespace(["Player","Client","Constants"],{AppIndexFileName:C.b,AppIdentityMapFileName:C.a,CachedServerAppIndexFileName:C.e,CacheManagerFileName:C.d,DefaultPackageName:C.k,DefaultCreatedDate:C.i,DefaultVersion:C.t,DefaultPackageUrl:C.l,DefaultPowerAppsName:C.m,DefaultDescription:C.j,DefaultUserId:C.s,DefaultSupportsPortrait:C.r,DefaultSupportsLandscape:C.q,DefaultPrimaryDeviceWidth:C.o,DefaultPrimaryDeviceHeight:C.n,DefaultPrimaryFormFactor:C.p,EnableDebugUIDeepLinkCommandName:C.v,DisableDebugUIDeepLinkCommandName:C.u,PlayerPackageExtension:C.E,ServerAppsPropertyName:C.I,LastUpdatedPropertyName:C.y,RefreshInterval:C.G,MaxRecentApps:C.C,MaxNewApps:C.B,SienaProtocol:C.J,LaunchPrimaryHostProtocol:C.z,LaunchSecondaryHostProtocol:C.A,WebLinks:C.K,BackstageIcons:C.c,CapabilitiesLocalizedNames:C.g,CapabilitiesIcons:C.f,InvalidClickTargetSelector:C.w,IsMainUIUsingDarkStatusBarBackground:C.x,MicrosoftCopyright:C.D,disallowedEmailDomains:C.N}),Core.exportToNamespace(["Player","Client","Constants","Paths"],{ControlsBaseURL:C.h,PluginsFolderName:C.F,ScriptsFolderName:C.H,WwwFolderName:C.M});n(76),n(77);var P=n(53);Core.exportToNamespace(["Player","Client","Popups"],P);var b=n(22);Core.exportToNamespace(["Player","Client","Popups"],b);var _=n(52);Core.exportToNamespace(["Player","Client","Popups"],_);var A=n(54);Core.exportToNamespace(["Player","Client","Popups"],A);var S=n(57);Core.exportToNamespace(["Player","Client","Popups"],S);var w=n(45);Core.exportToNamespace(["AppMagic","Runtime"],w);var E=n(14);Core.exportToNamespace(["AppMagic","Runtime"],E);var T=n(17);Core.exportToNamespace(["AppMagic","Runtime"],T);var I=n(66);Core.exportToNamespace(["AppMagic","Runtime","App","Host"],I);var k=n(67);Core.exportToNamespace(["AppMagic","Runtime","Consent"],k);var D=n(68);Core.exportToNamespace(["AppMagic","Runtime","Consent"],D);var M=n(60);Core.exportToNamespace(["AppMagic","Runtime"],M);var R=n(58);Core.exportToNamespace(["AppMagic","Runtime","Consent"],R);var L=n(69);Core.exportToNamespace(["AppMagic","Runtime"],L);var H=n(24);Core.exportToNamespace(["AppMagic","Runtime","StandaloneConsentServiceHelper"],H);n(62);var U=n(70);Core.exportToNamespace(["AppMagic","Runtime","Client"],U);var W=n(8);Core.exportToNamespace(["AppMagic","Runtime","MonitorHelper"],W);var x=n(73);Core.exportToNamespace(["AppMagic","Runtime","ObjectFactoryRegistration"],x);var O=n(4);Core.exportToNamespace(["AppMagic","Runtime","PlansHelper"],O);var N=n(50);Core.exportToNamespace(["AppMagic","Runtime"],N);var F=n(11);Core.exportToNamespace(["AppMagic","Runtime","PublishedAppUrlUtil"],F);var B=n(25);Core.exportToNamespace(["AppMagic","Runtime"],B);var V=n(6);Core.exportToNamespace(["AppMagic","Runtime"],V);var j=n(46);Core.exportToNamespace(["AppMagic","Runtime"],j);var G=n(48);Core.exportToNamespace(["AppMagic","Runtime","Client","Adal"],G);var z=n(3);Core.exportToNamespace(["AppMagic","Runtime"],z);var q=n(49);Core.exportToNamespace(["AppMagic","Runtime"],q);var K=n(41);Core.exportToNamespace(["AppMagic","Runtime"],K);var J=n(28);Core.exportToNamespace(["AppMagic","Runtime"],J);var Q=n(59);Core.exportToNamespace(["AppMagic","Runtime"],Q);var Z=n(42);Core.exportToNamespace(["AppMagic","Runtime"],Z);var Y=n(47);Core.exportToNamespace(["AppMagic","Runtime"],Y);var X=n(43);Core.exportToNamespace(["Player","Client"],X);var $=n(44);Core.exportToNamespace(["Player","Client"],$);var ee=n(2);Core.exportToNamespace(["Player","Client"],ee);var te=n(9);Core.exportToNamespace(["Player","Client"],te);var ne=n(7);Core.exportToNamespace(["Player","Client","Utility"],ne);var re=n(5);Core.exportToNamespace(["AppMetadataCaching"],re);var oe=n(38);Core.exportToNamespace(["AppNavigation"],oe);var ie=n(18);Core.exportToNamespace(["Player","Client","Components","WebPlayerAuthDialog"],ie);var ae=n(20);Core.exportToNamespace(["Player","Client","Components","WebPlayerBanner"],ae);var se=n(12);Core.exportToNamespace(["Player","Client","Components","WebPlayerConsentDialog"],se);var le=n(16);Core.exportToNamespace(["Player","Client","Components","WebPlayerConsentRequiredDialog"],le);var pe=n(1);Core.exportToNamespace(["Player","Client","Components","WebPlayerErrorDialog"],pe);var ce=n(15);Core.exportToNamespace(["Player","Client","Components","WebPlayerNoPlansDialog"],ce);var de=n(27);Core.exportToNamespace(["Player","Client","Components","WebPlayerPopupBanner"],de);var ue=n(10);Core.exportToNamespace(["Player","Client","Components","WebPlayerSessionExpiredBanner"],ue);var ge=n(30);Core.exportToNamespace(["Player","Client","Components"],ge);var me=n(21);Core.exportToNamespace(["Player","Client","Components"],me);var he=n(31);Core.exportToNamespace(["Player","Client","Components"],he);var ye=n(23);Core.exportToNamespace(["Player","Client","Components"],ye);var fe=n(40);Core.exportToNamespace(["Player","Client"],fe)}]);
//# sourceMappingURL=D:/a/_work/1/s/obj/Assets/js/Player.Client/Player.Client.js.map
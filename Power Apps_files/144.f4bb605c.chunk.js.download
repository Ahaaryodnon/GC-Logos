/*! For license information please see 144.f4bb605c.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[144],{14929:function(e,n,t){"use strict";t.d(n,"a",(function(){return g}));var o=t(11021),r=t(11868),i=t(13747),a=t(11858),c=t(14922),l=t(14132),d=t(14930),s=t(13556),u=t(12291);function m(e,n,t,o,r,i,a){try{var c=e[i](a),l=c.value}catch(d){return void t(d)}c.done?n(l):Promise.resolve(l).then(o,r)}function f(e){return function(){var n=this,t=arguments;return new Promise((function(o,r){var i=e.apply(n,t);function a(e){m(i,o,r,a,c,"next",e)}function c(e){m(i,o,r,a,c,"throw",e)}a(void 0)}))}}function p(e,n){var t="/connectivity/tenants/:tenantId/environments/".concat(e,"/connections"),o=u.a.deprecateLegacyPARP,r=[];r.push("environment eq '".concat(e,"'"));var c=Object(i.d)(o?t:"/providers/Microsoft.PowerApps/connections",r.join(" and "),n,{"api-version":o?a.a:a.b});return c="https://".concat(o?"ppapi":"pa-rp").concat(c)}var v={method:"GET",team:o.j.PowerappsPortal,page:!0};function h(e){return w.apply(this,arguments)}function w(){return(w=f((function*(e){var{environmentId:n,objectId:t,telemetryScope:i}=e,a=Object(s.j)(i,s.g.connectionListQueryFn,s.d.ConnectionExperience,s.e.DataQueryFn,o.j.PowerappsPortal,o.f.Medium);try{var c,l,d,u=yield Object(r.f)(p(n||"",t),v);return a.complete({environmentId:n,responseLength:null==u||null===(c=u.data)||void 0===c||null===(l=c.value)||void 0===l?void 0:l.length}),(null==u||null===(d=u.data)||void 0===d?void 0:d.value)||[]}catch(m){throw a.failure({environmentId:n,error:m}),m}}))).apply(this,arguments)}function g(e){return y.apply(this,arguments)}function y(){return(y=f((function*(e){var n,t,r,{objectId:i,environmentId:a,apiId:u,telemetryScope:m}=e,f=Object(s.j)(m,s.g.connectionsWithDetailsQueryFn,s.d.ConnectionExperience,s.e.DataQueryFn,o.j.PowerappsPortal,o.f.Medium),p=[];try{return u?([n,t]=yield Promise.all([h({environmentId:a,objectId:i,telemetryScope:m}),Object(c.a)({environmentId:a,objectId:i,apiId:u,telemetryScope:m})]),p=n.filter(e=>Object(l.e)(e)===(t&&t.id)).map(e=>d.a(e,t))):([n,r]=yield Promise.all([h({environmentId:a,objectId:i,telemetryScope:m}),Object(c.b)({environmentId:a,objectId:i,telemetryScope:m})]),p=n.map(e=>d.a(e,Object(l.d)(e,r)))),f.complete({environmentId:a,apiId:u,responseLength:p.length}),p}catch(v){throw f.failure({environmentId:a,apiId:u,error:v}),v}}))).apply(this,arguments)}},14930:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var o=t(14130),r=t(14132);function i(e,n){return{id:e?e.id:"",name:e?e.name:"",displayName:r.i(e),apiId:r.e(e),isInError:r.m(e),isAuthError:r.l(e),isConnected:r.k(e),isOnPrem:r.o(e),iconUri:r.f(e),statusErrorMessage:r.j(e),primaryRuntimeUrl:o.f(n)||"",apiDisplayName:o.d(n),apiName:null==n?void 0:n.name,connectionParameter:r.g(e),createdByUserId:r.h(e)}}},14941:function(e,n,t){"use strict";t.d(n,"a",(function(){return I})),t.d(n,"b",(function(){return P}));var o=t(11465),r=(t(14942),t(10926)),i=t.n(r),a=t(12217),c=t(11019),l=t(11021),d=t(12088),s=t(14943),u=t(11623),m=t(11625),f=t(12356);function p(){return(p=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}function v(e,n,t,o,r,i,a){try{var c=e[i](a),l=c.value}catch(d){return void t(d)}c.done?n(l):Promise.resolve(l).then(o,r)}var h=i.a.lazy(()=>Promise.resolve().then(t.bind(null,12835)).then(e=>({default:e.EmptyState}))),w="GET_ACCESS_TOKEN",g="WIDGET_READY",y="connectionsConfirmed",b="ConnectionReferencesFlowWidget.Load",C="ConnectionReferencesFlowWidget.AcquireToken";var j=Object(m.a)((function(e){var n,{environmentId:t,connectionReferences:m,onChangeConnectionSelection:p,t:h,setErrorMessage:j,styles:I,themeName:P,setIsLoadingConnectionReferencesFlowWidget:S,setStateError:N}=e,k={environmentId:t},[W,R]=i.a.useState(!1),[T,x]=i.a.useState(!1),F=i.a.useRef(!1);F.current=W;var A=Object(u.a)()(I),M=new MsFlowSdk({hostId:"ConnectionReferences",hostName:a.U.powerAppsFlowHostName,locale:Object(o.h)()}),z=i.a.useRef(null),D=e=>{N(e),j(e)};i.a.useEffect(()=>{var e,n,t;T&&(null===(e=(null===(t=z.current)||void 0===t?void 0:t.firstChild).contentWindow)||void 0===e||null===(n=e.focus)||void 0===n||n.call(e))},[T]);var L=function(){var e,n=(e=function*(e,n){var t=Object(l.X)("powerapps-connections",C),o=a.U.powerAppsFlowWidgetAuthorizationEndpoint;try{var r=yield Object(c.g)(o);t.complete(k),n(null,{token:r.accessToken})}catch(i){t.failure({data:k,error:i}),D(h("Common.request.failed"))}},function(){var n=this,t=arguments;return new Promise((function(o,r){var i=e.apply(n,t);function a(e){v(i,o,r,a,c,"next",e)}function c(e){v(i,o,r,a,c,"throw",e)}a(void 0)}))});return function(e,t){return n.apply(this,arguments)}}(),U=n=>{var t,o;D(h("Common.request.failed")),Object(l.U)(null!==(t=e.eventScope)&&void 0!==t?t:d.a,{eventName:"Flows/ConnectionReferences/onConnectionWizardError",eventData:{error:n}}),null===(o=e.onConnectionWizardError)||void 0===o||o.call(e,n)};return Object(r.useEffect)(()=>{var e,n=Object(l.X)("powerapps-connections",b),o=!1,r=-1;S&&S(!0);try{var i;e=M.renderWidget("connectionWizard",{container:"flow-widget-container-connectionreferences",enableOnBehalfOfTokens:!0,environmentId:t,widgetStyleSettings:{themeName:P||"default"},runtimeSettings:Object(f.b)(void 0,f.a.PowerAutomate),connectionWizardSettings:{connectionReferences:E(m),onConnectionReferencesConfirmed:e=>{o=!1,Object.keys(e).forEach(n=>{var t=e[n],o=m.find(e=>e.connectionreferencelogicalname===n);o&&o.selectedConnectionName!==t.selectedConnectionName&&p(o,t.selectedConnectionName)})},onConnectionWizardConfirmationButtonDetailsChanged:n=>{F.current&&!n.disabled&&(o||(o=!0,e.notify(y,null)))},onConnectionWizardError:U}}),n.progress({widgetId:O(null===(i=e)||void 0===i?void 0:i.url)}),e.listen(w,L),e.listen(g,()=>{n.complete(k),R(!0),window.clearTimeout(r),window.setTimeout(()=>{S&&S(!1),x(!0)},1e3)}),r=window.setTimeout(()=>{if(!F.current){var t,o,r=O(null===(t=e)||void 0===t?void 0:t.url);D(h("MultiConnectionsPicker.TimeoutLoadingPicker",{requestId:r})),S&&S(!1),n.failure({error:"The flows connection reference widget didn't load after 1 minute",widgetId:r,widgetUrl:null===(o=e)||void 0===o?void 0:o.url})}},6e4)}catch(a){n.failure({error:a,telemetryData:k})}return()=>{e&&(n.progress({disposed:!0}),window.clearTimeout(r),e.dispose())}},[t,null===(n=m[0])||void 0===n?void 0:n.connectorid]),i.a.createElement("div",{className:A.headerContainer,style:{display:T?"flex":"none"}},i.a.createElement("div",{className:A.title},h("MultiConnectionsPicker.inlineConnection.title")),i.a.createElement("div",{className:A.subtitle},h("MultiConnectionsPicker.inlineConnection.info")),i.a.createElement("div",{id:"flow-widget-container-connectionreferences",ref:z,className:s.a.iframeContainer}))}),s.b);function I(e){var{t:n,setErrorMessage:t}=e,[o,r]=i.a.useState(void 0);return i.a.createElement(i.a.Fragment,null,!o&&i.a.createElement(j,p({},e,{setStateError:r})),o&&i.a.createElement(i.a.Suspense,{fallback:null},i.a.createElement(h,{iconProps:{iconName:"StatusCircleErrorX"},title:n("MultiConnectionsWidget.loadError"),showPrimaryButton:!0,primaryButtonText:n("Common.request.tryAgain"),onPrimaryButtonClick:()=>{r(void 0),t("")}})))}function E(e){var n={};return e.forEach(e=>{n[e.connectionreferencelogicalname]={connectionProviderId:e.connectorid,connectionReferenceLogicalName:e.connectionreferencelogicalname,displayName:e.connectionreferencedisplayname}}),n}function P(e,n){switch(e){case"contrast":return"teams_high_contrast";case"dark":return n?"teams_modal_dark":"teams_dark";case"default":default:return n?"teams_modal":"teams"}}function O(e){var n;try{n=new URLSearchParams(new URL(e).search).get("widgetId")||"00000000-0000-0000-0000-000000000000"}catch(t){n="00000000-0000-0000-0000-000000000001"}return n}},14943:function(e,n,t){"use strict";t.d(n,"b",(function(){return r})),t.d(n,"a",(function(){return i}));var o=t(10929);function r(e){return{headerContainer:{height:"100%",width:"100%",flexDirection:"column",display:"flex"},title:{fontSize:"12px",fontWeight:600,paddingTop:"5px"},subtitle:{fontWeight:400,paddingTop:"4px",paddingBottom:"20px",fontSize:"12px"}}}var i=Object(o.db)({iframeContainer:{width:"100%",height:"100%",selectors:{"& > iframe":{width:"100%",height:"100%"}}}})}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/144.f4bb605c.chunk.js.map
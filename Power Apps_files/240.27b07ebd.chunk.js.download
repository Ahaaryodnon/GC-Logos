/*! For license information please see 240.27b07ebd.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[240],{17553:function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var r=n(17548),i=n(17554);function o(e,t,n,r,i,o,a){try{var s=e[o](a),l=s.value}catch(P){return void n(P)}s.done?t(l):Promise.resolve(l).then(r,i)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class P extends i.a{constructor(e,t,n,i,o){if(super(t,n,i,o),this.shouldEnablePARPToPPAPIConversion=void 0,this.shouldEnablePARPToPPAPIConnectivityRoutes=!1,this.parpToPpapiPathMap=void 0,!this.getIsPPAPIMiddlewareInitialized())throw Error("[PARPToPPAPIMiddleware] PPAPIMiddleware should be initialized first! You may call initializePPAPIMiddleware before initializePARPToPPAPIMiddleware");this.shouldEnablePARPToPPAPIConversion=e,this.getPPAPIMiddlewareLogger()("PARPToPPAPIMiddleware/initializePARPToPPAPIMiddleware",{shouldEnablePARPToPPAPIConversion:this.shouldEnablePARPToPPAPIConversion}),this.parpToPpapiPathMap=r.a}setShouldEnablePARPToPPAPIConversion(e){this.shouldEnablePARPToPPAPIConversion!==e&&(this.getPPAPIMiddlewareLogger()("PARPToPPAPIMiddleware/updatePARPToPPAPIMiddleware",{from:this.shouldEnablePARPToPPAPIConversion,to:e}),this.shouldEnablePARPToPPAPIConversion=e)}setShouldEnablePARPToPPAPIConnectivityRoutes(e){this.shouldEnablePARPToPPAPIConnectivityRoutes!==e&&(this.getPPAPIMiddlewareLogger()("PARPToPPAPIMiddleware/updatePARPToPPAPIMiddleware",{from:this.shouldEnablePARPToPPAPIConnectivityRoutes,to:e}),this.shouldEnablePARPToPPAPIConnectivityRoutes=e,this.shouldEnablePARPToPPAPIConnectivityRoutes&&(this.parpToPpapiPathMap=this.parpToPpapiPathMap.concat(r.b)))}tryConvertPARPRequestAndSetConfigContext(e){if((e=this.preConversion(e)).context&&e.context.ppapiContext)return e;var t=new URL(e.url);if(this.shouldSkipConversion(t))return e;var n=t.pathname,i=Object(r.h)(n,this.parpToPpapiPathMap);if(!i.converted)return this.getPPAPIMiddlewareLogger()("PARPToPPAPIMiddleware/tryConvertPARPToPPAPI",{oriUrlPathname:n,message:"tryConvertPARPToPPAPI failed. oriUrlPathname '"+n+"' could miss mapping in PARPToPPAPIPathMap"}),e;var o=this.getEndpoint(n,i.ppapiNamespace,i.matchedParams?i.matchedParams.environmentName:null,i.matchedParams?i.matchedParams.tenantId:null),a=Object(r.g)(i.newPath,this.currentContext);return i.newQueryParams&&Object.keys(i.newQueryParams).forEach(e=>{t.searchParams.set(e,i.newQueryParams[e])}),t.hostname=r.f.PPAPI,e.url=t.href,t.pathname=a,e.context=s(s({},e.context),{},{ppapiContext:{endpoint:o,url:t.href,newMethod:i.newMethod}}),this.getPPAPIMiddlewareLogger()("PARPToPPAPIMiddleware/tryConvertAndSetConfigContext",{oriUrlPathname:n,ppapiContext:e.context.ppapiContext}),n.indexOf("/scopes/admin/")>0&&(e.headers=s(s({},e.headers),{},{"x-ms-api-context-type":"Admin"})),e}shouldSkipConversion(e){return"true"===e.searchParams.get("skip-ppapi")}parpToPPAPIPreRequestHandler(e){var t,n=this;return(t=function*(){var t=new URL(e.url);return(e.service||t.hostname)===r.f.RP&&n.shouldEnablePARPToPPAPIConversion?(e=n.tryConvertPARPRequestAndSetConfigContext(e),Promise.resolve(e)):Promise.resolve(e)},function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function s(e){o(a,r,i,s,l,"next",e)}function l(e){o(a,r,i,s,l,"throw",e)}s(void 0)}))})()}}},17554:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(16199),i=n(17548);function o(e,t,n,r,i,o,a){try{var s=e[o](a),l=s.value}catch(P){return void n(P)}s.done?t(l):Promise.resolve(l).then(r,i)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function s(e){o(a,r,i,s,l,"next",e)}function l(e){o(a,r,i,s,l,"throw",e)}s(void 0)}))}}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class u{constructor(e,t,n,i){this.clusterCategory=void 0,this.logger=void 0,this.apiDiscovery=void 0,this.authorizationEndpoint=void 0,this.isPPAPIMiddlewareInitialized=!1,this.currentContext={tenantId:void 0,environmentName:void 0},this.clusterCategory=e,this.logger=t,this.apiDiscovery=new r.a(this.clusterCategory),this.authorizationEndpoint=this.apiDiscovery.getTokenAudience(),this.setPPAPICurrentEnvironmentName(n),this.setPPAPICurrentTenantId(i),this.isPPAPIMiddlewareInitialized=!0,this.logger("PPAPIMiddleware/initializePPAPIMiddleware",{curClusterCategory:this.clusterCategory})}getIsPPAPIMiddlewareInitialized(){return this.isPPAPIMiddlewareInitialized}getPPAPIMiddlewareLogger(){return this.logger}getAuthorizationEndpoint(){return this.authorizationEndpoint}setPPAPICurrentEnvironmentName(e){this.currentContext.environmentName!==e&&(this.logger("PPAPIMiddleware/setPPAPICurrentEnvironmentName",{from:this.currentContext.environmentName,to:e}),this.currentContext.environmentName=e)}setPPAPICurrentTenantId(e){this.currentContext.tenantId!==e&&(this.logger("PPAPIMiddleware/setPPAPICurrentTenantId",{from:this.currentContext.tenantId,to:e}),this.currentContext.tenantId=e)}tryConvertPPAPIRequestAndSetConfigContext(e){if((e=this.preConversion(e)).context&&e.context.ppapiContext)return this.logger("PPAPIMiddleware/tryConvertAndSetConfigContext",{ppapiContext:e.context.ppapiContext,result:"skipped as ppapiConvertion was completed before or not needed"}),e;var t=new URL(e.url),n=t.pathname;if(t.hostname!==i.f.PPAPI)return e;var r=Object(i.i)(t.pathname);if(!r.converted)throw Error("[PPAPIMiddleware] tryMapSwaggerToPPAPI failed. Swagger '"+t+"' could be invalid!");var o=this.getEndpoint(n,r.ppapiNamespace,r.matchedParams?r.matchedParams.environmentName:null,r.matchedParams?r.matchedParams.tenantId:null),a=Object(i.g)(r.newPath,this.currentContext);return t.pathname=a,e.context=l(l({},e.context),{},{ppapiContext:{endpoint:o,url:t.href}}),this.logger("PPAPIMiddleware/tryConvertAndSetConfigContext",{oriUrlPathname:n,ppapiContext:e.context.ppapiContext}),e}getEndpoint(e,t,n,r){var o;switch(t){case i.d.Environment:if(n&&!n.startsWith(":")){o=this.apiDiscovery.getEnvironmentEndpoint(n);break}if(!this.currentContext.environmentName)throw Error("[PPAPIMiddleware] Invalid request with currentEnvironmentId '"+this.currentContext.environmentName+"' for url oriUrlPathname '"+e+"'");o=this.apiDiscovery.getEnvironmentEndpoint(this.currentContext.environmentName);break;case i.d.Tenant:if(r&&!r.startsWith(":")){o=this.apiDiscovery.getTenantEndpoint(r);break}if(!this.currentContext.tenantId)throw Error("[PPAPIMiddleware] Invalid request with currentTenantId '"+this.currentContext.tenantId+"' for url oriUrlPathname '"+e+"'");o=this.apiDiscovery.getTenantEndpoint(this.currentContext.tenantId);break;case i.d.TenantIsland:if(r&&!r.startsWith(":")){o=this.apiDiscovery.getTenantIslandClusterEndpoint(r);break}if(!this.currentContext.tenantId)throw Error("[PPAPIMiddleware] Invalid request for Tenant Island Endpoint with currentTenantId 'il-"+this.currentContext.tenantId+"' for url oriUrlPathname '"+e+"'");o=this.apiDiscovery.getTenantIslandClusterEndpoint(this.currentContext.tenantId);break;default:throw Error("[PPAPIMiddleware] Invalid request: Unknown PPAPINamespace '"+t+"' for url oriUrlPathname '"+e+"'")}return o}getPPAPIEndpoint(e){var t=this;return a((function*(){return e=t.tryConvertPPAPIRequestAndSetConfigContext(e),Promise.resolve(e.context.ppapiContext.endpoint)}))()}PPAPIRequestHandler(e){var t=this;return a((function*(){e=t.tryConvertPPAPIRequestAndSetConfigContext(e);var n=new URL(e.context.ppapiContext.url);return e.context.ppapiContext.newMethod&&(e.method=e.context.ppapiContext.newMethod),n.hostname=e.context.ppapiContext.endpoint,e.url=n.href,e.context.ppapiContext.url=void 0,Promise.resolve(e)}))()}preConversion(e){var t=new URL(e.url);if(t.hostname.endsWith(this.authorizationEndpoint.replace("https://",""))){var n=t.host;t.hostname=i.f.PPAPI;var r=e.context&&e.context.ppapiContext&&e.context.ppapiContext.url,o=e.context&&e.context.ppapiContext&&e.context.ppapiContext.newMethod;e.context=l(l({},e.context),{},{ppapiContext:{endpoint:n,url:r||t.href,newMethod:o}}),e.url=t.href}return e}}},17555:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return l}));var r=n(17553),i=n(17548);function o(e,t,n,r,i,o,a){try{var s=e[o](a),l=s.value}catch(P){return void n(P)}s.done?t(l):Promise.resolve(l).then(r,i)}var a=function(e){return e.tie="tie",e.test="test",e.preprod="preprod",e.preview="preview",e.prod="prod",e.gov="gov",e.high="high",e.dod="dod",e.mooncake="mooncake",e.ex="ex",e.rx="rx",e}({}),s=Object.values(a);class l{constructor(e,t){var n=this;this.ppapiMiddlewareClientInstance=void 0,this.regionToClusterCategoryMap=new Map([]),this.apiDiscoveryFactory=e=>{var t=this.regionToClusterCategoryMap.get(e);return new i.e(t)},this.setShouldEnablePARPToPPAPIConversion=e=>{this.ppapiMiddlewareClientInstance instanceof r.a&&this.ppapiMiddlewareClientInstance.setShouldEnablePARPToPPAPIConversion(e)},this.setShouldEnablePARPToPPAPIConnectivityRoutes=e=>{this.ppapiMiddlewareClientInstance instanceof r.a&&this.ppapiMiddlewareClientInstance.setShouldEnablePARPToPPAPIConnectivityRoutes(e)},this.parpToPPAPIPreRequestHandler=e=>this.ppapiMiddlewareClientInstance.parpToPPAPIPreRequestHandler(e),this.PPAPIRequestHandler=e=>this.ppapiMiddlewareClientInstance.PPAPIRequestHandler(e),this.setPPAPICurrentEnvironmentName=e=>this.ppapiMiddlewareClientInstance.setPPAPICurrentEnvironmentName(e),this.setPPAPICurrentTenantId=e=>this.ppapiMiddlewareClientInstance.setPPAPICurrentTenantId(e),this.getAuthorizationEndpoint=e=>Promise.resolve(this.apiDiscoveryFactory(e).getTokenAudience()),this.getPPAPIAuthorizationEndpointConfiguration=()=>s.reduce((e,t)=>(e[t]=()=>this.getAuthorizationEndpoint(t),e),{}),this.getPPAPIEndpointConfiguration=()=>s.reduce((e,t)=>(e[t]=function(){var e,t=(e=function*(e){return n.ppapiMiddlewareClientInstance.getPPAPIEndpoint(e)},function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function s(e){o(a,r,i,s,l,"next",e)}function l(e){o(a,r,i,s,l,"throw",e)}s(void 0)}))});return function(e){return t.apply(this,arguments)}}(),e),{}),this.ppapiMiddlewareClientInstance=e,this.regionToClusterCategoryMap=t}}},17716:function(e,t,n){"use strict";n.d(t,"o",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"i",(function(){return a})),n.d(t,"p",(function(){return s})),n.d(t,"n",(function(){return l})),n.d(t,"f",(function(){return P})),n.d(t,"e",(function(){return u})),n.d(t,"g",(function(){return p})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return c})),n.d(t,"l",(function(){return h})),n.d(t,"v",(function(){return m})),n.d(t,"u",(function(){return C})),n.d(t,"k",(function(){return v})),n.d(t,"s",(function(){return g})),n.d(t,"r",(function(){return f})),n.d(t,"q",(function(){return A})),n.d(t,"m",(function(){return I})),n.d(t,"h",(function(){return b})),n.d(t,"t",(function(){return w})),n.d(t,"a",(function(){return T}));var r=n(17717);n.d(t,"j",(function(){return r.a}));var i={imageToApp:"/environment/:environmentId/createapp/image"},o={Upload:"upload",Sample:"sample",Figma:"figma"},a=function(e){return e.NewTable="new",e.Skip="skip",e}({}),s="sample",l=function(e){return e[e.Left=0]="Left",e[e.Right=1]="Right",e}({}),P={SolutionId:"00000001-0000-0000-0001-00000000009b",SolutionDisplayName:"Common Data Services Default Solution"},u={PublisherId:"00000001-0000-0000-0000-00000000005a",PublisherDisplayName:"CDS Default Publisher"},p="new",d="new",c={LogicalName:"name",DisplayName:"Name"},h={FromImage:"https://go.microsoft.com/fwlink/?linkid=2192157",FromFigma:"https://go.microsoft.com/fwlink/?linkid=2193888"},m="v1.0",C={processImage:"appintelligence/processimage",processControls:"appintelligence/processcontrols",createAppFromImage:"appintelligence/image/createapp",downloadApp:"appintelligence/downloadapp?sessionId=",createAppFromFigma:"appintelligence/figma/createapp"},v={InvalidResponse:"InvalidResponse",InvalidEnvironment:"InvalidEnvironment",TableNameConflict:"TableNameConflict",TablePermissionsMissing:"TablePermissionsMissing",TableCreateError:"TableCreateError",AttributeCreateError:"AttributeCreateError",TableCreatePermissionsMissing:"TableCreatePermissionsMissing",AttributeCreatePermissionsMissing:"AttributeCreatePermissionsMissing",AppNameValidationError:"appNameValidationError",FigmaUrlError:"figmaUrlError",FigmaApiKeyError:"figmaApiKeyError"},g="".concat("CreateFromContent","/Image"),f="".concat("CreateFromContent","/Figma"),A={ProcessImage:"ProcessImage",ProcessControls:"ProcessControls",CreateAppFromImage:"CreateApp/Image",CreateAppFromFigma:"CreateApp/Figma",DownloadApp:"DownloadApp",OpenApp:"OpenApp",FormValidation:"FormValidation",LoadCdsMetadataClient:"LoadCdsMetadataClient",CheckTableNameExists:"CheckTableNameExists",CreateTableWithAttributes:"CreateTableWithAttributes",CheckUserPrivileges:"CheckUserPrivileges",WizardAdvanceClick:"WizardAdvanceClick",WizardBackClick:"WizardBackClick",WizardCreateClick:"WizardCreateClick",WizardCloseClick:"WizardCloseClick",CarouselImageClick:"CarouselImageClick",LaunchWizardClick:"LaunchWizardClick",PivotTabClick:"PivotTabClick",TableSettingsClick:"TableSettingsClick",TableSettingsClosed:"TableSettingsClosed",NavigateToApp:"NavigateToApp",AddControl:"AddControl",UpdateControl:"UpdateControl",DeleteControl:"DeleteControl",AddColumn:"AddColumn",UpdateColumn:"UpdateColumn",DeleteColumn:"DeleteColumn",GetDefaultSolution:"GetDefaultSolution",ValidateLinkAndToken:"ValidateFigmaLinkAndToken",LearnMoreClicked:"LearnMoreClicked",CarouselNavigation:"CarouselNavigation",GetPublishers:"GetPublishers",GetSolutions:"GetSolutions",GetTables:"GetTables",GetColumns:"GetColumns",CreateAttribute:"CreateAttribute",DuplicateFigmaUIKit:"DuplicateFigmaUIKit",CheckAppNameExists:"CheckAppNameExists",GetPreviewImage:"GetPreviewImage"},I={Dataverse:{TableDisplayName:50,TablePluralName:50,TableLogicalName:41,TableDescription:300,ColumnDisplayName:50,ColumnLogicalName:39,ColumnDescription:200,AppDisplayName:64}},b="https://go.microsoft.com/fwlink/?linkid=2193981",w="https://go.microsoft.com/fwlink/?linkid=2243308",T=function(e){return e[e.NotSpecified=0]="NotSpecified",e[e.Available=1]="Available",e[e.Unavailable=2]="Unavailable",e[e.Malformed=3]="Malformed",e}({})},17717:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={appNameInput:"appNameInput",imageSourceOptions:"imageSourceOptions",sampleImageOptions:"sampleImageOptions",formatOptions:"formatOptions",documentCommands:"documentCommands",openTableSettings:"openTableSettings",saveTableSettings:"saveTableSettings",cancelTableSettings:"cancelTableSettings",tableDisplayName:"tableDisplayName",tablePluralName:"tablePluralName",tableLogicalName:"tableLogicalName",tablePrimaryColumnDropdown:"tablePrimaryColumnDropdown",taggingDetailsView:"taggingDetailsView",guidanceDetailsView:"guidanceDetailsView",columnsDetailsList:"columnsDetailsList",controlsDetailsList:"controlsDetailsList",dataSetupOptions:"dataSetupOptions",reviewTableNameLabel:"reviewTableNameLabel",reviewColumnsDetailsList:"reviewColumnsDetailsList",choosePublisher:"choosePublisher",chooseSolution:"chooseSolution",chooseTable:"chooseTable",chooseColumn:"chooseColumn"}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/240.27b07ebd.chunk.js.map
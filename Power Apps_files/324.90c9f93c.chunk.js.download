(window.webpackJsonp=window.webpackJsonp||[]).push([[324],{19518:function(n,t,e){"use strict";e.d(t,"b",(function(){return f})),e.d(t,"a",(function(){return h}));var o=e(10926),i=e(11208),r=e(11939),s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e])};function l(n,t){function e(){this.constructor=n}s(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}var a=Object.assign||function(n){for(var t,e=1,o=arguments.length;e<o;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},p=Object(i.shape)({onComponentsChange:i.func.isRequired,removeOnComponentsChange:i.func.isRequired}),u=Object(i.shape)({emit:i.func.isRequired,on:i.func.isRequired,off:i.func.isRequired}),h=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),t.prototype.componentWillMount=function(){this.context.bus.emit("fill-mount",{fill:this})},t.prototype.componentDidUpdate=function(){this.context.bus.emit("fill-updated",{fill:this})},t.prototype.componentWillUnmount=function(){this.context.bus.emit("fill-unmount",{fill:this})},t.prototype.render=function(){return null},t.contextTypes={bus:u},t}(o.Component),c=function(){function n(n){this._bus=n,this.handleFillMount=this.handleFillMount.bind(this),this.handleFillUpdated=this.handleFillUpdated.bind(this),this.handleFillUnmount=this.handleFillUnmount.bind(this),this._db={byName:new Map,byFill:new Map}}return n.prototype.mount=function(){this._bus.on("fill-mount",this.handleFillMount),this._bus.on("fill-updated",this.handleFillUpdated),this._bus.on("fill-unmount",this.handleFillUnmount)},n.prototype.unmount=function(){this._bus.off("fill-mount",this.handleFillMount),this._bus.off("fill-updated",this.handleFillUpdated),this._bus.off("fill-unmount",this.handleFillUnmount)},n.prototype.handleFillMount=function(n){var t=n.fill,e=o.Children.toArray(t.props.children),i=t.props.name,r={fill:t,children:e,name:i},s=this._db.byName.get(i);s?(s.components.push(r),s.listeners.forEach((function(n){return n(s.components)}))):this._db.byName.set(i,{listeners:[],components:[r]}),this._db.byFill.set(t,r)},n.prototype.handleFillUpdated=function(n){var t=n.fill,e=this._db.byFill.get(t),i=o.Children.toArray(t.props.children);if(!e)throw new Error("component was expected to be defined");e.children=i;var r=e.name,s=this._db.byName.get(r);if(!s)throw new Error("registration was expected to be defined");s.listeners.forEach((function(n){return n(s.components)}))},n.prototype.handleFillUnmount=function(n){var t=n.fill,e=this._db.byFill.get(t);if(!e)throw new Error("component was expected to be defined");var o=e.name,i=this._db.byName.get(o);if(!i)throw new Error("registration was expected to be defined");var r=i.components;r.splice(r.indexOf(e),1),this._db.byFill.delete(t),0===i.listeners.length&&0===i.components.length?this._db.byName.delete(o):i.listeners.forEach((function(n){return n(i.components)}))},n.prototype.onComponentsChange=function(n,t){var e=this._db.byName.get(n);e?(e.listeners.push(t),t(e.components)):(this._db.byName.set(n,{listeners:[t],components:[]}),t([]))},n.prototype.getFillsByName=function(n){var t=this._db.byName.get(n);return t?t.components.map((function(n){return n.fill})):[]},n.prototype.getChildrenByName=function(n){var t=this._db.byName.get(n);return t?t.components.map((function(n){return n.children})).reduce((function(n,t){return n.concat(t)}),[]):[]},n.prototype.removeOnComponentsChange=function(n,t){var e=this._db.byName.get(n);if(!e)throw new Error("expected registration to be defined");var o=e.listeners;o.splice(o.indexOf(t),1)},n}(),f=(function(n){function t(){var t=n.call(this)||this;return t._bus=new r.a,t._manager=new c(t._bus),t._manager.mount(),t}l(t,n),t.prototype.componentWillUnmount=function(){this._manager.unmount()},t.prototype.getChildContext=function(){return{bus:this._bus,manager:this._manager}},t.prototype.render=function(){return this.props.children},t.prototype.getFillsByName=function(n){return this._manager.getFillsByName(n)},t.prototype.getChildrenByName=function(n){return this._manager.getChildrenByName(n)},t.childContextTypes={manager:p,bus:u}}(o.Component),function(n){function t(t){var e=n.call(this,t)||this;return e.state={components:[]},e.handleComponentChange=e.handleComponentChange.bind(e),e}return l(t,n),t.prototype.componentWillMount=function(){this.context.manager.onComponentsChange(this.props.name,this.handleComponentChange)},t.prototype.handleComponentChange=function(n){this.setState({components:n})},Object.defineProperty(t.prototype,"fills",{get:function(){return this.state.components.map((function(n){return n.fill}))},enumerable:!0,configurable:!0}),t.prototype.componentWillReceiveProps=function(n){if(n.name!==this.props.name){this.context.manager.removeOnComponentsChange(this.props.name,this.handleComponentChange);var t=n.name;this.context.manager.onComponentsChange(t,this.handleComponentChange)}},t.prototype.componentWillUnmount=function(){var n=this.props.name;this.context.manager.removeOnComponentsChange(n,this.handleComponentChange)},t.prototype.render=function(){var n=this,t=[];if(this.state.components.forEach((function(e,i){var r=e.fill,s=e.children,l=n.props.fillChildProps;if(l){var p=Object.keys(l).reduce((function(t,e){var o=l[e];return t[e]="function"==typeof o?function(){return o(r,n.fills)}:o,t}),{});s.forEach((function(n,e){if("number"==typeof n||"string"==typeof n)throw new Error("Only element children will work here");t.push(Object(o.cloneElement)(n,a({key:i.toString()+e.toString()},p)))}))}else s.forEach((function(n,e){if("number"==typeof n||"string"==typeof n)throw new Error("Only element children will work here");t.push(Object(o.cloneElement)(n,{key:i.toString()+e.toString()}))}))})),"function"==typeof this.props.children){var e=this.props.children(t);if(Object(o.isValidElement)(e)||null===e)return e;var i=this._reactInternalInstance._currentElement._owner._instance.constructor,r=i.displayName||i.name;throw new Error("Slot rendered with function must return a valid React Element. Check the "+r+" render function.")}return t},t.contextTypes={manager:p},t}(o.Component))}}]);
/*! For license information please see 218.5ebea240.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[218],{17427:function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return p})),r.d(t,"c",(function(){return d}));var n=r(12219),i=r(10926),a=r(14226);function s(e,t,r,n,i,a,s){try{var o=e[a](s),c=o.value}catch(l){return void r(l)}o.done?t(c):Promise.resolve(c).then(n,i)}function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function c(e){return function(t){return i.createElement(e,o({},t,{getMetadataClient:a.c}))}}var l=i.createContext({metadataClient:null,metadataClientCreationStatus:a.a.Processing});class u extends i.Component{constructor(e){super(e),this.state={metadataClient:null,metadataClientCreationStatus:a.a.Processing}}componentDidMount(){this.createMetadataClient()}componentDidUpdate(e){e.currentEnvironment&&this.props.currentEnvironment&&this.isEnvironmentUpdated(e.currentEnvironment,this.props.currentEnvironment)&&this.createMetadataClient()}render(){var e=this.state;return i.createElement(l.Provider,{value:e},this.props.children)}createMetadataClient(){var e,t=this;return(e=function*(){t.setState({metadataClient:null,metadataClientCreationStatus:a.a.Processing});var e=yield Object(a.d)(t.props.currentEnvironment);t.setState(e)},function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function o(e){s(a,n,i,o,c,"next",e)}function c(e){s(a,n,i,o,c,"throw",e)}o(void 0)}))})()}isEnvironmentUpdated(e,t){return(null==e?void 0:e.id)!==(null==t?void 0:t.id)||!(Object(n.v)(e)||!Object(n.v)(t))}}var p=Object(n.cb)(u,!0);function d(e){return function(t){return i.createElement(l.Consumer,null,r=>i.createElement(e,o({},t,r)))}}},17441:function(e,t,r){"use strict";r.d(t,"a",(function(){return A})),r.d(t,"b",(function(){return T})),r.d(t,"c",(function(){return x}));var n=r(11858),i=r(17342),a=r(15949),s=r(11020),o=r(11842),c=r(11870),l=r(11465),u=r(12068),p=r(11940),d=r(11942),m=r(10926),v=r(17442),f=r(17443),P=r(17444),b=r(11205),h=r(11021),g=r(12291);function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var j=[{licenseSku:f.a.P2,isTrial:!0}];function y(){return{activeUserPlans:[],expiredUserPlans:[],currentPlansMetaData:{canAccessPremiumAnalyticsReports:!1,canAccessOnPremGateway:!1,canAccessPremiumApis:!1,doesUserHaveActivePremiumPlan:!1,doesUserHaveExpiredPremiumPlan:!1,doesUserHaveExpiredP2Plan:!1,doesUserHaveActiveDevPlan:!1,doesUserHaveActiveP2Plan:!1,doesUserHaveO365Plan:!1,getEnabledP2AndDevPlansSkuAndTrialInfo:j,additionalAllowedPremiumApis:[]},requestP2PlanRenewal:()=>E,signUpForP2Trial:(e,t)=>E,markRenewTrialAsDismissed:()=>E,resetRenewTrialValues:()=>E,plansLoadingStatus:o.a.NotLoaded}}var E=new Promise(()=>{}),A=m.createContext(y());class D extends m.Component{constructor(e){super(e),this.timeoutId=void 0,this.requestP2PlanRenewal=()=>this.props.getUserSettings(v.a.renewTrial),this.signUpForP2Trial=(e,t)=>{var r="https://bap-rp/providers/Microsoft.BusinessAppPlatform/servicePlans?api-version=".concat(e),n={licenseid:t};return this.props.httpClient.post(r,n).then(e=>e.data)},this.getPlansFromRp=()=>{this.props.httpClient.get(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?"https://ppapi/powerapps/tenants/:tenantId/plans?api-version=".concat("1"):"https://pa-rp/api/providers/Microsoft.PowerApps/objectIds/".concat(e,"/plans?api-version=").concat(n.b)}(this.props.oid,this.props.deprecateLegacyPARPForEssentialServices),{team:h.j.Shell}).then(e=>{this._setPlanState(Object(P.j)(e.data.value),Object(P.j)(e.data.value,!0)),u.c.setItemAsync("user-plans",e.data.value)}).catch(()=>{u.c.removeItemAsync("user-plans")})};var t=!g.a.provisionDevEnvironmentWithoutEnrollmentCall&&this.props.enrollmentLoadingStatus===o.a.NotLoaded&&this.isDevOfferInQuery();this.state=S(S({},y()),{},{waitingForEnrollments:t})}componentWillUnmount(){clearTimeout(this.timeoutId)}componentDidMount(){this.props.hasUserEnrolledAtLeastOnce&&(u.c.getItemAsync("user-plans").then(e=>{e&&this.state.plansLoadingStatus===o.a.NotLoaded&&this._setPlanState(Object(P.j)(e),Object(P.j)(e,!0))}),this.getPlansFromRp())}UNSAFE_componentWillReceiveProps(e){e.enrollmentLoadingStatus===o.a.Loaded&&this._setPlanState(e.enrollmentAndUserDetails.activeUserPlans,e.enrollmentAndUserDetails.expiredUserPlans,{waitingForEnrollments:this.state.waitingForEnrollments&&!e.enrollmentFullyLoaded})}render(){var e=S(S({},this.state),{},{requestP2PlanRenewal:this.requestP2PlanRenewal,signUpForP2Trial:this.signUpForP2Trial,resetRenewTrialValues:this.resetRenewTrialValues,markRenewTrialAsDismissed:this.markRenewTrialAsDismissed}),t=this.state.waitingForEnrollments?m.createElement(U,null):this.props.children;return m.createElement(A.Provider,{value:e},m.createElement(m.Fragment,null,t))}markRenewTrialAsDismissed(){return this.updateRenewTrialValues("true")}resetRenewTrialValues(){return this.updateRenewTrialValues("false")}updateRenewTrialValues(e){return this.props.setUserSettings(v.a.renewTrial,"dismissed",e)}_setPlanState(e,t,r){this.setState(S({activeUserPlans:e,expiredUserPlans:t,currentPlansMetaData:{canAccessOnPremGateway:Object(P.a)(e),canAccessPremiumAnalyticsReports:Object(P.b)(e),canAccessPremiumApis:Object(P.c)(e),doesUserHaveActiveDevPlan:Object(P.d)(e),doesUserHaveActiveP2Plan:Object(P.e)(e),doesUserHaveActivePremiumPlan:Object(P.f)(e),doesUserHaveExpiredPremiumPlan:Object(P.h)(t),doesUserHaveExpiredP2Plan:Object(P.g)(t),doesUserHaveO365Plan:Object(P.i)(e),getEnabledP2AndDevPlansSkuAndTrialInfo:Object(P.l)(e),additionalAllowedPremiumApis:Object(P.k)(e)},plansLoadingStatus:o.a.Loaded},r))}isDevOfferInQuery(){try{return"dev"===new URLSearchParams(this.props.location.search).get("offer")}catch(e){return!1}}}var U=Object(l.s)("PlansProvider")(e=>m.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"}},m.createElement("h4",{style:{maxWidth:"50%"}},e.t&&e.t("SyncPlans.message"),m.createElement(p.a,{size:d.a.large,style:{marginTop:"10px"}})))),T=Object(b.m)(Object(i.h)(Object(s.d)(Object(a.e)(Object(c.r)(D))))),x=Object(o.b)(A,"plansLoadingStatus")},17442:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){return e.renewTrial="renewTrial",e}({})},17443:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={P1:"P1",P2:"P2",SeededO365:"SeededO365",SeededD365:"SeededD365",Dev:"Dev",Free:"Free"}},17444:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return o})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"f",(function(){return u})),r.d(t,"h",(function(){return p})),r.d(t,"g",(function(){return d})),r.d(t,"i",(function(){return m})),r.d(t,"l",(function(){return v})),r.d(t,"j",(function(){return f})),r.d(t,"c",(function(){return P})),r.d(t,"k",(function(){return b}));var n=r(17445),i=r(12353);function a(e,t){return e&&i.some(e,e=>e.properties.licenseSku===n.a.P1||e.properties.licenseSku===n.a.P2&&e.properties.capabilityStatus===t)}function s(e){return e&&i.some(e,e=>e.properties&&e.properties.policies&&e.properties.policies.accessOnPremGateway)}function o(e){return e&&i.some(e,e=>e.properties&&e.properties.policies&&e.properties.policies.canAccessPremiumAnalyticsReports)}function c(e){return e&&i.some(e,e=>e.properties.licenseSku===n.a.Dev&&e.properties.capabilityStatus===n.b.Enabled)}function l(e){return e&&i.some(e,e=>e.properties.licenseSku===n.a.P2&&e.properties.capabilityStatus===n.b.Enabled)}function u(e){return a(e,n.b.Enabled)}function p(e){return a(e,n.b.Expired)}function d(e){return e&&i.some(e,e=>e.properties.licenseSku===n.a.P2&&e.properties.capabilityStatus===n.b.Expired)}function m(e){return e&&i.some(e,e=>e.properties.licenseSku===n.a.SeededO365&&e.properties.capabilityStatus===n.b.Enabled)}function v(e){return e?e.filter(e=>e.properties&&(e.properties.licenseSku===n.a.P2||e.properties.licenseSku===n.a.Dev)&&e.properties.capabilityStatus===n.b.Enabled).map(e=>({licenseSku:e.properties.licenseSku,isTrial:e.properties.isTrial})):[]}function f(e,t){return t?e.filter(e=>e.properties.capabilityStatus===n.b.Expired):e.filter(e=>e.properties.capabilityStatus===n.b.Enabled)}function P(e){return e.some(e=>e.properties&&e.properties.policies&&e.properties.policies.accessPremiumApis)}function b(e){return e?e.filter(e=>e.properties&&e.properties.policies&&e.properties.policies.additionalAllowedPremiumApis).reduce((e,t)=>e.concat(t.properties.policies.additionalAllowedPremiumApis||[]),[]):[]}},17445:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));var n={P1:"P1",P2:"P2",SeededO365:"SeededO365",SeededD365:"SeededD365",Dev:"Dev",Free:"Free"},i={Enabled:"Enabled",Disabled:"Disabled",Expired:"Expired"}},18820:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return s}));var n=r(11885),i=function(e){return e.svg="svg",e.png="png",e}({}),a=e=>{var t=/(?:\.([^.]+))?$/.exec(e);return(t&&t[1]||"").toLowerCase()},s=(e,t,r)=>{switch(e){case i.svg:return"data:image/svg+xml;base64,".concat(t);case i.png:return"data:image/png;base64,".concat(t);default:switch(r){case n.I.PNG:return"data:image/png;base64,".concat(t);case n.I.JPG:return"data:image/jpeg;base64,".concat(t);case n.I.GIF:return"data:image/gif;base64,".concat(t);case n.I.SVG:return"data:image/svg+xml;base64,".concat(t);case n.I.ICO:return"data:image/x-icon;base64,".concat(t);default:return}}}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/218.5ebea240.chunk.js.map
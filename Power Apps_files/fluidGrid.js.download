"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var AppMagic;!function(e){!function(e){!function(t){var o=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.renderCore=function(){var e=this.props,o=e.getControl,i=e.controlInstance,n=e.controlContext,r=e.textDirection;return n._requestRenderObservable(),React.createElement(t.DataCardView,{controlContext:n,getControl:o,controlInstance:i,bindingContext:n.bindingContext,textDirection:r})},o}(e.ObservableComponent);t.DataCardContainer=o}(e.FluidGrid||(e.FluidGrid={}))}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){!function(o){var i=function(e){function i(t){var o=e.call(this,t)||this;return o._handleContainerRef=o._handleContainerRef.bind(o),o}return __extends(i,e),i.prototype.render=function(){var i=this.props.controlContext,n=e.prototype.getChildControls.call(this),r=i.properties&&i.properties.ResizerGrip&&i.properties.ResizerGrip()?React.createElement(t.RuntimeControlResizersContainer,{controlContext:i}):null;return React.createElement("div",{ref:this._handleContainerRef,className:"appmagic-card ".concat(aphrodite.css(o.DataCardStyles.card))},n,r)},i.prototype._handleContainerRef=function(e){this._container=e?e.parentElement:null},i}(e.Controls.Container.ContainerViewBase);o.DataCardView=i}(t.FluidGrid||(t.FluidGrid={}))}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){!function(t){var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.resizeAuthoringCanvas=function(e,t,o,i){this.OpenAjax.updateBoundsPropertyValue("Width",o,!0),this.OpenAjax.updateBoundsPropertyValue("Height",i,!0)},t}(e.Controls.Container.ContainerManager);t.DataCardManager=o}(t.FluidGrid||(t.FluidGrid={}))}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){!function(o){var i=function(i){function n(){var e=i.call(this)||this;return e._containerManager=new o.DataCardManager,e.getAuthoringCanvasPlaceHolder=e.getAuthoringCanvasPlaceHolder.bind(e),e}return __extends(n,i),n.prototype.onLoad=function(){this._heightPropertyChangeCallback=this.OpenAjax.addPropertyChangeCallback(e.AuthoringTool.OpenAjaxPropertyNames.Height,(function(e,t){t._heightPropertyIsUpdating=!1}),!1)},n.prototype.onUnload=function(){this._heightPropertyChangeCallback.dispose()},n.prototype.initControlContext=function(e){var t=this;i.prototype.initControlContext.call(this,e),e._minHeight=e.modelProperties.Height.getValue(),e._maxHeight=null,e._autoHeightScheduled=!1,e._heightPropertyIsUpdating=!1,e.contentHeight=ko.observable(0),e._childComputedHeightObservables=ko.observableArray([]),e._computedHeightObservable=ko.pureComputed((function(){return t._computeHeight(e)})).extend({deferred:!0})},n.prototype.disposeControlContext=function(e){e.realized&&this.disposeView(e._containerDiv,e),e.contentHeight=null,e._computedHeightObservable.dispose(),e._computedHeightObservable=null,e._childComputedHeightObservables.peek().forEach((function(e){return e.dispose()})),e._childComputedHeightObservables(null),e._childComputedHeightObservables=null,i.prototype.disposeControlContext.call(this,e)},n.prototype.initView=function(e,o){var n=this;if(o.realized=!0,i.prototype.initView.call(this,e,o),o.isTemplate&&this.OpenAjax.controlManager.appModeObservable()!==t.AppMode.Publish){this._dataCardFieldNameSubscription=o.modelProperties[this.dataFieldPropertyName].modelObservable.subscribe((function(e){n._authoringCanvasLabel(n._getAuthoringCanvasLabel(e))}));var r=this._getAuthoringCanvasLabel(o.modelProperties[this.dataFieldPropertyName].getValue());this._authoringCanvasLabel=ko.observable(r),this._initializeNestedCanvas(o)}o._containerDiv=e,o._containerDiv.classList.add("appmagic-auto-height"),o._maxHeight=o.modelProperties.maximumHeight.getValue(),o.modelProperties.AutoHeight.getValue()&&(this._updateForAutoHeight(o),this._initComputedHeightSubscription(o))},n.prototype.disposeView=function(e,t){t.realized&&(this._disposeComputedHeightSubscription(t),t._containerDiv=null,t.isTemplate&&(this._dataCardFieldNameSubscription&&(this._dataCardFieldNameSubscription.dispose(),this._dataCardFieldNameSubscription=null),this._authoringCanvasLabel=null),i.prototype.disposeView.call(this,e,t),t.realized=!1)},n.prototype.onChildContextAdded=function(e,o){i.prototype.onChildContextAdded.call(this,e,o),o.isTemplate&&this._initChildComputedHeightObservable(e,o),this.OpenAjax.controlManager.appModeObservable()!==t.AppMode.Publish&&this.OpenAjax.controlManager.executeShellAction({id:"UpdateAuthoringCanvasPlaceholder"}),e._requestRender()},n.prototype.onChildContextRemoved=function(e,o){i.prototype.onChildContextRemoved.call(this,e,o),o.isTemplate&&this._disposeChildComputedHeightObservable(e,o),this.OpenAjax.controlManager.appModeObservable()!==t.AppMode.Publish&&this.OpenAjax.controlManager.executeShellAction({id:"UpdateAuthoringCanvasPlaceholder"}),e._requestRender()},n.prototype.handlesRealized=function(){return!0},n.prototype.skipChildConstraints=function(){return!0},n.prototype.onChangeVisible=function(e,t){this._updateForAutoHeight(t)},n.prototype.onBeforeChangeHeight=function(e,t){t._heightPropertyIsUpdating=!0},n.prototype.onChangeHeight=function(e,t){e.self||i.prototype.onChangeHeight.call(this,e,t)&&(null!==e.newValue&&(t._minHeight=e.newValue),this._scheduleUpdateForAutoHeight(t))},n.prototype.onChangeAutoHeight=function(e,t){e.newValue?(this._updateForAutoHeight(t),this._initComputedHeightSubscription(t)):(this._disposeComputedHeightSubscription(t),null!==t._minHeight&&t.modelProperties.Height.setValue(t._minHeight,!1,!1,!0))},n.prototype.findBoundsForNewChild=function(e){return void 0===e&&(e=0),null},n.prototype.getAuthoringCanvasPlaceHolder=function(){return e.Controls.doesControlHaveVisualChildren(this.OpenAjax)?null:this.OpenAjax.controlManager.renderAuthoringPlaceholder({controlId:this.OpenAjax.uniqueId,allowAddVisual:!0,fontSize:"16px"})},n.prototype.childControlsCanExpandForPrint=function(){return!0},Object.defineProperty(n.prototype,"dataFieldPropertyName",{get:function(){return"FieldName"},enumerable:!1,configurable:!0}),n.prototype._getAccessibilityContainer=function(e){var o=e.controlWidget.uniqueId;return new t.ControlAccessibilityContainer(o,t.AccessibilityHelper.getAccessibilityId(o,e),e.controlWidget.parentControlWidget.uniqueId,t.AccessibilityHelper.getParentAccessibilityId(e),e.modelProperties.X.getValue(),e.modelProperties.Y.getValue(),!0)},n.prototype._initComputedHeightSubscription=function(e){var t=this;e._computedHeightSubscription||(e._computedHeightSubscription=e._computedHeightObservable.subscribe((function(){return t._updateForAutoHeight(e)})))},n.prototype._disposeComputedHeightSubscription=function(e){e._computedHeightSubscription&&(e._computedHeightSubscription.dispose(),e._computedHeightSubscription=null)},n.prototype._initChildComputedHeightObservable=function(e,t){var o=this,i=null,n=!1,r=ko.pureComputed((function(){n||(o._promoteChildProperties(t),n=!0);var r=o._computeChildHeight(t);return e._heightPropertyIsUpdating&&null!==i?i:(i=r,r)})),a={controlContext:t,computedObservable:r,dispose:null};a.dispose=function(){a.computedObservable.dispose(),a.computedObservable=null,a.controlContext=null,a.dispose=null},e._childComputedHeightObservables.push(a)},n.prototype._disposeChildComputedHeightObservable=function(e,t){for(var o=e._childComputedHeightObservables(),i=o.length;i-- >0;){var n=o[i];n.controlContext===t&&(e._childComputedHeightObservables.splice(i,1),n.dispose())}},n.prototype._promoteChildProperties=function(e){var t=this,o=e.modelProperties;["Y","Height","Visible"].forEach((function(i){o[i]&&!o[i].modelObservable&&t.promoteChildProperty(e,i)}))},n.prototype._computeChildHeight=function(e){var t=e.modelProperties;if(!t.Visible.modelObservable())return 0;var o=t.Y.modelObservable(),i=t.Height.modelObservable();return Math.round(o+i)},n.prototype._computeHeight=function(e){for(var t=0,o=0,i=e._childComputedHeightObservables();o<i.length;o++){var n=i[o];t=Math.max(t,n.computedObservable())}return t},n.prototype._adjustHeight=function(e){if(e.realized)if(0!==e._children.length){var t=e._minHeight;null===t&&(t=e.modelProperties.Height.getValue());var o=e._computedHeightObservable.peek(),i=Core.Utility.clamp(o,t,e._maxHeight);e.contentHeight.peek()!==i?e.contentHeight(i):e.modelProperties.Height.getValue()<i&&e.modelProperties.Height.setValue(i,!1,!1,!0)}else 0!==e.contentHeight.peek()&&e.contentHeight(0)},n.prototype._shouldUpdateForAutoHeight=function(e){return!!(e.initialized&&e.realized&&e.modelProperties.AutoHeight.getValue()&&e.modelProperties.Visible.getValue())},n.prototype._updateForAutoHeight=function(e){this._shouldUpdateForAutoHeight(e)&&this._adjustHeight(e)},n.prototype._scheduleUpdateForAutoHeight=function(e){var t=this;!e._autoHeightScheduled&&this._shouldUpdateForAutoHeight(e)&&(Core.Tasks.schedule((function(){t._updateForAutoHeight(e),e._autoHeightScheduled=!1}),"DataCardAutoHeight-".concat(e.controlWidget.uniqueId,"-").concat(e.bindingContext.id)),e._autoHeightScheduled=!0)},n.prototype._initializeNestedCanvas=function(e){if(!this._authoringCanvas){e.properties.Height(e.properties.Height.peek()||0),e.properties.Width(e.properties.Width.peek()||0);var t=e.controlWidget;this._authoringCanvas=t.controlManager.initializeNestedCanvas(t.getId(),0,null,e.properties.Width,e.properties.Height,{childCanvasId:1,replicateControls:!0,originOffsetX:ko.observable(0),originOffsetY:ko.observable(0),templateWidth:e.properties.Width,templateHeight:e.properties.Height,onCanvasResize:this._containerManager.resizeAuthoringCanvas.bind(this),customLabel:this._authoringCanvasLabel})}},n.prototype._getAuthoringCanvasLabel=function(t){return t?e.ControlStrings.Card+" : "+t:e.ControlStrings.Card},n}(e.Controls.Container.ContainerControlBase);o.DataCardControl=i,e.Controls.RegisterReactConvertedControl("AppMagic.Controls.FluidGrid.DataCardControl",e.Controls.FluidGrid.DataCardControl,e.Controls.FluidGrid.DataCardContainer,(function(){return!0}))}(t.FluidGrid||(t.FluidGrid={}))}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){!function(e){e.DataCardStyles=aphrodite.StyleSheet.create({card:{height:"100%",width:"100%",position:"relative",outline:"none"}})}(e.FluidGrid||(e.FluidGrid={}))}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){!function(t){var o=e.Controls.ScrollContainer,i={height:"100%",width:"100%"},n=function(e){function t(t){var o=e.call(this,t)||this;return o._shouldUpdateScrollOffset=o._shouldUpdateScrollOffset.bind(o),o}return __extends(t,e),t.prototype.render=function(){var t=e.prototype.getChildControls.call(this),n=this.props,r=n.enableVirtualScrolling,a=n.scrollTopOffset,l=n.onScroll,s=n.tabIndex;return React.createElement("div",{className:"appmagic-fluidGrid",style:i},React.createElement(o,{enableVirtualScrolling:r,scrollTopOffset:a,shouldUpdateScrollOffset:this._shouldUpdateScrollOffset,onScroll:l,tabIndex:s},t))},t.prototype._shouldUpdateScrollOffset=function(e,t){return this.props.shouldUpdateScrollOffset(e)},t}(e.Controls.Container.ContainerViewBase);t.FluidGridView=n}(t.FluidGrid||(t.FluidGrid={}))}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(e){!function(t){var o=function(o){function i(e){var t=o.call(this,e)||this;return t._shouldUpdateInitialScrollOffset=!0,t._isAuthoringComputed=ko.pureComputed(i._isAuthoringMode),t._isAuthoringComputedSubscription=t._isAuthoringComputed.subscribe((function(e){return t._isAuthoringComputedValue=e})),t._isAuthoringComputedValue=t._isAuthoringComputed(),t._shouldUpdateScrollOffset=t._shouldUpdateScrollOffset.bind(t),t._handleScroll=t._handleScroll.bind(t),t}return __extends(i,o),i._isAuthoringMode=function(){var t=OpenAjax.widget.controlManager;return t.appModeObservable()===e.AppMode.Editable&&!t.authoringInteractionModeObservable()},i.prototype.componentDidMount=function(){o.prototype.componentDidMount.call(this),this._shouldUpdateInitialScrollOffset=!1},i.prototype.componentWillUnmount=function(){this._isAuthoringComputedSubscription&&(this._isAuthoringComputedSubscription.dispose(),this._isAuthoringComputedSubscription=null),this._isAuthoringComputed&&(this._isAuthoringComputed.dispose(),this._isAuthoringComputed=null),o.prototype.componentWillUnmount.call(this)},i.prototype.renderCore=function(){var o=this.props,i=o.getControl,n=o.controlInstance,r=o.controlContext,a=o.textDirection,l=this._isAuthoringComputed(),s=l,u=l?-1*r._scrollY:r._scrollTopOffset();return r._requestRenderObservable(),React.createElement(e.ContainerControlAccessibilityWrapper,{controlContext:r,isFocusable:!0},React.createElement(t.FluidGridView,{controlContext:r,getControl:i,controlInstance:n,bindingContext:r.bindingContext,textDirection:a,enableVirtualScrolling:s,scrollTopOffset:u,onScroll:this._handleScroll,shouldUpdateScrollOffset:this._shouldUpdateScrollOffset}))},i.prototype._shouldUpdateScrollOffset=function(e){return 0===e||this._shouldUpdateInitialScrollOffset||this._isAuthoringComputedValue},i.prototype._handleScroll=function(t){var o=this.props.controlContext,i=o.controlWidget;i.controlManager.appModeObservable.peek()!==e.AppMode.Publish&&i.updateScrollY(t),o._scrollTopOffset(t)},i}(e.ObservableComponent);t.FluidGridContainer=o}(e.FluidGrid||(e.FluidGrid={}))}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){!function(o){var i=function(o){function i(){var t=o.call(this)||this;return e.AuthoringTool.Runtime.isAuthoring&&(t._authoringPlaceHolderX=ko.observable(0),t._authoringPlaceHolderY=ko.observable(0),t._authoringPlaceHolderWidth=ko.observable(0),t._authoringPlaceHolderHeight=ko.observable(0)),t}return __extends(i,o),Object.defineProperty(i.prototype,"authoringPlaceHolderX",{get:function(){return this._authoringPlaceHolderX},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"authoringPlaceHolderY",{get:function(){return this._authoringPlaceHolderY},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"authoringPlaceHolderHeight",{get:function(){return this._authoringPlaceHolderHeight},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"authoringPlaceHolderWidth",{get:function(){return this._authoringPlaceHolderWidth},enumerable:!1,configurable:!0}),i.prototype.initLayoutVariables=function(e){var t=this;if(!e._layoutVariablesInitialized){var o=e._layoutInvalidated;o.extend({notify:"always"}).subscribe((function(o){o&&e.initialized&&(e._layoutSuspended?e._invalidateLayoutOnResume=!0:t._scheduleLayoutChildren(e))}));var i=e._containerPropertiesSubscriptions;i.push(e.modelProperties.Height.modelObservable.subscribe((function(){o(!0)}))),i.push(e.modelProperties.Width.modelObservable.subscribe((function(){o(!0)}))),i.push(e.modelProperties.BorderThickness.modelObservable.subscribe((function(){o(!0)}))),i.push(e.modelProperties.BorderStyle.modelObservable.subscribe((function(){o(!0)}))),e._layoutVariablesInitialized=!0,o.peek()&&this._scheduleLayoutChildren(e)}},i.prototype.suspendLayout=function(e){e._layoutSuspended=!0},i.prototype.resumeLayout=function(e){ko.tasks.schedule((function(){e.initialized&&(e._layoutSuspended=!1,e._invalidateLayoutOnResume?(e._invalidateLayoutOnResume=!1,e._invalidateLayoutOnResumeCount<i.MAX_CONSECUTIVE_LAYOUT_ON_RESUME_THRESHOLD?(e._invalidateLayoutOnResumeCount++,e._layoutInvalidated(!0)):(e._invalidateLayoutOnResumeCount=0,t.TelemetryHelper.trackActivityEvent(Core.Telemetry.ControlOperationNames.fluidGridManagerResumeLayout,e,{message:"Maximum consecutive layout threshold exceeded (".concat(i.MAX_CONSECUTIVE_LAYOUT_ON_RESUME_THRESHOLD,"). ")+"This usually indicates that one or more child rules have created an infinite layout cycle."},!0))):e._invalidateLayoutOnResumeCount=0)}))},i.prototype.getLastLayoutResults=function(e){return e._lastLayoutResults},i.prototype.layoutChildren=function(t){this._layoutChildrenCore(t,(function(t,o){return{transformedInput:t.slice(),results:e.Controls.Container.ContainerLayoutManager.layoutControls(t,o)}}))},i.prototype.findBoundsForNewChild=function(e,t){void 0===t&&(t=0);var o=-1;e._children.forEach((function(e){var t=e.controlContext.dataflowBounds.userYValue;o=Math.max(o,t)}));var i=e.properties.Width(),n=e.properties.NumberOfColumns(),r=-1,a=e._children.filter((function(e){return e.controlContext.dataflowBounds.userYValue===o})),l=a.length===n||0===a.length;a.forEach((function(e){return r=Math.max(r,e.controlContext.dataflowBounds.userXValue)}));var s=l?o+1:o,u=l?0:r+1;t>0&&(u+=t,s+=Math.floor(u/n),u%=n);var d=Math.floor(i/n);return 12===n?d*=3:6===n&&(d*=2),{x:u,y:s,width:d,height:this.authoringPlaceHolderHeight()}},i.prototype.getVisualSizeForNewChild=function(e){return{width:e.controlWidget.getPropertyValue("Width",e.bindingContext),height:null}},i.prototype._applyPlaceHolderLayout=function(e){var t=this._ensureValidLayoutValue(e.x),o=this._ensureValidLayoutValue(e.y),i=this._ensureValidLayoutValue(e.width),n=this._ensureValidLayoutValue(e.height);this._authoringPlaceHolderX(t),this._authoringPlaceHolderY(o),this._authoringPlaceHolderWidth(i),this._authoringPlaceHolderHeight(n)},i.prototype._ensureValidLayoutValue=function(e){return e&&isFinite(e)?e:0},i.prototype._scheduleLayoutChildren=function(e){var t=this;e._layoutInvalidated(!1),e.initialized&&!e._layoutPending&&(e._layoutPending=!0,Core.Tasks.schedule((function(){e.initialized&&(t.layoutChildren(e),e._layoutPending=!1)}),"FluidGridManager._scheduleLayoutChildren"))},i.prototype._layoutChildrenCore=function(t,o){if(t._layoutVariablesInitialized){var i=t.controlWidget.control,n=this._getControlsLayoutInfo(t),r=e.AuthoringTool.Runtime.isAuthoring,a=i.rendersAddCardPlaceholder&&t.isTemplate&&r;if(a){var l=0===n.length?0:-1/0;n.forEach((function(e){return l=Math.max(l,e.y||0)}));var s={name:"#@virtual-card-id@#",x:0,y:l+1,width:100,height:100,controlIndex:n.length+1,borderThickness:0,visible:!0,widthFit:!0};n.push(s)}var u=o(n,this._getContainerLayoutInfo({control:i,controlContext:t})).results;this.suspendLayout(t);for(var d=t._children,p=0,c=d.length;p<c;p++){var h=d[u[p].controlIndex];this._applyLayoutInfoToControl(t,h,u[p])}if(a){var g=u.pop();this._applyPlaceHolderLayout(g)}this.resumeLayout(t),t._lastLayoutResults=u,t._requestRender(),r&&i.OpenAjax.controlManager.executeShellAction({id:"UpdateAuthoringCanvasPlaceholder"})}},i.MAX_CONSECUTIVE_LAYOUT_ON_RESUME_THRESHOLD=10,i}(e.Controls.Container.ContainerManager);o.FluidGridManager=i}(t.FluidGrid||(t.FluidGrid={}))}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){!function(o){var i=function(i){function n(){var e=i.call(this)||this;return e._containerManager=new o.FluidGridManager,e.getAuthoringCanvasPlaceHolder=e.getAuthoringCanvasPlaceHolder.bind(e),e}return __extends(n,i),Object.defineProperty(n.prototype,"rendersAddCardPlaceholder",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_authoringControlContext",{get:function(){return this.OpenAjax.getAuthoringControlContext()},enumerable:!1,configurable:!0}),n.prototype.initControlContext=function(e){i.prototype.initControlContext.call(this,e),e._scrollTopOffset=ko.observable(0),e._scrollY=0,e._layoutVariablesInitialized=!1,e._layoutPending=!1,e._layoutSuspended=!1,e._invalidateLayoutOnResume=!1,e._invalidateLayoutOnResumeCount=0;var t=e.modelProperties.AcceptsFocus.getValue();e.modelProperties.TabIndex.setValue(t?0:-1)},n.prototype.disposeControlContext=function(e){e._layoutVariablesInitialized=!1,e.realized&&this.disposeView(null,e),i.prototype.disposeControlContext.call(this,e)},n.prototype.initView=function(t,o){o.realized=!0,this._containerManager.initLayoutVariables(o),e.AuthoringTool.Runtime.isAuthoring&&o.isTemplate&&this._initializeNestedCanvas(o),o._layoutInvalidated(!0)},n.prototype.disposeView=function(e,t){t.realized&&(t.realized=!1)},n.prototype.onChildAdded=function(e,t,o){Contracts.checkValue(e),this.isValidChildControl(t)&&(this._initChildPropSubscription(o,t,e),o.realized&&o._layoutInvalidated(!0))},n.prototype.onChildRemoved=function(e,t){Contracts.checkValue(e),t.initialized&&(this._disposeChildPropSubscription(t,e),t.realized&&t._layoutInvalidated(!0))},n.prototype.resetControl=function(e){e.initialized&&this._resetScrollOffset(e)},n.prototype.onChangeTabIndex=function(e,o){o._accessibilityContainer&&t.AccessibilityManager.updateItemTabIndex(o._accessibilityContainer,o.modelProperties.TabIndex.getValue())},n.prototype.onChangeAcceptsFocus=function(e,t){var o=t.modelProperties.AcceptsFocus.getValue();t.modelProperties.TabIndex.setValue(o?0:-1)},n.prototype.handlesRealized=function(){return!0},n.prototype.skipChildConstraints=function(){return!0},n.prototype.findBoundsForNewChild=function(e){return void 0===e&&(e=0),this._containerManager.findBoundsForNewChild(this._authoringControlContext,e)},n.prototype.getVisualSizeForNewChild=function(){return this._containerManager.getVisualSizeForNewChild(this._authoringControlContext)},n.prototype.getAuthoringCanvasPlaceHolder=function(){return o.FluidGridPlaceHolder.createPlaceHolder(this.OpenAjax.uniqueId,this._containerManager.authoringPlaceHolderX(),this._containerManager.authoringPlaceHolderY(),this._containerManager.authoringPlaceHolderWidth(),this._containerManager.authoringPlaceHolderHeight())},n.prototype.isValidChildControl=function(e){return i.prototype.isValidChildControl.call(this,e)&&e.controlWidget.canLayoutControl()},n.prototype._resetScrollOffset=function(e){var o=e.controlWidget;o.controlManager.appModeObservable()!==t.AppMode.Publish&&o.updateScrollY(0),e._scrollTopOffset(0)},n.prototype.childControlsCanExpandForPrint=function(){return!0},n.prototype.calculatePrintHeight=function(e){var t=0;return this.forEachPrintableChildControlContext(e,(function(e){var o=e.modelProperties.Y.getValue(),i=e.modelProperties.Height.getValue();t=Math.max(t,o+i)})),t},n.prototype._initChildPropSubscription=function(e,t,o){var i=this,n=["Visible","Width","X","Y","BorderThickness","BorderStyle","WidthFit"],r=!1,a={subscription:ko.pureComputed((function(){return t.initialized&&(r?i._evaluateChildProperties(t,n):(i._promoteAndEvaluateChildProperties(t,n),r=!0),ko.isObservable(t.contentHeight)&&t.contentHeight()),!0})).extend({notify:"always"}).subscribe((function(){e.realized&&e._layoutInvalidated(!0)})),control:o,dispose:null};a.dispose=function(){a.subscription.dispose(),a.subscription=null,a.control=null,a.dispose=null},e._childrenPropertiesSubscriptions.push(a)},n.prototype._disposeChildPropSubscription=function(e,t){for(var o=e._childrenPropertiesSubscriptions,i=o.length;i-- >0;){var n=o[i];n.control===t&&(o.splice(i,1),n.dispose())}},n.prototype._promoteAndEvaluateChildProperties=function(e,t){var o=this,i=e.modelProperties;t.forEach((function(t){i[t].modelObservable||o.promoteChildProperty(e,t),i[t].modelObservable()}))},n.prototype._evaluateChildProperties=function(e,t){var o=e.modelProperties;t.forEach((function(e){o[e].modelObservable()}))},n.prototype._initializeNestedCanvas=function(e){var t=this;if(!this._authoringCanvas){var o=e.properties.Width,i=e.properties.Height;o(o.peek()||0),i(i.peek()||0);var n=e.controlWidget;this._authoringCanvas=n.controlManager.initializeNestedCanvas(n.getId(),0,null,o,i,{childCanvasId:1,replicateControls:!0,originOffsetX:ko.observable(0),originOffsetY:ko.observable(0),templateWidth:o,templateHeight:i,onCanvasResize:this._containerManager.resizeAuthoringCanvas.bind(this),canvasScrollable:{y:!0,x:!1},onCanvasYScroll:function(o){var i=t.OpenAjax.getAuthoringControlContext();i._scrollY!==o&&(i._scrollY=o,e._requestRender())},disableSelectionBox:!0})}},n}(e.Controls.Container.ContainerControlBase);o.FluidGridControl=i,e.Controls.RegisterReactConvertedControl("AppMagic.Controls.FluidGrid.FluidGridControl",e.Controls.FluidGrid.FluidGridControl,e.Controls.FluidGrid.FluidGridContainer,(function(){return!0}))}(t.FluidGrid||(t.FluidGrid={}))}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={})),function(e){!function(t){!function(t){var o=aphrodite.css,i=function(t){function i(e){var o=t.call(this,e)||this;return o._handleAddCardClick=o._handleAddCardClick.bind(o),o}return __extends(i,t),i.createPlaceHolder=function(e,t,o,n,r){return React.createElement(i,{controlId:e,top:o,left:t,width:n,height:r})},i.prototype.render=function(){var t=i._getPlaceHolderStyles(),n=this.props,r=n.top,a=n.left,l=n.width,s=n.height;return React.createElement("div",{className:o(t.container),style:{top:r,left:a,width:l,height:s}},React.createElement("div",{className:"".concat(o(t.imgContainer)," fluidGridAddSectionContainer"),onMouseDown:this._handleAddCardClick},React.createElement("img",{draggable:!1,className:o(t.img),title:e.ControlStrings.AddNewCard,src:Core.Utility.getAbsoluteUri("images/ConnectionHubAddConnectionIcon.svg")}),React.createElement("div",{className:o(t.text)}," ",e.ControlStrings.AddNewCard," ")))},i._getPlaceHolderStyles=function(){return i._placeHolderStyles||(i._placeHolderStyles=aphrodite.StyleSheet.create({container:{display:"flex",alignItems:"center",position:"absolute",paddingLeft:"10px"},imgContainer:{cursor:"pointer",display:"flex",alignItems:"center",":hover":{opacity:"0.4"}},img:{width:"48px",height:"48px",marginRight:"10px"},text:{color:Core.UI.StyleConstants.ColorDarkGrey,fontFamily:Core.UI.StyleConstants.baseFontFamily,fontWeight:"lighter",fontSize:"24px"}})),i._placeHolderStyles},i.prototype._handleAddCardClick=function(e){var t=this.props.controlId;OpenAjax.widget.controlManager.executeShellAction({id:"AddControl",templateName:"dataCard",variantName:"blankCard",parentId:t}),e.stopPropagation()},i}(React.Component);t.FluidGridPlaceHolder=i}(t.FluidGrid||(t.FluidGrid={}))}(e.Controls||(e.Controls={}))}(AppMagic||(AppMagic={}));
//# sourceMappingURL=FluidGrid.js.map
"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var AppMagic;!function(e){!function(n){var t=function(){function t(){this._compass=Windows.Devices.Sensors.Compass.getDefault(),this._eventTracker=null,this._updateDataFn=null}return t.prototype.subscribe=function(n){null!==this._compass&&(this._updateDataFn=n,this._eventTracker=new e.Utility.EventTracker,this._eventTracker.add(this._compass,"readingchanged",this._onCompassReadingChanged,this))},t.prototype.unsubscribe=function(){null!==this._compass&&(this._eventTracker.dispose(),this._eventTracker=null)},t.prototype.getData=function(e){return n.CompassData.create(e)},t.prototype._onCompassReadingChanged=function(e){var n=e.reading;this._updateDataFn(this.getData(n.headingTrueNorth))},t}();n.WindowsCompassProfile=t}(e.DynamicDataSource||(e.DynamicDataSource={}))}(AppMagic||(AppMagic={})),function(e){!function(n){var t=function(){function t(){this._standardGravity=-9.81,this._accelerometer=Windows.Devices.Sensors.Accelerometer.getDefault(),this._eventTracker=null,this._updateDataFn=null}return t.prototype.subscribe=function(n){this._updateDataFn=n,this._eventTracker=new e.Utility.EventTracker,null!==this._accelerometer&&this._eventTracker.add(this._accelerometer,"readingchanged",this._onAccelerationReadingChanged,this)},t.prototype.unsubscribe=function(){this._eventTracker.dispose(),this._eventTracker=null},t.prototype.getData=function(e,t,o){return n.AccelerationData.create(e,t,o)},t.prototype._onAccelerationReadingChanged=function(e){var n=e.reading,t=this.getData(this._standardGravity*n.accelerationX,this._standardGravity*n.accelerationY,this._standardGravity*n.accelerationZ);this._updateDataFn(t)},t}();n.WindowsAccelerationProfile=t}(e.DynamicDataSource||(e.DynamicDataSource={}))}(AppMagic||(AppMagic={})),function(e){!function(n){var t=function(t){function o(){var o=t.call(this)||this;if(WinJS.Utilities.hasWinRT){var i=e.Strings&&e.Strings.LocationDataSourceName?e.Strings.LocationDataSourceName:"Location";o.dynamicDataSources[i]=n.WindowsLocationDataSource.isAvailable()?new n.WindowsLocationDataSource:new n.HTML5LocationDataSource;var a=e.Strings&&e.Strings.ConnectionDataSourceName?e.Strings.ConnectionDataSourceName:"Connection";o.dynamicDataSources[a]=Core.Environment.isWebAuthoring()?new n.ConnectionDataSource(new n.WebNetworkConnectionProfile,null):n.WindowsNetworkConnectionProfile.isAvailable()?new n.ConnectionDataSource(new n.WindowsNetworkConnectionProfile,null):new n.NullConnectionDataSource;var r=e.Strings&&e.Strings.AccelerationDataSourceName?e.Strings.AccelerationDataSourceName:"Acceleration";o.dynamicDataSources[r]=new n.AccelerationDataSource(new n.WindowsAccelerationProfile,null);var c=e.Strings&&e.Strings.CompassDataSourceName?e.Strings.CompassDataSourceName:"Compass";o.dynamicDataSources[c]=new n.CompassDataSource(new n.WindowsCompassProfile,null)}else{i=e.Strings&&e.Strings.LocationDataSourceName?e.Strings.LocationDataSourceName:"Location";o.dynamicDataSources[i]=new n.HTML5LocationDataSource;a=e.Strings&&e.Strings.ConnectionDataSourceName?e.Strings.ConnectionDataSourceName:"Connection";o.dynamicDataSources[a]=new n.ConnectionDataSource(new n.CordovaNetworkConnectionProfile,null);r=e.Strings&&e.Strings.AccelerationDataSourceName?e.Strings.AccelerationDataSourceName:"Acceleration";o.dynamicDataSources[r]=new n.AccelerationDataSource(new n.CordovaAccelerationProfile,null);c=e.Strings&&e.Strings.CompassDataSourceName?e.Strings.CompassDataSourceName:"Compass";o.dynamicDataSources[c]=new n.CompassDataSource(new n.CordovaCompassProfile,null)}return o}return __extends(o,t),o}(n.DynamicDataSourceFactory);n.WindowsDynamicDataSourceFactory=t}(e.DynamicDataSource||(e.DynamicDataSource={}))}(AppMagic||(AppMagic={})),function(e){!function(n){var t=function(){function t(){}return t.prototype.saveFile=function(t,o,i){var a=this,r=new Windows.Storage.Pickers.FileSavePicker;return r.suggestedStartLocation=Windows.Storage.Pickers.PickerLocationId.documentsLibrary,r.suggestedFileName=i,r.fileTypeChoices.insert(t,o),r.pickSaveFileAsync().then((function(e){return e?a._wrapWindowsStorageFile(e):new n.AsyncUserResponse(n.UserResponseStatus.UserCancelled)}),(function(t){return Core.Log.errorEx("WindowsFilePicker.saveFile",{error:t,message:e.Strings.ImpexFileSaveFailed}),new n.AsyncUserResponse(n.UserResponseStatus.Failure)}))},t.prototype.pickFile=function(t){var o=this,i=new Windows.Storage.Pickers.FileOpenPicker;i.viewMode=Windows.Storage.Pickers.PickerViewMode.list,i.fileTypeFilter.clear();for(var a=0;a<t.length;a++)i.fileTypeFilter.append(t[a]);return i.pickSingleFileAsync().then((function(e){return e?o._wrapWindowsStorageFile(e):new n.AsyncUserResponse(n.UserResponseStatus.UserCancelled)}),(function(t){return Core.Log.errorEx("WindowsFilePicker.pickFile",{error:t,message:e.Strings.ImpexFileGetFailed}),new n.AsyncUserResponse(n.UserResponseStatus.Failure)}))},t.prototype.isFilePickerV2Available=function(){return!1},t.prototype.pickFileV2Async=function(e){throw new Core.NotImplementedError("WindowsFilePicker.pickFileV2Async")},t.prototype.openFile=function(e){return e=e.split("/").join("\\"),Windows.Storage.StorageFile.getFileFromPathAsync(e).then((function(e){var n=new Windows.System.LauncherOptions;n.displayApplicationPicker=!0,Windows.System.Launcher.launchFileAsync(e,n)}))},t.prototype._wrapWindowsStorageFile=function(e){Windows.Storage.AccessCache.StorageApplicationPermissions.futureAccessList.add(e);var t=new Core.IO.WrappedStorageFile(e);return new n.AsyncUserResponse(n.UserResponseStatus.Success,t)},t}();n.WindowsFilePicker=t}(e.Common||(e.Common={}))}(AppMagic||(AppMagic={})),function(e){!function(n){var t=function(){function t(){this._locationService=new Windows.Devices.Geolocation.Geolocator,this._isEnabled=!1,this._eventTracker=null}return t.isAvailable=function(){return void 0!==Windows.Devices.Geolocation&&void 0!==(new Windows.Devices.Geolocation.Geolocator).getGeopositionAsync},Object.defineProperty(t.prototype,"isEnabled",{get:function(){return this._isEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"locationService",{get:function(){return this._locationService},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(){this._isEnabled=!0,this._eventTracker=new e.Utility.EventTracker,null!==this._locationService&&this._eventTracker.add(this._locationService,"positionchanged",this._onPositionSignalChanged,this)},t.prototype.unSubscribe=function(){this._eventTracker.dispose(),this._eventTracker=null,this._isEnabled=!1},t.prototype.getData=function(t){var o=this;if(null===this._locationService)return null;var i=e.AuthoringTool.Runtime.getDocumentId();return this._locationService.getGeopositionAsync().then((function(n){i===e.AuthoringTool.Runtime.getDocumentId()&&o._onGetPosition(n)}),t),n.LocationData.create(0,0,0)},t.prototype._onPositionSignalChanged=function(e){this._onGetPosition(e.position)},t.prototype._onGetPosition=function(t){var o=t.coordinate,i=n.LocationData.create(o.latitude,o.longitude,o.altitude),a=e.Strings&&e.Strings.LocationDataSourceName?e.Strings.LocationDataSourceName:"Location";try{e.AuthoringTool.Runtime.updateDynamicDatasource(a,i)}catch(n){if(!(n instanceof e.Runtime.App.NamedObjectNotFoundError))throw n}},t}();n.WindowsLocationDataSource=t}(e.DynamicDataSource||(e.DynamicDataSource={}))}(AppMagic||(AppMagic={})),function(e){!function(n){var t=function(){function t(){this._eventTracker=null,this._updateDataFn=null,this._sync=n.OfflineSyncState.Connected,this._syncLastMessage="",this._lastSyncDate=0}return t.isAvailable=function(){return void 0!==Windows.Networking.Connectivity.NetworkInformation&&void 0!==Windows.Networking.Connectivity.NetworkConnectivityLevel&&void 0!==Windows.Networking.Connectivity.NetworkCostType},t.prototype.subscribe=function(n){this._updateDataFn=n,this._eventTracker=new e.Utility.EventTracker,null!==Windows.Networking.Connectivity.NetworkInformation&&this._eventTracker.add(Windows.Networking.Connectivity.NetworkInformation,"networkstatuschanged",this._onConnectionSignalChanged,this)},t.prototype.unsubscribe=function(){this._eventTracker.dispose(),this._eventTracker=null},t.prototype.getConnectionType=function(){var e=Windows.Networking.Connectivity.NetworkConnectivityLevel.none,n=Windows.Networking.Connectivity.NetworkCostType.unknown,t=Windows.Networking.Connectivity.NetworkInformation.getInternetConnectionProfile();return null!==t&&(e=t.getNetworkConnectivityLevel(),n=t.getConnectionCost().networkCostType),this._createConnectionData(e,n)},t.prototype._createConnectionData=function(e,t){var o=e===Windows.Networking.Connectivity.NetworkConnectivityLevel.internetAccess,i=t===Windows.Networking.Connectivity.NetworkCostType.fixed||t===Windows.Networking.Connectivity.NetworkCostType.variable;return this._sync=n.OfflineSyncState.Connected,this._syncLastMessage="",this._lastSyncDate=0,n.ConnectionData.create(o,i,this._sync,this._syncLastMessage,this._lastSyncDate)},t.prototype._onConnectionSignalChanged=function(){var e=this.getConnectionType();this._updateDataFn(e)},t}();n.WindowsNetworkConnectionProfile=t}(e.DynamicDataSource||(e.DynamicDataSource={}))}(AppMagic||(AppMagic={}));
//# sourceMappingURL=AppMagic.Common.Windows.js.map
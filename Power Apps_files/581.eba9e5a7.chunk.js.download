/*! For license information please see 581.eba9e5a7.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[581],{25077:function(e,t,a){"use strict";a.d(t,"b",(function(){return b})),a.d(t,"a",(function(){return v})),a.d(t,"c",(function(){return f}));var n=a(10926),r=a(25078),o=a(25128),i=a(25079),l=a(20436),c=a(25143),s=a(11466),u=a(12219);function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){p(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var b={canAdvance:!1,input:void 0,loading:!1,wizardComplete:!1,tableNameConflict:!1,tableInfo:o.b.tableInfo,initializeControls:!1,initializeColumns:!1},g=Object(n.createContext)({state:m(m({},b),{},{steps:[]}),dispatch:()=>null,contentServiceClient:{processImage:()=>Promise.resolve(),processControls:()=>Promise.resolve(),createAppFromImage:()=>Promise.resolve()},cdsServiceClient:{checkEnvironmentStatusAndPermissions:()=>Promise.resolve(),checkTableNameExists:()=>Promise.resolve(!1),createTableWithAttributes:()=>Promise.resolve(),envSolutionInfo:{publisherPrefix:"",uniqueName:""},isLoadingPropertyOption:"",publisherOptions:[],solutionOptions:[],tableOptions:[],columnOptions:[],getPublisherOptionsAsync:()=>Promise.resolve(),getSolutionOptionsAsync:()=>Promise.resolve(),getTableOptionsAsync:()=>Promise.resolve(),getColumnOptionsAsync:()=>Promise.resolve()}}),v=Object(s.f)("CreateFrom")(e=>{var{children:t,imageWizardState:a,t:s}=e,{currentEnvironment:d}=Object(u.W)(),[p,b]=Object(n.useReducer)(r.a,a),v=Object(l.b)(b,d),f=Object(c.b)(b,d),{currentExtractValue:h}=p,y=Object(i.e)(s),O=n.useMemo(()=>m(m({},o.b),{},{controls:Object(i.d)(null==h?void 0:h.identifiedControls,y),tableInfo:m(m({},o.b.tableInfo),{},{columns:Object(i.d)(null==h?void 0:h.identifiedGroups,y)})}),[null==h?void 0:h.identifiedControls,null==h?void 0:h.identifiedGroups,y]);return n.createElement(g.Provider,{value:{state:p,dispatch:b,contentServiceClient:v,cdsServiceClient:f}},n.createElement(o.a,{taggingState:O},t))}),f=()=>Object(n.useContext)(g)},25078:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(20435),r=a(25079),o=a(17716),i=a(25081),l=a(20437),c=a(25125),s=["groupControlIds"];function u(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){p(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var b=(e,t)=>{var a,d,p,b,g,v,f,h,y,O,E,{type:C}=t;switch(C){case l.a.SET_SERVICE_RESPONSE_ERROR:var S=t,x=void 0===S.errorMessage||e.errorMessage!==o.k.InvalidResponse?S.errorMessage:e.errorMessage;return m(m({},e),{},{errorMessage:x,loading:null!==(a=S.loading)&&void 0!==a?a:e.loading,canAdvance:x!==o.k.InvalidResponse});case l.a.SET_INVALID_ENVIRONMENT_ERROR:var I=t,T=I.errorMessage;return m(m({},e),{},{environmentErrorMessage:T,loading:null!==(d=I.loading)&&void 0!==d?d:e.loading});case l.a.SET_CAN_ADVANCE:return m(m({},e),{},{canAdvance:t.canAdvance});case l.a.SAVE_INPUT_VALUES:var j=t.input;return j.layoutFormat!==(null===(p=e.input)||void 0===p?void 0:p.layoutFormat)||j.sampleFile!==e.input.sampleFile||j.name!==e.input.name||j.metadata!==e.input.metadata||(null===(b=j.uploadFile)||void 0===b?void 0:b.name)!==(null===(g=e.input.uploadFile)||void 0===g?void 0:g.name)||(null===(v=j.uploadFile)||void 0===v?void 0:v.type)!==(null===(f=e.input.uploadFile)||void 0===f?void 0:f.type)||(null===(h=j.uploadFile)||void 0===h?void 0:h.size)!==(null===(y=e.input.uploadFile)||void 0===y?void 0:y.size)?m(m({},e),{},{input:j,initializeControls:!0,initializeColumns:!0,currentExtractValue:void 0}):e;case l.a.PROCESS_IMAGE_TO_CONTROLS:return m(m({},e),{},{processImageToControlsRequest:t.request,loading:!0});case l.a.PROCESS_IMAGE_TO_CONTROLS_COMPLETE:return m(m({},e),{},{currentExtractValue:t.response,loading:!1,initializeControls:!1});case l.a.PROCESS_USER_DEFINED_CONTROLS:if(!e.currentExtractValue)return e;var w=t.controls,N=Object(r.b)(w),P=e.initializeColumns||!(!e.currentExtractValue.identifiedControls||Object(r.a)(e.currentExtractValue.identifiedControls,N)),k=m(m({},e.currentExtractValue),{},{identifiedControls:N});return P&&(k.identifiedGroups=void 0),m(m({},e),{},{currentExtractValue:k,initializeColumns:P});case l.a.PROCESS_CONTROLS_TO_COLUMNS:return m(m({},e),{},{currentExtractValue:t.request,loading:!0});case l.a.PROCESS_CONTROLS_TO_COLUMNS_COMPLETE:return m(m({},e),{},{currentExtractValue:t.response,loading:!1,initializeColumns:!1});case l.a.PROCESS_USER_DEFINED_COLUMNS:if(!e.currentExtractValue)return e;var L,D=t.tableInfo,R=t.publisherPrefix,A=D.columns,z=m(m({},e.currentExtractValue),{},{identifiedGroups:Object(r.b)(A)});if(e.dataSelection===o.i.NewTable)L=D.tableId===o.g?{name:Object(c.e)(D.name,o.m.Dataverse.TableDisplayName),logicalName:Object(c.j)(D.logicalName,o.m.Dataverse.TableLogicalName,R),pluralName:Object(c.e)(D.pluralName,o.m.Dataverse.TableDisplayName)}:{name:D.name,logicalName:D.logicalName,pluralName:D.pluralName},z.tableSchema=m(m({},L),{},{columns:D.columnSchema.map(e=>{var{groupControlIds:t}=e;return m(m({},u(e,s)),{},{logicalName:e.columnId===o.c?Object(c.j)(e.logicalName,o.m.Dataverse.ColumnLogicalName,R):e.logicalName})}),dataSourceType:n.a.Dataverse});else z.tableSchema=void 0;return m(m({},e),{},{currentExtractValue:z,tableInfo:D});case l.a.REVIEW_UPDATE_TABLE_SETTINGS:var B,M=t,{tableSettings:F,publisherPrefix:_}=M;B=F.tableId===o.g?m(m({},e.tableInfo),{},{logicalName:Object(c.j)(F.logicalName,o.m.Dataverse.TableLogicalName),pluralName:Object(c.e)(F.pluralName,o.m.Dataverse.TableDisplayName),name:Object(c.e)(F.name,o.m.Dataverse.TableDisplayName),primaryColumnId:F.primaryColumnId,tableId:F.tableId}):m(m({},e.tableInfo),F);var W=null===(O=e.currentExtractValue)||void 0===O?void 0:O.tableSchema;W&&(W.name=B.name,W.logicalName=F.tableId===o.g?Object(c.j)(B.logicalName,o.m.Dataverse.TableLogicalName,_):B.logicalName,W.pluralName=B.pluralName);var G=e.currentExtractValue?m(m({},e.currentExtractValue),{},{tableSchema:W}):void 0;return m(m({},e),{},{tableInfo:B,currentExtractValue:G});case l.a.PROCESS_CREATE_APP:return m(m({},e),{},{loading:!0,wizardComplete:!0});case l.a.PROCESS_CREATE_APP_COMPLETE:return m(m({},e),{},{createAppResponse:t.response,loading:!1});case l.a.SET_STEP_STATUS:var V=t,U=e.steps[V.step],H=null!==(E=U.subSteps)&&void 0!==E?E:[],K=V.subStep>-1?V.subStep:H.length-1;return H.length>0&&K<=H.length&&(H[K].status=V.status),0!==H.length&&K!==H.length-1||(U.status=V.status),m({},e);case l.a.SKIP_DATA_STEPS:case l.a.RESET_SKIPPED_STEP_STATUS:var q=t,Y=q.t?Object.values(Object(i.b)(q.t)):[],Z=e.steps[q.currentStep];if(q.isNewWizard){var X=e.steps.slice(q.currentStep),$=Z.subSteps.slice(q.currentSubStep);return q.skip?(X.forEach(e=>e.status=q.skipStatus),$.forEach(e=>e.status=q.skipStatus)):(X.forEach(e=>e.status=q.resetStatus),$.forEach(e=>e.status=q.resetStatus)),m(m({},e),{},{dataSelection:C===l.a.RESET_SKIPPED_STEP_STATUS?void 0:q.dataSelection,initializeColumns:q.dataSelection!==o.i.Skip})}var J,Q=e.steps;if(q.skip)return Q=e.steps.slice(0,q.currentStep+1),Z.subSteps&&(J=Z.subSteps.slice(0,q.currentSubStep+1),Z.subSteps=J),m(m({},e),{},{steps:Q,dataSelection:q.dataSelection,initializeColumns:!1});if(e.steps.length!==Y.length){var ee,te;if(Q=Y.slice(q.currentStep+1),Z.subSteps)J=(null!==(ee=null===(te=Y[q.currentStep])||void 0===te?void 0:te.subSteps)&&void 0!==ee?ee:[]).slice(q.currentSubStep+1),Z.subSteps.push(...J);return m(m({},e),{},{steps:[...e.steps,...Q],dataSelection:q.dataSelection,initializeColumns:!0})}return m(m({},e),{},{dataSelection:q.dataSelection});case l.a.SET_TABLE_NAME_CONFLICT:var ae=t.hasConflict,ne=ae&&e.errorMessage!==o.k.InvalidResponse?o.k.TableNameConflict:e.errorMessage===o.k.TableNameConflict?void 0:e.errorMessage;return m(m({},e),{},{tableNameConflict:ae,errorMessage:ne,canAdvance:!ae&&e.errorMessage!==o.k.InvalidResponse});case l.a.SET_USER_PRIVILEGES:return m(m({},e),{},{userPrivileges:t.privileges});case l.a.PROCESS_CREATE_TABLE:return m(m({},e),{},{loading:!0,wizardComplete:!0});case l.a.PROCESS_CREATE_TABLE_COMPLETE:return m(m({},e),{},{loading:!1,errorMessage:t.tableCreateError});case l.a.PROCESS_CREATE_ATTRIBUTE:return m(m({},e),{},{loading:!0,wizardComplete:!0});case l.a.PROCESS_CREATE_ATTRIBUTE_COMPLETE:var re=t.attributeCreateError;return m(m({},e),{},{loading:!1,wizardComplete:!re,errorMessage:re});case l.a.SET_WIZARD_COMPLETE_STATUS:return m(m({},e),{},{wizardComplete:t.isComplete});default:return e}}},25079:function(e,t,a){"use strict";a.d(t,"d",(function(){return l})),a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"a",(function(){return m}));var n=a(11859),r=a(20435),o=a(25080),i=a(10926),l=(e,t)=>e?e.map(e=>((e,t)=>{var a,n=o.a.Create(e.relativeBBox.x,e.relativeBBox.y,e.relativeBBox.width,e.relativeBBox.height),r=t(e.tagName,e.text);return u(n,e.id,r,e.tagName,null!==(a=e.text)&&void 0!==a?a:e.tagName)})(e,t)).sort(c):[],c=(e,t)=>{var a=e.rectangle,n=t.rectangle;return a||n?a?n?Math.abs(a.top-n.top)<.005?a.left>=n.left?1:-1:a.top>=n.top?1:-1:-1:1:0},s=e=>e.map(e=>(e=>{var{rectangle:t}=e;return{id:e.displayId,relativeBBox:{x:t.left,y:t.top,width:t.width,height:t.height},tagName:e.tagName,text:e.value}})(e)),u=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r.e.None,o=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return{ariaLabel:a,displayId:t,rectangle:e,hasOverlap:!1,isActive:i,isResizing:!1,isBeingKeyboardResized:!1,isHovered:!1,page:1,tagName:n,value:o}},d=e=>i.useCallback((t,a)=>{var o;return o=t===r.e.ControlGroup?e("ImageWizard.Guidance.column"):e("Controls.".concat(t.toLowerCase())),a?Object(n.a)(e("ImageWizard.taggingBoxAriaLabel"),a,o):o},[e]),m=(e,t)=>e.length===t.length&&(!!e.every(e=>{var a=t.find(t=>t.id===e.id);return!!a&&b(e,a)})&&t.every(t=>{var a=e.find(e=>e.id===t.id);return!!a&&b(t,a)})),p=["probability","data","properties"],b=(e,t)=>{var a=Object.keys(e).filter(e=>!p.includes(e)),n=Object.keys(t).filter(e=>!p.includes(e));if(a.length!==n.length)return!1;for(var r of a){var o=e[r],i=t[r];if(null!=o&&"object"==typeof o&&null!=i&&"object"==typeof i){if(!b(o,i))return!1}else if(o!==i)return!1}return!0}},25080:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return o}));var n=Math.pow(10,-6),r=function(e){return e[e.None=0]="None",e[e.Top=1]="Top",e[e.Left=2]="Left",e[e.Right=4]="Right",e[e.Bottom=8]="Bottom",e[e.TopLeft=3]="TopLeft",e[e.BottomRight=12]="BottomRight",e[e.TopRight=5]="TopRight",e[e.BottomLeft=10]="BottomLeft",e}({});class o{get width(){return this.right-this.left}get height(){return this.bottom-this.top}constructor(e,t,a,n){this.left=void 0,this.right=void 0,this.top=void 0,this.bottom=void 0,this.left=e,this.right=t,this.top=a,this.bottom=n}static Create(e,t,a,n){return new o(e,e+a,t,t+n)}static CreateFromPoints(e,t){return new o(Math.min(e.x,t.x),Math.max(e.x,t.x),Math.min(e.y,t.y),Math.max(e.y,t.y))}translate(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new o(this.left+e,this.right+e,this.top+t,this.bottom+t)}resize(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2?arguments[2]:void 0;return new o((a&r.Left)>0?this.left+e:this.left,(a&r.Right)>0?this.right+e:this.right,(a&r.Top)>0?this.top+t:this.top,(a&r.Bottom)>0?this.bottom+t:this.bottom)}moveEdge(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2?arguments[2]:void 0,n=(a&r.Left)>0?e:this.left,i=(a&r.Right)>0?e:this.right,l=(a&r.Top)>0?t:this.top,c=(a&r.Bottom)>0?t:this.bottom;return i<n&&((a&r.Left)>0?n=i:(a&r.Right)>0&&(i=n)),c<l&&((a&r.Top)>0?l=c:(a&r.Bottom)>0&&(c=l)),new o(n,i,l,c)}scale(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new o(this.left*e,this.right*e,this.top*e,this.bottom*e)}contains(e){return this.left-n<=e.x&&this.right+n>=e.x&&this.top-n<=e.y&&this.bottom+n>=e.y}distanceToPoint(e){return Math.hypot(this.center.x-e.x,this.center.y-e.y)}get center(){return{x:this.left+this.width/2,y:this.top+this.height/2}}containsRectangle(e){return this.left-n<=e.left&&this.right+n>=e.right&&this.top-n<=e.top&&this.bottom+n>=e.bottom}calculateRealRectangleFromReferenceWithRelativeCoordinates(e){return new o(e.left+this.left*e.width,e.left+this.right*e.width,e.top+this.top*e.height,e.top+this.bottom*e.height)}intersect(e){var t=Math.min(this.right,e.right),a=Math.max(this.left,e.left);if(!(t<a)){var n=Math.min(this.bottom,e.bottom),r=Math.max(this.top,e.top);if(!(n<r))return new o(a,t,r,n)}}intersectingArea(e){var t;return(null===(t=this.intersect(e))||void 0===t?void 0:t.area())||0}area(){return this.height*this.width}lineBetweenClosestCorners(e){var t,[a,n]=[this,e].map(e=>[{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.left,y:e.bottom},{x:e.right,y:e.bottom}]),r=a[0],o=n[0];for(var i of a)for(var l of n){var c=Math.hypot(i.x-l.x,i.y-l.y);(void 0===t||c<t)&&(t=c,r=i,o=l)}return{start:r,end:o}}equals(e){return this.left===e.left&&this.right===e.right&&this.top===e.top&&this.bottom===e.bottom}almostEquals(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2*n;return Math.abs(this.left-e.left)<=t&&Math.abs(this.right-e.right)<=t&&Math.abs(this.top-e.top)<t&&Math.abs(this.bottom-e.bottom)<=t}}},25081:function(e,t,a){"use strict";a.d(t,"b",(function(){return m})),a.d(t,"a",(function(){return p}));var n=a(14958),r=a(11465),o=a(10926),i=a.n(o),l=a(25077),c=a(25082),s=a(25083),u=a(25145),d=a(14134),m=e=>({upload:{title:e("ImageWizard.Steps.Upload.title"),titleSlug:e("ImageWizard.Steps.Upload.shortTitle"),content:i.a.createElement(s.f,null),advanceButtonAriaLabel:e("Common.next"),backButtonAriaLabel:e("Common.backButtonTitle")},components:{title:e("ImageWizard.Steps.Components.title"),titleSlug:e("ImageWizard.Steps.Components.shortTitle"),content:i.a.createElement(s.b,null),advanceButtonAriaLabel:e("Common.next"),backButtonAriaLabel:e("Common.backButtonTitle")},data:{title:e("ImageWizard.Steps.Data.title"),subSteps:[{title:e("ImageWizard.Steps.Storage.title"),titleSlug:e("ImageWizard.Steps.Storage.shortTitle"),content:i.a.createElement(s.c,null),advanceButtonAriaLabel:e("Common.next"),backButtonAriaLabel:e("Common.backButtonTitle")},...d.a.enableSelectExistingTable?[{title:e("ImageWizard.Steps.TableSelection.title"),titleSlug:e("ImageWizard.Steps.TableSelection.shortTitle"),content:i.a.createElement(s.e,null),advanceButtonAriaLabel:e("Common.next"),backButtonAriaLabel:e("Common.backButtonTitle")}]:[],{title:e("ImageWizard.Steps.Columns.title"),titleSlug:e("ImageWizard.Steps.Columns.shortTitle"),content:i.a.createElement(s.a,null),advanceButtonAriaLabel:e("Common.next"),backButtonAriaLabel:e("Common.backButtonTitle")}]},review:{title:e("ImageWizard.Steps.Review.title"),titleSlug:e("ImageWizard.Steps.Review.shortTitle"),content:i.a.createElement(s.d,null),advanceButtonAriaLabel:e("Common.next"),backButtonAriaLabel:e("Common.backButtonTitle")}}),p=Object(r.s)("CreateFrom")(e=>{var{t:t}=e,{state:a,dispatch:r,contentServiceClient:o,cdsServiceClient:s}=Object(l.c)(),{wizardComplete:d,loading:m}=a,{onAdvance:p,beforeAdvance:b,onCreate:g,navigateToApp:v,onBack:f,onClose:h,shouldBackProceed:y,disableAdvance:O}=Object(u.a)(a,r,o,s,t);return i.a.useEffect(()=>{d&&v()},[v,d]),i.a.createElement(n.a,{showSteps:!0,strings:{advanceButtonString:t("Common.next"),closeButtonString:t("Common.closeButtonTitle"),closeButtonAriaLabel:t("Common.closeButtonTitle"),completeButtonString:t("Common.submitButtonTitle"),backButtonString:t("Common.backButtonTitle")},disableAdvance:O,isComplete:d,onAdvance:p,onShouldAdvanceProceed:b,onComplete:g,onBack:f,onVisibilityChange:h,steps:a.steps,styles:c.i,onShouldBackProceed:y,backButtonProps:{disabled:d&&m}})})},25082:function(e,t,a){"use strict";a.d(t,"h",(function(){return i})),a.d(t,"i",(function(){return l})),a.d(t,"l",(function(){return c})),a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"j",(function(){return m})),a.d(t,"d",(function(){return p})),a.d(t,"g",(function(){return b})),a.d(t,"c",(function(){return v})),a.d(t,"k",(function(){return f})),a.d(t,"o",(function(){return h})),a.d(t,"f",(function(){return y})),a.d(t,"m",(function(){return O})),a.d(t,"n",(function(){return E}));var n=a(10929);function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var i={root:{flexGrow:1,height:"100%"},circle:{width:"48px",height:"48px"},label:{fontSize:"16px"}},l={root:{width:"100%",margin:"0px",paddingLeft:"16px"},stepFooter:{position:"relative"},stepProgress:{minWidth:"250px",width:"250px"},stepContent:{height:"50vh",overflowY:"auto",width:"100%",padding:"32px"}},c=Object(n.db)({imagePreviewWrapper:{height:"auto",flex:"1 1 auto",width:"auto",fontSize:14,fontWeight:400},stepContentHeader:{padding:"32px 32px 16px 32px"},rightSectionContainer:{paddingLeft:"16px",paddingRight:"16px",width:"375px"},taggedItemCallout:{maxWidth:"350px",padding:"20px 24px"},documentWrapper:{height:"85%"},boldText:{fontWeight:700},contentTitle:{fontSize:20,lineHeight:28,marginBottom:12},rootPadding:{padding:"16px 0px 0px 8px",height:"100%"}}),s=Object(n.db)({tablePropsButton:{paddingBottom:"12px"}}),u={root:{borderTop:"1px solid rgb(237, 235, 233)",".ms-DetailsHeader":{padding:"0px"},".ms-DetailsRow-fields":{fontSize:"14px"}}},d=(e,t,a)=>({root:{backgroundColor:e?void 0:"white",boxShadow:"0 0 4px ".concat(a.palette.neutralTertiary),width:"515px",height:"125px",margin:"8px",borderRadius:"4px",":hover":{boxShadow:e?void 0:"0px 0px 8px ".concat(a.palette.neutralTertiary)}},field:{transitionDuration:"100ms",flexDirection:"row",justifyContent:"flex-start",textAlign:"left",borderRadius:"4px",borderWidth:t?"2px":"0px",padding:"0px",height:"125px","::before":{margin:"8px"},"::after":{margin:"8px"}},labelWrapper:{width:"100%",height:"100%",maxWidth:"515px",fontWeight:600,p:{fontWeight:400}},imageWrapper:{opacity:1,position:"relative",width:"100px",height:"100px",overflow:"hidden"}}),m=(e,t)=>Object(n.db)({labelContainer:{marginLeft:"16px",marginRight:"16px",color:e?t.palette.neutralSecondary:void 0}}),p={flexContainer:{flexDirection:"column",alignContent:"center"},root:{width:"100%"}};function b(e){var t,a;return null!==(t=null===(a=g["#".concat(e)])||void 0===a?void 0:a.borderColor)&&void 0!==t?t:"blue"}var g={"#TextLabel":{borderColor:"#ff9800"},"#TextInput":{borderColor:"#4caf50"},"#Button":{borderColor:"#9c27b0"},"#CheckBox":{borderColor:"#00bcd4"},"#ControlGroup":{borderColor:"#7986cb"},"#Radio":{borderColor:"#cddc39"},"#Rectangle":{borderColor:"#a1887f"},"#DatePicker":{borderColor:"#512da8"},"#DropDown":{borderColor:"#ff5252"},"#ListBox":{borderColor:"#00796b"},"#Rating":{borderColor:"#ea80fc"},"#Slider":{borderColor:"#880e4f"},"#Toggle":{borderColor:"#69f0ae"}},v=Object(n.db)({controlListContainer:function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({display:"flex",alignItems:"center",marginBottom:"8px"},g),controlColorDiv:{width:"16px",height:"16px",border:"2px solid"},controlLabel:{color:"#000000",fontSize:"14px"}}),f=e=>Object(n.db)({tableNameContainer:{display:"flex",alignItems:"center",marginBottom:"8px"},primaryColumnField:{fontSize:"12px",backgroundColor:e.palette.neutralQuaternaryAlt,height:"24px",padding:"4px 6px"}}),h={root:{fontSize:"20px",marginRight:"8px"}},y={root:{padding:"0px 4px"}},O={root:{width:"100%",borderTop:"1px solid rgb(237, 235, 233)",".ms-DetailsHeader":{padding:"0px"},".ms-DetailsRow-fields":{fontSize:"14px"}}},E=e=>Object(n.db)({section:{width:"100%",minWidth:"300px",overflowX:"hidden",padding:"0 0 32px"},tableSelectionTitleMessage:{color:e.palette.neutralSecondary,maxWidth:"600px"},addIcon:{fontSize:"16px",color:e.palette.themeSecondary,marginRight:"8px"}})},25083:function(e,t,a){"use strict";var n=a(25084);a.d(t,"f",(function(){return n.a}));var r=a(25136);a.d(t,"b",(function(){return r.a}));var o=a(25138);a.d(t,"c",(function(){return o.a}));var i=a(25140);a.d(t,"a",(function(){return i.a}));var l=a(25141);a.d(t,"d",(function(){return l.a}));var c=a(25142);a.d(t,"e",(function(){return c.a}))},25084:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(12139),r=a(10926),o=a(25085),i=a(25093),l=a(17716),c=a(25077),s=()=>{var{state:e}=Object(c.c)();return e.errorMessage===l.k.InvalidResponse?r.createElement(i.h,null):r.createElement(r.Fragment,null,r.createElement(i.g,null),r.createElement(n.a,{horizontal:!0,horizontalAlign:"space-between",tokens:{childrenGap:5}},r.createElement(o.a,null),r.createElement(n.a.Item,{disableShrink:!0},r.createElement(i.d,null))))}},25085:function(e,t,a){"use strict";a.d(t,"a",(function(){return C}));var n=a(11824),r=a(11823),o=a(12948),i=a(12661),l=a(11465),c=a(10926),s=a.n(c),u=a(25086),d=a(20435),m=a(17716),p=a(25082),b=a(25090),g=a(25091),v=a(12671),f=a(10929),h=a(12149);function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){E(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function E(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var C=Object(l.s)("CreateFrom")(e=>{var t,{t:a}=e,l=Object(f.Y)(),c=s.a.useRef(null),y=s.a.useRef(null),E=s.a.useRef(null),C=s.a.useRef(null),[S,x]=s.a.useState(!1),{imageOption:I,layoutFormat:T,appName:j,appNameValidationError:w,selectedFileDisplayName:N,sampleImage:P,pagingPosition:k,recommendedLayout:L,fileInputErrorCode:D,onChangeImageOption:R,onChangeFormatOption:A,getSampleImageOptions:z,updatePaging:B,onDropImage:M,onChangeAppName:F}=Object(g.b)(E.current,a,l);s.a.useEffect(()=>{C.current&&!S&&(C.current.focus(),x(!0))},[S]);var _=z(),W=s.a.useMemo(()=>Object(b.b)(k),[k]),G=s.a.useCallback(()=>s.a.createElement(n.a,{onClick:()=>{var e;return null===(e=y.current)||void 0===e?void 0:e.open()}},a("AppFromImage.FormFields.chooseFileLabel")),[a]),V=s.a.useCallback((e,t)=>{var a=Object.assign({},e);return delete a.value,s.a.createElement(u.a,{ref:y,onDrop:M,className:b.h.fileUploadZone,inputProps:O(O({},a),{},{id:"".concat(null==a?void 0:a.id,"-hidden"),style:{visibility:"hidden"}}),accept:"image/jpeg,image/png",multiple:!1,maxSize:g.a,disableClick:!0},s.a.createElement(s.a.Fragment,null,null==t?void 0:t(e)))},[M]),U=s.a.useCallback(()=>{},[]);return s.a.createElement("div",{ref:c},s.a.createElement(h.a,{className:p.l.contentTitle},a("ImageWizard.Steps.Upload.title")),s.a.createElement("p",null,a("AppFromImage.subtext")),s.a.createElement("div",{className:b.h.form},s.a.createElement("div",{className:b.h.formSection},s.a.createElement(i.a,{label:a("AppFromImage.FormFields.appNameLabel"),required:!0,className:b.h.formField,onChange:F,value:j,"data-automationid":m.j.appNameInput,errorMessage:w,componentRef:C}),s.a.createElement(o.a,{options:[{key:m.b.Upload,text:a("AppFromImage.ImageOptions.uploadText")},{key:m.b.Sample,text:a("AppFromImage.ImageOptions.sampleImageText")}],label:a("AppFromImage.FormFields.imageLabel"),onChange:R,selectedKey:I,className:b.h.formField,"data-automationid":m.j.imageSourceOptions}),I===m.b.Upload&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.a,{label:a("AppFromImage.ImageOptions.uploadText"),placeholder:a("AppFromImage.ImageOptions.uploadPlaceholderText"),description:D?void 0:a("AppFromImage.ImageOptions.uploadSubtext"),required:!0,className:b.h.formField,styles:b.a,value:N,onRenderInput:V,onRenderPrefix:G,onChange:U,borderless:!0,readOnly:!0,"aria-hidden":!0,tabIndex:-1,errorMessage:D?a("KnownUserMessages.".concat(D)):void 0})),I===m.b.Sample&&s.a.createElement("div",{ref:E,className:b.h.sampleImageContainer},s.a.createElement(v.a,{content:a("Common.PagingButtons.viewLeft"),hostClassName:b.h.pagingContainer,styles:b.c},s.a.createElement(r.a,{iconProps:{iconName:"ChevronLeft"},onClick:()=>B(m.n.Left),className:b.h.pagingButtons,ariaLabel:a("Common.previous")})),s.a.createElement(o.a,{options:_,onChange:R,selectedKey:P,styles:W,style:{width:null===(t=E.current)||void 0===t?void 0:t.clientWidth},"data-automationid":m.j.sampleImageOptions}),s.a.createElement(v.a,{content:a("Common.PagingButtons.viewRight"),hostClassName:b.h.pagingContainer,styles:b.d},s.a.createElement(r.a,{iconProps:{iconName:"ChevronRight"},onClick:()=>B(m.n.Right),className:b.h.pagingButtons,ariaLabel:a("Common.next")}))),s.a.createElement(o.a,{options:[{key:d.c.Tablet.toString(),text:L===d.c.Tablet?a("Common.LayoutOptions.tabletRecommendedLabel"):a("Common.LayoutOptions.tabletLabel")},{key:d.c.Phone.toString(),text:L===d.c.Phone?a("Common.LayoutOptions.phoneRecommendedLabel"):a("Common.LayoutOptions.phoneLabel")}],label:a("AppFromImage.FormFields.formatLabel"),onChange:A,selectedKey:T,className:b.h.formField,"data-automationid":m.j.formatOptions}))))})},25090:function(e,t,a){"use strict";a.d(t,"h",(function(){return r})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return i})),a.d(t,"b",(function(){return l})),a.d(t,"f",(function(){return c})),a.d(t,"e",(function(){return s})),a.d(t,"g",(function(){return u})),a.d(t,"a",(function(){return d}));var n=a(10929),r=Object(n.db)({form:{display:"flex",width:"100%",minWidth:"300px",overflowX:"hidden",padding:"32px 0"},formSection:{width:"100%",overflow:"hidden"},formField:{position:"relative",marginBottom:"5px",paddingBottom:"16px",width:"400px",".ms-TextField-description":{fontSize:"14px"}},formFooter:{justifyContent:"end",display:"flex"},sampleImageContainer:{position:"relative",width:"50vw",display:"flex",zIndex:1,overflow:"hidden"},pagingContainer:{position:"absolute",transform:"translateY(-50%)",top:"50%",zIndex:10,padding:0},pagingButtons:{width:"34px",height:"34px",minWidth:"34px",opacity:"0.8"},fileUploadZone:{border:"none",height:"auto",margin:"auto",width:"100%"}}),o={root:{left:1}},i={root:{right:1}},l=e=>({root:{transform:"translateX(".concat(e,"px)"),transitionDuration:"0.5s"},flexContainer:{marginBottom:"10px",paddingBottom:"10px",flexWrap:"nowrap",selectors:{img:{height:"200px",margin:"auto"}}}}),c=300,s=16,u=e=>({root:{marginRight:s},choiceFieldWrapper:{width:"".concat(c,"px")},innerField:{transition:"transform .2s",":hover":{display:"flex",justifyContent:"center"},":hover .ms-ChoiceField-imageWrapper":{transform:"scale(2)",boxShadow:"0 0 4px ".concat(e.palette.neutralTertiary),borderRadius:"2px",zIndex:1e3,position:"absolute",height:"100%"}}}),d={wrapper:{paddingBottom:8},fieldGroup:{border:"none"},prefix:{padding:0}}},25091:function(e,t,a){"use strict";a.d(t,"a",(function(){return g})),a.d(t,"b",(function(){return f}));var n=a(11021),r=a(10926),o=a.n(r),i=a(20435),l=a(17716),c=a(25092),s=a(25077),u=a(20437);function d(e,t,a,n,r,o,i){try{var l=e[o](i),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}function m(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function i(e){d(o,n,r,i,l,"next",e)}function l(e){d(o,n,r,i,l,"throw",e)}i(void 0)}))}}var p=function(){var e=m((function*(e,t){var a=yield fetch(e),n=yield a.blob();return new File([n],t,n)}));return function(t,a){return e.apply(this,arguments)}}(),b={height:0,width:0,mimeType:"",size:0},g=4e6,v=function(e){return e.FileTooLarge="FileTooLarge",e.UnknownFileUploadError="UnknownFileUploadError",e}({}),f=(e,t,a)=>{var r,u,d,m,{state:p,dispatch:f}=Object(s.c)(),{input:y}=p,[O,E]=o.a.useState(null!=y&&y.sampleFile?l.b.Sample:l.b.Upload),[C,S]=o.a.useState(null!==(r=null==y?void 0:y.sampleFile)&&void 0!==r?r:""),[x,I]=o.a.useState(null==y?void 0:y.uploadFile),[T,j]=o.a.useState(null!==(u=null==y?void 0:y.name)&&void 0!==u?u:""),[w,N]=o.a.useState(null!==(d=null==y?void 0:y.layoutFormat)&&void 0!==d?d:i.c.Tablet),[P,k]=o.a.useState(0),L=o.a.useRef(b),[D,R]=o.a.useState(null!==(m=null==y?void 0:y.recommendedLayout)&&void 0!==m?m:null==y?void 0:y.layoutFormat),[A,z]=o.a.useState(),[B,M]=o.a.useState(),F=o.a.useMemo(()=>{var e=null==x?void 0:x.name.match(/[^\\]+$/);return e&&e.length>0?e[0]:""},[x]);o.a.useEffect(()=>{(function(e,t,a,n){return h.apply(this,arguments)})({sampleFile:null!=C?C:"",layoutFormat:w,uploadFile:x,name:null!=T?T:"",metadata:L.current,recommendedLayout:D},O,f,B).catch(e=>{var t=Object(n.p)(e);Object(n.U)(l.s,{eventData:t,eventName:l.q.FormValidation})})},[T,B,f,O,w,D,C,x]);var _=Object(c.d)(t,a),W=o.a.useCallback((e,t)=>{if(null!=t&&t.key)if(O===l.b.Sample&&t.key.startsWith(l.p))S(t.key),N(t.key.toLowerCase().includes(i.c.Phone)?i.c.Phone:i.c.Tablet),R(t.key.toLowerCase().includes(i.c.Phone)?i.c.Phone:i.c.Tablet);else if(O===l.b.Upload&&t.key===l.b.Sample){var a,n=null===(a=_()[0])||void 0===a?void 0:a.key;E(t.key),N(n.toLowerCase().includes(i.c.Phone)?i.c.Phone:i.c.Tablet),R(n.toLowerCase().includes(i.c.Phone)?i.c.Phone:i.c.Tablet),S(null!=n?n:""),L.current=b,z(void 0)}else E(t.key),k(0),S(""),I(void 0),N(i.c.Tablet),R(void 0)},[_,O]),G=o.a.useCallback((e,t)=>{var[a]=t;if(a)return a.size>g?z(v.FileTooLarge):z(v.UnknownFileUploadError),void I(void 0);var[n]=e;I(n),z(void 0),L.current.size=n.size,L.current.mimeType=n.type;var r=new FileReader;r.addEventListener("load",()=>{var e=new Image;e.onload=()=>{L.current.width=e.width,L.current.height=e.height,e.width/e.height>=.9?(N(i.c.Tablet),R(i.c.Tablet)):(N(i.c.Phone),R(i.c.Phone)),URL.revokeObjectURL(e.src)},e.src=URL.createObjectURL(n)}),r.readAsDataURL(n)},[]),V=o.a.useCallback((e,a)=>{var n=(null!=a?a:"").trim().length;a&&0!==n?n>64?M(t("KnownUserMessages.AppNameValidation.MaxLength.text")):/^[()\-\w\s]+$/.test(a)?M(void 0):M(t("KnownUserMessages.AppNameValidation.AllowedCharacters.text")):M(t("KnownUserMessages.AppNameValidation.Empty.text")),j(null!=a?a:"")},[t]),U=o.a.useCallback((e,t)=>{if(null!=t&&t.key){var a=t.key===i.c.Phone.toString()?i.c.Phone:i.c.Tablet;N(a)}},[]),H=o.a.useMemo(()=>t=>{var a=Object(c.c)(t,P,e);k(a)},[P,e]);return{imageOption:O,layoutFormat:w,appName:T,appNameValidationError:B,selectedFileDisplayName:F,sampleImage:C,pagingPosition:P,recommendedLayout:D,fileInputErrorCode:A,onChangeImageOption:W,onChangeFormatOption:U,getSampleImageOptions:_,updatePaging:H,onDropImage:G,onChangeAppName:V}};function h(){return(h=m((function*(e,t,a,n){var r=!1;if(t===l.b.Sample&&e.sampleFile){e.uploadFile=void 0;var{imagePath:o,fileName:i}=Object(c.b)(e.sampleFile);if(o){var s=yield p(o,i);e.uploadFile=s}}if(0===Object.keys(e).length)r=!0;else for(var d in e)if(!e[d]&&!Object(c.a)(t,d)){r=!0;break}a({type:u.a.SET_CAN_ADVANCE,canAdvance:!r&&!n}),a({type:u.a.SAVE_INPUT_VALUES,input:e})}))).apply(this,arguments)}},25092:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return u})),a.d(t,"c",(function(){return p})),a.d(t,"d",(function(){return b}));var n=a(11859),r=a(10926),o=a.n(r),i=a(25090),l=a(17716),c=a(20408),s=(e,t)=>"recommendedLayout"===t||e===l.b.Upload&&"sampleFile"===t||e===l.b.Sample&&"uploadFile"===t,u=e=>{var t=e.split("sample-"),a=t[t.length>0?t.length-1:0],n=e.lastIndexOf("/");return{imagePath:a,fileName:e.substring(n+1)}},d=i.f+i.e,m=6*d+d/2,p=(e,t,a)=>{var n=-m;return a&&(n=-(m-a.clientWidth)),e===l.n.Left?Math.min(t+d,0):Math.max(t-d,n)},b=(e,t)=>{var a=Object(i.g)(t);return o.a.useMemo(()=>()=>Object(c.e)().map((t,r)=>({key:"".concat(l.p,"-").concat(t),imageSrc:t,imageAlt:Object(n.a)(e("Common.sampleImageAltText"),r,6),selectedImageSrc:t,imageSize:{height:200},text:"",styles:a})),[e,a])}},25093:function(e,t,a){"use strict";var n=a(25094);a.d(t,"d",(function(){return n.a}));var r=a(25095);a.d(t,"a",(function(){return r.a})),a.d(t,"k",(function(){return r.b}));var o=a(25097);a.d(t,"f",(function(){return o.a}));var i=a(25122);a.d(t,"g",(function(){return i.a})),a.d(t,"h",(function(){return i.b}));var l=a(25124);a.d(t,"i",(function(){return l.a}));var c=a(25131);a.d(t,"j",(function(){return c.a}));var s=a(25133);a.d(t,"c",(function(){return s.a}));var u=a(25134);a.d(t,"b",(function(){return u.a}));var d=a(25135);a.d(t,"e",(function(){return d.a}))},25094:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(11465),r=a(10926),o=Object(n.s)("CreateFrom")(e=>r.createElement(r.Fragment,null))},25095:function(e,t,a){"use strict";a.d(t,"b",(function(){return u})),a.d(t,"a",(function(){return d}));var n=a(12149),r=a(11666),o=a(10926),i=a(25096),l=a(20435),c=a(11859),s=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?"Simple":""},u=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return{[l.e.TextLabel]:o.createElement(m,{t:e,showLabel:a,showSimpleGuidanceText:t}),[l.e.TextInput]:o.createElement(p,{t:e,showLabel:a,showSimpleGuidanceText:t}),[l.e.CheckBox]:o.createElement(b,{t:e,showLabel:a,showSimpleGuidanceText:t}),[l.e.Radio]:o.createElement(g,{t:e,showLabel:a,showSimpleGuidanceText:t}),[l.e.Rating]:o.createElement(v,{t:e,showLabel:a,showSimpleGuidanceText:t}),[l.e.Slider]:o.createElement(f,{t:e,showLabel:a,showSimpleGuidanceText:t}),[l.e.Toggle]:o.createElement(h,{t:e,showLabel:a,showSimpleGuidanceText:t}),[l.e.Button]:o.createElement(y,{t:e,showLabel:a,showSimpleGuidanceText:t}),[l.e.Rectangle]:o.createElement(C,{t:e,showLabel:a,showSimpleGuidanceText:t}),[l.e.DropDown]:o.createElement(E,{t:e,showLabel:a,showSimpleGuidanceText:t}),[l.e.DatePicker]:o.createElement(O,{t:e,showLabel:a,showSimpleGuidanceText:t})}},d=e=>{var{t:t,showLabel:a,showSimpleGuidanceText:r}=e,l=s(r),u=t("ImageWizard.Guidance.column");return o.createElement("div",{className:i.a.listItem},!1!==a&&o.createElement(n.a,null,u),o.createElement("p",null,t("ImageWizard.Guidance.columnDescription".concat(l))),o.createElement("p",{className:i.a.exampleText},t("ImageWizard.Guidance.example")),o.createElement("div",{className:i.a.columnContainer,title:Object(c.a)(t("ImageWizard.Guidance.exampleImageAlt"),u)},o.createElement("div",{className:i.a.wordBlurPillDefault}),o.createElement("div",{className:i.a.textInput})))},m=e=>{var{t:t,showLabel:a,showSimpleGuidanceText:r}=e,l=s(r),u=t("Controls.textlabel");return o.createElement("div",{className:i.a.listItem},!1!==a&&o.createElement(n.a,null,u),o.createElement("p",null,t("ImageWizard.Guidance.textLabelDescription".concat(l))),o.createElement("p",{className:i.a.exampleText},t("ImageWizard.Guidance.example")),o.createElement("div",{className:i.a.textLabelContainer,title:Object(c.a)(t("ImageWizard.Guidance.exampleImageAlt"),u)},o.createElement("div",{className:i.a.wordBlurPillLabel})))},p=e=>{var{t:t,showLabel:a,showSimpleGuidanceText:r}=e,l=s(r),u=t("Controls.textinput");return o.createElement("div",{className:i.a.listItem},!1!==a&&o.createElement(n.a,null,u),o.createElement("p",null,t("ImageWizard.Guidance.textInputDescription".concat(l))),o.createElement("p",{className:i.a.exampleText},t("ImageWizard.Guidance.example")),o.createElement("div",{title:Object(c.a)(t("ImageWizard.Guidance.exampleImageAlt"),u),className:i.a.description},o.createElement("div",{className:i.a.wordBlurPillDefault}),o.createElement("div",{className:i.a.textInputContainer},o.createElement("div",{className:i.a.textInput}))))},b=e=>{var{t:t,showLabel:a,showSimpleGuidanceText:r}=e,l=s(r),u=t("Controls.checkbox"),d=o.useMemo(()=>o.createElement("div",{className:i.a.boxRow},o.createElement("div",{className:i.a.checkBox}),o.createElement("div",{className:i.a.wordBlurPillOption})),[]);return o.createElement("div",{className:i.a.listItem},!1!==a&&o.createElement(n.a,null,u),o.createElement("p",null,t("ImageWizard.Guidance.checkboxDescription".concat(l))),o.createElement("p",{className:i.a.exampleText},t("ImageWizard.Guidance.example")),o.createElement("div",{title:Object(c.a)(t("ImageWizard.Guidance.exampleImageAlt"),u),className:i.a.description},o.createElement("div",{className:i.a.checkBoxContainer},d),o.createElement("div",{className:i.a.checkBoxContainer},d)))},g=e=>{var{t:t,showLabel:a,showSimpleGuidanceText:r}=e,l=s(r),u=t("Controls.radio"),d=o.useMemo(()=>o.createElement("div",{className:i.a.boxRow},o.createElement("div",{className:i.a.radio}),o.createElement("div",{className:i.a.wordBlurPillOption})),[]);return o.createElement("div",{className:i.a.listItem},!1!==a&&o.createElement(n.a,null,u),o.createElement("p",null,t("ImageWizard.Guidance.radioDescription".concat(l))),o.createElement("p",{className:i.a.exampleText},t("ImageWizard.Guidance.example")),o.createElement("div",{title:Object(c.a)(t("ImageWizard.Guidance.exampleImageAlt"),u),className:i.a.description},o.createElement("div",{className:i.a.radioContainer},d,d)))},v=e=>{var{t:t,showLabel:a,showSimpleGuidanceText:l}=e,u=s(l),d=t("Controls.rating"),m=o.useMemo(()=>o.createElement("div",{className:i.a.ratingContainer},o.createElement(r.a,{iconName:"FavoriteStarFill",className:i.a.rating}),o.createElement(r.a,{iconName:"FavoriteStarFill",className:i.a.rating}),o.createElement(r.a,{iconName:"FavoriteStarFill",className:i.a.rating}),o.createElement(r.a,{iconName:"FavoriteStar",className:i.a.rating}),o.createElement(r.a,{iconName:"FavoriteStar",className:i.a.rating})),[]);return o.createElement("div",{className:i.a.listItem},!1!==a&&o.createElement(n.a,null,d),o.createElement("p",null,t("ImageWizard.Guidance.ratingDescription".concat(u))),o.createElement("p",{className:i.a.exampleText},t("ImageWizard.Guidance.example")),o.createElement("div",{title:Object(c.a)(t("ImageWizard.Guidance.exampleImageAlt"),d),className:i.a.description},m))},f=e=>{var{t:t,showLabel:a,showSimpleGuidanceText:r}=e,l=s(r),u=t("Controls.slider");return o.createElement("div",{className:i.a.listItem},!1!==a&&o.createElement(n.a,null,u),o.createElement("p",null,t("ImageWizard.Guidance.sliderDescription".concat(l))),o.createElement("p",{className:i.a.exampleText},t("ImageWizard.Guidance.example")),o.createElement("div",{title:Object(c.a)(t("ImageWizard.Guidance.exampleImageAlt"),u),className:i.a.description},o.createElement("div",{className:i.a.sliderContainer},o.createElement("span",{className:i.a.slider}),o.createElement("span",{className:i.a.sliderSwitch}))))},h=e=>{var{t:t,showLabel:a,showSimpleGuidanceText:r}=e,l=s(r),u=t("Controls.toggle");return o.createElement("div",{className:i.a.listItem},!1!==a&&o.createElement(n.a,null,u),o.createElement("p",null,t("ImageWizard.Guidance.toggleDescription".concat(l))),o.createElement("p",{className:i.a.exampleText},t("ImageWizard.Guidance.example")),o.createElement("div",{title:Object(c.a)(t("ImageWizard.Guidance.exampleImageAlt"),u),className:i.a.description},o.createElement("div",{className:i.a.toggleContainer},o.createElement("span",{className:i.a.toggle}),o.createElement("span",{className:i.a.toggleSwitch}))))},y=e=>{var{t:t,showLabel:a,showSimpleGuidanceText:r}=e,l=s(r),u=t("Controls.button");return o.createElement("div",{className:i.a.listItem},!1!==a&&o.createElement(n.a,null,u),o.createElement("p",null,t("ImageWizard.Guidance.buttonDescription".concat(l))),o.createElement("p",{className:i.a.exampleText},t("ImageWizard.Guidance.example")),o.createElement("div",{title:Object(c.a)(t("ImageWizard.Guidance.exampleImageAlt"),u),className:i.a.description},o.createElement("div",{className:i.a.buttonContainer},o.createElement("div",{className:i.a.button},o.createElement("div",{className:i.a.wordBlurPillOption})))))},O=e=>{var{t:t,showLabel:a,showSimpleGuidanceText:l}=e,u=s(l),d=t("Controls.datepicker");return o.createElement("div",{className:i.a.listItem},!1!==a&&o.createElement(n.a,null,d),o.createElement("p",null,t("ImageWizard.Guidance.datePickerDescription".concat(u))),o.createElement("p",{className:i.a.exampleText},t("ImageWizard.Guidance.example")),o.createElement("div",{title:Object(c.a)(t("ImageWizard.Guidance.exampleImageAlt"),d),className:i.a.description},o.createElement("div",{className:i.a.datePickerContainer},o.createElement("div",{className:i.a.textInput}),o.createElement(r.a,{iconName:"DateTime",className:i.a.inputIcon}))))},E=e=>{var{t:t,showLabel:a,showSimpleGuidanceText:l}=e,u=s(l),d=t("Controls.dropdown");return o.createElement("div",{className:i.a.listItem},!1!==a&&o.createElement(n.a,null,d),o.createElement("p",null,t("ImageWizard.Guidance.dropdownDescription".concat(u))),o.createElement("p",{className:i.a.exampleText},t("ImageWizard.Guidance.example")),o.createElement("div",{title:Object(c.a)(t("ImageWizard.Guidance.exampleImageAlt"),d),className:i.a.description},o.createElement("div",{className:i.a.dropdownContainer},o.createElement("div",{className:i.a.textInput}),o.createElement(r.a,{iconName:"ChevronDown",className:i.a.inputIcon}))))},C=e=>{var{t:t,showLabel:a,showSimpleGuidanceText:r}=e,l=s(r),u=t("Controls.rectangle");return o.createElement("div",{className:i.a.listItem},!1!==a&&o.createElement(n.a,null,u),o.createElement("p",null,t("ImageWizard.Guidance.rectangleDescription".concat(l))),o.createElement("p",{className:i.a.exampleText},t("ImageWizard.Guidance.example")),o.createElement("div",{title:Object(c.a)(t("ImageWizard.Guidance.exampleImageAlt"),u),className:i.a.description},o.createElement("div",{className:i.a.rectangleContainer},o.createElement("div",{className:i.a.textInput}))))}},25096:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(10929),r=a(20435),o=a(25082);function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var s=Object(n.Y)(),u={borderRadius:"100px",height:"18px",backgroundColor:s.palette.neutralTertiaryAlt},d={width:"94px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"5px"},m={border:"2px solid"},p=Object(n.db)({listItem:{padding:"16px 0px"},exampleText:{margin:"6px 0px",paddingTop:"8px"},description:{padding:"8px 0px"},wordBlurPillDefault:l(l({},u),{},{width:"115px",marginBottom:"4px"}),wordBlurPillLabel:l(l({},u),{},{width:"90%"}),wordBlurPillOption:l(l({},u),{},{width:"60px",margin:"auto"}),textInput:{border:"1px solid ".concat(s.palette.neutralPrimary),width:"99%",height:"95%"},inputIcon:{position:"absolute",margin:"auto",fontSize:"20px",right:"10px"},checkBox:{border:"1px solid ".concat(s.palette.neutralPrimary),width:"20px",height:"20px",borderRadius:"2px",marginRight:"4px"},boxRow:{display:"flex",padding:"4px"},radio:{border:"1px solid ".concat(s.palette.neutralPrimary),width:"20px",height:"20px",borderRadius:"50%",marginRight:"4px"},rating:{fontSize:"20px",margin:"auto"},toggle:{position:"absolute",width:"45px",height:"95%",margin:"auto",backgroundColor:s.palette.themePrimary,borderRadius:"34px"},toggleSwitch:{position:"relative",height:"20px",width:"20px",left:"10px",backgroundColor:s.palette.white,borderRadius:"50%"},slider:{position:"relative",width:"100px",height:"5px",margin:"auto",backgroundColor:s.palette.themePrimary,borderRadius:"34px"},sliderSwitch:{position:"relative",height:"15px",width:"15px",left:"-50%",backgroundColor:s.palette.white,border:"1px solid",borderRadius:"50%"},button:{width:"110px",height:"95%",display:"flex",alignItems:"center",backgroundColor:s.palette.themePrimary,borderRadius:"10px"},columnContainer:{border:"2px dashed ".concat(Object(o.g)(r.e.ControlGroup)),width:"260px",height:"72px",display:"flex",flexDirection:"column",justifyContent:"center",padding:"5px"},checkBoxContainer:l(l(l({},d),m),{},{borderColor:Object(o.g)(r.e.CheckBox),flexDirection:"column",height:"auto"}),radioContainer:l(l(l({},d),m),{},{borderColor:Object(o.g)(r.e.Radio),flexDirection:"column",height:"auto"}),ratingContainer:l(l(l({},d),m),{},{width:"120px",borderColor:Object(o.g)(r.e.Rating)}),toggleContainer:l(l(l({},d),{},{width:"50px",position:"relative"},m),{},{borderColor:Object(o.g)(r.e.Toggle)}),sliderContainer:l(l(l({},d),{},{width:"120px"},m),{},{borderColor:Object(o.g)(r.e.Slider)}),textLabelContainer:l(l({},m),{},{borderColor:Object(o.g)(r.e.TextLabel),width:"155px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center"}),textInputContainer:l(l({},m),{},{borderColor:Object(o.g)(r.e.TextInput),width:"260px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center"}),buttonContainer:l(l({},m),{},{borderColor:Object(o.g)(r.e.Button),width:"120px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center"}),datePickerContainer:l(l({},m),{},{borderColor:Object(o.g)(r.e.DatePicker),width:"260px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"}),dropdownContainer:l(l({},m),{},{borderColor:Object(o.g)(r.e.DropDown),width:"260px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"}),rectangleContainer:l(l({},m),{},{borderColor:Object(o.g)(r.e.Rectangle),width:"260px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center"})})},25097:function(e,t,a){"use strict";a.d(t,"a",(function(){return x}));var n=a(10926),r=a(25098),o=a(25111),i=a(25082),l=a(11650),c=a(11672),s=a(11668),u=a(25100),d=a(12139),m=a(12917),p=a(25120),b=a(11466),g=a(10929),v=a(25121),f=a(17716),h=a(11730),y=a(11724);function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){C(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function C(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var S=()=>{},x=e=>{var{file:t,groupedBoxes:a,onNewBoxDrawn:O,activeItem:C,setActiveItem:x,unsetActiveItem:I,tooltipTaggingProps:T,onFocusOrHover:j,onFocusLostOrHoverOut:w,onResize:N,innerBoxes:P,allowInnerItemsToShow:k=!1,onDeleteBox:L}=e,[D,R]=n.useState(),A=n.useRef(null),z=n.useRef(null),[B,M]=n.useState([]),{t:F}=Object(b.g)("CreateFrom"),_=Object(g.Y)(),W=n.useMemo(()=>Object(v.a)(_),[_]),{showAllInnerBoxes:G,mainCommandItems:V,farCommandItems:U,zoomStyle:H,onImageLoaded:K}=Object(p.b)(k,A.current,W.commandBarButtonStyles,F);n.useEffect(()=>{if(t&&!D){var e=URL.createObjectURL(t);R(e)}return()=>{D&&URL.revokeObjectURL(D)}},[t,D]);var q=n.useCallback(()=>{k&&M([])},[k]),Y=n.useCallback(e=>{null==N||N(e.rectangle,e)},[N]),Z=n.useCallback(e=>t=>{t&&Object(l.a)(z.current,null==t?void 0:t.target)||(e.isActive=!1,e.isResizing=!1,e.displayTooltip=void 0,null==I||I(e))},[I]);return n.createElement(d.a,{className:W.classNames.imageWrapper,verticalFill:!0},n.createElement(m.a,{styles:W.commandBarStyles,items:V,farItems:U,"data-automationid":f.j.documentCommands}),n.createElement("div",{className:W.classNames.containerRef},n.createElement("div",{ref:A,className:W.classNames.domRef,style:H},n.createElement(h.a,{isCircularNavigation:!0,direction:y.a.domOrder},n.createElement(r.a,{styles:{root:{display:"block"}},activeItem:C,canCreateNewBox:!0,isTaggingEnabled:!0,page:1,onNewBoxDrawn:O,onResizing:N,onResizingCompleted:Y,onResizingStart:S,taggingBoxReference:z,showInnerItemsInsideLocation:(e,t)=>{if(k&&P&&0!==P.length){var a=[];P.forEach(e=>{t.intersectingArea(e.rectangle)>0&&a.push(e.rectangle)}),M(a)}},hideInnerItems:q,onDeleteBox:L},n.createElement(c.a,{className:W.classNames.imageContainer,imageFit:s.b.cover,src:D,alt:t.name,id:"imagePreview",onLoad:K}),k&&G&&(null==P?void 0:P.map((e,t)=>n.createElement(u.a,{key:"innerBox-".concat(t),rectangle:e.rectangle}))),k&&!G&&B.map((e,t)=>n.createElement(u.a,{key:"insideActiveBox-".concat(t),rectangle:e})),a.map(e=>{var t=Object(i.g)(e.tagName);return n.createElement(o.a,{onFocusOrHover:j,onFocusLostOrHoverOut:w,key:e.displayId,colorInHex:t,documentViewportProvider:()=>{var e;return null===(e=A.current)||void 0===e?void 0:e.getBoundingClientRect()},isDisabled:!1,item:e,onSetActiveItem:e=>{null==x||x(e)},unsetAsActiveItem:e=>{I(e)},onResizing:N,onResizingCompleted:Y,onResizingStart:S,tooltipTaggingProps:E(E({},T),{},{trapFocus:!1,onDismiss:Z(e),onEscape:Z(e)})})}))))))}},25098:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(11625),r=a(25099),o=a(25110),i=Object(n.a)(r.a,o.a)},25099:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(11623),r=a(11504),o=a(10926),i=a(25080),l=a(25100),c=a(25103),s=a(25106),u=a(25108),d=a(25109),m=Object(n.a)(),p=e=>{var{children:t,page:a,activeItem:n,isTaggingEnabled:p,canCreateNewBox:b,onNewBoxDrawn:g,showInnerItemsInsideLocation:v,hideInnerItems:f,taggingBoxReference:h,colorInHex:y,drawAsDark:O,theme:E,onResizing:C,onResizingCompleted:S,onResizingStart:x,isFullWidthAndHeight:I,onDeleteBox:T}=e,j=o.useRef(null),[w,N]=o.useState(),[P,k]=o.useState(),[L,D]=o.useState(),[R,A]=o.useState(),z=o.useMemo(()=>m(e.styles,{theme:E,colorInHex:y,drawAsDark:O,isTaggingEnabled:p,canCreateNewBox:b,isFullWidthAndHeight:I}),[e.styles,E,y,O,p,b,I]);o.useEffect(()=>{var e=j.current;if(e){var t=t=>{var n=Object(u.a)(t,e);if(R){if(null!=L&&L.rectangle){var r=Object(d.a)(L.rectangle,n,R);t.stopPropagation(),t.preventDefault(),C(r,L),null==v||v(a,r)}}else if(P&&b){var o=i.a.CreateFromPoints(P,n);N(o),null==v||v(a,o)}},r=t=>{if(null==f||f(),R)n&&(n.isResizing=!1,S(n)),A(void 0),D(void 0);else if(P){var r=i.a.CreateFromPoints(P,Object(u.a)(t,e));r.width<=1&&r.height<=1&&r.area()>0&&g(a,r,!1,Object(s.e)(t)),k(void 0),N(void 0)}};return window.addEventListener("mousemove",t),window.addEventListener("mouseup",r),()=>{window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",r)}}},[n,b,f,P,g,C,S,a,L,R,v]);var B=o.useCallback(e=>{var t=j.current;if(t)if(R);else{var a=Object(u.a)(e,t);n||k(a)}},[n,R]),M=o.useCallback(e=>{n&&(n.isResizing=!0,x(a,n),A(e),D(n))},[n,x,a]);return o.createElement("div",{className:z.root},o.createElement("div",{id:"taggingZoneContainer",onMouseDown:B,onKeyUp:e=>{e.keyCode===r.a.n&&e.shiftKey?(e.stopPropagation(),e.preventDefault(),null==g||g(1,i.a.Create(.5,.5,.1,.1),!0,Object(s.e)(e))):e.keyCode===r.a.del&&(null==T||T())},className:z.taggingZone,ref:j},t,p&&o.createElement(o.Fragment,null,w&&o.createElement(l.a,{rectangle:w,theme:E,colorInHex:y}),(null==n?void 0:n.rectangle)&&o.createElement(c.a,{ref:h,rectangle:n.rectangle,onResizeStart:M,classNames:z}))))}},25100:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(10926),r=a(25101),o=a(11623),i=a(11625),l=a(25102),c=Object(o.a)(),s=Object(i.a)(e=>{var{rectangle:t,theme:a,colorInHex:o}=e,i=n.useMemo(()=>c(e.styles,{theme:a,colorInHex:o}),[e.styles,a,o]),l={height:Object(r.a)(t.height,3),width:Object(r.a)(t.width,3),top:Object(r.a)(t.top,3),left:Object(r.a)(t.left,3)};return n.createElement("div",{className:i.root,style:l},n.createElement("div",{className:i.box}))},l.a)},25101:function(e,t,a){"use strict";function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return r(e,t)+"%"}function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=Math.pow(10,t);return Math.floor(100*e*a)/a}function o(e,t){(t<0||t>1)&&(t=1);var a=function(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(e,t,a,n)=>t+t+a+a+n+n);var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:void 0}(e);if(a){var{r:n,g:r,b:o}=a;return"rgba(".concat(n,", ").concat(r,", ").concat(o,", ").concat(t,")")}}function i(e,t){return e?t:void 0}a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return i}))},25102:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(25101),r=a(10929),o={root:"BasicRectangle-root",box:"BasicRectangle-box"},i=e=>{var{theme:t=Object(r.Y)(),colorInHex:a="#118dff"}=e,i=Object(r.R)(o,t);return{root:[i.root,{position:"absolute",boxSizing:"content-box",zIndex:0}],box:[i.box,{position:"absolute",boxSizing:"content-box",width:"100%",height:"100%",borderRadius:1,backgroundColor:Object(n.c)(a,.2),border:"2px dashed ".concat(a),zIndex:0,cursor:"crosshair",":hover":{backgroundColor:Object(n.c)(a,.4),border:"2px solid ".concat(a)}}]}}},25103:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(10926),r=a(25080),o=a(25104),i=a(25105),l=n.forwardRef((e,t)=>{var{rectangle:a,onResizeStart:l,classNames:c,dataAutomationId:s={TopLeftId:"topLeftResizer",BottomLeftId:"bottomLeftResizer",BottomRightId:"bottomRightResizer",TopRightId:"topRightResizer"}}=e;return n.createElement("div",{ref:t},n.createElement(o.a,{top:a.top,left:a.left,width:a.width,height:a.height,className:c.border}),n.createElement(i.a,{"data-automation-id":s.TopLeftId,top:a.top,left:a.left,edge:r.b.TopLeft,onMouseDown:()=>l(r.b.TopLeft),cornerClassName:c.corners,resizerClassName:c.resizerCorner}),n.createElement(i.a,{"data-automation-id":s.TopRightId,top:a.top,left:a.right,edge:r.b.TopRight,onMouseDown:()=>l(r.b.TopRight),cornerClassName:c.corners,resizerClassName:c.resizerCorner}),n.createElement(i.a,{"data-automation-id":s.BottomRightId,top:a.bottom,left:a.right,edge:r.b.BottomRight,onMouseDown:()=>l(r.b.BottomRight),cornerClassName:c.corners,resizerClassName:c.resizerCorner}),n.createElement(i.a,{"data-automation-id":s.BottomLeftId,top:a.bottom,left:a.left,edge:r.b.BottomLeft,onMouseDown:()=>l(r.b.BottomLeft),cornerClassName:c.corners,resizerClassName:c.resizerCorner}))})},25104:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(10926),r=a(25101),o=e=>{var{top:t,left:a,width:o,height:i,className:l}=e,c=n.useMemo(()=>Object(r.a)(t,3),[t]),s=n.useMemo(()=>Object(r.a)(a,3),[a]),u=n.useMemo(()=>"calc(".concat(Object(r.a)(o,3),")"),[o]),d=n.useMemo(()=>"calc(".concat(Object(r.a)(i,3)," )"),[i]);return n.createElement("div",{className:l,style:{top:c,left:s,width:u,height:d}})}},25105:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(10929),r=a(10926),o=a(25101),i=a(25080),l=e=>{var{top:t,left:a,edge:i,onMouseDown:l,cornerClassName:s,resizerClassName:u}=e,d=r.useMemo(()=>Object(n.eb)(u,c(i)),[i,u]),m=r.useCallback(e=>{e.stopPropagation(),l()},[l]),p=r.useMemo(()=>Object(o.a)(t,1),[t]),b=r.useMemo(()=>Object(o.a)(a,1),[a]);return r.createElement("div",{className:s,style:{top:p,left:b}},r.createElement("div",{tabIndex:-1,onMouseDown:m,"data-automation-id":e["data-automation-id"],className:d}))},c=e=>{switch(e){case i.b.TopLeft:return"is-nw";case i.b.TopRight:return"is-ne";case i.b.BottomRight:return"is-se";case i.b.BottomLeft:return"is-sw";default:return""}}},25106:function(e,t,a){"use strict";a.d(t,"e",(function(){return i})),a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return u}));var n=a(11504),r=a(25080),o=a(25107);function i(e){return e.ctrlKey||e.metaKey?n.a.ctrl:e.shiftKey?n.a.shift:void 0}function l(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return c(n.a.up,e)||t&&c(n.a.pageUp,e)?n.a.up:c(n.a.down,e)||t&&c(n.a.pageDown,e)?n.a.down:c(n.a.left,e)?n.a.left:c(n.a.right,e)?n.a.right:void 0}function c(e,t){var a;switch(e){case n.a.enter:a={key:"Enter",charCode:13};break;case n.a.escape:a={key:"Escape",charCode:27};break;case n.a.space:a={key:" ",charCode:32};break;case n.a.up:a={key:"ArrowUp",charCode:38};break;case n.a.down:a={key:"ArrowDown",charCode:40};break;case n.a.right:a={key:"ArrowRight",charCode:39};break;case n.a.left:a={key:"ArrowLeft",charCode:37};break;case n.a.pageUp:a={key:"PageUp",charCode:33};break;case n.a.pageDown:a={key:"PageDown",charCode:34};break;case n.a.shift:a={key:"Shift",charCode:16};break;case n.a.ctrl:a={key:"Control",charCode:17};break;default:a={key:"unknown",charCode:-1}}return t.key===a.key||t.charCode===a.charCode||t.which===a.charCode}function s(e,t,a){var i,l;switch(t){case n.a.up:return i=Object(o.a)(e.bottom-a)>e.top?Object(o.a)(e.bottom-a):e.bottom,new r.a(e.left,e.right,e.top,i);case n.a.down:return i=Object(o.a)(e.bottom+a),new r.a(e.left,e.right,e.top,i);case n.a.left:return l=Object(o.a)(e.right-a)>e.left?Object(o.a)(e.right-a):e.right,new r.a(e.left,l,e.top,e.bottom);case n.a.right:return l=Object(o.a)(e.right+a),new r.a(e.left,l,e.top,e.bottom);default:return e}}function u(e,t,a){var i,l,c,s;switch(t){case n.a.up:return i=Object(o.a)(e.top-a),l=Object(o.a)(e.bottom-a),new r.a(e.left,e.right,i,l);case n.a.down:return i=Object(o.a)(e.top+a),l=Object(o.a)(e.bottom+a),new r.a(e.left,e.right,i,l);case n.a.left:return c=Object(o.a)(e.left-a),s=Object(o.a)(e.right-a),new r.a(c,s,e.top,e.bottom);case n.a.right:return c=Object(o.a)(e.left+a),s=Object(o.a)(e.right+a),new r.a(c,s,e.top,e.bottom);default:return e}}},25107:function(e,t,a){"use strict";function n(e){return function(e,t,a){return Math.min(Math.max(e,t),a)}(e,0,1)}a.d(t,"a",(function(){return n}))},25108:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(25107);function r(e,t){var a=t.getBoundingClientRect();return{x:Object(n.a)((e.clientX-a.left)/t.clientWidth),y:Object(n.a)((e.clientY-a.top)/t.clientHeight)}}},25109:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(25107);function r(e,t,a){var r=Object(n.a)(t.x),o=Object(n.a)(t.y);return e.moveEdge(r,o,a)}},25110:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(25101),r=a(10929),o={root:"TaggingZone",taggingZone:"TaggingZone-root",border:"TaggingZone-border",corners:"TaggingZone-corners",resizerCorner:"TaggingZone-corners-resizer"},i=e=>{var{theme:t=Object(r.Y)(),colorInHex:a="#118dff",drawAsDark:i=!1,isTaggingEnabled:l,canCreateNewBox:c,isFullWidthAndHeight:s=!0}=e,u=Object(r.R)(o,t);return{root:[u.root,{"&.is-fill":{width:"100%",height:"100%"},display:"flex",justifyContent:"center"},s?"is-fill":void 0],taggingZone:[u.taggingZone,{cursor:"default",position:"relative","&.is-enabled":{cursor:"crosshair"}},c&&l?"is-enabled":void 0],border:[u.border,{boxSizing:"border-box",position:"absolute",zIndex:1,border:"2px solid ".concat(a),pointerEvents:"none",borderColor:a,"&.is-dark-border":{zIndex:0,borderColor:t.palette.black}},i?"is-dark-border":void 0],corners:[u.corners,{position:"absolute"}],resizerCorner:[u.resizerCorner,{boxSizing:"border-box",position:"absolute",zIndex:2,width:8,height:8,border:"2px solid ".concat(a),borderRadius:"50%",backgroundColor:t.palette.white,boxShadow:t.effects.elevation4,outline:"none",":hover, :focus":{borderColor:Object(n.c)(a,.6)},"&.is-dark-border":{borderColor:t.palette.black},"&.is-dark-border:hover, &.is-dark-border:focus":{borderColor:Object(n.c)(t.palette.black,.6)},"&.is-nw":{top:-2,left:-2,cursor:"nw-resize"},"&.is-ne":{top:-2,left:-5,cursor:"ne-resize"},"&.is-se":{top:-4,left:-5,cursor:"se-resize"},"&.is-sw":{top:-4,left:-2,cursor:"sw-resize"}},i?"is-dark-border":void 0]}}},25111:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(10926),r=a(25112),o=a(25106),i=a(11504),l=e=>{var{item:t,isDisabled:a,documentViewportProvider:l,colorInHex:c="#118dff",unsetAsActiveItem:s,onSetActiveItem:u,onResizing:d,onResizingStart:m,onResizingCompleted:p,tooltipTaggingProps:b,toolTipLayerHostId:g,onFocusOrHover:v,onFocusLostOrHoverOut:f,onDeleteBox:h}=e,[y,O]=n.useState(!1),E=n.useCallback(()=>{a||(t.isHovered=!0,null==v||v(t))},[a,t,v]),C=n.useCallback(()=>{t.isResizing=!1,t.isBeingKeyboardResized=!1,t.isHovered=!1,null==f||f(t)},[t,f]),S=n.useCallback(()=>{a||(C(),u(t),O(!0))},[a,t,C,u]),x=n.useCallback(a=>{if(Object(o.b)(i.a.del,a))null==h||h();else if(t.isBeingKeyboardResized){var n=Object(o.a)(a,!0);if(n){var r,l,c,b,g=Object(o.b)(i.a.pageUp,a)||Object(o.b)(i.a.pageDown,a)?4:1,v=null!==(r=t.boxReference)&&void 0!==r&&r.current?5*t.rectangle.width/(null===(l=t.boxReference)||void 0===l||null===(c=l.current)||void 0===c?void 0:c.clientWidth):.01;b=a.shiftKey?Object(o.c)(t.rectangle,n,v*g):Object(o.d)(t.rectangle,n,v*g),d(b,t),setTimeout(()=>{var t,a;return null===(t=e.item.boxReference)||void 0===t||null===(a=t.current)||void 0===a?void 0:a.scrollIntoView({block:"center"})},50),a.stopPropagation(),a.preventDefault()}}Object(o.b)(i.a.enter,a)||Object(o.b)(i.a.space,a)?(!t.isBeingKeyboardResized||t.hasOverlap||a.ctrlKey?t.isBeingKeyboardResized||(t.isBeingKeyboardResized=!0,t.isResizing=!0,m(t),u(t)):(t.isResizing=!1,t.isBeingKeyboardResized=!1,p(t),s(t)),a.ctrlKey&&!y&&O(!0)):Object(o.b)(i.a.escape,a)&&(t.isResizing=!1,t.isBeingKeyboardResized=!1,p(t),s(t),E())},[y,t,h,E,d,p,m,u,e.item.boxReference,s]);n.useEffect(()=>{y&&!t.isActive?O(!1):!y&&t.isActive&&t.displayTooltip&&O(!0)},[y,t.displayTooltip,t.isActive]);var I=n.useCallback(()=>{t.isBeingKeyboardResized||y?t.isBeingKeyboardResized&&C():(t.isResizing=!1,s(t))},[y,t,C,s]),T=n.useCallback(e=>t.boxReference=e(),[t]);return t.rectangle?n.createElement(r.a,{ariaLabel:t.ariaLabel,key:t.displayId,box:t.rectangle,getBoxReference:T,isHovered:t.isHovered,isActive:t.isActive,isBeingKeyboardResized:t.isBeingKeyboardResized,onBoxClick:S,onBoxKeyDown:x,onFocusOrHover:E,onFocusLostOrHoverOut:C,onBlur:I,isTooltipVisible:y,shouldSetFocus:t.isBeingKeyboardResized,tooltipProps:b,documentViewportProvider:l,isDisabled:a,colorInHex:c,layerHostId:g}):n.createElement(n.Fragment,null)}},25112:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(10926),r=a(11625),o=a(25113),i=a(25114),l=a(25117);function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var s=Object(r.a)(e=>{var{box:t,ariaLabel:a,isTooltipVisible:r,onFocusOrHover:o,onFocus:s,onBoxKeyDown:u,onBoxClick:d,isActive:m}=e,p=d||s,b=p?{"aria-label":a,role:"button","aria-pressed":m}:{title:a,role:"presentation"},{classNames:g,tooltipPosition:v,boundingBoxPositioningStyle:f,boundingBoxRef:h,boxRef:y,onMouseUp:O,onMouseDown:E,onMouseOut:C,onTooltipDismiss:S,onTooltipKeyDown:x,onBlurCallback:I,theme:T}=Object(l.a)(e);return n.createElement(n.Fragment,null,r&&n.createElement(i.a,c({},e.tooltipProps,{onDismiss:S,onEscape:x,tooltipPosition:v,theme:T,box:t,isTooltipVisible:r,targetRef:h})),n.createElement("div",{className:g.root,style:f,ref:h,hidden:e.isHidden},n.createElement("div",c({},b,{"data-is-focusable":!!p,onFocus:s||o,onBlur:I,onMouseOver:o,onMouseOut:C,onMouseDown:E,onMouseUp:O,onKeyDown:u,tabIndex:d?0:void 0,ref:y,className:g.box}))))},o.a)},25113:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(25101),r=a(10929),o=e=>{var{theme:t=Object(r.Y)(),colorInHex:a="#118dff",isActive:o,isDisabled:i,isBeingKeyboardResized:l,isClicked:c,isFocused:s,lightOverlay:u,isHovered:d}=e;return{root:{position:"absolute",boxSizing:"border-box",zIndex:0},box:[{position:"absolute",boxSizing:"border-box",width:"100%",height:"100%",borderStyle:"solid",borderColor:a,borderWidth:"2px",borderRadius:1,zIndex:0,outline:"none",selectors:{[r.m]:{border:"4px solid Window !important",backgroundColor:"transparent !important",selectors:{"::after":{content:'""',position:"absolute",top:-3,right:-3,bottom:-3,left:-3,border:"2px solid Highlight"}}},"&.is-hovered":{backgroundColor:Object(n.c)(a,.2)},"&.is-hovered.is-light-overlay":{backgroundColor:Object(n.c)(t.palette.black,.05)},"&.is-clicked":{backgroundColor:Object(n.c)(a,.3)},"&.is-enabled":{cursor:"pointer"},"&.is-active.is-hovered":{backgroundColor:Object(n.c)(a,.2)},"&.is-active.is-clicked":{backgroundColor:Object(n.c)(a,.3)},"&.is-focused":{backgroundColor:Object(n.c)(t.palette.neutralLight,.3)},"&.is-keyboard-resized":{backgroundColor:Object(n.c)(a,.2)}}},Object(n.b)(!!d&&!l,"is-hovered"),Object(n.b)(!!o&&!l,"is-active"),Object(n.b)(c&&!i,"is-clicked"),Object(n.b)(!!l,"is-keyboard-resized"),Object(n.b)(!i,"is-enabled"),Object(n.b)(!!s,"is-focused"),Object(n.b)(!!u,"is-light-overlay")]}}},25114:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(10926),r=a(11656),o=a(11623),i=a(11625),l=a(11504),c=a(25115),s=a(25106),u=a(25116),d=a(11803),m=Object(o.a)(),p=e=>{e.stopPropagation()},b=Object(i.a)(e=>{var{trapFocus:t,firstFocusableSelector:a,isTooltipVisible:o,onDismiss:i,title:c,errorMessage:u,main:d,footer:b,styles:v,theme:f,box:h,targetRef:y,onEscape:O,tooltipPosition:E}=e,C=n.useMemo(()=>m(v,{theme:f,box:h,tooltipPosition:E}),[h,f,v,E]),S=n.useCallback(e=>{Object(s.b)(l.a.escape,e)&&(e.stopPropagation(),e.preventDefault(),null==O||O())},[O]),x=n.useMemo(()=>g(C,c,y,i,S,d,u,b),[C,c,y,i,S,d,u,b]);return n.createElement(n.Fragment,null,t?n.createElement(r.a,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1,disabled:!o,onMouseUp:p,onMouseDown:p,onMouseMove:p,firstFocusableSelector:a},x):x)},u.c),g=(e,t,a,r,o,i,l,s)=>n.createElement(c.a,{onOuterClick:r},n.createElement(d.a,{className:e.root,onKeyDown:o,target:a.current,setInitialFocus:!0},n.createElement("div",{className:e.header},t),(i||l)&&n.createElement("div",{className:e.main},l&&n.createElement("div",{className:e.errorMessage},l),i),s&&n.createElement("div",{className:e.footer},s)))},25115:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(11650),r=a(11637),o=a(10926);var i=e=>{var{children:t,onOuterClick:a}=e,i=o.useRef(null),l=o.useMemo(()=>o.createElement("div",{ref:i},t),[t]);return o.useLayoutEffect(()=>{if(a){var e=e=>function(e,t,a){!t.current||e.defaultPrevented||Object(n.a)(t.current,e.target)||a(e)}(e,i,a),t=new r.a(l);return t.on(document.body,"mousedown",e,!0),()=>{t.off(document.body,"mousedown",e,!0)}}},[a,i,l]),l}},25116:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return l}));var n=a(10929),r=a(25101),o=240,i=12,l=e=>{var{theme:t=Object(n.Y)()}=e;return{root:{cursor:"default",position:"absolute",zIndex:1e3,boxSizing:"border-box",width:o,padding:"0 ".concat(i,"px"),background:t.palette.white,borderRadius:2,color:t.palette.neutralPrimary,filter:"drop-shadow(0 1.2px 3.6px ".concat(Object(r.c)(t.palette.black,.1),") drop-shadow(0 6.4px 14.4px ").concat(Object(r.c)(t.palette.black,.13),") drop-shadow(0 0 1px ").concat(t.palette.neutralLight,")"),userSelect:"text",selectors:{"::before":{content:'""',position:"absolute",boxSizing:"border-box",width:12,height:24,background:"transparent",pointerEvents:"none"}}},header:{paddingTop:"16px",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":"4",fontWeight:n.l.regular,fontSize:n.k.small,overflow:"hidden"},errorMessage:{marginBottom:12,padding:"4px 8px 6px",borderRadius:2,background:t.semanticColors.errorBackground,color:t.semanticColors.errorText,fontSize:n.k.smallPlus},main:{margin:"0 -12px",borderTop:"1px solid ".concat(t.palette.neutralLight),overflowY:"auto"},footer:{margin:"0 -12px",padding:"8px 0",borderTop:"1px solid ".concat(t.palette.neutralLight)}}}},25117:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(10926),r=a(25116),o=a(25101),i=a(25118),l=a(11623),c=a(10929),s=Object(l.a)(),u=e=>{var t,a,[l,u]=n.useState(null!==(t=e.isClicked)&&void 0!==t&&t),[d,m]=n.useState(),p=n.useRef(null),b=n.useRef(null),{box:g,isHovered:v,isBeingKeyboardResized:f,isTooltipVisible:h,isFocused:y,isActive:O,onBoxClick:E,isDisabled:C,lightOverlay:S,shouldSetFocus:x,theme:I=Object(c.Y)(),styles:T,colorInHex:j,boxBorderPadding:w,documentViewportProvider:N,onFocusLostOrHoverOut:P,tooltipProps:k,onBlur:L}=e;null===(a=e.getBoxReference)||void 0===a||a.call(e,()=>p);var D=n.useMemo(()=>s(T,{theme:I,colorInHex:j,boxBorderPadding:w,isClicked:l,isHovered:v,isBeingKeyboardResized:f,isFocused:y,isActive:O,isDisabled:C,lightOverlay:S}),[T,I,j,w,l,v,f,y,O,C,S]);n.useEffect(()=>{if(h&&!d){var e,t,a=N(),n=null===(e=b.current)||void 0===e?void 0:e.getBoundingClientRect(),o=a&&n&&Object(i.a)(a,n,r.b+r.a);if(m(o),x)null===(t=p.current)||void 0===t||t.focus()}else if(x&&f&&document.activeElement!==p.current){var l;null===(l=p.current)||void 0===l||l.focus()}},[N,f,h,x,d]);var R={height:Object(o.a)(g.height,3),width:Object(o.a)(g.width,3),top:Object(o.a)(g.top,3),left:Object(o.a)(g.left,3)},A=n.useCallback(()=>{var e;null==P||P(),null==k||null===(e=k.onEscape)||void 0===e||e.call(k)},[P,k]),z=n.useCallback(()=>{u(!1),null==P||P()},[P]),B=n.useCallback(()=>{null==L||L(),null==P||P()},[L,P]),M=n.useCallback(e=>{k.onDismiss?null==k||k.onDismiss(e):B()},[k,B]),F=n.useCallback(()=>{u(!0)},[]),_=n.useCallback(()=>{u(!1),null==E||E()},[E]);return{classNames:D,boundingBoxPositioningStyle:R,tooltipPosition:d,theme:I,boundingBoxRef:b,boxRef:p,onMouseUp:_,onMouseDown:F,onMouseOut:z,onTooltipDismiss:M,onBlurCallback:B,onTooltipKeyDown:A}}},25118:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(25119);function r(e,t){return t.top>=e.top+e.height/2?n.a.Top:n.a.Bottom}function o(e,t,a){var o=t.left-e.left,i=e.right-t.right,l=t.top-e.top,c=e.bottom-t.bottom,s=Math.max(o,i,c,l);return s<a?{side:n.a.Inside}:i===s?{side:n.a.Right,alignment:r(e,t)}:o===s?{side:n.a.Left,alignment:r(e,t)}:c===s?{side:n.a.Bottom}:{side:n.a.Top}}},25119:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=function(e){return e.Left="Left",e.Right="Right",e.Top="Top",e.Bottom="Bottom",e.Inside="Inside",e}({})},25120:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return l}));var n=a(10926),r=a.n(n),o=a(25101),i=12,l=(e,t,a,n)=>{var[l,c]=r.a.useState(1),[s,u]=r.a.useState(),[d,m]=r.a.useState(!1),[p,b]=r.a.useState(!1),g=r.a.useMemo(()=>{if(!t||!s)return 1;var e=2*i,a=44+e;return(t.clientHeight-a)/(t.clientWidth-a)/((s.height-e)/(s.width-e))},[t,s]),v=r.a.useMemo(()=>Math.min(1,g),[g]),f=r.a.useCallback(e=>{var t=Math.min(1,1,g),a=Math.max(5,1,g),n=Math.max(t,Math.min(a,e));c(n)},[g]),h=r.a.useMemo(()=>({width:Object(o.a)(l,3)}),[l]),y=r.a.useCallback(()=>{var e,a=null==t||null===(e=t.getElementsByTagName("img"))||void 0===e?void 0:e.item(0);a&&u({width:a.naturalWidth,height:a.naturalHeight}),b(!0)},[t]);return r.a.useEffect(()=>{f(v)},[s,f,v]),{mainCommandItems:e?[{key:"ShowComponents",text:n("DocumentViewer.showComponentsCommandText"),iconProps:{iconName:"HintText"},buttonStyles:a,onClick:()=>m(!d)}]:[],farCommandItems:[{key:"ZoomIn",text:n("DocumentViewer.zoomInText"),ariaLabel:n("DocumentViewer.zoomInText"),iconOnly:!0,iconProps:{iconName:"ZoomIn"},buttonStyles:a,onClick:()=>f(l+.15)},{key:"ZoomOut",text:n("DocumentViewer.zoomOut"),ariaLabel:n("DocumentViewer.zoomOut"),iconOnly:!0,iconProps:{iconName:"ZoomOut"},buttonStyles:a,onClick:()=>f(l-.15)},{key:"FitWidth",text:n("DocumentViewer.fitToWidthText"),ariaLabel:n("DocumentViewer.fitToWidthText"),iconOnly:!0,iconProps:{iconName:"FitWidth"},buttonStyles:a,onClick:()=>f(1)},{key:"FitPage",text:n("DocumentViewer.fitToPageText"),ariaLabel:n("DocumentViewer.fitToPageText"),iconOnly:!0,iconProps:{iconName:"FitPage"},buttonStyles:a,onClick:()=>f(v)}],showAllInnerBoxes:d,zoomStyle:h,onImageLoaded:y,imageLoaded:p}}},25121:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(10929),r=a(25120),o=e=>({root:{backgroundColor:e.palette.neutralLighterAlt,border:"1px solid ".concat(e.palette.neutralLight),padding:"4px"}}),i=e=>({rootHovered:{backgroundColor:e.palette.neutralLighter},iconHovered:{backgroundColor:e.palette.neutralLighter},root:{backgroundColor:e.palette.neutralLighterAlt}}),l=e=>Object(n.db)({imageWrapper:{display:"flex",justifyContent:"center",border:"1px solid ".concat(e.palette.neutralLight),borderRadius:"4px",backgroundColor:e.palette.neutralLighterAlt},containerRef:{overflow:"auto",height:"100%"},domRef:{padding:r.a,height:"100%",margin:"auto"},imageContainer:{position:"relative",display:"flex",justifyContent:"center",userSelect:"none","> div":{display:"block"}}}),c=e=>({classNames:l(e),commandBarButtonStyles:i(e),commandBarStyles:o(e)})},25122:function(e,t,a){"use strict";a.d(t,"a",(function(){return E})),a.d(t,"b",(function(){return C}));var n=a(10926),r=a(10929),o=a(25077),i=a(11934),l=a(11932),c=a(11465),s=a(17716),u=a(12139),d=a(11672),m=a(11668),p=a(20408),b=a(13419),g=a(11859),v=a(11860),f=a(25123),h={content:{width:"auto"}},y=e=>Object(r.db)({image:{width:"100%",maxWidth:"900px"},message:{fontSize:"16px",color:e.palette.themePrimary},boldText:{fontWeight:700}}),O={[s.k.TableNameConflict]:i.a.error,[s.k.TableCreateError]:i.a.error,[s.k.InvalidResponse]:i.a.error},E=Object(c.s)("CreateFrom")(e=>{var t,{t:a,messageActions:c}=e,u=Object(r.Y)(),d=y(u),{state:m}=Object(o.c)(),{errorMessage:p}=m;if(!p||p===s.k.InvalidResponse)return n.createElement(n.Fragment,null);var E=p&&p in s.k?a("KnownUserMessages.".concat(p)):p,C=p&&c&&c[p]?n.createElement("div",null,n.createElement(b.a,{onClick:c[p].onClick},c[p].label)):void 0,S=null!==(t=O[null!=p?p:""])&&void 0!==t?t:i.a.info;return n.createElement(l.a,{styles:h,messageBarType:S,dismissButtonAriaLabel:a("Common.closeButtonTitle"),isMultiline:!1,actions:C},Object(g.c)(E,(e,t)=>0===t?n.createElement("span",{className:d.boldText},e):n.createElement(v.a,{href:s.l.FromImage,target:"_blank",onClick:()=>Object(f.c)(s.s,{linkLocation:"Error/".concat(p)})},e)))}),C=Object(c.s)("CreateFrom")(e=>{var{t:t}=e,{state:a}=Object(o.c)(),{errorMessage:i}=a,l=Object(r.Y)(),c=y(l),b=n.useMemo(()=>t("KnownUserMessages.".concat(i)),[i,t]);return i===s.k.InvalidResponse?n.createElement(u.a,{verticalAlign:"center",verticalFill:!0,horizontalAlign:"center",tokens:{childrenGap:32}},n.createElement(d.a,{src:p.d.getPaths().createAppFailure,imageFit:m.b.cover,className:c.image}),n.createElement("div",{className:c.message},b)):n.createElement(n.Fragment,null)})},25123:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"d",(function(){return s})),a.d(t,"e",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return m}));var n=a(11021),r=a(17716);function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l=[["upload"],["components"],["data:selection",...a(14134).a.enableSelectExistingTable?["data:tables"]:[],"data:columns"],["review"]],c="DataSelection",s=(e,t,a,c)=>{var s="unknown";if(t>-1&&t<l.length){var u=l[t].length;s=l[t][a<0||a>=u?0:a]}Object(n.fb)(r.s,e,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({step:s},c))},u=(e,t)=>{Object(n.O)(r.s,{eventName:e,eventData:t})},d=(e,t)=>{Object(n.gb)(e,r.q.LearnMoreClicked,{eventData:t})},m=e=>{Object(n.gb)(r.s,r.q.DuplicateFigmaUIKit,{eventData:e})}},25124:function(e,t,a){"use strict";a.d(t,"b",(function(){return A})),a.d(t,"a",(function(){return B}));var n=a(21619),r=a(11798),o=a(12680),i=a(12149),l=a(12685),c=a(12139),s=a(10929),u=a(12661),d=a(11465),m=a(10926),p=a.n(m),b=a(17716),g=a(25125),v=a(25077),f=a(20437),h=a(14134),y=a(25126),O=a(20435),E=a(25127),C=a(25128),S=a(25130),x=a(11666),I=a(11859);function T(e,t,a,n,r,o,i){try{var l=e[o](i),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}function j(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function i(e){T(o,n,r,i,l,"next",e)}function l(e){T(o,n,r,i,l,"throw",e)}i(void 0)}))}}function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function N(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var P=Object(s.Y)(),k={commands:{backgroundColor:P.palette.white},navigation:{paddingBottom:"20px"},header:{paddingLeft:"16px",paddingRight:"16px"},content:{paddingLeft:"16px",paddingRight:"16px"}},L={wrapper:{width:"100%"},divider:{height:"1px",background:P.palette.neutralQuaternaryAlt,width:"100%"}},D={root:{fontSize:"16px",fontWeight:600}},R={subComponentStyles:{label:{root:{color:P.palette.neutralPrimary}}}},A={dropdownItems:{"& > button:first-child":{borderBottom:"1px solid ".concat(P.palette.neutralLight)}}},z={container:{display:"flex",alignItems:"center"},icon:{marginRight:"4px"},label:{fontWeight:600}},B=Object(d.s)("CreateFrom")(e=>{var{state:t,cdsServiceClient:a,dispatch:s}=Object(v.c)(),{dispatch:T}=Object(C.c)(),{t:B,panelIsVisible:M,onDismissPanel:F,tableInfo:_}=e,[W,G]=p.a.useState(_.logicalName),[V,U]=p.a.useState(_.name),[H,K]=p.a.useState(_.pluralName),[q,Y]=p.a.useState(_.primaryColumnId),[Z,X]=p.a.useState(t.tableNameConflict?B("KnownUserMessages.TableNameConflict"):void 0),[$,J]=p.a.useState(),[Q,ee]=p.a.useState(),[te,ae]=p.a.useState(!1),[ne,re]=p.a.useState(),[oe,ie]=p.a.useState(),le=_.tableId===b.g,ce=Object(m.useMemo)(()=>le?Object(y.c)(B,_):Object(y.a)(a.columnOptions),[a.columnOptions,le,B,_]),se=_.columnSchema.find(e=>e.id===q),[ue,de]=p.a.useState(se&&q===g.a.id?null==se?void 0:se.logicalName:g.a.logicalName),[me,pe]=p.a.useState(se&&q===g.a.id?null==se?void 0:se.name:g.a.name),be=B("AppFromImage.FormFields.fieldRequiredMessage"),ge=p.a.useCallback(e=>{if((null==e?void 0:e.primaryColumnId)===g.a.id){var a=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){N(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},g.a);a.name=me,a.logicalName=ue,T({type:S.a.UPDATE,columnSchema:a})}!e&&t.tableNameConflict&&W!==_.logicalName&&s({type:f.a.SET_TABLE_NAME_CONFLICT,hasConflict:!1}),Object(y.d)(_,e),null==F||F(e)},[t.tableNameConflict,W,_,F,me,ue,T,s]),ve=p.a.useCallback(j((function*(){var e={logicalName:W,pluralName:H,name:V,primaryColumnId:q,tableId:_.tableId};ae(!0),s({type:f.a.SET_TABLE_NAME_CONFLICT,hasConflict:!1});var t=yield Object(y.h)(_.tableId,e.logicalName,a);ae(!1),e&&t?X(B("KnownUserMessages.TableNameConflict")):ge(e)})),[a,ge,s,V,W,H,q,B,_.tableId]),fe=p.a.useCallback((function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t){var a=Object(g.e)(e,b.m.Dataverse.TableDisplayName,!1);K(a)}else{var r=Object(d.h)(),o=null!=r&&r.startsWith("en")?Object(n.plural)(e.trim()):e;K(o)}}),[]),he=p.a.useCallback(e=>{var t=Object(g.j)(e,b.m.Dataverse.TableLogicalName);G(t),X(t.trim().length<1?be:void 0)},[be]),ye=p.a.useCallback(e=>{var t=Object(g.e)(e,b.m.Dataverse.TableDisplayName,!1);U(t),fe(t,!1),he(t)},[fe,he]),Oe=p.a.useCallback(e=>{var t=Object(g.j)(e,b.m.Dataverse.TableLogicalName);de(t)},[]),Ee=p.a.useCallback(e=>{var t=Object(g.e)(e,b.m.Dataverse.TableDisplayName,!1);pe(t),Oe(t)},[Oe]);p.a.useEffect(()=>{J(V.trim().length<1?be:void 0),ee(H.trim().length<1?be:void 0),q===g.a.id?(ie(me.trim().length<1?be:void 0),re(ue.trim().length<1?be:void 0)):(ie(void 0),re(void 0))},[B,V,H,me,ue,q,be]);var Ce=te||!!$||!!Q||!!Z||!le,Se=p.a.useCallback(()=>Object(y.b)(B,ve,ge,Ce,te),[ge,ve,Ce,te,B]),xe=p.a.useCallback((e,t)=>Object(y.g)(P,e,t),[]),Ie=p.a.useCallback((e,t)=>Object(y.f)(P,e,t),[]);return p.a.createElement(l.a,{isOpen:M,headerText:B("TableSchemaView.".concat(h.a.enableSelectExistingTable?"tablePropertiesPanelHeader":"tablePanelHeader")),styles:k,onRenderFooterContent:Se,onDismiss:()=>ge(),isFooterAtBottom:!0,closeButtonAriaLabel:B("Common.closeButtonTitle")},p.a.createElement(c.a,{tokens:{childrenGap:16}},p.a.createElement(p.a.Fragment,null,p.a.createElement(u.a,{label:B("TableSchemaView.displayName"),required:le,value:V,maxLength:b.m.Dataverse.TableDisplayName,onChange:(e,t)=>ye(null!=t?t:""),"data-automationid":b.j.tableDisplayName,errorMessage:$,disabled:!le,styles:R}),p.a.createElement(u.a,{label:B("TableSchemaView.pluralDisplayName"),required:le,value:H,maxLength:b.m.Dataverse.TablePluralName,onChange:(e,t)=>fe(null!=t?t:""),"data-automationid":b.j.tablePluralName,errorMessage:Q,disabled:!le,styles:R}),p.a.createElement(u.a,{label:B("TableSchemaView.logicalName"),required:le,prefix:le?a.envSolutionInfo.publisherPrefix:void 0,value:W,maxLength:b.m.Dataverse.TableLogicalName,onChange:(e,t)=>he(null!=t?t:""),errorMessage:Z,"data-automationid":b.j.tableLogicalName,disabled:!le,styles:R}),p.a.createElement(r.a,{styles:L}),p.a.createElement(i.a,{styles:D},B("TableSchemaView.primaryNameColumnHeader")),p.a.createElement(o.a,{label:B("TableSchemaView.primaryName"),required:le,options:ce,selectedKey:q,onChange:(e,t)=>Y(t?parseInt(t.key.toString(),10):g.a.id),"data-automationid":b.j.tablePrimaryColumnDropdown,onRenderOption:xe,onRenderTitle:Ie,disabled:!le,styles:A}),h.a.enableSelectExistingTable&&le&&q===g.a.id&&p.a.createElement(p.a.Fragment,null,p.a.createElement(u.a,{label:B("TableSchemaView.displayName"),required:!0,value:me,maxLength:b.m.Dataverse.ColumnDisplayName,onChange:(e,t)=>Ee(null!=t?t:""),errorMessage:oe}),p.a.createElement(u.a,{label:B("TableSchemaView.logicalName"),required:!0,prefix:a.envSolutionInfo.publisherPrefix,value:ue,maxLength:b.m.Dataverse.ColumnLogicalName,onChange:(e,t)=>Oe(null!=t?t:""),errorMessage:ne}),p.a.createElement(o.a,{label:B("TableSchemaView.dataType"),required:!0,options:[{key:O.b.Text,text:B("TableSchemaView.DataTypeValues.Text"),data:{icon:E.b[O.b.Text]}}],defaultSelectedKey:O.b.Text,onRenderTitle:Ie,disabled:!0})),h.a.enableSelectExistingTable&&!le&&p.a.createElement("div",{style:z.container},p.a.createElement(x.a,{iconName:"Info",style:z.icon,"aria-hidden":"true",title:"Info"}),Object(I.c)(B("TableSchemaView.editTableInformation"),e=>p.a.createElement("span",{style:z.label},e))))))})},25125:function(e,t,a){"use strict";a.d(t,"j",(function(){return s})),a.d(t,"e",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"i",(function(){return m})),a.d(t,"a",(function(){return p})),a.d(t,"f",(function(){return b})),a.d(t,"g",(function(){return g})),a.d(t,"b",(function(){return v})),a.d(t,"h",(function(){return f})),a.d(t,"c",(function(){return h}));var n=a(20435),r=a(17716),o=a(11883);function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var c=[n.e.TextInput,n.e.CheckBox,n.e.Radio,n.e.DatePicker,n.e.DropDown,n.e.ListBox,n.e.Rating,n.e.Slider,n.e.Toggle];function s(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!e)return"";var n=e.replace(/\W/g,"").toLowerCase().trim().substring(0,t);return a?"".concat(a).concat(n):n}function u(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e)return"";var n=e.replace(/[^\s_A-Za-z0-9]/g,"").substring(0,t);return a?n.trim():n}function d(e,t,a,o,i,l){var d,m,p,b="".concat(a.substring(0,27)).concat(e.displayId),g=function(e,t){if(!t)return[];return e.filter(e=>t.containsRectangle(e.rectangle))}(t,e.rectangle),v=g.find(e=>c.includes(e.tagName)),f=null!==(d=null===(m=g.find(e=>e.tagName===n.e.TextLabel))||void 0===m?void 0:m.value)&&void 0!==d?d:null==v?void 0:v.value,h=u(f||b,r.m.Dataverse.ColumnDisplayName),y=0,O=o.filter(e=>e.startsWith(h));O.length>0&&(y+=O.length);var E=s(h,r.m.Dataverse.ColumnLogicalName);i.forEach(e=>{e==="".concat(E).concat(y>0?y:"")&&y++});var C=s("".concat(E).concat(y>0?y:""),r.m.Dataverse.ColumnLogicalName);h="".concat(h).concat(y>0?y:"");var S=function(e){switch(e){case n.e.DatePicker:return n.b.Date;case n.e.Rating:case n.e.Slider:case n.e.CheckBox:case n.e.Toggle:return n.b.Number;default:return n.b.Text}}(null!==(p=null==v?void 0:v.tagName)&&void 0!==p?p:n.e.TextInput);return e.value=h,l&&(e.ariaLabel=l(n.e.ControlGroup,h)),{id:e.displayId,groupId:e.displayId,name:h,dataType:S,logicalName:C,groupControlIds:v?[v.displayId]:[],columnId:r.c}}function m(e,t,a,n,r){var o=[],i=[...n];return e.forEach(e=>{var n=d(e,t,a,o.map(e=>e.name),i,r);o.push(n),i.push(n.logicalName)}),o}var p={id:-1,groupId:-1,name:r.d.DisplayName,dataType:n.b.Text,logicalName:r.d.LogicalName,groupControlIds:[],columnId:r.c};function b(e){var t,a=null===(t=e.find(e=>e.dataType===n.b.Text))||void 0===t?void 0:t.id;return{primaryColumnId:null!=a?a:-1,defaultPrimarySchema:void 0===a?function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},p):void 0}}function g(e){switch(e){case n.e.TextInput:case n.e.CheckBox:case n.e.Radio:case n.e.DropDown:case n.e.Toggle:return[n.b.Text,n.b.Email,n.b.Phone,n.b.URL,n.b.Number,n.b.Decimal,n.b.Date];case n.e.DatePicker:return[n.b.Text,n.b.Email,n.b.Phone,n.b.Date];case n.e.Rating:case n.e.Slider:return[n.b.Text,n.b.Email,n.b.Phone,n.b.Number,n.b.Decimal,n.b.Date];default:return[n.b.Text]}}var v=e=>{switch(e){case o.j.Integer:case o.j.Double:case o.j.BigInt:return n.b.Number;case o.j.Decimal:return n.b.Decimal;case o.j.DateTime:return n.b.Date;default:return n.b.Text}};function f(e,t,a,n){var r=!1;return!(r=!!t.find(t=>e.id!==t.id&&e.logicalName===t.logicalName))&&a.length>0&&(r=!!a.find(t=>t.key==="".concat(n).concat(e.logicalName))),r}var h=(e,t)=>e.map(e=>t&&e.key.startsWith(t)?e.key.replace(t,""):e.key)},25126:function(e,t,a){"use strict";a.d(t,"c",(function(){return h})),a.d(t,"a",(function(){return y})),a.d(t,"d",(function(){return O})),a.d(t,"h",(function(){return E})),a.d(t,"b",(function(){return S})),a.d(t,"e",(function(){return x})),a.d(t,"g",(function(){return I})),a.d(t,"f",(function(){return T}));var n=a(12861),r=a(11824),o=a(11666),i=a(11021),l=a(10926),c=a.n(l),s=a(20435),u=a(17716),d=a(25125),m=a(14134),p=a(25127);function b(e,t,a,n,r,o,i){try{var l=e[o](i),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){f(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function f(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var h=(e,t)=>{var a=t.columnSchema.filter(m.a.enableSelectExistingTable?e=>e.dataType===s.b.Text&&-1!==e.id:e=>e.dataType===s.b.Text).map(e=>({text:e.name,key:e.id,data:v({},e)}));return m.a.enableSelectExistingTable?[{text:e("TableSchemaView.newColumn"),key:-1,data:v({icon:"Add"},d.a)},...a]:a},y=e=>e.filter(e=>{var t;return null===(t=e.data)||void 0===t?void 0:t.isPrimary}).map(e=>v(v({},e),{},{key:d.a.id})),O=(e,t)=>{t?Object(i.fb)(u.s,u.q.TableSettingsClosed,{logicalNameChanged:t.logicalName!==e.logicalName,pluralNameChanged:t.pluralName!==e.pluralName,displayNameChanged:t.name!==e.name,primaryColumnChanged:t.primaryColumnId!==e.primaryColumnId,tableId:t.tableId!==e.tableId}):Object(i.fb)(u.s,u.q.TableSettingsClosed)},E=function(){var e,t=(e=function*(e,t,a){var n=!1;return e===u.g&&(n=yield a.checkTableNameExists(Object(d.j)(t,u.m.Dataverse.TableLogicalName,a.envSolutionInfo.publisherPrefix))),n},function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function i(e){b(o,n,r,i,l,"next",e)}function l(e){b(o,n,r,i,l,"throw",e)}i(void 0)}))});return function(e,a,n){return t.apply(this,arguments)}}(),C={root:{marginRight:8}},S=(e,t,a,o,i)=>c.a.createElement("div",null,c.a.createElement(n.LoadingPrimaryButton,{onClick:t,styles:C,"data-automationid":u.j.saveTableSettings,disabled:o,loadingAnnouncement:e("TableSchemaView.savingChangesText"),loading:i},e("Common.saveButtonTitle")),c.a.createElement(r.a,{onClick:()=>a(),"data-automationid":u.j.cancelTableSettings,disabled:i},e("Common.cancelButtonTitle"))),x=(e,t,a)=>{var n=Object(p.c)(e);return c.a.createElement("div",null,c.a.createElement(o.a,{styles:n,iconName:a,"aria-hidden":"true",title:a}),c.a.createElement("span",null,t))},I=(e,t,a)=>{var n,r;return t?-1===t.key&&null!==(n=t.data)&&void 0!==n&&n.icon?x(e,t.text,t.data.icon):null!==(r=null==a?void 0:a(t))&&void 0!==r?r:null:null},T=(e,t,a)=>{var n,r;if(!t||0===t.length)return null;var o=t[0];return null!==(n=o.data)&&void 0!==n&&n.icon?x(e,o.text,o.data.icon):null!==(r=null==a?void 0:a(t))&&void 0!==r?r:null}},25127:function(e,t,a){"use strict";a.d(t,"c",(function(){return c})),a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return u}));var n=a(20435);function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l=e=>({color:e.palette.themePrimary,verticalAlign:"middle",fontSize:16}),c=e=>({root:o(o({},l(e)),{},{marginRight:8})}),s={[n.b.Date]:"DateTime",[n.b.Decimal]:"Decimals",[n.b.Email]:"Mail",[n.b.Number]:"NumberField",[n.b.Phone]:"Phone",[n.b.Text]:"TextField",[n.b.URL]:"Link"},u={TextLabel:"Label",TextInput:"TextField",Button:"ButtonControl",CheckBox:"CheckboxComposite",Radio:"RadioBtnOn",Rectangle:"RectangleShape",DatePicker:"DateTime",DropDown:"Dropdown",Rating:"FavoriteStar",Slider:"Slider",Toggle:"ToggleRight"}},25128:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return c})),a.d(t,"c",(function(){return s}));var n=a(10926),r=a.n(n),o=a(25129),i={controls:[],tableInfo:{columnSchema:[],columns:[],name:"",logicalName:"",pluralName:"",primaryColumnId:-1,tableId:""},isValid:!0},l=Object(n.createContext)({state:i,dispatch:()=>null}),c=e=>{var{children:t,taggingState:a}=e,[i,c]=Object(n.useReducer)(o.a,a);return r.a.createElement(l.Provider,{value:{state:i,dispatch:c}},t)},s=()=>Object(n.useContext)(l)},25129:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(21619),r=a(11465),o=a(20435),i=a(25125),l=a(25130),c=a(25079),s=a(17716);function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){m(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function m(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var p=(e,t)=>{var{type:a}=t;switch(a){case l.b.INITIALIZE_CONTROL_TAGGING:var n=t;return Object(c.d)(n.controls,n.getAriaLabel);case l.b.ADD:return[...e.controls,t.control];case l.b.REMOVE:return[...e.controls.filter(e=>e.displayId!==t.id)];case l.b.UPDATE:var r=t,o=e.controls.findIndex(e=>e.displayId===r.control.displayId),i=d(d({},e.controls[o]),r.control);return[...e.controls.slice(0,o),i,...e.controls.slice(o+1)];case l.b.HIGHLIGHT_BOXES:var s=t;return[...e.controls.map(e=>e.tagName===s.tag?d(d({},e),{},{isHovered:!0}):e)];case l.b.UNHIGHLIGHT_BOXES:var u=t;return[...e.controls.map(e=>e.tagName===u.tag?d(d({},e),{},{isHovered:!1}):e)];default:return e.controls}},b=(e,t)=>{var a,u,{type:m}=t;switch(m){case l.a.INITIALIZE_COLUMN_TAGGING:var p=t,b=Object(c.d)(p.columns,p.getAriaLabel),g=Object(c.d)(p.controls,p.getAriaLabel),v=Object(i.i)(b,g,p.name,p.existingColumns,p.getAriaLabel),{tableId:f}=p.tableInfo,h=!f||f===s.g,y=Object(i.e)(p.name,s.m.Dataverse.TableDisplayName),{primaryColumnId:O,defaultPrimarySchema:E}=Object(i.f)(v),C=Object(r.h)(),S=h?{name:y,logicalName:Object(i.j)(y,s.m.Dataverse.TableLogicalName),pluralName:null!=C&&C.startsWith("en")?Object(n.plural)(y.trim()):y,tableId:s.g,primaryColumnId:O}:d(d({},p.tableInfo),{},{primaryColumnId:i.a.id});return E&&v.push(E),d({columns:b,columnSchema:v},S);case l.a.COLUMNS_UPDATE_TABLE_SETTINGS:var x,{tableSettings:I}=t;if(I.tableId!==s.g)x=d(d({},e.tableInfo),I);else{if(I.primaryColumnId!==i.a.id&&e.tableInfo.primaryColumnId===i.a.id){var T=e.tableInfo.columnSchema.findIndex(e=>e.id===i.a.id);e.tableInfo.columnSchema.splice(T,1)}x=d(d({},e.tableInfo),{},{logicalName:Object(i.j)(I.logicalName,s.m.Dataverse.TableLogicalName),pluralName:Object(i.e)(I.pluralName,s.m.Dataverse.TableDisplayName),name:Object(i.e)(I.name,s.m.Dataverse.TableDisplayName),primaryColumnId:I.primaryColumnId,tableId:I.tableId})}return d(d({},e.tableInfo),x);case l.a.ADD:var j=t,w=Object(i.d)(j.column,e.controls,e.tableInfo.name,e.tableInfo.columnSchema.map(e=>e.name),j.existingColumns);return d(d({},e.tableInfo),{},{columnSchema:[...e.tableInfo.columnSchema,w],columns:[...e.tableInfo.columns,j.column]});case l.a.REMOVE:var N=t,P=e.tableInfo.columnSchema.find(e=>e.groupId===N.id),k=e.tableInfo.columnSchema.filter(e=>e.groupId!==N.id);if((null==P?void 0:P.id)===e.tableInfo.primaryColumnId){var{primaryColumnId:L,defaultPrimarySchema:D}=Object(i.f)(k);D&&k.push(D),e.tableInfo.primaryColumnId=L}return d(d({},e.tableInfo),{},{columns:[...e.tableInfo.columns.filter(e=>e.displayId!==N.id)],columnSchema:k});case l.a.UPDATE:var R=t,A=e.tableInfo.columns.findIndex(e=>{var t;return e.displayId===(null===(t=R.column)||void 0===t?void 0:t.displayId)}),z=e.tableInfo.columnSchema.findIndex(e=>{var t;return e.id===(null===(t=R.columnSchema)||void 0===t?void 0:t.id)});R.columnSchema&&(R.columnSchema.name=Object(i.e)(R.columnSchema.name,s.m.Dataverse.ColumnDisplayName),R.columnSchema.logicalName=Object(i.j)(R.columnSchema.logicalName,s.m.Dataverse.ColumnLogicalName));var B=A>-1&&R.column?[...e.tableInfo.columns.slice(0,A),R.column,...e.tableInfo.columns.slice(A+1)]:e.tableInfo.columns.map(e=>(e.isActive=!1,e)),M=z>-1&&R.columnSchema?[...e.tableInfo.columnSchema.slice(0,z),R.columnSchema,...e.tableInfo.columnSchema.slice(z+1)]:e.tableInfo.columnSchema;if((null===(a=R.columnSchema)||void 0===a?void 0:a.id)===e.tableInfo.primaryColumnId&&R.columnSchema.dataType!==o.b.Text){var{primaryColumnId:F,defaultPrimarySchema:_}=Object(i.f)(M);_&&M.push(_),e.tableInfo.primaryColumnId=F}else(null===(u=R.columnSchema)||void 0===u?void 0:u.id)===i.a.id&&-1===z&&M.push(R.columnSchema);return d(d({},e.tableInfo),{},{columns:B,columnSchema:M});case l.a.HIGHLIGHT_BOXES:var W=t;return d(d({},e.tableInfo),{},{columns:e.tableInfo.columns.map(e=>e.displayId===W.id?d(d({},e),{},{isHovered:!0}):e)});case l.a.UNHIGHLIGHT_BOXES:var G=t;return d(d({},e.tableInfo),{},{columns:e.tableInfo.columns.map(e=>e.displayId===G.id?d(d({},e),{},{isHovered:!1}):e)});default:return e.tableInfo}},g=(e,t)=>{var{type:a}=t;switch(a){case l.c.SET_IS_VALID:return t.isValid;default:return e.isValid}},v=(e,t)=>({controls:p(e,t),tableInfo:b(e,t),isValid:g(e,t)})},25130:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return o}));var n=function(e){return e.ADD="ADD_CONTROL",e.REMOVE="REMOVE_CONTROL",e.UPDATE="UPDATE_CONTROL",e.INITIALIZE_CONTROL_TAGGING="INITIALIZE_CONTROL_TAGGING",e.HIGHLIGHT_BOXES="HIGHLIGHT_BOXES_CONTROL",e.UNHIGHLIGHT_BOXES="UNHIGHLIGHT_BOXES_CONTROL",e}({}),r=function(e){return e.ADD="ADD_COLUMN",e.REMOVE="REMOVE_COLUMN",e.UPDATE="UPDATE_COLUMN",e.INITIALIZE_COLUMN_TAGGING="INITIALIZE_COLUMN_TAGGING",e.COLUMNS_UPDATE_TABLE_SETTINGS="COLUMNS_UPDATE_TABLE_SETTINGS",e.HIGHLIGHT_BOXES="HIGHLIGHT_BOXES_COLUMN",e.UNHIGHLIGHT_BOXES="UNHIGHLIGHT_BOXES_COLUMN",e}({}),o=function(e){return e.SET_IS_VALID="SET_IS_VALID",e}({})},25131:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(11860),r=a(11859),o=a(10926),i=a(25132),l=a(12149),c=a(17716),s=a(25123),u=e=>{var{description:t,children:a,linkText:u,headerLabel:d}=e;return o.createElement("div",{className:i.a.outerContainer},o.createElement("div",{className:i.a.innerContainer},o.createElement(l.a,null,d),o.createElement("div",{className:i.a.description},Object(r.c)(t,(e,t)=>o.createElement(n.a,{href:c.l.FromImage,target:"_blank",underline:!0,onClick:()=>Object(s.c)(c.s,{linkLocation:"TaggingGuidance"})},u))),o.createElement("div",{className:i.a.childrenWrapper},a)))}},25132:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(10929),r=Object(n.Y)(),o=Object(n.db)({outerContainer:{border:"1px solid transparent",background:r.palette.white,boxShadow:"0px 0.3px 0.9px rgba(0, 0, 0, 0.1), 0px 1.6px 3.6px rgba(0, 0, 0, 0.13)",borderRadius:4},innerContainer:{padding:"12px"},description:{margin:"0 0 12px 0"},childrenWrapper:{borderTop:"1px solid ".concat(r.palette.neutralLighter),"> :first-child":{paddingTop:"12px"}}})},25133:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(12871),r=a(12149),o=a(13e3),i=a(12854),l=a(11504),c=a(11465),s=a(10926),u=a(20435),d=a(25106),m=a(25127),p={root:{display:"inline-flex",width:"100%",height:"38px"}},b={root:{fontSize:20,fontWeight:600}},g={root:{display:"inline-flex",width:"100%",padding:"8px 8px 8px 16px"}},v=()=>({itemCount:11}),f={header:Object(c.s)("CreateFrom")(e=>{var{t:t,onDeleteControl:a,onSearch:o}=e,l=s.useCallback((e,t)=>o(t),[o]);return s.createElement(s.Fragment,null,s.createElement(r.a,{styles:b},t("TaggingSelector.Controls.headerLabel")),s.createElement(i.a,{placeholder:t("TaggingSelector.Controls.search"),onChange:l}),s.createElement(n.a,{iconProps:{iconName:"Delete"},text:t("TaggingSelector.Controls.deleteTag"),styles:p,onClick:a}))}),main:Object(c.s)("CreateFrom")(e=>{var{t:t,onClickItem:a,filterText:r,selectedTag:i}=e,c=s.useCallback((e,t)=>{Object(d.b)(l.a.enter,e)&&a(t)},[a]),p=s.useMemo(()=>Object.keys(m.a).filter(e=>!r||e.toLocaleLowerCase().includes(r.toLocaleLowerCase())).map(e=>s.createElement(n.a,{key:e,iconProps:{iconName:m.a[e]},text:t("Controls.".concat(e.toLocaleLowerCase())),styles:g,onClick:()=>a(u.e[e]),onKeyDown:t=>c(t,u.e[e]),checked:e===i})),[r,a,c,i,t]);return s.createElement(o.a,{items:p,onRenderCell:e=>e,getPageSpecification:v})})}},25134:function(e,t,a){"use strict";a.d(t,"a",(function(){return P}));var n=a(10929),r=a(12871),o=a(11823),i=a(11824),l=a(12680),c=a(12149),s=a(12139),u=a(12661),d=a(11465),m=a(10926),p=a(20435),b=a(25125),g=a(17716),v=a(13127),f=a(14134),h=a(25127),y=a(25126),O=a(11859),E=a(25124);function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){x(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function x(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var I={root:{display:"inline-flex",width:"100%",height:"38px"}},T={root:{fontSize:20,fontWeight:600}},j=Object(n.eb)({padding:"16px 24px"}),w={root:{marginRight:8}},N={optionsContainer:S({maxHeight:300},E.b)},P={header:Object(d.s)("CreateFrom")(e=>{var{t:t,onDeleteColumn:a}=e;return m.createElement(m.Fragment,null,m.createElement(c.a,{styles:T},t("TaggingSelector.Columns.headerLabel")),m.createElement(r.a,{iconProps:{iconName:"Delete"},text:t("TaggingSelector.Columns.deleteColumn"),styles:I,onClick:a}))}),main:Object(d.s)("CreateFrom")(e=>{var t,a,{t:r,columnSchema:c,onSaveItem:d,controlInfo:E,prefix:C,existingColumns:x,tableInfo:I}=e,T=m.useRef(null),P=m.useRef(null),k=m.useRef(null),[L,D]=m.useState(!(null!=c&&c.name)),[R,A]=m.useState(null==c?void 0:c.logicalName),[z,B]=m.useState(!1),M=Object(n.Y)();m.useEffect(()=>{B(!R)},[R]);var F=m.useCallback((e,t)=>((e,t,a)=>{var n,r;if(!t||0===t.length)return null;var o=t[0];return null!==(n=o.data)&&void 0!==n&&n.icon?Object(y.e)(e,o.text,o.data.icon):null!==(r=null==a?void 0:a(t))&&void 0!==r?r:null})(M,e,t),[M]),_=m.useCallback((e,t)=>((e,t,a)=>{var n,r;return t?null!==(n=t.data)&&void 0!==n&&n.icon?Object(y.e)(e,t.text,t.data.icon):null!==(r=null==a?void 0:a(t))&&void 0!==r?r:null:null})(M,e,t),[M]),W=m.useMemo(()=>{var e;return{text:r("TableSchemaView.newColumn"),key:g.c,data:{dataType:null!==(e=null==c?void 0:c.dataType)&&void 0!==e?e:p.b.Text,icon:"Add"}}},[null==c?void 0:c.dataType,r]),[G,V]=m.useState(()=>{var e=I.tableId===g.g||(null==c?void 0:c.columnId)===g.c?void 0:x.find(e=>e.text===(null==c?void 0:c.name));return null!=e?e:W}),U=m.useMemo(()=>[W,...x],[W,x]),H=Object(b.g)(null!==(t=null==E?void 0:E.tagName)&&void 0!==t?t:p.e.TextInput).map(e=>({key:e.toString(),text:r("TableSchemaView.DataTypeValues.".concat(e)),data:{dataType:e,icon:h.b[e]}})),K=m.useCallback(()=>{var e;if(c){var t=S(S({},c),{},{columnId:null!==(e=null==G?void 0:G.key.toString())&&void 0!==e?e:g.c}),a=!1;if(G.key===g.c){var n,r,o,i,l,s,u,m,p=null===(n=k.current)||void 0===n||null===(r=n.selectedOptions)||void 0===r?void 0:r[0],v=null!==(o=null===(i=H.find(e=>e.key===(null==p?void 0:p.key)))||void 0===i?void 0:i.data.dataType)&&void 0!==o?o:c.dataType;t=S(S({},t),{},{logicalName:null!==(l=null===(s=P.current)||void 0===s?void 0:s.value)&&void 0!==l?l:c.logicalName,name:null!==(u=null===(m=T.current)||void 0===m?void 0:m.value)&&void 0!==u?u:c.name,dataType:v}),a=Object(b.h)(t,I.columnSchema,x,C),B(a)}else t=S(S({},t),{},{logicalName:G.key.toString(),name:G.text,dataType:G.data.dataType});!a&&d(t)}},[H,c,x,d,C,G,I.columnSchema]),q=m.useCallback(()=>{null==d||d()},[d]);return m.createElement(m.Fragment,null,m.createElement(s.a,{tokens:{childrenGap:16,padding:24}},f.a.enableSelectExistingTable&&I.tableId!==g.g&&m.createElement(v.a,{label:r("TableSchemaView.column"),options:U,selectedKey:G.key,onChange:(e,t)=>{V(null!=t?t:W)},styles:N,"data-automationid":g.j.chooseColumn,onRenderOption:_,allowFreeform:!0,autoComplete:"on"}),G.key===g.c&&m.createElement(m.Fragment,null,m.createElement(u.a,{label:r("TableSchemaView.displayName"),required:!0,defaultValue:null==c?void 0:c.name,componentRef:T,maxLength:g.m.Dataverse.ColumnDisplayName,onChange:(e,t)=>{D(!(null!=t&&t.trim()))}}),m.createElement(u.a,{label:r("TableSchemaView.logicalName"),required:!0,defaultValue:null==c?void 0:c.logicalName,prefix:C,componentRef:P,maxLength:g.m.Dataverse.ColumnLogicalName,onChange:(e,t)=>{A(null==t?void 0:t.trim())},errorMessage:z&&R?Object(O.a)(r("TaggingSelector.Columns.logicalNameConflict"),"".concat(C).concat(null===(a=P.current)||void 0===a?void 0:a.value)):void 0})),m.createElement(l.a,{label:r("TableSchemaView.dataType"),required:!0,options:H,defaultSelectedKey:G.data.dataType.toString(),componentRef:k,disabled:G.key!==g.c,onRenderTitle:F,onRenderOption:_})),m.createElement("div",{className:j},m.createElement(o.a,{onClick:K,styles:w,disabled:L||!R},r("Common.saveButtonTitle")),m.createElement(i.a,{onClick:q},r("Common.cancelButtonTitle"))))})}},25135:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(12149),r=a(11465),o=a(10926),i=a(20435),l=a(25095),c=a(11859),s={root:{fontSize:20,fontWeight:400}},u={main:Object(r.s)("CreateFrom")(e=>{var{t:t,tag:a}=e,r=o.useMemo(()=>a===i.e.ControlGroup?o.createElement(l.a,{t:t,showLabel:!1,showSimpleGuidanceText:!0}):Object(l.b)(t,!0,!1)[a],[t,a]),u=a===i.e.ControlGroup?t("ImageWizard.Guidance.column").toLocaleLowerCase():t("Controls.".concat(a.toString().toLowerCase())).toLocaleLowerCase();return o.createElement(o.Fragment,null,o.createElement(n.a,{styles:s},Object(c.a)(t("ImageWizard.tipCalloutHeader"),u)),r)})}},25136:function(e,t,a){"use strict";a.d(t,"a",(function(){return k}));var n=a(11860),r=a(13e3),o=a(14240),i=a(13418),l=a(11940),c=a(11942),s=a(12139),u=a(11859),d=a(11465),m=a(11021),p=a(17716),b=a(10926),g=a(20435),v=a(25130),f=a(25093),h=a(25128),y=a(25077),O=a(25082),E=a(25137),C=a(13256),S=a(12738),x=a(11803),I=a(11932),T=a(11934),j=a(25123),w=a(12149),N=a(11635),P=a(11636),k=Object(d.s)("CreateFrom")(e=>{var{t:t}=e,{state:a}=Object(y.c)(),{input:d,loading:k}=a,[L,D]=b.useState([]),{state:R,dispatch:A}=Object(h.c)(),[z,B]=b.useState(),M=a.errorMessage===p.k.InvalidResponse,F=b.createRef(),_=Object(N.a)(F),W=b.useCallback(()=>{var e=[...new Set(R.controls.filter(e=>e.tagName!==g.e.None).map(e=>e.tagName.toString()))];D(e)},[R.controls]),G=b.useCallback(e=>{A({type:v.b.ADD,control:e})},[A]),V=b.useCallback(e=>{var t=R.controls.find(t=>t.displayId===e&&t.tagName===g.e.None);t&&A({type:v.b.REMOVE,id:t.displayId})},[A,R.controls]),U=b.useCallback(()=>B(void 0),[]),{onNewBoxDrawn:H,activeRectangle:K,onSetActiveItem:q,onUnsetActiveItem:Y,hoveredItem:Z,onHover:X,onHoverOut:$}=Object(E.c)(R.controls,t("TaggingSelector.newObject"),W,G,V,U),{onClickControlType:J,onDeleteControl:Q,onControlMouseOver:ee,onControlMouseOut:te,onResize:ae,numberOfControls:ne}=Object(E.b)(A,R,K,Y,t),re=b.useMemo(()=>Object.values(Object(f.k)(t)),[t]),oe=b.useMemo(()=>({title:b.createElement(f.c.header,{onDeleteControl:Q,onSearch:B}),main:b.createElement(f.c.main,{onClickItem:J,filterText:z,selectedTag:null==K?void 0:K.tagName})}),[null==K?void 0:K.tagName,J,Q,z]),ie=b.useMemo(()=>[{key:"controlColor",name:"",minWidth:16,maxWidth:16,onRender:e=>b.createElement("div",{id:e,className:O.c.controlColorDiv})},{key:"controlName",name:"",minWidth:70,maxWidth:125,onRender:e=>b.createElement("p",{className:O.c.controlLabel},t("Controls.".concat(e.toLowerCase())))}],[t]),le=b.useMemo(()=>Z?b.createElement(x.a,{className:O.l.taggedItemCallout,target:Z.boxReference,setInitialFocus:!0},b.createElement(f.e.main,{tag:Z.tagName})):void 0,[Z]),ce=b.useCallback((e,t)=>b.createElement("div",{onMouseOver:ee(null==e?void 0:e.item),onMouseOut:te(null==e?void 0:e.item),onFocus:ee(null==e?void 0:e.item),onBlur:te(null==e?void 0:e.item)},null==t?void 0:t(e)),[te,ee]),se=b.useCallback(e=>Object(m.fb)(p.s,p.q.PivotTabClick,{pivotKey:null==e?void 0:e.props.itemKey}),[]),ue=b.useMemo(()=>()=>0===ne||ne>30?b.createElement(I.a,{messageBarType:ne>30?T.a.warning:T.a.error,dismissButtonAriaLabel:t("Common.closeButtonTitle")},Object(u.c)(t(ne>30?"KnownUserMessages.Tagging.complexApp":"KnownUserMessages.Tagging.emptyApp"),(e,t)=>b.createElement("span",{className:O.l.boldText},ne))):b.createElement(b.Fragment,null),[ne,t]),de=b.useMemo(()=>_<=P.a.medium,[_]),me=b.useMemo(()=>b.createElement(b.Fragment,null,!k&&!(null==d||!d.uploadFile)&&b.createElement("div",{className:O.l.imagePreviewWrapper,ref:F},b.createElement(f.f,{file:d.uploadFile,groupedBoxes:R.controls,onNewBoxDrawn:H,setActiveItem:q,unsetActiveItem:Y,activeItem:K,tooltipTaggingProps:oe,onFocusOrHover:X,onFocusLostOrHoverOut:$,onResize:ae,allowInnerItemsToShow:!1,onDeleteBox:Q}),le)),[K,le,null==d?void 0:d.uploadFile,k,Q,X,$,H,ae,q,Y,F,R.controls,oe]),pe=b.useMemo(()=>b.createElement(s.a.Item,{disableShrink:!0,className:O.l.rightSectionContainer},b.createElement(o.a,{onLinkClick:se},b.createElement(i.a,{headerText:t("ImageWizard.controlTaggingHeader"),itemKey:"tagging-controls-list","data-automationid":p.j.taggingDetailsView},b.createElement(s.a,{tokens:{padding:16,childrenGap:16}},b.createElement(f.j,{description:t("ImageWizard.controlTaggingDescription"),linkText:t("ImageWizard.taggingTipsText"),headerLabel:t("ImageWizard.Guidance.header")},b.createElement(C.a,{items:L,columns:ie,checkboxVisibility:S.a.hidden,className:O.c.controlListContainer,compact:!0,isHeaderVisible:!1,onRenderRow:ce,"data-automationid":p.j.controlsDetailsList})),b.createElement(f.d,null))),b.createElement(i.a,{headerText:t("ImageWizard.guidanceHeader"),itemKey:"tagging-controls-guidance","data-automationid":p.j.guidanceDetailsView},b.createElement(f.j,{description:t("ImageWizard.controlTaggingDescription"),linkText:t("ImageWizard.taggingTipsText"),headerLabel:t("ImageWizard.Guidance.header")},b.createElement(r.a,{items:re,onRenderCell:e=>e}))))),[ie,L,re,se,ce,t]);return a.loading?b.createElement(l.a,{label:t("ImageWizard.LoadingStatus.componentsLoading"),labelPosition:"bottom",styles:O.h,size:c.a.large}):b.createElement(b.Fragment,null,b.createElement(f.g,null),ue(),!M&&b.createElement(b.Fragment,null,b.createElement(w.a,{className:O.l.contentTitle},t("ImageWizard.Steps.Components.title")),b.createElement("p",null,Object(u.c)(t("ImageWizard.Steps.Components.description"),(e,a)=>b.createElement(n.a,{href:p.l.FromImage,target:"_blank",underline:!0,onClick:()=>Object(j.c)(p.s,{linkLocation:"ComponentTagging"})},t("ImageWizard.Steps.Components.learnMoreLinkText"))))),!M&&b.createElement(s.a,{horizontal:!0,horizontalAlign:"space-between",tokens:{padding:"32px 0px",childrenGap:5},wrap:de,className:O.l.documentWrapper},de?b.createElement(b.Fragment,null,pe,me):b.createElement(b.Fragment,null,me,pe)))})},25137:function(e,t,a){"use strict";a.d(t,"c",(function(){return p})),a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return g}));var n=a(10926),r=a.n(n),o=a(25079),i=a(20435),l=a(25130),c=a(25123),s=a(17716);function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){m(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function m(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var p=(e,t,a,n,l,c)=>{var[s,u]=r.a.useState(),[d,m]=r.a.useState(),[p,b]=r.a.useState(),g=r.a.useRef(0);r.a.useEffect(()=>{e.length>0&&(g.current=e.reduce((e,t)=>e.displayId>t.displayId?e:t).displayId+1,null==a||a())},[e,a]);var v=()=>{m(void 0)},f=r.a.useCallback(e=>{e&&u({id:+e.displayId,tagId:e.tagName}),v()},[]),h=r.a.useCallback(e=>{null!=e&&e.displayId&&(null==l||l(e.displayId)),p?(m(void 0),b(!1)):(u(void 0),null==c||c())},[l,c,p]),y=r.a.useCallback((e,a,r,l)=>{if(!s){u({tagId:i.e.None,id:g.current});var c=Object(o.c)(a,g.current,t);c.displayTooltip=!r,r&&(c.isBeingKeyboardResized=!0,c.isActive=!0,c.isResizing=!0,b(!0)),null==n||n(c)}},[s,t,n]),O=r.a.useMemo(()=>{if(s){var t=e.find(e=>e.displayId===s.id);if(t)return t.isActive=!0,t}},[s,e]);return{onNewBoxDrawn:y,boundingBoxes:e,onSetActiveItem:f,activeRectangle:O,onUnsetActiveItem:h,hoveredItem:d,onHover:e=>{O||m(e)},onHoverOut:v}},b=(e,t,a,n,u)=>{var m=t.tableInfo.columns.filter(e=>e.tagName!==i.e.None).length;r.a.useEffect(()=>{e(0===m?{type:l.c.SET_IS_VALID,isValid:!1}:{type:l.c.SET_IS_VALID,isValid:!0})},[m,e]);var p=Object(o.e)(u),b=r.a.useCallback(t=>()=>{a||e({type:l.a.HIGHLIGHT_BOXES,id:t})},[a,e]),g=r.a.useCallback(t=>()=>{e({type:l.a.UNHIGHLIGHT_BOXES,id:t})},[e]),v=r.a.useCallback((n,r)=>{var o=t.tableInfo.columns.find(e=>e.displayId===(null==a?void 0:a.displayId));o&&e({type:l.a.UPDATE,column:d(d({},o),{},{rectangle:n,isResizing:r.isResizing})})},[null==a?void 0:a.displayId,e,t.tableInfo.columns]),{activeSchema:f,boundControl:h}=r.a.useMemo(()=>{var e=a?t.tableInfo.columnSchema.find(e=>e.id===a.displayId):void 0,n=e&&e.groupControlIds.length>0?null==e?void 0:e.groupControlIds[0]:void 0;return{activeSchema:e,boundControl:n?t.controls.find(e=>e.displayId===n):void 0}},[a,t.tableInfo.columnSchema,t.controls]);return{onDeleteColumn:()=>{var r,o;if(a){var i=t.tableInfo.columns.length>0?t.tableInfo.columns[0]:void 0;Object(c.e)(s.q.DeleteColumn,{tagName:a.tagName,id:a.displayId}),e({type:l.a.REMOVE,id:a.displayId}),n(),null==i||null===(r=i.boxReference)||void 0===r||null===(o=r.current)||void 0===o||o.focus()}},onSaveColumn:r=>{if(a){var o=t.tableInfo.columns.find(e=>e.displayId===a.displayId);if((null==o?void 0:o.tagName)===i.e.None&&!r)return e({type:l.a.REMOVE,id:o.displayId}),void n();var u=t.tableInfo.columnSchema.find(e=>e.groupId===(null==o?void 0:o.displayId));if(o&&u){if(!r)return e({type:l.a.UPDATE,column:d(d({},o),{},{isActive:!1})}),void n();var m=o.tagName===i.e.None?s.q.AddColumn:s.q.UpdateColumn;Object(c.e)(m,{id:o.displayId,displayNameChanged:u.name!==(null==r?void 0:r.name),logicalNameChanged:u.logicalName!==(null==r?void 0:r.logicalName),tableNameUsed:null==r?void 0:r.logicalName.startsWith(t.tableInfo.logicalName),dataType:null==r?void 0:r.dataType,previousDataType:u.dataType}),e({type:l.a.UPDATE,column:o.tagName===i.e.None&&r||r.columnId!==s.c?d(d({},o),{},{tagName:i.e.ControlGroup,isActive:!1,value:r.name,isHovered:!1,isBeingKeyboardResized:!1,ariaLabel:p(i.e.ControlGroup,r.name)}):void 0,columnSchema:r}),n()}}},onColumnMouseOver:b,onColumnMouseOut:g,onResize:v,activeSchema:f,boundControl:h,numberOfColumns:m}},g=(e,t,a,n,u)=>{var m=Object(o.e)(u),p=t.controls.filter(e=>e.tagName!==i.e.None).length;r.a.useEffect(()=>{e(0===p?{type:l.c.SET_IS_VALID,isValid:!1}:{type:l.c.SET_IS_VALID,isValid:!0})},[p,e]);var b=r.a.useCallback(t=>()=>{e({type:l.b.HIGHLIGHT_BOXES,tag:t})},[e]);return{onDeleteControl:()=>{var r,o;if(a){var i=t.controls.length>0?t.controls[0]:void 0;Object(c.e)(s.q.DeleteControl,{tagName:a.tagName,id:a.displayId}),e({type:l.b.REMOVE,id:a.displayId}),n(),null==i||null===(r=i.boxReference)||void 0===r||null===(o=r.current)||void 0===o||o.focus()}},onClickControlType:r=>{if(a){var o=t.controls.find(e=>e.displayId===a.displayId);if(o){var u=o.tagName===i.e.None?s.q.AddControl:s.q.UpdateControl;Object(c.e)(u,{tagName:r,id:o.displayId,previousTagName:o.tagName===i.e.None?void 0:o.tagName}),e({type:l.b.UPDATE,control:d(d({},o),{},{tagName:r,isActive:!1,isHovered:!1,isBeingKeyboardResized:!1,ariaLabel:m(r,o.value)})}),n()}}},onControlMouseOut:r.a.useCallback(t=>()=>{e({type:l.b.UNHIGHLIGHT_BOXES,tag:t})},[e]),onControlMouseOver:b,onResize:r.a.useCallback((n,r)=>{var o=t.controls.find(e=>e.displayId===(null==a?void 0:a.displayId));o&&e({type:l.b.UPDATE,control:d(d({},o),{},{rectangle:n,isResizing:r.isResizing})})},[null==a?void 0:a.displayId,e,t.controls]),numberOfControls:p}}},25138:function(e,t,a){"use strict";a.d(t,"a",(function(){return I}));var n=a(12948),r=a(11860),o=a(11932),i=a(11934),l=a(11940),c=a(11942),s=a(12139),u=a(11859),d=a(11465),m=a(10926),p=a(17716),b=a(20408),g=a(25093),v=a(25077),f=a(25082),h=a(20437),y=a(10929),O=a(25123),E=a(14134),C=a(25139),S=a(12149),x={childrenGap:10,padding:10},I=Object(d.s)("CreateFrom")(e=>{var t,a,d,I,{t:T,isNewWizard:j=!1}=e,w=Object(y.Y)(),{state:N,dispatch:P}=Object(v.c)(),k=N.errorMessage===p.k.InvalidResponse,L=N.environmentErrorMessage?p.k.InvalidEnvironment:null!==(t=N.userPrivileges)&&void 0!==t&&t.prvCreateEntity?void 0:p.k.TablePermissionsMissing,[D,R]=m.useState(null!==(a=N.dataSelection)&&void 0!==a?a:!E.a.enableSelectExistingTable&&L?p.i.Skip:p.i.NewTable),A=m.useCallback((e,t)=>{null!=t&&t.key&&R(t.key===p.i.NewTable.toString()?p.i.NewTable:p.i.Skip)},[]);m.useEffect(()=>{D!==N.dataSelection&&P({type:h.a.SKIP_DATA_STEPS,currentStep:2,currentSubStep:0,skip:D===p.i.Skip,dataSelection:D,t:T,isNewWizard:j,skipStatus:j?C.a.Skipped:void 0,resetStatus:j?C.a.Empty:void 0})},[D,P,j,N.dataSelection,T]);var z=(e,t)=>{var a;return m.createElement(s.a,{tokens:x,className:Object(f.j)(null!==(a=null==e?void 0:e.disabled)&&void 0!==a&&a,w).labelContainer,verticalFill:!0,verticalAlign:"center"},null==t?void 0:t(e),m.createElement("p",null,Object(u.c)(null==e?void 0:e.about,(t,a)=>m.createElement(r.a,{href:p.l.FromImage,target:"_blank",underline:!0,onClick:()=>Object(O.c)(p.s,{linkLocation:"".concat(O.a,"/").concat(null==e?void 0:e.key)})},T("Common.learnMoreLinkText")))))};return N.userPrivileges?N.loading?m.createElement(l.a,{label:T("ImageWizard.LoadingStatus.appLoading"),labelPosition:"bottom",styles:f.h,size:c.a.large}):k?m.createElement(g.h,null):m.createElement(m.Fragment,null,m.createElement(g.g,null),!E.a.enableSelectExistingTable&&!!L&&m.createElement(o.a,{messageBarType:i.a.warning,dismissButtonAriaLabel:T("Common.closeButtonTitle")},Object(u.c)(T("KnownUserMessages.".concat(L)),(e,t)=>0===t?m.createElement("span",{className:f.l.boldText},e):m.createElement(r.a,{href:p.l.FromImage,target:"_blank",underline:!0,onClick:()=>Object(O.c)(p.s,{linkLocation:"".concat(O.a,"/").concat(L)})},e))),m.createElement(s.a,{style:{height:"100%"}},m.createElement(S.a,{className:f.l.contentTitle},T("ImageWizard.Steps.Storage.title")),m.createElement("p",null,T("ImageWizard.Steps.Storage.description")),m.createElement(s.a,{horizontal:!0,horizontalAlign:"center",wrap:!0,verticalAlign:"center",tokens:{padding:"32px 0px",childrenGap:5},style:{height:"100%"}},m.createElement(n.a,{styles:f.d,options:[{disabled:!(null!==(d=N.userPrivileges)&&void 0!==d&&d.prvCreateEntity||E.a.enableSelectExistingTable),key:p.i.NewTable.toString(),text:E.a.enableSelectExistingTable?T("AppFromImage.Data.DataOptions.dataverseTableTitle"):T("AppFromImage.Data.DataOptions.newTableTitle"),imageSize:{width:100,height:100},styles:Object(f.e)(!(null!==(I=N.userPrivileges)&&void 0!==I&&I.prvCreateEntity||E.a.enableSelectExistingTable),D===p.i.NewTable,w),about:E.a.enableSelectExistingTable?T("AppFromImage.Data.DataOptions.dataverseTableMessage"):T("AppFromImage.Data.DataOptions.newTableMessage"),imageAlt:E.a.enableSelectExistingTable?T("AppFromImage.Data.DataOptions.dataverseTableTitle"):T("AppFromImage.Data.DataOptions.newTableTitle"),imageSrc:b.b.createNewTable,onRenderLabel:z},{key:p.i.Skip.toString(),text:T("AppFromImage.Data.DataOptions.skipTitle"),imageSize:{width:100,height:100},styles:Object(f.e)(!1,D===p.i.Skip,w),about:T("AppFromImage.Data.DataOptions.skipMessage"),imageAlt:T("AppFromImage.Data.DataOptions.skipTitle"),imageSrc:b.b.skipStep,onRenderLabel:z}],defaultSelectedKey:D,onChange:A,"data-automationid":p.j.dataSetupOptions}),m.createElement(s.a.Item,{disableShrink:!0,className:f.l.rightSectionContainer},m.createElement(g.d,null))))):m.createElement(l.a,{label:T("ImageWizard.LoadingStatus.checkingPermissions"),labelPosition:"bottom",styles:f.h,size:c.a.large})})},25139:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=function(e){return e[e.Valid=0]="Valid",e[e.Warning=1]="Warning",e[e.Error=2]="Error",e[e.Empty=3]="Empty",e[e.Active=4]="Active",e[e.Skipped=5]="Skipped",e}({})},25140:function(e,t,a){"use strict";a.d(t,"a",(function(){return z}));var n=a(12871),r=a(13256),o=a(12738),i=a(11860),l=a(14240),c=a(13418),s=a(11940),u=a(11942),d=a(12139),m=a(11859),p=a(11465),b=a(11021),g=a(17716),v=a(10926),f=a(20435),h=a(25130),y=a(25093),O=a(25128),E=a(25077),C=a(25082),S=a(25137),x=a(11803),I=a(11932),T=a(11934),j=a(25123),w=a(11666),N=a(10929),P=a(25127),k=a(25125),L=a(14134),D=a(12149),R=a(11635),A=a(11636),z=Object(p.s)("CreateFrom")(e=>{var t,a,{t:p}=e,{state:z,cdsServiceClient:B}=Object(E.c)(),{input:M,loading:F}=z,{state:_,dispatch:W}=Object(O.c)(),[G,V]=v.useState(!1),U=z.errorMessage===g.k.InvalidResponse,[H,K]=v.useState(!1),q=v.createRef(),Y=Object(R.a)(q),Z=z.environmentErrorMessage?g.k.InvalidEnvironment:null!==(t=z.userPrivileges)&&void 0!==t&&t.prvCreateAttribute?void 0:g.k.AttributeCreatePermissionsMissing,X=v.useCallback(e=>{e&&W({type:h.a.COLUMNS_UPDATE_TABLE_SETTINGS,tableSettings:e}),V(!1)},[W]),$=v.useCallback(e=>{var t=Object(k.c)(B.columnOptions,B.envSolutionInfo.publisherPrefix);W({type:h.a.ADD,column:e,existingColumns:t})},[B.columnOptions,B.envSolutionInfo.publisherPrefix,W]),J=v.useCallback(e=>{var t=_.tableInfo.columns.find(t=>t.displayId===e&&t.tagName===f.e.None);t&&W({type:h.a.REMOVE,id:t.displayId})},[W,_.tableInfo.columns]),{boundingBoxes:Q,onNewBoxDrawn:ee,activeRectangle:te,onSetActiveItem:ae,onUnsetActiveItem:ne,hoveredItem:re,onHover:oe,onHoverOut:ie}=Object(S.c)(_.tableInfo.columns,p("TaggingSelector.newObject"),void 0,$,J),{activeSchema:le,boundControl:ce,onColumnMouseOver:se,onColumnMouseOut:ue,onDeleteColumn:de,onSaveColumn:me,onResize:pe,numberOfColumns:be}=Object(S.a)(W,_,te,ne,p);v.useEffect(()=>{var e;if(L.a.enableSelectExistingTable&&(null===(e=z.userPrivileges)||void 0===e||!e.prvCreateAttribute)){var t=!!_.tableInfo.columnSchema.find(e=>e.columnId===g.c);K(t),W({type:h.c.SET_IS_VALID,isValid:!t})}},[null===(a=z.userPrivileges)||void 0===a?void 0:a.prvCreateAttribute,W,_.tableInfo.columnSchema,_.isValid]);var ge=v.useMemo(()=>{var e=Object(N.Y)(),t=Object(P.c)(e);return[{key:"name",name:p("TableSchemaView.displayName"),fieldName:"name",minWidth:70,maxWidth:125},{key:"dataType",name:p("TableSchemaView.dataType"),fieldName:"dataType",minWidth:70,maxWidth:125,onRender:e=>e?v.createElement("div",null,v.createElement(w.a,{iconName:P.b[e.dataType],styles:t,"aria-hidden":"true",title:e.dataType}),v.createElement("span",null,e.dataType)):v.createElement(v.Fragment,null)}]},[p]),ve=_.tableInfo.columnSchema.map(e=>({name:e.name,dataType:p("TableSchemaView.DataTypeValues.".concat(e.dataType)),id:e.id})),fe=v.useMemo(()=>({title:v.createElement(y.b.header,{onDeleteColumn:de}),main:v.createElement(y.b.main,{columnSchema:le,onSaveItem:me,controlInfo:ce,prefix:B.envSolutionInfo.publisherPrefix,existingColumns:B.columnOptions,tableInfo:_.tableInfo})}),[le,ce,B.columnOptions,B.envSolutionInfo.publisherPrefix,de,me,_.tableInfo]),he=v.useMemo(()=>re?v.createElement(x.a,{className:C.l.taggedItemCallout,target:re.boxReference,setInitialFocus:!0},v.createElement(y.e.main,{tag:f.e.ControlGroup})):void 0,[re]),ye=v.useCallback((e,t)=>v.createElement("div",{onMouseOver:se(null==e?void 0:e.item.id),onMouseOut:ue(null==e?void 0:e.item.id),onFocus:se(null==e?void 0:e.item.id),onBlur:ue(null==e?void 0:e.item.id)},null==t?void 0:t(e)),[se,ue]),Oe=v.useCallback(e=>Object(b.fb)(g.s,g.q.PivotTabClick,{pivotKey:null==e?void 0:e.props.itemKey}),[]),Ee=v.useCallback(()=>{V(!0),Object(b.fb)(g.s,g.q.TableSettingsClick,{openedFrom:"columnTagging"})},[]),Ce=v.useMemo(()=>()=>0===be||be>30?v.createElement(I.a,{messageBarType:be>30?T.a.warning:T.a.error,dismissButtonAriaLabel:p("Common.closeButtonTitle")},Object(m.c)(p(be>30?"KnownUserMessages.Tagging.complexForm":"KnownUserMessages.Tagging.emptyForm"),(e,t)=>v.createElement("span",{className:C.l.boldText},be))):v.createElement(v.Fragment,null),[be,p]),Se=v.useMemo(()=>()=>H?v.createElement(I.a,{messageBarType:T.a.warning,dismissButtonAriaLabel:p("Common.closeButtonTitle")},Object(m.c)(p("KnownUserMessages.".concat(Z)),e=>v.createElement(i.a,{href:g.l.FromImage,target:"_blank",underline:!0,onClick:()=>Object(j.c)(g.s,{linkLocation:"".concat(j.a,"/").concat(Z)})},e))):v.createElement(v.Fragment,null),[H,Z,p]),xe=v.useMemo(()=>Y<=A.a.medium,[Y]),Ie=v.useMemo(()=>v.createElement(v.Fragment,null,!F&&!(null==M||!M.uploadFile)&&v.createElement("div",{className:C.l.imagePreviewWrapper,ref:q},v.createElement(y.f,{file:M.uploadFile,groupedBoxes:Q,onNewBoxDrawn:ee,activeItem:te,setActiveItem:ae,unsetActiveItem:ne,tooltipTaggingProps:fe,onFocusOrHover:oe,onFocusLostOrHoverOut:ie,onResize:pe,innerBoxes:_.controls,allowInnerItemsToShow:!0,onDeleteBox:de}),he)),[te,Q,he,null==M?void 0:M.uploadFile,F,de,oe,ie,ee,pe,ae,ne,q,_.controls,fe]),Te=v.useMemo(()=>v.createElement(d.a.Item,{disableShrink:!0,className:C.l.rightSectionContainer},v.createElement(l.a,{onLinkClick:Oe},v.createElement(c.a,{headerText:p("ImageWizard.columnTaggingHeader"),itemKey:"tagging-columns-list","data-automationid":g.j.taggingDetailsView},v.createElement(d.a,{tokens:{padding:16,childrenGap:16}},v.createElement(y.j,{description:p("ImageWizard.columnTaggingDescription"),linkText:p("ImageWizard.taggingTipsText"),headerLabel:p("ImageWizard.Guidance.header")},v.createElement(n.a,{iconProps:{iconName:"Settings"},text:p("ImageWizard.tableProperties"),className:C.a.tablePropsButton,onClick:Ee,"data-automationid":g.j.openTableSettings}),v.createElement(r.a,{items:ve,columns:ge,checkboxVisibility:o.a.hidden,styles:C.b,onRenderRow:ye,"data-automationid":g.j.columnsDetailsList})),v.createElement(y.d,null))),v.createElement(c.a,{headerText:p("ImageWizard.guidanceHeader"),itemKey:"tagging-columns-guidance","data-automationid":g.j.guidanceDetailsView},v.createElement(y.j,{description:p("ImageWizard.columnTaggingDescription"),linkText:p("ImageWizard.taggingTipsText"),headerLabel:p("ImageWizard.Guidance.header")},v.createElement(y.a,{t:p,showSimpleGuidanceText:!1,showLabel:!0}))))),[Oe,ye,Ee,p,ve,ge]);return F?v.createElement(s.a,{label:p("ImageWizard.LoadingStatus.columnsLoading"),labelPosition:"bottom",styles:C.h,size:u.a.large}):U?v.createElement(y.h,null):v.createElement(v.Fragment,null,v.createElement(y.g,{messageActions:{[g.k.TableNameConflict]:{label:p("ImageWizard.editTablePropertiesText"),onClick:Ee}}}),Ce(),Se(),G&&v.createElement(y.i,{panelIsVisible:G,onDismissPanel:X,tableInfo:_.tableInfo}),v.createElement(D.a,{className:C.l.contentTitle},p("ImageWizard.Steps.Columns.title")),v.createElement("p",null,Object(m.c)(p("ImageWizard.Steps.Columns.description"),(e,t)=>v.createElement(i.a,{href:g.l.FromImage,target:"_blank",underline:!0,onClick:()=>Object(j.c)(g.s,{linkLocation:"ColumnTagging"})},p("ImageWizard.Steps.Components.learnMoreLinkText")))),v.createElement(d.a,{horizontal:!0,horizontalAlign:"space-between",tokens:{padding:"32px 0px",childrenGap:5},wrap:xe,className:C.l.documentWrapper},xe?v.createElement(v.Fragment,null,Te,Ie):v.createElement(v.Fragment,null,Ie,Te)))})},25141:function(e,t,a){"use strict";a.d(t,"a",(function(){return E}));var n=a(11712),r=a(13256),o=a(12738),i=a(12149),l=a(11940),c=a(11942),s=a(12139),u=a(10929),d=a(11465),m=a(11021),p=a(17716),b=a(10926),g=a(25125),v=a(25093),f=a(25077),h=a(25082),y=a(20437),O=a(14134),E=Object(d.s)("CreateFrom")(e=>{var{t:t}=e,{state:a,dispatch:d,cdsServiceClient:E}=Object(f.c)(),{loading:C,wizardComplete:S,tableInfo:x}=a,{primaryColumnId:I}=x,[T,j]=b.useState(!1),w=Object(u.Y)(),N=a.errorMessage===p.k.InvalidResponse,P=Object(h.k)(w),k=b.useCallback(e=>{e&&d({type:y.a.REVIEW_UPDATE_TABLE_SETTINGS,tableSettings:e,publisherPrefix:E.envSolutionInfo.publisherPrefix}),j(!1)},[E.envSolutionInfo.publisherPrefix,d]),L=b.useMemo(()=>e=>{var a=b.createElement("span",null,e.name);return(null==e?void 0:e.id)===I?b.createElement(s.a,{horizontal:!0,tokens:{childrenGap:8},verticalAlign:"center"},a,b.createElement("span",{className:P.primaryColumnField},t("TableSchemaView.primaryNameColumnHeader"))):a},[I,P.primaryColumnField,t]),D=b.useMemo(()=>e=>{var t=e.columnId===p.c?Object(g.j)(e.logicalName,p.m.Dataverse.ColumnLogicalName,E.envSolutionInfo.publisherPrefix):e.logicalName;return b.createElement("span",null,t)},[E.envSolutionInfo.publisherPrefix]),R=b.useMemo(()=>[{key:"name",name:t("TableSchemaView.displayName"),fieldName:"name",minWidth:125,maxWidth:250,onRender:L},{key:"logicalName",name:t("TableSchemaView.logicalName"),fieldName:"logicalName",minWidth:125,maxWidth:250,onRender:D},{key:"dataType",name:t("TableSchemaView.dataType"),fieldName:"dataType",minWidth:125,maxWidth:250}],[L,D,t]),A=b.useMemo(()=>C?t(S?"ImageWizard.LoadingStatus.appLoading":"ImageWizard.LoadingStatus.reviewLoading"):void 0,[C,t,S]),z=b.useCallback(()=>{j(!0),Object(m.fb)(p.s,p.q.TableSettingsClick,{openedFrom:"wizardReview"})},[]);return A?b.createElement(l.a,{label:A,labelPosition:"bottom",styles:h.h,size:c.a.large}):N?b.createElement(v.h,null):b.createElement(b.Fragment,null,b.createElement(v.g,{messageActions:{[p.k.TableNameConflict]:{label:t("ImageWizard.editTablePropertiesText"),onClick:z}}}),!O.a.enableSelectExistingTable&&T&&b.createElement(v.i,{panelIsVisible:T,onDismissPanel:k,tableInfo:x}),b.createElement(i.a,{className:h.l.contentTitle},t("ImageWizard.Steps.Review.title")),b.createElement("p",null,t("ImageWizard.Steps.Review.description")),b.createElement(s.a,{horizontal:!0,horizontalAlign:"space-between",tokens:{padding:16,childrenGap:5}},b.createElement(s.a,{tokens:{padding:"16px 0px",childrenGap:5}},b.createElement("div",{className:P.tableNameContainer},b.createElement(i.a,{styles:h.o,"data-automationid":p.j.reviewTableNameLabel},x.name),!O.a.enableSelectExistingTable&&b.createElement(n.a,{iconProps:{iconName:"Edit"},styles:h.f,onClick:z,"data-automationid":p.j.openTableSettings})),b.createElement(r.a,{items:x.columnSchema,columns:R,checkboxVisibility:o.a.hidden,layoutMode:o.e.fixedColumns,skipViewportMeasures:!0,styles:h.m,"data-automationid":p.j.reviewColumnsDetailsList})),b.createElement(s.a.Item,{disableShrink:!0},b.createElement(v.d,null))))})},25142:function(e,t,a){"use strict";a.d(t,"a",(function(){return w}));var n=a(10926),r=a(12139),o=a(12149),i=a(13127),l=a(25077),c=a(11465),s=a(25082),u=a(25093),d=a(25128),m=a(17716),p=a(10929),b=a(25130),g=a(20437),v=a(25126),f=a(25143),h=a(11940),y=a(11942),O=a(11932),E=a(11934),C=a(11859),S=a(11860),x=a(25123),I=a(25124),T={tableId:m.g,name:"",logicalName:"",pluralName:"",primaryColumnId:-1},j={root:{maxWidth:"330px"},callout:{maxWidth:"330px"},optionsContainerWrapper:{maxHeight:"192px"},optionsContainer:I.b},w=Object(c.s)("CreateFrom")(e=>{var t,a,{t:c}=e,I=Object(p.Y)(),w=Object(s.n)(I),{cdsServiceClient:N,dispatch:P,state:k}=Object(l.c)(),{dispatch:L}=Object(d.c)(),[D,R]=n.useState(k.tableInfo.tableId),[A,z]=n.useState(!1),[B,M]=n.useState(!1),F=k.environmentErrorMessage?m.k.InvalidEnvironment:null!==(t=k.userPrivileges)&&void 0!==t&&t.prvCreateEntity?void 0:m.k.TableCreatePermissionsMissing,_=[{text:c("TableSchemaView.newTable"),key:m.g,data:{icon:"Add"}},...N.tableOptions];n.useEffect(()=>{var e,t=D===m.g&&!(null!==(e=k.userPrivileges)&&void 0!==e&&e.prvCreateEntity);M(t),L({type:b.c.SET_IS_VALID,isValid:!!D&&!t})},[D,B,null===(a=k.userPrivileges)||void 0===a?void 0:a.prvCreateEntity,L]),n.useEffect(()=>{N.isLoadingPropertyOption===f.a.COMPLETE?z(!1):z(!0)},[N.isLoadingPropertyOption]);var W=n.useCallback(e=>{var t,a,n=null!==(t=null==e||null===(a=e.key)||void 0===a?void 0:a.toString())&&void 0!==t?t:m.g;R(n),N.getColumnOptionsAsync(n);var r=n===m.g?T:{tableId:n,primaryColumnId:d.b.tableInfo.primaryColumnId,logicalName:n,pluralName:e.data.pluralDisplayName,name:e.text};P({type:g.a.REVIEW_UPDATE_TABLE_SETTINGS,tableSettings:r,publisherPrefix:N.envSolutionInfo.publisherPrefix})},[N,P]),G=n.useCallback((e,t)=>{var a,n;return e?null!==(a=e.data)&&void 0!==a&&a.icon?Object(v.e)(I,e.text,e.data.icon):null!==(n=null==t?void 0:t(e))&&void 0!==n?n:null:null},[I]),V=n.useMemo(()=>()=>B?n.createElement(O.a,{messageBarType:E.a.warning,dismissButtonAriaLabel:c("Common.closeButtonTitle")},Object(C.c)(c("KnownUserMessages.".concat(F)),(e,t)=>0===t?n.createElement("span",{className:s.l.boldText},e):n.createElement(S.a,{href:m.l.FromImage,target:"_blank",underline:!0,onClick:()=>Object(x.c)(m.s,{linkLocation:"".concat(x.a,"/").concat(F)})},e))):n.createElement(n.Fragment,null),[B,F,c]);return A?n.createElement(h.a,{label:c("PreviewTable.SpinnerLabel"),labelPosition:"bottom",styles:s.h,size:y.a.large}):n.createElement(n.Fragment,null,V(),n.createElement(r.a,{horizontal:!0,horizontalAlign:"space-between",tokens:{childrenGap:5}},n.createElement(r.a.Item,{grow:1,verticalFill:!0},n.createElement("div",{className:w.section},n.createElement(o.a,{className:s.l.contentTitle},c("ImageWizard.Steps.TableSelection.title")),n.createElement("p",{className:w.tableSelectionTitleMessage},c("ImageWizard.Steps.TableSelection.description"))),n.createElement("div",{className:w.section},n.createElement(i.a,{placeholder:c("ImageWizard.Steps.TableSelection.placeholder"),label:c("TableSchemaView.table"),required:!0,options:_,onRenderOption:G,selectedKey:D,onChange:(e,t)=>W(t),"data-automationid":m.j.chooseTable,styles:j,allowFreeform:!0,autoComplete:"on"}))),n.createElement(r.a.Item,{disableShrink:!0},n.createElement(u.d,null))))})},25143:function(e,t,a){"use strict";a.d(t,"a",(function(){return v})),a.d(t,"b",(function(){return O}));var n=a(14226),r=a(11020),o=a(11021),i=a(10926),l=a.n(i),c=a(17716),s=a(20437),u=a(25125),d=a(25144),m=a(11883);function p(e,t,a,n,r,o,i){try{var l=e[o](i),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}function b(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function i(e){p(o,n,r,i,l,"next",e)}function l(e){p(o,n,r,i,l,"throw",e)}i(void 0)}))}}var g=/^EntityMetadata With Id = LogicalName='[^']*' does not exist\.$/i,v={PUBLISHERS:"PUBLISHERS",SOLUTIONS:"SOLUTIONS",TABLES:"TABLES",COLUMNS:"COLUMNS",COMPLETE:"COMPLETE"},f={text:c.e.PublisherDisplayName,key:c.e.PublisherId},h={text:c.f.SolutionDisplayName,key:c.f.SolutionId},y={[m.j.DateTime]:"DateTimeAttribute",[m.j.Integer]:"IntegerAttribute",[m.j.Decimal]:"DecimalAttribute",[m.j.String]:"StringAttribute"},O=(e,t)=>{var{oid:a}=l.a.useContext(r.a),[i,m]=l.a.useState(),[p,O]=l.a.useState({uniqueName:"Default",publisherPrefix:"new_"}),[C,S]=l.a.useState([f]),[x,I]=l.a.useState([h]),[T,j]=l.a.useState([]),[w,N]=l.a.useState([]),[P,k]=l.a.useState(v.COMPLETE),L=l.a.useMemo(()=>b((function*(){if(t){var e=yield Object(n.c)(t);m(e)}})),[t]);l.a.useEffect(()=>{L().catch(e=>{if("Environment does not contain linkedEnvironmentMetadata"!==e){var t=Object(o.p)(e);Object(o.U)(c.s,{eventData:t,eventName:c.q.LoadCdsMetadataClient})}})},[L]);var D=l.a.useCallback(function(){var t=b((function*(t,a,n,r){E(function(){var o=b((function*(){if(i){e({type:s.a.PROCESS_CREATE_ATTRIBUTE});var o=i.createBatch({scenarioName:"".concat(c.s,"/").concat(c.q.CreateAttribute)}),l=r.map(e=>o.executeAction(y[e.AttributeType],"Create",{entityName:n,entityId:"",solutionName:p.uniqueName},e));yield o.submit({});var u=(yield Promise.all(l))?void 0:c.k.AttributeCreateError;e({type:s.a.PROCESS_CREATE_ATTRIBUTE_COMPLETE,attributeCreateError:u}),u?(e({type:s.a.SET_SERVICE_RESPONSE_ERROR,errorMessage:c.k.InvalidResponse}),t.completeWithError({attributeCreated:!1,error:"something unexpected"})):(t.progress({attributeCreated:!0}),a(t))}}));return function(){return o.apply(this,arguments)}}(),a=>{var n;e({type:s.a.PROCESS_CREATE_ATTRIBUTE_COMPLETE,attributeCreateError:null!==(n=a.message)&&void 0!==n?n:c.k.AttributeCreateError});var r=Object(o.p)(a);t.completeWithError({attributeCreated:!1,error:r})})}));return function(e,a,n,r){return t.apply(this,arguments)}}(),[i,e,p.uniqueName]),R=l.a.useCallback(function(){var t=b((function*(t,a,n){E(function(){var r=b((function*(){if(i){e({type:s.a.PROCESS_CREATE_TABLE});var r=(yield i.executeAction("Entity","Create",{solutionName:p.uniqueName},n,{scenarioName:"".concat(c.s,"/").concat(c.q.CreateTableWithAttributes)}))?void 0:c.k.TableCreateError;e({type:s.a.PROCESS_CREATE_TABLE_COMPLETE,tableCreateError:r}),r?(e({type:s.a.SET_SERVICE_RESPONSE_ERROR,errorMessage:c.k.InvalidResponse}),t.completeWithError({tableCreated:!1,error:"something unexpected"})):(t.progress({tableCreated:!0}),a(t))}}));return function(){return r.apply(this,arguments)}}(),a=>{e({type:s.a.PROCESS_CREATE_TABLE_COMPLETE,tableCreateError:c.k.TableCreateError});var n=Object(o.p)(a);t.completeWithError({tableCreated:!1,error:n})})}));return function(e,a,n){return t.apply(this,arguments)}}(),[i,e,p.uniqueName]);return{envSolutionInfo:p,isLoadingPropertyOption:P,publisherOptions:C,solutionOptions:x,tableOptions:T,columnOptions:w,checkEnvironmentStatusAndPermissions:l.a.useCallback(b((function*(){if(!i||null==t||!t.properties.linkedEnvironmentMetadata)return e({type:s.a.SET_INVALID_ENVIRONMENT_ERROR,errorMessage:c.k.InvalidEnvironment}),void e({type:s.a.SET_USER_PRIVILEGES,privileges:{}});var n=Object(o.Y)(c.s,c.q.CheckUserPrivileges),r=i.checkUserPrivileges({azureactivedirectoryobjectid:a},void 0,{scenarioName:"".concat(c.s,"/").concat(c.q.CheckUserPrivileges)}).then(t=>{var a={prvCreateEntity:!(null==t||!t.prvCreateEntity),prvCreateAttribute:!(null==t||!t.prvCreateAttribute)};e({type:s.a.SET_USER_PRIVILEGES,privileges:a}),n.complete(a)}).catch(t=>{e({type:s.a.SET_USER_PRIVILEGES,privileges:{}});var a=Object(o.p)(t);n.completeWithError({error:a})}),l=Object(o.Y)(c.s,c.q.GetDefaultSolution),u=i.executeOperation("solutions?$expand=publisherid&$filter=isvisible eq true and solutionid eq ".concat(c.f.SolutionId),"GET",{},{scenarioName:"".concat(c.s,"/").concat(c.q.GetDefaultSolution)}).then(e=>{var t,a,n,r,o,i=null===(t=e.value)||void 0===t?void 0:t[0];i&&O({uniqueName:null!==(n=i.uniquename)&&void 0!==n?n:"Default",publisherPrefix:"".concat(null!==(r=null===(o=i.publisherid)||void 0===o?void 0:o.customizationprefix)&&void 0!==r?r:"new","_")});l.complete({uniqueName:null==i?void 0:i.uniquename,publisherPrefix:null==i||null===(a=i.publisherid)||void 0===a?void 0:a.customizationprefix})}).catch(e=>{var t=Object(o.p)(e);l.completeWithError({error:t})});yield Promise.all([r,u])})),[i,null==t?void 0:t.properties.linkedEnvironmentMetadata,a,e]),checkTableNameExists:l.a.useCallback(function(){var t=b((function*(t){if(!i)return!1;var a=Object(o.Y)(c.s,c.q.CheckTableNameExists),n=function(){var n=b((function*(){return yield i.executeOperation("EntityDefinitions(LogicalName='".concat(t,"')?$select=LogicalName"),"GET",{},{scenarioName:"".concat(c.s,"/").concat(c.q.CheckTableNameExists)}),e({type:s.a.SET_TABLE_NAME_CONFLICT,hasConflict:!0}),a.complete({tableNameExists:!0}),!0}));return function(){return n.apply(this,arguments)}}();return yield E(n,t=>{var n=g.test(null==t?void 0:t.message);if("404"===(null==t?void 0:t.code)||"500"===(null==t?void 0:t.code)&&n)e({type:s.a.SET_TABLE_NAME_CONFLICT,hasConflict:!1}),a.complete({tableNameExists:!1});else{var r=Object(o.p)(t);a.completeWithError({error:r})}return!1})}));return function(e){return t.apply(this,arguments)}}(),[i,e]),createTableWithAttributes:l.a.useCallback(function(){var e=b((function*(e,a){var n,r,i=Object(o.Y)(c.s,c.q.CreateAppFromImage),l=(null==t||null===(n=t.properties)||void 0===n?void 0:n.linkedEnvironmentMetadata)&&parseInt(t.properties.linkedEnvironmentMetadata.baseLanguage,10)||1033,s=Object(d.a)(e,l,p.publisherPrefix);s?yield R(i,a,s):(i.progress({tableCreated:!1,error:!1}),(r=Object(d.c)(e,l,p.publisherPrefix))&&(yield D(i,a,e.logicalName,r))),s||r||a(i)}));return function(t,a){return e.apply(this,arguments)}}(),[D,R,p.publisherPrefix,null==t?void 0:t.properties.linkedEnvironmentMetadata]),getPublisherOptionsAsync:l.a.useCallback(b((function*(){k(v.PUBLISHERS);var e=Object(o.Y)(c.s,c.q.GetPublishers),t=[f],a=function(){var e=b((function*(){var e,a=yield null==i?void 0:i.fetchListView("Publisher","LookupView",{shouldShowFirstPartyPublisher:!0,shouldShowMicrosoftPublisher:!1,shouldShowReadOnlyPublisher:!1}),n=null!==(e=null==a?void 0:a.data)&&void 0!==e?e:[];t=n.map(e=>({text:e.friendlyname,key:e.publisherid})),S(t)}));return function(){return e.apply(this,arguments)}}();yield E(a,t=>{var a=Object(o.p)(t);e.completeWithError({error:a}),S([f])}),k(v.COMPLETE)})),[i]),getSolutionOptionsAsync:l.a.useCallback(b((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.e.PublisherId;k(v.SOLUTIONS);var t=Object(o.Y)(c.s,c.q.GetSolutions),a=[h],n=function(){var t=b((function*(){var t,n=yield null==i?void 0:i.fetchListView("Solution","UnmanagedSolutions",void 0,{filter:"_publisherid_value eq ".concat(e)}),r=null!==(t=null==n?void 0:n.data)&&void 0!==t?t:[];a=r.map(e=>({text:e.friendlyname,key:e.solutionid})),I(a)}));return function(){return t.apply(this,arguments)}}(),r=e=>{var a=Object(o.p)(e);t.completeWithError({error:a}),I([h])};yield E(n,r),k(v.COMPLETE)})),[i]),getTableOptionsAsync:l.a.useCallback(b((function*(){k(v.TABLES);var e=Object(o.Y)(c.s,c.q.GetTables),t=[],a=function(){var e=b((function*(){var e,a=yield null==i?void 0:i.fetchListView("Entity","All",{solutionId:c.f.SolutionId}),n=null!==(e=null==a?void 0:a.data)&&void 0!==e?e:[];t=Object(d.b)(n).map(e=>{var t,a,n,r,o,i;return{text:null!==(t=null===(a=e.DisplayName)||void 0===a||null===(n=a.LocalizedLabels[0])||void 0===n?void 0:n.Label)&&void 0!==t?t:e.LogicalName,key:e.LogicalName,data:{pluralDisplayName:null!==(r=null===(o=e.DisplayCollectionName)||void 0===o||null===(i=o.LocalizedLabels[0])||void 0===i?void 0:i.Label)&&void 0!==r?r:""}}}),j(t)}));return function(){return e.apply(this,arguments)}}();yield E(a,t=>{var a=Object(o.p)(t);e.completeWithError({error:a}),j([])}),k(v.COMPLETE)})),[i]),getColumnOptionsAsync:l.a.useCallback(function(){var e=b((function*(e){if(e===c.g)N([]);else{k(v.COLUMNS);var t=Object(o.Y)(c.s,c.q.GetColumns),a=function(){var t=b((function*(){var t,a=yield null==i?void 0:i.fetchExpandedEntity({entityName:e,entityId:"",solutionName:"",solutionId:""}),n=null!==(t=null==a?void 0:a.Attributes)&&void 0!==t?t:[],r=Object(d.b)(n).map(e=>{var t,a;return{text:null!==(t=null===(a=e.DisplayName.LocalizedLabels[0])||void 0===a?void 0:a.Label)&&void 0!==t?t:e.LogicalName,key:e.LogicalName,data:{dataType:Object(u.b)(e.AttributeType),isPrimary:e.IsPrimaryName}}});N(r)}));return function(){return t.apply(this,arguments)}}();yield E(a,e=>{var a=Object(o.p)(e);t.completeWithError({error:a}),N([])}),k(v.COMPLETE)}}));return function(t){return e.apply(this,arguments)}}(),[i])}};function E(e,t){return C.apply(this,arguments)}function C(){return(C=b((function*(e,t){try{return yield e()}catch(a){return t(a)}}))).apply(this,arguments)}},25144:function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"c",(function(){return p})),a.d(t,"b",(function(){return b}));var n=a(11883),r=a(17716),o=a(25125),i=a(20435);function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){s(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function u(e,t,a,l){return e.map(e=>function(e,t,a,l){var s={SchemaName:"".concat(Object(o.j)(e.logicalName,r.m.Dataverse.ColumnLogicalName,a)),DisplayName:m(e.name,t),IsPrimaryName:l};switch(e.dataType){case i.b.Date:return c(c({},s),{},{AttributeType:n.j.DateTime});case i.b.Number:return c(c({},s),{},{AttributeType:n.j.Integer});case i.b.Decimal:return c(c({},s),{},{AttributeType:n.j.Decimal});default:var u=c(c({},s),{},{AttributeType:n.j.String,MaxLength:100});return u.FormatName={Value:e.dataType===i.b.Email?n.J.Email:e.dataType===i.b.Phone?n.J.Phone:e.dataType===i.b.URL?n.J.Url:n.J.Text},u}}(e,t,a,e.id===(null==l?void 0:l.id)))}function d(e,t,a){var i=e.columnSchema.find(t=>t.id===e.primaryColumnId);if(e.logicalName&&i&&e.tableId===r.g)return{SchemaName:"".concat(Object(o.j)(e.logicalName,r.m.Dataverse.TableLogicalName,a)),DisplayName:m(e.name,t),DisplayCollectionName:m(e.pluralName,t),PrimaryNameAttribute:Object(o.j)(i.logicalName,r.m.Dataverse.ColumnLogicalName,a),OwnershipType:n.v.UserOwned,HasActivities:!1,HasNotes:!1,Attributes:u(e.columnSchema,t,a,i),IsMailMergeEnabled:{Value:!1},IsDuplicateDetectionEnabled:{Value:!1}}}function m(e,t){return{LocalizedLabels:[{Label:e.trim(),LanguageCode:t}]}}function p(e,t,a){var n=e.columnSchema.filter(e=>e.columnId===r.c);if(0!==n.length)return u(n,t,a)}function b(e){return e.sort((e,t)=>{var a,n,r,o,i,l,c=(null!==(a=null===(n=e.DisplayName)||void 0===n||null===(r=n.LocalizedLabels[0])||void 0===r?void 0:r.Label)&&void 0!==a?a:e.LogicalName).toUpperCase(),s=(null!==(o=null===(i=t.DisplayName)||void 0===i||null===(l=i.LocalizedLabels[0])||void 0===l?void 0:l.Label)&&void 0!==o?o:t.LogicalName).toUpperCase();return c.localeCompare(s)})}},25145:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(14958),r=a(10926),o=a.n(r),i=a(11205),l=a(25079),c=a(17716),s=a(25123),u=a(25125),d=a(25143),m=a(25130),p=a(25128),b=a(20437),g=a(14134);function v(e,t,a,n,r,o,i){try{var l=e[o](i),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}var f=(e,t,a,r,f,h,y)=>{var O,E,C=Object(i.i)(),{dispatch:S,state:x}=Object(p.c)(),[I,T]=o.a.useState(null!==(O=null==h?void 0:h("initTaggingControls"))&&void 0!==O&&O),[j,w]=o.a.useState(null!==(E=null==h?void 0:h("initTaggingColumns"))&&void 0!==E&&E),{currentExtractValue:N,input:P,createAppResponse:k,initializeControls:L,initializeColumns:D,userPrivileges:R}=e,A=Object(l.e)(f),z=o.a.useRef({step:0,subStep:-1});o.a.useEffect(()=>{I&&N&&N.identifiedControls&&(S({type:m.b.INITIALIZE_CONTROL_TAGGING,controls:N.identifiedControls,getAriaLabel:A}),T(!1),null==y||y("initTaggingControls",!1,!0))},[I,N,A,S,y]),o.a.useEffect(()=>{if(j&&N&&N.identifiedGroups&&N.identifiedControls){var{tableId:t,name:a,logicalName:n,pluralName:o}=e.tableInfo,i={tableId:t,name:a,logicalName:n,pluralName:o},l=Object(u.c)(r.columnOptions,r.envSolutionInfo.publisherPrefix);S({type:m.a.INITIALIZE_COLUMN_TAGGING,columns:N.identifiedGroups,controls:N.identifiedControls,name:N.outputName,getAriaLabel:A,tableInfo:i,existingColumns:l}),w(!1),null==y||y("initTaggingColumns",!1,!0)}},[j,N,A,e.tableInfo,S,r.columnOptions,r.envSolutionInfo.publisherPrefix,y]);var B=o.a.useCallback((function(a,o){var i,l,d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],m={};if(1===a)P&&(m.imageOption=(null===(i=P.sampleFile)||void 0===i?void 0:i.length)>0?P.sampleFile:"custom",m.imageMetadata=P.metadata,m.appFormat=null===(l=P.layoutFormat)||void 0===l?void 0:l.toString(),R||r.checkEnvironmentStatusAndPermissions());else if(2===a)if(o){if(0===o);else if(g.a.enableSelectExistingTable&&1===o)r.getTableOptionsAsync();else if(g.a.enableSelectExistingTable&&2===o||!g.a.enableSelectExistingTable&&1===o){var p;m.dataOption=null===(p=e.dataSelection)||void 0===p?void 0:p.toString(),m.dataStore=e.dataSelection===c.i.NewTable?"Dataverse":void 0,m.tableType="".concat(e.tableInfo.tableId===c.g?"new":"existing"," table"),!N||e.tableInfo.tableId&&e.tableInfo.tableId!==c.g||r.checkTableNameExists(Object(u.j)(N.outputName,c.m.Dataverse.TableLogicalName,r.envSolutionInfo.publisherPrefix))}}else m.controlCount=x.controls.length,m.controlTypes=[...new Set(x.controls.map(e=>e.tagName.toString()))],t({type:b.a.PROCESS_USER_DEFINED_CONTROLS,controls:x.controls});else if(3===a){m.columnsCount=x.tableInfo.columns.length;var v=x.tableInfo.columnSchema.length;m.columnSchemaCount=v;var f=x.tableInfo.columnSchema.filter(e=>e.columnId===c.c).length,h=v-f;m.newColumnSchemaCount=f,m.existingColumnSchemaCount=h,m.dataTypes=[...new Set(x.tableInfo.columnSchema.map(e=>e.dataType.toString()))],t({type:b.a.PROCESS_USER_DEFINED_COLUMNS,tableInfo:x.tableInfo,publisherPrefix:r.envSolutionInfo.publisherPrefix})}Object(s.d)(c.q.WizardAdvanceClick,d?a:z.current.step,d?null!=o?o:-1:z.current.subStep,m),t({type:b.a.SET_STEP_STATUS,step:void 0===o?a-1:a,subStep:void 0===o?-1:o-1,status:n.b.Valid}),z.current={step:a,subStep:null!=o?o:-1},null==y||y("wizardStepValue",{step:a,subStep:null!=o?o:0},!0)}),[r,N,t,P,y,e.dataSelection,e.tableInfo.tableId,x.controls,x.tableInfo,R]),M=o.a.useCallback((function(a,r){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i={};t({type:b.a.SET_STEP_STATUS,step:void 0===r?a+1:a,subStep:void 0===r?0:r,status:n.b.Empty}),o&&1===a&&t({type:b.a.RESET_SKIPPED_STEP_STATUS,currentStep:2,currentSubStep:0,resetStatus:n.b.Empty,isNewWizard:o,skip:!1,t:f,dataSelection:e.dataSelection}),Object(s.d)(c.q.WizardBackClick,o?a:z.current.step,o?null!=r?r:-1:z.current.subStep,i),a<=2&&1!==r&&e.tableNameConflict&&t({type:b.a.SET_TABLE_NAME_CONFLICT,hasConflict:!1}),z.current={step:a,subStep:null!=r?r:-1},null==y||y("wizardStepValue",{step:a,subStep:null!=r?r:0},!0)}),[t,y,e.dataSelection,e.tableNameConflict,f]);return{onAdvance:B,onCreate:o.a.useCallback(function(){var t,n=(t=function*(t,n){Object(s.d)(c.q.WizardCreateClick,null!=t?t:z.current.step,null!=n?n:z.current.subStep),N&&r.createTableWithAttributes(e.tableInfo,e=>a.createAppFromImage(N,e))},function(){var e=this,a=arguments;return new Promise((function(n,r){var o=t.apply(e,a);function i(e){v(o,n,r,i,l,"next",e)}function l(e){v(o,n,r,i,l,"throw",e)}i(void 0)}))});return function(e,t){return n.apply(this,arguments)}}(),[r,a,N,e.tableInfo]),navigateToApp:o.a.useCallback(()=>{var e,t=null==k?void 0:k.makerUrl;if(t){var a=null!==(e=new URL(t).searchParams.get("app-id"))&&void 0!==e?e:"";Object(s.e)(c.q.NavigateToApp,{appId:a});var n=t.replace(/^((http[s]?):)\/{2}([^:\/\s]+)/g,""),{location:r}=C;C.replace({pathname:r.pathname,search:r.search}),C.push(n)}},[null==k?void 0:k.makerUrl,C]),onBack:M,onClose:o.a.useCallback((e,t,a)=>{Object(s.d)(c.q.WizardCloseClick,null!=t?t:z.current.step,null!=a?a:z.current.subStep),C.goBack()},[C]),beforeAdvance:o.a.useCallback((e,t)=>{var n=void 0!==e?{step:e,subStep:null!=t?t:-1}:z.current;return P&&L&&n.step<2?(a.processImage({file:P.uploadFile,jsonParams:{appLayout:P.layoutFormat,appName:P.name}}),T(!0),null==y||y("initTaggingControls",!0,!0)):N&&D&&2===n.step&&(!g.a.enableSelectExistingTable&&-1===n.subStep||g.a.enableSelectExistingTable&&1===n.subStep)?(a.processControls(N),w(!0),null==y||y("initTaggingColumns",!0,!0)):g.a.enableSelectExistingTable&&N&&2===n.step&&1===n.subStep&&(w(!0),null==y||y("initTaggingColumns",!0,!0)),Promise.resolve(!0)},[a,N,D,L,P,y]),shouldBackProceed:o.a.useCallback((a,n)=>{var r=void 0!==a?{step:a,subStep:null!=n?n:-1}:z.current;return e.errorMessage===c.k.InvalidResponse&&(t({type:b.a.SET_SERVICE_RESPONSE_ERROR,errorMessage:void 0}),e.wizardComplete&&t({type:b.a.SET_WIZARD_COMPLETE_STATUS,isComplete:!1})),(1===r.step||2===r.step&&1===r.subStep)&&S({type:m.c.SET_IS_VALID,isValid:!0}),Promise.resolve(!0)},[t,e.errorMessage,e.wizardComplete,S]),disableAdvance:!e.canAdvance||e.loading||e.wizardComplete||2===z.current.step&&!R||!x.isValid||r.isLoadingPropertyOption!==d.a.COMPLETE}}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/581.eba9e5a7.chunk.js.map
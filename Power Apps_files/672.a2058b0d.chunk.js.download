/*! For license information please see 672.a2058b0d.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[672],{37883:function(e,t,a){"use strict";a.d(t,"c",(function(){return u})),a.d(t,"b",(function(){return d}));var n=a(10926),r=a(12313),o=a(37625),i=a(24029),l=a(11031),c=e=>{var{solutionUniqueName:t}=e,{data:a,isInitialLoading:n,isError:i,refetch:l}=Object(r.a)({enabled:!!t,queryKey:[t,"entity-schema-names"],queryFn:()=>Object(o.a)(t)});return{data:a,isInitialLoading:n,isError:i,refetch:l}},s=e=>{for(var{schemaNames:t,tableName:a,customizationPrefix:n}=e,r=Object(i.g)(n,a.toLowerCase()),o=new Set(t),l=1,c=r;o.has(c);)c=r+l,l++;return c},u=e=>c(e),d=e=>{var{schemaName:t,solutionUniqueName:a}=e,{data:r,isInitialLoading:o}=c({solutionUniqueName:a});return{isLoading:o,isUniqueSchemaName:Object(n.useMemo)(()=>{if(!r)return!0;var e=null==t?void 0:t.toLowerCase();return!!t&&(null==r?void 0:r.every(t=>t!==e))},[r,t])}};t.a=e=>{var{newTableName:t,solutionUniqueName:a,customizationPrefix:r}=e,[o,u]=Object(n.useState)(""),{data:d,isInitialLoading:p,isError:m}=c({solutionUniqueName:a}),b=Object(n.useMemo)(()=>Object(l.a)(),[]);if(t&&d&&r&&!p){Object(i.f)(t,!1)||(t=b);var f=s({schemaNames:d,customizationPrefix:r,tableName:t});f!==o&&u(f)}else m&&t&&r&&!o&&u(s({schemaNames:[],customizationPrefix:r,tableName:t}));return{isInitialLoading:p,uniqueSchemaName:o}}},37884:function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n=a(11932),r=a(11934),o=a(10929),i=a(12353),l=a(10926),c=a.n(l),s=a(37885),u=a(37886),d=a(12945),p=a(37887),m=a(37888),b=a(37889),f=a(37890),v=a(37891),g=a(37892);function h(){return(h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function y(e,t,a,n,r,o,i){try{var l=e[o](i),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){S(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function S(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var E=(e,t)=>{switch(t.type){case"NAVIGATE":return C(C({},e),{},{currentStep:t.payload.step,currentButtons:t.payload.buttons,stepKeys:t.payload.stepKeys});case"UPDATE_BUTTONS":return C(C({},e),{},{currentButtons:t.payload});case"UPDATE_CONTAINER_WIDTH":return C(C({},e),{},{containerWidth:t.payload});case"UPDATE_IS_EXECUTING":return C(C({},e),{},{isExecuting:t.payload});case"ADD_MESSAGE_BAR":var a=e.messageBars.filter(e=>(e.key||"")!==(t.payload.key||"")),n={message:t.payload.message,type:t.payload.type,props:t.payload.props,key:t.payload.key};return C(C({},e),{},{messageBars:[...a,n]});case"UPDATE_STEP_KEYS":return C(C({},e),{},{stepKeys:t.payload});case"UPDATE_CURRENT_STEP":return C(C({},e),{},{currentStep:C({},t.payload)});case"CLEAR_MESSAGE_BARS":return C(C({},e),{},{messageBars:[]});case"REMOVE_MESSAGE_BAR":return C(C({},e),{},{messageBars:e.messageBars.filter(e=>e!==t.payload)});case"UPDATE_NAVIGATION_WARNING_VISIBLE":return C(C({},e),{},{isNavigationWarningVisible:t.payload});case"UPDATE_ON_BEFORE_CANCEL":return C(C({},e),{},{onBeforeCancel:t.payload});default:return e}};function j(e){var t,a,{defaultReflowWidth:O,strings:S,initialData:j,styles:T,theme:w,onLogEvent:x,storeNavigationInMemory:k,onRenderNearLeftFooterButton:P}=e,[{currentButtons:N,isExecuting:F,messageBars:D,containerWidth:I,stepKeys:L,currentStep:A,isNavigationWarningVisible:B,onBeforeCancel:R},M]=Object(l.useReducer)(E,{currentButtons:Object(i.cloneDeep)(e.buttons),isExecuting:!1,messageBars:[],containerWidth:void 0,stepKeys:{currentStepKey:e.defaultStepKey},currentStep:void 0,isNavigationWarningVisible:!1,onBeforeCancel:void 0}),{gotoNewLocation:z,unblockCallback:W,isWarningOnNavigate:_,setIsWarningOnNavigate:U,updateHistory:H,completeWizard:K,currentStepKey:V}=Object(g.a)(t=>{if(t&&G.current&&G.current.key!==t){var a=oe(t);a||(X({message:u.d.InvalidStepKey,data:{stepKey:t}},!1),a=oe(e.defaultStepKey))?ae(a):X({message:u.d.InvalidDefaultStepKey,data:{stepKey:e.defaultStepKey}},!0)}},(e,t)=>{t&&e&&M({type:"UPDATE_NAVIGATION_WARNING_VISIBLE",payload:!0})},k,e.defaultStepKey),q=Object(l.useRef)(null),G=Object(l.useRef)(),Z=Object(l.useRef)(),Q=Object(l.useRef)(),Y=Object(l.useRef)(void 0),$=(e,t)=>{null==x||x({type:e,timestamp:new Date,data:t})},X=(e,t)=>{if(null==x||x({type:u.e.Error,timestamp:new Date,data:C({message:e.message},e.data)}),t)throw new Error(e.message)},J=()=>{M({type:"CLEAR_MESSAGE_BARS"})},ee=()=>{U(!1),M({type:"UPDATE_NAVIGATION_WARNING_VISIBLE",payload:!1})},te=(t,a)=>{var n=e.steps.find(e=>e.key===t);n?(_&&(Q.current=n,M({type:"UPDATE_NAVIGATION_WARNING_VISIBLE",payload:!0})),a&&ae(n,!0),H(t,a)):X({message:u.d.InvalidStepKey,data:{stepKey:t}},!1)},ae=(t,a)=>{var n,r=a&&!t.backStepKey?void 0:null!==(n=t.backStepKey)&&void 0!==n?n:null==L?void 0:L.currentStepKey,o=(t=>{var a,n=Object(i.cloneDeep)(e.buttons);return null===(a=t.buttonStates)||void 0===a||a.forEach(e=>{var t=n.find(t=>t.type===e.type);t&&Object.assign(t,e.state)}),n})(t);M({type:"NAVIGATE",payload:{buttons:o,step:t,stepKeys:{backStepKey:r,currentStepKey:t.key,nextStepKey:t.nextStepKey}}}),J(),ee(),M({type:"UPDATE_ON_BEFORE_CANCEL",payload:void 0}),a?$(u.e.Start,{from:t.key}):($(u.e.Navigation,{from:r,to:t.key,lastClicked:Y.current}),Y.current=void 0)},ne=W,re=c.a.useRef(j),oe=(t,a)=>{var n=e.steps.find(e=>e.key.toLowerCase()===(null==t?void 0:t.toLowerCase()));return!n&&a?oe(a):n};if(Object(l.useEffect)(()=>{if(t=e.steps,new Set(t.map(e=>e.key)).size<t.length)X({message:u.d.DuplicateStepKeys},!0);else{var t,a=oe(V,e.defaultStepKey);if(a)return te(a.key,!0),()=>{var e;$(u.e.End,{at:null===(e=G.current)||void 0===e?void 0:e.key}),null==W||W()};X({message:u.d.InvalidDefaultStepKey,data:{currentStepKey:V,defaultStepKey:e.defaultStepKey}},!0)}},[]),Object(l.useEffect)(()=>{G.current=A},[A]),Object(l.useEffect)(()=>{if(!q.current)return()=>{};var e=new d.a(()=>{var e;M({type:"UPDATE_CONTAINER_WIDTH",payload:null===(e=q.current)||void 0===e?void 0:e.clientWidth})});return e.observe(q.current),()=>{e.disconnect()}},[q.current]),!A)return null;var ie=()=>c.a.createElement(c.a.Fragment,null,D.map((e,t)=>{var a,o,i=null!==(a=e.key)&&void 0!==a?a:"messagebar-".concat(t);return c.a.createElement(n.a,h({key:i,"data-testid":i,className:de.messageBar,messageBarType:null!==(o=e.type)&&void 0!==o?o:r.a.info,onDismiss:()=>{M({type:"REMOVE_MESSAGE_BAR",payload:e})},dismissButtonAriaLabel:null==S?void 0:S.messageBarDismissButtonAriaLabel},e.props),e.message)})),le={getValue:e=>{var t;return null===(t=re.current)||void 0===t?void 0:t[e]},setValue:(e,t,a)=>{var n;return!(null!==(n=re.current)&&void 0!==n&&n.hasOwnProperty(e)&&!a)&&(re.current=C(C({},re.current),{},{[e]:t}),!0)},getStepKeys:()=>L,executeAsync:function(){var e,t=(e=function*(e){return M({type:"UPDATE_IS_EXECUTING",payload:!0}),yield e().finally(()=>{M({type:"UPDATE_IS_EXECUTING",payload:!1})})},function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function i(e){y(o,n,r,i,l,"next",e)}function l(e){y(o,n,r,i,l,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}(),navigateToStep:te,setNextStep:e=>{M({type:"UPDATE_STEP_KEYS",payload:C(C({},null!=L?L:{}),{},{nextStepKey:e})})},showMessage:(e,t,a,n)=>{M({type:"ADD_MESSAGE_BAR",payload:{message:e,type:t,props:a,key:n}})},updateFooterButton:(e,t)=>{var a=[...N],n=a.find(t=>t.type===e);n&&(n=Object.assign(n,t)),M({type:"UPDATE_BUTTONS",payload:a})},setContent:(e,t)=>{if(A){var a=C({},A);e===u.a.Left?a.leftContent=t:a.rightContent=t,M({type:"UPDATE_CURRENT_STEP",payload:a})}},clearMessage:e=>{var t=D.find(t=>t.key===e);t&&M({type:"REMOVE_MESSAGE_BAR",payload:t})},clearMessages:J,setWarnOnNavigate:(e,t)=>{ee(),U(e),Z.current=t},warnOnNavigate:ne,isMessageShown:e=>!!e&&D.some(t=>t.key===e),setOnBeforeCancel:e=>{M({type:"UPDATE_ON_BEFORE_CANCEL",payload:e})},isWarningOnNavigate:_},ce=null!==(t=null!==(a=A.reflowWidth)&&void 0!==a?a:O)&&void 0!==t?t:1024,se=void 0!==I&&void 0!==A.leftContent&&I<ce,ue=!!A.isFullScreen,de=Object(o.db)(Object(f.a)({theme:w,isStacked:se,isFullScreen:ue,containerWidth:I,reflowHeight:A.reflowHeight}),T),pe={classNames:de,currentButtons:N,currentStep:A,isExecuting:F,stepKeys:L,onButtonClick:(t,a)=>{var n,r,o,i;switch(Y.current=t.type,t.type){case u.c.Back:t.onClick?t.onClick(a):te(null!==(n=L.backStepKey)&&void 0!==n?n:e.defaultStepKey);break;case u.c.Next:t.onClick?t.onClick(a):te(null!==(r=L.nextStepKey)&&void 0!==r?r:e.defaultStepKey);break;case u.c.Cancel:var l;if(!R||!0===R())$(u.e.Cancel,{at:null==A?void 0:A.key}),t.onClick?t.onClick(a):null===(l=e.onCancel)||void 0===l||l.call(e);break;case u.c.Complete:K(),$(u.e.Complete,{at:null==A?void 0:A.key}),t.onClick?t.onClick(a):null===(o=e.onComplete)||void 0===o||o.call(e,re.current);break;case u.c.Close:$(u.e.Close,{at:null==A?void 0:A.key}),t.onClick?t.onClick(a):null===(i=e.onClose)||void 0===i||i.call(e,re.current)}},onRenderNearLeftFooterButton:P},me={classNames:de,currentStep:A,footerProps:pe,isStacked:se,strings:S,getMessageBars:ie};return c.a.createElement(s.a,{value:le},c.a.createElement("section",{className:de.wizardContainer,ref:q,role:"main"},B&&Z.current&&c.a.createElement(v.a,{content:Z.current,onConfirm:()=>{null==W||W(),$(u.e.ConfirmNavigation,{to:Q.current}),Q.current?(ae(Q.current),Q.current=void 0):(ee(),z())},onCancel:()=>{$(u.e.CancelNavigation,{to:Q.current}),M({type:"UPDATE_NAVIGATION_WARNING_VISIBLE",payload:!1}),Q.current=void 0}}),!ue&&c.a.createElement(m.a,{classNames:de,title:A.title||""}),se&&ie(),c.a.createElement(b.a,me),se&&!ue&&c.a.createElement(p.a,pe)))}},37885:function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c}));var n=a(12353),r=a(10926),o=Object(r.createContext)({getValue:n.noop,setValue:n.noop,executeAsync:n.noop,getStepKeys:n.noop,navigateToStep:n.noop,setNextStep:n.noop,showMessage:n.noop,updateFooterButton:n.noop,setContent:n.noop,clearMessages:n.noop,setWarnOnNavigate:n.noop,warnOnNavigate:n.noop,isMessageShown:n.noop,setOnBeforeCancel:n.noop,isWarningOnNavigate:!1});function i(){var{getValue:e,setValue:t}=Object(r.useContext)(o);return{getValue:e,setValue:t}}var l=()=>{var{getStepKeys:e,executeAsync:t,navigateToStep:a,setNextStep:n,showMessage:i,updateFooterButton:l,setContent:c,clearMessage:s,clearMessages:u,setWarnOnNavigate:d,warnOnNavigate:p,isMessageShown:m,setOnBeforeCancel:b,isWarningOnNavigate:f}=Object(r.useContext)(o);return{getStepKeys:e,executeAsync:t,navigateToStep:a,setNextStep:n,showMessage:i,updateFooterButton:l,setContent:c,clearMessage:s,clearMessages:u,setWarnOnNavigate:d,warnOnNavigate:p,isMessageShown:m,setOnBeforeCancel:b,isWarningOnNavigate:f}},c=o.Provider},37886:function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"b",(function(){return r})),a.d(t,"e",(function(){return o})),a.d(t,"d",(function(){return i})),a.d(t,"a",(function(){return l}));var n=function(e){return e.Cancel="Cancel",e.Close="Close",e.Back="Back",e.Next="Next",e.Complete="Complete",e}({}),r=function(e){return e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e}({}),o=function(e){return e.Cancel="cancel",e.Close="close",e.Complete="complete",e.Error="error",e.Navigation="navigation",e.Start="start",e.End="end",e.ConfirmNavigation="confirmNavigation",e.CancelNavigation="cancelNavigation",e}({}),i=function(e){return e.InvalidDefaultStepKey="Invalid step key specified, wizard cannot initialize.",e.InvalidStepKey="Invalid step key specified, going to default step.",e.DuplicateStepKeys="Duplicate step keys found, wizard cannot initialize.",e}({}),l=function(e){return e.Left="left",e.Right="right",e}({})},37887:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(11823),r=a(11824),o=a(10926),i=a.n(o),l=a(37886),c=e=>{var{classNames:t,currentButtons:a,currentStep:o,isExecuting:c,onButtonClick:s,onRenderNearLeftFooterButton:u,stepKeys:d}=e,p=e=>a.filter(t=>{var a;return(null!==(a=t.alignment)&&void 0!==a?a:l.b.Left)===e}).map((e,a)=>((e,a)=>{if(e.isHidden)return null;var u={disabled:c||!1===e.isEnabled||e.type===l.c.Back&&(!d.backStepKey||o.backStepKey===o.key)&&!e.onClick||e.type===l.c.Next&&(!d.nextStepKey||o.nextStepKey===o.key)&&!e.onClick,onClick:t=>s(e,t),className:t.footerButton,text:e.label,ariaLabel:e.label};return i.a.createElement(i.a.Fragment,{key:"footer-button-".concat(a)},e.isPrimary?i.a.createElement(n.a,u):i.a.createElement(r.a,u))})(e,a));return i.a.createElement("footer",{className:t.footer},i.a.createElement("div",{className:t.leftFooterButton},p(l.b.Left),u&&u()),i.a.createElement("div",null,p(l.b.Center)),i.a.createElement("div",null,p(l.b.Right)))}},37888:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(10926),r=a.n(n),o=e=>{var{classNames:t,title:a,headerNavContent:n}=e,o="string"==typeof a?()=>r.a.createElement("h1",null,a):a;return r.a.createElement("header",{className:t.header},r.a.createElement("div",{className:t.headerTitleContainer},r.a.createElement(o,null)),n&&r.a.createElement("div",{className:t.headerNavContainer},n()))}},37889:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(10926),r=a.n(n),o=a(12372),i=a(37887),l=a(11666),c=a(12353),s=a(12709),u=e=>{var t,{classNames:a,isStacked:u,currentStep:d,strings:p,footerProps:m,getMessageBars:b}=e,[f,v]=Object(n.useState)(!0),{isFullScreen:g,leftContent:h,rightContent:y}=d,O=Object(c.isUndefined)(h)?()=>r.a.createElement(r.a.Fragment,null):"string"==typeof h?()=>r.a.createElement("div",null,h):h,C="string"==typeof y?()=>r.a.createElement("div",null,y):y;return r.a.createElement("section",{className:a.contentSection},h&&!g&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"".concat(a.leftContainer).concat(u?" stacked":"")},(!u||!f)&&r.a.createElement("div",{className:a.leftContent},r.a.createElement(O,null),r.a.createElement(s.a,{message:null!==(t=d.onStepLoadedAriaLabel)&&void 0!==t?t:"","aria-live":"assertive"}))),r.a.createElement("div",null,u&&r.a.createElement(o.a,{ariaLabel:f?null==p?void 0:p.expandAriaLabel:null==p?void 0:p.collapseAriaLabel,"data-test-id":f?null==p?void 0:p.expandAriaLabel:null==p?void 0:p.collapseAriaLabel,"aria-expanded":!f,onClick:()=>v(!f),className:a.collapseButton},r.a.createElement(l.a,{iconName:f?"ChevronDown":"ChevronUp"})))),r.a.createElement("div",{className:"".concat(a.rightContainer).concat(u?" stacked":"").concat(g?" fullscreen":"")},!u&&b(),r.a.createElement("div",{className:a.rightContent,"data-test-id":"DocumentCard"},r.a.createElement(C,null)),!u&&!g&&r.a.createElement(i.a,m)))}},37890:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(10929);function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l=e=>{var{isStacked:t,isFullScreen:a,containerWidth:r,reflowHeight:i=480}=e,l=void 0!==r&&r<=1500?"400px":"460px",c="@media (min-height: ".concat(i,"px)"),s="@media screen and (max-width: ".concat(n.u,"px)");return Object(n.db)({wizardContainer:{display:"flex",flexDirection:"column",flex:1,height:"100%",width:"100%"},header:{width:"100%",minHeight:"72px",borderBottom:"solid 1px #e1dfdd",display:"flex",flexDirection:"row",alignItems:"center"},headerTitleContainer:{marginLeft:"32px",flex:1,selectors:{h1:{fontSize:n.k.size20,fontWeight:n.l.semibold}}},headerNavContainer:{display:"flex",flex:1,justifyContent:"flex-end",marginRight:"24px"},messageBar:{minHeight:"unset",selectors:{".ms-MessageBar-text":{[s]:{margin:4}},".ms-MessageBar-icon":{margin:"7px 0 8px 12px",[s]:{margin:"7px 0 0 3px"}},".ms-Button":{height:"auto",wordBreak:"normal",padding:4,[s]:{padding:2}},".ms-Button.ms-Button--icon":{height:24}}},contentSection:{display:"flex",[c]:{overflow:"auto"},flex:1,flexDirection:t?"column":"row"},leftContainer:o({userSelect:"none"},t?{width:"100%",borderRight:"unset",borderBottom:"solid 1px #e1dfdd"}:{borderRight:"solid 1px #e1dfdd",width:l}),leftContent:{padding:"24px",height:"100%"},collapseButton:{backgroundColor:"#f3f2f1",display:"block",width:"100%",minHeight:"20px",height:"20px",selectors:{span:{justifyContent:"center"}}},rightContainer:{display:"flex",flexDirection:"column",flex:1,maxWidth:t||a?"100vw":"calc(100vw - ".concat(l,")"),maxHeight:t?"calc(100% - 21px)":"inherit"},rightContent:{userSelect:"none",overflow:t?"unset":"auto",flex:1,padding:"24px",height:"100%"},footer:{borderTop:"solid 1px #e1dfdd",userSelect:"none",width:"100%",minHeight:"64px",padding:16,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},footerButton:{minWidth:"70px",minHeight:"32px","+ button":{marginLeft:8}}})}},37891:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(11629),r=a(11624),o=a(11708),i=a(11823),l=a(11824),c=a(10926),s=a.n(c),u=e=>{var{content:t,onConfirm:a,onCancel:c}=e,u={showCloseButton:!1,type:n.a.normal,title:t.title,subText:t.subText};return s.a.createElement(r.a,{hidden:!1,maxWidth:560,styles:{main:{minHeight:156}},dialogContentProps:u},s.a.createElement(o.a,null,s.a.createElement(i.a,{onClick:c,text:t.cancelButtonLabel}),s.a.createElement(l.a,{onClick:a,text:t.confirmButtonLabel})))}},37892:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(12353),r=a(10926),o=a(11205),i=e=>{e.preventDefault(),e.returnValue=""},l=(e,t,a,l)=>{var c=Object(o.i)(),{pathname:s,search:u,hash:d}=Object(o.j)(),[p,m]=Object(r.useState)(l),b=Object(r.useRef)(null),f=Object(r.useRef)(n.noop),v=Object(r.useRef)(!1),g=Object(r.useRef)(),h=Object(r.useRef)();g.current=e,h.current=t;return Object(r.useEffect)(()=>{a&&g.current&&g.current(p)},[p]),Object(r.useEffect)(()=>{if(!a){var e=c.listen(e=>{g.current&&g.current(e.hash.slice(1))});return()=>{e()}}},[]),Object(r.useEffect)(()=>{var e=c.block(e=>(h.current&&(h.current(e,v.current),b.current=e),!v.current&&void 0));return()=>{e()}},[]),{currentStepKey:a?p:null==d?void 0:d.slice(1),gotoNewLocation:()=>{var e;b.current&&(m(null===(e=b.current.hash)||void 0===e?void 0:e.slice(1)),c.push(b.current))},updateHistory:(e,t)=>{m(e),a||(t||d.slice(1)===e?c.replace("".concat(u,"#").concat(e)):c.push("".concat(u,"#").concat(e)))},isWarningOnNavigate:v.current,setIsWarningOnNavigate:e=>{v.current=e,e?window.addEventListener("beforeunload",i):window.removeEventListener("beforeunload",i)},unblockCallback:f.current,completeWizard:()=>{var e="".concat(s).concat(u);v.current=!1,m(void 0),a||c.replace(e)}}}},37893:function(e,t,a){"use strict";a.d(t,"k",(function(){return o})),a.d(t,"j",(function(){return i})),a.d(t,"i",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"c",(function(){return m})),a.d(t,"a",(function(){return b})),a.d(t,"g",(function(){return f})),a.d(t,"h",(function(){return v})),a.d(t,"f",(function(){return g})),a.d(t,"b",(function(){return h}));var n=a(12217),r=a(11021),o="CreateAppWizard",i=n.h,l=(e,t)=>{Object(r.W)(i,{eventName:e,eventData:t})},c=(e,t)=>{Object(r.U)(i,{eventName:e,eventData:t})},s=(e,t)=>{Object(r.fb)(i,e,t)},u={createTableSendMessage:e=>l("CreateTable/SendMessage",e),createTableCreateAppSuccess:e=>l("CreateTable/CreateApp/Success",e),createTableResetSession:e=>s("CreateTable/ResetSession/Reset",e),createTableDismissResetSession:e=>s("CreateTable/ResetSession/Dismiss",e),createTableGenerationFailure:e=>l("CreateTable/BotResponse/TableGenerationFailed",e),createTableCreateAppFailure:e=>c("CreateTable/CreateApp/Failure",e),createAppWizard:(e,t)=>l("CreateAppWizard/".concat(e),t),devEnvDialogDismiss:e=>l("devEnvDialog/Dismiss",e),devEnvDialogConfirm:e=>l("devEnvDialog/Confirm",e),createTableBotResponseSuccess:e=>l("CreateTable/BotResponse/Success",e),createTableBotResponseWarning:e=>l("CreateTable/BotResponse/Warning",e),createTableBotResponseFailure:e=>c("CreateTable/BotResponse/Failure",e),createTableInappropriateContent:e=>c("CreateTable/BotResponse/InappropriateContent",e),createTableRedirectTableHub:e=>l("CreateTable/RedirectToTableHub",e),createTableRedirectCreateApp:e=>l("CreateTable/RedirectToCreateApp",e)},d={loadingDataFromExcel:e=>l("CreateTableFromExcel/UploadFileAndGetInferenceData/Loading",e),columnSchemaNameChanged:e=>l("CreateTableFromExcel/UpdateGrid/columnSchemaNameChanged",e),noPrimaryColumn:e=>l("CreateTableFromExcel/GetInferenceData/noPrimaryColumn",e),errorFromExcel:e=>c("CreateTableFromExcel/UploadFileAndGetInferenceData/error",e),hasInferenceDataFromExcel:e=>l("CreateTableFromExcel/GetInferenceData/HasData",e),toggleFirstRowAsColumnHeaders:e=>l("CreateTableFromExcel/Grid/toggleFirstRowAsColumnHeaders",e),removeDefaultPrimaryColumnIfUpdated:e=>l("CreateTableFromExcel/Grid/removeDefaultPrimaryColumnIfUpdated",e),getFirstHeaderMapping:e=>l("CreateTableFromExcel/Grid/getFirstHeaderMapping",e),getAttributesBasedOnFirstRowData:e=>l("CreateTableFromExcel/Grid/getAttributesBasedOnFirstRowData",e),hasColumSchemaNameChanged:e=>l("CreateTableFromExcel/Grid/hasColumSchemaNameChanged",e),createTableInitiate:e=>l("CreateTableFromExcel/CreateTable/Initiate",e),createTableError:e=>c("CreateTableFromExcel/CreateTable/Error",e),createTableLoading:()=>l("CreateTableFromExcel/CreateTable/Loading"),createTable:e=>l("CreateTableFromExcel/CreateTable/Success",e),goBack:()=>l("CreateTableFromExcel/GoBack")},p={createTableFromConnectorDataFulfilled:e=>l("CreateTableFromConnector/CreateTableFromConnectorDataFulfilled",e),createTableInitiate:e=>l("CreateTableFromConnector/CreateTable/Initiate",e),createTableError:e=>c("CreateTableFromConnector/CreateTable/Error",e),createTableLoading:()=>l("CreateTableFromConnector/CreateTable/Loading"),createTable:e=>l("CreateTableFromConnector/CreateTable/Success",e),hasPreviewData:e=>l("CreateTableFromConnector/GetPreviewData/HasData",e),errorFromInference:e=>c("CreateTableFromConnector/InferenceData/Error",e),loadingDataFromInference:e=>l("CreateTableFromConnector/InferenceData/Loading",e),errorUpdatingData:e=>c("CreateTableFromConnector/InferenceData/ErrorUpdatingData",e),columnSchemaNameChanged:e=>l("CreateTableFromConnector/UpdateGrid/columnSchemaNameChanged",e),hasColumSchemaNameChanged:e=>l("CreateTableFromConnector/Grid/hasColumSchemaNameChanged",e)},m={tableSelected:e=>l("CreateAppFromExistingTable/TableSelected",e),redirectToCreateApp:e=>l("CreateAppFromExistingTable/RedirectToCreateApp",e)},b={AFDTileSelected:e=>l("AFDAppTemplateSelection/AFDTileSelected",e),TemplateTileSelected:e=>l("AFDAppTemplateSelection/TemplateTileSelected",e),TemplateFetchError:e=>c("AFDAppTemplateSelection/TemplateFetchError",e)},f={TileSelected:e=>l("LayoutTemplateSelection/TileSelected",e),TooltipClicked:e=>l("LayoutTemplateSelection/TooltipToggled",e),TooltipLinkClicked:e=>l("LayoutTemplateSelection/TooltipLinkClicked",e),FilterSelectionChanged:e=>l("LayoutTemplateSelection/FilterSelectionChanged",e)},v={TileSelected:e=>l("StartWithData/TileSelected",e),CommandSelected:e=>l("StartWithData/CommandSelected",e)},g={checkCompleted:e=>l("EnvironmentAccessCheck/CheckCompleted",e),actionClicked:e=>l("EnvironmentAccessCheck/ActionClicked",e)},h={AppNameChanged:e=>l("AppTemplateConfiguration/AppNameChange",e),ValidateAppName:e=>l("AppTemplateConfiguration/ValidateAppName",e),ValidateAppNameError:e=>l("AppTemplateConfiguration/ValidateAppNameError",e),RedirectToAFDTemplateSelection:e=>l("AppTemplateConfiguration/RedirectToAFDTemplateSelection",e),CustomizeAndCreateFromAppTemplate:e=>l("AppTemplateConfiguration/CustomizeAndCreateFromAppTemplate",e),PreviewAppFromAppTemplate:e=>l("AppTemplateConfiguration/PreviewAppFromAppTemplate",e),FormFactorSelectionChange:e=>l("AppTemplateConfiguration/FormFactorSelectionChange",e),ModelAppDesignerTargetChanged:e=>l("AppTemplateConfiguration/ModelAppDesignerTargetChanged",e),ToggleSampleAppTagCallout:e=>l("AppTemplateConfiguration/ToggleSampleAppTagCallout",e),LearnMoreLinkClick:e=>l("AppTemplateConfiguration/ToggleSampleAppTagCallout/LearnMoreLinkClick",e)}},37894:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c}));var n=a(10929),r=a(37895),o=a.n(r),i=a(24423);function l(){return{wizardContainer:{selectors:{".ms-MessageBar-text":{margin:"4px 8px"},".ms-MessageBar-innerText":{width:"100%",lineHeight:"20px",selectors:{button:{marginLeft:20,height:"auto",[i.a.smallDown]:{marginLeft:5}}}}}},leftContainer:{background:"url(".concat(o.a,") no-repeat center bottom/100% border-box"),selectors:{"&.stacked":{backgroundImage:"unset"}}},rightContent:{selectors:{"::-webkit-scrollbar":{width:6,height:4},"::-webkit-scrollbar-track":{},"::-webkit-scrollbar-thumb":{backgroundColor:Object(n.Y)().palette.blackTranslucent40,borderRadius:7},[n.m]:{"::-webkit-scrollbar-thumb":{backgroundColor:"Scrollbar"}}}}}}var c=Object(n.db)(l())},37895:function(e,t,a){e.exports=a.p+"static/media/wizardleftpane.15232ff2.svg"},37897:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));var n=function(e){return e.Dataverse="dataverse",e.SharePoint="sharepoint",e.Excel="excel",e.SQL="sql",e}({}),r=function(e){return e.MobileThreeScreen="MobileThreeScreen",e.ResponsiveSingleScreen="ResponsiveSingleScreen",e}({})},37898:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return c}));var n=a(37886),r=a(37897),o=a(22590),i=new Map([[r.a.SharePoint,o.a.ConnectionsSharepoint],[r.a.SQL,o.a.ConnectionsSqlServer],[r.a.Excel,o.a.ConnectionsExcelOnlineBusiness],[r.a.Dataverse,o.a.ConnectionsMicrosoftDataverse]]),l={endpoint:e=>"https://aibtext/v1.0/".concat(e,"/appintelligence/chat"),scenarios:{DataverseTable:"DataverseTable",NL2Table:"NL2Table"}},c=[{type:n.c.Next,state:{isHidden:!0}},{type:n.c.Complete,state:{isHidden:!1}}]},37909:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=function(e){return e.NoDataverse="NoDataverse",e.NoDataAccess="NoDataAccess",e.DefaultEnvironmentForbidden="DefaultEnvironmentForbidden",e.NoPremiumLicense="NoPremiumLicense",e.SampleAppsNotInstalled="SampleAppsNotInstalled",e.DependenciesNotInstalled="DependenciesNotInstalled",e.DisabledByAdministrator="DisabledByAdministrator",e.CreateAppsForbidden="CreateAppsForbidden",e.CreateDatabaseForbidden="CreateDatabaseForbidden",e}({})},37914:function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return s})),a.d(t,"d",(function(){return u}));var n=a(21987),r=a(14364),o=a(12349),i=a(22589),l=(e,t)=>{var a,r,o=null===(a=e.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.error;switch(null==o?void 0:o.code){case n.a.SchemaNameIsNotUnique:return t("common.errors.tableNameNotUniqueError");case n.a.CannotStartAnotherOperation:return t("common.errors.cannotStartAnotherOperation");default:return(null==o?void 0:o.message)||t("common.errors.genericError")}},c=(e,t,a)=>{var n=a?window.location.search:"";return"/environments/".concat(e,"/createWizard").concat(n,"#").concat(t)},s=(e,t,a)=>{var n=a?Object(o.e)(window.location.search,[i.b,i.a]):"";return"".concat(r.d.entities.replace(":environmentName",e),"/").concat(t).concat(n)},u=(e,t)=>{if(t)return e("common.disabledCardTooltips.".concat(t))}},37917:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"e",(function(){return p})),a.d(t,"b",(function(){return m})),a.d(t,"f",(function(){return f}));var n=a(11465),r=a(10926),o=a.n(r),i=a(18854),l=a(37893),c=a(37918),s=()=>{var{t:e}=Object(n.t)(l.k);return o.a.createElement("h1",null,e("common.stepTitles.createAnApp"))},u=()=>{var{t:e}=Object(n.t)(l.k);return o.a.createElement("h1",null,e("common.stepTitles.createNewTable"))},d=()=>{var e=Object(c.a)();return o.a.createElement(o.a.Fragment,null,e?f():b())},p=()=>Object(c.a)()?(()=>{var{t:e}=Object(n.t)(l.k);return o.a.createElement("h1",null,e("common.stepTitles.createATable"))})():s(),m=()=>o.a.createElement(p,null),b=()=>{var{t:e}=Object(n.t)(l.k),t=e("common.stepTitles.createAnApp");return o.a.createElement(i.a,{title:t})},f=()=>{var{t:e}=Object(n.t)(l.k),t=e("common.stepTitles.createATable");return o.a.createElement(i.a,{title:t})}},37918:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(11205),r=a(22590),o=a(12349),i=a(22589),l=e=>{var t=Object(n.j)(),a=Object(o.h)(t.search);return e||a[i.b]===r.b.TablesPage}},37922:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(20494),r=a(10926),o=a(17441),i=a(20030),l=a(14084),c=a(11853),s=a(12219),u=a(37923),d=a(20490),p=()=>{var e=Object(n.b)(),t=Object(r.useContext)(o.a),{currentEnvironment:a}=Object(s.W)(),{result:p,loading:m}=Object(i.a)([l.DefaultRoleTemplates.SystemAdministrator,l.DefaultRoleTemplates.SystemCustomizer],!e.hasCDSDatabaseInCurrentEnvironment),{expressDesignDisabled:b}=Object(u.a)(),f=!m&&void 0!==a&&Object(c.J)(a)&&e.hideModelDrivenMakerUxForDefault&&!p,v=void 0!==a&&!Object(c.j)(a),g=void 0!==a&&Object(c.I)(a),h=void 0!==a&&!Object(c.k)(a),{enableNLTableCreation:y}=Object(d.a)();return{isLoading:e.loading||m||g||void 0===y,isDataverse:e.hasCDSDatabaseInCurrentEnvironment,isDataAccessEnabled:e.hasDataAccessInCurrentEnvironment,isPremiumPlan:t.currentPlansMetaData.doesUserHaveActivePremiumPlan,isExpressDesignDisabled:b,isModelDrivenAppsForbidden:f,isCreatingAppsForbidden:v,isCreatingDatabaseForbidden:h,isNLTableCreationEnabled:y}}},37923:function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n=a(20390),r=a(37924),o=a(25077),i=a(25081),l=a(37925),c=a(37885),s=a(37886),u=a(12353),d=a(10926),p=a.n(d),m=a(37893),b=a(37917),f=a(22590),v=a(37926),g=a(37948);function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){O(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function O(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var C=()=>{var e,{getStepKeys:t}=Object(c.b)(),a=null===(e=t())||void 0===e?void 0:e.currentStepKey,n=v.b[null!=a?a:""];return n?p.a.createElement(n,null):null},S=()=>{var{setValue:e,getValue:t}=Object(c.c)(),a=t("expressWizardState"),{state:n}=Object(o.c)();return a!==n&&e("expressWizardState",n,!0),p.a.createElement(p.a.Fragment,null)},E=e=>{var t,{contentType:a,onAdvance:n}=e,{getStepKeys:r}=Object(c.b)(),s=Object(l.a)(),d=null===(t=r())||void 0===t?void 0:t.currentStepKey,{getValue:m}=Object(c.c)(),b=p.a.useMemo(()=>Object.values(Object(i.b)(s)),[s]),f=m("expressWizardState"),g=v.c[null!=d?d:""],h=f||y(y({},o.b),{},{steps:b}),O={contentType:null!=a?a:"",onAdvance:null!=n?n:u.noop};return g?p.a.createElement(o.a,{imageWizardState:h},p.a.createElement(S,null),p.a.createElement(g,O)):null},j=()=>{var e=Object(l.a)(),t=Object(n.a)(m.j),{contentType:a,onAdvance:o}=Object(g.a)();return{expressDesignSteps:p.a.useMemo(()=>((e,t,a)=>[{key:r.c.chooseContentType,title:b.a,leftContent:C,rightContent:()=>p.a.createElement(E,{contentType:t,onAdvance:a}),nextStepKey:t===r.a.Image?r.c.uploadAnImage:r.c.startFromFigma,backStepKey:f.a.LayoutTemplateSelection,buttonStates:v.a},{key:r.c.startFromFigma,title:b.a,leftContent:C,rightContent:()=>p.a.createElement(E,null),backStepKey:r.c.chooseContentType,buttonStates:[{type:s.c.Complete,state:{isEnabled:!1,isHidden:!1}},{type:s.c.Next,state:{isHidden:!0}}],reflowHeight:735},{key:r.c.uploadAnImage,title:b.a,leftContent:C,rightContent:()=>p.a.createElement(E,null),backStepKey:r.c.chooseContentType,buttonStates:v.a,reflowHeight:735,reflowWidth:1025}])(0,a,o),[a,o,e]),expressDesignDisabled:t.disableConvertFromFigma&&t.disableConvertFromImage}}},37924:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return o}));var n={Image:"Image",Figma:"Figma"},r={chooseContentType:"chooseContentType",startFromFigma:"figma/startFromFigma",uploadAnImage:"image/uploadAnImage"},o={0:{stepIteration:0},1:{stepIteration:1},2:{stepIteration:2},3:{stepIteration:2,subStepIteration:1},4:{stepIteration:2,subStepIteration:2},5:{stepIteration:3}}},37925:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(11465),r=()=>{var{t:e}=Object(n.t)("CreateFrom");return e}},37926:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return u}));var n=a(37927),r=a(37924),o=a(37934),i=a(37886),l=a(37940),c=[{type:i.c.Complete,state:{isEnabled:!1}}],s={[r.c.startFromFigma]:o.a,[r.c.uploadAnImage]:l.a,[r.c.chooseContentType]:n.a},u={[r.c.startFromFigma]:o.b,[r.c.uploadAnImage]:l.b,[r.c.chooseContentType]:n.b}},37927:function(e,t,a){"use strict";a.d(t,"a",(function(){return v})),a.d(t,"b",(function(){return g}));var n=a(10926),r=a(12139),o=a(12948),i=a(10929),l=a(20408),c=a(11465),s=a(37928),u=a(37885),d=a(37886),p=a(37931),m=a(37932),b=a(37933),f=a(37924),v=Object(c.s)("CreateFrom")(e=>{var{t:t}=e,a=t("NewWizard.ChooseContentType.Left.title"),r=t("NewWizard.ChooseContentType.Left.description");return n.createElement(s.a,{title:a,description:r})}),g=Object(c.s)("CreateFrom")(e=>{var{onAdvance:t,t:a}=e,[c,s]=n.useState(e.contentType),v=Object(i.Y)(),g=Object(p.a)(v),h=Object(p.i)(),{updateFooterButton:y,getStepKeys:O,navigateToStep:C}=Object(u.b)(),S=O(),E=n.useRef(null),j=n.useRef(!1),T=(e,t)=>n.createElement(r.a,{className:h.labelContainer,verticalFill:!0,verticalAlign:"center"},null==t?void 0:t(e));n.useEffect(()=>{E.current&&!j.current&&(E.current.focus(),j.current=!0)});var w=n.useCallback((e,a)=>{null!=a&&a.key&&S&&(s(a.key),y(d.c.Next,{onClick:()=>t({stepKeys:S,navigateToStep:C,selectedType:null==a?void 0:a.key})}))},[C,t,S,y]);return n.createElement(r.a,{className:g.container},n.createElement(r.a.Item,{className:g.typeOptionContainer},n.createElement(r.a,{tokens:{childrenGap:16}},n.createElement(r.a.Item,null,n.createElement("div",{id:"contentTypeLabel",className:g.typeOptionTitle},a("NewWizard.ChooseContentType.Right.optionTitle"))),n.createElement(r.a.Item,null,n.createElement(o.a,{componentRef:E,"aria-labelledby":"contentTypeLabel",styles:p.k,options:[{key:f.a.Image,text:a("NewWizard.ChooseContentType.Right.imageOptionText"),imageSize:{width:p.h,height:p.h},styles:Object(p.d)(f.a.Image===c,v),imageAlt:a("NewWizard.ChooseContentType.Right.imageAltOptionText"),imageSrc:l.a.StartFromImageTile,onRenderLabel:T},{key:f.a.Figma,text:a("NewWizard.ChooseContentType.Right.figmaOptionText"),imageSize:{width:p.h,height:p.h},styles:Object(p.d)(f.a.Figma===c,v),imageAlt:a("NewWizard.ChooseContentType.Right.figmaAltOptionText"),imageSrc:l.a.StartFromFigmaTile,onRenderLabel:T}],defaultSelectedKey:c,onChange:w})))),n.createElement(r.a.Item,{verticalFill:!0},c===f.a.Image?n.createElement(b.a,null):n.createElement(m.a,null)))})},37928:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(10926),r=a(12364),o=a(12139),i=a(37929),l=a(37930),c={childrenGap:24},s=e=>{var{title:t,description:a,content:s,copilotCard:u}=e,d=Object(i.b)();return n.createElement(o.a,{tokens:c,role:"complementary"},t&&n.createElement(o.a.Item,null,n.createElement("h2",{className:d.title},t)),a&&n.createElement(o.a.Item,null,n.createElement("div",{className:d.description},a)),s&&n.createElement(o.a.Item,null,s),u&&n.createElement(r.a,{styles:i.a},n.createElement("div",{className:d.copilotHeader},n.createElement(l.a,{className:d.copilotHeaderIcon}),n.createElement("h3",{className:d.copilotHeaderText},u.title)),u.content))}},37929:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return o}));var n=a(10929),r=()=>Object(n.db)({title:{fontSize:"20px",fontWeight:600,lineHeight:"36px"},description:{fontSize:"14px",fontWeight:400,lineHeight:"20px"},copilotHeader:{display:"flex",gap:8,marginBottom:16},copilotHeaderIcon:{width:24},copilotHeaderText:{fontSize:18,fontWeight:600,lineHeight:24}}),o={root:{border:"none",borderRadius:4,boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.13), 0px 0px 2px rgba(0, 0, 0, 0.10)",display:"flex",flexFlow:"column",alignItems:"flex-start",maxWidth:"100%",padding:"16px 16px 24px 16px"}}},37930:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n,r,o,i,l,c,s,u=a(10926);function d(){return(d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function p(e){return u.createElement("svg",d({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),n||(n=u.createElement("path",{d:"M17.0722 3.66246C16.7827 2.67691 15.8784 2 14.8512 2L14.1735 2C13.0569 2 12.0994 2.7971 11.897 3.8952L10.7119 10.3247L11.0335 9.22215C11.3216 8.23453 12.2269 7.55555 13.2557 7.55555L17.1772 7.55556L18.8242 8.19709L20.4119 7.55556H19.9483C18.9212 7.55556 18.0168 6.87864 17.7273 5.89309L17.0722 3.66246Z",fill:"url(#paint0_radial_56279_101874)"})),r||(r=u.createElement("path",{d:"M7.16561 20.328C7.45189 21.3183 8.35852 22 9.38937 22H10.8432C12.0912 22 13.1145 21.0107 13.1567 19.7634L13.3712 13.4201L12.9681 14.7851C12.6776 15.7691 11.774 16.4444 10.7481 16.4444L6.78679 16.4444L5.37506 15.6786L3.84668 16.4444H4.3025C5.33335 16.4444 6.23998 17.1261 6.52626 18.1164L7.16561 20.328Z",fill:"url(#paint1_radial_56279_101874)"})),o||(o=u.createElement("path",{d:"M14.7507 2H6.73041C4.43891 2 3.06401 5.02777 2.14741 8.05553C1.06148 11.6426 -0.359484 16.4401 3.75146 16.4401H7.21482C8.24955 16.4401 9.15794 15.7559 9.44239 14.7611C10.0445 12.6551 11.0997 8.98146 11.9285 6.18489C12.3497 4.76367 12.7005 3.5431 13.239 2.783C13.5409 2.35686 14.044 2 14.7507 2Z",fill:"url(#paint2_linear_56279_101874)"})),i||(i=u.createElement("path",{d:"M14.7507 2H6.73041C4.43891 2 3.06401 5.02777 2.14741 8.05553C1.06148 11.6426 -0.359484 16.4401 3.75146 16.4401H7.21482C8.24955 16.4401 9.15794 15.7559 9.44239 14.7611C10.0445 12.6551 11.0997 8.98146 11.9285 6.18489C12.3497 4.76367 12.7005 3.5431 13.239 2.783C13.5409 2.35686 14.044 2 14.7507 2Z",fill:"url(#paint3_linear_56279_101874)",fillOpacity:.4})),l||(l=u.createElement("path",{d:"M9.24902 22H17.2693C19.5608 22 20.9357 18.9722 21.8523 15.9445C22.9382 12.3574 24.3592 7.55991 20.2482 7.55991H16.7849C15.7501 7.55991 14.8417 8.24407 14.5573 9.23894C13.9552 11.3449 12.9 15.0186 12.0712 17.8151C11.65 19.2363 11.2991 20.4569 10.7607 21.217C10.4588 21.6431 9.9557 22 9.24902 22Z",fill:"url(#paint4_radial_56279_101874)"})),c||(c=u.createElement("path",{d:"M9.24902 22H17.2693C19.5608 22 20.9357 18.9722 21.8523 15.9445C22.9382 12.3574 24.3592 7.55991 20.2482 7.55991H16.7849C15.7501 7.55991 14.8417 8.24407 14.5573 9.23894C13.9552 11.3449 12.9 15.0186 12.0712 17.8151C11.65 19.2363 11.2991 20.4569 10.7607 21.217C10.4588 21.6431 9.9557 22 9.24902 22Z",fill:"url(#paint5_linear_56279_101874)"})),s||(s=u.createElement("defs",null,u.createElement("radialGradient",{id:"paint0_radial_56279_101874",cx:0,cy:0,r:1,gradientUnits:"userSpaceOnUse",gradientTransform:"translate(17.9657 7.76852) rotate(-134.314) scale(7.13185 7.02179)"},u.createElement("stop",{stopColor:"#7D7DF2"}),u.createElement("stop",{offset:.633728,stopColor:"#4A40D4"}),u.createElement("stop",{offset:.923392,stopColor:"#2F27A5"})),u.createElement("radialGradient",{id:"paint1_radial_56279_101874",cx:0,cy:0,r:1,gradientUnits:"userSpaceOnUse",gradientTransform:"translate(5.57463 16.2453) rotate(52.4153) scale(8.16508 7.88004)"},u.createElement("stop",{stopColor:"#A072EE"}),u.createElement("stop",{offset:.633728,stopColor:"#6C31D3"}),u.createElement("stop",{offset:.923392,stopColor:"#491D9F"})),u.createElement("linearGradient",{id:"paint2_linear_56279_101874",x1:6.61127,y1:19.5243,x2:7.80393,y2:.699525,gradientUnits:"userSpaceOnUse"},u.createElement("stop",{offset:.0499437,stopColor:"#00CCF9"}),u.createElement("stop",{offset:.415501,stopColor:"#4A94FC"}),u.createElement("stop",{offset:.764894,stopColor:"#7D7DF2"}),u.createElement("stop",{offset:1,stopColor:"#A071EE"})),u.createElement("linearGradient",{id:"paint3_linear_56279_101874",x1:7.25046,y1:2,x2:7.87502,y2:16.4401,gradientUnits:"userSpaceOnUse"},u.createElement("stop",{stopColor:"#B5BCFD"}),u.createElement("stop",{offset:.246674,stopColor:"#9B9FF8",stopOpacity:0})),u.createElement("radialGradient",{id:"paint4_radial_56279_101874",cx:0,cy:0,r:1,gradientUnits:"userSpaceOnUse",gradientTransform:"translate(20.7999 6.72766) rotate(115.589) scale(16.9332 20.3735)"},u.createElement("stop",{stopColor:"#6462E4"}),u.createElement("stop",{offset:.554591,stopColor:"#6462E4"}),u.createElement("stop",{offset:1,stopColor:"#A071EE"})),u.createElement("linearGradient",{id:"paint5_linear_56279_101874",x1:19.4113,y1:6.8672,x2:18.4888,y2:11.7057,gradientUnits:"userSpaceOnUse"},u.createElement("stop",{stopColor:"#B791F7"}),u.createElement("stop",{offset:1,stopColor:"#A071EE",stopOpacity:0})))))}a.p},37931:function(e,t,a){"use strict";a.d(t,"h",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"k",(function(){return s})),a.d(t,"d",(function(){return u})),a.d(t,"i",(function(){return d})),a.d(t,"b",(function(){return p})),a.d(t,"g",(function(){return m})),a.d(t,"f",(function(){return b})),a.d(t,"e",(function(){return f})),a.d(t,"j",(function(){return v})),a.d(t,"c",(function(){return g}));var n=a(10929);function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l=24,c=e=>Object(n.db)({container:{margin:"-24px",height:"100%"},typeOptionContainer:{padding:"32px",backgroundColor:e.semanticColors.defaultStateBackground,borderBottom:"1px solid ".concat(e.palette.neutralQuaternaryAlt)},typeOptionTitle:{fontWeight:600,fontSize:"16px"}}),s={flexContainer:{alignContent:"center"}},u=(e,t)=>({root:{boxShadow:"0 0 4px ".concat(t.palette.neutralTertiary),width:"240px",height:"74px",borderRadius:"4px",marginRight:"16px",backgroundColor:t.palette.white,":hover":{boxShadow:"0px 0px 8px ".concat(t.palette.neutralTertiary),backgroundColor:"#FCF4FC"}},field:o(o(o({transitionDuration:"100ms",flexDirection:"row",justifyContent:"flex-start",textAlign:"left",borderRadius:"4px",padding:"0px",height:"74px",width:"240px"},e&&{backgroundColor:"#FCF4FC"}),!e&&{borderWidth:"0px"}),{},{"::before, ::after":{display:"none"}}),labelWrapper:{width:"100%",height:"100%",maxWidth:"240px"},innerField:{paddingLeft:"12px",width:"44px",height:"44px"},imageWrapper:{opacity:1,position:"relative",width:"44px",height:"44px",overflow:"hidden",backgroundColor:t.palette.themeLighter,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"4px"}}),d=()=>Object(n.db)({labelContainer:{marginLeft:"12px",marginRight:"12px",fontWeight:600}}),p=e=>Object(n.db)({container:{padding:"42px 32px 0px"},contentContainer:{padding:"0px 48px 62px 42px"},titleContainer:{fontWeight:600,paddingBottom:"42px"},contentTitle:{fontSize:"28px"},contentSubtitle:{fontSize:"10px",color:e.palette.accent},figmaGuideTitle:{fontWeight:"600",fontSize:"16px",paddingBottom:"8px"},figmaGuideStep:{padding:"8px 0px"}}),m=e=>Object(n.db)({container:o({paddingLeft:e?"48px":"0px",maxWidth:e?"350px":"100%"},!e&&{paddingTop:"24px"})}),b=()=>({root:{width:"100%",height:"32px",borderRadius:"2px",marginBottom:"34px"},textContainer:{flexGrow:0}}),f=e=>Object(n.db)({done:{width:"16px",height:"16px",backgroundColor:e.palette.accent,borderRadius:"100%",marginBottom:"4px"},icon:{fontWeight:600,fontSize:"8px",color:e.palette.white,width:"16px",height:"16px",display:"flex",justifyContent:"center",alignItems:"center"}}),v=e=>Object(n.db)({container:{display:"flex",flexDirection:"column",alignItems:"center"},line:{width:"0",height:"36px",border:"1px solid ".concat(e.palette.accent),marginBottom:"4px"},stepOne:{width:"16px",height:"16px",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:e.palette.accent,borderRadius:"100%",margin:"4px auto",fontSize:"10px",fontWeight:600,color:e.palette.white}}),g=()=>Object(n.db)({container:{padding:"42px 32px 0px",display:"flex",flexDirection:"column",height:"100%"},titleContainer:{paddingBottom:"16px"},title:{fontSize:"28px",fontWeight:600}})},37932:function(e,t,a){"use strict";a.d(t,"a",(function(){return E}));var n=a(10926),r=a(12139),o=a(10929),i=a(11465),l=a(37931),c=a(11666),s=a(11672),u=a(11668),d=a(20408),p=a(11824),m=a(17716),b=a(11860),f=a(25123),v=a(11859),g=a(20431),h=a(11635),y=a(37924),O=()=>{var e=Object(o.Y)(),t=Object(l.e)(e);return n.createElement("div",{className:t.done},n.createElement(c.a,{iconName:"Accept",className:t.icon}))},C=()=>{var e=Object(o.Y)(),t=Object(l.j)(e),a=()=>n.createElement("div",{className:t.line}),i=()=>n.createElement("div",{className:t.stepOne},"1");return n.createElement(r.a.Item,{className:t.container},n.createElement(a,null),n.createElement(O,null),n.createElement(a,null),n.createElement(i,null),n.createElement(a,null))},S=e=>{var{text:t}=e,a=Object(o.Y)(),i=Object(l.b)(a);return n.createElement(r.a,{tokens:{childrenGap:10},horizontal:!0,className:i.figmaGuideStep},n.createElement(O,null),n.createElement("div",null,t))},E=Object(i.s)("CreateFrom")(e=>{var{t:t}=e,a=n.createRef(),i=Object(h.a)(a),c=Object(g.f)(i),O=Object(o.Y)(),E=Object(l.b)(O),j=Object(l.g)(c),T=Object(l.f)(),w=n.useMemo(()=>Object(v.c)(t("NewWizard.ChooseContentType.Right.figmaGuideStep1"),(e,t)=>n.createElement(b.a,{href:m.h,target:"_blank",underline:!0,onClick:()=>Object(f.b)({linkLocation:y.c.chooseContentType})},e)),[t]);return n.createElement("div",{ref:a},n.createElement(r.a,{horizontal:!0,className:E.container},n.createElement(C,null),n.createElement(r.a.Item,{className:E.contentContainer},n.createElement(r.a,null,n.createElement(r.a.Item,{className:E.titleContainer},n.createElement("div",{className:E.contentSubtitle},t("NewWizard.ChooseContentType.Right.figmaStepSubtitle")),n.createElement("h2",{className:E.contentTitle},t("NewWizard.ChooseContentType.Right.figmaStepTitle"))),n.createElement(r.a.Item,null,n.createElement(r.a,{horizontal:c},n.createElement(r.a.Item,null,n.createElement(s.a,{src:d.a.FigmaStepOne,imageFit:u.b.cover,alt:t("NewWizard.ChooseContentType.Right.figmaUIKitImageAltText")})),n.createElement(r.a.Item,{className:j.container},n.createElement("div",{className:E.figmaGuideTitle},t("NewWizard.ChooseContentType.Right.figmaGuideTitle")),n.createElement(S,{text:w}),n.createElement(p.a,{styles:T,href:m.h,target:"_blank",title:t("NewWizard.ChooseContentType.Right.duplicateKitButtonLabel"),iconProps:{iconName:"Copy"},text:t("NewWizard.ChooseContentType.Right.duplicateKitButtonLabel"),onClick:()=>Object(f.b)({linkLocation:y.c.chooseContentType})}),n.createElement(S,{text:t("NewWizard.ChooseContentType.Right.figmaGuideStep2")}),n.createElement(S,{text:t("NewWizard.ChooseContentType.Right.figmaGuideStep3")}),n.createElement(S,{text:t("NewWizard.ChooseContentType.Right.figmaGuideStep4")}))))))))})},37933:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(10926),r=a(12139),o=a(11465),i=a(12839),l=a(20431),c=a(20407),s=a(11635),u=a(37931),d=Object(o.s)("CreateFrom")(e=>{var{t:t}=e,a=n.createRef(),o=n.useRef(null),d=Object(s.a)(a),p=Object(l.f)(d),m=Object(u.c)();return n.createElement("div",{ref:a,className:m.container},n.createElement(r.a,{className:m.titleContainer,horizontal:!0,horizontalAlign:"space-between"},n.createElement(r.a,{tokens:{childrenGap:10}},n.createElement("h2",{className:m.title},t("AppFromImage.title")),n.createElement(i.a,null,t("AppFromImage.getStartedSubtitle")))),n.createElement(r.a,{horizontal:p,tokens:{childrenGap:5},verticalFill:!0,horizontalAlign:"center"},n.createElement(c.a,{t:t,carouselRef:o,currentResponsiveMode:d}),n.createElement(c.c,{currentResponsiveMode:d,t:t})))})},37934:function(e,t,a){"use strict";a.d(t,"a",(function(){return _})),a.d(t,"b",(function(){return U}));var n=a(10926),r=a(10929),o=a(12139),i=a(11465),l=a(37928),c=a(37935),s=a(12661),u=a(11860),d=a(11859),p=a(17716),m=a(12948),b=a(37885),f=a(37886),v=a(25123),g=a(12219),h=a(20434),y=a(20435),O=a(11205),C=a(11021),S=a(37936),E=a(11932),j=a(11934),T=a(11635),w=a(11636),x=a(37924),k=a(11019),P=a(37938);function N(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function F(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?N(Object(a),!0).forEach((function(t){D(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):N(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function D(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function I(e,t,a,n,r,o,i){try{var l=e[o](i),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}function L(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function i(e){I(o,n,r,i,l,"next",e)}function l(e){I(o,n,r,i,l,"throw",e)}i(void 0)}))}}var A=/^[()\-\w\s]+$/,B="appName",R="figmaLink",M="figmaApiKey",z="format",W=e=>{var{errorResponse:t,messageType:a}=e.errorMessage,{t:r}=Object(i.t)("CreateFrom"),l=n.useMemo(()=>()=>{var e,a=r("NewWizard.StartFromFigma.Right.FormFields.Errors.createAppError"),n="",o=null==t||null===(e=t.errors[0])||void 0===e?void 0:e.code;return o?(a=r("NewWizard.StartFromFigma.Right.FormFields.Errors.".concat(o,".primary")),n=r("NewWizard.StartFromFigma.Right.FormFields.Errors.".concat(o,".secondary"))):t.message&&(a=t.message),{primaryMessage:a,secondaryMessage:n}},[t,r])();return n.createElement(o.a.Item,{style:{margin:"-32px -32px 32px"}},n.createElement(E.a,{messageBarType:a},n.createElement("div",null,l.primaryMessage," ",Object(d.c)(l.secondaryMessage,(e,t)=>n.createElement(u.a,{href:p.h,target:"_blank",underline:!0,onClick:()=>Object(v.b)({linkLocation:"Error"})},e)))))},_=Object(i.s)("CreateFrom")(e=>{var{t:t}=e,a=t("NewWizard.StartFromFigma.Left.title"),r=t("NewWizard.StartFromFigma.Left.description"),o=Object(d.c)(t("NewWizard.CopilotCard.descriptionFigma"),(e,t)=>n.createElement(u.a,{href:p.t,target:"_blank",underline:!0},e));return n.createElement(l.a,{title:a,description:r,copilotCard:{title:t("NewWizard.CopilotCard.title"),content:o}})}),U=Object(i.s)("CreateFrom")(e=>{var t,a,i,l,E,N,D,I,{t:_}=e,U=Object(r.Y)(),H=n.createRef(),K=Object(T.a)(H)>w.a.xLarge,{updateFooterButton:V,navigateToStep:q}=Object(b.b)(),{currentEnvironment:G}=Object(g.W)(),{onSubmit:Z,isLoading:Q,validateInputAsync:Y,validateAppNameAsync:$,getPreviewImageAsync:X}=Object(h.a)(G),J=Object(O.i)(),{getValue:ee,setValue:te}=Object(b.c)(),ae=ee("figmaDataSet"),ne=ee("figmaFieldError"),re=ee("recommendedLayout"),[oe,ie]=n.useState({[B]:null!==(t=null==ae?void 0:ae.appName)&&void 0!==t?t:"",[R]:null!==(a=null==ae?void 0:ae.figmaLink)&&void 0!==a?a:"",[M]:null!==(i=null==ae?void 0:ae.figmaApiKey)&&void 0!==i?i:"",[z]:null!==(l=null==ae?void 0:ae.format)&&void 0!==l?l:y.c.Tablet}),[le,ce]=n.useState(null!==(E=null==ne?void 0:ne.appNameValidationError)&&void 0!==E?E:""),[se,ue]=n.useState(null!==(N=null==ne?void 0:ne.figmaUrlError)&&void 0!==N?N:""),[de,pe]=n.useState(null!==(D=null==ne?void 0:ne.figmaApiKeyError)&&void 0!==D?D:""),[me,be]=n.useState(),[fe,ve]=n.useState(!1),[ge,he]=n.useState(!0),{name:ye}=Object(k.t)(),[Oe]=ye.split(" "),[Ce,Se]=n.useState(null!==(I=ee("figmaPreviewImages"))&&void 0!==I?I:[]),Ee=Object(c.a)(U,K,oe.format),je=[{key:y.c.Tablet,text:re===y.c.Tablet?_("Common.LayoutOptions.tabletRecommendedLabel"):_("Common.LayoutOptions.tabletLabel")},{key:y.c.Phone,text:re===y.c.Phone?_("Common.LayoutOptions.phoneRecommendedLabel"):_("Common.LayoutOptions.phoneLabel")}],Te=n.useCallback(function(){var e=L((function*(e){ve(!0);var{appName:t,figmaLink:a,figmaApiKey:n,format:r}=oe;Object(C.fb)(p.r,p.q.WizardCreateClick);var o=yield Z({name:t,figmaUrl:a,figmaApiKey:n,layoutFormat:r});if("errors"in o)return ve(!1),void be({errorResponse:o,messageType:j.a.error});if(ve(!1),o.uploadError)be({errorResponse:{errors:[],message:o.uploadError},messageType:j.a.error});else if(o.makerUrl){var i=o.makerUrl.replace(/^((http[s]?):)\/{2}([^:\/\s]+)/g,"");J.push(i)}else be({errorResponse:{errors:[],message:"No url to app received, something went wrong."},messageType:j.a.error})}));return function(t){return e.apply(this,arguments)}}(),[oe,J,Z]),we=n.useCallback(e=>{var t=ee("figmaFieldError");te("figmaFieldError",F(F({},t),e),!0)},[ee,te]),xe=n.useCallback(function(){var e=L((function*(e,t){ue(e=>e===_("AppFromFigma.FormFields.fieldRequiredMessage")?"":e),pe(e=>e===_("AppFromFigma.FormFields.fieldRequiredMessage")?"":e);var a,n={},r=[],{nodeDataSet:o,status:i}=yield Y(e,t);if(404===i||400===i)ue(_("NewWizard.StartFromFigma.Right.FormFields.Errors.fileNotFound")),n={[p.k.FigmaUrlError]:_("NewWizard.StartFromFigma.Right.FormFields.Errors.fileNotFound")};else if(403===i)pe(_("NewWizard.StartFromFigma.Right.FormFields.Errors.apiKeyError")),n={[p.k.FigmaApiKeyError]:_("NewWizard.StartFromFigma.Right.FormFields.Errors.apiKeyError")};else if(-1===i||i>400)ue(_("NewWizard.StartFromFigma.Right.FormFields.Errors.fileNotFound")),pe(_("NewWizard.StartFromFigma.Right.FormFields.Errors.apiKeyError")),n={[p.k.FigmaUrlError]:_("NewWizard.StartFromFigma.Right.FormFields.Errors.fileNotFound"),[p.k.FigmaApiKeyError]:_("NewWizard.StartFromFigma.Right.FormFields.Errors.apiKeyError")};else{var{previewDataSet:l,hasError:c}=yield X(e,t,o);if(c)a={errorResponse:{errors:[],message:_("NewWizard.StartFromFigma.Right.FormFields.Errors.loadPreviewError")},messageType:j.a.warning};else{var s,u=null==o||null===(s=o.find(e=>!!e))||void 0===s?void 0:s.layout;te("recommendedLayout",u,!0),void 0!==u&&ie(e=>F(F({},e),{},{[z]:u})),r=l}ue(""),pe(""),n={[p.k.FigmaUrlError]:"",[p.k.FigmaApiKeyError]:""}}Se(r),te("figmaPreviewImages",r,!0),we(n),be(a)}));return function(t,a){return e.apply(this,arguments)}}(),[X,te,we,_,Y]),ke=n.useCallback(function(){var e=L((function*(e,t){var a={};switch(e){case R:t?t&&oe[M]?yield xe(t,oe[M]):t&&ue(""):(ue(_("AppFromFigma.FormFields.fieldRequiredMessage")),a={[p.k.FigmaUrlError]:_("AppFromFigma.FormFields.fieldRequiredMessage")});break;case M:t?t&&oe[R]?yield xe(oe[R],t):t&&pe(""):(pe(_("AppFromFigma.FormFields.fieldRequiredMessage")),a={[p.k.FigmaApiKeyError]:_("AppFromFigma.FormFields.fieldRequiredMessage")});break;default:var n="";if(t)if(t.length>p.m.Dataverse.AppDisplayName)n=_("KnownUserMessages.AppNameValidation.MaxLength.text");else if(A.test(t)){var r=yield $(t);n=null!=r?r:""}else n=_("KnownUserMessages.AppNameValidation.AllowedCharacters.text");else n=_("AppFromFigma.FormFields.fieldRequiredMessage");ce(n),a={[p.k.AppNameValidationError]:n}}we(a),he(!0)}));return function(t,a){return e.apply(this,arguments)}}(),[oe,xe,we,_,$]),Pe=n.useCallback(function(){var e=L((function*(e,t){var a,n=null!==(a=null==t?void 0:t.trim())&&void 0!==a?a:"";ie(t=>F(F({},t),{},{[e]:n})),ke(e,n)}));return function(t,a){return e.apply(this,arguments)}}(),[ke]);return n.useEffect(()=>{if(ge){var e=!(!oe.appName||!oe.figmaLink||!oe.figmaApiKey||le||de||se);V(f.c.Complete,{isEnabled:e,onClick:Te}),V(f.c.Back,{onClick:()=>{te("figmaDataSet",oe,!0),q(x.c.chooseContentType)}}),he(!1)}},[ge,V,Te,te,oe,q,le,de,se]),fe?n.createElement(S.a,{name:Oe}):n.createElement("div",{ref:H,className:Ee.container},n.createElement(o.a,{horizontal:K,verticalFill:!0},n.createElement(o.a.Item,{grow:!0,disableShrink:!0},n.createElement(o.a,{className:Ee.fieldContainer},me&&n.createElement(W,{errorMessage:me}),n.createElement(o.a.Item,{className:Ee.fieldContainerTitle},_("NewWizard.StartFromFigma.Right.FormFields.fieldTitle")),n.createElement(o.a.Item,null,n.createElement(s.a,{label:_("NewWizard.StartFromFigma.Right.FormFields.appNameLabel"),ariaLabel:_("NewWizard.StartFromFigma.Right.FormFields.appNameLabel"),required:!0,className:Ee.dataField,validateOnFocusOut:!0,errorMessage:le,defaultValue:oe.appName,onChange:(e,t)=>Pe(B,t)})),n.createElement(o.a.Item,null,n.createElement(s.a,{label:_("NewWizard.StartFromFigma.Right.FormFields.figmaLinkLabel"),ariaLabel:_("NewWizard.StartFromFigma.Right.FormFields.figmaLinkLabel"),required:!0,description:_("NewWizard.StartFromFigma.Right.FormFields.figmaLinkSubtext"),className:Ee.dataField,errorMessage:se,onChange:(e,t)=>Pe(R,t),validateOnFocusOut:!0,defaultValue:oe.figmaLink})),n.createElement(o.a.Item,null,n.createElement(s.a,{label:_("NewWizard.StartFromFigma.Right.FormFields.figmaApiKeyLabel"),ariaLabel:_("NewWizard.StartFromFigma.Right.FormFields.figmaApiKeyLabel"),required:!0,description:_("NewWizard.StartFromFigma.Right.FormFields.figmaApiKeySubtext"),className:Ee.dataField,revealPasswordAriaLabel:_("Common.showPasswordButtonTitle"),onRenderDescription:e=>n.createElement("div",{className:Ee.convertFromSubtext},Object(d.c)(null==e?void 0:e.description,(e,t)=>n.createElement(u.a,{href:p.l.FromFigma,target:"_blank",onClick:()=>Object(v.c)(p.r,{linkLocation:"AccessTokenField"})},_("Common.learnMoreLinkText")))),errorMessage:de,onChange:(e,t)=>Pe(M,t),validateOnFocusOut:!0,defaultValue:oe.figmaApiKey,type:"password"})),n.createElement(o.a.Item,null,n.createElement("div",{className:Ee.FormatChoiceGroup},n.createElement(m.a,{label:_("AppFromFigma.FormFields.formatLabel"),selectedKey:oe.format,options:je,onChange:(e,t)=>Pe(z,null==t?void 0:t.key)}))))),n.createElement(o.a.Item,{verticalFill:!0,className:Ee.previewContainer},n.createElement(o.a,{horizontalAlign:K?"center":"start"},n.createElement(o.a.Item,{className:Ee.previewTitle},_("NewWizard.StartFromFigma.Right.DevicePreview.devicePreviewTitle")),n.createElement(o.a.Item,{className:Ee.previewDevice},n.createElement(P.a,{deviceType:oe.format,imageDataSet:Ce,isLoading:Q}))))))})},37935:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(10929),r=a(20435);function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var c=(e,t,a)=>Object(n.db)({container:{margin:"-24px",height:"calc(100% + 48px)"},fieldContainer:{padding:"32px"},fieldContainerTitle:{fontWeight:600,fontSize:"20px",marginBottom:"37px"},dataField:{paddingTop:"8px",maxWidth:"852px",".ms-TextField-description":{fontSize:"12px"}},convertFromSubtext:{color:e.palette.neutralSecondary,fontSize:"12px"},FormatChoiceGroup:{marginTop:"11px"},previewContainer:i(i({width:t?a===r.c.Tablet?"795px":"423px":"100%"},t&&a===r.c.Tablet&&{minWidth:"795px"}),{},{backgroundColor:e.semanticColors.defaultStateBackground,paddingTop:"32px",paddingBottom:"70px",minHeight:"777px"}),previewTitle:i({fontWeight:600,fontSize:"20px",lineHeight:"28px",width:"100%"},t?{paddingLeft:a===r.c.Tablet?"42px":"24px"}:{paddingLeft:"32px"}),previewDevice:i({},!t&&{paddingLeft:"32px"})})},37936:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(10926),r=a(12139),o=a(10929),i=a(11465),l=a(11672),c=a(11668),s=a(20408),u=a(37937),d=a(12900),p=a(11859),m=Object(i.s)("CreateFrom")(e=>{var{t:t}=e,a=Object(o.Y)(),i=Object(u.a)(a);return n.createElement(r.a,{className:i.container},n.createElement(r.a,{horizontalAlign:"center"},n.createElement(r.a.Item,{className:i.title},Object(p.a)(t("NewWizard.AppCreationInProgress.title"),e.name)),n.createElement(r.a.Item,{className:i.subtitle},t("NewWizard.AppCreationInProgress.subtitle")),n.createElement(r.a.Item,{className:i.progressIndicator},n.createElement(d.a,null)),n.createElement(r.a.Item,null,n.createElement(l.a,{src:s.c.CreatingAppLoading,imageFit:c.b.cover,style:{maxWidth:"452px"}})),n.createElement(r.a.Item,{className:i.imageDescription},t("NewWizard.AppCreationInProgress.imageDescription"))))})},37937:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(10929),r=a(20408),o=e=>Object(n.db)({container:{position:"fixed",left:"0px",top:"48px",zIndex:1e6,width:"100vw",height:"calc(100vh - 48px)",background:"url(".concat(r.c.NewWizardBackground,") no-repeat center bottom/100% border-box"),backgroundColor:e.palette.white,lineHeight:36,overflowY:"auto",textAlign:"center"},title:{fontWeight:600,fontSize:"28px",paddingTop:"60px"},subtitle:{fontWeight:600,fontSize:"28px",paddingBottom:"60px"},imageDescription:{fontSize:"16px",paddingTop:"32px",color:e.palette.themeSecondary},progressIndicator:{width:"100%",maxWidth:"560px",paddingBottom:"80px"}})},37938:function(e,t,a){"use strict";a.d(t,"a",(function(){return S}));var n=a(10926),r=a.n(n),o=a(10929),i=a(11672),l=a(11668),c=a(37939),s=a(20435),u=a(12905),d=a(11465),p=a(20408),m=a(11021),b=a(17716),f=a(11940),v=a(11942),g=a(11623),h=a(11665),y=a(11625),O=a(11859),C=Object(g.a)(),S=Object(y.a)(e=>{var{t:t}=Object(d.t)("createFrom"),{deviceType:a,imageDataSet:n,isLoading:c,styles:g}=e,y=Object(o.Y)(),S=C(g,{theme:y,deviceType:a}),E=r.a.useRef(null),j=r.a.useMemo(()=>n.map(e=>e.name),[n]),T=r.a.useMemo(()=>n.map(e=>r.a.createElement("div",{className:S.previewImageContainer,key:"previewImage_".concat(e.name)},r.a.createElement("div",{className:S.previewImageItem},r.a.createElement(i.a,{src:e.imageUrl,imageFit:l.b.cover,alt:Object(O.a)(t("NewWizard.StartFromFigma.Right.DevicePreview.previewImageAltText"),e.name)})))),[S.previewImageContainer,S.previewImageItem,n,t]),w=r.a.useCallback((e,t)=>Object(m.fb)(b.r,b.q.CarouselNavigation,{buttonName:"Next",itemIndex:t}),[]),x=r.a.useCallback((e,t)=>Object(m.fb)(b.r,b.q.CarouselNavigation,{buttonName:"Previous",itemIndex:t}),[]),k=r.a.useCallback((e,t)=>Object(m.fb)(b.r,b.q.CarouselNavigation,{buttonName:"ItemSelected",itemIndex:t}),[]);return r.a.createElement("div",{className:Object(h.a)(S.container,a===s.c.Tablet?S.tabletContainer:S.phoneContainer)},r.a.createElement("div",{className:S.contentContainer},n.length>0&&!c?r.a.createElement(u.a,{isAutoPlayDisabled:!0,hideNavigation:!0,hidePlayButton:!0,styles:S.subComponentStyles.carousel,items:T,navPreviousButtonAriaLabel:t("Common.previous"),navNextButtonAriaLabel:t("Common.next"),indicatorButtonsAriaLabel:j,playButtonAriaLabel:t("Common.play"),pauseButtonAriaLabel:t("Common.pause"),componentRef:E,onNext:w,onPrevious:x,onItemSelected:k}):r.a.createElement("div",{className:S.emptyImageItem},c?r.a.createElement(f.a,{className:S.spinner,size:v.a.large}):r.a.createElement("div",{className:S.dashBorder},r.a.createElement(i.a,{src:p.c.PreviewEmptyApp,imageFit:l.b.cover,alt:t("NewWizard.StartFromFigma.Right.DevicePreview.emptyPreviewImageAltText")})))))},c.a)},37939:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(20435),r=e=>{var{palette:t}=e.theme;return{container:{backgroundColor:t.black,border:"10px solid ".concat(t.neutralSecondary),borderRadius:"28px"},tabletContainer:{marginTop:"62px",width:"711px",height:"365px",padding:"0 28px 0 49px"},phoneContainer:{marginTop:"34px",width:"280px",height:"576px",padding:"51px 0 43px"},contentContainer:{width:"100%",height:"100%",backgroundColor:t.white},previewImageContainer:{height:"100%"},previewImageItem:{height:"100%",overflow:"hidden"},emptyImageItem:{width:"100%",height:"100%",padding:"9px"},dashBorder:{border:"2px dashed ".concat(t.themeLight),borderRadius:"4px",display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"},spinner:{flexGrow:1,height:"100%",marginBottom:"10px"},subComponentStyles:{carousel:{root:{height:e.deviceType===n.c.Tablet?"403px":"565px",alignItems:"start"},itemWrapper:{height:"100%",paddingBottom:"58px",overflow:"hidden"},indicatorsWrapper:{backgroundColor:t.neutralLighter,borderRadius:"20px"}}}}}},37940:function(e,t,a){"use strict";a.d(t,"a",(function(){return O})),a.d(t,"b",(function(){return C}));var n=a(25077),r=a(25145),o=a(17716),i=a(37925),l=a(37885),c=a(37886),s=a(10926),u=a(25083),d=a(37941),p=a(37946),m=a(37924),b=a(37928),f=a(25082),v=a(11859),g=a(11860);function h(e,t,a,n,r,o,i){try{var l=e[o](i),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}function y(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function i(e){h(o,n,r,i,l,"next",e)}function l(e){h(o,n,r,i,l,"throw",e)}i(void 0)}))}}var O=()=>{var e,t,a,n=Object(i.a)(),{getValue:r}=Object(l.c)(),c=null!==(e=null===(t=r("expressWizardState"))||void 0===t?void 0:t.steps)&&void 0!==e?e:[],u=null!==(a=r("wizardStepValue"))&&void 0!==a?a:{step:0},d=Object(v.c)(n("NewWizard.CopilotCard.descriptionImage"),(e,t)=>s.createElement(g.a,{href:o.t,target:"_blank",underline:!0},e)),m=s.createElement(p.a,{steps:c,currentStepIteration:u.step,currentSubStepIteration:u.subStep});return s.createElement(b.a,{content:m,copilotCard:{title:n("NewWizard.CopilotCard.title"),content:d}})},C=()=>{var e=Object(i.a)(),{updateFooterButton:t,getStepKeys:a,executeAsync:p}=Object(l.b)(),{getValue:b,setValue:v}=Object(l.c)(),g=a(),[h,O]=Object(s.useState)(!1),[C,S]=Object(s.useState)(!1),[E,j]=Object(s.useState)(!1),{state:T,dispatch:w,contentServiceClient:x,cdsServiceClient:k}=Object(n.c)(),{dataSelection:P}=T,[N,F]=Object(s.useState)(0),{onAdvance:D,beforeAdvance:I,onCreate:L,navigateToApp:A,onBack:B,onClose:R,shouldBackProceed:M,disableAdvance:z}=Object(r.a)(T,w,x,k,e,b,v),W=m.b[N],_=function(){var e=y((function*(){var e=function(){var e=y((function*(){var e=m.b[N+1];W&&e&&(yield I(W.stepIteration,W.subStepIteration),D(e.stepIteration,e.subStepIteration,!0))}));return function(){return e.apply(this,arguments)}}();2===N&&P===o.i.Skip||(yield p(e),F(N+1))}));return function(){return e.apply(this,arguments)}}(),U=function(){var e=y((function*(){null!=g&&g.backStepKey&&(p(function(){var e=y((function*(){var e=m.b[N-1];W&&e&&(yield M(W.stepIteration,W.subStepIteration),B(e.stepIteration,e.subStepIteration,!0))}));return function(){return e.apply(this,arguments)}}()),F(N-1))}));return function(){return e.apply(this,arguments)}}(),H=function(){var e=y((function*(){p(function(){var e=y((function*(){W&&L(W.stepIteration,W.subStepIteration)}));return function(){return e.apply(this,arguments)}}())}));return function(){return e.apply(this,arguments)}}();Object(s.useEffect)(()=>{var e=5===N||2===N&&P===o.i.Skip;t(c.c.Next,{onClick:()=>O(!0),isEnabled:!z,isHidden:e}),t(c.c.Back,{onClick:0===N?void 0:()=>S(!0)}),t(c.c.Complete,{onClick:()=>j(!0),isEnabled:e,isHidden:!e})},[z,R,P,N]),Object(s.useEffect)(()=>{h&&(O(!1),_())},[h,_]),Object(s.useEffect)(()=>{C&&(S(!1),U())},[C,U]),Object(s.useEffect)(()=>{E&&(j(!1),H())},[E,H]),Object(s.useEffect)(()=>{T.wizardComplete&&T.createAppResponse&&A()},[A,T.createAppResponse,T.wizardComplete]);var K=null;return 0===N?K=s.createElement(u.f,null):1===N?K=s.createElement(u.b,null):2===N?K=s.createElement(s.Fragment,null,s.createElement(d.a,{isVisible:T.loading}),s.createElement(u.c,{isNewWizard:!0})):3===N?K=s.createElement(u.e,null):4===N?K=s.createElement(u.a,null):5===N&&(K=s.createElement(s.Fragment,null,s.createElement(d.a,{isVisible:T.loading}),s.createElement(u.d,null))),K?s.createElement("div",{className:f.l.rootPadding},K):null}},37941:function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return p}));var n=a(11019),r=a(11465),o=a(10926),i=a.n(o),l=a(37942),c=a.n(l),s=a(37943),u=a(37893),d=e=>{var{isVisible:t}=e,{t:a}=Object(r.t)(u.k),{name:o}=Object(n.t)(),[l]=o.split(" ");return i.a.createElement(s.a,{isVisible:t,imgSrc:c.a,title1:a("createTableStep.appCreationTitle1",{name:l}),title2:a("createTableStep.appCreationTitle2"),subtitle:a("createTableStep.appCreationSubtitle")})},p=e=>{var{isVisible:t,isAttemptingRetry:a}=e,{t:o}=Object(r.t)(u.k),{name:l}=Object(n.t)(),[d]=l.split(" "),p=o(a?"developerEnvironmentProvisioningStep.environmentCreationSubtitleRetry":"developerEnvironmentProvisioningStep.environmentCreationSubtitle"),m=o("developerEnvironmentProvisioningStep.environmentCreationTitle2");return i.a.createElement(i.a.Fragment,null,i.a.createElement(s.a,{isVisible:t,imgSrc:c.a,title1:o("developerEnvironmentProvisioningStep.environmentCreationTitle1",{name:d}),title2:m,subtitle:p,announcementMessage:m}))}},37942:function(e,t,a){e.exports=a.p+"static/media/appCreationIllustration.5c5e421e.22.png"},37943:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(11672),r=a(11631),o=a(12900),i=a(12139),l=a(12839),c=a(10926),s=a.n(c),u=a(37944),d=a(12709),p=e=>{var{imgSrc:t,title1:a,title2:c,subtitle:p,announcementMessage:m,isVisible:b,imgClassName:f}=e;return s.a.useEffect(()=>{b&&setTimeout(()=>{var e=document.getElementById("fluent-default-layer-host");e&&(e.style.zIndex="999998")},500)},[b]),s.a.createElement(r.a,{isOpen:b,className:u.a.loadingModal,isDarkOverlay:!1},s.a.createElement(i.a,{horizontal:!1,horizontalAlign:"center",className:u.a.loadingModalContentWrapper},s.a.createElement(l.a,{as:"p"},a),s.a.createElement(l.a,{as:"p"},c),s.a.createElement(o.a,{className:u.a.progressIndicator}),s.a.createElement(n.a,{src:t,alt:"",className:null!=f?f:""}),s.a.createElement(l.a,{as:"span"},p),m&&s.a.createElement(d.a,{message:m,"aria-live":"assertive"})))}},37944:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(10929),r=a(37945),o=a.n(r),{palette:i}=Object(n.Y)(),l=Object(n.db)({loadingModal:{marginTop:48,".ms-Dialog-main":{height:"100%",width:"100%",maxHeight:"100%",maxWidth:"100%",backgroundImage:"url(".concat(o.a,")"),backgroundRepeat:"no-repeat",backgroundPosition:"bottom",backgroundSize:"100%"},".ms-Overlay":{background:"none"}},loadingModalContentWrapper:{padding:"60px 0",lineHeight:36,p:{fontSize:28,maxWidth:386,textAlign:"center",fontWeight:n.l.semibold},img:{height:"auto",maxWidth:452,marginBottom:32},span:{color:i.themePrimary}},progressIndicator:{"&.ms-ProgressIndicator":{width:560,margin:"60px 0 52px"}}})},37945:function(e,t,a){e.exports=a.p+"static/media/loadingModalBackground.e7938dc1.svg"},37946:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(11666),r=a(11623),o=a(11665),i=a(11625),l=a(10926),c=a(37947),s=a(25139),u=Object(r.a)(),d=(e,t,a,r,i,c)=>{var u=!1,d=!1,p="",m=e.stepIcon;switch(t.status){case s.a.Valid:p="CheckMark",m=e.stepIcon_valid;break;case s.a.Warning:p="WarningSolid",m=e.stepIcon_warning;break;case s.a.Error:p="StatusErrorFull",m=e.stepIcon_error;break;case s.a.Empty:default:p="",m=e.stepIcon_empty}return a===r&&i===c?(p="",u=!0):t.status===s.a.Skipped?(p="",d=!0):void 0!==i&&(p=""),l.createElement("li",{key:"step-".concat(t.title),title:t.title,className:Object(o.a)(e.stepItem,void 0!==i&&e.subStepItem,t.complete&&e.stepComplete)},l.createElement(n.a,{iconName:p,className:Object(o.a)(e.stepIcon,m,void 0!==i&&e.subStepIcon,u&&e.stepActive,d&&e.stepSkipped)}),t.titleSlug||t.title)},p=Object(i.a)(e=>{var{steps:t,styles:a,theme:n,currentStepIteration:r,currentSubStepIteration:o}=e,i=u(a,{theme:n}),c=[];for(var s in t)if(t[s]){var p=t[s];if(c.push(d(i,p,parseInt(s,10),r)),p.subSteps&&p.subSteps.length>0)for(var m in p.subSteps)if(p.subSteps[m]){var b=p.subSteps[m];c.push(d(i,b,parseInt(s,10),r,parseInt(m,10),o))}}return l.createElement("ol",{className:i.stepProgress},c)},c.a)},37947:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=e=>{var{theme:t}=e,{palette:a}=t;return{stepProgress:[{padding:"16px 0 0 16px"}],stepItem:[{height:60,paddingLeft:28,wordBreak:"break-word",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":"3",position:"relative",listStyle:"none",selectors:{":after":{width:2,height:36,content:'""',display:"block",position:"absolute",top:23,left:9,backgroundColor:a.neutralTertiary}},":last-child:after":{height:0}}],subStepItem:{height:50,selectors:{":after":{height:24}}},stepComplete:{selectors:{":after":{backgroundColor:a.themePrimary}}},stepIcon:{width:16,height:16,position:"absolute",top:2,left:2.5,lineHeight:16,background:"transparent"},subStepIcon:{width:8,height:8,top:6,left:6,fontSize:6,lineHeight:8},stepIcon_empty:{borderRadius:"50%",border:"2px solid ".concat(a.neutralTertiary)},stepActive:{borderColor:"transparent",borderRadius:"50%",backgroundColor:a.themePrimary},stepSkipped:{borderColor:"transparent",borderRadius:"50%",backgroundColor:a.neutralTertiary},stepIcon_valid:{borderRadius:"50%",color:a.white,fontSize:10,textAlign:"center",backgroundColor:a.themePrimary},stepIcon_warning:{color:a.yellow,fontSize:16},stepIcon_error:{color:a.red,fontSize:16}}}},37948:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(37924),r=a(10926),o=a.n(r),i=()=>{var[e,t]=o.a.useState(n.a.Image);return{contentType:e,onAdvance:o.a.useCallback(e=>{var{stepKeys:a,navigateToStep:r}=e;(null==a?void 0:a.currentStepKey)===n.c.chooseContentType?(t(null==e?void 0:e.selectedType),(null==e?void 0:e.selectedType)===n.a.Image?r(n.c.uploadAnImage):r(n.c.startFromFigma)):(null==a||a.currentStepKey,n.c.startFromFigma)},[e])}}},37949:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(10929),r=a(12839),o=a(12139),i=a(10926),l=a.n(i),{palette:c}=Object(n.Y)(),s=Object(n.db)({leftContent:{padding:"8px 0 39px",height:"100%",h2:{fontSize:28,lineHeight:28,fontWeight:n.l.semibold},p:{color:c.neutralSecondary,marginBottom:20,":last-of-type":{"@media screen and (max-height: 298px)":{display:"none"}}}}}),u=e=>{var{title:t,subtitle:a,RenderBottomContent:n}=e,i="string"==typeof a?()=>l.a.createElement(r.a,{as:"p"},a):a;return l.a.createElement(o.a,{className:s.leftContent,verticalAlign:"space-between"},l.a.createElement(o.a,{horizontal:!1,tokens:{childrenGap:12}},l.a.createElement(r.a,{as:"h2"},t),i&&l.a.createElement(i,null)),n&&l.a.createElement(n,null))}},37950:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return s}));var n=a(12219),r=a(20491),o=a(14760),i=a(16210),l=(e,t)=>{var a,{data:l,isInitialLoading:c}=Object(i.c)(),{canUserCreateOrUseDevEnvironment:s}=Object(r.a)(),{currentEnvironment:u}=Object(n.W)(),{data:d,isInitialLoading:p}=Object(o.f)({environment:u,solutionId:t||(null==l||null===(a=l.solution)||void 0===a?void 0:a.id),telemetryScope:e,enabled:!!s||(!!t||!c&&!(null==l||!l.solution))},s);return{solutionData:d,solutionIsLoading:p||c}},c=e=>{var t,a,{solutionData:n}=l(e);return null==n||null===(t=n.solution)||void 0===t||null===(a=t.publisher)||void 0===a?void 0:a.customizationPrefix},s=e=>{var t,{solutionData:a}=l(e);return null==a||null===(t=a.solution)||void 0===t?void 0:t.uniqueName}},37951:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(11868),r=a(11021),o=a(14375),i=a(37952),l=a(14766),c=a(19515);function s(e,t,a,n,r,o,i){try{var l=e[o](i),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}var u=e=>({Accept:"application/json","Content-Type":"application/json","MSCRM.SolutionUniqueName":e,Prefer:"return=representation",Consistency:"Strong"}),d="https://cds-org/api/data/v9.0/EntityDefinitions?$select=LogicalName,EntitySetName,DisplayCollectionName,SchemaName&$filter=".concat("(IsIntersect eq false and IsLogicalEntity eq false and\n  PrimaryNameAttribute ne null and PrimaryNameAttribute ne '' and ObjectTypeCode gt 0 and\n  ObjectTypeCode ne 4712 and ObjectTypeCode ne 4724 and ObjectTypeCode ne 9933 and ObjectTypeCode ne 9934 and\n  ObjectTypeCode ne 9935 and ObjectTypeCode ne 9947 and ObjectTypeCode ne 9945 and ObjectTypeCode ne 9944 and\n  ObjectTypeCode ne 9942 and ObjectTypeCode ne 9951 and ObjectTypeCode ne 2016 and ObjectTypeCode ne 9949 and\n  ObjectTypeCode ne 9866 and ObjectTypeCode ne 9867 and ObjectTypeCode ne 9868) and (IsCustomizable/Value eq true or IsCustomEntity eq true or IsManaged eq false or IsMappable/Value eq true or IsRenameable/Value eq true)"),p=e=>{var t;return{displayName:null===(t=e.DisplayCollectionName.UserLocalizedLabel)||void 0===t?void 0:t.Label,entitySetName:e.EntitySetName,logicalName:e.LogicalName,schemaName:e.SchemaName}},m=e=>{var t,a,{solutionUniqueName:m}=e;return Object(o.a)({enabled:!!m,queryKey:[m,"connections-entities"],queryFn:(t=function*(){var e,t=yield n.f.get(d,{headers:u(m)});return null==t||null===(e=t.data)||void 0===e?void 0:e.value.map(p)},a=function(){var e=this,a=arguments;return new Promise((function(n,r){var o=t.apply(e,a);function i(e){s(o,n,r,i,l,"next",e)}function l(e){s(o,n,r,i,l,"throw",e)}i(void 0)}))},function(){return a.apply(this,arguments)}),onError:e=>{var t=Object(l.b)(e);Object(r.U)(i.a,{eventName:c.a.DataverseCollector,eventData:{name:t.name,message:t.message}})}})}},37952:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));var n="powerapps-connections",r="PowerAppsConnections"},37967:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(12139),r=a(12839),o=a(10926),i=a.n(o),l=a(37968),c=a(37988),s=a(11465),u=a(37969),d=Object(c.a)(),p=e=>{var{t:t}=Object(s.t)("PowerAppsConnections"),{collectorStep:a}=e,{headerText:o,subHeaderText:c}=(e=>{switch(e){case u.c:return{headerText:t("AfdConnections.Dataverse.HeaderText"),subHeaderText:t("AfdConnections.Dataverse.SubheaderText")};case u.d:return{headerText:t("AfdConnections.SharePoint.HeaderText"),subHeaderText:t("AfdConnections.SharePoint.SubheaderText")};case u.e:return{headerText:t("AfdConnections.SQLServer.HeaderText"),subHeaderText:t("AfdConnections.SQLServer.SubheaderText")};case u.b:return{headerText:t("AfdConnections.ExcelOnlineBusiness.HeaderText"),subHeaderText:t("AfdConnections.ExcelOnlineBusiness.SubheaderText")};default:return{headerText:t("AfdConnections.Generic.HeaderText"),subHeaderText:t("AfdConnections.Generic.SubheaderText")}}})(e.connectionApiId);return i.a.createElement(n.a,{verticalFill:!0},i.a.createElement(r.a,{className:d.title,variant:"large",as:"h2"},(null==a?void 0:a.mainContentHeaderText)||o),i.a.createElement(r.a,{className:d.subtitle},(null==a?void 0:a.mainContentSubHeaderText)||c),i.a.createElement(l.a,{connectionApiId:e.connectionApiId,templateType:e.templateType,shouldRedirectToHome:e.shouldRedirectToHome,isDataAccessEnabled:e.isDataAccessEnabled,onCollectorStepFulfilled:null==a?void 0:a.onCollectorStepFulfilled}))}},37968:function(e,t,a){"use strict";a.d(t,"a",(function(){return B}));var n=a(12139),r=a(13209),o=a(13205),i=a(12146),l=a(11934),c=a(10926),s=a.n(c),u=a(19540),d=a(19545),p=a(19544),m=a(37969),b=a(37970),f=a(37885),v=a(37886),g=a(37971),h=a(37976),y=a(37980),O=a(11868),C=a(12217),S=a(12219),E=a(37981),j=a(37984),T=a(24081),w=a(11465),x=a(14766),k=a(37952),P=a(11021),N=a(19515),F=a(11205),D=a(14929),I=a(11019);function L(e,t,a,n,r,o,i){try{var l=e[o](i),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}function A(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function i(e){L(o,n,r,i,l,"next",e)}function l(e){L(o,n,r,i,l,"throw",e)}i(void 0)}))}}var B=e=>{var t,{connectionApiId:a,templateType:L,shouldRedirectToHome:B,isDataAccessEnabled:R,onCollectorStepFulfilled:M}=e,{showMessage:z,updateFooterButton:W,navigateToStep:_}=Object(f.b)(),U=Object(F.i)();null!=B&&B()&&_("NotFound");var[H,K]=s.a.useState(void 0),[V,q]=s.a.useState(),[G,Z]=s.a.useState("loading"),[Q,Y]=s.a.useState(!1),[$,X]=s.a.useState(),{currentEnvironment:J}=Object(S.W)(),{t:ee}=Object(w.t)("PowerAppsConnections"),{fetchList:te}=Object(u.a)(),{oid:ae}=Object(I.t)(),ne=s.a.useCallback(()=>a!==m.c,[a]),re=Object(b.c)(),oe=Object(c.useCallback)((e,t)=>{Object(P.U)(k.a,{eventName:N.a.AfdConnectionsBase,eventData:{name:e,message:t}}),Y(!0)},[]);s.a.useEffect(()=>{ne()&&function(){var e=A((function*(){q(void 0),Z("loading"),Y(!1),W(v.c.Back,{isEnabled:!1});try{var e=yield te();if(W(v.c.Back,{isEnabled:!0}),!e)return void oe("fetchConnections","Failed to fetch the list of connections.");var t=e.filter(e=>e.id.toLowerCase()===a.toLowerCase());if(0===t.length)return void oe("fetchConnections","Connections with the api id of ".concat(a," is not present in the list of connections"));if(K(t[0]),0===(yield Object(D.a)({apiId:a,environmentId:null==J?void 0:J.name,objectId:ae,telemetryScope:C.h})).length)return void oe("getConnectionsWithDetails","Connections not found.")}catch(r){var n=Object(x.b)(r);oe(n.name,n.message)}}));return function(){return e.apply(this,arguments)}}()()},[a,null==J?void 0:J.name]);var ie=Object(y.a)({httpClient:O.f,apiHost:"https://".concat(C.U.powerAppsEndpointUrl),apiVersion:C.U.powerAppsApiVersion,environmentName:null!==(t=null==J?void 0:J.name)&&void 0!==t?t:"",apiAudience:C.U.powerAppsResource}),le=function(){var e=A((function*(e){if(e.apiId.toLowerCase()===m.b){var t=yield ie(e.apiId);X(t)}}));return function(t){return e.apply(this,arguments)}}(),ce=s.a.useCallback((e,t,n,r)=>{var o;M?M(e,r):e&&n?(Object(P.W)(k.a,{eventName:"".concat(N.a.AfdConnections,"/CreateAppButtonEnabled"),eventData:{name:a}}),W(v.c.Complete,{isEnabled:!0,onClick:(o=A((function*(){try{t&&(yield t());var{location:e}=U;U.replace({pathname:e.pathname,search:e.search}),U.push(n)}catch(r){var a=Object(x.b)(r);Object(P.U)(k.a,{eventName:N.a.AfdConnections,eventData:{name:a.name,message:a.message}})}})),function(){return o.apply(this,arguments)})})):W(v.c.Complete,{isEnabled:!1})},[W,M]),se=s.a.createElement(n.a,{verticalAlign:"center",verticalFill:!0,horizontalAlign:"center",styles:{root:{width:"100%"}}},s.a.createElement(T.a,{iconProps:{iconName:"OpenFolderHorizontal"},description:ee("AfdConnections.EmptyStateString")})),ue=s.a.useCallback(()=>{var e="cache-".concat(Date.now().toString());if(Q)return se;switch(a){case m.c:return s.a.createElement(E.a,{onCollectorFulfilled:ce,navigateToStep:_,templateType:L,isDataAccessEnabled:R});case m.e:return s.a.createElement(j.a,{connection:V,onCollectorFulfilled:ce,templateType:L});case m.d:return s.a.createElement(g.a,{connection:V,onCollectorFulfilled:ce,templateType:L});case m.b:return s.a.createElement(h.a,{connection:V,onCollectorFulfilled:ce,apiService:$,cacheKey:e,templateType:L});default:return s.a.createElement(s.a.Fragment,null)}},[a,V,ce,Q]),de=Object(c.useCallback)(()=>H?[{name:H.name,apiId:H.id}]:[],[H]),pe=s.a.useCallback(function(){var e=A((function*(e){var t,[a]=e,n=yield Object(p.a)({fn:(t=A((function*(){var e=yield Object(D.a)({apiId:a.apiId,environmentId:null==J?void 0:J.name,objectId:ae,telemetryScope:C.h});if(0!==e.length)return Y(!1),e.find(e=>e.name===a.connectionId);oe("getConnectionsWithDetails","Connections not found.")})),function(){return t.apply(this,arguments)})});n?(yield le(n),q(n)):oe("handleOnChangeConnectionReferences","Connection not found.")}));return function(t){return e.apply(this,arguments)}}(),[null==J?void 0:J.name,le]),me=Object(c.useCallback)(()=>{var e=[{type:r.a.line,height:36,width:36},{type:r.a.gap,width:5},{type:r.a.line,height:10,width:"95%"}];return s.a.createElement(s.a.Fragment,null,Array.from({length:4}).map((t,a)=>s.a.createElement(o.a,{key:a,style:{paddingTop:8},shimmerElements:e})))},[]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(n.a,{className:re.stack,horizontal:!0,tokens:{childrenGap:5},verticalFill:!0,wrap:!0},ne()&&s.a.createElement(i.a,{className:re.connectionStackItem},"loading"===G&&me(),s.a.createElement(d.a,{setErrorMessage:e=>{z(e,l.a.error),oe("ConnectionsPickerStandalone",e)},connectionReferences:de(),onChangeConnectionReferences:pe,flowWidgetStyles:b.a,style:Object(b.b)("loading"===G),loadingSpinnerProps:{styles:{root:{display:"none"}}},setLoading:e=>{Z(e?"loading":"loaded")},onConnectionWizardError:()=>{Y(!0)},eventScope:k.a})),s.a.createElement(i.a,{style:ne()?{borderLeftStyle:"solid",borderLeftWidth:"thin",borderLeftColor:b.d.palette.neutralLighter,marginLeft:-24,paddingLeft:12,maxWidth:"unset"}:void 0,grow:!0,shrink:!0},ue())))}},37969:function(e,t,a){"use strict";a.d(t,"d",(function(){return o})),a.d(t,"e",(function(){return i})),a.d(t,"c",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return s}));var n=a(14132),r=a(14130),o=Object(r.a)(n.b.SharePoint),i=Object(r.a)(n.b.SqlServer),l=Object(r.a)(n.b.CommonDataServiceForApps),c=Object(r.a)(n.b.ExcelOnlineBusiness),s="afd-connections"},37970:function(e,t,a){"use strict";a.d(t,"d",(function(){return o})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c}));var n=a(10929),r=a(10979),o=Object(n.Y)(),i=Object(r.c)(()=>Object(n.db)({stack:{paddingTop:15},connectionStackItem:{width:"25%",minWidth:435,marginRight:24,paddingRight:12}})),l={headerContainer:{display:"none"},title:{display:"none"},subtitle:{display:"none"}},c=e=>({height:e?"0%":"100%",visibility:e?"hidden":"visible"})},37971:function(e,t,a){"use strict";a.d(t,"a",(function(){return F}));var n=a(10929),r=a(12714),o=a(12139),i=a(12149),l=a(12839),c=a(12146),s=a(12738),u=a(12715),d=a(12355),p=a(12219),m=a(10926),b=a.n(m),f=a(37972),v=a.n(f),g=a(19500),h=a(37973),y=a(37975),O=a(14132),C=a(14130),S=a(14908),E=a(37952),j=a(11465),T=a(14830);function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){k(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function k(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var P=function(e){return e[e.None=0]="None",e[e.SiteNotFound=1]="SiteNotFound",e[e.InvalidUrl=2]="InvalidUrl",e[e.Default=3]="Default",e}(P||{}),N=Object(n.Y)(),F=e=>{var{t:t}=Object(j.t)("PowerAppsConnections"),{connection:a,onCollectorFulfilled:n,templateType:m}=e,{currentEnvironmentName:f=""}=Object(p.X)(),[w,k]=b.a.useState({site:"",list:""}),[F,D]=b.a.useState(""),[I,L]=b.a.useState(P.None),A=!a,B=Object(T.a)(),R=b.a.useMemo(()=>""!==F?[{id:F,displayName:F}]:void 0,[F]),M=b.a.useCallback(e=>{D(t=>t!==e?(k({site:e,list:""}),e):t)},[F,D,k]),{data:z,isError:W,refetch:_,isInitialLoading:U}=Object(S.c)({connection:a,isV2:!1,telemetryScope:E.a}),{data:H,isError:K,error:V,refetch:q,isInitialLoading:G}=Object(S.e)({connection:a,datasetUrl:w.site,isV2:!1,telemetryScope:E.a}),Z=b.a.useRef(new r.a({}));1===(null==R?void 0:R.length)&&Z.current.setIndexSelected(0,!0,!1);var Q=b.a.useCallback((e,t)=>{e&&k(a=>"Site"===t?{site:e.id,list:""}:x(x({},a),{},{list:e.id}))},[w]),Y=b.a.useCallback(()=>Object(d.g)({currentEnvironmentName:f,connectorType:a&&a.apiName||Object(C.b)(O.b.SharePoint),connectionName:a&&a.name,tableName:w.list,datasetName:w.site,solutionId:B,templateType:m}),[w,a]);b.a.useEffect(()=>{var e=!(!w.site||!w.list);n(e,void 0,e?Y():void 0,e?{tableName:w.list,datasetName:w.site,connectorType:(null==a?void 0:a.apiId)||Object(C.a)(O.b.SharePoint),connectionName:null==a?void 0:a.name}:void 0)},[w,null==a?void 0:a.apiId,null==a?void 0:a.name]);var $=b.a.useCallback((e,t)=>t?e.filter(e=>{var a,n;return e.displayName.toLowerCase().includes(null!==(a=null===(n=t.searchPhrase)||void 0===n?void 0:n.toLowerCase())&&void 0!==a?a:"")}):e,[]),X=b.a.useCallback(e=>{var a=t("SharePointCollector.ColumnName",{columnType:e});return[{key:a,name:a,ariaLabel:a,fieldName:a,minWidth:100,onRender:e=>b.a.createElement(g.a,{styles:{root:{paddingLeft:0},primaryNodeContainer:{width:30,height:30,justifyContent:"center",alignContent:"center",marginTop:6}},text:e.displayName,icons:[{src:v.a,variant:"image"}]})}]},[]),J=b.a.useCallback(()=>{switch(I){case P.InvalidUrl:case P.SiteNotFound:return t("SharePointCollector.InvalidSiteMessage");default:return""}},[I]);b.a.useEffect(()=>{if(K){var e,t,a,n=null==V||null===(e=V.response)||void 0===e?void 0:e.status,r=null==V||null===(t=V.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.errors;404===n?2===(null==r?void 0:r.length)&&"normalized_url"===(null==r?void 0:r[0])?M(r[1]):L(P.SiteNotFound):L(400===n?P.InvalidUrl:P.Default)}else L(P.None)},[K,H]);var ee=b.a.useCallback(()=>I===P.InvalidUrl||I===P.SiteNotFound?[]:R?H?R:[]:z,[z,I,R,H]),te=b.a.useCallback(()=>I===P.InvalidUrl||I===P.SiteNotFound?[]:w.site?H:[],[H,I]),ae=A?N.palette.neutralTertiary:void 0;return b.a.createElement(o.a,{tokens:{childrenGap:10},style:{paddingLeft:16,paddingBottom:32},verticalFill:!0},b.a.createElement(i.a,{required:!0,disabled:A},b.a.createElement(l.a,{variant:"mediumPlus",style:{fontWeight:"bold",color:ae}},t("SharePointCollector.SharePointSiteHeader"))),b.a.createElement(l.a,{variant:"small",style:{marginTop:0,color:ae}},t("SharePointCollector.EnterSharePointURLLabel")),b.a.createElement(c.a,null,b.a.createElement(y.a,{onConnectClick:M,label:t("SharePointCollector.EnterSharePointURL"),errorMessage:J(),disabled:A})),b.a.createElement(c.a,{grow:!0},b.a.createElement(h.a,{pickerLabel:t("SharePointCollector.SiteHeader"),columns:X("Site"),isError:R?I===P.Default:W,isLoading:!((!R||H||K)&&!A)||U,pickerItems:ee(),refetch:_,onQuery:$,checkboxVisibility:s.a.hidden,onActiveItemChanged:e=>Q(e,"Site"),selectionPreservedOnEmptyClick:!0,selectionMode:u.d.single,stringMessages:{emptyState:A?t("SharePointCollector.EmptyStateStringForSite"):void 0},"data-is-scrollable":"true",selection:Z.current})),b.a.createElement(c.a,{grow:!0},b.a.createElement(i.a,{required:!0,disabled:A},b.a.createElement(l.a,{variant:"mediumPlus",style:{fontWeight:"bold",color:ae}},t("SharePointCollector.ListHeader"))),b.a.createElement(h.a,{columns:X("List"),isError:I===P.Default,isLoading:G||A,pickerItems:te(),refetch:q,onQuery:$,checkboxVisibility:s.a.hidden,onActiveItemChanged:e=>Q(e,"List"),selectionPreservedOnEmptyClick:!0,selectionMode:u.d.single,stringMessages:{emptyState:w.site?void 0:t("SharePointCollector.EmptyStateStringForList")},"data-is-scrollable":"true"})))}},37972:function(e,t,a){e.exports=a.p+"static/media/icon_sharepoint.b886de29.svg"},37973:function(e,t,a){"use strict";a.d(t,"a",(function(){return P}));var n=a(12861),r=a(12742),o=a(13256),i=a(12139),l=a(12671),c=a(11675),s=a(12372),u=a(13209),d=a(13205),p=a(12149),m=a(12932),b=a(13286),f=a(11465),v=a(10926),g=a.n(v),h=a(37952),y=a(37974),O=["actionButtonProps","stringMessages","customStyles","pickerItems","pickerLabel","isError","isLoading","refetch"];function C(){return(C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function S(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){T(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function T(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var w=Object(r.k)(Object(r.l)(Object(r.i)(Object(r.c)(o.a)),(e,t)=>j(j({},t),{},{orderBy:e}),e=>{var t;return null!==(t=null==e?void 0:e.orderBy)&&void 0!==t?t:[]})),x=e=>{var{query:t,setQuery:a,actionButtonProps:r,showSearchBar:o,actionButtonToolTipContent:u}=e,{t:d}=Object(f.t)(h.b);return o?g.a.createElement(i.a,{horizontalAlign:"space-between",horizontal:!0},g.a.createElement(n.FilterSearchBox,{strings:{searchBoxPlaceholder:d("SearchablePicker.SearchBoxPlaceholder"),searchBoxClearButtonTitle:d("SearchablePicker.ClearButtonTitle")},searchText:t.searchPhrase||"",onSearchTextChange:(e,t)=>{a({searchPhrase:t})},styles:Object(y.a)()}),r&&g.a.createElement(i.a.Item,{shrink:!1},u?g.a.createElement(l.a,{content:u,id:"actionButtonTooltip",calloutProps:{gapSpace:0},styles:y.d,directionalHint:c.a.bottomCenter},g.a.createElement(s.a,r)):g.a.createElement(s.a,r))):g.a.createElement(g.a.Fragment,null)},k=e=>{var{customStyles:t}=e,a=[{type:u.a.line,height:36,width:36},{type:u.a.gap,width:"2%"},{type:u.a.line,height:26,width:"100%"}],n=Object(y.c)(null==t?void 0:t.pickerHeight,null==t?void 0:t.pickerWidth);return g.a.createElement("div",{className:n.picker},Array.from({length:4}).map((e,t)=>g.a.createElement(d.a,{key:t,className:n.pickerShimmer,shimmerElements:a})))},P=e=>{var t,a,n,r,o,l,c,{actionButtonProps:s,stringMessages:u,customStyles:d,pickerItems:E,pickerLabel:j,isError:T,isLoading:P,refetch:N}=e,F=S(e,O),[D,I]=Object(v.useState)({searchPhrase:""}),[L,A]=Object(v.useState)(!1),B=Object(y.c)(null==d?void 0:d.pickerHeight,null==d?void 0:d.pickerWidth),R=Object(y.b)(null==d?void 0:d.pickerHeight,null==d?void 0:d.pickerWidth),{t:M}=Object(f.t)(h.b);!T&&L?A(!1):T&&!L&&A(!0);var z=L?null!==(t=null===(a=e.stringMessages)||void 0===a||null===(n=a.errorState)||void 0===n?void 0:n.title)&&void 0!==t?t:M("SearchablePicker.ErrorStateString"):null!==(r=null===(o=e.stringMessages)||void 0===o?void 0:o.emptyState)&&void 0!==r?r:M("SearchablePicker.NoResultsFound"),W=null===(l=e.stringMessages)||void 0===l||null===(c=l.errorState)||void 0===c?void 0:c.description;return g.a.createElement(i.a,{horizontal:!1,verticalFill:!0},j&&g.a.createElement(p.a,{className:B.label,disabled:P},j),g.a.createElement(x,{query:D,setQuery:I,actionButtonProps:s,showSearchBar:!P,actionButtonToolTipContent:e.actionButtonToolTipContent}),P?g.a.createElement(k,{customStyles:d}):g.a.createElement(m.a,{styles:R},g.a.createElement(w,C({},F,{query:D,items:E,isHeaderVisible:!1,emptyStateProps:{iconProps:{iconName:"OpenFolderHorizontal"},showPrimaryButton:L,primaryButtonProps:{onClick:()=>{N()},text:M("SearchablePicker.ReloadButton")}},strings:{subComponentStrings:{emptyState:{title:z,description:W}}},onRenderRow:e=>g.a.createElement(b.a,C({},e,{"aria-busy":"true"}))}))))}},37974:function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return s})),a.d(t,"d",(function(){return u}));var n=a(10929),r=a(10979),o=Object(n.Y)(),i="1px solid ".concat(o.palette.neutralSecondary),l=Object(r.c)((e,t)=>Object(n.db)({picker:{padding:8,overflowY:"hidden",overflowX:"hidden",borderRadius:2,border:i,boxSizing:"border-box",height:e||"100%",minHeight:150,width:t},pickerShimmer:{marginTop:10,width:"100%",height:46},label:{marginBottom:5}})),c=Object(r.c)((e,t)=>({root:{borderRadius:2,border:i,boxSizing:"border-box",height:e||"100%",minHeight:150,width:t,position:"relative"}})),s=Object(r.c)(()=>({root:{marginBottom:10,border:i}})),u={root:{display:"inline-block"}}},37975:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(10929),r=a(12661),o=a(12139),i=a(12149),l=a(12671),c=a(11666),s=a(12146),u=a(11824),d=a(11465),p=a(10926),m=a.n(p),b=Object(n.Y)(),f=e=>{var{onConnectClick:t,label:a,onRenderTooltipContent:n,errorMessage:p,disabled:f,tooltipAriaLabel:v}=e,{t:g}=Object(d.t)("PowerAppsConnections"),[h,y]=m.a.useState(""),O=m.a.useMemo(()=>m.a.createElement(r.a,{id:"input-field",onKeyPress:e=>{13===e.charCode&&t(h)},onChange:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";y(a),""===a&&t(a)},errorMessage:p,borderless:!0,styles:{field:{border:"1px solid ".concat(b.palette.neutralSecondary)}},disabled:f,ariaLabel:a}),[p,h,f]);return m.a.createElement(m.a.Fragment,null,m.a.createElement(o.a,{horizontal:!0,tokens:{childrenGap:5}},m.a.createElement(i.a,{htmlFor:"input-filter",disabled:f},a),n&&m.a.createElement(l.a,{content:n},m.a.createElement(c.a,{style:{paddingTop:5},iconName:"Info","aria-label":v,tabIndex:0}))),m.a.createElement(o.a,{horizontal:!0,tokens:{childrenGap:5},id:"input-filter"},m.a.createElement(s.a,{grow:1},O),m.a.createElement(s.a,{grow:0},m.a.createElement(u.a,{text:g("InputFilter"),disabled:""===h||f,onClick:()=>t(h)}))))}},37976:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(12839),r=a(13205),o=a(12139),i=a(12146),l=a(12149),c=a(10926),s=a.n(c),u=a(37975),d=a(37977),p=a(11465),m=e=>{var[t,a]=s.a.useState(""),{t:c}=Object(p.t)("PowerAppsConnections"),m=!e.connection||!e.apiService,b=s.a.useMemo(()=>s.a.createElement("div",{style:{padding:10}},s.a.createElement(n.a,{block:!0},c("ExcelCollector.Tooltip.Part1")),s.a.createElement(n.a,{block:!0},s.a.createElement("i",null,"https://example.com/sites/team")),s.a.createElement(n.a,{block:!0,style:{marginTop:10}},c("ExcelCollector.Tooltip.Part2")),s.a.createElement(n.a,{block:!0},s.a.createElement("ul",null,s.a.createElement("li",null,s.a.createElement(n.a,null,c("ExcelCollector.Tooltip.Part3"))),s.a.createElement("li",null,s.a.createElement(n.a,null,c("ExcelCollector.Tooltip.Part4"))),s.a.createElement("li",null,s.a.createElement(n.a,null,c("ExcelCollector.Tooltip.Part5")))))),[]),f=()=>s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{style:{padding:8,overflowY:"hidden",overflowX:"hidden",borderRadius:2,border:"1px solid",boxSizing:"border-box",height:"80%",minHeight:150}},Array.from({length:8}).map((e,t)=>s.a.createElement(r.a,{key:t,width:"10%",styles:{root:{marginBottom:15,marginLeft:Math.min(20*t,80)}}}))),s.a.createElement("div",{style:{marginTop:20}},s.a.createElement(r.a,{width:"20%",height:20,styles:{root:{marginBottom:15}}}),s.a.createElement(r.a,{width:"20%",height:20,styles:{root:{marginBottom:15}}}),s.a.createElement(r.a,{width:"20%",height:20,styles:{root:{marginLeft:15}}})));return s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{tokens:{childrenGap:15},style:{height:"100%",paddingBottom:30,paddingLeft:16}},s.a.createElement(i.a,{id:"info-label"},s.a.createElement(l.a,{htmlFor:"info-label-description",disabled:m},c("ExcelCollector.Header")),s.a.createElement(n.a,{id:"info-label-description",variant:"medium"},c("ExcelCollector.Description"))),s.a.createElement(i.a,{id:"location"},s.a.createElement(u.a,{onConnectClick:a,label:c("ExcelCollector.LocationFilter"),onRenderTooltipContent:b,disabled:m,tooltipAriaLabel:"".concat(c("ExcelCollector.LocationFilter"),":\n            ").concat(c("ExcelCollector.Tooltip.Part1")," https://example.com/sites/team\n            ").concat(c("ExcelCollector.Tooltip.Part2"),"\n            ").concat(c("ExcelCollector.Tooltip.Part3"),"\n").concat(c("ExcelCollector.Tooltip.Part4")," ").concat(c("ExcelCollector.Tooltip.Part5"))})),s.a.createElement(i.a,{id:"file-tree",grow:!0},s.a.createElement(l.a,{htmlFor:"excel-table-collector",disabled:m},c("ExcelCollector.LabelForExcelTableSelectorTree")),e.connection&&e.apiService?s.a.createElement(d.a,{connection:e.connection,onCollectorFulfilled:e.onCollectorFulfilled,apiService:e.apiService,locationString:t,cacheKey:e.cacheKey,templateType:e.templateType}):s.a.createElement(f,null))))}},37977:function(e,t,a){"use strict";a.d(t,"a",(function(){return C}));var n=a(13052),r=a(21364),o=a(12139),i=a(12146),l=a(12839),c=a(11841),s=a(11870),u=a(37978),d=a(10926),p=a.n(d),m=a(37979),b=a(37970);function f(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?f(Object(a),!0).forEach((function(t){g(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function g(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function h(e,t,a,n,r,o,i){try{var l=e[o](i),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}function y(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function i(e){h(o,n,r,i,l,"next",e)}function l(e){h(o,n,r,i,l,"throw",e)}i(void 0)}))}}var O=Object(r.o)(Object(r.r)(Object(r.s)(n.b))),C=Object(c.a)(e=>{var{onCollectorFulfilled:t,connection:a,locationString:n,templateType:r}=e,[c,s]=p.a.useState(new Map),[d,f]=p.a.useState(),[g,h]=p.a.useState([]),[C,S]=p.a.useState(e.cacheKey),[E,j]=p.a.useState(),[T,w]=p.a.useState(!1),x=p.a.createRef(),{service:k,client:P}=Object(u.b)(e),N=k.getWithContextUtils();p.a.useEffect(()=>{w(!1),""!==n?(N.onSelected({id:n,displayName:"Custom Location"},!0,[{}]),S(n)):(N.resetResults(),S(e.cacheKey)),j(void 0)},[n]);var F=p.a.useCallback(e=>{s(t=>(e.forEach(e=>{t.set(e.id||e.Id,{item:e,resultsSnapShot:k.results})}),t))},[k.results]),D=p.a.useCallback((e,t)=>{var a=c.get(e.key),n=!g.includes(e);a&&a.item&&N.onSelected(a.item,n,n?a.resultsSnapShot:void 0)},[N]),I=p.a.useCallback(function(){var e=y((function*(e){var t=yield N.fetchList();if(t){F(t);var a=N.mapToPickerItems(t,e);return h(a),a}throw new Error("Error loading items")}));return function(t){return e.apply(this,arguments)}}(),[N]),L=p.a.useCallback(function(){var e=y((function*(e,t,a,n,r){var o;"Table"===(null===(o=e.iconProps)||void 0===o?void 0:o.iconName)&&k.result.source&&k.result.drive&&k.result.file&&e.key&&(f(e.key),j(v(v({},k.result),{},{table:e.key})))}));return function(t,a,n,r,o){return e.apply(this,arguments)}}(),[k]);return p.a.createElement(o.a,{tokens:{childrenGap:15},style:{height:"100%"}},p.a.createElement(i.a,{grow:!0},p.a.createElement(O,{initialSelectedItemKeys:new Set(d),onRenderItemLabel:(e,t,a,n,r)=>e.label&&e.key.includes(u.a)?p.a.createElement(l.a,{variant:"small",style:{color:b.d.palette.neutralPrimaryAlt,fontStyle:"italic"}},r()):r(),onItemExpand:D,onItemSelected:L,onLoadItems:I,key:C,cacheKey:C,styles:{root:{height:"100%",minHeight:150,background:b.d.palette.white,border:"solid",borderWidth:"thin"}},strings:{listAriaLabel:""},focusZoneProps:{componentRef:x},listProps:{renderEarly:!0,onPagesUpdated:()=>{if(x.current&&!T){var e,t,a,n,r,o,i;w(!0);var l=document.activeElement;x.current.focus(),null===(e=(t=document.activeElement).blur)||void 0===e||e.call(t),l?null===(a=(n=l).focus)||void 0===a||a.call(n):null===(r=document.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'))||void 0===r||null===(o=r[0])||void 0===o||null===(i=o.focus)||void 0===i||i.call(o)}}}})),p.a.createElement(i.a,null,Object(m.a)({connection:a,client:P,selectedResult:E,onCollectorFulfilled:t,templateType:r})))},[s.r])},37978:function(e,t,a){"use strict";a.d(t,"a",(function(){return h})),a.d(t,"b",(function(){return y}));var n=a(10926),r=a(11021),o=a(19502),i=a(19504),l=a(19505),c=a(19503),s=a(14766),u=a(19515),d=a(19497),p=a(37969),m=a(11465);function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){v(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function v(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function g(e,t,a,n,r,o,i){try{var l=e[o](i),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}var h="empty-child-of-",y=e=>{var{apiService:t,httpClient:a,connection:n}=e,[r]=Object(d.b)(a,n.name,t);return{service:O(r,t,p.a),client:r}},O=(e,t,a)=>{var{t:d}=Object(m.t)("PowerAppsConnections"),[p,b]=n.useState([{}]),v=n.useMemo(()=>p.slice(-1)[0],[p]),y=n.useCallback((e,t,a,n)=>{if(t&&a&&n){var r=e(n);b(a.concat(r))}else{var o=e(v);b(e=>e.concat(o))}},[v,p,b]),{properties:{swagger:O}}=t,C=Object(l.j)(O),S=n.useMemo(()=>Array.from(Object(o.a)(O,v,e,C)),[v,p]),E=S.map(e=>e.key),j=e=>C.reduce((t,a)=>t&&!!e[a.name],!0);return{getWithContextUtils:n.useMemo(()=>()=>{var e,n,p=E.findIndex((e,t)=>{var a,n;return void 0===v[e]||(null===(a=(n=S[t]).isIntermediate)||void 0===a?void 0:a.call(n,v.$selected))}),m=S[p>=0?p:S.length-1],O=Object(o.b)(m),C="Table"===m.title;return{mapToPickerItems:(e,t)=>{var a=e.map(e=>{var t,a=(t=e,Object(l.g)(t)?"FabricFolder":Object(l.h)(c.a.excelWorkBook)(t)?"ExcelDocument":"Table"===m.title?"Table":void 0);return{key:e.id||e.Id,label:O(e),level:p,disableFocus:!1,disableSelection:!C,isFolder:!C,iconProps:a?{iconName:a}:void 0}});return 0===a.length&&t&&a.push({key:"".concat(h).concat(t),label:d(C?"ExcelCollector.NoTableFoundMessage":"ExcelCollector.EmptyFolderMessage"),level:p,disableFocus:!1,disableSelection:!C,isFolder:!1}),a},fetchList:(e=function*(){try{return yield m.fetchItems()}catch(n){var e=Object(s.b)(n);return void Object(r.U)(a,{eventName:u.a.ExcelFlowCollector,eventData:{apiService:t.name,name:e.name,message:e.message}})}},n=function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function i(e){g(o,n,r,i,l,"next",e)}function l(e){g(o,n,r,i,l,"throw",e)}i(void 0)}))},function(){return n.apply(this,arguments)}),onSelected:(e,t,a)=>{if(t&&a){var n=a.slice(-1)[0],r=E.findIndex((e,t)=>{var a,r;return void 0===n[e]||(null===(a=(r=S[t]).isIntermediate)||void 0===a?void 0:a.call(r,n.$selected))}),l=S[r>=0?r:S.length-1],c=f(f({},n),{},{[l.key]:l.resolvePickedValue(e),$selected:e,$display:f(f({},n.$display),{},{[l.key]:l.isIntermediate&&Object(i.a)("Path")(e)?e.Path:Object(o.b)(l)(e)})});j(c)?b(a.slice(0,-1).concat(c)):y(t=>f(f({},t),{},{[l.key]:c[l.key],$selected:e,$display:c.$display}),t,a,n)}else{var s=f(f({},v),{},{[m.key]:m.resolvePickedValue(e),$selected:e,$display:f(f({},v.$display),{},{[m.key]:m.isIntermediate&&Object(i.a)("Path")(e)?e.Path:Object(o.b)(m)(e)})});j(s)?b(e=>e.slice(0,-1).concat(s)):y(t=>f(f({},t),{},{[m.key]:s[m.key],$selected:e,$display:s.$display}),t)}},resetResults:()=>b([{}]),step:m,title:m.title}},[S,v,t,p]),result:v,results:p}}},37979:function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n=a(12139),r=a(12680),o=a(12149),i=a(12671),l=a(11666),c=a(12948),s=a(14130),u=a(14132),d=a(12217),p=a(14766),m=a(12219),b=a(10926),f=a.n(b),v=a(11465),g=a(14830);function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){O(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function O(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function C(e,t,a,n,r,o,i){try{var l=e[o](i),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}function S(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function i(e){C(o,n,r,i,l,"next",e)}function l(e){C(o,n,r,i,l,"throw",e)}i(void 0)}))}}var E=function(e){return e.AutoGenerated="0",e.ManualSelect="1",e}(E||{}),j=e=>{var{client:t,selectedResult:a,onCollectorFulfilled:b,connection:h,templateType:O}=e,{currentEnvironmentName:C=""}=Object(m.X)(),[j,T]=f.a.useState([]),[w,x]=f.a.useState(),[k,P]=f.a.useState(E.AutoGenerated),{t:N}=Object(v.t)("PowerAppsConnections"),F=Object(g.a)(),D=!a,I=f.a.useMemo(()=>[{key:E.AutoGenerated,text:N("ExcelCollector.TableColumnOption.AutoGenerateOption")},{key:E.ManualSelect,text:N("ExcelCollector.TableColumnOption.ManualSelectOption"),onRenderField:(e,t)=>f.a.createElement(n.a,{horizontal:!0},t(e),f.a.createElement(r.a,{style:{width:200,marginTop:25,marginLeft:-156},selectedKey:null==w?void 0:w.key,onChange:(e,t)=>{x(t)},options:j,disabled:A,"aria-label":N("ExcelCollector.TableColumnOption.ManualSelectOption")}))}],[w,j]),L=f.a.useCallback(S((function*(){try{yield t.invoke("CreateIdColumn",y(y({},a),{},{idColumn:"__PowerAppsId__",populateColumn:"true"}))}catch(e){if(!e.toString().includes("409"))throw Object(p.b)(e)}})),[t]),A=k===E.AutoGenerated,B=f.a.useCallback(()=>{if(a)return Object(d.p)({currentEnvironmentName:C,connectorType:h&&h.apiName||Object(s.b)(u.b.ExcelOnlineBusiness),connectionName:h&&h.name,datasetName:"".concat(a.source,",").concat(a.drive,",").concat(a.file),tableName:a.table,solutionId:F,primaryKeyFieldName:A?"__PowerAppsId__":null==w?void 0:w.key.toString(),templateType:O})},[a,C,h,k,w,O]);return f.a.useEffect(()=>{a&&(t.invoke("GetColumns",a).then(e=>{T(e.value.map(e=>({key:e.name,text:e.displayName}))),x(j[0])}),b(!0,A?L:void 0,B()))},[a,k]),f.a.createElement(f.a.Fragment,null,f.a.createElement(n.a,{horizontal:!0,tokens:{childrenGap:5}},f.a.createElement(o.a,{disabled:D},N("ExcelCollector.TableColumnOption.Header")),f.a.createElement(i.a,{content:N("ExcelCollector.TableColumnOption.Tooltip")},f.a.createElement(l.a,{style:{paddingTop:5},iconName:"Info","aria-label":"".concat(N("ExcelCollector.TableColumnOption.Header"),":\n            ").concat(N("ExcelCollector.TableColumnOption.Tooltip")),tabIndex:0}))),f.a.createElement(c.a,{defaultSelectedKey:k,options:I,onChange:(e,t)=>t&&P(t.key),id:"primaryKeyChoice",disabled:D}))}},37980:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(10926),r=a(13773),o=a(19509);function i(e,t,a,n,r,o,i){try{var l=e[o](i),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}function l(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function l(e){i(o,n,r,l,c,"next",e)}function c(e){i(o,n,r,l,c,"throw",e)}l(void 0)}))}}var c=e=>{var{httpClient:t,apiAudience:a,apiHost:i,apiVersion:c,environmentName:s}=e,u=Object(o.a)(t,a,i,c),d=Object(r.b)();return n.useCallback(function(){var e=l((function*(e){var t,a={queryFn:(t=l((function*(){var{data:t}=yield u("GET","/api/invoke",{"x-ms-path-query":"".concat(e,"?api-version=").concat(c,"&%24filter=environment+eq+%27").concat(s,"%27")});return t})),function(){return t.apply(this,arguments)}),queryKey:[e,c,s,"useApiService"],staleTime:1/0};return yield d.fetchQuery(a)}));return function(t){return e.apply(this,arguments)}}(),[u,s,c])}},37981:function(e,t,a){"use strict";a.d(t,"a",(function(){return C}));var n=a(12738),r=a(12715),o=a(12709),i=a(10926),l=a.n(i),c=a(19500),s=a(37973),u=a(12217),d=a(12219),p=a(13396),m=a(37982),b=a(11465),f=a(37950),v=a(37952),g=a(37951),h=a(37983),y=a.n(h),O=a(14915),C=e=>{var t,{onCollectorFulfilled:a,navigateToStep:h,templateType:C,isDataAccessEnabled:S}=e,E=Object(i.useRef)(),{solutionData:j}=Object(f.a)(v.a),{data:T,isLoading:w,isError:x,refetch:k,error:P}=Object(g.a)({solutionUniqueName:null==j||null===(t=j.solution)||void 0===t?void 0:t.uniqueName}),{currentEnvironmentName:N=""}=Object(d.X)(),{t:F}=Object(b.t)("PowerAppsConnections"),D=Object(O.a)(P),[I,L]=Object(i.useState)(),[A,B]=Object(i.useState)();Object(i.useEffect)(()=>(void 0!==I&&B(F("DataverseCollector.FilteredItemsAnnouncement",{count:I})),()=>{B(void 0)}),[I]);var R=Object(i.useMemo)(()=>[{key:"DataverseTables",name:F("DataverseCollector.ColumnName"),ariaLabel:F("DataverseCollector.ColumnName"),fieldName:F("DataverseCollector.ColumnName"),minWidth:100,onRender:e=>l.a.createElement(c.a,{styles:Object(m.b)(),text:e.displayName,subText:e.schemaName,icons:[{src:y.a,variant:"image"}]})}],[]),M=Object(i.useCallback)((e,t)=>{a(!1),E.current=void 0;var n=e.filter(e=>{var a;return e&&(!(null!=t&&t.searchPhrase)||(null===(a=e.displayName)||void 0===a?void 0:a.toLocaleLowerCase().includes(null==t?void 0:t.searchPhrase.toLocaleLowerCase())))});return L(n.length),n},[]),z=Object(i.useCallback)((e,t,n)=>{if(e&&e!==E.current){var r,o,{logicalName:i,entitySetName:l}=e;E.current=e,a(!0,void 0,Object(u.p)({currentEnvironmentName:N,logicalName:i,tableName:l,solutionId:null!==(r=null==j||null===(o=j.solution)||void 0===o?void 0:o.id)&&void 0!==r?r:d.s,templateType:C}))}else e||a(!1)},[]),W=!1===S;return l.a.createElement(l.a.Fragment,null,l.a.createElement(s.a,{pickerItems:T,refetch:k,isError:x,isLoading:w,columns:R,onQuery:M,checkboxVisibility:n.a.hidden,onActiveItemChanged:z,selectionMode:r.d.single,actionButtonProps:{text:F("DataverseCollector.CreateTableButton"),onRenderIcon:()=>l.a.createElement("span",{style:{width:20,height:20}},l.a.createElement(p.g,null)),styles:m.a,onClick:()=>{h("CreateTableFromBlank")},disabled:W},actionButtonToolTipContent:W?F("DataverseCollector.CreateTableButtonTooltip"):void 0,stringMessages:{errorState:{description:D}}}),A&&l.a.createElement(o.a,{"aria-live":"assertive",message:A}))}},37982:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r}));var n=()=>({root:{paddingLeft:0},primaryNodeContainer:{width:30,height:30,justifyContent:"center",alignContent:"center",marginTop:6,backgroundColor:"#088142"}}),r={root:{width:"15%",whiteSpace:"nowrap"}}},37983:function(e,t,a){e.exports=a.p+"static/media/icon_dataverse.51f7e288.svg"},37984:function(e,t,a){"use strict";a.d(t,"a",(function(){return S}));var n=a(12139),r=a(12738),o=a(12715),i=a(10926),l=a.n(i),c=a(37985),s=a(37973),u=a(12217),d=a(12219),p=a(14130),m=a(14132),b=a(19500),f=a(37986),v=a(11465),g=a(37952),h=a(37987),y=a.n(h),O=a(14908),C=a(14830),S=e=>{var t,{connection:a,onCollectorFulfilled:h,templateType:S}=e,E=Object(i.useRef)(),{currentEnvironmentName:j=""}=Object(d.X)(),T=null==a||null===(t=a.connectionParameter)||void 0===t?void 0:t.name,w=Object(O.a)(T),[x,k]=Object(i.useState)(""),[P,N]=Object(i.useState)(""),{t:F}=Object(v.t)("PowerAppsConnections"),{tables:D,refetch:I,isError:L,isInitialLoading:A,datasetUrl:B,errorMessage:R}=Object(O.b)({connection:a,serverName:x,databaseName:P,isV2:!0,telemetryScope:g.a}),M=Object(C.a)();Object(i.useEffect)(()=>{k(""),N("")},[a]);var z=Object(i.useMemo)(()=>[{key:"SQLTables",name:F("SQLCollector.ColumnName"),ariaLabel:F("SQLCollector.ColumnName"),fieldName:F("SQLCollector.ColumnName"),minWidth:100,onRender:e=>l.a.createElement(b.a,{styles:Object(c.a)(),text:e.displayName,icons:[{src:y.a,variant:"image"}]})}],[a]),W=Object(i.useCallback)((e,t)=>(h(!1),E.current=void 0,e.filter(e=>{var a,n;return e&&(null===(a=e.displayName)||void 0===a?void 0:a.toLocaleLowerCase().includes((null==t||null===(n=t.searchPhrase)||void 0===n?void 0:n.toLocaleLowerCase())||""))})),[]),_=Object(i.useCallback)((e,t,n)=>{e&&e!==E.current&&a?(E.current=e,h(!0,void 0,Object(u.p)({currentEnvironmentName:j,connectorType:a.apiName||Object(p.b)(m.b.SqlServer),connectionName:a.name,tableName:e.id,datasetName:B,solutionId:M,templateType:S}))):e&&a||h(!1)},[a,B]),U=F(w?"SQLCollector.PickerLabel.WithNumberedList":"SQLCollector.PickerLabel.WithoutNumberedList");return l.a.createElement(n.a,{tokens:{childrenGap:10},style:{paddingLeft:16},verticalFill:!0},l.a.createElement(l.a.Fragment,null,w&&l.a.createElement(f.a,{label:F("SQLCollector.ServerConnectorLabel"),onConnect:(e,t)=>{k(e),N(t)}}),l.a.createElement(s.a,{columns:z,isError:L,refetch:I,isLoading:A||!a,pickerItems:D,onQuery:W,checkboxVisibility:r.a.hidden,onActiveItemChanged:_,selectionMode:o.d.single,stringMessages:{emptyState:w?F("SQLCollector.RequiresServerConnection"):void 0,errorState:{description:R}},pickerLabel:U})))}},37985:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=()=>({root:{paddingLeft:0},primaryNodeContainer:{width:30,height:30,justifyContent:"center",alignContent:"center",marginTop:6,backgroundColor:"#b1151a"}})},37986:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(10929),r=a(12149),o=a(12139),i=a(12661),l=a(11823),c=a(11465),s=a(10926),u=a.n(s),d=Object(n.Y)(),p=e=>{var{onConnect:t,label:a}=e,[n,s]=u.a.useState(""),[p,m]=u.a.useState(""),[b,f]=u.a.useState(),{t:v}=Object(c.t)("PowerAppsConnections");u.a.useEffect(()=>{f(!n.trim()||!p.trim())},[n,p]);var g={field:{border:"1px solid ".concat(d.palette.neutralSecondary)}};return u.a.createElement(u.a.Fragment,null,u.a.createElement(r.a,null,a),u.a.createElement(o.a,{tokens:{childrenGap:15},styles:{root:{marginBottom:15}}},u.a.createElement(i.a,{label:v("SQLCollector.ServerLabel"),id:"server-name",required:!0,onChange:(e,t)=>{s(null!=t?t:"")},placeholder:v("SQLCollector.ServerConnectorPlaceHolderText"),borderless:!0,styles:g}),u.a.createElement(i.a,{label:v("SQLCollector.DatabaseLabel"),id:"database-name",required:!0,onChange:(e,t)=>{m(null!=t?t:"")},borderless:!0,styles:g}),u.a.createElement(l.a,{text:"Connect",styles:{root:{width:"fit-content"}},disabled:b,onClick:()=>{f(!0),t(n,p)}})))}},37987:function(e,t,a){e.exports=a.p+"static/media/icon_sql.6880dd3b.svg"},37988:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(10929),r=()=>Object(n.db)({title:{fontWeight:n.l.semibold,padding:"0px 0px 5px 0px"},subtitle:{padding:"5px 0px 5px 0px"}})},37991:function(e,t,a){"use strict";a.d(t,"a",(function(){return j})),a.d(t,"b",(function(){return T}));var n=a(10926),r=a.n(n),o=a(37898),i=a(22590),l=a(37992),c=a(12217),s=a(37993),u=a(37917),d=a(37918),p=a(11465),m=a(37949),b=a(37893),f=a(38e3),v=a(38001);function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){y(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function y(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var O=i.a.CreateTableFromBlank,C=()=>{var e=Object(d.a)(),{t:t}=Object(p.t)(b.k);return e?r.a.createElement("div",null,r.a.createElement(p.c,{t:t,i18nKey:"createTableFromBlankStep.leftContentSubtitleTableFlow",components:{b:r.a.createElement("b",null)}})):r.a.createElement(r.a.Fragment,null)},S=()=>{var{t:e}=Object(p.t)(b.k),t=e("createTableFromBlankStep.leftContentTitle");return r.a.createElement(m.a,{title:t,subtitle:()=>r.a.createElement(C,null)})},E=()=>{var{onTableCreated:e}=Object(l.a)(c.k.Blank);return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,{busyState:f.a,onTableCreated:e}))};function j(){var{t:e}=Object(p.t)(b.k);return{key:O,title:u.e,leftContent:S,rightContent:E,buttonStates:o.c,onStepLoadedAriaLabel:e("createTableFromBlankStep.leftContentTitle")}}function T(e){var{t:t}=Object(p.t)(b.k);return h(h({},j()),{},{title:u.c,leftContent:void 0,rightContent:()=>r.a.createElement(s.a,{stringOverrides:{completeButtonLabel:t("common.buttons.saveAndClose")},solutionId:e.solutionId,busyState:v.a,onTableCreated:t=>{e.onTableCreated(t.persistedTableData.logicalName)}})})}},37992:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(11205),r=a(37914),o=a(12219),i=a(12217),l=a(37893),c=a(37918),s=e=>{var t=Object(n.i)(),{switchEnvironment:a}=Object(o.bb)(),{currentEnvironmentName:s}=Object(o.X)(),u=Object(c.a)();return{onTableCreated:n=>{var o,{action:c,appName:d,solutionId:p,switchToDevEnvironment:m,devEnvironment:b,persistedTableData:f,templateType:v}=n,{logicalName:g,entitySetName:h,metadataId:y}=f,O=n.switchToDevEnvironment?null===(o=n.devEnvironment)||void 0===o?void 0:o.name:s;if(u){l.i.createTableRedirectTableHub({type:e,action:c});var C=Object(r.b)(O,y,!0);t.push(C)}else{l.i.createTableRedirectCreateApp({type:e,action:c});var S=c===i.b?Object(i.w)(O,g,h,p,d,e):Object(i.p)({currentEnvironmentName:O,tableName:h,solutionId:p,logicalName:g,templateType:v});m?(t.replace("/environments/".concat(null==b?void 0:b.name,"/home")),a(b,S)):t.push(S)}}}}},37993:function(e,t,a){"use strict";a.d(t,"a",(function(){return T}));var n=a(12139),r=a(12217),o=a(37950),i=a(37570),l=a(37574),c=a(37883),s=a(37635),u=a(11465),d=a(37885),p=a(10926),m=a.n(p),b=a(37994),f=a(37893),v=a(37995),g=a(37996),h=a(22590),y=a(37997),O=a(37998),C=a(37999),S=a(37886),E=a(13807),j=h.a.CreateTableFromBlank,T=e=>{var t,a,{busyState:T,onTableCreated:w,stringOverrides:x,solutionId:k}=e;Object(O.a)(h.a.CreateTableFromBlank);var{solutionData:P,solutionIsLoading:N}=Object(o.a)(f.j,k),{table:F}=(()=>{var e=Object(E.jb)(),{t:t}=Object(u.t)(f.k),a=Object(o.c)(f.j),n=Object(o.b)(f.j),r=t("createTableFromBlankStep.blankTableDisplayName"),i=Object(b.a)(),[l,d]=Object(p.useState)(),{uniqueSchemaName:m,isInitialLoading:v}=Object(c.a)({newTableName:r,solutionUniqueName:a,customizationPrefix:n});return!v&&n&&m&&!l&&d(Object(s.g)({languageCode:i,customizationPrefix:n,tableDisplayName:r,customPrefixedSchemaName:m,tablePluralDisplayName:t("createTableFromBlankStep.blankTablePluralDisplayName"),primaryNameColumnDisplayName:t("createTableFromBlankStep.blankTablePrimaryColumnDisplayName"),changeTrackingEnabled:!e,isOfflineInMobileClient:!e})),{table:l}})(),[D,I]=Object(p.useState)(F),{t:L}=Object(u.t)(f.k),{getStepKeys:A,updateFooterButton:B}=Object(d.b)(),{label:R}=Object(C.a)();R=(null==x?void 0:x.completeButtonLabel)||R;var[M,z]=Object(p.useState)(!0),W=null===(t=A())||void 0===t?void 0:t.backStepKey,_=F&&P&&!N,U=!(null===(a=A())||void 0===a||!a.backStepKey),{isUniqueSchemaName:H}=Object(g.a)({schemaName:null==D?void 0:D.entity.SchemaName}),{isCreateModalVisible:K}=Object(v.a)({t:L,table:D,stepKey:j,canCreateTable:H&&M,solutionData:P,previousStepKey:W,switchToDevEnvironment:!1,tableCreationType:r.k.Blank,onTableCreated:w});return Object(p.useEffect)(()=>{void 0!==F&&I(F)},[F]),Object(p.useEffect)(()=>B(S.c.Back,{isHidden:!U}),[U]),Object(p.useEffect)(()=>{B(S.c.Complete,{label:R})},[]),m.a.createElement(m.a.Fragment,null,K&&m.a.createElement(T,null),_&&m.a.createElement(n.a,{className:y.a.seeExperienceInFullScreen},m.a.createElement(i.a,{table:F,classNames:{commandBarWrapper:y.a.commandBarWrapper,commandBarControl:y.a.commandBarControl},isLoading:N,solutionContext:null==P?void 0:P.solution,configurationType:l.a.Blank,onUpdate:e=>{I(e.table),z(e.canBeSaved)}})))}},37994:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(12219),r=()=>{var{currentEnvironment:e}=Object(n.W)();return e&&Object(n.E)(e)||1033}},37995:function(e,t,a){"use strict";var n=a(11934),r=a(37885),o=a(37886),i=a(10926),l=a(37893),c=a(22590),s=a(37914),u=a(37574),d=a(37636),p=a(12217),m=a(13737);function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){v(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function v(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}t.a=e=>{var t,{t:a,table:b,stepKey:v,sessionId:g,solutionData:h,canCreateTable:y,previousStepKey:O,onTableCreated:C}=e,S=g?{sessionId:g}:{},E=O?{previousStepKey:O}:{},{updateFooterButton:j,showMessage:T}=Object(r.b)(),[w,x]=Object(i.useState)(!1),{mutate:k,isSuccess:P,data:N,isLoading:F,isError:D,error:I}=Object(d.a)(),L=Object(m.e)({isSolutionFirst:!1}),{getValue:A}=Object(r.c)();if(O===c.a.ConnectionsMicrosoftDataverse&&(t=A("templateType")),Object(i.useEffect)(()=>{j(o.c.Complete,{onClick:()=>{var e,t=null==h||null===(e=h.solution)||void 0===e?void 0:e.uniqueName;t&&b&&(k({inMemoryTable:b,solutionUniqueName:t,enableSingleSaveApi:!1,configurationType:u.a.Blank,isPreferredSolutionFeatureEnabled:L}),x(!0))},isEnabled:y})},[b,y]),!F&&P&&N){var B,R,M;l.i.createTableCreateAppSuccess(f(f({stepKey:v},E),S));var z=null!==(B=null==h||null===(R=h.solution)||void 0===R?void 0:R.id)&&void 0!==B?B:"",W=null!==(M=null==b?void 0:b.entity.DisplayName.LocalizedLabels[0].Label)&&void 0!==M?M:"";C({action:t?p.a:p.b,appName:W,persistedTableData:N,solutionId:z,templateType:t})}else if(!F&&D&&I&&w){var _,U,H,K=null===(_=I.response)||void 0===_||null===(U=_.data)||void 0===U||null===(H=U.error)||void 0===H?void 0:H.message,V=Object(s.c)(I,a);l.i.createTableCreateAppFailure(f(f({stepKey:v,errorMessage:V,originalError:K},S),E)),x(!1),T(a("common.errors.createAppError",{error:V}),n.a.error)}return{isCreateModalVisible:w}}},37996:function(e,t,a){"use strict";var n=a(11630),r=a(11934),o=a(37950),i=a(37883),l=a(11465),c=a(37885),s=a(37893),u=Object(n.a)("uniqueSchemaNameMessageBar");t.a=e=>{var{schemaName:t}=e,{showMessage:a,clearMessage:n,isMessageShown:d}=Object(c.b)(),p=d(u),m=Object(o.c)(s.j),{t:b}=Object(l.t)(s.k),f=b("common.components.uniqueSchemaNameMessageBar.errorMessage"),{isLoading:v,isUniqueSchemaName:g}=Object(i.b)({schemaName:t,solutionUniqueName:m});return!t||v||g||p?g&&p&&n(u):a(f,r.a.warning,{onDismiss:void 0},u),{isUniqueSchemaName:g}}},37997:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c}));var n=a(10929);function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var{palette:i}=Object(n.Y)(),l=()=>({seeExperienceInFullScreen:{height:"calc(100% + 48px)",margin:"-24px"},commandBarWrapper:{paddingBottom:20},commandBarControl:{borderBottom:"1px solid ".concat(i.neutralLight)}}),c=Object(n.db)(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},l()))},37998:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(22590),r=a(37885),o=a(37922),i=[{conditions:{isDataAccessEnabled:!1,isDataverse:!1},redirectStep:n.a.StartWithData}],l=new Map([[n.a.CreateTableFromBlank,i],[n.a.CreateTableFromExcel,i],[n.a.CreateTableFromSharePoint,i],[n.a.ConfigureTableFromSharePoint,i],[n.a.CreateAppFromExistingTable,[{conditions:{isDataverse:!1},redirectStep:n.a.StartWithData}]],[n.a.CreateTable,[{conditions:{isNLTableCreationEnabled:!1},redirectStep:n.a.NotFound}]]]),c=(e,t)=>{var{navigateToStep:a}=Object(r.b)(),n=Object(o.a)();if(!n.isLoading){var i,c=l.get(e);if(c)for(var s=function(e){var a=c[e];if(Object.keys(a.conditions).some(e=>n[e]===a.conditions[e]))return i=null!=t?t:a.redirectStep,"break"},u=0;u<c.length;u++){if("break"===s(u))break}return i&&a(i),null}}},37999:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(37918),r=a(11465),o=a(37893),i=e=>{var t=Object(n.a)(e),{t:a}=Object(r.t)(o.k);return{label:a(t?"common.buttons.create":"common.buttons.createApp")}}},38e3:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(10926),r=a.n(n),o=a(37918),i=a(38001),l=a(37941),c=e=>{var{forceIsTableCreationFlow:t}=e,a=Object(o.a)(t);return r.a.createElement(r.a.Fragment,null,a?r.a.createElement(i.a,null):r.a.createElement(l.a,{isVisible:!0}))}},38001:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(10926),r=a.n(n),o=a(11698),i=a(11940),l=a(11942),c=a(11465),s=a(38002),u=a(37893),d=()=>{var{t:e}=Object(c.t)(u.k);return r.a.createElement(o.a,{className:s.a.overlay},r.a.createElement(i.a,{size:l.a.large,label:e("common.labels.creatingTable"),ariaLabel:e("common.labels.creatingTable"),ariaLive:"assertive",labelPosition:"bottom"}))}},38002:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(10929),{palette:r}=Object(n.Y)(),o=Object(n.db)({overlay:{display:"flex",justifyContent:"center",backgroundColor:r.white,opacity:.9,zIndex:99999}})},38003:function(e,t,a){"use strict";a.d(t,"a",(function(){return F})),a.d(t,"d",(function(){return D})),a.d(t,"b",(function(){return L})),a.d(t,"e",(function(){return A})),a.d(t,"c",(function(){return B}));var n=a(10926),r=a.n(n),o=a(11860),i=a(12139),l=a(37893),c=a(21727),s=a(37898),u=a(22590),d=a(38004),p=a(11465),m=a(38020),b=a(12088),f=a(14760),v=a(12219),g=a(21519),h=a(37992),y=a(12217),O=a(38e3),C=a(37917),S=a(37918),E=a(38021),j=a(38001),T=a(11859),w=a(13448);function x(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?x(Object(a),!0).forEach((function(t){P(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):x(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function P(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var N=()=>{var{t:e}=Object(p.t)(l.k),t=Object(S.a)(),a=Object(m.a)();return r.a.createElement(i.a,{tokens:{childrenGap:24}},r.a.createElement(i.a.Item,null,r.a.createElement("h2",{className:a.title},e("createTableFromExcelStep.fileUploadLeftContentTitle"))),r.a.createElement(i.a.Item,null,r.a.createElement("div",{className:a.subtitle},e("createTableFromExcelStep.fileUploadLeftContentFirstSubtitle1"),!t&&" ".concat(e("createTableFromExcelStep.fileUploadLeftContentFirstSubtitle2")))))},F=(e,t,a,n)=>{var o=Object(m.a)(),l=Object(S.a)(),s=l?"createTableFromExcelStep.tableDetailsLeftContentTitleTableFlow":"createTableFromExcelStep.tableDetailsLeftContentTitle",u={copilotDescription:e("createTableFromExcelStep.tableDetailsLeftContentSecondSubtitle"),copilotLinkTitle:e("createTableFromExcelStep.tableDetailsLeftContentLink"),copilotLink:c.a.aboutCreateAnAppFromExcelTables};return r.a.createElement(i.a,{tokens:{childrenGap:24}},r.a.createElement(i.a.Item,null,r.a.createElement("h2",{className:o.title},e(s))),r.a.createElement(i.a.Item,null,r.a.createElement("div",{className:o.subtitle},r.a.createElement(p.c,{t:e,i18nKey:l?(null==n?void 0:n.rowCount)<20?"createTableFromExcelStep.tableDetailsLeftContentLessThanTwentyRowsFirstSubtitleTable":"createTableFromExcelStep.tableDetailsLeftContentFirstSubtitleTable":(null==n?void 0:n.rowCount)<20?"createTableFromExcelStep.tableDetailsLeftContentLessThanTwentyRowsFirstSubtitleApp":"createTableFromExcelStep.tableDetailsLeftContentFirstSubtitleApp",components:{b:r.a.createElement("b",null)}}))),(a||!t)&&r.a.createElement(E.a,{usingFallbackLogic:t,useSummaryCard:a,summaryContentInfo:n,copilotContentInfo:u}))},D=e=>{var{t:t,rowCount:a,usingFallbackLogic:n}=e,i="";return(a||0)>=20&&(i="".concat(t("createTableFromExcelStep.rowsPreview",{numberOfRows:a}),".")),r.a.createElement(r.a.Fragment,null,Object(T.c)(t(n?"createTableFromExcelStep.simplifiedCopilotMessageFallback":"createTableFromExcelStep.simplifiedCopilotMessage",{previewMessage:i}),(e,t)=>{switch(t){case 0:return r.a.createElement("b",null,e);case 1:return r.a.createElement(o.a,{target:"_blank",href:w.a.aiGATerms,underline:!0},e);default:return r.a.createElement(r.a.Fragment,null)}}))},I=()=>{var{onTableCreated:e}=Object(h.a)(y.k.Excel);return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{busyState:O.a,onTableCreated:e}))};function L(){var{t:e}=Object(p.t)(l.k);return{key:u.a.CreateTableFromExcel,title:C.b,leftContent:N,rightContent:I,buttonStates:s.c,onStepLoadedAriaLabel:e("createTableFromExcelStep.fileUploadLeftContentTitle")}}function A(e){var{t:t}=Object(p.t)(l.k);return k(k({},L()),{},{title:C.c,leftContent:void 0,rightContent:()=>r.a.createElement(d.a,{stringOverrides:{completeButtonLabel:t("common.buttons.saveAndClose")},useSimplifiedLeftContent:!0,solutionId:e.solutionId,busyState:j.a,onTableCreated:t=>{e.onTableCreated(t.persistedTableData.logicalName)}})})}var B=()=>{var e,t,{currentEnvironment:a}=Object(v.W)(),{isInitialLoading:n,data:r,error:o}=Object(f.g)({environment:a,solutionName:"msdyn_SmartDataImportBase",telemetryScope:b.a});return!n&&!o&&Object(g.a)(null!==(e=null==r||null===(t=r.solution)||void 0===t?void 0:t.version)&&void 0!==e?e:"","1.0.0.13")}},38004:function(e,t,a){"use strict";a.d(t,"a",(function(){return L}));var n=a(10926),r=a.n(n),o=a(12219),i=a(11934),l=a(11465),c=a(38005),s=a(37570),u=a(12088),d=a(37574),p=a(12217),m=a(37885),b=a(37886),f=a(37893),v=a(38003),g=a(38018),h=a(37914),y=a(37883),O=a(37996),C=a(37997),S=a(37950),E=a(37998),j=a(22590),T=a(22600),w=a(12139),x=a(37636),k=a(37999),P=a(13737),N=a(38019);function F(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?F(Object(a),!0).forEach((function(t){I(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):F(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function I(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var L=e=>{var t,a,n,F,I,{busyState:L,onTableCreated:A,stringOverrides:B,solutionId:R,useSimplifiedLeftContent:M}=e;Object(E.a)(j.a.CreateTableFromExcel);var{t:z}=Object(l.t)(f.k),{solutionData:W,solutionIsLoading:_}=Object(S.a)(u.a,R),{currentEnvironmentName:U}=Object(o.X)(),H=null==W?void 0:W.solution,[K,V]=r.a.useState(!1),[q,G]=r.a.useState(!1),[Z,Q]=r.a.useState(!1),[Y,$]=r.a.useState(!1),[X,J]=r.a.useState(""),[ee,te]=r.a.useState(void 0),[ae,ne]=r.a.useState([]),[re,oe]=r.a.useState(void 0),[ie,le]=r.a.useState([]),[ce,se]=r.a.useState([]),[ue,de]=r.a.useState([]),[pe,me]=r.a.useState(void 0),[be,fe]=r.a.useState(),[ve,ge]=r.a.useState([]),[he,ye]=r.a.useState(!1),[Oe,Ce]=r.a.useState(!0),[Se,Ee]=r.a.useState(!0),[je,Te]=r.a.useState(""),[we,xe]=r.a.useState(""),{updateFooterButton:ke,showMessage:Pe,setContent:Ne,clearMessages:Fe,clearMessage:De,setWarnOnNavigate:Ie,isWarningOnNavigate:Le,getStepKeys:Ae}=Object(m.b)(),{getValue:Be}=Object(m.c)(),Re=Object(T.b)(),Me=Object(T.c)(),ze=Object(T.d)(),{mutate:We,isSuccess:_e,data:Ue,isLoading:He,isError:Ke,error:Ve}=Object(x.a)(),{label:qe}=Object(k.a)();qe=(null==B?void 0:B.completeButtonLabel)||qe;var Ge=null==ee?void 0:ee.SchemaName.split("_")[1],{uniqueSchemaName:Ze,isInitialLoading:Qe}=Object(y.a)({newTableName:Ge,solutionUniqueName:null==H?void 0:H.uniqueName,customizationPrefix:null==H||null===(t=H.publisher)||void 0===t?void 0:t.customizationPrefix}),{isUniqueSchemaName:Ye}=Object(O.a)({schemaName:null==pe||null===(a=pe.entity)||void 0===a?void 0:a.SchemaName}),$e=Object(P.e)({isSolutionFirst:!1}),Xe=!Object(v.c)()&&void 0,Je=!(null===(n=Ae())||void 0===n||!n.backStepKey);r.a.useEffect(()=>{null!=re&&re.RecordId&&ze&&M&&Pe(Object(v.d)({t:z,rowCount:(null==re?void 0:re.RowCount)||0,usingFallbackLogic:Y}),i.a.success,void 0,"ExcelSummaryCard")},[null==re?void 0:re.RecordId,ze,M,Y]),r.a.useEffect(()=>{var e=Be("setStepDetails");return null==e||e({fileRecordId:null==re?void 0:re.RecordId,usingFallbackLogic:Y,tableCreationType:p.k.Excel}),()=>{null==e||e(void 0)}},[null==re?void 0:re.RecordId,Y]),r.a.useEffect(()=>{K?(f.e.loadingDataFromExcel({isLoading:K}),Fe()):X?(f.e.errorFromExcel({errorFromExcel:X}),Pe(X,i.a.error,void 0,"ErrorMessage")):(De("TypeChangedMessage"),De("ErrorMessage"))},[K,X,z]),r.a.useEffect(()=>{!Qe&&Ze&&be&&fe(D(D({},be),{},{entity:D(D({},be.entity),{},{SchemaName:Ze})}))},[Qe,Ze]),r.a.useEffect(()=>ke(b.c.Back,{isHidden:!Je}),[Je]);var et=r.a.useCallback(()=>{var e=ze&&!(null==re||!re.ColumnCount);return Object(v.a)(z,Y,e,{mainTitle:z("createTableFromExcelStep.fileUploadedTittle"),contentTitle:z("createTableFromExcelStep.file"),contentName:we,columnCount:(null==re?void 0:re.ColumnCount)||0,rowCount:(null==re?void 0:re.RowCount)||0})},[z,Y,ze,we,null==re?void 0:re.ColumnCount,null==re?void 0:re.RowCount]);r.a.useEffect(()=>{q||Z?Pe(r.a.createElement(N.a,{t:z}),i.a.info,void 0,"TypeChangedMessage"):De("TypeChangedMessage")},[q,Z]),r.a.useMemo(()=>{if(ee){var e,t;f.e.hasInferenceDataFromExcel({dataLength:null==ae?void 0:ae.length,hasHeader:null==re?void 0:re.HasHeader,hasPrimaryColumn:null==re?void 0:re.HasPrimaryColumn,usingFallbackLogic:Y,columnCount:null==re?void 0:re.ColumnCount,rowCount:null==re?void 0:re.RowCount,localeString:Object(l.h)()}),M||Ne(b.a.Left,et);var a={fileInfo:re,data:ae,entity:ee,autoNumberSeeds:{}};if(null!=re&&re.AttributesMapping){var n=null!=re&&re.AttributesMapping?Object.entries(null==re?void 0:re.AttributesMapping).map(e=>{var[t,a]=e;return{AttributeSchemaName:t,ColumnIndex:a}}):[];le(n)}var r=[];if(null!=re&&re.FirstRow&&(r=Object.entries(null==re?void 0:re.FirstRow).map(e=>{var[t,a]=e;return{AttributeLogicalName:t,AttributeDisplayName:a}}),se(r)),Ee(!(null==re||!re.HasPrimaryColumn)),(null==re||!re.HasPrimaryColumn)&&null!=ee&&null!==(e=ee.Attributes)&&void 0!==e&&e.length){var o=Object(g.e)(ee.Attributes);f.e.noPrimaryColumn({primaryColumn:o}),Te(o)}me(a),de(Object(g.b)(null==a||null===(t=a.entity)||void 0===t?void 0:t.Attributes)),Ce(!(null==re||!re.HasHeader)),ge(ae),null!=re&&re.HasHeader?fe(Object(g.c)(a,r)):fe(a)}},[ee,ae,re,et,M]);var tt={title:z("createTableStep.navigationPreventionDialogTitle"),subText:z("createTableStep.navigationPreventionDialogSubtitle"),confirmButtonLabel:z("createTableStep.navigationPreventionDialogLeaveButton"),cancelButtonLabel:z("createTableStep.navigationPreventionDialogStayButton")},at=K||He||!_e&&(!!re||!!be);at!==Le&&Ie(at,tt);return r.a.useEffect(()=>{if(He)f.e.createTableLoading();else if(_e&&Ue&&U){var e,t,a,n=(null==pe||null===(e=pe.entity)||void 0===e||null===(t=e.DisplayName)||void 0===t||null===(a=t.LocalizedLabels[0])||void 0===a?void 0:a.Label)||"";f.e.createTable({appName:n,currentEnvironmentName:U,solutionId:null==H?void 0:H.id,usingFallbackLogic:Y}),A({action:p.b,appName:n,persistedTableData:Ue,solutionId:null==H?void 0:H.id})}else if(Ke&&Ve){var r,o,l,c=null===(r=Ve.response)||void 0===r||null===(o=r.data)||void 0===o||null===(l=o.error)||void 0===l?void 0:l.message,s=Object(h.c)(Ve,z);Pe(z("common.errors.createAppError",{error:s}),i.a.error,void 0,"ErrorMessage"),f.e.createTableError({errorMessage:s,originalError:c})}},[He,Ue,_e,null==H?void 0:H.id,U,null==pe||null===(F=pe.entity)||void 0===F?void 0:F.DisplayName,Ke,Ve,Y]),r.a.useEffect(()=>{ke(b.c.Complete,{onClick:()=>{var e=null==H?void 0:H.uniqueName;if(pe&&e){var t;f.e.createTableInitiate({solutionUniqueName:e}),Object(g.h)(null==pe||null===(t=pe.entity)||void 0===t?void 0:t.Attributes,Se,je,ie);var a=Object(g.a)(ie);We({inMemoryTable:{fileInfo:D({RecordId:null==re?void 0:re.RecordId,HasHeader:Oe,AttributesMapping:a},Re?{SourceTimeZone:Re}:{}),useUserSettings:Me,data:pe.data,entity:pe.entity,autoNumberSeeds:pe.autoNumberSeeds},solutionUniqueName:e,enableSingleSaveApi:!0,configurationType:d.a.ImportExcel,isPreferredSolutionFeatureEnabled:$e}),Fe()}},isEnabled:Ye&&he,label:qe})},[Oe,pe,Ye,he,null==H?void 0:H.uniqueName,re,ie,Se,je,$e]),r.a.createElement(r.a.Fragment,null,(He||_e)&&r.a.createElement(L,null),!be&&r.a.createElement(c.a,{publisherCustomizationPrefix:null==H||null===(I=H.publisher)||void 0===I?void 0:I.customizationPrefix,parseSampleData:Xe,setIsLoading:V,setTableDefinition:te,setTableSampleData:ne,setFileInfo:oe,setErrorFromExcel:J,setUsingFallbackLogic:$,setFileName:xe}),(K||be)&&r.a.createElement(w.a,{className:C.a.seeExperienceInFullScreen},r.a.createElement(s.a,{table:be,classNames:{commandBarWrapper:C.a.commandBarWrapper,commandBarControl:C.a.commandBarControl},useFirstRowAsColumnHeaders:Oe,setUseFirstRowAsColumnHeaders:e=>{if(Ce(e),e){var t;de(Object(g.b)(null==pe||null===(t=pe.entity)||void 0===t?void 0:t.Attributes)),pe&&(pe.data=(null==ve?void 0:ve.map(e=>e))||[]);var a=pe;null!=re&&re.HasHeader||!a||(a=Object(g.i)(a)),fe(Object(g.c)(a,ce))}else{var n=pe;null!=re&&re.HasHeader||!n?n=Object(g.g)(pe,ce,ve):n.data=(null==ve?void 0:ve.map(e=>e))||[],fe(Object(g.d)(n,ue))}f.e.toggleFirstRowAsColumnHeaders({current:Oe,newChoice:e})},isLoading:_||K,solutionContext:H,configurationType:d.a.ImportExcel,dataPayloadFormat:Xe?d.b.Dataverse:d.b.ExcelAndConnectorInference,onUpdate:e=>{var t,a,n,{hasColumSchemaNameChanged:r,fileInfoUpdatedMap:o,firstRowUpdatedMap:i,firstHeaderInfoMap:l,newDefaultPrimaryColumnName:c,tableUpdatedData:s}=Object(g.f)(ie,ce,ue,null===(t=e.table)||void 0===t||null===(a=t.entity)||void 0===a?void 0:a.Attributes,je,ve);r&&(le(o),se(i),de(l),ge(s),je&&!Se&&Te(c),f.e.hasColumSchemaNameChanged({defaultPrimaryColumnName:je,hasPrimaryColumn:Se})),me(e.table),ye(e.canBeSaved),Q(!(null===(n=e.validationErrors)||void 0===n||!n.hasDataErrors)),e.columnDataTypeWasUpdated&&G(!0)}})))}},38005:function(e,t,a){"use strict";a.d(t,"a",(function(){return C}));var n=a(10926),r=a.n(n),o=a(11623),i=a(11625),l=a(11465),c=a(38006),s=a(38009),u=a(38011),d=a(11021),p=a(12088),m=a(21622),b=a(38013),f=a(38014),v=a(38015);function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){y(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function y(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var O=Object(o.a)(),C=Object(i.a)(Object(l.s)("PowerappsPortalEntities")(e=>{var{t:t,publisherCustomizationPrefix:a,parseSampleData:n,setIsLoading:o,setErrorFromExcel:i,setTableDefinition:l,setTableSampleData:b,setFileInfo:g,setUsingFallbackLogic:y,setFileName:C,styles:S,theme:E}=e,j=O(S,{theme:E}),[T,w]=r.a.useState(null),[x,k]=r.a.useState(null),[P,N]=r.a.useState(!0),[F,D]=r.a.useState(!1),I=r.a.useRef(null),{containerHeight:L}=Object(f.a)({containerRef:I}),A=!!L&&L<400,{uploadFile:B,reset:R,isUploading:M,errorMessage:z}=Object(s.a)(),W=r.a.useCallback(e=>{w(e),k(null),e&&B&&B(e).then(t=>{null!=t&&t.RecordId?(k(t.RecordId),C(e.name)):k(null)})},[B]),{isInitialLoading:_,tableDefinition:U,tableSampleData:H,fileInfo:K,usingFallbackLogic:V,errorMessage:q,retry:G}=Object(u.a)(x,a,n,!M),Z=r.a.useCallback(()=>{k(null),N(!0),D(!1),R()},[R]),Q=r.a.useCallback(()=>{x?G():(R(),W(T))},[T,R,W,G]);r.a.useEffect(()=>{M||_?(o(!0),N(!1),D(!1)):!_&&(q||U||z)&&(o(!1),(q||z)&&(N(!1),D(!0)))},[_,M,U,q,z]),r.a.useEffect(()=>{q||z?(i(null!=q?q:""),Object(d.U)(p.a,{eventName:m.o.TableFromExcelError,eventData:{uploadErrorMessage:z,tableDefinitionErrorMessage:q,lastSuccessfulRecordId:x}})):i("")},[z,q]),r.a.useEffect(()=>{!_&&U&&(l(h(h({},U),{},{ChangeTrackingEnabled:!0,IsOfflineInMobileClient:{Value:!0}})),b(H||[]),g(K),y(V))},[_,U,H,K,V]);var Y=r.a.useMemo(()=>r.a.createElement("div",{ref:I,className:j.fullHeight},r.a.createElement(c.a,{disabled:M,isShortContainer:A,onFileAccepted:W})),[M,W]),$=r.a.useMemo(()=>r.a.createElement(v.a,{errorTitle:t("TableFromExcel.UploadErrorTitle"),errorSubtitle:t("TableFromExcel.UploadErrorSubtitle"),defaultButtonTitle:t("TableFromExcel.SelectAnotherFile"),defaultButtonOnClick:Z,primaryButtonTitle:t("TableFromExcel.TryAgain"),primaryButtonOnClick:Q}),[t,Z,Q]);return r.a.createElement(r.a.Fragment,null,P?Y:F?$:r.a.createElement(r.a.Fragment,null))}),b.a)},38006:function(e,t,a){"use strict";a.d(t,"a",(function(){return C}));var n=a(10926),r=a.n(n),o=a(11623),i=a(11625),l=a(11823),c=a(11666),s=a(11672),u=a(12149),d=a(12139),p=a(12146),m=a(25086),b=a(11465),f=a(38007),v=a.n(f),g=a(38008),h=a(19450),y=Object(o.a)(),O=["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel.sheet.binary.macroEnabled.12","application/vnd.ms-excel"],C=Object(i.a)(Object(b.s)("PowerappsPortalEntities")(e=>{var{t:t,onFileAccepted:a,disabled:n,isShortContainer:o=!1,theme:i,styles:b}=e,{enableCsvTypeForCreateTableFromExcel:f}=Object(h.c)(),g=y(b,{theme:i,isShortContainer:o}),C=r.a.useCallback(e=>{e[0]&&a&&a(e[0])},[a]),S=r.a.useRef(null),E=r.a.useCallback(()=>{var e;null===(e=S.current)||void 0===e||e.open()},[S.current]),j=r.a.useCallback((e,a)=>e?r.a.createElement(d.a,{horizontal:!0,verticalAlign:"center"},r.a.createElement(p.a,null,r.a.createElement(c.a,{iconName:"Completed",className:g.supportedIcon})),r.a.createElement(p.a,null,r.a.createElement(u.a,null,t("TableFromExcel.DropZoneFileSupportedText")))):a?r.a.createElement(d.a,{horizontal:!0,verticalAlign:"center"},r.a.createElement(p.a,null,r.a.createElement(c.a,{iconName:"Blocked2",className:g.notSupportedIcon})),r.a.createElement(p.a,null,r.a.createElement(u.a,null,t("TableFromExcel.DropZoneFileNotSupportedText")))):r.a.createElement(d.a,{horizontalAlign:"center",className:g.dropzoneContentContainer},!o&&r.a.createElement(p.a,null,r.a.createElement(s.a,{className:g.dropzoneImage,src:v.a,alt:t("TableFromExcel.DropZoneText")})),r.a.createElement(p.a,null,r.a.createElement(u.a,{className:g.titleLabel},t("TableFromExcel.DropZoneText"))),r.a.createElement(p.a,null,r.a.createElement(u.a,{className:g.subtitleLabel},t(f?"TableFromExcel.DropZoneSupportedExtensionsTextWithCsv":"TableFromExcel.DropZoneSupportedExtensionsText"))),r.a.createElement(p.a,null,r.a.createElement(l.a,{disabled:!!n,onClick:E,className:g.selectButton},t("TableFromExcel.BrowseFile")))),[o,E]);return f&&O.push("text/csv"),r.a.createElement(m.a,{ref:S,disabled:!!n,accept:O,className:g.dropzoneBase,acceptClassName:g.dropzoneAccept,rejectClassName:g.dropzoneReject,disableClick:!0,multiple:!1,onDropAccepted:C,inputProps:{"aria-label":t("TableFromExcel.DropZoneText")}},e=>{var{isDragAccept:t,isDragReject:a}=e;return j(t,a)})}),g.a)},38007:function(e,t,a){e.exports=a.p+"static/media/fileUploadBanner.ee248ad8.svg"},38008:function(e,t,a){"use strict";function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}a.d(t,"a",(function(){return i}));var i=e=>{var{theme:t,isShortContainer:a}=e,{palette:n}=t,o={fontSize:20,margin:"4px 0px",paddingRight:"10px",verticalAlign:"middle"},i=[a&&{maxHeight:"100%"}],l=[a&&{marginBottom:20}];return{dropzoneBase:[{flex:1,display:"flex",flexDirection:"column",height:"100%",overflow:"auto",alignItems:"center",justifyContent:"center",padding:20,borderWidth:2,borderStyle:"dashed",borderColor:(null==n?void 0:n.themePrimary)||"#742774",borderRadius:8,outline:"none",transition:"border .24s ease-in-out"},a&&{paddingTop:15,paddingBottom:15}],dropzoneAccept:{backgroundColor:"#F6E4F6",borderStyle:"solid !important",borderColor:(null==n?void 0:n.themePrimary)||"#742774"},dropzoneReject:{backgroundColor:(null==n?void 0:n.neutralLighter)||"#F3F2F1",borderStyle:"dashed",borderColor:(null==n?void 0:n.neutralTertiary)||"#A19F9D"},supportedIcon:r(r({},o),{},{color:(null==n?void 0:n.green)||"#107C10"}),notSupportedIcon:r(r({},o),{},{color:"#A80000"}),dropzoneContentContainer:i,dropzoneImage:{paddingBottom:15},titleLabel:{fontSize:18,fontWeight:600},subtitleLabel:{fontSize:18,fontWeight:400,paddingTop:0,paddingBottom:20},selectButton:l}}},38009:function(e,t,a){"use strict";a.d(t,"a",(function(){return P}));var n=a(10926),r=a(11031),o=a(12295),i=a(11868),l=a(11021),c=a(12088),s=a(14441),u=a(21622),d=a(38010);function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){b(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function f(e,t,a,n,r,o,i){try{var l=e[o](i),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}function v(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function i(e){f(o,n,r,i,l,"next",e)}function l(e){f(o,n,r,i,l,"throw",e)}i(void 0)}))}}var g="https://cds-org/api/data/v9.0/InitializeTemporaryFileBlocksUpload";function h(e){return y.apply(this,arguments)}function y(){return(y=v((function*(e){var t=yield i.f.post(g,e.input);if(null!=t&&t.data&&t.data.RecordId&&t.data.FileContinuationToken)return t.data;throw new Error("Bad response during initialization")}))).apply(this,arguments)}function O(e){return C.apply(this,arguments)}function C(){return(C=v((function*(e){if(!(yield i.f.post("https://cds-org/api/data/v9.0/UploadBlock",e.input)))throw new Error("Bad response during block upload")}))).apply(this,arguments)}function S(e,t){return{FileContinuationToken:t,BlockId:btoa(Object(r.a)()),BlockData:e.content}}function E(e,t,a,n,r){return j.apply(this,arguments)}function j(){return(j=v((function*(e,t,a,n,r){for(var o=[],i=0;i<e;i++){var l=yield t.readNextChunkAsBase64();if(l.status===d.a.Reading&&o.push(l),l.status===d.a.Complete){l.startByte<l.endByte&&o.push(l);break}}var c=[],s=[];return o.forEach(e=>{var t=S(e,a);c.push(t.BlockId),s.push(n({input:t,scenario:r}))}),yield Promise.all(s),c}))).apply(this,arguments)}function T(){return(T=v((function*(e,t,a,n){if(e&&t){for(var r=[],o=new d.b(e,{chunkSize:4194304}),i=yield E(4,o,t,a,n);i&&i.length>0;)r=r.concat(i),i=yield E(4,o,t,a,n);return r}return null}))).apply(this,arguments)}function w(e){return x.apply(this,arguments)}function x(){return(x=v((function*(e){var t=yield i.f.post("https://cds-org/api/data/v9.0/CommitFileBlocksUpload",e.input);if(null!=t&&t.data&&t.data.FileId&&t.data.FileSizeInBytes)return t.data;throw new Error("Bad response during commit")}))).apply(this,arguments)}function k(e){return Math.min(Math.random()*2**(e+1)*500,2e4)}function P(){var[e,t]=Object(n.useState)(!1),[a,r]=Object(n.useState)(""),{mutateAsync:i}=Object(o.a)(h,{retry:2,retryDelay:k,onError:(e,a)=>{var n,o=Object(s.f)(e);r(Object(s.f)(e)),t(!1),null==a||null===(n=a.scenario)||void 0===n||n.failure({initError:o})}}),{mutateAsync:d}=Object(o.a)(w,{retry:5,retryDelay:k,onError:(e,a)=>{var n,o=Object(s.f)(e);r(Object(s.f)(e)),t(!1),null==a||null===(n=a.scenario)||void 0===n||n.failure({commitError:o})}}),{mutateAsync:p}=Object(o.a)(O,{retry:2,retryDelay:k,onError:(e,a)=>{var n,o=Object(s.f)(e);r(Object(s.f)(e)),t(!1),null==a||null===(n=a.scenario)||void 0===n||n.failure({blockUploadError:o})}});return{uploadFile:function(){var e=v((function*(e){t(!0);var a=Object(l.N)(c.a,u.o.FileColumnUploadScenarioName,{fileSize:e.size,fileType:e.type}),n={FileName:e.name,FileSize:e.size},r=yield i({input:n,scenario:a});if(r){a.progress({initRecordId:r.RecordId});var o=yield function(e,t,a,n){return T.apply(this,arguments)}(e,r.FileContinuationToken,p,a);if(o){a.progress({uploadedBlockCount:o.length||0,parallelBlockUploadCount:4});var s={FileName:e.name,MimeType:e.type,BlockList:o,FileContinuationToken:r.FileContinuationToken},b=yield d({input:s,scenario:a});if(null!=b&&b.FileId)return a.complete({initRecordId:r.RecordId,commitFileSize:null==b?void 0:b.FileSizeInBytes,commitFileId:null==b?void 0:b.FileId,parallelBlockUploadCount:4}),t(!1),m(m({},b),{},{RecordId:r.RecordId})}}return t(!1),null}));return function(t){return e.apply(this,arguments)}}(),reset:()=>{t(!1),r("")},isUploading:e,errorMessage:a}}},38010:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return o}));var n=function(e){return e[e.Invalid=0]="Invalid",e[e.Reading=1]="Reading",e[e.Complete=2]="Complete",e[e.Canceled=3]="Canceled",e}({});class r{constructor(){this.status=void 0,this.content=void 0,this.startByte=void 0,this.endByte=void 0,this.progressPercent=void 0,this.errorMessage=void 0,this.status=n.Reading,this.content=null,this.startByte=0,this.endByte=0,this.progressPercent=0,this.errorMessage=null}}class o{constructor(e,t){this.startByte=void 0,this.chunkSize=void 0,this.reader=void 0,this.file=void 0,this.file=e,this.startByte=0,this.chunkSize=t.chunkSize||100,this.reader=new FileReader}readNextChunkAsBase64(){var e=this;return new Promise((t,a)=>{if(!e.file)return a("File has been disposed");var o=e.chunkSize,i=e.startByte+o;if(!(e.file.size>0))return a(e.getInvalidFileReadResult("File has no content"));i>e.file.size&&(i=e.file.size),e.reader.onload=a=>{var o=new r;if(e.file){var l=a.target.result;o.content=l.split("base64,")[1],o.progressPercent=i/e.file.size,o.progressPercent>=1?(o.progressPercent=1,o.status=n.Complete):o.status=n.Reading,o.startByte=e.startByte,o.endByte=i,e.startByte=i}else o=e.getInvalidFileReadResult("File is unavailable");return t(o)},e.reader.onerror=a=>{var n=e.getFileReadErrorMessage(a),r=e.getInvalidFileReadResult(n);t(r)};var l=e.file.slice(e.startByte,i,e.file.type);e.reader.readAsDataURL(l)})}dispose(){this.file&&(this.file=null)}getFileReadErrorMessage(e){var t;switch(e.target.error.code){case e.target.error.NOT_FOUND_ERR:t="File not found";break;case e.target.error.NOT_READABLE_ERR:t="File not readable";break;case e.target.error.ABORT_ERR:t="File read aborted";break;default:t="File read error"}return t}getInvalidFileReadResult(e){var t=new r;return t.status=n.Invalid,t.errorMessage=e,t}}},38011:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(38012),r=a(11466),o=a(12088),i=a(22600);function l(e,t,a,l){var c,s,u,{t:d}=Object(r.g)("PowerappsPortalEntities"),p=d("Common.Request.Failed"),m=Object(i.b)(),b=Object(i.c)(),{isInitialLoading:f,data:v,error:g,refetch:h}=Object(n.a)({recordId:e,publisherCustomizationPrefix:t,parseSampleData:a,sourceTimeZone:m||void 0,useUserSettings:!!b||void 0,telemetryScope:o.a,defaultErrorMessage:p,enableQuery:l}),y=g?(null===(c=g.response)||void 0===c||null===(s=c.data)||void 0===s||null===(u=s.error)||void 0===u?void 0:u.message)||g.message||p:"";return{isInitialLoading:f,tableDefinition:null!=v&&v.EntityDefinition?JSON.parse(null==v?void 0:v.EntityDefinition):void 0,tableSampleData:null!=v&&v.SampleData?JSON.parse(null==v?void 0:v.SampleData):[],fileInfo:null!=v&&v.FileInfo?JSON.parse(null==v?void 0:v.FileInfo):void 0,usingFallbackLogic:!(null==v||!v.UsingFallbackLogic),errorMessage:y,retry:h}}},38012:function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return f}));var n=a(12313),r=a(11868),o=a(13769),i=a(12219),l=a(11021),c=a(13556);function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){d(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function d(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function p(e,t,a,n,r,o,i){try{var l=e[o](i),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}function m(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function i(e){p(o,n,r,i,l,"next",e)}function l(e){p(o,n,r,i,l,"throw",e)}i(void 0)}))}}function b(e){var{recordId:t,publisherCustomizationPrefix:a,parseSampleData:s,sourceTimeZone:d,useUserSettings:p,telemetryScope:b,defaultErrorMessage:f,enableQuery:v}=e,{currentEnvironment:g,hasDataverse:h}=Object(i.W)(),y=Object(o.a)({eventScope:b,scenarioName:c.g.inferTableDefinition,eventData:void 0,team:l.j.PowerappsPortal,teamPriority:l.f.Medium}),O=Object(c.h)(c.d.DataExperience,c.e.DataFetchHooks),C=!!(v&&t&&g&&h),{data:S,error:E,refetch:j,isInitialLoading:T}=Object(n.a)([t,null==g?void 0:g.name],m((function*(){var e={team:l.j.PowerappsPortal},n=yield r.f.post("https://cds-org/api/data/v9.0/InferEntityDefinition",{RecordId:t,SolutionPrefix:a,ParseSampleData:s,SourceTimeZone:d,UseUserSettings:p},e);if(null==n||!n.data)throw new Error(f);return n.data})),{enabled:C,onSuccess:e=>{var n,r=null!=e&&e.EntityDefinition?JSON.parse(null==e?void 0:e.EntityDefinition):void 0,o=null!=e&&e.SampleData?JSON.parse(null==e?void 0:e.SampleData):void 0;null==y||y.complete(u({recordId:t,publisherCustomizationPrefix:a,columnsLength:null==r||null===(n=r.Attributes)||void 0===n?void 0:n.length,rowLength:null==o?void 0:o.length,sourceTimeZone:d,parseSampleData:s,useUserSettings:p},O))},onError:e=>null==y?void 0:y.failure(u(u({},e),O))});return{data:S,error:E,refetch:j,isInitialLoading:T}}function f(e){var{dataSourceInfo:t,userContext:a,recordId:s,solutionPrefix:d,telemetryScope:p,defaultErrorMessage:b,enableQuery:f}=e,{currentEnvironment:v,hasDataverse:g}=Object(i.W)(),h=Object(o.a)({eventScope:p,scenarioName:c.g.inferTableDefinitionV2,eventData:void 0,team:l.j.PowerappsPortal,teamPriority:l.f.Medium}),y=Object(c.h)(c.d.DataExperience,c.e.DataFetchHooks),O=!!(f&&null!=t&&t.EntityDefinition&&v&&g),{data:C,error:S,refetch:E,isRefetching:j,isInitialLoading:T}=Object(n.a)(["powerapps-ui-common","InferTableDefinitionV2",null==v?void 0:v.name,s,null==t?void 0:t.EntityDefinition],m((function*(){var e={team:l.j.PowerappsPortal},n=yield r.f.post("https://cds-org/api/data/v9.0/InferEntityDefinition",u(u({},t),{},{UserContext:JSON.stringify(a),RecordId:s,SolutionPrefix:d}),e);if(null==n||!n.data)throw new Error(b);return n.data})),{enabled:O,onSuccess:e=>{var t,a,n,r,o,i,l,c,s;try{l=null!=e&&e.EntityDefinition?JSON.parse(null==e?void 0:e.EntityDefinition):void 0,c=null!=e&&e.SampleData?JSON.parse(null==e?void 0:e.SampleData):void 0,s=null!=e&&e.FileInfo?JSON.parse(null==e?void 0:e.FileInfo):void 0}catch(O){var d,p,m,f,v,g;throw null==h||h.complete(u({hasParsingError:!0,columnsLength:null===(d=l)||void 0===d||null===(p=d.Attributes)||void 0===p?void 0:p.length,rowLength:null===(m=c)||void 0===m?void 0:m.length,usingFallbackLogic:null==e?void 0:e.UsingFallbackLogic,recordId:null===(f=s)||void 0===f?void 0:f.RecordId,sourceTimeZone:null===(v=s)||void 0===v?void 0:v.SourceTimeZone,hasHeader:null===(g=s)||void 0===g?void 0:g.HasHeader},y)),new Error(b)}null==h||h.complete(u({columnsLength:null===(t=l)||void 0===t||null===(a=t.Attributes)||void 0===a?void 0:a.length,rowLength:null===(n=c)||void 0===n?void 0:n.length,usingFallbackLogic:null==e?void 0:e.UsingFallbackLogic,recordId:null===(r=s)||void 0===r?void 0:r.RecordId,sourceTimeZone:null===(o=s)||void 0===o?void 0:o.SourceTimeZone,hasHeader:null===(i=s)||void 0===i?void 0:i.HasHeader},y))},onError:e=>null==h?void 0:h.failure(u(u({},e),y))});return{data:C,error:S,refetch:E,isRefetching:j,isInitialLoading:T}}},38013:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=e=>({titleLabel:{fontSize:18,fontWeight:600},subtitleLabel:{fontSize:18,fontWeight:400,paddingTop:0,paddingBottom:20},fullHeight:{height:"100%"},errorStateWrapper:{display:"flex",height:"100%",overflow:"auto",alignItems:"center",justifyContent:"center",padding:20},errorBannerImage:{paddingBottom:15}})},38014:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(10926),r=a.n(n),o=a(12945);function i(e){var{containerRef:t}=e,[a,n]=r.a.useState(0);return r.a.useEffect(()=>{if(t.current){var e=new o.a(e=>{var t,a;n((null===(t=e[0])||void 0===t||null===(a=t.contentRect)||void 0===a?void 0:a.height)||0)});return e.observe(t.current),()=>{t.current&&e.unobserve(t.current)}}return()=>{}},[t.current]),{containerHeight:a}}},38015:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(10926),r=a.n(n),o=a(12149),i=a(12139),l=a(12146),c=a(11824),s=a(11823),u=a(38016),d=a.n(u),p=a(38017),m=a(11672),b=e=>{var{errorTitle:t,errorSubtitle:a,defaultButtonTitle:n,defaultButtonOnClick:u,primaryButtonTitle:b,primaryButtonOnClick:f}=e;return r.a.createElement("div",{className:p.a.errorStateWrapper},r.a.createElement(i.a,{horizontalAlign:"center",tokens:{padding:20}},r.a.createElement(l.a,null,r.a.createElement(m.a,{className:p.a.errorBannerImage,src:d.a,alt:t})),r.a.createElement(l.a,null,r.a.createElement(o.a,{className:p.a.titleLabel},t)),r.a.createElement(l.a,null,r.a.createElement(o.a,{className:p.a.subtitleLabel},a)),r.a.createElement(l.a,null,r.a.createElement(i.a,{tokens:{childrenGap:8},horizontal:!0},r.a.createElement(c.a,{onClick:u},n),r.a.createElement(s.a,{onClick:f},b)))))}},38016:function(e,t,a){e.exports=a.p+"static/media/errorStateBanner.38db1dfc.svg"},38017:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(10929);function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var i=Object(n.db)(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},{errorStateWrapper:{display:"flex",height:"100%",overflow:"auto",alignItems:"center",justifyContent:"center",padding:20},errorBannerImage:{paddingBottom:15},titleLabel:{fontSize:18,fontWeight:600},subtitleLabel:{fontSize:18,fontWeight:400,paddingTop:0,paddingBottom:20}}))},38018:function(e,t,a){"use strict";a.d(t,"f",(function(){return l})),a.d(t,"h",(function(){return c})),a.d(t,"e",(function(){return s})),a.d(t,"b",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"d",(function(){return m})),a.d(t,"a",(function(){return f})),a.d(t,"i",(function(){return v})),a.d(t,"g",(function(){return g}));var n=a(37893);function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l=(e,t,a,r,i,l)=>{var c=e,s=t,u=a,d=l,p=!1,m="",b="",f=i;try{var v;if(c=null===(v=e||[])||void 0===v?void 0:v.map(e=>{var t;return-1===(null==r?void 0:r.findIndex(t=>{var a,n;return(null===(a=t.SchemaName)||void 0===a?void 0:a.toLowerCase())===(null===(n=e.AttributeSchemaName)||void 0===n?void 0:n.toLowerCase())}))&&null!=r&&r.length?(m=e.AttributeSchemaName,p=!0,b=(null===(t=r[e.ColumnIndex])||void 0===t?void 0:t.SchemaName)||m,n.e.columnSchemaNameChanged({currentSchemaName:m,newSchemaName:b}),i&&i===m&&(f=b),o(o({},e),{},{AttributeSchemaName:b})):e}),p){var g,h,y=null===(g=m)||void 0===g?void 0:g.toLowerCase(),O=null===(h=b)||void 0===h?void 0:h.toLowerCase(),C=null==t?void 0:t.findIndex(e=>{var t;return(null===(t=e.AttributeLogicalName)||void 0===t?void 0:t.toLowerCase())===y});s[C]=o(o({},t[C]),{},{AttributeLogicalName:O});var S=null==a?void 0:a.findIndex(e=>{var t;return(null===(t=e.AttributeSchemaName)||void 0===t?void 0:t.toLowerCase())===y});u[S]=o(o({},a[S]),{},{AttributeSchemaName:b});try{d.map(e=>(e[O]=e[y],delete e[y],e))}catch(E){n.e.errorFromExcel({Error:"Unexpected Error - getUpdatedFileInfoAttributeMapping - could not update data",e:E})}}}catch(E){n.e.errorFromExcel({Error:"Unexpected Error - getUpdatedFileInfoAttributeMapping - could not update attribute mapping in file info after column schema name change",e:E})}return{hasColumSchemaNameChanged:p,fileInfoUpdatedMap:c,firstRowUpdatedMap:s,firstHeaderInfoMap:u,newDefaultPrimaryColumnName:f,tableUpdatedData:d}},c=(e,t,a,r)=>{var o,i=r;try{if(!t&&a&&null!=r&&r.length&&(o=s(e))!==a){var l=null==r?void 0:r.findIndex(e=>{var t;return(null===(t=e.AttributeSchemaName)||void 0===t?void 0:t.toLowerCase())===(null==a?void 0:a.toLowerCase())});return-1!==l&&r.splice(l,1),n.e.removeDefaultPrimaryColumnIfUpdated({hasPrimaryColumn:t,defaultPrimaryColumnName:a,currentPrimaryColumnName:o,primaryColumnIndex:l,attributesMappingLength:null==r?void 0:r.length,currentAttributeMappingLength:null==i?void 0:i.length}),r}}catch(c){n.e.errorFromExcel({Error:"Unexpected Error - removeDefaultPrimaryColumnIfUpdated",e:c,hasPrimaryColumn:t,defaultPrimaryColumnName:a,currentPrimaryColumnName:o,attributesMappingLength:null==r?void 0:r.length,currentAttributeMappingLength:null==i?void 0:i.length})}return r},s=e=>{var t;return(null===(t=e.find(e=>e.IsPrimaryName))||void 0===t?void 0:t.SchemaName)||""},u=e=>{var t=[];try{var a,r;t=null===(a=e||[])||void 0===a?void 0:a.map(e=>{var t,a,n;return{AttributeSchemaName:e.SchemaName,AttributeDisplayName:null!==(t=e.DisplayName)&&void 0!==t&&t.LocalizedLabels[0]?null===(a=e.DisplayName)||void 0===a||null===(n=a.LocalizedLabels[0])||void 0===n?void 0:n.Label:e.SchemaName}}),n.e.getFirstHeaderMapping({attributes:null==e?void 0:e.length,firstRowMappingLength:null===(r=t)||void 0===r?void 0:r.length})}catch(o){n.e.errorFromExcel({Error:"Unexpected Error - getFirstHeaderMapping - could not get first header mapping",e:o})}return t},d=(e,t)=>{var a;if(e)return o(o({},e),{},{entity:o(o({},null==e?void 0:e.entity),{},{Attributes:p(t,null==e||null===(a=e.entity)||void 0===a?void 0:a.Attributes)})})},p=(e,t)=>{var a=t;if(null==t||!t.length)return[];try{var r;a=null===(r=t||[])||void 0===r?void 0:r.map(t=>{var a,n,r=t.SchemaName,i=null==e?void 0:e.findIndex(e=>{var t;return(null===(t=e.AttributeLogicalName)||void 0===t?void 0:t.toLowerCase())===(null==r?void 0:r.toLowerCase())});return o(o({},t),{},{DisplayName:o(o({},t.DisplayName),{},{LocalizedLabels:[o(o({},null===(a=t.DisplayName)||void 0===a?void 0:a.LocalizedLabels[0]),{},{Label:(null===(n=e[i])||void 0===n?void 0:n.AttributeDisplayName)||r})]})})}),n.e.getAttributesBasedOnFirstRowData({attributes:null==t?void 0:t.length,firstRowMappingLength:null==e?void 0:e.length})}catch(i){n.e.errorFromExcel({Error:"Unexpected Error - getAttributesBasedOnFirstRowData - could not swap display name based on first row mapping",e:i})}return a||[]},m=(e,t)=>{var a;if(e)return o(o({},e),{},{entity:o(o({},null==e?void 0:e.entity),{},{Attributes:b(t,null==e||null===(a=e.entity)||void 0===a?void 0:a.Attributes)})})},b=(e,t)=>{var a=t;if(null==t||!t.length)return[];try{var r;a=null===(r=t||[])||void 0===r?void 0:r.map(t=>{var a,n,r=t.SchemaName,i=null==e?void 0:e.findIndex(e=>{var t;return(null===(t=e.AttributeSchemaName)||void 0===t?void 0:t.toLowerCase())===(null==r?void 0:r.toLowerCase())});return o(o({},t),{},{DisplayName:o(o({},t.DisplayName),{},{LocalizedLabels:[o(o({},null===(a=t.DisplayName)||void 0===a?void 0:a.LocalizedLabels[0]),{},{Label:(null===(n=e[i])||void 0===n?void 0:n.AttributeDisplayName)||r})]})})}),n.e.getAttributesBasedOnFirstRowData({attributes:null==t?void 0:t.length,firstRowMappingLength:null==e?void 0:e.length})}catch(i){n.e.errorFromExcel({Error:"Unexpected Error - getAttributesBasedOnFirstRowData - could not swap display name based on first row mapping",e:i})}return a||[]},f=e=>{var t={};return null==e||e.forEach(e=>{t[e.AttributeSchemaName]=e.ColumnIndex}),t},v=e=>{try{var t;return null==e||null===(t=e.data)||void 0===t||t.splice(0,1),e}catch(a){n.e.errorFromExcel({Error:"Unexpected Error - removeFirstRowOfDataFromInMemoryTable - could not remove the first row of data",e:a})}return e},g=(e,t,a)=>{try{if(null!=t&&t.length&&e&&null!=a&&a.length){var r=h(t);return o(o({},e),{},{data:[r].concat(a)})}}catch(i){n.e.errorFromExcel({Error:"Unexpected Error - injectFirstRowOfDataFromInMemoryTable - could not inject the first row of data",e:i})}return e},h=e=>{var t={};return null==e||e.forEach(e=>{var a;t[null===(a=e.AttributeLogicalName)||void 0===a?void 0:a.toLowerCase()]=e.AttributeDisplayName}),t}},38019:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(10929),r=a(11860),o=a(10926),i=a.n(o),l=e=>{var{t:t}=e,{palette:a}=Object(n.Y)();return i.a.createElement(i.a.Fragment,null,t("createTableFromExcelStep.columnTypeChangedMessageText"),i.a.createElement(r.a,{href:"https://go.microsoft.com/fwlink/?linkid=2228814",target:"_blank","aria-label":t("createTableFromExcelStep.columnTypeChangedMessageText"),styles:{root:{paddingLeft:"0.4em",color:"".concat((null==a?void 0:a.themeSecondary)||"#8d308d"," !important")}},underline:!0},t("common.learnMore")))}},38020:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(10929),r=()=>Object(n.db)({title:{fontSize:n.k.size28,fontWeight:n.l.semibold,lineHeight:36},subtitle:{fontSize:n.k.size14,fontWeight:n.l.regular,lineHeight:n.k.size24}})},38021:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(10926),r=a.n(n),o=a(11860),i=a(12139),l=a(38022),c=a(38023),s=a(38028),u=a(38034),d=e=>{var{summaryContentInfo:t,useSummaryCard:a,usingFallbackLogic:n,copilotContentInfo:d,likeDislikeFeedbackPromptTitle:p}=e,{copilotDescription:m,copilotLinkTitle:b,copilotLink:f}=d,v=Object(l.a)();return r.a.createElement(i.a.Item,{className:v.box},r.a.createElement(i.a,{tokens:{childrenGap:16}},a&&r.a.createElement(i.a.Item,null,r.a.createElement(c.a,{contentInfo:t})),!n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.a.Item,null,r.a.createElement(u.a,null)),r.a.createElement(i.a.Item,null,r.a.createElement("div",{className:v.subtitle},m,r.a.createElement(o.a,{href:f,className:v.link,target:"_blank",underline:!0},b))),r.a.createElement(i.a.Item,null,r.a.createElement(s.a,{stringOverrides:{feedbackPromptTitle:p}})))))}},38022:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(10929),r=()=>{var{palette:e}=Object(n.Y)();return Object(n.db)({subtitle:{fontSize:n.k.size14,fontWeight:n.l.regular,lineHeight:n.k.size24},link:{paddingLeft:3},box:{padding:16,boxShadow:"0 0.3px 0.9px rgba(0, 0, 0, 0.1), 0 1.6px 3.6px rgba(0, 0, 0, 0.13)",borderRadius:4,backgroundColor:(null==e?void 0:e.white)||"#fff"}})}},38023:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(10926),r=a.n(n),o=a(12839),i=a(11675),l=a(12139),c=a(11623),s=a(11625),u=a(11630),d=a(11466),p=a(37893),m=a(38024),b=a(38027),f=a(38025),v=Object(c.a)(),g=Object(s.a)(e=>{var t,{t:a}=Object(d.g)(p.k),n=v(e.styles),c=e.contentInfo,s=Object(u.a)("TableSummaryCardTitle");return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.a.Item,null,r.a.createElement("h3",{id:s,className:n.title},c.mainTitle)),r.a.createElement("div",{"aria-labelledby":s},r.a.createElement(l.a,{horizontal:!0,wrap:!0,verticalFill:!0},r.a.createElement(l.a,{className:n.leftColumn},r.a.createElement(o.a,{className:n.subtitle},c.contentTitle)),r.a.createElement(l.a,null,r.a.createElement(o.a,{className:n.content},c.contentName))),r.a.createElement(l.a,{horizontal:!0,wrap:!0,verticalFill:!0},r.a.createElement(l.a,{className:n.leftColumn},r.a.createElement(o.a,{className:n.subtitle},a("tableSummaryCard.rows"))),r.a.createElement(l.a,null,r.a.createElement(o.a,{className:n.content},c.rowCount>=20?a("tableSummaryCard.rowsPreview",{numberOfRows:c.rowCount}):c.rowCount))),r.a.createElement(l.a,{horizontal:!0,wrap:!0,verticalFill:!0},r.a.createElement(l.a,{className:n.leftColumn},r.a.createElement(o.a,{className:n.subtitle},a("tableSummaryCard.columns"))),r.a.createElement(l.a,null,r.a.createElement(o.a,{className:n.content},null!==(t=c.unsupportedColumns)&&void 0!==t&&t.length?a("tableSummaryCard.columnsPreview",{numberOfColumns:c.columnCount}):c.columnCount,r.a.createElement(m.a,{unsupportedColumns:c.unsupportedColumns,messageType:f.a.Terse,tooltipLocation:i.a.rightCenter}))))))},b.a)},38024:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(11860),r=a(12839),o=a(13093),i=a(12139),l=a(11712),c=a(11648),s=a(11645),u=a(10926),d=a.n(u),p=a(38025),m=a(37893),b=a(11465),f=a(38026),v=a(13448),g=e=>{var{unsupportedColumns:t,messageType:a,tooltipLocation:u}=e,{t:g}=Object(b.t)(m.k),[h,{toggle:y}]=Object(c.a)(!1),O=Object(s.a)("description"),C=Object(s.a)("iconButton"),S=Object(s.a)("unsupported-label"),E=Object(f.a)(u),j="";if(null==t||!t.length)return d.a.createElement(d.a.Fragment,null);a===p.a.Terse&&(j=g("unsupportedColumns.messageTerse",{numberOfColumns:t.length})),a===p.a.Verbose&&(j=1===t.length?g("unsupportedColumns.messageVerboseSingular"):g("unsupportedColumns.messageVerbosePlural",{numberOfColumns:t.length}));var T=()=>d.a.createElement("div",{className:E.calloutContent},d.a.createElement("div",null,d.a.createElement("span",null,g("unsupportedColumns.calloutDescription"))," ",d.a.createElement(n.a,{href:v.a.unsupportedColumnsLearnMoreLink,target:"_blank",underline:!0},g("common.learnMore"))),d.a.createElement("div",{className:E.calloutContentSpacer}),t.map(e=>d.a.createElement("div",{key:e.FriendlyName},e.FriendlyName)));return d.a.createElement(d.a.Fragment,null,d.a.createElement("span",{id:S},d.a.createElement(r.a,{className:E.calloutTarget},j),d.a.createElement(l.a,{id:C,iconProps:{iconName:"Info"},title:g("unsupportedColumns.unsupportedColumnsInfoAriaLabel"),ariaLabel:g("unsupportedColumns.unsupportedColumnsInfoAriaLabel"),onClick:y,styles:f.c})),h&&d.a.createElement(o.a,{target:"#"+C,onDismiss:y,focusTrapProps:{isClickableOutsideFocusTrap:!0},ariaDescribedBy:O,role:"alertdialog",directionalHint:u,gapSpace:5,ariaLabel:j},d.a.createElement(i.a,{horizontal:!0},d.a.createElement(i.a,{tokens:{childrenGap:5},horizontalAlign:"center"},d.a.createElement(T,{unsupportedColumns:t})),d.a.createElement(l.a,{onClick:y,iconProps:{iconName:"Cancel"},ariaLabel:g("common.buttons.close"),title:g("common.buttons.close"),styles:f.b}))))}},38025:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n=function(e){return e[e.Terse=0]="Terse",e[e.Verbose=1]="Verbose",e}({})},38026:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return u}));var n,r,o=a(10929),i=a(11675),l=a(13821),c=e=>{var t,a={fontSize:o.k.size12,fontWeight:o.l.regular,lineHeight:o.k.size24,color:(null===l.a||void 0===l.a||null===(t=l.a.palette)||void 0===t?void 0:t.neutralPrimaryAlt)||"#3b3a39"};switch(e){case i.a.rightCenter:a.marginRight=5;break;case i.a.bottomCenter:a.margin=0}return Object(o.db)({calloutContent:{padding:8,lineHeight:16,fontSize:o.k.size12,fontWeight:o.l.regular,maxWidth:218},calloutContentSpacer:{height:12},calloutTarget:a})},s={root:{marginLeft:"0 !important",width:20,height:20,fontSize:12,lineHeight:16,color:(null===l.a||void 0===l.a||null===(n=l.a.palette)||void 0===n?void 0:n.neutralPrimary)||"#323130"},icon:{fontSize:12}},u={root:{width:32,color:(null===l.a||void 0===l.a||null===(r=l.a.palette)||void 0===r?void 0:r.neutralPrimary)||"#323130"},icon:{fontSize:12}}},38027:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(10929),r=()=>{var{palette:e}=Object(n.Y)();return Object(n.db)({leftColumn:{minWidth:"22%",marginRight:4},title:{fontSize:n.k.size18,fontWeight:n.l.semibold,lineHeight:n.k.size24,marginBottom:16},subtitle:{fontSize:n.k.size12,fontWeight:n.l.regular,lineHeight:n.k.size24},content:{minWidth:"76%",fontSize:n.k.size12,fontWeight:n.l.regular,lineHeight:n.k.size24,color:(null==e?void 0:e.neutralPrimaryAlt)||"#3b3a39",overflowWrap:"break-word",wordBreak:"break-word"}})}},38028:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(12839),r=a(11712),o=a(11623),i=a(11625),l=a(11630),c=a(11466),s=a(10926),u=a.n(s),d=a(38029),p=a(38030),m=a(38031),b=a(17668),f=a(37893),v={teamName:"powerapps",surveyName:"powerapps-excel2dv"},g=Object(o.a)(),h=Object(i.a)(e=>{var t,a,o,{t:i}=Object(c.g)(f.k),s=g(e.styles),{onDismissCallout:d,onSubmitFeedback:h,onButtonDismiss:y,likeOnClick:O,dislikeOnClick:C,calloutType:S,shouldShowCallout:E,textInputRef:j,buttonId:T}=Object(p.b)(v),w="".concat(p.a.ThumbsUp,"-feedbackButton"),x="".concat(p.a.ThumbsDown,"-feedbackButton"),k=S===p.a.ThumbsUp,P=S===p.a.ThumbsDown,N=Object(l.a)("ExcelFeedbackPromptTitle");return u.a.createElement("div",{className:s.container,role:"listbox","aria-labelledby":N},null!==(t=null===(a=e.customFeedbackPromptTitle)||void 0===a?void 0:a.call(e))&&void 0!==t?t:u.a.createElement(n.a,{className:s.header,id:N},(null===(o=e.stringOverrides)||void 0===o?void 0:o.feedbackPromptTitle)||i("common.components.userFeedback.feedbackPromptTitle")),u.a.createElement(r.a,{role:"option","aria-selected":k,className:s.thumbButton,id:w,ariaLabel:i("common.components.userFeedback.thumbsUpAriaLabel"),onClick:()=>O(w)},k?u.a.createElement(b.l,null):u.a.createElement(b.m,null)),u.a.createElement(r.a,{role:"option","aria-selected":P,className:s.thumbButton,id:x,ariaLabel:i("common.components.userFeedback.thumbsDownAriaLabel"),onClick:()=>C(x)},P?u.a.createElement(b.h,null):u.a.createElement(b.i,null)),u.a.createElement(m.a,{hidden:!E,target:T,onDismiss:d,calloutType:S,onSubmit:h,onButtonDismiss:y,textInputRef:j}))},d.a)},38029:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(10929),{palette:r}=Object(n.Y)(),o=()=>Object(n.db)({container:{display:"flex",alignItems:"center"},header:{marginRight:10,fontSize:n.k.size10,fontWeight:n.l.regular,lineHeight:n.k.size14,color:(null==r?void 0:r.black)||"#000000"},thumbButton:{width:20,padding:0,marginRight:4,color:r.neutralPrimaryAlt,selectors:{"&:active, &:hover":{color:r.themeSecondary,backgroundColor:r.neutralLighterAlt},'&[aria-selected="true"]':{color:r.themeSecondary}}}})},38030:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return b}));var n=a(10926),r=a.n(n),o=a(11868),i=a(12219),l=a(11019),c=a(11021),s=a(37893);function u(e,t,a,n,r,o,i){try{var l=e[o](i),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}function d(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function i(e){u(o,n,r,i,l,"next",e)}function l(e){u(o,n,r,i,l,"throw",e)}i(void 0)}))}}var p=function(e){return e.LikedMessage="Copilot/LikedMessage",e.DislikedMessage="Copilot/DislikedMessage",e.SubmittedFeedback="Copilot/SubmittedFeedback",e.DismissedCallout="Copilot/DismissedCallout",e}({}),m=function(e){return e.ThumbsUp="ThumbsUp",e.ThumbsDown="ThumbsDown",e.Unknown="Unknown",e}({}),b=e=>{var t,[a,n]=r.a.useState(!1),[o,u]=r.a.useState(m.Unknown),{oid:d,tid:b}=Object(l.t)(),{currentEnvironment:v}=Object(i.W)(),g=null!==(t=null==v?void 0:v.location)&&void 0!==t?t:"unknown",h=r.a.useRef(null),[y,O]=r.a.useState(),C=r.a.useCallback(e=>{n(!0),u(m.ThumbsUp),O(e),Object(c.fb)(s.j,p.LikedMessage)},[]),S=r.a.useCallback(e=>{n(!0),u(m.ThumbsDown),O(e),Object(c.fb)(s.j,p.DislikedMessage)},[]),E=r.a.useCallback(()=>{n(!1),f(o,g,d,b,e)},[o,d,b,g,e]),j=r.a.useCallback(()=>{E()},[E]),T=r.a.useCallback(()=>{var t;f(o,g,d,b,e,null===(t=h.current)||void 0===t?void 0:t.value),n(!1)},[o,d,b,g,e]);return{dislikeOnClick:S,likeOnClick:C,shouldShowCallout:a,onDismissCallout:E,onSubmitFeedback:T,onButtonDismiss:j,calloutType:o,textInputRef:h,buttonId:y}};function f(e,t,a,n,r,o){return v.apply(this,arguments)}function v(){return(v=d((function*(e,t,a,n,r,i){if(r&&(""===r.teamName||""===r.surveyName))throw new Error("No CES Settings provided");var l="".concat("https://ces/api/v1","/").concat(r.teamName,"/Surveys/").concat(r.surveyName,"/Feedbacks?userId=").concat(a),u={TenantId:n,Geo:t,IsDismissed:!1,Feedbacks:[{key:"comment",value:e+" - "+i}]},d=i?p.SubmittedFeedback:p.DismissedCallout,m=yield o.f.post(l,u);return Object(c.fb)(s.j,d,{dismissedFor:e,feedbackLength:null==i?void 0:i.length,feedbackId:m.data}),m.data}))).apply(this,arguments)}},38031:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(10926),r=a(12839),o=a(13093),i=a(11675),l=a(12661),c=a(11860),s=a(12139),u=a(11823),d=a(11824),p=a(11466),m=a(37893),b=a(38032),f=a(38030),v=a(38033),g=e=>{var{target:t,onSubmit:a,onButtonDismiss:g,onDismiss:h,textInputRef:y,hidden:O}=e,{t:C}=Object(p.g)(m.k);return n.createElement(o.a,{role:"alertdialog",hidden:O,className:b.a.callout,target:"#".concat(t),shouldDismissOnWindowFocus:!0,gapSpace:4,onDismiss:h,directionalHint:i.a.bottomCenter,setInitialFocus:!0,focusTrapProps:{isClickableOutsideFocusTrap:!0}},!O&&n.createElement(l.a,{className:b.a.textInput,label:e.calloutType===f.a.ThumbsUp?C("common.components.userFeedback.sendFeedbackLikeHeaderText"):C("common.components.userFeedback.sendFeedbackDislikeHeaderText"),multiline:!0,resizable:!1,rows:3,componentRef:y,maxLength:4970}),n.createElement(r.a,{block:!0,variant:"xSmall",className:b.a.disclaimerText},Object(v.a)(C("common.components.userFeedback.writtenFeedbackPrivacyText_format"),n.createElement(c.a,{underline:!0,target:"_blank",href:"https://go.microsoft.com/fwlink/?linkid=2189520"},C("common.components.userFeedback.privacyStatementText")))),n.createElement(s.a,{className:b.a.buttonStack,horizontal:!0,gap:8},n.createElement(u.a,{onClick:a},C("common.components.userFeedback.submitText")),n.createElement(d.a,{onClick:g},C("common.components.userFeedback.notNowText"))))}},38032:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(10929),r=Object(n.db)({callout:{width:283,height:216},textInput:{width:256,paddingLeft:12,paddingTop:6},disclaimerText:{width:256,marginTop:6,paddingLeft:12},buttonStack:{display:"flex",justifyContent:"flex-end",paddingTop:10,paddingRight:16,paddingBottom:12}})},38033:function(e,t,a){"use strict";function n(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];var r=[],o=0;return e.replace(/{(\d+)}/g,(t,n,i)=>(n<a.length&&(o!==i&&r.push(e.slice(o,i)),r.push(a[n]),o=i+t.length),"")),0!==r.length&&o===e.length||r.push(e.slice(o)),r}a.d(t,"a",(function(){return n}))},38034:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(11672),r=a(11623),o=a(11625),i=a(11466),l=a(10926),c=a.n(l),s=a(37893),u=a(38035),d=a(38036),p=a.n(d),m=Object(r.a)(),b=Object(o.a)(e=>{var{t:t}=Object(i.g)(s.k),a=m(e.styles);return c.a.createElement("div",{className:a.container},c.a.createElement(n.a,{src:p.a,alt:""}),c.a.createElement("h3",{className:a.copilotHeaderText},t("common.components.copilotHeader.headerText")))},u.a)},38035:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(10929),r=()=>Object(n.db)({container:{display:"flex",alignItems:"center"},copilotHeaderText:{marginLeft:10,fontSize:n.k.size18,fontWeight:n.l.semibold,lineHeight:n.k.size24}})},38036:function(e,t,a){e.exports=a.p+"static/media/copilot-blue.2542568c.svg"},38037:function(e,t,a){"use strict";a.d(t,"a",(function(){return W})),a.d(t,"b",(function(){return _})),a.d(t,"c",(function(){return U})),a.d(t,"d",(function(){return H}));var n=a(10926),r=a.n(n),o=a(12139),i=a(14130),l=a(14132),c=a(37967),s=a(37886),u=a(22590),d=a(11465),p=a(37893),m=a(37885),b=a(12219),f=a(37949),v=a(37922),g=a(38038),h=a(38039),y=a(37918),O=a(37898),C=a(37917),S=a(38e3),E=a(37992),j=a(12217),T=a(38020),w=a(21727),x=a(38021),k=a(37999),P=a(22599),N=a(38024),F=a(11859),D=a(38025),I=a(11675);function L(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?L(Object(a),!0).forEach((function(t){B(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):L(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function B(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var R=e=>{var{connectionType:t,onConnectionStepFulfilled:a}=e,{getValue:n}=Object(m.c)(),{hasDataverse:o}=Object(b.W)(),{isDataAccessEnabled:u}=Object(v.a)(),d=Object(P.a)(),f=Object(g.b)(t),{updateFooterButton:h}=Object(m.b)(),y=r.a.useCallback((e,t)=>{h(s.c.Next,{isEnabled:e}),e&&(p.d.createTableFromConnectorDataFulfilled({connectorType:null==t?void 0:t.connectorType}),a(t))},[h,a]);return r.a.createElement(c.a,{connectionApiId:Object(i.a)(t),templateType:n("templateType"),shouldRedirectToHome:()=>{var e=!o;return e=t!==l.b.SharePoint||(e||!d)},isDataAccessEnabled:u,collectorStep:{mainContentHeaderText:null==f?void 0:f.headerText,mainContentSubHeaderText:null==f?void 0:f.headerDescription,onCollectorStepFulfilled:y}})},M=()=>{var{t:e}=Object(d.t)(p.k);return r.a.createElement(f.a,{title:e("createTableFromConnector.selectDataTitle")})},z=()=>{var{t:e}=Object(d.t)(p.k),t=Object(y.a)(),a=Object(T.a)();return r.a.createElement(o.a,{tokens:{childrenGap:24}},r.a.createElement(o.a.Item,null,r.a.createElement("h2",{className:a.title},e("createTableFromConnector.previewTableTitle"))),r.a.createElement(o.a.Item,null,r.a.createElement("div",{className:a.subtitle},r.a.createElement(d.c,{t:e,i18nKey:e(t?"createTableFromConnector.createTableLeftContent":"createTableFromConnector.createAppLeftContent"),components:{b:r.a.createElement("b",null)}}))))},W=e=>{var{usingFallbackLogic:t,useSummaryCard:a,listName:n,rowCount:i,columnCount:l,unsupportedColumns:c}=e,{t:s}=Object(d.t)(p.k),u={mainTitle:s("createTableFromConnector.tableCardTitle"),contentTitle:s("createTableFromConnector.list"),contentName:n,rowCount:i,columnCount:l,unsupportedColumns:c},m={copilotDescription:s("createTableFromConnector.copilotDescription"),copilotLinkTitle:s("createTableFromConnector.previewCopilotReadTerms"),copilotLink:w.a.aboutCreateAnAppFromConnectorTables};return r.a.createElement(o.a,{tokens:{childrenGap:24}},r.a.createElement(z,null),(a||!t)&&r.a.createElement(x.a,{usingFallbackLogic:t,useSummaryCard:a,summaryContentInfo:u,copilotContentInfo:m,likeDislikeFeedbackPromptTitle:s("createTableFromConnector.likeDislikeFeedbackPromptTitle")}))},_=e=>{var{t:t,rowCount:a,unsupportedColumns:n,usingFallbackLogic:o}=e,i="";return a>=20&&(i="".concat(t("createTableFromExcelStep.rowsPreview",{numberOfRows:a}),".")),r.a.createElement(r.a.Fragment,null,Object(F.c)(t(o?"createTableFromConnector.simplifiedCopilotMessageFallback":"createTableFromConnector.simplifiedCopilotMessage",{previewMessage:i}),(e,t)=>{switch(t){case 0:return r.a.createElement("b",null,e);case 1:return r.a.createElement(N.a,{unsupportedColumns:n,messageType:D.a.Verbose,tooltipLocation:I.a.bottomCenter});default:return r.a.createElement(r.a.Fragment,null)}}))},U=e=>{var{t:t}=Object(d.t)(p.k),a=Object(P.a)(),{label:n}=Object(k.a)(null==e?void 0:e.useSimplifiedLeftContent),{onTableCreated:o}=Object(E.a)(j.k.SharePointConnector),i=Object(y.a)(null==e?void 0:e.useSimplifiedLeftContent),[c,m]=r.a.useState(void 0),b=r.a.useCallback(e=>{m(e)},[]);return a?[{key:u.a.ConfigureTableFromSharePoint,title:C.d,leftContent:M,rightContent:()=>r.a.createElement(R,{connectionType:l.b.SharePoint,onConnectionStepFulfilled:b}),buttonStates:[{type:s.c.Cancel,state:{isHidden:!1}},{type:s.c.Complete,state:{isHidden:!0}},{type:s.c.Back,state:{isHidden:!!i}},{type:s.c.Next,state:{isEnabled:!1,isHidden:!1}}],backStepKey:u.a.StartWithData,nextStepKey:u.a.CreateTableFromSharePoint,onStepLoadedAriaLabel:t("createTableFromConnector.selectDataTitle")},{key:u.a.CreateTableFromSharePoint,title:C.d,leftContent:()=>r.a.createElement(z,null),rightContent:()=>r.a.createElement(h.a,{busyState:S.a,onTableCreated:null!=e&&e.onTableCreated?t=>{null==e||e.onTableCreated(t.persistedTableData.logicalName)}:o,connectionData:c,solutionId:null==e?void 0:e.solutionId,useSimplifiedLeftContent:null==e?void 0:e.useSimplifiedLeftContent}),buttonStates:[...O.c,{type:s.c.Complete,state:{isEnabled:!1,label:n}}],backStepKey:u.a.ConfigureTableFromSharePoint,onStepLoadedAriaLabel:t("createTableFromConnector.previewTableTitle")}]:[]};function H(e){var{onTableCreated:t,solutionId:a}=e,n=U({onTableCreated:t,solutionId:a,useSimplifiedLeftContent:!0}),r=[],o=n.find(e=>e.key===u.a.ConfigureTableFromSharePoint);return o&&(r.push(A(A({},o),{},{buttonStates:[...o.buttonStates||[],{type:s.c.Back,state:{isHidden:!1}}],backStepKey:u.a.StartWithData,leftContent:void 0,title:C.f})),r.push(A(A({},n.find(e=>e.key===u.a.CreateTableFromSharePoint)),{},{leftContent:void 0,title:C.f}))),r}},38038:function(e,t,a){"use strict";a.d(t,"b",(function(){return m})),a.d(t,"a",(function(){return b}));var n=a(14132),r=a(11465),o=a(37893),i=a(10926),l=a.n(i),c=a(11860),s=a(13448);function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){p(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var m=e=>{var{t:t}=Object(r.t)(o.k);switch(e){case n.b.SharePoint:return{headerText:t("createTableFromConnector.sharePointDataTitle"),headerDescription:l.a.createElement("span",null,t("createTableFromConnector.sharePointDataDescription"),l.a.createElement(c.a,{href:s.a.unsupportedColumnsLearnMoreLink,target:"_blank",underline:!0},t("common.learnMore")))};default:return}},b=(e,t,a)=>{var n=e,r=t,i=!1,l="",c=-1;try{var s;n=null===(s=e||[])||void 0===s?void 0:s.map(e=>{var n=e.AttributeTargetName,s=null==a?void 0:a.findIndex(e=>{var t;return(null===(t=e.SchemaName)||void 0===t?void 0:t.toLowerCase())===(null==n?void 0:n.toLowerCase())});if(n&&-1===s&&null!=a&&a.length&&(c=null==t?void 0:t.findIndex(e=>{var t;return(null===(t=e.SchemaName)||void 0===t?void 0:t.toLowerCase())===(null==n?void 0:n.toLowerCase())}))>-1){var u;i=!0,l=null===(u=a[c])||void 0===u?void 0:u.SchemaName,o.d.columnSchemaNameChanged({currentSchemaName:n,newSchemaName:l});var p=r[c];return r[c]=d(d({},p),{},{SchemaName:l}),d(d({},e),{},{AttributeTargetName:l})}return e})}catch(u){o.d.errorUpdatingData({Error:"Unexpected Error - getUpdatedFileInfoAttributeInfo - could not update attribute info in file info after column schema name change",e:u})}return{hasColumSchemaNameChanged:i,fileInfoUpdatedMap:n,currentAttributesUpdated:r}}},38039:function(e,t,a){"use strict";a.d(t,"a",(function(){return B}));var n=a(11934),r=a(12139),o=a(13737),i=a(37950),l=a(12088),c=a(12355),s=a(38040),u=a(22590),d=a(37570),p=a(37574),m=a(37636),b=a(11465),f=a(12219),v=a(37885),g=a(37886),h=a(10926),y=a.n(h),O=a(37893),C=a(37998),S=a(37999),E=a(37996),j=a(37997),T=a(37914),w=a(38037),x=a(22600),k=a(38015),P=a(38038),N=a(37918),F=a(38019);function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function I(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(Object(a),!0).forEach((function(t){L(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function L(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var A="ErrorMessageTableFromConnector",B=e=>{var t,a,h,D,L,B,R,M,{busyState:z,onTableCreated:W,solutionId:_,connectionData:U,useSimplifiedLeftContent:H}=e;Object(C.a)(u.a.CreateTableFromSharePoint);var{t:K}=Object(b.t)(O.k),{solutionData:V,solutionIsLoading:q}=Object(i.a)(l.a,_),G=null==V?void 0:V.solution,{currentEnvironmentName:Z}=Object(f.X)(),Q=Object(o.e)({isSolutionFirst:!1}),Y=Object(N.a)(H),{updateFooterButton:$,showMessage:X,setContent:J,clearMessages:ee,clearMessage:te,setWarnOnNavigate:ae,isWarningOnNavigate:ne,getStepKeys:re,navigateToStep:oe}=Object(v.b)(),{getValue:ie}=Object(v.c)(),le=!(null===(t=re())||void 0===t||!t.backStepKey),ce=null==V||null===(a=V.solution)||void 0===a||null===(h=a.publisher)||void 0===h?void 0:h.customizationPrefix,{isLoading:se,fileInfo:ue,tableDefinition:de,tablePreviewData:pe,usingFallbackLogic:me,errorMessage:be,retry:fe,isRetrying:ve}=Object(s.a)({solutionPrefix:ce||"",connectionInfoRequest:{ConnectionId:(null==U?void 0:U.connectionName)||"",ConnectorId:(null==U?void 0:U.connectorType)||"",DatasetValue:(null==U?void 0:U.datasetName)||"",TableId:(null==U?void 0:U.tableName)||""},enableQuery:!!(ce&&null!=U&&U.tableName&&null!=U&&U.datasetName&&null!=U&&U.connectionName&&null!=U&&U.connectorType),defaultErrorMessage:K("errors.genericError")}),[ge,he]=y.a.useState(),[ye,Oe]=y.a.useState(void 0),[Ce,Se]=y.a.useState([]),[Ee,je]=y.a.useState([]),[Te,we]=y.a.useState(!1),[xe,ke]=y.a.useState(!1),[Pe,Ne]=y.a.useState(!1),Fe=Object(x.b)(),De=Object(x.d)(),Ie=Object(x.c)(),{label:Le}=Object(S.a)(H),{isUniqueSchemaName:Ae}=Object(E.a)({schemaName:null==ye||null===(D=ye.entity)||void 0===D?void 0:D.SchemaName}),{mutate:Be,isSuccess:Re,data:Me,isLoading:ze,isError:We,error:_e}=Object(m.a)(),Ue=De&&!(null==ue||!ue.ColumnCount),He=null==ue||null===(L=ue.AttributesInfo)||void 0===L?void 0:L.filter(e=>!e.AttributeTargetName);y.a.useEffect(()=>$(g.c.Back,{isHidden:!le}),[le]);var Ke=y.a.useCallback(()=>{var e,t,a,n,r;return y.a.createElement(w.a,{usingFallbackLogic:me,useSummaryCard:Ue,listName:null!==(e=null==de||null===(t=de.DisplayName)||void 0===t||null===(a=t.LocalizedLabels)||void 0===a?void 0:a[0].Label)&&void 0!==e?e:"",columnCount:null!==(n=null==ue?void 0:ue.ColumnCount)&&void 0!==n?n:0,rowCount:null!==(r=null==ue?void 0:ue.RowCount)&&void 0!==r?r:0,unsupportedColumns:He})},[me,De,null==ue?void 0:ue.ColumnCount,null==ue?void 0:ue.RowCount,null==de||null===(B=de.DisplayName)||void 0===B||null===(R=B.LocalizedLabels)||void 0===R?void 0:R[0].Label]);y.a.useEffect(()=>{ue&&Ue&&H&&X(Object(w.b)({t:K,rowCount:(null==ue?void 0:ue.RowCount)||0,unsupportedColumns:He,usingFallbackLogic:me}),n.a.success,void 0,"SuccessGridMessageBar")},[K,null==ue?void 0:ue.RowCount,Ue,me]),y.a.useEffect(()=>{xe||Pe?X(y.a.createElement(F.a,{t:K}),n.a.info,void 0,"TypeChangedMessage"):te("TypeChangedMessage")},[xe,Pe]),y.a.useEffect(()=>{var e=ie("setStepDetails");return null==e||e({fileRecordId:null==ue?void 0:ue.RecordId,usingFallbackLogic:me,tableCreationType:c.d.SharePointConnector}),()=>{null==e||e(void 0)}},[null==ue?void 0:ue.RecordId,me]),y.a.useMemo(()=>{if((se||ve)&&(he(void 0),Oe(void 0),te&&(te(A),te("SuccessGridMessageBar"),te("TypeChangedMessage")),O.d.loadingDataFromInference({connectorType:null==U?void 0:U.connectorType,isLoading:se,isRetrying:ve,dataLength:null==pe?void 0:pe.length,hasPrimaryColumn:null==ue?void 0:ue.HasPrimaryColumn})),be)X(be,n.a.error,void 0,A),O.d.errorFromInference({inferenceErrorMessage:be,connectorType:null==U?void 0:U.connectorType});else if(de){var e,t={fileInfoFromConnector:ue,data:pe,entity:de,autoNumberSeeds:{}};O.d.hasPreviewData({connectorType:null==U?void 0:U.connectorType,dataLength:null==pe?void 0:pe.length,hasPrimaryColumn:null==ue?void 0:ue.HasPrimaryColumn,usingFallbackLogic:me,columnCount:null==ue?void 0:ue.ColumnCount,rowCount:null==ue?void 0:ue.RowCount}),H||J(g.a.Left,Ke),Oe(t),he(t),Se((null==t||null===(e=t.entity)||void 0===e?void 0:e.Attributes)||[]),je((null==ue?void 0:ue.AttributesInfo)||[])}},[!!de,!!pe,!!ue,be,se,null==U?void 0:U.connectorType]);var Ve={title:K("createTableStep.navigationPreventionDialogTitle"),subText:K("createTableStep.navigationPreventionDialogSubtitle"),confirmButtonLabel:K("createTableStep.navigationPreventionDialogLeaveButton"),cancelButtonLabel:K("createTableStep.navigationPreventionDialogStayButton")},qe=se||ze||!Re&&(!!ue||!!ge);qe!==ne&&ae(qe,Ve);var Ge=y.a.useCallback(()=>{var e=re(),t=null==e?void 0:e.backStepKey;t&&(te(A),oe(t))},[re,oe]),Ze=y.a.useMemo(()=>y.a.createElement(k.a,{errorTitle:K("createTableFromConnector.uploadErrorTitle"),errorSubtitle:K("createTableFromConnector.uploadErrorSubtitle"),defaultButtonTitle:K("createTableFromConnector.selectAnotherList"),defaultButtonOnClick:Ge,primaryButtonTitle:K("createTableFromConnector.tryAgain"),primaryButtonOnClick:fe}),[K,Ge]);return y.a.useEffect(()=>{if(ze)O.d.createTableLoading();else if(Re&&Me&&Z){var e,t,a,r=(null==ye||null===(e=ye.entity)||void 0===e||null===(t=e.DisplayName)||void 0===t||null===(a=t.LocalizedLabels[0])||void 0===a?void 0:a.Label)||"";O.d.createTable({tableName:r,currentEnvironmentName:Z,solutionId:null==G?void 0:G.id,usingFallbackLogic:me}),W({action:c.b,appName:r,persistedTableData:Me,solutionId:null==G?void 0:G.id})}else if(We&&_e){var o,i,l,s=null===(o=_e.response)||void 0===o||null===(i=o.data)||void 0===i||null===(l=i.error)||void 0===l?void 0:l.message,u=Object(T.c)(_e,K),d=K(Y?"common.errors.createTableError":"common.errors.createAppError",{error:u});X(d,n.a.error,void 0,A),O.d.createTableError({errorMessage:u,originalError:s})}},[ze,Me,Re,null==G?void 0:G.id,Z,null==ye||null===(M=ye.entity)||void 0===M?void 0:M.DisplayName,We,_e,W,Y,K]),y.a.useEffect(()=>{$(g.c.Complete,{onClick:()=>{var e=null==G?void 0:G.uniqueName;ye&&e&&(O.d.createTableInitiate({solutionUniqueName:e}),Be({inMemoryTable:{fileInfoFromConnector:I(I({},ue),{},{HasHeader:!(null==ue||!ue.HasHeader),HasPrimaryColumn:!(null==ue||!ue.HasPrimaryColumn),SourceTimeZone:(null==ue?void 0:ue.SourceTimeZone)||"",AttributesInfo:Ee}),connectionInfo:{ConnectionId:(null==U?void 0:U.connectionName)||"",ConnectorId:(null==U?void 0:U.connectorType)||"",DatasetValue:(null==U?void 0:U.datasetName)||"",TableId:(null==U?void 0:U.tableName)||""},data:ye.data,entity:ye.entity,autoNumberSeeds:ye.autoNumberSeeds},solutionUniqueName:e,enableSingleSaveApi:!1,enableSingleSaveApiV2:!0,configurationType:p.a.ImportFromConnector,isPreferredSolutionFeatureEnabled:Q}),ee())},isEnabled:Ae&&Te,label:Le})},[ye,Ae,Te,null==G?void 0:G.uniqueName,Q,Le,null==ue?void 0:ue.HasHeader,null==ue?void 0:ue.HasPrimaryColumn,null==ue?void 0:ue.SourceTimeZone,Fe,Ie,Ee]),y.a.createElement(y.a.Fragment,null,(ze||Re)&&y.a.createElement(z,{forceIsTableCreationFlow:H}),!se&&!ve&&be&&Ze,(se||ve||ge)&&y.a.createElement(r.a,{className:j.a.seeExperienceInFullScreen},y.a.createElement(d.a,{table:ge,classNames:{commandBarWrapper:j.a.commandBarWrapper,commandBarControl:j.a.commandBarControl},isLoading:q||se||ve,solutionContext:G,configurationType:p.a.ImportFromConnector,dataPayloadFormat:p.b.ExcelAndConnectorInference,onUpdate:e=>{var t,a,n,{hasColumSchemaNameChanged:r,fileInfoUpdatedMap:o,currentAttributesUpdated:i}=Object(P.a)(Ee,Ce,null===(t=e.table)||void 0===t||null===(a=t.entity)||void 0===a?void 0:a.Attributes);r&&(je(o),Se(i),O.d.hasColumSchemaNameChanged({})),Oe(e.table),we(e.canBeSaved),Ne(!(null===(n=e.validationErrors)||void 0===n||!n.hasDataErrors)),e.columnDataTypeWasUpdated&&ke(!0)}})))}},38040:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(38012),r=a(12088),o=a(38041),i=a(22600),l=a(11021),c=a(21622),s=a(10926);function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){p(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function m(e){var t,a,u,p,m,b,f,v,{solutionPrefix:g,fileRecordId:h,connectionInfoRequest:y,enableQuery:O,defaultErrorMessage:C}=e,S=Object(i.b)(),E=h?{FileInfo:{RecordId:h}}:{ConnectionInfo:{ConnectionId:(null==y?void 0:y.ConnectionId)||"",ConnectorId:(null==y?void 0:y.ConnectorId)||"",DatasetValue:encodeURIComponent(encodeURIComponent((null==y?void 0:y.DatasetValue)||"")),TableId:(null==y?void 0:y.TableId)||""}},j={SourceTimeZone:S,SolutionPrefix:g},{isInitialLoading:T,data:w,error:x,refetch:k,isRefetching:P}=Object(o.a)({dataSourceInfoRequest:d(d({},E),{},{UserContext:j}),enableQuery:!!O&&!!(h||null!=y&&y.ConnectionId),telemetryScope:r.a,defaultErrorMessage:C}),{isInitialLoading:N,data:F,error:D,refetch:I,isRefetching:L}=Object(n.b)({dataSourceInfo:{PreviewData:(null==w?void 0:w.PreviewData)||"",FileInfo:(null==w?void 0:w.FileInfo)||"",EntityDefinition:(null==w?void 0:w.EntityDefinition)||""},userContext:j,recordId:"00000000-0000-0000-0000-000000000000",solutionPrefix:g,enableQuery:!!O&&!(null==w||!w.EntityDefinition),telemetryScope:r.a,defaultErrorMessage:C}),A=x?(null===(t=x.response)||void 0===t||null===(a=t.data)||void 0===a||null===(u=a.error)||void 0===u?void 0:u.message)||x.message||C:"",B=D?(null===(p=D.response)||void 0===p||null===(m=p.data)||void 0===m||null===(b=m.error)||void 0===b?void 0:b.message)||D.message||C:"",R=Object(s.useCallback)(()=>{A?k():B&&I()},[A,B,k,I]),M=[];try{var z=null==F?void 0:F.EntityDefinition;f=z?JSON.parse(z):void 0,M=null!=F&&F.SampleData?JSON.parse(null==F?void 0:F.SampleData):[],v=null!=F&&F.FileInfo?JSON.parse(null==F?void 0:F.FileInfo):void 0}catch(U){B=C,Object(l.U)(r.a,{eventName:c.o.InferenceTableError,eventData:{tableDefinition:f,tablePreviewData:M,fileInfo:v}})}var W=T||N,_=P||L;return{isLoading:W,errorMessage:W?"":A||B,tableDefinition:W?void 0:f,tablePreviewData:W?[]:M,fileInfo:W?void 0:v,usingFallbackLogic:!(null==F||!F.UsingFallbackLogic),retry:R,isRetrying:_}}},38041:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(12313),r=a(11868),o=a(13769),i=a(12219),l=a(11021),c=a(13556);function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){d(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function d(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function p(e,t,a,n,r,o,i){try{var l=e[o](i),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}function m(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function i(e){p(o,n,r,i,l,"next",e)}function l(e){p(o,n,r,i,l,"throw",e)}i(void 0)}))}}function b(e){var t,a,s,d,{dataSourceInfoRequest:p,telemetryScope:b,defaultErrorMessage:f,enableQuery:v}=e,{currentEnvironment:g,hasDataverse:h}=Object(i.W)(),y=Object(o.a)({eventScope:b,scenarioName:c.g.fetchDataSourceInfo,eventData:void 0,team:l.j.PowerappsPortal,teamPriority:l.f.Medium}),O=Object(c.h)(c.d.DataExperience,c.e.DataFetchHooks),C=!!(v&&(null!=p&&null!==(t=p.FileInfo)&&void 0!==t&&t.RecordId||null!=p&&null!==(a=p.ConnectionInfo)&&void 0!==a&&a.ConnectionId)&&g&&h),{data:S,isInitialLoading:E,error:j,refetch:T,isRefetching:w}=Object(n.a)(["powerapps-ui-common","FetchDataSourceInfo",null==g?void 0:g.name,null==p||null===(s=p.FileInfo)||void 0===s?void 0:s.RecordId,null==p||null===(d=p.ConnectionInfo)||void 0===d?void 0:d.TableId],m((function*(){var e={team:l.j.PowerappsPortal},t=yield r.f.post("https://cds-org/api/data/v9.0/FetchDataSourceInfo",{UserContext:JSON.stringify(null==p?void 0:p.UserContext),ConnectionInfo:JSON.stringify(null==p?void 0:p.ConnectionInfo),FileInfo:JSON.stringify(null==p?void 0:p.FileInfo)},e);if(null==t||!t.data)throw new Error(f);return t.data})),{enabled:C,onSuccess:e=>{var t,a,n,r,o,i,l;try{i=null!=e&&e.EntityDefinition?JSON.parse(null==e?void 0:e.EntityDefinition):void 0,l=null!=e&&e.PreviewData?JSON.parse(null==e?void 0:e.PreviewData):void 0}catch(v){var c,s,d,m,b;throw null==y||y.complete(u({hasParsingError:!0,fileRecordId:null==p||null===(c=p.FileInfo)||void 0===c?void 0:c.RecordId,connectionId:null==p||null===(s=p.ConnectionInfo)||void 0===s?void 0:s.ConnectionId,columnsLength:null===(d=i)||void 0===d||null===(m=d.Attributes)||void 0===m?void 0:m.length,rowLength:null===(b=l)||void 0===b?void 0:b.length},O)),new Error(f)}null==y||y.complete(u({fileRecordId:null==p||null===(t=p.FileInfo)||void 0===t?void 0:t.RecordId,connectionId:null==p||null===(a=p.ConnectionInfo)||void 0===a?void 0:a.ConnectionId,columnsLength:null===(n=i)||void 0===n||null===(r=n.Attributes)||void 0===r?void 0:r.length,rowLength:null===(o=l)||void 0===o?void 0:o.length},O))},onError:e=>null==y?void 0:y.failure(u(u({},e),O)),cacheTime:0});return{data:S,isInitialLoading:E,error:j,refetch:T,isRefetching:w}}},38043:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(37885),r=a(10926),o=()=>{var{setWarnOnNavigate:e,warnOnNavigate:t}=Object(n.b)();return Object(r.useEffect)(()=>t,[t]),{setWarnOnNavigate:e}}},38044:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(11038),r=Object(n.d)({packageName:"powerappsWizards",features:{enableConversationalManualEdits:{owner:"mirestom",description:"Allows manual edits on the conversational scenario.",enabledFor:{}},shouldAssignDeveloperPlanBeforeEnvironmentProvisioning:{owner:"jacalhou",createdDate:"05/02/2023",description:"If enabled, will assign the developer plan before provisioning the environment",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!0,high:!0,dod:!0,mooncake:!0}}}})},38070:function(e,t,a){"use strict";a.d(t,"a",(function(){return H})),a.d(t,"b",(function(){return K}));var n=a(10926),r=a.n(n),o=a(37885),i=a(22590),l=a(37886),c=a(37917),s=a(11465),u=a(37949),d=a(38071),p=a(37893),m=a(37922),b=a(38073),f=a(38074),v=a(37914),g=a(16100),h=a(12671),y=a(11675),O=a(11504),C=a(11672),S=a(12871),E=a(37897),j=a(37834),T=a(20490),w=a(11021),x=a(12217),k=a(20491),P=a(22586),N=a(11205),F=a(22588),D=a(22594),I=a(19450),L=a(16211),A=a(22599);function B(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?B(Object(a),!0).forEach((function(t){M(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):B(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function M(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var z=x.h,W=()=>{var{t:e}=Object(s.t)(p.k),t=e("startWithDataStep.leftContentTitle");return r.a.createElement(u.a,{title:t})},_=Object(d.b)(),U=e=>{var t,a,l,{navigateToStep:c}=Object(o.b)(),{setValue:u}=Object(o.c)(),x=Object(m.a)(),B=Object(D.a)(),{enableCreateTableFromSharePoint:M}=Object(I.b)(),W=Object(A.a)(),{t:U}=Object(s.t)(p.k),{enableNLTableCreation:H}=Object(T.a)(),K=Object(g.a)(),V=Object(d.a)(K,e.styleOverrides),{hideSelectExternalData:q}=Object(L.g)(),G=Object(N.i)(),{canUserCreateOrUseDevEnvironment:Z}=Object(k.a)(),[Q,Y]=Object(n.useState)(!1),[$,X]=Object(n.useState)(),[J,ee]=Object(n.useState)(),te=r.a.createRef();Object(n.useEffect)(()=>{H&&Object(w.W)(z,{eventName:"".concat(i.a.StartWithData,"/ShowHero")})},[H]);var ae=Object(b.a)(x,B,W,e.hideSelectAnExistingTable,e.hideSelectExternalData||q,!M,U,Z),ne=e=>{switch(e){case f.b.UploadExcel:return i.a.CreateTableFromExcel;case f.b.BlankTable:return i.a.CreateTableFromBlank;case f.b.ExistingTable:return i.a.CreateAppFromExistingTable;case f.b.ExternalData:return i.a.ConnectionsExternal;default:return}},re=e=>{switch(e){case f.a.File:return i.a.CreateTableFromExcel;case f.a.SharePointList:return i.a.ConfigureTableFromSharePoint;default:return}},oe=e=>{var t,a=e.key===f.b.ExternalData,n=!(null===(t=e.commands)||void 0===t||!t.length);a||!Z||n?(e=>{var t,a;if(p.h.TileSelected({key:e.key,disabled:e.disabled,disabledReason:e.disabledReason}),!e.disabled)if(null!==(t=e.commands)&&void 0!==t&&t.length&&null!==(a=te.current)&&void 0!==a&&a.openMenu){var n;null===(n=te.current)||void 0===n||n.openMenu()}else{var r=ne(e.key);switch(e.key){case f.b.UploadExcel:case f.b.CreateFromConnector:case f.b.BlankTable:case f.b.ExistingTable:c(r);break;case f.b.ExternalData:u("templateType",E.b.ResponsiveSingleScreen),c(r)}}})(e):(X(e.key),Y(!0))},ie=e=>{Z?(ee(e.key),Y(!0)):(e=>{if(p.h.CommandSelected({key:e.key,disabled:e.disabled,disabledReason:e.disabledReason}),!e.disabled){var t=re(e.key);switch(e.key){case f.a.File:case f.a.SharePointList:c(t)}}})(e)};return r.a.createElement(r.a.Fragment,null,H&&r.a.createElement("div",{className:V.nlHero},r.a.createElement(j.a,{stringOverrides:null===(t=e.stringOverrides)||void 0===t?void 0:t.naturalLanguageHeroContent,onUserTextSubmit:e=>{u("prompt",e,!0),Object(w.W)(z,{eventName:"".concat(i.a.StartWithData,"/NLHero/OpenCreateAppWizard")}),c(i.a.CreateTable)},styles:_,telemetryEventLocation:i.a.StartWithData})),r.a.createElement("div",{className:"".concat(V.cardsSection).concat(H?" nlHeroShown":"")},r.a.createElement("div",{className:"".concat(V.sectionHeader).concat(H?" nlHeroShown":"")},(null===(a=e.stringOverrides)||void 0===a||null===(l=a.headings)||void 0===l?void 0:l.selectOption)||U("startWithDataStep.headings.selectOption")),ae.map(e=>{var t,a="tooltip-".concat(e.key),n=!(null===(t=e.commands)||void 0===t||!t.length);return r.a.createElement("div",{key:e.key,className:V.cardContainer},r.a.createElement(h.a,{id:a,content:Object(v.d)(U,e.disabledReason),directionalHint:y.a.bottomCenter},r.a.createElement("div",{"aria-disabled":e.disabled,"aria-describedby":e.disabledReason?a:void 0,className:"".concat(V.card).concat(e.disabled?" disabled":""),tabIndex:0,onClick:()=>{oe(e)},role:"button",onKeyDown:t=>{(t.which||t.keyCode)===O.a.enter&&(t.preventDefault(),oe(e))}},r.a.createElement("div",{className:"".concat(V.imageContainer," ").concat(e.key)},r.a.createElement(C.a,{src:e.image,role:"presentation"})),r.a.createElement("div",{className:V.cardTitle},r.a.createElement("span",null,e.title),n&&r.a.createElement(S.a,{className:V.cardCommandButton,componentRef:te,"aria-label":U("startWithDataStep.commandButtonAriaLabel"),menuProps:{items:e.commands.map(e=>R(R({},e),{},{onClick:()=>ie(e)})),className:V.cardCommandMenu}})))))})),Q&&r.a.createElement(P.a,{telemetryScope:z,onDismiss:()=>Y(!1),onDevEnvironmentReady:e=>{var t;G.push(Object(F.f)(e.name,location.search,null!==(t=ne($))&&void 0!==t?t:re(J)))}}))};function H(){var{t:e}=Object(s.t)(p.k);return{key:i.a.StartWithData,title:c.a,leftContent:W,rightContent:U,buttonStates:[{type:l.c.Next,state:{isEnabled:!1}},{type:l.c.Back,state:{isHidden:!0}}],onStepLoadedAriaLabel:e("startWithDataStep.leftContentTitle")}}function K(e){var{t:t}=Object(s.t)(p.k);return R(R({},H()),{},{title:c.c,leftContent:void 0,rightContent:()=>r.a.createElement(U,{hideSelectAnExistingTable:!0,hideSelectExternalData:!0,styleOverrides:{cardsSection:{display:"flex !important"}},stringOverrides:{headings:{selectOption:t("tableModal.startWithDataStep.headings.selectOption")},naturalLanguageHeroContent:{heroTitle1:t("tableModal.startWithDataStep.naturalLanguageHero.title"),naturalLanguageSearchBox:{placeholder:t("tableModal.startWithDataStep.naturalLanguageHero.placeholder"),placeholderShort:t("tableModal.startWithDataStep.naturalLanguageHero.placeholderShort")}}}}),buttonStates:[{type:l.c.Next,state:{isHidden:!0}},{type:l.c.Back,state:{isHidden:!e.onBack,onClick:()=>{var t;null===(t=e.onBack)||void 0===t||t.call(e)}}}]})}},38071:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return d}));var n=a(10929),r=a(38072),o=a.n(r),i=a(24423);function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){s(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var u=(e,t)=>{var a,r;return Object(n.db)({cardsSection:c({display:"flex",flexWrap:"wrap","@supports (display: grid)":{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(289px, max-content))"},justifyContent:"center",marginBottom:"36px","&.nlHeroShown":{"@media screen and (min-width: 1953px)":{display:"flex"}}},null==t?void 0:t.cardsSection),sectionHeader:{fontWeight:n.l.semibold,fontSize:n.k.size16,lineHeight:n.k.size16,marginBottom:"14px",flex:"0 1 100%","@supports (display: grid)":{gridColumn:"1 / -1"},"&.nlHeroShown":{display:"flex",justifyContent:"center",marginTop:"79px"}},cardContainer:{display:"inline-block",userSelect:"none",margin:"10px 20px 10px 0"},card:{display:"flex",flexDirection:"column",position:"relative",width:"277px",height:"227px",backgroundColor:"#ffffff",boxSizing:"content-box",boxShadow:"#0000001c 0px 0.3px 0.9px, #0000001c 0px 1.6px 3.6px",border:"1px solid #edebe9",selectors:{"&.disabled":{opacity:"0.4",boxShadow:"unset"},":focus":{outline:"1px solid"},":hover":{outline:"1px solid #c8c6c4"}}},imageContainer:{height:"169px"},cardTitle:{display:"flex",alignItems:"center",flex:1,padding:"0 12px",fontSize:n.k.size16,fontWeight:n.l.semibold,lineHeight:"24px"},cardCommandButton:{marginLeft:"4px",padding:0,height:"30px"},cardCommandMenu:{selectors:{svg:{path:{fill:null!==(a=null==e||null===(r=e.palette)||void 0===r?void 0:r.themePrimary)&&void 0!==a?a:"#742774"}}}},nlHero:{margin:"-24px -24px 0 -24px",width:"calc(100% + 48px)",height:"342px",backgroundPosition:"center bottom",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",backgroundImage:"url(".concat(o.a,")"),backgroundSize:"cover",justifyContent:"center"}})},d=()=>Object(n.db)({title:{[i.a.mediumDown]:{marginTop:0},[i.a.xLargeUp]:{marginTop:0}}})},38072:function(e,t,a){e.exports=a.p+"static/media/nlHeroGraphic.ed6d2a33.svg"},38073:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(10926),r=a.n(n),o=a(38074),i=a(37909),l=a(38075),c=a.n(l),s=a(38076),u=a.n(s),d=a(38077),p=a.n(d),m=a(38078),b=a.n(m),f=a(10929),v={UploadExcel:c(),CreateFromConnector:c(),BlankTable:u(),ExistingTable:p(),ExternalData:b()};Object(f.ib)({icons:{UploadFile:r.a.createElement("svg",{width:"16",height:"16",viewBox:"0 -1 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{d:"M4 3C4 1.89543 4.89543 1 6 1H9.58579C9.98361 1 10.3651 1.15804 10.6464 1.43934L13.5607 4.35355C13.842 4.63486 14 5.01639 14 5.41421V13C14 14.1046 13.1046 15 12 15H8.66308C9.06621 14.7161 9.42948 14.3794 9.74284 14H12C12.5523 14 13 13.5523 13 13V6H10.5C9.67157 6 9 5.32843 9 4.5V2H6C5.44772 2 5 2.44772 5 3V5.02242C4.65659 5.05337 4.32228 5.11588 4 5.20703V3ZM10.5 5H12.7929L10 2.20711V4.5C10 4.77614 10.2239 5 10.5 5ZM5.5 15C7.98528 15 10 12.9853 10 10.5C10 8.01472 7.98528 6 5.5 6C3.01472 6 1 8.01472 1 10.5C1 12.9853 3.01472 15 5.5 15ZM7.85355 10.1464C8.04882 10.3417 8.04882 10.6583 7.85355 10.8536C7.65829 11.0488 7.34171 11.0488 7.14645 10.8536L6 9.70711V12.5C6 12.7761 5.77614 13 5.5 13C5.22386 13 5 12.7761 5 12.5L5 9.70711L3.85355 10.8536C3.65829 11.0488 3.34171 11.0488 3.14645 10.8536C2.95118 10.6583 2.95118 10.3417 3.14645 10.1464L5.14645 8.14645C5.19439 8.09851 5.24964 8.06234 5.30861 8.03794C5.36669 8.01385 5.4303 8.0004 5.497 8.00001L5.5 8L5.503 8.00001C5.5697 8.0004 5.63331 8.01385 5.69139 8.03794C5.74949 8.06198 5.80398 8.09744 5.85143 8.14433L5.85395 8.14684L7.85355 10.1464Z"})),SharePoint:r.a.createElement("svg",{width:"19",height:"17",viewBox:"0 -2 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{d:"M13 12.5V3.50001C12.9998 3.37506 13.0463 3.25456 13.1305 3.16222C13.2147 3.06989 13.3304 3.01242 13.4548 3.00113C13.5793 2.98984 13.7034 3.02555 13.8028 3.10123C13.9023 3.1769 13.9697 3.28706 13.992 3.41001L14 3.50001V12.5C14.0002 12.625 13.9537 12.7455 13.8695 12.8378C13.7853 12.9301 13.6696 12.9876 13.5452 12.9989C13.4207 13.0102 13.2966 12.9745 13.1972 12.8988C13.0977 12.8231 13.0303 12.713 13.008 12.59L13 12.5ZM1.008 8.09001L1 8.00001C0.999961 7.88298 1.04097 7.76965 1.11589 7.67975C1.19081 7.58985 1.29489 7.52907 1.41 7.50801L1.5 7.50001H10.292L7.611 4.81801C7.52817 4.73527 7.477 4.6261 7.4664 4.50952C7.4558 4.39293 7.48645 4.27632 7.553 4.18001L7.611 4.11101C7.69373 4.02818 7.8029 3.97701 7.91949 3.96641C8.03608 3.95581 8.15269 3.98645 8.249 4.05301L8.318 4.11101L11.854 7.64601C11.9367 7.72886 11.9877 7.8381 11.9981 7.95468C12.0085 8.07126 11.9777 8.18781 11.911 8.28401L11.854 8.35401L8.318 11.889C8.22981 11.9776 8.11164 12.0299 7.98678 12.0357C7.86191 12.0415 7.73941 12.0003 7.64342 11.9202C7.54742 11.8402 7.4849 11.7271 7.46816 11.6032C7.45142 11.4793 7.48169 11.3537 7.553 11.251L7.611 11.182L10.292 8.50001H1.5C1.38297 8.50005 1.26964 8.45903 1.17974 8.38412C1.08984 8.3092 1.02906 8.20512 1.008 8.09001L1 8.00001L1.008 8.09001Z"}))}});var g=(e,t,a,n,r,i,l,c)=>{var s;return null===(s=Object.values(o.b).map(o=>{var s=O(o,e,t);if(y(o,n,r,i))return{key:o,title:l("startWithDataStep.tiles.".concat(o)),image:v[o],disabled:!c&&!!s,disabledReason:c?void 0:s,commands:h(o,l,t,a)}}))||void 0===s?void 0:s.filter(e=>void 0!==e)},h=(e,t,a,n)=>e===o.b.CreateFromConnector?[{key:"File",text:t("startWithDataStep.commands.".concat(o.a.File)),iconProps:{iconName:"UploadFile"},disabled:!a},{key:"SharePointList",text:t("startWithDataStep.commands.".concat(o.a.SharePointList)),iconProps:{iconName:"SharePoint"},disabled:!n}]:[],y=(e,t,a,n)=>(e!==o.b.ExistingTable||!t)&&((e!==o.b.ExternalData||!a)&&((e!==o.b.CreateFromConnector||!n)&&!(e===o.b.UploadExcel&&!n))),O=(e,t,a)=>t.isDataverse||e===o.b.ExternalData?a||e!==o.b.UploadExcel?t.isDataAccessEnabled||e!==o.b.UploadExcel&&e!==o.b.CreateFromConnector&&e!==o.b.BlankTable?void 0:i.a.NoDataAccess:i.a.DependenciesNotInstalled:i.a.NoDataverse},38074:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r}));var n={CreateFromConnector:"CreateFromConnector",UploadExcel:"UploadExcel",BlankTable:"BlankTable",ExistingTable:"ExistingTable",ExternalData:"ExternalData"},r={File:"File",SharePointList:"SharePointList"}},38075:function(e,t,a){e.exports=a.p+"static/media/tile_uploadexcel.d99614b3.svg"},38076:function(e,t,a){e.exports=a.p+"static/media/tile_blanktable.8509705e.svg"},38077:function(e,t,a){e.exports=a.p+"static/media/tile_existingtable.39724491.svg"},38078:function(e,t,a){e.exports=a.p+"static/media/tile_externaldata.a83ff0ca.svg"},38082:function(e,t,a){"use strict";a.d(t,"a",(function(){return M})),a.d(t,"b",(function(){return z}));var n=a(10926),r=a.n(n),o=a(12139),i=a(11672),l=a(12839),c=a(11465),s=a(37886),u=a(37898),d=a(22590),p=a(37917),m=a(38083),b=a(37992),f=a(12217),v=a(37918),g=a(37893),h=a(38085),y=a(38137),O=a.n(y),C=a(38138),S=a.n(C),E=a(37949),j=a(38139),T=a(38084),w=a(38140),x=a.n(w),k=a(38e3),P=a(38001),N=a(37998);function F(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?F(Object(a),!0).forEach((function(t){I(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):F(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function I(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var L=()=>{var{t:e}=Object(c.t)(g.k),t=Object(v.a)(),a=e(t?"createTableStep.emptyStateTitleTableFlow":"createTableStep.emptyStateTitle"),n=t?void 0:e("createTableStep.emptyStateSubtitle"),s=t?S.a:O.a;return r.a.createElement(o.a,{className:h.a.emptyState},r.a.createElement(i.a,{src:s,alt:""}),r.a.createElement(o.a.Item,null,r.a.createElement(l.a,{as:"p"},a),n&&r.a.createElement(l.a,{as:"p"},n)))},A=()=>{var e=Object(v.a)(),{sessionId:t}=Object(T.b)(),{t:a}=Object(c.t)(g.k),s=a(e?"createTableStep.tableCreationFailedTitleTableFlow":"createTableStep.tableCreationFailedTitle"),u=a(e?"createTableStep.tableCreationFailedSubtitleTableFlow":"createTableStep.tableCreationFailedSubtitle");return Object(n.useEffect)(()=>{g.i.createTableGenerationFailure({sessionId:t})},[]),r.a.createElement(o.a,{className:h.a.emptyState},r.a.createElement(i.a,{src:x.a,alt:""}),r.a.createElement(o.a.Item,null,r.a.createElement(l.a,{as:"p"},s),r.a.createElement(l.a,{as:"p"},u)))},B=()=>{var{t:e}=Object(c.t)(g.k),t=e("createTableStep.leftContentCTATitle"),a=e("createTableStep.leftContentCTASubtitle"),n=e("createTableStep.leftContentSubtitle");return r.a.createElement(o.a,{className:h.a.leftContentSubtitle},r.a.createElement(l.a,{as:"p"},n),r.a.createElement(l.a,{as:"strong"},t),r.a.createElement(l.a,{as:"p"},a))},R=()=>{var{t:e}=Object(c.t)(g.k),t=e("createTableStep.leftContentSubtitleTableFlow1"),a=e("createTableStep.leftContentSubtitleTableFlow2");return r.a.createElement(o.a,{className:h.a.leftContentSubtitle},r.a.createElement(l.a,{as:"p"},t),r.a.createElement(l.a,{as:"p"},a),r.a.createElement("div",null,r.a.createElement(c.c,{t:e,i18nKey:"createTableStep.leftContentCTATitleTableFlow",components:{b:r.a.createElement("b",null)}})))},M={key:d.a.CreateTable,title:p.e,rightContent:()=>{var e=Object(v.a)(),{onTableCreated:t}=Object(b.a)(f.k.NL),{t:a}=Object(c.t)(g.k),n=a(e?"createTableStep.chatInputEmptyStatePlaceholderTableFlow":"createTableStep.chatInputEmptyStatePlaceholder");return Object(N.a)(d.a.CreateTable),r.a.createElement(r.a.Fragment,null,r.a.createElement(m.a,{webChatInputEmptyStatePlaceholder:n,busyState:k.a,emptyState:L,creationFailedState:A,onTableCreated:t}))},leftContent:()=>{var e=Object(v.a)(),{t:t}=Object(c.t)(g.k),a=t(e?"createTableStep.leftContentTitleTableFlow":"createTableStep.leftContentTitle");return r.a.createElement(E.a,{title:a,subtitle:()=>r.a.createElement(r.a.Fragment,null,e?r.a.createElement(R,null):r.a.createElement(B,null)),RenderBottomContent:()=>r.a.createElement(j.a,null)})},buttonStates:[...u.c,{type:s.c.Back,state:{isHidden:!0}}]};function z(e){var{t:t}=Object(c.t)(g.k),a=Object(v.a)(),n=t(a?"createTableStep.leftContentTitleTableFlow":"createTableStep.leftContentTitle");return D(D({},M),{},{title:p.c,leftContent:void 0,rightContent:()=>{var a=t("createTableStep.chatInputEmptyStatePlaceholderTableFlow");return r.a.createElement(r.a.Fragment,null,r.a.createElement(m.a,{solutionId:e.solutionId,webChatInputEmptyStatePlaceholder:a,busyState:P.a,emptyState:L,creationFailedState:A,stringOverrides:{completeButtonLabel:t("common.buttons.saveAndClose")},onTableCreated:t=>{e.onTableCreated(t.persistedTableData.logicalName)}}))},onStepLoadedAriaLabel:n})}},38083:function(e,t,a){"use strict";a.d(t,"a",(function(){return V}));var n=a(11860),r=a(11934),o=a(12139),i=a(13448),l=a(37950),c=a(20491),s=a(37570),u=a(37574),d=a(37883),p=a(11465),m=a(20490),b=a(37885),f=a(37886),v=a(10926),g=a.n(v),h=a(11031),y=a(38044),O=a(37893),C=a(37996),S=a(38043),E=a(37914),j=a(38084),T=a(38085),w=a(38089),x=a(38091),k=a(38135),P=a(22587),N=a(38132),F=a(11636),D=a(38136),I=a(37636),L=a(12217),A=a(37999),B=a(13737),R=a(13807),M=a(11205),z=a(12349),W=a(22589);function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function U(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){H(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function H(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var K=()=>{var{t:e}=Object(p.t)(O.k),t=e("createTableStep.aiDisclosureMessage"),a=e("createTableStep.aiDisclosureLearnMore"),r=Object(p.h)(),o=i.a.nl2TableTerms[Object(p.k)(r)]||i.a.nl2TableTerms[r];return g.a.createElement("div",{className:T.a.disclaimer},t," ",g.a.createElement(n.a,{className:T.a.link,target:"_blank",href:null!=o?o:i.a.nl2TableTerms.en,underline:!0},a))},V=e=>{var t,a,i,_,H,V,q,G,{webChatInputEmptyStatePlaceholder:Z,busyState:Q,emptyState:Y,creationFailedState:$,onTableCreated:X,stringOverrides:J,solutionId:ee}=e,{enableNLTableCreation:te}=Object(m.a)(),[ae,ne]=Object(v.useState)(!1),{t:re}=Object(p.t)(O.k),[oe,ie]=Object(v.useState)(Object(h.a)()),[le,ce]=Object(v.useState)(!1),se=Object(v.useRef)(!1),{getValue:ue}=Object(b.c)(),{setWarnOnNavigate:de}=Object(S.a)(),{solutionData:pe,solutionIsLoading:me}=Object(l.a)(O.j,ee),be=Object(M.j)(),fe=Object(z.h)(be.search)[W.a],[ve,ge]=Object(v.useState)(fe||ue("prompt")),[he,ye]=Object(v.useState)(""),[Oe,Ce]=Object(v.useState)(!1),[Se,Ee]=Object(v.useState)(),[je,Te]=Object(v.useState)(!0),[we,xe]=Object(v.useState)(void 0),[ke,Pe]=Object(v.useState)(!1),[Ne,Fe]=Object(v.useState)(!1),{mutate:De,isSuccess:Ie,data:Le,isLoading:Ae,isError:Be,error:Re}=Object(I.a)(),{updateFooterButton:Me,showMessage:ze,isWarningOnNavigate:We,getStepKeys:_e}=Object(b.b)(),{label:Ue}=Object(A.a)();Ue=(null==J?void 0:J.completeButtonLabel)||Ue;var He=!(null===(t=_e())||void 0===t||!t.backStepKey),Ke=Object(w.a)({table:Se,initialPrompt:ve}),Ve=Object(w.d)({table:Se}),qe=Ve||Ke,Ge=te&&!qe&&!Ie&&!Ne,Ze=qe?Z:re("createTableStep.chatInputPlaceholder"),{isUniqueSchemaName:Qe}=Object(C.a)({schemaName:null!==(a=null==we?void 0:we.entity.SchemaName)&&void 0!==a?a:null==Se?void 0:Se.entity.SchemaName}),{uniqueSchemaName:Ye,isInitialLoading:$e}=Object(d.a)({newTableName:null==Se||null===(i=Se.entity)||void 0===i||null===(_=i.DisplayName)||void 0===_||null===(H=_.LocalizedLabels[0])||void 0===H?void 0:H.Label,solutionUniqueName:null==pe||null===(V=pe.solution)||void 0===V?void 0:V.uniqueName,customizationPrefix:null==pe||null===(q=pe.solution)||void 0===q||null===(G=q.publisher)||void 0===G?void 0:G.customizationPrefix}),{hasReachedBreakpoint:Xe}=Object(D.a)(F.a.large),Je=Object(B.e)({isSolutionFirst:!1}),{devEnvironment:et,createDevEnvironment:tt,isCreateEnvComplete:at,isLoading:nt,isError:rt,error:ot}=Object(P.a)(O.j),it=Object(R.jb)(),lt=Ae||nt,ct=Re||ot,st=Be||rt,{canUserCreateOrUseDevEnvironment:ut}=Object(c.a)(),dt=(e,t,a)=>{De({inMemoryTable:t,configurationType:mt,targetEnvironment:e,solutionUniqueName:a,enableSingleSaveApi:!1,isPreferredSolutionFeatureEnabled:Je})};Se&&ke&&et&&at&&!Ne&&(Fe(!0),dt(et,Se,""));if(!qe&&null!=Se&&Se.entity&&Ye&&Ye!==(null==Se?void 0:Se.entity.SchemaName)&&!$e&&!Qe){var pt=U(U({},Se),{},{entity:U(U({},Se.entity),{},{SchemaName:Ye})});Ee(U(U({},pt),{},{entity:U({},Object(N.b)({entity:pt.entity,isCDSLiteUX:it,shouldAppBeCreatedInDevEnvironment:ut}).entity)}))}var mt=y.a.enableConversationalManualEdits?u.a.ConversationalReadWrite:u.a.ConversationalReadOnly;if(Object(v.useEffect)(()=>{Me(f.c.Complete,{onClick:()=>{var e,t=null==pe||null===(e=pe.solution)||void 0===e?void 0:e.uniqueName,a=t&&Se&&we;a&&!ut?(dt(void 0,Se,t),Pe(!0)):a&&ut&&ne(!0)},isEnabled:Qe&&je,label:Ue})},[Se,Qe,je,we]),lt||!Ie||!Le||We||se.current){if(!lt&&st&&ct&&ke){var bt,ft,vt,gt=null===(bt=ct.response)||void 0===bt||null===(ft=bt.data)||void 0===ft||null===(vt=ft.error)||void 0===vt?void 0:vt.message,ht=Object(E.c)(ct,re);O.i.createTableCreateAppFailure({sessionId:oe,errorMessage:ht,originalError:gt,shouldAppBeCreatedInDevEnvironment:ut}),Fe(!1),Pe(!1),ze(re("common.errors.createAppError",{error:ht}),r.a.error)}}else{var yt;se.current=!0,O.i.createTableCreateAppSuccess({sessionId:oe,shouldAppBeCreatedInDevEnvironment:ut});var Ot=null==pe||null===(yt=pe.solution)||void 0===yt?void 0:yt.id,Ct=null==Se?void 0:Se.entity.DisplayName.LocalizedLabels[0].Label;X({action:L.b,appName:Ct,switchToDevEnvironment:!!ut,devEnvironment:et,persistedTableData:Le,solutionId:Ot})}Object(v.useEffect)(()=>{void 0!==Se&&""!==ve&&ge("")},[Se]),Object(v.useEffect)(()=>Me(f.c.Back,{isHidden:!He}),[He]),Ge&&!We?de(!0,{title:re("createTableStep.navigationPreventionDialogTitle"),subText:re("createTableStep.navigationPreventionDialogSubtitle"),cancelButtonLabel:re("createTableStep.navigationPreventionDialogStayButton"),confirmButtonLabel:re("createTableStep.navigationPreventionDialogLeaveButton")}):!Ge&&We&&de(!1);var St=!Ve&&!Ne;return!St&&je&&Te(!1),g.a.createElement(j.a,{value:{table:Se,setTable:Ee,sessionId:oe,resetSession:()=>{Ee(void 0),ie(Object(h.a)()),ge("")},updatedTable:we,shouldAppBeCreatedInDevEnvironment:ut}},ke&&g.a.createElement(Q,null),g.a.createElement(k.a,{isVisible:ae,onDismiss:()=>{O.i.devEnvDialogDismiss(),ne(!1)},onConfirm:()=>{O.i.devEnvDialogConfirm(),ne(!1),Pe(!0),et?Se&&(Fe(!0),dt(et,Se,"")):tt()}}),g.a.createElement(o.a,{className:"".concat(T.a.createTableRightContentWrapper," ").concat(T.a.seeExperienceInFullScreen)},Xe&&g.a.createElement(o.a,{horizontal:!0,className:T.a.contentSwitcher},g.a.createElement(n.a,{"data-testid":"toggleButton",onClick:()=>{ce(!le)}},re(le?"createTableStep.seeTable":"createTableStep.seeCopilot"))),g.a.createElement(o.a,{horizontal:!0,className:T.a.inMemoryTableAndChatWrapper},g.a.createElement(o.a,{className:T.a.inMemoryTableAndStateContainersWrapper,style:{display:Xe&&le?"none":"flex"}},Ke&&g.a.createElement(Y,null),Ve&&g.a.createElement($,null),g.a.createElement(o.a,{className:"".concat(T.a.inMemoryTableWrapper).concat(qe?" hidden":"")},St&&g.a.createElement(s.a,{classNames:{commandBarWrapper:T.a.commandBarWrapper,commandBarControl:T.a.commandBarControl},table:Se,isLoading:me,solutionContext:null==pe?void 0:pe.solution,configurationType:mt,shouldSkipApiAndUseDevEnvironmentDefaults:ut,onUpdate:e=>{xe(e.table),Te(e.canBeSaved)},validationErrorAutoFixer:{fix:e=>{var t={MissingPrimaryNameColumn:re("createTableStep.helpMeFixIt.addPrimaryNameColumn")}[e.code];t&&ye(t)},isLoading:Oe}}))),!!pe&&g.a.createElement(o.a,{className:"".concat(T.a.webChatWrapper).concat(Xe?" sideBySide":""),style:{display:Xe&&!le?"none":"flex"}},g.a.createElement(x.b,null),g.a.createElement(x.a,{key:oe,onDisabledChange:Ce,setAdditionalPrompt:ye,additionalPrompt:he,solutionData:pe,initialPrompt:ve,chatInputPlaceholder:Ze}),g.a.createElement(K,null)))))}},38084:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"c",(function(){return s})),a.d(t,"e",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"d",(function(){return p}));var n=a(12353),r=a(10926),o={sessionId:"",table:void 0,setTable:n.noop,resetSession:n.noop,updatedTable:void 0,shouldAppBeCreatedInDevEnvironment:!1},i=Object(r.createContext)(o),l=()=>Object(r.useContext)(i),c=i.Provider,s=()=>({setTable:l().setTable}),u=()=>({updatedTable:l().updatedTable}),d=()=>{var{resetSession:e,sessionId:t}=l();return{resetSession:e,sessionId:t}},p=()=>({shouldAppBeCreatedInDevEnvironment:l().shouldAppBeCreatedInDevEnvironment})},38085:function(e,t,a){"use strict";a.d(t,"c",(function(){return v})),a.d(t,"b",(function(){return y})),a.d(t,"a",(function(){return O}));var n=a(10929),r=a(10964),o=a(38086),i=a(38087),l=a.n(i),c=a(38088),s=a.n(c),u=a(37997);function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){m(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function m(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var{palette:b,semanticColors:f}=Object(n.Y)(),v={avatarSize:28,sendBoxTextWrap:!0,bubbleBorderRadius:8,hideUploadButton:!0,showAvatarInGroup:!0,suggestedActionBorderWidth:1,bubbleFromUserBorderRadius:8,typingAnimationDuration:25e3,suggestedActionBorderRadius:4,suggestedActionBorderStyle:"none",suggestedActionLayout:"stacked",suggestedActionTextColor:b.black,bubbleBackground:b.white,suggestedActionBackgroundColor:b.white,bubbleFromUserBackground:"#F6E4F6",bubbleBorderStyle:"none",bubbleFromUserBorderStyle:"none",suggestedActionBorderColor:b.blackTranslucent40},{borderShine:g}=Object(o.a)({iteration:"2",borderWidth:"2px",theme:Object(n.Y)()}),h=Object(n.bb)({"0%":{left:"-65%"},"100%":{left:"100%"}}),y={main:{background:b.white,margin:"-4px 1px 4px",minHeight:40},progressbarStyle:{borderRadius:4,"& .ms-ProgressIndicator-progressBar":{background:"linear-gradient(90deg, #0F6CBD 35%, #46E2FA 70%, #CD75FF 92%)",borderRadius:4,animationName:h}},headerStyle:{margin:"0",padding:"10px 12px 5px"}},O=Object(n.db)(p({createTableRightContentWrapper:{justifyContent:"space-between"},createTableCenterContent:{flexGrow:1,maxWidth:"calc(100% - 341px)"},contentSwitcher:{backgroundColor:f.defaultStateBackground,height:"24px",paddingLeft:"10px"},inMemoryTableAndChatWrapper:{height:"100%"},inMemoryTableAndStateContainersWrapper:{width:"100%",overflow:"hidden"},inMemoryTableWrapper:{width:"auto",height:"100%","&.hidden":{display:"none"}},suggestionsWrapper:{padding:"12px 24px 16px",background:b.white,boxShadow:r.a.depth4,borderRadius:4,h5:{paddingBottom:8,marginBottom:12,fontWeight:n.l.semibold,borderBottom:"1px solid ".concat(b.neutralLight)},"@media screen and (max-height: 615px)":{display:"none"}},suggestion:{lineHeight:20,marginBottom:4,i:{color:b.themePrimary}},webchat:{".ms-Stack > &":{width:"100%",maxHeight:"calc(100% - 105px)",background:"none",".webchat__basic-transcript__transcript":{width:"100%"}},".webchat__stacked-layout":{margin:"0 14px !important",background:b.white,borderColor:"#E6E6E6",borderRadius:8,borderStyle:"none",borderWidth:1,boxShadow:"rgba(0, 0, 0, 0.14) 0px 1px 2px, rgba(0, 0, 0, 0.12) 0px 0px 2px"},".webchat__bubble__content":{minHeight:"auto !important","> p, > .markdown":{padding:"8px 16px",lineHeight:20}},".webchat__icon-button":{width:"32px !important",margin:"8px 0",alignSelf:"flex-end !important",".webchat__icon-button__shade":{height:"32px !important",width:"32px !important",top:"-9px !important",left:"-2px !important",bottom:"0px !important",right:"0px !important",borderRadius:"8px !important"},":before":{zIndex:1,width:16,height:16,content:"url(".concat(l.a,")")},':hover:not([aria-disabled="true"])':{cursor:"pointer",":before":{zIndex:1,width:16,height:16,content:"url(".concat(s.a,")")}},".webchat__send-icon":{display:"none"},".webchat__basic-transcript__scrollable":{display:"flex",justifyContent:"space-between"}},".webchat__basic-transcript .webchat__basic-transcript__scrollable":{"::-webkit-scrollbar":{width:6,height:4},"::-webkit-scrollbar-thumb":{backgroundColor:b.blackTranslucent40,borderRadius:7}},".webchat__bubble:not(.webchat__bubble--from-user)":{".webchat__bubble__content":{margin:"4px 2px",minWidth:286,"> div":{paddingBottom:0}}},".webchat__send-box":{position:"relative",padding:"0 11px 8px",".webchat__send-box__main":p(p({},g),{},{margin:"5px 5px 0",padding:"12px 12px",flexDirection:"column",minHeight:"80px !important",border:"1px solid #D1D1D1 !important",borderRadius:8,":focus-within::after":{position:"absolute",left:0,bottom:0,height:5,width:"100%",content:"''",borderRadius:"0px 0px 8px 8px",backgroundImage:"linear-gradient(to right, rgb(116, 39, 116), rgb(141, 48, 141))"}})},".webchat__send-box-text-box":{padding:"0 !important",alignItems:"flex-start !important",maxWidth:278,paddingBottom:"12px !important"},".webchat__suggested-actions__stack":{paddingTop:"0 !important",paddingLeft:"1px !important",paddingRight:"1px !important"},".webchat__suggested-actions__item-box":{borderRadius:4,button:{boxShadow:r.a.depth4,justifyContent:"left",":hover":{cursor:"pointer"}}},".webchat__suggested-actions:focus-within .webchat__suggested-actions__focus-indicator":{display:"none !important"},'.webchat__icon-button[aria-disabled="true"] .webchat__icon-button__shade':{background:"none !important"},".webchat__basic-transcript__activity-body":{display:"flex"},".webchat__basic-transcript__activity-body:has(div.webchat__stacked-layout--from-user)":{flexDirection:"row-reverse"},".webchat__stacked-layout__status":{marginLeft:20}},chatBubbleDisclaimer:{fontSize:10,lineHeight:14,color:"#707070",paddingBottom:12,width:260,display:"flex",alignItems:"center",justifyContent:"space-between",button:{width:20,height:20,svg:{height:14,width:"auto",color:"#424242"}}},chatBubbleDisclaimerLabel:{width:206},link:{"&.ms-Link":{color:b.themePrimary}},webChatWrapper:{overflow:"hidden",width:"auto",margin:"auto",backgroundColor:f.defaultStateBackground,borderLeft:"".concat(1,"px solid ").concat(b.neutralQuaternaryAlt),height:"100%",maxWidth:320,minWidth:320,"&.sideBySide":{width:"100%",minWidth:"auto",maxWidth:"none"}},webChatTitle:{lineHeight:26,padding:"12px 16px",h2:{fontSize:20,fontWeight:n.l.semibold},img:{width:24,height:24}},disclaimer:{fontSize:10,color:"#707070",padding:"0 16px 16px"},emptyState:{gap:28,width:"100%",height:"100%",padding:"24px",alignItems:"center",justifyContent:"center",p:{fontSize:18,display:"block",textAlign:"center",":first-of-type":{fontWeight:n.l.semibold}},img:{width:200,height:"auto","@media screen and (max-height: 516px)":{display:"none"}}},leftContentSubtitle:{p:{marginBottom:16},strong:{marginBottom:4,fontWeight:n.l.semibold}},typingIndicatorWrapper:{bottom:0,width:"100%",padding:"10px 16px"}},Object(u.b)()))},38087:function(e,t,a){e.exports=a.p+"static/media/sendButton.85a38038.svg"},38088:function(e,t,a){e.exports=a.p+"static/media/sendButtonHover.7ade4ca7.svg"},38089:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"d",(function(){return i})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"f",(function(){return s})),a.d(t,"g",(function(){return d})),a.d(t,"e",(function(){return p}));var n=a(38090),r=a(37893),o=e=>{var{initialPrompt:t,table:a}=e;return void 0===a&&!t},i=e=>{var{table:t}=e;return void 0!==t&&t.entity===n.a.tableSchema},l=e=>{var t;return"InappropriateContentDetected"===(null===(t=e.response)||void 0===t?void 0:t.data.error.code)},c=e=>{var t;return"RelevancyCheckFailed"===(null===(t=e.response)||void 0===t?void 0:t.data.error.code)},s=(e,t)=>{var a,n,r,o=null===(a=e.response)||void 0===a||null===(n=a.data.error.messages)||void 0===n?void 0:n[0],i=null===(r=e.response)||void 0===r?void 0:r.data.error.code;return"ERR_SESSION_EXPIRED"===o?t("createTableStep.errorMessages.errorSessionExpired"):"ERR_TOKEN_LIMIT_MESSAGE"===o?t("createTableStep.errorMessages.errorTokenLimitMessage"):"RelevancyCheckFailed"===i?t("createTableStep.errorMessages.errorRelevancyCheckFailed"):"InappropriateContentDetected"===i?t("createTableStep.errorMessages.errorInappropriateContentDetected"):o},u={NL2TABLE_DEFAULT_QUESTION:"createTableStep.quickReply.nL2TableDefaultQuestion",ERR_NEW_TABLE_CONTEXT_DETECTED:"createTableStep.quickReply.errorNewTableContextDetected",ERR_EMPTY_TABLE_NAME:"createTableStep.quickReply.errorEmptyTableName",ERR_EMPTY_COLUMN_NAME:"createTableStep.quickReply.errorEmptyColumnName",ERR_TOKEN_LIMIT:"createTableStep.quickReply.errorTokenLimit"},d=(e,t)=>e in u?(r.i.createTableBotResponseWarning({warning:e}),t(u[e])):e.indexOf("WARN_TOKEN_LIMIT")>-1?(r.i.createTableBotResponseWarning({warning:"WARN_TOKEN_LIMIT"}),e.replace("WARN_TOKEN_LIMIT",t("createTableStep.quickReply.warningTokenLimit"))):e,p=(e,t)=>{var a,n,r=[];return e.columns?e.columns:((e.columnsToAdd||e.columnsToRemove)&&(null===(a=e.columnsToAdd)||void 0===a||a.forEach(e=>{r.push({name:t("createTableStep.quickReply.suggestionToAddColumn",{columnName:e.name})})}),null===(n=e.columnsToRemove)||void 0===n||n.forEach(e=>{r.push({name:t("createTableStep.quickReply.suggestionToRemoveColumn",{columnName:e.name})})}),r.push({name:t("createTableStep.quickReply.askSuggestion")})),r)}},38090:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r}));var n={Success:"Success",Failed:"Failed",Inprogress:"Inprogress"},r={tableData:[],tableSchema:{}}},38091:function(e,t,a){"use strict";a.d(t,"b",(function(){return _})),a.d(t,"a",(function(){return U}));var n=a(11629),r=a(12139),o=a(11672),i=a(12839),l=a(11712),c=a(11624),s=a(11708),u=a(11823),d=a(11824),p=a(11019),m=a(11465),b=a(38092),f=a.n(b),v=a(38129),g=a(35045),h=a(32612),y=a(12353),O=a(10926),C=a.n(O),S=a(38036),E=a.n(S),j=a(37893),T=a(38084),w=a(38085),x=a(38130),k=a(38131),P=a(18850),N=a(38134),F=["botDecorator"];function D(){return(D=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function I(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function L(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?L(Object(a),!0).forEach((function(t){B(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):L(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function B(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var R=Object(y.memoize)(e=>t=>A(A({},t),{},{TEXT_INPUT_PLACEHOLDER:e})),M={teamName:"powerapps",surveyName:"powerappschatgpt"},z=e=>()=>()=>t=>{var{activeTyping:a}=t;return a.bot?C.a.createElement("div",{className:w.a.typingIndicatorWrapper},C.a.createElement(f.a,{styles:w.b,loadingUiStrings:[e]})):C.a.createElement(C.a.Fragment,null)},W=e=>{var{onDismissCallout:t,onSubmitFeedback:a,onButtonDismiss:n,calloutType:r,buttonId:o,shouldShowCallout:i,textInputRef:l,restoreFocus:c}=e;return C.a.createElement(O.Suspense,{fallback:null},C.a.createElement(g.a,{target:o,calloutType:r,hidden:!i,onSubmit:()=>{c(),a()},textInputRef:l,onDismiss:()=>{c(),t()},onButtonDismiss:()=>{c(),n()}}))},_=()=>{var{sessionId:e}=Object(T.b)(),{t:t}=Object(m.t)(j.k),[a,p]=Object(O.useState)(!1),b=()=>p(!1),{resetSession:f}=Object(T.b)(),v={type:n.a.normal,title:t("createTableStep.resetChatDialogTitle"),closeButtonAriaLabel:t("createTableStep.closeAriaLabel"),subText:t("createTableStep.resetChatDialogSubtitle")};return C.a.createElement(r.a,{className:w.a.webChatTitle,verticalAlign:"center",horizontal:!0,horizontalAlign:"space-between"},C.a.createElement(r.a,{verticalAlign:"center",horizontal:!0,tokens:{childrenGap:7}},C.a.createElement(o.a,{src:E.a,alt:""}),C.a.createElement(i.a,{as:"h2"},t("createTableStep.chatTitle"))),C.a.createElement(r.a.Item,null,C.a.createElement(l.a,{iconProps:{iconName:"Refresh"},onClick:()=>p(!0),title:t("createTableStep.resetChatTooltip")}),C.a.createElement(c.a,{hidden:!a,dialogContentProps:v,onDismiss:b},C.a.createElement(s.a,null,C.a.createElement(u.a,{onClick:()=>{j.i.createTableResetSession({sessionId:e}),f(),b()},text:t("createTableStep.restartDialogButton")}),C.a.createElement(d.a,{onClick:()=>{j.i.createTableDismissResetSession({sessionId:e}),b()},text:t("createTableStep.cancelDialogButton")})))))},U=e=>{var{initialPrompt:t,solutionData:a,chatInputPlaceholder:n,additionalPrompt:r,setAdditionalPrompt:o,onDisabledChange:i}=e,{t:l}=Object(m.t)(j.k),[c,s]=Object(O.useState)(!1),{oid:u}=Object(p.t)(),d=Object(x.a)({solutionData:a}),b=R(n),f=l("createTableStep.botTypingIndicatorText"),{storeFocus:g,restoreFocus:y}=Object(P.a)(),S=Object(v.b)(l("createTableStep.feedbackThanks"),M,l("createTableStep.feedbackThumbsUpAriaLabel"),l("createTableStep.feedbackThumbsDownAriaLabel"),()=>g(),()=>g()),{botDecorator:E}=S,T=I(S,F);null==i||i(c),Object(O.useEffect)(()=>{d.activity$.filter(e=>e.from.id===k.a).subscribe(e=>{"typing"===e.type?s(!0):"message"===e.type&&s(!1)})},[d]);var L=C.a.useCallback(()=>()=>e=>{var{activity:{from:{role:t},timestamp:a}}=e;if("bot"===t)return C.a.createElement("span",{className:w.a.chatBubbleDisclaimer},C.a.createElement("span",{className:w.a.chatBubbleDisclaimerLabel},l("createTableStep.botMessageDisclaimer")),C.a.createElement("span",null,E(a,!1)))},[E,l]);return C.a.createElement(h.Components.Composer,{userID:u,disabled:c,directLine:d,sendTypingIndicator:!0,styleOptions:w.c,overrideLocalizedStrings:b,activityStatusMiddleware:L,typingIndicatorMiddleware:z(f)},C.a.createElement(N.a,{initialPrompt:t,additionalPrompt:r,setAdditionalPrompt:o}),C.a.createElement(W,D({},T,{restoreFocus:y})))}},38130:function(e,t,a){"use strict";var n=a(38131);a.d(t,"a",(function(){return n.b}));a(38132)},38131:function(e,t,a){"use strict";a.d(t,"a",(function(){return v})),a.d(t,"b",(function(){return h}));var n=a(11465),r=a(33963),o=a(10926),i=a(35051),l=a(35079),c=a(11031),s=a(37893),u=a(38084),d=a(38132),p=a(37994);function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach((function(t){f(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function f(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var v="bot";var g=e=>{var{text:t,suggestions:a}=e;return b({text:t,type:"message",from:{id:v},timestamp:(new Date).toString()},(e=>e?{suggestedActions:{actions:e.map(e=>({text:e.name,title:e.name,value:e.name,type:"imBack"}))}}:{})(a))};function h(e){var t,a,m,f,{solutionData:h}=e,{sessionId:y}=Object(u.b)(),{t:O}=Object(n.t)(s.k),C=O("createTableStep.serverErrorMessage",{sessionId:y}),S=O("createTableStep.promptLengthExceededErrorMessage"),{sendPrompt:E}=Object(d.a)(),j=Object(p.a)(),{customizationPrefix:T="",customizationOptionValuePrefix:w=0}={customizationPrefix:null==h||null===(t=h.solution)||void 0===t||null===(a=t.publisher)||void 0===a?void 0:a.customizationPrefix,customizationOptionValuePrefix:null==h||null===(m=h.solution)||void 0===m||null===(f=m.publisher)||void 0===f?void 0:f.customizationOptionValuePrefix};return Object(o.useMemo)(()=>{var e,t=new i.BehaviorSubject(r.ConnectionStatus.Uninitialized),a=(e=[],{complete:()=>e.forEach(e=>e.complete()),error:t=>e.forEach(e=>e.error(t)),next:t=>e.forEach(e=>e.next(t)),observable:new i.Observable(t=>(e.push(t),()=>{var a,n,r;n=t,(r=(a=e).indexOf(n))>=0&&a.splice(r,1)}))}),n=e=>{var t,n,r,o,i=e,{response:l}=i,c=null==l?void 0:l.status,u=null==l||null===(t=l.data)||void 0===t||null===(n=t.error)||void 0===n?void 0:n.code,d=null==l||null===(r=l.data)||void 0===r?void 0:r.error.messages[0],p=i.message;o="PromptLengthExceeded"===u?S:void 0===c||Number(c)>=500?C:d||p,s.i.createTableBotResponseFailure({sessionId:y,errorMessage:o,originalError:p,responseStatus:c,apiErrorMessage:d}),a.next(g({text:o}))},o=e=>{var{answer:t,suggestions:n}=e,r=g({text:t,suggestions:n});s.i.createTableBotResponseSuccess({sessionId:y,hasSuggestions:(null==n?void 0:n.length)>0}),a.next(r)};return t.next(r.ConnectionStatus.Online),{activity$:a.observable,connectionStatus$:t,end:()=>{a.complete(),t.next(r.ConnectionStatus.Ended)},postActivity:e=>{if((e=>"typing"===e.type)(e))return i.Observable.from("");if(a.next(b(b({},e),{},{id:Object(c.a)(),timestamp:(new Date).toString()})),(e=>"message"===e.type)(e)){var t={question:e.text,customizationPrefix:T,customizationOptionValuePrefix:w,languageCode:j};Object(l.fromPromise)(E(t)).subscribe(o,n)}return a.next({type:"typing",from:{id:v}}),i.Observable.from(e.channelData.clientActivityID)}}},[y])}},38132:function(e,t,a){"use strict";a.d(t,"b",(function(){return w})),a.d(t,"a",(function(){return k}));var n=a(38133),r=a(11868),o=a(12219),i=a(12353),l=a(10926),c=a(38044),s=a(37893),u=a(37898),d=a(38084),p=a(11031),m=a(38090),b=a(38089),f=a(16211),v=a(13807),g=a(17678),h=a(17682),y=a(11465);function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){S(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function S(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function E(e,t,a,n,r,o,i){try{var l=e[o](i),c=l.value}catch(s){return void a(s)}l.done?t(c):Promise.resolve(c).then(n,r)}function j(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function i(e){E(o,n,r,i,l,"next",e)}function l(e){E(o,n,r,i,l,"throw",e)}i(void 0)}))}}var T=()=>{var{sessionId:e}=Object(d.b)(),{currentEnvironmentName:t}=Object(o.X)(),{enableNL2TableScenarioName:a}=Object(f.e)(),{enableNL2TableGeoExpansion:n}=Object(g.b)(),{isEnabled:i}=Object(h.a)(!!n),p=function(){var n=j((function*(n){var{question:o,customizationPrefix:l,languageCode:d,customizationOptionValuePrefix:p,tableData:m,tableSchema:b}=n,f=C(C({question:o},i?{crossGeoOptions:{enableCrossGeoCall:i}}:void 0),{},{context:C({sessionId:e,customizationPrefix:l,languageCode:d,customizationOptionValuePrefix:p,scenario:a?u.b.scenarios.NL2Table:u.b.scenarios.DataverseTable},c.a.enableConversationalManualEdits?{tableData:m,tableSchema:b}:void 0)});return s.i.createTableSendMessage({sessionId:e}),yield r.f.post(u.b.endpoint(t),f)}));return function(e){return n.apply(this,arguments)}}();return Object(l.useState)({sendChatMessage:p})[0]},w=Object(i.flow)([e=>{var t=Object(p.a)().substring(0,5);return C(C({},e),{},{entity:C(C({},e.entity),{},{SchemaName:e.builtUsingDevEnvironmentDefaults?e.entity.SchemaName+t:e.entity.SchemaName})})},e=>C(C({},e),{},{entity:C(C({},e.entity),{},{Attributes:e.entity.Attributes.map(t=>{var a;return null!=t&&null!==(a=t.OptionSet)&&void 0!==a&&a.Name&&(t.OptionSet.Name="".concat(e.entity.SchemaName,"_").concat(t.SchemaName)),t})})}),e=>C(C({},e),{},{entity:C(C({},e.entity),{},{ChangeTrackingEnabled:!e.isCDSLiteUX,IsOfflineInMobileClient:{Value:!e.isCDSLiteUX}})})]),x=e=>{var{additionalData:t=[],builtUsingDevEnvironmentDefaults:a,isCDSLiteUX:n}=e,r=0===t.length,{tableData:o,tableSchema:i}=r?m.a:((e,t,a)=>{var{tableData:n,tableSchema:r,answer:o,properties:i,suggestions:l}=e;return{answer:o,properties:i,suggestions:l,tableSchema:w({entity:r,builtUsingDevEnvironmentDefaults:t,isCDSLiteUX:a}).entity,tableData:n}})(t[0],a,n);return{data:o,entity:i,autoNumberSeeds:{},builtUsingDevEnvironmentDefaults:a}};function k(){var{setTable:e}=Object(d.c)(),{sendChatMessage:t}=T(),{updatedTable:a}=Object(d.e)(),{sessionId:r}=Object(d.b)(),{shouldAppBeCreatedInDevEnvironment:o}=Object(d.d)(),c=Object(l.useRef)(void 0);c.current=a;var u=Object(v.jb)(),{t:p}=Object(y.t)(s.k);function f(){return(f=j((function*(a){var{question:l,customizationPrefix:d,customizationOptionValuePrefix:f,languageCode:v}=a;try{var g,h,y,O,{data:C}=yield t({question:l,customizationPrefix:d,customizationOptionValuePrefix:f,languageCode:v,tableData:null===(g=c.current)||void 0===g?void 0:g.data,tableSchema:null===(h=c.current)||void 0===h?void 0:h.entity}),{additionalData:S,answers:E}=C,j=null!==(y=null==S||null===(O=S[0])||void 0===O?void 0:O.suggestions)&&void 0!==y?y:{},T=C.operationStatus===m.b.Success,w=E.length>-1?E[E.length-1]:"";if(T){var k=S.length>0&&Object(i.isNil)(S[0].tableSchema)?void 0:x({additionalData:S,builtUsingDevEnvironmentDefaults:o,isCDSLiteUX:u});k&&(k=Object(n.a)(k)),e(k)}return{answer:Object(b.g)(w,p),suggestions:Object(b.e)(j,p)}}catch(A){var P,N=A,F=null===(P=N.response)||void 0===P?void 0:P.data.error.messages[0],D=Object(b.f)(N,p);if(Object(b.b)(N)||Object(b.c)(N))return c.current||e(x({additionalData:[]})),s.i.createTableInappropriateContent({sessionId:r}),{answer:D,suggestions:[]};if(c.current)throw A;var I,L=null===(I=N.response)||void 0===I?void 0:I.status;return e(x({additionalData:[]})),s.i.createTableBotResponseFailure({sessionId:r,errorMessage:F,userErrorMessage:D,responseStatus:L}),{answer:D,suggestions:[]}}}))).apply(this,arguments)}return{sendPrompt:function(e){return f.apply(this,arguments)}}}},38133:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(19360),r=a(37576),o=a(11885),i=a(11021),l=a(37572);function c(e){var t,a={};return null===(t=e.entity.Attributes)||void 0===t||t.forEach(t=>{var i;(null===(i=t.AttributeTypeName)||void 0===i?void 0:i.Value)===o.e.ImageType||t["@odata.type"]===n.a.Image?e.data.forEach(e=>{e[Object(r.j)(t.SchemaName)]=null,Object(r.j)(t.SchemaName)&&(a.image=!0)}):t.AttributeType===o.d.DateTime&&e.data.forEach(e=>{var n=Object(r.j)(t.SchemaName),o=function(e){if("string"!=typeof e)return e;for(var[t,a]of s.entries())if(t.test(e)){var n=e.split(/[\/-]/);if(Number(n[a])<1753)return"1753-01-01T00:00:00.000Z"}return e}(e[n]);e[n]!==o&&(a.date=!0),e[n]=o})}),Object.keys(a).some(e=>a[e])&&Object(i.jb)(l.b,{eventName:l.a.sampleDataProcessor.cleanUpInvalidSampleData,eventData:a}),e}var s=new Map([[/^\d{2}\/\d{2}\/\d{4}$/,2],[/^\d{4}\/\d{2}\/\d{2}$/,0],[/^(\d{4}-\d{2}-\d{2})(T\d{2}:\d{2}:\d{2}(\.\d{1,3})?)?(Z|[+-]\d{2}:?\d{2})?$/,0]])},38134:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(10926),r=a.n(n),o=a(32612),i=a(38085),l=e=>{var{initialPrompt:t,additionalPrompt:a,setAdditionalPrompt:l}=e,c=o.hooks.useSendMessage(),[s]=o.hooks.useConnectivityStatus(),[u,d]=Object(n.useState)(!1);return(()=>{var[e,t]=o.hooks.useSendBoxValue();e.length>=250&&t(e.substring(0,250))})(),Object(n.useEffect)(()=>{u||"connected"!==s||(c(t),d(!0))},[s]),Object(n.useEffect)(()=>{u&&(c(a),l(""))},[a,l]),r.a.createElement(o.Components.BasicWebChat,{className:i.a.webchat})}},38135:function(e,t,a){"use strict";var n=a(11629),r=a(11624),o=a(11860),i=a(11708),l=a(11823),c=a(11824),s=a(20491),u=a(11465),d=a(10926),p=a.n(d),m=a(37893),b=a(12062),f=a(37918),v={main:{maxWidth:"470px !important"}};t.a=e=>{var{isVisible:t,onDismiss:a,onConfirm:d}=e,g=Object(f.a)(),{t:h}=Object(u.t)(m.k),{devEnvironment:y}=Object(s.a)(),O=void 0===y,C=h(((e,t)=>e?t?"devEnvCreationDialog.createEnvironmentSubTextTableFlow":"devEnvCreationDialog.createEnvironmentSubText":t?"devEnvCreationDialog.useEnvironmentSubTextTableFlow":"devEnvCreationDialog.useEnvironmentSubText")(O,g)),S={type:n.a.normal,title:h(g?"devEnvCreationDialog.titleTableFlow":"devEnvCreationDialog.title"),closeButtonAriaLabel:h("devEnvCreationDialog.dismissText")},E={isBlocking:!0,styles:v};return p.a.createElement(r.a,{hidden:!t,onDismiss:a,modalProps:E,dialogContentProps:S},p.a.createElement("div",null,C,O&&p.a.createElement(p.a.Fragment,null," ",p.a.createElement(o.a,{href:b.b.developerPlanLearnMoreLink,target:"_blank"},h("common.learnMore")))),p.a.createElement(i.a,null,p.a.createElement(l.a,{onClick:d,text:h("devEnvCreationDialog.confirmText")}),p.a.createElement(c.a,{onClick:a,text:h("devEnvCreationDialog.dismissText")})))}},38136:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(11635),r=a(10926);function o(e){var t=Object(n.a)(Object(r.createRef)()),[a,o]=Object(r.useState)(t<=e);return Object(r.useEffect)(()=>{o(t<e)},[t,e]),{hasReachedBreakpoint:a}}},38137:function(e,t,a){e.exports=a.p+"static/media/tableDesignerEmptyState.4a93111d.svg"},38138:function(e,t,a){e.exports=a.p+"static/media/tableDesignerEmptyStateTable.4bd63182.svg"},38139:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(10926),r=a.n(n),o=a(38085),i=a(12139),l=a(11666),c=a(12839),s=a(11465),u=a(37893),d=e=>{var{text:t}=e;return r.a.createElement(i.a,{className:o.a.suggestion,horizontal:!0,tokens:{childrenGap:6}},r.a.createElement(l.a,{iconName:"SkypeCircleCheck"})," ",r.a.createElement(c.a,{as:"span"},t))},p=()=>{var{t:e}=Object(s.t)(u.k),t=e("createTableStep.suggestionsTitle"),a=["suggestion1","suggestion2","suggestion3","suggestion4","suggestion5","suggestion6","suggestion7"].map(e=>"".concat("createTableStep.suggestions.").concat(e));return r.a.createElement(i.a,{className:o.a.suggestionsWrapper},r.a.createElement(c.a,{as:"h5"},t),a.map((t,a)=>r.a.createElement(d,{key:a,text:e(t)})))}},38140:function(e,t,a){e.exports=a.p+"static/media/tableCreationFailedState.3ec84c78.svg"}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/672.a2058b0d.chunk.js.map
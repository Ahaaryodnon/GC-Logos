/*! For license information please see 233.ad2a6fc5.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[233],{17321:function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"b",(function(){return v})),n.d(t,"h",(function(){return f})),n.d(t,"f",(function(){return h})),n.d(t,"a",(function(){return m})),n.d(t,"g",(function(){return b})),n.d(t,"c",(function(){return g}));n(11906);var r=n(11865),o=n(10926),i=n.n(o),a=n(12093),s=n(12096);function c(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){c(i,r,o,a,s,"next",e)}function s(e){c(i,r,o,a,s,"throw",e)}a(void 0)}))}}function l(e,t,n){return a.b(e,t,n)}function d(e,t,n,r,o){return p.apply(this,arguments)}function p(){return(p=u((function*(e,t,n,r,o){var i=new URLSearchParams(t);return yield a.c(e,n,t,i.get(s.a.EmbeddedInTeams.value)||void 0,r,void 0,o)}))).apply(this,arguments)}function v(e,t){return e===t||!(!r.a.useLocalCanvasEndpoint||"v1.0.0.0"!==e&&"v1.0.0.0"!==t)}function f(e){var t=i.a.useRef();return i.a.useEffect(()=>{t.current=e}),t.current}function h(e){return"POP"===e.action}function m(e,t){return!e&&!t||!(!e||!t)&&e.toUpperCase()===t.toUpperCase()}function b(e){try{var t=new URL(e);return-1!==t.hostname.indexOf("authoring")&&(-1!==t.hostname.indexOf("powerapps")||-1!==t.hostname.indexOf("appsplatform"))}catch(n){return!1}}function g(e,t){var n="geolocation; microphone; camera; fullscreen; clipboard-write;";return"72f988bf-86f1-41af-91ab-2d7cd011db47"===e&&"test"===t&&(n+="display-capture;"),n}},17322:function(e,t,n){"use strict";n.d(t,"f",(function(){return h})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return b})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return w})),n.d(t,"a",(function(){return y}));var r,o=n(11906),i=n(11021),a=n(12219),s=n(12094),c=n(17321),u=n(12096),l=n(17323);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){var n=function(e){var t=new URLSearchParams(e),n=[];return t.forEach((e,t)=>{var r;null!==(r=u.a[t])&&void 0!==r&&r.cleanOnUrlUpdate&&n.push(t)}),n.forEach(e=>t.delete(e)),t}(e);return n.set(u.a.Action.value,"edit"),n.set(u.a.AppId.value,t),n.toString()}function h(){var e=new URL(window.location.href),t=Object(l.f)();!e.searchParams.has("canvasSessionId")&&t&&e.searchParams.set("canvasSessionId",t),window.location.href=e.href}function m(e,t){var n,r=null==e||null===(n=e.data)||void 0===n?void 0:n.listUrl;r&&(!function(e){try{if("https:"===new URL(e).protocol)return!0}catch(t){return!1}return!1}(r)?b(t):window.location.href=r)}function b(e){var t,n,i=e&&e.name?e.name:a.f;window.open(Object(o.a)(r||(t=["/environments/","/home"],n||(n=t.slice(0)),r=Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(n)}}))),i),"_self")}function g(e,t){var n,r=null==e||null===(n=e.data)||void 0===n?void 0:n.appToken;if(r&&new URLSearchParams(t.location.search).get(u.a.AppId.value)!==r){var o=t.location,a="".concat(t.location.pathname,"?").concat(f(o.search,r));Object(i.W)(s.n,{eventName:"".concat(s.m,"/onFileOpenedUrlUpdate"),eventData:p(p({},t.location),{},{newUrl:a})}),t.replace(a)}}function w(e,t){var n,r,o=null==e||null===(n=e.data)||void 0===n?void 0:n.isNewApp,a=null==e||null===(r=e.data)||void 0===r?void 0:r.appToken;if(o&&a){var c=t.location,u="".concat(t.location.pathname,"?").concat(f(c.search,a));Object(i.W)(s.n,{eventName:"".concat(s.m,"/onFileSaveUrlUpdate"),eventData:p(p({},t.location),{},{newUrl:u})}),t.replace(u)}}function y(e,t){var n=e;Object(c.f)(e)&&n.canGo(-2)?e.go(-2):n.canGo(-1)?e.goBack():b(t)}},17323:function(e,t,n){"use strict";var r=n(17324);n.d(t,"c",(function(){return r.a})),n.d(t,"d",(function(){return r.b})),n.d(t,"e",(function(){return r.c})),n.d(t,"f",(function(){return r.d})),n.d(t,"g",(function(){return r.e}));var o=n(17336);n.d(t,"a",(function(){return o.a}));var i=n(17335);n.d(t,"b",(function(){return i.a}));n(17333)},17324:function(e,t,n){"use strict";n.d(t,"a",(function(){return N})),n.d(t,"b",(function(){return k})),n.d(t,"c",(function(){return I})),n.d(t,"d",(function(){return W})),n.d(t,"e",(function(){return _}));var r,o,i=n(11021),a=n(17325),s=n(17326),c=n(17327),u=n(17328),l=n(17336),d=n(17333),p=n(11906),v=n(11865),f=n(11864),h=n(13450),m=n(17334);function b(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function j(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){O(i,r,o,a,s,"next",e)}function s(e){O(i,r,o,a,s,"throw",e)}a(void 0)}))}}var C,E;function S(e,t,n,r){return"".concat(e,"-").concat(t.toString(),"-").concat(n,"-").concat(r)}function P(e,t,n,r){var o=S(e,t,n,r);if(C)return C.instanceKey===o?C.instancePromise:(Object(i.W)(s.q,{eventName:"".concat(s.p,"/getWebAuthInstancePromiseDisposing"),eventData:{requestedInstanceKey:o,currentInstanceKey:C.instanceKey}}),void _())}function N(e,t,n,r){return A.apply(this,arguments)}function A(){return(A=j((function*(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l.a.None;return yield B(e,t,n,r,o)}))).apply(this,arguments)}function k(e,t,n){return x.apply(this,arguments)}function x(){return(x=j((function*(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l.a.None,o=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]&&arguments[8],u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:void 0;return yield T(e,t,n,r,s,c,o,i,a,u)}))).apply(this,arguments)}function I(){var e;return(null===(e=C)||void 0===e?void 0:e.instancePromise)||void 0}function W(){var e;return(null===(e=C)||void 0===e?void 0:e.sessionId)||void 0}function B(e,t,n,r){var o,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l.a.None;Object(i.W)(s.q,{eventName:"".concat(s.p,"/_getEmptySessionWithHostEndpointInternal"),eventData:{environmentName:t.name,environmentLocation:t.location,environmentUpdateCadence:t.properties.updateCadence.id,webAuthEndpointOverride:n,studioVersion:r,autoDisposal:a,alreadyHasSessionOrPromise:!(null===(o=C)||void 0===o||!o.instancePromise)}}),R(a);var c=P(t.name,!0,n,r);return c||(C={instanceKey:S(t.name,!0,n,r),instancePromise:H.getEmptySessionWithHostEndpoint(e,t,n,r)}).instancePromise}function T(e,t,n){var r,o,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l.a.None,c=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0,d=arguments.length>6?arguments[6]:void 0,p=arguments.length>7?arguments[7]:void 0,v=arguments.length>8?arguments[8]:void 0,f=arguments.length>9&&void 0!==arguments[9]?arguments[9]:void 0,h=new URLSearchParams(window.location.search),m=h.get("canvasSessionId");Object(i.W)(s.q,{eventName:"".concat(s.p,"/_getOrCreateWebAuthSessionInternal"),eventData:{environmentName:n.name,environmentLocation:n.location,appId:d,environmentUpdateCadence:null===(r=n.properties.updateCadence)||void 0===r?void 0:r.id,autoDisposal:a,alreadyHasSessionOrPromise:!(null===(o=C)||void 0===o||!o.instancePromise),studioVersion:p,webAuthEndpointOverride:v,prevCanvasSessionID:m,entryPointSupportsCoauthoring:c,allowWebAuthSessionRetries:u}}),R(a);var b=P(n.name,!1,v,p);return b||(C={instanceKey:S(n.name,!1,v,p),instancePromise:H.createAsync(t,n,e,d,p,v,c,u,f),sessionId:e}).instancePromise}function _(){Object(i.W)(s.q,{eventName:"".concat(s.p,"/onWebAuthSessionDisposed")}),C=void 0,q()}function U(e){return D.apply(this,arguments)}function D(){return(D=j((function*(e){C&&(Object(i.W)(s.q,{eventName:"".concat(s.p,"/").concat("beforeunload")}),E!==l.a.BeforeBrowserUnload?E===l.a.AfterClosingConfirmation&&(e.preventDefault(),e.returnValue=""):(yield C.instancePromise).onBrowserClosing())}))).apply(this,arguments)}function M(){return L.apply(this,arguments)}function L(){return(L=j((function*(){C&&(Object(i.W)(s.q,{eventName:"".concat(s.p,"/").concat("unload")}),(yield C.instancePromise).onBrowserClosing())}))).apply(this,arguments)}function R(e){q(),E=e,window&&window.addEventListener&&(E!==l.a.BeforeBrowserUnload&&E!==l.a.AfterClosingConfirmation||window.addEventListener("beforeunload",U),E!==l.a.OnBrowserUnload&&E!==l.a.AfterClosingConfirmation||window.addEventListener("unload",M))}function q(){E=l.a.None,window&&window.removeEventListener&&(window.removeEventListener("beforeunload",U),window.removeEventListener("unload",M))}class H{get sessionToken(){return this._sessionToken}get sessionState(){return this._sessionState}get sessionId(){return this._sessionId}get domainName(){return this._domainName}get authoringHostVersion(){return this._authoringHostVersion}get authoringHostEndpoint(){return this._authoringHostEndpoint}get location(){return this._location}get isCoauthoringAllowed(){return this._isCoauthoringAllowed}get minimumSupportedVersionForCoauthoring(){return this._minimumSupportedVersionForCoauthoring}get isCoauthoringWithMultipleWritersAllowed(){return this._isCoauthoringWithMultipleWritersAllowed}get isCoauthoringEnabledForApp(){return this._isCoauthoringEnabledForApp}get isCoauthoringWithMultipleWritersEnabledForApp(){return this._isCoauthoringWithMultipleWritersEnabledForApp}get minimumSupportedVersionForMultipleWriters(){return this._minimumSupportedVersionForMultipleWriters}get coauthoringSessionId(){return this._coauthoringSessionId}static createAsync(e,t,n,r,o,a){var c=arguments;return j((function*(){var l,d,p,v,b,g,y,O,j,C,E=c.length>6&&void 0!==c[6]&&c[6],S=c.length>7&&void 0!==c[7]&&c[7],P=c.length>8&&void 0!==c[8]?c[8]:void 0;if(!t)throw new Error("environment parameter is required.");var N,A,k,x,I,W=t.name,B=t.location,T=null!==(l=null===(d=t.properties.updateCadence)||void 0===d?void 0:d.id)&&void 0!==l?l:"Frequent",_={environmentName:W,appId:r,environmentLocation:B,environmentUpdateCadence:T,studioVersion:o,webAuthEndpointOverride:a,entryPointSupportsCoauthoring:E,allowRetries:S,studioActionId:P},U=Object(i.N)(s.q,"".concat(s.p,"/createAsync"),_),D="",M=!1,L=null,R=!1,q=!1,V=!1,F=!1;try{var z=yield u.b();if(D=yield H._getSessionTokenAsync(z,W,S),E){var K=Object(i.X)(s.q,"".concat(s.p,"/loadCoauthoringECS"),_);try{yield h.b.waitUntilLoaded(8e3),K.complete(_)}catch(oe){K.failure(w(w({},_),{},{error:oe}))}}var G=new URLSearchParams(window.location.search).get(s.j),J=G&&"true"===G.toLowerCase();if(F=!(R=E&&!!m.b.getConfig().enableCanvasCoauthoring&&!J),R){var X,$=a?"https://".concat(a):Object(f.b)(e,t.location,t),Y=o?"/".concat(o):"",Z="".concat($).concat(Y),Q=!1;x=m.c.getConfig().minimumSupportedVersionForCoauthoring,I=m.d.getConfig().minimumSupportedVersionForMultipleWriters;var ee=(q=!!m.e.getConfig().enableCanvasCoauthoringWithMultipleWriters)?s.g.MultipleWriters:s.g.SingleWriter;try{X=yield H._startAsync(D,n,B,t.name,T,Z,S,r,ee,P)}catch(ie){var te;if(422!==(null==ie||null===(te=ie.response)||void 0===te?void 0:te.status))throw ie;Q=!0}if(Q||!X)F=!0;else{A="".concat(X.clientConfig.directOriginBaseUrl.replace(/\/$/,""),"/").concat(X.authoringHostVersion),k=X.clientConfig.location,M=X.isCoauthoringEnabled,V=X.isCoauthoringWithMultipleWritersEnabled,L=X.coauthoringSessionId,N=X;var ne=w(w({},_),{},{baseUrl:A,clientConfigLocation:X.clientConfig.location,authoringHostVersion:X.authoringHostVersion,clientConfigVersion:X.clientConfig.webAuthoringVersion,domainName:X.domainName,clientConfigDirectOriginBaseUrl:X.clientConfig.directOriginBaseUrl,coauthoringSessionId:L,isCoauthoringEnabledForApp:M,isCoauthoringWithMultipleWritersEnabledForApp:V,allowCoauthoring:R,allowCoauthoringWithMultipleWriters:q,minimumSupportedVersionForCoauthoring:x,minimumSupportedVersionForMultipleWriters:I});U.complete(ne)}}if(F){var re=yield H._getAuthoringHostEndpointAsync(e,t,o,a);A=re.baseUrl,k=re.location,N=yield H._createNewInstanceAsync(D,n,B,t.name,T,re.baseUrl,S,r,P),U.complete(w(w({},_),{},{allowCoauthoring:R,allowCoauthoringWithMultipleWriters:q,callNewInstance:F}))}}catch(ae){return U.failure(w(w({},_),{},{allowCoauthoring:R,allowCoauthoringWithMultipleWriters:q,callNewInstance:F,error:ae})),H._throwException(ae,"Unable to create WebAuthSession.")}return N&&N.sessionState&&N.domainName&&N.authoringHostVersion&&A&&k||Object(i.U)(s.q,{eventName:"".concat(s.p,"/WebAuthSession.createAsync.postConditionError"),eventData:w(w({},_),{},{allowCoauthoring:R,allowCoauthoringWithMultipleWriters:q,callNewInstance:F})}),new H(D,null!==(p=null===(v=N)||void 0===v?void 0:v.sessionState)&&void 0!==p?p:"",n,null!==(b=null===(g=N)||void 0===g?void 0:g.domainName)&&void 0!==b?b:"",null!==(y=null===(O=N)||void 0===O?void 0:O.authoringHostVersion)&&void 0!==y?y:"",null!==(j=A)&&void 0!==j?j:"",null!==(C=k)&&void 0!==C?C:"",R,x,q,M,V,I,L)}))()}static getEmptySessionWithHostEndpoint(e,t,n,r){return j((function*(){var o;Object(i.W)(s.q,{eventName:"".concat(s.p,"/getEmptySessionWithHostEndpoint"),eventData:{environment:t.name,webAuthEndpointOverride:n,studioVersion:r}});try{o=yield H._getAuthoringHostEndpointAsync(e,t,r,n)}catch(a){H._throwException(a,"Unable to get authoring host endpoint.")}return new H("","","","","",o.baseUrl,o.location,!1,void 0,!1,!1,!1,void 0,null)}))()}static _getHeaders(e){var t={};return e.sessionState&&(t[s.o]=e.sessionState),e.sessionToken&&(t[s.b]=e.sessionToken),e.sessionId&&(t[s.e]=e.sessionId),e.domainName&&(t[s.k]=e.domainName),e.environmentName&&(t[s.l]=e.environmentName),e.environmentUpdateCadence&&(t[s.m]=e.environmentUpdateCadence),e.appId&&(t[s.a]=e.appId),e.accessToken&&(t[s.c]="Bearer "+e.accessToken),e.coauthoringMode&&(t[s.h]=e.coauthoringMode),t}getJoinTokenAsync(){throw new Error("Method not implemented.")}onBrowserClosing(){if(!this._disposed&&!this._disposing){var e=this._getDisposeRequestDetails();u.d(e.url,e.headers),this._disposed=!0}}disposeAsync(){var e=this;return j((function*(){if(e._disposed)throw new d.a("Session already disposed.",d.b.AlreadyDisposed);if(!e._disposing){e._disposing=!0;var t=e._getDisposeRequestDetails();try{yield u.e(t.url,"authoringsession/dispose","POST",t.headers),e._disposed=!0,_()}catch(n){Object(i.U)(s.q,{eventName:"".concat(s.p,"/dispose")},n),H._throwException(n,"Unable to dispose web auth session.")}finally{e._disposing=!1}}}))()}_getDisposeRequestDetails(){return{url:"".concat(this.authoringHostEndpoint,"/api/authoringsession/dispose"),headers:H._getHeaders({sessionToken:this._sessionToken,sessionState:this._sessionState,sessionId:this._sessionId,domainName:this._domainName})}}constructor(e,t,n,r,o,i,a){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:void 0,u=arguments.length>9&&void 0!==arguments[9]&&arguments[9],l=arguments.length>10&&void 0!==arguments[10]&&arguments[10],d=arguments.length>11&&void 0!==arguments[11]&&arguments[11],p=arguments.length>12&&void 0!==arguments[12]?arguments[12]:void 0,v=arguments.length>13&&void 0!==arguments[13]?arguments[13]:null;this._sessionToken=e,this._sessionState=t,this._sessionId=n,this._domainName=r,this._authoringHostVersion=o,this._authoringHostEndpoint=i,this._location=a,this._isCoauthoringAllowed=s,this._minimumSupportedVersionForCoauthoring=c,this._isCoauthoringWithMultipleWritersAllowed=u,this._isCoauthoringEnabledForApp=l,this._isCoauthoringWithMultipleWritersEnabledForApp=d,this._minimumSupportedVersionForMultipleWriters=p,this._coauthoringSessionId=v,this._disposing=!1,this._disposed=!1}}H.powerAppsApiVersion="2020-02-01",H._getSessionTokenAsync=function(){var e=j((function*(e,t,n){var r=yield Object(c.b)(),o="https://".concat(r,"/providers/Microsoft.PowerApps/objectIds/").concat(u.a(e),"/initiateDocumentServerSession?api-version=").concat(H.powerAppsApiVersion),a=H._getHeaders({accessToken:e});Object(i.W)(s.q,{eventName:"".concat(s.p,"/_getSessionTokenAsync"),eventData:{environmentName:t,baseUrl:r}});var l="";try{var d={environmentName:t};l=(yield u.e(o,"initiateDocumentServerSession","POST",a,d,n)).sessionToken}catch(v){var p;Object(i.U)(s.q,{eventName:"".concat(s.p,"/_getSessionTokenAsync"),eventData:{requestStatusCode:null===(p=v.request)||void 0===p?void 0:p.status,url:o,environmentName:t}},v),H._throwException(v,"Unable to retrieve session token.")}return l}));return function(t,n,r){return e.apply(this,arguments)}}(),H._startAsync=function(){var e=j((function*(e,t,n,o,a,c,l,d,f){var h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:void 0,m={"environment-name":o,"environment-update-cadence":a},g=v.a.useIslandCluster||c?void 0:n;g&&(m.requestedLocation=g);var y=Object(p.a)(r||(r=b(["","/api/authoringsession/start?",""])),c,m),O={environmentName:o,appId:d,environmentLocation:n,environmentUpdateCadence:a,authoringHostEndpoint:c,url:y,coauthoringMode:f,studioActionId:h},j=Object(i.N)(s.q,"".concat(s.p,"/_startAsync"),O),C=yield u.c(),E=H._getHeaders({sessionToken:e,sessionId:t,environmentName:o,environmentUpdateCadence:a,appId:d,accessToken:C,coauthoringMode:f});try{var S=yield u.e(y,"authoringsession/start","POST",E,void 0,l,!0);return j.complete(w(w({},O),{},{clientConfigLocation:S.clientConfig.location,authoringHostVersion:S.authoringHostVersion,clientConfigVersion:S.clientConfig.webAuthoringVersion,domainName:S.domainName,clientConfigDirectOriginBaseUrl:S.clientConfig.directOriginBaseUrl,coauthoringSessionId:S.coauthoringSessionId,isCoauthoringEnabledForApp:S.isCoauthoringEnabled,isCoauthoringWithMultipleWritersEnabledForApp:S.isCoauthoringWithMultipleWritersEnabled})),S}catch(N){var P;return j.failure(w(w({},O),{},{requestStatusCode:null===(P=N.request)||void 0===P?void 0:P.status,error:N})),H._throwException(N,"Unable to create start web auth session.")}}));return function(t,n,r,o,i,a,s,c,u){return e.apply(this,arguments)}}(),H._createNewInstanceAsync=function(){var e=j((function*(e,t,n,r,a,c,l,d){var f,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:void 0,m=Object(p.a)(o||(o=b(["","/api/authoringsession/newinstance?",""])),c,{requestedLocation:v.a.useIslandCluster||c?void 0:n}),g={environmentName:r,environmentUpdateCadence:a,appId:d,environmentLocation:n,authoringHostEndpoint:c,url:m,studioActionId:h},y=Object(i.N)(s.q,"".concat(s.p,"/_createNewInstanceAsync"),g),O=yield u.c(),j=H._getHeaders({sessionToken:e,sessionId:t,environmentName:r,environmentUpdateCadence:a,appId:d,accessToken:O});try{var C;f=yield u.e(m,"authoringsession/newinstance","POST",j,void 0,l),y.complete(w(w({},g),{},{domainName:null===(C=f)||void 0===C?void 0:C.domainName}))}catch(S){var E;y.failure(w(w({},g),{},{requestStatusCode:null===(E=S.request)||void 0===E?void 0:E.status,error:S})),H._throwException(S,"Unable to create new web auth session instance.")}return f}));return function(t,n,r,o,i,a,s,c){return e.apply(this,arguments)}}(),H._getAuthoringHostEndpointAsync=function(){var e=j((function*(e,t,n,r){var o;Object(i.W)(s.q,{eventName:"".concat(s.p,"/_getAuthoringHostEndpointAsync"),eventData:{environmentName:t.name,studioVersion:n,webAuthEndpointOverride:r}});try{o=yield Object(a.a)(e,t,n,r)}catch(c){H._throwException(c,"Unable to get web authoring host endpoint.")}return o}));return function(t,n,r,o){return e.apply(this,arguments)}}(),H._throwException=(e,t)=>{throw e instanceof d.a?new d.a(t,e.ErrorType,e.HttpErrorCode):new d.a(t,d.b.Other)}},17325:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(11864),o=n(11021),i=n(17326);function a(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){a(i,r,o,s,c,"next",e)}function c(e){a(i,r,o,s,c,"throw",e)}s(void 0)}))}}function c(e,t,n,r){return u.apply(this,arguments)}function u(){return(u=s((function*(e,t,n,a){var s=yield Object(r.a)(e,t,n,a);if(s&&s.webAuthoringVersion&&s.directOriginBaseUrl&&s.location){var c="".concat(s.directOriginBaseUrl.replace(/\/$/,""),"/").concat(s.webAuthoringVersion);return Object(o.W)(i.q,{eventName:"".concat(i.p,"/getAuthoringHostEndpointAsync"),eventData:{baseUrl:c,location:s.location}}),{baseUrl:c,location:s.location}}var u,l=new Error("Response from web auth config api is invalid.");throw Object(o.U)(i.q,{eventName:"".concat(i.p,"/getAuthoringHostEndpointAsync"),eventData:{environmentName:t.name,environmentLocation:t.location,environmentUpdateCadence:null===(u=t.properties.updateCadence)||void 0===u?void 0:u.id,studioVersion:n,webAuthEndpointOverride:a,response:s}},l),l}))).apply(this,arguments)}},17326:function(e,t,n){"use strict";n.d(t,"q",(function(){return r})),n.d(t,"p",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"f",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"o",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"k",(function(){return p})),n.d(t,"l",(function(){return v})),n.d(t,"m",(function(){return f})),n.d(t,"a",(function(){return h})),n.d(t,"n",(function(){return m})),n.d(t,"h",(function(){return b})),n.d(t,"j",(function(){return g})),n.d(t,"g",(function(){return w}));var r="powerapps-webauth-session-manager",o="WebAuthSession",i="authorization",a="Authorization",s="x-ms-client-request-id",c="x-ms-correlation-request-id",u="x-ms-session-state",l="authoringsessiontoken",d="x-ms-client-session-id",p="x-ms-domain-name",v="x-ms-environment-name",f="x-ms-environment-update-cadence",h="x-ms-app-name",m="pa-rp",b="x-ms-coauthoring-mode",g="disableCanvasCoauthoring",w=function(e){return e.None="0",e.SingleWriter="2",e.MultipleWriters="3",e}({})},17327:function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return m})),n.d(t,"d",(function(){return g})),n.d(t,"f",(function(){return y})),n.d(t,"e",(function(){return O}));var r=n(11019),o=n(11415),i=n(10920),a=n(11868),s=n(11420),c=n.n(s),u=n(17326);function l(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){l(i,r,o,a,s,"next",e)}function s(e){l(i,r,o,a,s,"throw",e)}a(void 0)}))}}function p(){return v.apply(this,arguments)}function v(){return(v=d((function*(){return yield Object(a.m)(u.n)}))).apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return(h=d((function*(e){return yield Object(r.g)(e)}))).apply(this,arguments)}function m(){return b.apply(this,arguments)}function b(){return(b=d((function*(){return yield Object(a.o)(u.n,Object(i.j)().region)}))).apply(this,arguments)}function g(e,t,n,r){return w.apply(this,arguments)}function w(){return(w=d((function*(e,t,n,r){return yield c()({url:e,method:t,headers:n,data:r})}))).apply(this,arguments)}function y(e){return Object(o.b)(e)}function O(e){return j.apply(this,arguments)}function j(){return(j=d((function*(e){return new Promise(t=>setTimeout(()=>t(),e))}))).apply(this,arguments)}},17328:function(e,t,n){"use strict";n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return w})),n.d(t,"d",(function(){return C})),n.d(t,"e",(function(){return E})),n.d(t,"a",(function(){return k}));var r=n(10920),o=n(17329),i=n(11021),a=n(11031),s=n(17326),c=n(17327),u=n(17333),l=n(11865),d=n(17334);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function m(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){h(i,r,o,a,s,"next",e)}function s(e){h(i,r,o,a,s,"throw",e)}a(void 0)}))}}function b(){return g.apply(this,arguments)}function g(){return(g=m((function*(){var e,t=null===(e=d.a.getConfig())||void 0===e?void 0:e.WebAuthAccessTokenForMonitor;if(null!=t&&t.isEnabled){var n,o=Object(l.b)(null===(n=Object(r.j)())||void 0===n?void 0:n.region);return yield O(o)}return yield w()}))).apply(this,arguments)}function w(){return y.apply(this,arguments)}function y(){return(y=m((function*(){var e=yield Object(c.c)();return yield O(e)}))).apply(this,arguments)}function O(e){return j.apply(this,arguments)}function j(){return(j=m((function*(e){var t;if(e){if((t=yield Object(c.a)(e)).error)throw Object(i.U)(s.q,{eventName:"".concat(s.p,"/getAccessToken")},t.error),t.error;return t.accessToken}var n=new Error("Could not determine authorization endpoint.");throw Object(i.U)(s.q,{eventName:"".concat(s.p,"/getAccessToken")},n),n}))).apply(this,arguments)}function C(e,t){var n=a.a(),r=Object(i.t)(e),o=I(n,t),c=x(o,!0);try{var u=function(e,t){if(!fetch||!("keepalive"in new Request("")))return!1;fetch(e,{method:"POST",headers:t,keepalive:!0});return!0}(e,o);if(Object(i.W)(s.q,{eventName:"".concat(s.p,"/").concat(r),eventData:{keepalive:u,telemetryHeaders:c}}),!0===u)return;!function(e,t){var n=new XMLHttpRequest;for(var r in n.open("POST",e,!1),t)if(t.hasOwnProperty(r)){var o=t[r];n.setRequestHeader(r.toString(),o)}n.send()}(e,o)}catch(l){Object(i.U)(s.q,{eventName:"".concat(s.p,"/").concat(r)},l)}}function E(e,t,n,r,o){return S.apply(this,arguments)}function S(){return(S=m((function*(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return P(e,t,i,0,a,n,r,o)}))).apply(this,arguments)}function P(e,t,n,r,o,i,a,s,c){return N.apply(this,arguments)}function N(){return(N=m((function*(e,t,n,r,l,d,p,f,h){var m=a.a(),b=Object(i.t)(e),g=I(m,p),w={allowRetries:n,isRetry:r>0,numberOfRetries:r,apiUrl:b};Object(i.bb)(d,e,b,Object(i.v)(e),Object(i.u)(e),m,x(g,!0));var y,O=null!=h?h:Object(i.Y)(s.q,"".concat(s.p,"/API/").concat(t),w);try{y=yield Object(c.d)(e,d,g,f),O.complete(w)}catch(R){var j,C,E,S,N,k,W,B=R;B.config&&x(B.config.headers),B.response&&x(B.response.headers),B.request&&x(B.request.headers),Object(i.U)(s.q,{eventName:"".concat(s.p,"/").concat(b,"}"),eventData:w},B);var T=v(v({},w),{},{error:B,errorCode:B.code,errorStatus:null===(j=B.response)||void 0===j?void 0:j.status});if(n&&r<3&&("Network Error"===B.message||"ECONNABORTED"===B.code||0===(null===(C=B.response)||void 0===C?void 0:C.status)||408===(null===(E=B.response)||void 0===E?void 0:E.status)||l&&422===(null===(S=B.response)||void 0===S?void 0:S.status)||429===(null===(N=B.response)||void 0===N?void 0:N.status)||null!==(k=B.response)&&void 0!==k&&k.status&&(null===(W=B.response)||void 0===W?void 0:W.status)>=500)){var _,U;if(O.progress(T),422===(null===(_=B.response)||void 0===_?void 0:_.status)&&l)throw B;var D=r+1,M=A(D);return 429===(null===(U=B.response)||void 0===U?void 0:U.status)&&(M=Object(o.a)(B)||M),yield Object(c.e)(M),P(e,t,n,D,l,d,p,f,O)}O.failure(T);var L=B.response?u.b.HttpError:B.request?u.b.NetworkError:u.b.Other;throw B.response?new u.a(B.message,L,B.response.status):new u.a(B.message,L)}return x(y.headers),Object(i.S)(d,e,b,Object(i.v)(e),Object(i.u)(e),y.status,m,y.headers),y.data}))).apply(this,arguments)}function A(e){return 1e3*Math.pow(e,2)}function k(e){var t=Object(c.f)(e).payload.oid;if(t)return t;throw new Error("Unable to retrieve object id.")}function x(e,t){var n=t?Object.assign({},e):e;return n&&(n[s.c]&&(n[s.c]=""),n[s.d]&&(n[s.d]=""),n[s.o]&&(n[s.o]=""),n[s.b]&&(n[s.b]="")),n}function I(e,t){var n=v({"Content-Type":"application/json; charset=utf-8","Cache-Control":"no-cache"},t);return n[s.f]=e,n[s.i]=Object(i.y)(),n}},17329:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return m}));var r=n(17330),o=n.n(r),i=n(11021),a=n(11868),s=n(11873);function c(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}var u=!1;function l(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{retries:2,knownServices:{}};e&&e.interceptors&&!u&&(u=!0,e.interceptors.request.use(b(n)),o()(e,{retries:n.retries,shouldResetTimeout:!0,retryCondition:e=>{var t=p(e,n);return Object(i.W)(a.a,{eventName:"httpRetryInterceptor/retryCondition",eventData:{error:e,shouldRetry:t}}),t},retryDelay:null!==(t=n.retryDelay)&&void 0!==t?t:d}))}function d(e,t){var n=h(t);return n?1e3*(n+3*Math.random()):1e3*Math.pow(e,2)}function p(e,t){var n,r,o,i=null===(n=e.config)||void 0===n?void 0:n.knownServiceId;return null!==(r=t.knownServices)&&void 0!==r&&null!==(o=r[i])&&void 0!==o&&o.isRetriable?t.knownServices[i].isRetriable(e):v(e)}function v(e){var t,n,r;return"get"===(null===(t=e.config)||void 0===t||null===(n=t.method)||void 0===n?void 0:n.toLowerCase())&&(!(null===(r=e.config)||void 0===r||!r.knownServiceId)&&function(e){var t,n,r=(null===(t=e.response)||void 0===t?void 0:t.status)||0;if("Network Error"===e.message||"ECONNABORTED"===e.code||f.has(r))return!0;if(null!=e&&e.response&&429===(null==e||null===(n=e.response)||void 0===n?void 0:n.status)){var o=h(e);if(o&&o<60)return!0}return!1}(e))}var f=new Set([408,500,502,503,504]);var h=e=>{var t,n,r,o,i;return Number(null!==(t=null==e||null===(n=e.response)||void 0===n||null===(r=n.headers)||void 0===r?void 0:r["retry-after"])&&void 0!==t?t:null==e||null===(o=e.response)||void 0===o||null===(i=o.headers)||void 0===i?void 0:i["Retry-After"])||void 0};function m(e){var t;return!("post"!==(null===(t=e.config)||void 0===t?void 0:t.method)||!(Array.isArray(e.bodyDetails)&&e.bodyDetails||[]).every(e=>"query"===e.query))||v(e)}function b(e){return function(){var t,n=(t=function*(t){var n;if(!t)return t;var r=t,o=null===(n=t["axios-retry"])||void 0===n?void 0:n.retryCount;if(r.willRetry=t=>!!(o<e.retries&&t&&p(t,e)),o>0&&(r.attempt=o,void 0!==r.url&&r.knownServiceId)){var i=Object(a.j)(r.knownServiceId);i&&(yield Object(s.b)(r,i))}return t},function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){c(i,r,o,a,s,"next",e)}function s(e){c(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return n.apply(this,arguments)}}()}},17333:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var r=function(e){return e[e.AlreadyDisposed=0]="AlreadyDisposed",e[e.HttpError=1]="HttpError",e[e.NetworkError=2]="NetworkError",e[e.Other=3]="Other",e}({});class o extends Error{constructor(e,t,n){super(e),this._message=e,this._errorType=t,this._httpErrorCode=n,Object.setPrototypeOf(this,new.target.prototype)}get Message(){return this._message}get ErrorType(){return this._errorType}get HttpErrorCode(){return this._httpErrorCode}}},17334:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"a",(function(){return p}));var r=n(17335),o=n(13450),{useFeature:i,feature:a}=Object(o.a)({teamName:"MakerPortal",owners:["pacrozie"],description:"Enables canvas coauthoring (calling the WebAuth /start api -- instead of /webauthconfig + /newinstance -- which is necessary for coauthoring session routing).",createdOn:"03/23/2023",ecsURL:"https://ecs.skype.com/PowerApps-MakerPortal/MakerPortal/configurations/1100556",fallback:{enableCanvasCoauthoring:r.a.enableCanvasCoauthoring}}),{feature:s}=Object(o.a)({teamName:"MakerPortal",owners:["pacrozie"],description:"The minimum supported version canvas must be to allow enabling coauthoring.",createdOn:"08/22/2023",ecsURL:"https://ecs.skype.com/PowerApps-MakerPortal/MakerPortal/configurations/1123558",fallback:{minimumSupportedVersionForCoauthoring:"v3.23094.0.0"}}),{useFeature:c,feature:u}=Object(o.a)({teamName:"MakerPortal",owners:["luzhon"],description:"The minimum supported version canvas must be to allow enabling coauthoring with multiple writers from app settings.",createdOn:"02/18/2024",ecsURL:"https://ecs.skype.com/PowerApps-MakerPortal/MakerPortal/configurations/1118518",fallback:{minimumSupportedVersionForMultipleWriters:"v3.24031.0.0"}}),{useFeature:l,feature:d}=Object(o.a)({teamName:"MakerPortal",owners:["vpareddy"],description:"Enables canvas coauthoring with multiple writers.",createdOn:"08/15/2023",ecsURL:"https://ecs.skype.com/PowerApps-MakerPortal/MakerPortal/configurations/1118518",fallback:{enableCanvasCoauthoringWithMultipleWriters:r.a.enableCanvasCoauthoringWithMultipleWriters}}),{feature:p}=Object(o.a)({teamName:"MakerPortal",owners:["sramaiah","paauthoringfxeng"],description:"Determine if the access token generation for web auth is enabled",createdOn:"09/26/2023",fallback:{WebAuthAccessTokenForMonitor:{isEnabled:!1}}})},17335:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(11038),o=Object(r.d)({packageName:"webAuthSession",features:{enableCanvasCoauthoring:{owner:"pacrozie",createdDate:"02/23/2023",description:"Enables canvas coauthoring (calling the WebAuth /start api -- instead of /webauthconfig + /newinstance -- which is necessary for coauthoring session routing).",enabledFor:{test:!1,preprod:!1,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1,ex:!1,rx:!1}},enableCanvasCoauthoringWithMultipleWriters:{owner:"vpareddy",createdDate:"08/15/2023",description:"Enables canvas coauthoring with multiple writers.",enabledFor:{test:!1,preprod:!1,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1,ex:!1,rx:!1}}}})},17336:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){return e[e.None=0]="None",e[e.BeforeBrowserUnload=1]="BeforeBrowserUnload",e[e.OnBrowserUnload=2]="OnBrowserUnload",e[e.AfterClosingConfirmation=3]="AfterClosingConfirmation",e}({})},17363:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(13556),o=n(11021),i=n(10926),a=n(12313),s=n(11868),c=n(12063),u=n(12219),l=n(14768);function d(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,o)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){d(i,r,o,a,s,"next",e)}function s(e){d(i,r,o,a,s,"throw",e)}a(void 0)}))}}function v(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],[d,v]=Object(i.useState)(),[h,m]=Object(i.useState)(),{currentEnvironment:b}=Object(u.W)(),g=Object(l.e)(),w=Object(i.useMemo)(()=>["powerapps-ui-common","BapTenantSettings",e,null==b?void 0:b.name],[e,null==b?void 0:b.name]);Object(i.useLayoutEffect)(()=>{var{unregister:e}=g.register({persisterId:l.b.IndexedDB,queryKey:w,team:o.j.Shell});return e},[w,g]);var{data:y,error:O,isInitialLoading:j,isSuccess:C,isError:E}=Object(a.a)(w,p((function*(){var t={team:o.j.Shell},n=yield s.f.post(Object(c.b)(),null,t);return e.tenantSettingNames.map(e=>({settingName:e,value:f(e,n.data)}))})),{enabled:n&&e.tenantSettingNames.length>0});return Object(i.useEffect)(()=>{j?v(Object(r.j)(t,r.g.bapSettings,r.d.Common,r.e.DataFetchHooks,o.j.Shell,o.f.Medium)):C?null==d||d.complete({result:y}):E&&(null==d||d.failure({error:O}),m(null==O?void 0:O.message))},[j,C,E,t]),{loading:j,errorMessage:h,settings:y||null}}function f(e,t){var n,r=e.split("."),o=t;return r.every(e=>{var t=o[e];if("boolean"==typeof t||"string"==typeof t||"number"==typeof t)n="".concat(t);else if(t)return o=t,!0;return!1}),n}},17565:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return p}));var r=n(10926),o=n(17566),i=n(17567),a=n(17575),s=n(17571),c=n(11205),u=n(11842),l=r.createContext({isVisible:!1,isSupported:!1,isOpenInline:!1,isOpenInNewWindow:!1,botLoadingStatus:u.a.NotLoaded,toggleBot:()=>{throw Object(s.b)("SupportBot.SupportBotProviderContext.NotRegistered",{action:"toggleBot"}),new Error("Not Implemented")},openInNewWindow:()=>{throw Object(s.b)("SupportBot.SupportBotProviderContext.NotRegistered",{action:"openInNewWindow"}),new Error("Not Implemented")}}),d=e=>{var[t,n]=r.useState(!1),[s,d]=r.useState(!1),[p,v]=r.useState(!1),[f,h]=r.useState(void 0),m=Object(c.j)(),b=t=>null!=f?f:e.createBotParams(t),g=()=>{var t=window.open(e.createNewWindowUrl("botParams=".concat(encodeURIComponent(JSON.stringify(b(m.pathname))))),e.botWindowName,"height=800,width=650");if(t)var r=setInterval(()=>{t.closed&&(clearInterval(r),d(!1),n(!1))},1e3);v(!1),d(!0),n(!0)},w=e.enable&&o.a.enableSkylightBot,y={isVisible:t,isSupported:w,isOpenInNewWindow:s,isOpenInline:p,botLoadingStatus:u.a.Loaded,toggleBot:r=>{s||e.alwaysOpenInNewWindows?g():(t?(v(!1),h(void 0)):(v(!0),h(r)),n(!t))},openInNewWindow:g};return r.createElement(l.Provider,{value:y},r.createElement(r.Fragment,null,e.children),r.createElement(a.a,{createBotParams:b,authResource:e.authResource},r.createElement(i.a,null)))},p=Object(u.b)(l,"botLoadingStatus")},17566:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(11038),o=Object(r.d)({packageName:"power-support-bot",features:{enableSkylightBot:{owner:"cherieq",description:"The environments that the skylight bot is deployed to. Use a different flag to enable showing the bot.",enabledFor:{test:!0,preprod:!0,preview:!0,prod:!0,gov:!1,high:!1,dod:!1,mooncake:!1,ex:!1,rx:!1}},showOpenInNewWindowButton:{owner:"cherieq",description:"Whether open in new window button should be shown in the header. This should only be marked true when we have support from Skylight for transferring bot context",enabledFor:{test:!1,preprod:!1,preview:!1,prod:!1,gov:!1,high:!1,dod:!1,mooncake:!1,ex:!1,rx:!1}}}})},17567:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(10926),o=n(11465),i=n(17568),a=n(17582),s=Object(o.s)("supportBot")(e=>{var t={title:e.t("title"),moveText:e.t("moveMenuText"),closeBotText:e.t("closeBotText"),header:{title:e.t("title"),restartBotText:e.t("restartBotText"),minimizeBotText:e.t("minimizeBotText"),maximizeBotText:e.t("maximizeBotText"),closeBotText:e.t("closeBotText"),openInNewWindowText:e.t("openInNewWindowText")}};return r.createElement(a.a,null,r.createElement(i.a,t))})},17568:function(e,t,n){"use strict";var r=n(10926),o=n(11631),i=n(11718),a=n(17569),s=n(17572),c=n(11625),u=n(17573),l=n(11623),d=n(17574),p=n(17579),v=n(17581);function f(){return(f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var h={root:{pointerEvents:"none"},main:{pointerEvents:"auto"},scrollableContent:{maxHeight:"calc(100vh-32px)"}};t.a=Object(c.a)(e=>{var[t,n]=r.useState(!1),[c,u]=r.useState(!1),{isOpenInline:m,toggleBot:b,openInNewWindow:g}=Object(s.a)(),{restartSkylightBot:w}=Object(d.a)(),{styles:y}=e,O=Object(l.a)()(y,e);if(!m)return r.createElement(r.Fragment,null);return r.createElement(r.Fragment,null,r.createElement(o.a,{titleAriaId:e.title,isOpen:!0,isModeless:!0,className:O.modalContainer,styles:h,dragOptions:{moveMenuItemText:e.moveText,closeMenuItemText:e.closeBotText,keepInBounds:!0,menu:i.a,dragHandleSelector:"#".concat("SupportBotDraggableSection")},focusTrapZoneProps:{forceFocusInsideTrap:!1}},r.createElement("div",{className:t?O.smallModal:O.largeModal},r.createElement("div",{id:"SupportBotDraggableSection"},r.createElement(a.a,f({},e.header,{botIsMinimized:t,resizeBot:()=>{n(!t)},hideBot:()=>{b()},restartBot:()=>{u(!0)},openBotInNewWindow:()=>{g()}}))),r.createElement(v.a,{inNewWindow:!1}))),c&&r.createElement(p.a,{onCancel:()=>{u(!1)},onConfirm:()=>{u(!1),w()}}))},u.a)},17569:function(e,t,n){"use strict";var r=n(11712),o=n(11670),i=n(12139),a=n(10926),s=n(17570),c=n(11625),u=n(11623),l=n(17571),d=n(17566);t.a=Object(c.a)(e=>{var{styles:t}=e,n=Object(u.a)()(t,e);return a.createElement(i.a,{horizontal:!0,className:n.header,verticalAlign:"center",horizontalAlign:"space-between"},a.createElement(i.a.Item,null,a.createElement(o.a,{role:"presentation",iconName:"Robot",className:n.icon}),a.createElement("span",{className:n.title},e.title)),a.createElement(i.a.Item,null,d.a.showOpenInNewWindowButton&&a.createElement(r.a,{iconProps:{iconName:"OpenInNewWindow"},title:e.openInNewWindowText,ariaLabel:e.openInNewWindowText,onClick:()=>{Object(l.a)("SupportBot/Header/NewWindow"),e.openBotInNewWindow()}}),a.createElement(r.a,{iconProps:{iconName:"Refresh"},title:e.restartBotText,ariaLabel:e.restartBotText,onClick:()=>{Object(l.a)("SupportBot/Header/Restart"),e.restartBot()}}),a.createElement(r.a,{iconProps:{iconName:e.botIsMinimized?"FullScreen":"BackToWindow"},title:e.botIsMinimized?e.maximizeBotText:e.minimizeBotText,ariaLabel:e.botIsMinimized?e.maximizeBotText:e.minimizeBotText,onClick:()=>{Object(l.a)("SupportBot/Header/Resize",{isMinimized:e.botIsMinimized}),e.resizeBot()}}),a.createElement(r.a,{iconProps:{iconName:"Cancel"},title:e.closeBotText,ariaLabel:e.closeBotText,onClick:()=>{Object(l.a)("SupportBot/Header/Close"),e.hideBot()}})))},s.a)},17570:function(e,t,n){"use strict";function r(e){var{theme:t}=e;return{header:{height:"35px",backgroundColor:"#e6e6e6"},title:{fontSize:null==t?void 0:t.fonts.medium.fontSize},icon:{margin:"0 10px"}}}n.d(t,"a",(function(){return r}))},17572:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(10926),o=n(17565);function i(){return Object(r.useContext)(o.b)}},17573:function(e,t,n){"use strict";function r(e){return{largeModal:{height:"90vh",width:"500px"},smallModal:{height:"60vh",width:"500px"},modalContainer:{position:"fixed",right:"10px",bottom:"10px",width:"550px"}}}n.d(t,"a",(function(){return r}))},17579:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(10926),o=n(11465),i=n(17580);function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var s=Object(o.s)("supportBot")(e=>{var t={title:e.t("restartBotDialogTitle"),description:e.t("restartBotDialogDescription"),cancelText:e.t("restartBotDialogCancelButton"),confirmText:e.t("restartBotDialogConfirmButton")};return r.createElement(i.a,a({},t,{onCancel:e.onCancel,onConfirm:e.onConfirm}))})},17580:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(11824),o=n(11823),i=n(11624),a=n(11629),s=n(11708),c=n(10926),u=n(17571),l=e=>c.createElement(i.a,{hidden:!1,dialogContentProps:{type:a.a.normal,title:e.title,subText:e.description}},c.createElement(s.a,null,c.createElement(r.a,{onClick:()=>{Object(u.a)("SupportBot/RestartDialog/Cancel"),e.onCancel()},text:e.cancelText}),c.createElement(o.a,{onClick:()=>{Object(u.a)("SupportBot/RestartDialog/Confirm"),e.onConfirm()},text:e.confirmText})))},17582:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(10926),o=n(17571);class i extends r.PureComponent{render(){return r.Children.only(this.props.children)}componentDidCatch(e,t){var n,r;Object(o.b)("SupportBot/Crash",t,e),null===(n=(r=this.props).onError)||void 0===n||n.call(r,e,t)}}},17676:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"h",(function(){return v}));var r=n(10926),o=n(11205),i=Object(r.createContext)({isFeatureEnabled:!1,isCopilotPaneVisible:!1,setIsCopilotPaneVisible:()=>{},visibleAllowedRoutes:[],portalRef:{current:null},isPortalRefSet:!1,setIsPortalRefSet:()=>{},disabledReason:void 0}),a=()=>Object(r.useContext)(i),s=()=>a().isFeatureEnabled,c=()=>a().portalRef,u=()=>{var e,t=s(),n=(e=Object(o.j)(),a().visibleAllowedRoutes.some(t=>Object(o.h)(e.pathname,{path:t,exact:!1}))),r=a();return t&&n&&r.isPortalRefSet},l=()=>{var e;return null!==(e=a().disabledReason)&&void 0!==e?e:void 0},d=()=>{var e=a();return u()&&e.isCopilotPaneVisible},p=()=>a().setIsCopilotPaneVisible,v=()=>a().setIsPortalRefSet},17677:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(11021),o=n(17678),i=n(17680),a=n(10926);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=()=>{var{multiLanguageCanvasCopilotSupport:e}=Object(o.c)(),t=Object(i.a)({allowedLanguageList:["en"],disableLocaleCheck:e,disableEnvironmentRegionCheck:!0,disableCrossRegionCheck:!1}),{enableMakerPortalChatbot:n}=Object(o.a)();return Object(a.useEffect)(()=>{t.isLoading||Object(r.O)("PowerAppsAICommon",{eventName:"useIsMakerBotEnabled",eventData:{isCopilotEnabled:{isLoading:t.isLoading,isEnabled:t.isEnabled,reasons:c({},t.reasons)},enableMakerPortalChatbot:n,isMultiLanguageEnabled:e,multiLanguageCanvasCopilotSupport:e,enablePowerAppsCopilotGeoExpansion:!0}})},[n,t.isEnabled,t.isLoading,t.reasons,e]),t.isLoading?c(c({},t),{},{isEnabled:!1}):c(c({},t),{},{isEnabled:!!n&&(t.isEnabled||!!e)})}},17680:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(17681),o=n(17683),i=n(17684),a=n(17685),s=n(11021),c=n(10926),u=n.n(c),l=e=>{var{allowedLanguageList:t,disableEnvironmentRegionCheck:n,disableLocaleCheck:c,enableDataverseEnvironmentCheck:l,disableCrossRegionCheck:d=!1}=null!=e?e:{},p=Object(i.a)(),v=Object(o.a)(t),f=c||v,h=Object(r.a)({checkEnvironmentHasDataverseAndUserHasAccess:null!=l&&l,checkEnvCrossGeoEligibility:!d}),m=Object(a.a)(),b=p.isLoading||!n&&h.isLoading||m.isLoading;if(u.a.useEffect(()=>{b||Object(s.O)("PowerAppsAICommon",{eventName:"useIsPowerAppsCopilotEnabledWorldWide",eventData:{isOrgEligible:p.isEligible,isLocaleEligible:v,isEnvironmentEligible:h.isEligible,isTenantEligible:m.isEligible,disableLocaleCheck:c,disableEnvironmentRegionCheck:n}})},[p.isEligible,v,h.isEligible,m.isEligible,b,c,f,n]),b)return{isLoading:!0,isEnabled:!1};var g=n||h.isEligible;return{isLoading:!1,isEnabled:p.isEligible&&f&&g&&m.isEligible,reasons:{isOrgEligible:p.isEligible,isLocaleEligible:f,isEnvironmentEligible:g,isTenantEligible:m.isEligible}}}},17712:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10929),o=Object(r.db)({designerContainer:{height:"100%",position:"relative"},iframe:{height:"100%",width:"100%"},hiddenContainer:{display:"none"},visibleContainer:{display:"flex",flex:"1 1 auto",overflow:"hidden"},controlsList:{width:"100%",height:"100%",overflow:"auto"},controlButtonRoot:{width:"100%"},controlButtonLabel:{textAlign:"left"},hiddenIframe:{position:"absolute",left:"-1000px",top:"-1000px",width:"0px",height:"0px"}})}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/233.ad2a6fc5.chunk.js.map